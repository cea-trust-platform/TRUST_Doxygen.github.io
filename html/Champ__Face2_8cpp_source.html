<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VDF/Champs/Champ_Face2.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VDF/Champs/Champ_Face2.cpp</div>  </div>
</div>
<div class="contents">
<a href="Champ__Face2_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Champ_Face2.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VDF/Champs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/10</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Face_8h.html">Champ_Face.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VDF_8h.html">Zone_VDF.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__VDF_8h.html">Zone_Cl_VDF.h</a>&gt;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="comment">// Fonctions de calcul des composantes du tenseur GradU</span>
<a name="l00028"></a>00028 <span class="comment">// (derivees covariantes de la vitesse)</span>
<a name="l00029"></a>00029 <span class="comment">// dans le repere des coordonnees cylindriques</span>
<a name="l00030"></a>00030 
<a name="l00031"></a><a class="code" href="classChamp__Face.html#a0e6b34d29948c240cff8b96d0510ab6d">00031</a> <span class="keywordtype">void</span> <a class="code" href="classChamp__Face.html#a0e6b34d29948c240cff8b96d0510ab6d">Champ_Face::calculer_dercov_axi</a>(<span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; zone_Cl_VDF)
<a name="l00032"></a>00032 {
<a name="l00033"></a>00033   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF = <a class="code" href="classChamp__Face.html#a84b6abcd128000e1d5759caaa7ae0dee">la_zone_VDF</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00034"></a>00034   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco = <a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00035"></a>00035   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; orientation = zone_VDF.<a class="code" href="classZone__VDF.html#a9a9bd747218e463b3408a3590c12814c" title="inline DoubleVect&amp; Zone_VDF::porosite_face() { return porosite_face_; }">orientation</a>();
<a name="l00036"></a>00036   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00037"></a>00037   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; Qdm = zone_VDF.<a class="code" href="classZone__VDF.html#a5383bb6bad103f0b37e3862e112f9370">Qdm</a>();
<a name="l00038"></a>00038   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xv = zone_VDF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00039"></a>00039   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xp = zone_VDF.<a class="code" href="classZone__VF.html#a87a29f0223c71256a25ee343c9277599">xp</a>();
<a name="l00040"></a>00040   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; type_arete_bord = zone_Cl_VDF.<a class="code" href="classZone__Cl__VDF.html#ae99f1fd7eda112296855c945b44aa85c">type_arete_bord</a>();
<a name="l00041"></a>00041 
<a name="l00042"></a>00042   <span class="keywordtype">double</span> d_teta,R;
<a name="l00043"></a>00043   <span class="keywordtype">double</span> deux_pi = <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>*2.0;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="comment">// Remplissage de tau_diag_ : termes diagonaux du tenseur GradU</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047   <span class="keywordtype">int</span> fx0,fx1,fy0,fy1;
<a name="l00048"></a>00048   <span class="keywordtype">int</span> num_elem;
<a name="l00049"></a>00049   <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;zone_VDF.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); num_elem++)
<a name="l00050"></a>00050     {
<a name="l00051"></a>00051       fx0 = elem_faces(num_elem,0);
<a name="l00052"></a>00052       fx1 = elem_faces(num_elem,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00053"></a>00053       fy0 = elem_faces(num_elem,1);
<a name="l00054"></a>00054       fy1 = elem_faces(num_elem,1+<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="comment">// Calcul de tau11</span>
<a name="l00057"></a>00057       <a class="code" href="classChamp__Face.html#a6438021756713a2835a461188753f9cc" title="termes diagonaux du tenseur Grad">tau_diag_</a>(num_elem,0) = (inco[fx1]-inco[fx0])/(xv(fx1,0) - xv(fx0,0));
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="comment">// Calcul de tau22</span>
<a name="l00060"></a>00060       R = xp(num_elem,0);
<a name="l00061"></a>00061       d_teta = xv(fy1,1) - xv(fy0,1);
<a name="l00062"></a>00062       <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00063"></a>00063         d_teta += deux_pi;
<a name="l00064"></a>00064       <a class="code" href="classChamp__Face.html#a6438021756713a2835a461188753f9cc" title="termes diagonaux du tenseur Grad">tau_diag_</a>(num_elem,1) =     (inco[fy1]-inco[fy0])/(R*d_teta)
<a name="l00065"></a>00065                                   + 0.5*(inco[fx0]+inco[fx1])/R;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067     }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00070"></a>00070     {
<a name="l00071"></a>00071       <span class="keywordtype">int</span> fz0,fz1;
<a name="l00072"></a>00072       <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;zone_VDF.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); num_elem++)
<a name="l00073"></a>00073         {
<a name="l00074"></a>00074           fz0 = elem_faces(num_elem,2);
<a name="l00075"></a>00075           fz1 = elem_faces(num_elem,2+<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="comment">// Calcul de tau33</span>
<a name="l00078"></a>00078           <a class="code" href="classChamp__Face.html#a6438021756713a2835a461188753f9cc" title="termes diagonaux du tenseur Grad">tau_diag_</a>(num_elem,2) = (inco[fz1]-inco[fz0])/(xv(fz1,2) - xv(fz0,2));
<a name="l00079"></a>00079 
<a name="l00080"></a>00080         }
<a name="l00081"></a>00081     }
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <span class="comment">// Remplissage de tau_croises_ : termes extradiagonaux du tenseur GradU</span>
<a name="l00084"></a>00084 <span class="comment">// Les derivees croisees de la vitesse (termes extradiagonaux du tenseur</span>
<a name="l00085"></a>00085 <span class="comment">// GradU) sont calculees sur les aretes.</span>
<a name="l00086"></a>00086 <span class="comment">// Il y a deux derivees par arete:</span>
<a name="l00087"></a>00087 <span class="comment">// Pour une arete XY : tau12 et tau21</span>
<a name="l00088"></a>00088 <span class="comment">// Pour une arete YZ : tau23 et tau32</span>
<a name="l00089"></a>00089 <span class="comment">// Pour une arete XZ : tau13 et tau31</span>
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="comment">// Boucle sur les aretes bord</span>
<a name="l00092"></a>00092 
<a name="l00093"></a>00093   <span class="keywordtype">int</span> n_arete;
<a name="l00094"></a>00094   <span class="keywordtype">int</span> ndeb = zone_VDF.<a class="code" href="classZone__VDF.html#aa272d66cc2d519b88c3d5e8f0f70d700">premiere_arete_bord</a>();
<a name="l00095"></a>00095   <span class="keywordtype">int</span> nfin = ndeb + zone_VDF.<a class="code" href="classZone__VDF.html#a88b3380a8314d855c0f30a138efd834c">nb_aretes_bord</a>();
<a name="l00096"></a>00096   <span class="keywordtype">int</span> ori1,ori3;
<a name="l00097"></a>00097   <span class="keywordtype">int</span> fac1,fac2,fac3,fac4,signe;
<a name="l00098"></a>00098   <span class="keywordtype">double</span> dist3;
<a name="l00099"></a>00099 
<a name="l00100"></a>00100   <span class="keywordtype">int</span> n_type;
<a name="l00101"></a>00101 
<a name="l00102"></a>00102   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l00103"></a>00103     {
<a name="l00104"></a>00104       n_type=type_arete_bord(n_arete-ndeb);
<a name="l00105"></a>00105 
<a name="l00106"></a>00106       <span class="keywordflow">switch</span>(n_type)
<a name="l00107"></a>00107         {
<a name="l00108"></a>00108         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a> :
<a name="l00109"></a>00109 <span class="comment">// paroi-paroi</span>
<a name="l00110"></a>00110         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a>:
<a name="l00111"></a>00111 <span class="comment">// fluide-fluide</span>
<a name="l00112"></a>00112         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>:
<a name="l00113"></a>00113 <span class="comment">// paroi-fluide</span>
<a name="l00114"></a>00114           {
<a name="l00115"></a>00115             fac1 = Qdm(n_arete,0);
<a name="l00116"></a>00116             fac2 = Qdm(n_arete,1);
<a name="l00117"></a>00117             fac3 = Qdm(n_arete,2);
<a name="l00118"></a>00118             signe  = Qdm(n_arete,3);
<a name="l00119"></a>00119             ori1 = orientation(fac1);
<a name="l00120"></a>00120             ori3 = orientation(fac3);
<a name="l00121"></a>00121             <span class="keywordtype">int</span> rang1 = fac1 - zone_VDF.<a class="code" href="classZone__VF.html#a9571f861dfb23f699da7042773644a42" title="renvoie le numero de la premiere des faces sur lesquelles sont appliquees les conditions limites : bo...">premiere_face_bord</a>();
<a name="l00122"></a>00122             <span class="keywordtype">int</span> rang2 = fac2 - zone_VDF.<a class="code" href="classZone__VF.html#a9571f861dfb23f699da7042773644a42" title="renvoie le numero de la premiere des faces sur lesquelles sont appliquees les conditions limites : bo...">premiere_face_bord</a>();
<a name="l00123"></a>00123             <span class="keywordtype">double</span> vit_imp;
<a name="l00124"></a>00124 
<a name="l00125"></a>00125             <span class="keywordflow">if</span> (n_type == <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>)
<a name="l00126"></a>00126 <span class="comment">// arete paroi_fluide :il faut determiner qui est la face fluide</span>
<a name="l00127"></a>00127               {
<a name="l00128"></a>00128                 <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(inco[fac1],0))
<a name="l00129"></a>00129                   vit_imp = <a class="code" href="classChamp__Face.html#a613ea150dbc6a9b5f288011f90484381">val_imp_face_bord_private</a>(rang2,ori3);
<a name="l00130"></a>00130                 <span class="keywordflow">else</span>
<a name="l00131"></a>00131                   vit_imp = <a class="code" href="classChamp__Face.html#a613ea150dbc6a9b5f288011f90484381">val_imp_face_bord_private</a>(rang1,ori3);
<a name="l00132"></a>00132               }
<a name="l00133"></a>00133             <span class="keywordflow">else</span>
<a name="l00134"></a>00134               vit_imp = 0.5*(<a class="code" href="classChamp__Face.html#a613ea150dbc6a9b5f288011f90484381">val_imp_face_bord_private</a>(rang1,ori3)+
<a name="l00135"></a>00135                              <a class="code" href="classChamp__Face.html#a613ea150dbc6a9b5f288011f90484381">val_imp_face_bord_private</a>(rang2,ori3));
<a name="l00136"></a>00136 
<a name="l00137"></a>00137             <span class="keywordflow">if</span> (ori1 == 0) <span class="comment">//!&lt; bord d&#39;equation R = cte</span>
<a name="l00138"></a>00138 <span class="comment"></span>              {
<a name="l00139"></a>00139                 dist3 = xv(fac3,0) - xv(fac1,0);
<a name="l00140"></a>00140                 <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00141"></a>00141                   dist3 *= 2;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143                 <span class="keywordflow">if</span> (ori3 == 1)
<a name="l00144"></a>00144                   {
<a name="l00145"></a>00145 <span class="comment">// calcul de tau12</span>
<a name="l00146"></a>00146                     <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,0) = signe*(vit_imp-inco[fac3])/dist3;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 <span class="comment">// calcul de tau21</span>
<a name="l00149"></a>00149                     R = xv(fac1,0);
<a name="l00150"></a>00150                     d_teta = xv(fac2,1) - xv(fac1,1);
<a name="l00151"></a>00151                     <span class="keywordflow">if</span>  (d_teta &lt; 0)
<a name="l00152"></a>00152                       d_teta += deux_pi;
<a name="l00153"></a>00153                     <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,1) = (inco[fac2]-inco[fac1])/(R*d_teta);
<a name="l00154"></a>00154                   }
<a name="l00155"></a>00155                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3 == 2)
<a name="l00156"></a>00156                   {
<a name="l00157"></a>00157 <span class="comment">// calcul de tau13</span>
<a name="l00158"></a>00158                     <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,0) = signe*(vit_imp-inco[fac3])/dist3;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="comment">// calcul de tau31</span>
<a name="l00161"></a>00161                     <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,1) = (inco[fac2]-inco[fac1])/(xv(fac2,2)-xv(fac1,2));
<a name="l00162"></a>00162 
<a name="l00163"></a>00163                   }
<a name="l00164"></a>00164 
<a name="l00165"></a>00165               }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori1 == 1) <span class="comment">//!&lt; bord d&#39;equation teta = cte</span>
<a name="l00168"></a>00168 <span class="comment"></span>              {
<a name="l00169"></a>00169                 R = xv(fac3,0);
<a name="l00170"></a>00170                 d_teta = xv(fac3,1) - xv(fac1,1);
<a name="l00171"></a>00171                 <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00172"></a>00172                   d_teta += deux_pi;
<a name="l00173"></a>00173                 dist3  = R*d_teta;
<a name="l00174"></a>00174                 <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00175"></a>00175                   dist3 *= 2;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177                 <span class="keywordflow">if</span> (ori3 == 0)
<a name="l00178"></a>00178                   {
<a name="l00179"></a>00179 <span class="comment">// calcul de tau21</span>
<a name="l00180"></a>00180                     <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,0) = signe*(vit_imp-inco[fac3])/dist3
<a name="l00181"></a>00181                                               - 0.5*(inco[fac1]+inco[fac2])/R;
<a name="l00182"></a>00182 <span class="comment">// calcul de tau12</span>
<a name="l00183"></a>00183                     <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,1) = (inco[fac2]-inco[fac1])/(xv(fac2,0) - xv(fac1,0));
<a name="l00184"></a>00184 
<a name="l00185"></a>00185                   }
<a name="l00186"></a>00186                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3 == 2)
<a name="l00187"></a>00187                   {
<a name="l00188"></a>00188 <span class="comment">// calcul de tau23</span>
<a name="l00189"></a>00189                     <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,0) = signe*(vit_imp-inco[fac3])/dist3;
<a name="l00190"></a>00190 <span class="comment">// calcul de tau32</span>
<a name="l00191"></a>00191                     <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,1) = (inco[fac2]-inco[fac1])/(xv(fac2,2) - xv(fac1,2));
<a name="l00192"></a>00192                   }
<a name="l00193"></a>00193               }
<a name="l00194"></a>00194             <span class="keywordflow">else</span> <span class="comment">//!&lt; (ori1 == 2) bord d&#39;equation Z = cte</span>
<a name="l00195"></a>00195 <span class="comment"></span>              {
<a name="l00196"></a>00196                 dist3 = xv(fac3,2)-xv(fac1,2);
<a name="l00197"></a>00197                 <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00198"></a>00198                   dist3 *= 2;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200                 <span class="keywordflow">if</span> (ori3 == <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00201"></a>00201                   {
<a name="l00202"></a>00202 <span class="comment">// calcul de tau31</span>
<a name="l00203"></a>00203                     <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,0) = signe*(vit_imp-inco[fac3])/dist3;
<a name="l00204"></a>00204 <span class="comment">// calcul de tau13</span>
<a name="l00205"></a>00205                     <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,1) = (inco[fac2]-inco[fac1])/(xv(fac2,0) - xv(fac1,0));
<a name="l00206"></a>00206                   }
<a name="l00207"></a>00207                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3 == 1)
<a name="l00208"></a>00208                   {
<a name="l00209"></a>00209 <span class="comment">// calcul de tau32</span>
<a name="l00210"></a>00210                     <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,0) = signe*(vit_imp-inco[fac3])/dist3;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="comment">// calcul de tau23</span>
<a name="l00213"></a>00213                     R = xv(fac1,0);
<a name="l00214"></a>00214                     d_teta = xv(fac2,1) - xv(fac1,1);
<a name="l00215"></a>00215                     <span class="keywordflow">if</span>  (d_teta &lt; 0)
<a name="l00216"></a>00216                       d_teta += deux_pi;
<a name="l00217"></a>00217                     <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,1) = (inco[fac2]-inco[fac1])/(R*d_teta);
<a name="l00218"></a>00218                   }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220               }
<a name="l00221"></a>00221             <span class="keywordflow">break</span>;
<a name="l00222"></a>00222           }
<a name="l00223"></a>00223         <span class="keywordflow">case</span> 3:
<a name="l00224"></a>00224           {
<a name="l00225"></a>00225 <span class="comment">// symetrie-symetrie</span>
<a name="l00226"></a>00226 <span class="comment">// pas de flux diffusif calcule</span>
<a name="l00227"></a>00227             <span class="keywordflow">break</span>;
<a name="l00228"></a>00228           }
<a name="l00229"></a>00229         <span class="keywordflow">default</span> :
<a name="l00230"></a>00230           {
<a name="l00231"></a>00231             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l00232"></a>00232             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l00233"></a>00233             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l00234"></a>00234             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00235"></a>00235             <span class="keywordflow">break</span>;
<a name="l00236"></a>00236           }
<a name="l00237"></a>00237         }
<a name="l00238"></a>00238     }
<a name="l00239"></a>00239 
<a name="l00240"></a>00240 <span class="comment">// Boucle sur les aretes mixtes et internes</span>
<a name="l00241"></a>00241 
<a name="l00242"></a>00242   ndeb = zone_VDF.<a class="code" href="classZone__VDF.html#a1197e179e848063721cdf2121837bbc6">premiere_arete_mixte</a>();
<a name="l00243"></a>00243   nfin = zone_VDF.<a class="code" href="classZone__VDF.html#add0341183f527326bc526c92bbb19225">nb_aretes</a>();
<a name="l00244"></a>00244 
<a name="l00245"></a>00245   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l00246"></a>00246     {
<a name="l00247"></a>00247 
<a name="l00248"></a>00248       fac1=Qdm(n_arete,0);
<a name="l00249"></a>00249       fac2=Qdm(n_arete,1);
<a name="l00250"></a>00250       fac3=Qdm(n_arete,2);
<a name="l00251"></a>00251       fac4=Qdm(n_arete,3);
<a name="l00252"></a>00252       ori1 = orientation(fac1);
<a name="l00253"></a>00253       ori3 = orientation(fac3);
<a name="l00254"></a>00254 
<a name="l00255"></a>00255       <span class="keywordflow">if</span> (ori1 == 1)  <span class="comment">//!&lt; (seule possibilite : ori3 =0)  Arete XY</span>
<a name="l00256"></a>00256 <span class="comment"></span>        {
<a name="l00257"></a>00257 <span class="comment">// Calcul de tau21</span>
<a name="l00258"></a>00258           R = xv(fac3,0);
<a name="l00259"></a>00259           d_teta = xv(fac4,1) - xv(fac3,1);
<a name="l00260"></a>00260           <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00261"></a>00261             d_teta += deux_pi;
<a name="l00262"></a>00262           <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,1) = (inco(fac4)-inco(fac3))/(R*d_teta) - 0.5*(inco[fac1]+inco[fac2])/R;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 <span class="comment">// Calcul de tau12</span>
<a name="l00265"></a>00265           <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,0) = (inco(fac2)-inco(fac1))/(xv(fac2,0) - xv(fac1,0));
<a name="l00266"></a>00266 
<a name="l00267"></a>00267         }
<a name="l00268"></a>00268       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3 == 1) <span class="comment">//!&lt; (seule possibilite ori1 = 2) arete YZ</span>
<a name="l00269"></a>00269 <span class="comment"></span>        {
<a name="l00270"></a>00270 
<a name="l00271"></a>00271 <span class="comment">// Calcul de tau32</span>
<a name="l00272"></a>00272           <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,1) = (inco(fac4)-inco(fac3))/(xv(fac4,2) - xv(fac3,2));
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 <span class="comment">// Calcul de tau23</span>
<a name="l00275"></a>00275           R = xv(fac1,0);
<a name="l00276"></a>00276           d_teta = xv(fac2,1) - xv(fac1,1);
<a name="l00277"></a>00277           <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00278"></a>00278             d_teta += deux_pi;
<a name="l00279"></a>00279           <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,0) = (inco(fac2)-inco(fac1))/(R*d_teta);
<a name="l00280"></a>00280 
<a name="l00281"></a>00281         }
<a name="l00282"></a>00282       <span class="keywordflow">else</span> <span class="comment">//!&lt; seule possibilite ori1 = 2 et ori3 = 0:  arete XZ</span>
<a name="l00283"></a>00283 <span class="comment"></span>        {
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 <span class="comment">// Calcul de tau31</span>
<a name="l00286"></a>00286           <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,1) = (inco(fac4)-inco(fac3))/(xv(fac4,2) - xv(fac3,2));
<a name="l00287"></a>00287 
<a name="l00288"></a>00288 <span class="comment">// Calcul de tau13</span>
<a name="l00289"></a>00289           <a class="code" href="classChamp__Face.html#a5706b082facc8da2b44e61d89d36f151" title="termes extradiagonaux du tenseur Grad">tau_croises_</a>(n_arete,0) = (inco(fac2)-inco(fac1))/(xv(fac2,0) - xv(fac1,0));
<a name="l00290"></a>00290 
<a name="l00291"></a>00291         }
<a name="l00292"></a>00292 
<a name="l00293"></a>00293     }
<a name="l00294"></a>00294 }
<a name="l00295"></a>00295 
<a name="l00296"></a><a class="code" href="Champ__Face2_8cpp.html#a512370921074e5bfcbf1b38068b0c7ab">00296</a> <span class="keywordtype">void</span> <a class="code" href="Champ__Face2_8cpp.html#a512370921074e5bfcbf1b38068b0c7ab">calcul_interne2D</a>(<span class="keywordtype">int</span> num_elem,
<a name="l00297"></a>00297                       <span class="keywordtype">int</span> elx0,<span class="keywordtype">int</span> elx1,
<a name="l00298"></a>00298                       <span class="keywordtype">int</span> ely0,<span class="keywordtype">int</span> ely1,
<a name="l00299"></a>00299                       <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF,<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val,<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rot)
<a name="l00300"></a>00300 {
<a name="l00301"></a>00301   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00302"></a>00302   <span class="keywordtype">double</span> delta_x_0,delta_x_1,delta_y_0,delta_y_1;
<a name="l00303"></a>00303   <span class="keywordtype">double</span> delta_x,delta_y;
<a name="l00304"></a>00304   <span class="keywordtype">double</span> deriv_vx,deriv_uy;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306   deriv_vx = 0;
<a name="l00307"></a>00307   deriv_uy = 0;
<a name="l00308"></a>00308 
<a name="l00309"></a>00309   delta_x_0 = zone_VDF.<a class="code" href="classZone__VDF.html#a79bbd491752b86e5a186e50c9e5f8656">dist_elem_period</a>(num_elem,elx0,0);
<a name="l00310"></a>00310   delta_x_1 = zone_VDF.<a class="code" href="classZone__VDF.html#a79bbd491752b86e5a186e50c9e5f8656">dist_elem_period</a>(elx1,num_elem,0);
<a name="l00311"></a>00311   delta_y_0 = zone_VDF.<a class="code" href="classZone__VDF.html#a79bbd491752b86e5a186e50c9e5f8656">dist_elem_period</a>(num_elem,ely0,1);
<a name="l00312"></a>00312   delta_y_1 = zone_VDF.<a class="code" href="classZone__VDF.html#a79bbd491752b86e5a186e50c9e5f8656">dist_elem_period</a>(ely1,num_elem,1);
<a name="l00313"></a>00313 
<a name="l00314"></a>00314   delta_x = (delta_x_1-delta_x_0)*(delta_x_1+delta_x_0)/(delta_x_1*delta_x_0);
<a name="l00315"></a>00315   delta_y = (delta_y_1-delta_y_0)*(delta_y_1+delta_y_0)/(delta_y_1*delta_y_0);
<a name="l00316"></a>00316 
<a name="l00317"></a>00317   deriv_vx = (delta_x_0/delta_x_1*val(elem_faces(elx1,1))
<a name="l00318"></a>00318               + delta_x*val(elem_faces(num_elem,1))
<a name="l00319"></a>00319               - delta_x_1/delta_x_0*val(elem_faces(elx0,1)));
<a name="l00320"></a>00320   deriv_vx += (delta_x_0/delta_x_1*val(elem_faces(elx1,3))
<a name="l00321"></a>00321                + delta_x*val(elem_faces(num_elem,3))
<a name="l00322"></a>00322                - delta_x_1/delta_x_0*val(elem_faces(elx0,3)));
<a name="l00323"></a>00323   deriv_vx *= 0.5/(delta_x_0 + delta_x_1);
<a name="l00324"></a>00324 
<a name="l00325"></a>00325   deriv_uy = (delta_y_0/delta_y_1*val(elem_faces(ely1,0))
<a name="l00326"></a>00326               + delta_y*val(elem_faces(num_elem,0))
<a name="l00327"></a>00327               - delta_y_1/delta_y_0*val(elem_faces(ely0,0)));
<a name="l00328"></a>00328   deriv_uy += (delta_y_0/delta_y_1*val(elem_faces(ely1,2))
<a name="l00329"></a>00329                + delta_y*val(elem_faces(num_elem,2))
<a name="l00330"></a>00330                - delta_y_1/delta_y_0*val(elem_faces(ely0,2)));
<a name="l00331"></a>00331   deriv_uy *= 0.5/(delta_y_0 + delta_y_1);
<a name="l00332"></a>00332 
<a name="l00333"></a>00333   rot[num_elem] = deriv_vx - deriv_uy;
<a name="l00334"></a>00334 
<a name="l00335"></a>00335 }
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 
<a name="l00338"></a><a class="code" href="Champ__Face2_8cpp.html#ad284df16f05d7539b32fb2c14fd055ac">00338</a> <span class="keywordtype">void</span> <a class="code" href="Champ__Face2_8cpp.html#ad284df16f05d7539b32fb2c14fd055ac">calcul_bord2D</a>(<span class="keywordtype">int</span> num_elem,
<a name="l00339"></a>00339                    <span class="keywordtype">int</span> elx0,<span class="keywordtype">int</span> elx1,
<a name="l00340"></a>00340                    <span class="keywordtype">int</span> ely0,<span class="keywordtype">int</span> ely1,
<a name="l00341"></a>00341                    <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF,<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val,<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rot)
<a name="l00342"></a>00342 {
<a name="l00343"></a>00343   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00344"></a>00344   <span class="keywordtype">double</span> delta_x_0,delta_x_1,delta_y_0,delta_y_1;
<a name="l00345"></a>00345   <span class="keywordtype">double</span> delta_x,delta_y;
<a name="l00346"></a>00346   <span class="keywordtype">double</span> deriv_vx,deriv_uy;
<a name="l00347"></a>00347 
<a name="l00348"></a>00348   deriv_vx = 0;
<a name="l00349"></a>00349   deriv_uy = 0;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 <span class="comment">// Traitement des elements bord</span>
<a name="l00352"></a>00352   <span class="keywordflow">if</span> ( (elx0 == -1) || (elx1 == -1) )
<a name="l00353"></a>00353     {
<a name="l00354"></a>00354       <span class="keywordflow">if</span> (elx0 == -1)
<a name="l00355"></a>00355         {
<a name="l00356"></a>00356           <span class="keywordflow">if</span> (elx1 != -1)
<a name="l00357"></a>00357             {
<a name="l00358"></a>00358               delta_x_1 = zone_VDF.<a class="code" href="classZone__VDF.html#a79bbd491752b86e5a186e50c9e5f8656">dist_elem_period</a>(elx1,num_elem,0);
<a name="l00359"></a>00359               deriv_vx = (val(elem_faces(elx1,1))-val(elem_faces(num_elem,1))
<a name="l00360"></a>00360                           + val(elem_faces(elx1,3))-val(elem_faces(num_elem,3)));
<a name="l00361"></a>00361               deriv_vx *= 0.5/delta_x_1;
<a name="l00362"></a>00362 
<a name="l00363"></a>00363             }
<a name="l00364"></a>00364           <span class="keywordflow">else</span>
<a name="l00365"></a>00365             deriv_vx = 0;
<a name="l00366"></a>00366         }
<a name="l00367"></a>00367       <span class="keywordflow">else</span> <span class="comment">//!&lt; elx1 = -1 et elx0 != -1</span>
<a name="l00368"></a>00368 <span class="comment"></span>        {
<a name="l00369"></a>00369           delta_x_0 = zone_VDF.<a class="code" href="classZone__VDF.html#a79bbd491752b86e5a186e50c9e5f8656">dist_elem_period</a>(num_elem,elx0,0);
<a name="l00370"></a>00370           deriv_vx = (val(elem_faces(num_elem,1))-val(elem_faces(elx0,1))
<a name="l00371"></a>00371                       + val(elem_faces(num_elem,3))-val(elem_faces(elx0,3)));
<a name="l00372"></a>00372           deriv_vx *= 0.5/delta_x_0;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374         }
<a name="l00375"></a>00375     }
<a name="l00376"></a>00376   <span class="keywordflow">else</span> <span class="comment">//!&lt; elx0 != -1 et elx1 != -1</span>
<a name="l00377"></a>00377 <span class="comment"></span>    {
<a name="l00378"></a>00378       delta_x_0 = zone_VDF.<a class="code" href="classZone__VDF.html#a79bbd491752b86e5a186e50c9e5f8656">dist_elem_period</a>(num_elem,elx0,0);
<a name="l00379"></a>00379       delta_x_1 = zone_VDF.<a class="code" href="classZone__VDF.html#a79bbd491752b86e5a186e50c9e5f8656">dist_elem_period</a>(elx1,num_elem,0);
<a name="l00380"></a>00380       delta_x = (delta_x_1-delta_x_0)*(delta_x_1+delta_x_0)/(delta_x_1*delta_x_0);
<a name="l00381"></a>00381       deriv_vx = (delta_x_0/delta_x_1*val(elem_faces(elx1,1))
<a name="l00382"></a>00382                   + delta_x*val(elem_faces(num_elem,1))
<a name="l00383"></a>00383                   - delta_x_1/delta_x_0*val(elem_faces(elx0,1)));
<a name="l00384"></a>00384       deriv_vx += (delta_x_0/delta_x_1*val(elem_faces(elx1,3))
<a name="l00385"></a>00385                    + delta_x*val(elem_faces(num_elem,3))
<a name="l00386"></a>00386                    - delta_x_1/delta_x_0*val(elem_faces(elx0,3)));
<a name="l00387"></a>00387       deriv_vx *= 0.5/(delta_x_0 + delta_x_1);
<a name="l00388"></a>00388 
<a name="l00389"></a>00389     }
<a name="l00390"></a>00390 
<a name="l00391"></a>00391   <span class="keywordflow">if</span> ( (ely0 == -1) || (ely1 == -1) )
<a name="l00392"></a>00392     {
<a name="l00393"></a>00393       <span class="keywordflow">if</span> (ely0 == -1)
<a name="l00394"></a>00394         {
<a name="l00395"></a>00395           <span class="keywordflow">if</span> (ely1 != -1)
<a name="l00396"></a>00396             {
<a name="l00397"></a>00397               delta_y_1 = zone_VDF.<a class="code" href="classZone__VDF.html#a79bbd491752b86e5a186e50c9e5f8656">dist_elem_period</a>(ely1,num_elem,1);
<a name="l00398"></a>00398               deriv_uy = (val(elem_faces(ely1,0))-val(elem_faces(num_elem,0))
<a name="l00399"></a>00399                           + val(elem_faces(ely1,2))-val(elem_faces(num_elem,2)));
<a name="l00400"></a>00400               deriv_uy *= 0.5/delta_y_1;
<a name="l00401"></a>00401 
<a name="l00402"></a>00402             }
<a name="l00403"></a>00403           <span class="keywordflow">else</span>
<a name="l00404"></a>00404             deriv_uy = 0;
<a name="l00405"></a>00405         }
<a name="l00406"></a>00406       <span class="keywordflow">else</span> <span class="comment">//!&lt; ely1 = -1 et ely0 != -1</span>
<a name="l00407"></a>00407 <span class="comment"></span>        {
<a name="l00408"></a>00408           delta_y_0 = zone_VDF.<a class="code" href="classZone__VDF.html#a79bbd491752b86e5a186e50c9e5f8656">dist_elem_period</a>(num_elem,ely0,1);
<a name="l00409"></a>00409           deriv_uy = (val(elem_faces(num_elem,0))-val(elem_faces(ely0,0))
<a name="l00410"></a>00410                       + val(elem_faces(num_elem,2))-val(elem_faces(ely0,2)));
<a name="l00411"></a>00411           deriv_uy *= 0.5/delta_y_0;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413         }
<a name="l00414"></a>00414     }
<a name="l00415"></a>00415   <span class="keywordflow">else</span>  <span class="comment">//!&lt; ely0 != -1 et ely1 != -1</span>
<a name="l00416"></a>00416 <span class="comment"></span>    {
<a name="l00417"></a>00417       delta_y_0 = zone_VDF.<a class="code" href="classZone__VDF.html#a79bbd491752b86e5a186e50c9e5f8656">dist_elem_period</a>(num_elem,ely0,1);
<a name="l00418"></a>00418       delta_y_1 = zone_VDF.<a class="code" href="classZone__VDF.html#a79bbd491752b86e5a186e50c9e5f8656">dist_elem_period</a>(ely1,num_elem,1);
<a name="l00419"></a>00419       delta_y = (delta_y_1-delta_y_0)*(delta_y_1+delta_y_0)/(delta_y_1*delta_y_0);
<a name="l00420"></a>00420 
<a name="l00421"></a>00421       deriv_uy = (delta_y_0/delta_y_1*val(elem_faces(ely1,0))
<a name="l00422"></a>00422                   + delta_y*val(elem_faces(num_elem,0))
<a name="l00423"></a>00423                   - delta_y_1/delta_y_0*val(elem_faces(ely0,0)));
<a name="l00424"></a>00424       deriv_uy += (delta_y_0/delta_y_1*val(elem_faces(ely1,2))
<a name="l00425"></a>00425                    + delta_y*val(elem_faces(num_elem,2))
<a name="l00426"></a>00426                    - delta_y_1/delta_y_0*val(elem_faces(ely0,2)));
<a name="l00427"></a>00427       deriv_uy *= 0.5/(delta_y_0 + delta_y_1);
<a name="l00428"></a>00428 
<a name="l00429"></a>00429     }
<a name="l00430"></a>00430 
<a name="l00431"></a>00431   rot[num_elem] = deriv_vx - deriv_uy;
<a name="l00432"></a>00432 }
<a name="l00433"></a>00433 
<a name="l00434"></a><a class="code" href="Champ__Face3_8cpp.html#a55b486be8c7ed3ced7518eb23eb1a2a7">00434</a> <span class="keywordtype">void</span> <a class="code" href="Champ__Face2_8cpp.html#a55b486be8c7ed3ced7518eb23eb1a2a7">calrotord2centelemdim2</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rot,
<a name="l00435"></a>00435                             <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val, <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF,
<a name="l00436"></a>00436                             <span class="keywordtype">int</span> nb_elem, <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins,
<a name="l00437"></a>00437                             <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces)
<a name="l00438"></a>00438 {
<a name="l00439"></a>00439   <span class="keywordflow">if</span>(rot.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)!=nb_elem)
<a name="l00440"></a>00440     rot.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_elem);
<a name="l00441"></a>00441   <span class="keywordtype">int</span> elx0,elx1,ely0,ely1;
<a name="l00442"></a>00442 
<a name="l00443"></a>00443   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elem; num_elem++)
<a name="l00444"></a>00444     {
<a name="l00445"></a>00445       elx0 = face_voisins(elem_faces(num_elem,0),0);
<a name="l00446"></a>00446       elx1 = face_voisins(elem_faces(num_elem,2),1);
<a name="l00447"></a>00447       ely0 = face_voisins(elem_faces(num_elem,1),0);
<a name="l00448"></a>00448       ely1 = face_voisins(elem_faces(num_elem,3),1);
<a name="l00449"></a>00449 
<a name="l00450"></a>00450       <span class="keywordflow">if</span> ( (elx0 != -1) &amp;&amp; (elx1 != -1) &amp;&amp; (ely0 != -1)
<a name="l00451"></a>00451            &amp;&amp; (ely1 != -1))
<a name="l00452"></a>00452 <span class="comment">// Cas d&#39;un element interne</span>
<a name="l00453"></a>00453 
<a name="l00454"></a>00454         <a class="code" href="Champ__Face2_8cpp.html#a512370921074e5bfcbf1b38068b0c7ab">calcul_interne2D</a>(num_elem,elx0,elx1,ely0,ely1,zone_VDF,val,rot);
<a name="l00455"></a>00455       <span class="keywordflow">else</span>
<a name="l00456"></a>00456         <a class="code" href="Champ__Face2_8cpp.html#ad284df16f05d7539b32fb2c14fd055ac">calcul_bord2D</a>(num_elem,elx0,elx1,ely0,ely1,zone_VDF,val,rot);
<a name="l00457"></a>00457     }
<a name="l00458"></a>00458 }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:37 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
