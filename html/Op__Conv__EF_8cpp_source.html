<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/EF/Operateurs/Op_Conv_EF.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/EF/Operateurs/Op_Conv_EF.cpp</div>  </div>
</div>
<div class="contents">
<a href="Op__Conv__EF_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Op_Conv_EF.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/EF/Operateurs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/23</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 <span class="comment">// </span>
<a name="l00023"></a>00023 <span class="comment">// WARNING: DO NOT EDIT THIS FILE! Only edit the template file Op_Conv_EF.cpp.P</span>
<a name="l00024"></a>00024 <span class="comment">// </span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Op__Conv__EF_8h.html">Op_Conv_EF.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps__base_8h.html">Schema_Temps_base.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Param_8h.html">Param.h</a>&gt;</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Op__Diff__EF_8h.html">Op_Diff_EF.h</a>&gt;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="Op__Conv__EF_8cpp.html#a453574a7f31aafcdbe5881eda391d87c">00034</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classOp__Conv__EF.html" title="class Op_Conv_EF Cette classe represente l&#39;operateur de convection associe a une equation de transpor...">Op_Conv_EF</a>,<span class="stringliteral">&quot;Op_Conv_Generic_EF&quot;</span>,<a class="code" href="classOp__Conv__EF__base.html" title="class Op_Conv_EF_base Classe de base des operateurs de convection EF">Op_Conv_EF_base</a>);
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="classOp__Conv__EF.html#ad8039ec07b604ef3196d87554859f0fb">00036</a> <a class="code" href="classOp__Conv__EF.html#ad8039ec07b604ef3196d87554859f0fb">Op_Conv_EF::Op_Conv_EF</a>(): hourglass(0.),hourglass_impl_(0),btd_impl_(0),centre_impl_(0), hourglass_hors_conv_(0),btd_hors_conv_(0),f_lu_(-1.),calcul_dt_stab_(0)
<a name="l00037"></a>00037 {
<a name="l00038"></a>00038 }
<a name="l00039"></a>00039 
<a name="l00040"></a><a class="code" href="Op__Conv__EF_8cpp.html#a9f63bb639fceefc6fed64727daca1d79">00040</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classOp__Conv__BTD__EF.html">Op_Conv_BTD_EF</a>,<span class="stringliteral">&quot;Op_Conv_BTD_EF&quot;</span>,<a class="code" href="classOp__Conv__EF.html" title="class Op_Conv_EF Cette classe represente l&#39;operateur de convection associe a une equation de transpor...">Op_Conv_EF</a>);
<a name="l00041"></a><a class="code" href="classOp__Conv__BTD__EF.html#a57a2d9db471772c1b89bbb12e49efbd8">00041</a> <a class="code" href="classOp__Conv__BTD__EF.html#a57a2d9db471772c1b89bbb12e49efbd8">Op_Conv_BTD_EF::Op_Conv_BTD_EF</a>() : <a class="code" href="classOp__Conv__EF.html" title="class Op_Conv_EF Cette classe represente l&#39;operateur de convection associe a une equation de transpor...">Op_Conv_EF</a>()
<a name="l00042"></a>00042 {
<a name="l00043"></a>00043   <a class="code" href="classOp__Conv__EF.html#a1678395576cd863d74af0bdada354c3b">calcul_dt_stab_</a>=2;
<a name="l00044"></a>00044   <a class="code" href="classOp__Conv__EF.html#af6b1073d41da2d3fabb35ef12923cb0c">type_op</a> = <a class="code" href="classOp__Conv__EF.html#ab9734112d198e5e32e51e1efd1a9b75da3cab344cce2439325cbbaf941192caa8">amont</a>;
<a name="l00045"></a>00045   <a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>=1;
<a name="l00046"></a>00046   <a class="code" href="classOp__Conv__EF.html#ad3db522667ddc56c48ed6e9e74c11606">hourglass_impl_</a>=1;
<a name="l00047"></a>00047   <a class="code" href="classOp__Conv__EF.html#aad213768e53dd2ead0ac9f0554300bfb">btd_impl_</a>=1;
<a name="l00048"></a>00048   <a class="code" href="classOp__Conv__EF.html#a0849a62e83511b82512742ded6db229a" title="flag pour savoir si les termes sont implicites">centre_impl_</a>=1;
<a name="l00049"></a>00049   <a class="code" href="classOp__Conv__EF.html#a92cfa1fb25cc3c4e08407f73803d7ee9">btd_hors_conv_</a>=1;
<a name="l00050"></a>00050   <a class="code" href="classOp__Conv__EF.html#a0fd689419f4b31be5dda6d2e1b29f6cb">hourglass_hors_conv_</a>=1;
<a name="l00051"></a>00051 }
<a name="l00052"></a><a class="code" href="classOp__Conv__BTD__EF.html#a4dfe0b8cb862526acc8dbb7973d2468e">00052</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Conv__BTD__EF.html#a4dfe0b8cb862526acc8dbb7973d2468e" title="Associe l&#39;operateur a la zone_dis, la zone_Cl_dis, et a l&#39;inconnue de son equation.">Op_Conv_BTD_EF::completer</a>()
<a name="l00053"></a>00053 {
<a name="l00054"></a>00054 <span class="comment">// pour ne pas mettre les flags automatiquement</span>
<a name="l00055"></a>00055   <a class="code" href="classOp__Conv__BTD__EF.html#a4dfe0b8cb862526acc8dbb7973d2468e" title="Associe l&#39;operateur a la zone_dis, la zone_Cl_dis, et a l&#39;inconnue de son equation.">Op_Conv_EF_base::completer</a>();
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 }
<a name="l00058"></a><a class="code" href="classOp__Conv__BTD__EF.html#a7f2c32b1675b7bc106534c8b967cfaca">00058</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classOp__Conv__BTD__EF.html#a7f2c32b1675b7bc106534c8b967cfaca" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Conv_BTD_EF::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00059"></a>00059 <span class="keyword"></span>{
<a name="l00060"></a>00060   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() ;
<a name="l00061"></a>00061 }
<a name="l00062"></a><a class="code" href="classOp__Conv__BTD__EF.html#af6705b81e8ebffc122576b9ffba4f848">00062</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classOp__Conv__BTD__EF.html#af6705b81e8ebffc122576b9ffba4f848" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Conv_BTD_EF::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s )
<a name="l00063"></a>00063 {
<a name="l00064"></a>00064   <a class="code" href="classParam.html" title="Defined below in this file.">Param</a> param(<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()); <span class="comment">//!&lt; XD convection_btd convection_deriv btd 1 Only for EF discretization.</span>
<a name="l00065"></a>00065 <span class="comment"></span>  param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;btd&quot;</span>,&amp;<a class="code" href="classOp__Conv__EF.html#a9ac703b912c82db19c86f97ede4d749d">btd_</a>,<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384aaf5b6dfac1c5970478525407cc6ac572">Param::REQUIRED</a>); <span class="comment">//!&lt; XD_ADD_P double not_set</span>
<a name="l00066"></a>00066 <span class="comment"></span>  param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;facteur&quot;</span>,&amp;<a class="code" href="classOp__Conv__BTD__EF.html#a435785fb198d1dde368729db381db3f9">facteur_</a>,<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384aaf5b6dfac1c5970478525407cc6ac572">Param::REQUIRED</a>);  <span class="comment">//!&lt; XD_ADD_P double not_set</span>
<a name="l00067"></a>00067 <span class="comment"></span>
<a name="l00068"></a>00068   param.<a class="code" href="classParam.html#aea52f16d3b74c59c48cb5708ff48f14a">lire_avec_accolades</a>(s);
<a name="l00069"></a>00069   <span class="keywordflow">return</span> s;
<a name="l00070"></a>00070 }
<a name="l00071"></a>00071 
<a name="l00072"></a><a class="code" href="classOp__Conv__BTD__EF.html#a8819d0aebb5e933ca4fb261496386562">00072</a> <span class="keywordtype">double</span> <a class="code" href="classOp__Conv__BTD__EF.html#a8819d0aebb5e933ca4fb261496386562">Op_Conv_BTD_EF::coefficient_btd</a>()<span class="keyword"> const</span>
<a name="l00073"></a>00073 <span class="keyword"></span>{
<a name="l00074"></a>00074   <span class="keywordflow">if</span> (<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().equation_non_resolue())
<a name="l00075"></a>00075     <a class="code" href="classOp__Conv__EF.html#a47d7dbd31177020eef9e682fafe767f8" title="Calcul dt_stab.">calculer_dt_stab</a>();
<a name="l00076"></a>00076   <span class="keywordtype">double</span> f=<a class="code" href="classOperateur__Conv__base.html#a13cb02d4e31a7e61f7993282dae2268a">dt_stab_conv</a>()*<a class="code" href="classOp__Conv__BTD__EF.html#a435785fb198d1dde368729db381db3f9">facteur_</a>*<a class="code" href="classOp__Conv__EF.html#a9ac703b912c82db19c86f97ede4d749d">btd_</a>/2.;
<a name="l00077"></a>00077 <span class="comment">// Cerr&lt;&lt;&quot;ici btd &quot; &lt;&lt;f&lt;&lt;finl;</span>
<a name="l00078"></a>00078   <span class="keywordflow">return</span> f;
<a name="l00079"></a>00079 }<span class="comment"></span>
<a name="l00080"></a>00080 <span class="comment">////!&lt; printOn </span>
<a name="l00081"></a>00081 <span class="comment"></span><span class="comment">//</span>
<a name="l00082"></a><a class="code" href="classOp__Conv__EF.html#a39e280aa68788ded371fba87a4766c4c">00082</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classOp__Conv__EF.html#a39e280aa68788ded371fba87a4766c4c" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Conv_EF::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00083"></a>00083 <span class="keyword"></span>{
<a name="l00084"></a>00084   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() ;
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 <span class="comment"></span>
<a name="l00087"></a>00087 <span class="comment">////!&lt; readOn </span>
<a name="l00088"></a>00088 <span class="comment"></span><span class="comment">//</span>
<a name="l00089"></a><a class="code" href="classOp__Conv__EF.html#a867588a3d7783e1937136ba6a509306a">00089</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classOp__Conv__EF.html#a867588a3d7783e1937136ba6a509306a" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Conv_EF::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s )
<a name="l00090"></a>00090 {
<a name="l00091"></a>00091   <a class="code" href="classOp__Conv__EF.html#a9ac703b912c82db19c86f97ede4d749d">btd_</a>=3.;
<a name="l00092"></a>00092   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> type_op_lu;
<a name="l00093"></a>00093   s &gt;&gt; type_op_lu;
<a name="l00094"></a>00094 
<a name="l00095"></a>00095   <span class="keywordflow">if</span> (!(type_op_lu==<span class="stringliteral">&quot;amont&quot;</span>) &amp;&amp;  !(type_op_lu==<span class="stringliteral">&quot;centre&quot;</span>)  &amp;&amp;  !(type_op_lu==<span class="stringliteral">&quot;amont3&quot;</span>)&amp;&amp;!(type_op_lu==<span class="stringliteral">&quot;btd&quot;</span>))
<a name="l00096"></a>00096     {
<a name="l00097"></a>00097       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; type_op_lu &lt;&lt; <span class="stringliteral">&quot; n&#39;est pas compris par &quot;</span> &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00098"></a>00098       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; choisir parmi : amont -btd - centre &quot;</span> &lt;&lt; finl;
<a name="l00099"></a>00099       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00100"></a>00100     }
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 
<a name="l00103"></a>00103   <span class="keywordflow">if</span> (type_op_lu==<span class="stringliteral">&quot;centre&quot;</span>)
<a name="l00104"></a>00104     {
<a name="l00105"></a>00105       <a class="code" href="classOp__Conv__EF.html#af6b1073d41da2d3fabb35ef12923cb0c">type_op</a> = <a class="code" href="classOp__Conv__EF.html#ab9734112d198e5e32e51e1efd1a9b75da833f1aa6bfe72fc2320b1baf4e991957">centre</a>;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108 
<a name="l00109"></a>00109   <span class="keywordflow">if</span> ((type_op_lu==<span class="stringliteral">&quot;amont&quot;</span>)||(type_op_lu==<span class="stringliteral">&quot;amont3&quot;</span>)||(type_op_lu==<span class="stringliteral">&quot;btd&quot;</span>))
<a name="l00110"></a>00110     {
<a name="l00111"></a>00111       <a class="code" href="classOp__Conv__EF.html#af6b1073d41da2d3fabb35ef12923cb0c">type_op</a> = <a class="code" href="classOp__Conv__EF.html#ab9734112d198e5e32e51e1efd1a9b75da3cab344cce2439325cbbaf941192caa8">amont</a>;
<a name="l00112"></a>00112     }
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="keywordflow">if</span> ((<a class="code" href="classOp__Conv__EF.html#af6b1073d41da2d3fabb35ef12923cb0c">type_op</a>==<a class="code" href="classOp__Conv__EF.html#ab9734112d198e5e32e51e1efd1a9b75da3cab344cce2439325cbbaf941192caa8">amont</a>)
<a name="l00116"></a>00116       &amp;&amp;  (type_op_lu!=<span class="stringliteral">&quot;amont2&quot;</span>))
<a name="l00117"></a>00117     {
<a name="l00118"></a>00118       <a class="code" href="classOp__Conv__EF.html#a327e97302d9067603701c1fd50acedc1">f_lu_</a>=0.036585;
<a name="l00119"></a>00119       <a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>=1;
<a name="l00120"></a>00120       <a class="code" href="classOp__Conv__EF.html#ad3db522667ddc56c48ed6e9e74c11606">hourglass_impl_</a>=1;
<a name="l00121"></a>00121       <a class="code" href="classOp__Conv__EF.html#aad213768e53dd2ead0ac9f0554300bfb">btd_impl_</a>=1;
<a name="l00122"></a>00122       <a class="code" href="classOp__Conv__EF.html#a0849a62e83511b82512742ded6db229a" title="flag pour savoir si les termes sont implicites">centre_impl_</a>=1;
<a name="l00123"></a>00123     }
<a name="l00124"></a>00124   <span class="keywordflow">if</span> (type_op_lu==<span class="stringliteral">&quot;amont3&quot;</span>)
<a name="l00125"></a>00125     {
<a name="l00126"></a>00126       s &gt;&gt; <a class="code" href="classOp__Conv__EF.html#a327e97302d9067603701c1fd50acedc1">f_lu_</a>;
<a name="l00127"></a>00127 <span class="comment">// decommente  les 2 lognes</span>
<a name="l00128"></a>00128 <span class="comment">// centre_impl_=0;</span>
<a name="l00129"></a>00129 <span class="comment">// calcul_dt_stab_=1;</span>
<a name="l00130"></a>00130     }
<a name="l00131"></a>00131   <span class="keywordflow">if</span>  (type_op_lu==<span class="stringliteral">&quot;btd&quot;</span>)
<a name="l00132"></a>00132     <a class="code" href="classOp__Conv__EF.html#a327e97302d9067603701c1fd50acedc1">f_lu_</a>=-1;
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 
<a name="l00135"></a>00135   <span class="keywordflow">return</span> s ;
<a name="l00136"></a>00136 }
<a name="l00137"></a><a class="code" href="classOp__Conv__EF.html#a7e4e8fefbf78da38579a960fff32c315">00137</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Conv__EF.html#a7e4e8fefbf78da38579a960fff32c315" title="Associe l&#39;operateur a la zone_dis, la zone_Cl_dis, et a l&#39;inconnue de son equation.">Op_Conv_EF::completer</a>()
<a name="l00138"></a>00138 {
<a name="l00139"></a>00139   <a class="code" href="classOp__Conv__EF.html#a7e4e8fefbf78da38579a960fff32c315" title="Associe l&#39;operateur a la zone_dis, la zone_Cl_dis, et a l&#39;inconnue de son equation.">Op_Conv_EF_base::completer</a>();
<a name="l00140"></a>00140   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classOp__Diff__EF.html" title="class Op_Diff_EF Cette classe represente l&#39;operateur de diffusion La discretisation est EF Le champ d...">Op_Diff_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(0).l_op_base()))
<a name="l00141"></a>00141     {
<a name="l00142"></a>00142       <span class="keywordflow">if</span> (<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().schema_temps().diffusion_implicite())
<a name="l00143"></a>00143         {
<a name="l00144"></a>00144           <a class="code" href="classOp__Conv__EF.html#a92cfa1fb25cc3c4e08407f73803d7ee9">btd_hors_conv_</a>=1;
<a name="l00145"></a>00145           <a class="code" href="classOp__Conv__EF.html#a0fd689419f4b31be5dda6d2e1b29f6cb">hourglass_hors_conv_</a>=1;
<a name="l00146"></a>00146           <a class="code" href="classOp__Conv__EF.html#a1678395576cd863d74af0bdada354c3b">calcul_dt_stab_</a>=2;
<a name="l00147"></a>00147         }
<a name="l00148"></a>00148     }
<a name="l00149"></a>00149   <span class="keywordflow">else</span>
<a name="l00150"></a>00150     {
<a name="l00151"></a>00151       <a class="code" href="classOp__Conv__EF.html#a92cfa1fb25cc3c4e08407f73803d7ee9">btd_hors_conv_</a>=0;
<a name="l00152"></a>00152       <a class="code" href="classOp__Conv__EF.html#a0fd689419f4b31be5dda6d2e1b29f6cb">hourglass_hors_conv_</a>=0;
<a name="l00153"></a>00153     }
<a name="l00154"></a>00154 
<a name="l00155"></a>00155 }
<a name="l00156"></a>00156 <span class="comment">// </span>
<a name="l00157"></a>00157 <span class="comment">// Fonctions de la classe Op_Conv_EF</span>
<a name="l00158"></a>00158 <span class="comment">// </span>
<a name="l00159"></a>00159 <span class="comment">//</span>
<a name="l00160"></a>00160 <span class="comment">// </span>
<a name="l00161"></a>00161 <span class="comment">// Implementation des fonctions</span>
<a name="l00162"></a>00162 <span class="comment">// </span>
<a name="l00163"></a>00163 <span class="comment">// de la classe Op_Conv_EF</span>
<a name="l00164"></a>00164 <span class="comment">// </span>
<a name="l00165"></a>00165 <span class="comment">//</span>
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 
<a name="l00169"></a><a class="code" href="classOp__Conv__EF.html#a0aa984ccd3b7d5f0668202fc4e60e6b3">00169</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Conv__EF.html#a0aa984ccd3b7d5f0668202fc4e60e6b3">Op_Conv_EF::ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte,
<a name="l00170"></a>00170                                <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00171"></a>00171 <span class="keyword"></span>{
<a name="l00172"></a>00172   <span class="keywordflow">return</span> <a class="code" href="classOp__Conv__EF.html#a843e2b2c4d9bc3de665260b077782d26">ajouter_sous_cond</a>(transporte,resu,<a class="code" href="classOp__Conv__EF.html#a92cfa1fb25cc3c4e08407f73803d7ee9">btd_hors_conv_</a>,<a class="code" href="classOp__Conv__EF.html#a0fd689419f4b31be5dda6d2e1b29f6cb">hourglass_hors_conv_</a>,0);
<a name="l00173"></a>00173 }
<a name="l00174"></a><a class="code" href="classOp__Conv__EF.html#a1ccdede1551793f39643a81bb0628fb3">00174</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Conv__EF.html#a1ccdede1551793f39643a81bb0628fb3">Op_Conv_EF::ajouter_a_la_diffusion</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte,
<a name="l00175"></a>00175                                               <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00176"></a>00176 <span class="keyword"></span>{
<a name="l00177"></a>00177   <span class="keywordflow">return</span> <a class="code" href="classOp__Conv__EF.html#a843e2b2c4d9bc3de665260b077782d26">ajouter_sous_cond</a>(transporte,resu,!<a class="code" href="classOp__Conv__EF.html#a92cfa1fb25cc3c4e08407f73803d7ee9">btd_hors_conv_</a>,!<a class="code" href="classOp__Conv__EF.html#a0fd689419f4b31be5dda6d2e1b29f6cb">hourglass_hors_conv_</a>,1);
<a name="l00178"></a>00178 }
<a name="l00179"></a>00179 
<a name="l00180"></a>00180 
<a name="l00181"></a><a class="code" href="classOp__Conv__EF.html#a8a2724583588026cbcf3a05ae541d0fc">00181</a> <span class="keywordtype">double</span> <a class="code" href="classOp__Conv__EF.html#a8a2724583588026cbcf3a05ae541d0fc">Op_Conv_EF::coefficient_btd</a>()<span class="keyword"> const</span>
<a name="l00182"></a>00182 <span class="keyword"></span>{
<a name="l00183"></a>00183   <span class="keywordtype">double</span> dt=<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l00184"></a>00184   <span class="keywordtype">double</span> f=(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>)*dt/(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>-1);
<a name="l00185"></a>00185   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF.html#a327e97302d9067603701c1fd50acedc1">f_lu_</a>&gt;=0) f=<a class="code" href="classOp__Conv__EF.html#a327e97302d9067603701c1fd50acedc1">f_lu_</a>;
<a name="l00186"></a>00186   <span class="keywordflow">return</span> f;
<a name="l00187"></a>00187 }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 <span class="comment">// macro declare_ajouter(dimension,nbdim,nb_comp,nb_som_elem,dim_fois_nbn,gen)</span>
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 
<a name="l00193"></a><a class="code" href="classOp__Conv__EF.html#a8d696fed7489bca629ff1c6381277c22">00193</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Conv__EF.html#a8d696fed7489bca629ff1c6381277c22">Op_Conv_EF::ajouter_sous_cond_gen</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte,
<a name="l00194"></a>00194                                              <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> btd_impl,<span class="keywordtype">int</span> hourglass_impl,<span class="keywordtype">int</span> centre_impl)<span class="keyword"> const</span>
<a name="l00195"></a>00195 <span class="keyword"></span>{
<a name="l00196"></a>00196   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>, <a class="code" href="classOp__Conv__EF__base.html#a4181dffa4d7fa88293cefe4458d355c1">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>());
<a name="l00197"></a>00197   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_elem=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 
<a name="l00201"></a>00201   <span class="keywordflow">if</span> ((btd_impl==1)&amp;&amp;(hourglass_impl==1)&amp;&amp;(centre_impl==1)) <span class="keywordflow">return</span> resu;
<a name="l00202"></a>00202 
<a name="l00203"></a>00203   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; fluent_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>, <a class="code" href="classOp__Conv__EF__base.html#aa93385542b3568832bb37ff4f8af6052" title="tableau qui sert pour le calcul du pas de temps de stabilite">fluent</a>);
<a name="l00204"></a>00204 
<a name="l00205"></a>00205   <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; la_vitesse=<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>();
<a name="l00206"></a>00206   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; G=la_vitesse.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00207"></a>00207 
<a name="l00208"></a>00208   <span class="keywordtype">int</span> transport_rhou=0;
<a name="l00209"></a>00209   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classO__U__Ptr.html#a5aae0c48048a40339f3847aa14109231" title="Renvoie ref_().le_nom() si le pointeur est non nul ou &quot;Pointeur Nul&quot;.">le_nom</a>()==<span class="stringliteral">&quot;rho_u&quot;</span>) transport_rhou=1;
<a name="l00210"></a>00210   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rho_elem=(transport_rhou==1 ? <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique_melange&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>() : \
<a name="l00211"></a>00211                              <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
<a name="l00212"></a>00212   <span class="keywordtype">int</span> is_not_rho_unif = (rho_elem.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == 1 ? 0 : 1);
<a name="l00213"></a>00213 
<a name="l00214"></a>00214   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv vitesse&quot;</span>,G);
<a name="l00215"></a>00215   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv rho&quot;</span>,rho_elem);
<a name="l00216"></a>00216   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv transporte&quot;</span>,transporte);
<a name="l00217"></a>00217   <span class="keywordtype">int</span> nb_comp0 = resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00218"></a>00218   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00219"></a>00219   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00220"></a>00220   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; IPhi_thilde=zone_ef.<a class="code" href="classZone__EF.html#addd84cf676a5e031153effc095d88d35">IPhi_thilde</a>();
<a name="l00221"></a>00221   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00222"></a>00222   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00223"></a>00223   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00224"></a>00224   <span class="keywordtype">double</span> f= <a class="code" href="classOp__Conv__EF.html#a8a2724583588026cbcf3a05ae541d0fc">coefficient_btd</a>();
<a name="l00225"></a>00225 
<a name="l00226"></a>00226   <span class="keywordtype">int</span> mcoef3d[8]= {1,-1,-1,1,-1,1,1,-1};
<a name="l00227"></a>00227   <span class="keywordtype">int</span> sommetoppose[8]= {7,6,5,4,3,2,1,0};
<a name="l00228"></a>00228 
<a name="l00229"></a>00229   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> transp_loc(nb_som_elem,nb_comp0);
<a name="l00230"></a>00230 <span class="comment">// A DEPLACER !!!!!</span>
<a name="l00231"></a>00231   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; lambda=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOperateur__Diff__base.html" title="classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...">Operateur_Diff_base</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(0).l_op_base()).diffusivite().valeurs();
<a name="l00232"></a>00232   <span class="keywordtype">int</span> is_not_lambda_unif=1;
<a name="l00233"></a>00233   <span class="keywordflow">if</span> (lambda.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>()==1) is_not_lambda_unif=0;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=nb_comp0;
<a name="l00236"></a>00236   <span class="keyword">const</span> <span class="keywordtype">int</span> const_dimension=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00237"></a>00237 <span class="comment">// int nb_som_elem=zone_ef.zone().nb_som_elem();</span>
<a name="l00238"></a>00238   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> G_e(const_dimension);
<a name="l00239"></a>00239   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> pr(nb_comp),ge_bij(nb_som_elem);
<a name="l00240"></a>00240 
<a name="l00241"></a>00241 <span class="preprocessor">#define bij_(elem,i,j) bij(elem,i,j)</span>
<a name="l00242"></a>00242 <span class="preprocessor"></span><span class="preprocessor">#define transp_loc_(som,a) transp_loc(som,a)</span>
<a name="l00243"></a>00243 <span class="preprocessor"></span>
<a name="l00244"></a>00244 <span class="preprocessor">#define transporte_(som,a) transporte(som,a)</span>
<a name="l00245"></a>00245 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu(som,a)</span>
<a name="l00246"></a>00246 <span class="preprocessor"></span>
<a name="l00247"></a>00247 
<a name="l00248"></a>00248   <span class="keywordtype">double</span> inv_nb_som_elem=1./nb_som_elem;
<a name="l00249"></a>00249   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00250"></a>00250     <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00251"></a>00251       {
<a name="l00252"></a>00252         G_e=0;
<a name="l00253"></a>00253         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00254"></a>00254           {
<a name="l00255"></a>00255             <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00256"></a>00256             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00257"></a>00257               G_e[b]+=G(glob,b);
<a name="l00258"></a>00258             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00259"></a>00259               transp_loc(i1,a)=<a class="code" href="Op__Conv__EF_8cpp.html#aec139ab06c54f3c620f1e9944627c994">transporte_</a>(glob,a);
<a name="l00260"></a>00260           }
<a name="l00261"></a>00261         G_e*=inv_nb_som_elem;
<a name="l00262"></a>00262 <span class="comment">// Cerr&lt;&lt;&quot; coucou &quot;&lt;&lt;G_e&lt;&lt;finl;</span>
<a name="l00263"></a>00263 <span class="comment">// *10 !!!!!!!!!!!</span>
<a name="l00264"></a>00264         <span class="keywordtype">double</span> vol_elem=volumes(elem);
<a name="l00265"></a>00265         <span class="keywordtype">double</span> inv_vol_elem=1./vol_elem;
<a name="l00266"></a>00266         <span class="keywordtype">double</span> pond2=volumes_thilde(elem)*inv_vol_elem*inv_vol_elem;
<a name="l00267"></a>00267 
<a name="l00268"></a>00268         <span class="keywordflow">if</span> (transport_rhou)
<a name="l00269"></a>00269           pond2 /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l00270"></a>00270         <span class="keywordtype">double</span> fpond2=f*pond2;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272         <span class="keywordflow">if</span> ((<a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>)&amp;&amp;(nb_som_elem==8)&amp;&amp;(hourglass_impl==0))
<a name="l00273"></a>00273           {
<a name="l00274"></a>00274             <span class="keywordtype">double</span> pond3=f*<a class="code" href="ArrOfDouble_8cpp.html#af541bfdadae7483016c96f13760598ac" title="Produit scalaire de deux &quot;array&quot;. (dotproduct_array remplace operator* car le nom indique clairemen...">dotproduct_array</a>(G_e,G_e);
<a name="l00275"></a>00275             <span class="keywordflow">if</span> (transport_rhou) pond3 /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l00276"></a>00276             <span class="keywordflow">if</span> (is_not_lambda_unif)
<a name="l00277"></a>00277               pond3+=lambda(elem);
<a name="l00278"></a>00278             <span class="keywordflow">else</span>
<a name="l00279"></a>00279               pond3+=lambda(0,0);
<a name="l00280"></a>00280             pond3*=volumes_thilde(elem)*inv_vol_elem*pow(vol_elem,0.3333333333333333);
<a name="l00281"></a>00281             pond3*=<a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>;
<a name="l00282"></a>00282 
<a name="l00283"></a>00283             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00284"></a>00284               {
<a name="l00285"></a>00285                 <span class="keywordtype">double</span> coef2d=0.042*pond3;
<a name="l00286"></a>00286                 <span class="keywordtype">double</span> coef3d=coef2d*0.5;
<a name="l00287"></a>00287 
<a name="l00288"></a>00288                 <span class="keywordtype">double</span> t0=-coef2d*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(0,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(1,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(2,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(3,a)
<a name="l00289"></a>00289                                    +<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(4,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(5,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(6,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(7,a));
<a name="l00290"></a>00290 
<a name="l00291"></a>00291                 <span class="keywordtype">double</span> t3d=0;
<a name="l00292"></a>00292                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++) t3d+=mcoef3d[i]*<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i,a);
<a name="l00293"></a>00293                 t3d*=coef3d;
<a name="l00294"></a>00294                 <span class="keywordtype">double</span> t3db=coef3d*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(0,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(1,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(3,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(2,a)
<a name="l00295"></a>00295                                     -<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(4,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(5,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(7,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(6,a));
<a name="l00296"></a>00296                 <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(t3d,t3db,1e-6)) assert(0);
<a name="l00297"></a>00297                 <span class="comment">/*</span>
<a name="l00298"></a>00298 <span class="comment">                double t1=t0+coef2d*4.*(transp_loc_(0,a)+transp_loc_(7,a));</span>
<a name="l00299"></a>00299 <span class="comment">                double t2=t0+coef2d*4.*(transp_loc_(1,a)+transp_loc_(6,a));</span>
<a name="l00300"></a>00300 <span class="comment">                double t3=t0+coef2d*4.*(transp_loc_(3,a)+transp_loc_(4,a));</span>
<a name="l00301"></a>00301 <span class="comment">                double t4=t0+coef2d*4.*(transp_loc_(2,a)+transp_loc_(5,a));</span>
<a name="l00302"></a>00302 <span class="comment">                */</span>
<a name="l00303"></a>00303 <span class="comment">// if (elem==0) Cerr&lt;&lt;a&lt;&lt;&quot; &quot;&lt;&lt;t3d&lt;&lt;&quot; iiiiii &quot;&lt;&lt;t1&lt;&lt;&quot; &quot;&lt;&lt;pond3&lt;&lt;&quot; &quot;&lt;&lt;f&lt;&lt;finl;</span>
<a name="l00304"></a>00304                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)
<a name="l00305"></a>00305                   <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(elems(elem,i),a)-=mcoef3d[i]*t3d+t0+coef2d*4.*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(sommetoppose[i],a));
<a name="l00306"></a>00306               }
<a name="l00307"></a>00307           }
<a name="l00308"></a>00308 
<a name="l00309"></a>00309         {
<a name="l00310"></a>00310           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;nb_som_elem; yy++) ge_bij[yy]=0;
<a name="l00311"></a>00311           <span class="keywordflow">if</span> ((centre_impl==0)||(btd_impl==0))
<a name="l00312"></a>00312             {
<a name="l00313"></a>00313               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00314"></a>00314                 {
<a name="l00315"></a>00315                   <span class="keywordtype">double</span> cb=0;
<a name="l00316"></a>00316                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00317"></a>00317                     cb+=G_e[b]*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b);
<a name="l00318"></a>00318                   ge_bij[i1]=cb;
<a name="l00319"></a>00319                 }
<a name="l00320"></a>00320               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00321"></a>00321                 {
<a name="l00322"></a>00322                   <span class="keywordtype">double</span> pond=0;
<a name="l00323"></a>00323                   <span class="keywordflow">if</span> (centre_impl==0) pond=IPhi_thilde(elem,i1)*inv_vol_elem;
<a name="l00324"></a>00324                   <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00325"></a>00325 <span class="comment">// pr=0;</span>
<a name="l00326"></a>00326                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;nb_comp; yy++) pr[yy]=0;
<a name="l00327"></a>00327 
<a name="l00328"></a>00328                   <span class="keywordtype">double</span> cbbtd=pond;
<a name="l00329"></a>00329                   <span class="keywordflow">if</span> ((btd_impl==0)&amp;&amp;(<a class="code" href="classOp__Conv__EF.html#af6b1073d41da2d3fabb35ef12923cb0c">type_op</a>==<a class="code" href="classOp__Conv__EF.html#ab9734112d198e5e32e51e1efd1a9b75da3cab344cce2439325cbbaf941192caa8">amont</a>))
<a name="l00330"></a>00330                     cbbtd+=ge_bij[i1]*(fpond2);
<a name="l00331"></a>00331                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00332"></a>00332                     {
<a name="l00333"></a>00333                       <span class="keyword">const</span> <span class="keywordtype">double</span> cbi2=ge_bij[i2];
<a name="l00334"></a>00334                       <span class="keywordtype">double</span> coef=cbbtd*cbi2;
<a name="l00335"></a>00335                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00336"></a>00336                         pr[a]-=coef*<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i2,a);
<a name="l00337"></a>00337                     }
<a name="l00338"></a>00338                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00339"></a>00339                     <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(glob,a)+=pr[a];
<a name="l00340"></a>00340                 }
<a name="l00341"></a>00341             }
<a name="l00342"></a>00342         }
<a name="l00343"></a>00343       }
<a name="l00344"></a>00344 
<a name="l00345"></a>00345   fluent_.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00346"></a>00346   <span class="keywordflow">return</span> resu;
<a name="l00347"></a>00347 <span class="preprocessor">#undef bij_</span>
<a name="l00348"></a>00348 <span class="preprocessor"></span><span class="preprocessor">#undef transp_loc_</span>
<a name="l00349"></a>00349 <span class="preprocessor"></span><span class="preprocessor">#undef transporte_</span>
<a name="l00350"></a>00350 <span class="preprocessor"></span><span class="preprocessor">#undef resu_</span>
<a name="l00351"></a>00351 <span class="preprocessor"></span>}
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 
<a name="l00354"></a><a class="code" href="classOp__Conv__EF.html#aee0145605af027404be5bca5000d9d65">00354</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Conv__EF.html#aee0145605af027404be5bca5000d9d65">Op_Conv_EF::ajouter_sous_cond_dim3_nbn8_nbdim2</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte,
<a name="l00355"></a>00355                                                           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> btd_impl,<span class="keywordtype">int</span> hourglass_impl,<span class="keywordtype">int</span> centre_impl)<span class="keyword"> const</span>
<a name="l00356"></a>00356 <span class="keyword"></span>{
<a name="l00357"></a>00357   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>, <a class="code" href="classOp__Conv__EF__base.html#a4181dffa4d7fa88293cefe4458d355c1">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>());
<a name="l00358"></a>00358   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_elem=8;
<a name="l00359"></a>00359 
<a name="l00360"></a>00360 
<a name="l00361"></a>00361   <span class="keywordflow">if</span> ((btd_impl==1)&amp;&amp;(hourglass_impl==1)&amp;&amp;(centre_impl==1)) <span class="keywordflow">return</span> resu;
<a name="l00362"></a>00362 
<a name="l00363"></a>00363   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; fluent_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>, <a class="code" href="classOp__Conv__EF__base.html#aa93385542b3568832bb37ff4f8af6052" title="tableau qui sert pour le calcul du pas de temps de stabilite">fluent</a>);
<a name="l00364"></a>00364 
<a name="l00365"></a>00365   <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; la_vitesse=<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>();
<a name="l00366"></a>00366   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; G=la_vitesse.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00367"></a>00367 
<a name="l00368"></a>00368   <span class="keywordtype">int</span> transport_rhou=0;
<a name="l00369"></a>00369   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classO__U__Ptr.html#a5aae0c48048a40339f3847aa14109231" title="Renvoie ref_().le_nom() si le pointeur est non nul ou &quot;Pointeur Nul&quot;.">le_nom</a>()==<span class="stringliteral">&quot;rho_u&quot;</span>) transport_rhou=1;
<a name="l00370"></a>00370   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rho_elem=(transport_rhou==1 ? <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique_melange&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>() : \
<a name="l00371"></a>00371                              <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
<a name="l00372"></a>00372   <span class="keywordtype">int</span> is_not_rho_unif = (rho_elem.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == 1 ? 0 : 1);
<a name="l00373"></a>00373 
<a name="l00374"></a>00374   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv vitesse&quot;</span>,G);
<a name="l00375"></a>00375   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv rho&quot;</span>,rho_elem);
<a name="l00376"></a>00376   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv transporte&quot;</span>,transporte);
<a name="l00377"></a>00377   <span class="keywordtype">int</span> nb_comp0 = resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00378"></a>00378   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00379"></a>00379   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00380"></a>00380   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; IPhi_thilde=zone_ef.<a class="code" href="classZone__EF.html#addd84cf676a5e031153effc095d88d35">IPhi_thilde</a>();
<a name="l00381"></a>00381   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00382"></a>00382   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00383"></a>00383   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00384"></a>00384   <span class="keywordtype">double</span> f= <a class="code" href="classOp__Conv__EF.html#a8a2724583588026cbcf3a05ae541d0fc">coefficient_btd</a>();
<a name="l00385"></a>00385 
<a name="l00386"></a>00386   <span class="keywordtype">int</span> mcoef3d[8]= {1,-1,-1,1,-1,1,1,-1};
<a name="l00387"></a>00387   <span class="keywordtype">int</span> sommetoppose[8]= {7,6,5,4,3,2,1,0};
<a name="l00388"></a>00388 
<a name="l00389"></a>00389   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> transp_loc(nb_som_elem,nb_comp0);
<a name="l00390"></a>00390 <span class="comment">// A DEPLACER !!!!!</span>
<a name="l00391"></a>00391   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; lambda=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOperateur__Diff__base.html" title="classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...">Operateur_Diff_base</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(0).l_op_base()).diffusivite().valeurs();
<a name="l00392"></a>00392   <span class="keywordtype">int</span> is_not_lambda_unif=1;
<a name="l00393"></a>00393   <span class="keywordflow">if</span> (lambda.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>()==1) is_not_lambda_unif=0;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395   <span class="keyword">const</span> <span class="keywordtype">int</span> const_dimension= 3;
<a name="l00396"></a>00396 <span class="comment">// const int nb_som_elem= 8;</span>
<a name="l00397"></a>00397   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=3;
<a name="l00398"></a>00398   <span class="keyword">const</span> <span class="keywordtype">int</span> dim_fois_nbn=24;
<a name="l00399"></a>00399   <span class="keywordflow">if</span> (nb_comp0!=nb_comp) <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">abort</a>();
<a name="l00400"></a>00400 
<a name="l00401"></a>00401   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> G_e(const_dimension);
<a name="l00402"></a>00402   <span class="keywordtype">double</span> pr[nb_comp],ge_bij[nb_som_elem];
<a name="l00403"></a>00403   <span class="keyword">const</span> <span class="keywordtype">double</span>* bij_ptr=bij.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00404"></a>00404   <span class="keyword">const</span> <span class="keywordtype">double</span>* transp_loc_ptr=transp_loc.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00405"></a>00405   <span class="keyword">const</span> <span class="keywordtype">double</span>* transporte_ptr=transporte.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00406"></a>00406   <span class="keywordtype">double</span>* resu_ptr=resu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00407"></a>00407 
<a name="l00408"></a>00408 <span class="preprocessor">#define bij_(elem,i,j) bij_ptr[elem*dim_fois_nbn+i*const_dimension+j]</span>
<a name="l00409"></a>00409 <span class="preprocessor"></span><span class="preprocessor">#define transp_loc_(som,a) transp_loc_ptr[som*nb_comp+a]</span>
<a name="l00410"></a>00410 <span class="preprocessor"></span><span class="preprocessor">#define transporte_(som,a) transporte_ptr[som*nb_comp+a]</span>
<a name="l00411"></a>00411 <span class="preprocessor"></span>
<a name="l00412"></a>00412 <span class="preprocessor">#define resu_(som,a) resu_ptr[som*nb_comp+a]</span>
<a name="l00413"></a>00413 <span class="preprocessor"></span>
<a name="l00414"></a>00414   <span class="keywordtype">double</span> inv_nb_som_elem=1./nb_som_elem;
<a name="l00415"></a>00415   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00416"></a>00416     <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00417"></a>00417       {
<a name="l00418"></a>00418         G_e=0;
<a name="l00419"></a>00419         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00420"></a>00420           {
<a name="l00421"></a>00421             <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00422"></a>00422             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00423"></a>00423               G_e[b]+=G(glob,b);
<a name="l00424"></a>00424             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00425"></a>00425               transp_loc(i1,a)=<a class="code" href="Op__Conv__EF_8cpp.html#aec139ab06c54f3c620f1e9944627c994">transporte_</a>(glob,a);
<a name="l00426"></a>00426           }
<a name="l00427"></a>00427         G_e*=inv_nb_som_elem;
<a name="l00428"></a>00428 <span class="comment">// Cerr&lt;&lt;&quot; coucou &quot;&lt;&lt;G_e&lt;&lt;finl;</span>
<a name="l00429"></a>00429 <span class="comment">// *10 !!!!!!!!!!!</span>
<a name="l00430"></a>00430         <span class="keywordtype">double</span> vol_elem=volumes(elem);
<a name="l00431"></a>00431         <span class="keywordtype">double</span> inv_vol_elem=1./vol_elem;
<a name="l00432"></a>00432         <span class="keywordtype">double</span> pond2=volumes_thilde(elem)*inv_vol_elem*inv_vol_elem;
<a name="l00433"></a>00433 
<a name="l00434"></a>00434         <span class="keywordflow">if</span> (transport_rhou)
<a name="l00435"></a>00435           pond2 /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l00436"></a>00436         <span class="keywordtype">double</span> fpond2=f*pond2;
<a name="l00437"></a>00437 
<a name="l00438"></a>00438         <span class="keywordflow">if</span> ((<a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>)&amp;&amp;(nb_som_elem==8)&amp;&amp;(hourglass_impl==0))
<a name="l00439"></a>00439           {
<a name="l00440"></a>00440             <span class="keywordtype">double</span> pond3=f*<a class="code" href="ArrOfDouble_8cpp.html#af541bfdadae7483016c96f13760598ac" title="Produit scalaire de deux &quot;array&quot;. (dotproduct_array remplace operator* car le nom indique clairemen...">dotproduct_array</a>(G_e,G_e);
<a name="l00441"></a>00441             <span class="keywordflow">if</span> (transport_rhou) pond3 /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l00442"></a>00442             <span class="keywordflow">if</span> (is_not_lambda_unif)
<a name="l00443"></a>00443               pond3+=lambda(elem);
<a name="l00444"></a>00444             <span class="keywordflow">else</span>
<a name="l00445"></a>00445               pond3+=lambda(0,0);
<a name="l00446"></a>00446             pond3*=volumes_thilde(elem)*inv_vol_elem*pow(vol_elem,0.3333333333333333);
<a name="l00447"></a>00447             pond3*=<a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>;
<a name="l00448"></a>00448 
<a name="l00449"></a>00449             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00450"></a>00450               {
<a name="l00451"></a>00451                 <span class="keywordtype">double</span> coef2d=0.042*pond3;
<a name="l00452"></a>00452                 <span class="keywordtype">double</span> coef3d=coef2d*0.5;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454                 <span class="keywordtype">double</span> t0=-coef2d*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(0,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(1,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(2,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(3,a)
<a name="l00455"></a>00455                                    +<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(4,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(5,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(6,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(7,a));
<a name="l00456"></a>00456 
<a name="l00457"></a>00457                 <span class="keywordtype">double</span> t3d=0;
<a name="l00458"></a>00458                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++) t3d+=mcoef3d[i]*<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i,a);
<a name="l00459"></a>00459                 t3d*=coef3d;
<a name="l00460"></a>00460                 <span class="keywordtype">double</span> t3db=coef3d*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(0,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(1,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(3,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(2,a)
<a name="l00461"></a>00461                                     -<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(4,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(5,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(7,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(6,a));
<a name="l00462"></a>00462                 <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(t3d,t3db,1e-6)) assert(0);
<a name="l00463"></a>00463                 <span class="comment">/*</span>
<a name="l00464"></a>00464 <span class="comment">                double t1=t0+coef2d*4.*(transp_loc_(0,a)+transp_loc_(7,a));</span>
<a name="l00465"></a>00465 <span class="comment">                double t2=t0+coef2d*4.*(transp_loc_(1,a)+transp_loc_(6,a));</span>
<a name="l00466"></a>00466 <span class="comment">                double t3=t0+coef2d*4.*(transp_loc_(3,a)+transp_loc_(4,a));</span>
<a name="l00467"></a>00467 <span class="comment">                double t4=t0+coef2d*4.*(transp_loc_(2,a)+transp_loc_(5,a));</span>
<a name="l00468"></a>00468 <span class="comment">                */</span>
<a name="l00469"></a>00469 <span class="comment">// if (elem==0) Cerr&lt;&lt;a&lt;&lt;&quot; &quot;&lt;&lt;t3d&lt;&lt;&quot; iiiiii &quot;&lt;&lt;t1&lt;&lt;&quot; &quot;&lt;&lt;pond3&lt;&lt;&quot; &quot;&lt;&lt;f&lt;&lt;finl;</span>
<a name="l00470"></a>00470                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)
<a name="l00471"></a>00471                   <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(elems(elem,i),a)-=mcoef3d[i]*t3d+t0+coef2d*4.*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(sommetoppose[i],a));
<a name="l00472"></a>00472               }
<a name="l00473"></a>00473           }
<a name="l00474"></a>00474 
<a name="l00475"></a>00475         {
<a name="l00476"></a>00476           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;nb_som_elem; yy++) ge_bij[yy]=0;
<a name="l00477"></a>00477           <span class="keywordflow">if</span> ((centre_impl==0)||(btd_impl==0))
<a name="l00478"></a>00478             {
<a name="l00479"></a>00479               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00480"></a>00480                 {
<a name="l00481"></a>00481                   <span class="keywordtype">double</span> cb=0;
<a name="l00482"></a>00482                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00483"></a>00483                     cb+=G_e[b]*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b);
<a name="l00484"></a>00484                   ge_bij[i1]=cb;
<a name="l00485"></a>00485                 }
<a name="l00486"></a>00486               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00487"></a>00487                 {
<a name="l00488"></a>00488                   <span class="keywordtype">double</span> pond=0;
<a name="l00489"></a>00489                   <span class="keywordflow">if</span> (centre_impl==0) pond=IPhi_thilde(elem,i1)*inv_vol_elem;
<a name="l00490"></a>00490                   <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00491"></a>00491 <span class="comment">// pr=0;</span>
<a name="l00492"></a>00492                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;nb_comp; yy++) pr[yy]=0;
<a name="l00493"></a>00493 
<a name="l00494"></a>00494                   <span class="keywordtype">double</span> cbbtd=pond;
<a name="l00495"></a>00495                   <span class="keywordflow">if</span> ((btd_impl==0)&amp;&amp;(<a class="code" href="classOp__Conv__EF.html#af6b1073d41da2d3fabb35ef12923cb0c">type_op</a>==<a class="code" href="classOp__Conv__EF.html#ab9734112d198e5e32e51e1efd1a9b75da3cab344cce2439325cbbaf941192caa8">amont</a>))
<a name="l00496"></a>00496                     cbbtd+=ge_bij[i1]*(fpond2);
<a name="l00497"></a>00497                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00498"></a>00498                     {
<a name="l00499"></a>00499                       <span class="keyword">const</span> <span class="keywordtype">double</span> cbi2=ge_bij[i2];
<a name="l00500"></a>00500                       <span class="keywordtype">double</span> coef=cbbtd*cbi2;
<a name="l00501"></a>00501                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00502"></a>00502                         pr[a]-=coef*<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i2,a);
<a name="l00503"></a>00503                     }
<a name="l00504"></a>00504                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00505"></a>00505                     <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(glob,a)+=pr[a];
<a name="l00506"></a>00506                 }
<a name="l00507"></a>00507             }
<a name="l00508"></a>00508         }
<a name="l00509"></a>00509       }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511   fluent_.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00512"></a>00512   <span class="keywordflow">return</span> resu;
<a name="l00513"></a>00513 <span class="preprocessor">#undef bij_</span>
<a name="l00514"></a>00514 <span class="preprocessor"></span><span class="preprocessor">#undef transp_loc_</span>
<a name="l00515"></a>00515 <span class="preprocessor"></span><span class="preprocessor">#undef transporte_</span>
<a name="l00516"></a>00516 <span class="preprocessor"></span><span class="preprocessor">#undef resu_</span>
<a name="l00517"></a>00517 <span class="preprocessor"></span>}
<a name="l00518"></a>00518 
<a name="l00519"></a><a class="code" href="classOp__Conv__EF.html#a8ba1f6f1f53d3f78f9100a5a6360e63d">00519</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Conv__EF.html#a8ba1f6f1f53d3f78f9100a5a6360e63d">Op_Conv_EF::ajouter_sous_cond_dim3_nbn8_nbdim1</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte,
<a name="l00520"></a>00520                                                           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> btd_impl,<span class="keywordtype">int</span> hourglass_impl,<span class="keywordtype">int</span> centre_impl)<span class="keyword"> const</span>
<a name="l00521"></a>00521 <span class="keyword"></span>{
<a name="l00522"></a>00522   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>, <a class="code" href="classOp__Conv__EF__base.html#a4181dffa4d7fa88293cefe4458d355c1">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>());
<a name="l00523"></a>00523   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_elem=8;
<a name="l00524"></a>00524 
<a name="l00525"></a>00525 
<a name="l00526"></a>00526   <span class="keywordflow">if</span> ((btd_impl==1)&amp;&amp;(hourglass_impl==1)&amp;&amp;(centre_impl==1)) <span class="keywordflow">return</span> resu;
<a name="l00527"></a>00527 
<a name="l00528"></a>00528   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; fluent_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>, <a class="code" href="classOp__Conv__EF__base.html#aa93385542b3568832bb37ff4f8af6052" title="tableau qui sert pour le calcul du pas de temps de stabilite">fluent</a>);
<a name="l00529"></a>00529 
<a name="l00530"></a>00530   <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; la_vitesse=<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>();
<a name="l00531"></a>00531   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; G=la_vitesse.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00532"></a>00532 
<a name="l00533"></a>00533   <span class="keywordtype">int</span> transport_rhou=0;
<a name="l00534"></a>00534   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classO__U__Ptr.html#a5aae0c48048a40339f3847aa14109231" title="Renvoie ref_().le_nom() si le pointeur est non nul ou &quot;Pointeur Nul&quot;.">le_nom</a>()==<span class="stringliteral">&quot;rho_u&quot;</span>) transport_rhou=1;
<a name="l00535"></a>00535   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rho_elem=(transport_rhou==1 ? <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique_melange&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>() : \
<a name="l00536"></a>00536                              <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
<a name="l00537"></a>00537   <span class="keywordtype">int</span> is_not_rho_unif = (rho_elem.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == 1 ? 0 : 1);
<a name="l00538"></a>00538 
<a name="l00539"></a>00539   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv vitesse&quot;</span>,G);
<a name="l00540"></a>00540   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv rho&quot;</span>,rho_elem);
<a name="l00541"></a>00541   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv transporte&quot;</span>,transporte);
<a name="l00542"></a>00542   <span class="keywordtype">int</span> nb_comp0 = resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00543"></a>00543   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00544"></a>00544   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00545"></a>00545   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; IPhi_thilde=zone_ef.<a class="code" href="classZone__EF.html#addd84cf676a5e031153effc095d88d35">IPhi_thilde</a>();
<a name="l00546"></a>00546   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00547"></a>00547   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00548"></a>00548   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00549"></a>00549   <span class="keywordtype">double</span> f= <a class="code" href="classOp__Conv__EF.html#a8a2724583588026cbcf3a05ae541d0fc">coefficient_btd</a>();
<a name="l00550"></a>00550 
<a name="l00551"></a>00551   <span class="keywordtype">int</span> mcoef3d[8]= {1,-1,-1,1,-1,1,1,-1};
<a name="l00552"></a>00552   <span class="keywordtype">int</span> sommetoppose[8]= {7,6,5,4,3,2,1,0};
<a name="l00553"></a>00553 
<a name="l00554"></a>00554   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> transp_loc(nb_som_elem,nb_comp0);
<a name="l00555"></a>00555 <span class="comment">// A DEPLACER !!!!!</span>
<a name="l00556"></a>00556   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; lambda=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOperateur__Diff__base.html" title="classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...">Operateur_Diff_base</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(0).l_op_base()).diffusivite().valeurs();
<a name="l00557"></a>00557   <span class="keywordtype">int</span> is_not_lambda_unif=1;
<a name="l00558"></a>00558   <span class="keywordflow">if</span> (lambda.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>()==1) is_not_lambda_unif=0;
<a name="l00559"></a>00559 
<a name="l00560"></a>00560   <span class="keyword">const</span> <span class="keywordtype">int</span> const_dimension= 3;
<a name="l00561"></a>00561 <span class="comment">// const int nb_som_elem= 8;</span>
<a name="l00562"></a>00562   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=1;
<a name="l00563"></a>00563   <span class="keyword">const</span> <span class="keywordtype">int</span> dim_fois_nbn=24;
<a name="l00564"></a>00564   <span class="keywordflow">if</span> (nb_comp0!=nb_comp) <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">abort</a>();
<a name="l00565"></a>00565 
<a name="l00566"></a>00566   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> G_e(const_dimension);
<a name="l00567"></a>00567   <span class="keywordtype">double</span> pr[nb_comp],ge_bij[nb_som_elem];
<a name="l00568"></a>00568   <span class="keyword">const</span> <span class="keywordtype">double</span>* bij_ptr=bij.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00569"></a>00569   <span class="keyword">const</span> <span class="keywordtype">double</span>* transp_loc_ptr=transp_loc.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00570"></a>00570   <span class="keyword">const</span> <span class="keywordtype">double</span>* transporte_ptr=transporte.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00571"></a>00571   <span class="keywordtype">double</span>* resu_ptr=resu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00572"></a>00572 
<a name="l00573"></a>00573 <span class="preprocessor">#define bij_(elem,i,j) bij_ptr[elem*dim_fois_nbn+i*const_dimension+j]</span>
<a name="l00574"></a>00574 <span class="preprocessor"></span><span class="preprocessor">#define transp_loc_(som,a) transp_loc_ptr[som*nb_comp+a]</span>
<a name="l00575"></a>00575 <span class="preprocessor"></span><span class="preprocessor">#define transporte_(som,a) transporte_ptr[som*nb_comp+a]</span>
<a name="l00576"></a>00576 <span class="preprocessor"></span>
<a name="l00577"></a>00577 <span class="preprocessor">#define resu_(som,a) resu_ptr[som*nb_comp+a]</span>
<a name="l00578"></a>00578 <span class="preprocessor"></span>
<a name="l00579"></a>00579   <span class="keywordtype">double</span> inv_nb_som_elem=1./nb_som_elem;
<a name="l00580"></a>00580   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00581"></a>00581     <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00582"></a>00582       {
<a name="l00583"></a>00583         G_e=0;
<a name="l00584"></a>00584         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00585"></a>00585           {
<a name="l00586"></a>00586             <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00587"></a>00587             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00588"></a>00588               G_e[b]+=G(glob,b);
<a name="l00589"></a>00589             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00590"></a>00590               transp_loc(i1,a)=<a class="code" href="Op__Conv__EF_8cpp.html#aec139ab06c54f3c620f1e9944627c994">transporte_</a>(glob,a);
<a name="l00591"></a>00591           }
<a name="l00592"></a>00592         G_e*=inv_nb_som_elem;
<a name="l00593"></a>00593 <span class="comment">// Cerr&lt;&lt;&quot; coucou &quot;&lt;&lt;G_e&lt;&lt;finl;</span>
<a name="l00594"></a>00594 <span class="comment">// *10 !!!!!!!!!!!</span>
<a name="l00595"></a>00595         <span class="keywordtype">double</span> vol_elem=volumes(elem);
<a name="l00596"></a>00596         <span class="keywordtype">double</span> inv_vol_elem=1./vol_elem;
<a name="l00597"></a>00597         <span class="keywordtype">double</span> pond2=volumes_thilde(elem)*inv_vol_elem*inv_vol_elem;
<a name="l00598"></a>00598 
<a name="l00599"></a>00599         <span class="keywordflow">if</span> (transport_rhou)
<a name="l00600"></a>00600           pond2 /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l00601"></a>00601         <span class="keywordtype">double</span> fpond2=f*pond2;
<a name="l00602"></a>00602 
<a name="l00603"></a>00603         <span class="keywordflow">if</span> ((<a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>)&amp;&amp;(nb_som_elem==8)&amp;&amp;(hourglass_impl==0))
<a name="l00604"></a>00604           {
<a name="l00605"></a>00605             <span class="keywordtype">double</span> pond3=f*<a class="code" href="ArrOfDouble_8cpp.html#af541bfdadae7483016c96f13760598ac" title="Produit scalaire de deux &quot;array&quot;. (dotproduct_array remplace operator* car le nom indique clairemen...">dotproduct_array</a>(G_e,G_e);
<a name="l00606"></a>00606             <span class="keywordflow">if</span> (transport_rhou) pond3 /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l00607"></a>00607             <span class="keywordflow">if</span> (is_not_lambda_unif)
<a name="l00608"></a>00608               pond3+=lambda(elem);
<a name="l00609"></a>00609             <span class="keywordflow">else</span>
<a name="l00610"></a>00610               pond3+=lambda(0,0);
<a name="l00611"></a>00611             pond3*=volumes_thilde(elem)*inv_vol_elem*pow(vol_elem,0.3333333333333333);
<a name="l00612"></a>00612             pond3*=<a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>;
<a name="l00613"></a>00613 
<a name="l00614"></a>00614             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00615"></a>00615               {
<a name="l00616"></a>00616                 <span class="keywordtype">double</span> coef2d=0.042*pond3;
<a name="l00617"></a>00617                 <span class="keywordtype">double</span> coef3d=coef2d*0.5;
<a name="l00618"></a>00618 
<a name="l00619"></a>00619                 <span class="keywordtype">double</span> t0=-coef2d*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(0,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(1,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(2,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(3,a)
<a name="l00620"></a>00620                                    +<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(4,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(5,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(6,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(7,a));
<a name="l00621"></a>00621 
<a name="l00622"></a>00622                 <span class="keywordtype">double</span> t3d=0;
<a name="l00623"></a>00623                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++) t3d+=mcoef3d[i]*<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i,a);
<a name="l00624"></a>00624                 t3d*=coef3d;
<a name="l00625"></a>00625                 <span class="keywordtype">double</span> t3db=coef3d*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(0,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(1,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(3,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(2,a)
<a name="l00626"></a>00626                                     -<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(4,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(5,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(7,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(6,a));
<a name="l00627"></a>00627                 <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(t3d,t3db,1e-6)) assert(0);
<a name="l00628"></a>00628                 <span class="comment">/*</span>
<a name="l00629"></a>00629 <span class="comment">                double t1=t0+coef2d*4.*(transp_loc_(0,a)+transp_loc_(7,a));</span>
<a name="l00630"></a>00630 <span class="comment">                double t2=t0+coef2d*4.*(transp_loc_(1,a)+transp_loc_(6,a));</span>
<a name="l00631"></a>00631 <span class="comment">                double t3=t0+coef2d*4.*(transp_loc_(3,a)+transp_loc_(4,a));</span>
<a name="l00632"></a>00632 <span class="comment">                double t4=t0+coef2d*4.*(transp_loc_(2,a)+transp_loc_(5,a));</span>
<a name="l00633"></a>00633 <span class="comment">                */</span>
<a name="l00634"></a>00634 <span class="comment">// if (elem==0) Cerr&lt;&lt;a&lt;&lt;&quot; &quot;&lt;&lt;t3d&lt;&lt;&quot; iiiiii &quot;&lt;&lt;t1&lt;&lt;&quot; &quot;&lt;&lt;pond3&lt;&lt;&quot; &quot;&lt;&lt;f&lt;&lt;finl;</span>
<a name="l00635"></a>00635                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)
<a name="l00636"></a>00636                   <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(elems(elem,i),a)-=mcoef3d[i]*t3d+t0+coef2d*4.*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(sommetoppose[i],a));
<a name="l00637"></a>00637               }
<a name="l00638"></a>00638           }
<a name="l00639"></a>00639 
<a name="l00640"></a>00640         {
<a name="l00641"></a>00641           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;nb_som_elem; yy++) ge_bij[yy]=0;
<a name="l00642"></a>00642           <span class="keywordflow">if</span> ((centre_impl==0)||(btd_impl==0))
<a name="l00643"></a>00643             {
<a name="l00644"></a>00644               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00645"></a>00645                 {
<a name="l00646"></a>00646                   <span class="keywordtype">double</span> cb=0;
<a name="l00647"></a>00647                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00648"></a>00648                     cb+=G_e[b]*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b);
<a name="l00649"></a>00649                   ge_bij[i1]=cb;
<a name="l00650"></a>00650                 }
<a name="l00651"></a>00651               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00652"></a>00652                 {
<a name="l00653"></a>00653                   <span class="keywordtype">double</span> pond=0;
<a name="l00654"></a>00654                   <span class="keywordflow">if</span> (centre_impl==0) pond=IPhi_thilde(elem,i1)*inv_vol_elem;
<a name="l00655"></a>00655                   <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00656"></a>00656 <span class="comment">// pr=0;</span>
<a name="l00657"></a>00657                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;nb_comp; yy++) pr[yy]=0;
<a name="l00658"></a>00658 
<a name="l00659"></a>00659                   <span class="keywordtype">double</span> cbbtd=pond;
<a name="l00660"></a>00660                   <span class="keywordflow">if</span> ((btd_impl==0)&amp;&amp;(<a class="code" href="classOp__Conv__EF.html#af6b1073d41da2d3fabb35ef12923cb0c">type_op</a>==<a class="code" href="classOp__Conv__EF.html#ab9734112d198e5e32e51e1efd1a9b75da3cab344cce2439325cbbaf941192caa8">amont</a>))
<a name="l00661"></a>00661                     cbbtd+=ge_bij[i1]*(fpond2);
<a name="l00662"></a>00662                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00663"></a>00663                     {
<a name="l00664"></a>00664                       <span class="keyword">const</span> <span class="keywordtype">double</span> cbi2=ge_bij[i2];
<a name="l00665"></a>00665                       <span class="keywordtype">double</span> coef=cbbtd*cbi2;
<a name="l00666"></a>00666                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00667"></a>00667                         pr[a]-=coef*<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i2,a);
<a name="l00668"></a>00668                     }
<a name="l00669"></a>00669                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00670"></a>00670                     <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(glob,a)+=pr[a];
<a name="l00671"></a>00671                 }
<a name="l00672"></a>00672             }
<a name="l00673"></a>00673         }
<a name="l00674"></a>00674       }
<a name="l00675"></a>00675 
<a name="l00676"></a>00676   fluent_.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00677"></a>00677   <span class="keywordflow">return</span> resu;
<a name="l00678"></a>00678 <span class="preprocessor">#undef bij_</span>
<a name="l00679"></a>00679 <span class="preprocessor"></span><span class="preprocessor">#undef transp_loc_</span>
<a name="l00680"></a>00680 <span class="preprocessor"></span><span class="preprocessor">#undef transporte_</span>
<a name="l00681"></a>00681 <span class="preprocessor"></span><span class="preprocessor">#undef resu_</span>
<a name="l00682"></a>00682 <span class="preprocessor"></span>}
<a name="l00683"></a>00683 
<a name="l00684"></a>00684 
<a name="l00685"></a><a class="code" href="classOp__Conv__EF.html#a2ea2ac370a235e95bff068ba638d3038">00685</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Conv__EF.html#a2ea2ac370a235e95bff068ba638d3038">Op_Conv_EF::ajouter_sous_cond_dim2_nbn4_nbdim2</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte,
<a name="l00686"></a>00686                                                           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> btd_impl,<span class="keywordtype">int</span> hourglass_impl,<span class="keywordtype">int</span> centre_impl)<span class="keyword"> const</span>
<a name="l00687"></a>00687 <span class="keyword"></span>{
<a name="l00688"></a>00688   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>, <a class="code" href="classOp__Conv__EF__base.html#a4181dffa4d7fa88293cefe4458d355c1">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>());
<a name="l00689"></a>00689   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_elem=4;
<a name="l00690"></a>00690 
<a name="l00691"></a>00691 
<a name="l00692"></a>00692   <span class="keywordflow">if</span> ((btd_impl==1)&amp;&amp;(hourglass_impl==1)&amp;&amp;(centre_impl==1)) <span class="keywordflow">return</span> resu;
<a name="l00693"></a>00693 
<a name="l00694"></a>00694   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; fluent_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>, <a class="code" href="classOp__Conv__EF__base.html#aa93385542b3568832bb37ff4f8af6052" title="tableau qui sert pour le calcul du pas de temps de stabilite">fluent</a>);
<a name="l00695"></a>00695 
<a name="l00696"></a>00696   <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; la_vitesse=<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>();
<a name="l00697"></a>00697   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; G=la_vitesse.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00698"></a>00698 
<a name="l00699"></a>00699   <span class="keywordtype">int</span> transport_rhou=0;
<a name="l00700"></a>00700   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classO__U__Ptr.html#a5aae0c48048a40339f3847aa14109231" title="Renvoie ref_().le_nom() si le pointeur est non nul ou &quot;Pointeur Nul&quot;.">le_nom</a>()==<span class="stringliteral">&quot;rho_u&quot;</span>) transport_rhou=1;
<a name="l00701"></a>00701   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rho_elem=(transport_rhou==1 ? <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique_melange&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>() : \
<a name="l00702"></a>00702                              <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
<a name="l00703"></a>00703   <span class="keywordtype">int</span> is_not_rho_unif = (rho_elem.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == 1 ? 0 : 1);
<a name="l00704"></a>00704 
<a name="l00705"></a>00705   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv vitesse&quot;</span>,G);
<a name="l00706"></a>00706   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv rho&quot;</span>,rho_elem);
<a name="l00707"></a>00707   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv transporte&quot;</span>,transporte);
<a name="l00708"></a>00708   <span class="keywordtype">int</span> nb_comp0 = resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00709"></a>00709   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00710"></a>00710   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00711"></a>00711   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; IPhi_thilde=zone_ef.<a class="code" href="classZone__EF.html#addd84cf676a5e031153effc095d88d35">IPhi_thilde</a>();
<a name="l00712"></a>00712   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00713"></a>00713   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00714"></a>00714   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00715"></a>00715   <span class="keywordtype">double</span> f= <a class="code" href="classOp__Conv__EF.html#a8a2724583588026cbcf3a05ae541d0fc">coefficient_btd</a>();
<a name="l00716"></a>00716 
<a name="l00717"></a>00717   <span class="keywordtype">int</span> mcoef3d[8]= {1,-1,-1,1,-1,1,1,-1};
<a name="l00718"></a>00718   <span class="keywordtype">int</span> sommetoppose[8]= {7,6,5,4,3,2,1,0};
<a name="l00719"></a>00719 
<a name="l00720"></a>00720   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> transp_loc(nb_som_elem,nb_comp0);
<a name="l00721"></a>00721 <span class="comment">// A DEPLACER !!!!!</span>
<a name="l00722"></a>00722   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; lambda=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOperateur__Diff__base.html" title="classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...">Operateur_Diff_base</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(0).l_op_base()).diffusivite().valeurs();
<a name="l00723"></a>00723   <span class="keywordtype">int</span> is_not_lambda_unif=1;
<a name="l00724"></a>00724   <span class="keywordflow">if</span> (lambda.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>()==1) is_not_lambda_unif=0;
<a name="l00725"></a>00725 
<a name="l00726"></a>00726   <span class="keyword">const</span> <span class="keywordtype">int</span> const_dimension= 2;
<a name="l00727"></a>00727 <span class="comment">// const int nb_som_elem= 4;</span>
<a name="l00728"></a>00728   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=2;
<a name="l00729"></a>00729   <span class="keyword">const</span> <span class="keywordtype">int</span> dim_fois_nbn=8;
<a name="l00730"></a>00730   <span class="keywordflow">if</span> (nb_comp0!=nb_comp) <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">abort</a>();
<a name="l00731"></a>00731 
<a name="l00732"></a>00732   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> G_e(const_dimension);
<a name="l00733"></a>00733   <span class="keywordtype">double</span> pr[nb_comp],ge_bij[nb_som_elem];
<a name="l00734"></a>00734   <span class="keyword">const</span> <span class="keywordtype">double</span>* bij_ptr=bij.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00735"></a>00735   <span class="keyword">const</span> <span class="keywordtype">double</span>* transp_loc_ptr=transp_loc.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00736"></a>00736   <span class="keyword">const</span> <span class="keywordtype">double</span>* transporte_ptr=transporte.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00737"></a>00737   <span class="keywordtype">double</span>* resu_ptr=resu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00738"></a>00738 
<a name="l00739"></a>00739 <span class="preprocessor">#define bij_(elem,i,j) bij_ptr[elem*dim_fois_nbn+i*const_dimension+j]</span>
<a name="l00740"></a>00740 <span class="preprocessor"></span><span class="preprocessor">#define transp_loc_(som,a) transp_loc_ptr[som*nb_comp+a]</span>
<a name="l00741"></a>00741 <span class="preprocessor"></span><span class="preprocessor">#define transporte_(som,a) transporte_ptr[som*nb_comp+a]</span>
<a name="l00742"></a>00742 <span class="preprocessor"></span>
<a name="l00743"></a>00743 <span class="preprocessor">#define resu_(som,a) resu_ptr[som*nb_comp+a]</span>
<a name="l00744"></a>00744 <span class="preprocessor"></span>
<a name="l00745"></a>00745   <span class="keywordtype">double</span> inv_nb_som_elem=1./nb_som_elem;
<a name="l00746"></a>00746   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00747"></a>00747     <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00748"></a>00748       {
<a name="l00749"></a>00749         G_e=0;
<a name="l00750"></a>00750         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00751"></a>00751           {
<a name="l00752"></a>00752             <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00753"></a>00753             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00754"></a>00754               G_e[b]+=G(glob,b);
<a name="l00755"></a>00755             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00756"></a>00756               transp_loc(i1,a)=<a class="code" href="Op__Conv__EF_8cpp.html#aec139ab06c54f3c620f1e9944627c994">transporte_</a>(glob,a);
<a name="l00757"></a>00757           }
<a name="l00758"></a>00758         G_e*=inv_nb_som_elem;
<a name="l00759"></a>00759 <span class="comment">// Cerr&lt;&lt;&quot; coucou &quot;&lt;&lt;G_e&lt;&lt;finl;</span>
<a name="l00760"></a>00760 <span class="comment">// *10 !!!!!!!!!!!</span>
<a name="l00761"></a>00761         <span class="keywordtype">double</span> vol_elem=volumes(elem);
<a name="l00762"></a>00762         <span class="keywordtype">double</span> inv_vol_elem=1./vol_elem;
<a name="l00763"></a>00763         <span class="keywordtype">double</span> pond2=volumes_thilde(elem)*inv_vol_elem*inv_vol_elem;
<a name="l00764"></a>00764 
<a name="l00765"></a>00765         <span class="keywordflow">if</span> (transport_rhou)
<a name="l00766"></a>00766           pond2 /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l00767"></a>00767         <span class="keywordtype">double</span> fpond2=f*pond2;
<a name="l00768"></a>00768 
<a name="l00769"></a>00769         <span class="keywordflow">if</span> ((<a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>)&amp;&amp;(nb_som_elem==8)&amp;&amp;(hourglass_impl==0))
<a name="l00770"></a>00770           {
<a name="l00771"></a>00771             <span class="keywordtype">double</span> pond3=f*<a class="code" href="ArrOfDouble_8cpp.html#af541bfdadae7483016c96f13760598ac" title="Produit scalaire de deux &quot;array&quot;. (dotproduct_array remplace operator* car le nom indique clairemen...">dotproduct_array</a>(G_e,G_e);
<a name="l00772"></a>00772             <span class="keywordflow">if</span> (transport_rhou) pond3 /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l00773"></a>00773             <span class="keywordflow">if</span> (is_not_lambda_unif)
<a name="l00774"></a>00774               pond3+=lambda(elem);
<a name="l00775"></a>00775             <span class="keywordflow">else</span>
<a name="l00776"></a>00776               pond3+=lambda(0,0);
<a name="l00777"></a>00777             pond3*=volumes_thilde(elem)*inv_vol_elem*pow(vol_elem,0.3333333333333333);
<a name="l00778"></a>00778             pond3*=<a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>;
<a name="l00779"></a>00779 
<a name="l00780"></a>00780             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00781"></a>00781               {
<a name="l00782"></a>00782                 <span class="keywordtype">double</span> coef2d=0.042*pond3;
<a name="l00783"></a>00783                 <span class="keywordtype">double</span> coef3d=coef2d*0.5;
<a name="l00784"></a>00784 
<a name="l00785"></a>00785                 <span class="keywordtype">double</span> t0=-coef2d*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(0,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(1,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(2,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(3,a)
<a name="l00786"></a>00786                                    +<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(4,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(5,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(6,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(7,a));
<a name="l00787"></a>00787 
<a name="l00788"></a>00788                 <span class="keywordtype">double</span> t3d=0;
<a name="l00789"></a>00789                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++) t3d+=mcoef3d[i]*<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i,a);
<a name="l00790"></a>00790                 t3d*=coef3d;
<a name="l00791"></a>00791                 <span class="keywordtype">double</span> t3db=coef3d*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(0,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(1,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(3,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(2,a)
<a name="l00792"></a>00792                                     -<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(4,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(5,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(7,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(6,a));
<a name="l00793"></a>00793                 <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(t3d,t3db,1e-6)) assert(0);
<a name="l00794"></a>00794                 <span class="comment">/*</span>
<a name="l00795"></a>00795 <span class="comment">                double t1=t0+coef2d*4.*(transp_loc_(0,a)+transp_loc_(7,a));</span>
<a name="l00796"></a>00796 <span class="comment">                double t2=t0+coef2d*4.*(transp_loc_(1,a)+transp_loc_(6,a));</span>
<a name="l00797"></a>00797 <span class="comment">                double t3=t0+coef2d*4.*(transp_loc_(3,a)+transp_loc_(4,a));</span>
<a name="l00798"></a>00798 <span class="comment">                double t4=t0+coef2d*4.*(transp_loc_(2,a)+transp_loc_(5,a));</span>
<a name="l00799"></a>00799 <span class="comment">                */</span>
<a name="l00800"></a>00800 <span class="comment">// if (elem==0) Cerr&lt;&lt;a&lt;&lt;&quot; &quot;&lt;&lt;t3d&lt;&lt;&quot; iiiiii &quot;&lt;&lt;t1&lt;&lt;&quot; &quot;&lt;&lt;pond3&lt;&lt;&quot; &quot;&lt;&lt;f&lt;&lt;finl;</span>
<a name="l00801"></a>00801                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)
<a name="l00802"></a>00802                   <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(elems(elem,i),a)-=mcoef3d[i]*t3d+t0+coef2d*4.*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(sommetoppose[i],a));
<a name="l00803"></a>00803               }
<a name="l00804"></a>00804           }
<a name="l00805"></a>00805 
<a name="l00806"></a>00806         {
<a name="l00807"></a>00807           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;nb_som_elem; yy++) ge_bij[yy]=0;
<a name="l00808"></a>00808           <span class="keywordflow">if</span> ((centre_impl==0)||(btd_impl==0))
<a name="l00809"></a>00809             {
<a name="l00810"></a>00810               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00811"></a>00811                 {
<a name="l00812"></a>00812                   <span class="keywordtype">double</span> cb=0;
<a name="l00813"></a>00813                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00814"></a>00814                     cb+=G_e[b]*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b);
<a name="l00815"></a>00815                   ge_bij[i1]=cb;
<a name="l00816"></a>00816                 }
<a name="l00817"></a>00817               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00818"></a>00818                 {
<a name="l00819"></a>00819                   <span class="keywordtype">double</span> pond=0;
<a name="l00820"></a>00820                   <span class="keywordflow">if</span> (centre_impl==0) pond=IPhi_thilde(elem,i1)*inv_vol_elem;
<a name="l00821"></a>00821                   <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00822"></a>00822 <span class="comment">// pr=0;</span>
<a name="l00823"></a>00823                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;nb_comp; yy++) pr[yy]=0;
<a name="l00824"></a>00824 
<a name="l00825"></a>00825                   <span class="keywordtype">double</span> cbbtd=pond;
<a name="l00826"></a>00826                   <span class="keywordflow">if</span> ((btd_impl==0)&amp;&amp;(<a class="code" href="classOp__Conv__EF.html#af6b1073d41da2d3fabb35ef12923cb0c">type_op</a>==<a class="code" href="classOp__Conv__EF.html#ab9734112d198e5e32e51e1efd1a9b75da3cab344cce2439325cbbaf941192caa8">amont</a>))
<a name="l00827"></a>00827                     cbbtd+=ge_bij[i1]*(fpond2);
<a name="l00828"></a>00828                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00829"></a>00829                     {
<a name="l00830"></a>00830                       <span class="keyword">const</span> <span class="keywordtype">double</span> cbi2=ge_bij[i2];
<a name="l00831"></a>00831                       <span class="keywordtype">double</span> coef=cbbtd*cbi2;
<a name="l00832"></a>00832                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00833"></a>00833                         pr[a]-=coef*<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i2,a);
<a name="l00834"></a>00834                     }
<a name="l00835"></a>00835                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00836"></a>00836                     <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(glob,a)+=pr[a];
<a name="l00837"></a>00837                 }
<a name="l00838"></a>00838             }
<a name="l00839"></a>00839         }
<a name="l00840"></a>00840       }
<a name="l00841"></a>00841 
<a name="l00842"></a>00842   fluent_.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00843"></a>00843   <span class="keywordflow">return</span> resu;
<a name="l00844"></a>00844 <span class="preprocessor">#undef bij_</span>
<a name="l00845"></a>00845 <span class="preprocessor"></span><span class="preprocessor">#undef transp_loc_</span>
<a name="l00846"></a>00846 <span class="preprocessor"></span><span class="preprocessor">#undef transporte_</span>
<a name="l00847"></a>00847 <span class="preprocessor"></span><span class="preprocessor">#undef resu_</span>
<a name="l00848"></a>00848 <span class="preprocessor"></span>}
<a name="l00849"></a>00849 
<a name="l00850"></a><a class="code" href="classOp__Conv__EF.html#a1bde072671f5f9b50859b5bcc2d24c2c">00850</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Conv__EF.html#a1bde072671f5f9b50859b5bcc2d24c2c">Op_Conv_EF::ajouter_sous_cond_dim2_nbn4_nbdim1</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte,
<a name="l00851"></a>00851                                                           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> btd_impl,<span class="keywordtype">int</span> hourglass_impl,<span class="keywordtype">int</span> centre_impl)<span class="keyword"> const</span>
<a name="l00852"></a>00852 <span class="keyword"></span>{
<a name="l00853"></a>00853   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>, <a class="code" href="classOp__Conv__EF__base.html#a4181dffa4d7fa88293cefe4458d355c1">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>());
<a name="l00854"></a>00854   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_elem=4;
<a name="l00855"></a>00855 
<a name="l00856"></a>00856 
<a name="l00857"></a>00857   <span class="keywordflow">if</span> ((btd_impl==1)&amp;&amp;(hourglass_impl==1)&amp;&amp;(centre_impl==1)) <span class="keywordflow">return</span> resu;
<a name="l00858"></a>00858 
<a name="l00859"></a>00859   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; fluent_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>, <a class="code" href="classOp__Conv__EF__base.html#aa93385542b3568832bb37ff4f8af6052" title="tableau qui sert pour le calcul du pas de temps de stabilite">fluent</a>);
<a name="l00860"></a>00860 
<a name="l00861"></a>00861   <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; la_vitesse=<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>();
<a name="l00862"></a>00862   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; G=la_vitesse.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00863"></a>00863 
<a name="l00864"></a>00864   <span class="keywordtype">int</span> transport_rhou=0;
<a name="l00865"></a>00865   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classO__U__Ptr.html#a5aae0c48048a40339f3847aa14109231" title="Renvoie ref_().le_nom() si le pointeur est non nul ou &quot;Pointeur Nul&quot;.">le_nom</a>()==<span class="stringliteral">&quot;rho_u&quot;</span>) transport_rhou=1;
<a name="l00866"></a>00866   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rho_elem=(transport_rhou==1 ? <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique_melange&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>() : \
<a name="l00867"></a>00867                              <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
<a name="l00868"></a>00868   <span class="keywordtype">int</span> is_not_rho_unif = (rho_elem.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == 1 ? 0 : 1);
<a name="l00869"></a>00869 
<a name="l00870"></a>00870   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv vitesse&quot;</span>,G);
<a name="l00871"></a>00871   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv rho&quot;</span>,rho_elem);
<a name="l00872"></a>00872   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;conv transporte&quot;</span>,transporte);
<a name="l00873"></a>00873   <span class="keywordtype">int</span> nb_comp0 = resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00874"></a>00874   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00875"></a>00875   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00876"></a>00876   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; IPhi_thilde=zone_ef.<a class="code" href="classZone__EF.html#addd84cf676a5e031153effc095d88d35">IPhi_thilde</a>();
<a name="l00877"></a>00877   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00878"></a>00878   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00879"></a>00879   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00880"></a>00880   <span class="keywordtype">double</span> f= <a class="code" href="classOp__Conv__EF.html#a8a2724583588026cbcf3a05ae541d0fc">coefficient_btd</a>();
<a name="l00881"></a>00881 
<a name="l00882"></a>00882   <span class="keywordtype">int</span> mcoef3d[8]= {1,-1,-1,1,-1,1,1,-1};
<a name="l00883"></a>00883   <span class="keywordtype">int</span> sommetoppose[8]= {7,6,5,4,3,2,1,0};
<a name="l00884"></a>00884 
<a name="l00885"></a>00885   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> transp_loc(nb_som_elem,nb_comp0);
<a name="l00886"></a>00886 <span class="comment">// A DEPLACER !!!!!</span>
<a name="l00887"></a>00887   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; lambda=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOperateur__Diff__base.html" title="classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...">Operateur_Diff_base</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(0).l_op_base()).diffusivite().valeurs();
<a name="l00888"></a>00888   <span class="keywordtype">int</span> is_not_lambda_unif=1;
<a name="l00889"></a>00889   <span class="keywordflow">if</span> (lambda.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>()==1) is_not_lambda_unif=0;
<a name="l00890"></a>00890 
<a name="l00891"></a>00891   <span class="keyword">const</span> <span class="keywordtype">int</span> const_dimension= 2;
<a name="l00892"></a>00892 <span class="comment">// const int nb_som_elem= 4;</span>
<a name="l00893"></a>00893   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=1;
<a name="l00894"></a>00894   <span class="keyword">const</span> <span class="keywordtype">int</span> dim_fois_nbn=8;
<a name="l00895"></a>00895   <span class="keywordflow">if</span> (nb_comp0!=nb_comp) <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">abort</a>();
<a name="l00896"></a>00896 
<a name="l00897"></a>00897   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> G_e(const_dimension);
<a name="l00898"></a>00898   <span class="keywordtype">double</span> pr[nb_comp],ge_bij[nb_som_elem];
<a name="l00899"></a>00899   <span class="keyword">const</span> <span class="keywordtype">double</span>* bij_ptr=bij.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00900"></a>00900   <span class="keyword">const</span> <span class="keywordtype">double</span>* transp_loc_ptr=transp_loc.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00901"></a>00901   <span class="keyword">const</span> <span class="keywordtype">double</span>* transporte_ptr=transporte.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00902"></a>00902   <span class="keywordtype">double</span>* resu_ptr=resu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00903"></a>00903 
<a name="l00904"></a>00904 <span class="preprocessor">#define bij_(elem,i,j) bij_ptr[elem*dim_fois_nbn+i*const_dimension+j]</span>
<a name="l00905"></a>00905 <span class="preprocessor"></span><span class="preprocessor">#define transp_loc_(som,a) transp_loc_ptr[som*nb_comp+a]</span>
<a name="l00906"></a>00906 <span class="preprocessor"></span><span class="preprocessor">#define transporte_(som,a) transporte_ptr[som*nb_comp+a]</span>
<a name="l00907"></a>00907 <span class="preprocessor"></span>
<a name="l00908"></a>00908 <span class="preprocessor">#define resu_(som,a) resu_ptr[som*nb_comp+a]</span>
<a name="l00909"></a>00909 <span class="preprocessor"></span>
<a name="l00910"></a>00910   <span class="keywordtype">double</span> inv_nb_som_elem=1./nb_som_elem;
<a name="l00911"></a>00911   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00912"></a>00912     <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00913"></a>00913       {
<a name="l00914"></a>00914         G_e=0;
<a name="l00915"></a>00915         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00916"></a>00916           {
<a name="l00917"></a>00917             <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00918"></a>00918             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00919"></a>00919               G_e[b]+=G(glob,b);
<a name="l00920"></a>00920             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00921"></a>00921               transp_loc(i1,a)=<a class="code" href="Op__Conv__EF_8cpp.html#aec139ab06c54f3c620f1e9944627c994">transporte_</a>(glob,a);
<a name="l00922"></a>00922           }
<a name="l00923"></a>00923         G_e*=inv_nb_som_elem;
<a name="l00924"></a>00924 <span class="comment">// Cerr&lt;&lt;&quot; coucou &quot;&lt;&lt;G_e&lt;&lt;finl;</span>
<a name="l00925"></a>00925 <span class="comment">// *10 !!!!!!!!!!!</span>
<a name="l00926"></a>00926         <span class="keywordtype">double</span> vol_elem=volumes(elem);
<a name="l00927"></a>00927         <span class="keywordtype">double</span> inv_vol_elem=1./vol_elem;
<a name="l00928"></a>00928         <span class="keywordtype">double</span> pond2=volumes_thilde(elem)*inv_vol_elem*inv_vol_elem;
<a name="l00929"></a>00929 
<a name="l00930"></a>00930         <span class="keywordflow">if</span> (transport_rhou)
<a name="l00931"></a>00931           pond2 /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l00932"></a>00932         <span class="keywordtype">double</span> fpond2=f*pond2;
<a name="l00933"></a>00933 
<a name="l00934"></a>00934         <span class="keywordflow">if</span> ((<a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>)&amp;&amp;(nb_som_elem==8)&amp;&amp;(hourglass_impl==0))
<a name="l00935"></a>00935           {
<a name="l00936"></a>00936             <span class="keywordtype">double</span> pond3=f*<a class="code" href="ArrOfDouble_8cpp.html#af541bfdadae7483016c96f13760598ac" title="Produit scalaire de deux &quot;array&quot;. (dotproduct_array remplace operator* car le nom indique clairemen...">dotproduct_array</a>(G_e,G_e);
<a name="l00937"></a>00937             <span class="keywordflow">if</span> (transport_rhou) pond3 /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l00938"></a>00938             <span class="keywordflow">if</span> (is_not_lambda_unif)
<a name="l00939"></a>00939               pond3+=lambda(elem);
<a name="l00940"></a>00940             <span class="keywordflow">else</span>
<a name="l00941"></a>00941               pond3+=lambda(0,0);
<a name="l00942"></a>00942             pond3*=volumes_thilde(elem)*inv_vol_elem*pow(vol_elem,0.3333333333333333);
<a name="l00943"></a>00943             pond3*=<a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>;
<a name="l00944"></a>00944 
<a name="l00945"></a>00945             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00946"></a>00946               {
<a name="l00947"></a>00947                 <span class="keywordtype">double</span> coef2d=0.042*pond3;
<a name="l00948"></a>00948                 <span class="keywordtype">double</span> coef3d=coef2d*0.5;
<a name="l00949"></a>00949 
<a name="l00950"></a>00950                 <span class="keywordtype">double</span> t0=-coef2d*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(0,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(1,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(2,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(3,a)
<a name="l00951"></a>00951                                    +<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(4,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(5,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(6,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(7,a));
<a name="l00952"></a>00952 
<a name="l00953"></a>00953                 <span class="keywordtype">double</span> t3d=0;
<a name="l00954"></a>00954                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++) t3d+=mcoef3d[i]*<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i,a);
<a name="l00955"></a>00955                 t3d*=coef3d;
<a name="l00956"></a>00956                 <span class="keywordtype">double</span> t3db=coef3d*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(0,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(1,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(3,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(2,a)
<a name="l00957"></a>00957                                     -<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(4,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(5,a)-<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(7,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(6,a));
<a name="l00958"></a>00958                 <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(t3d,t3db,1e-6)) assert(0);
<a name="l00959"></a>00959                 <span class="comment">/*</span>
<a name="l00960"></a>00960 <span class="comment">                double t1=t0+coef2d*4.*(transp_loc_(0,a)+transp_loc_(7,a));</span>
<a name="l00961"></a>00961 <span class="comment">                double t2=t0+coef2d*4.*(transp_loc_(1,a)+transp_loc_(6,a));</span>
<a name="l00962"></a>00962 <span class="comment">                double t3=t0+coef2d*4.*(transp_loc_(3,a)+transp_loc_(4,a));</span>
<a name="l00963"></a>00963 <span class="comment">                double t4=t0+coef2d*4.*(transp_loc_(2,a)+transp_loc_(5,a));</span>
<a name="l00964"></a>00964 <span class="comment">                */</span>
<a name="l00965"></a>00965 <span class="comment">// if (elem==0) Cerr&lt;&lt;a&lt;&lt;&quot; &quot;&lt;&lt;t3d&lt;&lt;&quot; iiiiii &quot;&lt;&lt;t1&lt;&lt;&quot; &quot;&lt;&lt;pond3&lt;&lt;&quot; &quot;&lt;&lt;f&lt;&lt;finl;</span>
<a name="l00966"></a>00966                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)
<a name="l00967"></a>00967                   <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(elems(elem,i),a)-=mcoef3d[i]*t3d+t0+coef2d*4.*(<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i,a)+<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(sommetoppose[i],a));
<a name="l00968"></a>00968               }
<a name="l00969"></a>00969           }
<a name="l00970"></a>00970 
<a name="l00971"></a>00971         {
<a name="l00972"></a>00972           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;nb_som_elem; yy++) ge_bij[yy]=0;
<a name="l00973"></a>00973           <span class="keywordflow">if</span> ((centre_impl==0)||(btd_impl==0))
<a name="l00974"></a>00974             {
<a name="l00975"></a>00975               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00976"></a>00976                 {
<a name="l00977"></a>00977                   <span class="keywordtype">double</span> cb=0;
<a name="l00978"></a>00978                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00979"></a>00979                     cb+=G_e[b]*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b);
<a name="l00980"></a>00980                   ge_bij[i1]=cb;
<a name="l00981"></a>00981                 }
<a name="l00982"></a>00982               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00983"></a>00983                 {
<a name="l00984"></a>00984                   <span class="keywordtype">double</span> pond=0;
<a name="l00985"></a>00985                   <span class="keywordflow">if</span> (centre_impl==0) pond=IPhi_thilde(elem,i1)*inv_vol_elem;
<a name="l00986"></a>00986                   <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00987"></a>00987 <span class="comment">// pr=0;</span>
<a name="l00988"></a>00988                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;nb_comp; yy++) pr[yy]=0;
<a name="l00989"></a>00989 
<a name="l00990"></a>00990                   <span class="keywordtype">double</span> cbbtd=pond;
<a name="l00991"></a>00991                   <span class="keywordflow">if</span> ((btd_impl==0)&amp;&amp;(<a class="code" href="classOp__Conv__EF.html#af6b1073d41da2d3fabb35ef12923cb0c">type_op</a>==<a class="code" href="classOp__Conv__EF.html#ab9734112d198e5e32e51e1efd1a9b75da3cab344cce2439325cbbaf941192caa8">amont</a>))
<a name="l00992"></a>00992                     cbbtd+=ge_bij[i1]*(fpond2);
<a name="l00993"></a>00993                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00994"></a>00994                     {
<a name="l00995"></a>00995                       <span class="keyword">const</span> <span class="keywordtype">double</span> cbi2=ge_bij[i2];
<a name="l00996"></a>00996                       <span class="keywordtype">double</span> coef=cbbtd*cbi2;
<a name="l00997"></a>00997                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l00998"></a>00998                         pr[a]-=coef*<a class="code" href="Op__Conv__EF_8cpp.html#aa228d44e94732f32700e1e6c23778912">transp_loc_</a>(i2,a);
<a name="l00999"></a>00999                     }
<a name="l01000"></a>01000                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l01001"></a>01001                     <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(glob,a)+=pr[a];
<a name="l01002"></a>01002                 }
<a name="l01003"></a>01003             }
<a name="l01004"></a>01004         }
<a name="l01005"></a>01005       }
<a name="l01006"></a>01006 
<a name="l01007"></a>01007   fluent_.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01008"></a>01008   <span class="keywordflow">return</span> resu;
<a name="l01009"></a>01009 <span class="preprocessor">#undef bij_</span>
<a name="l01010"></a>01010 <span class="preprocessor"></span><span class="preprocessor">#undef transp_loc_</span>
<a name="l01011"></a>01011 <span class="preprocessor"></span><span class="preprocessor">#undef transporte_</span>
<a name="l01012"></a>01012 <span class="preprocessor"></span><span class="preprocessor">#undef resu_</span>
<a name="l01013"></a>01013 <span class="preprocessor"></span>}
<a name="l01014"></a>01014 
<a name="l01015"></a>01015 
<a name="l01016"></a><a class="code" href="classOp__Conv__EF.html#a843e2b2c4d9bc3de665260b077782d26">01016</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Conv__EF.html#a843e2b2c4d9bc3de665260b077782d26">Op_Conv_EF::ajouter_sous_cond</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte,
<a name="l01017"></a>01017                                          <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> btd_impl,<span class="keywordtype">int</span> hourglass_impl,<span class="keywordtype">int</span> centre_impl)<span class="keyword"> const</span>
<a name="l01018"></a>01018 <span class="keyword"></span>{
<a name="l01019"></a>01019   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l01020"></a>01020   <span class="keywordtype">int</span> nb_som_elem=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l01021"></a>01021   <span class="keywordtype">int</span> nb_compo=transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l01022"></a>01022 
<a name="l01023"></a>01023   <span class="keywordflow">if</span> ((<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)&amp;&amp;(nb_som_elem==8))
<a name="l01024"></a>01024     {
<a name="l01025"></a>01025       <span class="keywordflow">if</span> (nb_compo==1)
<a name="l01026"></a>01026         <span class="keywordflow">return</span> <a class="code" href="classOp__Conv__EF.html#a8ba1f6f1f53d3f78f9100a5a6360e63d">ajouter_sous_cond_dim3_nbn8_nbdim1</a>(transporte,resu,btd_impl,hourglass_impl,centre_impl);
<a name="l01027"></a>01027       <span class="keywordflow">else</span>
<a name="l01028"></a>01028         <span class="keywordflow">return</span> <a class="code" href="classOp__Conv__EF.html#aee0145605af027404be5bca5000d9d65">ajouter_sous_cond_dim3_nbn8_nbdim2</a>(transporte,resu,btd_impl,hourglass_impl,centre_impl);
<a name="l01029"></a>01029     }
<a name="l01030"></a>01030   <span class="keywordflow">return</span> <a class="code" href="classOp__Conv__EF.html#a8d696fed7489bca629ff1c6381277c22">ajouter_sous_cond_gen</a>(transporte,resu,btd_impl,hourglass_impl,centre_impl);
<a name="l01031"></a>01031 }
<a name="l01032"></a>01032 
<a name="l01033"></a><a class="code" href="classOp__Conv__EF.html#a14962a4f7b3e569693f21440e11450a1">01033</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Conv__EF.html#a14962a4f7b3e569693f21440e11450a1">Op_Conv_EF::ajouter_contribution_sous_cond</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice,<span class="keywordtype">int</span> btd_impl,<span class="keywordtype">int</span> hourglass_impl,<span class="keywordtype">int</span> centre_impl )<span class="keyword"> const</span>
<a name="l01034"></a>01034 <span class="keyword"></span>{
<a name="l01035"></a>01035 
<a name="l01036"></a>01036   <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; la_vitesse=<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>();
<a name="l01037"></a>01037   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; G=la_vitesse.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l01038"></a>01038 
<a name="l01039"></a>01039   <span class="keywordtype">int</span> transport_rhou=0;
<a name="l01040"></a>01040   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classO__U__Ptr.html#a5aae0c48048a40339f3847aa14109231" title="Renvoie ref_().le_nom() si le pointeur est non nul ou &quot;Pointeur Nul&quot;.">le_nom</a>()==<span class="stringliteral">&quot;rho_u&quot;</span>) transport_rhou=1;
<a name="l01041"></a>01041 
<a name="l01042"></a>01042   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rho_elem=(transport_rhou==1 ? <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique_melange&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>() : \
<a name="l01043"></a>01043                              <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
<a name="l01044"></a>01044   <span class="keywordtype">int</span> is_not_rho_unif = (rho_elem.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == 1 ? 0 : 1);
<a name="l01045"></a>01045 
<a name="l01046"></a>01046   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l01047"></a>01047   <span class="keywordtype">int</span> nb_comp = transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l01048"></a>01048   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l01049"></a>01049   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l01050"></a>01050   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; IPhi_thilde=zone_ef.<a class="code" href="classZone__EF.html#addd84cf676a5e031153effc095d88d35">IPhi_thilde</a>();
<a name="l01051"></a>01051 
<a name="l01052"></a>01052   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l01053"></a>01053   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l01054"></a>01054   <span class="keywordtype">int</span> nb_som_elem=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l01055"></a>01055   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l01056"></a>01056   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> G_e(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l01057"></a>01057 
<a name="l01058"></a>01058   <span class="keywordtype">double</span> f=<a class="code" href="classOp__Conv__EF.html#a8a2724583588026cbcf3a05ae541d0fc">coefficient_btd</a>();
<a name="l01059"></a>01059 <span class="comment">// DoubleTab transp_loc(nb_som_elem,nb_comp);</span>
<a name="l01060"></a>01060 <span class="comment">// A DEPLACER !!!!!</span>
<a name="l01061"></a>01061   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; lambda=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOperateur__Diff__base.html" title="classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...">Operateur_Diff_base</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(0).l_op_base()).diffusivite().valeurs();
<a name="l01062"></a>01062   <span class="keywordtype">int</span> is_not_lambda_unif=1;
<a name="l01063"></a>01063   <span class="keywordflow">if</span> (lambda.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>()==1)
<a name="l01064"></a>01064     is_not_lambda_unif=0;
<a name="l01065"></a>01065 
<a name="l01066"></a>01066   <span class="keywordtype">int</span> mcoef3d[8]= {1,-1,-1,1,-1,1,1,-1};
<a name="l01067"></a>01067   <span class="keywordtype">int</span> sommetoppose[8]= {7,6,5,4,3,2,1,0};
<a name="l01068"></a>01068   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l01069"></a>01069     <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l01070"></a>01070       {
<a name="l01071"></a>01071         G_e=0;
<a name="l01072"></a>01072         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l01073"></a>01073           {
<a name="l01074"></a>01074             <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l01075"></a>01075             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; b++)
<a name="l01076"></a>01076               G_e(b)+=G(glob,b);
<a name="l01077"></a>01077           }
<a name="l01078"></a>01078         G_e/=nb_som_elem;
<a name="l01079"></a>01079 
<a name="l01080"></a>01080         <span class="keywordtype">double</span> pond2=volumes_thilde(elem)/volumes(elem)/volumes(elem);
<a name="l01081"></a>01081 
<a name="l01082"></a>01082         <span class="keywordflow">if</span> (transport_rhou) pond2 /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l01083"></a>01083 
<a name="l01084"></a>01084         <span class="keywordflow">if</span> ((<a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>)&amp;&amp;(nb_som_elem==8)&amp;&amp;(hourglass_impl==1))
<a name="l01085"></a>01085           {
<a name="l01086"></a>01086             <span class="keywordtype">double</span> pond3=f*<a class="code" href="ArrOfDouble_8cpp.html#af541bfdadae7483016c96f13760598ac" title="Produit scalaire de deux &quot;array&quot;. (dotproduct_array remplace operator* car le nom indique clairemen...">dotproduct_array</a>(G_e,G_e);
<a name="l01087"></a>01087             <span class="keywordflow">if</span> (transport_rhou) pond3 /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l01088"></a>01088             <span class="keywordflow">if</span> (is_not_lambda_unif)
<a name="l01089"></a>01089               pond3+=lambda(elem);
<a name="l01090"></a>01090             <span class="keywordflow">else</span>
<a name="l01091"></a>01091               pond3+=lambda(0,0);
<a name="l01092"></a>01092             pond3*=volumes_thilde(elem)/volumes(elem)*pow(volumes(elem),0.3333333333333333);
<a name="l01093"></a>01093             pond3*=<a class="code" href="classOp__Conv__EF.html#a0bef9faac14750f2e1b3cd23714f8428">hourglass</a>;
<a name="l01094"></a>01094 
<a name="l01095"></a>01095             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l01096"></a>01096               {
<a name="l01097"></a>01097                 <span class="keywordtype">double</span> coef2d=0.042*pond3;
<a name="l01098"></a>01098                 <span class="keywordtype">double</span> coef3d=coef2d*0.5;
<a name="l01099"></a>01099 
<a name="l01100"></a>01100                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;8; i1++)
<a name="l01101"></a>01101                   {
<a name="l01102"></a>01102                     <span class="keywordtype">int</span> n1=elems(elem,i1)*nb_comp+a;
<a name="l01103"></a>01103                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;8; i2++)
<a name="l01104"></a>01104                       {
<a name="l01105"></a>01105                         <span class="keywordtype">int</span> n2=elems(elem,i2)*nb_comp+a;
<a name="l01106"></a>01106                         matrice.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>(n1,n2)+=mcoef3d[i1]*mcoef3d[i2]*coef3d-coef2d;
<a name="l01107"></a>01107                       }
<a name="l01108"></a>01108                     matrice.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>(n1,n1)+=coef2d*4.;
<a name="l01109"></a>01109                     matrice.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>(n1,elems(elem,sommetoppose[i1])*nb_comp+a)+=coef2d*4.;
<a name="l01110"></a>01110                   }
<a name="l01111"></a>01111               }
<a name="l01112"></a>01112           }
<a name="l01113"></a>01113 
<a name="l01114"></a>01114         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l01115"></a>01115           {
<a name="l01116"></a>01116             <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l01117"></a>01117 
<a name="l01118"></a>01118             <span class="keywordflow">if</span> (((btd_impl==1)&amp;&amp;(<a class="code" href="classOp__Conv__EF.html#af6b1073d41da2d3fabb35ef12923cb0c">type_op</a>==<a class="code" href="classOp__Conv__EF.html#ab9734112d198e5e32e51e1efd1a9b75da3cab344cce2439325cbbaf941192caa8">amont</a>))||(centre_impl==1))
<a name="l01119"></a>01119               {
<a name="l01120"></a>01120                 <span class="keywordtype">double</span> cb=0;
<a name="l01121"></a>01121                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; b++)
<a name="l01122"></a>01122                   cb+=G_e(b)*bij(elem,i1,b);
<a name="l01123"></a>01123                 cb*=(f*pond2);
<a name="l01124"></a>01124                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l01125"></a>01125                   {
<a name="l01126"></a>01126                     <span class="keywordtype">int</span> glob2=elems(elem,i2);
<a name="l01127"></a>01127 
<a name="l01128"></a>01128                     <span class="keywordtype">double</span> ca=0;
<a name="l01129"></a>01129                     <span class="keywordflow">if</span> (centre_impl==1)
<a name="l01130"></a>01130                       {
<a name="l01131"></a>01131                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; b++)
<a name="l01132"></a>01132                           ca+=G_e(b)*bij(elem,i2,b);
<a name="l01133"></a>01133                         <span class="keywordtype">double</span> pond=IPhi_thilde(elem,i1)/volumes(elem);
<a name="l01134"></a>01134 
<a name="l01135"></a>01135                         ca*=pond;
<a name="l01136"></a>01136                       }
<a name="l01137"></a>01137                     <span class="keywordtype">double</span> cc=0;
<a name="l01138"></a>01138                     <span class="keywordflow">if</span> ((btd_impl==1)&amp;&amp;(<a class="code" href="classOp__Conv__EF.html#af6b1073d41da2d3fabb35ef12923cb0c">type_op</a>==<a class="code" href="classOp__Conv__EF.html#ab9734112d198e5e32e51e1efd1a9b75da3cab344cce2439325cbbaf941192caa8">amont</a>))
<a name="l01139"></a>01139                       {
<a name="l01140"></a>01140                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; c++)
<a name="l01141"></a>01141                           cc+=G_e(c)*bij(elem,i2,c);
<a name="l01142"></a>01142                         cc*=cb;
<a name="l01143"></a>01143                       }
<a name="l01144"></a>01144 <span class="comment">// resu(glob)-=cc*cb*transp_loc(i2,0);</span>
<a name="l01145"></a>01145                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;nb_comp; a++)
<a name="l01146"></a>01146                       {
<a name="l01147"></a>01147                         <span class="keywordtype">int</span> n1=glob*nb_comp+a;
<a name="l01148"></a>01148                         <span class="keywordtype">int</span> n2=glob2*nb_comp+a;
<a name="l01149"></a>01149                         matrice.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>(n1,n2)+=cc+ca;
<a name="l01150"></a>01150 
<a name="l01151"></a>01151                       }
<a name="l01152"></a>01152                   }
<a name="l01153"></a>01153               }
<a name="l01154"></a>01154           }
<a name="l01155"></a>01155       }
<a name="l01156"></a>01156   <span class="keywordflow">return</span>;
<a name="l01157"></a>01157 }
<a name="l01158"></a>01158 
<a name="l01159"></a><a class="code" href="classOp__Conv__EF.html#aaf58d7bd3fb9fde8eab7c3e5c88091bb">01159</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Conv__EF.html#aaf58d7bd3fb9fde8eab7c3e5c88091bb">Op_Conv_EF::ajouter_contribution</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice )<span class="keyword"> const</span>
<a name="l01160"></a>01160 <span class="keyword"></span>{
<a name="l01161"></a>01161   <span class="keywordflow">return</span> <a class="code" href="classOp__Conv__EF.html#a14962a4f7b3e569693f21440e11450a1">ajouter_contribution_sous_cond</a>(transporte,matrice,(<a class="code" href="classOp__Conv__EF.html#aad213768e53dd2ead0ac9f0554300bfb">btd_impl_</a>)&amp;&amp;(<a class="code" href="classOp__Conv__EF.html#a92cfa1fb25cc3c4e08407f73803d7ee9">btd_hors_conv_</a>==0),(<a class="code" href="classOp__Conv__EF.html#ad3db522667ddc56c48ed6e9e74c11606">hourglass_impl_</a>)&amp;&amp;(<a class="code" href="classOp__Conv__EF.html#a0fd689419f4b31be5dda6d2e1b29f6cb">hourglass_hors_conv_</a>==0),<a class="code" href="classOp__Conv__EF.html#a0849a62e83511b82512742ded6db229a" title="flag pour savoir si les termes sont implicites">centre_impl_</a>);
<a name="l01162"></a>01162 }
<a name="l01163"></a>01163 
<a name="l01164"></a><a class="code" href="classOp__Conv__EF.html#ac18883b1667d6d0f07540f89e9efa831">01164</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Conv__EF.html#ac18883b1667d6d0f07540f89e9efa831">Op_Conv_EF::ajouter_contribution_a_la_diffusion</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice )<span class="keyword"> const</span>
<a name="l01165"></a>01165 <span class="keyword"></span>{
<a name="l01166"></a>01166   <a class="code" href="classOp__Conv__EF.html#a14962a4f7b3e569693f21440e11450a1">ajouter_contribution_sous_cond</a>(transporte,matrice,(<a class="code" href="classOp__Conv__EF.html#aad213768e53dd2ead0ac9f0554300bfb">btd_impl_</a>)&amp;&amp;(<a class="code" href="classOp__Conv__EF.html#a92cfa1fb25cc3c4e08407f73803d7ee9">btd_hors_conv_</a>==1),(<a class="code" href="classOp__Conv__EF.html#ad3db522667ddc56c48ed6e9e74c11606">hourglass_impl_</a>)&amp;&amp;(<a class="code" href="classOp__Conv__EF.html#a0fd689419f4b31be5dda6d2e1b29f6cb">hourglass_hors_conv_</a>==1),0);
<a name="l01167"></a>01167 }
<a name="l01168"></a>01168 
<a name="l01169"></a><a class="code" href="classOp__Conv__EF.html#a47d7dbd31177020eef9e682fafe767f8">01169</a> <span class="keywordtype">double</span> <a class="code" href="classOp__Conv__EF.html#a47d7dbd31177020eef9e682fafe767f8" title="Calcul dt_stab.">Op_Conv_EF::calculer_dt_stab</a>()<span class="keyword"> const</span>
<a name="l01170"></a>01170 <span class="keyword"></span>{
<a name="l01171"></a>01171   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF.html#a1678395576cd863d74af0bdada354c3b">calcul_dt_stab_</a>==0) <span class="keywordflow">return</span>  <a class="code" href="classOp__Conv__EF.html#a47d7dbd31177020eef9e682fafe767f8" title="Calcul dt_stab.">Operateur_base::calculer_dt_stab</a>();
<a name="l01172"></a>01172 
<a name="l01173"></a>01173   <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; la_vitesse=<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>();
<a name="l01174"></a>01174   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; G=la_vitesse.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l01175"></a>01175 
<a name="l01176"></a>01176   <span class="keywordtype">int</span> transport_rhou=0;
<a name="l01177"></a>01177   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__base.html#a048af7ee0fd0eb5f752ab621f3412cb6">vitesse_</a>.<a class="code" href="classO__U__Ptr.html#a5aae0c48048a40339f3847aa14109231" title="Renvoie ref_().le_nom() si le pointeur est non nul ou &quot;Pointeur Nul&quot;.">le_nom</a>()==<span class="stringliteral">&quot;rho_u&quot;</span>) transport_rhou=1;
<a name="l01178"></a>01178 
<a name="l01179"></a>01179   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rho_elem=(transport_rhou==1 ? <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique_melange&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>() : \
<a name="l01180"></a>01180                              <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
<a name="l01181"></a>01181   <span class="keywordtype">int</span> is_not_rho_unif = (rho_elem.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == 1 ? 0 : 1);
<a name="l01182"></a>01182 
<a name="l01183"></a>01183   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l01184"></a>01184   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; valeurs_diffusivite = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOperateur__Diff__base.html" title="classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...">Operateur_Diff_base</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(0).l_op_base()).diffusivite().valeurs();
<a name="l01185"></a>01185   <span class="keywordtype">int</span> is_not_lambda_unif = (valeurs_diffusivite.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == 1 ? 0 : 1);
<a name="l01186"></a>01186 
<a name="l01187"></a>01187   <span class="keywordtype">int</span> autre_eq=0;
<a name="l01188"></a>01188   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; valeurs_diffusivite_p = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOperateur__Diff__base.html" title="classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...">Operateur_Diff_base</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().probleme().<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>(autre_eq).operateur(0).l_op_base()).diffusivite().valeurs();
<a name="l01189"></a>01189   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF.html#a1678395576cd863d74af0bdada354c3b">calcul_dt_stab_</a>==2)
<a name="l01190"></a>01190     {
<a name="l01191"></a>01191       <span class="keywordflow">if</span> (&amp;valeurs_diffusivite_p == &amp;valeurs_diffusivite)
<a name="l01192"></a>01192         autre_eq=1;
<a name="l01193"></a>01193     }
<a name="l01194"></a>01194   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; valeurs_diffusivite_2 = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOperateur__Diff__base.html" title="classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...">Operateur_Diff_base</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().probleme().<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>(autre_eq).operateur(0).l_op_base()).diffusivite().valeurs();
<a name="l01195"></a>01195 
<a name="l01196"></a>01196   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>();
<a name="l01197"></a>01197 
<a name="l01198"></a>01198   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l01199"></a>01199   <span class="keywordtype">int</span> nb_som_elem=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l01200"></a>01200   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l01201"></a>01201   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> G_e(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l01202"></a>01202   <a class="code" href="classOp__Conv__EF.html#addb861acb56bcf446418030b4d868e20">max_ue_</a>=1e-8 ; <span class="comment">//!&lt; comme G2</span>
<a name="l01203"></a>01203 <span class="comment"></span>  <a class="code" href="classOp__Conv__EF.html#a60549d6d5a02155aa97167dc94309532">min_dx_</a>=1e37;
<a name="l01204"></a>01204   <span class="keywordtype">double</span> Max=0;
<a name="l01205"></a>01205   <span class="keywordtype">double</span> dt_l=0,dt2=0;
<a name="l01206"></a>01206   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l01207"></a>01207     <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l01208"></a>01208       {
<a name="l01209"></a>01209         G_e=0;
<a name="l01210"></a>01210         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l01211"></a>01211           {
<a name="l01212"></a>01212             <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l01213"></a>01213             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; b++)
<a name="l01214"></a>01214               G_e(b)+=G(glob,b);
<a name="l01215"></a>01215           }
<a name="l01216"></a>01216         G_e/=nb_som_elem;
<a name="l01217"></a>01217 <span class="comment">// if (transport_rhou)  G_e/=rho_elem(elem);</span>
<a name="l01218"></a>01218         <span class="keywordtype">double</span> ml=0;
<a name="l01219"></a>01219         <span class="keywordtype">double</span> dx2;
<a name="l01220"></a>01220 <span class="comment">// pas de temps de diffusion !!</span>
<a name="l01221"></a>01221         <span class="keywordtype">double</span> ml2=0;
<a name="l01222"></a>01222         <span class="keywordtype">double</span> vx[3];
<a name="l01223"></a>01223         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;3; d++)
<a name="l01224"></a>01224           {
<a name="l01225"></a>01225             dx2=<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(coord(elems(elem,0),d)-coord(elems(elem,7),d));
<a name="l01226"></a>01226             dx2+=<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(coord(elems(elem,1),d)-coord(elems(elem,6),d));
<a name="l01227"></a>01227             dx2+=<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(coord(elems(elem,2),d)-coord(elems(elem,5),d));
<a name="l01228"></a>01228             dx2+=<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(coord(elems(elem,3),d)-coord(elems(elem,4),d));
<a name="l01229"></a>01229             dx2*=0.25;
<a name="l01230"></a>01230             dx2*=dx2;
<a name="l01231"></a>01231 
<a name="l01232"></a>01232             ml2+=dx2;
<a name="l01233"></a>01233 <span class="comment">// double p=G_e(d)*G_e(d)/dx2;</span>
<a name="l01234"></a>01234             ml+=G_e(d)*G_e(d)/dx2;
<a name="l01235"></a>01235             vx[d]=G_e(d)*G_e(d);
<a name="l01236"></a>01236           }
<a name="l01237"></a>01237 
<a name="l01238"></a>01238         <span class="keywordtype">double</span> diffu=(is_not_lambda_unif?valeurs_diffusivite(elem):valeurs_diffusivite(0));
<a name="l01239"></a>01239 
<a name="l01240"></a>01240         <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF.html#a1678395576cd863d74af0bdada354c3b">calcul_dt_stab_</a>==2)
<a name="l01241"></a>01241           {
<a name="l01242"></a>01242             <span class="keywordtype">double</span> diffu2=(is_not_lambda_unif?valeurs_diffusivite_2(elem):valeurs_diffusivite_2(0));
<a name="l01243"></a>01243             <span class="keywordflow">if</span> (diffu2&lt;diffu)
<a name="l01244"></a>01244               diffu=diffu2;
<a name="l01245"></a>01245           }
<a name="l01246"></a>01246         diffu /= (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l01247"></a>01247 
<a name="l01248"></a>01248 <span class="comment">// horreur pour NR G2 cas clotaire</span>
<a name="l01249"></a>01249 <span class="comment">// diffu*=0.5;</span>
<a name="l01250"></a>01250 <span class="comment">// if (elem==0) Cerr&lt;&lt;&quot;uu &quot;&lt;&lt;diffu&lt;&lt;finl;</span>
<a name="l01251"></a>01251         <span class="keywordflow">if</span> (transport_rhou)
<a name="l01252"></a>01252           {
<a name="l01253"></a>01253             <span class="keywordtype">double</span> rho_e = (is_not_rho_unif ? rho_elem(elem) : rho_elem(0,0));
<a name="l01254"></a>01254             <span class="keywordtype">double</span> inv_rho2= rho_e*rho_e;
<a name="l01255"></a>01255             inv_rho2=1./inv_rho2;
<a name="l01256"></a>01256             ml*=inv_rho2;
<a name="l01257"></a>01257             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; d++)
<a name="l01258"></a>01258               vx[d]*=inv_rho2;
<a name="l01259"></a>01259           }
<a name="l01260"></a>01260 <span class="comment">// le .5* c&#39;est pour avoir le meme dt que g2 mais faux</span>
<a name="l01261"></a>01261         <span class="keywordtype">double</span> dxe=sqrt(ml2);
<a name="l01262"></a>01262         <span class="keywordflow">if</span> (dxe&lt;<a class="code" href="classOp__Conv__EF.html#a60549d6d5a02155aa97167dc94309532">min_dx_</a>)
<a name="l01263"></a>01263           <a class="code" href="classOp__Conv__EF.html#a60549d6d5a02155aa97167dc94309532">min_dx_</a>=dxe;
<a name="l01264"></a>01264         ml2=diffu/ml2;
<a name="l01265"></a>01265         ml*=<a class="code" href="classOp__Conv__EF.html#a9ac703b912c82db19c86f97ede4d749d">btd_</a>;
<a name="l01266"></a>01266         ml=sqrt(ml2*ml2+ml)+ml2+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>;
<a name="l01267"></a>01267         <span class="comment">/*      if (ml2&gt;0)</span>
<a name="l01268"></a>01268 <span class="comment">        ml=ml/(sqrt(ml2*ml2+ml)-ml2);</span>
<a name="l01269"></a>01269 <span class="comment">        else ml=-1.;</span>
<a name="l01270"></a>01270 <span class="comment">        */</span>
<a name="l01271"></a>01271         <span class="keywordflow">if</span> (ml &gt; Max) Max=ml;
<a name="l01272"></a>01272         <span class="keywordtype">double</span> ue=sqrt(vx[0]+vx[1]+vx[2]);
<a name="l01273"></a>01273         <span class="keywordflow">if</span> (ue&gt;<a class="code" href="classOp__Conv__EF.html#addb861acb56bcf446418030b4d868e20">max_ue_</a>) <a class="code" href="classOp__Conv__EF.html#addb861acb56bcf446418030b4d868e20">max_ue_</a>=ue;
<a name="l01274"></a>01274 
<a name="l01275"></a>01275         dt_l= 1./(Max+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l01276"></a>01276 
<a name="l01277"></a>01277         <span class="keywordflow">if</span> (elem==0) dt2=dt_l;
<a name="l01278"></a>01278         <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF.html#a9ac703b912c82db19c86f97ede4d749d">btd_</a>!=3.)
<a name="l01279"></a>01279           {
<a name="l01280"></a>01280             <span class="keywordtype">double</span> dt0=dt2;
<a name="l01281"></a>01281             <span class="keywordtype">double</span> s=1.;
<a name="l01282"></a>01282             <span class="keywordflow">while</span>(s&gt;0)
<a name="l01283"></a>01283               {
<a name="l01284"></a>01284                 s=-1;
<a name="l01285"></a>01285                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; d++)
<a name="l01286"></a>01286                   {
<a name="l01287"></a>01287                     <span class="keywordtype">double</span> c=vx[d]*dt0;
<a name="l01288"></a>01288                     <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(c)&gt;1e-16)
<a name="l01289"></a>01289                       s+=c/(2.*diffu  +c*<a class="code" href="classOp__Conv__EF.html#a9ac703b912c82db19c86f97ede4d749d">btd_</a>);
<a name="l01290"></a>01290                   }
<a name="l01291"></a>01291                 <span class="keywordflow">if</span> (s&gt;0)
<a name="l01292"></a>01292                   {
<a name="l01293"></a>01293                     dt0*=0.9;
<a name="l01294"></a>01294                     <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;elem&lt;&lt;<span class="stringliteral">&quot; &quot;</span> &lt;&lt;dt_l&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;s&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;dt0&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01295"></a>01295                     <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01296"></a>01296                   }
<a name="l01297"></a>01297               }
<a name="l01298"></a>01298             dt2=<a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(dt2,dt0);
<a name="l01299"></a>01299             dt_l=<a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(dt2,dt_l);
<a name="l01300"></a>01300           }
<a name="l01301"></a>01301       }
<a name="l01302"></a>01302   <a class="code" href="classOp__Conv__EF.html#a60549d6d5a02155aa97167dc94309532">min_dx_</a>=<a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_min</a>(<a class="code" href="classOp__Conv__EF.html#a60549d6d5a02155aa97167dc94309532">min_dx_</a>);
<a name="l01303"></a>01303   <a class="code" href="classOp__Conv__EF.html#addb861acb56bcf446418030b4d868e20">max_ue_</a>=<a class="code" href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d" title="Calcule le max de x sur tous les processeurs du groupe courant. Remarques : Cette methode doit etre a...">mp_max</a>(<a class="code" href="classOp__Conv__EF.html#addb861acb56bcf446418030b4d868e20">max_ue_</a>);
<a name="l01304"></a>01304   <a class="code" href="classOp__Conv__EF.html#a381e526d26f897a67f0c19048dfad484">coefficient_correcteur_supg_</a>.<a class="code" href="classChamp__Don__base.html#a17e3161b4b8cbf51a5029bba45ac758b" title="Fixe le nombre de composantes et le nombre de valeurs nodales.">dimensionner</a>(1,1);
<a name="l01305"></a>01305   <a class="code" href="classOp__Conv__EF.html#a381e526d26f897a67f0c19048dfad484">coefficient_correcteur_supg_</a>(0,0)=<a class="code" href="classOp__Conv__EF.html#a60549d6d5a02155aa97167dc94309532">min_dx_</a>/<a class="code" href="classOp__Conv__EF.html#addb861acb56bcf446418030b4d868e20">max_ue_</a>;
<a name="l01306"></a>01306   <span class="keywordtype">double</span> dt_stab=dt_l;
<a name="l01307"></a>01307   dt_stab = <a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_min</a>(dt_stab);
<a name="l01308"></a>01308 <span class="comment">// astuce pour contourner le type const de la methode</span>
<a name="l01309"></a>01309   <a class="code" href="classOp__Conv__EF__base.html" title="class Op_Conv_EF_base Classe de base des operateurs de convection EF">Op_Conv_EF_base</a>&amp; op = <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classOp__Conv__EF__base.html" title="class Op_Conv_EF_base Classe de base des operateurs de convection EF">Op_Conv_EF_base</a>,*<span class="keyword">this</span>);
<a name="l01310"></a>01310   op.<a class="code" href="classOperateur__Conv__base.html#a868dd39f29b4f613ec620fe5ada95977">fixer_dt_stab_conv</a>(dt_stab);
<a name="l01311"></a>01311 
<a name="l01312"></a>01312   <span class="keywordflow">return</span> dt_stab;
<a name="l01313"></a>01313 }
<a name="l01314"></a>01314 
<a name="l01315"></a><a class="code" href="classOp__Conv__EF.html#a6f7723749230a882a357dc0cb70d8aab">01315</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Conv__EF.html#a6f7723749230a882a357dc0cb70d8aab">Op_Conv_EF::contribue_au_second_membre</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu )<span class="keyword"> const</span>
<a name="l01316"></a>01316 <span class="keyword"></span>{
<a name="l01317"></a>01317 <span class="comment">// on a rien implicite</span>
<a name="l01318"></a>01318   <a class="code" href="classOp__Conv__EF.html#a843e2b2c4d9bc3de665260b077782d26">ajouter_sous_cond</a>(<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().inconnue().valeurs(),resu,((<a class="code" href="classOp__Conv__EF.html#a92cfa1fb25cc3c4e08407f73803d7ee9">btd_hors_conv_</a>==1)||<a class="code" href="classOp__Conv__EF.html#aad213768e53dd2ead0ac9f0554300bfb">btd_impl_</a>),((<a class="code" href="classOp__Conv__EF.html#a0fd689419f4b31be5dda6d2e1b29f6cb">hourglass_hors_conv_</a>==1)||<a class="code" href="classOp__Conv__EF.html#ad3db522667ddc56c48ed6e9e74c11606">hourglass_impl_</a>),<a class="code" href="classOp__Conv__EF.html#a0849a62e83511b82512742ded6db229a" title="flag pour savoir si les termes sont implicites">centre_impl_</a>);
<a name="l01319"></a>01319 }
<a name="l01320"></a>01320 
<a name="l01321"></a><a class="code" href="classOp__Conv__EF.html#af8960c0fa034348f7f233617715ffc07">01321</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Conv__EF.html#af8960c0fa034348f7f233617715ffc07">Op_Conv_EF::contribue_au_second_membre_a_la_diffusion</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu )<span class="keyword"> const</span>
<a name="l01322"></a>01322 <span class="keyword"></span>{
<a name="l01323"></a>01323   <a class="code" href="classOp__Conv__EF.html#a843e2b2c4d9bc3de665260b077782d26">ajouter_sous_cond</a>(<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().inconnue().valeurs(),resu,((<a class="code" href="classOp__Conv__EF.html#a92cfa1fb25cc3c4e08407f73803d7ee9">btd_hors_conv_</a>==0)||<a class="code" href="classOp__Conv__EF.html#aad213768e53dd2ead0ac9f0554300bfb">btd_impl_</a>),((<a class="code" href="classOp__Conv__EF.html#a0fd689419f4b31be5dda6d2e1b29f6cb">hourglass_hors_conv_</a>==0)||<a class="code" href="classOp__Conv__EF.html#ad3db522667ddc56c48ed6e9e74c11606">hourglass_impl_</a>),1);
<a name="l01324"></a>01324 }
<a name="l01325"></a>01325 
<a name="l01326"></a><a class="code" href="classOp__Conv__EF.html#a1713d3b9379f13a6ee344811d4eec051">01326</a> <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; <a class="code" href="classOp__Conv__EF.html#a1713d3b9379f13a6ee344811d4eec051">Op_Conv_EF::get_champ</a>(<span class="keyword">const</span> <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>&amp; nom)<span class="keyword"> const</span>
<a name="l01327"></a>01327 <span class="keyword"></span>{
<a name="l01328"></a>01328   <span class="keywordflow">if</span> (nom==<span class="stringliteral">&quot;coefficient_correcteur_supg&quot;</span>)
<a name="l01329"></a>01329     <span class="keywordflow">return</span> <a class="code" href="classOp__Conv__EF.html#a381e526d26f897a67f0c19048dfad484">coefficient_correcteur_supg_</a>;
<a name="l01330"></a>01330   <span class="keywordflow">return</span> <a class="code" href="classOp__Conv__EF.html#a1713d3b9379f13a6ee344811d4eec051">Op_Conv_EF_base::get_champ</a>(nom);
<a name="l01331"></a>01331 }
<a name="l01332"></a>01332 
<a name="l01333"></a>01333 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:11 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
