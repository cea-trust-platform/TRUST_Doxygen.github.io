<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: Champ_P1NC_implementation Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#friends">Friends</a>  </div>
  <div class="headertitle">
<div class="title">Champ_P1NC_implementation Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Champ_P1NC_implementation" --><!-- doxytag: inherits="Champ_implementation" -->
<p><code>#include &lt;<a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Champ_P1NC_implementation:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classChamp__P1NC__implementation.png" usemap="#Champ_P1NC_implementation_map" alt=""/>
  <map id="Champ_P1NC_implementation_map" name="Champ_P1NC_implementation_map">
<area href="classChamp__implementation.html" alt="Champ_implementation" shape="rect" coords="95,0,275,24"/>
<area href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC" alt="Champ_Fonc_P1NC" shape="rect" coords="0,112,180,136"/>
<area href="classChamp__P1NC.html" alt="Champ_P1NC" shape="rect" coords="190,112,370,136"/>
<area href="classCorrelation__Vec__Sca__VEF.html" title="classe Correlation_Vec_Sca_VEF" alt="Correlation_Vec_Sca_VEF" shape="rect" coords="0,168,180,192"/>
</map>
 </div></div>

<p><a href="classChamp__P1NC__implementation-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a562aaf721cd09c383b02b487a497df28">Champ_P1NC_implementation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a2a4f21d4b5b1fb270bdd8cb5022a0f15">~Champ_P1NC_implementation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a0418cc42fde4d3786ade386b5b816e8f">fixer_nb_valeurs_nodales</a> (int)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#ad022e7402ec857c8ecc9fd28d241fbea">fonction_forme_2D</a> (double x, double y, int le_poly, int face, const <a class="el" href="classIntTab.html">IntTab</a> &amp;sommet_poly, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;coord) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a7323420ee0d88c663808c2bd578ca2f4">fonction_forme_3D</a> (double x, double y, double z, int le_poly, int face, const <a class="el" href="classIntTab.html">IntTab</a> &amp;sommet_poly, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;coord) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#afca68bf9ab7b22877d7cfffcebc1115a">coord_barycentrique</a> (const <a class="el" href="classIntTab.html">IntTab</a> &amp;sommet_poly, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;coord, double x, double y, int le_poly, int face) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a6da2dafcd0da126d029c56700a485c44">coord_barycentrique</a> (const <a class="el" href="classIntTab.html">IntTab</a> &amp;sommet_poly, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;coord, double x, double y, double z, int le_poly, int face) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a01bdd73486d6a13644d1b3de226fbde4">valeur_a_elem</a> (const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;position, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;val, int le_poly) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#acacb4869ebabcb4fc4200aa604aa39bb">valeur_a_elem_compo</a> (const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;position, int le_poly, int ncomp) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a22d053851c997e080bc189f57d99a088">valeur_aux_elems</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;positions, const <a class="el" href="classIntVect.html">IntVect</a> &amp;les_polys, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;valeurs) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a6f97c08115ccb64a29832595a27041c0">valeur_aux_elems_compo</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;positions, const <a class="el" href="classIntVect.html">IntVect</a> &amp;les_polys, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;valeurs, int ncomp) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#aae75b2a451bacac1b78d3e5192d9e885">valeur_aux_sommets</a> (const <a class="el" href="classDomaine.html">Domaine</a> &amp;dom, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;ch_som) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a81463cf6fd9628251179b3e24ccbd803">valeur_aux_sommets_compo</a> (const <a class="el" href="classDomaine.html">Domaine</a> &amp;dom, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;ch_som, int ncomp) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#af03937cefb3ed641c5223a7a00fcb778">valeur_a_sommet_compo</a> (int num_som, int le_poly, int ncomp) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a8426620eca950b7ee6ff0b87bbb4ec64">valeur_aux_elems_smooth</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;positions, const <a class="el" href="classIntVect.html">IntVect</a> &amp;les_polys, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;valeurs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a2a41177f98eed27e4f08c03a9cf21358">valeur_aux_elems_compo_smooth</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;positions, const <a class="el" href="classIntVect.html">IntVect</a> &amp;les_polys, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;valeurs, int ncomp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a505f58ef53b201e637aae905fd85e0cc">remplir_coord_noeuds</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;positions) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a6fe1d5532cedc49f51a3c3608dbc2651">remplir_coord_noeuds_et_polys</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;positions, <a class="el" href="classIntVect.html">IntVect</a> &amp;polys) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#afd4bec4f5b250ce173225d6b6a8c5c22">imprime_P1NC</a> (<a class="el" href="classSortie.html">Sortie</a> &amp;, int) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#ab18ebd7f3cd91fb4e4db5cc8bf937ab3">filtrer_L2</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#aad8fd6dedb1f6f558e0c311df0b0db1d">filtrer_H1</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a01f966100fd849a80c9d9411e4ffb5e8">filtrer_resu</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#af1dfbfbb6b563d129a0320f96b02b6b6">get_MatP1NC2P1_L2</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classSolveurSys.html">SolveurSys</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a50e371e52c749c39ea58266b00b68896">get_solveur_L2</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a163afe69951edab9eaef1d70283d0245">filtrer_L2_H1</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a79f1a8c0e97b69d3da581a9b092be668">get_MatP1NC2P1_L2_H1</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a6b6b91437d42c304b9b27d85a8c6c0c5">get_MatP1NC2P1_H1</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classSolveurSys.html">SolveurSys</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a7e67a830f99e4f6e588a0b6ec23ebf4e">get_solveur_L2_H1</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classSolveurSys.html">SolveurSys</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a2811ab346e8816a8efc1debea4e85342">get_solveur_H1</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a0d8b7ab00a42ade15e4b650018f60a67">nb_colonnes_tot</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#ac15f4f26bdf2c63b5786305ad64b2007">nb_colonnes</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a5badd5dee68ffbd7e63228509fe1cb18">dimensionner_Mat_Bloc_Morse_Sym</a> (<a class="el" href="classMatrice.html">Matrice</a> &amp;matrice_tmp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a80e98cf9dfa018d6f3d18608924c8d57">Mat_Morse_to_Mat_Bloc</a> (<a class="el" href="classMatrice.html">Matrice</a> &amp;matrice_tmp)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="classZone__VEF.html">Zone_VEF</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a> () const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a0f30a2d8b2d1b2d85d7da0a0488eee56">trace</a> (const <a class="el" href="classFrontiere__dis__base.html">Frontiere_dis_base</a> &amp;fr, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;y, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;x, int distant) const </td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">MatP1NC2P1_L2</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice.html">Matrice</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSolveurSys.html">SolveurSys</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#aaa41328eec002384f541c9de9a4891b2">MatP1NC2P1_H1</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSolveurSys.html">SolveurSys</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">solveur_H1</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleVect.html">DoubleVect</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a0d930998a5c25e3e6ff01bec5bd561ca">ch_som_vect_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a4437c8f910d3e626accf68eeb590ab15">filtrer_L2_deja_appele_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a4fe02ee20bb5dbe82a86d1949950f296">MatP1NC2P1_L2_H1</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSolveurSys.html">SolveurSys</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a6400585e0d5d961530bdf72b58e07d65">solveur_L2_H1</a></td></tr>
<tr><td colspan="2"><h2><a name="friends"></a>
Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#ac2c0fa150a14667a03e52062463bf6c0">valeur_P1_L2</a> (<a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;, const <a class="el" href="classDomaine.html">Domaine</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Projection du champ P1NC "cha" sur l'espace des champs P1.<br/>
Le resultat est stocke dans cha.ch_som() et renvoye (valeur de retour)<br/>
Voir note technique 2006/010 de Patrick Quemere "Nouvelle approche VEF pour la LES...".<br/>
Voir aussi "What is in TRUST" : Scales_Separation_P1_P1NC.  <a href="#ac2c0fa150a14667a03e52062463bf6c0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a49c2050e228bf0f43a33de95e167b04e">valeur_P1_L2</a> (<a class="el" href="classChamp__Fonc__P1NC.html">Champ_Fonc_P1NC</a> &amp;, const <a class="el" href="classDomaine.html">Domaine</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a0b97339eaa2d6e03698b5cb38cccc829">valeur_P1_H1</a> (const <a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;, const <a class="el" href="classDomaine.html">Domaine</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a9f8ba857150e3b5ff99bc4abb30e7ae7">construire_MatP1NC2P1_L2</a> (<a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;, const <a class="el" href="classDomaine.html">Domaine</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a900ff1f8888f75232223f7fe860214fa">construire_MatP1NC2P1_H1</a> (<a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;, const <a class="el" href="classDomaine.html">Domaine</a> &amp;, double &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#a38d2d8477f11d236a2f94ac5ce713fec">construire_secmem_L2</a> (<a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;, const <a class="el" href="classDomaine.html">Domaine</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#aa7a1c2ef5332f7909f2dabc29e75a956">construire_secmem_H1</a> (<a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;, const <a class="el" href="classDomaine.html">Domaine</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const double &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#ab7ad21127b0f33f5259d56c929b2baea">valeur_P1_L2_H1</a> (<a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;, const <a class="el" href="classDomaine.html">Domaine</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChamp__P1NC__implementation.html#aa8d54a9e9a1aaed9408860d97043122a">test</a> (<a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;, const <a class="el" href="classDomaine.html">Domaine</a> &amp;)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00038">38</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a562aaf721cd09c383b02b487a497df28"></a><!-- doxytag: member="Champ_P1NC_implementation::Champ_P1NC_implementation" ref="a562aaf721cd09c383b02b487a497df28" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Champ_P1NC_implementation::Champ_P1NC_implementation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00049">49</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00163">filtrer_L2_deja_appele_</a>, <a class="el" href="SolveurSys_8h_source.html#l00064">SolveurSys::nommer()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00152">solveur_H1</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00150">solveur_L2</a>, <a class="el" href="Deriv___8cpp_source.html#l00091">Deriv_::typer()</a>, and <a class="el" href="SolveurSys_8h_source.html#l00038">Deriv_SolveurSys_base::valeur()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Initialise l&#39;attribut</span>
  <a class="code" href="classChamp__P1NC__implementation.html#a4437c8f910d3e626accf68eeb590ab15">filtrer_L2_deja_appele_</a>=0;
<span class="comment">// definition des types de solveurs par defaut (sinon, lecture dans solveur.bar)</span>
  <a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Solv_GCP&quot;</span>);
  <a class="code" href="classPrecond.html">Precond</a> p;
  p.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;SSOR&quot;</span>);
  <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolv__GCP.html">Solv_GCP</a>,<a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>()).set_precond(p);
  <a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>.<a class="code" href="classSolveurSys.html#a17fa90c93f514a6d2a898e682e724d3b" title="Donne un nom a l&#39;Objet_U Methode virtuelle a surcharger.">nommer</a>(<span class="stringliteral">&quot;solveur_L2&quot;</span>);
  <a class="code" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">solveur_H1</a>.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Solv_GCP&quot;</span>);
  <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolv__GCP.html">Solv_GCP</a>,<a class="code" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">solveur_H1</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>()).set_precond(p);
  <a class="code" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">solveur_H1</a>.<a class="code" href="classSolveurSys.html#a17fa90c93f514a6d2a898e682e724d3b" title="Donne un nom a l&#39;Objet_U Methode virtuelle a surcharger.">nommer</a>(<span class="stringliteral">&quot;solveur_H1&quot;</span>);



}
</pre></div>
</div>
</div>
<a class="anchor" id="a2a4f21d4b5b1fb270bdd8cb5022a0f15"></a><!-- doxytag: member="Champ_P1NC_implementation::~Champ_P1NC_implementation" ref="a2a4f21d4b5b1fb270bdd8cb5022a0f15" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual Champ_P1NC_implementation::~Champ_P1NC_implementation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00044">44</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>
<div class="fragment"><pre class="fragment">{};
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a42454b3d526344877e4d6dfc072a6a1b"></a><!-- doxytag: member="Champ_P1NC_implementation::ch_som" ref="a42454b3d526344877e4d6dfc072a6a1b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a>&amp; Champ_P1NC_implementation::ch_som </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00104">104</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00161">ch_som_</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01124">filtrer_resu()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01556">valeur_aux_elems_compo_smooth()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01490">valeur_aux_elems_smooth()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">valeur_P1_L2()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>;
  };
</pre></div>
</div>
</div>
<a class="anchor" id="a4505e6d941850aecad37b8b039990401"></a><!-- doxytag: member="Champ_P1NC_implementation::ch_som_vect" ref="a4505e6d941850aecad37b8b039990401" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a>&amp; Champ_P1NC_implementation::ch_som_vect </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00108">108</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00162">ch_som_vect_</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01124">filtrer_resu()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01958">nb_colonnes()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01941">nb_colonnes_tot()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">valeur_P1_L2()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classChamp__P1NC__implementation.html#a0d930998a5c25e3e6ff01bec5bd561ca">ch_som_vect_</a>;
  };
</pre></div>
</div>
</div>
<a class="anchor" id="afca68bf9ab7b22877d7cfffcebc1115a"></a><!-- doxytag: member="Champ_P1NC_implementation::coord_barycentrique" ref="afca68bf9ab7b22877d7cfffcebc1115a" args="(const IntTab &amp;sommet_poly, const DoubleTab &amp;coord, double x, double y, int le_poly, int face) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Champ_P1NC_implementation::coord_barycentrique </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td>
          <td class="paramname"><em>sommet_poly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>le_poly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>face</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00063">63</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="Champ__implementation__P1_8h_source.html#l00059">coord_barycentrique_P1_triangle()</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01556">valeur_aux_elems_compo_smooth()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01490">valeur_aux_elems_smooth()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="Champ__implementation__P1_8h.html#a9c0b4e243a99d689224836eaaa32ee61">coord_barycentrique_P1_triangle</a>(sommet_poly, coord, x, y, le_poly, face);
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a6da2dafcd0da126d029c56700a485c44"></a><!-- doxytag: member="Champ_P1NC_implementation::coord_barycentrique" ref="a6da2dafcd0da126d029c56700a485c44" args="(const IntTab &amp;sommet_poly, const DoubleTab &amp;coord, double x, double y, double z, int le_poly, int face) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Champ_P1NC_implementation::coord_barycentrique </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td>
          <td class="paramname"><em>sommet_poly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>le_poly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>face</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00070">70</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="Champ__implementation__P1_8h_source.html#l00178">coord_barycentrique_P1_tetraedre()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="Champ__implementation__P1_8h.html#ab40ad27af50075ee8b2c9d9e9f786357">coord_barycentrique_P1_tetraedre</a>(sommet_poly, coord, x, y, z, le_poly, face);
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a5badd5dee68ffbd7e63228509fe1cb18"></a><!-- doxytag: member="Champ_P1NC_implementation::dimensionner_Mat_Bloc_Morse_Sym" ref="a5badd5dee68ffbd7e63228509fe1cb18" args="(Matrice &amp;matrice_tmp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Champ_P1NC_implementation::dimensionner_Mat_Bloc_Morse_Sym </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrice.html">Matrice</a> &amp;&#160;</td>
          <td class="paramname"><em>matrice_tmp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01975">1975</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8cpp_source.html#l00346">Matrice_Morse::dimensionner()</a>, <a class="el" href="Matrice__Bloc_8cpp_source.html#l00560">Matrice_Bloc::dimensionner()</a>, <a class="el" href="Matrice__Bloc_8cpp_source.html#l00568">Matrice_Bloc::get_bloc()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00188">get_MatP1NC2P1_L2()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00119">Matrice_Morse::get_set_tab1()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00124">Matrice_Morse::get_set_tab2()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00134">Matrice_Morse::get_tab1()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00138">Matrice_Morse::get_tab2()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01958">nb_colonnes()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01941">nb_colonnes_tot()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Deriv___8cpp_source.html#l00091">Deriv_::typer()</a>, and <a class="el" href="Deriv__Matrice__Base_8h_source.html#l00028">Deriv_Matrice_Base::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">valeur_P1_L2()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// modif specific au Champ_P1NC_implementation</span>
  <span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; la_matrice = <a class="code" href="classChamp__P1NC__implementation.html#af1dfbfbb6b563d129a0320f96b02b6b6">get_MatP1NC2P1_L2</a>();
<span class="comment">// </span>
  <span class="keywordtype">int</span> n1 = <a class="code" href="classChamp__P1NC__implementation.html#a0d8b7ab00a42ade15e4b650018f60a67">nb_colonnes_tot</a>();
  <span class="keywordtype">int</span> n2 = <a class="code" href="classChamp__P1NC__implementation.html#ac15f4f26bdf2c63b5786305ad64b2007">nb_colonnes</a>();
  <span class="keywordtype">int</span> iligne;
  <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1=la_matrice.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>();
  <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2=la_matrice.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>();

  matrice_tmp.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Matrice_Bloc&quot;</span>);
  <a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>&amp; matrice=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>,matrice_tmp.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
  matrice.<a class="code" href="classMatrice__Bloc.html#a1db7c549cc1be958d5f00c29cd0f3a8c">dimensionner</a>(1,2);
  matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,0).<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Matrice_Morse_Sym&quot;</span>);
  matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,1).<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Matrice_Morse&quot;</span>);

  <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; MBrr =  <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,0).<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
  <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; MBrv =  <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>,matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,1).<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
  MBrr.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n2,0);
  MBrv.dimensionner(n2,0);

  <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1RR=MBrr.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
  <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2RR=MBrr.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
  <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1RV=MBrv.get_set_tab1();
  <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2RV=MBrv.get_set_tab2();

  <a class="code" href="classIntVect.html">IntVect</a> compteur_MBrr(n2);
  <a class="code" href="classIntVect.html">IntVect</a> compteur_MBrv(n2);
  compteur_MBrr=0;
  compteur_MBrv=0;

<span class="comment">// On parcours les lignes de la_matrice pour compter les elements</span>
<span class="comment">// non nuls de chaque ligne</span>
  <span class="keywordtype">int</span> jcolonne;
  <span class="keywordflow">for</span> (iligne=0; iligne&lt;n2; iligne++)
    {
      <span class="keywordtype">int</span> k;
      <span class="keywordflow">for</span> ( k=tab1(iligne)-1; k&lt;tab1(iligne+1)-1; k++)
        {
          jcolonne = tab2(k)-1;
          <span class="keywordflow">if</span> (jcolonne &lt; n2)
            {
<span class="comment">// l&#39;element correspondant est dans la partie RR de la_matrice</span>
              <span class="keywordflow">if</span> ((jcolonne &gt;= iligne) &amp;&amp; (jcolonne &lt; n2))
                {
<span class="comment">// l&#39;element correspondant est  situe au dessus de la diagonale de la_matrice</span>
                  compteur_MBrr(iligne)++;
                }
            }
          <span class="keywordflow">else</span>
            {
<span class="comment">// l&#39;element correspondant est dans la partie RV de la_matrice</span>
              compteur_MBrv(iligne)++;
            }
        }
    }


<span class="comment">// On remplie tab1RR et tab1RV</span>
  tab1RR(0)=1;
  tab1RV(0)=1;
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n2; i++)
    {
      tab1RR(i+1)=compteur_MBrr(i)+tab1RR(i);
      tab1RV(i+1)=compteur_MBrv(i)+tab1RV(i);
    }
<span class="comment">// On dimensionne tab2RR et tab2RV</span>
  MBrr.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n2,tab1RR(n2)-1);
  MBrv.dimensionner(n2,n1-n2,tab1RV(n2)-1);

<span class="comment">// On remplit tab2RR et tab2RV</span>
  <span class="keywordtype">int</span> compteurRR,compteurRV;
  <span class="keywordflow">for</span> (iligne=0; iligne&lt;n2; iligne++)
    {
      <span class="keywordtype">int</span> k;
      compteurRR = tab1RR(iligne)-1;
      compteurRV = tab1RV(iligne)-1;
      <span class="keywordflow">for</span> ( k=tab1(iligne)-1; k&lt;tab1(iligne+1)-1; k++)
        {
          jcolonne = tab2(k)-1;
          <span class="keywordflow">if</span> (jcolonne &lt; n2)
            {
<span class="comment">// l&#39;element correspondant est dans la partie RR de la_matrice</span>
              <span class="keywordflow">if</span> ((jcolonne &gt;= iligne) &amp;&amp; (jcolonne &lt; n2))
                {
<span class="comment">// l&#39;element correspondant est  situe au dessus de la diagonale de la_matrice</span>
                  tab2RR(compteurRR) = tab2(k);
                  compteurRR++;
                }
            }
          <span class="keywordflow">else</span>
            {
<span class="comment">// l&#39;element correspondant est dans la partie RV de la_matrice</span>
              tab2RV(compteurRV) = tab2(k)-n2;
              compteurRV++;
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aad8fd6dedb1f6f558e0c311df0b0db1d"></a><!-- doxytag: member="Champ_P1NC_implementation::filtrer_H1" ref="aad8fd6dedb1f6f558e0c311df0b0db1d" args="(DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Champ_P1NC_implementation::filtrer_H1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>valeurs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented in <a class="el" href="classChamp__P1NC.html#ac7fbffb73a5888ed3a81e3dd34a56e63">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00895">895</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="Champ__Inc__base_8cpp_source.html#l01012">Champ_Inc_base::domaine()</a>, <a class="el" href="Zone__VF_8h_source.html#l00609">Zone_VF::face_sommets()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l02353">mp_norme_vect()</a>, <a class="el" href="Zone_8cpp_source.html#l00608">Zone::nb_som_tot()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00062">ref_cast_non_const</a>, <a class="el" href="classChamp__P1NC__implementation.html#aa8d54a9e9a1aaed9408860d97043122a">test</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00716">valeur_P1_H1</a>, <a class="el" href="Champ__Inc__base_8cpp_source.html#l00221">Champ_Inc_base::valeurs()</a>, <a class="el" href="Zone__VF_8h_source.html#l00650">Zone_VF::xv()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Cerr &lt;&lt; &quot;Champ_P1NC_implementation::filtrer&quot; &lt;&lt; finl;</span>
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classChamp__P1NC__implementation.html#aa8d54a9e9a1aaed9408860d97043122a">test</a>=1;
  <span class="keywordflow">if</span>(!test)
    {
      test=1;
      <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> xv=zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;TEST filtrer_H1 solution = &quot;</span> &lt;&lt; <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(xv) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classChamp__P1NC__implementation.html#aad8fd6dedb1f6f558e0c311df0b0db1d">filtrer_H1</a>(xv);
      xv-=zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;TEST filtrer_H1 erreur = &quot;</span> &lt;&lt; <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(xv) &lt;&lt; finl;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;err = &quot;</span> &lt;&lt; xv
           &lt;&lt; <span class="stringliteral">&quot;zone_VEF.xv() &quot;</span> &lt;&lt; zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>() &lt;&lt; finl;
      xv=1.;
      <a class="code" href="classChamp__P1NC__implementation.html#aad8fd6dedb1f6f558e0c311df0b0db1d">filtrer_H1</a>(xv);
      xv-=1.;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;erreur sur les constantes : &quot;</span> &lt;&lt; <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(xv) &lt;&lt; finl;
    }
  <span class="keywordtype">int</span> nb_som= zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
  <span class="keywordtype">int</span> nb_faces=valeurs.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
  <span class="keyword">const</span> <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha_const =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
  <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,cha_const);
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> valeurs_fac(cha.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>());
  cha.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>()=valeurs;
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=valeurs.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vit_som(nb_som, nb_comp);
  <a class="code" href="classChamp__P1NC__implementation.html#a0b97339eaa2d6e03698b5cb38cccc829">valeur_P1_H1</a>(cha, cha.<a class="code" href="classChamp__Inc__base.html#a7804397c01b31d542be6a6c8af968b9b">domaine</a>(), vit_som);
  cha.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>()=valeurs_fac;
  <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>= 1./<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;

  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> face=0; face&lt;nb_faces; face++)
    {
      <span class="keywordtype">int</span> s1=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,0);
      <span class="keywordtype">int</span> s2=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,1);
      <span class="keywordtype">int</span> s3=-1;
      <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
        s3=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,2);
      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
        {
          <span class="keywordtype">double</span> somme=0;
          somme+=(vit_som(s1,comp)+vit_som(s2,comp));
          <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
            somme+=vit_som(s3,comp);
          valeurs(face, comp)=coeff*somme;
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab18ebd7f3cd91fb4e4db5cc8bf937ab3"></a><!-- doxytag: member="Champ_P1NC_implementation::filtrer_L2" ref="ab18ebd7f3cd91fb4e4db5cc8bf937ab3" args="(DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Champ_P1NC_implementation::filtrer_L2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>valeurs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>Paroi_negligeable_VEF </p>
</p>

<p>Reimplemented in <a class="el" href="classChamp__P1NC.html#a75f9ba41c7f6f9eddf9d33f9223326b6">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00945">945</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00161">ch_som_</a>, <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="DoubleTab_8h_source.html#l00254">DoubleTab::dimension_tot()</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="MorEqn_8h_source.html#l00082">MorEqn::equation()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Zone__VF_8h_source.html#l00609">Zone_VF::face_sommets()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02174">Equation_base::get_modele()</a>, <a class="el" href="Domaine_8h_source.html#l00613">Domaine::get_renum_som_perio()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Equation__base_8h_source.html#l00370">Equation_base::le_nom()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Mod__turb__hyd__base_8h_source.html#l00073">Mod_turb_hyd_base::loi_paroi()</a>, <a class="el" href="Zone_8h_source.html#l00469">Zone::nb_faces_elem()</a>, <a class="el" href="Front__VF_8h_source.html#l00066">Front_VF::nb_faces_tot()</a>, <a class="el" href="O__U__Ptr_8cpp_source.html#l00098">O_U_Ptr::non_nul()</a>, <a class="el" href="distances__VEF_8cpp_source.html#l00069">norm_2D_vit1_lp()</a>, <a class="el" href="distances__VEF_8cpp_source.html#l00387">norm_3D_vit1_lp()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00211">DoubleTab::ref()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00062">ref_cast_non_const</a>, <a class="el" href="DoubleVect_8h_source.html#l00153">DoubleVect::size()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Equation__base_8h_source.html#l00052">TURBULENCE</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Zone__Cl__dis_8h_source.html#l00032">Deriv_Zone_Cl_dis_base::valeur()</a>, <a class="el" href="Ref__Objet__U_8h_source.html#l00092">Ref_Objet_U::valeur()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">valeur_P1_L2</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Op__Div__VEFP1B__Elem_8cpp_source.html#l00081">verifier()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>, <a class="el" href="Equation__base_8h_source.html#l00391">Equation_base::zone_Cl_dis()</a>, <a class="el" href="Champ__P1NC_8h_source.html#l00227">Champ_P1NC::zone_vef()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01556">valeur_aux_elems_compo_smooth()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01490">valeur_aux_elems_smooth()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
  <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>= 1./<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<span class="comment">// int nb_som= zone_VEF.zone().nb_som_tot();</span>
  <span class="keywordtype">int</span> nb_faces=valeurs.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
  <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha = <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
  <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,cha) &amp;&amp; (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,cha)))
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;on ne doit pas filtre_L2 des champs qui ne sont pas de type P1NC&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }

  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=valeurs.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

  <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,cha))
    {
      <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; ch_inc_P1NC = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,cha);

      <span class="keywordflow">if</span> (ch_inc_P1NC.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a65e9b2520ac7b42444e4d9aa4f18ccf7" title="Renvoie le nom de l&#39;equation.">le_nom</a>()!=<span class="stringliteral">&quot;gradient_pression&quot;</span>)
        {
          <span class="keyword">const</span> <a class="code" href="classRef__Objet__U.html">RefObjU</a>&amp; modele_turbulence = ch_inc_P1NC.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#ab0bb5d06bdc91e131dc9d5f9d7b57095">get_modele</a>(<a class="code" href="Equation__base_8h.html#a2c9d34b2cc47e5b2b18347de20a77db5a0fecbd75e0b8b4c37ffd696e173a14c7">TURBULENCE</a>);
          <span class="keywordflow">if</span> (modele_turbulence.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>() &amp;&amp; <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classMod__turb__hyd__base.html" title="Classe Mod_turb_hyd_base Cette classe sert de base a la hierarchie des classes qui representent un mo...">Mod_turb_hyd_base</a>,modele_turbulence.<a class="code" href="classRef__Objet__U.html#ad875112c0fd275aa0c0aa710481ab11e">valeur</a>()))
            {
              <span class="keyword">const</span> <a class="code" href="classMod__turb__hyd__base.html" title="Classe Mod_turb_hyd_base Cette classe sert de base a la hierarchie des classes qui representent un mo...">Mod_turb_hyd_base</a>&amp; mod_turb = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMod__turb__hyd__base.html" title="Classe Mod_turb_hyd_base Cette classe sert de base a la hierarchie des classes qui representent un mo...">Mod_turb_hyd_base</a>,modele_turbulence.<a class="code" href="classRef__Objet__U.html#ad875112c0fd275aa0c0aa710481ab11e">valeur</a>());
              <span class="keyword">const</span> <a class="code" href="classTurbulence__paroi.html" title="Classe Turbulence_paroi Classe generique de la hierarchie des turbulences au niveau de la paroi...">Turbulence_paroi</a>&amp; loipar = mod_turb.<a class="code" href="classMod__turb__hyd__base.html#ac9de8c2c64dcf77d28790e021c07c61e">loi_paroi</a>();
              <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> tau_tan;

              <span class="keywordflow">if</span> (loipar.non_nul() &amp;&amp; loipar.valeur().use_shear() )
                {
                  tau_tan.<a class="code" href="classDoubleTab.html#afc7cddeeec2c80636e54eaf330ac41ad" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(loipar-&gt;Cisaillement_paroi());

<span class="comment">// Interpolation des vitesses a la paroi</span>

                  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VE_chF = ch_inc_P1NC.<a class="code" href="classChamp__P1NC.html#a122a5f097bee0c82357ab77ab23e0068">zone_vef</a>();
                  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>,ch_inc_P1NC.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
                  <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; les_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>();
                  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; mazone = zone_VE_chF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
                  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VE_chF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
                  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VE_chF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
                  <span class="keywordtype">int</span> nfac = mazone.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>(0);
                  <span class="keywordtype">int</span> nb_cl=les_cl.size();
                  <a class="code" href="classIntVect.html">IntVect</a> num(nfac);
                  <span class="keywordtype">int</span> num_cl,fac,ind_fac;

                  <span class="keywordtype">double</span> kappa=0.41;
                  <span class="keywordtype">double</span> norm_v,val0,val1,val2,norm_tau,u_tau;

                  <span class="keywordflow">for</span> (num_cl=0; num_cl&lt;nb_cl; num_cl++)
                    {
<span class="comment">// Boucle sur les bords</span>
                      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = les_cl[num_cl];
                      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; la_front_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
                      <span class="keywordtype">int</span> ndeb = 0;
                      <span class="keywordtype">int</span> nfin = la_front_dis.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();

                      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__paroi__fixe.html" title="classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes...">Dirichlet_paroi_fixe</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) &amp;&amp; tau_tan.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>()!=0)
                        {
                          <span class="keywordflow">for</span> (ind_fac=ndeb; ind_fac&lt;nfin ; ind_fac++)
                            {
                              fac = la_front_dis.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_fac);
                              <span class="keywordtype">int</span> elem = face_voisins(fac,0);

                              <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a> == 2 )
                                {
                                  num[0]=elem_faces(elem,0);
                                  num[1]=elem_faces(elem,1);
                                  <span class="keywordflow">if</span>      (num[0]==fac) num[0]=elem_faces(elem,2);
                                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num[1]==fac) num[1]=elem_faces(elem,2);

                                  norm_v=<a class="code" href="distances__VEF_8cpp.html#af1e08baeb1ff03d87fa7b45802b317cf">norm_2D_vit1_lp</a>(valeurs,fac,num[0],num[1],zone_VE_chF,val0,val1);
                                  norm_tau=sqrt(tau_tan(fac,0)*tau_tan(fac,0)+tau_tan(fac,1)*tau_tan(fac,1));
                                  u_tau=sqrt(norm_tau);
                                  <span class="comment">/*</span>
<span class="comment">                                  // PQ : 06/03 : pour un champ de vitesse 1D, l&#39;incompressibilite genere des vitesses (meme faibles) sur toutes</span>
<span class="comment">                                  // les composantes, qui se repercutent par la suite au niveau de la CL ici.</span>
<span class="comment">                                  //  (se manifestant en cours de calcul en entree par un pic de vitesse en proche paroi).</span>
<span class="comment">                                  // Pour assurer des entrees &quot;correctes&quot; (1D) on remedie a ce probleme via l&#39;operation suivante</span>
<span class="comment">                                  // (en supposant que les entrees sont alignees avec une des directions d&#39;espace)</span>
<span class="comment"></span>
<span class="comment">                                  if(dabs(val0)&gt;0.999) {val0=1.;val1=0.;}</span>
<span class="comment">                                  if(dabs(val1)&gt;0.999) {val0=0.;val1=1.;}</span>
<span class="comment">                                  */</span>

                                  valeurs(fac,0)=(norm_v-u_tau/kappa)*val0;
                                  valeurs(fac,1)=(norm_v-u_tau/kappa)*val1;

<span class="comment">// for (i=0 ; i&lt;Objet_U::dimension ; i++)</span>
<span class="comment">// valeurs(fac,i)=(valeurs(num[0],i)+valeurs(num[1],i))/2.-sqrt(tau_tan(fac,i))/kappa;</span>
<span class="comment">// valeurs(fac,0)=(valeurs(num[0],0)+valeurs(num[1],0))/2.-sqrt(tau_tan(fac,0))/kappa;</span>
                                }
                              <span class="keywordflow">else</span>
                                {
                                  num[0]=elem_faces(elem,0);
                                  num[1]=elem_faces(elem,1);
                                  num[2]=elem_faces(elem,2);
                                  <span class="keywordflow">if</span>      (num[0]==fac) num[0]=elem_faces(elem,3);
                                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num[1]==fac) num[1]=elem_faces(elem,3);
                                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num[2]==fac) num[2]=elem_faces(elem,3);

                                  norm_v=<a class="code" href="distances__VEF_8cpp.html#a8c6b41988d298e5bf17c7132f752e8e6">norm_3D_vit1_lp</a>(valeurs,fac,num[0],num[1],num[2],zone_VE_chF,val0,val1,val2);
                                  norm_tau=sqrt(tau_tan(fac,0)*tau_tan(fac,0)+tau_tan(fac,1)*tau_tan(fac,1)+tau_tan(fac,2)*tau_tan(fac,2));
                                  u_tau=sqrt(norm_tau);
                                  <span class="comment">/*</span>
<span class="comment">                                  // PQ : 06/03 : pour un champ de vitesse 1D, l&#39;incompressibilite genere des vitesses (meme faibles) sur toutes</span>
<span class="comment">                                  // les composantes, qui se repercutent par la suite au niveau de la CL ici.</span>
<span class="comment">                                  //  (se manifestant en cours de calcul en entree par un pic de vitesse en proche paroi).</span>
<span class="comment">                                  // Pour assurer des entrees &quot;correctes&quot; (1D) on remedie a ce probleme via l&#39;operation suivante</span>
<span class="comment">                                  // (en supposant que les entrees sont alignees suivant une des directions d&#39;espace)</span>
<span class="comment"></span>
<span class="comment">                                  if(dabs(val0)&gt;0.999) {val0=1.;val1=0.;val2=0.;}</span>
<span class="comment">                                  if(dabs(val1)&gt;0.999) {val0=0.;val1=1.;val2=0.;}</span>
<span class="comment">                                  if(dabs(val2)&gt;0.999) {val0=0.;val1=0.;val2=1.;}</span>
<span class="comment">                                  */</span>
                                  valeurs(fac,0)=(norm_v-u_tau/kappa)*val0;
                                  valeurs(fac,1)=(norm_v-u_tau/kappa)*val1;
                                  valeurs(fac,2)=(norm_v-u_tau/kappa)*val2;


<span class="comment">// DoubleTab xv=zone_VEF.xv();</span>
<span class="comment">// Cerr &lt;&lt; fac &lt;&lt; &quot; &quot; &lt;&lt; val0 &lt;&lt; &quot; &quot; &lt;&lt; val1 &lt;&lt; &quot; &quot; &lt;&lt; val2 &lt;&lt;finl;</span>
<span class="comment">// Cerr &lt;&lt; fac &lt;&lt; &quot; &quot; &lt;&lt; xv(fac,2) &lt;&lt; &quot; &quot; &lt;&lt; valeurs(fac,0) &lt;&lt; &quot; &quot; &lt;&lt; valeurs(fac,1) &lt;&lt; &quot; &quot; &lt;&lt; valeurs(fac,2) &lt;&lt; &quot; &quot; &lt;&lt; u_tau &lt;&lt; &quot; &quot; &lt;&lt; norm_v &lt;&lt;finl;</span>

<span class="comment">// for (i=0 ; i&lt;Objet_U::dimension ; i++)</span>
<span class="comment">// valeurs(fac,i)=(valeurs(num[0],i)+valeurs(num[1],i)+valeurs(num[2],i))/3.-sqrt(tau_tan(fac,i))/kappa;</span>
<span class="comment">// valeurs(fac,0)=(valeurs(num[0],0)+valeurs(num[1],0)+valeurs(num[2],0))/3.-sqrt(tau_tan(fac,0))/kappa;</span>
                                }
                            }<span class="comment">//fac</span>
                        }<span class="comment">//Dirichlet_paroi</span>
                    } <span class="comment">//Boucle sur les bords</span>
                  valeurs.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
                }<span class="comment">//!Paroi_negligeable_VEF</span>
<span class="comment"></span>            }
        }
    }

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> valeurs_fac(cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
  cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>()=valeurs;
  <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot; verif valeurs &quot;</span> , valeurs);

  <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,cha))
    {
      <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; ch_inc = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,cha);
      <a class="code" href="classChamp__P1NC__implementation.html#ac2c0fa150a14667a03e52062463bf6c0" title="Projection du champ P1NC &quot;cha&quot; sur l&#39;espace des champs P1. Le resultat est stocke dans cha...">valeur_P1_L2</a>(ch_inc,dom);
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,cha))
    {
      <a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>&amp; ch_fonc = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,cha);
      <a class="code" href="classChamp__P1NC__implementation.html#ac2c0fa150a14667a03e52062463bf6c0" title="Projection du champ P1NC &quot;cha&quot; sur l&#39;espace des champs P1. Le resultat est stocke dans cha...">valeur_P1_L2</a>(ch_fonc,dom);
    }

  <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot; verif valeurs &quot;</span> , valeurs);
  cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>()=valeurs_fac;
  valeurs_fac=valeurs;
  <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot; verif ch_som_ &quot;</span> , <a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>);
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> face=0; face&lt;nb_faces; face++)
    {
      <span class="keywordtype">int</span> s1=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,0);
      s1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(s1);
      <span class="keywordtype">int</span> s2=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,1);
      s2=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(s2);
      <span class="keywordtype">int</span> s3=-1;
      <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
        s3=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,2));
      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
        {
          <span class="keywordtype">double</span> somme=0;
          somme+=(<a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>(s1,comp)+<a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>(s2,comp));
          <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
            somme+=<a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>(s3,comp);
          valeurs(face, comp)=coeff*somme;
        }
    }
  valeurs.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
  <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot; verif valeurs L2&quot;</span> , valeurs);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a163afe69951edab9eaef1d70283d0245"></a><!-- doxytag: member="Champ_P1NC_implementation::filtrer_L2_H1" ref="a163afe69951edab9eaef1d70283d0245" args="(DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Champ_P1NC_implementation::filtrer_L2_H1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a01f966100fd849a80c9d9411e4ffb5e8"></a><!-- doxytag: member="Champ_P1NC_implementation::filtrer_resu" ref="a01f966100fd849a80c9d9411e4ffb5e8" args="(DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Champ_P1NC_implementation::filtrer_resu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented in <a class="el" href="classChamp__P1NC.html#a518597ace3e16644867a6798b3a4025a">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01124">1124</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00104">ch_som()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00108">ch_som_vect()</a>, <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00067">coeff_penalisation</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="DoubleTab_8h_source.html#l00254">DoubleTab::dimension_tot()</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Champ__Inc__base_8cpp_source.html#l01012">Champ_Inc_base::domaine()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="MorEqn_8h_source.html#l00082">MorEqn::equation()</a>, <a class="el" href="Periodique_8h_source.html#l00056">Periodique::face_associee()</a>, <a class="el" href="AssembleurPP1BUtil_8cpp_source.html#l00046">face_associee</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Domaine_8h_source.html#l00613">Domaine::get_renum_som_perio()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00146">MatP1NC2P1_L2</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00148">MatP1NC2P1_L2_Parallele</a>, <a class="el" href="communications_8cpp_source.html#l00598">mp_min()</a>, <a class="el" href="Front__VF_8h_source.html#l00061">Front_VF::nb_faces()</a>, <a class="el" href="Front__VF_8h_source.html#l00066">Front_VF::nb_faces_tot()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">Matrice_Morse::nb_lignes()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00062">ref_cast_non_const</a>, <a class="el" href="SolveurSys_8cpp_source.html#l00052">SolveurSys::resoudre_systeme()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00150">solveur_L2</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Deriv__Matrice__Base_8h_source.html#l00028">Deriv_Matrice_Base::valeur()</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Zone__Cl__dis_8h_source.html#l00032">Deriv_Zone_Cl_dis_base::valeur()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">valeur_P1_L2</a>, <a class="el" href="Equation__base_8h_source.html#l00391">Equation_base::zone_Cl_dis()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha_const =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
  <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>, cha_const);
  <span class="keywordtype">double</span> non_prepare=0;
  <span class="keywordflow">if</span> (cha.<a class="code" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">MatP1NC2P1_L2</a>.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() &lt;2)
    non_prepare=1;
  non_prepare=<a class="code" href="communications_8cpp.html#adb9fffe31bc56a52685e93ba06932547" title="renvoie le plus petit int i sur l&#39;ensemble des processeurs du groupe courant.">Process::mp_min</a>(non_prepare);
  <span class="keywordflow">if</span> (non_prepare==1)
    {
<span class="comment">// GF si on n a pas prepare la matrice, on appelle valeur_P1_L2(cha, cha.domaine()); et on remet les anciennes valeurs aux sommets</span>
      <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vit_som_sa=cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>();
      <a class="code" href="classChamp__P1NC__implementation.html#ac2c0fa150a14667a03e52062463bf6c0" title="Projection du champ P1NC &quot;cha&quot; sur l&#39;espace des champs P1. Le resultat est stocke dans cha...">valeur_P1_L2</a>(cha, cha.<a class="code" href="classChamp__Inc__base.html#a7804397c01b31d542be6a6c8af968b9b">domaine</a>());
      cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>()=vit_som_sa;
    }

  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>,
                                            cha.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_entrelaces= zone_VEF.volumes_entrelaces();
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; mazone =zone_VEF.zone();
  <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=mazone.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_VEF.face_sommets();
  <span class="keywordtype">int</span> nb_faces=resu.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
  <span class="keywordtype">int</span> nb_faces_tot=resu.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
  <span class="keywordtype">int</span> n_bord,nb_comp=resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> resu_som(cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>());
  resu_som = 0;

  <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> virtfait(nb_faces_tot-nb_faces);

  <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>= 1./<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
  <span class="keywordtype">int</span> face,ind_face;
  {
    <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.nb_front_Cl(); n_bord++)
      {
        <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
        <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
        <span class="keywordtype">int</span> nb_faces_tot_bord=le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
        <span class="keywordtype">int</span> nb_faces_bord = le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
        <span class="keywordtype">int</span> num1 = 0;
        <span class="keywordtype">int</span> num2 = nb_faces_tot_bord;

        <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
          {
            <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
            <span class="keywordtype">int</span> <a class="code" href="AssembleurPP1BUtil_8cpp.html#a3e374d53ebc7860e1c2f0b7906f2936d">face_associee</a>;
            <a class="code" href="classIntVect.html">IntVect</a> fait(nb_faces_tot_bord);
            <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
              {
                face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
                <span class="keywordflow">if</span> (fait(ind_face) == 0)
                  {
                    fait(ind_face) = 1;
                    <span class="keywordflow">if</span> (ind_face-nb_faces_bord&gt;=0) virtfait(face-nb_faces)=1;
                    face_associee=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(ind_face);
                    fait(face_associee) = 1;
                    <span class="keywordflow">if</span> (ind_face-nb_faces_bord&gt;=0)
                      {
                        face_associee = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(face_associee);
                        virtfait(face_associee-nb_faces)=1;
                      }

                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; isom++)
                      {
                        <span class="keywordtype">int</span> som=face_sommets(face,isom);
                        som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
                          resu_som(som, comp)+=coeff*resu(face, comp);
                      }

                  }
              }
          }
        <span class="keywordflow">else</span>
          {
            <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
              {
                face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
                <span class="keywordflow">if</span> (ind_face-nb_faces_bord&gt;=0) virtfait(face-nb_faces)=1;
                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;Objet_U::dimension; isom++)
                  {
                    <span class="keywordtype">int</span> som=face_sommets(face,isom);
                    som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
                      resu_som(som, comp)+=coeff*resu(face, comp);
                  }
              }
          }
      }


    <span class="keywordtype">int</span> deb=zone_VEF.premiere_face_int();


    <span class="keywordflow">for</span>(face=deb; face&lt;nb_faces_tot; face++)
      {
        <span class="keywordtype">int</span> indvirtface=face-nb_faces;
<span class="comment">// on regarde si la face virtuelle n&#39;a pas deja ete traitee</span>
        <span class="keywordflow">if</span> (indvirtface&gt;=0)
          <span class="keywordflow">if</span> (virtfait[indvirtface]==1) <span class="keywordflow">continue</span>;
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;Objet_U::dimension; isom++)
          {
            <span class="keywordtype">int</span> som=face_sommets(face,isom);
            som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
              resu_som(som, comp)+=coeff*resu(face, comp);
          }
      }
  }

<span class="comment">// resu_som.echange_espace_virtuel();</span>
<span class="comment">// Debog::verifier(&quot;Champ_P1NC_implementation::filtrer_resu 1.5 &quot;,resu);</span>
<span class="comment">// Debog::verifier(&quot;Champ_P1NC_implementation::filtrer_resu_som 1.5 &quot;,resu_som);</span>

<span class="comment">// ************************************************************************************************</span>
<span class="comment">// ************************************************************************************************</span>
<span class="comment">// </span>
<span class="comment">// Pour imposer residu_som = residu donne par CL</span>
<span class="comment">// </span>
<span class="comment">// ************************************************************************************************</span>
<span class="comment">// ************************************************************************************************</span>
  <a class="code" href="classIntVect.html">IntVect</a> test_cl_imposee(resu_som.dimension_tot(0));
  test_cl_imposee = 0;

  <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.nb_front_Cl(); n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      <span class="keywordtype">int</span> num1 = 0;
      <span class="keywordtype">int</span> num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>() ;

<span class="comment">// if (sub_type(Dirichlet,la_cl.valeur()) || sub_type(Dirichlet_homogene,la_cl.valeur()))</span>
      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
            {
              face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              <span class="keywordtype">double</span> vol=volumes_entrelaces(face);
              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;Objet_U::dimension; isom++)
                {
                  <span class="keywordtype">int</span> som=face_sommets(face,isom);
                  som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
                    {
                      <span class="keywordflow">if</span> (test_cl_imposee(som)==0)
                        resu_som(som,comp) = 0;
                      resu_som(som, comp) += <a class="code" href="Champ__P1NC__implementation_8cpp.html#aa542335f9416aab2cb6f6d433f596516">coeff_penalisation</a> * resu(face, comp)/vol;
                    }
                  test_cl_imposee(som) += 1;
                }
            }
        }
    }

  resu_som.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();

  <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>,cha.<a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>);
  <span class="keywordtype">int</span> i,nbs = resu_som.dimension(0);

  <a class="code" href="classDoubleVect.html">DoubleVect</a> secmem(cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>());
  <a class="code" href="classDoubleVect.html">DoubleVect</a> solution(cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>());

<span class="comment">// Modif CD 15/04/03 pour paralleliser le filtrage</span>
<span class="comment">// Matrice matrice_tmp;</span>
<span class="comment">// cha.dimensionner_Mat_Bloc_Morse_Sym(matrice_tmp);</span>
<span class="comment">// cha.Mat_Morse_to_Mat_Bloc(matrice_tmp);</span>
<span class="comment">// Fin Modif CD 15/04/03</span>

<span class="comment">// Debog::verifier_Mat_sommet(&quot;Champ_P1NC_implementation::filtrer_resu  cha.MatP1NC2P1_L2 &quot;, cha.MatP1NC2P1_L2);</span>

  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
    {
      solution=0.;
      <span class="keywordflow">for</span>(i=0; i&lt;nbs; i++)
        secmem(i)=resu_som(i,k);

      secmem.echange_espace_virtuel();

      solv.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmem, solution);

      <span class="keywordflow">for</span>(i=0; i&lt;nbs; i++)
        resu_som(i,k)=solution(i);
    }

  resu=0;
  {
    <span class="keywordflow">for</span>(face=0; face&lt;nb_faces; face++)
      {
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;Objet_U::dimension; isom++)
          {
            <span class="keywordtype">int</span> som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(zone_VEF.face_sommets(face,isom));
            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
              resu(face, comp)+=coeff*resu_som(som, comp);
          }
      }
  }
  {
    <span class="keywordflow">for</span>(face=0; face&lt;nb_faces; face++)
      {
        <span class="keywordtype">double</span> vol=volumes_entrelaces(face);
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
          resu(face, comp)*=vol;
      }
  }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0418cc42fde4d3786ade386b5b816e8f"></a><!-- doxytag: member="Champ_P1NC_implementation::fixer_nb_valeurs_nodales" ref="a0418cc42fde4d3786ade386b5b816e8f" args="(int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Champ_P1NC_implementation::fixer_nb_valeurs_nodales </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented in <a class="el" href="classChamp__Fonc__P1NC.html#a67dd9a12043c34fc30e6370b97f0f024">Champ_Fonc_P1NC</a>, and <a class="el" href="classChamp__P1NC.html#ad4e0e9846e1368cf4d8dee56036d84d5">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01928">1928</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00161">ch_som_</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00162">ch_som_vect_</a>, <a class="el" href="Domaine_8cpp_source.html#l00435">Domaine::creer_tableau_sommets()</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="DoubleTab_8h_source.html#l00264">DoubleTab::nb_dim()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00111">DoubleVect::reset()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00307">DoubleTab::reset()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>.<a class="code" href="classDoubleTab.html#acb465ae8c9b24990db18002693b42dea" title="met le tableau dans l&#39;etat obtenu par le constructeur par defaut voir DoubleVect::reset()">reset</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dim = <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>().<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>();
  <span class="keywordflow">if</span> (nb_dim &gt; 1)
    <a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().nb_comp());
  <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
  dom.<a class="code" href="classDomaine.html#a32c7de9f9e8e78e3d5ea68715b2ceb2b" title="Cree un tableau ayant une &quot;ligne&quot; par sommet du maillage. Voir MD_Vector_tools::creer_tableau_distrib...">creer_tableau_sommets</a>(<a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>);
  <a class="code" href="classChamp__P1NC__implementation.html#a0d930998a5c25e3e6ff01bec5bd561ca">ch_som_vect_</a>.<a class="code" href="classDoubleVect.html#a990500e5bf63a8ca55fd833d111e135c" title="met l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut. (voir ArrOfDouble::reset())">reset</a>();
  dom.<a class="code" href="classDomaine.html#a32c7de9f9e8e78e3d5ea68715b2ceb2b" title="Cree un tableau ayant une &quot;ligne&quot; par sommet du maillage. Voir MD_Vector_tools::creer_tableau_distrib...">creer_tableau_sommets</a>(<a class="code" href="classChamp__P1NC__implementation.html#a0d930998a5c25e3e6ff01bec5bd561ca">ch_som_vect_</a>);
  <span class="keywordflow">return</span> n;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad022e7402ec857c8ecc9fd28d241fbea"></a><!-- doxytag: member="Champ_P1NC_implementation::fonction_forme_2D" ref="ad022e7402ec857c8ecc9fd28d241fbea" args="(double x, double y, int le_poly, int face, const IntTab &amp;sommet_poly, const DoubleTab &amp;coord) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Champ_P1NC_implementation::fonction_forme_2D </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>le_poly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>face</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td>
          <td class="paramname"><em>sommet_poly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>coord</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00048">48</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="Champ__implementation__P1_8h_source.html#l00059">coord_barycentrique_P1_triangle()</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01332">valeur_a_elem()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01361">valeur_a_elem_compo()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01391">valeur_aux_elems()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01446">valeur_aux_elems_compo()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> 1 - 2 * <a class="code" href="Champ__implementation__P1_8h.html#a9c0b4e243a99d689224836eaaa32ee61">coord_barycentrique_P1_triangle</a>(sommet_poly, coord, x, y, le_poly, face);
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a7323420ee0d88c663808c2bd578ca2f4"></a><!-- doxytag: member="Champ_P1NC_implementation::fonction_forme_3D" ref="a7323420ee0d88c663808c2bd578ca2f4" args="(double x, double y, double z, int le_poly, int face, const IntTab &amp;sommet_poly, const DoubleTab &amp;coord) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Champ_P1NC_implementation::fonction_forme_3D </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>le_poly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>face</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td>
          <td class="paramname"><em>sommet_poly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>coord</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00055">55</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="Champ__implementation__P1_8h_source.html#l00178">coord_barycentrique_P1_tetraedre()</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01332">valeur_a_elem()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01361">valeur_a_elem_compo()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01391">valeur_aux_elems()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01446">valeur_aux_elems_compo()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> 1 - 3 * <a class="code" href="Champ__implementation__P1_8h.html#ab40ad27af50075ee8b2c9d9e9f786357">coord_barycentrique_P1_tetraedre</a>(sommet_poly, coord, x, y, z, le_poly, face);
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a6b6b91437d42c304b9b27d85a8c6c0c5"></a><!-- doxytag: member="Champ_P1NC_implementation::get_MatP1NC2P1_H1" ref="a6b6b91437d42c304b9b27d85a8c6c0c5" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a> &amp; Champ_P1NC_implementation::get_MatP1NC2P1_H1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00193">193</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00151">MatP1NC2P1_H1</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classChamp__P1NC__implementation.html#aaa41328eec002384f541c9de9a4891b2">MatP1NC2P1_H1</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af1dfbfbb6b563d129a0320f96b02b6b6"></a><!-- doxytag: member="Champ_P1NC_implementation::get_MatP1NC2P1_L2" ref="af1dfbfbb6b563d129a0320f96b02b6b6" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a> &amp; Champ_P1NC_implementation::get_MatP1NC2P1_L2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00188">188</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00146">MatP1NC2P1_L2</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01975">dimensionner_Mat_Bloc_Morse_Sym()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l02076">Mat_Morse_to_Mat_Bloc()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">MatP1NC2P1_L2</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a79f1a8c0e97b69d3da581a9b092be668"></a><!-- doxytag: member="Champ_P1NC_implementation::get_MatP1NC2P1_L2_H1" ref="a79f1a8c0e97b69d3da581a9b092be668" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a> &amp; Champ_P1NC_implementation::get_MatP1NC2P1_L2_H1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00198">198</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00175">MatP1NC2P1_L2_H1</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classChamp__P1NC__implementation.html#a4fe02ee20bb5dbe82a86d1949950f296">MatP1NC2P1_L2_H1</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2811ab346e8816a8efc1debea4e85342"></a><!-- doxytag: member="Champ_P1NC_implementation::get_solveur_H1" ref="a2811ab346e8816a8efc1debea4e85342" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classSolveurSys.html">SolveurSys</a> &amp; Champ_P1NC_implementation::get_solveur_H1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00208">208</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00152">solveur_H1</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">solveur_H1</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a50e371e52c749c39ea58266b00b68896"></a><!-- doxytag: member="Champ_P1NC_implementation::get_solveur_L2" ref="a50e371e52c749c39ea58266b00b68896" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classSolveurSys.html">SolveurSys</a> &amp; Champ_P1NC_implementation::get_solveur_L2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00203">203</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00150">solveur_L2</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7e67a830f99e4f6e588a0b6ec23ebf4e"></a><!-- doxytag: member="Champ_P1NC_implementation::get_solveur_L2_H1" ref="a7e67a830f99e4f6e588a0b6ec23ebf4e" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classSolveurSys.html">SolveurSys</a> &amp; Champ_P1NC_implementation::get_solveur_L2_H1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00213">213</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00176">solveur_L2_H1</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classChamp__P1NC__implementation.html#a6400585e0d5d961530bdf72b58e07d65">solveur_L2_H1</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="afd4bec4f5b250ce173225d6b6a8c5c22"></a><!-- doxytag: member="Champ_P1NC_implementation::imprime_P1NC" ref="afd4bec4f5b250ce173225d6b6a8c5c22" args="(Sortie &amp;, int) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Champ_P1NC_implementation::imprime_P1NC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01906">1906</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00033">Cout</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Zone__VF_8h_source.html#l00519">Zone_VF::nb_faces()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Zone__VF_8h_source.html#l00650">Zone_VF::xv()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC_8cpp_source.html#l00429">Champ_P1NC::imprime()</a>, and <a class="el" href="Champ__Fonc__P1NC_8cpp_source.html#l00093">Champ_Fonc_P1NC::imprime()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF=<a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pos_face=zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces = zone_VEF.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val = cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
  <span class="keywordtype">int</span> fac;
  os &lt;&lt; nb_faces &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  <span class="keywordflow">for</span> (fac=0; fac&lt;nb_faces; fac++)
    {
      <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
        os &lt;&lt; pos_face(fac,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pos_face(fac,1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pos_face(fac,2) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;
      <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
        os &lt;&lt; pos_face(fac,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pos_face(fac,1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;
      os &lt;&lt; val(fac,ncomp) &lt;&lt; finl;
    }
  os &lt;&lt; finl;
  <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;Champ_P1NC_implementation::imprime_P1NC FIN &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &quot;</span> &lt;&lt; finl;
  <span class="keywordflow">return</span> 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a80e98cf9dfa018d6f3d18608924c8d57"></a><!-- doxytag: member="Champ_P1NC_implementation::Mat_Morse_to_Mat_Bloc" ref="a80e98cf9dfa018d6f3d18608924c8d57" args="(Matrice &amp;matrice_tmp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Champ_P1NC_implementation::Mat_Morse_to_Mat_Bloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrice.html">Matrice</a> &amp;&#160;</td>
          <td class="paramname"><em>matrice_tmp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l02076">2076</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Bloc_8cpp_source.html#l00568">Matrice_Bloc::get_bloc()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00142">Matrice_Morse::get_coeff()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00188">get_MatP1NC2P1_L2()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00134">Matrice_Morse::get_tab1()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00138">Matrice_Morse::get_tab2()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01958">nb_colonnes()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01941">nb_colonnes_tot()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, and <a class="el" href="Deriv__Matrice__Base_8h_source.html#l00028">Deriv_Matrice_Base::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">valeur_P1_L2()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// </span>
  <span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; la_matrice = <a class="code" href="classChamp__P1NC__implementation.html#af1dfbfbb6b563d129a0320f96b02b6b6">get_MatP1NC2P1_L2</a>();
<span class="comment">// </span>

  <span class="keywordtype">int</span> n1 = <a class="code" href="classChamp__P1NC__implementation.html#a0d8b7ab00a42ade15e4b650018f60a67">nb_colonnes_tot</a>();
  <span class="keywordtype">int</span> n2 = <a class="code" href="classChamp__P1NC__implementation.html#ac15f4f26bdf2c63b5786305ad64b2007">nb_colonnes</a>();

  <a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>&amp; matrice= <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>,matrice_tmp.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
  <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; MBrr =  <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>,matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,0).<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
  <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; MBrv =  <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>,matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,1).<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());

  <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1RR=MBrr.get_set_tab1();
  <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2RR=MBrr.get_set_tab2();
  <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; coeffRR=MBrr.get_set_coeff();
  <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1RV=MBrv.get_set_tab1();
  <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2RV=MBrv.get_set_tab2();
  <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; coeffRV=MBrv.get_set_coeff();

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> ligne_tmp(n1);
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n2; i++)
    {
      <span class="keywordtype">int</span> k;
<span class="comment">// On recopie le premier bloc de la matrice dans un tableau :</span>
<span class="comment">// ligne_tmp = 0;</span>
      <span class="keywordflow">for</span> ( k=la_matrice.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i)-1; k&lt;la_matrice.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i+1)-1; k++)
        ligne_tmp(la_matrice.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>()(k) - 1) = la_matrice.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>()(k);

<span class="comment">// On complete la partie reelle de la matrice</span>
      <span class="keywordflow">for</span> ( k=tab1RR(i)-1; k&lt;tab1RR(i+1)-1; k++)
        coeffRR[k] = ligne_tmp(tab2RR[k] - 1);

<span class="comment">// On complete la partie virtuelle</span>
      <span class="keywordflow">for</span> ( k=tab1RV(i)-1; k&lt;tab1RV(i+1)-1; k++)
        coeffRV[k] = ligne_tmp(n2 + tab2RV[k] - 1);
    }


  <span class="comment">/*  Cerr&lt;&lt;&quot;Impression de la_matrice&quot;&lt;&lt;finl;</span>
<span class="comment">      la_matrice.imprimer_formatte(Cerr);</span>
<span class="comment">      Cerr&lt;&lt;&quot;Impression de MBrr&quot;&lt;&lt;finl;</span>
<span class="comment">      MBrr.imprimer_formatte(Cerr);</span>
<span class="comment">      Cerr&lt;&lt;&quot;Impression de MBrv&quot;&lt;&lt;finl;</span>
<span class="comment">      MBrv.imprimer_formatte(Cerr);*/</span>

  <span class="comment">/*  Debog::verifier_Mat_faces(&quot;avant resolution systeme : la_matrice&quot;,la_matrice);</span>
<span class="comment">      Debog::verifier_Mat_faces(&quot;avant resolution systeme : MBrr&quot;,MBrr);*/</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac15f4f26bdf2c63b5786305ad64b2007"></a><!-- doxytag: member="Champ_P1NC_implementation::nb_colonnes" ref="ac15f4f26bdf2c63b5786305ad64b2007" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Champ_P1NC_implementation::nb_colonnes </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01958">1958</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00108">ch_som_vect()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="DoubleVect_8h_source.html#l00135">DoubleVect::size_reelle()</a>, and <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01975">dimensionner_Mat_Bloc_Morse_Sym()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l02076">Mat_Morse_to_Mat_Bloc()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>()))
    {
      <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
      <span class="keywordflow">return</span> cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>().<a class="code" href="classDoubleVect.html#a4a6987db458541cdcd10495955f25263" title="Taille de l&#39;espace &quot;reel&quot; du vecteur. (si md_vector_ est nul, cette valeur est identique a size_arr...">size_reelle</a>();
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>()))
    {
      <a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>&amp; cha =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
      <span class="keywordflow">return</span> cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>().<a class="code" href="classDoubleVect.html#a4a6987db458541cdcd10495955f25263" title="Taille de l&#39;espace &quot;reel&quot; du vecteur. (si md_vector_ est nul, cette valeur est identique a size_arr...">size_reelle</a>();
    }

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0d8b7ab00a42ade15e4b650018f60a67"></a><!-- doxytag: member="Champ_P1NC_implementation::nb_colonnes_tot" ref="a0d8b7ab00a42ade15e4b650018f60a67" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Champ_P1NC_implementation::nb_colonnes_tot </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01941">1941</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00108">ch_som_vect()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="DoubleVect_8h_source.html#l00159">DoubleVect::size_totale()</a>, and <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01975">dimensionner_Mat_Bloc_Morse_Sym()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l02076">Mat_Morse_to_Mat_Bloc()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>()))
    {
      <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());

      <span class="keywordflow">return</span> cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>().<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>();
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>()))
    {
      <a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>&amp; cha = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
      <span class="keywordflow">return</span> cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>().<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>();
    }

  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a505f58ef53b201e637aae905fd85e0cc"></a><!-- doxytag: member="Champ_P1NC_implementation::remplir_coord_noeuds" ref="a505f58ef53b201e637aae905fd85e0cc" args="(DoubleTab &amp;positions) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Champ_P1NC_implementation::remplir_coord_noeuds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>positions</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classChamp__implementation.html#a0eb6d710d2a0400d28e3c80984fac75d">Champ_implementation</a>.</p>

<p>Reimplemented in <a class="el" href="classChamp__Fonc__P1NC.html#aa5f22b83413c516afd40d2c4c209305d">Champ_Fonc_P1NC</a>, and <a class="el" href="classChamp__P1NC.html#a85cf83d041243ad48906d3c56ae2bba7">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01873">1873</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Zone__VF_8h_source.html#l00519">Zone_VF::nb_faces()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00211">DoubleTab::ref()</a>, <a class="el" href="Zone__VF_8h_source.html#l00650">Zone_VF::xv()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01890">remplir_coord_noeuds_et_polys()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zvef = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xv = zvef.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
  <span class="keywordtype">int</span> nb_fac = zvef.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
  <span class="keywordflow">if</span> ( (xv.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0) == nb_fac ) &amp;&amp; (xv.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) == <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>) )
    noeuds.ref(xv);
  <span class="keywordflow">else</span>
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans Champ_P1NC_implementation::remplir_coord_noeuds()&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Les centres de gravite des faces n&#39;ont pas ete calcules&quot;</span> &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }
  <span class="keywordflow">return</span> noeuds;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6fe1d5532cedc49f51a3c3608dbc2651"></a><!-- doxytag: member="Champ_P1NC_implementation::remplir_coord_noeuds_et_polys" ref="a6fe1d5532cedc49f51a3c3608dbc2651" args="(DoubleTab &amp;positions, IntVect &amp;polys) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Champ_P1NC_implementation::remplir_coord_noeuds_et_polys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>positions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classIntVect.html">IntVect</a> &amp;&#160;</td>
          <td class="paramname"><em>polys</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classChamp__implementation.html#a83c40e62f34543358b851ff34f72e5b0">Champ_implementation</a>.</p>

<p>Reimplemented in <a class="el" href="classChamp__Fonc__P1NC.html#a748f98a8bd3138fdb2d3939342610720">Champ_Fonc_P1NC</a>, and <a class="el" href="classChamp__P1NC.html#a2fd0995ae33900517f22276837b1abd7">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01890">1890</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="Zone__VF_8h_source.html#l00519">Zone_VF::nb_faces()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01873">remplir_coord_noeuds()</a>, <a class="el" href="IntVect_8h_source.html#l00179">IntVect::resize()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classChamp__P1NC__implementation.html#a505f58ef53b201e637aae905fd85e0cc">remplir_coord_noeuds</a>(positions);
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zvef=<a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins=zvef.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keywordtype">int</span> nb_faces=zvef.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
  polys.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_faces);

  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i= 0; i&lt; nb_faces; i++)
    {
      polys(i)=face_voisins(i, 0);
    }
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0f30a2d8b2d1b2d85d7da0a0488eee56"></a><!-- doxytag: member="Champ_P1NC_implementation::trace" ref="a0f30a2d8b2d1b2d85d7da0a0488eee56" args="(const Frontiere_dis_base &amp;fr, const DoubleTab &amp;y, DoubleTab &amp;x, int distant) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Champ_P1NC_implementation::trace </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFrontiere__dis__base.html">Frontiere_dis_base</a> &amp;&#160;</td>
          <td class="paramname"><em>fr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>distant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00218">218</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>References <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="Frontiere__dis__base_8cpp_source.html#l00108">Frontiere_dis_base::frontiere()</a>, <a class="el" href="Frontiere_8cpp_source.html#l00419">Frontiere::trace_face_distant()</a>, and <a class="el" href="Frontiere_8cpp_source.html#l00396">Frontiere::trace_face_local()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (distant)
    fr.<a class="code" href="classFrontiere__dis__base.html#a95f81b046cd23c8c8083ae03eebe93cd" title="Renvoie la frontiere geometrique associee. (version const)">frontiere</a>().<a class="code" href="classFrontiere.html#a2993ce1565d3eeda6e2bb9e4aaeca175">trace_face_distant</a>(y, x);
  <span class="keywordflow">else</span>
    {
      fr.<a class="code" href="classFrontiere__dis__base.html#a95f81b046cd23c8c8083ae03eebe93cd" title="Renvoie la frontiere geometrique associee. (version const)">frontiere</a>().<a class="code" href="classFrontiere.html#a974cbdfc26742edbd79830f4768383ba" title="Renvoie la trace sur la frontiere du tableau aux faces y.">trace_face_local</a>(y, x);
      x.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
    }
  <span class="keywordflow">return</span> x;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a01bdd73486d6a13644d1b3de226fbde4"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_a_elem" ref="a01bdd73486d6a13644d1b3de226fbde4" args="(const DoubleVect &amp;position, DoubleVect &amp;val, int le_poly) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp; Champ_P1NC_implementation::valeur_a_elem </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>le_poly</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classChamp__implementation.html#a551ec70a5653366bc4bb2c2860399591">Champ_implementation</a>.</p>

<p>Reimplemented in <a class="el" href="classChamp__Fonc__P1NC.html#a23f861013414d8403131eacfcbd1863c">Champ_Fonc_P1NC</a>, and <a class="el" href="classChamp__P1NC.html#a24c49d1235ebe674524d467f2784e169">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01332">1332</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Domaine_8h_source.html#l00500">Domaine::coord_sommets()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00048">fonction_forme_2D()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00055">fonction_forme_3D()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Zone_8h_source.html#l00402">Zone::les_elems()</a>, <a class="el" href="Field__base_8h_source.html#l00119">Field_base::nb_comp()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Champ__implementation_8cpp_source.html#l00031">Champ_implementation::zone()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> N = cha.<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>(), D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
  val = 0;

  <span class="keywordflow">if</span> (le_poly != -1)
    {
      <span class="keyword">const</span> <span class="keywordtype">double</span> xs = position(0), ys = position(1),
                   zs = (D == 3) ? position(2) : 0;
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; D + 1; i++)
        {
          <span class="keyword">const</span> <span class="keywordtype">int</span> f = elem_faces(le_poly, i);
          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
            val(n) += ch(f, n) * ((D == 2) ? <a class="code" href="classChamp__P1NC__implementation.html#ad022e7402ec857c8ecc9fd28d241fbea">fonction_forme_2D</a>(xs, ys, le_poly, i, sommet_poly, coord) : <a class="code" href="classChamp__P1NC__implementation.html#a7323420ee0d88c663808c2bd578ca2f4">fonction_forme_3D</a>(xs, ys, zs, le_poly, i, sommet_poly, coord));
        }
    }
  <span class="keywordflow">return</span> val;
}
</pre></div>
</div>
</div>
<a class="anchor" id="acacb4869ebabcb4fc4200aa604aa39bb"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_a_elem_compo" ref="acacb4869ebabcb4fc4200aa604aa39bb" args="(const DoubleVect &amp;position, int le_poly, int ncomp) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Champ_P1NC_implementation::valeur_a_elem_compo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>le_poly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classChamp__implementation.html#a5b067f86c907cbded9ef33d10cce1ee4">Champ_implementation</a>.</p>

<p>Reimplemented in <a class="el" href="classChamp__Fonc__P1NC.html#af0fc0eeeb9e6555164b49fd648ff34de">Champ_Fonc_P1NC</a>, and <a class="el" href="classChamp__P1NC.html#a83d60fcec331cfb1ef02e1a4cdaf2be1">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01361">1361</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Domaine_8h_source.html#l00500">Domaine::coord_sommets()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00048">fonction_forme_2D()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00055">fonction_forme_3D()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Zone_8h_source.html#l00402">Zone::les_elems()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Champ__implementation_8cpp_source.html#l00031">Champ_implementation::zone()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Cerr &lt;&lt; &quot;Champ_P1NC_implementation::valeur_a_elem_compo&quot; &lt;&lt; finl;</span>
  <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
  <span class="keywordtype">double</span> val = 0.;

  <span class="keywordflow">if</span> (le_poly != -1)
    {
<span class="comment">// Calcul d&#39;apres les fonctions de forme sur le triangle ou le tetraedre</span>
      <span class="keyword">const</span> <span class="keywordtype">double</span> xs = position(0), ys = position(1),
                   zs = (D == 3) ? position(2) : 0;
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; D + 1; i++)
        {
          <span class="keyword">const</span> <span class="keywordtype">int</span> f = elem_faces(le_poly,i);
          val += ch(f, ncomp) * ((D == 2) ? <a class="code" href="classChamp__P1NC__implementation.html#ad022e7402ec857c8ecc9fd28d241fbea">fonction_forme_2D</a>(xs, ys, le_poly, i, sommet_poly, coord) : <a class="code" href="classChamp__P1NC__implementation.html#a7323420ee0d88c663808c2bd578ca2f4">fonction_forme_3D</a>(xs, ys, zs, le_poly, i, sommet_poly, coord));
        }
    }

  <span class="keywordflow">return</span> val;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af03937cefb3ed641c5223a7a00fcb778"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_a_sommet_compo" ref="af03937cefb3ed641c5223a7a00fcb778" args="(int num_som, int le_poly, int ncomp) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Champ_P1NC_implementation::valeur_a_sommet_compo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_som</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>le_poly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented in <a class="el" href="classChamp__P1NC.html#a099c50c4dd167411656183422b0fe120">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01724">1724</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Zone_8h_source.html#l00402">Zone::les_elems()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Champ__implementation_8cpp_source.html#l00031">Champ_implementation::zone()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01611">valeur_aux_sommets()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01769">valeur_aux_sommets_compo()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Cerr &lt;&lt; &quot;Champ_P1NC_implementation::valeur_a_sommet_compo&quot; &lt;&lt; finl;</span>
  <span class="keywordtype">int</span> face=-1;
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>().<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
  <span class="keywordtype">double</span> val=0;
  <span class="keywordflow">if</span> (le_poly != -1)
    {
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>+1; i++)
        {
          face = elem_faces(le_poly,i);
          <span class="keywordflow">if</span> (sommet_poly(le_poly,i)==num_som)
            val -= (Objet_U::dimension-1)*ch(face, ncomp);
          <span class="keywordflow">else</span>
            val += ch(face, ncomp);
        }
    }
  <span class="keywordflow">return</span> val;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a22d053851c997e080bc189f57d99a088"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_aux_elems" ref="a22d053851c997e080bc189f57d99a088" args="(const DoubleTab &amp;positions, const IntVect &amp;les_polys, DoubleTab &amp;valeurs) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Champ_P1NC_implementation::valeur_aux_elems </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>positions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIntVect.html">IntVect</a> &amp;&#160;</td>
          <td class="paramname"><em>les_polys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>valeurs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classChamp__implementation.html#acfeba8e11bd62a034bd2cbcf58dcd571">Champ_implementation</a>.</p>

<p>Reimplemented in <a class="el" href="classChamp__Fonc__P1NC.html#a852ff6b2a78068ea0b0745c7625a69bb">Champ_Fonc_P1NC</a>, and <a class="el" href="classChamp__P1NC.html#a8c9ccd8d7fb263c0777087a495ad3bed">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01391">1391</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Domaine_8h_source.html#l00500">Domaine::coord_sommets()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="DoubleTab_8h_source.html#l00254">DoubleTab::dimension_tot()</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00048">fonction_forme_2D()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00055">fonction_forme_3D()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Zone_8h_source.html#l00402">Zone::les_elems()</a>, <a class="el" href="Field__base_8h_source.html#l00119">Field_base::nb_comp()</a>, <a class="el" href="DoubleTab_8h_source.html#l00264">DoubleTab::nb_dim()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Champ__implementation_8cpp_source.html#l00031">Champ_implementation::zone()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
  <span class="keywordtype">int</span> nb_compo_=cha.<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>();
  <span class="keywordtype">int</span> face;
  <span class="keywordtype">double</span> xs,ys,zs;
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();

  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
  <span class="keywordflow">if</span> (val.nb_dim() &gt; 2)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur TRUST dans Champ_P1NC_implementation::valeur_aux_elems()\n&quot;</span>;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Le DoubleTab val a plus de 2 entrees\n&quot;</span>;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }

<span class="comment">// TODO : FIXME</span>
<span class="comment">// For FT the resize should be done in its good position and not here ...</span>
  <span class="keywordflow">if</span> (val.nb_dim() == 1 ) val.resize(val.dimension_tot(0),1);

  <span class="keywordtype">int</span> le_poly, D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();

  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rang_poly=0; rang_poly&lt;les_polys.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>(); rang_poly++)
    {
      le_poly=les_polys(rang_poly);
      <span class="keywordflow">if</span> (le_poly == -1)
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ncomp=0; ncomp&lt;nb_compo_; ncomp++)
          val(rang_poly, ncomp) = 0;
      <span class="keywordflow">else</span>
        {
          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ncomp=0; ncomp&lt;nb_compo_; ncomp++)
            {
              val(rang_poly, ncomp) = 0;
              xs = positions(rang_poly,0);
              ys = positions(rang_poly,1);
              zs = (D == 3) ? positions(rang_poly,2) : 0;
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; D + 1; i++)
                {
                  face = elem_faces(le_poly, i);
                  val(rang_poly, ncomp) += ch(face, ncomp) *
                                           ((D == 2) ? <a class="code" href="classChamp__P1NC__implementation.html#ad022e7402ec857c8ecc9fd28d241fbea">fonction_forme_2D</a>(xs, ys, le_poly, i, sommet_poly, coord) : <a class="code" href="classChamp__P1NC__implementation.html#a7323420ee0d88c663808c2bd578ca2f4">fonction_forme_3D</a>(xs, ys, zs, le_poly, i, sommet_poly, coord));
                }
            }
        }
    }
  <span class="keywordflow">return</span> val;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6f97c08115ccb64a29832595a27041c0"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_aux_elems_compo" ref="a6f97c08115ccb64a29832595a27041c0" args="(const DoubleTab &amp;positions, const IntVect &amp;les_polys, DoubleVect &amp;valeurs, int ncomp) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp; Champ_P1NC_implementation::valeur_aux_elems_compo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>positions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIntVect.html">IntVect</a> &amp;&#160;</td>
          <td class="paramname"><em>les_polys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>valeurs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classChamp__implementation.html#a66eee1acf842338142eb74ef420ce21e">Champ_implementation</a>.</p>

<p>Reimplemented in <a class="el" href="classChamp__Fonc__P1NC.html#a2253d7cd16b02021d66e3d663390fab4">Champ_Fonc_P1NC</a>, and <a class="el" href="classChamp__P1NC.html#acd958e79da72be12f658b189c07498e3">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01446">1446</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Domaine_8h_source.html#l00500">Domaine::coord_sommets()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00048">fonction_forme_2D()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00055">fonction_forme_3D()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Zone_8h_source.html#l00402">Zone::les_elems()</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Champ__implementation_8cpp_source.html#l00031">Champ_implementation::zone()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> les_polys_size = les_polys.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>();
  <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
  <span class="keywordtype">double</span> xs,ys,zs;
  <span class="keywordtype">int</span> face;
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<span class="comment">// Commenter en attendant de comprendre le dimensionnement de xp apres la sortie de version</span>
<span class="comment">// assert(val.size() == les_polys_size);</span>
  <span class="keywordtype">int</span> le_poly, D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;

  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();

  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rang_poly=0; rang_poly&lt;les_polys_size; rang_poly++)
    {
      le_poly=les_polys(rang_poly);
      <span class="keywordflow">if</span> (le_poly == -1) val(rang_poly) = 0;
      <span class="keywordflow">else</span>
        {
<span class="comment">// Calcul d&#39;apres les fonctions de forme sur le triangle ou le tetraedre</span>
          val(rang_poly) = 0;
          xs = positions(rang_poly,0);
          ys = positions(rang_poly,1);
          zs = (D == 3) ? positions(rang_poly,2) : 0.;
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; D + 1; i++)
            {
              face = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>(le_poly,i);
              val(rang_poly) += ch(face, ncomp) *
                                ( (D == 2) ? <a class="code" href="classChamp__P1NC__implementation.html#ad022e7402ec857c8ecc9fd28d241fbea">fonction_forme_2D</a>(xs,ys,le_poly,i,sommet_poly,coord) :
                                  <a class="code" href="classChamp__P1NC__implementation.html#a7323420ee0d88c663808c2bd578ca2f4">fonction_forme_3D</a>(xs,ys,zs,le_poly,i,sommet_poly,coord));
            }
        }
    }

  <span class="keywordflow">return</span> val;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2a41177f98eed27e4f08c03a9cf21358"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_aux_elems_compo_smooth" ref="a2a41177f98eed27e4f08c03a9cf21358" args="(const DoubleTab &amp;positions, const IntVect &amp;les_polys, DoubleVect &amp;valeurs, int ncomp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp; Champ_P1NC_implementation::valeur_aux_elems_compo_smooth </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>positions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIntVect.html">IntVect</a> &amp;&#160;</td>
          <td class="paramname"><em>les_polys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>valeurs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented in <a class="el" href="classChamp__Fonc__P1NC.html#aebb4a4e77b4f8664cd0ba5c57ad69da2">Champ_Fonc_P1NC</a>, and <a class="el" href="classChamp__P1NC.html#a042bbe5225ac0fcca1685fdcf696fc98">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01556">1556</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00104">ch_som()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00063">coord_barycentrique()</a>, <a class="el" href="Domaine_8h_source.html#l00500">Domaine::coord_sommets()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00945">filtrer_L2()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00163">filtrer_L2_deja_appele_</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Domaine_8h_source.html#l00613">Domaine::get_renum_som_perio()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Field__base_8cpp_source.html#l00056">Field_base::le_nom()</a>, <a class="el" href="Zone_8h_source.html#l00402">Zone::les_elems()</a>, <a class="el" href="Field__base_8h_source.html#l00119">Field_base::nb_comp()</a>, <a class="el" href="Objet__U_8cpp_source.html#l00132">Objet_U::que_suis_je()</a>, <a class="el" href="DoubleVect_8h_source.html#l00153">DoubleVect::size()</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Champ__implementation_8cpp_source.html#l00031">Champ_implementation::zone()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> ((!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>()))&amp;&amp;(!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>())))
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;L&#39;option chsom des sondes ne s&#39;applique pour le moment que pour les Champ_P1NC en VEF&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;or votre champ &quot;</span> &lt;&lt; <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classField__base.html#ae1377124eabe8387aced762115b062bb" title="Renvoie le nom du champ.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; est de type &quot;</span> &lt;&lt; <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; finl;
<span class="comment">// Je rajoute le message ci-dessous car le message habituel n&#39;apparait pas !</span>
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;TRUST a provoque une erreur et va s&#39;arreter&quot;</span> &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }
  <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha =<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> les_polys_size = les_polys.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>(), nb_compo_=cha.<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>(), D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch_sommet= (<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>());
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
  <span class="keywordflow">if</span> (!<a class="code" href="classChamp__P1NC__implementation.html#a4437c8f910d3e626accf68eeb590ab15">filtrer_L2_deja_appele_</a>)
    {
<span class="comment">// Filtrer L2 ne marche que pour les vecteurs</span>
<span class="comment">// C.MALOD 19/12/2006 : Ce n&#39;est plus vrai, ca marche aussi avec les scalaires.</span>
      <span class="keywordflow">if</span> (nb_compo_&gt;0)
        {
          <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> val_sauv=cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
          <a class="code" href="classChamp__P1NC__implementation.html#ab18ebd7f3cd91fb4e4db5cc8bf937ab3">filtrer_L2</a>(cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
          cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>()=val_sauv;
        }
      <a class="code" href="classChamp__P1NC__implementation.html#a4437c8f910d3e626accf68eeb590ab15">filtrer_L2_deja_appele_</a>=1;
    }
  assert(val.size() == les_polys_size);
  val = 0.;
  <span class="keywordtype">int</span> p;

<span class="comment">// calcul de la valeur aux elements suivant les coordonnees barycentriques (repris de Champ_P1)</span>

  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rang_poly=0; rang_poly&lt;les_polys_size; rang_poly++)
    <span class="keywordflow">if</span> ((p = les_polys(rang_poly)) != -1)
      {
        <span class="keyword">const</span> <span class="keywordtype">double</span> xs = positions(rang_poly,0), ys = positions(rang_poly,1),
                     zs = (D == 3) ? positions(rang_poly,2) : 0.;
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; D + 1; i++)
          {
            <span class="keywordtype">int</span> som = sommet_poly(p, i);
            <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
            val(rang_poly) += ch_sommet(som1, ncomp)
                              * ((D == 2) ? <a class="code" href="classChamp__P1NC__implementation.html#afca68bf9ab7b22877d7cfffcebc1115a">coord_barycentrique</a>(sommet_poly, coord, xs, ys, p, i) : <a class="code" href="classChamp__P1NC__implementation.html#afca68bf9ab7b22877d7cfffcebc1115a">coord_barycentrique</a>(sommet_poly, coord, xs, ys, zs, p, i));
          }
      }
  <span class="keywordflow">return</span> val;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8426620eca950b7ee6ff0b87bbb4ec64"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_aux_elems_smooth" ref="a8426620eca950b7ee6ff0b87bbb4ec64" args="(const DoubleTab &amp;positions, const IntVect &amp;les_polys, DoubleTab &amp;valeurs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Champ_P1NC_implementation::valeur_aux_elems_smooth </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>positions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIntVect.html">IntVect</a> &amp;&#160;</td>
          <td class="paramname"><em>les_polys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>valeurs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented in <a class="el" href="classChamp__Fonc__P1NC.html#aef366aa936d8be72d350e77e1cfd5a8a">Champ_Fonc_P1NC</a>, and <a class="el" href="classChamp__P1NC.html#ac7959b893210cbe05e33eed7980a2a25">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01490">1490</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00104">ch_som()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00063">coord_barycentrique()</a>, <a class="el" href="Domaine_8h_source.html#l00500">Domaine::coord_sommets()</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="DoubleTab_8h_source.html#l00254">DoubleTab::dimension_tot()</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00945">filtrer_L2()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00163">filtrer_L2_deja_appele_</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Domaine_8h_source.html#l00613">Domaine::get_renum_som_perio()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Field__base_8cpp_source.html#l00056">Field_base::le_nom()</a>, <a class="el" href="Zone_8h_source.html#l00402">Zone::les_elems()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Field__base_8h_source.html#l00119">Field_base::nb_comp()</a>, <a class="el" href="DoubleTab_8h_source.html#l00264">DoubleTab::nb_dim()</a>, <a class="el" href="Objet__U_8cpp_source.html#l00132">Objet_U::que_suis_je()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>, <a class="el" href="Champ__implementation_8cpp_source.html#l00031">Champ_implementation::zone()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> ((!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>()))&amp;&amp;(!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>())))
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;L&#39;option chsom des sondes ne s&#39;applique pour le moment que pour les Champ_P1NC en VEF&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;or votre champ &quot;</span> &lt;&lt; <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classField__base.html#ae1377124eabe8387aced762115b062bb" title="Renvoie le nom du champ.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; est de type &quot;</span> &lt;&lt; <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; finl;
<span class="comment">// Je rajoute le message ci-dessous car le message habituel n&#39;apparait pas !</span>
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;TRUST a provoque une erreur et va s&#39;arreter&quot;</span> &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }

  <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
  <span class="keyword">const</span> <span class="keywordtype">int</span> les_polys_size = les_polys.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>(), nb_compo_=cha.<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>(), D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;  ch_sommet= (<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>());
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>();
  <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
  <span class="keywordflow">if</span> (val.nb_dim() == 2)
    {
      assert((val.dimension(0) == les_polys_size)||(val.dimension_tot(0) == les_polys_size));
      assert(val.line_size() == nb_compo_);
    }
  <span class="keywordflow">else</span>
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur TRUST dans Champ_P1NC_implementation::valeur_aux_elems_smooth()\n&quot;</span>;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Le DoubleTab val a plus de 2 entrees\n&quot;</span>;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }
  <span class="keywordflow">if</span> (!<a class="code" href="classChamp__P1NC__implementation.html#a4437c8f910d3e626accf68eeb590ab15">filtrer_L2_deja_appele_</a>)
    {
<span class="comment">// Filtrer L2 ne marche que pour les vecteurs</span>
<span class="comment">// C.MALOD 19/12/2006 : Ce n&#39;est plus vrai, ca marche aussi avec les scalaires.</span>
      <span class="keywordflow">if</span> (nb_compo_&gt;0)
        {
          <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> val_sauv=cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
          <a class="code" href="classChamp__P1NC__implementation.html#ab18ebd7f3cd91fb4e4db5cc8bf937ab3">filtrer_L2</a>(cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
          cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>()=val_sauv;
        }
      <a class="code" href="classChamp__P1NC__implementation.html#a4437c8f910d3e626accf68eeb590ab15">filtrer_L2_deja_appele_</a>=1;
    }

<span class="comment">// calcul de la valeur aux elements suivant les coordonnees barycentriques (repris de Champ_P1)</span>
  val = 0.;
  <span class="keywordtype">int</span> p;
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rang_poly=0; rang_poly&lt;les_polys_size; rang_poly++)
    <span class="keywordflow">if</span> ((p = les_polys(rang_poly)) != -1)
      {
        <span class="keyword">const</span> <span class="keywordtype">double</span> xs = positions(rang_poly,0), ys = positions(rang_poly,1),
                     zs = (D == 3) ? positions(rang_poly,2) : 0.;
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ncomp=0; ncomp&lt;nb_compo_; ncomp++)
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; D + 1; i++)
            {
              <span class="keywordtype">int</span> som = sommet_poly(p, i);
              <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
              val(rang_poly, ncomp) += ch_sommet(som1, ncomp) * ((D == 2) ? <a class="code" href="classChamp__P1NC__implementation.html#afca68bf9ab7b22877d7cfffcebc1115a">coord_barycentrique</a>(sommet_poly, coord, xs, ys, p, i) : <a class="code" href="classChamp__P1NC__implementation.html#afca68bf9ab7b22877d7cfffcebc1115a">coord_barycentrique</a>(sommet_poly, coord, xs, ys, zs, p, i));
            }
      }
  <span class="keywordflow">return</span> val;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aae75b2a451bacac1b78d3e5192d9e885"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_aux_sommets" ref="aae75b2a451bacac1b78d3e5192d9e885" args="(const Domaine &amp;dom, DoubleTab &amp;ch_som) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Champ_P1NC_implementation::valeur_aux_sommets </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname"><em>dom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>ch_som</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classChamp__implementation.html#a6d898357c33fb21e84ab8dff1967df13">Champ_implementation</a>.</p>

<p>Reimplemented in <a class="el" href="classChamp__Fonc__P1NC.html#ad3c33abd53d784f94aaffe8701c6b613">Champ_Fonc_P1NC</a>, and <a class="el" href="classChamp__P1NC.html#a27d333e5c8677d824212cbbe5386a7db">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01611">1611</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Memoire_8cpp_source.html#l00026">compteur</a>, <a class="el" href="DoubleTab_8h_source.html#l00254">DoubleTab::dimension_tot()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00609">Zone_VF::face_sommets()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Double_8h_source.html#l00180">max()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00043">methode_calcul_valeurs_sommets</a>, <a class="el" href="Double_8h_source.html#l00199">min()</a>, <a class="el" href="Field__base_8h_source.html#l00119">Field_base::nb_comp()</a>, <a class="el" href="Zone_8h_source.html#l00319">Zone::nb_elem_tot()</a>, <a class="el" href="Zone__VF_8h_source.html#l00527">Zone_VF::nb_faces_tot()</a>, <a class="el" href="Zone_8h_source.html#l00445">Zone::nb_som_elem()</a>, <a class="el" href="Zone__VF_8h_source.html#l00538">Zone_VF::nb_som_face()</a>, <a class="el" href="Zone_8cpp_source.html#l00608">Zone::nb_som_tot()</a>, <a class="el" href="Zone_8h_source.html#l00344">Zone::sommet_elem()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01724">valeur_a_sommet_compo()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Champ__implementation_8cpp_source.html#l00031">Champ_implementation::zone()</a>, <a class="el" href="Domaine_8h_source.html#l00272">Domaine::zone()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; mazone = dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);

  <span class="keywordtype">int</span> nb_som = mazone.<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
  <span class="keywordtype">int</span> nb_som_return = champ_som.dimension_tot(0);

  <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
  <span class="keywordtype">int</span> nb_compo_=cha.<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>();
  <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>(nb_som);

  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
  assert(<a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>().<a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>()==mazone);

  <span class="keywordflow">if</span> ( <a class="code" href="Champ__P1NC__implementation_8cpp.html#afbe7fcf4bcc6179a6c6cfc12b0a6d799">methode_calcul_valeurs_sommets</a>&gt;0)
    {
      <span class="keywordtype">int</span> nb_elem_tot = mazone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
      <span class="keywordtype">int</span> nb_som_elem = mazone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();

      <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();

      <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> min_som(nb_som,nb_compo_) ;
      <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> max_som(nb_som,nb_compo_) ;
      <span class="keywordtype">int</span> ncomp, face_adj,face_glob;
      <span class="keywordtype">int</span> num_elem,num_som,j;

      champ_som = 0;
      <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> = 0;
      <span class="keywordflow">for</span> (j=0; j&lt;nb_som; j++)
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nb_compo_; k++ )
          {
            min_som(j,k) = 1.e+30 ;
            max_som(j,k) = 1.e-30 ;
          }

      <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;nb_elem_tot; num_elem++)
        {
          <span class="keywordflow">for</span> (j=0; j&lt;nb_som_elem; j++)
            {
              num_som = mazone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(num_elem,j);
              <span class="keywordflow">if</span>(num_som &lt; nb_som_return)
                {
                  <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>[num_som]++;
                  <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_compo_; ncomp++)
                    {
                      champ_som(num_som,ncomp) += <a class="code" href="classChamp__P1NC__implementation.html#af03937cefb3ed641c5223a7a00fcb778">valeur_a_sommet_compo</a>(num_som,num_elem,ncomp);
                      <span class="keywordflow">for</span>(face_adj=0; face_adj&lt;nb_som_elem; face_adj ++)
                        {
                          <span class="keywordflow">if</span> (face_adj != j )
                            {
                              face_glob = elem_faces(num_elem, face_adj);
                              min_som(num_som,ncomp) = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a> ( ch(face_glob,ncomp),min_som(num_som,ncomp) ) ;
                              max_som(num_som,ncomp) = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a> ( ch(face_glob,ncomp),max_som(num_som,ncomp) ) ;
                            }
                        }
                    }
                }
            }
        }
      <span class="keywordflow">for</span> (num_som=0; num_som&lt;nb_som_return; num_som++)
        <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_compo_; ncomp++)
          {
            champ_som(num_som,ncomp) /= <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>[num_som];
            <span class="keywordflow">if</span> ( <a class="code" href="Champ__P1NC__implementation_8cpp.html#afbe7fcf4bcc6179a6c6cfc12b0a6d799">methode_calcul_valeurs_sommets</a>&gt;1)
              {
                <span class="keywordflow">if</span> ( champ_som(num_som,ncomp) &lt; min_som(num_som,ncomp) )
                  {
                    champ_som(num_som,ncomp) = min_som(num_som,ncomp) ;
                  }
                <span class="keywordflow">if</span> ( champ_som(num_som,ncomp) &gt; max_som(num_som,ncomp) )
                  {
                    champ_som(num_som,ncomp) = max_som(num_som,ncomp) ;
                  }
              }
          }
    }
  <span class="keywordflow">else</span>
    {
      assert(<a class="code" href="Champ__P1NC__implementation_8cpp.html#afbe7fcf4bcc6179a6c6cfc12b0a6d799">methode_calcul_valeurs_sommets</a>==-1);
      champ_som = 0;
      <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> = 0;
      <span class="keywordtype">int</span> nb_comp=nb_compo_;
      <span class="keywordtype">int</span> nb_faces_tot=zone_VEF.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
      <span class="keywordtype">int</span> nb_som_face=zone_VEF.<a class="code" href="classZone__VF.html#a990808f967f351edbb83ff11d60b7445" title="renvoie le nombre de sommets par face. Rque : on a suppose que toutes les faces avait le meme nombre ...">nb_som_face</a>();
      <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
      <span class="keywordtype">int</span> face;
      <span class="keywordflow">for</span>(face=0; face&lt;nb_faces_tot; face++)
        {

          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
            {
              <span class="keywordtype">int</span> som1=face_sommets(face,isom);
              <span class="keywordflow">if</span> (som1&lt;nb_som_return)
                {
                  <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>[som1]++;
                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
                    champ_som(som1,k)+=ch(face,k);
                }
            }
        }


      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_som=0; num_som&lt;nb_som_return; num_som++)
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ncomp=0; ncomp&lt;nb_compo_; ncomp++)
          {
            champ_som(num_som,ncomp) /= <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>[num_som];
          }
    }
  <span class="keywordflow">return</span> champ_som;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a81463cf6fd9628251179b3e24ccbd803"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_aux_sommets_compo" ref="a81463cf6fd9628251179b3e24ccbd803" args="(const Domaine &amp;dom, DoubleVect &amp;ch_som, int ncomp) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp; Champ_P1NC_implementation::valeur_aux_sommets_compo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname"><em>dom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>ch_som</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classChamp__implementation.html#ab0166b0c8883bf3f3822e304cc08453f">Champ_implementation</a>.</p>

<p>Reimplemented in <a class="el" href="classChamp__Fonc__P1NC.html#aa4563540b023b926b0fc45cf7eebd9f9">Champ_Fonc_P1NC</a>, and <a class="el" href="classChamp__P1NC.html#ad8d5a61271cb8c1f0bf71b0c6e1f2eab">Champ_P1NC</a>.</p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01769">1769</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>References <a class="el" href="Memoire_8cpp_source.html#l00026">compteur</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00609">Zone_VF::face_sommets()</a>, <a class="el" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">Champ_implementation::le_champ()</a>, <a class="el" href="Double_8h_source.html#l00180">max()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00043">methode_calcul_valeurs_sommets</a>, <a class="el" href="Double_8h_source.html#l00199">min()</a>, <a class="el" href="Zone_8h_source.html#l00319">Zone::nb_elem_tot()</a>, <a class="el" href="Zone__VF_8h_source.html#l00527">Zone_VF::nb_faces_tot()</a>, <a class="el" href="Zone_8cpp_source.html#l00586">Zone::nb_som()</a>, <a class="el" href="Zone_8h_source.html#l00445">Zone::nb_som_elem()</a>, <a class="el" href="Zone__VF_8h_source.html#l00538">Zone_VF::nb_som_face()</a>, <a class="el" href="Zone_8h_source.html#l00344">Zone::sommet_elem()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01724">valeur_a_sommet_compo()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>, <a class="el" href="Champ__implementation_8cpp_source.html#l00035">Champ_implementation::zone_dis_base()</a>, and <a class="el" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; zone_dis = <a class="code" href="classChamp__implementation.html#a1be8c351fc8394e9126755dd557d13ca">zone_dis_base</a>();
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; mazone = zone_dis.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();

  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();


  <span class="keywordtype">int</span> nb_som = mazone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();

  <a class="code" href="classIntVect.html">IntVect</a> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>(nb_som);
  <span class="keywordflow">if</span> (<a class="code" href="Champ__P1NC__implementation_8cpp.html#afbe7fcf4bcc6179a6c6cfc12b0a6d799">methode_calcul_valeurs_sommets</a>&gt;0)
    {
      <span class="keywordtype">int</span> nb_elem_tot = mazone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
      <span class="keywordtype">int</span> nb_som_elem = mazone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
      <span class="keywordtype">int</span> num_elem,num_som,j;
      champ_som = 0;
      <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> = 0;
      <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();


      <a class="code" href="classDoubleVect.html">DoubleVect</a> min_som(nb_som) ;
      <a class="code" href="classDoubleVect.html">DoubleVect</a> max_som(nb_som) ;
      <span class="keywordtype">int</span> face_adj,face_glob;

      <span class="keywordflow">for</span> (j=0; j&lt;nb_som; j++)
        {
          min_som(j) = 1.e+30 ;
          max_som(j) = 1.e-30 ;
        }

      <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;nb_elem_tot; num_elem++)
        {
          <span class="keywordflow">for</span> (j=0; j&lt;nb_som_elem; j++)
            {
              num_som = mazone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(num_elem,j);
              <span class="keywordflow">if</span>(num_som &lt; nb_som)
                {
                  <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>[num_som]++;

                  champ_som(num_som) += <a class="code" href="classChamp__P1NC__implementation.html#af03937cefb3ed641c5223a7a00fcb778">valeur_a_sommet_compo</a>(num_som,num_elem,ncomp);

                  <span class="keywordflow">for</span>(face_adj=0; face_adj&lt;nb_som_elem; face_adj ++)
                    {
                      <span class="keywordflow">if</span> (face_adj != j )
                        {
                          face_glob = elem_faces(num_elem, face_adj);
                          min_som(num_som) = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>
                                             ( ch(face_glob,ncomp),min_som(num_som) ) ;
                          max_som(num_som) = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>
                                             ( ch(face_glob,ncomp),max_som(num_som) ) ;
                        }
                    }

                }
            }
        }

      <span class="keywordflow">for</span> (num_som=0; num_som&lt;nb_som; num_som++)
        {
          champ_som(num_som) /= <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>[num_som];
          <span class="keywordflow">if</span> (<a class="code" href="Champ__P1NC__implementation_8cpp.html#afbe7fcf4bcc6179a6c6cfc12b0a6d799">methode_calcul_valeurs_sommets</a>&gt;1)
            {
              <span class="keywordflow">if</span> ( champ_som(num_som) &lt; min_som(num_som) ) champ_som(num_som) = min_som(num_som) ;
              <span class="keywordflow">if</span> ( champ_som(num_som) &gt; max_som(num_som) ) champ_som(num_som) = max_som(num_som) ;
            }

        }
    }
  <span class="keywordflow">else</span>
    {
      champ_som = 0;
      <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> = 0;
      <span class="keywordtype">int</span> nb_faces_tot=zone_VEF.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
      <span class="keywordtype">int</span> nb_som_face=zone_VEF.<a class="code" href="classZone__VF.html#a990808f967f351edbb83ff11d60b7445" title="renvoie le nombre de sommets par face. Rque : on a suppose que toutes les faces avait le meme nombre ...">nb_som_face</a>();
      <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
      <span class="keywordtype">int</span> face;
      <span class="keywordflow">for</span>(face=0; face&lt;nb_faces_tot; face++)
        {

          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
            {
              <span class="keywordtype">int</span> som1=face_sommets(face,isom);
              <span class="keywordflow">if</span> (som1&lt;nb_som)
                {
                  <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>[som1]++;
                  champ_som(som1)+=ch(face,ncomp);
                }
            }
        }


      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_som=0; num_som&lt;nb_som; num_som++)
        {
          champ_som(num_som) /= <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>[num_som];
        }

    }
  <span class="keywordflow">return</span> champ_som;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a466ec2614b7af2152482bb253c7cb4f9"></a><!-- doxytag: member="Champ_P1NC_implementation::zone_vef" ref="a466ec2614b7af2152482bb253c7cb4f9" args="() const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual const <a class="el" href="classZone__VEF.html">Zone_VEF</a>&amp; Champ_P1NC_implementation::zone_vef </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [protected, pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implemented in <a class="el" href="classChamp__Fonc__P1NC.html#a674957c0e83fe37a2fa94029917a439f">Champ_Fonc_P1NC</a>, and <a class="el" href="classChamp__P1NC.html#a122a5f097bee0c82357ab77ab23e0068">Champ_P1NC</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00895">filtrer_H1()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00945">filtrer_L2()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01124">filtrer_resu()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01928">fixer_nb_valeurs_nodales()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01906">imprime_P1NC()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01873">remplir_coord_noeuds()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01890">remplir_coord_noeuds_et_polys()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01332">valeur_a_elem()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01361">valeur_a_elem_compo()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01724">valeur_a_sommet_compo()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01391">valeur_aux_elems()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01446">valeur_aux_elems_compo()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01556">valeur_aux_elems_compo_smooth()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01490">valeur_aux_elems_smooth()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01611">valeur_aux_sommets()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01769">valeur_aux_sommets_compo()</a>.</p>

</div>
</div>
<hr/><h2>Friends And Related Function Documentation</h2>
<a class="anchor" id="a900ff1f8888f75232223f7fe860214fa"></a><!-- doxytag: member="Champ_P1NC_implementation::construire_MatP1NC2P1_H1" ref="a900ff1f8888f75232223f7fe860214fa" args="(Champ_P1NC &amp;, const Domaine &amp;, double &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int construire_MatP1NC2P1_H1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9f8ba857150e3b5ff99bc4abb30e7ae7"></a><!-- doxytag: member="Champ_P1NC_implementation::construire_MatP1NC2P1_L2" ref="a9f8ba857150e3b5ff99bc4abb30e7ae7" args="(Champ_P1NC &amp;, const Domaine &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int construire_MatP1NC2P1_L2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa7a1c2ef5332f7909f2dabc29e75a956"></a><!-- doxytag: member="Champ_P1NC_implementation::construire_secmem_H1" ref="aa7a1c2ef5332f7909f2dabc29e75a956" args="(Champ_P1NC &amp;, const Domaine &amp;, DoubleTab &amp;, const double &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int construire_secmem_H1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a38d2d8477f11d236a2f94ac5ce713fec"></a><!-- doxytag: member="Champ_P1NC_implementation::construire_secmem_L2" ref="a38d2d8477f11d236a2f94ac5ce713fec" args="(Champ_P1NC &amp;, const Domaine &amp;, DoubleTab &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int construire_secmem_L2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa8d54a9e9a1aaed9408860d97043122a"></a><!-- doxytag: member="Champ_P1NC_implementation::test" ref="aa8d54a9e9a1aaed9408860d97043122a" args="(Champ_P1NC &amp;, const Domaine &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int test </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00895">filtrer_H1()</a>.</p>

</div>
</div>
<a class="anchor" id="a0b97339eaa2d6e03698b5cb38cccc829"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_P1_H1" ref="a0b97339eaa2d6e03698b5cb38cccc829" args="(const Champ_P1NC &amp;, const Domaine &amp;, DoubleTab &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a>&amp; valeur_P1_H1 </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;&#160;</td>
          <td class="paramname"><em>cha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname"><em>dom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>ch_som</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00716">716</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00895">filtrer_H1()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a> = dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);
  <span class="keywordtype">int</span> nb_elem_tot = zone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
  <span class="keywordtype">int</span> nb_som = zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();
  <span class="keywordtype">int</span> nb_som_elem = zone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = cha.<a class="code" href="classChamp__P1NC.html#a122a5f097bee0c82357ab77ab23e0068">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; normales=zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>, cha.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_som = zone.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keywordtype">double</span> mijK;
  <span class="keywordtype">int</span> nb_comp=ch_som.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
  <span class="keywordtype">int</span> dimension=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;

  <span class="keywordflow">if</span>(dimension==2)
    {
      mijK=1./4.;
    }
  <span class="keywordflow">else</span>
    {
      mijK=1./9.;
    }

  <span class="keywordtype">int</span> elem;
  <span class="keywordtype">int</span> n_bord;
  <span class="keyword">static</span> <span class="keywordtype">double</span> diag_ref;
  <span class="keywordtype">double</span> non_prepare=0;
  <span class="keywordflow">if</span> ( cha.<a class="code" href="classChamp__P1NC__implementation.html#aaa41328eec002384f541c9de9a4891b2">MatP1NC2P1_H1</a>.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() &lt;2 )
    non_prepare=1;
  non_prepare=<a class="code" href="communications_8cpp.html#adb9fffe31bc56a52685e93ba06932547" title="renvoie le plus petit int i sur l&#39;ensemble des processeurs du groupe courant.">Process::mp_min</a>(non_prepare);
  <span class="keywordflow">if</span> (non_prepare==1)
    {
      <a class="code" href="classEFichier.html" title="Fichier en lecture Cette classe est a la classe C++ ifstream ce que la classe Entree est a la classe ...">EFichier</a> fic;
      <span class="keywordflow">if</span>(fic.<a class="code" href="classEntree__Fichier__base.html#a8e34b235668e94f335cc9ab18dd4e427">ouvrir</a>(<span class="stringliteral">&quot;solveur.bar&quot;</span>))
        {
          <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>,cha.<a class="code" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">solveur_H1</a>);
          fic &gt;&gt; solv;
        }
      <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; mat=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,cha.<a class="code" href="classChamp__P1NC__implementation.html#aaa41328eec002384f541c9de9a4891b2">MatP1NC2P1_H1</a>);
      <span class="keywordtype">int</span> rang;
      <span class="keywordtype">int</span> nnz=0;
      <a class="code" href="classIntLists.html" title="Un tableau de listes de type IntList.">IntLists</a> voisins(nb_som);
      <a class="code" href="classDoubleLists.html" title="Un tableau de listes de type DoubleList.">DoubleLists</a> coeffs(nb_som);
      <a class="code" href="classDoubleVect.html">DoubleVect</a> diag(nb_som);
      <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
        {
          <span class="keywordtype">double</span> volume=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem);
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_elem; isom++)
            {
              <span class="keywordtype">int</span> facei=elem_faces(elem,isom);
              <span class="keywordtype">int</span> i=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(elem_som(elem,isom));
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jsom=isom+1; jsom&lt;nb_som_elem; jsom++)
                {
                  <span class="keywordtype">int</span> facej=elem_faces(elem,jsom);
                  <span class="keywordtype">int</span> j=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(elem_som(elem,jsom));
                  <span class="keywordtype">double</span> coeffij=0.0;
                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;dimension; k++)
                    coeffij+=normales(facei,k)*normales(facej,k);

                  coeffij*=zone_VEF.<a class="code" href="classZone__VEF.html#a5c3e9d7f89d87989e338f5d725853e48">oriente_normale</a>(facei,elem)*
                           zone_VEF.<a class="code" href="classZone__VEF.html#a5c3e9d7f89d87989e338f5d725853e48">oriente_normale</a>(facej,elem);
                  coeffij*=mijK/volume;
                  <span class="keywordtype">int</span> ii=i, jj=j;
                  <span class="keywordflow">if</span>(ii&gt;jj)
                    {
                      <span class="keywordtype">int</span> tmp=ii;
                      ii=jj;
                      jj=tmp;
                    }
                  rang=voisins[ii].rang(jj);
                  <span class="keywordflow">if</span>(rang==-1)
                    {
                      voisins[ii].add(jj);
                      coeffs[ii].add(coeffij);
                      nnz++;
                    }
                  <span class="keywordflow">else</span>
                    {
                      coeffs[ii][rang]+=coeffij;
                    }
                  diag[ii]-=coeffij;
                  diag[jj]-=coeffij;
                }
            }
        }
      diag_ref=diag(0);
      <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
        {
<span class="comment">// for n_bord</span>
          <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
          <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
          <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
          <span class="keywordtype">int</span> num2 = num1 + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();

          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=num1; face&lt;num2; face++)
            {
              elem=zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(face,0);
              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;dimension; isom++)
                {
                  <span class="keywordtype">int</span> som=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,isom);
                  som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
                  diag[som]=1.e1*diag_ref;
                }
            }
        }

      mat.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nb_som, nnz+nb_som) ;
      mat.<a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">remplir</a>(voisins, coeffs, diag) ;
      mat.<a class="code" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69" title="Suppression des doublons on ordonne tab2; Verification de la diagonale: tous ses elements doivent etr...">compacte</a>() ;
      mat.<a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(1);
<span class="comment">// Cerr &lt;&lt; &quot;Matrice de filtrage OK&quot; &lt;&lt; finl;</span>
<span class="comment">// Cerr &lt;&lt; &quot;Matrice de Laplacien P1 : &quot; &lt;&lt; finl;</span>
<span class="comment">// mat.imprimer(Cerr) &lt;&lt; finl;</span>
    }


  <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>=-1./dimension;
  <span class="keywordtype">int</span> k;
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
    {
<span class="comment">// for comp</span>
      <a class="code" href="classDoubleVect.html">DoubleVect</a> secmem(nb_som);
      <a class="code" href="classDoubleVect.html">DoubleVect</a> solution(nb_som);
      <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
        {
<span class="comment">// for elem</span>
          <span class="keywordtype">double</span> volume=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem);
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_elem; isom++)
            {
              <span class="keywordtype">int</span> facei=elem_faces(elem,isom);
              <span class="keywordtype">int</span> i=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(elem_som(elem,isom));
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jsom=0; jsom&lt;nb_som_elem; jsom++)
                {
                  <span class="keywordtype">int</span> facej=elem_faces(elem,jsom);
                  <span class="keywordtype">double</span> coeffij=0;
                  <span class="keywordflow">for</span>(k=0; k&lt;dimension; k++)
                    coeffij+=normales(facei,k)*normales(facej,k);
                  coeffij*=zone_VEF.<a class="code" href="classZone__VEF.html#a5c3e9d7f89d87989e338f5d725853e48">oriente_normale</a>(facei,elem)*
                           zone_VEF.<a class="code" href="classZone__VEF.html#a5c3e9d7f89d87989e338f5d725853e48">oriente_normale</a>(facej,elem);
                  coeffij*=coeff/volume;
                  secmem(i)+=coeffij*ch(facej,comp);
                }
            }
        }
      <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
        {
<span class="comment">// for n_bord</span>
          <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
          <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
          <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
          <span class="keywordtype">int</span> num2 = num1 + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();

          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=num1; face&lt;num2; face++)
            {
              elem=zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(face,0);
              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;dimension; isom++)
                {
                  <span class="keywordtype">int</span> som=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,isom);
                  som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
                  secmem(som)=1.e1*diag_ref* cha.<a class="code" href="classChamp__P1NC.html#a099c50c4dd167411656183422b0fe120">valeur_a_sommet_compo</a>(som, elem, comp);
                }
            }
        }

      <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>,cha.<a class="code" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">solveur_H1</a>);
      solv.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#aaa41328eec002384f541c9de9a4891b2">MatP1NC2P1_H1</a>, secmem, solution);

      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> som=0; som&lt;nb_som; som++)
        <a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>(som,comp)=solution(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som));

    }

  <span class="keywordflow">return</span> <a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a49c2050e228bf0f43a33de95e167b04e"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_P1_L2" ref="a49c2050e228bf0f43a33de95e167b04e" args="(Champ_Fonc_P1NC &amp;, const Domaine &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a>&amp; valeur_P1_L2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classChamp__Fonc__P1NC.html">Champ_Fonc_P1NC</a> &amp;&#160;</td>
          <td class="paramname"><em>cha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname"><em>dom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00494">494</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; mazone = dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);
  <span class="keywordtype">int</span> nb_elem_tot = mazone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
  <span class="keywordtype">int</span> nb_som = mazone.<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
  <span class="keywordtype">int</span> nb_som_elem = mazone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = cha.<a class="code" href="classChamp__Fonc__P1NC.html#a674957c0e83fe37a2fa94029917a439f">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_som = mazone.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
  <span class="keywordtype">double</span> mijK, miiK;
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit_som=cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>();

  <span class="keywordtype">int</span> nb_comp=vit_som.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> secmem(cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>());
  secmem=0.;

  <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
    {
      mijK=1./12.;
      miiK= 1./6.;
    }
  <span class="keywordflow">else</span>
    {
      mijK=1./18.;
      miiK= 1./12.;
    }

<span class="comment">// dans le cas d&#39;une zone nulle on doit effectuer le dimensionnement</span>
<span class="comment">// mais une seule fois</span>
  <span class="keywordtype">double</span> non_prepare=0;
  <span class="keywordflow">if</span> (cha.<a class="code" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">MatP1NC2P1_L2</a>.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() &lt;2)
    non_prepare=1;
  non_prepare=<a class="code" href="communications_8cpp.html#adb9fffe31bc56a52685e93ba06932547" title="renvoie le plus petit int i sur l&#39;ensemble des processeurs du groupe courant.">Process::mp_min</a>(non_prepare);
  <span class="keywordflow">if</span> (non_prepare==1)
    {
<span class="comment">// Initialisation du solveur</span>
      <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>, (cha.<a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>));
      <a class="code" href="classLecFicDiffuse.html" title="Cette classe implemente les operateurs et les methodes virtuelles de la classe EFichier de la facon s...">LecFicDiffuse</a> fic;
      fic.<a class="code" href="classLecFicDiffuse.html#a2e4f3199de5e1b47edcffc68952c7be8" title="Ouverture du fichier. Cette methode doit etre appelee par tous les processeurs du groupe...">ouvrir</a>(<span class="stringliteral">&quot;solveur.bar&quot;</span>);
      <span class="keywordflow">if</span>(fic.<a class="code" href="classLec__Diffuse__base.html#a0d28f6309b5b0d97b3bd0ad8309aec61">good</a>())
        {
          fic &gt;&gt; solv;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot;solveur.bar ouvert pour lire: &quot;</span> &lt;&lt; solv &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
        }
      solv-&gt;reinit();

      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;On remplit la matrice cha.MatP1NC2P1_L2 pour le champ &quot;</span>&lt;&lt; cha.<a class="code" href="classField__base.html#ae1377124eabe8387aced762115b062bb" title="Renvoie le nom du champ.">le_nom</a>() &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; mat=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, (cha.<a class="code" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">MatP1NC2P1_L2</a>));
      <span class="keywordtype">int</span> rang;
      <span class="keywordtype">int</span> nnz=0;
      <a class="code" href="classIntLists.html" title="Un tableau de listes de type IntList.">IntLists</a> voisins(nb_som);
      <a class="code" href="classDoubleLists.html" title="Un tableau de listes de type DoubleList.">DoubleLists</a> coeffs(nb_som);
      <a class="code" href="classDoubleVect.html">DoubleVect</a> diag(nb_som);
      <span class="keywordtype">int</span> elem;
      <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
        {
          <span class="keywordtype">double</span> coeff_ij=mijK*zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem);
          <span class="keywordtype">double</span> coeff_ii=miiK*zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem);
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_elem; isom++)
            {
              <span class="keywordtype">int</span> som=elem_som(elem,isom);
              <span class="keywordtype">int</span> ii=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
              diag[ii]+=coeff_ii;
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jsom=isom+1; jsom&lt;nb_som_elem; jsom++)
                {
                  <span class="keywordtype">int</span> asom=elem_som(elem,jsom);
                  <span class="keywordtype">int</span> j=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(asom);
                  <span class="keywordtype">int</span> i=ii;
                  <span class="keywordflow">if</span>(i&gt;j)
                    {
                      <span class="keywordtype">int</span> k=j;
                      j=i;
                      i=k;
                    }
                  rang=voisins[i].rang(j);
                  <span class="keywordflow">if</span>(rang==-1)
                    {
                      voisins[i].add(j);
                      coeffs[i].add(coeff_ij);
                      nnz++;
                    }
                  <span class="keywordflow">else</span>
                    {
                      coeffs[i][rang]+=coeff_ij;
                    }
                }
            }
        }


      {
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som; i++)
          <span class="keywordflow">if</span>(diag(i)==0)
            diag(i)=1.;
      }

      mat.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nb_som, nnz+nb_som) ;
      mat.<a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">remplir</a>(voisins, coeffs, diag) ;
      mat.<a class="code" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69" title="Suppression des doublons on ordonne tab2; Verification de la diagonale: tous ses elements doivent etr...">compacte</a>() ;
      mat.<a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(1);

<span class="comment">// Modif CD 15/04/03 pour paralleliser le filtrage</span>
<span class="comment">// On copie la matrice remplie ci-dessus dans une matrice bloc.</span>
<span class="comment">// Cette modification permet d&#39;utiliser le preconditionnement SSOR</span>

<span class="comment">// On fait aussi la transformation en matrice bloc en sequentiel car sinon</span>
<span class="comment">// probleme avec NP</span>

      cha.<a class="code" href="classChamp__P1NC__implementation.html#a5badd5dee68ffbd7e63228509fe1cb18">dimensionner_Mat_Bloc_Morse_Sym</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>);
      cha.<a class="code" href="classChamp__P1NC__implementation.html#a80e98cf9dfa018d6f3d18608924c8d57">Mat_Morse_to_Mat_Bloc</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>);

<span class="comment">// Fin Modif CD 15/04/03</span>

<span class="comment">// mat.imprimer_formatte(Cerr);</span>
<span class="comment">// Cerr&lt;&lt;&quot;zone.nb_som_tot() = &quot;&lt;&lt;mazone.nb_som_tot()&lt;&lt;&quot;, zone.nb_som() = &quot;&lt;&lt;mazone.nb_som()&lt;&lt;finl;</span>
<span class="comment">// Cerr &lt;&lt; &quot;Matrice de filtrage OK&quot; &lt;&lt; finl;</span>
<span class="comment">// Cout &lt;&lt; &quot;Matrice de masse P1 : &quot; &lt;&lt; finl;</span>
<span class="comment">// mat.imprimer(Cout) &lt;&lt; finl;</span>
    }

<span class="comment">// Debog::verifier(&quot; verif champ &quot; , ch);</span>

  <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
  <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
    coeff=1./6.;
  <span class="keywordflow">else</span>
    coeff=1./12.;

  <span class="keywordtype">int</span> nb_faces=zone_VEF.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
  <span class="keywordtype">int</span> nb_faces_tot=zone_VEF.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
  <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> virtfait(nb_faces_tot-nb_faces);
  <span class="keywordtype">int</span> nb_som_face=zone_VEF.<a class="code" href="classZone__VF.html#a990808f967f351edbb83ff11d60b7445" title="renvoie le nombre de sommets par face. Rque : on a suppose que toutes les faces avait le meme nombre ...">nb_som_face</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins=zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keywordtype">int</span> face;

  <span class="keywordflow">for</span>(face=0; face&lt;nb_faces_tot; face++)
    {
      <span class="keywordtype">int</span> indvirtface=face-nb_faces;
<span class="comment">// on regarde si la face virtuelle n&#39;a pas deja ete traitee</span>
      <span class="keywordflow">if</span> (indvirtface&gt;=0)
        <span class="keywordflow">if</span> (virtfait[indvirtface]==1) <span class="keywordflow">continue</span>;

      <span class="keywordtype">int</span> elem1=face_voisins(face,0);
      <span class="keywordtype">int</span> elem2=face_voisins(face,1);
      <span class="keywordtype">double</span> volume=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem1);
      <span class="keywordflow">if</span>(elem2!=-1)
        volume+=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem2);
      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
        {
          <span class="keywordtype">int</span> som=face_sommets(face,isom);
          <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<span class="comment">// Pour un sommet periodique on ne retient qu une seule contribution</span>
<span class="comment">// pour deux faces en vis a vis</span>
          <span class="keywordflow">if</span> (som1==som)
            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
              secmem(som1,k)+=coeff*volume*ch(face,k);
        }
    }

  secmem.echange_espace_virtuel();
<span class="comment">// Debog::verifier(&quot; verif secmem_ech &quot; , secmem);</span>

  <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>, cha.<a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>);
  <a class="code" href="classDoubleVect.html">DoubleVect</a> secmemk(cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>());
  <a class="code" href="classDoubleVect.html">DoubleVect</a> solution(cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>());

  <span class="keywordflow">if</span>(nb_comp==1)
    {
      solution=vit_som;
      secmem.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
      <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot; verif secmem &quot;</span> , secmem);


<span class="comment">// ON UTILISE LA MEME MATRICE EN SEQUENTIEL ET PARALLELE</span>
<span class="comment">// CE QUI PERMET D UTILISER UNE MATRICE BLOC QUAND ON APPELLE LE SOLVEUR NP</span>
      solv.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmem, solution);

      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> som=0; som&lt;nb_som; som++)
        vit_som(som)=solution(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som));
    }
  <span class="keywordflow">else</span>
    {
      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
        {
          <span class="keywordtype">int</span> som;
          <span class="keywordflow">for</span>(som=0; som&lt;nb_som; som++)
            {
              solution(som)=vit_som(som,k);
              secmemk(som)=secmem(som,k);
            }

          solution.echange_espace_virtuel();
          secmemk.echange_espace_virtuel();

<span class="comment">// ON UTILISE LA MEME MATRICE EN SEQUENTIEL ET PARALLELE</span>
<span class="comment">// CE QUI PERMET D UTILISER UNE MATRICE BLOC QUAND ON APPELLE LE SOLVEUR NP</span>
          solv.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmemk, solution);

          <span class="keywordflow">for</span>(som=0; som&lt;nb_som; som++)
            vit_som(som,k)=solution(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som));
        }
    }

<span class="comment">// Debog::verifier(&quot; verif vit_som 0 &quot; , vit_som);</span>
  vit_som.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<span class="comment">// Debog::verifier(&quot; verif vit_som 1 &quot; , vit_som);</span>

<span class="comment">// {</span>
<span class="comment">// for(int k=0; k&lt;nb_comp; k++)</span>
<span class="comment">// for(int som=0; som&lt;nb_som; som++)</span>
<span class="comment">// Cerr &lt;&lt; k &lt;&lt; &quot; x &quot; &lt;&lt; coord(som,0)&lt;&lt; &quot; y &quot; &lt;&lt; coord(som,1) &lt;&lt; &quot; &quot; &lt;&lt; vit_som(som,k) &lt;&lt; finl;</span>
<span class="comment">// double psc=vit_som*vit_som;</span>
<span class="comment">// psc = Process::mp_sum(psc);</span>
<span class="comment">// Debog::verifier(&quot;norme : &quot;, psc);</span>
<span class="comment">// Cerr &lt;&lt; &quot;############ psc = &quot; &lt;&lt; psc &lt;&lt; finl;</span>
<span class="comment">// }</span>
  <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot; verif vit_som &quot;</span> , vit_som);
  <span class="keywordflow">return</span> vit_som;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac2c0fa150a14667a03e52062463bf6c0"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_P1_L2" ref="ac2c0fa150a14667a03e52062463bf6c0" args="(Champ_P1NC &amp;, const Domaine &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a>&amp; valeur_P1_L2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;&#160;</td>
          <td class="paramname"><em>cha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname"><em>dom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Projection du champ P1NC "cha" sur l'espace des champs P1.<br/>
Le resultat est stocke dans cha.ch_som() et renvoye (valeur de retour)<br/>
Voir note technique 2006/010 de Patrick Quemere "Nouvelle approche VEF pour la LES...".<br/>
Voir aussi "What is in TRUST" : Scales_Separation_P1_P1NC. </p>

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">76</a> of file <a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00945">filtrer_L2()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01124">filtrer_resu()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; mazone = dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);

  <span class="keywordtype">int</span> nb_elem_tot = mazone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
  <span class="keywordtype">int</span> nb_som = mazone.<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
  <span class="keywordtype">int</span> nb_som_elem = mazone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();

  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = cha.<a class="code" href="classChamp__P1NC.html#a122a5f097bee0c82357ab77ab23e0068">zone_vef</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>, cha.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_som = mazone.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
  <span class="keywordtype">double</span> mijK, miiK;
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit_som=cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>();

  <span class="keywordtype">int</span> n_bord, nb_comp=vit_som.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> secmem(cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>());

  secmem=0.;
<span class="comment">// vit_som=0.; // PQ : 06/10/04 : dans la resolution du systeme, &quot;solution&quot; repart de vit_som=cha.ch_som()</span>
<span class="comment">// pour s&#39;affranchir de recalculer u_bar lors d&#39;un double appel a filtrer_L2</span>

  <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
    {
      mijK=1./12.;
      miiK= 1./6.;
    }
  <span class="keywordflow">else</span>
    {
      mijK=1./18.;
      miiK= 1./12.;
    }

<span class="comment">// dans le cas d&#39;une zone nulle on doit effectuer le dimensionnement</span>
<span class="comment">// mais une seule fois</span>
  <span class="keywordtype">double</span> non_prepare=0;
  <span class="keywordflow">if</span> (cha.<a class="code" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">MatP1NC2P1_L2</a>.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() &lt;2)
    non_prepare=1;
  non_prepare=<a class="code" href="communications_8cpp.html#adb9fffe31bc56a52685e93ba06932547" title="renvoie le plus petit int i sur l&#39;ensemble des processeurs du groupe courant.">Process::mp_min</a>(non_prepare);
  <span class="keywordflow">if</span> (non_prepare==1)
    {
<span class="comment">// Initialisation du solveur</span>
      <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>, (cha.<a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>));
      <a class="code" href="classLecFicDiffuse.html" title="Cette classe implemente les operateurs et les methodes virtuelles de la classe EFichier de la facon s...">LecFicDiffuse</a> fic;
      fic.<a class="code" href="classLecFicDiffuse.html#a2e4f3199de5e1b47edcffc68952c7be8" title="Ouverture du fichier. Cette methode doit etre appelee par tous les processeurs du groupe...">ouvrir</a>(<span class="stringliteral">&quot;solveur.bar&quot;</span>);
      <span class="keywordflow">if</span>(fic.<a class="code" href="classLec__Diffuse__base.html#a0d28f6309b5b0d97b3bd0ad8309aec61">good</a>())
        {
          fic &gt;&gt; solv;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot;solveur.bar ouvert pour lire: &quot;</span> &lt;&lt; solv &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
        }
      solv-&gt;reinit();

      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;On remplit la matrice cha.MatP1NC2P1_L2 pour le champ &quot;</span>&lt;&lt; cha.<a class="code" href="classField__base.html#ae1377124eabe8387aced762115b062bb" title="Renvoie le nom du champ.">le_nom</a>() &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; mat=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, (cha.<a class="code" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">MatP1NC2P1_L2</a>));
      <span class="keywordtype">int</span> rang;
      <span class="keywordtype">int</span> nnz=0;
      <a class="code" href="classIntLists.html" title="Un tableau de listes de type IntList.">IntLists</a> voisins(nb_som);
      <a class="code" href="classDoubleLists.html" title="Un tableau de listes de type DoubleList.">DoubleLists</a> coeffs(nb_som);
      <a class="code" href="classDoubleVect.html">DoubleVect</a> diag(nb_som);
      <span class="keywordtype">int</span> elem;
      <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
        {
          <span class="keywordtype">double</span> coeff_ij=mijK*zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem);
          <span class="keywordtype">double</span> coeff_ii=miiK*zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem);
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_elem; isom++)
            {
              <span class="keywordtype">int</span> som=elem_som(elem,isom);
              <span class="keywordtype">int</span> ii=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
              diag[ii]+=coeff_ii;
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jsom=isom+1; jsom&lt;nb_som_elem; jsom++)
                {
                  <span class="keywordtype">int</span> asom=elem_som(elem,jsom);
                  <span class="keywordtype">int</span> j=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(asom);
                  <span class="keywordtype">int</span> i=ii;
                  <span class="keywordflow">if</span>(i&gt;j)
                    {
                      <span class="keywordtype">int</span> k=j;
                      j=i;
                      i=k;
                    }
                  rang=voisins[i].rang(j);
                  <span class="keywordflow">if</span>(rang==-1)
                    {
                      voisins[i].add(j);
                      coeffs[i].add(coeff_ij);
                      nnz++;
                    }
                  <span class="keywordflow">else</span>
                    {
                      coeffs[i][rang]+=coeff_ij;
                    }
                }
            }
        }

<span class="comment">// PQ : pour le remplissage des coefficients de la matrice specifiques au CL Dirichlet,</span>
<span class="comment">// on commence par traiter les conditions Dirichlet, PUIS Dirichlet_homogene pour s&#39;assurer</span>
<span class="comment">// de l&#39;&quot;adherence&quot; des points sommets appartenant aux deux types de CL (aretes de bords)</span>

      <a class="code" href="classIntVect.html">IntVect</a> test_cl_imposee(nb_som);
      test_cl_imposee = 0;

      <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
        {
<span class="comment">// for n_bord</span>
          <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
          <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
          <span class="keywordtype">int</span> face;
          <span class="keywordtype">int</span> num1 = 0;
          <span class="keywordtype">int</span> num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<span class="comment">// if ( sub_type(Dirichlet,la_cl.valeur()))</span>
          <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
            {
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
                {
                  face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; isom++)
                    {
                      <span class="keywordtype">int</span> som=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,isom);
                      som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
                      <span class="keywordflow">if</span> (test_cl_imposee(som) == 0)
                        diag[som] = 0;
                      diag[som] += <a class="code" href="Champ__P1NC__implementation_8cpp.html#aa542335f9416aab2cb6f6d433f596516">coeff_penalisation</a>;
                      test_cl_imposee(som) += 1;
                    }
                }
            }
        }<span class="comment">//for n_bord</span>

      test_cl_imposee = 0;

      <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
        {
<span class="comment">// for n_bord</span>
          <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
          <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
          <span class="keywordtype">int</span> face;
          <span class="keywordtype">int</span> num1 = 0;
          <span class="keywordtype">int</span> num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();

          <span class="keywordflow">if</span> (  <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) )
            {
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
                {
                  face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;Objet_U::dimension; isom++)
                    {
                      <span class="keywordtype">int</span> som=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,isom);
                      som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
                      <span class="keywordflow">if</span> (test_cl_imposee(som) == 0)
                        diag[som] = 0;
                      diag[som] += <a class="code" href="Champ__P1NC__implementation_8cpp.html#aa542335f9416aab2cb6f6d433f596516">coeff_penalisation</a>;
                      test_cl_imposee(som) += 1;
                    }
                }
            }
        }<span class="comment">//for n_bord</span>

      {
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som; i++)
          <span class="keywordflow">if</span>(diag(i)==0)
            diag(i)=1.;
      }

<span class="comment">// coeffs = 0.;</span>
<span class="comment">// diag = 10.;</span>
      mat.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nb_som, nnz+nb_som) ;
      mat.<a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">remplir</a>(voisins, coeffs, diag) ;
      mat.<a class="code" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69" title="Suppression des doublons on ordonne tab2; Verification de la diagonale: tous ses elements doivent etr...">compacte</a>() ;
      mat.<a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(1);

<span class="comment">// Modif CD 15/04/03 pour paralleliser le filtrage</span>
<span class="comment">// On copie la matrice remplie ci-dessus dans une matrice bloc.</span>
<span class="comment">// Cette modification permet d&#39;utiliser le preconditionnement SSOR</span>

<span class="comment">// On fait aussi la transformation en matrice bloc en sequentiel car sinon</span>
<span class="comment">// probleme avec NP</span>

      cha.<a class="code" href="classChamp__P1NC__implementation.html#a5badd5dee68ffbd7e63228509fe1cb18">dimensionner_Mat_Bloc_Morse_Sym</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>);
      cha.<a class="code" href="classChamp__P1NC__implementation.html#a80e98cf9dfa018d6f3d18608924c8d57">Mat_Morse_to_Mat_Bloc</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>);

<span class="comment">// Fin Modif CD 15/04/03</span>

<span class="comment">// mat.imprimer_formatte(Cerr);</span>
<span class="comment">// Cerr&lt;&lt;&quot;zone.nb_som_tot() = &quot;&lt;&lt;mazone.nb_som_tot()&lt;&lt;&quot;, zone.nb_som() = &quot;&lt;&lt;mazone.nb_som()&lt;&lt;finl;</span>
<span class="comment">// Cerr &lt;&lt; &quot;Matrice de filtrage OK&quot; &lt;&lt; finl;</span>
<span class="comment">// Cout &lt;&lt; &quot;Matrice de masse P1 : &quot; &lt;&lt; finl;</span>
<span class="comment">// mat.imprimer(Cout) &lt;&lt; finl;</span>
    }

<span class="comment">// Debog::verifier(&quot; verif champ &quot; , ch);</span>

  <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
  <span class="keywordflow">if</span>(Objet_U::dimension==2)
    coeff=1./6.;
  <span class="keywordflow">else</span>
    coeff=1./12.;

  <span class="keywordtype">int</span> nb_faces=zone_VEF.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
  <span class="keywordtype">int</span> nb_faces_tot=zone_VEF.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
  <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> virtfait(nb_faces_tot-nb_faces);
  <span class="keywordtype">int</span> nb_som_face=zone_VEF.<a class="code" href="classZone__VF.html#a990808f967f351edbb83ff11d60b7445" title="renvoie le nombre de sommets par face. Rque : on a suppose que toutes les faces avait le meme nombre ...">nb_som_face</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins=zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keywordtype">int</span> face;
  <span class="keywordtype">int</span> premiere_face_int = zone_VEF.<a class="code" href="classZone__VF.html#a12869806fa4834aca8f2964e16509dfd" title="une face est interne ssi elle separe deux elements. renvoie le numero de la premiere face interne...">premiere_face_int</a>();

  <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
    {
<span class="comment">// for n_bord</span>
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      <span class="keywordtype">int</span> nb_faces_bord = le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
      <span class="keywordtype">int</span> num1 = 0;
      <span class="keywordtype">int</span> num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();

      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
<span class="comment">// *0.5 car les faces perio sont parcourues deux fois</span>
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
            {
              face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              <span class="keywordflow">if</span> (ind_face-nb_faces_bord&gt;=0) virtfait(face-nb_faces)=1;
              <span class="keywordtype">int</span> elem1=face_voisins(face,0);
              <span class="keywordtype">int</span> elem2=face_voisins(face,1);
              <span class="keywordtype">double</span> volume=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem1);
              <span class="keywordflow">if</span>(elem2!=-1)
                volume+=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem2);
              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
                {
                  <span class="keywordtype">int</span> som=face_sommets(face,isom);
                  <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
                    secmem(som1,k)+=0.5*coeff*volume*ch(face,k);
                }
            }
        }
      <span class="keywordflow">else</span>
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
          {
            face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
            <span class="keywordflow">if</span> (ind_face-nb_faces_bord&gt;=0) virtfait(face-nb_faces)=1;
            <span class="keywordtype">int</span> elem1=face_voisins(face,0);
            <span class="keywordtype">int</span> elem2=face_voisins(face,1);
            <span class="keywordtype">double</span> volume=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem1);
            <span class="keywordflow">if</span>(elem2!=-1)
              volume+=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem2);
            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
              {
                <span class="keywordtype">int</span> som=face_sommets(face,isom);
                <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
                  secmem(som1,k)+=coeff*volume*ch(face,k);
              }
          }
    }

  <span class="keywordflow">for</span>(face=premiere_face_int; face&lt;nb_faces_tot; face++)
    {
      <span class="keywordtype">int</span> indvirtface=face-nb_faces;
<span class="comment">// on regarde si la face virtuelle n&#39;a pas deja ete traitee</span>
      <span class="keywordflow">if</span> (indvirtface&gt;=0)
        <span class="keywordflow">if</span> (virtfait[indvirtface]==1) <span class="keywordflow">continue</span>;

      <span class="keywordtype">int</span> elem1=face_voisins(face,0);
      <span class="keywordtype">int</span> elem2=face_voisins(face,1);
      <span class="keywordtype">double</span> volume=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem1);
      <span class="keywordflow">if</span>(elem2!=-1)
        volume+=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem2);
      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
        {
          <span class="keywordtype">int</span> som=face_sommets(face,isom);
          <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
            secmem(som1,k)+=coeff*volume*ch(face,k);
        }
    }
<span class="comment">// ************************************************************************************************</span>
<span class="comment">// ************************************************************************************************</span>
<span class="comment">// </span>
<span class="comment">// Pour imposer u_som = u donne par CL_Dirichlet</span>
<span class="comment">//</span>
<span class="comment">// ************************************************************************************************</span>
<span class="comment">// ************************************************************************************************</span>

<span class="comment">// PQ : on commence par traiter les conditions Dirichlet, PUIS Dirichlet_homogene pour s&#39;assurer</span>
<span class="comment">// de l&#39;&quot;adherence&quot; des points sommets appartenant aux deux types de CL (aretes de bords)</span>

  <a class="code" href="classIntVect.html">IntVect</a> test_cl_imposee(nb_som);

  test_cl_imposee = 0;

  <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
    {
<span class="comment">// for n_bord</span>
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      <span class="keywordtype">int</span> num1 = 0;
      <span class="keywordtype">int</span> num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();

<span class="comment">// if ( sub_type(Dirichlet,la_cl.valeur()))</span>
      <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
            {
              face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
                {
                  <span class="keywordtype">int</span> som=face_sommets(face,isom);
                  <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
                    {
                      <span class="keywordflow">if</span> (test_cl_imposee(som1)==0)
                        secmem(som1,k) = 0;

                      secmem(som1,k) += <a class="code" href="Champ__P1NC__implementation_8cpp.html#aa542335f9416aab2cb6f6d433f596516">coeff_penalisation</a> * ch(face,k);
                    }
                  test_cl_imposee(som1) += 1;
                }
            }
        }
    }<span class="comment">//for n_bord</span>

  test_cl_imposee = 0;

  <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
    {
<span class="comment">// for n_bord</span>
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      <span class="keywordtype">int</span> num1 = 0;
      <span class="keywordtype">int</span> num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();

      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
            {
              face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
                {
                  <span class="keywordtype">int</span> som=face_sommets(face,isom);
                  <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
                    {
                      <span class="keywordflow">if</span> (test_cl_imposee(som1)==0)
                        secmem(som1,k) = 0;

                      secmem(som1,k) += <a class="code" href="Champ__P1NC__implementation_8cpp.html#aa542335f9416aab2cb6f6d433f596516">coeff_penalisation</a> * ch(face,k);
                    }
                  test_cl_imposee(som1) += 1;
                }
            }
        }
    }<span class="comment">//for n_bord</span>

<span class="comment">// ************************************************************************************************</span>
<span class="comment">// ************************************************************************************************</span>
  secmem.echange_espace_virtuel();
<span class="comment">// Debog::verifier(&quot; verif secmem_ech &quot; , secmem);</span>

  <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>, cha.<a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>);
  <a class="code" href="classDoubleVect.html">DoubleVect</a> secmemk(cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>());
  <a class="code" href="classDoubleVect.html">DoubleVect</a> solution(cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>());

  <span class="keywordflow">if</span>(nb_comp==1)
    {
      solution=vit_som;
      secmem.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
      <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot; verif secmem &quot;</span> , secmem);


<span class="comment">// ON UTILISE LA MEME MATRICE EN SEQUENTIEL ET PARALLELE</span>
<span class="comment">// CE QUI PERMET D UTILISER UNE MATRICE BLOC QUAND ON APPELLE LE SOLVEUR NP</span>
      solv.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmem, solution);

      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> som=0; som&lt;nb_som; som++)
        vit_som(som)=solution(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som));
    }
  <span class="keywordflow">else</span>
    {
      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
        {
          <span class="keywordtype">int</span> som;
          <span class="keywordflow">for</span>(som=0; som&lt;nb_som; som++)
            {
              solution(som)=vit_som(som,k);
              secmemk(som)=secmem(som,k);
            }

          solution.echange_espace_virtuel();
          secmemk.echange_espace_virtuel();

<span class="comment">// ON UTILISE LA MEME MATRICE EN SEQUENTIEL ET PARALLELE</span>
<span class="comment">// CE QUI PERMET D UTILISER UNE MATRICE BLOC QUAND ON APPELLE LE SOLVEUR NP</span>
          solv.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmemk, solution);

          <span class="keywordflow">for</span>(som=0; som&lt;nb_som; som++)
            vit_som(som,k)=solution(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som));
        }
    }

<span class="comment">// Debog::verifier(&quot; verif vit_som 0 &quot; , vit_som);</span>
  vit_som.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<span class="comment">// Debog::verifier(&quot; verif vit_som 1 &quot; , vit_som);</span>

<span class="comment">// {</span>
<span class="comment">// for(int k=0; k&lt;nb_comp; k++)</span>
<span class="comment">// for(int som=0; som&lt;nb_som; som++)</span>
<span class="comment">// Cerr &lt;&lt; k &lt;&lt; &quot; x &quot; &lt;&lt; coord(som,0)&lt;&lt; &quot; y &quot; &lt;&lt; coord(som,1) &lt;&lt; &quot; &quot; &lt;&lt; vit_som(som,k) &lt;&lt; finl;</span>
<span class="comment">// double psc=vit_som*vit_som;</span>
<span class="comment">// psc = Process::mp_sum(psc);</span>
<span class="comment">// Debog::verifier(&quot;norme : &quot;, psc);</span>
<span class="comment">// Cerr &lt;&lt; &quot;############ psc = &quot; &lt;&lt; psc &lt;&lt; finl;</span>
<span class="comment">// }</span>
  <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot; verif vit_som &quot;</span> , vit_som);
  <span class="keywordflow">return</span> vit_som;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab7ad21127b0f33f5259d56c929b2baea"></a><!-- doxytag: member="Champ_P1NC_implementation::valeur_P1_L2_H1" ref="ab7ad21127b0f33f5259d56c929b2baea" args="(Champ_P1NC &amp;, const Domaine &amp;, DoubleTab &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a>&amp; valeur_P1_L2_H1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classChamp__P1NC.html">Champ_P1NC</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a87a50a3c8cceb34eef5114e0358bedf5"></a><!-- doxytag: member="Champ_P1NC_implementation::ch_som_" ref="a87a50a3c8cceb34eef5114e0358bedf5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> <a class="el" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">Champ_P1NC_implementation::ch_som_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00161">161</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC_8cpp_source.html#l00079">Champ_P1NC::abortTimeStep()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00104">ch_som()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00945">filtrer_L2()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01928">fixer_nb_valeurs_nodales()</a>.</p>

</div>
</div>
<a class="anchor" id="a0d930998a5c25e3e6ff01bec5bd561ca"></a><!-- doxytag: member="Champ_P1NC_implementation::ch_som_vect_" ref="a0d930998a5c25e3e6ff01bec5bd561ca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a> <a class="el" href="classChamp__P1NC__implementation.html#a0d930998a5c25e3e6ff01bec5bd561ca">Champ_P1NC_implementation::ch_som_vect_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00162">162</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00108">ch_som_vect()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01928">fixer_nb_valeurs_nodales()</a>.</p>

</div>
</div>
<a class="anchor" id="a4437c8f910d3e626accf68eeb590ab15"></a><!-- doxytag: member="Champ_P1NC_implementation::filtrer_L2_deja_appele_" ref="a4437c8f910d3e626accf68eeb590ab15" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classChamp__P1NC__implementation.html#a4437c8f910d3e626accf68eeb590ab15">Champ_P1NC_implementation::filtrer_L2_deja_appele_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00163">163</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00049">Champ_P1NC_implementation()</a>, <a class="el" href="Champ__P1NC_8cpp_source.html#l00073">Champ_P1NC::mettre_a_jour()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01556">valeur_aux_elems_compo_smooth()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01490">valeur_aux_elems_smooth()</a>.</p>

</div>
</div>
<a class="anchor" id="aaa41328eec002384f541c9de9a4891b2"></a><!-- doxytag: member="Champ_P1NC_implementation::MatP1NC2P1_H1" ref="aaa41328eec002384f541c9de9a4891b2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a> <a class="el" href="classChamp__P1NC__implementation.html#aaa41328eec002384f541c9de9a4891b2">Champ_P1NC_implementation::MatP1NC2P1_H1</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00151">151</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00193">get_MatP1NC2P1_H1()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00716">valeur_P1_H1()</a>.</p>

</div>
</div>
<a class="anchor" id="a0c4ec557a2e6a41888f850f5b9859bd5"></a><!-- doxytag: member="Champ_P1NC_implementation::MatP1NC2P1_L2" ref="a0c4ec557a2e6a41888f850f5b9859bd5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a> <a class="el" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">Champ_P1NC_implementation::MatP1NC2P1_L2</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00146">146</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01124">filtrer_resu()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00188">get_MatP1NC2P1_L2()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">valeur_P1_L2()</a>.</p>

</div>
</div>
<a class="anchor" id="a4fe02ee20bb5dbe82a86d1949950f296"></a><!-- doxytag: member="Champ_P1NC_implementation::MatP1NC2P1_L2_H1" ref="a4fe02ee20bb5dbe82a86d1949950f296" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a> <a class="el" href="classChamp__P1NC__implementation.html#a4fe02ee20bb5dbe82a86d1949950f296">Champ_P1NC_implementation::MatP1NC2P1_L2_H1</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00175">175</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00198">get_MatP1NC2P1_L2_H1()</a>.</p>

</div>
</div>
<a class="anchor" id="ac14f52f8e8882ef0609846e613e73a07"></a><!-- doxytag: member="Champ_P1NC_implementation::MatP1NC2P1_L2_Parallele" ref="ac14f52f8e8882ef0609846e613e73a07" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice.html">Matrice</a> <a class="el" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">Champ_P1NC_implementation::MatP1NC2P1_L2_Parallele</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00148">148</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01124">filtrer_resu()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">valeur_P1_L2()</a>.</p>

</div>
</div>
<a class="anchor" id="ab63e935fdf162acb323dcfa263b88282"></a><!-- doxytag: member="Champ_P1NC_implementation::solveur_H1" ref="ab63e935fdf162acb323dcfa263b88282" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSolveurSys.html">SolveurSys</a> <a class="el" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">Champ_P1NC_implementation::solveur_H1</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00152">152</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00049">Champ_P1NC_implementation()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00208">get_solveur_H1()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00716">valeur_P1_H1()</a>.</p>

</div>
</div>
<a class="anchor" id="aadbead528fba47cbd045b66c715f81da"></a><!-- doxytag: member="Champ_P1NC_implementation::solveur_L2" ref="aadbead528fba47cbd045b66c715f81da" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSolveurSys.html">SolveurSys</a> <a class="el" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">Champ_P1NC_implementation::solveur_L2</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00150">150</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00049">Champ_P1NC_implementation()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01124">filtrer_resu()</a>, <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00203">get_solveur_L2()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">valeur_P1_L2()</a>.</p>

</div>
</div>
<a class="anchor" id="a6400585e0d5d961530bdf72b58e07d65"></a><!-- doxytag: member="Champ_P1NC_implementation::solveur_L2_H1" ref="a6400585e0d5d961530bdf72b58e07d65" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSolveurSys.html">SolveurSys</a> <a class="el" href="classChamp__P1NC__implementation.html#a6400585e0d5d961530bdf72b58e07d65">Champ_P1NC_implementation::solveur_L2_H1</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00176">176</a> of file <a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1NC__implementation_8h_source.html#l00213">get_solveur_L2_H1()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/VEF/Champs/<a class="el" href="Champ__P1NC__implementation_8h_source.html">Champ_P1NC_implementation.h</a></li>
<li>src/VEF/Champs/<a class="el" href="Champ__P1NC__implementation_8cpp_source.html">Champ_P1NC_implementation.cpp</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:36:23 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
