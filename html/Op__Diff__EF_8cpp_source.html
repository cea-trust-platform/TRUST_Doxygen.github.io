<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/EF/Operateurs/Op_Diff_EF.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/EF/Operateurs/Op_Diff_EF.cpp</div>  </div>
</div>
<div class="contents">
<a href="Op__Diff__EF_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Op_Diff_EF.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/EF/Operateurs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     1</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 <span class="comment">// </span>
<a name="l00023"></a>00023 <span class="comment">// WARNING: DO NOT EDIT THIS FILE! Only edit the template file Op_Diff_EF.cpp.P</span>
<a name="l00024"></a>00024 <span class="comment">// </span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="comment">// static int transpose_=1;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Op__Diff__EF_8h.html">Op_Diff_EF.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Zone__EF_8h.html">Zone_EF.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__EF_8h.html">Zone_Cl_EF.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Uniforme_8h.html">Champ_Uniforme.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Milieu__base_8h.html">Milieu_base.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="DoubleTrav_8h.html">DoubleTrav.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="Neumann__paroi_8h.html">Neumann_paroi.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="Neumann__sortie__libre_8h.html">Neumann_sortie_libre.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="Echange__global__impose_8h.html">Echange_global_impose.h</a>&gt;</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="Param_8h.html">Param.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="Op__Conv__EF_8h.html">Op_Conv_EF.h</a>&gt;</span>
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="Op__Diff__EF_8cpp.html#ab4751d5361c9fd2f006b4ab298a1a797">00042</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classOp__Diff__EF.html" title="class Op_Diff_EF Cette classe represente l&#39;operateur de diffusion La discretisation est EF Le champ d...">Op_Diff_EF</a>,<span class="stringliteral">&quot;Op_Diff_EF&quot;</span>,<a class="code" href="classOp__Diff__EF__base.html" title="class Op_Diff_EF_base Classe de base des operateurs de convection EF">Op_Diff_EF_base</a>);
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="classOp__Diff__EF.html#adc266f3df17c7ba96a4b4f5058bfe2dd">00044</a> <a class="code" href="classOp__Diff__EF.html#adc266f3df17c7ba96a4b4f5058bfe2dd">Op_Diff_EF::Op_Diff_EF</a>():transpose_(1),transpose_partout_(0),nouvelle_expression_(0)
<a name="l00045"></a>00045 {
<a name="l00046"></a>00046 }<span class="comment"></span>
<a name="l00047"></a>00047 <span class="comment">////!&lt; printOn </span>
<a name="l00048"></a>00048 <span class="comment"></span><span class="comment">//</span>
<a name="l00049"></a><a class="code" href="classOp__Diff__EF.html#a081bae2c65420472d0213149e9e01676">00049</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classOp__Diff__EF.html#a081bae2c65420472d0213149e9e01676" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Diff_EF::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00050"></a>00050 <span class="keyword"></span>{
<a name="l00051"></a>00051   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() ;
<a name="l00052"></a>00052 }
<a name="l00053"></a>00053 <span class="comment"></span>
<a name="l00054"></a>00054 <span class="comment">////!&lt; readOn </span>
<a name="l00055"></a>00055 <span class="comment"></span><span class="comment">//</span>
<a name="l00056"></a>00056 
<a name="l00057"></a><a class="code" href="classOp__Diff__EF.html#af1762eafb5f5fde4eac4e007cfc84cea">00057</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classOp__Diff__EF.html#af1762eafb5f5fde4eac4e007cfc84cea" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Diff_EF::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s )
<a name="l00058"></a>00058 {
<a name="l00059"></a>00059   <span class="keywordflow">return</span> s ;
<a name="l00060"></a>00060 }
<a name="l00061"></a><a class="code" href="Op__Diff__EF_8cpp.html#a951d839c2e72b3b97000ecb02a627f42">00061</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classOp__Diff__option__EF.html">Op_Diff_option_EF</a>,<span class="stringliteral">&quot;Op_Diff_option_EF&quot;</span>,<a class="code" href="classOp__Diff__EF.html" title="class Op_Diff_EF Cette classe represente l&#39;operateur de diffusion La discretisation est EF Le champ d...">Op_Diff_EF</a>);
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="comment"></span>
<a name="l00064"></a>00064 <span class="comment">////!&lt; printOn </span>
<a name="l00065"></a>00065 <span class="comment"></span><span class="comment">//</span>
<a name="l00066"></a>00066 
<a name="l00067"></a><a class="code" href="classOp__Diff__option__EF.html#ae2afbb2000a5d8dc7a8e27435c31bae0">00067</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classOp__Diff__option__EF.html#ae2afbb2000a5d8dc7a8e27435c31bae0" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Diff_option_EF::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00068"></a>00068 <span class="keyword"></span>{
<a name="l00069"></a>00069   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()  ;
<a name="l00070"></a>00070 }
<a name="l00071"></a>00071 <span class="comment"></span>
<a name="l00072"></a>00072 <span class="comment">////!&lt; readOn </span>
<a name="l00073"></a>00073 <span class="comment"></span><span class="comment">//</span>
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="classOp__Diff__option__EF.html#a4551d750ac94624c7351fede9c444db4">00075</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classOp__Diff__option__EF.html#a4551d750ac94624c7351fede9c444db4" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Diff_option_EF::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s )
<a name="l00076"></a>00076 {
<a name="l00077"></a>00077   <a class="code" href="classParam.html" title="Defined below in this file.">Param</a> param(<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>());
<a name="l00078"></a>00078   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;grad_u_transpose&quot;</span>, &amp;<a class="code" href="classOp__Diff__EF.html#a7ddc8b767fdf7438b3dafd53ee4a5547" title="vaurt zero si on ne veut pas calculer grad u transpose">transpose_</a> );
<a name="l00079"></a>00079   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;grad_u_transpose_partout&quot;</span>, &amp;<a class="code" href="classOp__Diff__EF.html#aac0d06305db461f32f48d4c0738adcef" title="vaut 1 si on veut calculer grad_u_transpose meme au bord">transpose_partout_</a> );
<a name="l00080"></a>00080   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;nouvelle_expression&quot;</span>,&amp;<a class="code" href="classOp__Diff__EF.html#a67a011bbbd2ad3798f1241f0c2d95ed6">nouvelle_expression_</a>);
<a name="l00081"></a>00081   param.<a class="code" href="classParam.html#a6363f31c467c06512aee2f004abac69d">ajouter_condition</a>(<span class="stringliteral">&quot;(value_of_grad_u_transpose_EQ_0)_OR_(value_of_grad_u_transpose_EQ_1)&quot;</span>,<span class="stringliteral">&quot; grad_u_transpose doit valoir 0 ou 1 &quot;</span>);
<a name="l00082"></a>00082   param.<a class="code" href="classParam.html#a6363f31c467c06512aee2f004abac69d">ajouter_condition</a>(<span class="stringliteral">&quot;(value_of_grad_u_transpose_partout_EQ_0)_OR_(value_of_grad_u_transpose_partout_EQ_1)&quot;</span>,<span class="stringliteral">&quot; grad_u_transpose_partout doit valoir 0 ou 1 &quot;</span>);
<a name="l00083"></a>00083   param.<a class="code" href="classParam.html#a6363f31c467c06512aee2f004abac69d">ajouter_condition</a>(<span class="stringliteral">&quot;(value_of_grad_u_transpose_partout_EQ_0)_OR_((value_of_grad_u_transpose_partout_EQ_1)_AND_(value_of_grad_u_transpose_EQ_1))&quot;</span>,<span class="stringliteral">&quot; si grad_u_transpose_partout vaut 1 alors grad_u_transpose doit valoir 1&quot;</span>);
<a name="l00084"></a>00084   param.<a class="code" href="classParam.html#aa9d44fc51b4a08b357733a97dc7acaad" title="Read the is input with the parameters (defined with the Param object) inside: { ... } Example, to read: { a 1 b 2 } Param param(que_suis_je()); int a,b; param.ajouter(&quot;a&quot;,&amp;a); param.ajouter(&quot;b&quot;,&amp;b); param.lire_avec_accolades_depuis(is);.">lire_avec_accolades_depuis</a>(s);
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 
<a name="l00087"></a>00087   <span class="keywordflow">return</span> s ;
<a name="l00088"></a>00088 }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 
<a name="l00091"></a><a class="code" href="Op__Diff__EF_8cpp.html#a1bfeb5e8695ea0d9ae2b7b1df9a522fd">00091</a> <span class="keywordtype">void</span> <a class="code" href="Op__Diff__EF_8cpp.html#a1bfeb5e8695ea0d9ae2b7b1df9a522fd">remplir_marqueur_sommet_neumann</a>(<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; marqueur,<span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF,<span class="keyword">const</span> <a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>&amp; zone_Cl_EF , <span class="keywordtype">int</span> transpose_partout)
<a name="l00092"></a>00092 {
<a name="l00093"></a>00093   marqueur.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(zone_EF.<a class="code" href="classZone__dis__base.html#a8f793341b7a41d67561ba563ae0f69a0">nb_som_tot</a>());
<a name="l00094"></a>00094   <span class="keywordflow">if</span> ( transpose_partout) <span class="keywordflow">return</span>;
<a name="l00095"></a>00095 <span class="comment">// Neumann :</span>
<a name="l00096"></a>00096   <span class="keywordtype">int</span> n_bord;
<a name="l00097"></a>00097   <span class="keywordtype">int</span> nb_bords=zone_EF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>();
<a name="l00098"></a>00098   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_EF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l00099"></a>00099   <span class="keywordtype">int</span> nb_som_face=zone_EF.<a class="code" href="classZone__VF.html#a990808f967f351edbb83ff11d60b7445" title="renvoie le nombre de sommets par face. Rque : on a suppose que toutes les faces avait le meme nombre ...">nb_som_face</a>();
<a name="l00100"></a>00100   <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;nb_bords; n_bord++)
<a name="l00101"></a>00101     {
<a name="l00102"></a>00102       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_EF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00103"></a>00103 
<a name="l00104"></a>00104       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00105"></a>00105         {
<a name="l00106"></a>00106           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00107"></a>00107           <span class="keywordtype">int</span> nfin =le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00108"></a>00108           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face&lt;nfin; ind_face++)
<a name="l00109"></a>00109             {
<a name="l00110"></a>00110               <span class="keywordtype">int</span> face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00111"></a>00111               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_face; i1++)
<a name="l00112"></a>00112                 {
<a name="l00113"></a>00113                   <span class="keywordtype">int</span> glob2=face_sommets(face,i1);
<a name="l00114"></a>00114                   marqueur(glob2)=1;
<a name="l00115"></a>00115 
<a name="l00116"></a>00116                 }
<a name="l00117"></a>00117             }
<a name="l00118"></a>00118         }
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120 }
<a name="l00121"></a>00121 <span class="comment">/*</span>
<a name="l00122"></a>00122 <span class="comment">void Op_Diff_EF::associer(const Zone_dis&amp; zone_dis,</span>
<a name="l00123"></a>00123 <span class="comment">                                const Zone_Cl_dis&amp; zone_cl_dis,</span>
<a name="l00124"></a>00124 <span class="comment">                                const Champ_Inc&amp; ch_transporte)</span>
<a name="l00125"></a>00125 <span class="comment">{</span>
<a name="l00126"></a>00126 <span class="comment">  const Zone_EF&amp; zEF = ref_cast(Zone_EF,zone_dis.valeur());</span>
<a name="l00127"></a>00127 <span class="comment">  const Zone_Cl_EF&amp; zclEF = ref_cast(Zone_Cl_EF,zone_cl_dis.valeur());</span>
<a name="l00128"></a>00128 <span class="comment">  if (sub_type(Champ_P1_EF,ch_transporte.valeur()))</span>
<a name="l00129"></a>00129 <span class="comment">    {</span>
<a name="l00130"></a>00130 <span class="comment">      const Champ_P1_EF&amp; inco = ref_cast(Champ_P1_EF,ch_transporte.valeur());</span>
<a name="l00131"></a>00131 <span class="comment">      REF(Champ_P1_EF) inconnue;</span>
<a name="l00132"></a>00132 <span class="comment">      inconnue = inco;</span>
<a name="l00133"></a>00133 <span class="comment">    }</span>
<a name="l00134"></a>00134 <span class="comment">  if (sub_type(Champ_Q1_EF,ch_transporte.valeur()))</span>
<a name="l00135"></a>00135 <span class="comment">    {</span>
<a name="l00136"></a>00136 <span class="comment">      const Champ_Q1_EF&amp; inco = ref_cast(Champ_Q1_EF,ch_transporte.valeur());</span>
<a name="l00137"></a>00137 <span class="comment">      REF(Champ_Q1_EF) inconnue;</span>
<a name="l00138"></a>00138 <span class="comment">      inconnue = inco;</span>
<a name="l00139"></a>00139 <span class="comment">    }</span>
<a name="l00140"></a>00140 <span class="comment">  la_zone_EF = zEF;</span>
<a name="l00141"></a>00141 <span class="comment">  la_zcl_EF = zclEF;</span>
<a name="l00142"></a>00142 <span class="comment"></span>
<a name="l00143"></a>00143 <span class="comment">  // Dimensionnement dans le cas ou l&#39;operateur est traite de facon implicite</span>
<a name="l00144"></a>00144 <span class="comment">  // On dimensionne et initialise le tableau des bilans de flux:</span>
<a name="l00145"></a>00145 <span class="comment">  const Zone_EF&amp; zone_EF = la_zone_EF.valeur();</span>
<a name="l00146"></a>00146 <span class="comment"></span>
<a name="l00147"></a>00147 <span class="comment">  int N = 1;</span>
<a name="l00148"></a>00148 <span class="comment"></span>
<a name="l00149"></a>00149 <span class="comment">  (ref_cast(DoubleTab,flux_bords)).resize(zone_EF.nb_faces_bord(),N);</span>
<a name="l00150"></a>00150 <span class="comment">  flux_bords=0.;</span>
<a name="l00151"></a>00151 <span class="comment">}</span><span class="comment"></span>
<a name="l00152"></a>00152 <span class="comment">////!&lt; associer </span>
<a name="l00153"></a>00153 <span class="comment"></span>//
<a name="l00154"></a>00154 */
<a name="l00155"></a>00155 <span class="comment">//</span><span class="comment"></span>
<a name="l00156"></a>00156 <span class="comment">//! associe le champ de diffusivite</span>
<a name="l00157"></a><a class="code" href="classOp__Diff__EF.html#a82f435a97ce02352559568cbf95b53a9">00157</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classOp__Diff__EF.html#a82f435a97ce02352559568cbf95b53a9" title="associe le champ de diffusivite">Op_Diff_EF::associer_diffusivite</a>(<span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; diffu)
<a name="l00158"></a>00158 {
<a name="l00159"></a>00159   <a class="code" href="classOp__Diff__EF.html#a8a2320756ff9657f196544188d03e1eb">diffusivite_</a> = diffu;
<a name="l00160"></a>00160 }
<a name="l00161"></a>00161 
<a name="l00162"></a><a class="code" href="classOp__Diff__EF.html#a4bbb9b2f07a24a6779e5eb098a7edcf6">00162</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__EF.html#a4bbb9b2f07a24a6779e5eb098a7edcf6" title="Associe l&#39;operateur a la zone_dis, la zone_Cl_dis, et a l&#39;inconnue de son equation.">Op_Diff_EF::completer</a>()
<a name="l00163"></a>00163 {
<a name="l00164"></a>00164   <a class="code" href="classOp__Diff__EF.html#a4bbb9b2f07a24a6779e5eb098a7edcf6" title="Associe l&#39;operateur a la zone_dis, la zone_Cl_dis, et a l&#39;inconnue de son equation.">Operateur_base::completer</a>();
<a name="l00165"></a>00165   <a class="code" href="classOp__EF__base.html#a080c1044520da3366eb94ec3a92eb9da">marque_elem</a>(<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>());
<a name="l00166"></a>00166 }
<a name="l00167"></a><a class="code" href="classOp__Diff__EF.html#a082a2bb13cf1bb0de7b465f622b0b106">00167</a> <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; <a class="code" href="classOp__Diff__EF.html#a082a2bb13cf1bb0de7b465f622b0b106">Op_Diff_EF::diffusivite</a>()<span class="keyword"> const</span>
<a name="l00168"></a>00168 <span class="keyword"></span>{
<a name="l00169"></a>00169   <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__EF.html#a8a2320756ff9657f196544188d03e1eb">diffusivite_</a>;
<a name="l00170"></a>00170 }
<a name="l00171"></a>00171 
<a name="l00172"></a><a class="code" href="classOp__Diff__EF.html#a279310b0c244df90a22d8ff89bb3d29f">00172</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__EF.html#a279310b0c244df90a22d8ff89bb3d29f">Op_Diff_EF::remplir_nu</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; nu)<span class="keyword"> const</span>
<a name="l00173"></a>00173 <span class="keyword"></span>{
<a name="l00174"></a>00174   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classOp__Diff__EF__base.html#ac664238d74a546d15e8d7c26551be784">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00175"></a>00175 <span class="comment">// On dimensionne nu</span>
<a name="l00176"></a>00176   <span class="keywordflow">if</span> (nu.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>()==0)
<a name="l00177"></a>00177     zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(nu);
<a name="l00178"></a>00178   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; diffu=<a class="code" href="classOp__Diff__EF.html#a082a2bb13cf1bb0de7b465f622b0b106">diffusivite</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l00179"></a>00179   <span class="keywordflow">if</span> (diffu.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>()==1)
<a name="l00180"></a>00180     nu = diffu(0,0);
<a name="l00181"></a>00181   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (diffu.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>()==1)
<a name="l00182"></a>00182     nu = diffu;
<a name="l00183"></a>00183   <span class="keywordflow">else</span>
<a name="l00184"></a>00184     {
<a name="l00185"></a>00185       assert(diffu.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1)==1);
<a name="l00186"></a>00186       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;diffu.<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>(); i++) nu(i)=diffu(i,0);
<a name="l00187"></a>00187     }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 <span class="comment">// nu.echange_espace_virtuel();</span>
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 
<a name="l00193"></a><a class="code" href="classOp__Diff__EF.html#a59fa0c441a04910006a52e72eae1b352">00193</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__EF.html#a59fa0c441a04910006a52e72eae1b352">Op_Diff_EF::ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_inconnue, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00194"></a>00194 <span class="keyword"></span>{
<a name="l00195"></a>00195   <span class="keywordflow">if</span> ((<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().nombre_d_operateurs()&gt;1)&amp;&amp;<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classOp__Conv__EF.html" title="class Op_Conv_EF Cette classe represente l&#39;operateur de convection associe a une equation de transpor...">Op_Conv_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(1).l_op_base()))
<a name="l00196"></a>00196     <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOp__Conv__EF.html" title="class Op_Conv_EF Cette classe represente l&#39;operateur de convection associe a une equation de transpor...">Op_Conv_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(1).l_op_base()).ajouter_a_la_diffusion(tab_inconnue,resu);
<a name="l00197"></a>00197 <span class="comment">// ref_cast(Op_Conv_EF,equation().operateur(1).l_op_base()).ajouter_sous_cond(tab_inconnue,resu,0,0,1);</span>
<a name="l00198"></a>00198   <span class="keywordflow">if</span> (<a class="code" href="classOp__Diff__EF.html#a67a011bbbd2ad3798f1241f0c2d95ed6">nouvelle_expression_</a>==1)
<a name="l00199"></a>00199     <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__EF.html#ac77a4ff27852f9503057460327ed7183">ajouter_new</a>(tab_inconnue,resu);
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 
<a name="l00203"></a>00203   <a class="code" href="classOp__Diff__EF.html#a279310b0c244df90a22d8ff89bb3d29f">remplir_nu</a>(<a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>);
<a name="l00204"></a>00204 <span class="comment">// const Zone_Cl_EF&amp; zone_Cl_EF = la_zcl_EF.valeur();</span>
<a name="l00205"></a>00205   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef = <a class="code" href="classOp__Diff__EF__base.html#ac664238d74a546d15e8d7c26551be784">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00206"></a>00206   <span class="keywordtype">int</span> nb_som_elem=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00207"></a>00207 
<a name="l00208"></a>00208   <span class="keywordtype">int</span> N = resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00209"></a>00209   <a class="code" href="Field__base_8h.html#a1b86c8f670a9b34da7f628a821fb646b" title="This is a base class from which inherit Champ_base and Champ_front_base. It handles all the generic a...">Nature_du_champ</a> nat= <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>().<a class="code" href="classField__base.html#a75bf4e0a6258589a83801c0383d049cc" title="Renvoie la nature d&#39;un champ (scalaire, multiscalaire, vectoriel).">nature_du_champ</a>();
<a name="l00210"></a>00210   <span class="keywordflow">if</span> (nat==<a class="code" href="Field__base_8h.html#a1b86c8f670a9b34da7f628a821fb646ba66d795f4e2fbb5636a3966c73964c5e7">vectoriel</a>)
<a name="l00211"></a>00211     {
<a name="l00212"></a>00212       <span class="keywordflow">if</span> ((<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)&amp;&amp;(nb_som_elem==8))
<a name="l00213"></a>00213         <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__EF.html#acf3e0fa6e9beaf2add946e5b711c86ea">ajouter_vectoriel_dim3_nbn_8</a>(tab_inconnue,resu);
<a name="l00214"></a>00214       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==2)&amp;&amp;(nb_som_elem==4))
<a name="l00215"></a>00215         {
<a name="l00216"></a>00216           <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__EF.html#a826ac42f96d97c1d58a7bd0e73ead654">ajouter_vectoriel_dim2_nbn_4</a>(tab_inconnue,resu);
<a name="l00217"></a>00217         }
<a name="l00218"></a>00218       <span class="keywordflow">else</span>
<a name="l00219"></a>00219         {
<a name="l00220"></a>00220           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;__FILE__&lt;&lt;(int)__LINE__&lt;&lt; <span class="stringliteral">&quot;cas non optimise &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00221"></a>00221           <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__EF.html#af659927b2f084c91757f109ca70551e0">ajouter_vectoriel_gen</a>(tab_inconnue,resu);
<a name="l00222"></a>00222         }
<a name="l00223"></a>00223     }
<a name="l00224"></a>00224   <span class="keywordflow">else</span>
<a name="l00225"></a>00225     {
<a name="l00226"></a>00226       <span class="keywordflow">if</span> (N != 1)
<a name="l00227"></a>00227         {
<a name="l00228"></a>00228           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;__FILE__&lt;&lt;(int)__LINE__&lt;&lt; <span class="stringliteral">&quot;cas non prevu &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00229"></a>00229           assert(0);
<a name="l00230"></a>00230           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00231"></a>00231           <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__EF.html#a59fa0c441a04910006a52e72eae1b352">ajouter</a>(tab_inconnue,resu);
<a name="l00232"></a>00232         }
<a name="l00233"></a>00233       <span class="keywordflow">if</span> ((<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)&amp;&amp;(nb_som_elem==8))
<a name="l00234"></a>00234         <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__EF.html#af6dc758a3a8f272428f0be02e097947d">ajouter_scalaire_dim3_nbn_8</a>(tab_inconnue,resu);
<a name="l00235"></a>00235       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==2)&amp;&amp;(nb_som_elem==4))
<a name="l00236"></a>00236         {
<a name="l00237"></a>00237           <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__EF.html#a9f87a2ebf17ff9d55b3745636694ece2">ajouter_scalaire_dim2_nbn_4</a>(tab_inconnue,resu);
<a name="l00238"></a>00238         }
<a name="l00239"></a>00239       <span class="keywordflow">else</span>
<a name="l00240"></a>00240         {
<a name="l00241"></a>00241           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;__FILE__&lt;&lt;(int)__LINE__&lt;&lt; <span class="stringliteral">&quot;cas non optimise &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00242"></a>00242           <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__EF.html#a52cd3f93057f7d425c8a75aa6927c8e0">ajouter_scalaire_gen</a>(tab_inconnue,resu);
<a name="l00243"></a>00243         }
<a name="l00244"></a>00244 
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246 <span class="comment">// </span>
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 <span class="comment">// macro declare_ajouter(dimension,N,nature,nb_som_elem,dim_fois_nbn)</span>
<a name="l00251"></a>00251 
<a name="l00252"></a>00252 
<a name="l00253"></a><a class="code" href="classOp__Diff__EF.html#acf3e0fa6e9beaf2add946e5b711c86ea">00253</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__EF.html#acf3e0fa6e9beaf2add946e5b711c86ea">Op_Diff_EF::ajouter_vectoriel_dim3_nbn_8</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_inconnue, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00254"></a>00254 <span class="keyword"></span>{
<a name="l00255"></a>00255   <span class="keyword">const</span> <span class="keywordtype">int</span> N =3;
<a name="l00256"></a>00256   <span class="keyword">const</span> <span class="keywordtype">int</span> dim_fois_nbn= 24;
<a name="l00257"></a>00257   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_elem= 8;
<a name="l00258"></a>00258   <span class="keyword">const</span> <span class="keywordtype">int</span> const_dimension= 3;
<a name="l00259"></a>00259   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00260"></a>00260   assert(nb_som_elem*const_dimension==dim_fois_nbn);
<a name="l00261"></a>00261 
<a name="l00262"></a>00262   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> marqueur_neuman;
<a name="l00263"></a>00263   <a class="code" href="Op__Diff__EF_8cpp.html#a1bfeb5e8695ea0d9ae2b7b1df9a522fd">remplir_marqueur_sommet_neumann</a>( marqueur_neuman,zone_ef,<a class="code" href="classOp__Diff__EF__base.html#a7b2c331807120f651f22dc0f22fc51b9">la_zcl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>(),<a class="code" href="classOp__Diff__EF.html#aac0d06305db461f32f48d4c0738adcef" title="vaut 1 si on veut calculer grad_u_transpose meme au bord">transpose_partout_</a> );
<a name="l00264"></a>00264 
<a name="l00265"></a>00265   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00266"></a>00266   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00267"></a>00267 
<a name="l00268"></a>00268   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00269"></a>00269   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00270"></a>00270 <span class="comment">// </span>
<a name="l00271"></a>00271   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00272"></a>00272 
<a name="l00273"></a>00273 <span class="preprocessor">#if 1</span>
<a name="l00274"></a>00274 <span class="preprocessor"></span>  <span class="keyword">const</span> <span class="keywordtype">double</span>* bij_ptr=bij.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00275"></a>00275   <span class="keyword">const</span> <span class="keywordtype">double</span>* inco_ptr=tab_inconnue.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00276"></a>00276   <span class="keywordtype">double</span>* resu_ptr=resu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00277"></a>00277 <span class="preprocessor">#define bij_(elem,i,j) bij_ptr[elem*dim_fois_nbn+i*const_dimension+j]</span>
<a name="l00278"></a>00278 <span class="preprocessor"></span><span class="preprocessor">#define inconnue_(som,a) inco_ptr[som * N + a]</span>
<a name="l00279"></a>00279 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu_ptr[som * N + a]</span>
<a name="l00280"></a>00280 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00281"></a>00281 <span class="preprocessor"></span><span class="preprocessor">#define bij_(elem,i,j) bij(elem,i,j)</span>
<a name="l00282"></a>00282 <span class="preprocessor"></span><span class="preprocessor">#define inconnue_(som,a) inconnue(som,a)</span>
<a name="l00283"></a>00283 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu(som,a)</span>
<a name="l00284"></a>00284 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00285"></a>00285 <span class="preprocessor"></span>  {
<a name="l00286"></a>00286     <span class="keywordtype">double</span> pr[3];
<a name="l00287"></a>00287     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00288"></a>00288       <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00289"></a>00289         {
<a name="l00290"></a>00290           <span class="keywordtype">double</span> pond=volumes_thilde(elem)/volumes(elem)/volumes(elem)*<a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>(elem);
<a name="l00291"></a>00291 
<a name="l00292"></a>00292 
<a name="l00293"></a>00293           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00294"></a>00294             {
<a name="l00295"></a>00295               <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00296"></a>00296               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;N; yy++) pr[yy]=0;
<a name="l00297"></a>00297               <span class="keywordtype">int</span> transpose = (marqueur_neuman(glob) == 1 || N == 1) ? 0 : <a class="code" href="classOp__Diff__EF.html#a7ddc8b767fdf7438b3dafd53ee4a5547" title="vaurt zero si on ne veut pas calculer grad u transpose">transpose_</a>;
<a name="l00298"></a>00298               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00299"></a>00299                 {
<a name="l00300"></a>00300                   <span class="keywordtype">int</span> glob2=elems(elem,i2);
<a name="l00301"></a>00301 
<a name="l00302"></a>00302                   {
<a name="l00303"></a>00303                     <span class="keywordtype">double</span> <a class="code" href="Zone__CoviMAC_8h.html#aa24d8c7ee8fd93e2360821d3636ec69d">prod</a>=0;
<a name="l00304"></a>00304                     <span class="keywordtype">double</span> prod2=0;
<a name="l00305"></a>00305                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00306"></a>00306                       {
<a name="l00307"></a>00307                         prod+=<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b)*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i2,b);
<a name="l00308"></a>00308                         <span class="keywordflow">if</span> (transpose)
<a name="l00309"></a>00309                           prod2+=<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b)*<a class="code" href="Op__Diff__EF_8cpp.html#acd26084b8f7f8ecd3b6bbe889312465f">inconnue_</a>(glob2,b);
<a name="l00310"></a>00310                       }
<a name="l00311"></a>00311                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l00312"></a>00312                       pr[n] += prod*<a class="code" href="Op__Diff__EF_8cpp.html#acd26084b8f7f8ecd3b6bbe889312465f">inconnue_</a>(glob2, n)+prod2*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem, i2, n);
<a name="l00313"></a>00313                   }
<a name="l00314"></a>00314                 }
<a name="l00315"></a>00315               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l00316"></a>00316                 <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(glob, n) -= pr[n] * pond;
<a name="l00317"></a>00317 
<a name="l00318"></a>00318             }
<a name="l00319"></a>00319         }
<a name="l00320"></a>00320   }
<a name="l00321"></a>00321 
<a name="l00322"></a>00322 <span class="comment">// Debog::verifier(&quot; Op_Diff_EF::ajouter, resu 0 &quot;,resu);</span>
<a name="l00323"></a>00323 <span class="comment">// Journal()&lt;&lt;max(resu)&lt;&lt;&quot; &quot;&lt;&lt;min(resu)&lt;&lt;finl;</span>
<a name="l00324"></a>00324 
<a name="l00325"></a>00325 
<a name="l00326"></a>00326 <span class="comment">// on ajoute la contribution des bords</span>
<a name="l00327"></a>00327   <a class="code" href="classOp__Diff__EF.html#a2523fcf4a2dfd3c44dda73b8dc334ba3">ajouter_bords</a>(tab_inconnue,resu);
<a name="l00328"></a>00328   <span class="keywordflow">return</span> resu;
<a name="l00329"></a>00329 <span class="preprocessor">#undef bij_</span>
<a name="l00330"></a>00330 <span class="preprocessor"></span><span class="preprocessor">#undef inconnue_</span>
<a name="l00331"></a>00331 <span class="preprocessor"></span><span class="preprocessor">#undef resu_</span>
<a name="l00332"></a>00332 <span class="preprocessor"></span>}
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 
<a name="l00335"></a>00335 <span class="comment">// Punset(N)</span>
<a name="l00336"></a>00336 <span class="comment">// Punset(dim_fois_nbn)</span>
<a name="l00337"></a>00337 <span class="comment">// Punset(nb_som_elem)</span>
<a name="l00338"></a>00338 
<a name="l00339"></a>00339 
<a name="l00340"></a><a class="code" href="classOp__Diff__EF.html#af6dc758a3a8f272428f0be02e097947d">00340</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__EF.html#af6dc758a3a8f272428f0be02e097947d">Op_Diff_EF::ajouter_scalaire_dim3_nbn_8</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_inconnue, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00341"></a>00341 <span class="keyword"></span>{
<a name="l00342"></a>00342   <span class="keyword">const</span> <span class="keywordtype">int</span> N =1;
<a name="l00343"></a>00343   <span class="keyword">const</span> <span class="keywordtype">int</span> dim_fois_nbn= 24;
<a name="l00344"></a>00344   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_elem= 8;
<a name="l00345"></a>00345   <span class="keyword">const</span> <span class="keywordtype">int</span> const_dimension= 3;
<a name="l00346"></a>00346   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00347"></a>00347   assert(nb_som_elem*const_dimension==dim_fois_nbn);
<a name="l00348"></a>00348 
<a name="l00349"></a>00349 
<a name="l00350"></a>00350   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00351"></a>00351   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00352"></a>00352 
<a name="l00353"></a>00353   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00354"></a>00354   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00355"></a>00355 <span class="comment">// </span>
<a name="l00356"></a>00356   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00357"></a>00357 
<a name="l00358"></a>00358 <span class="preprocessor">#if 1</span>
<a name="l00359"></a>00359 <span class="preprocessor"></span>  <span class="keyword">const</span> <span class="keywordtype">double</span>* bij_ptr=bij.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00360"></a>00360   <span class="keyword">const</span> <span class="keywordtype">double</span>* inco_ptr=tab_inconnue.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00361"></a>00361 
<a name="l00362"></a>00362 <span class="preprocessor">#define bij_(elem,i,j) bij_ptr[elem*dim_fois_nbn+i*const_dimension+j]</span>
<a name="l00363"></a>00363 <span class="preprocessor"></span><span class="preprocessor">#define inconnue_(som,a) inco_ptr[som * N + a]</span>
<a name="l00364"></a>00364 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu_ptr[som * N + a]</span>
<a name="l00365"></a>00365 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00366"></a>00366 <span class="preprocessor"></span><span class="preprocessor">#define bij_(elem,i,j) bij(elem,i,j)</span>
<a name="l00367"></a>00367 <span class="preprocessor"></span><span class="preprocessor">#define inconnue_(som,a) inconnue(som,a)</span>
<a name="l00368"></a>00368 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu(som,a)</span>
<a name="l00369"></a>00369 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00370"></a>00370 <span class="preprocessor"></span>  {
<a name="l00371"></a>00371     <span class="keywordtype">double</span> pr[1];
<a name="l00372"></a>00372     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00373"></a>00373       <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00374"></a>00374         {
<a name="l00375"></a>00375           <span class="keywordtype">double</span> pond=volumes_thilde(elem)/volumes(elem)/volumes(elem)*<a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>(elem);
<a name="l00376"></a>00376 
<a name="l00377"></a>00377 
<a name="l00378"></a>00378           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00379"></a>00379             {
<a name="l00380"></a>00380               <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00381"></a>00381               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;N; yy++) pr[yy]=0;
<a name="l00382"></a>00382               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00383"></a>00383                 {
<a name="l00384"></a>00384                   <span class="keywordtype">int</span> glob2=elems(elem,i2);
<a name="l00385"></a>00385 
<a name="l00386"></a>00386                   {
<a name="l00387"></a>00387                     <span class="keywordtype">double</span> <a class="code" href="Zone__CoviMAC_8h.html#aa24d8c7ee8fd93e2360821d3636ec69d">prod</a>=0;
<a name="l00388"></a>00388                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00389"></a>00389                       {
<a name="l00390"></a>00390                         prod+=<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b)*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i2,b);
<a name="l00391"></a>00391                       }
<a name="l00392"></a>00392                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l00393"></a>00393                       pr[n] += prod*<a class="code" href="Op__Diff__EF_8cpp.html#acd26084b8f7f8ecd3b6bbe889312465f">inconnue_</a>(glob2, n);
<a name="l00394"></a>00394                   }
<a name="l00395"></a>00395                 }
<a name="l00396"></a>00396               resu(glob)-=pr[0]*pond;
<a name="l00397"></a>00397 
<a name="l00398"></a>00398             }
<a name="l00399"></a>00399         }
<a name="l00400"></a>00400   }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 <span class="comment">// Debog::verifier(&quot; Op_Diff_EF::ajouter, resu 0 &quot;,resu);</span>
<a name="l00403"></a>00403 <span class="comment">// Journal()&lt;&lt;max(resu)&lt;&lt;&quot; &quot;&lt;&lt;min(resu)&lt;&lt;finl;</span>
<a name="l00404"></a>00404 
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 <span class="comment">// on ajoute la contribution des bords</span>
<a name="l00407"></a>00407   <a class="code" href="classOp__Diff__EF.html#a2523fcf4a2dfd3c44dda73b8dc334ba3">ajouter_bords</a>(tab_inconnue,resu);
<a name="l00408"></a>00408   <span class="keywordflow">return</span> resu;
<a name="l00409"></a>00409 <span class="preprocessor">#undef bij_</span>
<a name="l00410"></a>00410 <span class="preprocessor"></span><span class="preprocessor">#undef inconnue_</span>
<a name="l00411"></a>00411 <span class="preprocessor"></span><span class="preprocessor">#undef resu_</span>
<a name="l00412"></a>00412 <span class="preprocessor"></span>}
<a name="l00413"></a>00413 
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 <span class="comment">// Punset(N)</span>
<a name="l00416"></a>00416 <span class="comment">// Punset(dim_fois_nbn)</span>
<a name="l00417"></a>00417 <span class="comment">// Punset(nb_som_elem)</span>
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 
<a name="l00420"></a>00420 
<a name="l00421"></a><a class="code" href="classOp__Diff__EF.html#a826ac42f96d97c1d58a7bd0e73ead654">00421</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__EF.html#a826ac42f96d97c1d58a7bd0e73ead654">Op_Diff_EF::ajouter_vectoriel_dim2_nbn_4</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_inconnue, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00422"></a>00422 <span class="keyword"></span>{
<a name="l00423"></a>00423   <span class="keyword">const</span> <span class="keywordtype">int</span> N =2;
<a name="l00424"></a>00424   <span class="keyword">const</span> <span class="keywordtype">int</span> dim_fois_nbn= 8;
<a name="l00425"></a>00425   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_elem= 4;
<a name="l00426"></a>00426   <span class="keyword">const</span> <span class="keywordtype">int</span> const_dimension= 2;
<a name="l00427"></a>00427   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00428"></a>00428   assert(nb_som_elem*const_dimension==dim_fois_nbn);
<a name="l00429"></a>00429 
<a name="l00430"></a>00430   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> marqueur_neuman;
<a name="l00431"></a>00431   <a class="code" href="Op__Diff__EF_8cpp.html#a1bfeb5e8695ea0d9ae2b7b1df9a522fd">remplir_marqueur_sommet_neumann</a>( marqueur_neuman,zone_ef,<a class="code" href="classOp__Diff__EF__base.html#a7b2c331807120f651f22dc0f22fc51b9">la_zcl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>(),<a class="code" href="classOp__Diff__EF.html#aac0d06305db461f32f48d4c0738adcef" title="vaut 1 si on veut calculer grad_u_transpose meme au bord">transpose_partout_</a> );
<a name="l00432"></a>00432 
<a name="l00433"></a>00433   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00434"></a>00434   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00435"></a>00435 
<a name="l00436"></a>00436   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00437"></a>00437   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00438"></a>00438 <span class="comment">// </span>
<a name="l00439"></a>00439   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00440"></a>00440 
<a name="l00441"></a>00441 <span class="preprocessor">#if 1</span>
<a name="l00442"></a>00442 <span class="preprocessor"></span>  <span class="keyword">const</span> <span class="keywordtype">double</span>* bij_ptr=bij.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00443"></a>00443   <span class="keyword">const</span> <span class="keywordtype">double</span>* inco_ptr=tab_inconnue.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00444"></a>00444   <span class="keywordtype">double</span>* resu_ptr=resu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00445"></a>00445 <span class="preprocessor">#define bij_(elem,i,j) bij_ptr[elem*dim_fois_nbn+i*const_dimension+j]</span>
<a name="l00446"></a>00446 <span class="preprocessor"></span><span class="preprocessor">#define inconnue_(som,a) inco_ptr[som * N + a]</span>
<a name="l00447"></a>00447 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu_ptr[som * N + a]</span>
<a name="l00448"></a>00448 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00449"></a>00449 <span class="preprocessor"></span><span class="preprocessor">#define bij_(elem,i,j) bij(elem,i,j)</span>
<a name="l00450"></a>00450 <span class="preprocessor"></span><span class="preprocessor">#define inconnue_(som,a) inconnue(som,a)</span>
<a name="l00451"></a>00451 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu(som,a)</span>
<a name="l00452"></a>00452 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00453"></a>00453 <span class="preprocessor"></span>  {
<a name="l00454"></a>00454     <span class="keywordtype">double</span> pr[2];
<a name="l00455"></a>00455     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00456"></a>00456       <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00457"></a>00457         {
<a name="l00458"></a>00458           <span class="keywordtype">double</span> pond=volumes_thilde(elem)/volumes(elem)/volumes(elem)*<a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>(elem);
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 
<a name="l00461"></a>00461           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00462"></a>00462             {
<a name="l00463"></a>00463               <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00464"></a>00464               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;N; yy++) pr[yy]=0;
<a name="l00465"></a>00465               <span class="keywordtype">int</span> transpose = (marqueur_neuman(glob) == 1 || N == 1) ? 0 : <a class="code" href="classOp__Diff__EF.html#a7ddc8b767fdf7438b3dafd53ee4a5547" title="vaurt zero si on ne veut pas calculer grad u transpose">transpose_</a>;
<a name="l00466"></a>00466               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00467"></a>00467                 {
<a name="l00468"></a>00468                   <span class="keywordtype">int</span> glob2=elems(elem,i2);
<a name="l00469"></a>00469 
<a name="l00470"></a>00470                   {
<a name="l00471"></a>00471                     <span class="keywordtype">double</span> <a class="code" href="Zone__CoviMAC_8h.html#aa24d8c7ee8fd93e2360821d3636ec69d">prod</a>=0;
<a name="l00472"></a>00472                     <span class="keywordtype">double</span> prod2=0;
<a name="l00473"></a>00473                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00474"></a>00474                       {
<a name="l00475"></a>00475                         prod+=<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b)*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i2,b);
<a name="l00476"></a>00476                         <span class="keywordflow">if</span> (transpose)
<a name="l00477"></a>00477                           prod2+=<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b)*<a class="code" href="Op__Diff__EF_8cpp.html#acd26084b8f7f8ecd3b6bbe889312465f">inconnue_</a>(glob2,b);
<a name="l00478"></a>00478                       }
<a name="l00479"></a>00479                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l00480"></a>00480                       pr[n] += prod*<a class="code" href="Op__Diff__EF_8cpp.html#acd26084b8f7f8ecd3b6bbe889312465f">inconnue_</a>(glob2, n)+prod2*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem, i2, n);
<a name="l00481"></a>00481                   }
<a name="l00482"></a>00482                 }
<a name="l00483"></a>00483               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l00484"></a>00484                 <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(glob, n) -= pr[n] * pond;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486             }
<a name="l00487"></a>00487         }
<a name="l00488"></a>00488   }
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 <span class="comment">// Debog::verifier(&quot; Op_Diff_EF::ajouter, resu 0 &quot;,resu);</span>
<a name="l00491"></a>00491 <span class="comment">// Journal()&lt;&lt;max(resu)&lt;&lt;&quot; &quot;&lt;&lt;min(resu)&lt;&lt;finl;</span>
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 
<a name="l00494"></a>00494 <span class="comment">// on ajoute la contribution des bords</span>
<a name="l00495"></a>00495   <a class="code" href="classOp__Diff__EF.html#a2523fcf4a2dfd3c44dda73b8dc334ba3">ajouter_bords</a>(tab_inconnue,resu);
<a name="l00496"></a>00496   <span class="keywordflow">return</span> resu;
<a name="l00497"></a>00497 <span class="preprocessor">#undef bij_</span>
<a name="l00498"></a>00498 <span class="preprocessor"></span><span class="preprocessor">#undef inconnue_</span>
<a name="l00499"></a>00499 <span class="preprocessor"></span><span class="preprocessor">#undef resu_</span>
<a name="l00500"></a>00500 <span class="preprocessor"></span>}
<a name="l00501"></a>00501 
<a name="l00502"></a>00502 
<a name="l00503"></a>00503 <span class="comment">// Punset(N)</span>
<a name="l00504"></a>00504 <span class="comment">// Punset(dim_fois_nbn)</span>
<a name="l00505"></a>00505 <span class="comment">// Punset(nb_som_elem)</span>
<a name="l00506"></a>00506 
<a name="l00507"></a>00507 
<a name="l00508"></a><a class="code" href="classOp__Diff__EF.html#a9f87a2ebf17ff9d55b3745636694ece2">00508</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__EF.html#a9f87a2ebf17ff9d55b3745636694ece2">Op_Diff_EF::ajouter_scalaire_dim2_nbn_4</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_inconnue, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00509"></a>00509 <span class="keyword"></span>{
<a name="l00510"></a>00510   <span class="keyword">const</span> <span class="keywordtype">int</span> N =1;
<a name="l00511"></a>00511   <span class="keyword">const</span> <span class="keywordtype">int</span> dim_fois_nbn= 8;
<a name="l00512"></a>00512   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_elem= 4;
<a name="l00513"></a>00513   <span class="keyword">const</span> <span class="keywordtype">int</span> const_dimension= 2;
<a name="l00514"></a>00514   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00515"></a>00515   assert(nb_som_elem*const_dimension==dim_fois_nbn);
<a name="l00516"></a>00516 
<a name="l00517"></a>00517 
<a name="l00518"></a>00518   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00519"></a>00519   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00520"></a>00520 
<a name="l00521"></a>00521   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00522"></a>00522   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00523"></a>00523 <span class="comment">// </span>
<a name="l00524"></a>00524   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00525"></a>00525 
<a name="l00526"></a>00526 <span class="preprocessor">#if 1</span>
<a name="l00527"></a>00527 <span class="preprocessor"></span>  <span class="keyword">const</span> <span class="keywordtype">double</span>* bij_ptr=bij.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00528"></a>00528   <span class="keyword">const</span> <span class="keywordtype">double</span>* inco_ptr=tab_inconnue.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00529"></a>00529 
<a name="l00530"></a>00530 <span class="preprocessor">#define bij_(elem,i,j) bij_ptr[elem*dim_fois_nbn+i*const_dimension+j]</span>
<a name="l00531"></a>00531 <span class="preprocessor"></span><span class="preprocessor">#define inconnue_(som,a) inco_ptr[som * N + a]</span>
<a name="l00532"></a>00532 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu_ptr[som * N + a]</span>
<a name="l00533"></a>00533 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00534"></a>00534 <span class="preprocessor"></span><span class="preprocessor">#define bij_(elem,i,j) bij(elem,i,j)</span>
<a name="l00535"></a>00535 <span class="preprocessor"></span><span class="preprocessor">#define inconnue_(som,a) inconnue(som,a)</span>
<a name="l00536"></a>00536 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu(som,a)</span>
<a name="l00537"></a>00537 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00538"></a>00538 <span class="preprocessor"></span>  {
<a name="l00539"></a>00539     <span class="keywordtype">double</span> pr[1];
<a name="l00540"></a>00540     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00541"></a>00541       <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00542"></a>00542         {
<a name="l00543"></a>00543           <span class="keywordtype">double</span> pond=volumes_thilde(elem)/volumes(elem)/volumes(elem)*<a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>(elem);
<a name="l00544"></a>00544 
<a name="l00545"></a>00545 
<a name="l00546"></a>00546           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00547"></a>00547             {
<a name="l00548"></a>00548               <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00549"></a>00549               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;N; yy++) pr[yy]=0;
<a name="l00550"></a>00550               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00551"></a>00551                 {
<a name="l00552"></a>00552                   <span class="keywordtype">int</span> glob2=elems(elem,i2);
<a name="l00553"></a>00553 
<a name="l00554"></a>00554                   {
<a name="l00555"></a>00555                     <span class="keywordtype">double</span> <a class="code" href="Zone__CoviMAC_8h.html#aa24d8c7ee8fd93e2360821d3636ec69d">prod</a>=0;
<a name="l00556"></a>00556                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00557"></a>00557                       {
<a name="l00558"></a>00558                         prod+=<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b)*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i2,b);
<a name="l00559"></a>00559                       }
<a name="l00560"></a>00560                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l00561"></a>00561                       pr[n] += prod*<a class="code" href="Op__Diff__EF_8cpp.html#acd26084b8f7f8ecd3b6bbe889312465f">inconnue_</a>(glob2, n);
<a name="l00562"></a>00562                   }
<a name="l00563"></a>00563                 }
<a name="l00564"></a>00564               resu(glob)-=pr[0]*pond;
<a name="l00565"></a>00565 
<a name="l00566"></a>00566             }
<a name="l00567"></a>00567         }
<a name="l00568"></a>00568   }
<a name="l00569"></a>00569 
<a name="l00570"></a>00570 <span class="comment">// Debog::verifier(&quot; Op_Diff_EF::ajouter, resu 0 &quot;,resu);</span>
<a name="l00571"></a>00571 <span class="comment">// Journal()&lt;&lt;max(resu)&lt;&lt;&quot; &quot;&lt;&lt;min(resu)&lt;&lt;finl;</span>
<a name="l00572"></a>00572 
<a name="l00573"></a>00573 
<a name="l00574"></a>00574 <span class="comment">// on ajoute la contribution des bords</span>
<a name="l00575"></a>00575   <a class="code" href="classOp__Diff__EF.html#a2523fcf4a2dfd3c44dda73b8dc334ba3">ajouter_bords</a>(tab_inconnue,resu);
<a name="l00576"></a>00576   <span class="keywordflow">return</span> resu;
<a name="l00577"></a>00577 <span class="preprocessor">#undef bij_</span>
<a name="l00578"></a>00578 <span class="preprocessor"></span><span class="preprocessor">#undef inconnue_</span>
<a name="l00579"></a>00579 <span class="preprocessor"></span><span class="preprocessor">#undef resu_</span>
<a name="l00580"></a>00580 <span class="preprocessor"></span>}
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 
<a name="l00583"></a>00583 <span class="comment">// Punset(N)</span>
<a name="l00584"></a>00584 <span class="comment">// Punset(dim_fois_nbn)</span>
<a name="l00585"></a>00585 <span class="comment">// Punset(nb_som_elem)</span>
<a name="l00586"></a>00586 
<a name="l00587"></a>00587 
<a name="l00588"></a><a class="code" href="classOp__Diff__EF.html#a52cd3f93057f7d425c8a75aa6927c8e0">00588</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__EF.html#a52cd3f93057f7d425c8a75aa6927c8e0">Op_Diff_EF::ajouter_scalaire_gen</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_inconnue, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00589"></a>00589 <span class="keyword"></span>{
<a name="l00590"></a>00590   <span class="keyword">const</span> <span class="keywordtype">int</span> const_dimension= <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00591"></a>00591   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00592"></a>00592   <span class="keyword">const</span> <span class="keywordtype">int</span> N = resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00593"></a>00593   <span class="keywordtype">int</span> nb_som_elem=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00594"></a>00594   <span class="keywordtype">int</span> dim_fois_nbn=nb_som_elem*const_dimension;
<a name="l00595"></a>00595   assert(nb_som_elem*const_dimension==dim_fois_nbn);
<a name="l00596"></a>00596 
<a name="l00597"></a>00597 
<a name="l00598"></a>00598   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00599"></a>00599   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00600"></a>00600 
<a name="l00601"></a>00601   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00602"></a>00602   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00603"></a>00603 <span class="comment">// </span>
<a name="l00604"></a>00604   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 <span class="preprocessor">#if 1</span>
<a name="l00607"></a>00607 <span class="preprocessor"></span>  <span class="keyword">const</span> <span class="keywordtype">double</span>* bij_ptr=bij.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00608"></a>00608   <span class="keyword">const</span> <span class="keywordtype">double</span>* inco_ptr=tab_inconnue.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00609"></a>00609 
<a name="l00610"></a>00610 <span class="preprocessor">#define bij_(elem,i,j) bij_ptr[elem*dim_fois_nbn+i*const_dimension+j]</span>
<a name="l00611"></a>00611 <span class="preprocessor"></span><span class="preprocessor">#define inconnue_(som,a) inco_ptr[som * N + a]</span>
<a name="l00612"></a>00612 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu_ptr[som * N + a]</span>
<a name="l00613"></a>00613 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00614"></a>00614 <span class="preprocessor"></span><span class="preprocessor">#define bij_(elem,i,j) bij(elem,i,j)</span>
<a name="l00615"></a>00615 <span class="preprocessor"></span><span class="preprocessor">#define inconnue_(som,a) inconnue(som,a)</span>
<a name="l00616"></a>00616 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu(som,a)</span>
<a name="l00617"></a>00617 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00618"></a>00618 <span class="preprocessor"></span>  {
<a name="l00619"></a>00619     <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> pr(N);
<a name="l00620"></a>00620     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00621"></a>00621       <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00622"></a>00622         {
<a name="l00623"></a>00623           <span class="keywordtype">double</span> pond=volumes_thilde(elem)/volumes(elem)/volumes(elem)*<a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>(elem);
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 
<a name="l00626"></a>00626           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00627"></a>00627             {
<a name="l00628"></a>00628               <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00629"></a>00629               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;N; yy++) pr[yy]=0;
<a name="l00630"></a>00630               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00631"></a>00631                 {
<a name="l00632"></a>00632                   <span class="keywordtype">int</span> glob2=elems(elem,i2);
<a name="l00633"></a>00633 
<a name="l00634"></a>00634                   {
<a name="l00635"></a>00635                     <span class="keywordtype">double</span> <a class="code" href="Zone__CoviMAC_8h.html#aa24d8c7ee8fd93e2360821d3636ec69d">prod</a>=0;
<a name="l00636"></a>00636                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00637"></a>00637                       {
<a name="l00638"></a>00638                         prod+=<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b)*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i2,b);
<a name="l00639"></a>00639                       }
<a name="l00640"></a>00640                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l00641"></a>00641                       pr[n] += prod*<a class="code" href="Op__Diff__EF_8cpp.html#acd26084b8f7f8ecd3b6bbe889312465f">inconnue_</a>(glob2, n);
<a name="l00642"></a>00642                   }
<a name="l00643"></a>00643                 }
<a name="l00644"></a>00644               resu(glob)-=pr[0]*pond;
<a name="l00645"></a>00645 
<a name="l00646"></a>00646             }
<a name="l00647"></a>00647         }
<a name="l00648"></a>00648   }
<a name="l00649"></a>00649 
<a name="l00650"></a>00650 <span class="comment">// Debog::verifier(&quot; Op_Diff_EF::ajouter, resu 0 &quot;,resu);</span>
<a name="l00651"></a>00651 <span class="comment">// Journal()&lt;&lt;max(resu)&lt;&lt;&quot; &quot;&lt;&lt;min(resu)&lt;&lt;finl;</span>
<a name="l00652"></a>00652 
<a name="l00653"></a>00653 
<a name="l00654"></a>00654 <span class="comment">// on ajoute la contribution des bords</span>
<a name="l00655"></a>00655   <a class="code" href="classOp__Diff__EF.html#a2523fcf4a2dfd3c44dda73b8dc334ba3">ajouter_bords</a>(tab_inconnue,resu);
<a name="l00656"></a>00656   <span class="keywordflow">return</span> resu;
<a name="l00657"></a>00657 <span class="preprocessor">#undef bij_</span>
<a name="l00658"></a>00658 <span class="preprocessor"></span><span class="preprocessor">#undef inconnue_</span>
<a name="l00659"></a>00659 <span class="preprocessor"></span><span class="preprocessor">#undef resu_</span>
<a name="l00660"></a>00660 <span class="preprocessor"></span>}
<a name="l00661"></a>00661 
<a name="l00662"></a><a class="code" href="classOp__Diff__EF.html#af659927b2f084c91757f109ca70551e0">00662</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__EF.html#af659927b2f084c91757f109ca70551e0">Op_Diff_EF::ajouter_vectoriel_gen</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_inconnue, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00663"></a>00663 <span class="keyword"></span>{
<a name="l00664"></a>00664   <span class="keyword">const</span> <span class="keywordtype">int</span> const_dimension= <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00665"></a>00665   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00666"></a>00666   <span class="keyword">const</span> <span class="keywordtype">int</span> N = resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00667"></a>00667   <span class="keywordtype">int</span> nb_som_elem=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00668"></a>00668   <span class="keywordtype">int</span> dim_fois_nbn=nb_som_elem*const_dimension;
<a name="l00669"></a>00669   assert(nb_som_elem*const_dimension==dim_fois_nbn);
<a name="l00670"></a>00670 
<a name="l00671"></a>00671   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> marqueur_neuman;
<a name="l00672"></a>00672   <a class="code" href="Op__Diff__EF_8cpp.html#a1bfeb5e8695ea0d9ae2b7b1df9a522fd">remplir_marqueur_sommet_neumann</a>( marqueur_neuman,zone_ef,<a class="code" href="classOp__Diff__EF__base.html#a7b2c331807120f651f22dc0f22fc51b9">la_zcl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>(),<a class="code" href="classOp__Diff__EF.html#aac0d06305db461f32f48d4c0738adcef" title="vaut 1 si on veut calculer grad_u_transpose meme au bord">transpose_partout_</a> );
<a name="l00673"></a>00673 
<a name="l00674"></a>00674   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00675"></a>00675   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00676"></a>00676 
<a name="l00677"></a>00677   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00678"></a>00678   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00679"></a>00679 <span class="comment">// </span>
<a name="l00680"></a>00680   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00681"></a>00681 
<a name="l00682"></a>00682 <span class="preprocessor">#if 1</span>
<a name="l00683"></a>00683 <span class="preprocessor"></span>  <span class="keyword">const</span> <span class="keywordtype">double</span>* bij_ptr=bij.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00684"></a>00684   <span class="keyword">const</span> <span class="keywordtype">double</span>* inco_ptr=tab_inconnue.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00685"></a>00685   <span class="keywordtype">double</span>* resu_ptr=resu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00686"></a>00686 <span class="preprocessor">#define bij_(elem,i,j) bij_ptr[elem*dim_fois_nbn+i*const_dimension+j]</span>
<a name="l00687"></a>00687 <span class="preprocessor"></span><span class="preprocessor">#define inconnue_(som,a) inco_ptr[som * N + a]</span>
<a name="l00688"></a>00688 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu_ptr[som * N + a]</span>
<a name="l00689"></a>00689 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00690"></a>00690 <span class="preprocessor"></span><span class="preprocessor">#define bij_(elem,i,j) bij(elem,i,j)</span>
<a name="l00691"></a>00691 <span class="preprocessor"></span><span class="preprocessor">#define inconnue_(som,a) inconnue(som,a)</span>
<a name="l00692"></a>00692 <span class="preprocessor"></span><span class="preprocessor">#define resu_(som,a) resu(som,a)</span>
<a name="l00693"></a>00693 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00694"></a>00694 <span class="preprocessor"></span>  {
<a name="l00695"></a>00695     <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> pr(N);
<a name="l00696"></a>00696     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00697"></a>00697       <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00698"></a>00698         {
<a name="l00699"></a>00699           <span class="keywordtype">double</span> pond=volumes_thilde(elem)/volumes(elem)/volumes(elem)*<a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>(elem);
<a name="l00700"></a>00700 
<a name="l00701"></a>00701 
<a name="l00702"></a>00702           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00703"></a>00703             {
<a name="l00704"></a>00704               <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00705"></a>00705               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> yy=0; yy&lt;N; yy++) pr[yy]=0;
<a name="l00706"></a>00706               <span class="keywordtype">int</span> transpose = (marqueur_neuman(glob) == 1 || N == 1) ? 0 : <a class="code" href="classOp__Diff__EF.html#a7ddc8b767fdf7438b3dafd53ee4a5547" title="vaurt zero si on ne veut pas calculer grad u transpose">transpose_</a>;
<a name="l00707"></a>00707               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00708"></a>00708                 {
<a name="l00709"></a>00709                   <span class="keywordtype">int</span> glob2=elems(elem,i2);
<a name="l00710"></a>00710 
<a name="l00711"></a>00711                   {
<a name="l00712"></a>00712                     <span class="keywordtype">double</span> <a class="code" href="Zone__CoviMAC_8h.html#aa24d8c7ee8fd93e2360821d3636ec69d">prod</a>=0;
<a name="l00713"></a>00713                     <span class="keywordtype">double</span> prod2=0;
<a name="l00714"></a>00714                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;const_dimension; b++)
<a name="l00715"></a>00715                       {
<a name="l00716"></a>00716                         prod+=<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b)*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i2,b);
<a name="l00717"></a>00717                         <span class="keywordflow">if</span> (transpose)
<a name="l00718"></a>00718                           prod2+=<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem,i1,b)*<a class="code" href="Op__Diff__EF_8cpp.html#acd26084b8f7f8ecd3b6bbe889312465f">inconnue_</a>(glob2,b);
<a name="l00719"></a>00719                       }
<a name="l00720"></a>00720                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l00721"></a>00721                       pr[n] += prod*<a class="code" href="Op__Diff__EF_8cpp.html#acd26084b8f7f8ecd3b6bbe889312465f">inconnue_</a>(glob2, n)+prod2*<a class="code" href="Op__Conv__EF_8cpp.html#a1891b7a4d3d0ef904a1f27322cfedeec">bij_</a>(elem, i2, n);
<a name="l00722"></a>00722                   }
<a name="l00723"></a>00723                 }
<a name="l00724"></a>00724               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l00725"></a>00725                 <a class="code" href="Op__Conv__EF_8cpp.html#ac589eb9e4844464bac4aea735bc8d1fd">resu_</a>(glob, n) -= pr[n] * pond;
<a name="l00726"></a>00726 
<a name="l00727"></a>00727             }
<a name="l00728"></a>00728         }
<a name="l00729"></a>00729   }
<a name="l00730"></a>00730 
<a name="l00731"></a>00731 <span class="comment">// Debog::verifier(&quot; Op_Diff_EF::ajouter, resu 0 &quot;,resu);</span>
<a name="l00732"></a>00732 <span class="comment">// Journal()&lt;&lt;max(resu)&lt;&lt;&quot; &quot;&lt;&lt;min(resu)&lt;&lt;finl;</span>
<a name="l00733"></a>00733 
<a name="l00734"></a>00734 
<a name="l00735"></a>00735 <span class="comment">// on ajoute la contribution des bords</span>
<a name="l00736"></a>00736   <a class="code" href="classOp__Diff__EF.html#a2523fcf4a2dfd3c44dda73b8dc334ba3">ajouter_bords</a>(tab_inconnue,resu);
<a name="l00737"></a>00737   <span class="keywordflow">return</span> resu;
<a name="l00738"></a>00738 <span class="preprocessor">#undef bij_</span>
<a name="l00739"></a>00739 <span class="preprocessor"></span><span class="preprocessor">#undef inconnue_</span>
<a name="l00740"></a>00740 <span class="preprocessor"></span><span class="preprocessor">#undef resu_</span>
<a name="l00741"></a>00741 <span class="preprocessor"></span>}
<a name="l00742"></a>00742 
<a name="l00743"></a><a class="code" href="classOp__Diff__EF.html#ac77a4ff27852f9503057460327ed7183">00743</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__EF.html#ac77a4ff27852f9503057460327ed7183">Op_Diff_EF::ajouter_new</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_inconnue, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00744"></a>00744 <span class="keyword"></span>{
<a name="l00745"></a>00745   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;NEW&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00746"></a>00746   <a class="code" href="classOp__Diff__EF.html#a279310b0c244df90a22d8ff89bb3d29f">remplir_nu</a>(<a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>);
<a name="l00747"></a>00747 <span class="comment">// const Zone_Cl_EF&amp; zone_Cl_EF = la_zcl_EF.valeur();</span>
<a name="l00748"></a>00748 <span class="comment">// const Zone_EF&amp; zone_EF = la_zone_EF.valeur();</span>
<a name="l00749"></a>00749 
<a name="l00750"></a>00750 
<a name="l00751"></a>00751   <span class="keyword">const</span> <span class="keywordtype">int</span> N = resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00752"></a>00752   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> marqueur_neuman;
<a name="l00753"></a>00753   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00754"></a>00754   <span class="keywordflow">if</span>(N &gt; 1)
<a name="l00755"></a>00755     <a class="code" href="Op__Diff__EF_8cpp.html#a1bfeb5e8695ea0d9ae2b7b1df9a522fd">remplir_marqueur_sommet_neumann</a>( marqueur_neuman,zone_ef,<a class="code" href="classOp__Diff__EF__base.html#a7b2c331807120f651f22dc0f22fc51b9">la_zcl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>(),<a class="code" href="classOp__Diff__EF.html#aac0d06305db461f32f48d4c0738adcef" title="vaut 1 si on veut calculer grad_u_transpose meme au bord">transpose_partout_</a> );
<a name="l00756"></a>00756 
<a name="l00757"></a>00757   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00758"></a>00758 
<a name="l00759"></a>00759   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00760"></a>00760   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij_thilde=zone_ef.<a class="code" href="classZone__EF.html#a19670025b345d5a9125180fb960052be">Bij_thilde</a>();
<a name="l00761"></a>00761   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00762"></a>00762   <span class="keywordtype">int</span> nb_som_elem=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00763"></a>00763   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00764"></a>00764 
<a name="l00765"></a>00765   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00766"></a>00766     <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00767"></a>00767       {
<a name="l00768"></a>00768         <span class="keywordtype">double</span> pond=1./volumes(elem);
<a name="l00769"></a>00769         assert(N == <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> || N == 1);
<a name="l00770"></a>00770 
<a name="l00771"></a>00771         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00772"></a>00772           {
<a name="l00773"></a>00773             <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00774"></a>00774             <span class="keywordtype">int</span> transpose = (marqueur_neuman(glob) == 1 || N == 1) ? 0 : <a class="code" href="classOp__Diff__EF.html#a7ddc8b767fdf7438b3dafd53ee4a5547" title="vaurt zero si on ne veut pas calculer grad u transpose">transpose_</a>;
<a name="l00775"></a>00775             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00776"></a>00776               {
<a name="l00777"></a>00777                 <span class="keywordtype">int</span> glob2=elems(elem,i2);
<a name="l00778"></a>00778                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l00779"></a>00779                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; d++)
<a name="l00780"></a>00780                     resu(glob, n) -= bij(elem, i1, d) * (bij_thilde(elem, i2, d) * tab_inconnue(glob2, n) + transpose * bij_thilde(elem, i2, n) * tab_inconnue(glob2, d)) * <a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>(elem) * pond;
<a name="l00781"></a>00781               }
<a name="l00782"></a>00782           }
<a name="l00783"></a>00783       }
<a name="l00784"></a>00784 <span class="comment">// Debog::verifier(&quot; Op_Diff_EF::ajouter, resu 0 &quot;,resu);</span>
<a name="l00785"></a>00785 <span class="comment">// Journal()&lt;&lt;max(resu)&lt;&lt;&quot; &quot;&lt;&lt;min(resu)&lt;&lt;finl;</span>
<a name="l00786"></a>00786 
<a name="l00787"></a>00787 
<a name="l00788"></a>00788 <span class="comment">// on ajoute la contribution des bords</span>
<a name="l00789"></a>00789   <a class="code" href="classOp__Diff__EF.html#a2523fcf4a2dfd3c44dda73b8dc334ba3">ajouter_bords</a>(tab_inconnue,resu);
<a name="l00790"></a>00790   <span class="keywordflow">return</span> resu;
<a name="l00791"></a>00791 }
<a name="l00792"></a>00792 
<a name="l00793"></a><a class="code" href="classOp__Diff__EF.html#a5721846f352f684c83604a837990f5ec">00793</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__EF.html#a5721846f352f684c83604a837990f5ec">Op_Diff_EF::calculer</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_inconnue, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00794"></a>00794 <span class="keyword"></span>{
<a name="l00795"></a>00795   resu = 0;
<a name="l00796"></a>00796   <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__EF.html#a59fa0c441a04910006a52e72eae1b352">ajouter</a>(tab_inconnue,resu);
<a name="l00797"></a>00797 }
<a name="l00798"></a>00798 
<a name="l00799"></a>00799 
<a name="l00800"></a>00800 
<a name="l00801"></a>00801 <span class="comment">//</span>
<a name="l00802"></a>00802 <span class="comment">// Methode pour l&#39;implicite</span>
<a name="l00803"></a>00803 <span class="comment">//</span>
<a name="l00804"></a>00804 
<a name="l00805"></a>00805 
<a name="l00806"></a>00806 <span class="comment">// essai</span>
<a name="l00807"></a><a class="code" href="Op__Diff__EF_8cpp.html#a578bb5ade70953064b9062fe8fc35f49">00807</a> <span class="keyword">inline</span> <span class="keywordtype">double</span>&amp; <a class="code" href="Op__Diff__EF_8cpp.html#a578bb5ade70953064b9062fe8fc35f49">coeff_opt</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice,<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j)
<a name="l00808"></a>00808 {
<a name="l00809"></a>00809   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1_=matrice.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>();
<a name="l00810"></a>00810   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2_=matrice.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>();
<a name="l00811"></a>00811   <span class="keywordtype">int</span> k1=tab1_[i]-1;
<a name="l00812"></a>00812   <span class="keywordtype">int</span> k2=tab1_[i+1]-1;
<a name="l00813"></a>00813   <span class="keywordtype">int</span> k;
<a name="l00814"></a>00814   <span class="keywordflow">for</span> (k=k1; k&lt;k2; k++)
<a name="l00815"></a>00815     <span class="keywordflow">if</span> (tab2_[k]-1 == j) <span class="keywordflow">return</span>(matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>()(k));
<a name="l00816"></a>00816   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;i ou j ne conviennent pas &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00817"></a>00817   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;i=&quot;</span> &lt;&lt; i &lt;&lt; finl;
<a name="l00818"></a>00818   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;j=&quot;</span> &lt;&lt; j &lt;&lt; finl;
<a name="l00819"></a>00819   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;n_lignes=&quot;</span> &lt;&lt; matrice.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() &lt;&lt; finl;
<a name="l00820"></a>00820   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;n_colonnes=&quot;</span> &lt;&lt; matrice.<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>() &lt;&lt; finl;
<a name="l00821"></a>00821   assert( k&lt;tab1_[i]-1);
<a name="l00822"></a>00822   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00823"></a>00823   <span class="keywordflow">return</span> <a class="code" href="Op__Diff__EF_8cpp.html#a578bb5ade70953064b9062fe8fc35f49">coeff_opt</a>(matrice,i,j);
<a name="l00824"></a>00824 }
<a name="l00825"></a>00825 <span class="comment">// #define matrice_coef(i,j) coeff_opt(matrice,i,j)</span>
<a name="l00826"></a><a class="code" href="Op__Diff__EF_8cpp.html#a6aa91ac617af38500bc935d0db9b70b2">00826</a> <span class="preprocessor">#define  matrice_coef(i,j) matrice.coef(i,j)</span>
<a name="l00827"></a><a class="code" href="classOp__Diff__EF.html#a1e56048a083026b34efabf4005c4ad22">00827</a> <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="classOp__Diff__EF.html#a1e56048a083026b34efabf4005c4ad22">Op_Diff_EF::ajouter_contribution</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice )<span class="keyword"> const</span>
<a name="l00828"></a>00828 <span class="keyword"></span>{
<a name="l00829"></a>00829   <span class="keywordflow">if</span> (1)
<a name="l00830"></a>00830     <span class="keywordflow">if</span> ((<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().nombre_d_operateurs()&gt;1)&amp;&amp;<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classOp__Conv__EF.html" title="class Op_Conv_EF Cette classe represente l&#39;operateur de convection associe a une equation de transpor...">Op_Conv_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(1).l_op_base()))
<a name="l00831"></a>00831       <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOp__Conv__EF.html" title="class Op_Conv_EF Cette classe represente l&#39;operateur de convection associe a une equation de transpor...">Op_Conv_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(1).l_op_base()).ajouter_contribution_a_la_diffusion(transporte,matrice);
<a name="l00832"></a>00832 
<a name="l00833"></a>00833   <span class="keywordflow">if</span> (<a class="code" href="classOp__Diff__EF.html#a67a011bbbd2ad3798f1241f0c2d95ed6">nouvelle_expression_</a>==1)
<a name="l00834"></a>00834     {
<a name="l00835"></a>00835       <a class="code" href="classOp__Diff__EF.html#a311b3200894c5b4b8541186e522779fe">ajouter_contribution_new</a>(transporte,matrice);
<a name="l00836"></a>00836     }
<a name="l00837"></a>00837 <span class="comment">// On remplit le tableau nu car l&#39;assemblage d&#39;une</span>
<a name="l00838"></a>00838 <span class="comment">// matrice avec ajouter_contribution peut se faire</span>
<a name="l00839"></a>00839 <span class="comment">// avant le premier pas de temps</span>
<a name="l00840"></a>00840   <a class="code" href="classOp__Diff__EF.html#a279310b0c244df90a22d8ff89bb3d29f">remplir_nu</a>(<a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>);
<a name="l00841"></a>00841 
<a name="l00842"></a>00842   <span class="keyword">const</span> <span class="keywordtype">int</span> N = transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00843"></a>00843   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00844"></a>00844   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00845"></a>00845   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00846"></a>00846 
<a name="l00847"></a>00847   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00848"></a>00848   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00849"></a>00849   <span class="keywordtype">int</span> nb_som_elem=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00850"></a>00850   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00851"></a>00851   <span class="keywordtype">int</span> nb_som=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();
<a name="l00852"></a>00852 
<a name="l00853"></a>00853   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> marqueur_neuman;
<a name="l00854"></a>00854   <a class="code" href="Op__Diff__EF_8cpp.html#a1bfeb5e8695ea0d9ae2b7b1df9a522fd">remplir_marqueur_sommet_neumann</a>( marqueur_neuman,zone_ef,<a class="code" href="classOp__Diff__EF__base.html#a7b2c331807120f651f22dc0f22fc51b9">la_zcl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>(),<a class="code" href="classOp__Diff__EF.html#aac0d06305db461f32f48d4c0738adcef" title="vaut 1 si on veut calculer grad_u_transpose meme au bord">transpose_partout_</a> );
<a name="l00855"></a>00855   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00856"></a>00856     <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00857"></a>00857       {
<a name="l00858"></a>00858         <span class="keywordtype">double</span> pond=volumes_thilde(elem)/volumes(elem)/volumes(elem);
<a name="l00859"></a>00859 
<a name="l00860"></a>00860         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00861"></a>00861           {
<a name="l00862"></a>00862             <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00863"></a>00863 
<a name="l00864"></a>00864             <span class="keywordtype">int</span> transpose = (marqueur_neuman(glob) == 1 || N == 1) ? 0 : <a class="code" href="classOp__Diff__EF.html#a7ddc8b767fdf7438b3dafd53ee4a5547" title="vaurt zero si on ne veut pas calculer grad u transpose">transpose_</a>;
<a name="l00865"></a>00865             <span class="keywordflow">if</span> (glob&lt;nb_som)
<a name="l00866"></a>00866               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00867"></a>00867                 {
<a name="l00868"></a>00868                   <span class="keywordtype">int</span> glob2=elems(elem,i2);
<a name="l00869"></a>00869                   <span class="keywordtype">double</span> cb=0;
<a name="l00870"></a>00870                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; b++)
<a name="l00871"></a>00871                     cb+=bij(elem,i1,b)*bij(elem,i2,b);
<a name="l00872"></a>00872                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l00873"></a>00873                     {
<a name="l00874"></a>00874                       <a class="code" href="Op__Diff__EF_8cpp.html#a6aa91ac617af38500bc935d0db9b70b2">matrice_coef</a>(glob * N + n, glob2 * N + n) += cb * <a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>(elem) * pond;
<a name="l00875"></a>00875                       <span class="keywordflow">if</span> (transpose)
<a name="l00876"></a>00876                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; d++)
<a name="l00877"></a>00877                           <a class="code" href="Op__Diff__EF_8cpp.html#a6aa91ac617af38500bc935d0db9b70b2">matrice_coef</a>(glob * N + n, glob2 * N + d) += bij(elem, i1, d) * bij(elem, i2, n) * <a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>(elem) * pond;
<a name="l00878"></a>00878                     }
<a name="l00879"></a>00879                 }
<a name="l00880"></a>00880           }
<a name="l00881"></a>00881       }
<a name="l00882"></a>00882   <span class="keywordflow">if</span> (N == 1) <a class="code" href="classOp__Diff__EF.html#acbb8c88d1af3d029aa0bf7e954da447f">ajouter_contributions_bords</a>(matrice);
<a name="l00883"></a>00883 
<a name="l00884"></a>00884 
<a name="l00885"></a>00885 
<a name="l00886"></a>00886 }
<a name="l00887"></a>00887 
<a name="l00888"></a><a class="code" href="classOp__Diff__EF.html#a311b3200894c5b4b8541186e522779fe">00888</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__EF.html#a311b3200894c5b4b8541186e522779fe">Op_Diff_EF::ajouter_contribution_new</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice )<span class="keyword"> const</span>
<a name="l00889"></a>00889 <span class="keyword"></span>{
<a name="l00890"></a>00890 <span class="comment">// Cerr&lt;&lt;&quot; NEW&quot;&lt;&lt;finl;</span>
<a name="l00891"></a>00891 <span class="comment">// On remplit le tableau nu car l&#39;assemblage d&#39;une</span>
<a name="l00892"></a>00892 <span class="comment">// matrice avec ajouter_contribution peut se faire</span>
<a name="l00893"></a>00893 <span class="comment">// avant le premier pas de temps</span>
<a name="l00894"></a>00894   <a class="code" href="classOp__Diff__EF.html#a279310b0c244df90a22d8ff89bb3d29f">remplir_nu</a>(<a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>);
<a name="l00895"></a>00895 
<a name="l00896"></a>00896   <span class="keyword">const</span> <span class="keywordtype">int</span> N = transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00897"></a>00897   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00898"></a>00898 <span class="comment">// const DoubleVect&amp; volumes_thilde= zone_ef.volumes_thilde();</span>
<a name="l00899"></a>00899   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00900"></a>00900 
<a name="l00901"></a>00901   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00902"></a>00902   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij_thilde=zone_ef.<a class="code" href="classZone__EF.html#a19670025b345d5a9125180fb960052be">Bij_thilde</a>();
<a name="l00903"></a>00903   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00904"></a>00904   <span class="keywordtype">int</span> nb_som_elem=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00905"></a>00905   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00906"></a>00906   <span class="keywordtype">int</span> nb_som=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();
<a name="l00907"></a>00907 
<a name="l00908"></a>00908   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> marqueur_neuman;
<a name="l00909"></a>00909   <a class="code" href="Op__Diff__EF_8cpp.html#a1bfeb5e8695ea0d9ae2b7b1df9a522fd">remplir_marqueur_sommet_neumann</a>( marqueur_neuman,zone_ef,<a class="code" href="classOp__Diff__EF__base.html#a7b2c331807120f651f22dc0f22fc51b9">la_zcl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>(),<a class="code" href="classOp__Diff__EF.html#aac0d06305db461f32f48d4c0738adcef" title="vaut 1 si on veut calculer grad_u_transpose meme au bord">transpose_partout_</a> );
<a name="l00910"></a>00910   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00911"></a>00911     <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">elem_contribue</a>(elem))
<a name="l00912"></a>00912       {
<a name="l00913"></a>00913         <span class="keywordtype">double</span> pond=1./volumes(elem);
<a name="l00914"></a>00914 
<a name="l00915"></a>00915         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00916"></a>00916           {
<a name="l00917"></a>00917             <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00918"></a>00918 
<a name="l00919"></a>00919             <span class="keywordtype">int</span> transpose = (marqueur_neuman(glob) == 1 || N == 1) ? 0 : <a class="code" href="classOp__Diff__EF.html#a7ddc8b767fdf7438b3dafd53ee4a5547" title="vaurt zero si on ne veut pas calculer grad u transpose">transpose_</a>;
<a name="l00920"></a>00920             <span class="keywordflow">if</span> (glob&lt;nb_som)
<a name="l00921"></a>00921               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00922"></a>00922                 {
<a name="l00923"></a>00923                   <span class="keywordtype">int</span> glob2=elems(elem,i2);
<a name="l00924"></a>00924                   <span class="keywordtype">double</span> cb=0;
<a name="l00925"></a>00925                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; b++)
<a name="l00926"></a>00926                     cb+=bij(elem,i1,b)*bij_thilde(elem,i2,b);
<a name="l00927"></a>00927                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l00928"></a>00928                     {
<a name="l00929"></a>00929                       <a class="code" href="Op__Diff__EF_8cpp.html#a6aa91ac617af38500bc935d0db9b70b2">matrice_coef</a>(glob * N + n, glob2 * N + n) += cb * <a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>(elem) * pond;
<a name="l00930"></a>00930                       <span class="keywordflow">if</span> (transpose)
<a name="l00931"></a>00931                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; d++)
<a name="l00932"></a>00932                           <a class="code" href="Op__Diff__EF_8cpp.html#a6aa91ac617af38500bc935d0db9b70b2">matrice_coef</a>(glob * N + n, glob2 * N + d) += bij(elem, i1, d) * bij_thilde(elem, i2, n) * <a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>(elem) * pond;
<a name="l00933"></a>00933                     }
<a name="l00934"></a>00934                 }
<a name="l00935"></a>00935           }
<a name="l00936"></a>00936       }
<a name="l00937"></a>00937 
<a name="l00938"></a>00938 
<a name="l00939"></a>00939 
<a name="l00940"></a>00940 
<a name="l00941"></a>00941 }
<a name="l00942"></a><a class="code" href="classOp__Diff__EF.html#ab72c7fab9d3ee0125fd77ed681a10e34">00942</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__EF.html#ab72c7fab9d3ee0125fd77ed681a10e34" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Diff_EF::contribuer_au_second_membre</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu )<span class="keyword"> const</span>
<a name="l00943"></a>00943 <span class="keyword"></span>{
<a name="l00944"></a>00944 
<a name="l00945"></a>00945   <span class="keywordflow">if</span> ((<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().nombre_d_operateurs()&gt;1)&amp;&amp;<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classOp__Conv__EF.html" title="class Op_Conv_EF Cette classe represente l&#39;operateur de convection associe a une equation de transpor...">Op_Conv_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(1).l_op_base()))
<a name="l00946"></a>00946     <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOp__Conv__EF.html" title="class Op_Conv_EF Cette classe represente l&#39;operateur de convection associe a une equation de transpor...">Op_Conv_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().operateur(1).l_op_base()).contribue_au_second_membre_a_la_diffusion(resu);
<a name="l00947"></a>00947   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_inconnue=<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00948"></a>00948   <a class="code" href="classOp__Diff__EF.html#a2523fcf4a2dfd3c44dda73b8dc334ba3">ajouter_bords</a>(tab_inconnue,resu,0);
<a name="l00949"></a>00949 }
<a name="l00950"></a><a class="code" href="classOp__Diff__EF.html#a2523fcf4a2dfd3c44dda73b8dc334ba3">00950</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__EF.html#a2523fcf4a2dfd3c44dda73b8dc334ba3">Op_Diff_EF::ajouter_bords</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_inconnue,<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,  <span class="keywordtype">int</span> contrib_interne )<span class="keyword"> const</span>
<a name="l00951"></a>00951 <span class="keyword"></span>{
<a name="l00952"></a>00952 <span class="comment">// a mettre dans calculer_flux_bord....</span>
<a name="l00953"></a>00953 
<a name="l00954"></a>00954   <span class="keyword">const</span> <a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>&amp; zone_Cl_EF = <a class="code" href="classOp__Diff__EF__base.html#a7b2c331807120f651f22dc0f22fc51b9">la_zcl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>();
<a name="l00955"></a>00955   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classOp__Diff__EF__base.html#ac664238d74a546d15e8d7c26551be784">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00956"></a>00956   <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>=0.;
<a name="l00957"></a>00957 <span class="comment">// const DoubleTab&amp; tab_inconnue=equation().inconnue().valeurs();</span>
<a name="l00958"></a>00958 <span class="comment">// on parcourt toutes les faces de bord et on calcule lambda*gradT</span>
<a name="l00959"></a>00959   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00960"></a>00960   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins=zone_ef.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00961"></a>00961   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; bij=zone_ef.<a class="code" href="classZone__EF.html#a1399220391b0ae308681ac13bd7c98c1">Bij</a>();
<a name="l00962"></a>00962   <span class="keywordtype">int</span> nb_som_elem=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00963"></a>00963   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00964"></a>00964   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales=zone_ef.<a class="code" href="classZone__EF.html#a6c5db13c18d9793f63bc0678e6c5eb7d">face_normales</a>();
<a name="l00965"></a>00965   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_thilde= zone_ef.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00966"></a>00966   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes= zone_ef.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00967"></a>00967 
<a name="l00968"></a>00968   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_ef.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l00969"></a>00969   <span class="keywordtype">int</span> nb_som_face=zone_ef.<a class="code" href="classZone__VF.html#a990808f967f351edbb83ff11d60b7445" title="renvoie le nombre de sommets par face. Rque : on a suppose que toutes les faces avait le meme nombre ...">nb_som_face</a>();
<a name="l00970"></a>00970 
<a name="l00971"></a>00971   <span class="keyword">const</span> <span class="keywordtype">int</span> N = resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00972"></a>00972 
<a name="l00973"></a>00973   <span class="keywordflow">if</span> (N &gt; 1)
<a name="l00974"></a>00974     {
<a name="l00975"></a>00975 <span class="comment">// Cerr&lt;&lt;__PRETTY_FUNCTION__&lt;&lt;&quot; non code pour les vecteurs&quot;&lt;&lt;finl;</span>
<a name="l00976"></a>00976       <a class="code" href="classOp__EF__base.html#a7d8b39ad16163676b21ee9b8456ce5fe">modifier_flux</a>(*<span class="keyword">this</span>);
<a name="l00977"></a>00977       <span class="keywordflow">return</span>;
<a name="l00978"></a>00978     }
<a name="l00979"></a>00979   <span class="keywordtype">int</span> premiere_face_int=zone_ef.<a class="code" href="classZone__VF.html#a12869806fa4834aca8f2964e16509dfd" title="une face est interne ssi elle separe deux elements. renvoie le numero de la premiere face interne...">premiere_face_int</a>();
<a name="l00980"></a>00980   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=0; face&lt;premiere_face_int; face++)
<a name="l00981"></a>00981     {
<a name="l00982"></a>00982       <span class="keywordtype">int</span> elem=face_voisins(face,0);
<a name="l00983"></a>00983       <span class="keywordflow">if</span> (elem==-1) face_voisins(face,1);
<a name="l00984"></a>00984 
<a name="l00985"></a>00985       <span class="keywordtype">double</span> pond= volumes_thilde(elem)/volumes(elem)/volumes(elem);
<a name="l00986"></a>00986 
<a name="l00987"></a>00987       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00988"></a>00988         {
<a name="l00989"></a>00989 
<a name="l00990"></a>00990           <span class="keywordtype">int</span> glob2=elems(elem,i1);
<a name="l00991"></a>00991           {
<a name="l00992"></a>00992 
<a name="l00993"></a>00993             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a=0; a&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; a++)
<a name="l00994"></a>00994               {
<a name="l00995"></a>00995                 <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0)+=face_normales(face,a)*bij(elem,i1,a)*tab_inconnue(glob2)*<a class="code" href="classOp__Diff__EF__base.html#aed8321fa3ed2c68bdbffb01ee3a3fd81">nu_</a>(elem)*pond;
<a name="l00996"></a>00996               }
<a name="l00997"></a>00997           }
<a name="l00998"></a>00998         }
<a name="l00999"></a>00999 
<a name="l01000"></a>01000     }
<a name="l01001"></a>01001 
<a name="l01002"></a>01002 <span class="comment">// Neumann :</span>
<a name="l01003"></a>01003   <span class="keywordtype">int</span> n_bord;
<a name="l01004"></a>01004   <span class="keywordtype">int</span> nb_bords=zone_Cl_EF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
<a name="l01005"></a>01005 
<a name="l01006"></a>01006   <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;nb_bords; n_bord++)
<a name="l01007"></a>01007     {
<a name="l01008"></a>01008       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_EF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l01009"></a>01009       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l01010"></a>01010       <span class="keywordtype">int</span> ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l01011"></a>01011       <span class="keywordtype">int</span> nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l01012"></a>01012 
<a name="l01013"></a>01013       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l01014"></a>01014         {
<a name="l01015"></a>01015           <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp; la_cl_paroi = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>, la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l01016"></a>01016           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=ndeb; face&lt;nfin; face++)
<a name="l01017"></a>01017             {
<a name="l01018"></a>01018 
<a name="l01019"></a>01019               <span class="keywordtype">double</span> flux=la_cl_paroi.<a class="code" href="classNeumann__paroi.html#a76b977c608b621e7dd7106401ab44936" title="Renvoie la valeur du flux impose sur la i-eme composante du champ representant le flux a la frontiere...">flux_impose</a>(face-ndeb)*zone_EF.<a class="code" href="classZone__VF.html#af42306af8f7398c037e978377924ebe8">surface</a>(face);
<a name="l01020"></a>01020               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_face; i1++)
<a name="l01021"></a>01021                 {
<a name="l01022"></a>01022                   <span class="keywordtype">int</span> glob2=face_sommets(face,i1);
<a name="l01023"></a>01023                   {
<a name="l01024"></a>01024 
<a name="l01025"></a>01025                     resu[glob2] += flux/nb_som_face;
<a name="l01026"></a>01026                   }
<a name="l01027"></a>01027                   <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) = flux;
<a name="l01028"></a>01028                 }
<a name="l01029"></a>01029             }
<a name="l01030"></a>01030         }
<a name="l01031"></a>01031       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>, la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l01032"></a>01032         {
<a name="l01033"></a>01033           <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp; la_cl_paroi = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>, la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l01034"></a>01034           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=ndeb; face&lt;nfin; face++)
<a name="l01035"></a>01035             {
<a name="l01036"></a>01036 
<a name="l01037"></a>01037               <span class="keywordtype">double</span> h=la_cl_paroi.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-ndeb);
<a name="l01038"></a>01038               <span class="keywordtype">double</span> Text=la_cl_paroi.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-ndeb);
<a name="l01039"></a>01039 
<a name="l01040"></a>01040 
<a name="l01041"></a>01041               <span class="keywordtype">double</span> tm=0;
<a name="l01042"></a>01042               <span class="keywordflow">if</span> (contrib_interne)
<a name="l01043"></a>01043                 {
<a name="l01044"></a>01044                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_face; i1++)
<a name="l01045"></a>01045                     {
<a name="l01046"></a>01046                       <span class="keywordtype">int</span> glob2=face_sommets(face,i1);
<a name="l01047"></a>01047                       {
<a name="l01048"></a>01048                         tm+=tab_inconnue(glob2);
<a name="l01049"></a>01049                       }
<a name="l01050"></a>01050                     }
<a name="l01051"></a>01051                   tm/=nb_som_face;
<a name="l01052"></a>01052                 }
<a name="l01053"></a>01053               <span class="keywordtype">double</span> flux=h*(Text-tm)*zone_EF.<a class="code" href="classZone__VF.html#af42306af8f7398c037e978377924ebe8">surface</a>(face);
<a name="l01054"></a>01054               <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) = flux;
<a name="l01055"></a>01055               flux/=nb_som_face;
<a name="l01056"></a>01056               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_face; i1++)
<a name="l01057"></a>01057                 {
<a name="l01058"></a>01058                   <span class="keywordtype">int</span> glob2=face_sommets(face,i1);
<a name="l01059"></a>01059                   {
<a name="l01060"></a>01060                     resu[glob2] += flux;
<a name="l01061"></a>01061                   }
<a name="l01062"></a>01062 
<a name="l01063"></a>01063                 }
<a name="l01064"></a>01064             }
<a name="l01065"></a>01065         }
<a name="l01066"></a>01066 
<a name="l01067"></a>01067 
<a name="l01068"></a>01068     }
<a name="l01069"></a>01069   <a class="code" href="classOp__EF__base.html#a7d8b39ad16163676b21ee9b8456ce5fe">modifier_flux</a>(*<span class="keyword">this</span>);
<a name="l01070"></a>01070 }
<a name="l01071"></a>01071 
<a name="l01072"></a>01072 
<a name="l01073"></a>01073 
<a name="l01074"></a>01074 
<a name="l01075"></a><a class="code" href="classOp__Diff__EF.html#acbb8c88d1af3d029aa0bf7e954da447f">01075</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__EF.html#acbb8c88d1af3d029aa0bf7e954da447f">Op_Diff_EF::ajouter_contributions_bords</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice )<span class="keyword"> const</span>
<a name="l01076"></a>01076 <span class="keyword"></span>{
<a name="l01077"></a>01077   <span class="keyword">const</span> <a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>&amp; zone_Cl_EF = <a class="code" href="classOp__Diff__EF__base.html#a7b2c331807120f651f22dc0f22fc51b9">la_zcl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>();
<a name="l01078"></a>01078   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classOp__Diff__EF__base.html#ac664238d74a546d15e8d7c26551be784">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l01079"></a>01079   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l01080"></a>01080 
<a name="l01081"></a>01081   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_ef.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l01082"></a>01082   <span class="keywordtype">int</span> nb_som_face=zone_ef.<a class="code" href="classZone__VF.html#a990808f967f351edbb83ff11d60b7445" title="renvoie le nombre de sommets par face. Rque : on a suppose que toutes les faces avait le meme nombre ...">nb_som_face</a>();
<a name="l01083"></a>01083 
<a name="l01084"></a>01084   <span class="keywordtype">int</span> N = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>().<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l01085"></a>01085 
<a name="l01086"></a>01086   <span class="keywordflow">if</span> (N &gt; 1)
<a name="l01087"></a>01087     {
<a name="l01088"></a>01088 <span class="comment">// Cerr&lt;&lt;__PRETTY_FUNCTION__&lt;&lt;&quot; non code pour les vecteurs&quot;&lt;&lt;finl;</span>
<a name="l01089"></a>01089       <span class="keywordflow">throw</span>;
<a name="l01090"></a>01090       <span class="keywordflow">return</span>;
<a name="l01091"></a>01091     }
<a name="l01092"></a>01092 
<a name="l01093"></a>01093 <span class="comment">// Neumann :</span>
<a name="l01094"></a>01094   <span class="keywordtype">int</span> n_bord;
<a name="l01095"></a>01095   <span class="keywordtype">int</span> nb_bords=zone_Cl_EF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
<a name="l01096"></a>01096 
<a name="l01097"></a>01097   <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;nb_bords; n_bord++)
<a name="l01098"></a>01098     {
<a name="l01099"></a>01099       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_EF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l01100"></a>01100       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l01101"></a>01101       <span class="keywordtype">int</span> ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l01102"></a>01102       <span class="keywordtype">int</span> nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l01103"></a>01103 
<a name="l01104"></a>01104 
<a name="l01105"></a>01105       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>, la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l01106"></a>01106         {
<a name="l01107"></a>01107 <span class="comment">// matrice.imprimer(Cout);</span>
<a name="l01108"></a>01108           <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp; la_cl_paroi = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>, la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l01109"></a>01109           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=ndeb; face&lt;nfin; face++)
<a name="l01110"></a>01110             {
<a name="l01111"></a>01111 
<a name="l01112"></a>01112               <span class="keywordtype">double</span> h=la_cl_paroi.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-ndeb);
<a name="l01113"></a>01113 <span class="comment">// double Text=la_cl_paroi.T_ext(face-ndeb);</span>
<a name="l01114"></a>01114 
<a name="l01115"></a>01115 
<a name="l01116"></a>01116               <span class="keywordtype">double</span> tm=1./(nb_som_face*nb_som_face);
<a name="l01117"></a>01117               <span class="keywordtype">double</span> flux=h*zone_EF.<a class="code" href="classZone__VF.html#af42306af8f7398c037e978377924ebe8">surface</a>(face)*tm;
<a name="l01118"></a>01118               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_face; i1++)
<a name="l01119"></a>01119                 {
<a name="l01120"></a>01120                   <span class="keywordtype">int</span> glob2=face_sommets(face,i1);
<a name="l01121"></a>01121                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j1=0; j1&lt;nb_som_face; j1++)
<a name="l01122"></a>01122                     {
<a name="l01123"></a>01123                       <span class="keywordtype">int</span> glob1=face_sommets(face,j1);
<a name="l01124"></a>01124                       {
<a name="l01125"></a>01125                         <a class="code" href="Op__Diff__EF_8cpp.html#a6aa91ac617af38500bc935d0db9b70b2">matrice_coef</a>(glob1,glob2) += flux;
<a name="l01126"></a>01126                       }
<a name="l01127"></a>01127 
<a name="l01128"></a>01128                     }
<a name="l01129"></a>01129                 }
<a name="l01130"></a>01130             }
<a name="l01131"></a>01131 <span class="comment">// matrice.imprimer(Cout);exit();</span>
<a name="l01132"></a>01132         }
<a name="l01133"></a>01133     }
<a name="l01134"></a>01134 }
<a name="l01135"></a><a class="code" href="classOp__Diff__EF.html#ab32a7f92d76007ee2a49ac4fe2558a60">01135</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__EF.html#ab32a7f92d76007ee2a49ac4fe2558a60">Op_Diff_EF::verifier</a>()<span class="keyword"> const</span>
<a name="l01136"></a>01136 <span class="keyword"></span>{
<a name="l01137"></a>01137   <span class="keyword">static</span> <span class="keywordtype">int</span> testee=0;
<a name="l01138"></a>01138   <span class="keywordflow">if</span>(testee)
<a name="l01139"></a>01139     <span class="keywordflow">return</span>;
<a name="l01140"></a>01140   testee=1;
<a name="l01141"></a>01141 }
<a name="l01142"></a>01142 
<a name="l01143"></a>01143 
<a name="l01144"></a>01144 
<a name="l01145"></a>01145 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:11 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
