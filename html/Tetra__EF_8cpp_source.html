<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/EF/Zones/Tetra_EF.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/EF/Zones/Tetra_EF.cpp</div>  </div>
</div>
<div class="contents">
<a href="Tetra__EF_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Tetra_EF.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/EF/Zones</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     1</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Tetra__EF_8h.html">Tetra_EF.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Zone__EF_8h.html">Zone_EF.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Champ__P1__EF_8h.html">Champ_P1_EF.h</a>&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="Tetra__EF_8cpp.html#ab29749c08788e7bc7652f4ba421c4d00">00028</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classTetra__EF.html">Tetra_EF</a>,<span class="stringliteral">&quot;Tetra_EF&quot;</span>,<a class="code" href="classElem__EF__base.html">Elem_EF_base</a>);
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="comment">// printOn et readOn</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="classTetra__EF.html#aaa993d823e70cc88f88ba22faa2cbad7">00033</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classTetra__EF.html#aaa993d823e70cc88f88ba22faa2cbad7" title="Ecriture de l&#39;objet sur un flot de sortie Methode a surcharger.">Tetra_EF::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00034"></a>00034 <span class="keyword"></span>{
<a name="l00035"></a>00035   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00036"></a>00036 }
<a name="l00037"></a>00037 
<a name="l00038"></a><a class="code" href="classTetra__EF.html#a527559eb42a4b46c8321d89e9872ff2e">00038</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classTetra__EF.html#a527559eb42a4b46c8321d89e9872ff2e" title="Lecture d&#39;un Objet_U sur un flot d&#39;entree Methode a surcharger.">Tetra_EF::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s )
<a name="l00039"></a>00039 {
<a name="l00040"></a>00040   <span class="keywordflow">return</span> s ;
<a name="l00041"></a>00041 }
<a name="l00042"></a>00042 <span class="comment">//</span>
<a name="l00043"></a>00043 <span class="comment">//</span>
<a name="l00044"></a>00044 <span class="comment">//</span>
<a name="l00045"></a>00045 <span class="comment">//</span><span class="comment"></span>
<a name="l00046"></a>00046 <span class="comment">//! renvoie pour la facette fa7 :&lt;br&gt;pour j=0,j=1 : les numeros locaux des 2 faces qui entourent fa7&lt;br&gt;pour j=2,j=3 : les numeros locaux des sommets du tetraedre qui&lt;br&gt;appartiennent a fa7</span>
<a name="l00047"></a><a class="code" href="classTetra__EF.html#a8a7aa3f2d5fb2aaac32b36920c19dc2b">00047</a> <span class="comment"></span><a class="code" href="classTetra__EF.html#a8a7aa3f2d5fb2aaac32b36920c19dc2b" title="renvoie pour la facette fa7 : pour j=0,j=1 : les numeros locaux des 2 faces qui entourent fa7 pour j=...">Tetra_EF::Tetra_EF</a>()
<a name="l00048"></a>00048 {
<a name="l00049"></a>00049 }
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="classTetra__EF.html#acc1cd7e5bd09c5603b71b1836c2a7419">00051</a> <span class="keywordtype">void</span> <a class="code" href="classTetra__EF.html#acc1cd7e5bd09c5603b71b1836c2a7419">Tetra_EF::normale</a>(<span class="keywordtype">int</span> num_Face,<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; Face_normales,
<a name="l00052"></a>00052                        <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; Face_sommets,
<a name="l00053"></a>00053                        <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; Face_voisins,
<a name="l00054"></a>00054                        <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces,
<a name="l00055"></a>00055                        <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom)<span class="keyword"> const</span>
<a name="l00056"></a>00056 <span class="keyword"></span>{
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 <span class="comment">// Cerr &lt;&lt; &quot; num_Face &quot; &lt;&lt; num_Face &lt;&lt; finl;</span>
<a name="l00059"></a>00059   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; les_coords = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="comment">// Cerr &lt;&lt; &quot;les face sommet &quot; &lt;&lt; Face_sommets &lt;&lt; finl;</span>
<a name="l00062"></a>00062   <span class="keywordtype">double</span> x1,y1,z1,x2,y2,z2;
<a name="l00063"></a>00063   <span class="keywordtype">double</span> nx,ny,nz;
<a name="l00064"></a>00064   <span class="keywordtype">int</span> f0,no4;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066   <span class="keywordtype">int</span> n0 = Face_sommets(num_Face,0);
<a name="l00067"></a>00067   <span class="keywordtype">int</span> n1 = Face_sommets(num_Face,1);
<a name="l00068"></a>00068   <span class="keywordtype">int</span> n2 = Face_sommets(num_Face,2);
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 
<a name="l00071"></a>00071   x1 = les_coords(n0,0) - les_coords(n1,0);
<a name="l00072"></a>00072   y1 = les_coords(n0,1) - les_coords(n1,1);
<a name="l00073"></a>00073   z1 = les_coords(n0,2) - les_coords(n1,2);
<a name="l00074"></a>00074 
<a name="l00075"></a>00075   x2 = les_coords(n2,0) - les_coords(n1,0);
<a name="l00076"></a>00076   y2 = les_coords(n2,1) - les_coords(n1,1);
<a name="l00077"></a>00077   z2 = les_coords(n2,2) - les_coords(n1,2);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079   nx = (y1*z2 - y2*z1)/2;
<a name="l00080"></a>00080   ny = (-x1*z2 + x2*z1)/2;
<a name="l00081"></a>00081   nz = (x1*y2 - x2*y1)/2;
<a name="l00082"></a>00082 <span class="comment">// Cerr &lt;&lt; &quot;nx &quot; &lt;&lt; nx &lt;&lt; &quot; ny &quot; &lt;&lt; ny &lt;&lt; &quot; nz &quot; &lt;&lt; nz &lt;&lt; finl;</span>
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="comment">// Orientation de la normale de elem1 vers elem2</span>
<a name="l00085"></a>00085 <span class="comment">// pour cela recherche du sommet de elem1 qui n&#39;est pas sur la Face</span>
<a name="l00086"></a>00086   <span class="keywordtype">int</span> elem1 = Face_voisins(num_Face,0);
<a name="l00087"></a>00087   <span class="keywordflow">if</span> ( (f0 = elem_faces(elem1,0)) == num_Face )
<a name="l00088"></a>00088     f0 = elem_faces(elem1,1);
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   <span class="keywordflow">if</span> ( (no4 = Face_sommets(f0,0)) != n0    &amp;&amp;   no4 != n1
<a name="l00091"></a>00091        &amp;&amp;   no4 != n2)
<a name="l00092"></a>00092     ;
<a name="l00093"></a>00093   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (no4 = Face_sommets(f0,1)) != n0 &amp;&amp; no4 != n1
<a name="l00094"></a>00094             &amp;&amp; no4 != n2 )
<a name="l00095"></a>00095     ;
<a name="l00096"></a>00096   <span class="keywordflow">else</span>
<a name="l00097"></a>00097     no4 = Face_sommets(f0,2);
<a name="l00098"></a>00098 
<a name="l00099"></a>00099   x1 = les_coords(no4,0) - les_coords(n0,0);
<a name="l00100"></a>00100   y1 = les_coords(no4,1) - les_coords(n0,1);
<a name="l00101"></a>00101   z1 = les_coords(no4,2) - les_coords(n0,2);
<a name="l00102"></a>00102 
<a name="l00103"></a>00103   <span class="keywordflow">if</span> ( (nx*x1+ny*y1+nz*z1) &gt; 0 )
<a name="l00104"></a>00104     {
<a name="l00105"></a>00105       Face_normales(num_Face,0) = - nx;
<a name="l00106"></a>00106       Face_normales(num_Face,1) = - ny;
<a name="l00107"></a>00107       Face_normales(num_Face,2) = - nz;
<a name="l00108"></a>00108     }
<a name="l00109"></a>00109   <span class="keywordflow">else</span>
<a name="l00110"></a>00110     {
<a name="l00111"></a>00111       Face_normales(num_Face,0) = nx;
<a name="l00112"></a>00112       Face_normales(num_Face,1) = ny;
<a name="l00113"></a>00113       Face_normales(num_Face,2) = nz;
<a name="l00114"></a>00114     }
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 <span class="comment">// Cerr &lt;&lt; &quot;Face_normales &quot; &lt;&lt; Face_normales &lt;&lt; finl;</span>
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 }
<a name="l00119"></a>00119 
<a name="l00120"></a><a class="code" href="classTetra__EF.html#a0df06c8ecb16c445cb26223f03fb743f">00120</a> <span class="keywordtype">void</span> <a class="code" href="classTetra__EF.html#a0df06c8ecb16c445cb26223f03fb743f">Tetra_EF::calcul_vc</a>(<span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; Face,<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; vc,
<a name="l00121"></a>00121                          <span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; vs,<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vsom,
<a name="l00122"></a>00122                          <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; vitesse,<span class="keywordtype">int</span> type_cl)<span class="keyword"> const</span>
<a name="l00123"></a>00123 <span class="keyword"></span>{
<a name="l00124"></a>00124   <span class="keywordtype">int</span> comp;
<a name="l00125"></a>00125   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,vitesse.<a class="code" href="classChamp__base.html#a298ee24f3efdf2f60f39a13966a20bcd">zone_dis_base</a>());
<a name="l00126"></a>00126   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_face = zone_EF.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>();
<a name="l00127"></a>00127   <span class="keywordflow">switch</span>(type_cl)
<a name="l00128"></a>00128     {
<a name="l00129"></a>00129 
<a name="l00130"></a>00130     <span class="keywordflow">case</span> 0: <span class="comment">//!&lt; le tetraedre n&#39;a pas de Face de Dirichlet</span>
<a name="l00131"></a>00131 <span class="comment"></span>      {
<a name="l00132"></a>00132         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00133"></a>00133           vc[comp] = 0.25*vs[comp];
<a name="l00134"></a>00134         <span class="keywordflow">break</span>;
<a name="l00135"></a>00135       }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137     <span class="keywordflow">case</span> 1: <span class="comment">//!&lt; le tetraedre a une Face de Dirichlet : KEL3</span>
<a name="l00138"></a>00138 <span class="comment"></span>      {
<a name="l00139"></a>00139         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00140"></a>00140           vc[comp] = vitesse(Face[3],comp)*porosite_face(Face[3]);
<a name="l00141"></a>00141         <span class="keywordflow">break</span>;
<a name="l00142"></a>00142       }
<a name="l00143"></a>00143 
<a name="l00144"></a>00144     <span class="keywordflow">case</span> 2: <span class="comment">//!&lt; le tetraedre a une Face de Dirichlet : KEL2</span>
<a name="l00145"></a>00145 <span class="comment"></span>      {
<a name="l00146"></a>00146         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00147"></a>00147           vc[comp] = vitesse(Face[2],comp)*porosite_face(Face[2]);
<a name="l00148"></a>00148         <span class="keywordflow">break</span>;
<a name="l00149"></a>00149       }
<a name="l00150"></a>00150 
<a name="l00151"></a>00151     <span class="keywordflow">case</span> 4: <span class="comment">//!&lt; le tetraedre a une Face de Dirichlet : KEL1</span>
<a name="l00152"></a>00152 <span class="comment"></span>      {
<a name="l00153"></a>00153         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00154"></a>00154           vc[comp] = vitesse(Face[1],comp)*porosite_face(Face[1]);
<a name="l00155"></a>00155         <span class="keywordflow">break</span>;
<a name="l00156"></a>00156       }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158     <span class="keywordflow">case</span> 8: <span class="comment">//!&lt; le tetraedre a une Face de Dirichlet : KEL0</span>
<a name="l00159"></a>00159 <span class="comment"></span>      {
<a name="l00160"></a>00160         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00161"></a>00161           vc[comp] = vitesse(Face[0],comp)*porosite_face(Face[0]);
<a name="l00162"></a>00162         <span class="keywordflow">break</span>;
<a name="l00163"></a>00163       }
<a name="l00164"></a>00164 
<a name="l00165"></a>00165     <span class="keywordflow">case</span> 3: <span class="comment">//!&lt; le tetraedre a deux faces de Dirichlet : KEL3 et KEL2</span>
<a name="l00166"></a>00166 <span class="comment"></span>      {
<a name="l00167"></a>00167         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00168"></a>00168           vc[comp] = 0.5* (vsom(0,comp) + vsom(1,comp));
<a name="l00169"></a>00169         <span class="keywordflow">break</span>;
<a name="l00170"></a>00170       }
<a name="l00171"></a>00171 
<a name="l00172"></a>00172     <span class="keywordflow">case</span> 5: <span class="comment">//!&lt; le tetraedre a deux faces de Dirichlet : KEL3 et KEL1</span>
<a name="l00173"></a>00173 <span class="comment"></span>      {
<a name="l00174"></a>00174         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00175"></a>00175           vc[comp] = 0.5* (vsom(0,comp) + vsom(2,comp));
<a name="l00176"></a>00176         <span class="keywordflow">break</span>;
<a name="l00177"></a>00177       }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179     <span class="keywordflow">case</span> 6: <span class="comment">//!&lt; le tetraedre a deux faces de Dirichlet : KEL1 et KEL2</span>
<a name="l00180"></a>00180 <span class="comment"></span>      {
<a name="l00181"></a>00181         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00182"></a>00182           vc[comp] = 0.5* (vsom(0,comp) + vsom(3,comp));
<a name="l00183"></a>00183         <span class="keywordflow">break</span>;
<a name="l00184"></a>00184       }
<a name="l00185"></a>00185 
<a name="l00186"></a>00186     <span class="keywordflow">case</span> 9: <span class="comment">//!&lt; le tetraedre a deux faces de Dirichlet : KEL0 et KEL3</span>
<a name="l00187"></a>00187 <span class="comment"></span>      {
<a name="l00188"></a>00188         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00189"></a>00189           vc[comp] = 0.5* (vsom(1,comp) + vsom(2,comp));
<a name="l00190"></a>00190         <span class="keywordflow">break</span>;
<a name="l00191"></a>00191       }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193     <span class="keywordflow">case</span> 10: <span class="comment">//!&lt; le tetraedre a deux faces de Dirichlet : KEL0 et KEL2</span>
<a name="l00194"></a>00194 <span class="comment"></span>      {
<a name="l00195"></a>00195         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00196"></a>00196           vc[comp] = 0.5* (vsom(1,comp) + vsom(3,comp));
<a name="l00197"></a>00197         <span class="keywordflow">break</span>;
<a name="l00198"></a>00198       }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <span class="keywordflow">case</span> 12: <span class="comment">//!&lt; le tetraedre a deux faces de Dirichlet : KEL0 et KEL1</span>
<a name="l00201"></a>00201 <span class="comment"></span>      {
<a name="l00202"></a>00202         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00203"></a>00203           vc[comp] = 0.5*(vsom(2,comp) + vsom(3,comp));
<a name="l00204"></a>00204         <span class="keywordflow">break</span>;
<a name="l00205"></a>00205       }
<a name="l00206"></a>00206 
<a name="l00207"></a>00207     <span class="keywordflow">case</span> 7: <span class="comment">//!&lt; le tetraedre a trois faces de Dirichlet : KEL1, KEL2 et KEL3</span>
<a name="l00208"></a>00208 <span class="comment"></span>      {
<a name="l00209"></a>00209         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00210"></a>00210           vc[comp] = vsom(0,comp);
<a name="l00211"></a>00211         <span class="keywordflow">break</span>;
<a name="l00212"></a>00212       }
<a name="l00213"></a>00213 
<a name="l00214"></a>00214     <span class="keywordflow">case</span> 11: <span class="comment">//!&lt; le tetraedre a trois faces de Dirichlet : KEL0,KEL2 et KEL3</span>
<a name="l00215"></a>00215 <span class="comment"></span>      {
<a name="l00216"></a>00216         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00217"></a>00217           vc[comp] = vsom(1,comp);
<a name="l00218"></a>00218         <span class="keywordflow">break</span>;
<a name="l00219"></a>00219       }
<a name="l00220"></a>00220 
<a name="l00221"></a>00221     <span class="keywordflow">case</span> 13: <span class="comment">//!&lt; le tetraedre a trois faces de Dirichlet : KEL0, KEL1 et KEL3</span>
<a name="l00222"></a>00222 <span class="comment"></span>      {
<a name="l00223"></a>00223         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00224"></a>00224           vc[comp] = vsom(2,comp);
<a name="l00225"></a>00225         <span class="keywordflow">break</span>;
<a name="l00226"></a>00226       }
<a name="l00227"></a>00227 
<a name="l00228"></a>00228     <span class="keywordflow">case</span> 14: <span class="comment">//!&lt; le tetraedre a trois faces de Dirichlet : KEL0, KEL1 et KEL2</span>
<a name="l00229"></a>00229 <span class="comment"></span>      {
<a name="l00230"></a>00230         <span class="keywordflow">for</span> (comp=0; comp&lt;3; comp++)
<a name="l00231"></a>00231           vc[comp] = vsom(3,comp);
<a name="l00232"></a>00232         <span class="keywordflow">break</span>;
<a name="l00233"></a>00233       }
<a name="l00234"></a>00234 
<a name="l00235"></a>00235     } <span class="comment">//!&lt; fin du switch</span>
<a name="l00236"></a>00236 <span class="comment"></span>}
<a name="l00237"></a>00237 
<a name="l00238"></a>00238 <span class="comment">//</span>
<a name="l00239"></a>00239 <span class="comment">//</span><span class="comment"></span>
<a name="l00240"></a>00240 <span class="comment">//! calcule les coord xg du centre d&#39;un element non standard&lt;br&gt;calcule aussi idirichlet=nb de faces de Dirichlet de l&#39;element</span>
<a name="l00241"></a><a class="code" href="classTetra__EF.html#a388509ddc0faa966e633bd2a702b8e85">00241</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTetra__EF.html#a388509ddc0faa966e633bd2a702b8e85" title="calcule les coord xg du centre d&#39;un element non standard calcule aussi idirichlet=nb de faces de Diri...">Tetra_EF::calcul_xg</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; xg,<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; x, <span class="keyword">const</span> <span class="keywordtype">int</span> type_elem_Cl,
<a name="l00242"></a>00242                          <span class="keywordtype">int</span>&amp; idirichlet,<span class="keywordtype">int</span>&amp; n1,<span class="keywordtype">int</span>&amp; n2,<span class="keywordtype">int</span>&amp; n3)<span class="keyword"> const</span>
<a name="l00243"></a>00243 <span class="keyword"></span>{
<a name="l00244"></a>00244   <span class="keywordtype">int</span> j,dim=xg.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l00245"></a>00245 
<a name="l00246"></a>00246   <span class="keywordflow">switch</span>(type_elem_Cl)
<a name="l00247"></a>00247     {
<a name="l00248"></a>00248 
<a name="l00249"></a>00249     <span class="keywordflow">case</span> 0:  <span class="comment">//!&lt; le tetraedre n&#39;a pas de Face de Dirichlet. Il a 6 Facettes</span>
<a name="l00250"></a>00250 <span class="comment"></span>      {
<a name="l00251"></a>00251         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00252"></a>00252           xg[j]=0.25*(x(0,j)+x(1,j)+x(2,j)+x(3,j));
<a name="l00253"></a>00253 
<a name="l00254"></a>00254         idirichlet=0;
<a name="l00255"></a>00255         <span class="keywordflow">break</span>;
<a name="l00256"></a>00256       }
<a name="l00257"></a>00257 
<a name="l00258"></a>00258     <span class="keywordflow">case</span> 1:  <span class="comment">//!&lt; le tetraedre a une Face de Dirichlet.  Le &#39;centre&#39; du tetraedre est au milieu de la Face 3 qui a pour sommets 0, 1, 2 Il a 3 Facettes reelles : 0   aux noeuds 2 3 xg                           1   aux noeuds 1 3 xg                           3   aux noeuds 3 0 xg les 3 autres Facettes sont sur la Face 3</span>
<a name="l00259"></a>00259 <span class="comment"></span><span class="comment">//</span>
<a name="l00260"></a>00260 <span class="comment">//</span>
<a name="l00261"></a>00261 <span class="comment">//</span>
<a name="l00262"></a>00262 <span class="comment">//</span>
<a name="l00263"></a>00263 <span class="comment">//</span>
<a name="l00264"></a>00264 <span class="comment">//</span>
<a name="l00265"></a>00265 
<a name="l00266"></a>00266       {
<a name="l00267"></a>00267         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00268"></a>00268           xg[j]=(x(0,j)+x(1,j)+x(2,j))/3.;
<a name="l00269"></a>00269 
<a name="l00270"></a>00270         idirichlet=1;
<a name="l00271"></a>00271         <span class="keywordflow">break</span>;
<a name="l00272"></a>00272 
<a name="l00273"></a>00273       }
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     <span class="keywordflow">case</span> 2:  <span class="comment">//!&lt; le tetraedre a une Face de Dirichlet.  Le &#39;centre&#39; du tetraedre est au milieu de la Face 2 qui a pour sommets 0, 1, 3 Il a 3 Facettes reelles : 0   aux noeuds 2 3 xg                           2   aux noeuds 1 2 xg                           4   aux noeuds 2 0 xg</span>
<a name="l00276"></a>00276 <span class="comment"></span><span class="comment">//</span>
<a name="l00277"></a>00277 <span class="comment">//</span>
<a name="l00278"></a>00278 <span class="comment">//</span>
<a name="l00279"></a>00279 <span class="comment">//</span>
<a name="l00280"></a>00280 <span class="comment">//</span>
<a name="l00281"></a>00281 
<a name="l00282"></a>00282       {
<a name="l00283"></a>00283         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00284"></a>00284           xg[j]=(x(0,j)+x(1,j)+x(3,j))/3.;
<a name="l00285"></a>00285 
<a name="l00286"></a>00286         idirichlet=1;
<a name="l00287"></a>00287         <span class="keywordflow">break</span>;
<a name="l00288"></a>00288       }
<a name="l00289"></a>00289 
<a name="l00290"></a>00290     <span class="keywordflow">case</span> 4:  <span class="comment">//!&lt; le tetraedre a une Face de Dirichlet.  Le &#39;centre&#39; du tetraedre est au milieu de la Face 1 qui a pour sommets 0, 2, 3 Il a 3 Facettes reelles : 1   aux noeuds 1 3 xg                           2   aux noeuds 1 2 xg                           5   aux noeuds 1 0 xg</span>
<a name="l00291"></a>00291 <span class="comment"></span><span class="comment">//</span>
<a name="l00292"></a>00292 <span class="comment">//</span>
<a name="l00293"></a>00293 <span class="comment">//</span>
<a name="l00294"></a>00294 <span class="comment">//</span>
<a name="l00295"></a>00295 <span class="comment">//</span>
<a name="l00296"></a>00296 
<a name="l00297"></a>00297       {
<a name="l00298"></a>00298         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00299"></a>00299           xg[j]=(x(0,j)+x(2,j)+x(3,j))/3.;
<a name="l00300"></a>00300 
<a name="l00301"></a>00301         idirichlet=1;
<a name="l00302"></a>00302         <span class="keywordflow">break</span>;
<a name="l00303"></a>00303       }
<a name="l00304"></a>00304 
<a name="l00305"></a>00305     <span class="keywordflow">case</span> 8:  <span class="comment">//!&lt; le tetraedre a une Face de Dirichlet.  Le &#39;centre&#39; du tetraedre est au milieu de la Face 0 qui a pour sommets 1, 2, 3 Il a 3 Facettes reelles : 3   aux noeuds 3 0 xg                           4   aux noeuds 2 0 xg                           5   aux noeuds 1 0 xg</span>
<a name="l00306"></a>00306 <span class="comment"></span><span class="comment">//</span>
<a name="l00307"></a>00307 <span class="comment">//</span>
<a name="l00308"></a>00308 <span class="comment">//</span>
<a name="l00309"></a>00309 <span class="comment">//</span>
<a name="l00310"></a>00310 <span class="comment">//</span>
<a name="l00311"></a>00311 
<a name="l00312"></a>00312       {
<a name="l00313"></a>00313         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00314"></a>00314           xg[j]=(x(1,j)+x(2,j)+x(3,j))/3.;
<a name="l00315"></a>00315 
<a name="l00316"></a>00316         idirichlet=1;
<a name="l00317"></a>00317         <span class="keywordflow">break</span>;
<a name="l00318"></a>00318       }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320     <span class="keywordflow">case</span> 3:  <span class="comment">//!&lt; le tetraedre a deux faces de Dirichlet 2 et 3. Le &#39;centre&#39; du tetraedre est au milieu de l&#39;arete qui a pour extremites 0, 1. Il a 1 Facette nulle: 5</span>
<a name="l00321"></a>00321 <span class="comment"></span><span class="comment">//</span>
<a name="l00322"></a>00322 <span class="comment">//</span>
<a name="l00323"></a>00323 
<a name="l00324"></a>00324       {
<a name="l00325"></a>00325         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00326"></a>00326           xg[j]= 0.5*(x(0,j)+x(1,j));
<a name="l00327"></a>00327 
<a name="l00328"></a>00328         n1=5;
<a name="l00329"></a>00329         idirichlet=2;
<a name="l00330"></a>00330         <span class="keywordflow">break</span>;
<a name="l00331"></a>00331       }
<a name="l00332"></a>00332 
<a name="l00333"></a>00333 
<a name="l00334"></a>00334     <span class="keywordflow">case</span> 5:  <span class="comment">//!&lt; le tetraedre a deux faces de Dirichlet 3 et 1. Le &#39;centre&#39; du tetraedre est au milieu de l&#39;arete qui a pour extremites 0, 2. Il a 1 Facette  nulle  : 4</span>
<a name="l00335"></a>00335 <span class="comment"></span><span class="comment">//</span>
<a name="l00336"></a>00336 <span class="comment">//</span>
<a name="l00337"></a>00337 
<a name="l00338"></a>00338       {
<a name="l00339"></a>00339         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00340"></a>00340           xg[j]= 0.5*(x(0,j)+x(2,j));
<a name="l00341"></a>00341 
<a name="l00342"></a>00342         n1=4;
<a name="l00343"></a>00343         idirichlet=2;
<a name="l00344"></a>00344         <span class="keywordflow">break</span>;
<a name="l00345"></a>00345       }
<a name="l00346"></a>00346 
<a name="l00347"></a>00347     <span class="keywordflow">case</span> 6:  <span class="comment">//!&lt; le tetraedre a deux faces de Dirichlet 1 et 2. Le &#39;centre&#39; du tetraedre est au milieu de l&#39;arete qui a pour extremites 0, 3. Il a 1 Facette  nulle: 3</span>
<a name="l00348"></a>00348 <span class="comment"></span><span class="comment">//</span>
<a name="l00349"></a>00349 <span class="comment">//</span>
<a name="l00350"></a>00350 
<a name="l00351"></a>00351       {
<a name="l00352"></a>00352         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00353"></a>00353           xg[j]= 0.5*(x(0,j)+x(3,j));
<a name="l00354"></a>00354 
<a name="l00355"></a>00355         n1=3;
<a name="l00356"></a>00356         idirichlet=2;
<a name="l00357"></a>00357         <span class="keywordflow">break</span>;
<a name="l00358"></a>00358       }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360     <span class="keywordflow">case</span> 9:  <span class="comment">//!&lt; le tetraedre a deux faces de Dirichlet 0 et 3. Le &#39;centre&#39; du tetraedre est au milieu de l&#39;arete qui a pour extremites 1, 2 Il a 1 Facette  nulle: 2</span>
<a name="l00361"></a>00361 <span class="comment"></span><span class="comment">//</span>
<a name="l00362"></a>00362 <span class="comment">//</span>
<a name="l00363"></a>00363 
<a name="l00364"></a>00364       {
<a name="l00365"></a>00365         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00366"></a>00366           xg[j]= 0.5*(x(1,j)+x(2,j));
<a name="l00367"></a>00367 
<a name="l00368"></a>00368         n1=2;
<a name="l00369"></a>00369         idirichlet=2;
<a name="l00370"></a>00370         <span class="keywordflow">break</span>;
<a name="l00371"></a>00371       }
<a name="l00372"></a>00372 
<a name="l00373"></a>00373     <span class="keywordflow">case</span> 10:  <span class="comment">//!&lt; le tetraedre a deux faces de Dirichlet 0 et 2. Le &#39;centre&#39; du tetraedre est au milieu de l&#39;arete qui a pour extremites 1, 3. Il a 1 Facette  nulle: 1</span>
<a name="l00374"></a>00374 <span class="comment"></span><span class="comment">//</span>
<a name="l00375"></a>00375 <span class="comment">//</span>
<a name="l00376"></a>00376 
<a name="l00377"></a>00377       {
<a name="l00378"></a>00378         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00379"></a>00379           xg[j]= 0.5*(x(1,j)+x(3,j));
<a name="l00380"></a>00380 
<a name="l00381"></a>00381         n1=1;
<a name="l00382"></a>00382         idirichlet=2;
<a name="l00383"></a>00383         <span class="keywordflow">break</span>;
<a name="l00384"></a>00384       }
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 
<a name="l00387"></a>00387     <span class="keywordflow">case</span> 12:  <span class="comment">//!&lt; le tetraedre a deux faces de Dirichlet 0 et 1. Le &#39;centre&#39; du tetraedre est au milieu de l&#39;arete qui a pour sommets 2, 3. Il a 1 Facette  nulle</span>
<a name="l00388"></a>00388 <span class="comment"></span><span class="comment">//</span>
<a name="l00389"></a>00389 <span class="comment">//</span>
<a name="l00390"></a>00390 
<a name="l00391"></a>00391       {
<a name="l00392"></a>00392         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00393"></a>00393           xg[j]= 0.5*(x(2,j)+x(3,j));
<a name="l00394"></a>00394 
<a name="l00395"></a>00395         n1=0;
<a name="l00396"></a>00396         idirichlet=2;
<a name="l00397"></a>00397         <span class="keywordflow">break</span>;
<a name="l00398"></a>00398       }
<a name="l00399"></a>00399 
<a name="l00400"></a>00400     <span class="keywordflow">case</span> 7:  <span class="comment">//!&lt; trois faces de Dirichlet : 1,2,3. Le centre est au sommet 0 il y 3 Facettes nulles: 3,4,5</span>
<a name="l00401"></a>00401 <span class="comment"></span><span class="comment">//</span>
<a name="l00402"></a>00402 
<a name="l00403"></a>00403       {
<a name="l00404"></a>00404         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00405"></a>00405           xg[j]= x(0,j);
<a name="l00406"></a>00406 
<a name="l00407"></a>00407         n1=3;
<a name="l00408"></a>00408         n2=4;
<a name="l00409"></a>00409         n3=5;
<a name="l00410"></a>00410         idirichlet=3;
<a name="l00411"></a>00411         <span class="keywordflow">break</span>;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413       }
<a name="l00414"></a>00414 
<a name="l00415"></a>00415     <span class="keywordflow">case</span> 11:  <span class="comment">//!&lt; trois faces de Dirichlet : 0,2,3. Le centre est au sommet 1 il y 3 Facettes nulles: 1, 2, 5</span>
<a name="l00416"></a>00416 <span class="comment"></span><span class="comment">//</span>
<a name="l00417"></a>00417 
<a name="l00418"></a>00418       {
<a name="l00419"></a>00419         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00420"></a>00420           xg[j]= x(1,j);
<a name="l00421"></a>00421 
<a name="l00422"></a>00422         n1=1;
<a name="l00423"></a>00423         n2=2;
<a name="l00424"></a>00424         n3=5;
<a name="l00425"></a>00425         idirichlet=3;
<a name="l00426"></a>00426         <span class="keywordflow">break</span>;
<a name="l00427"></a>00427 
<a name="l00428"></a>00428       }
<a name="l00429"></a>00429 
<a name="l00430"></a>00430     <span class="keywordflow">case</span> 13:  <span class="comment">//!&lt; trois faces de Dirichlet : 0,1,3. Le centre est au sommet 2 il y 3 Facettes nulles: 0, 2, 4</span>
<a name="l00431"></a>00431 <span class="comment"></span><span class="comment">//</span>
<a name="l00432"></a>00432 
<a name="l00433"></a>00433       {
<a name="l00434"></a>00434         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00435"></a>00435           xg[j]= x(2,j);
<a name="l00436"></a>00436 
<a name="l00437"></a>00437         n1=0;
<a name="l00438"></a>00438         n2=2;
<a name="l00439"></a>00439         n3=4;
<a name="l00440"></a>00440         idirichlet=3;
<a name="l00441"></a>00441         <span class="keywordflow">break</span>;
<a name="l00442"></a>00442 
<a name="l00443"></a>00443       }
<a name="l00444"></a>00444     <span class="keywordflow">case</span> 14:  <span class="comment">//!&lt; trois faces de Dirichlet : 0,1,2. Le centre est au sommet 3 il y 3 Facettes nulles: 0, 1, 3</span>
<a name="l00445"></a>00445 <span class="comment"></span><span class="comment">//</span>
<a name="l00446"></a>00446 
<a name="l00447"></a>00447       {
<a name="l00448"></a>00448         <span class="keywordflow">for</span> (j=0; j&lt;dim; j++)
<a name="l00449"></a>00449           xg[j]= x(3,j);
<a name="l00450"></a>00450 
<a name="l00451"></a>00451         n1=0;
<a name="l00452"></a>00452         n2=1;
<a name="l00453"></a>00453         n3=3;
<a name="l00454"></a>00454         idirichlet=3;
<a name="l00455"></a>00455         <span class="keywordflow">break</span>;
<a name="l00456"></a>00456 
<a name="l00457"></a>00457       }
<a name="l00458"></a>00458     }
<a name="l00459"></a>00459 }
<a name="l00460"></a>00460 
<a name="l00461"></a>00461 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:11 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
