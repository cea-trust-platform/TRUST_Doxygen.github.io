<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VDF/Sources/Terme_Source_inc_VDF_Face.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VDF/Sources/Terme_Source_inc_VDF_Face.cpp</div>  </div>
</div>
<div class="contents">
<a href="Terme__Source__inc__VDF__Face_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Terme_Source_inc_VDF_Face.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VDF/Sources</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/19</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Terme__Source__inc__VDF__Face_8h.html">Terme_Source_inc_VDF_Face.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VDF_8h.html">Zone_VDF.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__VDF_8h.html">Zone_Cl_VDF.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Neumann__sortie__libre_8h.html">Neumann_sortie_libre.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Symetrie_8h.html">Symetrie.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet_8h.html">Dirichlet.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__homogene_8h.html">Dirichlet_homogene.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Periodique_8h.html">Periodique.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Pb__Fluide__base_8h.html">Pb_Fluide_base.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Navier__Stokes__std_8h.html">Navier_Stokes_std.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="DoubleTrav_8h.html">DoubleTrav.h</a>&gt;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="Terme__Source__inc__VDF__Face_8cpp.html#a59ddb9d7c1a886067809d89945ab2933">00036</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classTerme__Source__inc__VDF__Face.html">Terme_Source_inc_VDF_Face</a>,<span class="stringliteral">&quot;inc_VDF_Face&quot;</span>,<a class="code" href="classSource__base.html" title="classe Source_base Un objet Source_base est un terme apparaissant au second membre d&#39;une equation...">Source_base</a>);
<a name="l00037"></a>00037 <span class="comment"></span>
<a name="l00038"></a>00038 <span class="comment">////!&lt; printOn </span>
<a name="l00039"></a>00039 <span class="comment"></span><span class="comment">//</span>
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="classTerme__Source__inc__VDF__Face.html#ae6f78c1d465aff9f4932fd190d1c59af">00041</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classTerme__Source__inc__VDF__Face.html#ae6f78c1d465aff9f4932fd190d1c59af" title="NE FAIT RIEN A surcharger dans les classes derivees. Imprime la source sur un flot de sortie...">Terme_Source_inc_VDF_Face::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00042"></a>00042 <span class="keyword"></span>{
<a name="l00043"></a>00043   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() ;
<a name="l00044"></a>00044 }
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="comment"></span>
<a name="l00047"></a>00047 <span class="comment">////!&lt; readOn </span>
<a name="l00048"></a>00048 <span class="comment"></span><span class="comment">//</span>
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="classTerme__Source__inc__VDF__Face.html#ada6a97bb98b963c4d39c5b1624fa495c">00050</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classTerme__Source__inc__VDF__Face.html#ada6a97bb98b963c4d39c5b1624fa495c" title="NE FAIT RIEN A surcharger dans les classes derivees. Lecture d&#39;un terme source sur un flot d&#39;entree...">Terme_Source_inc_VDF_Face::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s )
<a name="l00051"></a>00051 {
<a name="l00052"></a>00052   <span class="keywordflow">return</span> <a class="code" href="classTerme__Source__inc.html#a33742154b920caf0286910dc0be8743e">Terme_Source_inc::lire_donnees</a>(s);
<a name="l00053"></a>00053 }
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="classTerme__Source__inc__VDF__Face.html#a8544add85a03f123ff324f98610707c4">00055</a> <span class="keywordtype">void</span> <a class="code" href="classTerme__Source__inc__VDF__Face.html#a8544add85a03f123ff324f98610707c4">Terme_Source_inc_VDF_Face::associer_pb</a>(<span class="keyword">const</span> <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb)
<a name="l00056"></a>00056 {
<a name="l00057"></a>00057   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPb__Fluide__base.html" title="classe Pb_Fluide_base Cette classe a pour but de disposer d une classe amont pour la hierarchie des p...">Pb_Fluide_base</a>,pb))
<a name="l00058"></a>00058     {
<a name="l00059"></a>00059       <span class="keyword">const</span> <a class="code" href="classNavier__Stokes__std.html" title="classe Navier_Stokes_std Cette classe porte les termes de l&#39;equation de la dynamique pour un fluide s...">Navier_Stokes_std</a>&amp; eqn_th = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classNavier__Stokes__std.html" title="classe Navier_Stokes_std Cette classe porte les termes de l&#39;equation de la dynamique pour un fluide s...">Navier_Stokes_std</a>,pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(0));
<a name="l00060"></a>00060       <a class="code" href="classTerme__Source__inc.html#ade4a3591120fee9fcfea233eacd42108">Terme_Source_inc::associer_eqn</a>(eqn_th);
<a name="l00061"></a>00061     }
<a name="l00062"></a>00062   <span class="keywordflow">else</span>
<a name="l00063"></a>00063     {
<a name="l00064"></a>00064       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error for the method  Terme_Source_inc_VDF_Face::associer_pb&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00065"></a>00065       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The source term &quot;</span>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot; cannot be activated for the problem &quot;</span>&lt;&lt;pb.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt; finl;
<a name="l00066"></a>00066       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00067"></a>00067     }
<a name="l00068"></a>00068 }
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="classTerme__Source__inc__VDF__Face.html#a4a6bb3d41bee0cb1082d8882684fc7a1">00070</a> <span class="keywordtype">void</span> <a class="code" href="classTerme__Source__inc__VDF__Face.html#a4a6bb3d41bee0cb1082d8882684fc7a1">Terme_Source_inc_VDF_Face::associer_zones</a>(<span class="keyword">const</span> <a class="code" href="classZone__dis.html" title="classe Zone_dis Classe generique de la hierarchie des zones discretisees. Un objet de type Zone_dis p...">Zone_dis</a>&amp; zone_dis,
<a name="l00071"></a>00071                                                <span class="keyword">const</span> <a class="code" href="classZone__Cl__dis.html" title="classe Zone_Cl_dis Classe generique de la hierarchie des conditions aux limites discretisees. Un objet Zone_Cl_dis peut referencer n&#39;importe quel derivant de Zone_Cl_dis_base. La plupart des methodes appellent les methodes de l&#39;objet Probleme sous-jacent via la methode valeur() declaree grace a la macro Declare_deriv().;">Zone_Cl_dis</a>&amp; zone_Cl_dis)
<a name="l00072"></a>00072 {
<a name="l00073"></a>00073   <a class="code" href="classTerme__Source__inc__VDF__Face.html#a0b32ebe91a6fe89761e30e5d941aa687">la_zone_VDF</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>, zone_dis.<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>());
<a name="l00074"></a>00074   <a class="code" href="classTerme__Source__inc__VDF__Face.html#a10ad5b0de407f7990b36b5e07cedfe42">la_zone_Cl_VDF</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>, zone_Cl_dis.<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00075"></a>00075 }
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="comment">// void Terme_Source_inc_VDF_Face::mettre_a_jour(double temps)</span>
<a name="l00078"></a>00078 <span class="comment">// //void Turbulence_hyd_sous_maille_inc_VDF::mettre_a_jour(double )</span>
<a name="l00079"></a>00079 <span class="comment">// {</span>
<a name="l00080"></a>00080 <span class="comment">// int nb_elem_tot = la_zone_VDF-&gt;zone().nb_elem_tot();</span>
<a name="l00081"></a>00081 <span class="comment">// DoubleTrav cell_cent_vel(nb_elem_tot,dimension);</span>
<a name="l00082"></a>00082 <span class="comment">// calculer_cell_cent_vel(cell_cent_vel);</span>
<a name="l00083"></a>00083 <span class="comment">// }</span>
<a name="l00084"></a>00084 
<a name="l00085"></a><a class="code" href="classTerme__Source__inc__VDF__Face.html#a9a2b18fec2172febc2580eb3347c11b9">00085</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classTerme__Source__inc__VDF__Face.html#a9a2b18fec2172febc2580eb3347c11b9">Terme_Source_inc_VDF_Face::ajouter</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00086"></a>00086 <span class="keyword"></span>{
<a name="l00087"></a>00087   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF = <a class="code" href="classTerme__Source__inc__VDF__Face.html#a0b32ebe91a6fe89761e30e5d941aa687">la_zone_VDF</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00088"></a>00088   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; zone_Cl_VDF = <a class="code" href="classTerme__Source__inc__VDF__Face.html#a10ad5b0de407f7990b36b5e07cedfe42">la_zone_Cl_VDF</a>.<a class="code" href="classRef__Zone__Cl__VDF.html#a1e655604e840cda5b393e45f975b73ff">valeur</a>();
<a name="l00089"></a>00089   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VDF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00090"></a>00090   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; orientation = zone_VDF.<a class="code" href="classZone__VDF.html#a9a9bd747218e463b3408a3590c12814c" title="inline DoubleVect&amp; Zone_VDF::porosite_face() { return porosite_face_; }">orientation</a>();
<a name="l00091"></a>00091 <span class="comment">// const DoubleTab&amp; xv = zone_VDF.xv();</span>
<a name="l00092"></a>00092   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_surf = zone_VDF.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>();
<a name="l00093"></a>00093   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_entrelaces = zone_VDF.<a class="code" href="classZone__VF.html#a64f0b549e5aea1656855113e3510f418">volumes_entrelaces</a>();
<a name="l00094"></a>00094   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = <a class="code" href="classTerme__Source__inc__VDF__Face.html#a0b32ebe91a6fe89761e30e5d941aa687">la_zone_VDF</a>-&gt;zone();
<a name="l00095"></a>00095   <span class="keywordtype">int</span> nb_elem = zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>();
<a name="l00096"></a>00096 
<a name="l00097"></a>00097   <span class="keywordtype">int</span> ndeb,nfin,ncomp,num_face;
<a name="l00098"></a>00098 <span class="comment">// double debit_e=0.,dt,vol,Surf;</span>
<a name="l00099"></a>00099   <span class="keywordtype">double</span> vol;
<a name="l00100"></a>00100   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> s(3);
<a name="l00101"></a>00101   s = 0.;
<a name="l00102"></a>00102 <span class="comment">// int nb_elem_tot = la_zone_VDF-&gt;zone().nb_elem_tot();</span>
<a name="l00103"></a>00103 <span class="comment">// double dQij=0;</span>
<a name="l00104"></a>00104 <span class="comment">// double si;</span>
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 <span class="comment">// static int deb=0;</span>
<a name="l00107"></a>00107 <span class="comment">// static double source=0.;</span>
<a name="l00108"></a>00108 <span class="comment">// static double debnm1;</span>
<a name="l00109"></a>00109 <span class="comment">// static double debit_ref=0.;</span>
<a name="l00110"></a>00110 <span class="comment">// Cerr &lt;&lt; &quot; debut de inc&quot; &lt;&lt; finl;</span>
<a name="l00111"></a>00111 <span class="comment">// double tps = eq_hydraulique().inconnue().temps();</span>
<a name="l00112"></a>00112 <span class="comment">// const DoubleVect&amp; vit = eq_hydraulique().inconnue().valeurs();</span>
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="comment">// calculer_cell_cent_vel</span>
<a name="l00115"></a>00115 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00116"></a>00116 
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="comment">// Exemple XTOF</span>
<a name="l00119"></a>00119 <span class="comment">// Cerr &lt;&lt; &quot; debut de parallel &quot; &lt;&lt; finl;</span>
<a name="l00120"></a>00120   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> cell_cent_vel(0,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00121"></a>00121   <a class="code" href="classTerme__Source__inc__VDF__Face.html#a0b32ebe91a6fe89761e30e5d941aa687">la_zone_VDF</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(cell_cent_vel);
<a name="l00122"></a>00122 <span class="comment">// DoubleTrav toto(cell_cent_vel);</span>
<a name="l00123"></a>00123   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> temp1(cell_cent_vel);
<a name="l00124"></a>00124   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> temp2(cell_cent_vel);
<a name="l00125"></a>00125   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> filt_vel(cell_cent_vel);
<a name="l00126"></a>00126   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> inc_dv(cell_cent_vel);
<a name="l00127"></a>00127   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> dQij_j(cell_cent_vel);
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 
<a name="l00130"></a>00130 <span class="comment">// DoubleTrav cell_cent_vel(nb_elem_tot,dimension);</span>
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00133"></a>00133   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse = <a class="code" href="classMorEqn.html#a47b12fa29b57783a8a5897f7611e2176">mon_equation</a>-&gt;inconnue().valeurs();
<a name="l00134"></a>00134 <span class="comment">// const DoubleTab&amp; vitesse = mon_equation-&gt;inconnue().valeurs();</span>
<a name="l00135"></a>00135 <span class="comment">// const Zone_VDF&amp; zone_VDF = la_zone_VDF.valeur();</span>
<a name="l00136"></a>00136 <span class="comment">// int nb_elem_tot = zone_VDF.zone().nb_elem_tot();</span>
<a name="l00137"></a>00137   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00138"></a>00138   <span class="keywordtype">int</span> element_number;
<a name="l00139"></a>00139   <span class="keywordtype">int</span> num0=-1,num1,num2=-1,num3,num4=-1,num5=-1;
<a name="l00140"></a>00140 <span class="comment">// Cerr &lt;&lt; &quot; vitesse &quot; &lt;&lt; vitesse &lt;&lt; finl;</span>
<a name="l00141"></a>00141 <span class="comment">// This is to calculate the cell centered velocity values</span>
<a name="l00142"></a>00142 
<a name="l00143"></a>00143   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> uij_filt_1(cell_cent_vel);
<a name="l00144"></a>00144   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> uij_filt_2(cell_cent_vel);
<a name="l00145"></a>00145   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> uij_filt_3(cell_cent_vel);
<a name="l00146"></a>00146   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> uij_filt(nb_elem,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00147"></a>00147   <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00148"></a>00148     {
<a name="l00149"></a>00149 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; &quot; &lt;&lt; element_number &lt;&lt; finl;</span>
<a name="l00150"></a>00150       num0 = elem_faces(element_number,0);
<a name="l00151"></a>00151       num1 = elem_faces(element_number,1);
<a name="l00152"></a>00152       num2 = elem_faces(element_number,2);
<a name="l00153"></a>00153       num3 = elem_faces(element_number,3);
<a name="l00154"></a>00154 <span class="comment">// uij_filt(element_number,0,0)=uij_filt_1(element_number,0);</span>
<a name="l00155"></a>00155 <span class="comment">// uij_filt(element_number,1,0)=uij_filt_1(element_number,1);</span>
<a name="l00156"></a>00156 <span class="comment">// uij_filt(element_number,0,1)=uij_filt_2(element_number,0);</span>
<a name="l00157"></a>00157 <span class="comment">// uij_filt(element_number,1,1)=uij_filt_2(element_number,1);</span>
<a name="l00158"></a>00158       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00159"></a>00159         {
<a name="l00160"></a>00160 <span class="comment">// uij_filt(element_number,0,2)=uij_filt_3(element_number,0);</span>
<a name="l00161"></a>00161 <span class="comment">// uij_filt(element_number,1,2)=uij_filt_3(element_number,1);</span>
<a name="l00162"></a>00162 <span class="comment">// uij_filt(element_number,2,2)=uij_filt_3(element_number,2);</span>
<a name="l00163"></a>00163 <span class="comment">// uij_filt(element_number,2,0)=uij_filt_1(element_number,2);</span>
<a name="l00164"></a>00164 <span class="comment">// uij_filt(element_number,2,1)=uij_filt_2(element_number,2);</span>
<a name="l00165"></a>00165           num4 = elem_faces(element_number,4);
<a name="l00166"></a>00166           num5 = elem_faces(element_number,5);
<a name="l00167"></a>00167         }
<a name="l00168"></a>00168 
<a name="l00169"></a>00169       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2)
<a name="l00170"></a>00170         {
<a name="l00171"></a>00171           cell_cent_vel(element_number,0)=0.5*(vitesse[num0]+vitesse[num2]);
<a name="l00172"></a>00172           cell_cent_vel(element_number,1)=0.5*(vitesse[num1]+vitesse[num3]);
<a name="l00173"></a>00173         }
<a name="l00174"></a>00174       <span class="keywordflow">else</span>
<a name="l00175"></a>00175         {
<a name="l00176"></a>00176           cell_cent_vel(element_number,0)=0.5*(vitesse[num0]+vitesse[num3]);
<a name="l00177"></a>00177           cell_cent_vel(element_number,1)=0.5*(vitesse[num1]+vitesse[num4]);
<a name="l00178"></a>00178           cell_cent_vel(element_number,2)=0.5*(vitesse[num2]+vitesse[num5]);
<a name="l00179"></a>00179         }
<a name="l00180"></a>00180     }
<a name="l00181"></a>00181   cell_cent_vel.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="comment">// Cerr &lt;&lt; &quot; calculer_filter_field&quot; &lt;&lt; finl;</span>
<a name="l00184"></a>00184 <span class="comment">// </span>
<a name="l00185"></a>00185 <span class="comment">// calculer_filter_field(cell_cent_vel,filt_vel);</span>
<a name="l00186"></a>00186 <span class="comment">// </span>
<a name="l00187"></a>00187 <span class="comment">// calculate filter vector, unfilter tensor and</span>
<a name="l00188"></a>00188 <span class="comment">// increment fields in the same loop to speed up calculation</span>
<a name="l00189"></a>00189 <span class="comment">// </span>
<a name="l00190"></a>00190 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 <span class="comment">// DoubleTab toto(cell_cent_vel);</span>
<a name="l00193"></a>00193 
<a name="l00194"></a>00194   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Qij_1(cell_cent_vel);
<a name="l00195"></a>00195   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Qij_2(cell_cent_vel);
<a name="l00196"></a>00196   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Qij_3(cell_cent_vel);
<a name="l00197"></a>00197   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Lij_1(cell_cent_vel);
<a name="l00198"></a>00198   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Lij_2(cell_cent_vel);
<a name="l00199"></a>00199   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Lij_3(cell_cent_vel);
<a name="l00200"></a>00200   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> ttemp1_1(cell_cent_vel);
<a name="l00201"></a>00201   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> ttemp1_2(cell_cent_vel);
<a name="l00202"></a>00202   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> ttemp1_3(cell_cent_vel);
<a name="l00203"></a>00203   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> ttemp2_1(cell_cent_vel);
<a name="l00204"></a>00204   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> ttemp2_2(cell_cent_vel);
<a name="l00205"></a>00205   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> ttemp2_3(cell_cent_vel);
<a name="l00206"></a>00206 <span class="comment">// DoubleTab Qij(uij_filt);</span>
<a name="l00207"></a>00207 <span class="comment">// DoubleTab Lij(uij_filt);</span>
<a name="l00208"></a>00208 <span class="comment">// DoubleTab ttemp1(uij_filt);</span>
<a name="l00209"></a>00209 <span class="comment">// DoubleTab ttemp2(uij_filt);</span>
<a name="l00210"></a>00210 <span class="comment">// DoubleTrav filt_vel(nb_elem_tot,dimension);</span>
<a name="l00211"></a>00211 <span class="comment">// DoubleTrav inc_dv(nb_elem_tot,dimension);</span>
<a name="l00212"></a>00212 <span class="comment">// inc_dv.resize(nb_elem_tot,dimension);</span>
<a name="l00213"></a>00213 <span class="comment">// DoubleTrav uij_filt(nb_elem_tot,dimension,dimension);</span>
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00216"></a>00216 <span class="comment">// const Zone_VDF&amp; zone_VDF = la_zone_VDF.valeur();</span>
<a name="l00217"></a>00217 <span class="comment">// const IntTab&amp; face_voisins = zone_VDF.face_voisins();</span>
<a name="l00218"></a>00218 <span class="comment">// int nb_elem_tot = zone_VDF.zone().nb_elem_tot();</span>
<a name="l00219"></a>00219 <span class="comment">// const IntTab&amp; elem_faces = zone_VDF.elem_faces();</span>
<a name="l00220"></a>00220 <span class="comment">// int element_number;</span>
<a name="l00221"></a>00221 <span class="comment">// int num0,num1,num2,num3,num4,num5;</span>
<a name="l00222"></a>00222   <span class="keywordtype">int</span> f0,<a class="code" href="Lois__sodium_8h.html#a3034a1fb8c782842a2b9473c0f02a448">f1</a>,<a class="code" href="Lois__sodium_8h.html#a23f45359b08cb1d0538697b4f2d3dbbe">f2</a>,f3,f4,f5;
<a name="l00223"></a>00223   <span class="keywordtype">int</span> i;
<a name="l00224"></a>00224   <span class="keywordtype">int</span> num0_1,num1_1,num2_1,num3_1,num4_1,num5_1;
<a name="l00225"></a>00225   <span class="keywordtype">int</span> f0_1,f1_1,f2_1,f3_1,f4_1,f5_1;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 <span class="comment">// DoubleTrav temp1(nb_elem_tot,dimension);</span>
<a name="l00228"></a>00228 <span class="comment">// DoubleTrav temp2(nb_elem_tot,dimension);</span>
<a name="l00229"></a>00229 
<a name="l00230"></a>00230 <span class="comment">// This is to calculate the filtered velocity field</span>
<a name="l00231"></a>00231 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; boucle 1 &quot; &lt;&lt; finl;</span>
<a name="l00232"></a>00232   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ==2)
<a name="l00233"></a>00233     {
<a name="l00234"></a>00234       <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00235"></a>00235         {
<a name="l00236"></a>00236 <span class="comment">// for (i=0 ; i&lt;dimension ; i++)</span>
<a name="l00237"></a>00237 <span class="comment">// for (j=0 ; j&lt;dimension ; j++)</span>
<a name="l00238"></a>00238 <span class="comment">// uij_filt(element_number,i,j)=cell_cent_vel(element_number,i)*</span>
<a name="l00239"></a>00239 <span class="comment">// cell_cent_vel(element_number,j);</span>
<a name="l00240"></a>00240           <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)
<a name="l00241"></a>00241             {
<a name="l00242"></a>00242               uij_filt_1(element_number,i)=cell_cent_vel(element_number,i)*
<a name="l00243"></a>00243                                            cell_cent_vel(element_number,0);
<a name="l00244"></a>00244               uij_filt_2(element_number,i)=cell_cent_vel(element_number,i)*
<a name="l00245"></a>00245                                            cell_cent_vel(element_number,1);
<a name="l00246"></a>00246             }
<a name="l00247"></a>00247           f0 = elem_faces(element_number,0);
<a name="l00248"></a>00248           num0 = face_voisins(f0,0);
<a name="l00249"></a>00249           f2 = elem_faces(element_number,2);
<a name="l00250"></a>00250           num2 = face_voisins(f2,1);
<a name="l00251"></a>00251           <span class="keywordflow">if</span> ( (num0 == -1) || (num2 == -1) )
<a name="l00252"></a>00252             <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00253"></a>00253               {
<a name="l00254"></a>00254                 temp1(element_number,i)=cell_cent_vel(element_number,i);
<a name="l00255"></a>00255                 inc_dv(element_number,i)=0.;
<a name="l00256"></a>00256               }
<a name="l00257"></a>00257           <span class="keywordflow">else</span>
<a name="l00258"></a>00258             {
<a name="l00259"></a>00259               <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00260"></a>00260                 {
<a name="l00261"></a>00261                   temp1(element_number,i)=0.25*(cell_cent_vel(num0,i)+
<a name="l00262"></a>00262                                                 2.0*cell_cent_vel(element_number,i)+
<a name="l00263"></a>00263                                                 cell_cent_vel(num2,i));
<a name="l00264"></a>00264                 }
<a name="l00265"></a>00265               f0_1 = elem_faces(num0,0);
<a name="l00266"></a>00266               num0_1 = face_voisins(f0_1,0);
<a name="l00267"></a>00267               f2_1 = elem_faces(num2,2);
<a name="l00268"></a>00268               num2_1 = face_voisins(f2_1,1);
<a name="l00269"></a>00269               <span class="keywordflow">if</span> ( (num0_1 == -1) || (num2_1 == -1) )
<a name="l00270"></a>00270                 <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00271"></a>00271                   inc_dv(element_number,i)+=(cell_cent_vel(num0,i))-(cell_cent_vel(num2,i));
<a name="l00272"></a>00272               <span class="keywordflow">else</span>
<a name="l00273"></a>00273                 {
<a name="l00274"></a>00274                   <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00275"></a>00275                     {
<a name="l00276"></a>00276                       inc_dv(element_number,i)+=(cell_cent_vel(num0_1,i))-(cell_cent_vel(num2_1,i));
<a name="l00277"></a>00277                     }
<a name="l00278"></a>00278                 }
<a name="l00279"></a>00279             }
<a name="l00280"></a>00280         }
<a name="l00281"></a>00281       temp1.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00282"></a>00282 
<a name="l00283"></a>00283       <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00284"></a>00284         {
<a name="l00285"></a>00285           f1 = elem_faces(element_number,1);
<a name="l00286"></a>00286           num1 = face_voisins(f1,0);
<a name="l00287"></a>00287           f3 = elem_faces(element_number,3);
<a name="l00288"></a>00288           num3 = face_voisins(f3,1);
<a name="l00289"></a>00289           <span class="keywordflow">if</span> ( (num1 == -1) || (num3 == -1) )
<a name="l00290"></a>00290             <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00291"></a>00291               {
<a name="l00292"></a>00292                 filt_vel(element_number,i)=temp1(element_number,i);
<a name="l00293"></a>00293                 inc_dv(element_number,i)=0.;
<a name="l00294"></a>00294               }
<a name="l00295"></a>00295           <span class="keywordflow">else</span>
<a name="l00296"></a>00296             {
<a name="l00297"></a>00297               <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00298"></a>00298                 {
<a name="l00299"></a>00299                   filt_vel(element_number,i)=0.25*(temp1(num1,i)+
<a name="l00300"></a>00300                                                    2.0*temp1(element_number,i)+
<a name="l00301"></a>00301                                                    temp1(num3,i));
<a name="l00302"></a>00302                 }
<a name="l00303"></a>00303               f1_1 = elem_faces(num0,1);
<a name="l00304"></a>00304               num1_1 = face_voisins(f1_1,0);
<a name="l00305"></a>00305               f3_1 = elem_faces(num3,3);
<a name="l00306"></a>00306               num3_1 = face_voisins(f3_1,1);
<a name="l00307"></a>00307               <span class="keywordflow">if</span> ( (num1_1 == -1) || (num3_1 == -1) )
<a name="l00308"></a>00308                 <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00309"></a>00309                   inc_dv(element_number,i)+=(cell_cent_vel(num1,i))-(cell_cent_vel(num3,i));
<a name="l00310"></a>00310               <span class="keywordflow">else</span>
<a name="l00311"></a>00311                 {
<a name="l00312"></a>00312                   <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00313"></a>00313                     {
<a name="l00314"></a>00314                       inc_dv(element_number,i)+=(cell_cent_vel(num1_1,i))-(cell_cent_vel(num3_1,i));
<a name="l00315"></a>00315                     }
<a name="l00316"></a>00316                 }
<a name="l00317"></a>00317             }
<a name="l00318"></a>00318         }
<a name="l00319"></a>00319     }
<a name="l00320"></a>00320   <span class="keywordflow">else</span> <span class="comment">//!&lt; dimension == 3</span>
<a name="l00321"></a>00321 <span class="comment"></span>    {
<a name="l00322"></a>00322       <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00323"></a>00323         {
<a name="l00324"></a>00324 <span class="comment">// for (i=0 ; i&lt;dimension ; i++)</span>
<a name="l00325"></a>00325 <span class="comment">// for (j=0 ; j&lt;dimension ; j++)</span>
<a name="l00326"></a>00326 <span class="comment">// uij_filt(element_number,i,j)=cell_cent_vel(element_number,i)*</span>
<a name="l00327"></a>00327 <span class="comment">// cell_cent_vel(element_number,j);</span>
<a name="l00328"></a>00328           <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)
<a name="l00329"></a>00329             {
<a name="l00330"></a>00330               uij_filt_1(element_number,i)=cell_cent_vel(element_number,i)*
<a name="l00331"></a>00331                                            cell_cent_vel(element_number,0);
<a name="l00332"></a>00332               uij_filt_2(element_number,i)=cell_cent_vel(element_number,i)*
<a name="l00333"></a>00333                                            cell_cent_vel(element_number,1);
<a name="l00334"></a>00334               uij_filt_3(element_number,i)=cell_cent_vel(element_number,i)*
<a name="l00335"></a>00335                                            cell_cent_vel(element_number,2);
<a name="l00336"></a>00336             }
<a name="l00337"></a>00337           f0 = elem_faces(element_number,0);
<a name="l00338"></a>00338           num0 = face_voisins(f0,0);
<a name="l00339"></a>00339           f3 = elem_faces(element_number,3);
<a name="l00340"></a>00340           num3 = face_voisins(f3,1);
<a name="l00341"></a>00341           <span class="keywordflow">if</span> ( (num0 == -1) || (num3 == -1) )
<a name="l00342"></a>00342             <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00343"></a>00343               {
<a name="l00344"></a>00344                 temp1(element_number,i)=cell_cent_vel(element_number,i);
<a name="l00345"></a>00345                 inc_dv(element_number,i)+=0.;
<a name="l00346"></a>00346               }
<a name="l00347"></a>00347           <span class="keywordflow">else</span>
<a name="l00348"></a>00348             {
<a name="l00349"></a>00349               <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00350"></a>00350                 {
<a name="l00351"></a>00351                   temp1(element_number,i)=0.25*(cell_cent_vel(num0,i)+
<a name="l00352"></a>00352                                                 2.0*cell_cent_vel(element_number,i)+
<a name="l00353"></a>00353                                                 cell_cent_vel(num3,i));
<a name="l00354"></a>00354                 }
<a name="l00355"></a>00355 <span class="comment">// Cerr &lt;&lt; &quot; not num0 et num3 &quot; &lt;&lt; num0 &lt;&lt; &quot; &quot; &lt;&lt; num3 &lt;&lt; finl;</span>
<a name="l00356"></a>00356               f0_1 = elem_faces(num0,0);
<a name="l00357"></a>00357               num0_1 = face_voisins(f0_1,0);
<a name="l00358"></a>00358               f3_1 = elem_faces(num3,3);
<a name="l00359"></a>00359               num3_1 = face_voisins(f3_1,1);
<a name="l00360"></a>00360               <span class="keywordflow">if</span> ( (num0_1 == -1) || (num3_1 == -1) )
<a name="l00361"></a>00361                 <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00362"></a>00362                   inc_dv(element_number,i)+=(cell_cent_vel(num0,i))-(cell_cent_vel(num3,i));
<a name="l00363"></a>00363               <span class="keywordflow">else</span>
<a name="l00364"></a>00364                 {
<a name="l00365"></a>00365 <span class="comment">// Cerr &lt;&lt; &quot; not num0_1 et num3_1 &quot; &lt;&lt; num0_1 &lt;&lt; &quot; &quot; &lt;&lt; num3_1 &lt;&lt; finl;</span>
<a name="l00366"></a>00366                   <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00367"></a>00367                     {
<a name="l00368"></a>00368                       inc_dv(element_number,i)+=(cell_cent_vel(num0_1,i))-(cell_cent_vel(num3_1,i));
<a name="l00369"></a>00369                     }
<a name="l00370"></a>00370                 }
<a name="l00371"></a>00371             }
<a name="l00372"></a>00372         }
<a name="l00373"></a>00373 
<a name="l00374"></a>00374       temp1.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00375"></a>00375       <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00376"></a>00376         {
<a name="l00377"></a>00377           f1 = elem_faces(element_number,1);
<a name="l00378"></a>00378           num1 = face_voisins(f1,0);
<a name="l00379"></a>00379           f4 = elem_faces(element_number,4);
<a name="l00380"></a>00380           num4 = face_voisins(f4,1);
<a name="l00381"></a>00381           <span class="keywordflow">if</span> ( (num1 == -1) || (num4 == -1) )
<a name="l00382"></a>00382             <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00383"></a>00383               {
<a name="l00384"></a>00384                 temp2(element_number,i)=temp1(element_number,i);
<a name="l00385"></a>00385                 inc_dv(element_number,i)+=0.;
<a name="l00386"></a>00386               }
<a name="l00387"></a>00387           <span class="keywordflow">else</span>
<a name="l00388"></a>00388             {
<a name="l00389"></a>00389               <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00390"></a>00390                 {
<a name="l00391"></a>00391                   temp2(element_number,i)=0.25*(temp1(num1,i)+
<a name="l00392"></a>00392                                                 2.0*temp1(element_number,i)+
<a name="l00393"></a>00393                                                 temp1(num4,i));
<a name="l00394"></a>00394                 }
<a name="l00395"></a>00395 <span class="comment">// Cerr &lt;&lt; &quot; not num1 et num4 &quot; &lt;&lt; num1 &lt;&lt; &quot; &quot; &lt;&lt; num4 &lt;&lt; finl;</span>
<a name="l00396"></a>00396               f1_1 = elem_faces(num1,1);
<a name="l00397"></a>00397               num1_1 = face_voisins(f1_1,0);
<a name="l00398"></a>00398               f4_1 = elem_faces(num4,4);
<a name="l00399"></a>00399               num4_1 = face_voisins(f4_1,1);
<a name="l00400"></a>00400               <span class="keywordflow">if</span> ( (num1_1 == -1) || (num4_1 == -1) )
<a name="l00401"></a>00401                 <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00402"></a>00402                   inc_dv(element_number,i)+=(cell_cent_vel(num1,i))-(cell_cent_vel(num4,i));
<a name="l00403"></a>00403               <span class="keywordflow">else</span>
<a name="l00404"></a>00404                 {
<a name="l00405"></a>00405 <span class="comment">// Cerr &lt;&lt; &quot; not num1_1 et num4_1 &quot; &lt;&lt; num1_1 &lt;&lt; &quot; &quot; &lt;&lt; num4_1 &lt;&lt; finl;</span>
<a name="l00406"></a>00406                   <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00407"></a>00407                     {
<a name="l00408"></a>00408                       inc_dv(element_number,i)+=(cell_cent_vel(num1_1,i))-(cell_cent_vel(num4_1,i));
<a name="l00409"></a>00409                     }
<a name="l00410"></a>00410                 }
<a name="l00411"></a>00411             }
<a name="l00412"></a>00412         }
<a name="l00413"></a>00413 
<a name="l00414"></a>00414       temp2.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00415"></a>00415       <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00416"></a>00416         {
<a name="l00417"></a>00417           f2 = elem_faces(element_number,2);
<a name="l00418"></a>00418           num2 = face_voisins(f2,0);
<a name="l00419"></a>00419           f5 = elem_faces(element_number,5);
<a name="l00420"></a>00420           num5 = face_voisins(f5,1);
<a name="l00421"></a>00421           <span class="keywordflow">if</span> ( (num2 == -1) || (num5 == -1) )
<a name="l00422"></a>00422             <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00423"></a>00423               {
<a name="l00424"></a>00424                 filt_vel(element_number,i)=temp2(element_number,i);
<a name="l00425"></a>00425                 inc_dv(element_number,i)+=0.;
<a name="l00426"></a>00426               }
<a name="l00427"></a>00427           <span class="keywordflow">else</span>
<a name="l00428"></a>00428             {
<a name="l00429"></a>00429               <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00430"></a>00430                 {
<a name="l00431"></a>00431                   filt_vel(element_number,i)=0.25*(temp2(num2,i)+
<a name="l00432"></a>00432                                                    2.0*temp2(element_number,i)+
<a name="l00433"></a>00433                                                    temp2(num5,i));
<a name="l00434"></a>00434                 }
<a name="l00435"></a>00435 <span class="comment">// Cerr &lt;&lt; &quot; not num2 et num5 &quot; &lt;&lt; num2 &lt;&lt; &quot; &quot; &lt;&lt; num5 &lt;&lt; finl;</span>
<a name="l00436"></a>00436               f2_1 = elem_faces(num2,2);
<a name="l00437"></a>00437               num2_1 = face_voisins(f2_1,0);
<a name="l00438"></a>00438               f5_1 = elem_faces(num5,5);
<a name="l00439"></a>00439               num5_1 = face_voisins(f5_1,1);
<a name="l00440"></a>00440               <span class="keywordflow">if</span> ( (num2_1 == -1) || (num5_1 == -1) )
<a name="l00441"></a>00441                 <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00442"></a>00442                   inc_dv(element_number,i)+=(cell_cent_vel(num2,i))-(cell_cent_vel(num5,i));
<a name="l00443"></a>00443               <span class="keywordflow">else</span>
<a name="l00444"></a>00444                 {
<a name="l00445"></a>00445 <span class="comment">// Cerr &lt;&lt; &quot; not num2_1 et num5_1 &quot; &lt;&lt; num2_1 &lt;&lt; &quot; &quot; &lt;&lt; num5_1 &lt;&lt; finl;</span>
<a name="l00446"></a>00446                   <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i ++)
<a name="l00447"></a>00447                     {
<a name="l00448"></a>00448                       inc_dv(element_number,i)+=(cell_cent_vel(num2_1,i))-(cell_cent_vel(num5_1,i));
<a name="l00449"></a>00449                     }
<a name="l00450"></a>00450                 }
<a name="l00451"></a>00451             }
<a name="l00452"></a>00452         }
<a name="l00453"></a>00453     }
<a name="l00454"></a>00454   filt_vel.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00455"></a>00455   inc_dv.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00456"></a>00456   uij_filt_1.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00457"></a>00457   uij_filt_2.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00458"></a>00458   uij_filt_3.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 <span class="comment">// </span>
<a name="l00461"></a>00461 <span class="comment">// calculer_Qij(inc_dv,Qij);</span>
<a name="l00462"></a>00462 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00463"></a>00463 
<a name="l00464"></a>00464 <span class="comment">// DoubleTrav Qij(nb_elem_tot,dimension,dimension);</span>
<a name="l00465"></a>00465 
<a name="l00466"></a>00466 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00467"></a>00467 <span class="comment">// const Zone_VDF&amp; zone_VDF = la_zone_VDF.valeur();</span>
<a name="l00468"></a>00468 <span class="comment">// int nb_elem_tot = zone_VDF.zone().nb_elem_tot();</span>
<a name="l00469"></a>00469 <span class="comment">// int element_number;</span>
<a name="l00470"></a>00470 
<a name="l00471"></a>00471 <span class="comment">// This is to calculate the Qij tensor</span>
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 <span class="comment">// for (element_number=0 ; element_number&lt;nb_elem_tot ; element_number ++)</span>
<a name="l00474"></a>00474 <span class="comment">// {</span>
<a name="l00475"></a>00475 <span class="comment">// for (int i=0 ; i&lt;dimension ; i++)</span>
<a name="l00476"></a>00476 <span class="comment">// for (int j=0 ; j&lt;dimension ; j++)</span>
<a name="l00477"></a>00477 <span class="comment">// Qij(element_number,i,j)=inc_dv(element_number,i)*inc_dv(element_number,j);</span>
<a name="l00478"></a>00478 <span class="comment">// }</span>
<a name="l00479"></a>00479 
<a name="l00480"></a>00480 <span class="comment">// Cerr &lt;&lt; &quot; calculer_Lij &quot; &lt;&lt; finl;</span>
<a name="l00481"></a>00481 <span class="comment">// </span>
<a name="l00482"></a>00482 <span class="comment">// calculer_Lij(cell_cent_vel,filt_vel,Lij);</span>
<a name="l00483"></a>00483 <span class="comment">// </span>
<a name="l00484"></a>00484 <span class="comment">// calculate Qij and uij_filt in the same loop to speed up calculation</span>
<a name="l00485"></a>00485 <span class="comment">// </span>
<a name="l00486"></a>00486 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00487"></a>00487 
<a name="l00488"></a>00488 <span class="comment">// DoubleTrav Lij(nb_elem_tot,dimension,dimension);</span>
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00491"></a>00491 <span class="comment">// const Zone_VDF&amp; zone_VDF = la_zone_VDF.valeur();</span>
<a name="l00492"></a>00492 <span class="comment">// int nb_elem_tot = zone_VDF.zone().nb_elem_tot();</span>
<a name="l00493"></a>00493 <span class="comment">// int element_number;</span>
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 <span class="comment">// DoubleTrav uij_filt(nb_elem_tot,dimension,dimension);</span>
<a name="l00496"></a>00496 <span class="comment">// DoubleTrav ttemp1(nb_elem_tot,dimension,dimension);</span>
<a name="l00497"></a>00497 <span class="comment">// DoubleTrav ttemp2(nb_elem_tot,dimension,dimension);</span>
<a name="l00498"></a>00498 
<a name="l00499"></a>00499 <span class="comment">// This is to calculate the Lij term for the C coefficient</span>
<a name="l00500"></a>00500 
<a name="l00501"></a>00501 <span class="comment">// for (element_number=0 ; element_number&lt;nb_elem_tot ; element_number ++)</span>
<a name="l00502"></a>00502 <span class="comment">// {</span>
<a name="l00503"></a>00503 <span class="comment">// for (int i=0 ; i&lt;dimension ; i++)</span>
<a name="l00504"></a>00504 <span class="comment">// for (int j=0 ; j&lt;dimension ; j++)</span>
<a name="l00505"></a>00505 <span class="comment">// {</span>
<a name="l00506"></a>00506 <span class="comment">// uij_filt(element_number,i,j)=cell_cent_vel(element_number,i)*</span>
<a name="l00507"></a>00507 <span class="comment">// cell_cent_vel(element_number,j);</span>
<a name="l00508"></a>00508 <span class="comment">// }</span>
<a name="l00509"></a>00509 <span class="comment">// }</span>
<a name="l00510"></a>00510 
<a name="l00511"></a>00511 <span class="comment">// calculer_filter_tensor(uij_filt);</span>
<a name="l00512"></a>00512 <span class="comment">// Cerr &lt;&lt; &quot; calculer_uij_filt &quot; &lt;&lt; finl;</span>
<a name="l00513"></a>00513 
<a name="l00514"></a>00514 <span class="comment">// This is to calculate the filtered tensor field</span>
<a name="l00515"></a>00515 <span class="comment">// int j;</span>
<a name="l00516"></a>00516 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; boucle 2 &quot; &lt;&lt; finl;</span>
<a name="l00517"></a>00517   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ==2)
<a name="l00518"></a>00518     {
<a name="l00519"></a>00519       <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00520"></a>00520         {
<a name="l00521"></a>00521           f0 = elem_faces(element_number,0);
<a name="l00522"></a>00522           num0 = face_voisins(f0,0);
<a name="l00523"></a>00523           f2 = elem_faces(element_number,2);
<a name="l00524"></a>00524           num2 = face_voisins(f2,1);
<a name="l00525"></a>00525           <span class="keywordflow">if</span> ( (num0 == -1) || (num2 == -1) )
<a name="l00526"></a>00526 <span class="comment">// for (i=0 ; i&lt;dimension ; i ++)</span>
<a name="l00527"></a>00527 <span class="comment">// for (j=0 ; j&lt;dimension ; j ++)</span>
<a name="l00528"></a>00528 <span class="comment">// ttemp1(element_number,i,j)=uij_filt(element_number,i,j);</span>
<a name="l00529"></a>00529             <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)
<a name="l00530"></a>00530               {
<a name="l00531"></a>00531                 ttemp1_1(element_number,i)=uij_filt_1(element_number,i);
<a name="l00532"></a>00532                 ttemp1_2(element_number,i)=uij_filt_2(element_number,i);
<a name="l00533"></a>00533               }
<a name="l00534"></a>00534           <span class="keywordflow">else</span>
<a name="l00535"></a>00535             {
<a name="l00536"></a>00536 <span class="comment">// for (i=0 ; i&lt;dimension ; i ++)</span>
<a name="l00537"></a>00537 <span class="comment">// for (j=0 ; j&lt;dimension ; j ++)</span>
<a name="l00538"></a>00538 <span class="comment">// {</span>
<a name="l00539"></a>00539 <span class="comment">// ttemp1(element_number,i,j)=0.25*(uij_filt(num0,i,j)+</span>
<a name="l00540"></a>00540 <span class="comment">// 2.0*uij_filt(element_number,i,j)+</span>
<a name="l00541"></a>00541 <span class="comment">// uij_filt(num2,i,j));</span>
<a name="l00542"></a>00542 <span class="comment">// }</span>
<a name="l00543"></a>00543               <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)
<a name="l00544"></a>00544                 {
<a name="l00545"></a>00545                   ttemp1_1(element_number,i)=0.25*(uij_filt_1(num0,i)+
<a name="l00546"></a>00546                                                    2.0*uij_filt_1(element_number,i)+
<a name="l00547"></a>00547                                                    uij_filt_1(num2,i));
<a name="l00548"></a>00548                   ttemp1_2(element_number,i)=0.25*(uij_filt_2(num0,i)+
<a name="l00549"></a>00549                                                    2.0*uij_filt_2(element_number,i)+
<a name="l00550"></a>00550                                                    uij_filt_2(num2,i));
<a name="l00551"></a>00551                 }
<a name="l00552"></a>00552             }
<a name="l00553"></a>00553         }
<a name="l00554"></a>00554 
<a name="l00555"></a>00555       ttemp1_1.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00556"></a>00556       ttemp1_2.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00557"></a>00557       <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00558"></a>00558         {
<a name="l00559"></a>00559           f1 = elem_faces(element_number,1);
<a name="l00560"></a>00560           num1 = face_voisins(f1,0);
<a name="l00561"></a>00561           f3 = elem_faces(element_number,3);
<a name="l00562"></a>00562           num3 = face_voisins(f3,1);
<a name="l00563"></a>00563           <span class="keywordflow">if</span> ( (num1 == -1) || (num3 == -1) )
<a name="l00564"></a>00564 <span class="comment">// for (i=0 ; i&lt;dimension ; i ++)</span>
<a name="l00565"></a>00565 <span class="comment">// for (j=0 ; j&lt;dimension ; j ++)</span>
<a name="l00566"></a>00566 <span class="comment">// uij_filt(element_number,i,j)=ttemp1(element_number,i,j);</span>
<a name="l00567"></a>00567             <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)
<a name="l00568"></a>00568               {
<a name="l00569"></a>00569                 uij_filt_1(element_number,i)=ttemp1_1(element_number,i);
<a name="l00570"></a>00570                 uij_filt_2(element_number,i)=ttemp1_2(element_number,i);
<a name="l00571"></a>00571               }
<a name="l00572"></a>00572           <span class="keywordflow">else</span>
<a name="l00573"></a>00573             {
<a name="l00574"></a>00574 <span class="comment">// for (i=0 ; i&lt;dimension ; i ++)</span>
<a name="l00575"></a>00575 <span class="comment">// for (j=0 ; j&lt;dimension ; j ++)</span>
<a name="l00576"></a>00576 <span class="comment">// {</span>
<a name="l00577"></a>00577 <span class="comment">// uij_filt(element_number,i,j)=0.25*(ttemp1(num1,i,j)+</span>
<a name="l00578"></a>00578 <span class="comment">// 2.0*ttemp1(element_number,i,j)+</span>
<a name="l00579"></a>00579 <span class="comment">// ttemp1(num3,i,j));</span>
<a name="l00580"></a>00580 <span class="comment">// }</span>
<a name="l00581"></a>00581               <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)
<a name="l00582"></a>00582                 {
<a name="l00583"></a>00583                   uij_filt_1(element_number,i)=0.25*(ttemp1_1(num0,i)+
<a name="l00584"></a>00584                                                      2.0*ttemp1_1(element_number,i)+
<a name="l00585"></a>00585                                                      ttemp1_1(num2,i));
<a name="l00586"></a>00586                   uij_filt_2(element_number,i)=0.25*(ttemp1_2(num0,i)+
<a name="l00587"></a>00587                                                      2.0*ttemp1_2(element_number,i)+
<a name="l00588"></a>00588                                                      ttemp1_2(num2,i));
<a name="l00589"></a>00589                 }
<a name="l00590"></a>00590             }
<a name="l00591"></a>00591         }
<a name="l00592"></a>00592     }
<a name="l00593"></a>00593   <span class="keywordflow">else</span>
<a name="l00594"></a>00594     {
<a name="l00595"></a>00595       <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00596"></a>00596         {
<a name="l00597"></a>00597           f0 = elem_faces(element_number,0);
<a name="l00598"></a>00598           num0 = face_voisins(f0,0);
<a name="l00599"></a>00599           f3 = elem_faces(element_number,3);
<a name="l00600"></a>00600           num3 = face_voisins(f3,1);
<a name="l00601"></a>00601           <span class="keywordflow">if</span> ( (num0 == -1) || (num3 == -1) )
<a name="l00602"></a>00602 <span class="comment">// for (i=0 ; i&lt;dimension ; i ++)</span>
<a name="l00603"></a>00603 <span class="comment">// for (j=0 ; j&lt;dimension ; j ++)</span>
<a name="l00604"></a>00604 <span class="comment">// ttemp1(element_number,i,j)=uij_filt(element_number,i,j);</span>
<a name="l00605"></a>00605             <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)
<a name="l00606"></a>00606               {
<a name="l00607"></a>00607                 ttemp1_1(element_number,i)=uij_filt_1(element_number,i);
<a name="l00608"></a>00608                 ttemp1_2(element_number,i)=uij_filt_2(element_number,i);
<a name="l00609"></a>00609                 ttemp1_3(element_number,i)=uij_filt_3(element_number,i);
<a name="l00610"></a>00610               }
<a name="l00611"></a>00611           <span class="keywordflow">else</span>
<a name="l00612"></a>00612             {
<a name="l00613"></a>00613 <span class="comment">// for (i=0 ; i&lt;dimension ; i ++)</span>
<a name="l00614"></a>00614 <span class="comment">// for (j=0 ; j&lt;dimension ; j ++)</span>
<a name="l00615"></a>00615 <span class="comment">// {</span>
<a name="l00616"></a>00616 <span class="comment">// ttemp1(element_number,i,j)=0.25*(uij_filt(num0,i,j)+</span>
<a name="l00617"></a>00617 <span class="comment">// 2.0*uij_filt(element_number,i,j)+</span>
<a name="l00618"></a>00618 <span class="comment">// uij_filt(num3,i,j));</span>
<a name="l00619"></a>00619 <span class="comment">// }</span>
<a name="l00620"></a>00620               <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)
<a name="l00621"></a>00621                 {
<a name="l00622"></a>00622                   ttemp1_1(element_number,i)=0.25*(uij_filt_1(num0,i)+
<a name="l00623"></a>00623                                                    2.0*uij_filt_1(element_number,i)+
<a name="l00624"></a>00624                                                    uij_filt_1(num2,i));
<a name="l00625"></a>00625                   ttemp1_2(element_number,i)=0.25*(uij_filt_2(num0,i)+
<a name="l00626"></a>00626                                                    2.0*uij_filt_2(element_number,i)+
<a name="l00627"></a>00627                                                    uij_filt_2(num2,i));
<a name="l00628"></a>00628                   ttemp1_3(element_number,i)=0.25*(uij_filt_3(num0,i)+
<a name="l00629"></a>00629                                                    2.0*uij_filt_3(element_number,i)+
<a name="l00630"></a>00630                                                    uij_filt_3(num2,i));
<a name="l00631"></a>00631                 }
<a name="l00632"></a>00632             }
<a name="l00633"></a>00633         }
<a name="l00634"></a>00634 
<a name="l00635"></a>00635       ttemp1_1.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00636"></a>00636       ttemp1_2.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00637"></a>00637       ttemp1_3.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00638"></a>00638       <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00639"></a>00639         {
<a name="l00640"></a>00640           f1 = elem_faces(element_number,1);
<a name="l00641"></a>00641           num1 = face_voisins(f1,0);
<a name="l00642"></a>00642           f4 = elem_faces(element_number,4);
<a name="l00643"></a>00643           num4 = face_voisins(f4,1);
<a name="l00644"></a>00644           <span class="keywordflow">if</span> ( (num1 == -1) || (num4 == -1) )
<a name="l00645"></a>00645 <span class="comment">// for (i=0 ; i&lt;dimension ; i ++)</span>
<a name="l00646"></a>00646 <span class="comment">// for (j=0 ; j&lt;dimension ; j ++)</span>
<a name="l00647"></a>00647 <span class="comment">// ttemp2(element_number,i,j)=ttemp1(element_number,i,j);</span>
<a name="l00648"></a>00648             <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)
<a name="l00649"></a>00649               {
<a name="l00650"></a>00650                 ttemp2_1(element_number,i)=ttemp1_1(element_number,i);
<a name="l00651"></a>00651                 ttemp2_2(element_number,i)=ttemp1_2(element_number,i);
<a name="l00652"></a>00652                 ttemp2_3(element_number,i)=ttemp1_3(element_number,i);
<a name="l00653"></a>00653               }
<a name="l00654"></a>00654           <span class="keywordflow">else</span>
<a name="l00655"></a>00655             {
<a name="l00656"></a>00656 <span class="comment">// for (i=0 ; i&lt;dimension ; i ++)</span>
<a name="l00657"></a>00657 <span class="comment">// for (j=0 ; j&lt;dimension ; j ++)</span>
<a name="l00658"></a>00658 <span class="comment">// {</span>
<a name="l00659"></a>00659 <span class="comment">// ttemp2(element_number,i,j)=0.25*(ttemp1(num1,i,j)+</span>
<a name="l00660"></a>00660 <span class="comment">// 2.0*ttemp1(element_number,i,j)+</span>
<a name="l00661"></a>00661 <span class="comment">// ttemp1(num4,i,j));</span>
<a name="l00662"></a>00662 <span class="comment">// }</span>
<a name="l00663"></a>00663             }
<a name="l00664"></a>00664         }
<a name="l00665"></a>00665 
<a name="l00666"></a>00666       ttemp2_1.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00667"></a>00667       ttemp2_2.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00668"></a>00668       ttemp2_3.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00669"></a>00669       <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00670"></a>00670         {
<a name="l00671"></a>00671           f2 = elem_faces(element_number,2);
<a name="l00672"></a>00672           num2 = face_voisins(f2,0);
<a name="l00673"></a>00673           f5 = elem_faces(element_number,5);
<a name="l00674"></a>00674           num5 = face_voisins(f5,1);
<a name="l00675"></a>00675           <span class="keywordflow">if</span> ( (num2 == -1) || (num5 == -1) )
<a name="l00676"></a>00676 <span class="comment">// for (i=0 ; i&lt;dimension ; i ++)</span>
<a name="l00677"></a>00677 <span class="comment">// for (j=0 ; j&lt;dimension ; j ++)</span>
<a name="l00678"></a>00678 <span class="comment">// uij_filt(element_number,i,j)=ttemp2(element_number,i,j);</span>
<a name="l00679"></a>00679             <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)
<a name="l00680"></a>00680               {
<a name="l00681"></a>00681                 uij_filt_1(element_number,i)=ttemp2_1(element_number,i);
<a name="l00682"></a>00682                 uij_filt_2(element_number,i)=ttemp2_2(element_number,i);
<a name="l00683"></a>00683                 uij_filt_3(element_number,i)=ttemp2_3(element_number,i);
<a name="l00684"></a>00684               }
<a name="l00685"></a>00685           <span class="keywordflow">else</span>
<a name="l00686"></a>00686             {
<a name="l00687"></a>00687 <span class="comment">// for (i=0 ; i&lt;dimension ; i ++)</span>
<a name="l00688"></a>00688 <span class="comment">// for (j=0 ; j&lt;dimension ; j ++)</span>
<a name="l00689"></a>00689 <span class="comment">// {</span>
<a name="l00690"></a>00690 <span class="comment">// uij_filt(element_number,i,j)=0.25*(ttemp2(num2,i,j)+</span>
<a name="l00691"></a>00691 <span class="comment">// 2.0*ttemp2(element_number,i,j)+</span>
<a name="l00692"></a>00692 <span class="comment">// ttemp2(num5,i,j));</span>
<a name="l00693"></a>00693 <span class="comment">// }</span>
<a name="l00694"></a>00694               <span class="keywordflow">for</span> (i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)
<a name="l00695"></a>00695                 {
<a name="l00696"></a>00696                   uij_filt_1(element_number,i)=0.25*(ttemp2_1(num0,i)+
<a name="l00697"></a>00697                                                      2.0*ttemp2_1(element_number,i)+
<a name="l00698"></a>00698                                                      ttemp2_1(num2,i));
<a name="l00699"></a>00699                   uij_filt_2(element_number,i)=0.25*(ttemp2_2(num0,i)+
<a name="l00700"></a>00700                                                      2.0*ttemp2_2(element_number,i)+
<a name="l00701"></a>00701                                                      ttemp2_2(num2,i));
<a name="l00702"></a>00702                   uij_filt_3(element_number,i)=0.25*(ttemp2_3(num0,i)+
<a name="l00703"></a>00703                                                      2.0*ttemp2_3(element_number,i)+
<a name="l00704"></a>00704                                                      ttemp2_3(num2,i));
<a name="l00705"></a>00705                 }
<a name="l00706"></a>00706             }
<a name="l00707"></a>00707         }
<a name="l00708"></a>00708     }
<a name="l00709"></a>00709 <span class="comment">// finish calculating Lij</span>
<a name="l00710"></a>00710 
<a name="l00711"></a>00711   uij_filt_1.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00712"></a>00712   uij_filt_2.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00713"></a>00713   uij_filt_3.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00714"></a>00714 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; boucle 3 &quot; &lt;&lt; finl;</span>
<a name="l00715"></a>00715   <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00716"></a>00716     {
<a name="l00717"></a>00717 <span class="comment">// for (int i=0 ; i&lt;dimension ; i++)</span>
<a name="l00718"></a>00718 <span class="comment">// for (int j=0 ; j&lt;dimension ; j++)</span>
<a name="l00719"></a>00719 <span class="comment">// {</span>
<a name="l00720"></a>00720 <span class="comment">// Qij(element_number,i,j)=inc_dv(element_number,i)*inc_dv(element_number,j);</span>
<a name="l00721"></a>00721 <span class="comment">// Lij(element_number,i,j)=uij_filt(element_number,i,j)-</span>
<a name="l00722"></a>00722 <span class="comment">// filt_vel(element_number,i)*filt_vel(element_number,j);</span>
<a name="l00723"></a>00723 <span class="comment">// }</span>
<a name="l00724"></a>00724       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0 ; ii&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; ii++)
<a name="l00725"></a>00725         {
<a name="l00726"></a>00726           Qij_1(element_number,ii)=inc_dv(element_number,ii)*inc_dv(element_number,0);
<a name="l00727"></a>00727           Qij_2(element_number,ii)=inc_dv(element_number,ii)*inc_dv(element_number,1);
<a name="l00728"></a>00728           Lij_1(element_number,ii)=uij_filt_1(element_number,ii)-
<a name="l00729"></a>00729                                    filt_vel(element_number,ii)*filt_vel(element_number,0);
<a name="l00730"></a>00730           Lij_2(element_number,ii)=uij_filt_2(element_number,ii)-
<a name="l00731"></a>00731                                    filt_vel(element_number,ii)*filt_vel(element_number,1);
<a name="l00732"></a>00732           <span class="keywordflow">if</span> (dimension == 3)
<a name="l00733"></a>00733             {
<a name="l00734"></a>00734               Qij_3(element_number,ii)=inc_dv(element_number,ii)*inc_dv(element_number,2);
<a name="l00735"></a>00735               Lij_3(element_number,ii)=uij_filt_3(element_number,ii)-
<a name="l00736"></a>00736                                        filt_vel(element_number,ii)*filt_vel(element_number,2);
<a name="l00737"></a>00737             }
<a name="l00738"></a>00738         }
<a name="l00739"></a>00739     }
<a name="l00740"></a>00740 
<a name="l00741"></a>00741   Lij_1.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00742"></a>00742   Lij_2.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00743"></a>00743   Lij_3.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00744"></a>00744   Qij_1.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00745"></a>00745   Qij_2.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00746"></a>00746   Qij_3.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00747"></a>00747 <span class="comment">// </span>
<a name="l00748"></a>00748 <span class="comment">// calculer_f(Lij,Qij);</span>
<a name="l00749"></a>00749 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00750"></a>00750 
<a name="l00751"></a>00751   <a class="code" href="classDoubleVect.html">DoubleVect</a> f(nb_elem);
<a name="l00752"></a>00752 
<a name="l00753"></a>00753 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00754"></a>00754   <a class="code" href="classDoubleVect.html">DoubleVect</a> temp_1(nb_elem);
<a name="l00755"></a>00755   <a class="code" href="classDoubleVect.html">DoubleVect</a> temp_2(nb_elem);
<a name="l00756"></a>00756 
<a name="l00757"></a>00757 <span class="comment">// Evaluate the dynamic model coefficient f</span>
<a name="l00758"></a>00758   <span class="keywordtype">int</span> elem;
<a name="l00759"></a>00759   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2)
<a name="l00760"></a>00760     <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem; elem++)
<a name="l00761"></a>00761       {
<a name="l00762"></a>00762 <span class="comment">// temp_1(elem)=0.;</span>
<a name="l00763"></a>00763 <span class="comment">// temp_2(elem)=0.;</span>
<a name="l00764"></a>00764 <span class="comment">// for (int k=0 ; k&lt;dimension ; k++)</span>
<a name="l00765"></a>00765 <span class="comment">// for (int l=0 ; l&lt;dimension ; l++)</span>
<a name="l00766"></a>00766 <span class="comment">// {</span>
<a name="l00767"></a>00767 <span class="comment">// temp_1(elem)+=Lij(elem,k,k);</span>
<a name="l00768"></a>00768 <span class="comment">// temp_2(elem)+=4.*Qij(elem,l,l);</span>
<a name="l00769"></a>00769 <span class="comment">// }</span>
<a name="l00770"></a>00770 
<a name="l00771"></a>00771         temp_1(elem)=Lij_1(elem,0)+Lij_2(elem,1);
<a name="l00772"></a>00772         temp_2(elem)=4.*Qij_1(elem,0)+4.*Qij_2(elem,1);
<a name="l00773"></a>00773         <span class="keywordflow">if</span>(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(temp_2(elem)) &lt; 1.e-12)
<a name="l00774"></a>00774           f(elem)=0.;
<a name="l00775"></a>00775         <span class="keywordflow">else</span>
<a name="l00776"></a>00776           f(elem)=temp_1(elem)/temp_2(elem);
<a name="l00777"></a>00777       }
<a name="l00778"></a>00778   <span class="keywordflow">else</span>
<a name="l00779"></a>00779     <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem; elem++)
<a name="l00780"></a>00780       {
<a name="l00781"></a>00781 <span class="comment">// temp_1(elem)=0.;</span>
<a name="l00782"></a>00782 <span class="comment">// temp_2(elem)=0.;</span>
<a name="l00783"></a>00783 
<a name="l00784"></a>00784         temp_1(elem)=Lij_1(elem,0)+Lij_2(elem,1)+Lij_3(elem,2);
<a name="l00785"></a>00785         temp_2(elem)=4.*Qij_1(elem,0)+4.*Qij_2(elem,1)+4.*Qij_3(elem,2);
<a name="l00786"></a>00786         <span class="keywordflow">if</span>(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(temp_2(elem)) &lt; 1.e-12)
<a name="l00787"></a>00787           f(elem)=0.;
<a name="l00788"></a>00788         <span class="keywordflow">else</span>
<a name="l00789"></a>00789           f(elem)=temp_1(elem)/temp_2(elem);
<a name="l00790"></a>00790       }
<a name="l00791"></a>00791 
<a name="l00792"></a>00792   f.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00793"></a>00793 <span class="comment">// Cerr &lt;&lt; &quot; calculer_dQij_j&quot; &lt;&lt; f &lt;&lt; &quot; &quot; &lt;&lt; Qij &lt;&lt; finl;</span>
<a name="l00794"></a>00794 <span class="comment">// </span>
<a name="l00795"></a>00795 <span class="comment">// calculer_dQij_j(f,Qij,dQij_j);</span>
<a name="l00796"></a>00796 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00797"></a>00797 
<a name="l00798"></a>00798 <span class="comment">// DoubleTrav dQij_j(nb_elem_tot,dimension);</span>
<a name="l00799"></a>00799 <span class="comment">// dQij_j.resize(nb_elem_tot,dimension);</span>
<a name="l00800"></a>00800 
<a name="l00801"></a>00801 <span class="comment">// -------------------------------------------------------------------</span>
<a name="l00802"></a>00802 <span class="comment">// const IntTab&amp; Qdm = zone_VDF.Qdm();</span>
<a name="l00803"></a>00803 <span class="comment">// const IntVect&amp; orientation = zone_VDF.orientation();</span>
<a name="l00804"></a>00804 
<a name="l00805"></a>00805 <span class="comment">// </span>
<a name="l00806"></a>00806 <span class="comment">// Calculate the source term dQij_j = d/dxj ( f Qij )</span>
<a name="l00807"></a>00807 <span class="comment">// </span>
<a name="l00808"></a>00808 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; boucle 4 &quot; &lt;&lt; nb_elem &lt;&lt; finl;</span>
<a name="l00809"></a>00809   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ==2)
<a name="l00810"></a>00810     {
<a name="l00811"></a>00811       <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00812"></a>00812         {
<a name="l00813"></a>00813           f0 = elem_faces(element_number,0);
<a name="l00814"></a>00814           num0 = face_voisins(f0,0);
<a name="l00815"></a>00815           <span class="keywordflow">if</span> (num0 == -1)
<a name="l00816"></a>00816             num0 = element_number;
<a name="l00817"></a>00817           f1 = elem_faces(element_number,1);
<a name="l00818"></a>00818           num1 = face_voisins(f1,0);
<a name="l00819"></a>00819           <span class="keywordflow">if</span> (num1 == -1)
<a name="l00820"></a>00820             num1 = element_number;
<a name="l00821"></a>00821           f2 = elem_faces(element_number,2);
<a name="l00822"></a>00822           num2 = face_voisins(f2,1);
<a name="l00823"></a>00823           <span class="keywordflow">if</span> (num2 == -1)
<a name="l00824"></a>00824             num2 = element_number;
<a name="l00825"></a>00825           f3 = elem_faces(element_number,3);
<a name="l00826"></a>00826           num3 = face_voisins(f3,1);
<a name="l00827"></a>00827           <span class="keywordflow">if</span> (num3 == -1)
<a name="l00828"></a>00828             num3 = element_number;
<a name="l00829"></a>00829 <span class="comment">// dQij_j(element_number,0)=0.5*((f(num2)*Qij(num2,0,0)-f(num0)*Qij(num0,0,0))/</span>
<a name="l00830"></a>00830 <span class="comment">// zone_VDF.dim_elem(element_number,0));</span>
<a name="l00831"></a>00831 <span class="comment">// dQij_j(element_number,0)+=0.5*((f(num3)*Qij(num3,0,1)-f(num1)*Qij(num1,0,1))/</span>
<a name="l00832"></a>00832 <span class="comment">// zone_VDF.dim_elem(element_number,1));</span>
<a name="l00833"></a>00833 <span class="comment">// dQij_j(element_number,1)=0.5*((f(num2)*Qij(num2,1,0)-f(num0)*Qij(num0,1,0))/</span>
<a name="l00834"></a>00834 <span class="comment">// zone_VDF.dim_elem(element_number,0));</span>
<a name="l00835"></a>00835 <span class="comment">// dQij_j(element_number,1)+=0.5*((f(num3)*Qij(num3,1,1)-f(num1)*Qij(num1,1,1))/</span>
<a name="l00836"></a>00836 <span class="comment">// zone_VDF.dim_elem(element_number,1));</span>
<a name="l00837"></a>00837           dQij_j(element_number,0)=0.5*((f(num2)*Qij_1(num2,0)-f(num0)*Qij_1(num0,0))/
<a name="l00838"></a>00838                                         zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,0));
<a name="l00839"></a>00839           dQij_j(element_number,0)+=0.5*((f(num3)*Qij_2(num3,0)-f(num1)*Qij_2(num1,0))/
<a name="l00840"></a>00840                                          zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,1));
<a name="l00841"></a>00841           dQij_j(element_number,1)=0.5*((f(num2)*Qij_1(num2,1)-f(num0)*Qij_1(num0,1))/
<a name="l00842"></a>00842                                         zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,0));
<a name="l00843"></a>00843           dQij_j(element_number,1)+=0.5*((f(num3)*Qij_2(num3,1)-f(num1)*Qij_2(num1,1))/
<a name="l00844"></a>00844                                          zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,1));
<a name="l00845"></a>00845         }
<a name="l00846"></a>00846     }
<a name="l00847"></a>00847   <span class="keywordflow">else</span>
<a name="l00848"></a>00848     {
<a name="l00849"></a>00849       <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem ; element_number ++)
<a name="l00850"></a>00850         {
<a name="l00851"></a>00851           f0 = elem_faces(element_number,0);
<a name="l00852"></a>00852           num0 = face_voisins(f0,0);
<a name="l00853"></a>00853           <span class="keywordflow">if</span> (num0 == -1 || num0 &gt;= nb_elem)
<a name="l00854"></a>00854             {
<a name="l00855"></a>00855 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; bord num0 &quot; &lt;&lt; finl;</span>
<a name="l00856"></a>00856               num0 = element_number;
<a name="l00857"></a>00857             }
<a name="l00858"></a>00858           f1 = elem_faces(element_number,1);
<a name="l00859"></a>00859           num1 = face_voisins(f1,0);
<a name="l00860"></a>00860           <span class="keywordflow">if</span> (num1 == -1 || num0 &gt;= nb_elem)
<a name="l00861"></a>00861             {
<a name="l00862"></a>00862 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; bord num1 &quot; &lt;&lt; finl;</span>
<a name="l00863"></a>00863               num1 = element_number;
<a name="l00864"></a>00864             }
<a name="l00865"></a>00865           f2 = elem_faces(element_number,2);
<a name="l00866"></a>00866           num2 = face_voisins(f2,0);
<a name="l00867"></a>00867           <span class="keywordflow">if</span> (num2 == -1 || num2 &gt;= nb_elem)
<a name="l00868"></a>00868             {
<a name="l00869"></a>00869 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; bord num2 &quot; &lt;&lt; finl;</span>
<a name="l00870"></a>00870               num2 = element_number;
<a name="l00871"></a>00871             }
<a name="l00872"></a>00872           f3 = elem_faces(element_number,3);
<a name="l00873"></a>00873           num3 = face_voisins(f3,1);
<a name="l00874"></a>00874           <span class="keywordflow">if</span> (num3 == -1 || num3 &gt;= nb_elem)
<a name="l00875"></a>00875             {
<a name="l00876"></a>00876 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; bord num3 &quot; &lt;&lt; finl;</span>
<a name="l00877"></a>00877               num3 = element_number;
<a name="l00878"></a>00878             }
<a name="l00879"></a>00879           f4 = elem_faces(element_number,4);
<a name="l00880"></a>00880           num4 = face_voisins(f4,1);
<a name="l00881"></a>00881           <span class="keywordflow">if</span> (num4 == -1 || num4 &gt;= nb_elem)
<a name="l00882"></a>00882             {
<a name="l00883"></a>00883 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; bord num4 &quot; &lt;&lt; finl;</span>
<a name="l00884"></a>00884               num4 = element_number;
<a name="l00885"></a>00885             }
<a name="l00886"></a>00886           f5 = elem_faces(element_number,5);
<a name="l00887"></a>00887           num5 = face_voisins(f5,1);
<a name="l00888"></a>00888           <span class="keywordflow">if</span> (num5 == -1 || num5 &gt;= nb_elem)
<a name="l00889"></a>00889             {
<a name="l00890"></a>00890 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; bord num5 &quot; &lt;&lt; finl;</span>
<a name="l00891"></a>00891               num5 = element_number;
<a name="l00892"></a>00892             }
<a name="l00893"></a>00893 <span class="comment">// dQij_j(element_number,0)=0.5*((f(num3)*Qij(num3,0,0)-f(num0)*Qij(num0,0,0))/</span>
<a name="l00894"></a>00894 <span class="comment">// zone_VDF.dim_elem(element_number,0));</span>
<a name="l00895"></a>00895 <span class="comment">// dQij_j(element_number,0)+=0.5*((f(num4)*Qij(num4,0,1)-f(num1)*Qij(num1,0,1))/</span>
<a name="l00896"></a>00896 <span class="comment">// zone_VDF.dim_elem(element_number,1));</span>
<a name="l00897"></a>00897 <span class="comment">// dQij_j(element_number,0)+=0.5*((f(num5)*Qij(num5,0,2)-f(num2)*Qij(num2,0,2))/</span>
<a name="l00898"></a>00898 <span class="comment">// zone_VDF.dim_elem(element_number,2));</span>
<a name="l00899"></a>00899           dQij_j(element_number,0)=0.5*((f(num3)*Qij_1(num3,0)-f(num0)*Qij_1(num0,0))/
<a name="l00900"></a>00900                                         zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,0));
<a name="l00901"></a>00901           dQij_j(element_number,0)+=0.5*((f(num4)*Qij_2(num4,0)-f(num1)*Qij_2(num1,0))/
<a name="l00902"></a>00902                                          zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,1));
<a name="l00903"></a>00903           dQij_j(element_number,0)+=0.5*((f(num5)*Qij_3(num5,0)-f(num2)*Qij_3(num2,0))/
<a name="l00904"></a>00904                                          zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,2));
<a name="l00905"></a>00905 
<a name="l00906"></a>00906 
<a name="l00907"></a>00907 <span class="comment">// dQij_j(element_number,1)=0.5*((f(num3)*Qij(num3,1,0)-f(num0)*Qij(num0,1,0))/</span>
<a name="l00908"></a>00908 <span class="comment">// zone_VDF.dim_elem(element_number,0));</span>
<a name="l00909"></a>00909 <span class="comment">// dQij_j(element_number,1)+=0.5*((f(num4)*Qij(num4,1,1)-f(num1)*Qij(num1,1,1))/</span>
<a name="l00910"></a>00910 <span class="comment">// zone_VDF.dim_elem(element_number,1));</span>
<a name="l00911"></a>00911 <span class="comment">// dQij_j(element_number,1)+=0.5*((f(num5)*Qij(num5,1,2)-f(num2)*Qij(num2,1,2))/</span>
<a name="l00912"></a>00912 <span class="comment">// zone_VDF.dim_elem(element_number,2));</span>
<a name="l00913"></a>00913           dQij_j(element_number,1)=0.5*((f(num3)*Qij_1(num3,1)-f(num0)*Qij_1(num0,1))/
<a name="l00914"></a>00914                                         zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,0));
<a name="l00915"></a>00915           dQij_j(element_number,1)+=0.5*((f(num4)*Qij_2(num4,1)-f(num1)*Qij_2(num1,1))/
<a name="l00916"></a>00916                                          zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,1));
<a name="l00917"></a>00917           dQij_j(element_number,1)+=0.5*((f(num5)*Qij_3(num5,1)-f(num2)*Qij_3(num2,1))/
<a name="l00918"></a>00918                                          zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,2));
<a name="l00919"></a>00919 
<a name="l00920"></a>00920 <span class="comment">// dQij_j(element_number,2)=0.5*((f(num3)*Qij(num3,2,0)-f(num0)*Qij(num0,2,0))/</span>
<a name="l00921"></a>00921 <span class="comment">// zone_VDF.dim_elem(element_number,0));</span>
<a name="l00922"></a>00922 <span class="comment">// dQij_j(element_number,2)+=0.5*((f(num4)*Qij(num4,2,1)-f(num1)*Qij(num1,2,1))/</span>
<a name="l00923"></a>00923 <span class="comment">// zone_VDF.dim_elem(element_number,1));</span>
<a name="l00924"></a>00924 <span class="comment">// dQij_j(element_number,2)+=0.5*((f(num5)*Qij(num5,2,2)-f(num2)*Qij(num2,2,2))/</span>
<a name="l00925"></a>00925 <span class="comment">// zone_VDF.dim_elem(element_number,2));</span>
<a name="l00926"></a>00926           dQij_j(element_number,2)=0.5*((f(num3)*Qij_1(num3,2)-f(num0)*Qij_1(num0,2))/
<a name="l00927"></a>00927                                         zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,0));
<a name="l00928"></a>00928           dQij_j(element_number,2)+=0.5*((f(num4)*Qij_2(num4,2)-f(num1)*Qij_2(num1,2))/
<a name="l00929"></a>00929                                          zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,1));
<a name="l00930"></a>00930           dQij_j(element_number,2)+=0.5*((f(num5)*Qij_3(num5,2)-f(num2)*Qij_3(num2,2))/
<a name="l00931"></a>00931                                          zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(element_number,2));
<a name="l00932"></a>00932         }
<a name="l00933"></a>00933     }
<a name="l00934"></a>00934   dQij_j.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00935"></a>00935 <span class="comment">// double min_f=1.e6, max_f=-1.e6;</span>
<a name="l00936"></a>00936 <span class="comment">// double min_q=1.e6, max_q=-1.e6;</span>
<a name="l00937"></a>00937 <span class="comment">// double min_dq=1.e6, max_dq=-1.e6;</span>
<a name="l00938"></a>00938 <span class="comment">// for (element_number=0 ; element_number&lt;nb_elem ; element_number ++)</span>
<a name="l00939"></a>00939 <span class="comment">// {</span>
<a name="l00940"></a>00940 <span class="comment">// //           if (Qij(element_number,0,1)&lt;min_q)</span>
<a name="l00941"></a>00941 <span class="comment">// //             min_q=Qij(element_number,0,1);</span>
<a name="l00942"></a>00942 <span class="comment">// //           if (Qij(element_number,0,1)&gt;max_q)</span>
<a name="l00943"></a>00943 <span class="comment">// //             max_q=Qij(element_number,0,1);</span>
<a name="l00944"></a>00944 <span class="comment">// if (f(element_number)&lt;min_f)</span>
<a name="l00945"></a>00945 <span class="comment">// min_f=f(element_number);</span>
<a name="l00946"></a>00946 <span class="comment">// if (f(element_number)&gt;max_f)</span>
<a name="l00947"></a>00947 <span class="comment">// max_f=f(element_number);</span>
<a name="l00948"></a>00948 <span class="comment">// if (dQij_j(element_number,0)&lt;min_dq)</span>
<a name="l00949"></a>00949 <span class="comment">// min_dq=dQij_j(element_number,0);</span>
<a name="l00950"></a>00950 <span class="comment">// if (dQij_j(element_number,0)&gt;max_dq)</span>
<a name="l00951"></a>00951 <span class="comment">// max_dq=dQij_j(element_number,0);</span>
<a name="l00952"></a>00952 <span class="comment">// }</span>
<a name="l00953"></a>00953 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; min/max &quot; &lt;&lt; min_f &lt;&lt; &quot; &quot; &lt;&lt; max_f &lt;&lt; &quot; &quot;  &lt;&lt; min_dq &lt;&lt; &quot; &quot; &lt;&lt; max_dq &lt;&lt; finl;</span>
<a name="l00954"></a>00954 <span class="comment">// Cerr &lt;&lt; &quot; min/max &quot; &lt;&lt; min_f &lt;&lt; &quot; &quot; &lt;&lt; max_f &lt;&lt; &quot; &quot;  &lt;&lt; min_q &lt;&lt; &quot; &quot; &lt;&lt; max_q &lt;&lt; &quot; &quot; &lt;&lt; min_dq &lt;&lt; &quot; &quot; &lt;&lt; max_dq &lt;&lt; finl;</span>
<a name="l00955"></a>00955 
<a name="l00956"></a>00956   <span class="keywordtype">double</span> inc_s;
<a name="l00957"></a>00957 <span class="comment">// Cerr &lt;&lt; &quot;Force de volume (gradient de pression moteur) = &quot; &lt;&lt; source &lt;&lt; finl;</span>
<a name="l00958"></a>00958 
<a name="l00959"></a>00959 <span class="comment">// Boucle sur les conditions limites pour traiter les faces de bord</span>
<a name="l00960"></a>00960 <span class="comment">// Cerr &lt;&lt; me() &lt;&lt; &quot; cond lims &quot; &lt;&lt; finl;</span>
<a name="l00961"></a>00961   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;zone_VDF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00962"></a>00962     {
<a name="l00963"></a>00963 
<a name="l00964"></a>00964 <span class="comment">// pour chaque Condition Limite on regarde son type</span>
<a name="l00965"></a>00965 <span class="comment">// Si face de Dirichlet ou de Symetrie on ne fait rien</span>
<a name="l00966"></a>00966 <span class="comment">// Si face de Neumann on calcule la contribution au terme source</span>
<a name="l00967"></a>00967 
<a name="l00968"></a>00968       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VDF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00969"></a>00969 
<a name="l00970"></a>00970       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00971"></a>00971         {
<a name="l00972"></a>00972 
<a name="l00973"></a>00973 <span class="comment">// const Neumann_sortie_libre&amp; la_cl_neumann = ref_cast(Neumann_sortie_libre,la_cl.valeur());</span>
<a name="l00974"></a>00974           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00975"></a>00975           ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00976"></a>00976           nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00977"></a>00977 
<a name="l00978"></a>00978           <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00979"></a>00979             {
<a name="l00980"></a>00980               vol = volumes_entrelaces(num_face)*porosite_surf(num_face);
<a name="l00981"></a>00981               ncomp = orientation(num_face);
<a name="l00982"></a>00982               num0 = face_voisins(num_face,0);
<a name="l00983"></a>00983               <span class="keywordflow">if</span> (num0 == -1)
<a name="l00984"></a>00984                 num0 = face_voisins(num_face,1);
<a name="l00985"></a>00985               inc_s=dQij_j(num0,ncomp)*vol;
<a name="l00986"></a>00986 <span class="comment">// resu(num_face)+= s(ncomp)*vol;</span>
<a name="l00987"></a>00987               resu(num_face)+= inc_s;
<a name="l00988"></a>00988             }
<a name="l00989"></a>00989         }
<a name="l00990"></a>00990 
<a name="l00991"></a>00991       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classSymetrie.html" title="classe Symetrie Sur les faces de symetrie on a les proprietes suivantes: - composante normale de la v...">Symetrie</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00992"></a>00992         ;
<a name="l00993"></a>00993       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00994"></a>00994                 ||
<a name="l00995"></a>00995                 (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00996"></a>00996               )
<a name="l00997"></a>00997         ;
<a name="l00998"></a>00998       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00999"></a>00999         {
<a name="l01000"></a>01000           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l01001"></a>01001           ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l01002"></a>01002           nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l01003"></a>01003 
<a name="l01004"></a>01004           <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l01005"></a>01005             {
<a name="l01006"></a>01006               vol = volumes_entrelaces(num_face)*porosite_surf(num_face);
<a name="l01007"></a>01007               ncomp = orientation(num_face);
<a name="l01008"></a>01008               num0 = face_voisins(num_face,0);
<a name="l01009"></a>01009               <span class="keywordflow">if</span> (num0 == -1)
<a name="l01010"></a>01010                 num0 = face_voisins(num_face,1);
<a name="l01011"></a>01011               inc_s=dQij_j(num0,ncomp)*vol;
<a name="l01012"></a>01012 <span class="comment">// resu(num_face)+= s(ncomp)*vol;</span>
<a name="l01013"></a>01013               resu(num_face)+= inc_s;
<a name="l01014"></a>01014 
<a name="l01015"></a>01015             }
<a name="l01016"></a>01016         }
<a name="l01017"></a>01017     }
<a name="l01018"></a>01018 
<a name="l01019"></a>01019 <span class="comment">// Boucle sur les faces internes</span>
<a name="l01020"></a>01020   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">me</a>() &lt;&lt; <span class="stringliteral">&quot; faces internes &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01021"></a>01021 
<a name="l01022"></a>01022   <span class="keywordtype">double</span> min_inc=1.e6, max_inc=-1.e6;
<a name="l01023"></a>01023   <span class="keywordtype">int</span> num_e1, n_comp1;
<a name="l01024"></a>01024   <span class="keywordtype">int</span> num_e2, n_comp2;
<a name="l01025"></a>01025   ndeb = zone_VDF.<a class="code" href="classZone__VF.html#a12869806fa4834aca8f2964e16509dfd" title="une face est interne ssi elle separe deux elements. renvoie le numero de la premiere face interne...">premiere_face_int</a>();
<a name="l01026"></a>01026   <span class="keywordflow">for</span> (num_face =zone_VDF.<a class="code" href="classZone__VF.html#a12869806fa4834aca8f2964e16509dfd" title="une face est interne ssi elle separe deux elements. renvoie le numero de la premiere face interne...">premiere_face_int</a>(); num_face&lt;zone_VDF.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>(); num_face++)
<a name="l01027"></a>01027     {
<a name="l01028"></a>01028 
<a name="l01029"></a>01029       vol = volumes_entrelaces(num_face)*porosite_surf(num_face);
<a name="l01030"></a>01030       ncomp = orientation(num_face);
<a name="l01031"></a>01031       num0 = face_voisins(num_face,0);
<a name="l01032"></a>01032       num1 = face_voisins(num_face,1);
<a name="l01033"></a>01033       inc_s=0.5*(dQij_j(num0,ncomp)+dQij_j(num1,ncomp))*vol;
<a name="l01034"></a>01034 <span class="comment">// resu(num_face)+= s(ncomp)*vol;</span>
<a name="l01035"></a>01035       resu(num_face)+= inc_s;
<a name="l01036"></a>01036       <span class="keywordflow">if</span> (inc_s&lt;min_inc)
<a name="l01037"></a>01037         {
<a name="l01038"></a>01038           min_inc=inc_s;
<a name="l01039"></a>01039           num_e1=num0;
<a name="l01040"></a>01040           n_comp1=ncomp;
<a name="l01041"></a>01041         }
<a name="l01042"></a>01042       <span class="keywordflow">if</span> (inc_s&gt;max_inc)
<a name="l01043"></a>01043         {
<a name="l01044"></a>01044           max_inc=inc_s;
<a name="l01045"></a>01045           num_e2=num0;
<a name="l01046"></a>01046           n_comp2=ncomp;
<a name="l01047"></a>01047         }
<a name="l01048"></a>01048     }
<a name="l01049"></a>01049   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; min_inc &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; num_e1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; n_comp1 &lt;&lt; finl;
<a name="l01050"></a>01050   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; max_inc &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; num_e2 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; n_comp2 &lt;&lt; finl;
<a name="l01051"></a>01051   resu.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01052"></a>01052   <span class="keywordflow">return</span> resu;
<a name="l01053"></a>01053 }
<a name="l01054"></a>01054 
<a name="l01055"></a><a class="code" href="classTerme__Source__inc__VDF__Face.html#ab23e01b9d627923750384020ccf8373f">01055</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classTerme__Source__inc__VDF__Face.html#ab23e01b9d627923750384020ccf8373f">Terme_Source_inc_VDF_Face::calculer</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01056"></a>01056 <span class="keyword"></span>{
<a name="l01057"></a>01057   resu = 0;
<a name="l01058"></a>01058   <a class="code" href="classTerme__Source__inc__VDF__Face.html#a9a2b18fec2172febc2580eb3347c11b9">ajouter</a>(resu);
<a name="l01059"></a>01059   resu.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01060"></a>01060   <span class="keywordflow">return</span> resu;
<a name="l01061"></a>01061 }
<a name="l01062"></a>01062 
<a name="l01063"></a>01063 
<a name="l01064"></a>01064 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:41 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
