<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Math/Matrices/Matrix_tools.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Math/Matrices/Matrix_tools.cpp</div>  </div>
</div>
<div class="contents">
<a href="Matrix__tools_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2019, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Matrix_tools.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Math/Matrices</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/2</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Matrix__tools_8h.html">Matrix_tools.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Matrice_8h.html">Matrice.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Base_8h.html">Matrice_Base.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Nulle_8h.html">Matrice_Nulle.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Diagonale_8h.html">Matrice_Diagonale.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse_8h.html">Matrice_Morse.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse__Sym_8h.html">Matrice_Morse_Sym.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="IntTab_8h.html">IntTab.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="ArrOfDouble_8h.html">ArrOfDouble.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Array__tools_8h.html">Array_tools.h</a>&gt;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="comment">// conversion to morse format</span>
<a name="l00035"></a><a class="code" href="classMatrix__tools.html#a883a58fdfaec4bcdf4cb9b280d6682dd">00035</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#a883a58fdfaec4bcdf4cb9b280d6682dd">Matrix_tools::convert_to_morse_matrix</a>( <span class="keyword">const</span> <a class="code" href="classMatrice__Base.html">Matrice_Base</a>&amp; in,
<a name="l00036"></a>00036                                             <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp;      out )
<a name="l00037"></a>00037 {
<a name="l00038"></a>00038   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> stencil;
<a name="l00039"></a>00039   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> coefficients;
<a name="l00040"></a>00040 
<a name="l00041"></a>00041   in.<a class="code" href="classMatrice__Base.html#abdb1a534ff53b8e4dba303cb1df9e90a">get_stencil_and_coefficients</a>( stencil, coefficients );
<a name="l00042"></a>00042 
<a name="l00043"></a>00043   <a class="code" href="classMatrix__tools.html#aec0884c9772d5ea34f81912ae244aefb">Matrix_tools::build_morse_matrix</a>( in.<a class="code" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">nb_lignes</a>( ),
<a name="l00044"></a>00044                                     in.<a class="code" href="classMatrice__Base.html#a8aff414991f0c4f80d8581fbbda62cae">nb_colonnes</a>( ),
<a name="l00045"></a>00045                                     stencil,
<a name="l00046"></a>00046                                     coefficients,
<a name="l00047"></a>00047                                     out );
<a name="l00048"></a>00048 }
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="comment">// conversion to symetric morse format</span>
<a name="l00053"></a><a class="code" href="classMatrix__tools.html#afb9029f1822e71384cb9a04f0c772464">00053</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#afb9029f1822e71384cb9a04f0c772464">Matrix_tools::convert_to_symmetric_morse_matrix</a>( <span class="keyword">const</span> <a class="code" href="classMatrice__Base.html">Matrice_Base</a>&amp; in,
<a name="l00054"></a>00054                                                       <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp;  out )
<a name="l00055"></a>00055 {
<a name="l00056"></a>00056   assert( in.<a class="code" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">nb_lignes</a>( ) == in.<a class="code" href="classMatrice__Base.html#a8aff414991f0c4f80d8581fbbda62cae">nb_colonnes</a>( ) );
<a name="l00057"></a>00057 
<a name="l00058"></a>00058   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> stencil;
<a name="l00059"></a>00059   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> coefficients;
<a name="l00060"></a>00060 
<a name="l00061"></a>00061   in.<a class="code" href="classMatrice__Base.html#aa97ade54dcec93f34c69a463db717079">get_symmetric_stencil_and_coefficients</a>( stencil, coefficients );
<a name="l00062"></a>00062 
<a name="l00063"></a>00063   <a class="code" href="classMatrix__tools.html#ae7dc650ed93e2c58315be8f58fc7f033">Matrix_tools::build_symmetric_morse_matrix</a>( in.<a class="code" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">nb_lignes</a>( ),
<a name="l00064"></a>00064                                               stencil,
<a name="l00065"></a>00065                                               coefficients,
<a name="l00066"></a>00066                                               out );
<a name="l00067"></a>00067 }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 <span class="comment">// checking stencil</span>
<a name="l00070"></a><a class="code" href="classMatrix__tools.html#a65b2c128c19a22f2905cd3821e14f7f7">00070</a> <span class="keywordtype">bool</span> <a class="code" href="classMatrix__tools.html#a65b2c128c19a22f2905cd3821e14f7f7">Matrix_tools::is_normalized_stencil</a>( <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; stencil )
<a name="l00071"></a>00071 {
<a name="l00072"></a>00072   <span class="keyword">const</span> <span class="keywordtype">int</span> size = stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00073"></a>00073   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=1; i&lt;size; ++i )
<a name="l00074"></a>00074     {
<a name="l00075"></a>00075       <span class="keywordtype">int</span> delta1 = stencil( i-1, 0 ) - stencil( i, 0 );
<a name="l00076"></a>00076       <span class="keywordtype">int</span> delta2 = stencil( i-1, 1 ) - stencil( i, 1 );
<a name="l00077"></a>00077       <span class="keywordtype">int</span> delta  = ( delta1 == 0 ) ? delta2 : delta1;
<a name="l00078"></a>00078 
<a name="l00079"></a>00079       <span class="keywordflow">if</span> ( delta &gt;= 0 )
<a name="l00080"></a>00080         {
<a name="l00081"></a>00081           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00082"></a>00082         }
<a name="l00083"></a>00083     }
<a name="l00084"></a>00084   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="comment">// checking symmetric stencil</span>
<a name="l00088"></a><a class="code" href="classMatrix__tools.html#adb8508bde9cb7b1db78f41e497b7ae04">00088</a> <span class="keywordtype">bool</span> <a class="code" href="classMatrix__tools.html#adb8508bde9cb7b1db78f41e497b7ae04">Matrix_tools::is_normalized_symmetric_stencil</a>( <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; stencil )
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090   <span class="keywordflow">if</span> ( ! ( <a class="code" href="classMatrix__tools.html#a65b2c128c19a22f2905cd3821e14f7f7">is_normalized_stencil</a>( stencil ) ) )
<a name="l00091"></a>00091     {
<a name="l00092"></a>00092       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;non-normalized stencil&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00093"></a>00093       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00094"></a>00094     }
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <span class="keyword">const</span> <span class="keywordtype">int</span> size = stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00097"></a>00097   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;size; ++i )
<a name="l00098"></a>00098     {
<a name="l00099"></a>00099       <span class="keywordtype">int</span> delta = stencil( i, 0 ) - stencil( i, 1 );
<a name="l00100"></a>00100       <span class="keywordflow">if</span> ( delta &gt; 0 )
<a name="l00101"></a>00101         {
<a name="l00102"></a>00102           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; ) line index &gt; column index : ( &quot;</span> &lt;&lt; stencil( i, 0 ) &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; stencil( i, 1 ) &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00103"></a>00103           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00104"></a>00104         }
<a name="l00105"></a>00105     }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00108"></a>00108 }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 <span class="comment">// building morse matrices</span>
<a name="l00112"></a><a class="code" href="classMatrix__tools.html#a481961691c1dbee5372da25777e5c1e8">00112</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#a481961691c1dbee5372da25777e5c1e8">Matrix_tools::allocate_morse_matrix</a>( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp;  nb_lines,
<a name="l00113"></a>00113                                           <span class="keyword">const</span> <span class="keywordtype">int</span>&amp;  nb_columns,
<a name="l00114"></a>00114                                           <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp;  stencil,
<a name="l00115"></a>00115                                           <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrix ,
<a name="l00116"></a>00116                                           <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; attach_stencil_to_matrix )
<a name="l00117"></a>00117 {
<a name="l00118"></a>00118   assert( <a class="code" href="classMatrix__tools.html#a65b2c128c19a22f2905cd3821e14f7f7">is_normalized_stencil</a>( stencil ) );
<a name="l00119"></a>00119 
<a name="l00120"></a>00120   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_coefficients = stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00121"></a>00121 
<a name="l00122"></a>00122   matrix.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>( nb_lines,
<a name="l00123"></a>00123                        nb_columns,
<a name="l00124"></a>00124                        nb_coefficients );
<a name="l00125"></a>00125 
<a name="l00126"></a>00126   <span class="keywordflow">if</span> ( nb_coefficients &gt; 0 )
<a name="l00127"></a>00127     {
<a name="l00128"></a>00128       matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>( ) = 0 ;
<a name="l00129"></a>00129       matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>( )( 0 ) = 1;
<a name="l00130"></a>00130       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_coefficients; ++i )
<a name="l00131"></a>00131         {
<a name="l00132"></a>00132           assert( stencil( i ,0 ) &gt;= 0         );
<a name="l00133"></a>00133           assert( stencil( i ,0 ) &lt; nb_lines   );
<a name="l00134"></a>00134           assert( stencil( i ,1 ) &gt;= 0         );
<a name="l00135"></a>00135           assert( stencil( i ,1 ) &lt; nb_columns );
<a name="l00136"></a>00136 
<a name="l00137"></a>00137           matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>( )( stencil( i, 0 ) + 1 ) += 1;
<a name="l00138"></a>00138           matrix.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>( )( i ) = stencil( i, 1 ) + 1;
<a name="l00139"></a>00139         }
<a name="l00140"></a>00140       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
<a name="l00141"></a>00141         {
<a name="l00142"></a>00142           matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>()( i + 1 ) += matrix.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()( i );
<a name="l00143"></a>00143         }
<a name="l00144"></a>00144     }
<a name="l00145"></a>00145 
<a name="l00146"></a>00146   <span class="keywordflow">if</span>( attach_stencil_to_matrix )
<a name="l00147"></a>00147     {
<a name="l00148"></a>00148       matrix.<a class="code" href="classMatrice__Base.html#a7bf83f36d9929eb7da655a9cd2f00def">set_stencil</a>( stencil );
<a name="l00149"></a>00149     }
<a name="l00150"></a>00150 }
<a name="l00151"></a>00151 
<a name="l00152"></a><a class="code" href="classMatrix__tools.html#aec0884c9772d5ea34f81912ae244aefb">00152</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#aec0884c9772d5ea34f81912ae244aefb">Matrix_tools::build_morse_matrix</a>( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp;      nb_lines,
<a name="l00153"></a>00153                                        <span class="keyword">const</span> <span class="keywordtype">int</span>&amp;      nb_columns,
<a name="l00154"></a>00154                                        <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp;      stencil,
<a name="l00155"></a>00155                                        <span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; coefficients,
<a name="l00156"></a>00156                                        <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp;     matrix )
<a name="l00157"></a>00157 {
<a name="l00158"></a>00158   assert( <a class="code" href="classMatrix__tools.html#a65b2c128c19a22f2905cd3821e14f7f7">is_normalized_stencil</a>( stencil ) );
<a name="l00159"></a>00159 
<a name="l00160"></a>00160   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_coefficients = stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00161"></a>00161   assert( nb_coefficients == coefficients.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) );
<a name="l00162"></a>00162 
<a name="l00163"></a>00163   matrix.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>( nb_lines,
<a name="l00164"></a>00164                        nb_columns,
<a name="l00165"></a>00165                        nb_coefficients );
<a name="l00166"></a>00166 
<a name="l00167"></a>00167   <span class="keywordflow">if</span> ( nb_coefficients &gt; 0 )
<a name="l00168"></a>00168     {
<a name="l00169"></a>00169       matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>() =0  ;
<a name="l00170"></a>00170       matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>()( 0 ) = 1;
<a name="l00171"></a>00171       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_coefficients; ++i )
<a name="l00172"></a>00172         {
<a name="l00173"></a>00173           assert( stencil( i ,0 ) &gt;= 0         );
<a name="l00174"></a>00174           assert( stencil( i ,0 ) &lt; nb_lines   );
<a name="l00175"></a>00175           assert( stencil( i ,1 ) &gt;= 0         );
<a name="l00176"></a>00176           assert( stencil( i ,1 ) &lt; nb_columns );
<a name="l00177"></a>00177 
<a name="l00178"></a>00178           matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>()( stencil( i, 0 ) + 1 ) += 1;
<a name="l00179"></a>00179           matrix.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>()( i ) = stencil( i, 1 ) + 1;
<a name="l00180"></a>00180           matrix.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>()( i ) = coefficients[ i ];
<a name="l00181"></a>00181         }
<a name="l00182"></a>00182       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
<a name="l00183"></a>00183         {
<a name="l00184"></a>00184           matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>()( i + 1 ) += matrix.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()( i );
<a name="l00185"></a>00185         }
<a name="l00186"></a>00186     }
<a name="l00187"></a>00187 }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">// building symmetric morse matrices</span>
<a name="l00192"></a><a class="code" href="classMatrix__tools.html#ad452da2005d07c2ef2d33ed32936d0a9">00192</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#ad452da2005d07c2ef2d33ed32936d0a9">Matrix_tools::allocate_symmetric_morse_matrix</a>( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp;      order,
<a name="l00193"></a>00193                                                     <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp;      stencil,
<a name="l00194"></a>00194                                                     <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; matrix )
<a name="l00195"></a>00195 {
<a name="l00196"></a>00196   assert( <a class="code" href="classMatrix__tools.html#adb8508bde9cb7b1db78f41e497b7ae04">is_normalized_symmetric_stencil</a>( stencil ) );
<a name="l00197"></a>00197 
<a name="l00198"></a>00198   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_coefficients = stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00199"></a>00199 
<a name="l00200"></a>00200   matrix.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>( order,
<a name="l00201"></a>00201                        order,
<a name="l00202"></a>00202                        nb_coefficients );
<a name="l00203"></a>00203 
<a name="l00204"></a>00204   <span class="keywordflow">if</span> ( nb_coefficients &gt; 0 )
<a name="l00205"></a>00205     {
<a name="l00206"></a>00206       matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>()= 0 ;
<a name="l00207"></a>00207       matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>()( 0 ) = 1;
<a name="l00208"></a>00208       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_coefficients; ++i )
<a name="l00209"></a>00209         {
<a name="l00210"></a>00210           assert( stencil( i ,0 ) &gt;= 0               );
<a name="l00211"></a>00211           assert( stencil( i ,0 ) &lt; order            );
<a name="l00212"></a>00212           assert( stencil( i ,1 ) &gt;= 0               );
<a name="l00213"></a>00213           assert( stencil( i ,1 ) &lt; order            );
<a name="l00214"></a>00214           assert( stencil( i, 0 ) &lt;= stencil( i, 1 ) );
<a name="l00215"></a>00215 
<a name="l00216"></a>00216           matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>()( stencil( i, 0 ) + 1 ) += 1;
<a name="l00217"></a>00217           matrix.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>()( i ) = stencil( i, 1 ) + 1;
<a name="l00218"></a>00218         }
<a name="l00219"></a>00219       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;order; ++i )
<a name="l00220"></a>00220         {
<a name="l00221"></a>00221           matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>()( i + 1 ) += matrix.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()( i );
<a name="l00222"></a>00222         }
<a name="l00223"></a>00223     }
<a name="l00224"></a>00224   matrix.<a class="code" href="classMatrice__Morse.html#ae99753a8725a9a7f58b62d6e675a69d8">set_symmetric</a>( 1 );
<a name="l00225"></a>00225 }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 
<a name="l00228"></a><a class="code" href="classMatrix__tools.html#ae7dc650ed93e2c58315be8f58fc7f033">00228</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#ae7dc650ed93e2c58315be8f58fc7f033">Matrix_tools::build_symmetric_morse_matrix</a>( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp;      order,
<a name="l00229"></a>00229                                                  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp;      stencil,
<a name="l00230"></a>00230                                                  <span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; coefficients,
<a name="l00231"></a>00231                                                  <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; matrix )
<a name="l00232"></a>00232 {
<a name="l00233"></a>00233   assert( <a class="code" href="classMatrix__tools.html#adb8508bde9cb7b1db78f41e497b7ae04">is_normalized_symmetric_stencil</a>( stencil ) );
<a name="l00234"></a>00234 
<a name="l00235"></a>00235   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_coefficients = stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00236"></a>00236   assert( nb_coefficients == coefficients.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) );
<a name="l00237"></a>00237 
<a name="l00238"></a>00238   matrix.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>( order,
<a name="l00239"></a>00239                        order,
<a name="l00240"></a>00240                        nb_coefficients );
<a name="l00241"></a>00241 
<a name="l00242"></a>00242   <span class="keywordflow">if</span> ( nb_coefficients &gt; 0 )
<a name="l00243"></a>00243     {
<a name="l00244"></a>00244       matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>() = 0 ;
<a name="l00245"></a>00245       matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>()( 0 ) = 1;
<a name="l00246"></a>00246       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_coefficients; ++i )
<a name="l00247"></a>00247         {
<a name="l00248"></a>00248           assert( stencil( i ,0 ) &gt;= 0               );
<a name="l00249"></a>00249           assert( stencil( i ,0 ) &lt; order            );
<a name="l00250"></a>00250           assert( stencil( i ,1 ) &gt;= 0               );
<a name="l00251"></a>00251           assert( stencil( i ,1 ) &lt; order            );
<a name="l00252"></a>00252           assert( stencil( i, 0 ) &lt;= stencil( i, 1 ) );
<a name="l00253"></a>00253 
<a name="l00254"></a>00254           matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>()( stencil( i, 0 ) + 1 ) += 1;
<a name="l00255"></a>00255           matrix.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>()( i )  = stencil( i, 1 ) + 1;
<a name="l00256"></a>00256           matrix.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>()( i ) = coefficients[ i ];
<a name="l00257"></a>00257         }
<a name="l00258"></a>00258       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;order; ++i )
<a name="l00259"></a>00259         {
<a name="l00260"></a>00260           matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>()( i + 1 ) += matrix.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()( i );
<a name="l00261"></a>00261         }
<a name="l00262"></a>00262     }
<a name="l00263"></a>00263   matrix.<a class="code" href="classMatrice__Morse.html#ae99753a8725a9a7f58b62d6e675a69d8">set_symmetric</a>( 1 );
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="comment">// allocation for scaled addition</span>
<a name="l00268"></a><a class="code" href="classMatrix__tools.html#afd39fcedc82a6b321c72bdab50821998">00268</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#afd39fcedc82a6b321c72bdab50821998">Matrix_tools::allocate_for_scaled_addition</a>( <span class="keyword">const</span> <a class="code" href="classMatrice.html">Matrice</a>&amp; A,
<a name="l00269"></a>00269                                                  <span class="keyword">const</span> <a class="code" href="classMatrice.html">Matrice</a>&amp; B,
<a name="l00270"></a>00270                                                  <a class="code" href="classMatrice.html">Matrice</a>&amp;       C )
<a name="l00271"></a>00271 {
<a name="l00272"></a>00272   assert( A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">nb_lignes</a>( )   == B.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">nb_lignes</a>( )   );
<a name="l00273"></a>00273   assert( A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a8aff414991f0c4f80d8581fbbda62cae">nb_colonnes</a>( ) == B.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a8aff414991f0c4f80d8581fbbda62cae">nb_colonnes</a>( ) );
<a name="l00274"></a>00274 
<a name="l00275"></a>00275   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> A_stencil;
<a name="l00276"></a>00276   A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a62ec15030f4e1395b28a85346a0886f2">get_stencil</a>( A_stencil );
<a name="l00277"></a>00277   <span class="keyword">const</span> <span class="keywordtype">int</span> A_size = A_stencil.dimension( 0 );
<a name="l00278"></a>00278 
<a name="l00279"></a>00279   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> B_stencil;
<a name="l00280"></a>00280   B.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a62ec15030f4e1395b28a85346a0886f2">get_stencil</a>( B_stencil );
<a name="l00281"></a>00281   <span class="keyword">const</span> <span class="keywordtype">int</span> B_size = B_stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00282"></a>00282 
<a name="l00283"></a>00283   <span class="keywordtype">int</span> size = A_size + B_size;
<a name="l00284"></a>00284   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> stencil;
<a name="l00285"></a>00285   stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l00286"></a>00286   stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( size, 2 );
<a name="l00287"></a>00287 
<a name="l00288"></a>00288   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;A_size; ++i )
<a name="l00289"></a>00289     {
<a name="l00290"></a>00290       stencil( i , 0 ) = A_stencil( i, 0 );
<a name="l00291"></a>00291       stencil( i , 1 ) = A_stencil( i, 1 ) ;
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293 
<a name="l00294"></a>00294   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;B_size; ++i )
<a name="l00295"></a>00295     {
<a name="l00296"></a>00296       stencil( i+A_size , 0 ) = B_stencil( i, 0 );
<a name="l00297"></a>00297       stencil( i+A_size , 1 ) = B_stencil( i, 1 ) ;
<a name="l00298"></a>00298     }
<a name="l00299"></a>00299 
<a name="l00300"></a>00300   <a class="code" href="Array__tools_8cpp.html#a07eed4c823b0632bdbf353fdab2a3c6b" title="Trie le tableau tab dans l&#39;ordre lexicographique et retire les doublons (attention [1...">tableau_trier_retirer_doublons</a>( stencil );
<a name="l00301"></a>00301 
<a name="l00302"></a>00302   C.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>( <span class="stringliteral">&quot;Matrice_Morse&quot;</span> );
<a name="l00303"></a>00303   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; C_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>( <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>, C.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ) );
<a name="l00304"></a>00304 
<a name="l00305"></a>00305   <a class="code" href="classMatrix__tools.html#a481961691c1dbee5372da25777e5c1e8">allocate_morse_matrix</a>( A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">nb_lignes</a>( ),
<a name="l00306"></a>00306                          A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a8aff414991f0c4f80d8581fbbda62cae">nb_colonnes</a>( ),
<a name="l00307"></a>00307                          stencil,
<a name="l00308"></a>00308                          C_ );
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a><a class="code" href="classMatrix__tools.html#a4c61a40790267a9a4ac56421f3d8092b">00311</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#a4c61a40790267a9a4ac56421f3d8092b">Matrix_tools::allocate_for_symmetric_scaled_addition</a>( <span class="keyword">const</span> <a class="code" href="classMatrice.html">Matrice</a>&amp; A,
<a name="l00312"></a>00312                                                            <span class="keyword">const</span> <a class="code" href="classMatrice.html">Matrice</a>&amp; B,
<a name="l00313"></a>00313                                                            <a class="code" href="classMatrice.html">Matrice</a>&amp;       C )
<a name="l00314"></a>00314 {
<a name="l00315"></a>00315   assert( A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">nb_lignes</a>( )   == A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">nb_lignes</a>( )   );
<a name="l00316"></a>00316   assert( A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">nb_lignes</a>( )   == B.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">nb_lignes</a>( )   );
<a name="l00317"></a>00317   assert( A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a8aff414991f0c4f80d8581fbbda62cae">nb_colonnes</a>( ) == B.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a8aff414991f0c4f80d8581fbbda62cae">nb_colonnes</a>( ) );
<a name="l00318"></a>00318 
<a name="l00319"></a>00319   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> A_stencil;
<a name="l00320"></a>00320   A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a080cc472da361a4e84e528e28aa9d16b">get_symmetric_stencil</a>( A_stencil );
<a name="l00321"></a>00321   <span class="keyword">const</span> <span class="keywordtype">int</span> A_size = A_stencil.dimension( 0 );
<a name="l00322"></a>00322 
<a name="l00323"></a>00323   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> B_stencil;
<a name="l00324"></a>00324   B.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a080cc472da361a4e84e528e28aa9d16b">get_symmetric_stencil</a>( B_stencil );
<a name="l00325"></a>00325   <span class="keyword">const</span> <span class="keywordtype">int</span> B_size = B_stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00326"></a>00326 
<a name="l00327"></a>00327   <span class="keywordtype">int</span> size = A_size + B_size;
<a name="l00328"></a>00328   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> stencil;
<a name="l00329"></a>00329   stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l00330"></a>00330   stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( size, 2 );
<a name="l00331"></a>00331 
<a name="l00332"></a>00332   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;A_size; ++i )
<a name="l00333"></a>00333     {
<a name="l00334"></a>00334       stencil( i , 0 ) = A_stencil( i, 0 );
<a name="l00335"></a>00335       stencil( i , 1 ) = A_stencil( i, 1 ) ;
<a name="l00336"></a>00336     }
<a name="l00337"></a>00337 
<a name="l00338"></a>00338   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;B_size; ++i )
<a name="l00339"></a>00339     {
<a name="l00340"></a>00340       stencil( i+A_size , 0 ) = B_stencil( i, 0 );
<a name="l00341"></a>00341       stencil( i+A_size , 1 ) = B_stencil( i, 1 ) ;
<a name="l00342"></a>00342     }
<a name="l00343"></a>00343 
<a name="l00344"></a>00344   <a class="code" href="Array__tools_8cpp.html#a07eed4c823b0632bdbf353fdab2a3c6b" title="Trie le tableau tab dans l&#39;ordre lexicographique et retire les doublons (attention [1...">tableau_trier_retirer_doublons</a>( stencil );
<a name="l00345"></a>00345 
<a name="l00346"></a>00346   C.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>( <span class="stringliteral">&quot;Matrice_Morse_Sym&quot;</span> );
<a name="l00347"></a>00347   <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; C_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>( <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, C.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ) );
<a name="l00348"></a>00348 
<a name="l00349"></a>00349   <a class="code" href="classMatrix__tools.html#ad452da2005d07c2ef2d33ed32936d0a9">allocate_symmetric_morse_matrix</a>( A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">nb_lignes</a>( ),
<a name="l00350"></a>00350                                    stencil,
<a name="l00351"></a>00351                                    C_ );
<a name="l00352"></a>00352 }
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 <span class="comment">// scaled addition</span>
<a name="l00356"></a><a class="code" href="classMatrix__tools.html#a03eaa7f480ae812cae9c502944fba97b">00356</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#a03eaa7f480ae812cae9c502944fba97b">Matrix_tools::add_scaled_matrices</a>( <span class="keyword">const</span> <a class="code" href="classMatrice.html">Matrice</a>&amp; A,
<a name="l00357"></a>00357                                         <span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  alpha,
<a name="l00358"></a>00358                                         <span class="keyword">const</span> <a class="code" href="classMatrice.html">Matrice</a>&amp; B,
<a name="l00359"></a>00359                                         <span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  beta,
<a name="l00360"></a>00360                                         <a class="code" href="classMatrice.html">Matrice</a>&amp;       C )
<a name="l00361"></a>00361 {
<a name="l00362"></a>00362   assert( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>( <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>, C.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ) ) );
<a name="l00363"></a>00363   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; C_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>( <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>, C.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ) );
<a name="l00364"></a>00364 
<a name="l00365"></a>00365   assert( C_.<a class="code" href="classMatrice__Morse.html#a16be4586cacf33093dcd6a8fd804f7f0">check_sorted_morse_matrix_structure</a>( ) );
<a name="l00366"></a>00366 
<a name="l00367"></a>00367   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> A_stencil;
<a name="l00368"></a>00368   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> A_coefficients;
<a name="l00369"></a>00369   A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#abdb1a534ff53b8e4dba303cb1df9e90a">get_stencil_and_coefficients</a>( A_stencil,
<a name="l00370"></a>00370                                             A_coefficients );
<a name="l00371"></a>00371 
<a name="l00372"></a>00372   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> B_stencil;
<a name="l00373"></a>00373   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> B_coefficients;
<a name="l00374"></a>00374   B.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#abdb1a534ff53b8e4dba303cb1df9e90a">get_stencil_and_coefficients</a>( B_stencil,
<a name="l00375"></a>00375                                             B_coefficients );
<a name="l00376"></a>00376 
<a name="l00377"></a>00377   <span class="keywordtype">int</span> A_k = 0;
<a name="l00378"></a>00378   <span class="keywordtype">int</span> B_k = 0;
<a name="l00379"></a>00379 
<a name="l00380"></a>00380   C_.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>() = 0.0 ;
<a name="l00381"></a>00381 
<a name="l00382"></a>00382   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = C_.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l00383"></a>00383   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
<a name="l00384"></a>00384     {
<a name="l00385"></a>00385       <span class="keywordtype">int</span> k0   = C_.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()( i ) - 1;
<a name="l00386"></a>00386       <span class="keywordtype">int</span> k1   = C_.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()( i + 1 ) - 1;
<a name="l00387"></a>00387 
<a name="l00388"></a>00388       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=k0; k&lt;k1; ++k )
<a name="l00389"></a>00389         {
<a name="l00390"></a>00390           <span class="keywordtype">int</span> j = C_.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>()( k ) - 1;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392           <span class="keywordflow">if</span> ( ( A_k &lt; A_stencil.dimension( 0 ) ) &amp;&amp; ( A_stencil( A_k, 0 ) == i ) &amp;&amp; ( A_stencil( A_k, 1 ) == j ) )
<a name="l00393"></a>00393             {
<a name="l00394"></a>00394               C_.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>()( k ) += alpha * A_coefficients[ A_k ];
<a name="l00395"></a>00395               ++A_k;
<a name="l00396"></a>00396             }
<a name="l00397"></a>00397 
<a name="l00398"></a>00398           <span class="keywordflow">if</span> ( ( B_k &lt; B_stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 ) ) &amp;&amp; ( B_stencil( B_k, 0 ) == i ) &amp;&amp; ( B_stencil( B_k, 1 ) == j ) )
<a name="l00399"></a>00399             {
<a name="l00400"></a>00400               C_.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>()( k ) += beta * B_coefficients[ B_k ];
<a name="l00401"></a>00401               ++B_k;
<a name="l00402"></a>00402             }
<a name="l00403"></a>00403         }
<a name="l00404"></a>00404     }
<a name="l00405"></a>00405 
<a name="l00406"></a>00406   assert( A_k == A_coefficients.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) );
<a name="l00407"></a>00407   assert( B_k == B_coefficients.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) );
<a name="l00408"></a>00408 }
<a name="l00409"></a>00409 
<a name="l00410"></a><a class="code" href="classMatrix__tools.html#ad5692fd52104fed2f5f1c880c5a551ba">00410</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#ad5692fd52104fed2f5f1c880c5a551ba">Matrix_tools::add_symmetric_scaled_matrices</a>( <span class="keyword">const</span> <a class="code" href="classMatrice.html">Matrice</a>&amp; A,
<a name="l00411"></a>00411                                                   <span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  alpha,
<a name="l00412"></a>00412                                                   <span class="keyword">const</span> <a class="code" href="classMatrice.html">Matrice</a>&amp; B,
<a name="l00413"></a>00413                                                   <span class="keyword">const</span> <span class="keywordtype">double</span>&amp;  beta,
<a name="l00414"></a>00414                                                   <a class="code" href="classMatrice.html">Matrice</a>&amp;       C )
<a name="l00415"></a>00415 {
<a name="l00416"></a>00416   assert( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>( <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, C.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ) ) );
<a name="l00417"></a>00417   <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; C_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>( <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, C.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ) );
<a name="l00418"></a>00418 
<a name="l00419"></a>00419   assert( C_.<a class="code" href="classMatrice__Morse__Sym.html#a9a861d39c6c10c5095db3aac51be4b22">check_sorted_symmetric_morse_matrix_structure</a>( ) );
<a name="l00420"></a>00420 
<a name="l00421"></a>00421   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> A_stencil;
<a name="l00422"></a>00422   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> A_coefficients;
<a name="l00423"></a>00423   A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#aa97ade54dcec93f34c69a463db717079">get_symmetric_stencil_and_coefficients</a>( A_stencil,
<a name="l00424"></a>00424                                                       A_coefficients );
<a name="l00425"></a>00425 
<a name="l00426"></a>00426   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> B_stencil;
<a name="l00427"></a>00427   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> B_coefficients;
<a name="l00428"></a>00428   B.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#aa97ade54dcec93f34c69a463db717079">get_symmetric_stencil_and_coefficients</a>( B_stencil,
<a name="l00429"></a>00429                                                       B_coefficients );
<a name="l00430"></a>00430 
<a name="l00431"></a>00431   <span class="keywordtype">int</span> A_k = 0;
<a name="l00432"></a>00432   <span class="keywordtype">int</span> B_k = 0;
<a name="l00433"></a>00433 
<a name="l00434"></a>00434   C_.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>() = 0.0 ;
<a name="l00435"></a>00435 
<a name="l00436"></a>00436   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = C_.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l00437"></a>00437   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
<a name="l00438"></a>00438     {
<a name="l00439"></a>00439       <span class="keywordtype">int</span> k0   = C_.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()( i ) - 1;
<a name="l00440"></a>00440       <span class="keywordtype">int</span> k1   = C_.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()( i + 1 ) - 1;
<a name="l00441"></a>00441 
<a name="l00442"></a>00442       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=k0; k&lt;k1; ++k )
<a name="l00443"></a>00443         {
<a name="l00444"></a>00444           <span class="keywordtype">int</span> j = C_.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>()( k ) - 1;
<a name="l00445"></a>00445 
<a name="l00446"></a>00446           <span class="keywordflow">if</span> ( ( A_k &lt; A_stencil.dimension( 0 ) ) &amp;&amp; ( A_stencil( A_k, 0 ) == i ) &amp;&amp; ( A_stencil( A_k, 1 ) == j ) )
<a name="l00447"></a>00447             {
<a name="l00448"></a>00448               C_.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>()( k ) += alpha * A_coefficients[ A_k ];
<a name="l00449"></a>00449               ++A_k;
<a name="l00450"></a>00450             }
<a name="l00451"></a>00451 
<a name="l00452"></a>00452           <span class="keywordflow">if</span> ( ( B_k &lt; B_stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 ) ) &amp;&amp; ( B_stencil( B_k, 0 ) == i ) &amp;&amp; ( B_stencil( B_k, 1 ) == j ) )
<a name="l00453"></a>00453             {
<a name="l00454"></a>00454               C_.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>()( k ) += beta * B_coefficients[ B_k ];
<a name="l00455"></a>00455               ++B_k;
<a name="l00456"></a>00456             }
<a name="l00457"></a>00457         }
<a name="l00458"></a>00458     }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460   assert( A_k == A_coefficients.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) );
<a name="l00461"></a>00461   assert( B_k == B_coefficients.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) );
<a name="l00462"></a>00462 }
<a name="l00463"></a>00463 
<a name="l00464"></a>00464 <span class="comment">// stencil analysis</span>
<a name="l00465"></a><a class="code" href="classMatrix__tools.html#a5c9935d743f55df2e116955e06bdeb36">00465</a> <span class="keywordtype">bool</span> <a class="code" href="classMatrix__tools.html#a5c9935d743f55df2e116955e06bdeb36">Matrix_tools::is_null_stencil</a>( <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; stencil )
<a name="l00466"></a>00466 {
<a name="l00467"></a>00467   <span class="keywordflow">return</span> ( stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 ) == 0 );
<a name="l00468"></a>00468 }
<a name="l00469"></a>00469 
<a name="l00470"></a><a class="code" href="classMatrix__tools.html#ac2d30be6be7f3aee185ac06c5c082b24">00470</a> <span class="keywordtype">bool</span> <a class="code" href="classMatrix__tools.html#ac2d30be6be7f3aee185ac06c5c082b24">Matrix_tools::is_diagonal_stencil</a>( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nb_lines,
<a name="l00471"></a>00471                                         <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nb_columns,
<a name="l00472"></a>00472                                         <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; stencil )
<a name="l00473"></a>00473 {
<a name="l00474"></a>00474   <span class="keywordflow">if</span> ( nb_lines != nb_columns )
<a name="l00475"></a>00475     {
<a name="l00476"></a>00476       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00477"></a>00477     }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479   <span class="keyword">const</span> <span class="keywordtype">int</span> size = stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00480"></a>00480 
<a name="l00481"></a>00481   <span class="keywordflow">if</span> ( size == 0 )
<a name="l00482"></a>00482     {
<a name="l00483"></a>00483       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00484"></a>00484     }
<a name="l00485"></a>00485 
<a name="l00486"></a>00486   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;size; ++i )
<a name="l00487"></a>00487     {
<a name="l00488"></a>00488       <span class="keywordflow">if</span> ( stencil( i, 0 ) != stencil( i, 1 ) )
<a name="l00489"></a>00489         {
<a name="l00490"></a>00490           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00491"></a>00491         }
<a name="l00492"></a>00492 
<a name="l00493"></a>00493       <span class="keywordflow">if</span> ( stencil( i, 0 ) &gt;= nb_lines )
<a name="l00494"></a>00494         {
<a name="l00495"></a>00495           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00496"></a>00496         }
<a name="l00497"></a>00497 
<a name="l00498"></a>00498       <span class="keywordflow">if</span> ( stencil( i, 1 ) &gt;= nb_columns )
<a name="l00499"></a>00499         {
<a name="l00500"></a>00500           <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00501"></a>00501         }
<a name="l00502"></a>00502     }
<a name="l00503"></a>00503 
<a name="l00504"></a>00504   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00505"></a>00505 }
<a name="l00506"></a>00506 
<a name="l00507"></a><a class="code" href="classMatrix__tools.html#a6fabf45a0d328c24c81f8c8f8a1f90ca">00507</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#a6fabf45a0d328c24c81f8c8f8a1f90ca">Matrix_tools::allocate_from_stencil</a>( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nb_lines,
<a name="l00508"></a>00508                                           <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nb_columns,
<a name="l00509"></a>00509                                           <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; stencil,
<a name="l00510"></a>00510                                           <a class="code" href="classMatrice.html">Matrice</a>&amp;      matrix ,
<a name="l00511"></a>00511                                           <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp;   attach_stencil_to_matrix)
<a name="l00512"></a>00512 {
<a name="l00513"></a>00513   <span class="keywordflow">if</span> ( <a class="code" href="classMatrix__tools.html#a5c9935d743f55df2e116955e06bdeb36">is_null_stencil</a>( stencil ) )
<a name="l00514"></a>00514     {
<a name="l00515"></a>00515       matrix.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>( <span class="stringliteral">&quot;Matrice_Nulle&quot;</span> );
<a name="l00516"></a>00516       <a class="code" href="classMatrice__Nulle.html">Matrice_Nulle</a>&amp; matrix_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>( <a class="code" href="classMatrice__Nulle.html">Matrice_Nulle</a>, matrix.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ) );
<a name="l00517"></a>00517       matrix_.<a class="code" href="classMatrice__Nulle.html#ae2e85aea8540f15fc8623f0139ccc3ba">dimensionner</a>( nb_lines, nb_columns );
<a name="l00518"></a>00518     }
<a name="l00519"></a>00519   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="classMatrix__tools.html#ac2d30be6be7f3aee185ac06c5c082b24">is_diagonal_stencil</a>( nb_lines,
<a name="l00520"></a>00520                                  nb_columns,
<a name="l00521"></a>00521                                  stencil ) )
<a name="l00522"></a>00522     {
<a name="l00523"></a>00523       matrix.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>( <span class="stringliteral">&quot;Matrice_Diagonale&quot;</span> );
<a name="l00524"></a>00524       <a class="code" href="classMatrice__Diagonale.html" title="Classe Matrice_Diagonale Represente une matrice diagonale.">Matrice_Diagonale</a>&amp; matrix_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>( <a class="code" href="classMatrice__Diagonale.html" title="Classe Matrice_Diagonale Represente une matrice diagonale.">Matrice_Diagonale</a>, matrix.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ) );
<a name="l00525"></a>00525       matrix_.<a class="code" href="classMatrice__Diagonale.html#a04d4da286be3c04f2c412890dd7e6d8a">dimensionner</a>( nb_lines );
<a name="l00526"></a>00526       <span class="keywordflow">if</span>( attach_stencil_to_matrix )
<a name="l00527"></a>00527         {
<a name="l00528"></a>00528           matrix_.<a class="code" href="classMatrice__Base.html#a7bf83f36d9929eb7da655a9cd2f00def">set_stencil</a>( stencil );
<a name="l00529"></a>00529         }
<a name="l00530"></a>00530     }
<a name="l00531"></a>00531   <span class="keywordflow">else</span>
<a name="l00532"></a>00532     {
<a name="l00533"></a>00533       matrix.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>( <span class="stringliteral">&quot;Matrice_Morse&quot;</span> );
<a name="l00534"></a>00534       <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrix_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>( <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>, matrix.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ) );
<a name="l00535"></a>00535       <a class="code" href="classMatrix__tools.html#a481961691c1dbee5372da25777e5c1e8">allocate_morse_matrix</a>( nb_lines,
<a name="l00536"></a>00536                              nb_columns,
<a name="l00537"></a>00537                              stencil,
<a name="l00538"></a>00538                              matrix_,
<a name="l00539"></a>00539                              attach_stencil_to_matrix );
<a name="l00540"></a>00540     }
<a name="l00541"></a>00541 }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 <span class="comment">// extending a matrix&#39;s stencil</span>
<a name="l00544"></a><a class="code" href="classMatrix__tools.html#a23f0518daf2d6b95a5f6b49606b973a1">00544</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#a23f0518daf2d6b95a5f6b49606b973a1">Matrix_tools::extend_matrix_stencil</a>( <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; stencil,
<a name="l00545"></a>00545                                           <a class="code" href="classMatrice.html">Matrice</a>&amp;      matrix ,
<a name="l00546"></a>00546                                           <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp;   attach_stencil_to_matrix )
<a name="l00547"></a>00547 {
<a name="l00548"></a>00548   <span class="keywordflow">if</span> ( ! ( <a class="code" href="classMatrix__tools.html#a5c9935d743f55df2e116955e06bdeb36">is_null_stencil</a>( stencil ) ) )
<a name="l00549"></a>00549     {
<a name="l00550"></a>00550       <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines   = matrix.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">nb_lignes</a>( );
<a name="l00551"></a>00551       <span class="keyword">const</span> <span class="keywordtype">int</span> nb_columns = matrix.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a8aff414991f0c4f80d8581fbbda62cae">nb_colonnes</a>( );
<a name="l00552"></a>00552 
<a name="l00553"></a>00553       <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> full_stencil;
<a name="l00554"></a>00554       matrix.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>( ).<a class="code" href="classMatrice__Base.html#a62ec15030f4e1395b28a85346a0886f2">get_stencil</a>( full_stencil );
<a name="l00555"></a>00555       full_stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l00556"></a>00556       <span class="keyword">const</span> <span class="keywordtype">int</span> size = stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00557"></a>00557 
<a name="l00558"></a>00558       <span class="keyword">const</span> <span class="keywordtype">int</span> old_size = full_stencil.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>( ) / 2 ;
<a name="l00559"></a>00559 
<a name="l00560"></a>00560       full_stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( old_size + size, 2);
<a name="l00561"></a>00561 
<a name="l00562"></a>00562       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;size; ++i )
<a name="l00563"></a>00563         {
<a name="l00564"></a>00564           full_stencil( old_size + i , 0 ) = stencil( i, 0 );
<a name="l00565"></a>00565           full_stencil( old_size + i , 1 ) = stencil( i, 1 );
<a name="l00566"></a>00566         }
<a name="l00567"></a>00567 
<a name="l00568"></a>00568       <a class="code" href="Array__tools_8cpp.html#a07eed4c823b0632bdbf353fdab2a3c6b" title="Trie le tableau tab dans l&#39;ordre lexicographique et retire les doublons (attention [1...">tableau_trier_retirer_doublons</a>( full_stencil );
<a name="l00569"></a>00569 
<a name="l00570"></a>00570       <a class="code" href="classMatrix__tools.html#a6fabf45a0d328c24c81f8c8f8a1f90ca">allocate_from_stencil</a>( nb_lines,
<a name="l00571"></a>00571                              nb_columns,
<a name="l00572"></a>00572                              full_stencil,
<a name="l00573"></a>00573                              matrix ,
<a name="l00574"></a>00574                              attach_stencil_to_matrix );
<a name="l00575"></a>00575     }
<a name="l00576"></a>00576 }
<a name="l00577"></a>00577 
<a name="l00578"></a>00578 
<a name="l00579"></a>00579 
<a name="l00580"></a><a class="code" href="classMatrix__tools.html#aa0217673e58cc10787e372ea780d708d">00580</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#aa0217673e58cc10787e372ea780d708d">Matrix_tools::matdiag_mult_matmorse</a>( <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; diag,
<a name="l00581"></a>00581                                           <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; mat,
<a name="l00582"></a>00582                                           <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; <a class="code" href="Loi__horaire_8cpp.html#a3419dc9c5aa47723b8e50bdfe0aa264a">inverse</a> )
<a name="l00583"></a>00583 {
<a name="l00584"></a>00584   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lignes = mat.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l00585"></a>00585   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = mat.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>( );
<a name="l00586"></a>00586   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = mat.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>( );
<a name="l00587"></a>00587   <span class="keywordtype">int</span> nnz_tot = 0;
<a name="l00588"></a>00588   <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;nb_lignes; i++ )
<a name="l00589"></a>00589     {
<a name="l00590"></a>00590       <span class="keyword">const</span> <span class="keywordtype">int</span> nnz_i = tab1[ i+1 ] - tab1[ i ]; <span class="comment">//!&lt; nnz sur la ligne i</span>
<a name="l00591"></a>00591 <span class="comment"></span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nnz_i; k++)
<a name="l00592"></a>00592         {
<a name="l00593"></a>00593           <span class="keyword">const</span> <span class="keywordtype">int</span> j = tab2[nnz_tot + k] - 1 ; <span class="comment">//!&lt; indice de la colonne</span>
<a name="l00594"></a>00594 <span class="comment"></span>          <span class="keywordtype">double</span>&amp; coefficient = mat.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>( i, j );
<a name="l00595"></a>00595           <span class="keywordflow">if</span>( inverse )
<a name="l00596"></a>00596             coefficient *= 1./diag[ i ] ;
<a name="l00597"></a>00597           <span class="keywordflow">else</span>
<a name="l00598"></a>00598             coefficient *= diag[ i ] ;
<a name="l00599"></a>00599         }
<a name="l00600"></a>00600       nnz_tot += nnz_i;
<a name="l00601"></a>00601     }
<a name="l00602"></a>00602 }
<a name="l00603"></a>00603 
<a name="l00604"></a><a class="code" href="classMatrix__tools.html#a87d8c408e5257b0fea8795117cb39b6f">00604</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#a87d8c408e5257b0fea8795117cb39b6f">Matrix_tools::matmorse_mult_matdiag</a>( <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; diag,
<a name="l00605"></a>00605                                           <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; mat,
<a name="l00606"></a>00606                                           <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; <a class="code" href="Loi__horaire_8cpp.html#a3419dc9c5aa47723b8e50bdfe0aa264a">inverse</a> )
<a name="l00607"></a>00607 {
<a name="l00608"></a>00608   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lignes = mat.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l00609"></a>00609   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = mat.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>( );
<a name="l00610"></a>00610   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = mat.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>( );
<a name="l00611"></a>00611   <span class="keywordtype">int</span> nnz_tot = 0;
<a name="l00612"></a>00612   <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;nb_lignes; i++ )
<a name="l00613"></a>00613     {
<a name="l00614"></a>00614       <span class="keyword">const</span> <span class="keywordtype">int</span> nnz_i = tab1[ i+1 ] - tab1[ i ]; <span class="comment">//!&lt; nnz sur la ligne i</span>
<a name="l00615"></a>00615 <span class="comment"></span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nnz_i; k++)
<a name="l00616"></a>00616         {
<a name="l00617"></a>00617           <span class="keyword">const</span> <span class="keywordtype">int</span> j = tab2[nnz_tot + k] - 1 ; <span class="comment">//!&lt; indice de la colonne</span>
<a name="l00618"></a>00618 <span class="comment"></span>          <span class="keywordtype">double</span>&amp; coefficient = mat.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>( i, j );
<a name="l00619"></a>00619           <span class="keywordflow">if</span>( inverse )
<a name="l00620"></a>00620             coefficient *= 1./diag[ j ] ;
<a name="l00621"></a>00621           <span class="keywordflow">else</span>
<a name="l00622"></a>00622             coefficient *= diag[ j ] ;
<a name="l00623"></a>00623         }
<a name="l00624"></a>00624       nnz_tot += nnz_i;
<a name="l00625"></a>00625     }
<a name="l00626"></a>00626 }
<a name="l00627"></a>00627 
<a name="l00628"></a>00628 
<a name="l00629"></a><a class="code" href="classMatrix__tools.html#a96b10a4b8af33f8a98c763face0119f8">00629</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#a96b10a4b8af33f8a98c763face0119f8">Matrix_tools::uniform_matdiag_mult_matmorse</a>( <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; diag,
<a name="l00630"></a>00630                                                   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; mat,
<a name="l00631"></a>00631                                                   <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; <a class="code" href="Loi__horaire_8cpp.html#a3419dc9c5aa47723b8e50bdfe0aa264a">inverse</a> )
<a name="l00632"></a>00632 {
<a name="l00633"></a>00633   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lignes = mat.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l00634"></a>00634   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = mat.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>( );
<a name="l00635"></a>00635   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = mat.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>( );
<a name="l00636"></a>00636   <span class="keywordtype">int</span> nnz_tot = 0;
<a name="l00637"></a>00637   <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;nb_lignes; i++ )
<a name="l00638"></a>00638     {
<a name="l00639"></a>00639       <span class="keyword">const</span> <span class="keywordtype">int</span> nnz_i = tab1[ i+1 ] - tab1[ i ]; <span class="comment">//!&lt; nnz sur la ligne i</span>
<a name="l00640"></a>00640 <span class="comment"></span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nnz_i; k++)
<a name="l00641"></a>00641         {
<a name="l00642"></a>00642           <span class="keyword">const</span> <span class="keywordtype">int</span> j = tab2[nnz_tot + k] - 1 ; <span class="comment">//!&lt; indice de la colonne</span>
<a name="l00643"></a>00643 <span class="comment"></span>          <span class="keywordtype">double</span>&amp; coefficient = mat.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>( i, j );
<a name="l00644"></a>00644           <span class="keywordflow">if</span>( inverse )
<a name="l00645"></a>00645             coefficient *= 1./diag ;
<a name="l00646"></a>00646           <span class="keywordflow">else</span>
<a name="l00647"></a>00647             coefficient *= diag ;
<a name="l00648"></a>00648         }
<a name="l00649"></a>00649       nnz_tot += nnz_i;
<a name="l00650"></a>00650     }
<a name="l00651"></a>00651 }
<a name="l00652"></a>00652 
<a name="l00653"></a><a class="code" href="classMatrix__tools.html#af2b21ae39cec8d57c7a25ee8470d12d1">00653</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#af2b21ae39cec8d57c7a25ee8470d12d1">Matrix_tools::matmorse_mult_uniform_matdiag</a>( <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; diag,
<a name="l00654"></a>00654                                                   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; mat,
<a name="l00655"></a>00655                                                   <span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; <a class="code" href="Loi__horaire_8cpp.html#a3419dc9c5aa47723b8e50bdfe0aa264a">inverse</a> )
<a name="l00656"></a>00656 {
<a name="l00657"></a>00657   <a class="code" href="classMatrix__tools.html#a96b10a4b8af33f8a98c763face0119f8">uniform_matdiag_mult_matmorse</a>( diag, mat, inverse );
<a name="l00658"></a>00658 }
<a name="l00659"></a>00659 
<a name="l00660"></a><a class="code" href="classMatrix__tools.html#a563caf48d0afde13e6893a6d4ea92ed8">00660</a> <span class="keywordtype">void</span> <a class="code" href="classMatrix__tools.html#a563caf48d0afde13e6893a6d4ea92ed8">Matrix_tools::extend_matrix</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; mat, <span class="keywordtype">int</span> nl, <span class="keywordtype">int</span> nc)
<a name="l00661"></a>00661 {
<a name="l00662"></a>00662 
<a name="l00663"></a>00663   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = mat.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>(), old_tab1 = tab1;
<a name="l00664"></a>00664   tab1.<a class="code" href="classIntVect.html#a273976ecf3d2d4fdbdc48ab446027e8e" title="met l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut. (voir ArrOfInt::reset())">reset</a>(), tab1.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nl + 1);
<a name="l00665"></a>00665   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= nl; i++) tab1(i) = old_tab1(<a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(i, old_tab1.size() - 1));
<a name="l00666"></a>00666   mat.<a class="code" href="classMatrice__Morse.html#ab2fb02a8aba88f717c2285960f375fba">set_nb_columns</a>(nc); <span class="comment">//plus facile</span>
<a name="l00667"></a>00667 }
<a name="l00668"></a>00668 
<a name="l00669"></a>00669 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:22 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
