<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Utilitaires/Memoire.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Utilitaires/Memoire.cpp</div>  </div>
</div>
<div class="contents">
<a href="Memoire_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Memoire.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Utilitaires</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/29</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Memoire_8h.html">Memoire.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="DoubleVect_8h.html">DoubleVect.h</a>&gt;</span>
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">00026</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>=0;
<a name="l00027"></a>00027 <a class="code" href="classMemoire.html" title="La memoire de Trio-U.">Memoire</a>* <a class="code" href="classMemoire.html#acd61fd288f3630ddbc6318181365e3d9">Memoire::_instance</a> = 0;
<a name="l00028"></a>00028 <span class="keywordtype">int</span> <a class="code" href="classMemoire.html#a4c917c493d12d3068e6358a5c206c69c">Memoire::prems</a>=0;
<a name="l00029"></a>00029 <span class="keywordtype">int</span> <a class="code" href="classMemoire.html#afad244ad3fa64eeafa47de55be84e1d2">Memoire::step</a>=4096;
<a name="l00030"></a>00030 <span class="comment">// struct mallinfo minfo;</span>
<a name="l00031"></a><a class="code" href="Memoire_8cpp.html#a5e58a838411d236617a731fb5afe468f">00031</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#a5e58a838411d236617a731fb5afe468f">max_sz_mem</a>=0;
<a name="l00032"></a><a class="code" href="Memoire_8cpp.html#ab45d2528f17360758465726935f3bb7e">00032</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ab45d2528f17360758465726935f3bb7e">min_sz_mem</a>=0;
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">// Precondition:</span>
<a name="l00036"></a>00036 <span class="comment">// Parametre:</span>
<a name="l00037"></a>00037 <span class="comment">// Signification:</span>
<a name="l00038"></a>00038 <span class="comment">// Valeurs par defaut:</span>
<a name="l00039"></a>00039 <span class="comment">// Contraintes:</span>
<a name="l00040"></a>00040 <span class="comment">// Acces:</span>
<a name="l00041"></a>00041 <span class="comment">// Exception:</span>
<a name="l00042"></a>00042 <span class="comment">// Effets de bord:</span>
<a name="l00043"></a>00043 <span class="comment">// Postcondition:</span>
<a name="l00044"></a>00044 <span class="comment">//</span>
<a name="l00045"></a>00045 <span class="comment">//</span><span class="comment"></span>
<a name="l00046"></a>00046 <span class="comment">//! Retourne un pointeur sur l&#39;instance de la memoire&lt;br&gt;Cree un nouvel objet memoire si aucune instance n&#39;a deja ete creee</span>
<a name="l00047"></a>00047 <span class="comment"></span><span class="comment">/** \return Memoire*&lt;br&gt;</span>
<a name="l00048"></a>00048 <span class="comment">Signification: pointeur sur l&#39;instance de la memoire&lt;br&gt;</span>
<a name="l00049"></a>00049 <span class="comment">Contraintes: */</span>
<a name="l00050"></a><a class="code" href="classMemoire.html#a552329c7ffbaff5dd8395af9489fa05b">00050</a> <a class="code" href="classMemoire.html" title="La memoire de Trio-U.">Memoire</a>&amp; <a class="code" href="classMemoire.html#a552329c7ffbaff5dd8395af9489fa05b" title="Retourne un pointeur sur l&#39;instance de la memoire Cree un nouvel objet memoire si aucune instance n&#39;a...">Memoire::Instance</a>()
<a name="l00051"></a>00051 {
<a name="l00052"></a>00052   <span class="keywordflow">if</span> (<a class="code" href="classMemoire.html#acd61fd288f3630ddbc6318181365e3d9">_instance</a> == 0)
<a name="l00053"></a>00053     {
<a name="l00054"></a>00054       <a class="code" href="classMemoire.html#acd61fd288f3630ddbc6318181365e3d9">_instance</a> = <span class="keyword">new</span> <a class="code" href="classMemoire.html#a873e4f651ec4119a849a14000ddbfd92" title="Constructeur Initialize une zone de travail pour les Objet_U, les &quot;double&quot; et les &quot;int&quot;...">Memoire</a>;
<a name="l00055"></a>00055     }
<a name="l00056"></a>00056   <span class="keywordflow">return</span> *<a class="code" href="classMemoire.html#acd61fd288f3630ddbc6318181365e3d9">_instance</a>;
<a name="l00057"></a>00057 }
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="comment">// Precondition:</span>
<a name="l00061"></a>00061 <span class="comment">// Parametre:</span>
<a name="l00062"></a>00062 <span class="comment">// Signification:</span>
<a name="l00063"></a>00063 <span class="comment">// Valeurs par defaut:</span>
<a name="l00064"></a>00064 <span class="comment">// Contraintes:</span>
<a name="l00065"></a>00065 <span class="comment">// Acces:</span>
<a name="l00066"></a>00066 <span class="comment">// </span>
<a name="l00067"></a>00067 <span class="comment">// Signification:</span>
<a name="l00068"></a>00068 <span class="comment">// Contraintes:</span>
<a name="l00069"></a>00069 <span class="comment">// Exception:</span>
<a name="l00070"></a>00070 <span class="comment">// Effets de bord:</span>
<a name="l00071"></a>00071 <span class="comment">// Postcondition:</span>
<a name="l00072"></a>00072 <span class="comment">//</span>
<a name="l00073"></a>00073 <span class="comment">//</span><span class="comment"></span>
<a name="l00074"></a>00074 <span class="comment">//! Constructeur&lt;br&gt;Initialize une zone de travail pour les Objet_U, les &quot;double&quot; et les &quot;int&quot;</span>
<a name="l00075"></a><a class="code" href="classMemoire.html#a873e4f651ec4119a849a14000ddbfd92">00075</a> <span class="comment"></span><a class="code" href="classMemoire.html#a873e4f651ec4119a849a14000ddbfd92" title="Constructeur Initialize une zone de travail pour les Objet_U, les &quot;double&quot; et les &quot;int&quot;...">Memoire::Memoire</a>() : size(step), data(new <a class="code" href="classMemoire__ptr.html" title="Pointeur dans la Memoire de TRUST pour un Objet_U.">Memoire_ptr</a>[step]),
<a name="l00076"></a>00076   trav_double(new <a class="code" href="classDouble__ptr__trav.html" title="Une zone de travail de la Memoire TRUST composee d&#39;elements de type double.">Double_ptr_trav</a>()), trav_int(new <a class="code" href="classInt__ptr__trav.html" title="Une zone de travail de la Memoire TRUST composee d&#39;elements de type int.">Int_ptr_trav</a>())
<a name="l00077"></a>00077 {
<a name="l00078"></a>00078 <span class="comment">// Cerr &lt;&lt; &quot;prems=&quot;&lt;&lt;prems&lt;&lt;&quot; step=&quot;&lt;&lt;step&lt;&lt;finl;</span>
<a name="l00079"></a>00079   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=<a class="code" href="classMemoire.html#a4c917c493d12d3068e6358a5c206c69c">prems</a>; i&lt;<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00080"></a>00080     <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i].<a class="code" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a>=i+1;
<a name="l00081"></a>00081 <span class="comment">// minfo = mallinfo();</span>
<a name="l00082"></a>00082 <span class="comment">// min_sz_mem = minfo.arena;</span>
<a name="l00083"></a>00083 <span class="comment">// max_sz_mem = min_sz_mem;</span>
<a name="l00084"></a>00084 }
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="comment">// Precondition:</span>
<a name="l00088"></a>00088 <span class="comment">// La memoire doit avoir prealablement ete instanciee</span>
<a name="l00089"></a>00089 <span class="comment">// Parametre: Objet_U* obj</span>
<a name="l00090"></a>00090 <span class="comment">// Signification: pointeur sur l&#39;Objet_U a ajouter</span>
<a name="l00091"></a>00091 <span class="comment">// Valeurs par defaut:</span>
<a name="l00092"></a>00092 <span class="comment">// Contraintes:</span>
<a name="l00093"></a>00093 <span class="comment">// Acces:</span>
<a name="l00094"></a>00094 <span class="comment">// Exception:</span>
<a name="l00095"></a>00095 <span class="comment">// Effets de bord:</span>
<a name="l00096"></a>00096 <span class="comment">// Postcondition:</span>
<a name="l00097"></a>00097 <span class="comment">//</span><span class="comment"></span>
<a name="l00098"></a>00098 <span class="comment">//! Ajoute un Objet_U dans la Memoire de TRUST</span>
<a name="l00099"></a>00099 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00100"></a>00100 <span class="comment">Signification: le numero affecte a l&#39;objet dans la memoire&lt;br&gt;</span>
<a name="l00101"></a>00101 <span class="comment">Contraintes: */</span>
<a name="l00102"></a><a class="code" href="classMemoire.html#afdd7ddaae25f7a5c44820ab8cfe68381">00102</a> <span class="keywordtype">int</span> <a class="code" href="classMemoire.html#afdd7ddaae25f7a5c44820ab8cfe68381" title="Ajoute un Objet_U dans la Memoire de TRUST.">Memoire::add</a>(<a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>* obj)
<a name="l00103"></a>00103 {
<a name="l00104"></a>00104   assert(<a class="code" href="classMemoire.html#acd61fd288f3630ddbc6318181365e3d9">_instance</a> != 0);
<a name="l00105"></a>00105   <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>++;
<a name="l00106"></a>00106   <span class="keywordflow">if</span>(<a class="code" href="classMemoire.html#a4c917c493d12d3068e6358a5c206c69c">prems</a>&lt;<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>)
<a name="l00107"></a>00107     {
<a name="l00108"></a>00108       <span class="keyword">const</span> <span class="keywordtype">int</span> num=<a class="code" href="classMemoire.html#a4c917c493d12d3068e6358a5c206c69c">prems</a>;
<a name="l00109"></a>00109       assert(<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].libre());
<a name="l00110"></a>00110       <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].<a class="code" href="classMemoire__ptr.html#a502af64e00f83e0fc7ddc7397ab5132f" title="Affecte un Objet_U a un pointeur memoire.">set</a>(obj);
<a name="l00111"></a>00111       <a class="code" href="classMemoire.html#a4c917c493d12d3068e6358a5c206c69c">prems</a>=<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].<a class="code" href="classMemoire__ptr.html#af25fae8f176caebc8593481152edd9c9">next</a>;
<a name="l00112"></a>00112       <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].<a class="code" href="classMemoire__ptr.html#af25fae8f176caebc8593481152edd9c9">next</a> = -1;
<a name="l00113"></a>00113       assert(<a class="code" href="classMemoire.html#a4c917c493d12d3068e6358a5c206c69c">prems</a>&gt;=0);
<a name="l00114"></a>00114 <span class="comment">// minfo = mallinfo();</span>
<a name="l00115"></a>00115 <span class="comment">// int sz_mem = minfo.arena;</span>
<a name="l00116"></a>00116 <span class="comment">// if(sz_mem &gt; max_sz_mem) max_sz_mem = sz_mem;</span>
<a name="l00117"></a>00117       <span class="keywordflow">return</span> num;
<a name="l00118"></a>00118     }
<a name="l00119"></a>00119   <span class="keywordtype">int</span> old_size=<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>;
<a name="l00120"></a>00120   <span class="keywordtype">int</span> i;
<a name="l00121"></a>00121   <a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>*=2;
<a name="l00122"></a>00122 <span class="comment">// Cerr&lt;&lt;&quot;size &quot;&lt;&lt;size&lt;&lt;&quot; &quot;&lt;&lt;size/step&lt;&lt;finl;</span>
<a name="l00123"></a>00123   <a class="code" href="classMemoire__ptr.html" title="Pointeur dans la Memoire de TRUST pour un Objet_U.">Memoire_ptr</a>* newdata=<span class="keyword">new</span> <a class="code" href="classMemoire__ptr.html" title="Pointeur dans la Memoire de TRUST pour un Objet_U.">Memoire_ptr</a>[<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>];
<a name="l00124"></a>00124   <span class="keywordflow">if</span>(!newdata)
<a name="l00125"></a>00125     {
<a name="l00126"></a>00126       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Not enough memory &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00127"></a>00127       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00128"></a>00128     }
<a name="l00129"></a>00129   <a class="code" href="classMemoire__ptr.html" title="Pointeur dans la Memoire de TRUST pour un Objet_U.">Memoire_ptr</a>  newptr(obj);
<a name="l00130"></a>00130   <span class="keywordflow">for</span>(i=0; i&lt;old_size; i++)
<a name="l00131"></a>00131     {
<a name="l00132"></a>00132       newdata[i]=<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i];
<a name="l00133"></a>00133       <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i].<a class="code" href="classMemoire__ptr.html#a502af64e00f83e0fc7ddc7397ab5132f" title="Affecte un Objet_U a un pointeur memoire.">set</a>(0);
<a name="l00134"></a>00134     }
<a name="l00135"></a>00135   newdata[old_size]=newptr;
<a name="l00136"></a>00136   <span class="keywordflow">for</span>(i=old_size; i&lt;<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00137"></a>00137     newdata[i].<a class="code" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a>=i+1;
<a name="l00138"></a>00138   <span class="keywordflow">if</span>(<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>)
<a name="l00139"></a>00139     <span class="keyword">delete</span>[] <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>;
<a name="l00140"></a>00140   <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>=newdata;
<a name="l00141"></a>00141   <a class="code" href="classMemoire.html#a4c917c493d12d3068e6358a5c206c69c">prems</a>=old_size+1;
<a name="l00142"></a>00142 <span class="comment">// minfo = mallinfo();</span>
<a name="l00143"></a>00143 <span class="comment">// int sz_mem = minfo.arena;</span>
<a name="l00144"></a>00144 <span class="comment">// if(sz_mem &gt; max_sz_mem) max_sz_mem = sz_mem;</span>
<a name="l00145"></a>00145   <span class="keywordflow">return</span> old_size;
<a name="l00146"></a>00146 }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 <span class="comment">// Precondition:</span>
<a name="l00150"></a>00150 <span class="comment">// Parametre: int num</span>
<a name="l00151"></a>00151 <span class="comment">// Signification: le numero de l&#39;Objet_U a supprimer</span>
<a name="l00152"></a>00152 <span class="comment">// Valeurs par defaut:</span>
<a name="l00153"></a>00153 <span class="comment">// Contraintes:</span>
<a name="l00154"></a>00154 <span class="comment">// Acces:</span>
<a name="l00155"></a>00155 <span class="comment">// Exception:</span>
<a name="l00156"></a>00156 <span class="comment">// Effets de bord:</span>
<a name="l00157"></a>00157 <span class="comment">// Postcondition:</span>
<a name="l00158"></a>00158 <span class="comment">//</span>
<a name="l00159"></a>00159 <span class="comment">//</span><span class="comment"></span>
<a name="l00160"></a>00160 <span class="comment">//! Suppression de la memoire de l&#39;Objet_U de numero num&lt;br&gt;L&#39;Objet_U n&#39;est pas supprime, seul son pointeur dans la memoire l&#39;est.</span>
<a name="l00161"></a>00161 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00162"></a>00162 <span class="comment">Signification: code de retour, retourne toujours 1&lt;br&gt;</span>
<a name="l00163"></a>00163 <span class="comment">Contraintes: */</span>
<a name="l00164"></a><a class="code" href="classMemoire.html#a600901ad151e94f1f8956ec0a2dc6b18">00164</a> <span class="keywordtype">int</span> <a class="code" href="classMemoire.html#a600901ad151e94f1f8956ec0a2dc6b18" title="Suppression de la memoire de l&#39;Objet_U de numero num L&#39;Objet_U n&#39;est pas supprime, seul son pointeur dans la memoire l&#39;est.">Memoire::suppr</a>(<span class="keywordtype">int</span> num)
<a name="l00165"></a>00165 {
<a name="l00166"></a>00166 <span class="comment">// Cerr &lt;&lt; &quot;Suppression de &quot; &lt;&lt; num &lt;&lt; finl;</span>
<a name="l00167"></a>00167   assert(!<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].libre());
<a name="l00168"></a>00168   <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].<a class="code" href="classMemoire__ptr.html#af25fae8f176caebc8593481152edd9c9">next</a>=<a class="code" href="classMemoire.html#a4c917c493d12d3068e6358a5c206c69c">prems</a>;
<a name="l00169"></a>00169   <a class="code" href="classMemoire.html#a4c917c493d12d3068e6358a5c206c69c">prems</a>=num;
<a name="l00170"></a>00170   <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].<a class="code" href="classMemoire__ptr.html#a502af64e00f83e0fc7ddc7397ab5132f" title="Affecte un Objet_U a un pointeur memoire.">set</a>(0);
<a name="l00171"></a>00171   <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>--;
<a name="l00172"></a>00172   <span class="keywordflow">if</span>((<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>&gt;4*<a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>)&amp;&amp;(<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>&gt;<a class="code" href="classMemoire.html#afad244ad3fa64eeafa47de55be84e1d2">step</a>))
<a name="l00173"></a>00173 <span class="comment">// if((size-compteur)&gt;step)</span>
<a name="l00174"></a>00174     {
<a name="l00175"></a>00175       <a class="code" href="classMemoire.html#a46c7b07f882adba0eae1724c7ad861e2" title="Compacte la memoire Ce compactage est effectue automatiquement lorsqu&#39;il devient necessaire.">compacte</a>();
<a name="l00176"></a>00176     }
<a name="l00177"></a>00177   <span class="comment">/*</span>
<a name="l00178"></a>00178 <span class="comment">    static int deb=0;</span>
<a name="l00179"></a>00179 <span class="comment">    if (compteur &gt;500) deb=1;</span>
<a name="l00180"></a>00180 <span class="comment">    if ((deb)&amp;&amp;(compteur&lt;3))</span>
<a name="l00181"></a>00181 <span class="comment">    {</span>
<a name="l00182"></a>00182 <span class="comment">    Cerr&lt;&lt;&quot;here &quot;&lt;&lt;compteur&lt;&lt;finl;</span>
<a name="l00183"></a>00183 <span class="comment"></span>
<a name="l00184"></a>00184 <span class="comment">    int i;</span>
<a name="l00185"></a>00185 <span class="comment">    for(i=0; i&lt;size; i++)</span>
<a name="l00186"></a>00186 <span class="comment">    if(! data[i].libre())</span>
<a name="l00187"></a>00187 <span class="comment">    {</span>
<a name="l00188"></a>00188 <span class="comment">    Cerr &lt;&lt; finl;</span>
<a name="l00189"></a>00189 <span class="comment">    Cerr &lt;&lt; i &lt;&lt; &quot; &quot;;</span>
<a name="l00190"></a>00190 <span class="comment">    const Objet_U&amp; obj=objet_u(i);</span>
<a name="l00191"></a>00191 <span class="comment">    Cerr &lt;&lt; &quot; :: &quot;;</span>
<a name="l00192"></a>00192 <span class="comment">    Cerr &lt;&lt; &quot;TYPE :&quot; &lt;&lt; obj.le_type()&lt;&lt;finl;</span>
<a name="l00193"></a>00193 <span class="comment">    if(sub_type(Nom,obj)) Cerr &lt;&lt; &quot; NAME : &quot; &lt;&lt; obj.le_nom() &lt;&lt;finl;</span>
<a name="l00194"></a>00194 <span class="comment"></span>
<a name="l00195"></a>00195 <span class="comment">    }</span>
<a name="l00196"></a>00196 <span class="comment">    }</span>
<a name="l00197"></a>00197 <span class="comment">  */</span>
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 <span class="comment">// GF quand on n&#39;a plus d&#39;objet_u on detruit tout</span>
<a name="l00200"></a>00200 
<a name="l00201"></a>00201   <span class="keywordflow">if</span> (<a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>==0)
<a name="l00202"></a>00202     {
<a name="l00203"></a>00203 <span class="comment">// Cerr&lt;&lt;&quot;delete data&quot;&lt;&lt;finl;</span>
<a name="l00204"></a>00204       <span class="keywordflow">if</span> (<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>)
<a name="l00205"></a>00205         {
<a name="l00206"></a>00206           <span class="keyword">delete</span>[] <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>;
<a name="l00207"></a>00207           <span class="keyword">delete</span> <a class="code" href="classMemoire.html#a48f9d322d95ecfcfad79b793b8ae63a9">trav_double</a>;
<a name="l00208"></a>00208           <span class="keyword">delete</span> <a class="code" href="classMemoire.html#ae2cd9384c90a89b4fe4053c35746a28d">trav_int</a>;
<a name="l00209"></a>00209           <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>=0;
<a name="l00210"></a>00210           <span class="keyword">delete</span> <a class="code" href="classMemoire.html#acd61fd288f3630ddbc6318181365e3d9">_instance</a>;
<a name="l00211"></a>00211           <a class="code" href="classMemoire.html#acd61fd288f3630ddbc6318181365e3d9">_instance</a>=0;
<a name="l00212"></a>00212 
<a name="l00213"></a>00213         }
<a name="l00214"></a>00214     }
<a name="l00215"></a>00215   <span class="keywordflow">return</span> 1;
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 <span class="comment">// Precondition:</span>
<a name="l00220"></a>00220 <span class="comment">// Parametre: const Nom&amp; type</span>
<a name="l00221"></a>00221 <span class="comment">// Signification: le type de l&#39;objet</span>
<a name="l00222"></a>00222 <span class="comment">// Valeurs par defaut:</span>
<a name="l00223"></a>00223 <span class="comment">// Contraintes:</span>
<a name="l00224"></a>00224 <span class="comment">// Acces:</span>
<a name="l00225"></a>00225 <span class="comment">// Parametre: const Nom&amp; nom</span>
<a name="l00226"></a>00226 <span class="comment">// Signification: le nom de l&#39;objet</span>
<a name="l00227"></a>00227 <span class="comment">// Valeurs par defaut:</span>
<a name="l00228"></a>00228 <span class="comment">// Contraintes:</span>
<a name="l00229"></a>00229 <span class="comment">// Acces:</span>
<a name="l00230"></a>00230 <span class="comment">// Exception:</span>
<a name="l00231"></a>00231 <span class="comment">// Effets de bord:</span>
<a name="l00232"></a>00232 <span class="comment">// Postcondition:</span>
<a name="l00233"></a>00233 <span class="comment">//</span><span class="comment"></span>
<a name="l00234"></a>00234 <span class="comment">//! Retourne le rang dans la memoire de l&#39;objet de type et de nom indiques</span>
<a name="l00235"></a>00235 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00236"></a>00236 <span class="comment">Signification: le rang de l&#39;objet s&#39;il est trouve dans la memoire, -1 sinon&lt;br&gt;</span>
<a name="l00237"></a>00237 <span class="comment">Contraintes: */</span>
<a name="l00238"></a><a class="code" href="classMemoire.html#a9d6cb393c6bbb18bd2189b9218ff4fa1">00238</a> <span class="keywordtype">int</span> <a class="code" href="classMemoire.html#a9d6cb393c6bbb18bd2189b9218ff4fa1" title="Retourne le rang dans la memoire de l&#39;objet de type et de nom indiques.">Memoire::rang</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type, <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom)<span class="keyword"> const</span>
<a name="l00239"></a>00239 <span class="keyword"></span>{
<a name="l00240"></a>00240   <a class="code" href="classMemoire__ptr.html" title="Pointeur dans la Memoire de TRUST pour un Objet_U.">Memoire_ptr</a>* x=<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>;
<a name="l00241"></a>00241   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00242"></a>00242     {
<a name="l00243"></a>00243       <span class="keywordflow">if</span>( !( x-&gt;<a class="code" href="classMemoire__ptr.html#a7a99abc7336d101a9b28dd47b59ff8cb" title="Indique si le pointeur memoire est libre, c&#39;est-a-dire s&#39;il pointe sur un Objet_U non nul...">libre</a>() ) )
<a name="l00244"></a>00244         <span class="keywordflow">if</span> ( ((x-&gt;<a class="code" href="classMemoire__ptr.html#a9f0b4fe6a16cdacbbc0fba27b00c8177" title="Retourne une reference sur l&#39;Objet_U pointe par le pointeur memoire.">obj</a>()).que_suis_je()==type) &amp;&amp;
<a name="l00245"></a>00245              ((x-&gt;<a class="code" href="classMemoire__ptr.html#a9f0b4fe6a16cdacbbc0fba27b00c8177" title="Retourne une reference sur l&#39;Objet_U pointe par le pointeur memoire.">obj</a>()).le_nom()==nom) )
<a name="l00246"></a>00246           <span class="keywordflow">return</span> i;
<a name="l00247"></a>00247       x++;
<a name="l00248"></a>00248     }
<a name="l00249"></a>00249   <span class="keywordflow">return</span> -1;
<a name="l00250"></a>00250 }
<a name="l00251"></a>00251 
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="comment">// Precondition:</span>
<a name="l00254"></a>00254 <span class="comment">// Parametre: const Nom&amp; nom</span>
<a name="l00255"></a>00255 <span class="comment">// Signification: le nom de l&#39;objet</span>
<a name="l00256"></a>00256 <span class="comment">// Valeurs par defaut:</span>
<a name="l00257"></a>00257 <span class="comment">// Contraintes:</span>
<a name="l00258"></a>00258 <span class="comment">// Acces:</span>
<a name="l00259"></a>00259 <span class="comment">// Exception:</span>
<a name="l00260"></a>00260 <span class="comment">// Effets de bord:</span>
<a name="l00261"></a>00261 <span class="comment">// Postcondition:</span>
<a name="l00262"></a>00262 <span class="comment">//</span><span class="comment"></span>
<a name="l00263"></a>00263 <span class="comment">//! Retourne le rang dans la memoire de l&#39;objet de nom indique</span>
<a name="l00264"></a>00264 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00265"></a>00265 <span class="comment">Signification: le rang de l&#39;objet s&#39;il est trouve dans la memoire, -1 sinon&lt;br&gt;</span>
<a name="l00266"></a>00266 <span class="comment">Contraintes: */</span>
<a name="l00267"></a><a class="code" href="classMemoire.html#a1b3949ad5dea324f968730a21917e5ad">00267</a> <span class="keywordtype">int</span> <a class="code" href="classMemoire.html#a9d6cb393c6bbb18bd2189b9218ff4fa1" title="Retourne le rang dans la memoire de l&#39;objet de type et de nom indiques.">Memoire::rang</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom)<span class="keyword"> const</span>
<a name="l00268"></a>00268 <span class="keyword"></span>{
<a name="l00269"></a>00269   <a class="code" href="classMemoire__ptr.html" title="Pointeur dans la Memoire de TRUST pour un Objet_U.">Memoire_ptr</a>* x=<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>;
<a name="l00270"></a>00270   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00271"></a>00271     <span class="keywordflow">if</span>( !( x-&gt;<a class="code" href="classMemoire__ptr.html#a7a99abc7336d101a9b28dd47b59ff8cb" title="Indique si le pointeur memoire est libre, c&#39;est-a-dire s&#39;il pointe sur un Objet_U non nul...">libre</a>() ) )
<a name="l00272"></a>00272       {
<a name="l00273"></a>00273         <span class="keywordflow">if</span> (((x-&gt;<a class="code" href="classMemoire__ptr.html#a9f0b4fe6a16cdacbbc0fba27b00c8177" title="Retourne une reference sur l&#39;Objet_U pointe par le pointeur memoire.">obj</a>()).le_nom())==nom)
<a name="l00274"></a>00274           <span class="keywordflow">return</span> i;
<a name="l00275"></a>00275         x++;
<a name="l00276"></a>00276       }
<a name="l00277"></a>00277   <span class="keywordflow">return</span> -1;
<a name="l00278"></a>00278 }
<a name="l00279"></a>00279 
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="comment">// Precondition:</span>
<a name="l00282"></a>00282 <span class="comment">// num doit etre positif ou nul et inferieur au nombre d&#39;objets de la memoire</span>
<a name="l00283"></a>00283 <span class="comment">// Parametre: int num</span>
<a name="l00284"></a>00284 <span class="comment">// Signification: le rang de l&#39;objet dans la memoire</span>
<a name="l00285"></a>00285 <span class="comment">// Valeurs par defaut:</span>
<a name="l00286"></a>00286 <span class="comment">// Contraintes:</span>
<a name="l00287"></a>00287 <span class="comment">// Acces: entree</span>
<a name="l00288"></a>00288 <span class="comment">// Exception:</span>
<a name="l00289"></a>00289 <span class="comment">// Sort en erreur si la memoire comporte une erreur a la case de rang num</span>
<a name="l00290"></a>00290 <span class="comment">// Effets de bord:</span>
<a name="l00291"></a>00291 <span class="comment">// Postcondition:</span>
<a name="l00292"></a>00292 <span class="comment">//</span><span class="comment"></span>
<a name="l00293"></a>00293 <span class="comment">//! Retoune une reference sur l&#39;Objet_U de rang num dans la memoire</span>
<a name="l00294"></a>00294 <span class="comment"></span><span class="comment">/** \return Objet_U\&amp;&lt;br&gt;</span>
<a name="l00295"></a>00295 <span class="comment">Signification: reference sur l&#39;Objet_U trouve&lt;br&gt;</span>
<a name="l00296"></a>00296 <span class="comment">Contraintes: */</span>
<a name="l00297"></a><a class="code" href="classMemoire.html#a214a0f83b3164a2a24e366cc80cb806e">00297</a> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; <a class="code" href="classMemoire.html#a214a0f83b3164a2a24e366cc80cb806e" title="Retoune une reference sur l&#39;Objet_U de rang num dans la memoire.">Memoire::objet_u</a>(<span class="keywordtype">int</span> num)
<a name="l00298"></a>00298 {
<a name="l00299"></a>00299   assert(num &gt;=0);
<a name="l00300"></a>00300   assert(num &lt; <a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>);
<a name="l00301"></a>00301   assert(!<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].libre());
<a name="l00302"></a>00302   <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; objet = <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].<a class="code" href="classMemoire__ptr.html#a9f0b4fe6a16cdacbbc0fba27b00c8177" title="Retourne une reference sur l&#39;Objet_U pointe par le pointeur memoire.">obj</a>();
<a name="l00303"></a>00303   <span class="keyword">const</span> <span class="keywordtype">int</span> num_obj = objet.<a class="code" href="classObjet__U.html#a299d10d1be93af1c2b9f2f43f50141f5" title="Renvoie l&#39;indice de l&#39;objet dans Memoire::data.">numero</a>();
<a name="l00304"></a>00304   <span class="keywordflow">if</span> (num_obj != num)
<a name="l00305"></a>00305     {
<a name="l00306"></a>00306       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Objet_U &amp; Memoire::objet_u(int num) &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00307"></a>00307       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; num                       = &quot;</span> &lt;&lt; num &lt;&lt; finl;
<a name="l00308"></a>00308       std::cerr &lt;&lt; <span class="stringliteral">&quot; data[num].o_ptr           = &quot;</span> &lt;&lt; &amp;objet &lt;&lt; std::endl;
<a name="l00309"></a>00309       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; data[num].o_ptr-&gt;numero() = &quot;</span> &lt;&lt; num_obj &lt;&lt; finl;
<a name="l00310"></a>00310       assert(0);
<a name="l00311"></a>00311       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00312"></a>00312     }
<a name="l00313"></a>00313   <span class="keywordflow">return</span> objet;
<a name="l00314"></a>00314 }
<a name="l00315"></a>00315 
<a name="l00316"></a>00316 
<a name="l00317"></a>00317 <span class="comment">// Precondition:</span>
<a name="l00318"></a>00318 <span class="comment">// num doit etre positif ou nul et inferieur au nombre d&#39;objets de la memoire</span>
<a name="l00319"></a>00319 <span class="comment">// Parametre: int num</span>
<a name="l00320"></a>00320 <span class="comment">// Signification: le rang de l&#39;objet dans la memoire</span>
<a name="l00321"></a>00321 <span class="comment">// Valeurs par defaut:</span>
<a name="l00322"></a>00322 <span class="comment">// Contraintes:</span>
<a name="l00323"></a>00323 <span class="comment">// Acces: entree</span>
<a name="l00324"></a>00324 <span class="comment">// Exception:</span>
<a name="l00325"></a>00325 <span class="comment">// Sort en erreur si la memoire comporte une erreur a la case de rang num</span>
<a name="l00326"></a>00326 <span class="comment">// Effets de bord:</span>
<a name="l00327"></a>00327 <span class="comment">// Postcondition:</span>
<a name="l00328"></a>00328 <span class="comment">//</span><span class="comment"></span>
<a name="l00329"></a>00329 <span class="comment">//! Retoune une reference constante sur l&#39;Objet_U de rang num dans la memoire</span>
<a name="l00330"></a>00330 <span class="comment"></span><span class="comment">/** \return const Objet_U\&amp;&lt;br&gt;</span>
<a name="l00331"></a>00331 <span class="comment">Signification: reference sur l&#39;Objet_U trouve&lt;br&gt;</span>
<a name="l00332"></a>00332 <span class="comment">Contraintes: */</span>
<a name="l00333"></a><a class="code" href="classMemoire.html#a922c512b37386cd9fa27493fa7f9f246">00333</a> <span class="keyword">const</span> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; <a class="code" href="classMemoire.html#a214a0f83b3164a2a24e366cc80cb806e" title="Retoune une reference sur l&#39;Objet_U de rang num dans la memoire.">Memoire::objet_u</a>(<span class="keywordtype">int</span> num)<span class="keyword"> const</span>
<a name="l00334"></a>00334 <span class="keyword"></span>{
<a name="l00335"></a>00335   assert(num &gt;=0);
<a name="l00336"></a>00336   assert(num &lt; <a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>);
<a name="l00337"></a>00337   assert(!<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].libre());
<a name="l00338"></a>00338   <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; objet = <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].<a class="code" href="classMemoire__ptr.html#a9f0b4fe6a16cdacbbc0fba27b00c8177" title="Retourne une reference sur l&#39;Objet_U pointe par le pointeur memoire.">obj</a>();
<a name="l00339"></a>00339   <span class="keyword">const</span> <span class="keywordtype">int</span> num_obj = objet.<a class="code" href="classObjet__U.html#a299d10d1be93af1c2b9f2f43f50141f5" title="Renvoie l&#39;indice de l&#39;objet dans Memoire::data.">numero</a>();
<a name="l00340"></a>00340   <span class="keywordflow">if</span> (num_obj != num)
<a name="l00341"></a>00341     {
<a name="l00342"></a>00342       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in const Objet_U &amp; Memoire::objet_u(int num) &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00343"></a>00343       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; num                       = &quot;</span> &lt;&lt; num &lt;&lt; finl;
<a name="l00344"></a>00344       std::cerr &lt;&lt; <span class="stringliteral">&quot; data[num].o_ptr           = &quot;</span> &lt;&lt; &amp;objet &lt;&lt; std::endl;
<a name="l00345"></a>00345       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; data[num].o_ptr-&gt;numero() = &quot;</span> &lt;&lt; num_obj &lt;&lt; finl;
<a name="l00346"></a>00346       assert(0);
<a name="l00347"></a>00347       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00348"></a>00348     }
<a name="l00349"></a>00349   <span class="keywordflow">return</span> objet;
<a name="l00350"></a>00350 }
<a name="l00351"></a>00351 
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 <span class="comment">// Precondition:</span>
<a name="l00354"></a>00354 <span class="comment">// num doit etre positif ou nul et inferieur au nombre d&#39;objets de la memoire</span>
<a name="l00355"></a>00355 <span class="comment">// Parametre: int num</span>
<a name="l00356"></a>00356 <span class="comment">// Signification: le rang de l&#39;objet dans la memoire</span>
<a name="l00357"></a>00357 <span class="comment">// Valeurs par defaut:</span>
<a name="l00358"></a>00358 <span class="comment">// Contraintes:</span>
<a name="l00359"></a>00359 <span class="comment">// Acces: entree</span>
<a name="l00360"></a>00360 <span class="comment">// Exception:</span>
<a name="l00361"></a>00361 <span class="comment">// Sort en erreur si la memoire comporte une erreur a la case de rang num</span>
<a name="l00362"></a>00362 <span class="comment">// Effets de bord:</span>
<a name="l00363"></a>00363 <span class="comment">// Postcondition:</span>
<a name="l00364"></a>00364 <span class="comment">//</span><span class="comment"></span>
<a name="l00365"></a>00365 <span class="comment">//! Retoune un pointeur sur l&#39;Objet_U de rang num dans la memoire</span>
<a name="l00366"></a>00366 <span class="comment"></span><span class="comment">/** \return Objet_U\&amp;&lt;br&gt;</span>
<a name="l00367"></a>00367 <span class="comment">Signification: reference sur l&#39;Objet_U trouve&lt;br&gt;</span>
<a name="l00368"></a>00368 <span class="comment">Contraintes: */</span>
<a name="l00369"></a><a class="code" href="classMemoire.html#a36f6e504179ff0415989dc468128395e">00369</a> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>* <a class="code" href="classMemoire.html#a36f6e504179ff0415989dc468128395e" title="Retoune un pointeur sur l&#39;Objet_U de rang num dans la memoire.">Memoire::objet_u_ptr</a>(<span class="keywordtype">int</span> num)
<a name="l00370"></a>00370 {
<a name="l00371"></a>00371   assert(num &gt;=0);
<a name="l00372"></a>00372   assert(num &lt; <a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>);
<a name="l00373"></a>00373   assert(!<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].libre());
<a name="l00374"></a>00374   <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; objet = <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].<a class="code" href="classMemoire__ptr.html#a9f0b4fe6a16cdacbbc0fba27b00c8177" title="Retourne une reference sur l&#39;Objet_U pointe par le pointeur memoire.">obj</a>();
<a name="l00375"></a>00375   <span class="keyword">const</span> <span class="keywordtype">int</span> num_obj = objet.<a class="code" href="classObjet__U.html#a299d10d1be93af1c2b9f2f43f50141f5" title="Renvoie l&#39;indice de l&#39;objet dans Memoire::data.">numero</a>();
<a name="l00376"></a>00376   <span class="keywordflow">if</span> (num_obj != num)
<a name="l00377"></a>00377     {
<a name="l00378"></a>00378       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Objet_U * Memoire::objet_u(int num) &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00379"></a>00379       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; num                       = &quot;</span> &lt;&lt; num &lt;&lt; finl;
<a name="l00380"></a>00380       std::cerr &lt;&lt; <span class="stringliteral">&quot; data[num].o_ptr           = &quot;</span> &lt;&lt; &amp;objet &lt;&lt; std::endl;
<a name="l00381"></a>00381       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; data[num].o_ptr-&gt;numero() = &quot;</span> &lt;&lt; num_obj &lt;&lt; finl;
<a name="l00382"></a>00382       assert(0);
<a name="l00383"></a>00383       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00384"></a>00384     }
<a name="l00385"></a>00385   <span class="keywordflow">return</span> &amp;objet;
<a name="l00386"></a>00386 }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 <span class="comment">// Precondition:</span>
<a name="l00390"></a>00390 <span class="comment">// num doit etre positif ou nul et inferieur au nombre d&#39;objets de la memoire</span>
<a name="l00391"></a>00391 <span class="comment">// Parametre: int num</span>
<a name="l00392"></a>00392 <span class="comment">// Signification: le rang de l&#39;objet dans la memoire</span>
<a name="l00393"></a>00393 <span class="comment">// Valeurs par defaut:</span>
<a name="l00394"></a>00394 <span class="comment">// Contraintes:</span>
<a name="l00395"></a>00395 <span class="comment">// Acces: entree</span>
<a name="l00396"></a>00396 <span class="comment">// Exception:</span>
<a name="l00397"></a>00397 <span class="comment">// Sort en erreur si la memoire comporte une erreur a la case de rang num</span>
<a name="l00398"></a>00398 <span class="comment">// Effets de bord:</span>
<a name="l00399"></a>00399 <span class="comment">// Postcondition:</span>
<a name="l00400"></a>00400 <span class="comment">//</span><span class="comment"></span>
<a name="l00401"></a>00401 <span class="comment">//! Retoune un pointeur constant sur l&#39;Objet_U de rang num dans la memoire</span>
<a name="l00402"></a>00402 <span class="comment"></span><span class="comment">/** \return Objet_U\&amp;&lt;br&gt;</span>
<a name="l00403"></a>00403 <span class="comment">Signification: reference sur l&#39;Objet_U trouve&lt;br&gt;</span>
<a name="l00404"></a>00404 <span class="comment">Contraintes: */</span>
<a name="l00405"></a><a class="code" href="classMemoire.html#a31eaf81941f74063bbeecce5d39a4c8e">00405</a> <span class="keyword">const</span> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>* <a class="code" href="classMemoire.html#a36f6e504179ff0415989dc468128395e" title="Retoune un pointeur sur l&#39;Objet_U de rang num dans la memoire.">Memoire::objet_u_ptr</a>(<span class="keywordtype">int</span> num)<span class="keyword">const</span>
<a name="l00406"></a>00406 <span class="keyword"></span>{
<a name="l00407"></a>00407   assert(num &gt;=0);
<a name="l00408"></a>00408   assert(num &lt; <a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>);
<a name="l00409"></a>00409   assert(!<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].libre());
<a name="l00410"></a>00410   <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; objet = <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[num].<a class="code" href="classMemoire__ptr.html#a9f0b4fe6a16cdacbbc0fba27b00c8177" title="Retourne une reference sur l&#39;Objet_U pointe par le pointeur memoire.">obj</a>();
<a name="l00411"></a>00411   <span class="keyword">const</span> <span class="keywordtype">int</span> num_obj = objet.<a class="code" href="classObjet__U.html#a299d10d1be93af1c2b9f2f43f50141f5" title="Renvoie l&#39;indice de l&#39;objet dans Memoire::data.">numero</a>();
<a name="l00412"></a>00412   <span class="keywordflow">if</span> (num_obj != num)
<a name="l00413"></a>00413     {
<a name="l00414"></a>00414       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in const Objet_U * Memoire::objet_u(int num) &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00415"></a>00415       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; num                       = &quot;</span> &lt;&lt; num &lt;&lt; finl;
<a name="l00416"></a>00416       std::cerr &lt;&lt; <span class="stringliteral">&quot; data[num].o_ptr           = &quot;</span> &lt;&lt; &amp;objet &lt;&lt; std::endl;
<a name="l00417"></a>00417       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; data[num].o_ptr-&gt;numero() = &quot;</span> &lt;&lt; num_obj &lt;&lt; finl;
<a name="l00418"></a>00418       assert(0);
<a name="l00419"></a>00419       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00420"></a>00420     }
<a name="l00421"></a>00421   <span class="keywordflow">return</span> &amp;objet;
<a name="l00422"></a>00422 }
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 
<a name="l00425"></a>00425 <span class="comment">// Precondition:</span>
<a name="l00426"></a>00426 <span class="comment">// Parametre:</span>
<a name="l00427"></a>00427 <span class="comment">// Signification:</span>
<a name="l00428"></a>00428 <span class="comment">// Valeurs par defaut:</span>
<a name="l00429"></a>00429 <span class="comment">// Contraintes:</span>
<a name="l00430"></a>00430 <span class="comment">// Acces:</span>
<a name="l00431"></a>00431 <span class="comment">// </span>
<a name="l00432"></a>00432 <span class="comment">// Signification:</span>
<a name="l00433"></a>00433 <span class="comment">// Contraintes:</span>
<a name="l00434"></a>00434 <span class="comment">// Exception:</span>
<a name="l00435"></a>00435 <span class="comment">// Effets de bord:</span>
<a name="l00436"></a>00436 <span class="comment">// Postcondition:</span>
<a name="l00437"></a>00437 <span class="comment">//</span>
<a name="l00438"></a>00438 <span class="comment">//</span><span class="comment"></span>
<a name="l00439"></a>00439 <span class="comment">//! Compacte la memoire&lt;br&gt;Ce compactage est effectue automatiquement lorsqu&#39;il devient necessaire</span>
<a name="l00440"></a><a class="code" href="classMemoire.html#a46c7b07f882adba0eae1724c7ad861e2">00440</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classMemoire.html#a46c7b07f882adba0eae1724c7ad861e2" title="Compacte la memoire Ce compactage est effectue automatiquement lorsqu&#39;il devient necessaire.">Memoire::compacte</a>()
<a name="l00441"></a>00441 {
<a name="l00442"></a>00442 <span class="comment">// Cerr &lt;&lt; &quot;On compacte la memoire &quot; &lt;&lt; finl;</span>
<a name="l00443"></a>00443 <span class="comment">// Cerr &lt;&lt; &quot;size prems &quot; &lt;&lt; size &lt;&lt; &quot; &quot; &lt;&lt; prems &lt;&lt; finl;</span>
<a name="l00444"></a>00444 <span class="comment">// Cerr &lt;&lt; &quot;avant&quot; &lt;&lt; finl;</span>
<a name="l00445"></a>00445   <span class="keywordtype">int</span> i, compte=0;
<a name="l00446"></a>00446   <span class="keywordtype">int</span>* newnum=<span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>];
<a name="l00447"></a>00447   <span class="keywordflow">if</span>(!newnum)
<a name="l00448"></a>00448     {
<a name="l00449"></a>00449       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Not enough memory &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00450"></a>00450       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00451"></a>00451     }
<a name="l00452"></a>00452   <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00453"></a>00453     <span class="keywordflow">if</span>(<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i].libre())
<a name="l00454"></a>00454       newnum[i]=-1;
<a name="l00455"></a>00455     <span class="keywordflow">else</span>
<a name="l00456"></a>00456       newnum[i]=compte++;
<a name="l00457"></a>00457   <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00458"></a>00458     <span class="keywordflow">if</span>(newnum[i]&gt;-1)
<a name="l00459"></a>00459       {
<a name="l00460"></a>00460         <a class="code" href="classMemoire.html#a214a0f83b3164a2a24e366cc80cb806e" title="Retoune une reference sur l&#39;Objet_U de rang num dans la memoire.">objet_u</a>(i).<a class="code" href="classObjet__U.html#a6f83d6ca940b341101e6f52dbe24cfbe" title="Change le numero interne de l&#39;Objet_U.">change_num</a>(newnum);
<a name="l00461"></a>00461       }
<a name="l00462"></a>00462   <a class="code" href="classMemoire__ptr.html" title="Pointeur dans la Memoire de TRUST pour un Objet_U.">Memoire_ptr</a>* newdata=<span class="keyword">new</span> <a class="code" href="classMemoire__ptr.html" title="Pointeur dans la Memoire de TRUST pour un Objet_U.">Memoire_ptr</a>[compte];
<a name="l00463"></a>00463   <span class="keywordflow">if</span>(!newdata)
<a name="l00464"></a>00464     {
<a name="l00465"></a>00465       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Not enough memory &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00466"></a>00466       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00467"></a>00467     }
<a name="l00468"></a>00468   <span class="keywordflow">for</span>(i=0; i&lt; <a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00469"></a>00469     <span class="keywordflow">if</span>(newnum[i]&gt;-1)
<a name="l00470"></a>00470       newdata[newnum[i]]=<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i];
<a name="l00471"></a>00471   <span class="keyword">delete</span>[] <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>;
<a name="l00472"></a>00472   <span class="keyword">delete</span>[] newnum;
<a name="l00473"></a>00473   <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>=newdata;
<a name="l00474"></a>00474   size=<a class="code" href="classMemoire.html#a4c917c493d12d3068e6358a5c206c69c">prems</a>=compte;
<a name="l00475"></a>00475   <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00476"></a>00476     <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i].<a class="code" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a>=i+1;
<a name="l00477"></a>00477   <a class="code" href="classMemoire.html#a1aed38d66018e07086e3077b2b728943" title="Verifie le contenu de toutes les cases de la memoire.">verifie</a>();
<a name="l00478"></a>00478 <span class="comment">// Cerr &lt;&lt; &quot;la memoire est compactee&quot; &lt;&lt; finl;</span>
<a name="l00479"></a>00479 <span class="comment">// Cerr &lt;&lt; &quot;size prems &quot; &lt;&lt; size &lt;&lt; &quot; &quot; &lt;&lt; prems &lt;&lt; finl;</span>
<a name="l00480"></a>00480 }
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 
<a name="l00483"></a>00483 <span class="comment">// Precondition:</span>
<a name="l00484"></a>00484 <span class="comment">// Parametre:</span>
<a name="l00485"></a>00485 <span class="comment">// Signification:</span>
<a name="l00486"></a>00486 <span class="comment">// Valeurs par defaut:</span>
<a name="l00487"></a>00487 <span class="comment">// Contraintes:</span>
<a name="l00488"></a>00488 <span class="comment">// Acces:</span>
<a name="l00489"></a>00489 <span class="comment">// Exception:</span>
<a name="l00490"></a>00490 <span class="comment">// Effets de bord:</span>
<a name="l00491"></a>00491 <span class="comment">// Postcondition:</span>
<a name="l00492"></a>00492 <span class="comment">//</span><span class="comment"></span>
<a name="l00493"></a>00493 <span class="comment">//! Imprime un etat sur la memoire sur la sortie des erreurs</span>
<a name="l00494"></a>00494 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00495"></a>00495 <span class="comment">Signification: code de retour; retourne toujours 1&lt;br&gt;</span>
<a name="l00496"></a>00496 <span class="comment">Contraintes: */</span>
<a name="l00497"></a><a class="code" href="classMemoire.html#a55101fe7e31a040a96c35b44a1a2ad60">00497</a> <span class="keywordtype">int</span> <a class="code" href="classMemoire.html#a55101fe7e31a040a96c35b44a1a2ad60" title="Imprime un etat sur la memoire sur la sortie des erreurs.">Memoire::imprime</a>()<span class="keyword"> const</span>
<a name="l00498"></a>00498 <span class="keyword"></span>{
<a name="l00499"></a>00499   assert(<a class="code" href="classMemoire.html#a4c917c493d12d3068e6358a5c206c69c">prems</a> &lt;=<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>);
<a name="l00500"></a>00500   <span class="keywordtype">int</span> i, tmp=0;
<a name="l00501"></a>00501   <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00502"></a>00502     <span class="keywordflow">if</span>(! <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i].libre()) tmp++;
<a name="l00503"></a>00503   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;\n There are &quot;</span> &lt;&lt; size &lt;&lt; <span class="stringliteral">&quot; memory squares&quot;</span>;
<a name="l00504"></a>00504   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;\n of which &quot;</span> &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot; ==(const char*)&quot;</span> &lt;&lt; <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> &lt;&lt; <span class="stringliteral">&quot; are used&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00505"></a>00505   <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00506"></a>00506     {
<a name="l00507"></a>00507       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span> &lt;&lt; flush;
<a name="l00508"></a>00508       <span class="keywordflow">if</span>(! (<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i].libre()) )
<a name="l00509"></a>00509         {
<a name="l00510"></a>00510           <span class="keyword">const</span> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; obj=<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i].<a class="code" href="classMemoire__ptr.html#a9f0b4fe6a16cdacbbc0fba27b00c8177" title="Retourne une reference sur l&#39;Objet_U pointe par le pointeur memoire.">obj</a>();
<a name="l00511"></a>00511           <span class="keywordflow">if</span> (obj.<a class="code" href="classObjet__U.html#a299d10d1be93af1c2b9f2f43f50141f5" title="Renvoie l&#39;indice de l&#39;objet dans Memoire::data.">numero</a>() != i)
<a name="l00512"></a>00512             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;error&quot;</span>;
<a name="l00513"></a>00513           <span class="keywordflow">else</span>
<a name="l00514"></a>00514             {
<a name="l00515"></a>00515               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;TYPE :&quot;</span> &lt;&lt; obj.<a class="code" href="classObjet__U.html#a20e8218a2f8f3659081112fc055fc3a5" title="Donne le nom du type de l&#39;Objet_U.">le_type</a>()&lt;&lt; flush;
<a name="l00516"></a>00516               <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classO__U__Ptr.html" title="Pointeur sur un Objet_U. Le constructeur par defaut construit un pointeur &quot;nul&quot;. O_U_Ptr_H.">O_U_Ptr</a>, obj))
<a name="l00517"></a>00517                 {
<a name="l00518"></a>00518                   <span class="keyword">const</span> <a class="code" href="classO__U__Ptr.html" title="Pointeur sur un Objet_U. Le constructeur par defaut construit un pointeur &quot;nul&quot;. O_U_Ptr_H.">O_U_Ptr</a>&amp; x=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classO__U__Ptr.html" title="Pointeur sur un Objet_U. Le constructeur par defaut construit un pointeur &quot;nul&quot;. O_U_Ptr_H.">O_U_Ptr</a>, obj);
<a name="l00519"></a>00519                   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; key: &quot;</span> &lt;&lt; x &lt;&lt; flush;
<a name="l00520"></a>00520                 }
<a name="l00521"></a>00521               <span class="keywordflow">else</span>
<a name="l00522"></a>00522                 <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; NAME : &quot;</span> &lt;&lt; obj.<a class="code" href="classObjet__U.html#a70413a8785d36bf5105fced1c89d0d2b" title="Donne le nom de l&#39;Objet_U Methode a surcharger : renvoie &quot;neant&quot; dans cette implementation.">le_nom</a>() &lt;&lt; flush;
<a name="l00523"></a>00523               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; address : &quot;</span> &lt;&lt; (long)(&amp;(obj))&lt;&lt; flush;
<a name="l00524"></a>00524               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; SIZE : &quot;</span> &lt;&lt; (int)(obj.<a class="code" href="classObjet__U.html#a0ee0946339f09a2c73c09fcda71c3be2">taille_memoire</a>())&lt;&lt; <span class="stringliteral">&quot; octets &quot;</span>&lt;&lt; flush;
<a name="l00525"></a>00525             }
<a name="l00526"></a>00526         }
<a name="l00527"></a>00527       <span class="keywordflow">else</span>
<a name="l00528"></a>00528         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;free &quot;</span>;
<a name="l00529"></a>00529       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl;
<a name="l00530"></a>00530     }
<a name="l00531"></a>00531   <span class="keywordflow">return</span> 1;
<a name="l00532"></a>00532 }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534 
<a name="l00535"></a>00535 <span class="comment">// Precondition:</span>
<a name="l00536"></a>00536 <span class="comment">// Parametre:</span>
<a name="l00537"></a>00537 <span class="comment">// Signification:</span>
<a name="l00538"></a>00538 <span class="comment">// Valeurs par defaut:</span>
<a name="l00539"></a>00539 <span class="comment">// Contraintes:</span>
<a name="l00540"></a>00540 <span class="comment">// Acces:</span>
<a name="l00541"></a>00541 <span class="comment">// Exception:</span>
<a name="l00542"></a>00542 <span class="comment">// Effets de bord:</span>
<a name="l00543"></a>00543 <span class="comment">// Postcondition:</span>
<a name="l00544"></a>00544 <span class="comment">//</span><span class="comment"></span>
<a name="l00545"></a>00545 <span class="comment">//! Verifie le contenu de toutes les cases de la memoire</span>
<a name="l00546"></a>00546 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00547"></a>00547 <span class="comment">Signification: code de retour; retourne toujours 1&lt;br&gt;</span>
<a name="l00548"></a>00548 <span class="comment">Contraintes: */</span>
<a name="l00549"></a><a class="code" href="classMemoire.html#a1aed38d66018e07086e3077b2b728943">00549</a> <span class="keywordtype">int</span> <a class="code" href="classMemoire.html#a1aed38d66018e07086e3077b2b728943" title="Verifie le contenu de toutes les cases de la memoire.">Memoire::verifie</a>()<span class="keyword"> const</span>
<a name="l00550"></a>00550 <span class="keyword"></span>{
<a name="l00551"></a>00551   assert(<a class="code" href="classMemoire.html#a4c917c493d12d3068e6358a5c206c69c">prems</a> &lt;=<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>);
<a name="l00552"></a>00552   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00553"></a>00553     {
<a name="l00554"></a>00554       <span class="keywordflow">if</span>(! (<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i].libre()) )
<a name="l00555"></a>00555         {
<a name="l00556"></a>00556           <span class="keywordflow">if</span> ((<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i].obj()).numero() != i)
<a name="l00557"></a>00557             {
<a name="l00558"></a>00558               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;ERROR at the square &quot;</span> &lt;&lt; i &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00559"></a>00559               <a class="code" href="classMemoire.html#a55101fe7e31a040a96c35b44a1a2ad60" title="Imprime un etat sur la memoire sur la sortie des erreurs.">imprime</a>();
<a name="l00560"></a>00560               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00561"></a>00561             }
<a name="l00562"></a>00562         }
<a name="l00563"></a>00563     }
<a name="l00564"></a>00564   <span class="keywordflow">return</span> 1;
<a name="l00565"></a>00565 }
<a name="l00566"></a>00566 
<a name="l00567"></a>00567 
<a name="l00568"></a>00568 <span class="comment">// Precondition:</span>
<a name="l00569"></a>00569 <span class="comment">// Parametre: Sortie&amp; os</span>
<a name="l00570"></a>00570 <span class="comment">// Signification: le flot de sortie a utiliser</span>
<a name="l00571"></a>00571 <span class="comment">// Valeurs par defaut:</span>
<a name="l00572"></a>00572 <span class="comment">// Contraintes:</span>
<a name="l00573"></a>00573 <span class="comment">// Acces:</span>
<a name="l00574"></a>00574 <span class="comment">// Parametre: const Memoire&amp; mem</span>
<a name="l00575"></a>00575 <span class="comment">// Signification: la memoire a examiner</span>
<a name="l00576"></a>00576 <span class="comment">// Valeurs par defaut:</span>
<a name="l00577"></a>00577 <span class="comment">// Contraintes:</span>
<a name="l00578"></a>00578 <span class="comment">// Acces:</span>
<a name="l00579"></a>00579 <span class="comment">// Exception:</span>
<a name="l00580"></a>00580 <span class="comment">// Effets de bord:</span>
<a name="l00581"></a>00581 <span class="comment">// Postcondition:</span>
<a name="l00582"></a>00582 <span class="comment">//</span><span class="comment"></span>
<a name="l00583"></a>00583 <span class="comment">//! Operateur d&#39;affichage d&#39;un etat de la memoire mem sur le flot de sortie os</span>
<a name="l00584"></a>00584 <span class="comment"></span><span class="comment">/** \return Sortie\&amp; le flot de sortie modifie&lt;br&gt;</span>
<a name="l00585"></a>00585 <span class="comment">Signification:&lt;br&gt;</span>
<a name="l00586"></a>00586 <span class="comment">Contraintes: */</span>
<a name="l00587"></a><a class="code" href="Memoire_8h.html#a6081da23e9bd69ac20053d3be588a679">00587</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="String2_8cpp.html#a704f90d583a4fd0cada309350da375d5">operator &lt;&lt; </a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os, <span class="keyword">const</span> <a class="code" href="classMemoire.html" title="La memoire de Trio-U.">Memoire</a>&amp; mem)
<a name="l00588"></a>00588 {
<a name="l00589"></a>00589   <span class="keywordtype">int</span> i;
<a name="l00590"></a>00590   <span class="keywordtype">int</span> total=0;
<a name="l00591"></a>00591   <span class="keywordtype">int</span> tmp=0;
<a name="l00592"></a>00592   <span class="keywordtype">int</span> tmp1=0;
<a name="l00593"></a>00593   <span class="keywordflow">for</span>(i=0; i&lt;mem.<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00594"></a>00594     <span class="keywordflow">if</span>(! mem.<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i].<a class="code" href="classMemoire__ptr.html#a7a99abc7336d101a9b28dd47b59ff8cb" title="Indique si le pointeur memoire est libre, c&#39;est-a-dire s&#39;il pointe sur un Objet_U non nul...">libre</a>()) tmp++;
<a name="l00595"></a>00595   os &lt;&lt; <span class="stringliteral">&quot;\n il y a &quot;</span> &lt;&lt; mem.<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a> &lt;&lt; <span class="stringliteral">&quot; cases memoires&quot;</span>;
<a name="l00596"></a>00596   os &lt;&lt; <span class="stringliteral">&quot;\n dont &quot;</span> &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot; ==(const char*)&quot;</span> &lt;&lt; <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> &lt;&lt; <span class="stringliteral">&quot; sont occupees&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00597"></a>00597   <span class="keywordflow">for</span>(i=0; i&lt;mem.<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00598"></a>00598     <span class="keywordflow">if</span>(! mem.<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i].<a class="code" href="classMemoire__ptr.html#a7a99abc7336d101a9b28dd47b59ff8cb" title="Indique si le pointeur memoire est libre, c&#39;est-a-dire s&#39;il pointe sur un Objet_U non nul...">libre</a>())
<a name="l00599"></a>00599       {
<a name="l00600"></a>00600         os &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00601"></a>00601         <span class="keyword">const</span> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; obj=mem.<a class="code" href="classMemoire.html#a214a0f83b3164a2a24e366cc80cb806e" title="Retoune une reference sur l&#39;Objet_U de rang num dans la memoire.">objet_u</a>(i);
<a name="l00602"></a>00602         os &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span>;
<a name="l00603"></a>00603         os &lt;&lt; <span class="stringliteral">&quot;TYPE :&quot;</span> &lt;&lt; obj.<a class="code" href="classObjet__U.html#a20e8218a2f8f3659081112fc055fc3a5" title="Donne le nom du type de l&#39;Objet_U.">le_type</a>();
<a name="l00604"></a>00604         <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>,obj)) os &lt;&lt; <span class="stringliteral">&quot; NOM : &quot;</span> &lt;&lt; obj.<a class="code" href="classObjet__U.html#a70413a8785d36bf5105fced1c89d0d2b" title="Donne le nom de l&#39;Objet_U Methode a surcharger : renvoie &quot;neant&quot; dans cette implementation.">le_nom</a>() ;
<a name="l00605"></a>00605         os &lt;&lt; <span class="stringliteral">&quot; adresse : &quot;</span> &lt;&lt; (long)(&amp;(obj));
<a name="l00606"></a>00606         <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>,obj))
<a name="l00607"></a>00607           {
<a name="l00608"></a>00608             <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; toto = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>,obj);
<a name="l00609"></a>00609             tmp = obj.<a class="code" href="classObjet__U.html#a0ee0946339f09a2c73c09fcda71c3be2">taille_memoire</a>() +
<a name="l00610"></a>00610                   (int) ((toto.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()*<span class="keyword">sizeof</span>(int))/toto.<a class="code" href="classArrOfInt.html#a2e8671e0e07855965bbff4c59582f224" title="Retourne le nombre de references des donnees du tableau si le tableau est &quot;normal&quot;, -1 s&#39;il est &quot;detache&quot; ou &quot;ref_data&quot;.">ref_count</a>());
<a name="l00611"></a>00611             os &lt;&lt; <span class="stringliteral">&quot; TAILLE ArrOfInt : &quot;</span> &lt;&lt; tmp&lt;&lt; <span class="stringliteral">&quot; octets &quot;</span>;
<a name="l00612"></a>00612             <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classIntVect.html">IntVect</a>,obj))
<a name="l00613"></a>00613               {
<a name="l00614"></a>00614                 <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; titi = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classIntVect.html">IntVect</a>,obj);
<a name="l00615"></a>00615                 tmp1 = obj.<a class="code" href="classObjet__U.html#a0ee0946339f09a2c73c09fcda71c3be2">taille_memoire</a>() +
<a name="l00616"></a>00616                        (int) ((titi.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>()*<span class="keyword">sizeof</span>(int))/titi.<a class="code" href="classArrOfInt.html#a2e8671e0e07855965bbff4c59582f224" title="Retourne le nombre de references des donnees du tableau si le tableau est &quot;normal&quot;, -1 s&#39;il est &quot;detache&quot; ou &quot;ref_data&quot;.">ref_count</a>());
<a name="l00617"></a>00617                 os &lt;&lt; <span class="stringliteral">&quot; dont : &quot;</span> &lt;&lt; (tmp-tmp1) &lt;&lt; <span class="stringliteral">&quot; octets virtuels &quot;</span>;
<a name="l00618"></a>00618               }
<a name="l00619"></a>00619             os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00620"></a>00620           }
<a name="l00621"></a>00621         <span class="keywordflow">else</span>
<a name="l00622"></a>00622           {
<a name="l00623"></a>00623             <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>,obj))
<a name="l00624"></a>00624               {
<a name="l00625"></a>00625                 <span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; toto = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>,obj);
<a name="l00626"></a>00626                 tmp = obj.<a class="code" href="classObjet__U.html#a0ee0946339f09a2c73c09fcda71c3be2">taille_memoire</a>() +
<a name="l00627"></a>00627                       (int) ((toto.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()*<span class="keyword">sizeof</span>(double))/toto.<a class="code" href="classArrOfDouble.html#a324a6714dc9d9a7b5997fda646d24974" title="Retourne le nombre de references des donnees du tableau si le tableau est &quot;normal&quot;, -1 s&#39;il est &quot;detache&quot; ou &quot;ref_data&quot;.">ref_count</a>());
<a name="l00628"></a>00628                 os &lt;&lt; <span class="stringliteral">&quot; TAILLE ArrOfDouble : &quot;</span> &lt;&lt; tmp&lt;&lt; <span class="stringliteral">&quot; octets &quot;</span>;
<a name="l00629"></a>00629                 <span class="comment">/* PL: Plante en P1Bulle donc je commente</span>
<a name="l00630"></a>00630 <span class="comment">                   if(sub_type(DoubleVect,obj)){</span>
<a name="l00631"></a>00631 <span class="comment">                   const DoubleVect&amp; titi = ref_cast(DoubleVect,obj);</span>
<a name="l00632"></a>00632 <span class="comment">                   tmp1 = obj.taille_memoire() +</span>
<a name="l00633"></a>00633 <span class="comment">                   (int) ((titi.size()*sizeof(double))/titi.ref_count());</span>
<a name="l00634"></a>00634 <span class="comment">                   os &lt;&lt; &quot; dont : &quot; &lt;&lt; (tmp-tmp1) &lt;&lt; &quot; octets virtuels &quot;;</span>
<a name="l00635"></a>00635 <span class="comment">                   } */</span>
<a name="l00636"></a>00636                 os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00637"></a>00637               }
<a name="l00638"></a>00638             <span class="keywordflow">else</span>
<a name="l00639"></a>00639               {
<a name="l00640"></a>00640                 <span class="comment">/*</span>
<a name="l00641"></a>00641 <span class="comment">                  if(sub_type(Matrice_Morse_Sym,obj)){</span>
<a name="l00642"></a>00642 <span class="comment">                  const Matrice_Morse_Sym&amp; toto = ref_cast(Matrice_Morse_Sym,obj);</span>
<a name="l00643"></a>00643 <span class="comment">                  tmp = obj.taille_memoire() +</span>
<a name="l00644"></a>00644 <span class="comment">                  (int) (toto.nb_lignes()*sizeof(int)) +</span>
<a name="l00645"></a>00645 <span class="comment">                  (int) ((toto.nb_coeff()+1)*sizeof(int)) +</span>
<a name="l00646"></a>00646 <span class="comment">                  (int) (toto.nb_coeff()*sizeof(double));</span>
<a name="l00647"></a>00647 <span class="comment">                  os &lt;&lt; &quot; TAILLE Matrice_Morse_Sym : &quot; &lt;&lt; tmp&lt;&lt; &quot; octets &quot;;</span>
<a name="l00648"></a>00648 <span class="comment">                  os &lt;&lt; &quot;\n&quot;;</span>
<a name="l00649"></a>00649 <span class="comment">                  }</span>
<a name="l00650"></a>00650 <span class="comment">                  else</span>
<a name="l00651"></a>00651 <span class="comment">                */</span>
<a name="l00652"></a>00652                 os &lt;&lt; <span class="stringliteral">&quot; TAILLE : &quot;</span> &lt;&lt; (tmp=obj.<a class="code" href="classObjet__U.html#a0ee0946339f09a2c73c09fcda71c3be2">taille_memoire</a>())&lt;&lt; <span class="stringliteral">&quot; octets \n &quot;</span>;
<a name="l00653"></a>00653               }
<a name="l00654"></a>00654           }
<a name="l00655"></a>00655         total += tmp;
<a name="l00656"></a>00656         os.<a class="code" href="classSortie.html#a2456baf1997d9a7a6310349929bccf30">flush</a>();
<a name="l00657"></a>00657       }
<a name="l00658"></a>00658   os &lt;&lt; <span class="stringliteral">&quot;Taille memoire max: &quot;</span> &lt;&lt;  <a class="code" href="Memoire_8cpp.html#a5e58a838411d236617a731fb5afe468f">max_sz_mem</a> &lt;&lt; finl;
<a name="l00659"></a>00659   os &lt;&lt; <span class="stringliteral">&quot;Taille memoire min: &quot;</span> &lt;&lt;  <a class="code" href="Memoire_8cpp.html#ab45d2528f17360758465726935f3bb7e">min_sz_mem</a> &lt;&lt; finl;
<a name="l00660"></a>00660   os &lt;&lt; <span class="stringliteral">&quot;Taille memoire occupee en Mo: &quot;</span> &lt;&lt;  (<a class="code" href="Memoire_8cpp.html#a5e58a838411d236617a731fb5afe468f">max_sz_mem</a>-<a class="code" href="Memoire_8cpp.html#ab45d2528f17360758465726935f3bb7e">min_sz_mem</a>)/1024/1024 &lt;&lt; finl;
<a name="l00661"></a>00661 
<a name="l00662"></a>00662   <span class="keywordflow">return</span> os &lt;&lt; <span class="stringliteral">&quot;Occupation taille memoire totale en Mo: &quot;</span> &lt;&lt; total/1024/1024 &lt;&lt; finl;
<a name="l00663"></a>00663 }
<a name="l00664"></a>00664 
<a name="l00665"></a>00665 
<a name="l00666"></a>00666 
<a name="l00667"></a>00667 
<a name="l00668"></a>00668 <span class="comment">// Precondition:</span>
<a name="l00669"></a>00669 <span class="comment">// Parametre:</span>
<a name="l00670"></a>00670 <span class="comment">// Signification:</span>
<a name="l00671"></a>00671 <span class="comment">// Valeurs par defaut:</span>
<a name="l00672"></a>00672 <span class="comment">// Contraintes:</span>
<a name="l00673"></a>00673 <span class="comment">// Acces:</span>
<a name="l00674"></a>00674 <span class="comment">// </span>
<a name="l00675"></a>00675 <span class="comment">// Signification:</span>
<a name="l00676"></a>00676 <span class="comment">// Contraintes:</span>
<a name="l00677"></a>00677 <span class="comment">// Exception:</span>
<a name="l00678"></a>00678 <span class="comment">// Effets de bord:</span>
<a name="l00679"></a>00679 <span class="comment">// Postcondition:</span>
<a name="l00680"></a>00680 <span class="comment">//</span>
<a name="l00681"></a>00681 <span class="comment">//</span>
<a name="l00682"></a>00682 <span class="comment">//</span><span class="comment"></span>
<a name="l00683"></a>00683 <span class="comment">//! Destruction de la memoire&lt;br&gt;Supprime les zone de travail pour les Objet_U, les double et les int&lt;br&gt;Sort (exit) avec un code 0</span>
<a name="l00684"></a><a class="code" href="classMemoire.html#aa82bbb8df4104d9be5f721127d9735cd">00684</a> <span class="comment"></span><a class="code" href="classMemoire.html#aa82bbb8df4104d9be5f721127d9735cd" title="Destruction de la memoire Supprime les zone de travail pour les Objet_U, les double et les int Sort (...">Memoire::~Memoire</a>()
<a name="l00685"></a>00685 {
<a name="l00686"></a>00686 <span class="comment">// GF on a deja tout detruit avant.</span>
<a name="l00687"></a>00687   <span class="keywordflow">return</span>;
<a name="l00688"></a>00688   <span class="keywordflow">if</span> (<a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>)
<a name="l00689"></a>00689     {
<a name="l00690"></a>00690       <span class="keywordtype">int</span> i;
<a name="l00691"></a>00691       <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="classMemoire.html#adaff2aa11d09d28ce7a0f30764a0fdff">size</a>; i++)
<a name="l00692"></a>00692         <span class="keywordflow">if</span>(! <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>[i].libre())
<a name="l00693"></a>00693           {
<a name="l00694"></a>00694             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00695"></a>00695             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00696"></a>00696             <span class="keyword">const</span> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; obj=<a class="code" href="classMemoire.html#a214a0f83b3164a2a24e366cc80cb806e" title="Retoune une reference sur l&#39;Objet_U de rang num dans la memoire.">objet_u</a>(i);
<a name="l00697"></a>00697             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; :: &quot;</span>;
<a name="l00698"></a>00698             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;TYPE :&quot;</span> &lt;&lt; obj.<a class="code" href="classObjet__U.html#a20e8218a2f8f3659081112fc055fc3a5" title="Donne le nom du type de l&#39;Objet_U.">le_type</a>() &lt;&lt; finl;
<a name="l00699"></a>00699           }
<a name="l00700"></a>00700 
<a name="l00701"></a>00701       <span class="keyword">delete</span>[] <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>;
<a name="l00702"></a>00702       <span class="keyword">delete</span> <a class="code" href="classMemoire.html#a48f9d322d95ecfcfad79b793b8ae63a9">trav_double</a>;
<a name="l00703"></a>00703       <span class="keyword">delete</span> <a class="code" href="classMemoire.html#ae2cd9384c90a89b4fe4053c35746a28d">trav_int</a>;
<a name="l00704"></a>00704       <a class="code" href="classMemoire.html#a51fd92a82514ca97dd348e3b9a56bad3">data</a>=0;
<a name="l00705"></a>00705     }
<a name="l00706"></a>00706   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Memory destruction &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00707"></a>00707   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Max Memory Size : &quot;</span> &lt;&lt; <a class="code" href="Memoire_8cpp.html#a5e58a838411d236617a731fb5afe468f">max_sz_mem</a> &lt;&lt; finl;
<a name="l00708"></a>00708   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Memory size min : &quot;</span> &lt;&lt; <a class="code" href="Memoire_8cpp.html#ab45d2528f17360758465726935f3bb7e">min_sz_mem</a> &lt;&lt; finl;
<a name="l00709"></a>00709   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Memory size used in Ko : &quot;</span> &lt;&lt; (<a class="code" href="Memoire_8cpp.html#a5e58a838411d236617a731fb5afe468f">max_sz_mem</a>-<a class="code" href="Memoire_8cpp.html#ab45d2528f17360758465726935f3bb7e">min_sz_mem</a>)/1024 &lt;&lt; finl;
<a name="l00710"></a>00710   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00711"></a>00711 }
<a name="l00712"></a>00712 
<a name="l00713"></a>00713 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:27 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
