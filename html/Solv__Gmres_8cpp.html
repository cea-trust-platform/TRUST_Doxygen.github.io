<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Math/SolvSys/Solv_Gmres.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">src/Kernel/Math/SolvSys/Solv_Gmres.cpp File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="Solv__Gmres_8h_source.html">Solv_Gmres.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="Matrice__Morse__Sym_8h_source.html">Matrice_Morse_Sym.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="Matrice__Bloc_8h_source.html">Matrice_Bloc.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="Motcle_8h_source.html">Motcle.h</a>&gt;</code><br/>
</div>
<p><a href="Solv__Gmres_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Solv__Gmres_8cpp.html#afbc5853c7d6e7c4d9b3e3b54022af3c6">gmres_local</a> (const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;A, const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;b, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;x1, double &amp;seuil, int precond_diag, int &amp;nb_it_max, int &amp;controle_residu, <a class="el" href="classVect__DoubleVect.html">Vect_DoubleVect</a> &amp;v, int dim_espace_Krilov, int limpr_=0)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classType__info.html">Type_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Solv__Gmres_8cpp.html#a14829a5a3099d0b499340f39a3fd0bc4">Solv_Gmresbases</a> [1] = { &amp;( <a class="el" href="classsolv__iteratif.html">solv_iteratif</a> ::info_obj)}</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="afbc5853c7d6e7c4d9b3e3b54022af3c6"></a><!-- doxytag: member="Solv_Gmres.cpp::gmres_local" ref="afbc5853c7d6e7c4d9b3e3b54022af3c6" args="(const Matrice_Morse &amp;A, const DoubleVect &amp;b, DoubleVect &amp;x1, double &amp;seuil, int precond_diag, int &amp;nb_it_max, int &amp;controle_residu, Vect_DoubleVect &amp;v, int dim_espace_Krilov, int limpr_=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gmres_local </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>seuil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>precond_diag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>nb_it_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>controle_residu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classVect__DoubleVect.html">Vect_DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dim_espace_Krilov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>limpr_</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; dimension de l'espace de Krylov nkr=10;</p>
<p>&lt; Krilov vectors</p>
<p>&lt; Heisenberg maatrix of coefficients</p>
<p>&lt; nothing to do </p>
</p>

<p>Definition at line <a class="el" href="Solv__Gmres_8cpp_source.html#l00208">208</a> of file <a class="el" href="Solv__Gmres_8cpp_source.html">Solv_Gmres.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="EntreeSortie_8h_source.html#l00033">Cout</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Double_8h_source.html#l00180">max()</a>, <a class="el" href="Double_8h_source.html#l00199">min()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l02353">mp_norme_vect()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l02342">mp_prodscal()</a>, <a class="el" href="Process_8cpp_source.html#l00178">Process::mp_sum()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00127">Matrice_Base::multvect()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00135">Matrice_Base::multvect_()</a>, <a class="el" href="DoubleVect_8h_source.html#l00153">DoubleVect::size()</a>, <a class="el" href="ArrOfDouble_8h_source.html#l00350">ArrOfDouble::size_array()</a>, <a class="el" href="DoubleVect_8h_source.html#l00135">DoubleVect::size_reelle()</a>, <a class="el" href="DoubleVect_8h_source.html#l00147">DoubleVect::size_reelle_ok()</a>, and <a class="el" href="Double_8h_source.html#l00369">sup_strict()</a>.</p>

<p>Referenced by <a class="el" href="Solv__Gmres_8cpp_source.html#l00415">Solv_Gmres::Gmres()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// return le_solveur_.resoudre_systeme(A,b,x1);</span>
<span class="comment">// A.inverse(b,x1,seuil); return 1;</span>

  <span class="keywordtype">int</span> i,j,nk,i0,im,it,ii;
  <span class="keywordtype">double</span> tem=1.,res,ccos,ssin ;
<span class="comment">// PL c&#39;est pas joli et c&#39;est de moi mais je ne comprends pas pourquoi</span>
<span class="comment">// l&#39;utilisation de b.size_reelle() plante sur la matrice en pression depuis la 1.6.0 (non teste)</span>
<span class="comment">// Qu&#39;est ce qui est fait en implicite pour b.size_reelle() soit &gt;=0 ???</span>
  <span class="keyword">const</span> <span class="keywordtype">int</span> ns=(b.<a class="code" href="classDoubleVect.html#aafef4b3a96cdc428d62c5cedc9af6112">size_reelle_ok</a>()?b.<a class="code" href="classDoubleVect.html#a4a6987db458541cdcd10495955f25263" title="Taille de l&#39;espace &quot;reel&quot; du vecteur. (si md_vector_ est nul, cette valeur est identique a size_arr...">size_reelle</a>():b.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>());

  <span class="keywordtype">int</span> nb_ligne_tot=(int)<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>((<span class="keywordtype">double</span>) ns);
<span class="comment">// Ajoute par DJ</span>
<span class="comment">// --------------</span>
<span class="comment">// int nb_elem_tot = b.size_totale();</span>
<span class="comment">// DoubleVect x1(x);</span>
<span class="comment">// x1=0.;</span>
<span class="comment">// for(int n_elem=0; n_elem&lt;nb_elem_tot; n_elem++)</span>
<span class="comment">// {</span>
<span class="comment">// x1(n_elem)=x(n_elem);</span>
<span class="comment">// }</span>
<span class="comment">// --------------</span>

<span class="comment">// A present dans le jdd</span>
  <span class="keywordtype">double</span> epsGMRES=1.e-10*0;
  <span class="keywordtype">int</span> nkr=<a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(10,nb_ligne_tot/2);                         <span class="comment">//!&lt; dimension de l&#39;espace de Krylov nkr=10;</span>
<span class="comment"></span><span class="comment">//</span>
  nkr=dim_espace_Krilov;
  <span class="keywordtype">int</span> nit1=<a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(20,nb_ligne_tot);
  <span class="keywordtype">int</span> nit=<a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(nb_it_max,nit1);
  <span class="keywordtype">double</span> rec_min = seuil;
  <span class="keywordtype">double</span> rec_max = 0.1  ;
  <span class="keywordtype">double</span> res2_old=-1;
  <span class="keywordflow">if</span> (v.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>()==0)
    v.<a class="code" href="classvect__impl.html#ad841d6b676a796bae26ed2566b7b3b41">dimensionner</a>(nkr);                         <span class="comment">//!&lt; Krilov vectors</span>
<span class="comment"></span>  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> h(nkr+1,nkr);                <span class="comment">//!&lt; Heisenberg maatrix of coefficients</span>
<span class="comment"></span>  <a class="code" href="classDoubleVect.html">DoubleVect</a> r(nkr+1);
  <a class="code" href="classDoubleVect.html">DoubleVect</a> v0(x1);
  <a class="code" href="classDoubleVect.html">DoubleVect</a> v1(x1) ;
  <span class="keywordtype">int</span> ns2=ns;
  <a class="code" href="classDoubleVect.html">DoubleVect</a> Diag(ns);
  Diag=1.;
  <span class="keywordflow">if</span> (precond_diag)
    <span class="keywordflow">for</span> ( i=0; i&lt;ns; i++)
      Diag[i]=1./A(i,i);

<span class="comment">// Initialisation</span>
  v0 = 0. ;
  v1 = 0. ;

  A.<a class="code" href="classMatrice__Base.html#a8e710142a55d65a007a89e0ccc36ed62">multvect_</a>(x1,v0);
  v0 *= -1. ;
  v0+=b;
  v0.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
  <span class="keywordtype">double</span> res0 = <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(v0);
  <span class="keywordflow">for</span> (ii=0; ii&lt;ns2; ii++)
    v0(ii)*=Diag(ii);
  res = <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(v0);
  <span class="keywordflow">if</span> (limpr_==1)
    <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<span class="stringliteral">&quot;Gmres : initial residual = &quot;</span>&lt;&lt;res0&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<span class="comment">// See http://stackoverflow.com/questions/3437085/check-nan-number</span>
<span class="comment">// May be could be interesting to implement isnan function somewhere</span>
  <span class="keywordflow">if</span> (res0!=res0)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Nan detected in Solv_Gmres::gmres_local()&quot;</span> &lt;&lt; finl;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Contact TRUST support.&quot;</span> &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }
  rec_min = (rec_min&lt;res*epsGMRES) ? res*epsGMRES : rec_min;
  rec_min = (rec_min&lt;rec_max) ? rec_min : rec_max ;

<span class="comment">// iterations</span>
  <span class="keywordflow">for</span>(it=0; it&lt;nit; it++)
    {
      <span class="keywordflow">if</span> (res==0) <span class="keywordflow">return</span> 0; <span class="comment">//!&lt; nothing to do</span>
<span class="comment"></span>      nk = nkr;

<span class="comment">// ...Orthogonalisation of Arnoldi</span>
      v0 /= res;
      r = 0. ;
      r[0] = res;
      h=0.;
      <span class="keywordflow">for</span>(j=0; j&lt;nkr; j++)
        {
          v0.echange_espace_virtuel();
          v[j]=v0;
          A.<a class="code" href="classMatrice__Base.html#a05caa487a25a6d5e7fbd38d4b2f4ee1e" title="Multiplication d&#39;un vecteur par la matrice. Operation: r = A*x.">multvect</a>(v0,v1);
          <span class="keywordflow">for</span> (ii=0; ii&lt;ns2; ii++) v1(ii)*=Diag(ii);
          v0 = v1 ;
<span class="comment">// Modifie par DJ</span>
<span class="comment">// ---------------</span>
          <span class="keywordflow">for</span>(i=0; i&lt;=j; i++)
            {
              <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; vvi=v[i];
              h(i,j)+=<a class="code" href="DoubleVect_8cpp.html#a07d13cbdadca6b60d5e128653f52a4bb">mp_prodscal</a>(v0,vvi);
              <span class="keywordflow">for</span> (ii=0; ii&lt;ns; ii++) v0(ii) -= h(i,j) * vvi(ii);
              v0.echange_espace_virtuel();
            }
          tem=<a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(v0);

          h(j+1,j) = tem;
          <span class="keywordflow">if</span>(tem&lt;rec_min)
            {
              nk = j+1;
              <span class="keywordflow">goto</span> l5;
            }
          v0 /= tem;
        }
<span class="comment">// ...Triangularisation</span>
l5:
      <span class="keywordflow">for</span>(i=0; i&lt;nk; i++)
        {
          im = i+1;
          tem = 1./sqrt(h(i,i)*h(i,i) + h(im,i)*h(im,i));
          ccos = h(i,i) * tem;
          ssin = - h(im,i) * tem;
          <span class="keywordflow">for</span>(j=i; j&lt;nk; j++)
            {
              tem = h(i,j);
              h(i,j) = ccos * tem - ssin * h(im,j);
              h(im,j) =  ssin * tem + ccos * h(im,j);
            }
          r[im] = ssin * r[i];
          r[i] *= ccos;
        }

<span class="comment">// ...Solution of linear system</span>
      <span class="keywordflow">for</span>(i=nk-1; i&gt;=0; i--)
        {
          r[i] /= h(i,i);
          <span class="keywordflow">for</span>(i0=i-1; i0&gt;=0; i0--)
            r[i0] -= h(i0,i)* r[i];
        }
      <span class="keywordflow">for</span>(i=0; i&lt;nk; i++)
        {
          <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; vvi=v[i];
          <span class="keywordflow">for</span>(ii=0; ii&lt;ns; ii++)  x1(ii) += r[i]*vvi(ii);
        }
      x1.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
      A.<a class="code" href="classMatrice__Base.html#a8e710142a55d65a007a89e0ccc36ed62">multvect_</a>(x1,v0);
      v0 *= -1. ;
      v0+=b;

<span class="comment">// calcul du residu sans le precond....</span>
      <span class="keywordtype">double</span> res2=<a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(v0);
      <span class="keywordflow">if</span> ((it&gt;0) &amp;&amp; (controle_residu==1) &amp;&amp; (<a class="code" href="Double_8h.html#a2c495f52155e100aae5a8903602ff590">sup_strict</a>(res2,res2_old)))
        {
          <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;The Gmres iterative system is stopped after : &quot;</span> &lt;&lt; it+1 &lt;&lt;<span class="stringliteral">&quot; iterations &quot;</span>&lt;&lt;finl;
          <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;since an increase of the residue is detected.&quot;</span>&lt;&lt; finl;
          <span class="keywordflow">return</span> it;
        }

      res2_old = res2;
      <span class="keywordflow">if</span> (limpr_==1)
        <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<span class="stringliteral">&quot; - At it = &quot;</span>&lt;&lt; it+1 &lt;&lt;<span class="stringliteral">&quot;, residu scalar = &quot;</span>&lt;&lt; res2 &lt;&lt; finl;

<span class="comment">// Test d&#39;arret sur le residu</span>
      <span class="keywordflow">if</span>(res2&lt;rec_min)
        {
<span class="comment">// Ajoute par DJ</span>
<span class="comment">// --------------</span>
          <span class="keywordflow">if</span> (limpr_&gt;-1)
            {
              <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;Gmres : Number of iterations to reach convergence : &quot;</span> &lt;&lt; it+1 &lt;&lt; finl;
              <span class="keywordtype">double</span> residu_relatif = (res0&gt;0?res2/res0:res2);
              <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;Final residue: &quot;</span> &lt;&lt; res2 &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span> &lt;&lt; residu_relatif &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; finl;
            }
          <span class="keywordflow">return</span> it+1;
        }
<span class="comment">// Test d&#39;arret sur le nombre d&#39;iterations max</span>
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (it==nit-1)
        {
<span class="comment">// Ajoute par DJ</span>
<span class="comment">// --------------</span>
<span class="comment">// On fait le choix de mettre a jour c_demi et mutilde_demi meme s&#39;il n&#39;y a pas convergence...</span>

<span class="comment">// x=x1;</span>
<span class="comment">// --------------</span>
          <span class="keywordflow">if</span> (limpr_&gt;-1)
            {
              <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;Gmres : Stopped after &quot;</span>&lt;&lt; it+1 &lt;&lt;<span class="stringliteral">&quot; iterations (=nb_it_max)&quot;</span>&lt;&lt; finl;
              <span class="keywordtype">double</span> residu_relatif = (res0&gt;0?res2/res0:res2);
              <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;Final residue: &quot;</span> &lt;&lt; res2 &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span> &lt;&lt; residu_relatif &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; finl;
            }
          <span class="keywordflow">if</span> (it == (nb_ligne_tot-1))
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&quot;</span>&lt;&lt; finl;
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;!!! Gmres stopped after a number of iterations equal to the matrix size. &quot;</span>&lt;&lt; finl;
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;!!! Either your matrix is ill-conditioned (try cholesky instead), or your convergence threshold is too low. &quot;</span>&lt;&lt; finl;
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&quot;</span>&lt;&lt; finl;
              <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>(-1);
            }
          <span class="keywordflow">return</span> it+1;
        }

<span class="comment">// Calcul du residu avec preconditionnement</span>
      <span class="keywordflow">for</span> (ii=0; ii&lt;ns2; ii++) v0(ii)*=Diag(ii);
      res = <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(v0);
    }
  <span class="keywordflow">return</span> -1;
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a14829a5a3099d0b499340f39a3fd0bc4"></a><!-- doxytag: member="Solv_Gmres.cpp::Solv_Gmresbases" ref="a14829a5a3099d0b499340f39a3fd0bc4" args="[1]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a>* <a class="el" href="Solv__Gmres_8cpp.html#a14829a5a3099d0b499340f39a3fd0bc4">Solv_Gmresbases</a>[1] = { &amp;( <a class="el" href="classsolv__iteratif.html">solv_iteratif</a> ::info_obj)}</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Solv__Gmres_8cpp_source.html#l00032">32</a> of file <a class="el" href="Solv__Gmres_8cpp_source.html">Solv_Gmres.cpp</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:53 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
