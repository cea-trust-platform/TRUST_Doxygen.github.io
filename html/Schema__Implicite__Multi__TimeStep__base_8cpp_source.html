<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Schemas_Temps/Schema_Implicite_Multi_TimeStep_base.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Schemas_Temps/Schema_Implicite_Multi_TimeStep_base.cpp</div>  </div>
</div>
<div class="contents">
<a href="Schema__Implicite__Multi__TimeStep__base_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Schema_Implicite_Multi_TimeStep_base.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Schemas_Temps</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/3</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Implicite__Multi__TimeStep__base_8h.html">Schema_Implicite_Multi_TimeStep_base.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Equation__base_8h.html">Equation_base.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__Couple_8h.html">Probleme_Couple.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Milieu__base_8h.html">Milieu_base.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Param_8h.html">Param.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="LecFicDiffuse_8h.html">LecFicDiffuse.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="communications_8h.html">communications.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse_8h.html">Matrice_Morse.h</a>&gt;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="Schema__Implicite__Multi__TimeStep__base_8cpp.html#a7a90a39501920a1ae4f91eb9225798f5">00034</a> <a class="code" href="Declare__Base_8h.html#ad0be56e3a9cdd8f6dafc3864627fea86">Implemente_base</a>(<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html">Schema_Implicite_Multi_TimeStep_base</a>,<span class="stringliteral">&quot;Schema_Implicite_Multi_TimeStep_base&quot;</span>,<a class="code" href="classSchema__Implicite__base.html" title="class Schema_Implicite_base Classe de base pour tous les schemas en temps implicite Il porte un objet...">Schema_Implicite_base</a>);
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="comment">// printOn()</span>
<a name="l00037"></a>00037 <span class="comment">//</span>
<a name="l00038"></a>00038 
<a name="l00039"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a070d77173012297a4b75c59157d7725b">00039</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a070d77173012297a4b75c59157d7725b" title="Surcharge Objet_U::printOn(Sortie&amp;) Imprime le schema en temps sur un flot de sortie. !! Attention n&#39;est pas symetrique de la lecture !! On ecrit les differents parametres du schema en temps.">Schema_Implicite_Multi_TimeStep_base::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00040"></a>00040 <span class="keyword"></span>{
<a name="l00041"></a>00041   <span class="keywordflow">return</span>  <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a070d77173012297a4b75c59157d7725b" title="Surcharge Objet_U::printOn(Sortie&amp;) Imprime le schema en temps sur un flot de sortie. !! Attention n&#39;est pas symetrique de la lecture !! On ecrit les differents parametres du schema en temps.">Schema_Implicite_base::printOn</a>(s);
<a name="l00042"></a>00042 }
<a name="l00043"></a>00043 <span class="comment"></span>
<a name="l00044"></a>00044 <span class="comment">////!&lt; readOn </span>
<a name="l00045"></a>00045 <span class="comment"></span><span class="comment">//</span>
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a616bee66bdacbf7fa99ce436646ad30e">00047</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a616bee66bdacbf7fa99ce436646ad30e" title="Lecture d&#39;un schema en temps a partir d&#39;un flot d&#39;entree. Le format de lecture attendu est le suivant...">Schema_Implicite_Multi_TimeStep_base::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s)
<a name="l00048"></a>00048 {
<a name="l00049"></a>00049   <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a918596856950ac4dd895c36e47c550be">nb_ite_max</a>=100000;
<a name="l00050"></a>00050   <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a67409abca1c65e048634c1977707ee36">residu_old_</a>=0;
<a name="l00051"></a>00051   <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#accd31b2329848889733a35a0f68b9631">facsec_max_</a>=<a class="code" href="Double_8h.html#ae0ee0cebfad5968da0ad6cc7a49e16b6">DMAXFLOAT</a>;
<a name="l00052"></a>00052 
<a name="l00053"></a>00053   <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a616bee66bdacbf7fa99ce436646ad30e" title="Lecture d&#39;un schema en temps a partir d&#39;un flot d&#39;entree. Le format de lecture attendu est le suivant...">Schema_Implicite_base::readOn</a>(s);
<a name="l00054"></a>00054 
<a name="l00055"></a>00055   <span class="keywordflow">if</span>(!<a class="code" href="classSchema__Implicite__base.html#a2ec52d78a0623b094e00e6c6c6c4cfe2">le_solveur</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l00056"></a>00056     {
<a name="l00057"></a>00057       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;A solver must be selected.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00058"></a>00058       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Syntax : &quot;</span> &lt;&lt; finl
<a name="l00059"></a>00059            &lt;&lt; <span class="stringliteral">&quot;Solveur solver_name [ solver parameters ] &quot;</span> &lt;&lt; finl;
<a name="l00060"></a>00060       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00061"></a>00061     }
<a name="l00062"></a>00062   <span class="keywordflow">if</span> (<a class="code" href="classSchema__Temps__base.html#af19143270478f1a870292550da641a94" title="Renvoie 1 si le schema en temps a ete lu diffusion_implicite.">diffusion_implicite</a>())
<a name="l00063"></a>00063     {
<a name="l00064"></a>00064       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;diffusion_implicite option cannot be used with an implicit time scheme.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00065"></a>00065       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00066"></a>00066     }
<a name="l00067"></a>00067 
<a name="l00068"></a>00068   <span class="keywordflow">return</span> s;
<a name="l00069"></a>00069 }
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="Schema__Implicite__Multi__TimeStep__base_8cpp.html#a1d05275a5b6167d30101855a79fa56c7">00071</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Schema__Implicite__Multi__TimeStep__base_8cpp.html#a1d05275a5b6167d30101855a79fa56c7">Implicite_Multi_TimeStep_calcul_fac_sec</a>(<span class="keywordtype">double</span>&amp; residu_,<span class="keywordtype">double</span>&amp; residu_old,<span class="keywordtype">double</span>&amp; facsec_,<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; facsec_max_,<span class="keywordtype">int</span>&amp; nb_ite_sans_accel_)
<a name="l00072"></a>00072 {
<a name="l00073"></a>00073   <span class="keywordtype">double</span> rap                   = 1.2;
<a name="l00074"></a>00074   <span class="keywordtype">int</span>    nb_ite_sans_accel_max = 20000;
<a name="l00075"></a>00075 
<a name="l00076"></a>00076   <span class="keywordflow">if</span> (residu_old==0)
<a name="l00077"></a>00077     {
<a name="l00078"></a>00078       residu_old=residu_;
<a name="l00079"></a>00079       nb_ite_sans_accel_=0;
<a name="l00080"></a>00080     }
<a name="l00081"></a>00081   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((residu_old&gt;rap*residu_)||(nb_ite_sans_accel_&gt;nb_ite_sans_accel_max))
<a name="l00082"></a>00082     {
<a name="l00083"></a>00083       facsec_*=sqrt(rap);
<a name="l00084"></a>00084       residu_old=residu_;
<a name="l00085"></a>00085       facsec_=<a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(facsec_,facsec_max_);
<a name="l00086"></a>00086       nb_ite_sans_accel_=0;
<a name="l00087"></a>00087     }
<a name="l00088"></a>00088 
<a name="l00089"></a>00089   nb_ite_sans_accel_++;
<a name="l00090"></a>00090 }
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ad9e6d24263afb655218e2b83d60ccb3c">00092</a> <span class="keywordtype">void</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ad9e6d24263afb655218e2b83d60ccb3c">Schema_Implicite_Multi_TimeStep_base::set_param</a>(<a class="code" href="classParam.html" title="Defined below in this file.">Param</a>&amp; param)
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 {
<a name="l00095"></a>00095   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;max_iter_implicite&quot;</span>,&amp;<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a918596856950ac4dd895c36e47c550be">nb_ite_max</a>);
<a name="l00096"></a>00096   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;facsec_max&quot;</span>, &amp;<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#accd31b2329848889733a35a0f68b9631">facsec_max_</a>);
<a name="l00097"></a>00097   <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ad9e6d24263afb655218e2b83d60ccb3c">Schema_Implicite_base::set_param</a>(param);
<a name="l00098"></a>00098 }
<a name="l00099"></a>00099 
<a name="l00100"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a718ff28412ce9367f9f253ecd3a54722">00100</a> <span class="keywordtype">bool</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a718ff28412ce9367f9f253ecd3a54722">Schema_Implicite_Multi_TimeStep_base::initTimeStep</a>(<span class="keywordtype">double</span> dt)
<a name="l00101"></a>00101 {
<a name="l00102"></a>00102   <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a718ff28412ce9367f9f253ecd3a54722">Schema_Implicite_base::initTimeStep</a>(dt);
<a name="l00103"></a>00103   <a class="code" href="classSchema__Temps__base.html#addda9320fe85fd273e84fa0d09f12eef" title="Residu.">residu_</a> = 0;
<a name="l00104"></a>00104   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00105"></a>00105 }
<a name="l00106"></a>00106 <span class="comment">//</span>
<a name="l00107"></a>00107 <span class="comment">// //</span>
<a name="l00108"></a>00108 <span class="comment">// Caracteristiques du schema //</span>
<a name="l00109"></a>00109 <span class="comment">// //</span>
<a name="l00110"></a>00110 <span class="comment">//</span>
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 <span class="comment">//</span>
<a name="l00113"></a>00113 <span class="comment">//</span><span class="comment"></span>
<a name="l00114"></a>00114 <span class="comment">//! Renvoie le nombre de valeurs temporelles futures.&lt;br&gt;Ici : n+1, donc 1.</span>
<a name="l00115"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a9243fa2bf5d87f63327ce5dfb763c3f2">00115</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a9243fa2bf5d87f63327ce5dfb763c3f2" title="Renvoie le nombre de valeurs temporelles futures. Ici : n+1, donc 1.">Schema_Implicite_Multi_TimeStep_base::nb_valeurs_futures</a>()<span class="keyword"> const</span>
<a name="l00116"></a>00116 <span class="keyword"></span>{
<a name="l00117"></a>00117   <span class="keywordflow">return</span> 1 ;
<a name="l00118"></a>00118 }
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="comment">//</span>
<a name="l00121"></a>00121 <span class="comment">//</span><span class="comment"></span>
<a name="l00122"></a>00122 <span class="comment">//! Renvoie le le temps a la i-eme valeur future.&lt;br&gt;Ici : t(n+1)</span>
<a name="l00123"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a402f961d701d61f7616d20aa639be563">00123</a> <span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a402f961d701d61f7616d20aa639be563" title="Renvoie le le temps a la i-eme valeur future. Ici : t(n+1)">Schema_Implicite_Multi_TimeStep_base::temps_futur</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l00124"></a>00124 <span class="keyword"></span>{
<a name="l00125"></a>00125   assert(i==1);
<a name="l00126"></a>00126   <span class="keywordflow">return</span> <a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>()+<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l00127"></a>00127 }
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 <span class="comment">//</span>
<a name="l00130"></a>00130 <span class="comment">//</span>
<a name="l00131"></a>00131 <span class="comment">//</span><span class="comment"></span>
<a name="l00132"></a>00132 <span class="comment">//! Renvoie le le temps le temps que doivent rendre les champs a&lt;br&gt;l&#39;appel de valeurs()&lt;br&gt;Ici : t(n+1)</span>
<a name="l00133"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ad80d74e5cdf1af0209e4a9315817dce9">00133</a> <span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ad80d74e5cdf1af0209e4a9315817dce9" title="Renvoie le le temps le temps que doivent rendre les champs a l&#39;appel de valeurs() Ici : t(n+1)...">Schema_Implicite_Multi_TimeStep_base::temps_defaut</a>()<span class="keyword"> const</span>
<a name="l00134"></a>00134 <span class="keyword"></span>{
<a name="l00135"></a>00135   <span class="keywordflow">return</span> <a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>()+<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="comment">//</span>
<a name="l00139"></a>00139 <span class="comment">// //</span>
<a name="l00140"></a>00140 <span class="comment">// Fin des caracteristiques du schema  //</span>
<a name="l00141"></a>00141 <span class="comment">// //</span>
<a name="l00142"></a>00142 <span class="comment">//</span>
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ae6093ef087a74518c39e97ce0009a268">00144</a> <span class="keywordtype">void</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ae6093ef087a74518c39e97ce0009a268">Schema_Implicite_Multi_TimeStep_base::Initialiser_Champs</a>(<a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb)
<a name="l00145"></a>00145 {
<a name="l00146"></a>00146   <span class="keywordtype">int</span> i      = 0;
<a name="l00147"></a>00147   <span class="keywordtype">int</span> j      = 0;
<a name="l00148"></a>00148 
<a name="l00149"></a>00149   <span class="keywordflow">for</span>(i=0; i&lt;pb.<a class="code" href="classProbleme__base.html#abefceb0ac0d0b35d42a4daaa82a95f59">nombre_d_equations</a>(); i++)
<a name="l00150"></a>00150     {
<a name="l00151"></a>00151       <span class="keywordflow">if</span> ( (pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i).<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()!=<span class="stringliteral">&quot;Euler&quot;</span>) || <a class="code" href="classSchema__Temps__base.html#ae6dd72bce33a443217b83f56a4da23a2">temps_courant_</a>==0.)
<a name="l00152"></a>00152         {
<a name="l00153"></a>00153           <span class="keywordflow">for</span> (j=<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aa17f04a2659b434bdfe159b5bb44982d">nb_valeurs_passees</a>(); j&gt;-1; j--)
<a name="l00154"></a>00154             {
<a name="l00155"></a>00155               pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i).<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>(j+1) = pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i).<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>(j);
<a name="l00156"></a>00156             }
<a name="l00157"></a>00157         }
<a name="l00158"></a>00158     }
<a name="l00159"></a>00159 }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 
<a name="l00163"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a0cd930ac963850199a3a7b2b7e9894c1">00163</a> <span class="keywordtype">int</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a0cd930ac963850199a3a7b2b7e9894c1" title="Mise a jour du temps courant (t+=dt) et du nombre de pas de temps effectue (nb_pas_dt_++).">Schema_Implicite_Multi_TimeStep_base::mettre_a_jour</a>()
<a name="l00164"></a>00164 {
<a name="l00165"></a>00165   <a class="code" href="Schema__Implicite__Multi__TimeStep__base_8cpp.html#a1d05275a5b6167d30101855a79fa56c7">Implicite_Multi_TimeStep_calcul_fac_sec</a>(<a class="code" href="classSchema__Temps__base.html#addda9320fe85fd273e84fa0d09f12eef" title="Residu.">residu_</a>,<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a67409abca1c65e048634c1977707ee36">residu_old_</a>,<a class="code" href="classSchema__Temps__base.html#a8cdc40f1adfd8ff29d7f9c75330920ee">facsec_</a>,<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#accd31b2329848889733a35a0f68b9631">facsec_max_</a>,<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a5af050207c47e419b7e3bd0106343962">nb_ite_sans_accel_</a>);
<a name="l00166"></a>00166   <span class="keywordflow">return</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a0cd930ac963850199a3a7b2b7e9894c1" title="Mise a jour du temps courant (t+=dt) et du nombre de pas de temps effectue (nb_pas_dt_++).">Schema_Temps_base::mettre_a_jour</a>();
<a name="l00167"></a>00167 }
<a name="l00168"></a>00168 
<a name="l00169"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aecf9342116bb9855a198dadb51a36b75">00169</a> <span class="keywordtype">int</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aecf9342116bb9855a198dadb51a36b75">Schema_Implicite_Multi_TimeStep_base::Iterer_Pb</a>(<a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb,<span class="keywordtype">int</span> ite)
<a name="l00170"></a>00170 {
<a name="l00171"></a>00171   <span class="keywordtype">int</span>  i               = 0, ok = 1;
<a name="l00172"></a>00172   <span class="keywordtype">int</span>  ii              = 0;
<a name="l00173"></a>00173   <span class="keywordtype">bool</span> convergence_pb  = <span class="keyword">true</span>;
<a name="l00174"></a>00174   <span class="keywordtype">bool</span> convergence_eqn = <span class="keyword">false</span>;
<a name="l00175"></a>00175   <span class="keywordtype">int</span>  drap = pb.<a class="code" href="classProbleme__base.html#a4ef1cb4c4eed0aab75358ab7a91e29db">is_dilatable</a>();
<a name="l00176"></a>00176 
<a name="l00177"></a>00177   <span class="keywordflow">for</span>(i=0; i&lt;pb.<a class="code" href="classProbleme__base.html#abefceb0ac0d0b35d42a4daaa82a95f59">nombre_d_equations</a>(); i++)
<a name="l00178"></a>00178     {
<a name="l00179"></a>00179 <span class="comment">// reverse equation order if quasi-compressible medium</span>
<a name="l00180"></a>00180       <span class="keywordflow">if</span> ((drap)&amp;&amp;(i&lt;2))
<a name="l00181"></a>00181         ii = 1-i;
<a name="l00182"></a>00182       <span class="keywordflow">else</span>
<a name="l00183"></a>00183         ii = i;
<a name="l00184"></a>00184 
<a name="l00185"></a>00185       <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn               = pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(ii);
<a name="l00186"></a>00186       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;     present           = eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00187"></a>00187       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;     futur             = eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a518c3eb1e7a249ae0fc4d1a4e0d072d0" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t+i.">futur</a>();
<a name="l00188"></a>00188       <span class="keywordtype">double</span>         temps             = <a class="code" href="classSchema__Temps__base.html#ae6dd72bce33a443217b83f56a4da23a2">temps_courant_</a>+<a class="code" href="classSchema__Temps__base.html#a41d96b9bfd9ead46031343c31f9bfe5d" title="Pas de temps de calcul.">dt_</a>;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>      stored_parameters;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192       <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#afeb224f476531ecb36a80fddcb5cbc6c">authorized_equation</a>(eqn);
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="comment">// imposer_cond_lim   sert pour la pression et pour les echanges entre pbs</span>
<a name="l00195"></a>00195       eqn.<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>()-&gt;<a class="code" href="classZone__Cl__dis.html#a9a1b2c60317659659ff316f39fd27ed8" title="Appel a l&#39;objet sous-jacent. Impose les conditions aux limites a un temps donne du Champ_Inc...">imposer_cond_lim</a>(eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>(),<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>()+<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>());
<a name="l00196"></a>00196       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<span class="stringliteral">&quot;Solving equation &quot;</span>&lt;&lt;eqn.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00197"></a>00197       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inut=futur;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199       <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ab68edb1a7af5daedc36cd55a92f0c3eb">store_equation_parameters</a>(eqn,stored_parameters);
<a name="l00200"></a>00200       convergence_eqn = <a class="code" href="classSchema__Implicite__base.html#a2ec52d78a0623b094e00e6c6c6c4cfe2">le_solveur</a>.<a class="code" href="classDeriv__Solveur__Implicite__Base.html#a8081e667a3bf58ade28409ee65e0653a">valeur</a>().<a class="code" href="classSolveur__Implicite__Base.html#a31c1c319fd1ed2ce1e2e74b9d95ec45d">iterer_eqn</a>(eqn,inut, present, dt_,ite, ok);
<a name="l00201"></a>00201       <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ac17eb5af4e87b3880415a0ed145636ca">modify_equation_parameters</a>(eqn,stored_parameters);
<a name="l00202"></a>00202 
<a name="l00203"></a>00203       convergence_pb  = convergence_pb&amp;&amp;convergence_eqn;
<a name="l00204"></a>00204       futur           = present;
<a name="l00205"></a>00205       eqn.<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>()-&gt;<a class="code" href="classZone__Cl__dis.html#a9a1b2c60317659659ff316f39fd27ed8" title="Appel a l&#39;objet sous-jacent. Impose les conditions aux limites a un temps donne du Champ_Inc...">imposer_cond_lim</a>(eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>(),<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>()+<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>());
<a name="l00206"></a>00206       present         = futur;
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <span class="comment">// La ligne suivante realise:</span>
<a name="l00209"></a>00209 <span class="comment">// MAJ NS (donc MAJ inc)</span>
<a name="l00210"></a>00210 <span class="comment">// MAJ modele de turbulence donc k-eps</span>
<a name="l00211"></a>00211 <span class="comment">// eqn.inconnue().mettre_a_jour(temps);</span>
<a name="l00212"></a>00212 <span class="comment">// eqn.inconnue().reculer();</span>
<a name="l00213"></a>00213       <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a4e56b730c77ec35f3e354f98dff2b8ac">changer_temps</a>(eqn,temps);
<a name="l00214"></a>00214     }
<a name="l00215"></a>00215   <span class="keywordflow">return</span> (convergence_pb==<span class="keyword">true</span>);
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a8c61d610ebc2a5feb78dcb56a8e65398">00218</a> <span class="keywordtype">void</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a8c61d610ebc2a5feb78dcb56a8e65398">Schema_Implicite_Multi_TimeStep_base::test_stationnaire</a>(<a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb)
<a name="l00219"></a>00219 {
<a name="l00220"></a>00220   <span class="keywordtype">int</span> i = 0;
<a name="l00221"></a>00221   <span class="keywordtype">int</span> j = 0;
<a name="l00222"></a>00222 
<a name="l00223"></a>00223   <span class="keywordflow">for</span>(i=0; i&lt;pb.<a class="code" href="classProbleme__base.html#abefceb0ac0d0b35d42a4daaa82a95f59">nombre_d_equations</a>(); i++)
<a name="l00224"></a>00224     {
<a name="l00225"></a>00225 <span class="comment">// treatement of time convergency</span>
<a name="l00226"></a>00226       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; passe = pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i).<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>();
<a name="l00227"></a>00227       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; present = pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i).<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00228"></a>00228       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; futur = pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i).<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a518c3eb1e7a249ae0fc4d1a4e0d072d0" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t+i.">futur</a>();
<a name="l00229"></a>00229 
<a name="l00230"></a>00230       futur    = present;
<a name="l00231"></a>00231       pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i).<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>()-&gt;<a class="code" href="classZone__Cl__dis.html#a9a1b2c60317659659ff316f39fd27ed8" title="Appel a l&#39;objet sous-jacent. Impose les conditions aux limites a un temps donne du Champ_Inc...">imposer_cond_lim</a>(pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i).<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>(),<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>()+<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>());
<a name="l00232"></a>00232       present -= passe;
<a name="l00233"></a>00233       present /= <a class="code" href="classSchema__Temps__base.html#a41d96b9bfd9ead46031343c31f9bfe5d" title="Pas de temps de calcul.">dt_</a>;
<a name="l00234"></a>00234       <a class="code" href="classSchema__Temps__base.html#ae688058ec9592383f84aeb6de1d56158" title="//Actualisation de stationnaire_atteint_ et residu_ (critere residu_&lt;seuil_statio_)">update_critere_statio</a>(present, pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i));
<a name="l00235"></a>00235       <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a6ee7ebc8081ee39ea73e1aae6177c9a8">update_time_derivative</a>(pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i),present);
<a name="l00236"></a>00236       <span class="keywordflow">for</span> (j=0; j&lt;<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aa17f04a2659b434bdfe159b5bb44982d">nb_valeurs_passees</a>(); j++)
<a name="l00237"></a>00237         {
<a name="l00238"></a>00238           pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i).<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>(j) = pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i).<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>(j+1);
<a name="l00239"></a>00239         }
<a name="l00240"></a>00240     }
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
<a name="l00243"></a><a class="code" href="Schema__Implicite__Multi__TimeStep__base_8cpp.html#a1a1f45a12f1b6d848e546ceab24872c0">00243</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Schema__Implicite__Multi__TimeStep__base_8cpp.html#a1a1f45a12f1b6d848e546ceab24872c0">Implicite_Multi_TimeStep_recommencer_pb</a>(<span class="keywordtype">int</span> nb_valeurs_passees, <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb)
<a name="l00244"></a>00244 {
<a name="l00245"></a>00245   <span class="keywordtype">int</span> i = 0;
<a name="l00246"></a>00246   <span class="keywordtype">int</span> j = 0;
<a name="l00247"></a>00247   <span class="keywordflow">for</span>(i=0; i&lt;pb.<a class="code" href="classProbleme__base.html#abefceb0ac0d0b35d42a4daaa82a95f59">nombre_d_equations</a>(); i++)
<a name="l00248"></a>00248     {
<a name="l00249"></a>00249       <span class="keywordflow">for</span> (j=0; j&lt;nb_valeurs_passees; j++)
<a name="l00250"></a>00250         {
<a name="l00251"></a>00251           pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i).<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>(j) = pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i).<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>(j+1);
<a name="l00252"></a>00252         }
<a name="l00253"></a>00253     }
<a name="l00254"></a>00254 }
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 
<a name="l00257"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a402f7d1705a1735e1348224fe2aa7045">00257</a> <span class="keywordtype">bool</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a402f7d1705a1735e1348224fe2aa7045" title="Calculate the U(n+1) unknown for each equation (if solved) of the problem with the selected time sche...">Schema_Implicite_Multi_TimeStep_base::iterateTimeStep</a>(<span class="keywordtype">bool</span>&amp; converged)
<a name="l00258"></a>00258 {
<a name="l00259"></a>00259   <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; prob=<a class="code" href="classSchema__Temps__base.html#a6e2edfe46a7f27b6fc8f114d92c35dc2">pb_base</a>();
<a name="l00260"></a>00260 
<a name="l00261"></a>00261   <span class="keywordtype">int</span> convergence_pb = 0;
<a name="l00262"></a>00262   <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ae6093ef087a74518c39e97ce0009a268">Initialiser_Champs</a>(prob);
<a name="l00263"></a>00263 
<a name="l00264"></a>00264   <span class="keywordtype">int</span> ok=0;
<a name="l00265"></a>00265   <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>;
<a name="l00266"></a>00266   <span class="keywordflow">while</span> (!ok)
<a name="l00267"></a>00267     {
<a name="l00268"></a>00268       compteur=0;
<a name="l00269"></a>00269       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00270"></a>00270       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot; : solving of problem &quot;</span>&lt;&lt;prob.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;finl;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272       <span class="keywordflow">while</span> ((!convergence_pb)&amp;&amp;(compteur&lt;<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a918596856950ac4dd895c36e47c550be">nb_ite_max</a>))
<a name="l00273"></a>00273         {
<a name="l00274"></a>00274           compteur++;
<a name="l00275"></a>00275           prob.<a class="code" href="classProbleme__base.html#a9671bf3444fe91303e454ff61d64c79c" title="ATTENTION : Rentre ici tout ce qui ne correspond pas a l&#39;API normale de Problem. Actuellement on y me...">updateGivenFields</a>();
<a name="l00276"></a>00276           convergence_pb = <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aecf9342116bb9855a198dadb51a36b75">Iterer_Pb</a>(prob,compteur);
<a name="l00277"></a>00277           <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;finl;;
<a name="l00278"></a>00278         }
<a name="l00279"></a>00279 
<a name="l00280"></a>00280       <span class="keywordflow">if</span> ((!convergence_pb)&amp;&amp;(compteur==<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a918596856950ac4dd895c36e47c550be">nb_ite_max</a>))
<a name="l00281"></a>00281         {
<a name="l00282"></a>00282           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot; has not converged at t=&quot;</span>&lt;&lt; <a class="code" href="classSchema__Temps__base.html#ae6dd72bce33a443217b83f56a4da23a2">temps_courant_</a> &lt;&lt; <span class="stringliteral">&quot; with dt =&quot;</span> &lt;&lt; <a class="code" href="classSchema__Temps__base.html#a41d96b9bfd9ead46031343c31f9bfe5d" title="Pas de temps de calcul.">dt_</a>&lt;&lt; finl;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284           <span class="keywordtype">double</span> rap =  sqrt(2.);
<a name="l00285"></a>00285           <a class="code" href="classSchema__Temps__base.html#a8cdc40f1adfd8ff29d7f9c75330920ee">facsec_</a>    /= rap;
<a name="l00286"></a>00286           <a class="code" href="classSchema__Temps__base.html#a41d96b9bfd9ead46031343c31f9bfe5d" title="Pas de temps de calcul.">dt_</a>        /= rap;
<a name="l00287"></a>00287           ok         =0;
<a name="l00288"></a>00288 
<a name="l00289"></a>00289           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;We restart with dt_ =&quot;</span> &lt;&lt; <a class="code" href="classSchema__Temps__base.html#a41d96b9bfd9ead46031343c31f9bfe5d" title="Pas de temps de calcul.">dt_</a> &lt;&lt;finl;
<a name="l00290"></a>00290 
<a name="l00291"></a>00291           prob.<a class="code" href="classProbleme__base.html#aea05204e5a5bc8ee97dd8d0a50627ea6" title="Aborts the resolution of the current time step.">abortTimeStep</a>();
<a name="l00292"></a>00292           prob.<a class="code" href="classProbleme__base.html#a165c557986360282eba78ebac000b89c" title="This method allocates and initializes the unknown and given fields for the future time step...">initTimeStep</a>(<a class="code" href="classSchema__Temps__base.html#a41d96b9bfd9ead46031343c31f9bfe5d" title="Pas de temps de calcul.">dt_</a>);
<a name="l00293"></a>00293 
<a name="l00294"></a>00294 <span class="comment">// PL pour corriger plantage danbs U_in_var_impl</span>
<a name="l00295"></a>00295           <span class="keyword">const</span> <span class="keywordtype">int</span> nb_eqn=prob.<a class="code" href="classProbleme__base.html#abefceb0ac0d0b35d42a4daaa82a95f59">nombre_d_equations</a>();
<a name="l00296"></a>00296           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii=0; ii&lt;nb_eqn; ii++)
<a name="l00297"></a>00297             {
<a name="l00298"></a>00298               <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn=prob.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(ii);
<a name="l00299"></a>00299               <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a0eab795f1a18df2327ed2510c99af930">mettre_a_jour_equation</a>(eqn,<a class="code" href="classSchema__Temps__base.html#ae6dd72bce33a443217b83f56a4da23a2">temps_courant_</a>+<a class="code" href="classSchema__Temps__base.html#a41d96b9bfd9ead46031343c31f9bfe5d" title="Pas de temps de calcul.">dt_</a>);
<a name="l00300"></a>00300             }
<a name="l00301"></a>00301 <span class="comment">// Fin</span>
<a name="l00302"></a>00302 
<a name="l00303"></a>00303           <a class="code" href="Schema__Implicite__Multi__TimeStep__base_8cpp.html#a1a1f45a12f1b6d848e546ceab24872c0">Implicite_Multi_TimeStep_recommencer_pb</a>(<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aa17f04a2659b434bdfe159b5bb44982d">nb_valeurs_passees</a>(),prob);
<a name="l00304"></a>00304         }
<a name="l00305"></a>00305       <span class="keywordflow">else</span>
<a name="l00306"></a>00306         {
<a name="l00307"></a>00307           <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<span class="stringliteral">&quot;The problem &quot;</span>&lt;&lt;prob.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot; has converged after &quot;</span>&lt;&lt;compteur&lt;&lt;<span class="stringliteral">&quot; iterations.&quot;</span>&lt;&lt;finl;
<a name="l00308"></a>00308           ok=1;
<a name="l00309"></a>00309         }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311     }
<a name="l00312"></a>00312 <span class="comment">// modification : prise en compte de la possibilite de modification du dt dans Itere_Pb</span>
<a name="l00313"></a>00313 <span class="comment">// cas du solveur pour compressible : division du pas de temps par 2</span>
<a name="l00314"></a>00314 <span class="comment">// si la convergence n&#39;est pas atteinte en un nombre de pas de temps donne</span>
<a name="l00315"></a>00315 <span class="comment">// double temps = dt_ + temps_courant_;</span>
<a name="l00316"></a>00316   <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a8c61d610ebc2a5feb78dcb56a8e65398">test_stationnaire</a>(prob);
<a name="l00317"></a>00317 
<a name="l00318"></a>00318   converged=<span class="keyword">true</span>;
<a name="l00319"></a>00319 
<a name="l00320"></a>00320   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00321"></a>00321 }
<a name="l00322"></a>00322 
<a name="l00323"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a12bc63c111febea01794dd5161091678">00323</a> <span class="keywordtype">int</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a12bc63c111febea01794dd5161091678">Schema_Implicite_Multi_TimeStep_base::faire_un_pas_de_temps_pb_couple</a>(<a class="code" href="classProbleme__Couple.html" title="classe Probleme_Couple C&#39;est la classe historique de couplage de TRUST. Il s&#39;agit d&#39;un Couplage_U par...">Probleme_Couple</a>&amp; pbc, <span class="keywordtype">int</span>&amp; ok)
<a name="l00324"></a>00324 {
<a name="l00325"></a>00325 <span class="comment">// Modif B.M. : Si on fait la sauvegarde entre derivee en temps inco et mettre a jour,</span>
<a name="l00326"></a>00326 <span class="comment">// un calcul avec reprise n&#39;est pas equivalent au calcul ininterrompu</span>
<a name="l00327"></a>00327 <span class="comment">// (front-tracking notamment). Donc je mets la sauvegarde au debut du pas de temps.</span>
<a name="l00328"></a>00328 <span class="comment">// if (lsauv())</span>
<a name="l00329"></a>00329 <span class="comment">// for (int i=0;i&lt;pbc.nb_problemes();i++)</span>
<a name="l00330"></a>00330 <span class="comment">// ref_cast(Probleme_base,pbc.probleme(i)).sauver();</span>
<a name="l00331"></a>00331 
<a name="l00332"></a>00332   <span class="keywordtype">int</span> convergence_pbc = 0;
<a name="l00333"></a>00333   <span class="keywordtype">int</span> convergence_pb;
<a name="l00334"></a>00334   <span class="keywordtype">int</span> i;
<a name="l00335"></a>00335 
<a name="l00336"></a>00336   <span class="keywordflow">for</span>(i=0; i&lt;pbc.<a class="code" href="classCouplage__U.html#abb5aa9654efade53ade07f8181f8cf8b" title="Number of problems.">nb_problemes</a>(); i++)
<a name="l00337"></a>00337     <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ae6093ef087a74518c39e97ce0009a268">Initialiser_Champs</a>(<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>,pbc.<a class="code" href="classCouplage__U.html#af963c77dd8af104e2005f0b2272e5325" title="Access by index (const)">probleme</a>(i)));
<a name="l00338"></a>00338 
<a name="l00339"></a>00339 
<a name="l00340"></a>00340   <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342   <span class="keywordflow">while</span> (!ok)
<a name="l00343"></a>00343     {
<a name="l00344"></a>00344       compteur=0;
<a name="l00345"></a>00345 
<a name="l00346"></a>00346       <span class="keywordflow">while</span> ((!convergence_pbc )&amp;&amp;(compteur&lt;<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a918596856950ac4dd895c36e47c550be">nb_ite_max</a>))
<a name="l00347"></a>00347         {
<a name="l00348"></a>00348           compteur++;
<a name="l00349"></a>00349           convergence_pbc=1;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 
<a name="l00352"></a>00352           <span class="keywordflow">for</span>(i=0; i&lt;pbc.<a class="code" href="classCouplage__U.html#abb5aa9654efade53ade07f8181f8cf8b" title="Number of problems.">nb_problemes</a>()*1; i++)
<a name="l00353"></a>00353             {
<a name="l00354"></a>00354               <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>,pbc.<a class="code" href="classCouplage__U.html#af963c77dd8af104e2005f0b2272e5325" title="Access by index (const)">probleme</a>(i));
<a name="l00355"></a>00355               <span class="keyword">const</span> <span class="keywordtype">int</span> nb_eqn=pb.<a class="code" href="classProbleme__base.html#abefceb0ac0d0b35d42a4daaa82a95f59">nombre_d_equations</a>();
<a name="l00356"></a>00356               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ii=0; ii&lt;nb_eqn; ii++)
<a name="l00357"></a>00357                 {
<a name="l00358"></a>00358                   pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(ii).<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>()-&gt;calculer_coeffs_echange(<a class="code" href="classSchema__Temps__base.html#ae6dd72bce33a443217b83f56a4da23a2">temps_courant_</a>+<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>());
<a name="l00359"></a>00359                 }
<a name="l00360"></a>00360 
<a name="l00361"></a>00361             }
<a name="l00362"></a>00362 
<a name="l00363"></a>00363           <span class="keywordflow">for</span>(i=0; i&lt;pbc.<a class="code" href="classCouplage__U.html#abb5aa9654efade53ade07f8181f8cf8b" title="Number of problems.">nb_problemes</a>(); i++)
<a name="l00364"></a>00364             {
<a name="l00365"></a>00365               pbc.<a class="code" href="classCouplage__U.html#af963c77dd8af104e2005f0b2272e5325" title="Access by index (const)">probleme</a>(i).<a class="code" href="classProbleme__U.html#adfd9be01607a32ffde929d1d20700d81" title="ATTENTION : Rentre ici tout ce qui ne correspond pas a l&#39;API normale de Problem. Actuellement on y me...">updateGivenFields</a>();
<a name="l00366"></a>00366               convergence_pb = <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aecf9342116bb9855a198dadb51a36b75">Iterer_Pb</a>(<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>,pbc.<a class="code" href="classCouplage__U.html#af963c77dd8af104e2005f0b2272e5325" title="Access by index (const)">probleme</a>(i)),compteur);
<a name="l00367"></a>00367               convergence_pbc = convergence_pbc * convergence_pb ;
<a name="l00368"></a>00368             }
<a name="l00369"></a>00369 
<a name="l00370"></a>00370         }
<a name="l00371"></a>00371       <span class="keywordflow">if</span> ((!convergence_pbc)&amp;&amp;(compteur==<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a918596856950ac4dd895c36e47c550be">nb_ite_max</a>))
<a name="l00372"></a>00372         {
<a name="l00373"></a>00373           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;The process is restarted. &quot;</span> &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00374"></a>00374           <a class="code" href="classSchema__Temps__base.html#a8cdc40f1adfd8ff29d7f9c75330920ee">facsec_</a>/=2;
<a name="l00375"></a>00375           <a class="code" href="classSchema__Temps__base.html#a41d96b9bfd9ead46031343c31f9bfe5d" title="Pas de temps de calcul.">dt_</a>/=2;
<a name="l00376"></a>00376           ok=0;
<a name="l00377"></a>00377           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i2=0; i2&lt;pbc.<a class="code" href="classCouplage__U.html#abb5aa9654efade53ade07f8181f8cf8b" title="Number of problems.">nb_problemes</a>(); i2++)
<a name="l00378"></a>00378             {
<a name="l00379"></a>00379               <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>,pbc.<a class="code" href="classCouplage__U.html#af963c77dd8af104e2005f0b2272e5325" title="Access by index (const)">probleme</a>(i2)).<a class="code" href="classSchema__Temps__base.html#a5fa2d6fdaa5e161a4c28e579372dbd2f">abortTimeStep</a>();
<a name="l00380"></a>00380               <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>,pbc.<a class="code" href="classCouplage__U.html#af963c77dd8af104e2005f0b2272e5325" title="Access by index (const)">probleme</a>(i2)).<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a718ff28412ce9367f9f253ecd3a54722">initTimeStep</a>(<a class="code" href="classSchema__Temps__base.html#a41d96b9bfd9ead46031343c31f9bfe5d" title="Pas de temps de calcul.">dt_</a>);
<a name="l00381"></a>00381               <a class="code" href="Schema__Implicite__Multi__TimeStep__base_8cpp.html#a1a1f45a12f1b6d848e546ceab24872c0">Implicite_Multi_TimeStep_recommencer_pb</a>(<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aa17f04a2659b434bdfe159b5bb44982d">nb_valeurs_passees</a>(),<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>,pbc.<a class="code" href="classCouplage__U.html#af963c77dd8af104e2005f0b2272e5325" title="Access by index (const)">probleme</a>(i2)));
<a name="l00382"></a>00382             }
<a name="l00383"></a>00383         }
<a name="l00384"></a>00384       <span class="keywordflow">else</span> ok=1;
<a name="l00385"></a>00385     }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387   <span class="keywordtype">double</span> residu_1=0;
<a name="l00388"></a>00388   <span class="keywordflow">for</span>(i=0; i&lt;pbc.<a class="code" href="classCouplage__U.html#abb5aa9654efade53ade07f8181f8cf8b" title="Number of problems.">nb_problemes</a>(); i++)
<a name="l00389"></a>00389     {
<a name="l00390"></a>00390       residu_1=<a class="code" href="classSchema__Temps__base.html#addda9320fe85fd273e84fa0d09f12eef" title="Residu.">residu_</a>;
<a name="l00391"></a>00391       <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a8c61d610ebc2a5feb78dcb56a8e65398">test_stationnaire</a>(<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>,pbc.<a class="code" href="classCouplage__U.html#af963c77dd8af104e2005f0b2272e5325" title="Access by index (const)">probleme</a>(i)));
<a name="l00392"></a>00392       <a class="code" href="classSchema__Temps__base.html#addda9320fe85fd273e84fa0d09f12eef" title="Residu.">residu_</a>=<a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(<a class="code" href="classSchema__Temps__base.html#addda9320fe85fd273e84fa0d09f12eef" title="Residu.">residu_</a>,residu_1);
<a name="l00393"></a>00393     }
<a name="l00394"></a>00394 
<a name="l00395"></a>00395   <span class="keywordflow">return</span> 1;
<a name="l00396"></a>00396 }
<a name="l00397"></a>00397 
<a name="l00398"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ac839d795368428672754244c9b25b8ee">00398</a> <span class="keywordtype">void</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ac839d795368428672754244c9b25b8ee">Schema_Implicite_Multi_TimeStep_base::ajouter_inertie</a>(<a class="code" href="classMatrice__Base.html">Matrice_Base</a>&amp; mat_morse,<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; secmem,<span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn)<span class="keyword"> const</span>
<a name="l00399"></a>00399 <span class="keyword"></span>{
<a name="l00400"></a>00400   <span class="keywordflow">if</span> (<a class="code" href="classSchema__Temps__base.html#a247769eddf9c0bfcaabc50b8dd90d401" title="Renvoie le nombre de pas de temps effectues.">nb_pas_dt</a>()&gt;<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a7af3825ba82171bd2e0da660cdf1d4c6">nb_pas_dt_seuil</a>())
<a name="l00401"></a>00401     {
<a name="l00402"></a>00402       <span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp;  eqn_bis   = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classEquation__base.html">Equation_base</a>,eqn);
<a name="l00403"></a>00403       <span class="keywordtype">int</span>             i         = 0;
<a name="l00404"></a>00404       <span class="keywordtype">int</span>             offset    = 0;
<a name="l00405"></a>00405       <span class="keywordtype">double</span>          time_step = <a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l00406"></a>00406 
<a name="l00407"></a>00407 <span class="comment">// Building of a time-in-ascending-order table</span>
<a name="l00408"></a>00408       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> times(<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#adc855ca60f512200557839aa36442ce5">nb_valeurs_temporelles_effectives</a>());
<a name="l00409"></a>00409       assert(<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aa17f04a2659b434bdfe159b5bb44982d">nb_valeurs_passees</a>()+2 == <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#adc855ca60f512200557839aa36442ce5">nb_valeurs_temporelles_effectives</a>());
<a name="l00410"></a>00410 
<a name="l00411"></a>00411       <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aa17f04a2659b434bdfe159b5bb44982d">nb_valeurs_passees</a>(); ++i)
<a name="l00412"></a>00412         {
<a name="l00413"></a>00413           offset   =  <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aa17f04a2659b434bdfe159b5bb44982d">nb_valeurs_passees</a>()-i;
<a name="l00414"></a>00414           times[i] =  eqn_bis.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>().<a class="code" href="classChamp__Inc__base.html#a98ff36bce5f3ea9fdf39f6278c623dec" title="Retourne le temps du ieme champ passe.">recuperer_temps_passe</a>(offset); <span class="comment">//past time</span>
<a name="l00415"></a>00415         }
<a name="l00416"></a>00416       times[<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aa17f04a2659b434bdfe159b5bb44982d">nb_valeurs_passees</a>()]   = eqn_bis.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>().<a class="code" href="classChamp__Inc__base.html#a01eb63457ca509d86f3459b62af2c6e3" title="Retourne le temps du ieme champ futur.">recuperer_temps_futur</a>(0); <span class="comment">//present time</span>
<a name="l00417"></a>00417       times[<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aa17f04a2659b434bdfe159b5bb44982d">nb_valeurs_passees</a>()+1] = eqn_bis.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>().<a class="code" href="classChamp__Inc__base.html#a01eb63457ca509d86f3459b62af2c6e3" title="Retourne le temps du ieme champ futur.">recuperer_temps_futur</a>(1); <span class="comment">//future time</span>
<a name="l00418"></a>00418 
<a name="l00419"></a>00419       <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a2143d8a13b402d2d0771f4c55479e37b">compute_coefficients</a>(time_step,times);
<a name="l00420"></a>00420       <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a82b34b21a8babc1a580de44cb64dd556">add_multi_timestep_data</a>(eqn, mat_morse, secmem);
<a name="l00421"></a>00421     }
<a name="l00422"></a>00422   <span class="keywordflow">else</span>
<a name="l00423"></a>00423     {
<a name="l00424"></a>00424 <span class="comment">// Backward Euler time scheme</span>
<a name="l00425"></a>00425       <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ac839d795368428672754244c9b25b8ee">Schema_Temps_base::ajouter_inertie</a>(mat_morse,secmem,eqn);
<a name="l00426"></a>00426     }
<a name="l00427"></a>00427 }
<a name="l00428"></a>00428 
<a name="l00429"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a6991ee278132c00aa23d94e51ab2388e">00429</a> <span class="keywordtype">int</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a6991ee278132c00aa23d94e51ab2388e">Schema_Implicite_Multi_TimeStep_base::faire_un_pas_de_temps_eqn_base</a>(<a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn)
<a name="l00430"></a>00430 {
<a name="l00431"></a>00431 <span class="comment">// Necessary because of equations like Transport_K_Eps which must be time incremented but</span>
<a name="l00432"></a>00432 <span class="comment">// are not equations of the solved problem and therefore are not seen by Schema_Implicite_Multi_TimeStep_base::iterateTimeStep</span>
<a name="l00433"></a>00433 
<a name="l00434"></a>00434   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; passe           = eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>();
<a name="l00435"></a>00435   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; present         = eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00436"></a>00436   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; futur           = eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a518c3eb1e7a249ae0fc4d1a4e0d072d0" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t+i.">futur</a>();
<a name="l00437"></a>00437   <span class="keywordtype">int</span>        <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>        = 0, ok = 1;
<a name="l00438"></a>00438   <span class="keywordtype">int</span>        i               = 0;
<a name="l00439"></a>00439   <span class="keywordtype">bool</span>       convergence_eqn = <span class="keyword">false</span>;
<a name="l00440"></a>00440 
<a name="l00441"></a>00441   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>      stored_parameters;
<a name="l00442"></a>00442 
<a name="l00443"></a>00443   <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#afeb224f476531ecb36a80fddcb5cbc6c">authorized_equation</a>(eqn);
<a name="l00444"></a>00444 
<a name="l00445"></a>00445 <span class="comment">// Initialize time data</span>
<a name="l00446"></a>00446   <span class="keywordflow">if</span> ( (eqn.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() != <span class="stringliteral">&quot;Euler&quot;</span>) || <a class="code" href="classSchema__Temps__base.html#ae6dd72bce33a443217b83f56a4da23a2">temps_courant_</a> ==0.)
<a name="l00447"></a>00447     {
<a name="l00448"></a>00448       <span class="keywordflow">for</span> (i=<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aa17f04a2659b434bdfe159b5bb44982d">nb_valeurs_passees</a>(); i&gt;-1; i--)
<a name="l00449"></a>00449         {
<a name="l00450"></a>00450           eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>(i+1) = eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>(i);
<a name="l00451"></a>00451         }
<a name="l00452"></a>00452     }
<a name="l00453"></a>00453 
<a name="l00454"></a>00454 <span class="comment">// sert pour la pression et les couplages</span>
<a name="l00455"></a>00455   eqn.<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classZone__Cl__dis.html#a9a1b2c60317659659ff316f39fd27ed8" title="Appel a l&#39;objet sous-jacent. Impose les conditions aux limites a un temps donne du Champ_Inc...">imposer_cond_lim</a>(eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>(),<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>()+<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>());
<a name="l00456"></a>00456 
<a name="l00457"></a>00457   <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00458"></a>00458   <span class="keywordflow">while</span> ((!convergence_eqn)&amp;&amp;(compteur&lt;<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a918596856950ac4dd895c36e47c550be">nb_ite_max</a>))
<a name="l00459"></a>00459     {
<a name="l00460"></a>00460       compteur++;
<a name="l00461"></a>00461 
<a name="l00462"></a>00462       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<span class="stringliteral">&quot;==================================================================================&quot;</span> &lt;&lt; finl;
<a name="l00463"></a>00463       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot;: Implicit iteration &quot;</span> &lt;&lt; compteur &lt;&lt; <span class="stringliteral">&quot; on the &quot;</span>&lt;&lt;eqn.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; equation of the problem &quot;</span>&lt;&lt; eqn.<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a58bc0b101f3f3f1d8522a9f41f1fad7b" title="surcharge Objet_U::le_nom() Renvoie le nom du probleme">le_nom</a>()&lt;&lt; <span class="stringliteral">&quot; :&quot;</span> &lt;&lt;finl;
<a name="l00464"></a>00464       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<span class="stringliteral">&quot;==================================================================================&quot;</span> &lt;&lt; finl;
<a name="l00465"></a>00465 
<a name="l00466"></a>00466       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inut=futur;
<a name="l00467"></a>00467       <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ab68edb1a7af5daedc36cd55a92f0c3eb">store_equation_parameters</a>(eqn,stored_parameters);
<a name="l00468"></a>00468       convergence_eqn=<a class="code" href="classSchema__Implicite__base.html#a2ec52d78a0623b094e00e6c6c6c4cfe2">le_solveur</a>.<a class="code" href="classDeriv__Solveur__Implicite__Base.html#a8081e667a3bf58ade28409ee65e0653a">valeur</a>().<a class="code" href="classSolveur__Implicite__Base.html#a31c1c319fd1ed2ce1e2e74b9d95ec45d">iterer_eqn</a>(eqn, inut, present, <a class="code" href="classSchema__Temps__base.html#a41d96b9bfd9ead46031343c31f9bfe5d" title="Pas de temps de calcul.">dt_</a>, compteur, ok);
<a name="l00469"></a>00469       <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#ac17eb5af4e87b3880415a0ed145636ca">modify_equation_parameters</a>(eqn,stored_parameters);
<a name="l00470"></a>00470       futur=present;
<a name="l00471"></a>00471       eqn.<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classZone__Cl__dis.html#a9a1b2c60317659659ff316f39fd27ed8" title="Appel a l&#39;objet sous-jacent. Impose les conditions aux limites a un temps donne du Champ_Inc...">imposer_cond_lim</a>(eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>(),<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>()+<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>());
<a name="l00472"></a>00472       present=futur;
<a name="l00473"></a>00473     }
<a name="l00474"></a>00474 
<a name="l00475"></a>00475 <span class="comment">// Calculation of time derivative at time n+1</span>
<a name="l00476"></a>00476   present -= passe; <span class="comment">//&quot;present&quot; contains unknown at time n+1 and &quot;passe&quot; contains unknown at time n</span>
<a name="l00477"></a>00477   present/=<a class="code" href="classSchema__Temps__base.html#a41d96b9bfd9ead46031343c31f9bfe5d" title="Pas de temps de calcul.">dt_</a>;
<a name="l00478"></a>00478 
<a name="l00479"></a>00479   <a class="code" href="classSchema__Temps__base.html#ae688058ec9592383f84aeb6de1d56158" title="//Actualisation de stationnaire_atteint_ et residu_ (critere residu_&lt;seuil_statio_)">update_critere_statio</a>(present, eqn);
<a name="l00480"></a>00480   <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a6ee7ebc8081ee39ea73e1aae6177c9a8">update_time_derivative</a>(eqn,present);
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 <span class="comment">// Update time data</span>
<a name="l00483"></a>00483   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#aa17f04a2659b434bdfe159b5bb44982d">nb_valeurs_passees</a>(); i++)
<a name="l00484"></a>00484     {
<a name="l00485"></a>00485       eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>(i) = eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>(i+1);
<a name="l00486"></a>00486     }
<a name="l00487"></a>00487 
<a name="l00488"></a>00488   <span class="keywordflow">return</span> 1;
<a name="l00489"></a>00489 }
<a name="l00490"></a>00490 
<a name="l00491"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a3f019454157ecd36dc1ecc28e857d4a0">00491</a> <span class="keywordtype">int</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a3f019454157ecd36dc1ecc28e857d4a0" title="Reprise (lecture) du temps courant et du nombre de pas de temps effectues a partir d&#39;un flot d&#39;entree...">Schema_Implicite_Multi_TimeStep_base::reprendre</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s)
<a name="l00492"></a>00492 {
<a name="l00493"></a>00493   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> <a class="code" href="Postraitement_8cpp.html#a2014b0b7ca4c8b7161754648bb234d56">nom_fichier</a>(<a class="code" href="classObjet__U.html#a7c27c4f80259eeef76ff8fe2d3bc61f7" title="Renvoie une reference constante vers le nom du cas. Cette methode est statique.">nom_du_cas</a>());
<a name="l00494"></a>00494   nom_fichier+=<span class="stringliteral">&quot;.dt_ev&quot;</span>;
<a name="l00495"></a>00495   <a class="code" href="classLecFicDiffuse.html" title="Cette classe implemente les operateurs et les methodes virtuelles de la classe EFichier de la facon s...">LecFicDiffuse</a> <a class="code" href="Op__Grad__EF_8cpp.html#abc0897c211f7aa4541da5833388f868b">test</a>;
<a name="l00496"></a>00496   <span class="keywordflow">if</span> (!test.<a class="code" href="classLecFicDiffuse.html#a2e4f3199de5e1b47edcffc68952c7be8" title="Ouverture du fichier. Cette methode doit etre appelee par tous les processeurs du groupe...">ouvrir</a>(nom_fichier))
<a name="l00497"></a>00497     {
<a name="l00498"></a>00498       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00499"></a>00499       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;***************** WARNING ***************&quot;</span> &lt;&lt; finl;
<a name="l00500"></a>00500       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;File &quot;</span> &lt;&lt; nom_fichier &lt;&lt; <span class="stringliteral">&quot; does not exist.&quot;</span> &lt;&lt; finl;
<a name="l00501"></a>00501       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;In order to restart a calculation carried out with an implicit time scheme&quot;</span> &lt;&lt; finl;
<a name="l00502"></a>00502       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;it is preferable to re-read the .dt_ev file to pick up some informations&quot;</span> &lt;&lt; finl;
<a name="l00503"></a>00503       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;and in particular the facsec of the previous calculation.&quot;</span> &lt;&lt; finl;
<a name="l00504"></a>00504       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;TRUST will use facsec= &quot;</span> &lt;&lt; <a class="code" href="classSchema__Temps__base.html#a8cdc40f1adfd8ff29d7f9c75330920ee">facsec_</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; finl;
<a name="l00505"></a>00505       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Else specify the facsec wanted value in your data file.&quot;</span> &lt;&lt; finl;
<a name="l00506"></a>00506       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span> &lt;&lt; finl;
<a name="l00507"></a>00507       <span class="keywordflow">return</span> 1;
<a name="l00508"></a>00508     }
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="comment">// Reprise du facsec et du residu dans le fichier .dt_ev s&#39;il existe</span>
<a name="l00511"></a>00511   <span class="keywordtype">double</span> facsec_lu=1.;
<a name="l00512"></a>00512   <span class="keywordtype">double</span> residu_lu=0;
<a name="l00513"></a>00513   <span class="keywordtype">double</span> facsec_lu_old;
<a name="l00514"></a>00514 
<a name="l00515"></a>00515 <span class="comment">// Test ouverture du fichier</span>
<a name="l00516"></a>00516   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00517"></a>00517     {
<a name="l00518"></a>00518       <a class="code" href="classEFichier.html" title="Fichier en lecture Cette classe est a la classe C++ ifstream ce que la classe Entree est a la classe ...">EFichier</a> fichier;
<a name="l00519"></a>00519       fichier.<a class="code" href="classEntree__Fichier__base.html#a8e34b235668e94f335cc9ab18dd4e427">ouvrir</a>(nom_fichier);
<a name="l00520"></a>00520       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> chaine;
<a name="l00521"></a>00521       <span class="keywordtype">double</span> temps=0;
<a name="l00522"></a>00522       <span class="keywordtype">double</span> dt;
<a name="l00523"></a>00523       std::string ligne;
<a name="l00524"></a>00524 <span class="comment">// Si en tete on lit</span>
<a name="l00525"></a>00525       fichier &gt;&gt; chaine;
<a name="l00526"></a>00526       <span class="keywordflow">if</span> (chaine==<span class="stringliteral">&quot;#&quot;</span>)
<a name="l00527"></a>00527         {
<a name="l00528"></a>00528 <span class="comment">// On lit la ligne complete</span>
<a name="l00529"></a>00529           std::getline(fichier.<a class="code" href="classEntree__Fichier__base.html#a9e5abc201d0864efb7e22b593556f432">get_ifstream</a>(), ligne);
<a name="l00530"></a>00530         } <span class="comment">//!&lt; Sinon on reouvre</span>
<a name="l00531"></a>00531 <span class="comment"></span>      <span class="keywordflow">else</span>
<a name="l00532"></a>00532         {
<a name="l00533"></a>00533           fichier.<a class="code" href="classEntree__Fichier__base.html#a8e34b235668e94f335cc9ab18dd4e427">ouvrir</a>(nom_fichier);
<a name="l00534"></a>00534         }
<a name="l00535"></a>00535 <span class="comment">// Recherche du pas de temps precedant tinit_</span>
<a name="l00536"></a>00536       fichier &gt;&gt; temps;
<a name="l00537"></a>00537       <span class="keywordflow">while</span> (!fichier.<a class="code" href="classEntree__Fichier__base.html#a5e6b0d743eb5c7986090c615bd7ad584">eof</a>() &amp;&amp; temps&lt;<a class="code" href="classSchema__Temps__base.html#ab13482fd427c6008c91d0df5d3a7e07f">tinit_</a>)
<a name="l00538"></a>00538         {
<a name="l00539"></a>00539           facsec_lu_old = facsec_lu;
<a name="l00540"></a>00540           fichier &gt;&gt; dt;
<a name="l00541"></a>00541           fichier &gt;&gt; facsec_lu;
<a name="l00542"></a>00542           fichier &gt;&gt; residu_lu;
<a name="l00543"></a>00543 <span class="comment">// On lit le reste de la ligne</span>
<a name="l00544"></a>00544           std::getline(fichier.<a class="code" href="classEntree__Fichier__base.html#a9e5abc201d0864efb7e22b593556f432">get_ifstream</a>(), ligne);
<a name="l00545"></a>00545           fichier &gt;&gt; temps;
<a name="l00546"></a>00546           <span class="keywordflow">if</span> (facsec_lu_old != facsec_lu)
<a name="l00547"></a>00547             {
<a name="l00548"></a>00548               <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a67409abca1c65e048634c1977707ee36">residu_old_</a> = residu_lu;
<a name="l00549"></a>00549               <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a5af050207c47e419b7e3bd0106343962">nb_ite_sans_accel_</a> = 1;
<a name="l00550"></a>00550             }
<a name="l00551"></a>00551           <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a5af050207c47e419b7e3bd0106343962">nb_ite_sans_accel_</a>++;
<a name="l00552"></a>00552         }
<a name="l00553"></a>00553     }
<a name="l00554"></a>00554   <a class="code" href="communications_8cpp.html#a2335b36078ae87e23dab400a6e129a3c">envoyer_broadcast</a>(facsec_lu, 0 <span class="comment">/* pe source */</span>);
<a name="l00555"></a>00555   <a class="code" href="communications_8cpp.html#a2335b36078ae87e23dab400a6e129a3c">envoyer_broadcast</a>(residu_lu, 0 <span class="comment">/* pe source */</span>);
<a name="l00556"></a>00556   <a class="code" href="communications_8cpp.html#a2335b36078ae87e23dab400a6e129a3c">envoyer_broadcast</a>(<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a5af050207c47e419b7e3bd0106343962">nb_ite_sans_accel_</a>, 0 <span class="comment">/* pe source */</span>);
<a name="l00557"></a>00557   <a class="code" href="communications_8cpp.html#a2335b36078ae87e23dab400a6e129a3c">envoyer_broadcast</a>(<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a67409abca1c65e048634c1977707ee36">residu_old_</a>, 0 <span class="comment">/* pe source */</span>);
<a name="l00558"></a>00558 
<a name="l00559"></a>00559 <span class="comment">// On prend le facsec lu uniquement s&#39;il est entre les</span>
<a name="l00560"></a>00560 <span class="comment">// bornes specifiees dans le jeu de donnees</span>
<a name="l00561"></a>00561 <span class="comment">// En effet, on peut faire un calcul explicite puis une reprise en implicite</span>
<a name="l00562"></a>00562   <a class="code" href="classSchema__Temps__base.html#addda9320fe85fd273e84fa0d09f12eef" title="Residu.">residu_</a> = residu_lu;
<a name="l00563"></a>00563   <span class="keywordflow">if</span> (facsec_lu&gt;=<a class="code" href="classSchema__Temps__base.html#a8cdc40f1adfd8ff29d7f9c75330920ee">facsec_</a>)
<a name="l00564"></a>00564     {
<a name="l00565"></a>00565       <span class="keywordflow">if</span> (facsec_lu&lt;=<a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#accd31b2329848889733a35a0f68b9631">facsec_max_</a>)
<a name="l00566"></a>00566         <a class="code" href="classSchema__Temps__base.html#a8cdc40f1adfd8ff29d7f9c75330920ee">facsec_</a> = facsec_lu;
<a name="l00567"></a>00567       <span class="keywordflow">else</span>
<a name="l00568"></a>00568         <a class="code" href="classSchema__Temps__base.html#a8cdc40f1adfd8ff29d7f9c75330920ee">facsec_</a> = <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#accd31b2329848889733a35a0f68b9631">facsec_max_</a>;
<a name="l00569"></a>00569       <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>()) <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Facsec after reading in &quot;</span> &lt;&lt; nom_fichier &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="classSchema__Temps__base.html#a8cdc40f1adfd8ff29d7f9c75330920ee">facsec_</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00570"></a>00570       <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>()) <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Residu after reading in &quot;</span> &lt;&lt; nom_fichier &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="classSchema__Temps__base.html#addda9320fe85fd273e84fa0d09f12eef" title="Residu.">residu_</a> &lt;&lt; finl;
<a name="l00571"></a>00571     }
<a name="l00572"></a>00572   <span class="keywordflow">else</span>
<a name="l00573"></a>00573     {
<a name="l00574"></a>00574       <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
<a name="l00575"></a>00575         {
<a name="l00576"></a>00576           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The readen facsec in &quot;</span> &lt;&lt; nom_fichier &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; facsec_lu &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00577"></a>00577           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;is not used since it is lower than the facsec from the data set : &quot;</span> &lt;&lt; <a class="code" href="classSchema__Temps__base.html#a8cdc40f1adfd8ff29d7f9c75330920ee">facsec_</a> &lt;&lt; finl;
<a name="l00578"></a>00578         }
<a name="l00579"></a>00579     }
<a name="l00580"></a>00580   <span class="keywordflow">return</span> 1;
<a name="l00581"></a>00581 }
<a name="l00582"></a>00582 
<a name="l00583"></a>00583 <span class="comment">// To get du/dt table without pressure gradient and influences of past and present times</span>
<a name="l00584"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a7879328ee40582b3d8a5d4053c609ecf">00584</a> <span class="keywordtype">void</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a7879328ee40582b3d8a5d4053c609ecf">Schema_Implicite_Multi_TimeStep_base::modifier_second_membre_full_impl</a>(<span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; secmem)
<a name="l00585"></a>00585 {
<a name="l00586"></a>00586   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Error in &quot;</span>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot;::modifier_second_membre_full_impl()&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00587"></a>00587   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot; is an implicit time scheme&quot;</span>&lt;&lt;finl;
<a name="l00588"></a>00588   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot;::modifier_second_membre_full_impl() should not be used&quot;</span>&lt;&lt;finl;
<a name="l00589"></a>00589   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00590"></a>00590 }
<a name="l00591"></a>00591 
<a name="l00592"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a5a7a32d3a81b07c0ad60ddd468f315b3">00592</a> <span class="keywordtype">void</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#a5a7a32d3a81b07c0ad60ddd468f315b3">Schema_Implicite_Multi_TimeStep_base::modifier_second_membre</a>(<span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; secmem)
<a name="l00593"></a>00593 {
<a name="l00594"></a>00594   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Error in &quot;</span>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot;::modifier_second_membre()&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00595"></a>00595   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot; is an implicit time scheme&quot;</span>&lt;&lt;finl;
<a name="l00596"></a>00596   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot;::modifier_second_membre() should not be used&quot;</span>&lt;&lt;finl;
<a name="l00597"></a>00597   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00598"></a>00598 }
<a name="l00599"></a>00599 
<a name="l00600"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#afeb224f476531ecb36a80fddcb5cbc6c">00600</a> <span class="keywordtype">void</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#afeb224f476531ecb36a80fddcb5cbc6c">Schema_Implicite_Multi_TimeStep_base::authorized_equation</a>(<span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn)
<a name="l00601"></a>00601 {
<a name="l00602"></a>00602   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>  equation_name(eqn.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>());
<a name="l00603"></a>00603   <span class="keywordtype">bool</span> authorized =  <span class="keyword">true</span>;
<a name="l00604"></a>00604 
<a name="l00605"></a>00605   authorized &amp;= (bool) equation_name.<a class="code" href="classNom.html#a93c76852274daa72fd695c9b2ad8a070">find</a>(<span class="stringliteral">&quot;FT&quot;</span>);
<a name="l00606"></a>00606   authorized &amp;= (bool) equation_name.find(<span class="stringliteral">&quot;Front_Tracking&quot;</span>);
<a name="l00607"></a>00607   authorized &amp;= (bool) equation_name.find(<span class="stringliteral">&quot;QC&quot;</span>);
<a name="l00608"></a>00608   authorized &amp;= (bool) equation_name.find(<span class="stringliteral">&quot;Quasi_Compressible&quot;</span>);
<a name="l00609"></a>00609 
<a name="l00610"></a>00610   <span class="keywordflow">if</span> (!authorized)
<a name="l00611"></a>00611     {
<a name="l00612"></a>00612       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Error in &quot;</span>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot;::authorized_equation()&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00613"></a>00613       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Equation &quot;</span>&lt;&lt;equation_name&lt;&lt;<span class="stringliteral">&quot; is not allowed with &quot;</span>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot; time scheme&quot;</span>&lt;&lt;finl;
<a name="l00614"></a>00614       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00615"></a>00615     }
<a name="l00616"></a>00616 }
<a name="l00617"></a>00617 
<a name="l00618"></a><a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#af27760b56c480e648498e83e26b761d9">00618</a> <span class="keywordtype">void</span> <a class="code" href="classSchema__Implicite__Multi__TimeStep__base.html#afeb224f476531ecb36a80fddcb5cbc6c">Schema_Implicite_Multi_TimeStep_base::authorized_equation</a>(<span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn)<span class="keyword"> const</span>
<a name="l00619"></a>00619 <span class="keyword"></span>{
<a name="l00620"></a>00620   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>  equation_name(eqn.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>());
<a name="l00621"></a>00621   <span class="keywordtype">bool</span> authorized =  <span class="keyword">true</span>;
<a name="l00622"></a>00622 
<a name="l00623"></a>00623   authorized &amp;= (bool) equation_name.<a class="code" href="classNom.html#a93c76852274daa72fd695c9b2ad8a070">find</a>(<span class="stringliteral">&quot;FT&quot;</span>);
<a name="l00624"></a>00624   authorized &amp;= (bool) equation_name.find(<span class="stringliteral">&quot;Front_Tracking&quot;</span>);
<a name="l00625"></a>00625   authorized &amp;= (bool) equation_name.find(<span class="stringliteral">&quot;QC&quot;</span>);
<a name="l00626"></a>00626   authorized &amp;= (bool) equation_name.find(<span class="stringliteral">&quot;Quasi_Compressible&quot;</span>);
<a name="l00627"></a>00627 
<a name="l00628"></a>00628   <span class="keywordflow">if</span> (!authorized)
<a name="l00629"></a>00629     {
<a name="l00630"></a>00630       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Error in &quot;</span>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot;::authorized_equation()&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00631"></a>00631       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Equation &quot;</span>&lt;&lt;equation_name&lt;&lt;<span class="stringliteral">&quot; is not allowed with &quot;</span>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot; time scheme&quot;</span>&lt;&lt;finl;
<a name="l00632"></a>00632       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00633"></a>00633     }
<a name="l00634"></a>00634 }
<a name="l00635"></a>00635 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:25 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
