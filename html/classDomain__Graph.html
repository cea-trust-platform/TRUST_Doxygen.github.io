<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: Domain_Graph Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a>  </div>
  <div class="headertitle">
<div class="title">Domain_Graph Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Domain_Graph" -->
<p>Build the graph of the domain that the METIS/PARMETIS/PTSCOTCH libraries need.  
 <a href="classDomain__Graph.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>&gt;</code></p>

<p><a href="classDomain__Graph-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#acc11973f649e67cc5d0297b2a1462e65">construire_graph_from_segment</a> (const <a class="el" href="classDomaine.html">Domaine</a> &amp;dom, const int use_weights)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#a182aaf66fe5c9451d0c6b309a1289b86">construire_graph_elem_elem</a> (const <a class="el" href="classDomaine.html">Domaine</a> &amp;dom, const <a class="el" href="classNoms.html">Noms</a> &amp;liste_bords_periodiques, const int use_weights, <a class="el" href="classStatic__Int__Lists.html">Static_Int_Lists</a> &amp;graph_elements_perio)</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#af9e2729c1801be23ecf1237370a9b97c">nvtxs</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#a5adfd8eda78ca66bd99c1a675b573810">nedges</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#ad5c25a0bfc7f12a6f18d146ea624b1ec">weightflag</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classArrOfInt.html">ArrOfInt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#ace9fd4d5cc1ff127e4c7ed2f8d189e4a">xadj</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classArrOfInt.html">ArrOfInt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#ab9d17a6424dcbf4c43a138c19aaf8016">adjncy</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classArrOfInt.html">ArrOfInt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#a59235e5ba7a37abd767bb8c18c5a3338">vwgts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classArrOfInt.html">ArrOfInt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#a16341c1f48e745c57d5b5ad8955a9427">ewgts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classArrOfInt.html">ArrOfInt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#ad0879da629d9df6707b70ca0e7030b19">vtxdist</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classArrOfInt.html">ArrOfInt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#ab143b875d41dc9757e8b2472c31efa72">edgegsttab</a></td></tr>
<tr><td colspan="2"><h2><a name="friends"></a>
Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#afd565e677032d77711ba369ae5193491">Partitionneur_Metis</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#a4ed94ac79bac350ad242f7416f11725a">Partitionneur_Parmetis</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDomain__Graph.html#af3fc6aaa0e6be136c511a1430be9383d">Partitionneur_Ptscotch</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Build the graph of the domain that the METIS/PARMETIS/PTSCOTCH libraries need. </p>

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00028">28</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a182aaf66fe5c9451d0c6b309a1289b86"></a><!-- doxytag: member="Domain_Graph::construire_graph_elem_elem" ref="a182aaf66fe5c9451d0c6b309a1289b86" args="(const Domaine &amp;dom, const Noms &amp;liste_bords_periodiques, const int use_weights, Static_Int_Lists &amp;graph_elements_perio)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Domain_Graph::construire_graph_elem_elem </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname"><em>dom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classNoms.html">Noms</a> &amp;&#160;</td>
          <td class="paramname"><em>liste_bords_periodiques</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>use_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStatic__Int__Lists.html">Static_Int_Lists</a> &amp;&#160;</td>
          <td class="paramname"><em>graph_elements_perio</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; Les sommets de la face en cours</p>
<p>&lt; Les elements voisins d'une_face</p>
<p>&lt; l'element i_elem n'est pas voisin: erreur interne</p>
<p>&lt; l'element i_elem n'est pas voisin: erreur interne</p>
<p>&lt; -1 peut faire des partitions discontinues ou pas equilibrees du tout </p>
</p>

<p>Definition at line <a class="el" href="Domain__Graph_8cpp_source.html#l00170">170</a> of file <a class="el" href="Domain__Graph_8cpp_source.html">Domain_Graph.cpp</a>.</p>

<p>References <a class="el" href="Domain__Graph_8h_source.html#l00052">adjncy</a>, <a class="el" href="Partitionneur__base_8cpp_source.html#l00147">Partitionneur_base::calculer_graphe_connexions_periodiques()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Domain__Graph_8cpp_source.html#l00034">construire_connectivite_real_som_virtual_elem()</a>, <a class="el" href="Connectivite__som__elem_8cpp_source.html#l00042">construire_connectivite_som_elem()</a>, <a class="el" href="Zone_8cpp_source.html#l01398">Zone::construire_elem_virt_pe_num()</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Domain__Graph_8h_source.html#l00056">edgegsttab</a>, <a class="el" href="communications_8cpp_source.html#l00452">envoyer_all_to_all()</a>, <a class="el" href="Domain__Graph_8h_source.html#l00054">ewgts</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Connectivite__som__elem_8cpp_source.html#l00108">find_adjacent_elements()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Static__Int__Lists_8h_source.html#l00106">Static_Int_Lists::get_list_size()</a>, <a class="el" href="classPoly__geom__base.html#aa5aae399947d9858e81d2bd6c4edf812">Poly_geom_base::get_somme_nb_faces_elem()</a>, <a class="el" href="Elem__geom__base_8cpp_source.html#l00265">Elem_geom_base::get_tab_faces_sommets_locaux()</a>, <a class="el" href="Zone_8h_source.html#l00402">Zone::les_elems()</a>, <a class="el" href="Process_8cpp_source.html#l00117">Process::me()</a>, <a class="el" href="Process_8cpp_source.html#l00178">Process::mp_sum()</a>, <a class="el" href="communications_8cpp_source.html#l00608">mppartial_sum()</a>, <a class="el" href="Zone_8h_source.html#l00300">Zone::nb_elem()</a>, <a class="el" href="Zone_8h_source.html#l01240">Zone::nb_faces_frontiere()</a>, <a class="el" href="Zone_8cpp_source.html#l00527">Zone::nb_faces_joint()</a>, <a class="el" href="Domaine_8cpp_source.html#l00184">Domaine::nb_som()</a>, <a class="el" href="Domain__Graph_8h_source.html#l00049">nedges</a>, <a class="el" href="Process_8cpp_source.html#l00109">Process::nproc()</a>, <a class="el" href="Domain__Graph_8h_source.html#l00048">nvtxs</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="ArrOfInt_8h_source.html#l00240">ArrOfInt::resize_array()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00443">ArrOfInt::set_smart_resize()</a>, <a class="el" href="vect__impl_8h_source.html#l00057">vect_impl::size()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00342">ArrOfInt::size_array()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Zone_8h_source.html#l00491">Zone::type_elem()</a>, <a class="el" href="Raffiner__Simplexes_8cpp_source.html#l00183">type_elem()</a>, <a class="el" href="Elem__geom_8h_source.html#l00044">Deriv_Elem_geom_base::valeur()</a>, <a class="el" href="Domain__Graph_8h_source.html#l00055">vtxdist</a>, <a class="el" href="Domain__Graph_8h_source.html#l00053">vwgts</a>, <a class="el" href="Domain__Graph_8h_source.html#l00050">weightflag</a>, <a class="el" href="Domain__Graph_8h_source.html#l00051">xadj</a>, and <a class="el" href="Domaine_8h_source.html#l00272">Domaine::zone()</a>.</p>

<p>Referenced by <a class="el" href="Partitionneur__Ptscotch_8cpp_source.html#l00085">Partitionneur_Ptscotch::construire_partition()</a>, <a class="el" href="Partitionneur__Parmetis_8cpp_source.html#l00085">Partitionneur_Parmetis::construire_partition()</a>, and <a class="el" href="Partitionneur__Metis_8cpp_source.html#l00136">Partitionneur_Metis::construire_partition()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classStatic__Int__Lists.html" title="Cette classe permet de stocker des listes d&#39;entiers accessibles en temps constant. La taille des listes ne peut pas changer sans perdre le contenu (ce sont des listes statiques). Exemple: Static_Int_List l; ArrOfInt tailles(3); tailles[0] = 2; tailles[1] = 3; tailles[2] = 0; // On reserve la memoire pour trois listes de taille 2, 3 et 0: l.set_list_sizes(tailles); // On affecte une valeur au deuxieme element de la premiere liste: l.set_value(0,1,765); // Affiche la valeur Cout &lt;&lt; l(0,1);.">Static_Int_Lists</a> som_elem;
  <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);
  <span class="keyword">const</span> <a class="code" href="classElem__geom__base.html" title="Classe Elem_geom_base Cette classe est la classe de base pour la definition d&#39;elements geometriques c...">Elem_geom_base</a>&amp; <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a> = zone.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classDeriv__Elem__geom__base.html#a384b487459a33f9f521fb16539ec81de">valeur</a>();
  <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> faces_element_reference;
  <span class="keyword">const</span> <span class="keywordtype">int</span> is_regular =
    type_elem.<a class="code" href="classElem__geom__base.html#a9993267e98ef97472d3a5ef9c3c67882" title="remplit le tableau faces_som_local(i,j) qui donne pour 0 &lt;= i &lt; nb_faces() et 0 &lt;= j &lt; nb_som_face(i) le ...">get_tab_faces_sommets_locaux</a>(faces_element_reference);
  <span class="keywordflow">if</span> (! is_regular)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Domain_Graph::construire_graph_elem_elem\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot; The type of element is not supported&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPoly__geom__base.html" title=": class Poly_geom_base &lt;Description of class Poly_geom_base&gt;">Poly_geom_base</a>,type_elem).get_tab_faces_sommets_locaux(faces_element_reference,0);
    }
  <span class="keywordtype">int</span> nb_faces_par_element = faces_element_reference.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_sommets_par_face = faces_element_reference.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);

  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_som = zone.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem = zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>();

  <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> offsets(<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>());
  offsets = <a class="code" href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071" title="Calul de la somme partielle de i sur les processeurs 0 a me()-1 (renvoie 0 sur le processeur 0)...">mppartial_sum</a>(nb_elem);
  <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(offsets, offsets);
  <span class="keywordtype">int</span> my_offset = offsets[<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>()];

  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Construction of the som_elem connectivity&quot;</span> &lt;&lt; finl;
  <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
    {
<span class="comment">// what we&#39;re doing here is not equivalent to construire_connectivite_som_elem with virtual elements set to 1</span>
<span class="comment">// in the latter, we also build the connectivity for virtual nodes</span>
<span class="comment">// here, we add the connectivity of real nodes only with virtual elements</span>
<span class="comment">// + we want som_elem to contain global numerotation for elements</span>
      <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> elem_virt_pe_num;
      zone.<a class="code" href="classZone.html#a5a8e81b23354f7080912cf6113a4740c">construire_elem_virt_pe_num</a>(elem_virt_pe_num);
      <a class="code" href="Domain__Graph_8cpp.html#a59f2c95ce088a2f16d969d2dc7954375">construire_connectivite_real_som_virtual_elem</a>(dom.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>(),
                                                    elem_som,
                                                    som_elem,
                                                    elem_virt_pe_num,
                                                    offsets);

    }
  <span class="keywordflow">else</span>
    <a class="code" href="Connectivite__som__elem_8cpp.html#a82161461a228e43ae236c31101ff3ce6" title="construction de la structure som_elem pour la zone donnee On cree pour chaque sommet i la liste des e...">construire_connectivite_som_elem</a>(dom.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>(),
                                     elem_som,
                                     som_elem,
                                     0 <span class="comment">/* ne pas inclure les elements virtuels */</span>);


  <span class="keywordtype">int</span> nb_connexions_perio = 0;
  <span class="keywordflow">if</span> (liste_bords_periodiques.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>() &gt; 0)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Construction of graph connectivity for periodic boundaries&quot;</span> &lt;&lt; finl;
      nb_connexions_perio = <a class="code" href="classPartitionneur__base.html#ae4bf98b6e5948e2b368d5b1525d73b76" title="Calcul d&#39;un graphe de connectivite entre les elements lies par des faces periodiques. Si l&#39;element i est voisin de l&#39;element j par une face periodique, alors il existe k tel que graph(i,k)==j et il existe k2 tel que graph(j,k2)==i. Parametre: zone Signification: la zone a traiter Parametre: liste_bords_periodiques Signification: liste des noms des bords periodiques. ATTENTION: on suppose que les faces des bords periodiques sont rangees selon la convention des bords periodiques. Voir check_faces_periodiques(). Parametre: som_elem Signification: la connectivite sommets-elements pour la zone donnee. Parametre: graph Signification: On y stocke le resultat. Valeur de retour: nombre d&#39;elements dans le graphe (egal au nombre de faces periodiques)">Partitionneur_base::calculer_graphe_connexions_periodiques</a>(dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0),
                                                                                       liste_bords_periodiques,
                                                                                       som_elem,
                                                                                       my_offset,
                                                                                       graph_elements_perio);
    }

<span class="comment">// ****************************************************************</span>
<span class="comment">// PREMIERE ETAPE: calcul du nombre de vertex et edges du graph:</span>

<span class="comment">// Nombre total de faces de bord:</span>
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_bord = zone.<a class="code" href="classZone.html#adb3970b0289aa1b0a38772011fd5d915" title="Renvoie le nombre de faces frontiere de la zone du type specifie. C&#39;est la somme des nombres de bords...">nb_faces_frontiere</a>();

<span class="comment">// Chaque element du maillage est un &quot;vertex&quot; du graph.</span>
<span class="comment">// Les &quot;edges&quot; du graph relient chaque element a ses voisins par une face.</span>
<span class="comment">// Il y a autant d&#39;edges que de faces ayant deux voisins, fois 2</span>
<span class="comment">// Formule classique: nb_faces internes = nnn/2 avec :</span>
  <span class="keywordtype">int</span> nnn = nb_elem * nb_faces_par_element - nb_faces_bord + nb_connexions_perio;
  <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPoly__geom__base.html" title=": class Poly_geom_base &lt;Description of class Poly_geom_base&gt;">Poly_geom_base</a>,zone.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classDeriv__Elem__geom__base.html#a384b487459a33f9f521fb16539ec81de">valeur</a>()))
    {
      <span class="keyword">const</span> <a class="code" href="classPoly__geom__base.html" title=": class Poly_geom_base &lt;Description of class Poly_geom_base&gt;">Poly_geom_base</a>&amp; poly=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPoly__geom__base.html" title=": class Poly_geom_base &lt;Description of class Poly_geom_base&gt;">Poly_geom_base</a>,zone.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classDeriv__Elem__geom__base.html#a384b487459a33f9f521fb16539ec81de">valeur</a>());
      nnn= poly.<a class="code" href="classPoly__geom__base.html#aa5aae399947d9858e81d2bd6c4edf812">get_somme_nb_faces_elem</a>() - nb_faces_bord + nb_connexions_perio;
    }

  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_edges = nnn + nb_faces_bord;

  <a class="code" href="classDomain__Graph.html#af9e2729c1801be23ecf1237370a9b97c">nvtxs</a> = nb_elem + zone.<a class="code" href="classZone.html#aff77b437f8c58064cc80a3221a0b6130" title="Renvoie le nombre de joints de la zone.">nb_faces_joint</a>(); <span class="comment">//each joint face is linked to a virtual element</span>
  <a class="code" href="classDomain__Graph.html#ace9fd4d5cc1ff127e4c7ed2f8d189e4a">xadj</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(nb_elem+1);
  <a class="code" href="classDomain__Graph.html#ace9fd4d5cc1ff127e4c7ed2f8d189e4a">xadj</a> = -1;
  <a class="code" href="classDomain__Graph.html#ab9d17a6424dcbf4c43a138c19aaf8016">adjncy</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(nb_edges+nb_faces_bord);
  <a class="code" href="classDomain__Graph.html#ab9d17a6424dcbf4c43a138c19aaf8016">adjncy</a> = -1;
  <a class="code" href="classDomain__Graph.html#ab143b875d41dc9757e8b2472c31efa72">edgegsttab</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(nb_edges+nb_faces_bord);
  <a class="code" href="classDomain__Graph.html#ab143b875d41dc9757e8b2472c31efa72">edgegsttab</a> = -1;

  <a class="code" href="classDomain__Graph.html#a59235e5ba7a37abd767bb8c18c5a3338">vwgts</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(0); <span class="comment">//NULL</span>
  <span class="keywordflow">if</span> (! use_weights)
    {
      <a class="code" href="classDomain__Graph.html#ad5c25a0bfc7f12a6f18d146ea624b1ec">weightflag</a> = 0;
      <a class="code" href="classDomain__Graph.html#a16341c1f48e745c57d5b5ad8955a9427">ewgts</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(0); <span class="comment">//NULL</span>
    }
  <span class="keywordflow">else</span>
    {
      <a class="code" href="classDomain__Graph.html#ad5c25a0bfc7f12a6f18d146ea624b1ec">weightflag</a> = 1;
      <a class="code" href="classDomain__Graph.html#a16341c1f48e745c57d5b5ad8955a9427">ewgts</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(nb_edges + nb_faces_bord);
    }

  <a class="code" href="classDomain__Graph.html#ad0879da629d9df6707b70ca0e7030b19">vtxdist</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>()+1);
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>(); p++)
    <a class="code" href="classDomain__Graph.html#ad0879da629d9df6707b70ca0e7030b19">vtxdist</a>[p] = offsets[p];
  <a class="code" href="classDomain__Graph.html#ad0879da629d9df6707b70ca0e7030b19">vtxdist</a>[<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>()] = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(nb_elem);

  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Construction of the elem_elem connectivity&quot;</span> &lt;&lt; finl;
<span class="comment">// ***************************************************************</span>
<span class="comment">// DEUXIEME ETAPE: remplissage du graph</span>
<span class="comment">// Algorithme: Pour chaque element, boucle sur les faces de l&#39;element</span>
<span class="comment">// et on ajoute un &quot;edge&quot; entre l&#39;element et ses voisins. On cherche</span>
<span class="comment">// l&#39;element voisin par une face a l&#39;aide de la fonction find_adjacent_elements.</span>
<span class="comment">// </span>
<span class="comment">// Deux tableaux de travail:</span>
  <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> une_face(nb_sommets_par_face); <span class="comment">//!&lt; Les sommets de la face en cours</span>
<span class="comment"></span>  <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> voisins; <span class="comment">//!&lt; Les elements voisins d&#39;une_face</span>
<span class="comment"></span>  voisins.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);

  <span class="keywordtype">int</span> error = 0;
  <span class="keywordtype">int</span> edge_count = 0;
  <span class="keywordtype">int</span> i_elem;
  <span class="keywordflow">for</span> (i_elem = 0; i_elem &lt; nb_elem; i_elem++)
    {
      <a class="code" href="classDomain__Graph.html#ace9fd4d5cc1ff127e4c7ed2f8d189e4a">xadj</a>[i_elem] = edge_count;
      <span class="keywordtype">int</span> i_face;

      <span class="keywordflow">if</span> (!is_regular)
        {
          <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPoly__geom__base.html" title=": class Poly_geom_base &lt;Description of class Poly_geom_base&gt;">Poly_geom_base</a>,type_elem).get_tab_faces_sommets_locaux(faces_element_reference,i_elem);
          <span class="keywordtype">int</span> nb_faces_elem       = faces_element_reference.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
          <span class="keywordflow">while</span> ( faces_element_reference(nb_faces_elem-1,0)==-1)
            nb_faces_elem--;
          nb_faces_par_element= nb_faces_elem;
        }
      <span class="keywordflow">for</span> (i_face = 0; i_face &lt; nb_faces_par_element; i_face++)
        {
<span class="comment">// Construction de cette face de l&#39;element:</span>
<span class="comment">// (indice des sommets de la face dans le domaine)</span>
          {
            <span class="keywordtype">int</span> i;
            <span class="keywordflow">for</span> (i = 0; i &lt; nb_sommets_par_face; i++)
              {
                <span class="keyword">const</span> <span class="keywordtype">int</span> i_som = faces_element_reference(i_face, i);
                <span class="keywordflow">if</span> (i_som&lt;0)
                  une_face[i] = i_som;
                <span class="keywordflow">else</span>
                  {
                    <span class="keyword">const</span> <span class="keywordtype">int</span> sommet = elem_som(i_elem, i_som);
                    une_face[i] = sommet;
                  }
              }
          }
<span class="comment">// Recherche des elements voisins de cette face:</span>
<span class="comment">// (indices des elements contenant les sommets de la face)</span>
          <a class="code" href="Connectivite__som__elem_8cpp.html#afccbadf5344a16154a56b33dbddf88c1" title="Cherche les elements qui contiennent tous les sommets du tableau sommets_to_find (permet de trouver l...">find_adjacent_elements</a>(som_elem, une_face, voisins);

          <span class="keyword">const</span> <span class="keywordtype">int</span> nb_voisins = voisins.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
          <span class="keywordtype">int</span> elem_voisin = -1;
          <span class="keywordflow">switch</span> (nb_voisins)
            {
            <span class="keywordflow">case</span> 0:
              {
<span class="comment">// Aucun voisin: erreur interne</span>
                error = 3;
                <span class="keywordflow">break</span>;
              }
            <span class="keywordflow">case</span> 1:
              {
<span class="comment">// Un seul voisin, c&#39;est une face frontiere</span>
                <span class="keyword">const</span> <span class="keywordtype">int</span> elem = voisins[0];
                <span class="keywordflow">if</span> (elem != i_elem + my_offset)
                  error = 3; <span class="comment">//!&lt; l&#39;element i_elem n&#39;est pas voisin: erreur interne</span>
<span class="comment"></span>                <span class="keywordflow">else</span>
                  elem_voisin = -1;
                <span class="keywordflow">break</span>;
              }
            <span class="keywordflow">case</span> 2:
              {
<span class="comment">// Le cas le plus courant:</span>
                <span class="keyword">const</span> <span class="keywordtype">int</span> elem0 = voisins[0];
                <span class="keyword">const</span> <span class="keywordtype">int</span> elem1 = voisins[1];
                <span class="keywordflow">if</span> (elem0 == i_elem + my_offset) <span class="comment">//neighbours contain global numerotation</span>
                  elem_voisin = elem1;
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem1 == i_elem + my_offset)
                  elem_voisin = elem0;
                <span class="keywordflow">else</span>
                  error = 3; <span class="comment">//!&lt; l&#39;element i_elem n&#39;est pas voisin: erreur interne</span>
<span class="comment"></span>                <span class="keywordflow">break</span>;
              }
            <span class="keywordflow">default</span>:
              {
<span class="comment">// Plus de deux voisins</span>
                error = 2;
              }
            }

          <span class="keywordflow">if</span> (error)
            <span class="keywordflow">break</span>;

          <span class="keywordflow">if</span> (elem_voisin &gt;= 0)
            {
              <span class="keywordflow">if</span> (edge_count &gt;= nb_edges)
                {
                  error = 1;
                  <span class="keywordflow">break</span>;
                }
              <a class="code" href="classDomain__Graph.html#ab9d17a6424dcbf4c43a138c19aaf8016">adjncy</a>[edge_count] = elem_voisin;

              <span class="keywordflow">if</span> (use_weights)
                {
<span class="comment">// internal connection have more weight:</span>
<span class="comment">// it&#39;s better if the generated partition is not dispatched on several processors</span>
                  <span class="keywordflow">if</span>( my_offset &lt;= elem_voisin &amp;&amp; elem_voisin &lt; nb_elem+my_offset) <span class="comment">//neighbour belongs to me = strong connection</span>
                    <a class="code" href="classDomain__Graph.html#a16341c1f48e745c57d5b5ad8955a9427">ewgts</a>[edge_count] = 4;
                  <span class="keywordflow">else</span>
                    <a class="code" href="classDomain__Graph.html#a16341c1f48e745c57d5b5ad8955a9427">ewgts</a>[edge_count] = 1; <span class="comment">//!&lt; -1 peut faire des partitions discontinues ou pas equilibrees du tout</span>
<span class="comment"></span>
                }

              edge_count++;
            }
        }
<span class="comment">// Ajout des connexions supplementaires pour les faces periodiques</span>
      <span class="keywordflow">if</span> (nb_connexions_perio &gt; 0)
        {
          <span class="keyword">const</span> <span class="keywordtype">int</span> n = graph_elements_perio.<a class="code" href="classStatic__Int__Lists.html#adbf6903737c3c30bf87e05b29f5a5b56" title="renvoie le nombre d&#39;elements de la liste i">get_list_size</a>(i_elem);
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
            {
              <span class="keyword">const</span> <span class="keywordtype">int</span> elem_voisin = graph_elements_perio(i_elem, i);
              <span class="keywordflow">if</span> (edge_count &gt;= nb_edges)
                {
                  error = 1;
                  <span class="keywordflow">break</span>;
                }
              <a class="code" href="classDomain__Graph.html#ab9d17a6424dcbf4c43a138c19aaf8016">adjncy</a>[edge_count] = elem_voisin;
<span class="comment">// Les connexions entre faces periodiques sont fortes:</span>
<span class="comment">// on veut que ces elements soient sur le meme processeur</span>
<span class="comment">// Attention, si on met un poids nettement plus eleve que les autres</span>
<span class="comment">// edges, on degrade la qualite du decoupage !</span>
              <span class="keywordflow">if</span> (use_weights)
                {
                  <a class="code" href="classDomain__Graph.html#a16341c1f48e745c57d5b5ad8955a9427">ewgts</a>[edge_count] = 4;
                }
              edge_count++;
            }
        }
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (use_weights)
        {
          <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() == 1)
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Warning: You specify use_weights option with Metis but you didn&#39;t use Periodique keyword&quot;</span> &lt;&lt; finl;
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;to define the boundary where periodicity apply.&quot;</span> &lt;&lt; finl;
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Either suppress use_weight or add Periodique keyword.&quot;</span> &lt;&lt; finl;
              <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
            }
        }
      <span class="keywordflow">if</span> (error &gt; 0)
        <span class="keywordflow">break</span>;
    }
  <a class="code" href="classDomain__Graph.html#ace9fd4d5cc1ff127e4c7ed2f8d189e4a">xadj</a>[nb_elem] = edge_count;
  <a class="code" href="classDomain__Graph.html#a5adfd8eda78ca66bd99c1a675b573810">nedges</a> = edge_count;

  std::map&lt;int,int&gt; global_to_local_index;
  <span class="keywordtype">int</span> cnt=nb_elem;
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> e=0; e&lt;nb_edges + nb_faces_bord; e++)
    {
      <span class="keywordtype">int</span> vertex = <a class="code" href="classDomain__Graph.html#ab9d17a6424dcbf4c43a138c19aaf8016">adjncy</a>[e];
      <span class="keywordflow">if</span>( my_offset &lt;= vertex &amp;&amp; vertex &lt; nb_elem+my_offset) <span class="comment">//neighbour belongs to me</span>
        {
          <a class="code" href="classDomain__Graph.html#ab143b875d41dc9757e8b2472c31efa72">edgegsttab</a>[e] = vertex - my_offset;
        }
      <span class="keywordflow">else</span>
        {
          std::map&lt;int,int&gt;::iterator it = global_to_local_index.find(vertex);
          <span class="keywordflow">if</span>(it != global_to_local_index.end())
            {
              <a class="code" href="classDomain__Graph.html#ab143b875d41dc9757e8b2472c31efa72">edgegsttab</a>[e] = global_to_local_index[vertex];

            }
          <span class="keywordflow">else</span>
            {
              global_to_local_index[vertex] =cnt++;
              <a class="code" href="classDomain__Graph.html#ab143b875d41dc9757e8b2472c31efa72">edgegsttab</a>[e] = global_to_local_index[vertex];
            }

        }
    }

  <span class="keywordflow">if</span> (error == 1)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Domaine_Graph::construire_graph_elem_elem\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot; The number of element-element connections is greater than expected\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot; The number of boundary faces is wrong.\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot; You must discretize the domain to check.&quot;</span> &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (error == 2)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Domain_Graph::construire_graph_elem_elem\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot; Problem in the mesh: one internal face has more than two neighboring elements\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot; List of neighboring elements:&quot;</span> &lt;&lt; voisins
           &lt;&lt; <span class="stringliteral">&quot;\n Nodes of the face:&quot;</span> &lt;&lt; une_face;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (error)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Internal error in Domain_Graph::construire_graph_elem_elem\n&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot; (error &quot;</span> &lt;&lt; error &lt;&lt; <span class="stringliteral">&quot;) Problem in neighborhood algorithms&quot;</span>
           &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }

}
</pre></div>
</div>
</div>
<a class="anchor" id="acc11973f649e67cc5d0297b2a1462e65"></a><!-- doxytag: member="Domain_Graph::construire_graph_from_segment" ref="acc11973f649e67cc5d0297b2a1462e65" args="(const Domaine &amp;dom, const int use_weights)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Domain_Graph::construire_graph_from_segment </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDomaine.html">Domaine</a> &amp;&#160;</td>
          <td class="paramname"><em>dom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>use_weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; 2 liens par liaison</p>
<p>&lt; mouif</p>
<p>&lt; des liens peuvent etre doubles </p>
</p>

<p>Definition at line <a class="el" href="Domain__Graph_8cpp_source.html#l00102">102</a> of file <a class="el" href="Domain__Graph_8cpp_source.html">Domain_Graph.cpp</a>.</p>

<p>References <a class="el" href="Domain__Graph_8h_source.html#l00052">adjncy</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00112">Matrix_tools::allocate_morse_matrix()</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Domain__Graph_8h_source.html#l00054">ewgts</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00134">Matrice_Morse::get_tab1()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00138">Matrice_Morse::get_tab2()</a>, <a class="el" href="Zone_8h_source.html#l00402">Zone::les_elems()</a>, <a class="el" href="IntVect_8cpp_source.html#l01581">IntVect::local_max_vect()</a>, <a class="el" href="Domain__Graph_8h_source.html#l00049">nedges</a>, <a class="el" href="Domain__Graph_8h_source.html#l00048">nvtxs</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00240">ArrOfInt::resize_array()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00443">ArrOfInt::set_smart_resize()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00342">ArrOfInt::size_array()</a>, <a class="el" href="Array__tools_8cpp_source.html#l00389">tableau_trier_retirer_doublons()</a>, <a class="el" href="Domain__Graph_8h_source.html#l00053">vwgts</a>, <a class="el" href="Domain__Graph_8h_source.html#l00050">weightflag</a>, <a class="el" href="Domain__Graph_8h_source.html#l00051">xadj</a>, and <a class="el" href="Domaine_8h_source.html#l00272">Domaine::zone()</a>.</p>

<p>Referenced by <a class="el" href="Partitionneur__Metis_8cpp_source.html#l00136">Partitionneur_Metis::construire_partition()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; liaisons = dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();

<span class="comment">// ****************************************************************</span>
<span class="comment">// PREMIERE ETAPE: calcul du nombre de vertex et edges du graph:</span>
  <span class="keywordtype">int</span> nb_edges = liaisons.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>(); <span class="comment">//!&lt; 2 liens par liaison</span>
<span class="comment"></span>  <span class="keywordtype">int</span> nb_elem=liaisons.<a class="code" href="classIntVect.html#a71df51f4f83be94f9ea9b5eaad7298a5">local_max_vect</a>()+1;  <span class="comment">//!&lt; mouif</span>
<span class="comment"></span>  <a class="code" href="classDomain__Graph.html#af9e2729c1801be23ecf1237370a9b97c">nvtxs</a> = nb_elem;
  <a class="code" href="classDomain__Graph.html#ace9fd4d5cc1ff127e4c7ed2f8d189e4a">xadj</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(nb_elem+1);
  <a class="code" href="classDomain__Graph.html#a59235e5ba7a37abd767bb8c18c5a3338">vwgts</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(0);
  <span class="keywordflow">if</span> (! use_weights)
    {
      <a class="code" href="classDomain__Graph.html#ad5c25a0bfc7f12a6f18d146ea624b1ec">weightflag</a> = 0;
      <a class="code" href="classDomain__Graph.html#a16341c1f48e745c57d5b5ad8955a9427">ewgts</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(0);
    }
  <span class="keywordflow">else</span>
    {
      abort();
      <a class="code" href="classDomain__Graph.html#ad5c25a0bfc7f12a6f18d146ea624b1ec">weightflag</a> = 1;
      <a class="code" href="classDomain__Graph.html#a16341c1f48e745c57d5b5ad8955a9427">ewgts</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(nb_edges);
    }

<span class="comment">// on construit connectivite item item</span>
  <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> stencyl(0,2);
  stencyl.set_smart_resize(1);
  <span class="keywordtype">int</span> size=0;
  <span class="keywordtype">int</span> nbl=liaisons.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nbl; i++)
    {
      stencyl.resize(size+2,2);
      <span class="keywordtype">int</span> n1=liaisons(i,0);
      <span class="keywordtype">int</span> n2=liaisons(i,1);
      {
        stencyl(size,0)=n1;
        stencyl(size,1)=n2;

        size++;
        stencyl(size,0)=n2;
        stencyl(size,1)=n1;

        size++;
      }
    }
  <a class="code" href="Array__tools_8cpp.html#a07eed4c823b0632bdbf353fdab2a3c6b" title="Trie le tableau tab dans l&#39;ordre lexicographique et retire les doublons (attention [1...">tableau_trier_retirer_doublons</a>(stencyl);
  <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> A;
  <a class="code" href="classMatrix__tools.html#a481961691c1dbee5372da25777e5c1e8">Matrix_tools::allocate_morse_matrix</a>(nb_elem,nb_elem,stencyl,A);

  nb_edges=A.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>().<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>(); <span class="comment">//!&lt; des liens peuvent etre doubles</span>
<span class="comment"></span>  <a class="code" href="classDomain__Graph.html#a5adfd8eda78ca66bd99c1a675b573810">nedges</a> = nb_edges;
  <a class="code" href="classDomain__Graph.html#ab9d17a6424dcbf4c43a138c19aaf8016">adjncy</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(nb_edges);
<span class="comment">// </span>
  assert(A.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>().<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()==<a class="code" href="classDomain__Graph.html#af9e2729c1801be23ecf1237370a9b97c">nvtxs</a>+1);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;<a class="code" href="classDomain__Graph.html#af9e2729c1801be23ecf1237370a9b97c">nvtxs</a>+1; c++)
    {
      <a class="code" href="classDomain__Graph.html#ace9fd4d5cc1ff127e4c7ed2f8d189e4a">xadj</a>[c]=A.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(c)-1;
    }
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;<a class="code" href="classDomain__Graph.html#a5adfd8eda78ca66bd99c1a675b573810">nedges</a>; c++)
    {
      <a class="code" href="classDomain__Graph.html#ab9d17a6424dcbf4c43a138c19aaf8016">adjncy</a>[c]=A.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>()(c)-1;
    }

}
</pre></div>
</div>
</div>
<hr/><h2>Friends And Related Function Documentation</h2>
<a class="anchor" id="afd565e677032d77711ba369ae5193491"></a><!-- doxytag: member="Domain_Graph::Partitionneur_Metis" ref="afd565e677032d77711ba369ae5193491" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classPartitionneur__Metis.html">Partitionneur_Metis</a><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00031">31</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4ed94ac79bac350ad242f7416f11725a"></a><!-- doxytag: member="Domain_Graph::Partitionneur_Parmetis" ref="a4ed94ac79bac350ad242f7416f11725a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classPartitionneur__Parmetis.html">Partitionneur_Parmetis</a><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00032">32</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>

</div>
</div>
<a class="anchor" id="af3fc6aaa0e6be136c511a1430be9383d"></a><!-- doxytag: member="Domain_Graph::Partitionneur_Ptscotch" ref="af3fc6aaa0e6be136c511a1430be9383d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classPartitionneur__Ptscotch.html">Partitionneur_Ptscotch</a><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00033">33</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ab9d17a6424dcbf4c43a138c19aaf8016"></a><!-- doxytag: member="Domain_Graph::adjncy" ref="ab9d17a6424dcbf4c43a138c19aaf8016" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArrOfInt.html">ArrOfInt</a> <a class="el" href="classDomain__Graph.html#ab9d17a6424dcbf4c43a138c19aaf8016">Domain_Graph::adjncy</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00052">52</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>

<p>Referenced by <a class="el" href="Domain__Graph_8cpp_source.html#l00170">construire_graph_elem_elem()</a>, <a class="el" href="Domain__Graph_8cpp_source.html#l00102">construire_graph_from_segment()</a>, <a class="el" href="Partitionneur__Ptscotch_8cpp_source.html#l00085">Partitionneur_Ptscotch::construire_partition()</a>, <a class="el" href="Partitionneur__Parmetis_8cpp_source.html#l00085">Partitionneur_Parmetis::construire_partition()</a>, and <a class="el" href="Partitionneur__Metis_8cpp_source.html#l00136">Partitionneur_Metis::construire_partition()</a>.</p>

</div>
</div>
<a class="anchor" id="ab143b875d41dc9757e8b2472c31efa72"></a><!-- doxytag: member="Domain_Graph::edgegsttab" ref="ab143b875d41dc9757e8b2472c31efa72" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArrOfInt.html">ArrOfInt</a> <a class="el" href="classDomain__Graph.html#ab143b875d41dc9757e8b2472c31efa72">Domain_Graph::edgegsttab</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00056">56</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>

<p>Referenced by <a class="el" href="Domain__Graph_8cpp_source.html#l00170">construire_graph_elem_elem()</a>, and <a class="el" href="Partitionneur__Ptscotch_8cpp_source.html#l00085">Partitionneur_Ptscotch::construire_partition()</a>.</p>

</div>
</div>
<a class="anchor" id="a16341c1f48e745c57d5b5ad8955a9427"></a><!-- doxytag: member="Domain_Graph::ewgts" ref="a16341c1f48e745c57d5b5ad8955a9427" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArrOfInt.html">ArrOfInt</a> <a class="el" href="classDomain__Graph.html#a16341c1f48e745c57d5b5ad8955a9427">Domain_Graph::ewgts</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00054">54</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>

<p>Referenced by <a class="el" href="Domain__Graph_8cpp_source.html#l00170">construire_graph_elem_elem()</a>, <a class="el" href="Domain__Graph_8cpp_source.html#l00102">construire_graph_from_segment()</a>, <a class="el" href="Partitionneur__Ptscotch_8cpp_source.html#l00085">Partitionneur_Ptscotch::construire_partition()</a>, <a class="el" href="Partitionneur__Parmetis_8cpp_source.html#l00085">Partitionneur_Parmetis::construire_partition()</a>, and <a class="el" href="Partitionneur__Metis_8cpp_source.html#l00136">Partitionneur_Metis::construire_partition()</a>.</p>

</div>
</div>
<a class="anchor" id="a5adfd8eda78ca66bd99c1a675b573810"></a><!-- doxytag: member="Domain_Graph::nedges" ref="a5adfd8eda78ca66bd99c1a675b573810" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classDomain__Graph.html#a5adfd8eda78ca66bd99c1a675b573810">Domain_Graph::nedges</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00049">49</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>

<p>Referenced by <a class="el" href="Domain__Graph_8cpp_source.html#l00170">construire_graph_elem_elem()</a>, and <a class="el" href="Domain__Graph_8cpp_source.html#l00102">construire_graph_from_segment()</a>.</p>

</div>
</div>
<a class="anchor" id="af9e2729c1801be23ecf1237370a9b97c"></a><!-- doxytag: member="Domain_Graph::nvtxs" ref="af9e2729c1801be23ecf1237370a9b97c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classDomain__Graph.html#af9e2729c1801be23ecf1237370a9b97c">Domain_Graph::nvtxs</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00048">48</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>

<p>Referenced by <a class="el" href="Domain__Graph_8cpp_source.html#l00170">construire_graph_elem_elem()</a>, <a class="el" href="Domain__Graph_8cpp_source.html#l00102">construire_graph_from_segment()</a>, <a class="el" href="Partitionneur__Parmetis_8cpp_source.html#l00085">Partitionneur_Parmetis::construire_partition()</a>, and <a class="el" href="Partitionneur__Metis_8cpp_source.html#l00136">Partitionneur_Metis::construire_partition()</a>.</p>

</div>
</div>
<a class="anchor" id="ad0879da629d9df6707b70ca0e7030b19"></a><!-- doxytag: member="Domain_Graph::vtxdist" ref="ad0879da629d9df6707b70ca0e7030b19" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArrOfInt.html">ArrOfInt</a> <a class="el" href="classDomain__Graph.html#ad0879da629d9df6707b70ca0e7030b19">Domain_Graph::vtxdist</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00055">55</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>

<p>Referenced by <a class="el" href="Domain__Graph_8cpp_source.html#l00170">construire_graph_elem_elem()</a>, and <a class="el" href="Partitionneur__Parmetis_8cpp_source.html#l00085">Partitionneur_Parmetis::construire_partition()</a>.</p>

</div>
</div>
<a class="anchor" id="a59235e5ba7a37abd767bb8c18c5a3338"></a><!-- doxytag: member="Domain_Graph::vwgts" ref="a59235e5ba7a37abd767bb8c18c5a3338" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArrOfInt.html">ArrOfInt</a> <a class="el" href="classDomain__Graph.html#a59235e5ba7a37abd767bb8c18c5a3338">Domain_Graph::vwgts</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00053">53</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>

<p>Referenced by <a class="el" href="Domain__Graph_8cpp_source.html#l00170">construire_graph_elem_elem()</a>, <a class="el" href="Domain__Graph_8cpp_source.html#l00102">construire_graph_from_segment()</a>, <a class="el" href="Partitionneur__Parmetis_8cpp_source.html#l00085">Partitionneur_Parmetis::construire_partition()</a>, and <a class="el" href="Partitionneur__Metis_8cpp_source.html#l00136">Partitionneur_Metis::construire_partition()</a>.</p>

</div>
</div>
<a class="anchor" id="ad5c25a0bfc7f12a6f18d146ea624b1ec"></a><!-- doxytag: member="Domain_Graph::weightflag" ref="ad5c25a0bfc7f12a6f18d146ea624b1ec" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classDomain__Graph.html#ad5c25a0bfc7f12a6f18d146ea624b1ec">Domain_Graph::weightflag</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00050">50</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>

<p>Referenced by <a class="el" href="Domain__Graph_8cpp_source.html#l00170">construire_graph_elem_elem()</a>, <a class="el" href="Domain__Graph_8cpp_source.html#l00102">construire_graph_from_segment()</a>, and <a class="el" href="Partitionneur__Parmetis_8cpp_source.html#l00085">Partitionneur_Parmetis::construire_partition()</a>.</p>

</div>
</div>
<a class="anchor" id="ace9fd4d5cc1ff127e4c7ed2f8d189e4a"></a><!-- doxytag: member="Domain_Graph::xadj" ref="ace9fd4d5cc1ff127e4c7ed2f8d189e4a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArrOfInt.html">ArrOfInt</a> <a class="el" href="classDomain__Graph.html#ace9fd4d5cc1ff127e4c7ed2f8d189e4a">Domain_Graph::xadj</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Domain__Graph_8h_source.html#l00051">51</a> of file <a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a>.</p>

<p>Referenced by <a class="el" href="Domain__Graph_8cpp_source.html#l00170">construire_graph_elem_elem()</a>, <a class="el" href="Domain__Graph_8cpp_source.html#l00102">construire_graph_from_segment()</a>, <a class="el" href="Partitionneur__Ptscotch_8cpp_source.html#l00085">Partitionneur_Ptscotch::construire_partition()</a>, <a class="el" href="Partitionneur__Parmetis_8cpp_source.html#l00085">Partitionneur_Parmetis::construire_partition()</a>, and <a class="el" href="Partitionneur__Metis_8cpp_source.html#l00136">Partitionneur_Metis::construire_partition()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/Kernel/Geometrie/Decoupeur/<a class="el" href="Domain__Graph_8h_source.html">Domain_Graph.h</a></li>
<li>src/Kernel/Geometrie/Decoupeur/<a class="el" href="Domain__Graph_8cpp_source.html">Domain_Graph.cpp</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:36:35 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
