<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VEF/Champs/Champ_P1NC_implementation.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VEF/Champs/Champ_P1NC_implementation.cpp</div>  </div>
</div>
<div class="contents">
<a href="Champ__P1NC__implementation_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Champ_P1NC_implementation.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VEF/Champs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/61</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Champ__P1NC__implementation_8h.html">Champ_P1NC_implementation.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Champ__P1NC_8h.html">Champ_P1NC.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Fonc__P1NC_8h.html">Champ_Fonc_P1NC.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="LecFicDiffuse_8h.html">LecFicDiffuse.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="DoubleLists_8h.html">DoubleLists.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Periodique_8h.html">Periodique.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Solv__GCP_8h.html">Solv_GCP.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="SSOR_8h.html">SSOR.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Equation__base_8h.html">Equation_base.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Mod__turb__hyd__base_8h.html">Mod_turb_hyd_base.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__paroi__fixe_8h.html">Dirichlet_paroi_fixe.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__paroi__defilante_8h.html">Dirichlet_paroi_defilante.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="distances__VEF_8h.html">distances_VEF.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Bloc_8h.html">Matrice_Bloc.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="IntLists_8h.html">IntLists.h</a>&gt;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 
<a name="l00043"></a><a class="code" href="Champ__P1NC__implementation_8cpp.html#afbe7fcf4bcc6179a6c6cfc12b0a6d799">00043</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="Champ__P1NC__implementation_8cpp.html#afbe7fcf4bcc6179a6c6cfc12b0a6d799">methode_calcul_valeurs_sommets</a> = 2 ;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="comment">// -1 moyenne des faces</span>
<a name="l00046"></a>00046 <span class="comment">// 1 moyenne des sommets sans min/max</span>
<a name="l00047"></a>00047 <span class="comment">// 2 moyenne des sommets avec min/max (ancienne version)</span>
<a name="l00048"></a>00048 
<a name="l00049"></a><a class="code" href="classChamp__P1NC__implementation.html#a562aaf721cd09c383b02b487a497df28">00049</a> <a class="code" href="classChamp__P1NC__implementation.html#a562aaf721cd09c383b02b487a497df28">Champ_P1NC_implementation::Champ_P1NC_implementation</a>()
<a name="l00050"></a>00050 {
<a name="l00051"></a>00051 <span class="comment">// Initialise l&#39;attribut</span>
<a name="l00052"></a>00052   <a class="code" href="classChamp__P1NC__implementation.html#a4437c8f910d3e626accf68eeb590ab15">filtrer_L2_deja_appele_</a>=0;
<a name="l00053"></a>00053 <span class="comment">// definition des types de solveurs par defaut (sinon, lecture dans solveur.bar)</span>
<a name="l00054"></a>00054   <a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Solv_GCP&quot;</span>);
<a name="l00055"></a>00055   <a class="code" href="classPrecond.html">Precond</a> p;
<a name="l00056"></a>00056   p.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;SSOR&quot;</span>);
<a name="l00057"></a>00057   <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolv__GCP.html">Solv_GCP</a>,<a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>()).set_precond(p);
<a name="l00058"></a>00058   <a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>.<a class="code" href="classSolveurSys.html#a17fa90c93f514a6d2a898e682e724d3b" title="Donne un nom a l&#39;Objet_U Methode virtuelle a surcharger.">nommer</a>(<span class="stringliteral">&quot;solveur_L2&quot;</span>);
<a name="l00059"></a>00059   <a class="code" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">solveur_H1</a>.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Solv_GCP&quot;</span>);
<a name="l00060"></a>00060   <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolv__GCP.html">Solv_GCP</a>,<a class="code" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">solveur_H1</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>()).set_precond(p);
<a name="l00061"></a>00061   <a class="code" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">solveur_H1</a>.<a class="code" href="classSolveurSys.html#a17fa90c93f514a6d2a898e682e724d3b" title="Donne un nom a l&#39;Objet_U Methode virtuelle a surcharger.">nommer</a>(<span class="stringliteral">&quot;solveur_H1&quot;</span>);
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 }
<a name="l00066"></a>00066 
<a name="l00067"></a><a class="code" href="Champ__P1NC__implementation_8cpp.html#aa542335f9416aab2cb6f6d433f596516">00067</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="Champ__P1NC__implementation_8cpp.html#aa542335f9416aab2cb6f6d433f596516">coeff_penalisation</a> = 1e9;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="comment">//</span>
<a name="l00072"></a>00072 <span class="comment">//</span>
<a name="l00073"></a>00073 <span class="comment">//</span>
<a name="l00074"></a>00074 <span class="comment">//</span><span class="comment"></span>
<a name="l00075"></a>00075 <span class="comment">//! Projection du champ P1NC &quot;cha&quot; sur l&#39;espace des champs P1.&lt;br&gt;Le resultat est stocke dans cha.ch_som() et renvoye (valeur de retour)&lt;br&gt;Voir note technique 2006/010 de Patrick Quemere &quot;Nouvelle approche VEF pour la LES...&quot;.&lt;br&gt;Voir aussi &quot;What is in TRUST&quot; : Scales_Separation_P1_P1NC.</span>
<a name="l00076"></a><a class="code" href="Champ__P1NC__implementation_8cpp.html#ae1e2fa7e95f53175d1fe9cf5741ba751">00076</a> <span class="comment"></span><a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="Champ__P1NC__implementation_8cpp.html#ae1e2fa7e95f53175d1fe9cf5741ba751" title="Projection du champ P1NC &quot;cha&quot; sur l&#39;espace des champs P1. Le resultat est stocke dans cha...">valeur_P1_L2</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha, <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom)
<a name="l00077"></a>00077 {
<a name="l00078"></a>00078   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; mazone = dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   <span class="keywordtype">int</span> nb_elem_tot = mazone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00081"></a>00081   <span class="keywordtype">int</span> nb_som = mazone.<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
<a name="l00082"></a>00082   <span class="keywordtype">int</span> nb_som_elem = mazone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00083"></a>00083   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00084"></a>00084 
<a name="l00085"></a>00085   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = cha.<a class="code" href="classChamp__P1NC.html#a122a5f097bee0c82357ab77ab23e0068">zone_vef</a>();
<a name="l00086"></a>00086   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>, cha.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00087"></a>00087   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_som = mazone.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00088"></a>00088   <span class="keywordtype">double</span> mijK, miiK;
<a name="l00089"></a>00089   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit_som=cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>();
<a name="l00090"></a>00090 
<a name="l00091"></a>00091   <span class="keywordtype">int</span> n_bord, nb_comp=vit_som.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00092"></a>00092   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> secmem(cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>());
<a name="l00093"></a>00093 
<a name="l00094"></a>00094   secmem=0.;
<a name="l00095"></a>00095 <span class="comment">// vit_som=0.; // PQ : 06/10/04 : dans la resolution du systeme, &quot;solution&quot; repart de vit_som=cha.ch_som()</span>
<a name="l00096"></a>00096 <span class="comment">// pour s&#39;affranchir de recalculer u_bar lors d&#39;un double appel a filtrer_L2</span>
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
<a name="l00099"></a>00099     {
<a name="l00100"></a>00100       mijK=1./12.;
<a name="l00101"></a>00101       miiK= 1./6.;
<a name="l00102"></a>00102     }
<a name="l00103"></a>00103   <span class="keywordflow">else</span>
<a name="l00104"></a>00104     {
<a name="l00105"></a>00105       mijK=1./18.;
<a name="l00106"></a>00106       miiK= 1./12.;
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="comment">// dans le cas d&#39;une zone nulle on doit effectuer le dimensionnement</span>
<a name="l00110"></a>00110 <span class="comment">// mais une seule fois</span>
<a name="l00111"></a>00111   <span class="keywordtype">double</span> non_prepare=0;
<a name="l00112"></a>00112   <span class="keywordflow">if</span> (cha.<a class="code" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">MatP1NC2P1_L2</a>.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() &lt;2)
<a name="l00113"></a>00113     non_prepare=1;
<a name="l00114"></a>00114   non_prepare=<a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_min</a>(non_prepare);
<a name="l00115"></a>00115   <span class="keywordflow">if</span> (non_prepare==1)
<a name="l00116"></a>00116     {
<a name="l00117"></a>00117 <span class="comment">// Initialisation du solveur</span>
<a name="l00118"></a>00118       <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>, (cha.<a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>));
<a name="l00119"></a>00119       <a class="code" href="classLecFicDiffuse.html" title="Cette classe implemente les operateurs et les methodes virtuelles de la classe EFichier de la facon s...">LecFicDiffuse</a> fic;
<a name="l00120"></a>00120       fic.<a class="code" href="classLecFicDiffuse.html#a2e4f3199de5e1b47edcffc68952c7be8" title="Ouverture du fichier. Cette methode doit etre appelee par tous les processeurs du groupe...">ouvrir</a>(<span class="stringliteral">&quot;solveur.bar&quot;</span>);
<a name="l00121"></a>00121       <span class="keywordflow">if</span>(fic.<a class="code" href="classLec__Diffuse__base.html#a0d28f6309b5b0d97b3bd0ad8309aec61">good</a>())
<a name="l00122"></a>00122         {
<a name="l00123"></a>00123           fic &gt;&gt; solv;
<a name="l00124"></a>00124           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot;solveur.bar ouvert pour lire: &quot;</span> &lt;&lt; solv &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00125"></a>00125         }
<a name="l00126"></a>00126       solv-&gt;reinit();
<a name="l00127"></a>00127 
<a name="l00128"></a>00128       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;On remplit la matrice cha.MatP1NC2P1_L2 pour le champ &quot;</span>&lt;&lt; cha.<a class="code" href="classField__base.html#ae1377124eabe8387aced762115b062bb" title="Renvoie le nom du champ.">le_nom</a>() &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00129"></a>00129       <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; mat=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, (cha.<a class="code" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">MatP1NC2P1_L2</a>));
<a name="l00130"></a>00130       <span class="keywordtype">int</span> rang;
<a name="l00131"></a>00131       <span class="keywordtype">int</span> nnz=0;
<a name="l00132"></a>00132       <a class="code" href="classIntLists.html" title="Un tableau de listes de type IntList.">IntLists</a> voisins(nb_som);
<a name="l00133"></a>00133       <a class="code" href="classDoubleLists.html" title="Un tableau de listes de type DoubleList.">DoubleLists</a> coeffs(nb_som);
<a name="l00134"></a>00134       <a class="code" href="classDoubleVect.html">DoubleVect</a> diag(nb_som);
<a name="l00135"></a>00135       <span class="keywordtype">int</span> elem;
<a name="l00136"></a>00136       <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00137"></a>00137         {
<a name="l00138"></a>00138           <span class="keywordtype">double</span> coeff_ij=mijK*zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem);
<a name="l00139"></a>00139           <span class="keywordtype">double</span> coeff_ii=miiK*zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem);
<a name="l00140"></a>00140           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_elem; isom++)
<a name="l00141"></a>00141             {
<a name="l00142"></a>00142               <span class="keywordtype">int</span> som=elem_som(elem,isom);
<a name="l00143"></a>00143               <span class="keywordtype">int</span> ii=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l00144"></a>00144               diag[ii]+=coeff_ii;
<a name="l00145"></a>00145               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jsom=isom+1; jsom&lt;nb_som_elem; jsom++)
<a name="l00146"></a>00146                 {
<a name="l00147"></a>00147                   <span class="keywordtype">int</span> asom=elem_som(elem,jsom);
<a name="l00148"></a>00148                   <span class="keywordtype">int</span> j=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(asom);
<a name="l00149"></a>00149                   <span class="keywordtype">int</span> i=ii;
<a name="l00150"></a>00150                   <span class="keywordflow">if</span>(i&gt;j)
<a name="l00151"></a>00151                     {
<a name="l00152"></a>00152                       <span class="keywordtype">int</span> k=j;
<a name="l00153"></a>00153                       j=i;
<a name="l00154"></a>00154                       i=k;
<a name="l00155"></a>00155                     }
<a name="l00156"></a>00156                   rang=voisins[i].rang(j);
<a name="l00157"></a>00157                   <span class="keywordflow">if</span>(rang==-1)
<a name="l00158"></a>00158                     {
<a name="l00159"></a>00159                       voisins[i].add(j);
<a name="l00160"></a>00160                       coeffs[i].add(coeff_ij);
<a name="l00161"></a>00161                       nnz++;
<a name="l00162"></a>00162                     }
<a name="l00163"></a>00163                   <span class="keywordflow">else</span>
<a name="l00164"></a>00164                     {
<a name="l00165"></a>00165                       coeffs[i][rang]+=coeff_ij;
<a name="l00166"></a>00166                     }
<a name="l00167"></a>00167                 }
<a name="l00168"></a>00168             }
<a name="l00169"></a>00169         }
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="comment">// PQ : pour le remplissage des coefficients de la matrice specifiques au CL Dirichlet,</span>
<a name="l00172"></a>00172 <span class="comment">// on commence par traiter les conditions Dirichlet, PUIS Dirichlet_homogene pour s&#39;assurer</span>
<a name="l00173"></a>00173 <span class="comment">// de l&#39;&quot;adherence&quot; des points sommets appartenant aux deux types de CL (aretes de bords)</span>
<a name="l00174"></a>00174 
<a name="l00175"></a>00175       <a class="code" href="classIntVect.html">IntVect</a> test_cl_imposee(nb_som);
<a name="l00176"></a>00176       test_cl_imposee = 0;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178       <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00179"></a>00179         {
<a name="l00180"></a>00180 <span class="comment">// for n_bord</span>
<a name="l00181"></a>00181           <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00182"></a>00182           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00183"></a>00183           <span class="keywordtype">int</span> face;
<a name="l00184"></a>00184           <span class="keywordtype">int</span> num1 = 0;
<a name="l00185"></a>00185           <span class="keywordtype">int</span> num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00186"></a>00186 <span class="comment">// if ( sub_type(Dirichlet,la_cl.valeur()))</span>
<a name="l00187"></a>00187           <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00188"></a>00188             {
<a name="l00189"></a>00189               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
<a name="l00190"></a>00190                 {
<a name="l00191"></a>00191                   face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00192"></a>00192                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; isom++)
<a name="l00193"></a>00193                     {
<a name="l00194"></a>00194                       <span class="keywordtype">int</span> som=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,isom);
<a name="l00195"></a>00195                       som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l00196"></a>00196                       <span class="keywordflow">if</span> (test_cl_imposee(som) == 0)
<a name="l00197"></a>00197                         diag[som] = 0;
<a name="l00198"></a>00198                       diag[som] += <a class="code" href="Champ__P1NC__implementation_8cpp.html#aa542335f9416aab2cb6f6d433f596516">coeff_penalisation</a>;
<a name="l00199"></a>00199                       test_cl_imposee(som) += 1;
<a name="l00200"></a>00200                     }
<a name="l00201"></a>00201                 }
<a name="l00202"></a>00202             }
<a name="l00203"></a>00203         }<span class="comment">//for n_bord</span>
<a name="l00204"></a>00204 
<a name="l00205"></a>00205       test_cl_imposee = 0;
<a name="l00206"></a>00206 
<a name="l00207"></a>00207       <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00208"></a>00208         {
<a name="l00209"></a>00209 <span class="comment">// for n_bord</span>
<a name="l00210"></a>00210           <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00211"></a>00211           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00212"></a>00212           <span class="keywordtype">int</span> face;
<a name="l00213"></a>00213           <span class="keywordtype">int</span> num1 = 0;
<a name="l00214"></a>00214           <span class="keywordtype">int</span> num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00215"></a>00215 
<a name="l00216"></a>00216           <span class="keywordflow">if</span> (  <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) )
<a name="l00217"></a>00217             {
<a name="l00218"></a>00218               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
<a name="l00219"></a>00219                 {
<a name="l00220"></a>00220                   face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00221"></a>00221                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; isom++)
<a name="l00222"></a>00222                     {
<a name="l00223"></a>00223                       <span class="keywordtype">int</span> som=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,isom);
<a name="l00224"></a>00224                       som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l00225"></a>00225                       <span class="keywordflow">if</span> (test_cl_imposee(som) == 0)
<a name="l00226"></a>00226                         diag[som] = 0;
<a name="l00227"></a>00227                       diag[som] += <a class="code" href="Champ__P1NC__implementation_8cpp.html#aa542335f9416aab2cb6f6d433f596516">coeff_penalisation</a>;
<a name="l00228"></a>00228                       test_cl_imposee(som) += 1;
<a name="l00229"></a>00229                     }
<a name="l00230"></a>00230                 }
<a name="l00231"></a>00231             }
<a name="l00232"></a>00232         }<span class="comment">//for n_bord</span>
<a name="l00233"></a>00233 
<a name="l00234"></a>00234       {
<a name="l00235"></a>00235         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som; i++)
<a name="l00236"></a>00236           <span class="keywordflow">if</span>(diag(i)==0)
<a name="l00237"></a>00237             diag(i)=1.;
<a name="l00238"></a>00238       }
<a name="l00239"></a>00239 
<a name="l00240"></a>00240 <span class="comment">// coeffs = 0.;</span>
<a name="l00241"></a>00241 <span class="comment">// diag = 10.;</span>
<a name="l00242"></a>00242       mat.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nb_som, nnz+nb_som) ;
<a name="l00243"></a>00243       mat.<a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">remplir</a>(voisins, coeffs, diag) ;
<a name="l00244"></a>00244       mat.<a class="code" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69" title="Suppression des doublons on ordonne tab2; Verification de la diagonale: tous ses elements doivent etr...">compacte</a>() ;
<a name="l00245"></a>00245       mat.<a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(1);
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 <span class="comment">// Modif CD 15/04/03 pour paralleliser le filtrage</span>
<a name="l00248"></a>00248 <span class="comment">// On copie la matrice remplie ci-dessus dans une matrice bloc.</span>
<a name="l00249"></a>00249 <span class="comment">// Cette modification permet d&#39;utiliser le preconditionnement SSOR</span>
<a name="l00250"></a>00250 
<a name="l00251"></a>00251 <span class="comment">// On fait aussi la transformation en matrice bloc en sequentiel car sinon</span>
<a name="l00252"></a>00252 <span class="comment">// probleme avec NP</span>
<a name="l00253"></a>00253 
<a name="l00254"></a>00254       cha.<a class="code" href="classChamp__P1NC__implementation.html#a5badd5dee68ffbd7e63228509fe1cb18">dimensionner_Mat_Bloc_Morse_Sym</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>);
<a name="l00255"></a>00255       cha.<a class="code" href="classChamp__P1NC__implementation.html#a80e98cf9dfa018d6f3d18608924c8d57">Mat_Morse_to_Mat_Bloc</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>);
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 <span class="comment">// Fin Modif CD 15/04/03</span>
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 <span class="comment">// mat.imprimer_formatte(Cerr);</span>
<a name="l00260"></a>00260 <span class="comment">// Cerr&lt;&lt;&quot;zone.nb_som_tot() = &quot;&lt;&lt;mazone.nb_som_tot()&lt;&lt;&quot;, zone.nb_som() = &quot;&lt;&lt;mazone.nb_som()&lt;&lt;finl;</span>
<a name="l00261"></a>00261 <span class="comment">// Cerr &lt;&lt; &quot;Matrice de filtrage OK&quot; &lt;&lt; finl;</span>
<a name="l00262"></a>00262 <span class="comment">// Cout &lt;&lt; &quot;Matrice de masse P1 : &quot; &lt;&lt; finl;</span>
<a name="l00263"></a>00263 <span class="comment">// mat.imprimer(Cout) &lt;&lt; finl;</span>
<a name="l00264"></a>00264     }
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 <span class="comment">// Debog::verifier(&quot; verif champ &quot; , ch);</span>
<a name="l00267"></a>00267 
<a name="l00268"></a>00268   <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
<a name="l00269"></a>00269   <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
<a name="l00270"></a>00270     coeff=1./6.;
<a name="l00271"></a>00271   <span class="keywordflow">else</span>
<a name="l00272"></a>00272     coeff=1./12.;
<a name="l00273"></a>00273 
<a name="l00274"></a>00274   <span class="keywordtype">int</span> nb_faces=zone_VEF.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
<a name="l00275"></a>00275   <span class="keywordtype">int</span> nb_faces_tot=zone_VEF.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
<a name="l00276"></a>00276   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> virtfait(nb_faces_tot-nb_faces);
<a name="l00277"></a>00277   <span class="keywordtype">int</span> nb_som_face=zone_VEF.<a class="code" href="classZone__VF.html#a990808f967f351edbb83ff11d60b7445" title="renvoie le nombre de sommets par face. Rque : on a suppose que toutes les faces avait le meme nombre ...">nb_som_face</a>();
<a name="l00278"></a>00278   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l00279"></a>00279   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins=zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00280"></a>00280   <span class="keywordtype">int</span> face;
<a name="l00281"></a>00281   <span class="keywordtype">int</span> premiere_face_int = zone_VEF.<a class="code" href="classZone__VF.html#a12869806fa4834aca8f2964e16509dfd" title="une face est interne ssi elle separe deux elements. renvoie le numero de la premiere face interne...">premiere_face_int</a>();
<a name="l00282"></a>00282 
<a name="l00283"></a>00283   <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00284"></a>00284     {
<a name="l00285"></a>00285 <span class="comment">// for n_bord</span>
<a name="l00286"></a>00286       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00287"></a>00287       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00288"></a>00288       <span class="keywordtype">int</span> nb_faces_bord = le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00289"></a>00289       <span class="keywordtype">int</span> num1 = 0;
<a name="l00290"></a>00290       <span class="keywordtype">int</span> num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00291"></a>00291 
<a name="l00292"></a>00292       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00293"></a>00293         {
<a name="l00294"></a>00294 <span class="comment">// *0.5 car les faces perio sont parcourues deux fois</span>
<a name="l00295"></a>00295           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
<a name="l00296"></a>00296             {
<a name="l00297"></a>00297               face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00298"></a>00298               <span class="keywordflow">if</span> (ind_face-nb_faces_bord&gt;=0) virtfait(face-nb_faces)=1;
<a name="l00299"></a>00299               <span class="keywordtype">int</span> elem1=face_voisins(face,0);
<a name="l00300"></a>00300               <span class="keywordtype">int</span> elem2=face_voisins(face,1);
<a name="l00301"></a>00301               <span class="keywordtype">double</span> volume=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem1);
<a name="l00302"></a>00302               <span class="keywordflow">if</span>(elem2!=-1)
<a name="l00303"></a>00303                 volume+=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem2);
<a name="l00304"></a>00304               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
<a name="l00305"></a>00305                 {
<a name="l00306"></a>00306                   <span class="keywordtype">int</span> som=face_sommets(face,isom);
<a name="l00307"></a>00307                   <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l00308"></a>00308                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
<a name="l00309"></a>00309                     secmem(som1,k)+=0.5*coeff*volume*ch(face,k);
<a name="l00310"></a>00310                 }
<a name="l00311"></a>00311             }
<a name="l00312"></a>00312         }
<a name="l00313"></a>00313       <span class="keywordflow">else</span>
<a name="l00314"></a>00314         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
<a name="l00315"></a>00315           {
<a name="l00316"></a>00316             face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00317"></a>00317             <span class="keywordflow">if</span> (ind_face-nb_faces_bord&gt;=0) virtfait(face-nb_faces)=1;
<a name="l00318"></a>00318             <span class="keywordtype">int</span> elem1=face_voisins(face,0);
<a name="l00319"></a>00319             <span class="keywordtype">int</span> elem2=face_voisins(face,1);
<a name="l00320"></a>00320             <span class="keywordtype">double</span> volume=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem1);
<a name="l00321"></a>00321             <span class="keywordflow">if</span>(elem2!=-1)
<a name="l00322"></a>00322               volume+=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem2);
<a name="l00323"></a>00323             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
<a name="l00324"></a>00324               {
<a name="l00325"></a>00325                 <span class="keywordtype">int</span> som=face_sommets(face,isom);
<a name="l00326"></a>00326                 <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l00327"></a>00327                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
<a name="l00328"></a>00328                   secmem(som1,k)+=coeff*volume*ch(face,k);
<a name="l00329"></a>00329               }
<a name="l00330"></a>00330           }
<a name="l00331"></a>00331     }
<a name="l00332"></a>00332 
<a name="l00333"></a>00333   <span class="keywordflow">for</span>(face=premiere_face_int; face&lt;nb_faces_tot; face++)
<a name="l00334"></a>00334     {
<a name="l00335"></a>00335       <span class="keywordtype">int</span> indvirtface=face-nb_faces;
<a name="l00336"></a>00336 <span class="comment">// on regarde si la face virtuelle n&#39;a pas deja ete traitee</span>
<a name="l00337"></a>00337       <span class="keywordflow">if</span> (indvirtface&gt;=0)
<a name="l00338"></a>00338         <span class="keywordflow">if</span> (virtfait[indvirtface]==1) <span class="keywordflow">continue</span>;
<a name="l00339"></a>00339 
<a name="l00340"></a>00340       <span class="keywordtype">int</span> elem1=face_voisins(face,0);
<a name="l00341"></a>00341       <span class="keywordtype">int</span> elem2=face_voisins(face,1);
<a name="l00342"></a>00342       <span class="keywordtype">double</span> volume=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem1);
<a name="l00343"></a>00343       <span class="keywordflow">if</span>(elem2!=-1)
<a name="l00344"></a>00344         volume+=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem2);
<a name="l00345"></a>00345       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
<a name="l00346"></a>00346         {
<a name="l00347"></a>00347           <span class="keywordtype">int</span> som=face_sommets(face,isom);
<a name="l00348"></a>00348           <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l00349"></a>00349           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
<a name="l00350"></a>00350             secmem(som1,k)+=coeff*volume*ch(face,k);
<a name="l00351"></a>00351         }
<a name="l00352"></a>00352     }
<a name="l00353"></a>00353 <span class="comment">// ************************************************************************************************</span>
<a name="l00354"></a>00354 <span class="comment">// ************************************************************************************************</span>
<a name="l00355"></a>00355 <span class="comment">// </span>
<a name="l00356"></a>00356 <span class="comment">// Pour imposer u_som = u donne par CL_Dirichlet</span>
<a name="l00357"></a>00357 <span class="comment">//</span>
<a name="l00358"></a>00358 <span class="comment">// ************************************************************************************************</span>
<a name="l00359"></a>00359 <span class="comment">// ************************************************************************************************</span>
<a name="l00360"></a>00360 
<a name="l00361"></a>00361 <span class="comment">// PQ : on commence par traiter les conditions Dirichlet, PUIS Dirichlet_homogene pour s&#39;assurer</span>
<a name="l00362"></a>00362 <span class="comment">// de l&#39;&quot;adherence&quot; des points sommets appartenant aux deux types de CL (aretes de bords)</span>
<a name="l00363"></a>00363 
<a name="l00364"></a>00364   <a class="code" href="classIntVect.html">IntVect</a> test_cl_imposee(nb_som);
<a name="l00365"></a>00365 
<a name="l00366"></a>00366   test_cl_imposee = 0;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368   <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00369"></a>00369     {
<a name="l00370"></a>00370 <span class="comment">// for n_bord</span>
<a name="l00371"></a>00371       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00372"></a>00372       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00373"></a>00373       <span class="keywordtype">int</span> num1 = 0;
<a name="l00374"></a>00374       <span class="keywordtype">int</span> num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00375"></a>00375 
<a name="l00376"></a>00376 <span class="comment">// if ( sub_type(Dirichlet,la_cl.valeur()))</span>
<a name="l00377"></a>00377       <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00378"></a>00378         {
<a name="l00379"></a>00379           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
<a name="l00380"></a>00380             {
<a name="l00381"></a>00381               face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00382"></a>00382               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
<a name="l00383"></a>00383                 {
<a name="l00384"></a>00384                   <span class="keywordtype">int</span> som=face_sommets(face,isom);
<a name="l00385"></a>00385                   <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l00386"></a>00386                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
<a name="l00387"></a>00387                     {
<a name="l00388"></a>00388                       <span class="keywordflow">if</span> (test_cl_imposee(som1)==0)
<a name="l00389"></a>00389                         secmem(som1,k) = 0;
<a name="l00390"></a>00390 
<a name="l00391"></a>00391                       secmem(som1,k) += <a class="code" href="Champ__P1NC__implementation_8cpp.html#aa542335f9416aab2cb6f6d433f596516">coeff_penalisation</a> * ch(face,k);
<a name="l00392"></a>00392                     }
<a name="l00393"></a>00393                   test_cl_imposee(som1) += 1;
<a name="l00394"></a>00394                 }
<a name="l00395"></a>00395             }
<a name="l00396"></a>00396         }
<a name="l00397"></a>00397     }<span class="comment">//for n_bord</span>
<a name="l00398"></a>00398 
<a name="l00399"></a>00399   test_cl_imposee = 0;
<a name="l00400"></a>00400 
<a name="l00401"></a>00401   <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00402"></a>00402     {
<a name="l00403"></a>00403 <span class="comment">// for n_bord</span>
<a name="l00404"></a>00404       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00405"></a>00405       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00406"></a>00406       <span class="keywordtype">int</span> num1 = 0;
<a name="l00407"></a>00407       <span class="keywordtype">int</span> num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00408"></a>00408 
<a name="l00409"></a>00409       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00410"></a>00410         {
<a name="l00411"></a>00411           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
<a name="l00412"></a>00412             {
<a name="l00413"></a>00413               face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00414"></a>00414               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
<a name="l00415"></a>00415                 {
<a name="l00416"></a>00416                   <span class="keywordtype">int</span> som=face_sommets(face,isom);
<a name="l00417"></a>00417                   <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l00418"></a>00418                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
<a name="l00419"></a>00419                     {
<a name="l00420"></a>00420                       <span class="keywordflow">if</span> (test_cl_imposee(som1)==0)
<a name="l00421"></a>00421                         secmem(som1,k) = 0;
<a name="l00422"></a>00422 
<a name="l00423"></a>00423                       secmem(som1,k) += <a class="code" href="Champ__P1NC__implementation_8cpp.html#aa542335f9416aab2cb6f6d433f596516">coeff_penalisation</a> * ch(face,k);
<a name="l00424"></a>00424                     }
<a name="l00425"></a>00425                   test_cl_imposee(som1) += 1;
<a name="l00426"></a>00426                 }
<a name="l00427"></a>00427             }
<a name="l00428"></a>00428         }
<a name="l00429"></a>00429     }<span class="comment">//for n_bord</span>
<a name="l00430"></a>00430 
<a name="l00431"></a>00431 <span class="comment">// ************************************************************************************************</span>
<a name="l00432"></a>00432 <span class="comment">// ************************************************************************************************</span>
<a name="l00433"></a>00433   secmem.<a class="code" href="classIntVect.html#ad12bea67621d1a0ee82b27c9a37ca4ef">echange_espace_virtuel</a>();
<a name="l00434"></a>00434 <span class="comment">// Debog::verifier(&quot; verif secmem_ech &quot; , secmem);</span>
<a name="l00435"></a>00435 
<a name="l00436"></a>00436   <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>, cha.<a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>);
<a name="l00437"></a>00437   <a class="code" href="classDoubleVect.html">DoubleVect</a> secmemk(cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>());
<a name="l00438"></a>00438   <a class="code" href="classDoubleVect.html">DoubleVect</a> solution(cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>());
<a name="l00439"></a>00439 
<a name="l00440"></a>00440   <span class="keywordflow">if</span>(nb_comp==1)
<a name="l00441"></a>00441     {
<a name="l00442"></a>00442       solution=vit_som;
<a name="l00443"></a>00443       secmem.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00444"></a>00444       <a class="code" href="classDebog.html#aa228f7e951ef67b9e9bb31ced928652f">Debog::verifier</a>(<span class="stringliteral">&quot; verif secmem &quot;</span> , secmem);
<a name="l00445"></a>00445 
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 <span class="comment">// ON UTILISE LA MEME MATRICE EN SEQUENTIEL ET PARALLELE</span>
<a name="l00448"></a>00448 <span class="comment">// CE QUI PERMET D UTILISER UNE MATRICE BLOC QUAND ON APPELLE LE SOLVEUR NP</span>
<a name="l00449"></a>00449       solv.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmem, solution);
<a name="l00450"></a>00450 
<a name="l00451"></a>00451       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> som=0; som&lt;nb_som; som++)
<a name="l00452"></a>00452         vit_som(som)=solution(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som));
<a name="l00453"></a>00453     }
<a name="l00454"></a>00454   <span class="keywordflow">else</span>
<a name="l00455"></a>00455     {
<a name="l00456"></a>00456       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
<a name="l00457"></a>00457         {
<a name="l00458"></a>00458           <span class="keywordtype">int</span> som;
<a name="l00459"></a>00459           <span class="keywordflow">for</span>(som=0; som&lt;nb_som; som++)
<a name="l00460"></a>00460             {
<a name="l00461"></a>00461               solution(som)=vit_som(som,k);
<a name="l00462"></a>00462               secmemk(som)=secmem(som,k);
<a name="l00463"></a>00463             }
<a name="l00464"></a>00464 
<a name="l00465"></a>00465           solution.echange_espace_virtuel();
<a name="l00466"></a>00466           secmemk.echange_espace_virtuel();
<a name="l00467"></a>00467 
<a name="l00468"></a>00468 <span class="comment">// ON UTILISE LA MEME MATRICE EN SEQUENTIEL ET PARALLELE</span>
<a name="l00469"></a>00469 <span class="comment">// CE QUI PERMET D UTILISER UNE MATRICE BLOC QUAND ON APPELLE LE SOLVEUR NP</span>
<a name="l00470"></a>00470           solv.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmemk, solution);
<a name="l00471"></a>00471 
<a name="l00472"></a>00472           <span class="keywordflow">for</span>(som=0; som&lt;nb_som; som++)
<a name="l00473"></a>00473             vit_som(som,k)=solution(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som));
<a name="l00474"></a>00474         }
<a name="l00475"></a>00475     }
<a name="l00476"></a>00476 
<a name="l00477"></a>00477 <span class="comment">// Debog::verifier(&quot; verif vit_som 0 &quot; , vit_som);</span>
<a name="l00478"></a>00478   vit_som.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00479"></a>00479 <span class="comment">// Debog::verifier(&quot; verif vit_som 1 &quot; , vit_som);</span>
<a name="l00480"></a>00480 
<a name="l00481"></a>00481 <span class="comment">// {</span>
<a name="l00482"></a>00482 <span class="comment">// for(int k=0; k&lt;nb_comp; k++)</span>
<a name="l00483"></a>00483 <span class="comment">// for(int som=0; som&lt;nb_som; som++)</span>
<a name="l00484"></a>00484 <span class="comment">// Cerr &lt;&lt; k &lt;&lt; &quot; x &quot; &lt;&lt; coord(som,0)&lt;&lt; &quot; y &quot; &lt;&lt; coord(som,1) &lt;&lt; &quot; &quot; &lt;&lt; vit_som(som,k) &lt;&lt; finl;</span>
<a name="l00485"></a>00485 <span class="comment">// double psc=vit_som*vit_som;</span>
<a name="l00486"></a>00486 <span class="comment">// psc = Process::mp_sum(psc);</span>
<a name="l00487"></a>00487 <span class="comment">// Debog::verifier(&quot;norme : &quot;, psc);</span>
<a name="l00488"></a>00488 <span class="comment">// Cerr &lt;&lt; &quot;############ psc = &quot; &lt;&lt; psc &lt;&lt; finl;</span>
<a name="l00489"></a>00489 <span class="comment">// }</span>
<a name="l00490"></a>00490   <a class="code" href="classDebog.html#aa228f7e951ef67b9e9bb31ced928652f">Debog::verifier</a>(<span class="stringliteral">&quot; verif vit_som &quot;</span> , vit_som);
<a name="l00491"></a>00491   <span class="keywordflow">return</span> vit_som;
<a name="l00492"></a>00492 }
<a name="l00493"></a>00493 
<a name="l00494"></a><a class="code" href="Champ__P1NC__implementation_8cpp.html#a43bd8c6597e2da0d19e69fc180cd9477">00494</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="Champ__P1NC__implementation_8cpp.html#ae1e2fa7e95f53175d1fe9cf5741ba751" title="Projection du champ P1NC &quot;cha&quot; sur l&#39;espace des champs P1. Le resultat est stocke dans cha...">valeur_P1_L2</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>&amp; cha, <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom)
<a name="l00495"></a>00495 {
<a name="l00496"></a>00496   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; mazone = dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);
<a name="l00497"></a>00497   <span class="keywordtype">int</span> nb_elem_tot = mazone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00498"></a>00498   <span class="keywordtype">int</span> nb_som = mazone.<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
<a name="l00499"></a>00499   <span class="keywordtype">int</span> nb_som_elem = mazone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00500"></a>00500   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00501"></a>00501   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = cha.<a class="code" href="classChamp__Fonc__P1NC.html#a674957c0e83fe37a2fa94029917a439f">zone_vef</a>();
<a name="l00502"></a>00502   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_som = mazone.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00503"></a>00503   <span class="keywordtype">double</span> mijK, miiK;
<a name="l00504"></a>00504   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit_som=cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>();
<a name="l00505"></a>00505 
<a name="l00506"></a>00506   <span class="keywordtype">int</span> nb_comp=vit_som.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00507"></a>00507   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> secmem(cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>());
<a name="l00508"></a>00508   secmem=0.;
<a name="l00509"></a>00509 
<a name="l00510"></a>00510   <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
<a name="l00511"></a>00511     {
<a name="l00512"></a>00512       mijK=1./12.;
<a name="l00513"></a>00513       miiK= 1./6.;
<a name="l00514"></a>00514     }
<a name="l00515"></a>00515   <span class="keywordflow">else</span>
<a name="l00516"></a>00516     {
<a name="l00517"></a>00517       mijK=1./18.;
<a name="l00518"></a>00518       miiK= 1./12.;
<a name="l00519"></a>00519     }
<a name="l00520"></a>00520 
<a name="l00521"></a>00521 <span class="comment">// dans le cas d&#39;une zone nulle on doit effectuer le dimensionnement</span>
<a name="l00522"></a>00522 <span class="comment">// mais une seule fois</span>
<a name="l00523"></a>00523   <span class="keywordtype">double</span> non_prepare=0;
<a name="l00524"></a>00524   <span class="keywordflow">if</span> (cha.<a class="code" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">MatP1NC2P1_L2</a>.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() &lt;2)
<a name="l00525"></a>00525     non_prepare=1;
<a name="l00526"></a>00526   non_prepare=<a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_min</a>(non_prepare);
<a name="l00527"></a>00527   <span class="keywordflow">if</span> (non_prepare==1)
<a name="l00528"></a>00528     {
<a name="l00529"></a>00529 <span class="comment">// Initialisation du solveur</span>
<a name="l00530"></a>00530       <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>, (cha.<a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>));
<a name="l00531"></a>00531       <a class="code" href="classLecFicDiffuse.html" title="Cette classe implemente les operateurs et les methodes virtuelles de la classe EFichier de la facon s...">LecFicDiffuse</a> fic;
<a name="l00532"></a>00532       fic.<a class="code" href="classLecFicDiffuse.html#a2e4f3199de5e1b47edcffc68952c7be8" title="Ouverture du fichier. Cette methode doit etre appelee par tous les processeurs du groupe...">ouvrir</a>(<span class="stringliteral">&quot;solveur.bar&quot;</span>);
<a name="l00533"></a>00533       <span class="keywordflow">if</span>(fic.<a class="code" href="classLec__Diffuse__base.html#a0d28f6309b5b0d97b3bd0ad8309aec61">good</a>())
<a name="l00534"></a>00534         {
<a name="l00535"></a>00535           fic &gt;&gt; solv;
<a name="l00536"></a>00536           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot;solveur.bar ouvert pour lire: &quot;</span> &lt;&lt; solv &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00537"></a>00537         }
<a name="l00538"></a>00538       solv-&gt;reinit();
<a name="l00539"></a>00539 
<a name="l00540"></a>00540       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;On remplit la matrice cha.MatP1NC2P1_L2 pour le champ &quot;</span>&lt;&lt; cha.<a class="code" href="classField__base.html#ae1377124eabe8387aced762115b062bb" title="Renvoie le nom du champ.">le_nom</a>() &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00541"></a>00541       <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; mat=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, (cha.<a class="code" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">MatP1NC2P1_L2</a>));
<a name="l00542"></a>00542       <span class="keywordtype">int</span> rang;
<a name="l00543"></a>00543       <span class="keywordtype">int</span> nnz=0;
<a name="l00544"></a>00544       <a class="code" href="classIntLists.html" title="Un tableau de listes de type IntList.">IntLists</a> voisins(nb_som);
<a name="l00545"></a>00545       <a class="code" href="classDoubleLists.html" title="Un tableau de listes de type DoubleList.">DoubleLists</a> coeffs(nb_som);
<a name="l00546"></a>00546       <a class="code" href="classDoubleVect.html">DoubleVect</a> diag(nb_som);
<a name="l00547"></a>00547       <span class="keywordtype">int</span> elem;
<a name="l00548"></a>00548       <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00549"></a>00549         {
<a name="l00550"></a>00550           <span class="keywordtype">double</span> coeff_ij=mijK*zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem);
<a name="l00551"></a>00551           <span class="keywordtype">double</span> coeff_ii=miiK*zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem);
<a name="l00552"></a>00552           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_elem; isom++)
<a name="l00553"></a>00553             {
<a name="l00554"></a>00554               <span class="keywordtype">int</span> som=elem_som(elem,isom);
<a name="l00555"></a>00555               <span class="keywordtype">int</span> ii=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l00556"></a>00556               diag[ii]+=coeff_ii;
<a name="l00557"></a>00557               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jsom=isom+1; jsom&lt;nb_som_elem; jsom++)
<a name="l00558"></a>00558                 {
<a name="l00559"></a>00559                   <span class="keywordtype">int</span> asom=elem_som(elem,jsom);
<a name="l00560"></a>00560                   <span class="keywordtype">int</span> j=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(asom);
<a name="l00561"></a>00561                   <span class="keywordtype">int</span> i=ii;
<a name="l00562"></a>00562                   <span class="keywordflow">if</span>(i&gt;j)
<a name="l00563"></a>00563                     {
<a name="l00564"></a>00564                       <span class="keywordtype">int</span> k=j;
<a name="l00565"></a>00565                       j=i;
<a name="l00566"></a>00566                       i=k;
<a name="l00567"></a>00567                     }
<a name="l00568"></a>00568                   rang=voisins[i].rang(j);
<a name="l00569"></a>00569                   <span class="keywordflow">if</span>(rang==-1)
<a name="l00570"></a>00570                     {
<a name="l00571"></a>00571                       voisins[i].add(j);
<a name="l00572"></a>00572                       coeffs[i].add(coeff_ij);
<a name="l00573"></a>00573                       nnz++;
<a name="l00574"></a>00574                     }
<a name="l00575"></a>00575                   <span class="keywordflow">else</span>
<a name="l00576"></a>00576                     {
<a name="l00577"></a>00577                       coeffs[i][rang]+=coeff_ij;
<a name="l00578"></a>00578                     }
<a name="l00579"></a>00579                 }
<a name="l00580"></a>00580             }
<a name="l00581"></a>00581         }
<a name="l00582"></a>00582 
<a name="l00583"></a>00583 
<a name="l00584"></a>00584       {
<a name="l00585"></a>00585         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som; i++)
<a name="l00586"></a>00586           <span class="keywordflow">if</span>(diag(i)==0)
<a name="l00587"></a>00587             diag(i)=1.;
<a name="l00588"></a>00588       }
<a name="l00589"></a>00589 
<a name="l00590"></a>00590       mat.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nb_som, nnz+nb_som) ;
<a name="l00591"></a>00591       mat.<a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">remplir</a>(voisins, coeffs, diag) ;
<a name="l00592"></a>00592       mat.<a class="code" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69" title="Suppression des doublons on ordonne tab2; Verification de la diagonale: tous ses elements doivent etr...">compacte</a>() ;
<a name="l00593"></a>00593       mat.<a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(1);
<a name="l00594"></a>00594 
<a name="l00595"></a>00595 <span class="comment">// Modif CD 15/04/03 pour paralleliser le filtrage</span>
<a name="l00596"></a>00596 <span class="comment">// On copie la matrice remplie ci-dessus dans une matrice bloc.</span>
<a name="l00597"></a>00597 <span class="comment">// Cette modification permet d&#39;utiliser le preconditionnement SSOR</span>
<a name="l00598"></a>00598 
<a name="l00599"></a>00599 <span class="comment">// On fait aussi la transformation en matrice bloc en sequentiel car sinon</span>
<a name="l00600"></a>00600 <span class="comment">// probleme avec NP</span>
<a name="l00601"></a>00601 
<a name="l00602"></a>00602       cha.<a class="code" href="classChamp__P1NC__implementation.html#a5badd5dee68ffbd7e63228509fe1cb18">dimensionner_Mat_Bloc_Morse_Sym</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>);
<a name="l00603"></a>00603       cha.<a class="code" href="classChamp__P1NC__implementation.html#a80e98cf9dfa018d6f3d18608924c8d57">Mat_Morse_to_Mat_Bloc</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>);
<a name="l00604"></a>00604 
<a name="l00605"></a>00605 <span class="comment">// Fin Modif CD 15/04/03</span>
<a name="l00606"></a>00606 
<a name="l00607"></a>00607 <span class="comment">// mat.imprimer_formatte(Cerr);</span>
<a name="l00608"></a>00608 <span class="comment">// Cerr&lt;&lt;&quot;zone.nb_som_tot() = &quot;&lt;&lt;mazone.nb_som_tot()&lt;&lt;&quot;, zone.nb_som() = &quot;&lt;&lt;mazone.nb_som()&lt;&lt;finl;</span>
<a name="l00609"></a>00609 <span class="comment">// Cerr &lt;&lt; &quot;Matrice de filtrage OK&quot; &lt;&lt; finl;</span>
<a name="l00610"></a>00610 <span class="comment">// Cout &lt;&lt; &quot;Matrice de masse P1 : &quot; &lt;&lt; finl;</span>
<a name="l00611"></a>00611 <span class="comment">// mat.imprimer(Cout) &lt;&lt; finl;</span>
<a name="l00612"></a>00612     }
<a name="l00613"></a>00613 
<a name="l00614"></a>00614 <span class="comment">// Debog::verifier(&quot; verif champ &quot; , ch);</span>
<a name="l00615"></a>00615 
<a name="l00616"></a>00616   <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
<a name="l00617"></a>00617   <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
<a name="l00618"></a>00618     coeff=1./6.;
<a name="l00619"></a>00619   <span class="keywordflow">else</span>
<a name="l00620"></a>00620     coeff=1./12.;
<a name="l00621"></a>00621 
<a name="l00622"></a>00622   <span class="keywordtype">int</span> nb_faces=zone_VEF.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
<a name="l00623"></a>00623   <span class="keywordtype">int</span> nb_faces_tot=zone_VEF.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
<a name="l00624"></a>00624   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> virtfait(nb_faces_tot-nb_faces);
<a name="l00625"></a>00625   <span class="keywordtype">int</span> nb_som_face=zone_VEF.<a class="code" href="classZone__VF.html#a990808f967f351edbb83ff11d60b7445" title="renvoie le nombre de sommets par face. Rque : on a suppose que toutes les faces avait le meme nombre ...">nb_som_face</a>();
<a name="l00626"></a>00626   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l00627"></a>00627   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins=zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00628"></a>00628   <span class="keywordtype">int</span> face;
<a name="l00629"></a>00629 
<a name="l00630"></a>00630   <span class="keywordflow">for</span>(face=0; face&lt;nb_faces_tot; face++)
<a name="l00631"></a>00631     {
<a name="l00632"></a>00632       <span class="keywordtype">int</span> indvirtface=face-nb_faces;
<a name="l00633"></a>00633 <span class="comment">// on regarde si la face virtuelle n&#39;a pas deja ete traitee</span>
<a name="l00634"></a>00634       <span class="keywordflow">if</span> (indvirtface&gt;=0)
<a name="l00635"></a>00635         <span class="keywordflow">if</span> (virtfait[indvirtface]==1) <span class="keywordflow">continue</span>;
<a name="l00636"></a>00636 
<a name="l00637"></a>00637       <span class="keywordtype">int</span> elem1=face_voisins(face,0);
<a name="l00638"></a>00638       <span class="keywordtype">int</span> elem2=face_voisins(face,1);
<a name="l00639"></a>00639       <span class="keywordtype">double</span> volume=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem1);
<a name="l00640"></a>00640       <span class="keywordflow">if</span>(elem2!=-1)
<a name="l00641"></a>00641         volume+=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem2);
<a name="l00642"></a>00642       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
<a name="l00643"></a>00643         {
<a name="l00644"></a>00644           <span class="keywordtype">int</span> som=face_sommets(face,isom);
<a name="l00645"></a>00645           <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l00646"></a>00646 <span class="comment">// Pour un sommet periodique on ne retient qu une seule contribution</span>
<a name="l00647"></a>00647 <span class="comment">// pour deux faces en vis a vis</span>
<a name="l00648"></a>00648           <span class="keywordflow">if</span> (som1==som)
<a name="l00649"></a>00649             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
<a name="l00650"></a>00650               secmem(som1,k)+=coeff*volume*ch(face,k);
<a name="l00651"></a>00651         }
<a name="l00652"></a>00652     }
<a name="l00653"></a>00653 
<a name="l00654"></a>00654   secmem.echange_espace_virtuel();
<a name="l00655"></a>00655 <span class="comment">// Debog::verifier(&quot; verif secmem_ech &quot; , secmem);</span>
<a name="l00656"></a>00656 
<a name="l00657"></a>00657   <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>, cha.<a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>);
<a name="l00658"></a>00658   <a class="code" href="classDoubleVect.html">DoubleVect</a> secmemk(cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>());
<a name="l00659"></a>00659   <a class="code" href="classDoubleVect.html">DoubleVect</a> solution(cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>());
<a name="l00660"></a>00660 
<a name="l00661"></a>00661   <span class="keywordflow">if</span>(nb_comp==1)
<a name="l00662"></a>00662     {
<a name="l00663"></a>00663       solution=vit_som;
<a name="l00664"></a>00664       secmem.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00665"></a>00665       <a class="code" href="classDebog.html#aa228f7e951ef67b9e9bb31ced928652f">Debog::verifier</a>(<span class="stringliteral">&quot; verif secmem &quot;</span> , secmem);
<a name="l00666"></a>00666 
<a name="l00667"></a>00667 
<a name="l00668"></a>00668 <span class="comment">// ON UTILISE LA MEME MATRICE EN SEQUENTIEL ET PARALLELE</span>
<a name="l00669"></a>00669 <span class="comment">// CE QUI PERMET D UTILISER UNE MATRICE BLOC QUAND ON APPELLE LE SOLVEUR NP</span>
<a name="l00670"></a>00670       solv.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmem, solution);
<a name="l00671"></a>00671 
<a name="l00672"></a>00672       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> som=0; som&lt;nb_som; som++)
<a name="l00673"></a>00673         vit_som(som)=solution(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som));
<a name="l00674"></a>00674     }
<a name="l00675"></a>00675   <span class="keywordflow">else</span>
<a name="l00676"></a>00676     {
<a name="l00677"></a>00677       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
<a name="l00678"></a>00678         {
<a name="l00679"></a>00679           <span class="keywordtype">int</span> som;
<a name="l00680"></a>00680           <span class="keywordflow">for</span>(som=0; som&lt;nb_som; som++)
<a name="l00681"></a>00681             {
<a name="l00682"></a>00682               solution(som)=vit_som(som,k);
<a name="l00683"></a>00683               secmemk(som)=secmem(som,k);
<a name="l00684"></a>00684             }
<a name="l00685"></a>00685 
<a name="l00686"></a>00686           solution.echange_espace_virtuel();
<a name="l00687"></a>00687           secmemk.echange_espace_virtuel();
<a name="l00688"></a>00688 
<a name="l00689"></a>00689 <span class="comment">// ON UTILISE LA MEME MATRICE EN SEQUENTIEL ET PARALLELE</span>
<a name="l00690"></a>00690 <span class="comment">// CE QUI PERMET D UTILISER UNE MATRICE BLOC QUAND ON APPELLE LE SOLVEUR NP</span>
<a name="l00691"></a>00691           solv.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmemk, solution);
<a name="l00692"></a>00692 
<a name="l00693"></a>00693           <span class="keywordflow">for</span>(som=0; som&lt;nb_som; som++)
<a name="l00694"></a>00694             vit_som(som,k)=solution(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som));
<a name="l00695"></a>00695         }
<a name="l00696"></a>00696     }
<a name="l00697"></a>00697 
<a name="l00698"></a>00698 <span class="comment">// Debog::verifier(&quot; verif vit_som 0 &quot; , vit_som);</span>
<a name="l00699"></a>00699   vit_som.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00700"></a>00700 <span class="comment">// Debog::verifier(&quot; verif vit_som 1 &quot; , vit_som);</span>
<a name="l00701"></a>00701 
<a name="l00702"></a>00702 <span class="comment">// {</span>
<a name="l00703"></a>00703 <span class="comment">// for(int k=0; k&lt;nb_comp; k++)</span>
<a name="l00704"></a>00704 <span class="comment">// for(int som=0; som&lt;nb_som; som++)</span>
<a name="l00705"></a>00705 <span class="comment">// Cerr &lt;&lt; k &lt;&lt; &quot; x &quot; &lt;&lt; coord(som,0)&lt;&lt; &quot; y &quot; &lt;&lt; coord(som,1) &lt;&lt; &quot; &quot; &lt;&lt; vit_som(som,k) &lt;&lt; finl;</span>
<a name="l00706"></a>00706 <span class="comment">// double psc=vit_som*vit_som;</span>
<a name="l00707"></a>00707 <span class="comment">// psc = Process::mp_sum(psc);</span>
<a name="l00708"></a>00708 <span class="comment">// Debog::verifier(&quot;norme : &quot;, psc);</span>
<a name="l00709"></a>00709 <span class="comment">// Cerr &lt;&lt; &quot;############ psc = &quot; &lt;&lt; psc &lt;&lt; finl;</span>
<a name="l00710"></a>00710 <span class="comment">// }</span>
<a name="l00711"></a>00711   <a class="code" href="classDebog.html#aa228f7e951ef67b9e9bb31ced928652f">Debog::verifier</a>(<span class="stringliteral">&quot; verif vit_som &quot;</span> , vit_som);
<a name="l00712"></a>00712   <span class="keywordflow">return</span> vit_som;
<a name="l00713"></a>00713 }
<a name="l00714"></a>00714 
<a name="l00715"></a>00715 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;
<a name="l00716"></a><a class="code" href="Champ__P1NC__implementation_8cpp.html#a0e22cdb4dfb563f9623c36837500dc95">00716</a> <a class="code" href="Champ__P1NC__implementation_8cpp.html#a0e22cdb4dfb563f9623c36837500dc95">valeur_P1_H1</a>(<span class="keyword">const</span> <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha,
<a name="l00717"></a>00717              <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,
<a name="l00718"></a>00718              <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch_som)
<a name="l00719"></a>00719 {
<a name="l00720"></a>00720   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);
<a name="l00721"></a>00721   <span class="keywordtype">int</span> nb_elem_tot = zone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00722"></a>00722   <span class="keywordtype">int</span> nb_som = zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();
<a name="l00723"></a>00723   <span class="keywordtype">int</span> nb_som_elem = zone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00724"></a>00724   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00725"></a>00725   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = cha.<a class="code" href="classChamp__P1NC.html#a122a5f097bee0c82357ab77ab23e0068">zone_vef</a>();
<a name="l00726"></a>00726   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; normales=zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00727"></a>00727   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>, cha.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00728"></a>00728   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_som = zone.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00729"></a>00729   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00730"></a>00730   <span class="keywordtype">double</span> mijK;
<a name="l00731"></a>00731   <span class="keywordtype">int</span> nb_comp=ch_som.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00732"></a>00732   <span class="keywordtype">int</span> dimension=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00733"></a>00733 
<a name="l00734"></a>00734   <span class="keywordflow">if</span>(dimension==2)
<a name="l00735"></a>00735     {
<a name="l00736"></a>00736       mijK=1./4.;
<a name="l00737"></a>00737     }
<a name="l00738"></a>00738   <span class="keywordflow">else</span>
<a name="l00739"></a>00739     {
<a name="l00740"></a>00740       mijK=1./9.;
<a name="l00741"></a>00741     }
<a name="l00742"></a>00742 
<a name="l00743"></a>00743   <span class="keywordtype">int</span> elem;
<a name="l00744"></a>00744   <span class="keywordtype">int</span> n_bord;
<a name="l00745"></a>00745   <span class="keyword">static</span> <span class="keywordtype">double</span> diag_ref;
<a name="l00746"></a>00746   <span class="keywordtype">double</span> non_prepare=0;
<a name="l00747"></a>00747   <span class="keywordflow">if</span> ( cha.<a class="code" href="classChamp__P1NC__implementation.html#aaa41328eec002384f541c9de9a4891b2">MatP1NC2P1_H1</a>.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() &lt;2 )
<a name="l00748"></a>00748     non_prepare=1;
<a name="l00749"></a>00749   non_prepare=<a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_min</a>(non_prepare);
<a name="l00750"></a>00750   <span class="keywordflow">if</span> (non_prepare==1)
<a name="l00751"></a>00751     {
<a name="l00752"></a>00752       <a class="code" href="classEFichier.html" title="Fichier en lecture Cette classe est a la classe C++ ifstream ce que la classe Entree est a la classe ...">EFichier</a> fic;
<a name="l00753"></a>00753       <span class="keywordflow">if</span>(fic.<a class="code" href="classEntree__Fichier__base.html#a8e34b235668e94f335cc9ab18dd4e427">ouvrir</a>(<span class="stringliteral">&quot;solveur.bar&quot;</span>))
<a name="l00754"></a>00754         {
<a name="l00755"></a>00755           <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>,cha.<a class="code" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">solveur_H1</a>);
<a name="l00756"></a>00756           fic &gt;&gt; solv;
<a name="l00757"></a>00757         }
<a name="l00758"></a>00758       <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; mat=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,cha.<a class="code" href="classChamp__P1NC__implementation.html#aaa41328eec002384f541c9de9a4891b2">MatP1NC2P1_H1</a>);
<a name="l00759"></a>00759       <span class="keywordtype">int</span> rang;
<a name="l00760"></a>00760       <span class="keywordtype">int</span> nnz=0;
<a name="l00761"></a>00761       <a class="code" href="classIntLists.html" title="Un tableau de listes de type IntList.">IntLists</a> voisins(nb_som);
<a name="l00762"></a>00762       <a class="code" href="classDoubleLists.html" title="Un tableau de listes de type DoubleList.">DoubleLists</a> coeffs(nb_som);
<a name="l00763"></a>00763       <a class="code" href="classDoubleVect.html">DoubleVect</a> diag(nb_som);
<a name="l00764"></a>00764       <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00765"></a>00765         {
<a name="l00766"></a>00766           <span class="keywordtype">double</span> volume=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem);
<a name="l00767"></a>00767           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_elem; isom++)
<a name="l00768"></a>00768             {
<a name="l00769"></a>00769               <span class="keywordtype">int</span> facei=elem_faces(elem,isom);
<a name="l00770"></a>00770               <span class="keywordtype">int</span> i=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(elem_som(elem,isom));
<a name="l00771"></a>00771               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jsom=isom+1; jsom&lt;nb_som_elem; jsom++)
<a name="l00772"></a>00772                 {
<a name="l00773"></a>00773                   <span class="keywordtype">int</span> facej=elem_faces(elem,jsom);
<a name="l00774"></a>00774                   <span class="keywordtype">int</span> j=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(elem_som(elem,jsom));
<a name="l00775"></a>00775                   <span class="keywordtype">double</span> coeffij=0.0;
<a name="l00776"></a>00776                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;dimension; k++)
<a name="l00777"></a>00777                     coeffij+=normales(facei,k)*normales(facej,k);
<a name="l00778"></a>00778 
<a name="l00779"></a>00779                   coeffij*=zone_VEF.<a class="code" href="classZone__VEF.html#a5c3e9d7f89d87989e338f5d725853e48">oriente_normale</a>(facei,elem)*
<a name="l00780"></a>00780                            zone_VEF.<a class="code" href="classZone__VEF.html#a5c3e9d7f89d87989e338f5d725853e48">oriente_normale</a>(facej,elem);
<a name="l00781"></a>00781                   coeffij*=mijK/volume;
<a name="l00782"></a>00782                   <span class="keywordtype">int</span> ii=i, jj=j;
<a name="l00783"></a>00783                   <span class="keywordflow">if</span>(ii&gt;jj)
<a name="l00784"></a>00784                     {
<a name="l00785"></a>00785                       <span class="keywordtype">int</span> tmp=ii;
<a name="l00786"></a>00786                       ii=jj;
<a name="l00787"></a>00787                       jj=tmp;
<a name="l00788"></a>00788                     }
<a name="l00789"></a>00789                   rang=voisins[ii].rang(jj);
<a name="l00790"></a>00790                   <span class="keywordflow">if</span>(rang==-1)
<a name="l00791"></a>00791                     {
<a name="l00792"></a>00792                       voisins[ii].add(jj);
<a name="l00793"></a>00793                       coeffs[ii].add(coeffij);
<a name="l00794"></a>00794                       nnz++;
<a name="l00795"></a>00795                     }
<a name="l00796"></a>00796                   <span class="keywordflow">else</span>
<a name="l00797"></a>00797                     {
<a name="l00798"></a>00798                       coeffs[ii][rang]+=coeffij;
<a name="l00799"></a>00799                     }
<a name="l00800"></a>00800                   diag[ii]-=coeffij;
<a name="l00801"></a>00801                   diag[jj]-=coeffij;
<a name="l00802"></a>00802                 }
<a name="l00803"></a>00803             }
<a name="l00804"></a>00804         }
<a name="l00805"></a>00805       diag_ref=diag(0);
<a name="l00806"></a>00806       <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00807"></a>00807         {
<a name="l00808"></a>00808 <span class="comment">// for n_bord</span>
<a name="l00809"></a>00809           <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00810"></a>00810           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00811"></a>00811           <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00812"></a>00812           <span class="keywordtype">int</span> num2 = num1 + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00813"></a>00813 
<a name="l00814"></a>00814           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=num1; face&lt;num2; face++)
<a name="l00815"></a>00815             {
<a name="l00816"></a>00816               elem=zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(face,0);
<a name="l00817"></a>00817               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;dimension; isom++)
<a name="l00818"></a>00818                 {
<a name="l00819"></a>00819                   <span class="keywordtype">int</span> som=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,isom);
<a name="l00820"></a>00820                   som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l00821"></a>00821                   diag[som]=1.e1*diag_ref;
<a name="l00822"></a>00822                 }
<a name="l00823"></a>00823             }
<a name="l00824"></a>00824         }
<a name="l00825"></a>00825 
<a name="l00826"></a>00826       mat.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nb_som, nnz+nb_som) ;
<a name="l00827"></a>00827       mat.<a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">remplir</a>(voisins, coeffs, diag) ;
<a name="l00828"></a>00828       mat.<a class="code" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69" title="Suppression des doublons on ordonne tab2; Verification de la diagonale: tous ses elements doivent etr...">compacte</a>() ;
<a name="l00829"></a>00829       mat.<a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(1);
<a name="l00830"></a>00830 <span class="comment">// Cerr &lt;&lt; &quot;Matrice de filtrage OK&quot; &lt;&lt; finl;</span>
<a name="l00831"></a>00831 <span class="comment">// Cerr &lt;&lt; &quot;Matrice de Laplacien P1 : &quot; &lt;&lt; finl;</span>
<a name="l00832"></a>00832 <span class="comment">// mat.imprimer(Cerr) &lt;&lt; finl;</span>
<a name="l00833"></a>00833     }
<a name="l00834"></a>00834 
<a name="l00835"></a>00835 
<a name="l00836"></a>00836   <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>=-1./dimension;
<a name="l00837"></a>00837   <span class="keywordtype">int</span> k;
<a name="l00838"></a>00838   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l00839"></a>00839     {
<a name="l00840"></a>00840 <span class="comment">// for comp</span>
<a name="l00841"></a>00841       <a class="code" href="classDoubleVect.html">DoubleVect</a> secmem(nb_som);
<a name="l00842"></a>00842       <a class="code" href="classDoubleVect.html">DoubleVect</a> solution(nb_som);
<a name="l00843"></a>00843       <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00844"></a>00844         {
<a name="l00845"></a>00845 <span class="comment">// for elem</span>
<a name="l00846"></a>00846           <span class="keywordtype">double</span> volume=zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem);
<a name="l00847"></a>00847           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_elem; isom++)
<a name="l00848"></a>00848             {
<a name="l00849"></a>00849               <span class="keywordtype">int</span> facei=elem_faces(elem,isom);
<a name="l00850"></a>00850               <span class="keywordtype">int</span> i=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(elem_som(elem,isom));
<a name="l00851"></a>00851               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jsom=0; jsom&lt;nb_som_elem; jsom++)
<a name="l00852"></a>00852                 {
<a name="l00853"></a>00853                   <span class="keywordtype">int</span> facej=elem_faces(elem,jsom);
<a name="l00854"></a>00854                   <span class="keywordtype">double</span> coeffij=0;
<a name="l00855"></a>00855                   <span class="keywordflow">for</span>(k=0; k&lt;dimension; k++)
<a name="l00856"></a>00856                     coeffij+=normales(facei,k)*normales(facej,k);
<a name="l00857"></a>00857                   coeffij*=zone_VEF.<a class="code" href="classZone__VEF.html#a5c3e9d7f89d87989e338f5d725853e48">oriente_normale</a>(facei,elem)*
<a name="l00858"></a>00858                            zone_VEF.<a class="code" href="classZone__VEF.html#a5c3e9d7f89d87989e338f5d725853e48">oriente_normale</a>(facej,elem);
<a name="l00859"></a>00859                   coeffij*=coeff/volume;
<a name="l00860"></a>00860                   secmem(i)+=coeffij*ch(facej,comp);
<a name="l00861"></a>00861                 }
<a name="l00862"></a>00862             }
<a name="l00863"></a>00863         }
<a name="l00864"></a>00864       <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00865"></a>00865         {
<a name="l00866"></a>00866 <span class="comment">// for n_bord</span>
<a name="l00867"></a>00867           <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00868"></a>00868           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00869"></a>00869           <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00870"></a>00870           <span class="keywordtype">int</span> num2 = num1 + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00871"></a>00871 
<a name="l00872"></a>00872           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=num1; face&lt;num2; face++)
<a name="l00873"></a>00873             {
<a name="l00874"></a>00874               elem=zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(face,0);
<a name="l00875"></a>00875               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;dimension; isom++)
<a name="l00876"></a>00876                 {
<a name="l00877"></a>00877                   <span class="keywordtype">int</span> som=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,isom);
<a name="l00878"></a>00878                   som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l00879"></a>00879                   secmem(som)=1.e1*diag_ref* cha.<a class="code" href="classChamp__P1NC.html#a099c50c4dd167411656183422b0fe120">valeur_a_sommet_compo</a>(som, elem, comp);
<a name="l00880"></a>00880                 }
<a name="l00881"></a>00881             }
<a name="l00882"></a>00882         }
<a name="l00883"></a>00883 
<a name="l00884"></a>00884       <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>,cha.<a class="code" href="classChamp__P1NC__implementation.html#ab63e935fdf162acb323dcfa263b88282">solveur_H1</a>);
<a name="l00885"></a>00885       solv.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#aaa41328eec002384f541c9de9a4891b2">MatP1NC2P1_H1</a>, secmem, solution);
<a name="l00886"></a>00886 
<a name="l00887"></a>00887       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> som=0; som&lt;nb_som; som++)
<a name="l00888"></a>00888         ch_som(som,comp)=solution(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som));
<a name="l00889"></a>00889 
<a name="l00890"></a>00890     }
<a name="l00891"></a>00891 
<a name="l00892"></a>00892   <span class="keywordflow">return</span> ch_som;
<a name="l00893"></a>00893 }
<a name="l00894"></a>00894 
<a name="l00895"></a><a class="code" href="classChamp__P1NC__implementation.html#aad8fd6dedb1f6f558e0c311df0b0db1d">00895</a> <span class="keywordtype">void</span> <a class="code" href="classChamp__P1NC__implementation.html#aad8fd6dedb1f6f558e0c311df0b0db1d">Champ_P1NC_implementation::filtrer_H1</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; valeurs)<span class="keyword"> const</span>
<a name="l00896"></a>00896 <span class="keyword"></span>{
<a name="l00897"></a>00897 <span class="comment">// Cerr &lt;&lt; &quot;Champ_P1NC_implementation::filtrer&quot; &lt;&lt; finl;</span>
<a name="l00898"></a>00898   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l00899"></a>00899   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classChamp__P1NC__implementation.html#aa8d54a9e9a1aaed9408860d97043122a">test</a>=1;
<a name="l00900"></a>00900   <span class="keywordflow">if</span>(!test)
<a name="l00901"></a>00901     {
<a name="l00902"></a>00902       test=1;
<a name="l00903"></a>00903       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> xv=zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00904"></a>00904       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;TEST filtrer_H1 solution = &quot;</span> &lt;&lt; <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(xv) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00905"></a>00905       <a class="code" href="classChamp__P1NC__implementation.html#aad8fd6dedb1f6f558e0c311df0b0db1d">filtrer_H1</a>(xv);
<a name="l00906"></a>00906       xv-=zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00907"></a>00907       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;TEST filtrer_H1 erreur = &quot;</span> &lt;&lt; <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(xv) &lt;&lt; finl;
<a name="l00908"></a>00908       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;err = &quot;</span> &lt;&lt; xv
<a name="l00909"></a>00909            &lt;&lt; <span class="stringliteral">&quot;zone_VEF.xv() &quot;</span> &lt;&lt; zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>() &lt;&lt; finl;
<a name="l00910"></a>00910       xv=1.;
<a name="l00911"></a>00911       <a class="code" href="classChamp__P1NC__implementation.html#aad8fd6dedb1f6f558e0c311df0b0db1d">filtrer_H1</a>(xv);
<a name="l00912"></a>00912       xv-=1.;
<a name="l00913"></a>00913       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;erreur sur les constantes : &quot;</span> &lt;&lt; <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(xv) &lt;&lt; finl;
<a name="l00914"></a>00914     }
<a name="l00915"></a>00915   <span class="keywordtype">int</span> nb_som= zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
<a name="l00916"></a>00916   <span class="keywordtype">int</span> nb_faces=valeurs.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00917"></a>00917   <span class="keyword">const</span> <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha_const =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
<a name="l00918"></a>00918   <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,cha_const);
<a name="l00919"></a>00919   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> valeurs_fac(cha.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>());
<a name="l00920"></a>00920   cha.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>()=valeurs;
<a name="l00921"></a>00921   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=valeurs.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00922"></a>00922   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vit_som(nb_som, nb_comp);
<a name="l00923"></a>00923   <a class="code" href="classChamp__P1NC__implementation.html#a0b97339eaa2d6e03698b5cb38cccc829">valeur_P1_H1</a>(cha, cha.<a class="code" href="classChamp__Inc__base.html#a7804397c01b31d542be6a6c8af968b9b">domaine</a>(), vit_som);
<a name="l00924"></a>00924   cha.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>()=valeurs_fac;
<a name="l00925"></a>00925   <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>= 1./<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00926"></a>00926 
<a name="l00927"></a>00927   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> face=0; face&lt;nb_faces; face++)
<a name="l00928"></a>00928     {
<a name="l00929"></a>00929       <span class="keywordtype">int</span> s1=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,0);
<a name="l00930"></a>00930       <span class="keywordtype">int</span> s2=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,1);
<a name="l00931"></a>00931       <span class="keywordtype">int</span> s3=-1;
<a name="l00932"></a>00932       <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
<a name="l00933"></a>00933         s3=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,2);
<a name="l00934"></a>00934       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l00935"></a>00935         {
<a name="l00936"></a>00936           <span class="keywordtype">double</span> somme=0;
<a name="l00937"></a>00937           somme+=(vit_som(s1,comp)+vit_som(s2,comp));
<a name="l00938"></a>00938           <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
<a name="l00939"></a>00939             somme+=vit_som(s3,comp);
<a name="l00940"></a>00940           valeurs(face, comp)=coeff*somme;
<a name="l00941"></a>00941         }
<a name="l00942"></a>00942     }
<a name="l00943"></a>00943 }
<a name="l00944"></a>00944 
<a name="l00945"></a><a class="code" href="classChamp__P1NC__implementation.html#ab18ebd7f3cd91fb4e4db5cc8bf937ab3">00945</a> <span class="keywordtype">void</span> <a class="code" href="classChamp__P1NC__implementation.html#ab18ebd7f3cd91fb4e4db5cc8bf937ab3">Champ_P1NC_implementation::filtrer_L2</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; valeurs)<span class="keyword"> const</span>
<a name="l00946"></a>00946 <span class="keyword"></span>{
<a name="l00947"></a>00947   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l00948"></a>00948   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00949"></a>00949   <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>= 1./<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00950"></a>00950 <span class="comment">// int nb_som= zone_VEF.zone().nb_som_tot();</span>
<a name="l00951"></a>00951   <span class="keywordtype">int</span> nb_faces=valeurs.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
<a name="l00952"></a>00952   <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha = <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
<a name="l00953"></a>00953   <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,cha) &amp;&amp; (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,cha)))
<a name="l00954"></a>00954     {
<a name="l00955"></a>00955       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;on ne doit pas filtre_L2 des champs qui ne sont pas de type P1NC&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00956"></a>00956       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00957"></a>00957     }
<a name="l00958"></a>00958 
<a name="l00959"></a>00959   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=valeurs.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00960"></a>00960 
<a name="l00961"></a>00961   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,cha))
<a name="l00962"></a>00962     {
<a name="l00963"></a>00963       <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; ch_inc_P1NC = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,cha);
<a name="l00964"></a>00964 
<a name="l00965"></a>00965       <span class="keywordflow">if</span> (ch_inc_P1NC.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a65e9b2520ac7b42444e4d9aa4f18ccf7" title="Renvoie le nom de l&#39;equation.">le_nom</a>()!=<span class="stringliteral">&quot;gradient_pression&quot;</span>)
<a name="l00966"></a>00966         {
<a name="l00967"></a>00967           <span class="keyword">const</span> <a class="code" href="classRef__Objet__U.html">RefObjU</a>&amp; modele_turbulence = ch_inc_P1NC.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#ab0bb5d06bdc91e131dc9d5f9d7b57095">get_modele</a>(<a class="code" href="Equation__base_8h.html#a2c9d34b2cc47e5b2b18347de20a77db5a0fecbd75e0b8b4c37ffd696e173a14c7">TURBULENCE</a>);
<a name="l00968"></a>00968           <span class="keywordflow">if</span> (modele_turbulence.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>() &amp;&amp; <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classMod__turb__hyd__base.html" title="Classe Mod_turb_hyd_base Cette classe sert de base a la hierarchie des classes qui representent un mo...">Mod_turb_hyd_base</a>,modele_turbulence.<a class="code" href="classRef__Objet__U.html#ad875112c0fd275aa0c0aa710481ab11e">valeur</a>()))
<a name="l00969"></a>00969             {
<a name="l00970"></a>00970               <span class="keyword">const</span> <a class="code" href="classMod__turb__hyd__base.html" title="Classe Mod_turb_hyd_base Cette classe sert de base a la hierarchie des classes qui representent un mo...">Mod_turb_hyd_base</a>&amp; mod_turb = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMod__turb__hyd__base.html" title="Classe Mod_turb_hyd_base Cette classe sert de base a la hierarchie des classes qui representent un mo...">Mod_turb_hyd_base</a>,modele_turbulence.<a class="code" href="classRef__Objet__U.html#ad875112c0fd275aa0c0aa710481ab11e">valeur</a>());
<a name="l00971"></a>00971               <span class="keyword">const</span> <a class="code" href="classTurbulence__paroi.html" title="Classe Turbulence_paroi Classe generique de la hierarchie des turbulences au niveau de la paroi...">Turbulence_paroi</a>&amp; loipar = mod_turb.<a class="code" href="classMod__turb__hyd__base.html#ac9de8c2c64dcf77d28790e021c07c61e">loi_paroi</a>();
<a name="l00972"></a>00972               <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> tau_tan;
<a name="l00973"></a>00973 
<a name="l00974"></a>00974               <span class="keywordflow">if</span> (loipar.non_nul() &amp;&amp; loipar.valeur().use_shear() )
<a name="l00975"></a>00975                 {
<a name="l00976"></a>00976                   tau_tan.<a class="code" href="classDoubleTab.html#afc7cddeeec2c80636e54eaf330ac41ad" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(loipar-&gt;Cisaillement_paroi());
<a name="l00977"></a>00977 
<a name="l00978"></a>00978 <span class="comment">// Interpolation des vitesses a la paroi</span>
<a name="l00979"></a>00979 
<a name="l00980"></a>00980                   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VE_chF = ch_inc_P1NC.<a class="code" href="classChamp__P1NC.html#a122a5f097bee0c82357ab77ab23e0068">zone_vef</a>();
<a name="l00981"></a>00981                   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>,ch_inc_P1NC.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00982"></a>00982                   <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; les_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>();
<a name="l00983"></a>00983                   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; mazone = zone_VE_chF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00984"></a>00984                   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VE_chF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00985"></a>00985                   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VE_chF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00986"></a>00986                   <span class="keywordtype">int</span> nfac = mazone.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>(0);
<a name="l00987"></a>00987                   <span class="keywordtype">int</span> nb_cl=les_cl.size();
<a name="l00988"></a>00988                   <a class="code" href="classIntVect.html">IntVect</a> num(nfac);
<a name="l00989"></a>00989                   <span class="keywordtype">int</span> num_cl,fac,ind_fac;
<a name="l00990"></a>00990 
<a name="l00991"></a>00991                   <span class="keywordtype">double</span> kappa=0.41;
<a name="l00992"></a>00992                   <span class="keywordtype">double</span> norm_v,val0,val1,val2,norm_tau,u_tau;
<a name="l00993"></a>00993 
<a name="l00994"></a>00994                   <span class="keywordflow">for</span> (num_cl=0; num_cl&lt;nb_cl; num_cl++)
<a name="l00995"></a>00995                     {
<a name="l00996"></a>00996 <span class="comment">// Boucle sur les bords</span>
<a name="l00997"></a>00997                       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = les_cl[num_cl];
<a name="l00998"></a>00998                       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; la_front_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00999"></a>00999                       <span class="keywordtype">int</span> ndeb = 0;
<a name="l01000"></a>01000                       <span class="keywordtype">int</span> nfin = la_front_dis.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l01001"></a>01001 
<a name="l01002"></a>01002                       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__paroi__fixe.html" title="classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes...">Dirichlet_paroi_fixe</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) &amp;&amp; tau_tan.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>()!=0)
<a name="l01003"></a>01003                         {
<a name="l01004"></a>01004                           <span class="keywordflow">for</span> (ind_fac=ndeb; ind_fac&lt;nfin ; ind_fac++)
<a name="l01005"></a>01005                             {
<a name="l01006"></a>01006                               fac = la_front_dis.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_fac);
<a name="l01007"></a>01007                               <span class="keywordtype">int</span> elem = face_voisins(fac,0);
<a name="l01008"></a>01008 
<a name="l01009"></a>01009                               <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a> == 2 )
<a name="l01010"></a>01010                                 {
<a name="l01011"></a>01011                                   num[0]=elem_faces(elem,0);
<a name="l01012"></a>01012                                   num[1]=elem_faces(elem,1);
<a name="l01013"></a>01013                                   <span class="keywordflow">if</span>      (num[0]==fac) num[0]=elem_faces(elem,2);
<a name="l01014"></a>01014                                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num[1]==fac) num[1]=elem_faces(elem,2);
<a name="l01015"></a>01015 
<a name="l01016"></a>01016                                   norm_v=<a class="code" href="distances__VEF_8cpp.html#af1e08baeb1ff03d87fa7b45802b317cf">norm_2D_vit1_lp</a>(valeurs,fac,num[0],num[1],zone_VE_chF,val0,val1);
<a name="l01017"></a>01017                                   norm_tau=sqrt(tau_tan(fac,0)*tau_tan(fac,0)+tau_tan(fac,1)*tau_tan(fac,1));
<a name="l01018"></a>01018                                   u_tau=sqrt(norm_tau);
<a name="l01019"></a>01019                                   <span class="comment">/*</span>
<a name="l01020"></a>01020 <span class="comment">                                  // PQ : 06/03 : pour un champ de vitesse 1D, l&#39;incompressibilite genere des vitesses (meme faibles) sur toutes</span>
<a name="l01021"></a>01021 <span class="comment">                                  // les composantes, qui se repercutent par la suite au niveau de la CL ici.</span>
<a name="l01022"></a>01022 <span class="comment">                                  //  (se manifestant en cours de calcul en entree par un pic de vitesse en proche paroi).</span>
<a name="l01023"></a>01023 <span class="comment">                                  // Pour assurer des entrees &quot;correctes&quot; (1D) on remedie a ce probleme via l&#39;operation suivante</span>
<a name="l01024"></a>01024 <span class="comment">                                  // (en supposant que les entrees sont alignees avec une des directions d&#39;espace)</span>
<a name="l01025"></a>01025 <span class="comment"></span>
<a name="l01026"></a>01026 <span class="comment">                                  if(dabs(val0)&gt;0.999) {val0=1.;val1=0.;}</span>
<a name="l01027"></a>01027 <span class="comment">                                  if(dabs(val1)&gt;0.999) {val0=0.;val1=1.;}</span>
<a name="l01028"></a>01028 <span class="comment">                                  */</span>
<a name="l01029"></a>01029 
<a name="l01030"></a>01030                                   valeurs(fac,0)=(norm_v-u_tau/kappa)*val0;
<a name="l01031"></a>01031                                   valeurs(fac,1)=(norm_v-u_tau/kappa)*val1;
<a name="l01032"></a>01032 
<a name="l01033"></a>01033 <span class="comment">// for (i=0 ; i&lt;Objet_U::dimension ; i++)</span>
<a name="l01034"></a>01034 <span class="comment">// valeurs(fac,i)=(valeurs(num[0],i)+valeurs(num[1],i))/2.-sqrt(tau_tan(fac,i))/kappa;</span>
<a name="l01035"></a>01035 <span class="comment">// valeurs(fac,0)=(valeurs(num[0],0)+valeurs(num[1],0))/2.-sqrt(tau_tan(fac,0))/kappa;</span>
<a name="l01036"></a>01036                                 }
<a name="l01037"></a>01037                               <span class="keywordflow">else</span>
<a name="l01038"></a>01038                                 {
<a name="l01039"></a>01039                                   num[0]=elem_faces(elem,0);
<a name="l01040"></a>01040                                   num[1]=elem_faces(elem,1);
<a name="l01041"></a>01041                                   num[2]=elem_faces(elem,2);
<a name="l01042"></a>01042                                   <span class="keywordflow">if</span>      (num[0]==fac) num[0]=elem_faces(elem,3);
<a name="l01043"></a>01043                                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num[1]==fac) num[1]=elem_faces(elem,3);
<a name="l01044"></a>01044                                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num[2]==fac) num[2]=elem_faces(elem,3);
<a name="l01045"></a>01045 
<a name="l01046"></a>01046                                   norm_v=<a class="code" href="distances__VEF_8cpp.html#a8c6b41988d298e5bf17c7132f752e8e6">norm_3D_vit1_lp</a>(valeurs,fac,num[0],num[1],num[2],zone_VE_chF,val0,val1,val2);
<a name="l01047"></a>01047                                   norm_tau=sqrt(tau_tan(fac,0)*tau_tan(fac,0)+tau_tan(fac,1)*tau_tan(fac,1)+tau_tan(fac,2)*tau_tan(fac,2));
<a name="l01048"></a>01048                                   u_tau=sqrt(norm_tau);
<a name="l01049"></a>01049                                   <span class="comment">/*</span>
<a name="l01050"></a>01050 <span class="comment">                                  // PQ : 06/03 : pour un champ de vitesse 1D, l&#39;incompressibilite genere des vitesses (meme faibles) sur toutes</span>
<a name="l01051"></a>01051 <span class="comment">                                  // les composantes, qui se repercutent par la suite au niveau de la CL ici.</span>
<a name="l01052"></a>01052 <span class="comment">                                  //  (se manifestant en cours de calcul en entree par un pic de vitesse en proche paroi).</span>
<a name="l01053"></a>01053 <span class="comment">                                  // Pour assurer des entrees &quot;correctes&quot; (1D) on remedie a ce probleme via l&#39;operation suivante</span>
<a name="l01054"></a>01054 <span class="comment">                                  // (en supposant que les entrees sont alignees suivant une des directions d&#39;espace)</span>
<a name="l01055"></a>01055 <span class="comment"></span>
<a name="l01056"></a>01056 <span class="comment">                                  if(dabs(val0)&gt;0.999) {val0=1.;val1=0.;val2=0.;}</span>
<a name="l01057"></a>01057 <span class="comment">                                  if(dabs(val1)&gt;0.999) {val0=0.;val1=1.;val2=0.;}</span>
<a name="l01058"></a>01058 <span class="comment">                                  if(dabs(val2)&gt;0.999) {val0=0.;val1=0.;val2=1.;}</span>
<a name="l01059"></a>01059 <span class="comment">                                  */</span>
<a name="l01060"></a>01060                                   valeurs(fac,0)=(norm_v-u_tau/kappa)*val0;
<a name="l01061"></a>01061                                   valeurs(fac,1)=(norm_v-u_tau/kappa)*val1;
<a name="l01062"></a>01062                                   valeurs(fac,2)=(norm_v-u_tau/kappa)*val2;
<a name="l01063"></a>01063 
<a name="l01064"></a>01064 
<a name="l01065"></a>01065 <span class="comment">// DoubleTab xv=zone_VEF.xv();</span>
<a name="l01066"></a>01066 <span class="comment">// Cerr &lt;&lt; fac &lt;&lt; &quot; &quot; &lt;&lt; val0 &lt;&lt; &quot; &quot; &lt;&lt; val1 &lt;&lt; &quot; &quot; &lt;&lt; val2 &lt;&lt;finl;</span>
<a name="l01067"></a>01067 <span class="comment">// Cerr &lt;&lt; fac &lt;&lt; &quot; &quot; &lt;&lt; xv(fac,2) &lt;&lt; &quot; &quot; &lt;&lt; valeurs(fac,0) &lt;&lt; &quot; &quot; &lt;&lt; valeurs(fac,1) &lt;&lt; &quot; &quot; &lt;&lt; valeurs(fac,2) &lt;&lt; &quot; &quot; &lt;&lt; u_tau &lt;&lt; &quot; &quot; &lt;&lt; norm_v &lt;&lt;finl;</span>
<a name="l01068"></a>01068 
<a name="l01069"></a>01069 <span class="comment">// for (i=0 ; i&lt;Objet_U::dimension ; i++)</span>
<a name="l01070"></a>01070 <span class="comment">// valeurs(fac,i)=(valeurs(num[0],i)+valeurs(num[1],i)+valeurs(num[2],i))/3.-sqrt(tau_tan(fac,i))/kappa;</span>
<a name="l01071"></a>01071 <span class="comment">// valeurs(fac,0)=(valeurs(num[0],0)+valeurs(num[1],0)+valeurs(num[2],0))/3.-sqrt(tau_tan(fac,0))/kappa;</span>
<a name="l01072"></a>01072                                 }
<a name="l01073"></a>01073                             }<span class="comment">//fac</span>
<a name="l01074"></a>01074                         }<span class="comment">//Dirichlet_paroi</span>
<a name="l01075"></a>01075                     } <span class="comment">//Boucle sur les bords</span>
<a name="l01076"></a>01076                   valeurs.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01077"></a>01077                 }<span class="comment">//!Paroi_negligeable_VEF</span>
<a name="l01078"></a>01078 <span class="comment"></span>            }
<a name="l01079"></a>01079         }
<a name="l01080"></a>01080     }
<a name="l01081"></a>01081 
<a name="l01082"></a>01082   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> valeurs_fac(cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
<a name="l01083"></a>01083   cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>()=valeurs;
<a name="l01084"></a>01084   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot; verif valeurs &quot;</span> , valeurs);
<a name="l01085"></a>01085 
<a name="l01086"></a>01086   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,cha))
<a name="l01087"></a>01087     {
<a name="l01088"></a>01088       <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; ch_inc = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,cha);
<a name="l01089"></a>01089       <a class="code" href="classChamp__P1NC__implementation.html#ac2c0fa150a14667a03e52062463bf6c0" title="Projection du champ P1NC &quot;cha&quot; sur l&#39;espace des champs P1. Le resultat est stocke dans cha...">valeur_P1_L2</a>(ch_inc,dom);
<a name="l01090"></a>01090     }
<a name="l01091"></a>01091   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,cha))
<a name="l01092"></a>01092     {
<a name="l01093"></a>01093       <a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>&amp; ch_fonc = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,cha);
<a name="l01094"></a>01094       <a class="code" href="classChamp__P1NC__implementation.html#ac2c0fa150a14667a03e52062463bf6c0" title="Projection du champ P1NC &quot;cha&quot; sur l&#39;espace des champs P1. Le resultat est stocke dans cha...">valeur_P1_L2</a>(ch_fonc,dom);
<a name="l01095"></a>01095     }
<a name="l01096"></a>01096 
<a name="l01097"></a>01097   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot; verif valeurs &quot;</span> , valeurs);
<a name="l01098"></a>01098   cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>()=valeurs_fac;
<a name="l01099"></a>01099   valeurs_fac=valeurs;
<a name="l01100"></a>01100   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot; verif ch_som_ &quot;</span> , <a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>);
<a name="l01101"></a>01101   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> face=0; face&lt;nb_faces; face++)
<a name="l01102"></a>01102     {
<a name="l01103"></a>01103       <span class="keywordtype">int</span> s1=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,0);
<a name="l01104"></a>01104       s1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(s1);
<a name="l01105"></a>01105       <span class="keywordtype">int</span> s2=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,1);
<a name="l01106"></a>01106       s2=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(s2);
<a name="l01107"></a>01107       <span class="keywordtype">int</span> s3=-1;
<a name="l01108"></a>01108       <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
<a name="l01109"></a>01109         s3=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>(face,2));
<a name="l01110"></a>01110       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l01111"></a>01111         {
<a name="l01112"></a>01112           <span class="keywordtype">double</span> somme=0;
<a name="l01113"></a>01113           somme+=(<a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>(s1,comp)+<a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>(s2,comp));
<a name="l01114"></a>01114           <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
<a name="l01115"></a>01115             somme+=<a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>(s3,comp);
<a name="l01116"></a>01116           valeurs(face, comp)=coeff*somme;
<a name="l01117"></a>01117         }
<a name="l01118"></a>01118     }
<a name="l01119"></a>01119   valeurs.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01120"></a>01120   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot; verif valeurs L2&quot;</span> , valeurs);
<a name="l01121"></a>01121 }
<a name="l01122"></a>01122 
<a name="l01123"></a>01123 
<a name="l01124"></a><a class="code" href="classChamp__P1NC__implementation.html#a01f966100fd849a80c9d9411e4ffb5e8">01124</a> <span class="keywordtype">void</span> <a class="code" href="classChamp__P1NC__implementation.html#a01f966100fd849a80c9d9411e4ffb5e8">Champ_P1NC_implementation::filtrer_resu</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01125"></a>01125 <span class="keyword"></span>{
<a name="l01126"></a>01126   <span class="keyword">const</span> <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha_const =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
<a name="l01127"></a>01127   <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>, cha_const);
<a name="l01128"></a>01128   <span class="keywordtype">double</span> non_prepare=0;
<a name="l01129"></a>01129   <span class="keywordflow">if</span> (cha.<a class="code" href="classChamp__P1NC__implementation.html#a0c4ec557a2e6a41888f850f5b9859bd5">MatP1NC2P1_L2</a>.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() &lt;2)
<a name="l01130"></a>01130     non_prepare=1;
<a name="l01131"></a>01131   non_prepare=<a class="code" href="communications_8cpp.html#adb9fffe31bc56a52685e93ba06932547" title="renvoie le plus petit int i sur l&#39;ensemble des processeurs du groupe courant.">Process::mp_min</a>(non_prepare);
<a name="l01132"></a>01132   <span class="keywordflow">if</span> (non_prepare==1)
<a name="l01133"></a>01133     {
<a name="l01134"></a>01134 <span class="comment">// GF si on n a pas prepare la matrice, on appelle valeur_P1_L2(cha, cha.domaine()); et on remet les anciennes valeurs aux sommets</span>
<a name="l01135"></a>01135       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vit_som_sa=cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>();
<a name="l01136"></a>01136       <a class="code" href="classChamp__P1NC__implementation.html#ac2c0fa150a14667a03e52062463bf6c0" title="Projection du champ P1NC &quot;cha&quot; sur l&#39;espace des champs P1. Le resultat est stocke dans cha...">valeur_P1_L2</a>(cha, cha.<a class="code" href="classChamp__Inc__base.html#a7804397c01b31d542be6a6c8af968b9b">domaine</a>());
<a name="l01137"></a>01137       cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>()=vit_som_sa;
<a name="l01138"></a>01138     }
<a name="l01139"></a>01139 
<a name="l01140"></a>01140   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>,
<a name="l01141"></a>01141                                             cha.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l01142"></a>01142   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l01143"></a>01143   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_entrelaces= zone_VEF.volumes_entrelaces();
<a name="l01144"></a>01144   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; mazone =zone_VEF.zone();
<a name="l01145"></a>01145   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=mazone.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l01146"></a>01146   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_VEF.face_sommets();
<a name="l01147"></a>01147   <span class="keywordtype">int</span> nb_faces=resu.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l01148"></a>01148   <span class="keywordtype">int</span> nb_faces_tot=resu.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
<a name="l01149"></a>01149   <span class="keywordtype">int</span> n_bord,nb_comp=resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l01150"></a>01150 
<a name="l01151"></a>01151   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> resu_som(cha.<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>());
<a name="l01152"></a>01152   resu_som = 0;
<a name="l01153"></a>01153 
<a name="l01154"></a>01154   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> virtfait(nb_faces_tot-nb_faces);
<a name="l01155"></a>01155 
<a name="l01156"></a>01156   <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>= 1./<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l01157"></a>01157   <span class="keywordtype">int</span> face,ind_face;
<a name="l01158"></a>01158   {
<a name="l01159"></a>01159     <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.nb_front_Cl(); n_bord++)
<a name="l01160"></a>01160       {
<a name="l01161"></a>01161         <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l01162"></a>01162         <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l01163"></a>01163         <span class="keywordtype">int</span> nb_faces_tot_bord=le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l01164"></a>01164         <span class="keywordtype">int</span> nb_faces_bord = le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l01165"></a>01165         <span class="keywordtype">int</span> num1 = 0;
<a name="l01166"></a>01166         <span class="keywordtype">int</span> num2 = nb_faces_tot_bord;
<a name="l01167"></a>01167 
<a name="l01168"></a>01168         <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l01169"></a>01169           {
<a name="l01170"></a>01170             <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l01171"></a>01171             <span class="keywordtype">int</span> <a class="code" href="AssembleurPP1BUtil_8cpp.html#a3e374d53ebc7860e1c2f0b7906f2936d">face_associee</a>;
<a name="l01172"></a>01172             <a class="code" href="classIntVect.html">IntVect</a> fait(nb_faces_tot_bord);
<a name="l01173"></a>01173             <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
<a name="l01174"></a>01174               {
<a name="l01175"></a>01175                 face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l01176"></a>01176                 <span class="keywordflow">if</span> (fait(ind_face) == 0)
<a name="l01177"></a>01177                   {
<a name="l01178"></a>01178                     fait(ind_face) = 1;
<a name="l01179"></a>01179                     <span class="keywordflow">if</span> (ind_face-nb_faces_bord&gt;=0) virtfait(face-nb_faces)=1;
<a name="l01180"></a>01180                     face_associee=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(ind_face);
<a name="l01181"></a>01181                     fait(face_associee) = 1;
<a name="l01182"></a>01182                     <span class="keywordflow">if</span> (ind_face-nb_faces_bord&gt;=0)
<a name="l01183"></a>01183                       {
<a name="l01184"></a>01184                         face_associee = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(face_associee);
<a name="l01185"></a>01185                         virtfait(face_associee-nb_faces)=1;
<a name="l01186"></a>01186                       }
<a name="l01187"></a>01187 
<a name="l01188"></a>01188                     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; isom++)
<a name="l01189"></a>01189                       {
<a name="l01190"></a>01190                         <span class="keywordtype">int</span> som=face_sommets(face,isom);
<a name="l01191"></a>01191                         som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l01192"></a>01192                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l01193"></a>01193                           resu_som(som, comp)+=coeff*resu(face, comp);
<a name="l01194"></a>01194                       }
<a name="l01195"></a>01195 
<a name="l01196"></a>01196                   }
<a name="l01197"></a>01197               }
<a name="l01198"></a>01198           }
<a name="l01199"></a>01199         <span class="keywordflow">else</span>
<a name="l01200"></a>01200           {
<a name="l01201"></a>01201             <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
<a name="l01202"></a>01202               {
<a name="l01203"></a>01203                 face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l01204"></a>01204                 <span class="keywordflow">if</span> (ind_face-nb_faces_bord&gt;=0) virtfait(face-nb_faces)=1;
<a name="l01205"></a>01205                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; isom++)
<a name="l01206"></a>01206                   {
<a name="l01207"></a>01207                     <span class="keywordtype">int</span> som=face_sommets(face,isom);
<a name="l01208"></a>01208                     som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l01209"></a>01209                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l01210"></a>01210                       resu_som(som, comp)+=coeff*resu(face, comp);
<a name="l01211"></a>01211                   }
<a name="l01212"></a>01212               }
<a name="l01213"></a>01213           }
<a name="l01214"></a>01214       }
<a name="l01215"></a>01215 
<a name="l01216"></a>01216 
<a name="l01217"></a>01217     <span class="keywordtype">int</span> deb=zone_VEF.premiere_face_int();
<a name="l01218"></a>01218 
<a name="l01219"></a>01219 
<a name="l01220"></a>01220     <span class="keywordflow">for</span>(face=deb; face&lt;nb_faces_tot; face++)
<a name="l01221"></a>01221       {
<a name="l01222"></a>01222         <span class="keywordtype">int</span> indvirtface=face-nb_faces;
<a name="l01223"></a>01223 <span class="comment">// on regarde si la face virtuelle n&#39;a pas deja ete traitee</span>
<a name="l01224"></a>01224         <span class="keywordflow">if</span> (indvirtface&gt;=0)
<a name="l01225"></a>01225           <span class="keywordflow">if</span> (virtfait[indvirtface]==1) <span class="keywordflow">continue</span>;
<a name="l01226"></a>01226         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; isom++)
<a name="l01227"></a>01227           {
<a name="l01228"></a>01228             <span class="keywordtype">int</span> som=face_sommets(face,isom);
<a name="l01229"></a>01229             som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l01230"></a>01230             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l01231"></a>01231               resu_som(som, comp)+=coeff*resu(face, comp);
<a name="l01232"></a>01232           }
<a name="l01233"></a>01233       }
<a name="l01234"></a>01234   }
<a name="l01235"></a>01235 
<a name="l01236"></a>01236 <span class="comment">// resu_som.echange_espace_virtuel();</span>
<a name="l01237"></a>01237 <span class="comment">// Debog::verifier(&quot;Champ_P1NC_implementation::filtrer_resu 1.5 &quot;,resu);</span>
<a name="l01238"></a>01238 <span class="comment">// Debog::verifier(&quot;Champ_P1NC_implementation::filtrer_resu_som 1.5 &quot;,resu_som);</span>
<a name="l01239"></a>01239 
<a name="l01240"></a>01240 <span class="comment">// ************************************************************************************************</span>
<a name="l01241"></a>01241 <span class="comment">// ************************************************************************************************</span>
<a name="l01242"></a>01242 <span class="comment">// </span>
<a name="l01243"></a>01243 <span class="comment">// Pour imposer residu_som = residu donne par CL</span>
<a name="l01244"></a>01244 <span class="comment">// </span>
<a name="l01245"></a>01245 <span class="comment">// ************************************************************************************************</span>
<a name="l01246"></a>01246 <span class="comment">// ************************************************************************************************</span>
<a name="l01247"></a>01247   <a class="code" href="classIntVect.html">IntVect</a> test_cl_imposee(resu_som.dimension_tot(0));
<a name="l01248"></a>01248   test_cl_imposee = 0;
<a name="l01249"></a>01249 
<a name="l01250"></a>01250   <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;zone_VEF.nb_front_Cl(); n_bord++)
<a name="l01251"></a>01251     {
<a name="l01252"></a>01252       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l01253"></a>01253       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l01254"></a>01254       <span class="keywordtype">int</span> num1 = 0;
<a name="l01255"></a>01255       <span class="keywordtype">int</span> num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>() ;
<a name="l01256"></a>01256 
<a name="l01257"></a>01257 <span class="comment">// if (sub_type(Dirichlet,la_cl.valeur()) || sub_type(Dirichlet_homogene,la_cl.valeur()))</span>
<a name="l01258"></a>01258       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l01259"></a>01259         {
<a name="l01260"></a>01260           <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
<a name="l01261"></a>01261             {
<a name="l01262"></a>01262               face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l01263"></a>01263               <span class="keywordtype">double</span> vol=volumes_entrelaces(face);
<a name="l01264"></a>01264               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; isom++)
<a name="l01265"></a>01265                 {
<a name="l01266"></a>01266                   <span class="keywordtype">int</span> som=face_sommets(face,isom);
<a name="l01267"></a>01267                   som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l01268"></a>01268                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l01269"></a>01269                     {
<a name="l01270"></a>01270                       <span class="keywordflow">if</span> (test_cl_imposee(som)==0)
<a name="l01271"></a>01271                         resu_som(som,comp) = 0;
<a name="l01272"></a>01272                       resu_som(som, comp) += <a class="code" href="Champ__P1NC__implementation_8cpp.html#aa542335f9416aab2cb6f6d433f596516">coeff_penalisation</a> * resu(face, comp)/vol;
<a name="l01273"></a>01273                     }
<a name="l01274"></a>01274                   test_cl_imposee(som) += 1;
<a name="l01275"></a>01275                 }
<a name="l01276"></a>01276             }
<a name="l01277"></a>01277         }
<a name="l01278"></a>01278     }
<a name="l01279"></a>01279 
<a name="l01280"></a>01280   resu_som.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01281"></a>01281 
<a name="l01282"></a>01282   <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solv=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>,cha.<a class="code" href="classChamp__P1NC__implementation.html#aadbead528fba47cbd045b66c715f81da">solveur_L2</a>);
<a name="l01283"></a>01283   <span class="keywordtype">int</span> i,nbs = resu_som.dimension(0);
<a name="l01284"></a>01284 
<a name="l01285"></a>01285   <a class="code" href="classDoubleVect.html">DoubleVect</a> secmem(cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>());
<a name="l01286"></a>01286   <a class="code" href="classDoubleVect.html">DoubleVect</a> solution(cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>());
<a name="l01287"></a>01287 
<a name="l01288"></a>01288 <span class="comment">// Modif CD 15/04/03 pour paralleliser le filtrage</span>
<a name="l01289"></a>01289 <span class="comment">// Matrice matrice_tmp;</span>
<a name="l01290"></a>01290 <span class="comment">// cha.dimensionner_Mat_Bloc_Morse_Sym(matrice_tmp);</span>
<a name="l01291"></a>01291 <span class="comment">// cha.Mat_Morse_to_Mat_Bloc(matrice_tmp);</span>
<a name="l01292"></a>01292 <span class="comment">// Fin Modif CD 15/04/03</span>
<a name="l01293"></a>01293 
<a name="l01294"></a>01294 <span class="comment">// Debog::verifier_Mat_sommet(&quot;Champ_P1NC_implementation::filtrer_resu  cha.MatP1NC2P1_L2 &quot;, cha.MatP1NC2P1_L2);</span>
<a name="l01295"></a>01295 
<a name="l01296"></a>01296   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
<a name="l01297"></a>01297     {
<a name="l01298"></a>01298       solution=0.;
<a name="l01299"></a>01299       <span class="keywordflow">for</span>(i=0; i&lt;nbs; i++)
<a name="l01300"></a>01300         secmem(i)=resu_som(i,k);
<a name="l01301"></a>01301 
<a name="l01302"></a>01302       secmem.echange_espace_virtuel();
<a name="l01303"></a>01303 
<a name="l01304"></a>01304       solv.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(cha.<a class="code" href="classChamp__P1NC__implementation.html#ac14f52f8e8882ef0609846e613e73a07">MatP1NC2P1_L2_Parallele</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmem, solution);
<a name="l01305"></a>01305 
<a name="l01306"></a>01306       <span class="keywordflow">for</span>(i=0; i&lt;nbs; i++)
<a name="l01307"></a>01307         resu_som(i,k)=solution(i);
<a name="l01308"></a>01308     }
<a name="l01309"></a>01309 
<a name="l01310"></a>01310   resu=0;
<a name="l01311"></a>01311   {
<a name="l01312"></a>01312     <span class="keywordflow">for</span>(face=0; face&lt;nb_faces; face++)
<a name="l01313"></a>01313       {
<a name="l01314"></a>01314         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; isom++)
<a name="l01315"></a>01315           {
<a name="l01316"></a>01316             <span class="keywordtype">int</span> som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(zone_VEF.face_sommets(face,isom));
<a name="l01317"></a>01317             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l01318"></a>01318               resu(face, comp)+=coeff*resu_som(som, comp);
<a name="l01319"></a>01319           }
<a name="l01320"></a>01320       }
<a name="l01321"></a>01321   }
<a name="l01322"></a>01322   {
<a name="l01323"></a>01323     <span class="keywordflow">for</span>(face=0; face&lt;nb_faces; face++)
<a name="l01324"></a>01324       {
<a name="l01325"></a>01325         <span class="keywordtype">double</span> vol=volumes_entrelaces(face);
<a name="l01326"></a>01326         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l01327"></a>01327           resu(face, comp)*=vol;
<a name="l01328"></a>01328       }
<a name="l01329"></a>01329   }
<a name="l01330"></a>01330 }
<a name="l01331"></a>01331 
<a name="l01332"></a><a class="code" href="classChamp__P1NC__implementation.html#a01bdd73486d6a13644d1b3de226fbde4">01332</a> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classChamp__P1NC__implementation.html#a01bdd73486d6a13644d1b3de226fbde4">Champ_P1NC_implementation::valeur_a_elem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; position,
<a name="l01333"></a>01333                                                      <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; val,
<a name="l01334"></a>01334                                                      <span class="keywordtype">int</span> le_poly)<span class="keyword"> const</span>
<a name="l01335"></a>01335 <span class="keyword"></span>{
<a name="l01336"></a>01336   <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
<a name="l01337"></a>01337   <span class="keyword">const</span> <span class="keywordtype">int</span> N = cha.<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>(), D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l01338"></a>01338   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>();
<a name="l01339"></a>01339   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l01340"></a>01340   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l01341"></a>01341   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l01342"></a>01342   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l01343"></a>01343   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l01344"></a>01344   val = 0;
<a name="l01345"></a>01345 
<a name="l01346"></a>01346   <span class="keywordflow">if</span> (le_poly != -1)
<a name="l01347"></a>01347     {
<a name="l01348"></a>01348       <span class="keyword">const</span> <span class="keywordtype">double</span> xs = position(0), ys = position(1),
<a name="l01349"></a>01349                    zs = (D == 3) ? position(2) : 0;
<a name="l01350"></a>01350       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; D + 1; i++)
<a name="l01351"></a>01351         {
<a name="l01352"></a>01352           <span class="keyword">const</span> <span class="keywordtype">int</span> f = elem_faces(le_poly, i);
<a name="l01353"></a>01353           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n = 0; n &lt; N; n++)
<a name="l01354"></a>01354             val(n) += ch(f, n) * ((D == 2) ? <a class="code" href="classChamp__P1NC__implementation.html#ad022e7402ec857c8ecc9fd28d241fbea">fonction_forme_2D</a>(xs, ys, le_poly, i, sommet_poly, coord) : <a class="code" href="classChamp__P1NC__implementation.html#a7323420ee0d88c663808c2bd578ca2f4">fonction_forme_3D</a>(xs, ys, zs, le_poly, i, sommet_poly, coord));
<a name="l01355"></a>01355         }
<a name="l01356"></a>01356     }
<a name="l01357"></a>01357   <span class="keywordflow">return</span> val;
<a name="l01358"></a>01358 }
<a name="l01359"></a>01359 
<a name="l01360"></a>01360 <span class="keywordtype">double</span> <a class="code" href="classChamp__P1NC__implementation.html#acacb4869ebabcb4fc4200aa604aa39bb">Champ_P1NC_implementation::</a>
<a name="l01361"></a><a class="code" href="classChamp__P1NC__implementation.html#acacb4869ebabcb4fc4200aa604aa39bb">01361</a> <a class="code" href="classChamp__P1NC__implementation.html#acacb4869ebabcb4fc4200aa604aa39bb">valeur_a_elem_compo</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; position, <span class="keywordtype">int</span> le_poly, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l01362"></a>01362 <span class="keyword"></span>{
<a name="l01363"></a>01363 <span class="comment">// Cerr &lt;&lt; &quot;Champ_P1NC_implementation::valeur_a_elem_compo&quot; &lt;&lt; finl;</span>
<a name="l01364"></a>01364   <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
<a name="l01365"></a>01365   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>();
<a name="l01366"></a>01366   <span class="keyword">const</span> <span class="keywordtype">int</span> D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l01367"></a>01367   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l01368"></a>01368   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l01369"></a>01369   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l01370"></a>01370   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l01371"></a>01371   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l01372"></a>01372   <span class="keywordtype">double</span> val = 0.;
<a name="l01373"></a>01373 
<a name="l01374"></a>01374   <span class="keywordflow">if</span> (le_poly != -1)
<a name="l01375"></a>01375     {
<a name="l01376"></a>01376 <span class="comment">// Calcul d&#39;apres les fonctions de forme sur le triangle ou le tetraedre</span>
<a name="l01377"></a>01377       <span class="keyword">const</span> <span class="keywordtype">double</span> xs = position(0), ys = position(1),
<a name="l01378"></a>01378                    zs = (D == 3) ? position(2) : 0;
<a name="l01379"></a>01379       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; D + 1; i++)
<a name="l01380"></a>01380         {
<a name="l01381"></a>01381           <span class="keyword">const</span> <span class="keywordtype">int</span> f = elem_faces(le_poly,i);
<a name="l01382"></a>01382           val += ch(f, ncomp) * ((D == 2) ? <a class="code" href="classChamp__P1NC__implementation.html#ad022e7402ec857c8ecc9fd28d241fbea">fonction_forme_2D</a>(xs, ys, le_poly, i, sommet_poly, coord) : <a class="code" href="classChamp__P1NC__implementation.html#a7323420ee0d88c663808c2bd578ca2f4">fonction_forme_3D</a>(xs, ys, zs, le_poly, i, sommet_poly, coord));
<a name="l01383"></a>01383         }
<a name="l01384"></a>01384     }
<a name="l01385"></a>01385 
<a name="l01386"></a>01386   <span class="keywordflow">return</span> val;
<a name="l01387"></a>01387 }
<a name="l01388"></a>01388 
<a name="l01389"></a>01389 
<a name="l01390"></a>01390 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__P1NC__implementation.html#a22d053851c997e080bc189f57d99a088">Champ_P1NC_implementation::</a>
<a name="l01391"></a><a class="code" href="classChamp__P1NC__implementation.html#a22d053851c997e080bc189f57d99a088">01391</a> <a class="code" href="classChamp__P1NC__implementation.html#a22d053851c997e080bc189f57d99a088">valeur_aux_elems</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions,
<a name="l01392"></a>01392                  <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; les_polys,
<a name="l01393"></a>01393                  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val)<span class="keyword"> const</span>
<a name="l01394"></a>01394 <span class="keyword"></span>{
<a name="l01395"></a>01395   <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
<a name="l01396"></a>01396   <span class="keywordtype">int</span> nb_compo_=cha.<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>();
<a name="l01397"></a>01397   <span class="keywordtype">int</span> face;
<a name="l01398"></a>01398   <span class="keywordtype">double</span> xs,ys,zs;
<a name="l01399"></a>01399   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l01400"></a>01400 
<a name="l01401"></a>01401   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l01402"></a>01402   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>();
<a name="l01403"></a>01403   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l01404"></a>01404   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l01405"></a>01405   <span class="keywordflow">if</span> (val.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() &gt; 2)
<a name="l01406"></a>01406     {
<a name="l01407"></a>01407       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur TRUST dans Champ_P1NC_implementation::valeur_aux_elems()\n&quot;</span>;
<a name="l01408"></a>01408       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Le DoubleTab val a plus de 2 entrees\n&quot;</span>;
<a name="l01409"></a>01409       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01410"></a>01410     }
<a name="l01411"></a>01411 
<a name="l01412"></a>01412 <span class="comment">// TODO : FIXME</span>
<a name="l01413"></a>01413 <span class="comment">// For FT the resize should be done in its good position and not here ...</span>
<a name="l01414"></a>01414   <span class="keywordflow">if</span> (val.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 1 ) val.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(val.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0),1);
<a name="l01415"></a>01415 
<a name="l01416"></a>01416   <span class="keywordtype">int</span> le_poly, D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l01417"></a>01417   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l01418"></a>01418 
<a name="l01419"></a>01419   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rang_poly=0; rang_poly&lt;les_polys.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>(); rang_poly++)
<a name="l01420"></a>01420     {
<a name="l01421"></a>01421       le_poly=les_polys(rang_poly);
<a name="l01422"></a>01422       <span class="keywordflow">if</span> (le_poly == -1)
<a name="l01423"></a>01423         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ncomp=0; ncomp&lt;nb_compo_; ncomp++)
<a name="l01424"></a>01424           val(rang_poly, ncomp) = 0;
<a name="l01425"></a>01425       <span class="keywordflow">else</span>
<a name="l01426"></a>01426         {
<a name="l01427"></a>01427           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ncomp=0; ncomp&lt;nb_compo_; ncomp++)
<a name="l01428"></a>01428             {
<a name="l01429"></a>01429               val(rang_poly, ncomp) = 0;
<a name="l01430"></a>01430               xs = positions(rang_poly,0);
<a name="l01431"></a>01431               ys = positions(rang_poly,1);
<a name="l01432"></a>01432               zs = (D == 3) ? positions(rang_poly,2) : 0;
<a name="l01433"></a>01433               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; D + 1; i++)
<a name="l01434"></a>01434                 {
<a name="l01435"></a>01435                   face = elem_faces(le_poly, i);
<a name="l01436"></a>01436                   val(rang_poly, ncomp) += ch(face, ncomp) *
<a name="l01437"></a>01437                                            ((D == 2) ? <a class="code" href="classChamp__P1NC__implementation.html#ad022e7402ec857c8ecc9fd28d241fbea">fonction_forme_2D</a>(xs, ys, le_poly, i, sommet_poly, coord) : <a class="code" href="classChamp__P1NC__implementation.html#a7323420ee0d88c663808c2bd578ca2f4">fonction_forme_3D</a>(xs, ys, zs, le_poly, i, sommet_poly, coord));
<a name="l01438"></a>01438                 }
<a name="l01439"></a>01439             }
<a name="l01440"></a>01440         }
<a name="l01441"></a>01441     }
<a name="l01442"></a>01442   <span class="keywordflow">return</span> val;
<a name="l01443"></a>01443 }
<a name="l01444"></a>01444 
<a name="l01445"></a>01445 <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classChamp__P1NC__implementation.html#a6f97c08115ccb64a29832595a27041c0">Champ_P1NC_implementation::</a>
<a name="l01446"></a><a class="code" href="classChamp__P1NC__implementation.html#a6f97c08115ccb64a29832595a27041c0">01446</a> <a class="code" href="classChamp__P1NC__implementation.html#a6f97c08115ccb64a29832595a27041c0">valeur_aux_elems_compo</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions,
<a name="l01447"></a>01447                        <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; les_polys,
<a name="l01448"></a>01448                        <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; val,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l01449"></a>01449 <span class="keyword"></span>{
<a name="l01450"></a>01450   <span class="keywordtype">int</span> les_polys_size = les_polys.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>();
<a name="l01451"></a>01451   <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
<a name="l01452"></a>01452   <span class="keywordtype">double</span> xs,ys,zs;
<a name="l01453"></a>01453   <span class="keywordtype">int</span> face;
<a name="l01454"></a>01454   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l01455"></a>01455   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>();
<a name="l01456"></a>01456   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l01457"></a>01457   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l01458"></a>01458 <span class="comment">// Commenter en attendant de comprendre le dimensionnement de xp apres la sortie de version</span>
<a name="l01459"></a>01459 <span class="comment">// assert(val.size() == les_polys_size);</span>
<a name="l01460"></a>01460   <span class="keywordtype">int</span> le_poly, D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l01461"></a>01461 
<a name="l01462"></a>01462   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l01463"></a>01463 
<a name="l01464"></a>01464   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rang_poly=0; rang_poly&lt;les_polys_size; rang_poly++)
<a name="l01465"></a>01465     {
<a name="l01466"></a>01466       le_poly=les_polys(rang_poly);
<a name="l01467"></a>01467       <span class="keywordflow">if</span> (le_poly == -1) val(rang_poly) = 0;
<a name="l01468"></a>01468       <span class="keywordflow">else</span>
<a name="l01469"></a>01469         {
<a name="l01470"></a>01470 <span class="comment">// Calcul d&#39;apres les fonctions de forme sur le triangle ou le tetraedre</span>
<a name="l01471"></a>01471           val(rang_poly) = 0;
<a name="l01472"></a>01472           xs = positions(rang_poly,0);
<a name="l01473"></a>01473           ys = positions(rang_poly,1);
<a name="l01474"></a>01474           zs = (D == 3) ? positions(rang_poly,2) : 0.;
<a name="l01475"></a>01475           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; D + 1; i++)
<a name="l01476"></a>01476             {
<a name="l01477"></a>01477               face = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>(le_poly,i);
<a name="l01478"></a>01478               val(rang_poly) += ch(face, ncomp) *
<a name="l01479"></a>01479                                 ( (D == 2) ? <a class="code" href="classChamp__P1NC__implementation.html#ad022e7402ec857c8ecc9fd28d241fbea">fonction_forme_2D</a>(xs,ys,le_poly,i,sommet_poly,coord) :
<a name="l01480"></a>01480                                   <a class="code" href="classChamp__P1NC__implementation.html#a7323420ee0d88c663808c2bd578ca2f4">fonction_forme_3D</a>(xs,ys,zs,le_poly,i,sommet_poly,coord));
<a name="l01481"></a>01481             }
<a name="l01482"></a>01482         }
<a name="l01483"></a>01483     }
<a name="l01484"></a>01484 
<a name="l01485"></a>01485   <span class="keywordflow">return</span> val;
<a name="l01486"></a>01486 }
<a name="l01487"></a>01487 
<a name="l01488"></a>01488 
<a name="l01489"></a>01489 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__P1NC__implementation.html#a8426620eca950b7ee6ff0b87bbb4ec64">Champ_P1NC_implementation::</a>
<a name="l01490"></a><a class="code" href="classChamp__P1NC__implementation.html#a8426620eca950b7ee6ff0b87bbb4ec64">01490</a> <a class="code" href="classChamp__P1NC__implementation.html#a8426620eca950b7ee6ff0b87bbb4ec64">valeur_aux_elems_smooth</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions,
<a name="l01491"></a>01491                         <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; les_polys,
<a name="l01492"></a>01492                         <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val)
<a name="l01493"></a>01493 {
<a name="l01494"></a>01494   <span class="keywordflow">if</span> ((!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>()))&amp;&amp;(!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>())))
<a name="l01495"></a>01495     {
<a name="l01496"></a>01496       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;L&#39;option chsom des sondes ne s&#39;applique pour le moment que pour les Champ_P1NC en VEF&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01497"></a>01497       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;or votre champ &quot;</span> &lt;&lt; <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classField__base.html#ae1377124eabe8387aced762115b062bb" title="Renvoie le nom du champ.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; est de type &quot;</span> &lt;&lt; <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; finl;
<a name="l01498"></a>01498 <span class="comment">// Je rajoute le message ci-dessous car le message habituel n&#39;apparait pas !</span>
<a name="l01499"></a>01499       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;TRUST a provoque une erreur et va s&#39;arreter&quot;</span> &lt;&lt; finl;
<a name="l01500"></a>01500       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01501"></a>01501     }
<a name="l01502"></a>01502 
<a name="l01503"></a>01503   <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
<a name="l01504"></a>01504   <span class="keyword">const</span> <span class="keywordtype">int</span> les_polys_size = les_polys.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>(), nb_compo_=cha.<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>(), D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l01505"></a>01505   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;  ch_sommet= (<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>());
<a name="l01506"></a>01506   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l01507"></a>01507   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>();
<a name="l01508"></a>01508   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l01509"></a>01509   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l01510"></a>01510   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l01511"></a>01511   <span class="keywordflow">if</span> (val.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 2)
<a name="l01512"></a>01512     {
<a name="l01513"></a>01513       assert((val.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0) == les_polys_size)||(val.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0) == les_polys_size));
<a name="l01514"></a>01514       assert(val.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>() == nb_compo_);
<a name="l01515"></a>01515     }
<a name="l01516"></a>01516   <span class="keywordflow">else</span>
<a name="l01517"></a>01517     {
<a name="l01518"></a>01518       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur TRUST dans Champ_P1NC_implementation::valeur_aux_elems_smooth()\n&quot;</span>;
<a name="l01519"></a>01519       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Le DoubleTab val a plus de 2 entrees\n&quot;</span>;
<a name="l01520"></a>01520       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01521"></a>01521     }
<a name="l01522"></a>01522   <span class="keywordflow">if</span> (!<a class="code" href="classChamp__P1NC__implementation.html#a4437c8f910d3e626accf68eeb590ab15">filtrer_L2_deja_appele_</a>)
<a name="l01523"></a>01523     {
<a name="l01524"></a>01524 <span class="comment">// Filtrer L2 ne marche que pour les vecteurs</span>
<a name="l01525"></a>01525 <span class="comment">// C.MALOD 19/12/2006 : Ce n&#39;est plus vrai, ca marche aussi avec les scalaires.</span>
<a name="l01526"></a>01526       <span class="keywordflow">if</span> (nb_compo_&gt;0)
<a name="l01527"></a>01527         {
<a name="l01528"></a>01528           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> val_sauv=cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l01529"></a>01529           <a class="code" href="classChamp__P1NC__implementation.html#ab18ebd7f3cd91fb4e4db5cc8bf937ab3">filtrer_L2</a>(cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
<a name="l01530"></a>01530           cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>()=val_sauv;
<a name="l01531"></a>01531         }
<a name="l01532"></a>01532       <a class="code" href="classChamp__P1NC__implementation.html#a4437c8f910d3e626accf68eeb590ab15">filtrer_L2_deja_appele_</a>=1;
<a name="l01533"></a>01533     }
<a name="l01534"></a>01534 
<a name="l01535"></a>01535 <span class="comment">// calcul de la valeur aux elements suivant les coordonnees barycentriques (repris de Champ_P1)</span>
<a name="l01536"></a>01536   val = 0.;
<a name="l01537"></a>01537   <span class="keywordtype">int</span> p;
<a name="l01538"></a>01538   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rang_poly=0; rang_poly&lt;les_polys_size; rang_poly++)
<a name="l01539"></a>01539     <span class="keywordflow">if</span> ((p = les_polys(rang_poly)) != -1)
<a name="l01540"></a>01540       {
<a name="l01541"></a>01541         <span class="keyword">const</span> <span class="keywordtype">double</span> xs = positions(rang_poly,0), ys = positions(rang_poly,1),
<a name="l01542"></a>01542                      zs = (D == 3) ? positions(rang_poly,2) : 0.;
<a name="l01543"></a>01543         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ncomp=0; ncomp&lt;nb_compo_; ncomp++)
<a name="l01544"></a>01544           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; D + 1; i++)
<a name="l01545"></a>01545             {
<a name="l01546"></a>01546               <span class="keywordtype">int</span> som = sommet_poly(p, i);
<a name="l01547"></a>01547               <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l01548"></a>01548               val(rang_poly, ncomp) += ch_sommet(som1, ncomp) * ((D == 2) ? <a class="code" href="classChamp__P1NC__implementation.html#afca68bf9ab7b22877d7cfffcebc1115a">coord_barycentrique</a>(sommet_poly, coord, xs, ys, p, i) : <a class="code" href="classChamp__P1NC__implementation.html#afca68bf9ab7b22877d7cfffcebc1115a">coord_barycentrique</a>(sommet_poly, coord, xs, ys, zs, p, i));
<a name="l01549"></a>01549             }
<a name="l01550"></a>01550       }
<a name="l01551"></a>01551   <span class="keywordflow">return</span> val;
<a name="l01552"></a>01552 }
<a name="l01553"></a>01553 
<a name="l01554"></a>01554 
<a name="l01555"></a>01555 <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classChamp__P1NC__implementation.html#a2a41177f98eed27e4f08c03a9cf21358">Champ_P1NC_implementation::</a>
<a name="l01556"></a><a class="code" href="classChamp__P1NC__implementation.html#a2a41177f98eed27e4f08c03a9cf21358">01556</a> <a class="code" href="classChamp__P1NC__implementation.html#a2a41177f98eed27e4f08c03a9cf21358">valeur_aux_elems_compo_smooth</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions,
<a name="l01557"></a>01557                               <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; les_polys,
<a name="l01558"></a>01558                               <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; val,<span class="keywordtype">int</span> ncomp)
<a name="l01559"></a>01559 {
<a name="l01560"></a>01560   <span class="keywordflow">if</span> ((!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>()))&amp;&amp;(!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>())))
<a name="l01561"></a>01561     {
<a name="l01562"></a>01562       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;L&#39;option chsom des sondes ne s&#39;applique pour le moment que pour les Champ_P1NC en VEF&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01563"></a>01563       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;or votre champ &quot;</span> &lt;&lt; <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classField__base.html#ae1377124eabe8387aced762115b062bb" title="Renvoie le nom du champ.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; est de type &quot;</span> &lt;&lt; <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; finl;
<a name="l01564"></a>01564 <span class="comment">// Je rajoute le message ci-dessous car le message habituel n&#39;apparait pas !</span>
<a name="l01565"></a>01565       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;TRUST a provoque une erreur et va s&#39;arreter&quot;</span> &lt;&lt; finl;
<a name="l01566"></a>01566       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01567"></a>01567     }
<a name="l01568"></a>01568   <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha =<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
<a name="l01569"></a>01569   <span class="keyword">const</span> <span class="keywordtype">int</span> les_polys_size = les_polys.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>(), nb_compo_=cha.<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>(), D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l01570"></a>01570   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch_sommet= (<a class="code" href="classChamp__P1NC__implementation.html#a42454b3d526344877e4d6dfc072a6a1b">ch_som</a>());
<a name="l01571"></a>01571   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l01572"></a>01572   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l01573"></a>01573   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>();
<a name="l01574"></a>01574   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l01575"></a>01575   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l01576"></a>01576   <span class="keywordflow">if</span> (!<a class="code" href="classChamp__P1NC__implementation.html#a4437c8f910d3e626accf68eeb590ab15">filtrer_L2_deja_appele_</a>)
<a name="l01577"></a>01577     {
<a name="l01578"></a>01578 <span class="comment">// Filtrer L2 ne marche que pour les vecteurs</span>
<a name="l01579"></a>01579 <span class="comment">// C.MALOD 19/12/2006 : Ce n&#39;est plus vrai, ca marche aussi avec les scalaires.</span>
<a name="l01580"></a>01580       <span class="keywordflow">if</span> (nb_compo_&gt;0)
<a name="l01581"></a>01581         {
<a name="l01582"></a>01582           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> val_sauv=cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l01583"></a>01583           <a class="code" href="classChamp__P1NC__implementation.html#ab18ebd7f3cd91fb4e4db5cc8bf937ab3">filtrer_L2</a>(cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>());
<a name="l01584"></a>01584           cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>()=val_sauv;
<a name="l01585"></a>01585         }
<a name="l01586"></a>01586       <a class="code" href="classChamp__P1NC__implementation.html#a4437c8f910d3e626accf68eeb590ab15">filtrer_L2_deja_appele_</a>=1;
<a name="l01587"></a>01587     }
<a name="l01588"></a>01588   assert(val.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == les_polys_size);
<a name="l01589"></a>01589   val = 0.;
<a name="l01590"></a>01590   <span class="keywordtype">int</span> p;
<a name="l01591"></a>01591 
<a name="l01592"></a>01592 <span class="comment">// calcul de la valeur aux elements suivant les coordonnees barycentriques (repris de Champ_P1)</span>
<a name="l01593"></a>01593 
<a name="l01594"></a>01594   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rang_poly=0; rang_poly&lt;les_polys_size; rang_poly++)
<a name="l01595"></a>01595     <span class="keywordflow">if</span> ((p = les_polys(rang_poly)) != -1)
<a name="l01596"></a>01596       {
<a name="l01597"></a>01597         <span class="keyword">const</span> <span class="keywordtype">double</span> xs = positions(rang_poly,0), ys = positions(rang_poly,1),
<a name="l01598"></a>01598                      zs = (D == 3) ? positions(rang_poly,2) : 0.;
<a name="l01599"></a>01599         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; D + 1; i++)
<a name="l01600"></a>01600           {
<a name="l01601"></a>01601             <span class="keywordtype">int</span> som = sommet_poly(p, i);
<a name="l01602"></a>01602             <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som);
<a name="l01603"></a>01603             val(rang_poly) += ch_sommet(som1, ncomp)
<a name="l01604"></a>01604                               * ((D == 2) ? <a class="code" href="classChamp__P1NC__implementation.html#afca68bf9ab7b22877d7cfffcebc1115a">coord_barycentrique</a>(sommet_poly, coord, xs, ys, p, i) : <a class="code" href="classChamp__P1NC__implementation.html#afca68bf9ab7b22877d7cfffcebc1115a">coord_barycentrique</a>(sommet_poly, coord, xs, ys, zs, p, i));
<a name="l01605"></a>01605           }
<a name="l01606"></a>01606       }
<a name="l01607"></a>01607   <span class="keywordflow">return</span> val;
<a name="l01608"></a>01608 }
<a name="l01609"></a>01609 
<a name="l01610"></a>01610 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__P1NC__implementation.html#aae75b2a451bacac1b78d3e5192d9e885">Champ_P1NC_implementation::</a>
<a name="l01611"></a><a class="code" href="classChamp__P1NC__implementation.html#aae75b2a451bacac1b78d3e5192d9e885">01611</a> <a class="code" href="classChamp__P1NC__implementation.html#aae75b2a451bacac1b78d3e5192d9e885">valeur_aux_sommets</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,
<a name="l01612"></a>01612                    <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; champ_som)<span class="keyword"> const</span>
<a name="l01613"></a>01613 <span class="keyword"></span>{
<a name="l01614"></a>01614   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; mazone = dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);
<a name="l01615"></a>01615 
<a name="l01616"></a>01616   <span class="keywordtype">int</span> nb_som = mazone.<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
<a name="l01617"></a>01617   <span class="keywordtype">int</span> nb_som_return = champ_som.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
<a name="l01618"></a>01618 
<a name="l01619"></a>01619   <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
<a name="l01620"></a>01620   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l01621"></a>01621   <span class="keywordtype">int</span> nb_compo_=cha.<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>();
<a name="l01622"></a>01622   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>(nb_som);
<a name="l01623"></a>01623 
<a name="l01624"></a>01624   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l01625"></a>01625   assert(<a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>().<a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>()==mazone);
<a name="l01626"></a>01626 
<a name="l01627"></a>01627   <span class="keywordflow">if</span> ( <a class="code" href="Champ__P1NC__implementation_8cpp.html#afbe7fcf4bcc6179a6c6cfc12b0a6d799">methode_calcul_valeurs_sommets</a>&gt;0)
<a name="l01628"></a>01628     {
<a name="l01629"></a>01629       <span class="keywordtype">int</span> nb_elem_tot = mazone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l01630"></a>01630       <span class="keywordtype">int</span> nb_som_elem = mazone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l01631"></a>01631 
<a name="l01632"></a>01632       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l01633"></a>01633 
<a name="l01634"></a>01634       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> min_som(nb_som,nb_compo_) ;
<a name="l01635"></a>01635       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> max_som(nb_som,nb_compo_) ;
<a name="l01636"></a>01636       <span class="keywordtype">int</span> ncomp, face_adj,face_glob;
<a name="l01637"></a>01637       <span class="keywordtype">int</span> num_elem,num_som,j;
<a name="l01638"></a>01638 
<a name="l01639"></a>01639       champ_som = 0;
<a name="l01640"></a>01640       compteur = 0;
<a name="l01641"></a>01641       <span class="keywordflow">for</span> (j=0; j&lt;nb_som; j++)
<a name="l01642"></a>01642         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nb_compo_; k++ )
<a name="l01643"></a>01643           {
<a name="l01644"></a>01644             min_som(j,k) = 1.e+30 ;
<a name="l01645"></a>01645             max_som(j,k) = 1.e-30 ;
<a name="l01646"></a>01646           }
<a name="l01647"></a>01647 
<a name="l01648"></a>01648       <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;nb_elem_tot; num_elem++)
<a name="l01649"></a>01649         {
<a name="l01650"></a>01650           <span class="keywordflow">for</span> (j=0; j&lt;nb_som_elem; j++)
<a name="l01651"></a>01651             {
<a name="l01652"></a>01652               num_som = mazone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(num_elem,j);
<a name="l01653"></a>01653               <span class="keywordflow">if</span>(num_som &lt; nb_som_return)
<a name="l01654"></a>01654                 {
<a name="l01655"></a>01655                   compteur[num_som]++;
<a name="l01656"></a>01656                   <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_compo_; ncomp++)
<a name="l01657"></a>01657                     {
<a name="l01658"></a>01658                       champ_som(num_som,ncomp) += <a class="code" href="classChamp__P1NC__implementation.html#af03937cefb3ed641c5223a7a00fcb778">valeur_a_sommet_compo</a>(num_som,num_elem,ncomp);
<a name="l01659"></a>01659                       <span class="keywordflow">for</span>(face_adj=0; face_adj&lt;nb_som_elem; face_adj ++)
<a name="l01660"></a>01660                         {
<a name="l01661"></a>01661                           <span class="keywordflow">if</span> (face_adj != j )
<a name="l01662"></a>01662                             {
<a name="l01663"></a>01663                               face_glob = elem_faces(num_elem, face_adj);
<a name="l01664"></a>01664                               min_som(num_som,ncomp) = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a> ( ch(face_glob,ncomp),min_som(num_som,ncomp) ) ;
<a name="l01665"></a>01665                               max_som(num_som,ncomp) = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a> ( ch(face_glob,ncomp),max_som(num_som,ncomp) ) ;
<a name="l01666"></a>01666                             }
<a name="l01667"></a>01667                         }
<a name="l01668"></a>01668                     }
<a name="l01669"></a>01669                 }
<a name="l01670"></a>01670             }
<a name="l01671"></a>01671         }
<a name="l01672"></a>01672       <span class="keywordflow">for</span> (num_som=0; num_som&lt;nb_som_return; num_som++)
<a name="l01673"></a>01673         <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_compo_; ncomp++)
<a name="l01674"></a>01674           {
<a name="l01675"></a>01675             champ_som(num_som,ncomp) /= compteur[num_som];
<a name="l01676"></a>01676             <span class="keywordflow">if</span> ( <a class="code" href="Champ__P1NC__implementation_8cpp.html#afbe7fcf4bcc6179a6c6cfc12b0a6d799">methode_calcul_valeurs_sommets</a>&gt;1)
<a name="l01677"></a>01677               {
<a name="l01678"></a>01678                 <span class="keywordflow">if</span> ( champ_som(num_som,ncomp) &lt; min_som(num_som,ncomp) )
<a name="l01679"></a>01679                   {
<a name="l01680"></a>01680                     champ_som(num_som,ncomp) = min_som(num_som,ncomp) ;
<a name="l01681"></a>01681                   }
<a name="l01682"></a>01682                 <span class="keywordflow">if</span> ( champ_som(num_som,ncomp) &gt; max_som(num_som,ncomp) )
<a name="l01683"></a>01683                   {
<a name="l01684"></a>01684                     champ_som(num_som,ncomp) = max_som(num_som,ncomp) ;
<a name="l01685"></a>01685                   }
<a name="l01686"></a>01686               }
<a name="l01687"></a>01687           }
<a name="l01688"></a>01688     }
<a name="l01689"></a>01689   <span class="keywordflow">else</span>
<a name="l01690"></a>01690     {
<a name="l01691"></a>01691       assert(<a class="code" href="Champ__P1NC__implementation_8cpp.html#afbe7fcf4bcc6179a6c6cfc12b0a6d799">methode_calcul_valeurs_sommets</a>==-1);
<a name="l01692"></a>01692       champ_som = 0;
<a name="l01693"></a>01693       compteur = 0;
<a name="l01694"></a>01694       <span class="keywordtype">int</span> nb_comp=nb_compo_;
<a name="l01695"></a>01695       <span class="keywordtype">int</span> nb_faces_tot=zone_VEF.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
<a name="l01696"></a>01696       <span class="keywordtype">int</span> nb_som_face=zone_VEF.<a class="code" href="classZone__VF.html#a990808f967f351edbb83ff11d60b7445" title="renvoie le nombre de sommets par face. Rque : on a suppose que toutes les faces avait le meme nombre ...">nb_som_face</a>();
<a name="l01697"></a>01697       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l01698"></a>01698       <span class="keywordtype">int</span> face;
<a name="l01699"></a>01699       <span class="keywordflow">for</span>(face=0; face&lt;nb_faces_tot; face++)
<a name="l01700"></a>01700         {
<a name="l01701"></a>01701 
<a name="l01702"></a>01702           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
<a name="l01703"></a>01703             {
<a name="l01704"></a>01704               <span class="keywordtype">int</span> som1=face_sommets(face,isom);
<a name="l01705"></a>01705               <span class="keywordflow">if</span> (som1&lt;nb_som_return)
<a name="l01706"></a>01706                 {
<a name="l01707"></a>01707                   compteur[som1]++;
<a name="l01708"></a>01708                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_comp; k++)
<a name="l01709"></a>01709                     champ_som(som1,k)+=ch(face,k);
<a name="l01710"></a>01710                 }
<a name="l01711"></a>01711             }
<a name="l01712"></a>01712         }
<a name="l01713"></a>01713 
<a name="l01714"></a>01714 
<a name="l01715"></a>01715       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_som=0; num_som&lt;nb_som_return; num_som++)
<a name="l01716"></a>01716         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ncomp=0; ncomp&lt;nb_compo_; ncomp++)
<a name="l01717"></a>01717           {
<a name="l01718"></a>01718             champ_som(num_som,ncomp) /= compteur[num_som];
<a name="l01719"></a>01719           }
<a name="l01720"></a>01720     }
<a name="l01721"></a>01721   <span class="keywordflow">return</span> champ_som;
<a name="l01722"></a>01722 }
<a name="l01723"></a>01723 
<a name="l01724"></a><a class="code" href="classChamp__P1NC__implementation.html#af03937cefb3ed641c5223a7a00fcb778">01724</a> <span class="keywordtype">double</span> <a class="code" href="classChamp__P1NC__implementation.html#af03937cefb3ed641c5223a7a00fcb778">Champ_P1NC_implementation::valeur_a_sommet_compo</a>(<span class="keywordtype">int</span> num_som, <span class="keywordtype">int</span> le_poly, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l01725"></a>01725 <span class="keyword"></span>{
<a name="l01726"></a>01726 <span class="comment">// Cerr &lt;&lt; &quot;Champ_P1NC_implementation::valeur_a_sommet_compo&quot; &lt;&lt; finl;</span>
<a name="l01727"></a>01727   <span class="keywordtype">int</span> face=-1;
<a name="l01728"></a>01728   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>().<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l01729"></a>01729   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = <a class="code" href="classChamp__implementation.html#a66052aa2858507b8a7b58f6beab245ad">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l01730"></a>01730   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l01731"></a>01731   <span class="keywordtype">double</span> val=0;
<a name="l01732"></a>01732   <span class="keywordflow">if</span> (le_poly != -1)
<a name="l01733"></a>01733     {
<a name="l01734"></a>01734       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>+1; i++)
<a name="l01735"></a>01735         {
<a name="l01736"></a>01736           face = elem_faces(le_poly,i);
<a name="l01737"></a>01737           <span class="keywordflow">if</span> (sommet_poly(le_poly,i)==num_som)
<a name="l01738"></a>01738             val -= (Objet_U::dimension-1)*ch(face, ncomp);
<a name="l01739"></a>01739           <span class="keywordflow">else</span>
<a name="l01740"></a>01740             val += ch(face, ncomp);
<a name="l01741"></a>01741         }
<a name="l01742"></a>01742     }
<a name="l01743"></a>01743   <span class="keywordflow">return</span> val;
<a name="l01744"></a>01744 }
<a name="l01745"></a>01745 
<a name="l01746"></a>01746 <span class="comment">// DoubleTab&amp; Champ_P1NC_implementation::</span>
<a name="l01747"></a>01747 <span class="comment">// valeur_aux_sommets(const Domaine&amp; dom,</span>
<a name="l01748"></a>01748 <span class="comment">// DoubleTab&amp; ch_som) const</span>
<a name="l01749"></a>01749 <span class="comment">// {</span>
<a name="l01750"></a>01750 <span class="comment">// //Cerr &lt;&lt; &quot;Champ_P1NC_implementation::valeur_aux_sommets&quot; &lt;&lt; finl;</span>
<a name="l01751"></a>01751 <span class="comment">// Champ_P1NC&amp; ch=ref_cast(Champ_P1NC, le_champ());</span>
<a name="l01752"></a>01752 <span class="comment">// valeur_P1_L2(ch, dom);</span>
<a name="l01753"></a>01753 <span class="comment">// DoubleTab&amp; champ_sommet=ch.ch_som();</span>
<a name="l01754"></a>01754 <span class="comment">// if (champ_sommet.nb_dim()==1)</span>
<a name="l01755"></a>01755 <span class="comment">// {</span>
<a name="l01756"></a>01756 <span class="comment">// for (int k=0;k&lt;champ_sommet.dimension(0);k++)</span>
<a name="l01757"></a>01757 <span class="comment">// ch_som(k,0)=champ_sommet(k);</span>
<a name="l01758"></a>01758 <span class="comment">// }</span>
<a name="l01759"></a>01759 <span class="comment">// else</span>
<a name="l01760"></a>01760 <span class="comment">// {</span>
<a name="l01761"></a>01761 <span class="comment">// for (int k=0;k&lt;champ_sommet.dimension(0);k++)</span>
<a name="l01762"></a>01762 <span class="comment">// for (int ncomp=0;ncomp&lt;champ_sommet.dimension(1);ncomp++)</span>
<a name="l01763"></a>01763 <span class="comment">// ch_som(k,ncomp)=champ_sommet(k,ncomp);</span>
<a name="l01764"></a>01764 <span class="comment">// }</span>
<a name="l01765"></a>01765 <span class="comment">// return ch_som;</span>
<a name="l01766"></a>01766 <span class="comment">// }</span>
<a name="l01767"></a>01767 
<a name="l01768"></a>01768 <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classChamp__P1NC__implementation.html#a81463cf6fd9628251179b3e24ccbd803">Champ_P1NC_implementation::</a>
<a name="l01769"></a><a class="code" href="classChamp__P1NC__implementation.html#a81463cf6fd9628251179b3e24ccbd803">01769</a> <a class="code" href="classChamp__P1NC__implementation.html#a81463cf6fd9628251179b3e24ccbd803">valeur_aux_sommets_compo</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,
<a name="l01770"></a>01770                          <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; champ_som,
<a name="l01771"></a>01771                          <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l01772"></a>01772 <span class="keyword"></span>{
<a name="l01773"></a>01773   <span class="keyword">const</span> <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; zone_dis = <a class="code" href="classChamp__implementation.html#a1be8c351fc8394e9126755dd557d13ca">zone_dis_base</a>();
<a name="l01774"></a>01774   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; mazone = zone_dis.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l01775"></a>01775   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch = <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l01776"></a>01776 
<a name="l01777"></a>01777   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l01778"></a>01778 
<a name="l01779"></a>01779 
<a name="l01780"></a>01780   <span class="keywordtype">int</span> nb_som = mazone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();
<a name="l01781"></a>01781 
<a name="l01782"></a>01782   <a class="code" href="classIntVect.html">IntVect</a> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>(nb_som);
<a name="l01783"></a>01783   <span class="keywordflow">if</span> (<a class="code" href="Champ__P1NC__implementation_8cpp.html#afbe7fcf4bcc6179a6c6cfc12b0a6d799">methode_calcul_valeurs_sommets</a>&gt;0)
<a name="l01784"></a>01784     {
<a name="l01785"></a>01785       <span class="keywordtype">int</span> nb_elem_tot = mazone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l01786"></a>01786       <span class="keywordtype">int</span> nb_som_elem = mazone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l01787"></a>01787       <span class="keywordtype">int</span> num_elem,num_som,j;
<a name="l01788"></a>01788       champ_som = 0;
<a name="l01789"></a>01789       compteur = 0;
<a name="l01790"></a>01790       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l01791"></a>01791 
<a name="l01792"></a>01792 
<a name="l01793"></a>01793       <a class="code" href="classDoubleVect.html">DoubleVect</a> min_som(nb_som) ;
<a name="l01794"></a>01794       <a class="code" href="classDoubleVect.html">DoubleVect</a> max_som(nb_som) ;
<a name="l01795"></a>01795       <span class="keywordtype">int</span> face_adj,face_glob;
<a name="l01796"></a>01796 
<a name="l01797"></a>01797       <span class="keywordflow">for</span> (j=0; j&lt;nb_som; j++)
<a name="l01798"></a>01798         {
<a name="l01799"></a>01799           min_som(j) = 1.e+30 ;
<a name="l01800"></a>01800           max_som(j) = 1.e-30 ;
<a name="l01801"></a>01801         }
<a name="l01802"></a>01802 
<a name="l01803"></a>01803       <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;nb_elem_tot; num_elem++)
<a name="l01804"></a>01804         {
<a name="l01805"></a>01805           <span class="keywordflow">for</span> (j=0; j&lt;nb_som_elem; j++)
<a name="l01806"></a>01806             {
<a name="l01807"></a>01807               num_som = mazone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(num_elem,j);
<a name="l01808"></a>01808               <span class="keywordflow">if</span>(num_som &lt; nb_som)
<a name="l01809"></a>01809                 {
<a name="l01810"></a>01810                   compteur[num_som]++;
<a name="l01811"></a>01811 
<a name="l01812"></a>01812                   champ_som(num_som) += <a class="code" href="classChamp__P1NC__implementation.html#af03937cefb3ed641c5223a7a00fcb778">valeur_a_sommet_compo</a>(num_som,num_elem,ncomp);
<a name="l01813"></a>01813 
<a name="l01814"></a>01814                   <span class="keywordflow">for</span>(face_adj=0; face_adj&lt;nb_som_elem; face_adj ++)
<a name="l01815"></a>01815                     {
<a name="l01816"></a>01816                       <span class="keywordflow">if</span> (face_adj != j )
<a name="l01817"></a>01817                         {
<a name="l01818"></a>01818                           face_glob = elem_faces(num_elem, face_adj);
<a name="l01819"></a>01819                           min_som(num_som) = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>
<a name="l01820"></a>01820                                              ( ch(face_glob,ncomp),min_som(num_som) ) ;
<a name="l01821"></a>01821                           max_som(num_som) = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>
<a name="l01822"></a>01822                                              ( ch(face_glob,ncomp),max_som(num_som) ) ;
<a name="l01823"></a>01823                         }
<a name="l01824"></a>01824                     }
<a name="l01825"></a>01825 
<a name="l01826"></a>01826                 }
<a name="l01827"></a>01827             }
<a name="l01828"></a>01828         }
<a name="l01829"></a>01829 
<a name="l01830"></a>01830       <span class="keywordflow">for</span> (num_som=0; num_som&lt;nb_som; num_som++)
<a name="l01831"></a>01831         {
<a name="l01832"></a>01832           champ_som(num_som) /= compteur[num_som];
<a name="l01833"></a>01833           <span class="keywordflow">if</span> (<a class="code" href="Champ__P1NC__implementation_8cpp.html#afbe7fcf4bcc6179a6c6cfc12b0a6d799">methode_calcul_valeurs_sommets</a>&gt;1)
<a name="l01834"></a>01834             {
<a name="l01835"></a>01835               <span class="keywordflow">if</span> ( champ_som(num_som) &lt; min_som(num_som) ) champ_som(num_som) = min_som(num_som) ;
<a name="l01836"></a>01836               <span class="keywordflow">if</span> ( champ_som(num_som) &gt; max_som(num_som) ) champ_som(num_som) = max_som(num_som) ;
<a name="l01837"></a>01837             }
<a name="l01838"></a>01838 
<a name="l01839"></a>01839         }
<a name="l01840"></a>01840     }
<a name="l01841"></a>01841   <span class="keywordflow">else</span>
<a name="l01842"></a>01842     {
<a name="l01843"></a>01843       champ_som = 0;
<a name="l01844"></a>01844       compteur = 0;
<a name="l01845"></a>01845       <span class="keywordtype">int</span> nb_faces_tot=zone_VEF.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
<a name="l01846"></a>01846       <span class="keywordtype">int</span> nb_som_face=zone_VEF.<a class="code" href="classZone__VF.html#a990808f967f351edbb83ff11d60b7445" title="renvoie le nombre de sommets par face. Rque : on a suppose que toutes les faces avait le meme nombre ...">nb_som_face</a>();
<a name="l01847"></a>01847       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l01848"></a>01848       <span class="keywordtype">int</span> face;
<a name="l01849"></a>01849       <span class="keywordflow">for</span>(face=0; face&lt;nb_faces_tot; face++)
<a name="l01850"></a>01850         {
<a name="l01851"></a>01851 
<a name="l01852"></a>01852           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_face; isom++)
<a name="l01853"></a>01853             {
<a name="l01854"></a>01854               <span class="keywordtype">int</span> som1=face_sommets(face,isom);
<a name="l01855"></a>01855               <span class="keywordflow">if</span> (som1&lt;nb_som)
<a name="l01856"></a>01856                 {
<a name="l01857"></a>01857                   compteur[som1]++;
<a name="l01858"></a>01858                   champ_som(som1)+=ch(face,ncomp);
<a name="l01859"></a>01859                 }
<a name="l01860"></a>01860             }
<a name="l01861"></a>01861         }
<a name="l01862"></a>01862 
<a name="l01863"></a>01863 
<a name="l01864"></a>01864       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_som=0; num_som&lt;nb_som; num_som++)
<a name="l01865"></a>01865         {
<a name="l01866"></a>01866           champ_som(num_som) /= compteur[num_som];
<a name="l01867"></a>01867         }
<a name="l01868"></a>01868 
<a name="l01869"></a>01869     }
<a name="l01870"></a>01870   <span class="keywordflow">return</span> champ_som;
<a name="l01871"></a>01871 }
<a name="l01872"></a>01872 
<a name="l01873"></a><a class="code" href="classChamp__P1NC__implementation.html#a505f58ef53b201e637aae905fd85e0cc">01873</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__P1NC__implementation.html#a505f58ef53b201e637aae905fd85e0cc">Champ_P1NC_implementation::remplir_coord_noeuds</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; noeuds)<span class="keyword"> const</span>
<a name="l01874"></a>01874 <span class="keyword"></span>{
<a name="l01875"></a>01875   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zvef = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l01876"></a>01876   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xv = zvef.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l01877"></a>01877   <span class="keywordtype">int</span> nb_fac = zvef.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
<a name="l01878"></a>01878   <span class="keywordflow">if</span> ( (xv.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0) == nb_fac ) &amp;&amp; (xv.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) == <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>) )
<a name="l01879"></a>01879     noeuds.<a class="code" href="classDoubleTab.html#afc7cddeeec2c80636e54eaf330ac41ad" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(xv);
<a name="l01880"></a>01880   <span class="keywordflow">else</span>
<a name="l01881"></a>01881     {
<a name="l01882"></a>01882       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans Champ_P1NC_implementation::remplir_coord_noeuds()&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01883"></a>01883       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Les centres de gravite des faces n&#39;ont pas ete calcules&quot;</span> &lt;&lt; finl;
<a name="l01884"></a>01884       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01885"></a>01885     }
<a name="l01886"></a>01886   <span class="keywordflow">return</span> noeuds;
<a name="l01887"></a>01887 }
<a name="l01888"></a>01888 
<a name="l01889"></a>01889 
<a name="l01890"></a><a class="code" href="classChamp__P1NC__implementation.html#a6fe1d5532cedc49f51a3c3608dbc2651">01890</a> <span class="keywordtype">int</span> <a class="code" href="classChamp__P1NC__implementation.html#a6fe1d5532cedc49f51a3c3608dbc2651">Champ_P1NC_implementation::remplir_coord_noeuds_et_polys</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions,
<a name="l01891"></a>01891                                                              <a class="code" href="classIntVect.html">IntVect</a>&amp; polys)<span class="keyword"> const</span>
<a name="l01892"></a>01892 <span class="keyword"></span>{
<a name="l01893"></a>01893   <a class="code" href="classChamp__P1NC__implementation.html#a505f58ef53b201e637aae905fd85e0cc">remplir_coord_noeuds</a>(positions);
<a name="l01894"></a>01894   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zvef=<a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l01895"></a>01895   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins=zvef.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l01896"></a>01896   <span class="keywordtype">int</span> nb_faces=zvef.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
<a name="l01897"></a>01897   polys.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_faces);
<a name="l01898"></a>01898 
<a name="l01899"></a>01899   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i= 0; i&lt; nb_faces; i++)
<a name="l01900"></a>01900     {
<a name="l01901"></a>01901       polys(i)=face_voisins(i, 0);
<a name="l01902"></a>01902     }
<a name="l01903"></a>01903   <span class="keywordflow">return</span> 0;
<a name="l01904"></a>01904 }
<a name="l01905"></a>01905 
<a name="l01906"></a><a class="code" href="classChamp__P1NC__implementation.html#afd4bec4f5b250ce173225d6b6a8c5c22">01906</a> <span class="keywordtype">int</span> <a class="code" href="classChamp__P1NC__implementation.html#afd4bec4f5b250ce173225d6b6a8c5c22">Champ_P1NC_implementation::imprime_P1NC</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l01907"></a>01907 <span class="keyword"></span>{
<a name="l01908"></a>01908   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF=<a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>();
<a name="l01909"></a>01909   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pos_face=zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l01910"></a>01910   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces = zone_VEF.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
<a name="l01911"></a>01911   <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; cha=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>();
<a name="l01912"></a>01912   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val = cha.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l01913"></a>01913   <span class="keywordtype">int</span> fac;
<a name="l01914"></a>01914   os &lt;&lt; nb_faces &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01915"></a>01915   <span class="keywordflow">for</span> (fac=0; fac&lt;nb_faces; fac++)
<a name="l01916"></a>01916     {
<a name="l01917"></a>01917       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
<a name="l01918"></a>01918         os &lt;&lt; pos_face(fac,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pos_face(fac,1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pos_face(fac,2) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;
<a name="l01919"></a>01919       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
<a name="l01920"></a>01920         os &lt;&lt; pos_face(fac,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pos_face(fac,1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;
<a name="l01921"></a>01921       os &lt;&lt; val(fac,ncomp) &lt;&lt; finl;
<a name="l01922"></a>01922     }
<a name="l01923"></a>01923   os &lt;&lt; finl;
<a name="l01924"></a>01924   <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;Champ_P1NC_implementation::imprime_P1NC FIN &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &quot;</span> &lt;&lt; finl;
<a name="l01925"></a>01925   <span class="keywordflow">return</span> 1;
<a name="l01926"></a>01926 }
<a name="l01927"></a>01927 
<a name="l01928"></a><a class="code" href="classChamp__P1NC__implementation.html#a0418cc42fde4d3786ade386b5b816e8f">01928</a> <span class="keywordtype">int</span> <a class="code" href="classChamp__P1NC__implementation.html#a0418cc42fde4d3786ade386b5b816e8f">Champ_P1NC_implementation::fixer_nb_valeurs_nodales</a>(<span class="keywordtype">int</span> n)
<a name="l01929"></a>01929 {
<a name="l01930"></a>01930   <a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>.<a class="code" href="classDoubleTab.html#acb465ae8c9b24990db18002693b42dea" title="met le tableau dans l&#39;etat obtenu par le constructeur par defaut voir DoubleVect::reset()">reset</a>();
<a name="l01931"></a>01931   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dim = <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>().<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>();
<a name="l01932"></a>01932   <span class="keywordflow">if</span> (nb_dim &gt; 1)
<a name="l01933"></a>01933     <a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, <a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().nb_comp());
<a name="l01934"></a>01934   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom = <a class="code" href="classChamp__P1NC__implementation.html#a466ec2614b7af2152482bb253c7cb4f9">zone_vef</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l01935"></a>01935   dom.<a class="code" href="classDomaine.html#a32c7de9f9e8e78e3d5ea68715b2ceb2b" title="Cree un tableau ayant une &quot;ligne&quot; par sommet du maillage. Voir MD_Vector_tools::creer_tableau_distrib...">creer_tableau_sommets</a>(<a class="code" href="classChamp__P1NC__implementation.html#a87a50a3c8cceb34eef5114e0358bedf5">ch_som_</a>);
<a name="l01936"></a>01936   <a class="code" href="classChamp__P1NC__implementation.html#a0d930998a5c25e3e6ff01bec5bd561ca">ch_som_vect_</a>.<a class="code" href="classDoubleVect.html#a990500e5bf63a8ca55fd833d111e135c" title="met l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut. (voir ArrOfDouble::reset())">reset</a>();
<a name="l01937"></a>01937   dom.<a class="code" href="classDomaine.html#a32c7de9f9e8e78e3d5ea68715b2ceb2b" title="Cree un tableau ayant une &quot;ligne&quot; par sommet du maillage. Voir MD_Vector_tools::creer_tableau_distrib...">creer_tableau_sommets</a>(<a class="code" href="classChamp__P1NC__implementation.html#a0d930998a5c25e3e6ff01bec5bd561ca">ch_som_vect_</a>);
<a name="l01938"></a>01938   <span class="keywordflow">return</span> n;
<a name="l01939"></a>01939 }
<a name="l01940"></a>01940 <span class="comment">// Ajout de methodes pour le filtrage L2 en //</span>
<a name="l01941"></a><a class="code" href="classChamp__P1NC__implementation.html#a0d8b7ab00a42ade15e4b650018f60a67">01941</a> <span class="keywordtype">int</span> <a class="code" href="classChamp__P1NC__implementation.html#a0d8b7ab00a42ade15e4b650018f60a67">Champ_P1NC_implementation::nb_colonnes_tot</a>()
<a name="l01942"></a>01942 {
<a name="l01943"></a>01943   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>()))
<a name="l01944"></a>01944     {
<a name="l01945"></a>01945       <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
<a name="l01946"></a>01946 
<a name="l01947"></a>01947       <span class="keywordflow">return</span> cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>().<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>();
<a name="l01948"></a>01948     }
<a name="l01949"></a>01949   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>()))
<a name="l01950"></a>01950     {
<a name="l01951"></a>01951       <a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>&amp; cha = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
<a name="l01952"></a>01952       <span class="keywordflow">return</span> cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>().<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>();
<a name="l01953"></a>01953     }
<a name="l01954"></a>01954 
<a name="l01955"></a>01955   <span class="keywordflow">return</span> 0;
<a name="l01956"></a>01956 }
<a name="l01957"></a>01957 
<a name="l01958"></a><a class="code" href="classChamp__P1NC__implementation.html#ac15f4f26bdf2c63b5786305ad64b2007">01958</a> <span class="keywordtype">int</span> <a class="code" href="classChamp__P1NC__implementation.html#ac15f4f26bdf2c63b5786305ad64b2007">Champ_P1NC_implementation::nb_colonnes</a>()
<a name="l01959"></a>01959 {
<a name="l01960"></a>01960   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>()))
<a name="l01961"></a>01961     {
<a name="l01962"></a>01962       <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; cha =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
<a name="l01963"></a>01963       <span class="keywordflow">return</span> cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>().<a class="code" href="classDoubleVect.html#a4a6987db458541cdcd10495955f25263" title="Taille de l&#39;espace &quot;reel&quot; du vecteur. (si md_vector_ est nul, cette valeur est identique a size_arr...">size_reelle</a>();
<a name="l01964"></a>01964     }
<a name="l01965"></a>01965   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>()))
<a name="l01966"></a>01966     {
<a name="l01967"></a>01967       <a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>&amp; cha =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Fonc__P1NC.html" title="classe Champ_Fonc_P1NC">Champ_Fonc_P1NC</a>,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
<a name="l01968"></a>01968       <span class="keywordflow">return</span> cha.<a class="code" href="classChamp__P1NC__implementation.html#a4505e6d941850aecad37b8b039990401">ch_som_vect</a>().<a class="code" href="classDoubleVect.html#a4a6987db458541cdcd10495955f25263" title="Taille de l&#39;espace &quot;reel&quot; du vecteur. (si md_vector_ est nul, cette valeur est identique a size_arr...">size_reelle</a>();
<a name="l01969"></a>01969     }
<a name="l01970"></a>01970 
<a name="l01971"></a>01971   <span class="keywordflow">return</span> 0;
<a name="l01972"></a>01972 }
<a name="l01973"></a>01973 
<a name="l01974"></a>01974 
<a name="l01975"></a><a class="code" href="classChamp__P1NC__implementation.html#a5badd5dee68ffbd7e63228509fe1cb18">01975</a> <span class="keywordtype">void</span> <a class="code" href="classChamp__P1NC__implementation.html#a5badd5dee68ffbd7e63228509fe1cb18">Champ_P1NC_implementation::dimensionner_Mat_Bloc_Morse_Sym</a>(<a class="code" href="classMatrice.html">Matrice</a>&amp; matrice_tmp)
<a name="l01976"></a>01976 {
<a name="l01977"></a>01977 <span class="comment">// modif specific au Champ_P1NC_implementation</span>
<a name="l01978"></a>01978   <span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; la_matrice = <a class="code" href="classChamp__P1NC__implementation.html#af1dfbfbb6b563d129a0320f96b02b6b6">get_MatP1NC2P1_L2</a>();
<a name="l01979"></a>01979 <span class="comment">// </span>
<a name="l01980"></a>01980   <span class="keywordtype">int</span> n1 = <a class="code" href="classChamp__P1NC__implementation.html#a0d8b7ab00a42ade15e4b650018f60a67">nb_colonnes_tot</a>();
<a name="l01981"></a>01981   <span class="keywordtype">int</span> n2 = <a class="code" href="classChamp__P1NC__implementation.html#ac15f4f26bdf2c63b5786305ad64b2007">nb_colonnes</a>();
<a name="l01982"></a>01982   <span class="keywordtype">int</span> iligne;
<a name="l01983"></a>01983   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1=la_matrice.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>();
<a name="l01984"></a>01984   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2=la_matrice.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>();
<a name="l01985"></a>01985 
<a name="l01986"></a>01986   matrice_tmp.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Matrice_Bloc&quot;</span>);
<a name="l01987"></a>01987   <a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>&amp; matrice=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>,matrice_tmp.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l01988"></a>01988   matrice.<a class="code" href="classMatrice__Bloc.html#a1db7c549cc1be958d5f00c29cd0f3a8c">dimensionner</a>(1,2);
<a name="l01989"></a>01989   matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,0).<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Matrice_Morse_Sym&quot;</span>);
<a name="l01990"></a>01990   matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,1).<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Matrice_Morse&quot;</span>);
<a name="l01991"></a>01991 
<a name="l01992"></a>01992   <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; MBrr =  <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,0).<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l01993"></a>01993   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; MBrv =  <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>,matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,1).<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l01994"></a>01994   MBrr.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n2,0);
<a name="l01995"></a>01995   MBrv.dimensionner(n2,0);
<a name="l01996"></a>01996 
<a name="l01997"></a>01997   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1RR=MBrr.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l01998"></a>01998   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2RR=MBrr.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l01999"></a>01999   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1RV=MBrv.get_set_tab1();
<a name="l02000"></a>02000   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2RV=MBrv.get_set_tab2();
<a name="l02001"></a>02001 
<a name="l02002"></a>02002   <a class="code" href="classIntVect.html">IntVect</a> compteur_MBrr(n2);
<a name="l02003"></a>02003   <a class="code" href="classIntVect.html">IntVect</a> compteur_MBrv(n2);
<a name="l02004"></a>02004   compteur_MBrr=0;
<a name="l02005"></a>02005   compteur_MBrv=0;
<a name="l02006"></a>02006 
<a name="l02007"></a>02007 <span class="comment">// On parcours les lignes de la_matrice pour compter les elements</span>
<a name="l02008"></a>02008 <span class="comment">// non nuls de chaque ligne</span>
<a name="l02009"></a>02009   <span class="keywordtype">int</span> jcolonne;
<a name="l02010"></a>02010   <span class="keywordflow">for</span> (iligne=0; iligne&lt;n2; iligne++)
<a name="l02011"></a>02011     {
<a name="l02012"></a>02012       <span class="keywordtype">int</span> k;
<a name="l02013"></a>02013       <span class="keywordflow">for</span> ( k=tab1(iligne)-1; k&lt;tab1(iligne+1)-1; k++)
<a name="l02014"></a>02014         {
<a name="l02015"></a>02015           jcolonne = tab2(k)-1;
<a name="l02016"></a>02016           <span class="keywordflow">if</span> (jcolonne &lt; n2)
<a name="l02017"></a>02017             {
<a name="l02018"></a>02018 <span class="comment">// l&#39;element correspondant est dans la partie RR de la_matrice</span>
<a name="l02019"></a>02019               <span class="keywordflow">if</span> ((jcolonne &gt;= iligne) &amp;&amp; (jcolonne &lt; n2))
<a name="l02020"></a>02020                 {
<a name="l02021"></a>02021 <span class="comment">// l&#39;element correspondant est  situe au dessus de la diagonale de la_matrice</span>
<a name="l02022"></a>02022                   compteur_MBrr(iligne)++;
<a name="l02023"></a>02023                 }
<a name="l02024"></a>02024             }
<a name="l02025"></a>02025           <span class="keywordflow">else</span>
<a name="l02026"></a>02026             {
<a name="l02027"></a>02027 <span class="comment">// l&#39;element correspondant est dans la partie RV de la_matrice</span>
<a name="l02028"></a>02028               compteur_MBrv(iligne)++;
<a name="l02029"></a>02029             }
<a name="l02030"></a>02030         }
<a name="l02031"></a>02031     }
<a name="l02032"></a>02032 
<a name="l02033"></a>02033 
<a name="l02034"></a>02034 <span class="comment">// On remplie tab1RR et tab1RV</span>
<a name="l02035"></a>02035   tab1RR(0)=1;
<a name="l02036"></a>02036   tab1RV(0)=1;
<a name="l02037"></a>02037   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n2; i++)
<a name="l02038"></a>02038     {
<a name="l02039"></a>02039       tab1RR(i+1)=compteur_MBrr(i)+tab1RR(i);
<a name="l02040"></a>02040       tab1RV(i+1)=compteur_MBrv(i)+tab1RV(i);
<a name="l02041"></a>02041     }
<a name="l02042"></a>02042 <span class="comment">// On dimensionne tab2RR et tab2RV</span>
<a name="l02043"></a>02043   MBrr.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n2,tab1RR(n2)-1);
<a name="l02044"></a>02044   MBrv.dimensionner(n2,n1-n2,tab1RV(n2)-1);
<a name="l02045"></a>02045 
<a name="l02046"></a>02046 <span class="comment">// On remplit tab2RR et tab2RV</span>
<a name="l02047"></a>02047   <span class="keywordtype">int</span> compteurRR,compteurRV;
<a name="l02048"></a>02048   <span class="keywordflow">for</span> (iligne=0; iligne&lt;n2; iligne++)
<a name="l02049"></a>02049     {
<a name="l02050"></a>02050       <span class="keywordtype">int</span> k;
<a name="l02051"></a>02051       compteurRR = tab1RR(iligne)-1;
<a name="l02052"></a>02052       compteurRV = tab1RV(iligne)-1;
<a name="l02053"></a>02053       <span class="keywordflow">for</span> ( k=tab1(iligne)-1; k&lt;tab1(iligne+1)-1; k++)
<a name="l02054"></a>02054         {
<a name="l02055"></a>02055           jcolonne = tab2(k)-1;
<a name="l02056"></a>02056           <span class="keywordflow">if</span> (jcolonne &lt; n2)
<a name="l02057"></a>02057             {
<a name="l02058"></a>02058 <span class="comment">// l&#39;element correspondant est dans la partie RR de la_matrice</span>
<a name="l02059"></a>02059               <span class="keywordflow">if</span> ((jcolonne &gt;= iligne) &amp;&amp; (jcolonne &lt; n2))
<a name="l02060"></a>02060                 {
<a name="l02061"></a>02061 <span class="comment">// l&#39;element correspondant est  situe au dessus de la diagonale de la_matrice</span>
<a name="l02062"></a>02062                   tab2RR(compteurRR) = tab2(k);
<a name="l02063"></a>02063                   compteurRR++;
<a name="l02064"></a>02064                 }
<a name="l02065"></a>02065             }
<a name="l02066"></a>02066           <span class="keywordflow">else</span>
<a name="l02067"></a>02067             {
<a name="l02068"></a>02068 <span class="comment">// l&#39;element correspondant est dans la partie RV de la_matrice</span>
<a name="l02069"></a>02069               tab2RV(compteurRV) = tab2(k)-n2;
<a name="l02070"></a>02070               compteurRV++;
<a name="l02071"></a>02071             }
<a name="l02072"></a>02072         }
<a name="l02073"></a>02073     }
<a name="l02074"></a>02074 }
<a name="l02075"></a>02075 
<a name="l02076"></a><a class="code" href="classChamp__P1NC__implementation.html#a80e98cf9dfa018d6f3d18608924c8d57">02076</a> <span class="keywordtype">void</span> <a class="code" href="classChamp__P1NC__implementation.html#a80e98cf9dfa018d6f3d18608924c8d57">Champ_P1NC_implementation::Mat_Morse_to_Mat_Bloc</a>(<a class="code" href="classMatrice.html">Matrice</a>&amp; matrice_tmp)
<a name="l02077"></a>02077 {
<a name="l02078"></a>02078 <span class="comment">// </span>
<a name="l02079"></a>02079   <span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; la_matrice = <a class="code" href="classChamp__P1NC__implementation.html#af1dfbfbb6b563d129a0320f96b02b6b6">get_MatP1NC2P1_L2</a>();
<a name="l02080"></a>02080 <span class="comment">// </span>
<a name="l02081"></a>02081 
<a name="l02082"></a>02082   <span class="keywordtype">int</span> n1 = <a class="code" href="classChamp__P1NC__implementation.html#a0d8b7ab00a42ade15e4b650018f60a67">nb_colonnes_tot</a>();
<a name="l02083"></a>02083   <span class="keywordtype">int</span> n2 = <a class="code" href="classChamp__P1NC__implementation.html#ac15f4f26bdf2c63b5786305ad64b2007">nb_colonnes</a>();
<a name="l02084"></a>02084 
<a name="l02085"></a>02085   <a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>&amp; matrice= <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>,matrice_tmp.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l02086"></a>02086   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; MBrr =  <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>,matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,0).<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l02087"></a>02087   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; MBrv =  <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>,matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,1).<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l02088"></a>02088 
<a name="l02089"></a>02089   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1RR=MBrr.get_set_tab1();
<a name="l02090"></a>02090   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2RR=MBrr.get_set_tab2();
<a name="l02091"></a>02091   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; coeffRR=MBrr.get_set_coeff();
<a name="l02092"></a>02092   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1RV=MBrv.get_set_tab1();
<a name="l02093"></a>02093   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2RV=MBrv.get_set_tab2();
<a name="l02094"></a>02094   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; coeffRV=MBrv.get_set_coeff();
<a name="l02095"></a>02095 
<a name="l02096"></a>02096   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> ligne_tmp(n1);
<a name="l02097"></a>02097   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n2; i++)
<a name="l02098"></a>02098     {
<a name="l02099"></a>02099       <span class="keywordtype">int</span> k;
<a name="l02100"></a>02100 <span class="comment">// On recopie le premier bloc de la matrice dans un tableau :</span>
<a name="l02101"></a>02101 <span class="comment">// ligne_tmp = 0;</span>
<a name="l02102"></a>02102       <span class="keywordflow">for</span> ( k=la_matrice.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i)-1; k&lt;la_matrice.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i+1)-1; k++)
<a name="l02103"></a>02103         ligne_tmp(la_matrice.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>()(k) - 1) = la_matrice.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>()(k);
<a name="l02104"></a>02104 
<a name="l02105"></a>02105 <span class="comment">// On complete la partie reelle de la matrice</span>
<a name="l02106"></a>02106       <span class="keywordflow">for</span> ( k=tab1RR(i)-1; k&lt;tab1RR(i+1)-1; k++)
<a name="l02107"></a>02107         coeffRR[k] = ligne_tmp(tab2RR[k] - 1);
<a name="l02108"></a>02108 
<a name="l02109"></a>02109 <span class="comment">// On complete la partie virtuelle</span>
<a name="l02110"></a>02110       <span class="keywordflow">for</span> ( k=tab1RV(i)-1; k&lt;tab1RV(i+1)-1; k++)
<a name="l02111"></a>02111         coeffRV[k] = ligne_tmp(n2 + tab2RV[k] - 1);
<a name="l02112"></a>02112     }
<a name="l02113"></a>02113 
<a name="l02114"></a>02114 
<a name="l02115"></a>02115   <span class="comment">/*  Cerr&lt;&lt;&quot;Impression de la_matrice&quot;&lt;&lt;finl;</span>
<a name="l02116"></a>02116 <span class="comment">      la_matrice.imprimer_formatte(Cerr);</span>
<a name="l02117"></a>02117 <span class="comment">      Cerr&lt;&lt;&quot;Impression de MBrr&quot;&lt;&lt;finl;</span>
<a name="l02118"></a>02118 <span class="comment">      MBrr.imprimer_formatte(Cerr);</span>
<a name="l02119"></a>02119 <span class="comment">      Cerr&lt;&lt;&quot;Impression de MBrv&quot;&lt;&lt;finl;</span>
<a name="l02120"></a>02120 <span class="comment">      MBrv.imprimer_formatte(Cerr);*/</span>
<a name="l02121"></a>02121 
<a name="l02122"></a>02122   <span class="comment">/*  Debog::verifier_Mat_faces(&quot;avant resolution systeme : la_matrice&quot;,la_matrice);</span>
<a name="l02123"></a>02123 <span class="comment">      Debog::verifier_Mat_faces(&quot;avant resolution systeme : MBrr&quot;,MBrr);*/</span>
<a name="l02124"></a>02124 }
<a name="l02125"></a>02125 
<a name="l02126"></a>02126 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:42 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
