<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VDF/Operateurs/Operateurs_Diff/Op_Diff_VDF_Face_Axi.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VDF/Operateurs/Operateurs_Diff/Op_Diff_VDF_Face_Axi.cpp</div>  </div>
</div>
<div class="contents">
<a href="Op__Diff__VDF__Face__Axi_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Op_Diff_VDF_Face_Axi.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VDF/Operateurs/Operateurs_Diff</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/25</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Op__Diff__VDF__Face__Axi_8h.html">Op_Diff_VDF_Face_Axi.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Champ__base_8h.html">Champ_base.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Inc_8h.html">Champ_Inc.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="SFichier_8h.html">SFichier.h</a>&gt;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a><a class="code" href="Op__Diff__VDF__Face__Axi_8cpp.html#a8e88a90be09b32edef08be20e42508d8">00029</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classOp__Diff__VDF__Face__Axi.html" title="class Op_Diff_VDF_Face_Axi Cette classe represente l&#39;operateur de diffusion associe aux equations de ...">Op_Diff_VDF_Face_Axi</a>,<span class="stringliteral">&quot;Op_Diff_VDF_const_Face_Axi&quot;</span>,<a class="code" href="classOp__Diff__VDF__Face__base.html" title="class Op_Diff_VDF_Face_base Cette classe represente l&#39;operateur de diffusion associe a une equation d...">Op_Diff_VDF_Face_base</a>);
<a name="l00030"></a>00030 
<a name="l00031"></a><a class="code" href="classOp__Diff__VDF__Face__Axi.html#a3e81438607b2d2e7d73e298dbea50800">00031</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a3e81438607b2d2e7d73e298dbea50800" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Diff_VDF_Face_Axi::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00032"></a>00032 <span class="keyword"></span>{
<a name="l00033"></a>00033   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() ;
<a name="l00034"></a>00034 }
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="classOp__Diff__VDF__Face__Axi.html#a194f7b2bbadb0e0e2c629adb0589a96e">00036</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a194f7b2bbadb0e0e2c629adb0589a96e" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Diff_VDF_Face_Axi::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s )
<a name="l00037"></a>00037 {
<a name="l00038"></a>00038   <span class="keywordflow">return</span> s ;
<a name="l00039"></a>00039 }
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="classOp__Diff__VDF__Face__Axi.html#a51b92fabbc492d05267e1128e7353032">00041</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a51b92fabbc492d05267e1128e7353032" title="complete l&#39;iterateur et l&#39;evaluateur">Op_Diff_VDF_Face_Axi::associer</a>(<span class="keyword">const</span> <a class="code" href="classZone__dis.html" title="classe Zone_dis Classe generique de la hierarchie des zones discretisees. Un objet de type Zone_dis p...">Zone_dis</a>&amp; zone_dis,
<a name="l00042"></a>00042                                     <span class="keyword">const</span> <a class="code" href="classZone__Cl__dis.html" title="classe Zone_Cl_dis Classe generique de la hierarchie des conditions aux limites discretisees. Un objet Zone_Cl_dis peut referencer n&#39;importe quel derivant de Zone_Cl_dis_base. La plupart des methodes appellent les methodes de l&#39;objet Probleme sous-jacent via la methode valeur() declaree grace a la macro Declare_deriv().;">Zone_Cl_dis</a>&amp; zone_cl_dis,
<a name="l00043"></a>00043                                     <span class="keyword">const</span> <a class="code" href="classChamp__Inc.html">Champ_Inc</a>&amp; ch_transporte)
<a name="l00044"></a>00044 {
<a name="l00045"></a>00045   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>,zone_dis.<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>());
<a name="l00046"></a>00046   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; zclvdf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>,zone_cl_dis.<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00047"></a>00047   <span class="keyword">const</span> <a class="code" href="classChamp__Face.html" title="class Champ_Face Cette classe sert a representer un champ vectoriel dont on ne calcule que les compos...">Champ_Face</a>&amp; inco = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Face.html" title="class Champ_Face Cette classe sert a representer un champ vectoriel dont on ne calcule que les compos...">Champ_Face</a>,ch_transporte.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>());
<a name="l00048"></a>00048   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a894f2b636a46cb73bfcba0af62322332">la_zone_vdf</a> = zvdf;
<a name="l00049"></a>00049   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ab1d1205ba2670a75075cebcb2e3b00b1">la_zcl_vdf</a> = zclvdf;
<a name="l00050"></a>00050   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8404cff9b08d2a9afeff8fb5d221257f">inconnue</a> = inco;
<a name="l00051"></a>00051 
<a name="l00052"></a>00052   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>.<a class="code" href="classDoubleVect.html#a2b45ece955d7d57746fa32b5a6a89cc2" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(zvdf.<a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>());
<a name="l00053"></a>00053   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>.<a class="code" href="classDoubleVect.html#a2b45ece955d7d57746fa32b5a6a89cc2" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(zvdf.<a class="code" href="classZone__VF.html#a64f0b549e5aea1656855113e3510f418">volumes_entrelaces</a>());
<a name="l00054"></a>00054   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a893731253b6dd11a1dcadc409f76b44a">orientation</a>.<a class="code" href="classIntVect.html#a165455689c6d27ac93c9cf8823e47a0f" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(zvdf.<a class="code" href="classZone__VDF.html#a9a9bd747218e463b3408a3590c12814c" title="inline DoubleVect&amp; Zone_VDF::porosite_face() { return porosite_face_; }">orientation</a>());
<a name="l00055"></a>00055   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>.<a class="code" href="classDoubleVect.html#a2b45ece955d7d57746fa32b5a6a89cc2" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(zvdf.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>());
<a name="l00056"></a>00056   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad92fbadfb228bed9c662b8146df61a65">xp</a>.<a class="code" href="classDoubleTab.html#afc7cddeeec2c80636e54eaf330ac41ad" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(zvdf.<a class="code" href="classZone__VF.html#a87a29f0223c71256a25ee343c9277599">xp</a>());
<a name="l00057"></a>00057   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>.<a class="code" href="classDoubleTab.html#afc7cddeeec2c80636e54eaf330ac41ad" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(zvdf.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>());
<a name="l00058"></a>00058   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>.<a class="code" href="classIntTab.html#ae9ae8fefb1fda4a5c035229ab420a96d" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(zvdf.<a class="code" href="classZone__VDF.html#a5383bb6bad103f0b37e3862e112f9370">Qdm</a>());
<a name="l00059"></a>00059   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#af192843bdd789be8b3c4ea74946804e0">face_voisins</a>.<a class="code" href="classIntTab.html#ae9ae8fefb1fda4a5c035229ab420a96d" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(zvdf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>());
<a name="l00060"></a>00060   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>.<a class="code" href="classIntTab.html#ae9ae8fefb1fda4a5c035229ab420a96d" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(zvdf.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>());
<a name="l00061"></a>00061   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a162b673e7bcaaf891fa1a3584a3abdf9">type_arete_bord</a>.<a class="code" href="classIntVect.html#a165455689c6d27ac93c9cf8823e47a0f" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(zclvdf.type_arete_bord());
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 }
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="comment">//</span><span class="comment"></span>
<a name="l00066"></a>00066 <span class="comment">//! associe le champ de diffusivite</span>
<a name="l00067"></a><a class="code" href="classOp__Diff__VDF__Face__Axi.html#a67732032113ce3368c67bf6e0c7001c2">00067</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a67732032113ce3368c67bf6e0c7001c2" title="associe le champ de diffusivite">Op_Diff_VDF_Face_Axi::associer_diffusivite</a>(<span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; diffu)
<a name="l00068"></a>00068 {
<a name="l00069"></a>00069   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ae17896b36dea744dea1baa1dfaaa423f">diffusivite_</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Uniforme.html" title="classe Champ_Uniforme Represente un champ constant dans l&#39;espace et dans le temps.">Champ_Uniforme</a>, diffu);
<a name="l00070"></a>00070 }
<a name="l00071"></a>00071 
<a name="l00072"></a><a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad8747397a4cc7cd30a169d3e48bd8b95">00072</a> <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad8747397a4cc7cd30a169d3e48bd8b95">Op_Diff_VDF_Face_Axi::diffusivite</a>()<span class="keyword"> const</span>
<a name="l00073"></a>00073 <span class="keyword"></span>{
<a name="l00074"></a>00074   <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ae17896b36dea744dea1baa1dfaaa423f">diffusivite_</a>;
<a name="l00075"></a>00075 }
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="classOp__Diff__VDF__Face__Axi.html#ae02394dcd064883759eb1ba615abd679">00077</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ae02394dcd064883759eb1ba615abd679" title="ajoute la contribution de la diffusion au second membre resu renvoie resu">Op_Diff_VDF_Face_Axi::ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00078"></a>00078 <span class="keyword"></span>{
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   <span class="keywordflow">if</span> (inco.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>() &gt; 1)
<a name="l00081"></a>00081     {
<a name="l00082"></a>00082       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans Op_Diff_VDF_Face_Axi::ajouter&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00083"></a>00083       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On ne sait pas traiter la diffusion d&#39;un Champ_Face a plusieurs inconnues&quot;</span> &lt;&lt; finl;
<a name="l00084"></a>00084       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00085"></a>00085     }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a894f2b636a46cb73bfcba0af62322332">la_zone_vdf</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00088"></a>00088   <span class="keywordtype">double</span> db_diffusivite = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ae17896b36dea744dea1baa1dfaaa423f">diffusivite_</a>.<a class="code" href="classRef__Champ__Uniforme.html#a5d1796bf8b3ee05cd2f78c0039fc4be5">valeur</a>()(0,0);
<a name="l00089"></a>00089   <span class="keywordtype">double</span> d_teta;
<a name="l00090"></a>00090   <span class="keywordtype">double</span> tau11, tau22, tau12, tau21, R;
<a name="l00091"></a>00091   <span class="keywordtype">double</span> tau13, tau31, tau23, tau32, tau33;
<a name="l00092"></a>00092   <span class="keywordtype">int</span> fac1,fac2,fac3,fac4;
<a name="l00093"></a>00093   <span class="keywordtype">double</span> coef_laplacien_axi;
<a name="l00094"></a>00094 <span class="comment">// int nb_faces_elem = zvdf.zone().nb_faces_elem();</span>
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <span class="keywordtype">double</span> deux_pi = <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>*2.0;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <span class="keywordtype">int</span> ndeb ;
<a name="l00099"></a>00099   <span class="keywordtype">int</span> nfin ;
<a name="l00100"></a>00100 
<a name="l00101"></a>00101   <span class="keywordtype">double</span> flux;
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 <span class="comment">// Boucle sur les elements</span>
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <span class="keywordtype">int</span> fx0,fx1,fy0,fy1;
<a name="l00106"></a>00106   <span class="keywordtype">double</span> flux_X,flux_Y;
<a name="l00107"></a>00107   <span class="keywordtype">int</span> num_elem;
<a name="l00108"></a>00108   <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;zvdf.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); num_elem++)
<a name="l00109"></a>00109     {
<a name="l00110"></a>00110       fx0 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>(num_elem,0);
<a name="l00111"></a>00111       fx1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>(num_elem,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00112"></a>00112       fy0 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>(num_elem,1);
<a name="l00113"></a>00113       fy1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>(num_elem,1+<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 <span class="comment">// Calcul de tau11</span>
<a name="l00116"></a>00116       tau11 = (inco[fx1]-inco[fx0])/(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fx1,0) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fx0,0));
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="comment">// Calcul de tau22</span>
<a name="l00119"></a>00119       R = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad92fbadfb228bed9c662b8146df61a65">xp</a>(num_elem,0);
<a name="l00120"></a>00120       d_teta = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fy1,1) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fy0,1);
<a name="l00121"></a>00121       <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00122"></a>00122         d_teta += deux_pi;
<a name="l00123"></a>00123       tau22 =  (inco[fy1]-inco[fy0])/(R*d_teta);
<a name="l00124"></a>00124 <span class="comment">// termes supplementaires en axi</span>
<a name="l00125"></a>00125       tau22 += 0.5*(inco[fx0]+inco[fx1])/R;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 
<a name="l00128"></a>00128       flux_X = tau11*db_diffusivite*0.5*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fx0)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fx1));
<a name="l00129"></a>00129       flux_Y = tau22*db_diffusivite*0.5*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fy0)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fy1));
<a name="l00130"></a>00130 
<a name="l00131"></a>00131       resu[fx0] += flux_X;
<a name="l00132"></a>00132       resu[fx1] -= flux_X;
<a name="l00133"></a>00133       resu[fy0] += flux_Y;
<a name="l00134"></a>00134       resu[fy1] -= flux_Y;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00137"></a>00137 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00138"></a>00138 <span class="comment">// coef_laplacien_axi = -0.5*tau22*db_diffusivite;</span>
<a name="l00139"></a>00139 <span class="comment">// resu[fx0] += coef_laplacien_axi*volumes_entrelaces(fx0)*porosite(fx0)/xv(fx0,0);</span>
<a name="l00140"></a>00140 <span class="comment">// resu[fx1] += coef_laplacien_axi*volumes_entrelaces(fx1)*porosite(fx1)/xv(fx1,0);</span>
<a name="l00141"></a>00141       coef_laplacien_axi = +0.5*tau22*db_diffusivite;
<a name="l00142"></a>00142       resu[fx0] -= coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fx0)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fx0)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fx0,0);
<a name="l00143"></a>00143       resu[fx1] -= coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fx1)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fx1)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fx1,0);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145     }
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00148"></a>00148     {
<a name="l00149"></a>00149       <span class="keywordtype">int</span> fz0,fz1;
<a name="l00150"></a>00150       <span class="keywordtype">double</span> flux_Z;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152       <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;zvdf.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); num_elem++)
<a name="l00153"></a>00153         {
<a name="l00154"></a>00154           fz0 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>(num_elem,2);
<a name="l00155"></a>00155           fz1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>(num_elem,2+<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00156"></a>00156 
<a name="l00157"></a>00157 <span class="comment">// Calcul de tau33</span>
<a name="l00158"></a>00158           tau33 = (inco[fz1]-inco[fz0])/(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fz1,2) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fz0,2));
<a name="l00159"></a>00159 
<a name="l00160"></a>00160           flux_Z = tau33*db_diffusivite*0.5*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fz0)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fz1));
<a name="l00161"></a>00161 
<a name="l00162"></a>00162           resu[fz0] += flux_Z;
<a name="l00163"></a>00163           resu[fz1] -= flux_Z;
<a name="l00164"></a>00164         }
<a name="l00165"></a>00165     }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 <span class="comment">// Boucle sur les aretes bord</span>
<a name="l00168"></a>00168 
<a name="l00169"></a>00169   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aabaf760b182f6b283faec8342f943650">ajouter_bord</a>(inco, resu);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="comment">// Boucle sur les aretes mixtes et internes</span>
<a name="l00172"></a>00172 
<a name="l00173"></a>00173   ndeb = zvdf.<a class="code" href="classZone__VDF.html#a1197e179e848063721cdf2121837bbc6">premiere_arete_mixte</a>();
<a name="l00174"></a>00174   nfin = zvdf.<a class="code" href="classZone__VDF.html#add0341183f527326bc526c92bbb19225">nb_aretes</a>();
<a name="l00175"></a>00175   <span class="keywordtype">int</span> ori1, ori3, n_arete;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l00178"></a>00178     {
<a name="l00179"></a>00179 
<a name="l00180"></a>00180       fac1=<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,0);
<a name="l00181"></a>00181       fac2=<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,1);
<a name="l00182"></a>00182       fac3=<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,2);
<a name="l00183"></a>00183       fac4=<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,3);
<a name="l00184"></a>00184       ori1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a893731253b6dd11a1dcadc409f76b44a">orientation</a>(fac1);
<a name="l00185"></a>00185       ori3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a893731253b6dd11a1dcadc409f76b44a">orientation</a>(fac3);
<a name="l00186"></a>00186 
<a name="l00187"></a>00187       <span class="keywordflow">if</span> (ori1 == 1)  <span class="comment">//!&lt; (seule possibilite : ori3 =0)  Arete XY</span>
<a name="l00188"></a>00188 <span class="comment"></span>        {
<a name="l00189"></a>00189 <span class="comment">// Calcul de tau21</span>
<a name="l00190"></a>00190           R = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,0);
<a name="l00191"></a>00191           d_teta = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac4,1) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,1);
<a name="l00192"></a>00192           <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00193"></a>00193             d_teta += deux_pi;
<a name="l00194"></a>00194           tau21 = (inco(fac4)-inco(fac3))/(R*d_teta);
<a name="l00195"></a>00195 <span class="comment">// Terme supplementaire en axi</span>
<a name="l00196"></a>00196           tau21 -= 0.5*(inco[fac1]+inco[fac2])/R;
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 <span class="comment">// flux de tau21 sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00199"></a>00199 
<a name="l00200"></a>00200           flux = db_diffusivite*tau21*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00201"></a>00201                  *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00202"></a>00202 
<a name="l00203"></a>00203 
<a name="l00204"></a>00204           resu(fac3) += flux;
<a name="l00205"></a>00205           resu(fac4) -= flux;
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00208"></a>00208 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00209"></a>00209 
<a name="l00210"></a>00210           coef_laplacien_axi = 0.5*db_diffusivite*tau21;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212           resu(fac1) += coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fac1)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l00213"></a>00213           resu(fac2) += coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fac2)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac2,0);
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 <span class="comment">// Calcul de tau12</span>
<a name="l00216"></a>00216           tau12 = (inco(fac2)-inco(fac1))/(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac2,0) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0));
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="comment">// flux de tau12 sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00219"></a>00219 
<a name="l00220"></a>00220           flux = db_diffusivite*tau12*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac3)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac4))*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac3)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac4));
<a name="l00221"></a>00221 
<a name="l00222"></a>00222           resu(fac1) += flux;
<a name="l00223"></a>00223           resu(fac2) -= flux;
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3 == 1) <span class="comment">//!&lt; (seule possibilite ori1 = 2) arete YZ</span>
<a name="l00226"></a>00226 <span class="comment"></span>        {
<a name="l00227"></a>00227 
<a name="l00228"></a>00228 <span class="comment">// Calcul de tau32</span>
<a name="l00229"></a>00229           tau32 = (inco(fac4)-inco(fac3))/(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac4,2) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,2));
<a name="l00230"></a>00230 
<a name="l00231"></a>00231 <span class="comment">// flux de tau32 sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00232"></a>00232           flux = db_diffusivite*tau32*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00233"></a>00233                  *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00234"></a>00234 
<a name="l00235"></a>00235           resu(fac3) += flux;
<a name="l00236"></a>00236           resu(fac4) -= flux;
<a name="l00237"></a>00237 
<a name="l00238"></a>00238 <span class="comment">// Calcul de tau23</span>
<a name="l00239"></a>00239           R = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l00240"></a>00240           d_teta = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac2,1) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,1);
<a name="l00241"></a>00241           <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00242"></a>00242             d_teta += deux_pi;
<a name="l00243"></a>00243           tau23 = (inco(fac2)-inco(fac1))/(R*d_teta);
<a name="l00244"></a>00244 
<a name="l00245"></a>00245 <span class="comment">// flux de tau23 sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00246"></a>00246           flux = db_diffusivite*tau23*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac3)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac4))
<a name="l00247"></a>00247                  *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac3)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac4));
<a name="l00248"></a>00248           resu(fac1) += flux;
<a name="l00249"></a>00249           resu(fac2) -= flux;
<a name="l00250"></a>00250         }
<a name="l00251"></a>00251       <span class="keywordflow">else</span> <span class="comment">//!&lt; seule possibilite ori1 = 2 et ori3 = 0:  arete XZ</span>
<a name="l00252"></a>00252 <span class="comment"></span>        {
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 <span class="comment">// Calcul de tau31</span>
<a name="l00255"></a>00255           tau31 = (inco(fac4)-inco(fac3))/(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac4,2) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,2));
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 <span class="comment">// flux de tau31 sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00258"></a>00258           flux = db_diffusivite*tau31*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00259"></a>00259                  *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00260"></a>00260 
<a name="l00261"></a>00261           resu(fac3) += flux;
<a name="l00262"></a>00262           resu(fac4) -= flux;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 <span class="comment">// Calcul de tau13</span>
<a name="l00265"></a>00265           tau13 = (inco(fac2)-inco(fac1))/(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac2,0) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0));
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="comment">// flux de tau13 sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00268"></a>00268           flux = db_diffusivite*tau13*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac3)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac4))
<a name="l00269"></a>00269                  *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac3)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac4));
<a name="l00270"></a>00270 
<a name="l00271"></a>00271           resu(fac1) += flux;
<a name="l00272"></a>00272           resu(fac2) -= flux;
<a name="l00273"></a>00273         }
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     }
<a name="l00276"></a>00276   <span class="keywordflow">return</span> resu;
<a name="l00277"></a>00277 }
<a name="l00278"></a>00278 
<a name="l00279"></a>00279 
<a name="l00280"></a>00280 
<a name="l00281"></a><a class="code" href="classOp__Diff__VDF__Face__Axi.html#a595d54508ab982ac7778c07080050f75">00281</a> <span class="keywordtype">double</span> <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a595d54508ab982ac7778c07080050f75" title="Calcul dt_stab.">Op_Diff_VDF_Face_Axi::calculer_dt_stab</a>()<span class="keyword"> const</span>
<a name="l00282"></a>00282 <span class="keyword"></span>{
<a name="l00283"></a>00283   <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a595d54508ab982ac7778c07080050f75" title="Calcul dt_stab.">Op_Diff_VDF_Face_base::calculer_dt_stab</a>(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a894f2b636a46cb73bfcba0af62322332">la_zone_vdf</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>()) ;
<a name="l00284"></a>00284 }
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 
<a name="l00288"></a><a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad60e8ba3263846bc88bc90567e44c896">00288</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad60e8ba3263846bc88bc90567e44c896" title="calcule la contribution de la diffusion, la range dans resu renvoie resu">Op_Diff_VDF_Face_Axi::calculer</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00289"></a>00289 <span class="keyword"></span>{
<a name="l00290"></a>00290   resu=0;
<a name="l00291"></a>00291   <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ae02394dcd064883759eb1ba615abd679" title="ajoute la contribution de la diffusion au second membre resu renvoie resu">ajouter</a>(inco,resu);
<a name="l00292"></a>00292 }
<a name="l00293"></a>00293 
<a name="l00294"></a>00294 
<a name="l00295"></a><a class="code" href="classOp__Diff__VDF__Face__Axi.html#aabaf760b182f6b283faec8342f943650">00295</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aabaf760b182f6b283faec8342f943650">Op_Diff_VDF_Face_Axi::ajouter_bord</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00296"></a>00296 <span class="keyword"></span>{
<a name="l00297"></a>00297 
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 
<a name="l00300"></a>00300   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a894f2b636a46cb73bfcba0af62322332">la_zone_vdf</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00301"></a>00301   <span class="keywordtype">double</span> db_diffusivite = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ae17896b36dea744dea1baa1dfaaa423f">diffusivite_</a>.<a class="code" href="classRef__Champ__Uniforme.html#a5d1796bf8b3ee05cd2f78c0039fc4be5">valeur</a>()(0,0);
<a name="l00302"></a>00302 <span class="comment">// int nb_faces_elem = zvdf.zone().nb_faces_elem();</span>
<a name="l00303"></a>00303   <span class="keywordtype">double</span> deux_pi = <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>*2.0;
<a name="l00304"></a>00304 
<a name="l00305"></a>00305   <span class="keywordtype">double</span> d_teta, R, tmp, coef_laplacien_axi, dist3;
<a name="l00306"></a>00306   <span class="keywordtype">int</span> fac1,fac2,fac3,signe, n_type, n_arete;
<a name="l00307"></a>00307 
<a name="l00308"></a>00308   <span class="keywordtype">int</span> ndeb = zvdf.<a class="code" href="classZone__VDF.html#aa272d66cc2d519b88c3d5e8f0f70d700">premiere_arete_bord</a>();
<a name="l00309"></a>00309   <span class="keywordtype">int</span> nfin = ndeb + zvdf.<a class="code" href="classZone__VDF.html#a88b3380a8314d855c0f30a138efd834c">nb_aretes_bord</a>();
<a name="l00310"></a>00310   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l00311"></a>00311     {
<a name="l00312"></a>00312       n_type=<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a162b673e7bcaaf891fa1a3584a3abdf9">type_arete_bord</a>(n_arete-ndeb);
<a name="l00313"></a>00313 
<a name="l00314"></a>00314       <span class="keywordflow">switch</span>(n_type)
<a name="l00315"></a>00315         {
<a name="l00316"></a>00316         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a> :
<a name="l00317"></a>00317 <span class="comment">// paroi-paroi</span>
<a name="l00318"></a>00318         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a>:
<a name="l00319"></a>00319 <span class="comment">// fluide-fluide</span>
<a name="l00320"></a>00320         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>:
<a name="l00321"></a>00321 <span class="comment">// paroi-fluide</span>
<a name="l00322"></a>00322           {
<a name="l00323"></a>00323             fac1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,0);
<a name="l00324"></a>00324             fac2 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,1);
<a name="l00325"></a>00325             fac3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,2);
<a name="l00326"></a>00326             signe  = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,3);
<a name="l00327"></a>00327             <span class="keywordtype">int</span> ori1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a893731253b6dd11a1dcadc409f76b44a">orientation</a>(fac1);
<a name="l00328"></a>00328             <span class="keywordtype">int</span> ori3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a893731253b6dd11a1dcadc409f76b44a">orientation</a>(fac3);
<a name="l00329"></a>00329             <span class="keywordtype">int</span> rang1 = fac1 - zvdf.<a class="code" href="classZone__VF.html#a9571f861dfb23f699da7042773644a42" title="renvoie le numero de la premiere des faces sur lesquelles sont appliquees les conditions limites : bo...">premiere_face_bord</a>();
<a name="l00330"></a>00330             <span class="keywordtype">int</span> rang2 = fac2 - zvdf.<a class="code" href="classZone__VF.html#a9571f861dfb23f699da7042773644a42" title="renvoie le numero de la premiere des faces sur lesquelles sont appliquees les conditions limites : bo...">premiere_face_bord</a>();
<a name="l00331"></a>00331             <span class="keywordtype">double</span> vit_imp;
<a name="l00332"></a>00332 
<a name="l00333"></a>00333             <span class="keywordflow">if</span> (n_type == <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>)
<a name="l00334"></a>00334 <span class="comment">// arete paroi_fluide :il faut determiner qui est la face fluide</span>
<a name="l00335"></a>00335               {
<a name="l00336"></a>00336                 <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(inco[fac1],0))
<a name="l00337"></a>00337                   vit_imp = <a class="code" href="Champ__Face_8cpp.html#ae2ba1e8935ec33397828bf564e63f6d7">Champ_Face_get_val_imp_face_bord</a>(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8404cff9b08d2a9afeff8fb5d221257f">inconnue</a>-&gt;temps(),rang2,ori3,<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ab1d1205ba2670a75075cebcb2e3b00b1">la_zcl_vdf</a>);
<a name="l00338"></a>00338                 <span class="keywordflow">else</span>
<a name="l00339"></a>00339                   vit_imp = <a class="code" href="Champ__Face_8cpp.html#ae2ba1e8935ec33397828bf564e63f6d7">Champ_Face_get_val_imp_face_bord</a>(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8404cff9b08d2a9afeff8fb5d221257f">inconnue</a>-&gt;temps(),rang1,ori3,<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ab1d1205ba2670a75075cebcb2e3b00b1">la_zcl_vdf</a>);
<a name="l00340"></a>00340               }
<a name="l00341"></a>00341             <span class="keywordflow">else</span>
<a name="l00342"></a>00342               vit_imp = 0.5*(<a class="code" href="Champ__Face_8cpp.html#ae2ba1e8935ec33397828bf564e63f6d7">Champ_Face_get_val_imp_face_bord</a>(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8404cff9b08d2a9afeff8fb5d221257f">inconnue</a>-&gt;temps(),rang1,ori3,<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ab1d1205ba2670a75075cebcb2e3b00b1">la_zcl_vdf</a>)+
<a name="l00343"></a>00343                              <a class="code" href="Champ__Face_8cpp.html#ae2ba1e8935ec33397828bf564e63f6d7">Champ_Face_get_val_imp_face_bord</a>(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8404cff9b08d2a9afeff8fb5d221257f">inconnue</a>-&gt;temps(),rang2,ori3,<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ab1d1205ba2670a75075cebcb2e3b00b1">la_zcl_vdf</a>));
<a name="l00344"></a>00344 
<a name="l00345"></a>00345             <span class="keywordflow">if</span> (ori1 == 0) <span class="comment">//!&lt; bord d&#39;equation R = cte</span>
<a name="l00346"></a>00346 <span class="comment"></span>              {
<a name="l00347"></a>00347                 <span class="keywordtype">double</span> flux1;
<a name="l00348"></a>00348                 <span class="keywordflow">if</span> (ori3 == 1)  <span class="comment">//!&lt; flux de tau12 a travers le bord</span>
<a name="l00349"></a>00349 <span class="comment"></span>                  {
<a name="l00350"></a>00350                     dist3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,0)-<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l00351"></a>00351                     <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00352"></a>00352                       dist3 *= 1; <span class="comment">//SB dist3 *= 2;</span>
<a name="l00353"></a>00353                     tmp = (inco[fac3]-vit_imp)/dist3;
<a name="l00354"></a>00354                     flux1 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00355"></a>00355                             *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00356"></a>00356                   }
<a name="l00357"></a>00357                 <span class="keywordflow">else</span> <span class="comment">//if (ori3 == 2)  flux de tau13 a travers le bord</span>
<a name="l00358"></a>00358                   {
<a name="l00359"></a>00359                     assert(ori3==2);
<a name="l00360"></a>00360                     dist3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,0)-<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l00361"></a>00361                     <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00362"></a>00362                       dist3 *= 1; <span class="comment">//SB dist3 *= 2</span>
<a name="l00363"></a>00363                     tmp = (inco[fac3]-vit_imp)/dist3;
<a name="l00364"></a>00364                     flux1 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00365"></a>00365                             *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00366"></a>00366                   }
<a name="l00367"></a>00367 
<a name="l00368"></a>00368                 resu[fac3]+=signe*flux1;
<a name="l00369"></a>00369 
<a name="l00370"></a>00370 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l00371"></a>00371 <span class="comment">// resu[fac1] += flux1_2;</span>
<a name="l00372"></a>00372 <span class="comment">// resu[fac2] -= flux1_2;</span>
<a name="l00373"></a>00373 
<a name="l00374"></a>00374               }
<a name="l00375"></a>00375             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori1 == 1) <span class="comment">//!&lt; bord d&#39;equation teta = cte</span>
<a name="l00376"></a>00376 <span class="comment"></span>              {
<a name="l00377"></a>00377                 <span class="keywordtype">double</span> flux2;
<a name="l00378"></a>00378                 R = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,0);
<a name="l00379"></a>00379                 d_teta = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,1) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,1);
<a name="l00380"></a>00380                 <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00381"></a>00381                   d_teta += deux_pi;
<a name="l00382"></a>00382                 dist3  = R*d_teta;
<a name="l00383"></a>00383                 <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00384"></a>00384                   dist3 *= 1; <span class="comment">//SB dist3 *= 2</span>
<a name="l00385"></a>00385 
<a name="l00386"></a>00386                 <span class="keywordflow">if</span> (ori3 == 0) <span class="comment">//!&lt; flux de tau21 a travers le bord</span>
<a name="l00387"></a>00387 <span class="comment"></span>                  {
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 <span class="comment">// Terme supplementaire en axi</span>
<a name="l00390"></a>00390                     <span class="keywordtype">double</span> tmpbis=(inco[fac3]-vit_imp)/dist3;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392                     tmpbis -=(0.5*(inco[fac1]+inco[fac2])/R);
<a name="l00393"></a>00393                     flux2 = db_diffusivite*tmpbis*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00394"></a>00394 
<a name="l00395"></a>00395                     resu[fac3]+=signe*flux2;
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l00398"></a>00398 <span class="comment">// resu[fac1]+= flux1_2;</span>
<a name="l00399"></a>00399 <span class="comment">// resu[fac2]-= flux1_2;</span>
<a name="l00400"></a>00400 
<a name="l00401"></a>00401 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00402"></a>00402 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00403"></a>00403 
<a name="l00404"></a>00404                     coef_laplacien_axi = 0.5*db_diffusivite*tmpbis;
<a name="l00405"></a>00405                     resu(fac1) += coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fac1)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l00406"></a>00406                     resu(fac2) += coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fac2)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac2,0);
<a name="l00407"></a>00407 
<a name="l00408"></a>00408                   }
<a name="l00409"></a>00409                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3 == 2) <span class="comment">//!&lt; flux de tau23 a travers le bord</span>
<a name="l00410"></a>00410 <span class="comment"></span>                  {
<a name="l00411"></a>00411                     <span class="keywordtype">double</span> flux3;
<a name="l00412"></a>00412                     tmp = signe*(vit_imp-inco[fac3])/dist3;
<a name="l00413"></a>00413                     flux3 = db_diffusivite*tmp*0.25;
<a name="l00414"></a>00414                     flux3*=(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00415"></a>00415 
<a name="l00416"></a>00416                     resu[fac3]+=signe*flux3;
<a name="l00417"></a>00417 
<a name="l00418"></a>00418 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l00419"></a>00419 <span class="comment">// resu[fac1]+= flux1_2;</span>
<a name="l00420"></a>00420 <span class="comment">// resu[fac2]-= flux1_2;</span>
<a name="l00421"></a>00421                   }
<a name="l00422"></a>00422               }
<a name="l00423"></a>00423             <span class="keywordflow">else</span> <span class="comment">//!&lt; (ori1 == 2) bord d&#39;equation Z = cte</span>
<a name="l00424"></a>00424 <span class="comment"></span>              {
<a name="l00425"></a>00425                 <span class="keywordtype">double</span> flux4;
<a name="l00426"></a>00426                 <span class="keywordflow">if</span> (ori3 == 0)  <span class="comment">//!&lt; flux de tau31 a travers le bord</span>
<a name="l00427"></a>00427 <span class="comment"></span>                  {
<a name="l00428"></a>00428                     dist3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,2)-<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,2);
<a name="l00429"></a>00429                     <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00430"></a>00430                       dist3 *= 1; <span class="comment">//SB         dist3 *= 2;</span>
<a name="l00431"></a>00431                     tmp = (inco[fac3]-vit_imp)/dist3;
<a name="l00432"></a>00432                     flux4 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00433"></a>00433                             *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00434"></a>00434                   }
<a name="l00435"></a>00435                 <span class="keywordflow">else</span> <span class="comment">//if (ori3 == 1)  flux de tau32 a travers le bord</span>
<a name="l00436"></a>00436                   {
<a name="l00437"></a>00437                     assert(ori3==1);
<a name="l00438"></a>00438                     dist3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,2)-<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,2);
<a name="l00439"></a>00439                     <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00440"></a>00440                       dist3 *= 1; <span class="comment">//SB 2</span>
<a name="l00441"></a>00441                     tmp = (inco[fac3]-vit_imp)/dist3;
<a name="l00442"></a>00442                     flux4 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00443"></a>00443                             *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00444"></a>00444                   }
<a name="l00445"></a>00445 
<a name="l00446"></a>00446                 resu[fac3] += signe*flux4;
<a name="l00447"></a>00447               }
<a name="l00448"></a>00448             <span class="keywordflow">break</span>;
<a name="l00449"></a>00449           }
<a name="l00450"></a>00450         <span class="keywordflow">case</span> 3:
<a name="l00451"></a>00451           {
<a name="l00452"></a>00452 <span class="comment">// symetrie-symetrie</span>
<a name="l00453"></a>00453 <span class="comment">// pas de flux diffusif calcule</span>
<a name="l00454"></a>00454             <span class="keywordflow">break</span>;
<a name="l00455"></a>00455           }
<a name="l00456"></a>00456         <span class="keywordflow">default</span> :
<a name="l00457"></a>00457           {
<a name="l00458"></a>00458             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l00459"></a>00459             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l00460"></a>00460             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l00461"></a>00461             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00462"></a>00462             <span class="keywordflow">break</span>;
<a name="l00463"></a>00463           }
<a name="l00464"></a>00464         }
<a name="l00465"></a>00465     }
<a name="l00466"></a>00466 
<a name="l00467"></a>00467 }
<a name="l00468"></a>00468 
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 <span class="comment">//</span>
<a name="l00471"></a>00471 <span class="comment">// Methode pour l&#39;implicite</span>
<a name="l00472"></a>00472 <span class="comment">//</span>
<a name="l00473"></a>00473 
<a name="l00474"></a><a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad9c84825e3439468baf36b5f09e69a76">00474</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad9c84825e3439468baf36b5f09e69a76">Op_Diff_VDF_Face_Axi::ajouter_contribution</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice )<span class="keyword"> const</span>
<a name="l00475"></a>00475 <span class="keyword"></span>{
<a name="l00476"></a>00476   <span class="keywordflow">if</span> (inco.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>() &gt; 1)
<a name="l00477"></a>00477     {
<a name="l00478"></a>00478       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans Op_Diff_VDF_Face_Axi::ajouter&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00479"></a>00479       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On ne sait pas traiter la diffusion d&#39;un Champ_Face a plusieurs inconnues&quot;</span> &lt;&lt; finl;
<a name="l00480"></a>00480       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00481"></a>00481     }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a894f2b636a46cb73bfcba0af62322332">la_zone_vdf</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00484"></a>00484   <span class="keywordtype">double</span> db_diffusivite = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ae17896b36dea744dea1baa1dfaaa423f">diffusivite_</a>.<a class="code" href="classRef__Champ__Uniforme.html#a5d1796bf8b3ee05cd2f78c0039fc4be5">valeur</a>()(0,0);
<a name="l00485"></a>00485   <span class="keywordtype">double</span> d_teta;
<a name="l00486"></a>00486   <span class="keywordtype">double</span> tau11, tau22, tau12, tau21, R;
<a name="l00487"></a>00487   <span class="keywordtype">double</span> tau13, tau31, tau23, tau32, tau33;
<a name="l00488"></a>00488   <span class="keywordtype">int</span> fac1,fac2,fac3,fac4;
<a name="l00489"></a>00489   <span class="keywordtype">double</span> coef_laplacien_axi;
<a name="l00490"></a>00490 <span class="comment">// int nb_faces_elem = zvdf.zone().nb_faces_elem();</span>
<a name="l00491"></a>00491 
<a name="l00492"></a>00492   <span class="keywordtype">double</span> deux_pi = <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>*2.0;
<a name="l00493"></a>00493 
<a name="l00494"></a>00494   <span class="keywordtype">int</span> ndeb ;
<a name="l00495"></a>00495   <span class="keywordtype">int</span> nfin,k ;
<a name="l00496"></a>00496   <span class="keywordtype">double</span> flux;
<a name="l00497"></a>00497   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = matrice.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l00498"></a>00498   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = matrice.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l00499"></a>00499   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l00500"></a>00500 
<a name="l00501"></a>00501 
<a name="l00502"></a>00502 <span class="comment">// Boucle sur les elements</span>
<a name="l00503"></a>00503 
<a name="l00504"></a>00504   <span class="keywordtype">int</span> fx0,fx1,fy0,fy1;
<a name="l00505"></a>00505   <span class="keywordtype">double</span> flux_X,flux_Y;
<a name="l00506"></a>00506   <span class="keywordtype">int</span> num_elem;
<a name="l00507"></a>00507   <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;zvdf.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); num_elem++)
<a name="l00508"></a>00508     {
<a name="l00509"></a>00509       fx0 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>(num_elem,0);
<a name="l00510"></a>00510       fx1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>(num_elem,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00511"></a>00511       fy0 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>(num_elem,1);
<a name="l00512"></a>00512       fy1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>(num_elem,1+<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00513"></a>00513 
<a name="l00514"></a>00514 <span class="comment">// Calcul de tau11</span>
<a name="l00515"></a>00515       tau11 = 1/(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fx1,0) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fx0,0));
<a name="l00516"></a>00516 
<a name="l00517"></a>00517 <span class="comment">// Calcul de tau22</span>
<a name="l00518"></a>00518       R = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad92fbadfb228bed9c662b8146df61a65">xp</a>(num_elem,0);
<a name="l00519"></a>00519       d_teta = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fy1,1) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fy0,1);
<a name="l00520"></a>00520       <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00521"></a>00521         d_teta += deux_pi;
<a name="l00522"></a>00522       tau22 =  1/(R*d_teta);
<a name="l00523"></a>00523 <span class="comment">// termes supplementaires en axi</span>
<a name="l00524"></a>00524       tau22 += 0.5/R;
<a name="l00525"></a>00525 
<a name="l00526"></a>00526       flux_X = tau11*db_diffusivite*0.5*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fx0)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fx1));
<a name="l00527"></a>00527       flux_Y = tau22*db_diffusivite*0.5*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fy0)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fy1));
<a name="l00528"></a>00528 
<a name="l00529"></a>00529       <span class="keywordflow">for</span> (k=tab1[fx0]-1; k&lt;tab1[fx0+1]-1; k++)
<a name="l00530"></a>00530         {
<a name="l00531"></a>00531           <span class="keywordflow">if</span> (tab2[k]-1==fx0)
<a name="l00532"></a>00532             coeff[k]+=flux_X;
<a name="l00533"></a>00533           <span class="keywordflow">if</span> (tab2[k]-1==fx1)
<a name="l00534"></a>00534             coeff[k]-=flux_X;
<a name="l00535"></a>00535         }
<a name="l00536"></a>00536       <span class="keywordflow">for</span> (k=tab1[fx1]-1; k&lt;tab1[fx1+1]-1; k++)
<a name="l00537"></a>00537         {
<a name="l00538"></a>00538           <span class="keywordflow">if</span> (tab2[k]-1==fx0)
<a name="l00539"></a>00539             coeff[k]-=flux_X;
<a name="l00540"></a>00540           <span class="keywordflow">if</span> (tab2[k]-1==fx1)
<a name="l00541"></a>00541             coeff[k]+=flux_X;
<a name="l00542"></a>00542         }
<a name="l00543"></a>00543       <span class="keywordflow">for</span> (k=tab1[fy0]-1; k&lt;tab1[fy0+1]-1; k++)
<a name="l00544"></a>00544         {
<a name="l00545"></a>00545           <span class="keywordflow">if</span> (tab2[k]-1==fy0)
<a name="l00546"></a>00546             coeff[k]+=flux_Y;
<a name="l00547"></a>00547           <span class="keywordflow">if</span> (tab2[k]-1==fy1)
<a name="l00548"></a>00548             coeff[k]-=flux_Y;
<a name="l00549"></a>00549         }
<a name="l00550"></a>00550       <span class="keywordflow">for</span> (k=tab1[fy1]-1; k&lt;tab1[fy1+1]-1; k++)
<a name="l00551"></a>00551         {
<a name="l00552"></a>00552           <span class="keywordflow">if</span> (tab2[k]-1==fy0)
<a name="l00553"></a>00553             coeff[k]-=flux_Y;
<a name="l00554"></a>00554           <span class="keywordflow">if</span> (tab2[k]-1==fy1)
<a name="l00555"></a>00555             coeff[k]+=flux_Y;
<a name="l00556"></a>00556         }
<a name="l00557"></a>00557 
<a name="l00558"></a>00558 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00559"></a>00559 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00560"></a>00560 <span class="comment">// SB - en +</span>
<a name="l00561"></a>00561       coef_laplacien_axi = +0.5*tau22*db_diffusivite;
<a name="l00562"></a>00562       <span class="keywordflow">for</span> (k=tab1[fx0]-1; k&lt;tab1[fx0+1]-1; k++)
<a name="l00563"></a>00563         {
<a name="l00564"></a>00564           <span class="keywordflow">if</span> (tab2[k]-1==fx0)
<a name="l00565"></a>00565             coeff[k]+=coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fx0)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fx0)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fx0,0);
<a name="l00566"></a>00566         }
<a name="l00567"></a>00567       <span class="keywordflow">for</span> (k=tab1[fx1]-1; k&lt;tab1[fx1+1]-1; k++)
<a name="l00568"></a>00568         {
<a name="l00569"></a>00569           <span class="keywordflow">if</span> (tab2[k]-1==fx1)
<a name="l00570"></a>00570             coeff[k]+=
<a name="l00571"></a>00571               coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fx1)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fx1)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fx1,0);
<a name="l00572"></a>00572         }
<a name="l00573"></a>00573     }
<a name="l00574"></a>00574 
<a name="l00575"></a>00575   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00576"></a>00576     {
<a name="l00577"></a>00577       <span class="keywordtype">int</span> fz0,fz1;
<a name="l00578"></a>00578       <span class="keywordtype">double</span> flux_Z;
<a name="l00579"></a>00579 
<a name="l00580"></a>00580       <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;zvdf.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); num_elem++)
<a name="l00581"></a>00581         {
<a name="l00582"></a>00582           fz0 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>(num_elem,2);
<a name="l00583"></a>00583           fz1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#aeb7519655bb011d63bcb28e2223617df">elem_faces</a>(num_elem,2+<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00584"></a>00584 
<a name="l00585"></a>00585 <span class="comment">// Calcul de tau33</span>
<a name="l00586"></a>00586           tau33 =1/(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fz1,2) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fz0,2));
<a name="l00587"></a>00587           flux_Z = tau33*db_diffusivite*0.5*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fz0)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fz1));
<a name="l00588"></a>00588 
<a name="l00589"></a>00589           <span class="keywordflow">for</span> (k=tab1[fz0]-1; k&lt;tab1[fz0+1]-1; k++)
<a name="l00590"></a>00590             {
<a name="l00591"></a>00591               <span class="keywordflow">if</span> (tab2[k]-1==fz0)
<a name="l00592"></a>00592                 coeff[k]+=flux_Z;
<a name="l00593"></a>00593               <span class="keywordflow">if</span> (tab2[k]-1==fz1)
<a name="l00594"></a>00594                 coeff[k]-=flux_Z;
<a name="l00595"></a>00595             }
<a name="l00596"></a>00596           <span class="keywordflow">for</span> (k=tab1[fz1]-1; k&lt;tab1[fz1+1]-1; k++)
<a name="l00597"></a>00597             {
<a name="l00598"></a>00598               <span class="keywordflow">if</span> (tab2[k]-1==fz0)
<a name="l00599"></a>00599                 coeff[k]-=flux_Z;
<a name="l00600"></a>00600               <span class="keywordflow">if</span> (tab2[k]-1==fz1)
<a name="l00601"></a>00601                 coeff[k]+=flux_Z;
<a name="l00602"></a>00602             }
<a name="l00603"></a>00603         }
<a name="l00604"></a>00604     }
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 <span class="comment">// Boucle sur les aretes bord</span>
<a name="l00607"></a>00607   <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8654f3d847b061608e5a6e51416a92a1">ajouter_contribution_bord</a>(inco, matrice);
<a name="l00608"></a>00608 
<a name="l00609"></a>00609 <span class="comment">// Boucle sur les aretes mixtes et internes</span>
<a name="l00610"></a>00610 
<a name="l00611"></a>00611   ndeb = zvdf.<a class="code" href="classZone__VDF.html#a1197e179e848063721cdf2121837bbc6">premiere_arete_mixte</a>();
<a name="l00612"></a>00612   nfin = zvdf.<a class="code" href="classZone__VDF.html#add0341183f527326bc526c92bbb19225">nb_aretes</a>();
<a name="l00613"></a>00613   <span class="keywordtype">int</span> ori1, ori3, n_arete;
<a name="l00614"></a>00614   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l00615"></a>00615     {
<a name="l00616"></a>00616 
<a name="l00617"></a>00617       fac1=<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,0);
<a name="l00618"></a>00618       fac2=<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,1);
<a name="l00619"></a>00619       fac3=<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,2);
<a name="l00620"></a>00620       fac4=<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,3);
<a name="l00621"></a>00621       ori1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a893731253b6dd11a1dcadc409f76b44a">orientation</a>(fac1);
<a name="l00622"></a>00622       ori3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a893731253b6dd11a1dcadc409f76b44a">orientation</a>(fac3);
<a name="l00623"></a>00623 
<a name="l00624"></a>00624       <span class="keywordflow">if</span> (ori1 == 1)  <span class="comment">//!&lt; (seule possibilite : ori3 =0)  Arete XY</span>
<a name="l00625"></a>00625 <span class="comment"></span>        {
<a name="l00626"></a>00626 <span class="comment">// Calcul de tau21</span>
<a name="l00627"></a>00627           R = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,0);
<a name="l00628"></a>00628           d_teta = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac4,1) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,1);
<a name="l00629"></a>00629           <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00630"></a>00630             d_teta += deux_pi;
<a name="l00631"></a>00631           tau21 = 1/(R*d_teta);
<a name="l00632"></a>00632 
<a name="l00633"></a>00633 <span class="comment">// Terme supplementaire en axi</span>
<a name="l00634"></a>00634           tau21 -= 0.5/R;
<a name="l00635"></a>00635 
<a name="l00636"></a>00636 <span class="comment">// flux de tau21 sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00637"></a>00637 
<a name="l00638"></a>00638           flux = db_diffusivite*tau21*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00639"></a>00639                  *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00640"></a>00640 
<a name="l00641"></a>00641           <span class="keywordflow">for</span> (k=tab1[fac3]-1; k&lt;tab1[fac3+1]-1; k++)
<a name="l00642"></a>00642             {
<a name="l00643"></a>00643               <span class="keywordflow">if</span> (tab2[k]-1==fac3)
<a name="l00644"></a>00644                 coeff[k]+=flux;
<a name="l00645"></a>00645               <span class="keywordflow">if</span> (tab2[k]-1==fac4)
<a name="l00646"></a>00646                 coeff[k]-=flux;
<a name="l00647"></a>00647             }
<a name="l00648"></a>00648           <span class="keywordflow">for</span> (k=tab1[fac4]-1; k&lt;tab1[fac4+1]-1; k++)
<a name="l00649"></a>00649             {
<a name="l00650"></a>00650               <span class="keywordflow">if</span> (tab2[k]-1==fac3)
<a name="l00651"></a>00651                 coeff[k]-=flux;
<a name="l00652"></a>00652               <span class="keywordflow">if</span> (tab2[k]-1==fac4)
<a name="l00653"></a>00653                 coeff[k]+=flux;
<a name="l00654"></a>00654             }
<a name="l00655"></a>00655 
<a name="l00656"></a>00656 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00657"></a>00657 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00658"></a>00658 
<a name="l00659"></a>00659           coef_laplacien_axi = 0.5*db_diffusivite*tau21;
<a name="l00660"></a>00660           <span class="keywordflow">for</span> (k=tab1[fac1]-1; k&lt;tab1[fac1+1]-1; k++)
<a name="l00661"></a>00661             {
<a name="l00662"></a>00662               <span class="keywordflow">if</span> (tab2[k]-1==fac1)
<a name="l00663"></a>00663                 coeff[k]+=coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fac1)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l00664"></a>00664             }
<a name="l00665"></a>00665           <span class="keywordflow">for</span> (k=tab1[fac2]-1; k&lt;tab1[fac2+1]-1; k++)
<a name="l00666"></a>00666             {
<a name="l00667"></a>00667               <span class="keywordflow">if</span> (tab2[k]-1==fac2)
<a name="l00668"></a>00668                 coeff[k]+=coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fac2)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac2,0);
<a name="l00669"></a>00669             }
<a name="l00670"></a>00670 
<a name="l00671"></a>00671 <span class="comment">// Calcul de tau12</span>
<a name="l00672"></a>00672           tau12 = 1/(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac2,0) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0));
<a name="l00673"></a>00673 
<a name="l00674"></a>00674 <span class="comment">// flux de tau12 sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00675"></a>00675 
<a name="l00676"></a>00676           flux = db_diffusivite*tau12*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac3)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac4))*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac3)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac4));
<a name="l00677"></a>00677           <span class="keywordflow">for</span> (k=tab1[fac1]-1; k&lt;tab1[fac1+1]-1; k++)
<a name="l00678"></a>00678             {
<a name="l00679"></a>00679               <span class="keywordflow">if</span> (tab2[k]-1==fac1)
<a name="l00680"></a>00680                 coeff[k]+=flux;
<a name="l00681"></a>00681               <span class="keywordflow">if</span> (tab2[k]-1==fac2)
<a name="l00682"></a>00682                 coeff[k]-=flux;
<a name="l00683"></a>00683             }
<a name="l00684"></a>00684           <span class="keywordflow">for</span> (k=tab1[fac2]-1; k&lt;tab1[fac2+1]-1; k++)
<a name="l00685"></a>00685             {
<a name="l00686"></a>00686               <span class="keywordflow">if</span> (tab2[k]-1==fac1)
<a name="l00687"></a>00687                 coeff[k]-=flux;
<a name="l00688"></a>00688               <span class="keywordflow">if</span> (tab2[k]-1==fac2)
<a name="l00689"></a>00689                 coeff[k]+=flux;
<a name="l00690"></a>00690             }
<a name="l00691"></a>00691         }
<a name="l00692"></a>00692       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3 == 1) <span class="comment">//!&lt; (seule possibilite ori1 = 2) arete YZ</span>
<a name="l00693"></a>00693 <span class="comment"></span>        {
<a name="l00694"></a>00694 
<a name="l00695"></a>00695 <span class="comment">// Calcul de tau32</span>
<a name="l00696"></a>00696           tau32 = 1/(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac4,2) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,2));
<a name="l00697"></a>00697 
<a name="l00698"></a>00698 <span class="comment">// flux de tau32 sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00699"></a>00699           flux = db_diffusivite*tau32*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00700"></a>00700                  *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00701"></a>00701 
<a name="l00702"></a>00702           <span class="keywordflow">for</span> (k=tab1[fac3]-1; k&lt;tab1[fac3+1]-1; k++)
<a name="l00703"></a>00703             {
<a name="l00704"></a>00704               <span class="keywordflow">if</span> (tab2[k]-1==fac3)
<a name="l00705"></a>00705                 coeff[k]+=flux;
<a name="l00706"></a>00706               <span class="keywordflow">if</span> (tab2[k]-1==fac4)
<a name="l00707"></a>00707                 coeff[k]-=flux;
<a name="l00708"></a>00708             }
<a name="l00709"></a>00709           <span class="keywordflow">for</span> (k=tab1[fac4]-1; k&lt;tab1[fac4+1]-1; k++)
<a name="l00710"></a>00710             {
<a name="l00711"></a>00711               <span class="keywordflow">if</span> (tab2[k]-1==fac3)
<a name="l00712"></a>00712                 coeff[k]-=flux;
<a name="l00713"></a>00713               <span class="keywordflow">if</span> (tab2[k]-1==fac4)
<a name="l00714"></a>00714                 coeff[k]+=flux;
<a name="l00715"></a>00715             }
<a name="l00716"></a>00716 
<a name="l00717"></a>00717 <span class="comment">// Calcul de tau23</span>
<a name="l00718"></a>00718           R = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l00719"></a>00719           d_teta = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac2,1) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,1);
<a name="l00720"></a>00720           <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00721"></a>00721             d_teta += deux_pi;
<a name="l00722"></a>00722           tau23 = 1/(R*d_teta);
<a name="l00723"></a>00723 
<a name="l00724"></a>00724 <span class="comment">// flux de tau23 sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00725"></a>00725           flux = db_diffusivite*tau23*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac3)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac4))
<a name="l00726"></a>00726                  *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac3)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac4));
<a name="l00727"></a>00727           <span class="keywordflow">for</span> (k=tab1[fac1]-1; k&lt;tab1[fac1+1]-1; k++)
<a name="l00728"></a>00728             {
<a name="l00729"></a>00729               <span class="keywordflow">if</span> (tab2[k]-1==fac1)
<a name="l00730"></a>00730                 coeff[k]+=flux;
<a name="l00731"></a>00731               <span class="keywordflow">if</span> (tab2[k]-1==fac2)
<a name="l00732"></a>00732                 coeff[k]-=flux;
<a name="l00733"></a>00733             }
<a name="l00734"></a>00734           <span class="keywordflow">for</span> (k=tab1[fac2]-1; k&lt;tab1[fac2+1]-1; k++)
<a name="l00735"></a>00735             {
<a name="l00736"></a>00736               <span class="keywordflow">if</span> (tab2[k]-1==fac1)
<a name="l00737"></a>00737                 coeff[k]-=flux;
<a name="l00738"></a>00738               <span class="keywordflow">if</span> (tab2[k]-1==fac2)
<a name="l00739"></a>00739                 coeff[k]+=flux;
<a name="l00740"></a>00740             }
<a name="l00741"></a>00741         }
<a name="l00742"></a>00742       <span class="keywordflow">else</span> <span class="comment">//!&lt; seule possibilite ori1 = 2 et ori3 = 0:  arete XZ</span>
<a name="l00743"></a>00743 <span class="comment"></span>        {
<a name="l00744"></a>00744 
<a name="l00745"></a>00745 <span class="comment">// Calcul de tau31</span>
<a name="l00746"></a>00746           tau31 = 1/(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac4,2) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,2));
<a name="l00747"></a>00747 
<a name="l00748"></a>00748 <span class="comment">// flux de tau31 sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00749"></a>00749           flux = db_diffusivite*tau31*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00750"></a>00750                  *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00751"></a>00751 
<a name="l00752"></a>00752           <span class="keywordflow">for</span> (k=tab1[fac3]-1; k&lt;tab1[fac3+1]-1; k++)
<a name="l00753"></a>00753             {
<a name="l00754"></a>00754               <span class="keywordflow">if</span> (tab2[k]-1==fac3)
<a name="l00755"></a>00755                 coeff[k]+=flux;
<a name="l00756"></a>00756               <span class="keywordflow">if</span> (tab2[k]-1==fac4)
<a name="l00757"></a>00757                 coeff[k]-=flux;
<a name="l00758"></a>00758             }
<a name="l00759"></a>00759           <span class="keywordflow">for</span> (k=tab1[fac4]-1; k&lt;tab1[fac4+1]-1; k++)
<a name="l00760"></a>00760             {
<a name="l00761"></a>00761               <span class="keywordflow">if</span> (tab2[k]-1==fac3)
<a name="l00762"></a>00762                 coeff[k]-=flux;
<a name="l00763"></a>00763               <span class="keywordflow">if</span> (tab2[k]-1==fac4)
<a name="l00764"></a>00764                 coeff[k]+=flux;
<a name="l00765"></a>00765             }
<a name="l00766"></a>00766 <span class="comment">// Calcul de tau13</span>
<a name="l00767"></a>00767           tau13 = 1/(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac2,0) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0));
<a name="l00768"></a>00768 
<a name="l00769"></a>00769 <span class="comment">// flux de tau13 sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00770"></a>00770           flux = db_diffusivite*tau13*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac3)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac4))
<a name="l00771"></a>00771                  *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac3)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac4));
<a name="l00772"></a>00772           <span class="keywordflow">for</span> (k=tab1[fac1]-1; k&lt;tab1[fac1+1]-1; k++)
<a name="l00773"></a>00773             {
<a name="l00774"></a>00774               <span class="keywordflow">if</span> (tab2[k]-1==fac1)
<a name="l00775"></a>00775                 coeff[k]+=flux;
<a name="l00776"></a>00776               <span class="keywordflow">if</span> (tab2[k]-1==fac2)
<a name="l00777"></a>00777                 coeff[k]-=flux;
<a name="l00778"></a>00778             }
<a name="l00779"></a>00779           <span class="keywordflow">for</span> (k=tab1[fac2]-1; k&lt;tab1[fac2+1]-1; k++)
<a name="l00780"></a>00780             {
<a name="l00781"></a>00781               <span class="keywordflow">if</span> (tab2[k]-1==fac1)
<a name="l00782"></a>00782                 coeff[k]-=flux;
<a name="l00783"></a>00783               <span class="keywordflow">if</span> (tab2[k]-1==fac2)
<a name="l00784"></a>00784                 coeff[k]+=flux;
<a name="l00785"></a>00785             }
<a name="l00786"></a>00786         }
<a name="l00787"></a>00787     }
<a name="l00788"></a>00788 }
<a name="l00789"></a>00789 
<a name="l00790"></a><a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8654f3d847b061608e5a6e51416a92a1">00790</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8654f3d847b061608e5a6e51416a92a1">Op_Diff_VDF_Face_Axi::ajouter_contribution_bord</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice )<span class="keyword"> const</span>
<a name="l00791"></a>00791 <span class="keyword"></span>{
<a name="l00792"></a>00792 
<a name="l00793"></a>00793   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a894f2b636a46cb73bfcba0af62322332">la_zone_vdf</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00794"></a>00794   <span class="keywordtype">double</span> db_diffusivite = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ae17896b36dea744dea1baa1dfaaa423f">diffusivite_</a>.<a class="code" href="classRef__Champ__Uniforme.html#a5d1796bf8b3ee05cd2f78c0039fc4be5">valeur</a>()(0,0);
<a name="l00795"></a>00795 <span class="comment">// int nb_faces_elem = zvdf.zone().nb_faces_elem();</span>
<a name="l00796"></a>00796   <span class="keywordtype">double</span> deux_pi = <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>*2.0;
<a name="l00797"></a>00797 
<a name="l00798"></a>00798   <span class="keywordtype">double</span> d_teta, R, tmp, coef_laplacien_axi, dist3;
<a name="l00799"></a>00799   <span class="keywordtype">int</span> fac1,fac2,fac3,signe, n_type, n_arete,k;
<a name="l00800"></a>00800 
<a name="l00801"></a>00801   <span class="keywordtype">int</span> ndeb = zvdf.<a class="code" href="classZone__VDF.html#aa272d66cc2d519b88c3d5e8f0f70d700">premiere_arete_bord</a>();
<a name="l00802"></a>00802   <span class="keywordtype">int</span> nfin = ndeb + zvdf.<a class="code" href="classZone__VDF.html#a88b3380a8314d855c0f30a138efd834c">nb_aretes_bord</a>();
<a name="l00803"></a>00803 
<a name="l00804"></a>00804   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = matrice.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l00805"></a>00805   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = matrice.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l00806"></a>00806   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l00807"></a>00807 
<a name="l00808"></a>00808   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l00809"></a>00809     {
<a name="l00810"></a>00810       n_type=<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a162b673e7bcaaf891fa1a3584a3abdf9">type_arete_bord</a>(n_arete-ndeb);
<a name="l00811"></a>00811 
<a name="l00812"></a>00812       <span class="keywordflow">switch</span>(n_type)
<a name="l00813"></a>00813         {
<a name="l00814"></a>00814         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>:
<a name="l00815"></a>00815 <span class="comment">// paroi-paroi</span>
<a name="l00816"></a>00816         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a>:
<a name="l00817"></a>00817 <span class="comment">// fluide-fluide</span>
<a name="l00818"></a>00818         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>:
<a name="l00819"></a>00819 <span class="comment">// paroi-fluide</span>
<a name="l00820"></a>00820           {
<a name="l00821"></a>00821             <span class="keywordtype">double</span> flux1;
<a name="l00822"></a>00822             fac1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,0);
<a name="l00823"></a>00823             fac2 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,1);
<a name="l00824"></a>00824             fac3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,2);
<a name="l00825"></a>00825             signe  = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,3);
<a name="l00826"></a>00826             <span class="keywordtype">int</span> ori1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a893731253b6dd11a1dcadc409f76b44a">orientation</a>(fac1);
<a name="l00827"></a>00827             <span class="keywordtype">int</span> ori3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a893731253b6dd11a1dcadc409f76b44a">orientation</a>(fac3);
<a name="l00828"></a>00828             <span class="keywordflow">if</span> (ori1 == 0) <span class="comment">//!&lt; bord d&#39;equation R = cte</span>
<a name="l00829"></a>00829 <span class="comment"></span>              {
<a name="l00830"></a>00830                 <span class="keywordflow">if</span> (ori3 == 1)  <span class="comment">//!&lt; flux de tau12 a travers le bord</span>
<a name="l00831"></a>00831 <span class="comment"></span>                  {
<a name="l00832"></a>00832                     dist3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,0)-<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l00833"></a>00833                     <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00834"></a>00834                       dist3 *= 1; <span class="comment">//SB 2</span>
<a name="l00835"></a>00835                     tmp = 1/dist3;
<a name="l00836"></a>00836                     flux1 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00837"></a>00837                             *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00838"></a>00838                   }
<a name="l00839"></a>00839                 <span class="keywordflow">else</span> <span class="comment">//if (ori3 == 2)  flux de tau13 a travers le bord</span>
<a name="l00840"></a>00840                   {
<a name="l00841"></a>00841                     assert(ori3 == 2);
<a name="l00842"></a>00842                     dist3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,0)-<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l00843"></a>00843                     <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00844"></a>00844                       dist3 *= 1; <span class="comment">//!&lt; SB</span>
<a name="l00845"></a>00845 <span class="comment"></span>                    tmp =   1/dist3; <span class="comment">//SB signe/dist3</span>
<a name="l00846"></a>00846                     flux1 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00847"></a>00847                             *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00848"></a>00848                   }
<a name="l00849"></a>00849                 <span class="keywordflow">for</span> (k=tab1[fac3]-1; k&lt;tab1[fac3+1]-1; k++)
<a name="l00850"></a>00850                   {
<a name="l00851"></a>00851                     <span class="keywordflow">if</span> (tab2[k]-1==fac3)
<a name="l00852"></a>00852                       coeff[k]+=signe*flux1;
<a name="l00853"></a>00853                   }
<a name="l00854"></a>00854 
<a name="l00855"></a>00855 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l00856"></a>00856 <span class="comment">// remplir les coeff des face fac1 et fac2</span>
<a name="l00857"></a>00857               }
<a name="l00858"></a>00858             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori1 == 1) <span class="comment">//!&lt; bord d&#39;equation teta = cte</span>
<a name="l00859"></a>00859 <span class="comment"></span>              {
<a name="l00860"></a>00860                 R = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,0);
<a name="l00861"></a>00861                 d_teta = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,1) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,1);
<a name="l00862"></a>00862                 <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00863"></a>00863                   d_teta += deux_pi;
<a name="l00864"></a>00864                 dist3  = R*d_teta;
<a name="l00865"></a>00865                 <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00866"></a>00866                   dist3 *= 1; <span class="comment">//!&lt; 2</span>
<a name="l00867"></a>00867 <span class="comment"></span>                <span class="keywordtype">double</span> flux2;
<a name="l00868"></a>00868                 <span class="keywordflow">if</span> (ori3 == 0) <span class="comment">//!&lt; flux de tau21 a travers le bord</span>
<a name="l00869"></a>00869 <span class="comment"></span>                  {
<a name="l00870"></a>00870 
<a name="l00871"></a>00871 <span class="comment">// Terme supplementaire en axi</span>
<a name="l00872"></a>00872                     <span class="keywordtype">double</span> tmpbis=(1/dist3); <span class="comment">//!&lt; signe/dist3</span>
<a name="l00873"></a>00873 <span class="comment"></span>
<a name="l00874"></a>00874                     tmpbis -=(0.5/R); <span class="comment">//!&lt; +=</span>
<a name="l00875"></a>00875 <span class="comment"></span>                    flux2 = db_diffusivite*tmpbis*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00876"></a>00876 
<a name="l00877"></a>00877                     <span class="keywordflow">for</span> (k=tab1[fac3]-1; k&lt;tab1[fac3+1]-1; k++)
<a name="l00878"></a>00878                       {
<a name="l00879"></a>00879                         <span class="keywordflow">if</span> (tab2[k]-1==fac3)
<a name="l00880"></a>00880                           coeff[k]+=signe*flux2;
<a name="l00881"></a>00881                       }
<a name="l00882"></a>00882 
<a name="l00883"></a>00883 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l00884"></a>00884 <span class="comment">// resu[fac1]+= flux1_2;</span>
<a name="l00885"></a>00885 <span class="comment">// resu[fac2]-= flux1_2;</span>
<a name="l00886"></a>00886 
<a name="l00887"></a>00887 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00888"></a>00888 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00889"></a>00889 
<a name="l00890"></a>00890                     coef_laplacien_axi = 0.5*db_diffusivite*tmpbis;
<a name="l00891"></a>00891                     <span class="keywordflow">for</span> (k=tab1[fac1]-1; k&lt;tab1[fac1+1]-1; k++)
<a name="l00892"></a>00892                       {
<a name="l00893"></a>00893                         <span class="keywordflow">if</span> (tab2[k]-1==fac1)
<a name="l00894"></a>00894                           coeff[k]+=coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fac1)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l00895"></a>00895                       }
<a name="l00896"></a>00896                     <span class="keywordflow">for</span> (k=tab1[fac2]-1; k&lt;tab1[fac2+1]-1; k++)
<a name="l00897"></a>00897                       {
<a name="l00898"></a>00898                         <span class="keywordflow">if</span> (tab2[k]-1==fac2)
<a name="l00899"></a>00899                           coeff[k]+=coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fac2)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac2,0);
<a name="l00900"></a>00900                       }
<a name="l00901"></a>00901                   }
<a name="l00902"></a>00902                 <span class="keywordflow">else</span> <span class="comment">//if (ori3 == 2)  flux de tau23 a travers le bord</span>
<a name="l00903"></a>00903                   {
<a name="l00904"></a>00904                     assert(ori3==2);
<a name="l00905"></a>00905                     tmp = 1/dist3; <span class="comment">//SB signe/dist3</span>
<a name="l00906"></a>00906                     flux2 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00907"></a>00907 
<a name="l00908"></a>00908                     <span class="keywordflow">for</span> (k=tab1[fac3]-1; k&lt;tab1[fac3+1]-1; k++)
<a name="l00909"></a>00909                       {
<a name="l00910"></a>00910                         <span class="keywordflow">if</span> (tab2[k]-1==fac3)
<a name="l00911"></a>00911                           coeff[k]+=signe*flux2;
<a name="l00912"></a>00912                       }
<a name="l00913"></a>00913 
<a name="l00914"></a>00914 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l00915"></a>00915 <span class="comment">// resu[fac1]+= flux1_2;</span>
<a name="l00916"></a>00916 <span class="comment">// resu[fac2]-= flux1_2;</span>
<a name="l00917"></a>00917                   }
<a name="l00918"></a>00918               }
<a name="l00919"></a>00919             <span class="keywordflow">else</span> <span class="comment">//!&lt; (ori1 == 2) bord d&#39;equation Z = cte</span>
<a name="l00920"></a>00920 <span class="comment"></span>              {
<a name="l00921"></a>00921                 <span class="keywordtype">double</span> flux3;
<a name="l00922"></a>00922                 <span class="keywordflow">if</span> (ori3 == 0)  <span class="comment">//!&lt; flux de tau31 a travers le bord</span>
<a name="l00923"></a>00923 <span class="comment"></span>                  {
<a name="l00924"></a>00924                     dist3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,2)-<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,2);
<a name="l00925"></a>00925                     <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00926"></a>00926                       dist3 *= 1;        <span class="comment">//SB 2</span>
<a name="l00927"></a>00927                     tmp = 1/dist3; <span class="comment">//SB signe/dist3</span>
<a name="l00928"></a>00928                     flux3 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00929"></a>00929                             *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00930"></a>00930                   }
<a name="l00931"></a>00931                 <span class="keywordflow">else</span> <span class="comment">//if (ori3 == 1) flux de tau32 a travers le bord</span>
<a name="l00932"></a>00932                   {
<a name="l00933"></a>00933                     assert(ori3 == 1);
<a name="l00934"></a>00934                     dist3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,2)-<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,2);
<a name="l00935"></a>00935                     <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l00936"></a>00936                       dist3 *= 1;        <span class="comment">//SB 2</span>
<a name="l00937"></a>00937                     tmp = 1/dist3; <span class="comment">//SB signe/dist3</span>
<a name="l00938"></a>00938                     flux3 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l00939"></a>00939                             *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l00940"></a>00940                   }
<a name="l00941"></a>00941                 <span class="keywordflow">for</span> (k=tab1[fac3]-1; k&lt;tab1[fac3+1]-1; k++)
<a name="l00942"></a>00942                   {
<a name="l00943"></a>00943                     <span class="keywordflow">if</span> (tab2[k]-1==fac3)
<a name="l00944"></a>00944                       coeff[k]+=signe*flux3;
<a name="l00945"></a>00945                   }
<a name="l00946"></a>00946               }
<a name="l00947"></a>00947             <span class="keywordflow">break</span>;
<a name="l00948"></a>00948           }
<a name="l00949"></a>00949         <span class="keywordflow">case</span> 3:
<a name="l00950"></a>00950           {
<a name="l00951"></a>00951 <span class="comment">// symetrie-symetrie</span>
<a name="l00952"></a>00952 <span class="comment">// pas de flux diffusif calcule</span>
<a name="l00953"></a>00953             <span class="keywordflow">break</span>;
<a name="l00954"></a>00954           }
<a name="l00955"></a>00955         <span class="keywordflow">default</span> :
<a name="l00956"></a>00956           {
<a name="l00957"></a>00957             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l00958"></a>00958             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l00959"></a>00959             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l00960"></a>00960             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00961"></a>00961             <span class="keywordflow">break</span>;
<a name="l00962"></a>00962           }
<a name="l00963"></a>00963         }
<a name="l00964"></a>00964     }
<a name="l00965"></a>00965 
<a name="l00966"></a>00966 }
<a name="l00967"></a>00967 
<a name="l00968"></a><a class="code" href="classOp__Diff__VDF__Face__Axi.html#ae9b436999f17d0503983cf87f3bf2033">00968</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ae9b436999f17d0503983cf87f3bf2033">Op_Diff_VDF_Face_Axi::contribue_au_second_membre</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu )<span class="keyword"> const</span>
<a name="l00969"></a>00969 <span class="keyword"></span>{
<a name="l00970"></a>00970 
<a name="l00971"></a>00971   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a894f2b636a46cb73bfcba0af62322332">la_zone_vdf</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00972"></a>00972   <span class="keywordtype">double</span> db_diffusivite = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#ae17896b36dea744dea1baa1dfaaa423f">diffusivite_</a>.<a class="code" href="classRef__Champ__Uniforme.html#a5d1796bf8b3ee05cd2f78c0039fc4be5">valeur</a>()(0,0);
<a name="l00973"></a>00973 <span class="comment">// int nb_faces_elem = zvdf.zone().nb_faces_elem();</span>
<a name="l00974"></a>00974   <span class="keywordtype">double</span> deux_pi = <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>*2.0;
<a name="l00975"></a>00975 
<a name="l00976"></a>00976   <span class="keywordtype">double</span> d_teta, R, tmp, coef_laplacien_axi, dist3;
<a name="l00977"></a>00977   <span class="keywordtype">int</span> fac1,fac2,fac3,signe, n_type, n_arete;
<a name="l00978"></a>00978 
<a name="l00979"></a>00979   <span class="keywordtype">int</span> ndeb = zvdf.<a class="code" href="classZone__VDF.html#aa272d66cc2d519b88c3d5e8f0f70d700">premiere_arete_bord</a>();
<a name="l00980"></a>00980   <span class="keywordtype">int</span> nfin = ndeb + zvdf.<a class="code" href="classZone__VDF.html#a88b3380a8314d855c0f30a138efd834c">nb_aretes_bord</a>();
<a name="l00981"></a>00981   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l00982"></a>00982     {
<a name="l00983"></a>00983       n_type=<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a162b673e7bcaaf891fa1a3584a3abdf9">type_arete_bord</a>(n_arete-ndeb);
<a name="l00984"></a>00984 
<a name="l00985"></a>00985       <span class="keywordflow">switch</span>(n_type)
<a name="l00986"></a>00986         {
<a name="l00987"></a>00987         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>:
<a name="l00988"></a>00988 <span class="comment">// paroi-paroi</span>
<a name="l00989"></a>00989         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a>:
<a name="l00990"></a>00990 <span class="comment">// fluide-fluide</span>
<a name="l00991"></a>00991         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>:
<a name="l00992"></a>00992 <span class="comment">// paroi-fluide</span>
<a name="l00993"></a>00993           {
<a name="l00994"></a>00994             fac1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,0);
<a name="l00995"></a>00995             fac2 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,1);
<a name="l00996"></a>00996             fac3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,2);
<a name="l00997"></a>00997             signe  = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8ab0a86bed6d4e664781f2b23b62ce93">Qdm</a>(n_arete,3);
<a name="l00998"></a>00998             <span class="keywordtype">int</span> ori1 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a893731253b6dd11a1dcadc409f76b44a">orientation</a>(fac1);
<a name="l00999"></a>00999             <span class="keywordtype">int</span> ori3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a893731253b6dd11a1dcadc409f76b44a">orientation</a>(fac3);
<a name="l01000"></a>01000             <span class="keywordtype">int</span> rang1 = fac1 - zvdf.<a class="code" href="classZone__VF.html#a9571f861dfb23f699da7042773644a42" title="renvoie le numero de la premiere des faces sur lesquelles sont appliquees les conditions limites : bo...">premiere_face_bord</a>();
<a name="l01001"></a>01001             <span class="keywordtype">int</span> rang2 = fac2 - zvdf.<a class="code" href="classZone__VF.html#a9571f861dfb23f699da7042773644a42" title="renvoie le numero de la premiere des faces sur lesquelles sont appliquees les conditions limites : bo...">premiere_face_bord</a>();
<a name="l01002"></a>01002             <span class="keywordtype">double</span> vit_imp;
<a name="l01003"></a>01003 
<a name="l01004"></a>01004             <span class="keywordflow">if</span> (n_type == <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>)
<a name="l01005"></a>01005 <span class="comment">// arete paroi_fluide :il faut determiner qui est la face fluide</span>
<a name="l01006"></a>01006               {
<a name="l01007"></a>01007                 <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8404cff9b08d2a9afeff8fb5d221257f">inconnue</a>.<a class="code" href="classRef__Champ__Face.html#ab3bc856ba736c84e483378400b194290">valeur</a>()(fac1),0))
<a name="l01008"></a>01008                   vit_imp = <a class="code" href="Champ__Face_8cpp.html#ae2ba1e8935ec33397828bf564e63f6d7">Champ_Face_get_val_imp_face_bord</a>(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8404cff9b08d2a9afeff8fb5d221257f">inconnue</a>-&gt;temps(),rang2,ori3,<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ab1d1205ba2670a75075cebcb2e3b00b1">la_zcl_vdf</a>);
<a name="l01009"></a>01009                 <span class="keywordflow">else</span>
<a name="l01010"></a>01010                   vit_imp = <a class="code" href="Champ__Face_8cpp.html#ae2ba1e8935ec33397828bf564e63f6d7">Champ_Face_get_val_imp_face_bord</a>(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8404cff9b08d2a9afeff8fb5d221257f">inconnue</a>-&gt;temps(),rang1,ori3,<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ab1d1205ba2670a75075cebcb2e3b00b1">la_zcl_vdf</a>);
<a name="l01011"></a>01011               }
<a name="l01012"></a>01012             <span class="keywordflow">else</span>
<a name="l01013"></a>01013               vit_imp = 0.5*(<a class="code" href="Champ__Face_8cpp.html#ae2ba1e8935ec33397828bf564e63f6d7">Champ_Face_get_val_imp_face_bord</a>(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8404cff9b08d2a9afeff8fb5d221257f">inconnue</a>-&gt;temps(),rang1,ori3,<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ab1d1205ba2670a75075cebcb2e3b00b1">la_zcl_vdf</a>)+
<a name="l01014"></a>01014                              <a class="code" href="Champ__Face_8cpp.html#ae2ba1e8935ec33397828bf564e63f6d7">Champ_Face_get_val_imp_face_bord</a>(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a8404cff9b08d2a9afeff8fb5d221257f">inconnue</a>-&gt;temps(),rang2,ori3,<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ab1d1205ba2670a75075cebcb2e3b00b1">la_zcl_vdf</a>));
<a name="l01015"></a>01015 
<a name="l01016"></a>01016             <span class="keywordflow">if</span> (ori1 == 0) <span class="comment">//!&lt; bord d&#39;equation R = cte</span>
<a name="l01017"></a>01017 <span class="comment"></span>              {
<a name="l01018"></a>01018                 <span class="keywordtype">double</span> flux1;
<a name="l01019"></a>01019                 <span class="keywordflow">if</span> (ori3 == 1)  <span class="comment">//!&lt; flux de tau12 a travers le bord</span>
<a name="l01020"></a>01020 <span class="comment"></span>                  {
<a name="l01021"></a>01021                     dist3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,0)-<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l01022"></a>01022                     <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l01023"></a>01023                       dist3 *= 1; <span class="comment">//SB 2</span>
<a name="l01024"></a>01024                     tmp = (-1*vit_imp)/dist3;
<a name="l01025"></a>01025                     flux1 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l01026"></a>01026                             *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l01027"></a>01027                   }
<a name="l01028"></a>01028                 <span class="keywordflow">else</span> <span class="comment">//if (ori3 == 2)  flux de tau13 a travers le bord</span>
<a name="l01029"></a>01029                   {
<a name="l01030"></a>01030                     assert(ori3 == 2);
<a name="l01031"></a>01031                     dist3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,0)-<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l01032"></a>01032                     <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l01033"></a>01033                       dist3 *= 1;
<a name="l01034"></a>01034                     tmp =   -1*(vit_imp)/dist3;
<a name="l01035"></a>01035                     flux1 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l01036"></a>01036                             *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l01037"></a>01037                   }
<a name="l01038"></a>01038 
<a name="l01039"></a>01039                 resu[fac3]+=signe*flux1;
<a name="l01040"></a>01040 
<a name="l01041"></a>01041 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l01042"></a>01042 <span class="comment">// resu[fac1] += flux1_2;</span>
<a name="l01043"></a>01043 <span class="comment">// resu[fac2] -= flux1_2;</span>
<a name="l01044"></a>01044 
<a name="l01045"></a>01045               }
<a name="l01046"></a>01046             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori1 == 1) <span class="comment">//!&lt; bord d&#39;equation teta = cte</span>
<a name="l01047"></a>01047 <span class="comment"></span>              {
<a name="l01048"></a>01048                 R = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,0);
<a name="l01049"></a>01049                 d_teta = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,1) - <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,1);
<a name="l01050"></a>01050                 <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l01051"></a>01051                   d_teta += deux_pi;
<a name="l01052"></a>01052                 dist3  = R*d_teta;
<a name="l01053"></a>01053                 <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l01054"></a>01054                   dist3 *= 1;
<a name="l01055"></a>01055 
<a name="l01056"></a>01056                 <span class="keywordflow">if</span> (ori3 == 0) <span class="comment">//!&lt; flux de tau21 a travers le bord</span>
<a name="l01057"></a>01057 <span class="comment"></span>                  {
<a name="l01058"></a>01058                     <span class="keywordtype">double</span> flux2;
<a name="l01059"></a>01059 <span class="comment">// Terme supplementaire en axi</span>
<a name="l01060"></a>01060                     <span class="keywordtype">double</span> tmpbis=(-1*(vit_imp)/dist3);
<a name="l01061"></a>01061 
<a name="l01062"></a>01062                     flux2 = db_diffusivite*tmpbis *0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l01063"></a>01063 
<a name="l01064"></a>01064                     resu[fac3]+=signe*flux2;
<a name="l01065"></a>01065 
<a name="l01066"></a>01066 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l01067"></a>01067 <span class="comment">// resu[fac1]+= flux1_2;</span>
<a name="l01068"></a>01068 <span class="comment">// resu[fac2]-= flux1_2;</span>
<a name="l01069"></a>01069 
<a name="l01070"></a>01070 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l01071"></a>01071 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l01072"></a>01072 
<a name="l01073"></a>01073                     coef_laplacien_axi = 0.5*db_diffusivite*tmpbis;
<a name="l01074"></a>01074                     resu(fac1) += coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fac1)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,0);
<a name="l01075"></a>01075                     resu(fac2) += coef_laplacien_axi*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a7dce485e816fccb7c4480005eaec86bb">volumes_entrelaces</a>(fac2)*<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2)/<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac2,0);
<a name="l01076"></a>01076 
<a name="l01077"></a>01077                   }
<a name="l01078"></a>01078                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3 == 2) <span class="comment">//!&lt; flux de tau23 a travers le bord</span>
<a name="l01079"></a>01079 <span class="comment"></span>                  {
<a name="l01080"></a>01080                     <span class="keywordtype">double</span> flux3;
<a name="l01081"></a>01081                     tmp = -1*(vit_imp)/dist3;
<a name="l01082"></a>01082                     flux3 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l01083"></a>01083 
<a name="l01084"></a>01084                     resu[fac3]+=signe*flux3;
<a name="l01085"></a>01085 
<a name="l01086"></a>01086 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l01087"></a>01087 <span class="comment">// resu[fac1]+= flux1_2;</span>
<a name="l01088"></a>01088 <span class="comment">// resu[fac2]-= flux1_2;</span>
<a name="l01089"></a>01089                   }
<a name="l01090"></a>01090               }
<a name="l01091"></a>01091             <span class="keywordflow">else</span> <span class="comment">//!&lt; (ori1 == 2) bord d&#39;equation Z = cte</span>
<a name="l01092"></a>01092 <span class="comment"></span>              {
<a name="l01093"></a>01093                 <span class="keywordtype">double</span> flux4;
<a name="l01094"></a>01094                 <span class="keywordflow">if</span> (ori3 == 0)  <span class="comment">//!&lt; flux de tau31 a travers le bord</span>
<a name="l01095"></a>01095 <span class="comment"></span>                  {
<a name="l01096"></a>01096                     dist3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,2)-<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,2);
<a name="l01097"></a>01097                     <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l01098"></a>01098                       dist3 *= 1;
<a name="l01099"></a>01099                     tmp = -1*(vit_imp)/dist3;
<a name="l01100"></a>01100                     flux4 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l01101"></a>01101                             *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l01102"></a>01102                   }
<a name="l01103"></a>01103                 <span class="keywordflow">else</span> <span class="comment">//!&lt; if (ori3 == 1)  flux de tau32 a travers le bord</span>
<a name="l01104"></a>01104 <span class="comment"></span>                  {
<a name="l01105"></a>01105                     assert(ori3 == 1);
<a name="l01106"></a>01106                     dist3 = <a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac3,2)-<a class="code" href="classOp__Diff__VDF__Face__Axi.html#a1e03644cea88a130d2bf1c4cb188011b">xv</a>(fac1,2);
<a name="l01107"></a>01107                     <span class="keywordflow">if</span> (n_type != <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>)
<a name="l01108"></a>01108                       dist3 *= 1;
<a name="l01109"></a>01109                     tmp = -1*(vit_imp)/dist3;
<a name="l01110"></a>01110                     flux4 = db_diffusivite*tmp*0.25*(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#ad69138483138d165eea05be1aae31729">surface</a>(fac2))
<a name="l01111"></a>01111                             *(<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac1)+<a class="code" href="classOp__Diff__VDF__Face__Axi.html#aa2016faab9657b7da94ffafbd1425da2">porosite</a>(fac2));
<a name="l01112"></a>01112                   }
<a name="l01113"></a>01113 
<a name="l01114"></a>01114                 resu[fac3] += signe*flux4;
<a name="l01115"></a>01115               }
<a name="l01116"></a>01116             <span class="keywordflow">break</span>;
<a name="l01117"></a>01117           }
<a name="l01118"></a>01118         <span class="keywordflow">case</span> 3:
<a name="l01119"></a>01119           {
<a name="l01120"></a>01120 <span class="comment">// symetrie-symetrie</span>
<a name="l01121"></a>01121 <span class="comment">// pas de flux diffusif calcule</span>
<a name="l01122"></a>01122             <span class="keywordflow">break</span>;
<a name="l01123"></a>01123           }
<a name="l01124"></a>01124         <span class="keywordflow">default</span> :
<a name="l01125"></a>01125           {
<a name="l01126"></a>01126             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l01127"></a>01127             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l01128"></a>01128             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l01129"></a>01129             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01130"></a>01130             <span class="keywordflow">break</span>;
<a name="l01131"></a>01131           }
<a name="l01132"></a>01132         }
<a name="l01133"></a>01133     }
<a name="l01134"></a>01134 
<a name="l01135"></a>01135 }
<a name="l01136"></a>01136 
<a name="l01137"></a>01137 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:39 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
