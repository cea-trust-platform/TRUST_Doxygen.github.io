<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/P1NCP1B/Operateurs/Op_Diff_RotRot.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/P1NCP1B/Operateurs/Op_Diff_RotRot.cpp</div>  </div>
</div>
<div class="contents">
<a href="Op__Diff__RotRot_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Op_Diff_RotRot.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/P1NCP1B/Operateurs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/11</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Op__Diff__RotRot_8h.html">Op_Diff_RotRot.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__VEF_8h.html">Zone_Cl_VEF.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Front__VF_8h.html">Front_VF.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Zone__dis_8h.html">Zone_dis.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__dis_8h.html">Zone_Cl_dis.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse__Sym_8h.html">Matrice_Morse_Sym.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="SFichier_8h.html">SFichier.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="LecFicDistribueBin_8h.html">LecFicDistribueBin.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Uniforme_8h.html">Champ_Uniforme.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Solv__GCP_8h.html">Solv_GCP.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="SSOR_8h.html">SSOR.h</a>&gt;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="Op__Diff__RotRot_8cpp.html#a23fe086056549a401b41c2be7ac69ef2">00036</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classOp__Diff__RotRot.html">Op_Diff_RotRot</a>,<span class="stringliteral">&quot;Op_Diff_VEF_ROTROT_const_P1NC&quot;</span>,<a class="code" href="classOperateur__Diff__base.html" title="classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...">Operateur_Diff_base</a>);
<a name="l00037"></a>00037 <span class="comment"></span>
<a name="l00038"></a>00038 <span class="comment">////!&lt; Implementation de printOn et readOn ATTENTION: verifier ou est implementer la fonction que_suis_je()</span>
<a name="l00039"></a>00039 <span class="comment"></span><span class="comment">//</span>
<a name="l00040"></a><a class="code" href="classOp__Diff__RotRot.html#a4e90b857b008d5ef73b1118b5dff0678">00040</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classOp__Diff__RotRot.html#a4e90b857b008d5ef73b1118b5dff0678" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Diff_RotRot::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00041"></a>00041 <span class="keyword"></span>{
<a name="l00042"></a>00042   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() ;
<a name="l00043"></a>00043 }
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 
<a name="l00046"></a><a class="code" href="classOp__Diff__RotRot.html#a43b3968cdae59f7e4c82b2ef80011297">00046</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classOp__Diff__RotRot.html#a43b3968cdae59f7e4c82b2ef80011297" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Diff_RotRot::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s)
<a name="l00047"></a>00047 {
<a name="l00048"></a>00048   <span class="keywordflow">return</span> s ;
<a name="l00049"></a>00049 }
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="classOp__Diff__RotRot.html#afead7c7cedd99653b9eb38dafc9d1459">00051</a> <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; <a class="code" href="classOp__Diff__RotRot.html#afead7c7cedd99653b9eb38dafc9d1459">Op_Diff_RotRot::zone_Vef</a>()<span class="keyword"> const</span>
<a name="l00052"></a>00052 <span class="keyword"></span>{
<a name="l00053"></a>00053   <span class="keywordflow">return</span> <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>, <a class="code" href="classOp__Diff__RotRot.html#acfc857bb8f14b3f69e5418810ff59efd">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>());
<a name="l00054"></a>00054 }
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__RotRot.html#a96d2cf0820cc813f213e4268c67578f4">Op_Diff_RotRot::</a>
<a name="l00057"></a><a class="code" href="classOp__Diff__RotRot.html#a96d2cf0820cc813f213e4268c67578f4">00057</a> <a class="code" href="classOp__Diff__RotRot.html#a96d2cf0820cc813f213e4268c67578f4">associer</a>(<span class="keyword">const</span> <a class="code" href="classZone__dis.html" title="classe Zone_dis Classe generique de la hierarchie des zones discretisees. Un objet de type Zone_dis p...">Zone_dis</a>&amp; zone_dis, <span class="keyword">const</span> <a class="code" href="classZone__Cl__dis.html" title="classe Zone_Cl_dis Classe generique de la hierarchie des conditions aux limites discretisees. Un objet Zone_Cl_dis peut referencer n&#39;importe quel derivant de Zone_Cl_dis_base. La plupart des methodes appellent les methodes de l&#39;objet Probleme sous-jacent via la methode valeur() declaree grace a la macro Declare_deriv().;">Zone_Cl_dis</a>&amp; zone_Cl_dis,
<a name="l00058"></a>00058          <span class="keyword">const</span> <a class="code" href="classChamp__Inc.html">Champ_Inc</a>&amp; inco)
<a name="l00059"></a>00059 {
<a name="l00060"></a>00060   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zvef = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>, zone_dis.<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>());
<a name="l00061"></a>00061   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zclvef = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>, zone_Cl_dis.<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00062"></a>00062   <a class="code" href="classOp__Diff__RotRot.html#acfc857bb8f14b3f69e5418810ff59efd">la_zone_vef</a> = zvef;
<a name="l00063"></a>00063   <a class="code" href="classOp__Diff__RotRot.html#a388ac4b3cf9771efe241a2fa22acc71a">la_zcl_vef</a> = zclvef;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065   <a class="code" href="classOp__Diff__RotRot.html#afc17520b507293cbe9571d3d56ef1d19">curl_</a>.<a class="code" href="classOp__Curl__VEFP1B.html#aa2c346b443c2fde59a2a834776525158">associer</a>(zone_dis,zone_Cl_dis,inco);
<a name="l00066"></a>00066   <a class="code" href="classOp__Diff__RotRot.html#a3378a3a917ff8a6cd2a373cd644cc0b5">rot_</a>.<a class="code" href="classOp__Rot__VEFP1B.html#a8f3f0e5ef64f85517ce411b1d89e3a10">associer</a>(zone_dis,zone_Cl_dis,inco);
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="comment">//</span>
<a name="l00069"></a>00069 <span class="comment">// On definit le champ vorticite</span>
<a name="l00070"></a>00070   <a class="code" href="classOp__Diff__RotRot.html#a739a904719fd5aae8929a6a23896f6f5">vorticite_</a>.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Champ_P1_isoP1Bulle&quot;</span>);
<a name="l00071"></a>00071   <a class="code" href="classChamp__P1__isoP1Bulle.html">Champ_P1_isoP1Bulle</a>&amp; vorticite =
<a name="l00072"></a>00072     <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1__isoP1Bulle.html">Champ_P1_isoP1Bulle</a>,<a class="code" href="classOp__Diff__RotRot.html#a739a904719fd5aae8929a6a23896f6f5">vorticite_</a>.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>());
<a name="l00073"></a>00073 
<a name="l00074"></a>00074   vorticite.<a class="code" href="classChamp__P1__isoP1Bulle.html#a0da79bedd1a76f5a1cf0e65f22f90bc7">associer_zone_dis_base</a>(zvef);
<a name="l00075"></a>00075   vorticite.<a class="code" href="classField__base.html#a3e1964ad4c0e4132aa0e39bc36dfdb15" title="Donne un nom au champ.">nommer</a>(<span class="stringliteral">&quot;vorticite&quot;</span>);
<a name="l00076"></a>00076 
<a name="l00077"></a>00077   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2) vorticite.<a class="code" href="classField__base.html#a0d3bb177287a79b9d7da6f3a46deff53" title="Fixe le nombre de composantes du champ. Le champ est vectoriel s&#39;il est de meme dimension que l&#39;espac...">fixer_nb_comp</a>(1);
<a name="l00078"></a>00078   <span class="keywordflow">else</span> vorticite.<a class="code" href="classField__base.html#a0d3bb177287a79b9d7da6f3a46deff53" title="Fixe le nombre de composantes du champ. Le champ est vectoriel s&#39;il est de meme dimension que l&#39;espac...">fixer_nb_comp</a>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   <span class="keywordtype">int</span> nb_tot = zvef.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>() + zvef.<a class="code" href="classZone__dis__base.html#acc9921d6a29cb719fd832fd573e47825">nb_som</a>() -1;
<a name="l00081"></a>00081   vorticite.<a class="code" href="classChamp__P1__isoP1Bulle.html#ad95a666cd32dce25d2fb4bcc1be7538b">fixer_nb_valeurs_nodales</a>(nb_tot);
<a name="l00082"></a>00082 
<a name="l00083"></a>00083   vorticite.<a class="code" href="classField__base.html#a5bcb91a2475ee68412475efc3d9902f1" title="Specifie l&#39;unite d&#39;un champ scalaire ou dont toutes les composantes ont la meme unite.">fixer_unite</a>(<span class="stringliteral">&quot;s-1&quot;</span>);
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="comment">//</span>
<a name="l00086"></a>00086 
<a name="l00087"></a>00087   <a class="code" href="classOp__Diff__RotRot.html#ad5ecf818aaf1e95f85482dbfa76eacc8">solveur_</a>.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Solv_GCP&quot;</span>);
<a name="l00088"></a>00088   <a class="code" href="classPrecond.html">Precond</a> p;
<a name="l00089"></a>00089   p.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;SSOR&quot;</span>);
<a name="l00090"></a>00090   <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolv__GCP.html">Solv_GCP</a>,<a class="code" href="classOperateur__base.html#a01258c6b4bf60a83b7ebd1649a54ecf6">solveur</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>()).set_precond(p);
<a name="l00091"></a>00091   <a class="code" href="classOp__Diff__RotRot.html#a865af8e20238554b5ef30f24934b7d93">assembler_matrice</a>(<a class="code" href="classOp__Diff__RotRot.html#ac7de3a6a93b09d8a3d83140c683fb885">matrice_vorticite_</a>);
<a name="l00092"></a>00092   <a class="code" href="classOp__Diff__RotRot.html#abb50cce2f67e16b350cbd37a2751d7b2">tester</a>();
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 }
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__RotRot.html#a3f421e2efdf4a9d16d4c378af32683b3">Op_Diff_RotRot::</a>
<a name="l00099"></a><a class="code" href="classOp__Diff__RotRot.html#a3f421e2efdf4a9d16d4c378af32683b3">00099</a> <a class="code" href="classOp__Diff__RotRot.html#a3f421e2efdf4a9d16d4c378af32683b3">calculer</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; diffusion)<span class="keyword"> const</span>
<a name="l00100"></a>00100 <span class="keyword"></span>{
<a name="l00101"></a>00101   diffusion = 0;
<a name="l00102"></a>00102   <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__RotRot.html#aa2c61eeea7185aa52cb0ad6b527808d5">ajouter</a>(vitesse,diffusion);
<a name="l00103"></a>00103 }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="comment">// Methode de l&#39;operateur de diffusion sous forme</span>
<a name="l00106"></a>00106 <span class="comment">// rotationnel de la vorticite sans const la seule qui</span>
<a name="l00107"></a>00107 <span class="comment">// doit etre appelee.</span>
<a name="l00108"></a>00108 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__RotRot.html#aa2c61eeea7185aa52cb0ad6b527808d5">Op_Diff_RotRot::</a>
<a name="l00109"></a><a class="code" href="classOp__Diff__RotRot.html#aa2c61eeea7185aa52cb0ad6b527808d5">00109</a> <a class="code" href="classOp__Diff__RotRot.html#aa2c61eeea7185aa52cb0ad6b527808d5">ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; diffusion)<span class="keyword"> const</span>
<a name="l00110"></a>00110 <span class="keyword"></span>{
<a name="l00111"></a>00111   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;je suis dans OpDiffRotRot&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00112"></a>00112   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> curl(<a class="code" href="classOp__Diff__RotRot.html#ac7de3a6a93b09d8a3d83140c683fb885">matrice_vorticite_</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>().<a class="code" href="classMatrice__Base.html#aa72ae45ad33c9dd24c315c620d88dcb2">ordre</a>());
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="comment">// Marche car Champ_Inc est mutable</span>
<a name="l00115"></a>00115   <a class="code" href="classOp__Diff__RotRot.html#afc17520b507293cbe9571d3d56ef1d19">curl_</a>.<a class="code" href="classOp__Curl__VEFP1B.html#a7633908e56d05a5b56454702673eee75">calculer</a>(vitesse,curl);
<a name="l00116"></a>00116 <span class="comment">// curl=-1*curl;</span>
<a name="l00117"></a>00117   <a class="code" href="classOp__Diff__RotRot.html#af2a767f5d88d90bfff61fbd89185f7e1">calculer_vorticite</a>(<a class="code" href="classOp__Diff__RotRot.html#a739a904719fd5aae8929a6a23896f6f5">vorticite_</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(),curl);
<a name="l00118"></a>00118   <a class="code" href="classOp__Diff__RotRot.html#a3378a3a917ff8a6cd2a373cd644cc0b5">rot_</a>.<a class="code" href="classOp__Rot__VEFP1B.html#ae5e862ecb5f381a8d9d9ac250bb1643b">calculer</a>(<a class="code" href="classOp__Diff__RotRot.html#a739a904719fd5aae8929a6a23896f6f5">vorticite_</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(),diffusion);
<a name="l00119"></a>00119 
<a name="l00120"></a>00120   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;je sors de OpDiffRotRot&quot;</span> &lt;&lt; finl;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122   <span class="keywordflow">return</span> diffusion;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124 }
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 <span class="keywordtype">int</span> <a class="code" href="classOp__Diff__RotRot.html#af2a767f5d88d90bfff61fbd89185f7e1">Op_Diff_RotRot::</a>
<a name="l00127"></a><a class="code" href="classOp__Diff__RotRot.html#af2a767f5d88d90bfff61fbd89185f7e1">00127</a> <a class="code" href="classOp__Diff__RotRot.html#af2a767f5d88d90bfff61fbd89185f7e1">calculer_vorticite</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; solution,        <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; curl)<span class="keyword"> const</span>
<a name="l00128"></a>00128 <span class="keyword"></span>{
<a name="l00129"></a>00129   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = <a class="code" href="classOp__Diff__RotRot.html#afead7c7cedd99653b9eb38dafc9d1459">zone_Vef</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00130"></a>00130   <span class="keyword">static</span> <span class="keywordtype">int</span> nb_appel2=0;
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 <span class="comment">// Resolution en vorticite: on ne considere que le cas</span>
<a name="l00133"></a>00133 <span class="comment">// sequentiel pour le moment.</span>
<a name="l00134"></a>00134 <span class="comment">// Pour le cas parallele, il faut s&#39;inspirer de la classe N_S.cpp.</span>
<a name="l00135"></a>00135 
<a name="l00136"></a>00136   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>()==1)
<a name="l00137"></a>00137     {
<a name="l00138"></a>00138 <span class="comment">// On considere que la matrice de vorticite est une matrice</span>
<a name="l00139"></a>00139 <span class="comment">// morse par defaut, et on applique la methode inverse()</span>
<a name="l00140"></a>00140 <span class="comment">// pour resoudre le systeme lineaire.</span>
<a name="l00141"></a>00141       <span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; la_matrice=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,
<a name="l00142"></a>00142                                                    <a class="code" href="classOp__Diff__RotRot.html#ac7de3a6a93b09d8a3d83140c683fb885">matrice_vorticite_</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l00143"></a>00143 <span class="comment">// Matrice_Morse&amp; la_matrice = (Matrice_Morse&amp;) matrice_vorticite_.valeur();</span>
<a name="l00144"></a>00144       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> solution_temporaire(la_matrice.<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>());
<a name="l00145"></a>00145 
<a name="l00146"></a>00146       assert(solution_temporaire.size() == solution.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>()-1);
<a name="l00147"></a>00147       assert(curl.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == solution_temporaire.size());
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 <span class="comment">// On resoud un systeme lineaire pour calculer la vorticite</span>
<a name="l00150"></a>00150 <span class="comment">// La vorticite est alors stockee dans la variable solution</span>
<a name="l00151"></a>00151 <span class="comment">// la_matrice.inverse(curl,solution_temporaire,1e-15);</span>
<a name="l00152"></a>00152       <a class="code" href="classSolv__GCP.html">Solv_GCP</a>&amp; solv = <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classSolv__GCP.html">Solv_GCP</a>,<a class="code" href="classOp__Diff__RotRot.html#ad5ecf818aaf1e95f85482dbfa76eacc8">solveur_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>());
<a name="l00153"></a>00153       solv.set_seuil(1e-17);
<a name="l00154"></a>00154       solv.resoudre_systeme(la_matrice,curl,solution_temporaire);
<a name="l00155"></a>00155 
<a name="l00156"></a>00156 <span class="comment">// On recopie les valeurs de solution temoraire dans solution</span>
<a name="l00157"></a>00157 <span class="comment">// Une case n&#39;est pas remplie: on le fait plus tard.</span>
<a name="l00158"></a>00158       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;solution_temporaire.size(); i++)
<a name="l00159"></a>00159         solution[i]=solution_temporaire[i];
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 <span class="comment">// On remplit le dernier element de &quot;solution&quot;</span>
<a name="l00162"></a>00162       <span class="keywordtype">int</span> sommet = zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>()-1;
<a name="l00163"></a>00163 
<a name="l00164"></a>00164       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classOp__Diff__RotRot.html#afc17520b507293cbe9571d3d56ef1d19">curl_</a>.<a class="code" href="classOp__Curl__VEFP1B.html#a1e2cbb8d630bc56484ad08b7513473ec">elem_som_size</a>(sommet); i++)
<a name="l00165"></a>00165         solution[sommet] +=
<a name="l00166"></a>00166           solution_temporaire[<a class="code" href="classOp__Diff__RotRot.html#afc17520b507293cbe9571d3d56ef1d19">curl_</a>.<a class="code" href="classOp__Curl__VEFP1B.html#a99eb2150a4f0e3c42db87544dc9ba86d">elements_pour_sommet</a>(sommet,i)];
<a name="l00167"></a>00167 
<a name="l00168"></a>00168       nb_appel2++;
<a name="l00169"></a>00169 
<a name="l00170"></a>00170     }
<a name="l00171"></a>00171 
<a name="l00172"></a>00172   <span class="keywordflow">return</span> 1;
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">//</span>
<a name="l00176"></a>00176 <span class="comment">/* Fonctions permettant l&#39;assemblage de la matrice */</span>
<a name="l00177"></a>00177 <span class="comment">/* de vorticite */</span>
<a name="l00178"></a>00178 <span class="comment">//</span>
<a name="l00179"></a>00179 
<a name="l00180"></a>00180 <span class="comment">/* On calcule la matrice de vorticite pour le probleme triple:</span>
<a name="l00181"></a>00181 <span class="comment">   / on considere le cas sans condition au limite pour la vorticite</span>
<a name="l00182"></a>00182 <span class="comment">   / pour le moment, et on ne code pas la partie parallele de</span>
<a name="l00183"></a>00183 <span class="comment">   / l&#39;algo.</span>
<a name="l00184"></a>00184 <span class="comment">   / REM: pour l&#39;instant, ne fonctionne qu&#39;en 2D</span>
<a name="l00185"></a>00185 <span class="comment">*/</span>
<a name="l00186"></a><a class="code" href="classOp__Diff__RotRot.html#a865af8e20238554b5ef30f24934b7d93">00186</a> <span class="keywordtype">int</span> <a class="code" href="classOp__Diff__RotRot.html#a865af8e20238554b5ef30f24934b7d93">Op_Diff_RotRot::assembler_matrice</a>(<a class="code" href="classMatrice.html">Matrice</a>&amp; matrice)
<a name="l00187"></a>00187 {
<a name="l00188"></a>00188   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = <a class="code" href="classOp__Diff__RotRot.html#afead7c7cedd99653b9eb38dafc9d1459">zone_Vef</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00189"></a>00189 
<a name="l00190"></a>00190   <span class="keywordtype">int</span> colonne_a_remplir_tab2,colonne_a_remplir_coeff;
<a name="l00191"></a>00191   <span class="keywordtype">int</span> nombre_coeff_non_nuls;
<a name="l00192"></a>00192 
<a name="l00193"></a>00193   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Assemblage de la matrice de vorticite en cours...&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00194"></a>00194   matrice.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Matrice_Morse_Sym&quot;</span>);
<a name="l00195"></a>00195 <span class="comment">// Matrice_Morse&amp; la_matrice=(Matrice_Morse&amp;) matrice.valeur();</span>
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 <span class="comment">// On dimensionne la matrice de maniere convenable.</span>
<a name="l00198"></a>00198 <span class="comment">// La matrice est carree et de taille (nombre_elem+nombre_som)</span>
<a name="l00199"></a>00199 <span class="comment">// Le nombre de coeff non nuls n&#39;excedent pas</span>
<a name="l00200"></a>00200 <span class="comment">// (2* (dimension+1) + 1)* nb_elem + (nb_som-1) * (nb_som-1)</span>
<a name="l00201"></a>00201 <span class="comment">// ATTENTION: une BASE de mon espace est les fonctions indicatrices</span>
<a name="l00202"></a>00202 <span class="comment">// des elements + les fonctions chapeaux - 1 de ces fonctions</span>
<a name="l00203"></a>00203 <span class="comment">// Sinon la somme des toutes les fontions chapeaux - la somme</span>
<a name="l00204"></a>00204 <span class="comment">// de toutes les fonctions indicatrices = 0</span>
<a name="l00205"></a>00205 <span class="comment">// Par defaut, on enleve la derniere fonction chapeau pour</span>
<a name="l00206"></a>00206 <span class="comment">// former notre base.</span>
<a name="l00207"></a>00207 <span class="comment">// Cf. Papier dans Latex/Vorticity</span>
<a name="l00208"></a>00208   nombre_coeff_non_nuls = (2*<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> + 3) * zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>()
<a name="l00209"></a>00209                           + (zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>()-1)* (zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>()-1);
<a name="l00210"></a>00210 <span class="comment">// la_matrice.dimensionner(zone.nb_elem()+zone.nb_som()-1,nombre_coeff_non_nuls);</span>
<a name="l00211"></a>00211   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> la_matrice(zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>()+ zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>()-1,nombre_coeff_non_nuls);
<a name="l00212"></a>00212 
<a name="l00213"></a>00213 <span class="comment">// Au cas ou la matrice existe deja dans un fichier</span>
<a name="l00214"></a>00214   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nomfic(<span class="stringliteral">&quot;Vorticite.sv&quot;</span>);
<a name="l00215"></a>00215   <a class="code" href="classLecFicDistribueBin.html" title="Lecture dans un fichier au format binaire. Cette classe implemente les operateurs et les methodes vir...">LecFicDistribueBin</a> vorticite;
<a name="l00216"></a>00216   <span class="keywordtype">int</span> fic_vorticite_existe;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218   <span class="keywordflow">if</span>(vorticite.<a class="code" href="classLecFicDistribue.html#a2186b78886c1a8630c7f69af03141087" title="Ouvre le fichier avec les parametres mode et prot donnes Ces parametres sont les parametres de la met...">ouvrir</a>(nomfic)) fic_vorticite_existe=1;
<a name="l00219"></a>00219   <span class="keywordflow">else</span> fic_vorticite_existe=0;
<a name="l00220"></a>00220 
<a name="l00221"></a>00221   <span class="keywordflow">if</span>(fic_vorticite_existe)
<a name="l00222"></a>00222     {
<a name="l00223"></a>00223       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Relecture de la matrice de vorticite sur le fichier: &quot;</span>
<a name="l00224"></a>00224            &lt;&lt; nomfic &lt;&lt; finl;
<a name="l00225"></a>00225       vorticite &gt;&gt; la_matrice;
<a name="l00226"></a>00226       vorticite.<a class="code" href="classEntree__Fichier__base.html#aca9165bc1712c1057b4d4b91a7ea4fb4">close</a>();
<a name="l00227"></a>00227       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Fin de la relecture de la matrice de vorticite.&quot;</span> &lt;&lt; finl;
<a name="l00228"></a>00228       <span class="keywordflow">return</span> 1;
<a name="l00229"></a>00229     }
<a name="l00230"></a>00230 
<a name="l00231"></a>00231   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Assemblage de la matrice de vorticite &quot;</span> &lt;&lt; nomfic &lt;&lt; finl;
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 <span class="comment">// Maintenant on remplit la matrice ligne par ligne</span>
<a name="l00234"></a>00234 <span class="comment">// On rappelle que les elements et les sommets sont numerotes</span>
<a name="l00235"></a>00235 <span class="comment">// a partir de 0.</span>
<a name="l00236"></a>00236 <span class="comment">// Mais les indices de colonnes et de lignes des tableaux</span>
<a name="l00237"></a>00237 <span class="comment">// d&#39;une matrice morse FORTRAN commencent a 1.</span>
<a name="l00238"></a>00238 <span class="comment">// Ex de construction: matrice[numerotation_C++] = numerotation_FORTRAN</span>
<a name="l00239"></a>00239 
<a name="l00240"></a>00240 <span class="comment">// Parametres importants pour remplir les tableaux</span>
<a name="l00241"></a>00241   nombre_coeff_non_nuls = 1;
<a name="l00242"></a>00242   colonne_a_remplir_tab2 = 0; <span class="comment">//pour le C++</span>
<a name="l00243"></a>00243   colonne_a_remplir_coeff = 0; <span class="comment">//pour le C++</span>
<a name="l00244"></a>00244 
<a name="l00245"></a>00245 <span class="comment">// On commence par remplir les lignes de la sous-matrice</span>
<a name="l00246"></a>00246 <span class="comment">// de taille nb_elem * (nb_elem + nb_som) : cf. structure de la matrice</span>
<a name="l00247"></a>00247   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> numero_elem = 0; numero_elem &lt; zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>(); numero_elem++)
<a name="l00248"></a>00248     {
<a name="l00249"></a>00249 <span class="comment">// Pour un element donne &quot;numero_elem&quot;, on calcule la liste</span>
<a name="l00250"></a>00250 <span class="comment">// des sommets qui appartiennent a cet element.</span>
<a name="l00251"></a>00251       <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a> sommets_pour_elem = <a class="code" href="classOp__Diff__RotRot.html#a9cd512857a9c0992557f0f57ace95ebb">sommets_pour_element</a>(numero_elem);
<a name="l00252"></a>00252       <a class="code" href="classOp__Diff__RotRot.html#ad47914f4e58b4324c20f0950b21bfc3a">Tri</a>(sommets_pour_elem); <span class="comment">//tableau trie</span>
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 <span class="comment">// On remplit tab1</span>
<a name="l00255"></a>00255       la_matrice.get_set_tab1()(numero_elem) = nombre_coeff_non_nuls;
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 <span class="comment">// On remplit tab2 et coeff</span>
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 <span class="comment">// Les nb_elem premiers elements de la ligne &quot;numero_elem&quot;</span>
<a name="l00260"></a>00260 <span class="comment">// a cause du FORTRAN</span>
<a name="l00261"></a>00261       la_matrice.get_set_tab2()(colonne_a_remplir_tab2) = numero_elem + 1;
<a name="l00262"></a>00262       la_matrice.get_set_coeff()(colonne_a_remplir_coeff) =
<a name="l00263"></a>00263         <a class="code" href="classOp__Diff__RotRot.html#a79468e0b7c3f8e910422c15b01f5f6ad">remplir_elem_elem_EF</a>(numero_elem);
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 <span class="comment">// On incremente nb_coeff_non_nuls car on vient de remplir</span>
<a name="l00266"></a>00266 <span class="comment">// une ligne par l&#39;un de ces elements non nul</span>
<a name="l00267"></a>00267       nombre_coeff_non_nuls++;
<a name="l00268"></a>00268 
<a name="l00269"></a>00269 <span class="comment">// On incremente les compteurs puisque l&#39;on vient de remplir</span>
<a name="l00270"></a>00270 <span class="comment">// des cases du tableau</span>
<a name="l00271"></a>00271       colonne_a_remplir_tab2++;
<a name="l00272"></a>00272       colonne_a_remplir_coeff++;
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 <span class="comment">// Les nb_som elements de la ligne &quot;numero_elem&quot;</span>
<a name="l00275"></a>00275       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; zone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>(); i++)
<a name="l00276"></a>00276         {
<a name="l00277"></a>00277 <span class="comment">// Si ce &quot;sommet_pour_elem[i]&quot; est different du numero</span>
<a name="l00278"></a>00278 <span class="comment">// du dernier sommet alors on stocke le bon coefficient</span>
<a name="l00279"></a>00279           <span class="keywordflow">if</span> (sommets_pour_elem[i] != zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>()-1)
<a name="l00280"></a>00280             {
<a name="l00281"></a>00281               la_matrice.get_set_tab2()(colonne_a_remplir_tab2) =
<a name="l00282"></a>00282                 zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>()+sommets_pour_elem[i]+1; <span class="comment">//pour FORTRAN</span>
<a name="l00283"></a>00283               la_matrice.get_set_coeff()(colonne_a_remplir_coeff) =
<a name="l00284"></a>00284                 <a class="code" href="classOp__Diff__RotRot.html#ab00a3dc467baea961ec75e582073ae36">remplir_elem_som_EF</a>(numero_elem,sommets_pour_elem[i]);
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 <span class="comment">// On incremente nb_coeff_non_nuls car on vient de remplir</span>
<a name="l00287"></a>00287 <span class="comment">// une ligne avec l&#39;un de ces elements non nul</span>
<a name="l00288"></a>00288               nombre_coeff_non_nuls++;
<a name="l00289"></a>00289 
<a name="l00290"></a>00290 <span class="comment">// Enfin on incremente les colonne_* pour eviter de reecrire</span>
<a name="l00291"></a>00291 <span class="comment">// sur des coefficients deja stockes</span>
<a name="l00292"></a>00292               colonne_a_remplir_tab2++;
<a name="l00293"></a>00293               colonne_a_remplir_coeff++;
<a name="l00294"></a>00294             }
<a name="l00295"></a>00295 
<a name="l00296"></a>00296         }
<a name="l00297"></a>00297 
<a name="l00298"></a>00298 <span class="comment">// Pas besoin de modifier les entiers nombre_coeff_non_nuls et</span>
<a name="l00299"></a>00299 <span class="comment">// colonne_* : ils sont a la bonne valeur.</span>
<a name="l00300"></a>00300 
<a name="l00301"></a>00301     }
<a name="l00302"></a>00302 
<a name="l00303"></a>00303 <span class="comment">// On remplit les lignes de la sous-matrice de taille</span>
<a name="l00304"></a>00304 <span class="comment">// nb_som *( nb_elem+nb_som) :cf. structure de la matrice</span>
<a name="l00305"></a>00305   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> numero_som = 0; numero_som &lt; zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>()-1; numero_som++)
<a name="l00306"></a>00306     {
<a name="l00307"></a>00307 <span class="comment">// On stocke les tableaux qui nous sont utiles</span>
<a name="l00308"></a>00308 <span class="comment">// Ainsi que leur taille respective</span>
<a name="l00309"></a>00309       <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a> Elem_pour_sommet = <a class="code" href="classOp__Diff__RotRot.html#a9cdf99b46403be6cf5056e1d44d22097">elements_pour_sommet</a>(numero_som);
<a name="l00310"></a>00310       <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a> Sommets_voisins = <a class="code" href="classOp__Diff__RotRot.html#a510b30206bd2f0b670519f8d4f459518">sommets_voisins</a>(numero_som,Elem_pour_sommet);
<a name="l00311"></a>00311       <a class="code" href="classOp__Diff__RotRot.html#ad47914f4e58b4324c20f0950b21bfc3a">Tri</a>(Elem_pour_sommet); <span class="comment">//liste triee</span>
<a name="l00312"></a>00312       <a class="code" href="classOp__Diff__RotRot.html#ad47914f4e58b4324c20f0950b21bfc3a">Tri</a>(Sommets_voisins); <span class="comment">//liste triee</span>
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 <span class="comment">// On remplit tab1</span>
<a name="l00315"></a>00315 <span class="comment">// pour FORTRAN</span>
<a name="l00316"></a>00316       la_matrice.get_set_tab1()(zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>()+numero_som) = nombre_coeff_non_nuls;
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 <span class="comment">// On remplit tab2 et coeff</span>
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 <span class="comment">// Les nb_elem premiers elements de la ligne &quot;numero_som&quot;</span>
<a name="l00321"></a>00321       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; Elem_pour_sommet.<a class="code" href="classIntList.html#ae8b23a7b17410d1e0bdcc20da0594f9b" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>(); i++)
<a name="l00322"></a>00322         {
<a name="l00323"></a>00323 <span class="comment">// A cause du FORTRAN</span>
<a name="l00324"></a>00324           la_matrice.get_set_tab2()(colonne_a_remplir_tab2) = Elem_pour_sommet[i]+1;
<a name="l00325"></a>00325           la_matrice.get_set_coeff()(colonne_a_remplir_coeff) =
<a name="l00326"></a>00326             <a class="code" href="classOp__Diff__RotRot.html#a13e0f43be13978852558cb5d2f7fade9">remplir_som_elem_EF</a>(Elem_pour_sommet[i],numero_som);
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 <span class="comment">// On incremente nb_coeff_non_nuls car on vient de remplir</span>
<a name="l00329"></a>00329 <span class="comment">// une ligne avec l&#39;un de ces elements non nul</span>
<a name="l00330"></a>00330           nombre_coeff_non_nuls++;
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="comment">// On incremente convenablement les indices de colonnes</span>
<a name="l00333"></a>00333           colonne_a_remplir_tab2++;
<a name="l00334"></a>00334           colonne_a_remplir_coeff++;
<a name="l00335"></a>00335         }
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 <span class="comment">// Pas besoin de modifier les entiers nb_coeff_non_nuls et</span>
<a name="l00338"></a>00338 <span class="comment">// colonne_* : ils sont a la bonne valeur.</span>
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 <span class="comment">// Les nb_som elements de la ligne &quot;numero_som&quot;</span>
<a name="l00341"></a>00341       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; Sommets_voisins.<a class="code" href="classIntList.html#ae8b23a7b17410d1e0bdcc20da0594f9b" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>(); i++)
<a name="l00342"></a>00342         {
<a name="l00343"></a>00343 <span class="comment">// On recupere le numero global du sommet_voisin</span>
<a name="l00344"></a>00344           <span class="keywordtype">int</span> numero_som_global = Sommets_voisins[i];
<a name="l00345"></a>00345 
<a name="l00346"></a>00346 <span class="comment">// Et si &quot;numero_som_global&quot; est different du numero</span>
<a name="l00347"></a>00347 <span class="comment">// du dernier sommet, alors on stocke le bon coefficient</span>
<a name="l00348"></a>00348 
<a name="l00349"></a>00349           <span class="keywordflow">if</span> (numero_som_global != zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>()-1)
<a name="l00350"></a>00350             {
<a name="l00351"></a>00351 <span class="comment">// A cause du FORTRAN</span>
<a name="l00352"></a>00352               la_matrice.get_set_tab2()(colonne_a_remplir_tab2) =
<a name="l00353"></a>00353                 zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>()+Sommets_voisins[i]+1;
<a name="l00354"></a>00354               la_matrice.get_set_coeff()(colonne_a_remplir_coeff) =
<a name="l00355"></a>00355                 <a class="code" href="classOp__Diff__RotRot.html#a4d95095e28decec9aa47326a14d92e11">remplir_som_som_EF</a>(numero_som,Sommets_voisins[i],Elem_pour_sommet);
<a name="l00356"></a>00356 
<a name="l00357"></a>00357 <span class="comment">// On incremente nb_coeff_non_nuls car on vient de remplir</span>
<a name="l00358"></a>00358 <span class="comment">// une ligne avec l&#39;un de ces elements non nul</span>
<a name="l00359"></a>00359               nombre_coeff_non_nuls++;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361 <span class="comment">// On incremente les indices</span>
<a name="l00362"></a>00362               colonne_a_remplir_tab2++;
<a name="l00363"></a>00363               colonne_a_remplir_coeff++;
<a name="l00364"></a>00364             }
<a name="l00365"></a>00365 
<a name="l00366"></a>00366         }
<a name="l00367"></a>00367 
<a name="l00368"></a>00368 <span class="comment">// Pas besoin d&#39;incrementer nombre_coeff_non_nuls et colonne_*</span>
<a name="l00369"></a>00369 <span class="comment">// : ils sont deja a la bonne valeur</span>
<a name="l00370"></a>00370     }
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 <span class="comment">// Par convention pour les matrices morses, le dernier element</span>
<a name="l00373"></a>00373 <span class="comment">// de tab1 est tab1[zone.nb_elem()+zone.nb_som()+1] et vaut</span>
<a name="l00374"></a>00374 <span class="comment">// le nombre total de coefficients non nuls +1</span>
<a name="l00375"></a>00375 <span class="comment">// soit avec notre algorithme: nombre_coeff_non_nuls</span>
<a name="l00376"></a>00376   la_matrice.get_set_tab1()(zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>()+zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>()-1) = nombre_coeff_non_nuls;
<a name="l00377"></a>00377 
<a name="l00378"></a>00378 <span class="comment">// if(Debog::mode_db==2) Debog::save_matrix_seq(la_matrice);</span>
<a name="l00379"></a>00379 <span class="comment">// else if(Debog::mode_db==3)</span>
<a name="l00380"></a>00380 <span class="comment">// Debog::save_and_distribute_matrix_seq(la_matrice);</span>
<a name="l00381"></a>00381 
<a name="l00382"></a>00382   <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; la_matrice_sym = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,
<a name="l00383"></a>00383                                                matrice.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l00384"></a>00384   la_matrice_sym = la_matrice;
<a name="l00385"></a>00385 
<a name="l00386"></a>00386   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Fin de l&#39;assemblage de la matrice de vorticite. &quot;</span> &lt;&lt; finl;
<a name="l00387"></a>00387 
<a name="l00388"></a>00388   <span class="keywordflow">return</span> 1;
<a name="l00389"></a>00389 }
<a name="l00390"></a>00390 
<a name="l00391"></a>00391 <span class="comment">/* Pour un element donne &quot;numero_elem&quot; retourne */</span>
<a name="l00392"></a>00392 <span class="comment">/* la liste des sommets appartenant a cet element */</span>
<a name="l00393"></a><a class="code" href="classOp__Diff__RotRot.html#a9cd512857a9c0992557f0f57ace95ebb">00393</a> <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a> <a class="code" href="classOp__Diff__RotRot.html#a9cd512857a9c0992557f0f57ace95ebb">Op_Diff_RotRot::sommets_pour_element</a>(<span class="keywordtype">int</span> numero_elem)<span class="keyword"> const</span>
<a name="l00394"></a>00394 <span class="keyword"></span>{
<a name="l00395"></a>00395   <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a> resultat;
<a name="l00396"></a>00396   <span class="keywordtype">int</span> numero_global_sommet = 0;
<a name="l00397"></a>00397   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = <a class="code" href="classOp__Diff__RotRot.html#afead7c7cedd99653b9eb38dafc9d1459">zone_Vef</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 <span class="comment">// Par precaution mais normalement inutile</span>
<a name="l00400"></a>00400   <span class="keywordflow">if</span> (! resultat.<a class="code" href="classIntListElem.html#ab51c7ccf0b6cafff507e631d4203b5bd" title="renvoie 1 si la liste est vide renvoie 0 sinon.">est_vide</a>() ) resultat.<a class="code" href="classIntList.html#ab659c50477f288e2122b1184e59bae90" title="Vide la liste.">vide</a>();
<a name="l00401"></a>00401 
<a name="l00402"></a>00402   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt; zone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>() ; i++)
<a name="l00403"></a>00403     {
<a name="l00404"></a>00404       numero_global_sommet = zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(numero_elem,i);
<a name="l00405"></a>00405       resultat.<a class="code" href="classIntList.html#a251e57a817484f3c2bb8e9382ebb55b4" title="Ajout d&#39;un element a la liste ssi il n&#39;existe pas deja.">add_if_not</a>(numero_global_sommet);
<a name="l00406"></a>00406     }
<a name="l00407"></a>00407 
<a name="l00408"></a>00408   <span class="keywordflow">return</span> resultat;
<a name="l00409"></a>00409 }
<a name="l00410"></a>00410 
<a name="l00411"></a>00411 <span class="comment">/* Pour un sommet donne &quot;numero_sommet&quot; retourne */</span>
<a name="l00412"></a>00412 <span class="comment">/* la liste des elements contenant ce sommet */</span>
<a name="l00413"></a>00413 <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a>
<a name="l00414"></a><a class="code" href="classOp__Diff__RotRot.html#a9cdf99b46403be6cf5056e1d44d22097">00414</a> <a class="code" href="classOp__Diff__RotRot.html#a9cdf99b46403be6cf5056e1d44d22097">Op_Diff_RotRot::elements_pour_sommet</a>(<span class="keywordtype">int</span> numero_sommet)<span class="keyword"> const</span>
<a name="l00415"></a>00415 <span class="keyword"></span>{
<a name="l00416"></a>00416   <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a> resultat;
<a name="l00417"></a>00417   <span class="keywordtype">int</span> numero_global_som;
<a name="l00418"></a>00418   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = <a class="code" href="classOp__Diff__RotRot.html#afead7c7cedd99653b9eb38dafc9d1459">zone_Vef</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00419"></a>00419 
<a name="l00420"></a>00420 <span class="comment">// Par precaution mais normalement inutile</span>
<a name="l00421"></a>00421   <span class="keywordflow">if</span> (! resultat.<a class="code" href="classIntListElem.html#ab51c7ccf0b6cafff507e631d4203b5bd" title="renvoie 1 si la liste est vide renvoie 0 sinon.">est_vide</a>() ) resultat.<a class="code" href="classIntList.html#ab659c50477f288e2122b1184e59bae90" title="Vide la liste.">vide</a>();
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 <span class="comment">// Pas tres efficace mais marche quelle que soit la dimension:</span>
<a name="l00424"></a>00424 <span class="comment">// on boucle sur les elements, on regarde pour chaque element</span>
<a name="l00425"></a>00425 <span class="comment">// ses sommets, puis on compare ces sommets au parametre d&#39;entree</span>
<a name="l00426"></a>00426 <span class="comment">// et si l&#39;un d&#39;eux coincide avec le parametre d&#39;entree, on stocke</span>
<a name="l00427"></a>00427 <span class="comment">// l&#39;element.</span>
<a name="l00428"></a>00428   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> numero_elem = 0 ; numero_elem &lt; zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>() ; numero_elem++)
<a name="l00429"></a>00429     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> numero_som = 0 ; numero_som &lt; zone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>() ; numero_som++)
<a name="l00430"></a>00430       {
<a name="l00431"></a>00431         numero_global_som = zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(numero_elem,numero_som);
<a name="l00432"></a>00432         <span class="keywordflow">if</span> ( numero_sommet == numero_global_som )
<a name="l00433"></a>00433           resultat.<a class="code" href="classIntList.html#a251e57a817484f3c2bb8e9382ebb55b4" title="Ajout d&#39;un element a la liste ssi il n&#39;existe pas deja.">add_if_not</a>(numero_elem);
<a name="l00434"></a>00434       }
<a name="l00435"></a>00435 
<a name="l00436"></a>00436   <span class="keywordflow">return</span> resultat;
<a name="l00437"></a>00437 
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 
<a name="l00440"></a>00440 <span class="comment">/* Pour un sommet donne &quot;numero_sommet&quot; retourne */</span>
<a name="l00441"></a>00441 <span class="comment">/* la liste des sommets voisins de &quot;numero_sommet&quot; */</span>
<a name="l00442"></a>00442 <span class="comment">/* Parametre: la liste des elements contenant &quot;numero_sommet&quot; */</span>
<a name="l00443"></a>00443 <span class="comment">/* Il suffit de chercher dans ces elements pour avoir le resultat */</span>
<a name="l00444"></a>00444 <span class="comment">/* REM: la liste resultat contient le sommet &quot;numero_sommet&quot; */</span>
<a name="l00445"></a>00445 <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a> <a class="code" href="classOp__Diff__RotRot.html#a510b30206bd2f0b670519f8d4f459518">Op_Diff_RotRot::</a>
<a name="l00446"></a><a class="code" href="classOp__Diff__RotRot.html#a510b30206bd2f0b670519f8d4f459518">00446</a> <a class="code" href="classOp__Diff__RotRot.html#a510b30206bd2f0b670519f8d4f459518">sommets_voisins</a>(<span class="keywordtype">int</span> numero_sommet,<span class="keyword">const</span> <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a>&amp; <a class="code" href="classliste.html" title="Les classes liste et liste_curseur representent une liste de Deriv&lt;Objet_U&gt; et un curseur associe...">liste</a>)<span class="keyword"> const</span>
<a name="l00447"></a>00447 <span class="keyword"></span>{
<a name="l00448"></a>00448   <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a> resultat;
<a name="l00449"></a>00449   <span class="keywordtype">int</span> numero_global_som;
<a name="l00450"></a>00450   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = <a class="code" href="classOp__Diff__RotRot.html#afead7c7cedd99653b9eb38dafc9d1459">zone_Vef</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00451"></a>00451 
<a name="l00452"></a>00452 <span class="comment">// Il suffit de recuperer les sommets des elements de &quot;liste&quot;</span>
<a name="l00453"></a>00453 <span class="comment">// puis de les comparer a &quot;numero_som&quot; et de les conserver</span>
<a name="l00454"></a>00454 <span class="comment">// sans doublon.</span>
<a name="l00455"></a>00455   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> numero_elem_loc = 0 ; numero_elem_loc&lt;liste.<a class="code" href="classIntList.html#ae8b23a7b17410d1e0bdcc20da0594f9b" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>(); numero_elem_loc++)
<a name="l00456"></a>00456     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> numero_som = 0; numero_som &lt; zone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>() ; numero_som++)
<a name="l00457"></a>00457       {
<a name="l00458"></a>00458         numero_global_som =
<a name="l00459"></a>00459           zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(liste[numero_elem_loc],numero_som);
<a name="l00460"></a>00460         resultat.<a class="code" href="classIntList.html#a251e57a817484f3c2bb8e9382ebb55b4" title="Ajout d&#39;un element a la liste ssi il n&#39;existe pas deja.">add_if_not</a>(numero_global_som); <span class="comment">//contient &quot;numero_sommet&quot;</span>
<a name="l00461"></a>00461       }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463 <span class="comment">// Cerr &lt;&lt; &quot;Affichage de sommets_voisins pour numero_som &quot; &lt;&lt; numero_sommet</span>
<a name="l00464"></a>00464 <span class="comment">// &lt;&lt; finl;</span>
<a name="l00465"></a>00465 <span class="comment">// for (int i=0;i&lt;resultat.size();i++)</span>
<a name="l00466"></a>00466 <span class="comment">// Cerr &lt;&lt; resultat[i] &lt;&lt; finl;</span>
<a name="l00467"></a>00467 
<a name="l00468"></a>00468   <span class="keywordflow">return</span> resultat;
<a name="l00469"></a>00469 }
<a name="l00470"></a>00470 
<a name="l00471"></a>00471 <span class="comment">/* Fonction de tri d&#39;une IntList */</span>
<a name="l00472"></a>00472 <span class="comment">/* Le tri s&#39;effectue par ordre croissant */</span>
<a name="l00473"></a>00473 <span class="comment">/* REM: on n&#39;a aucun doublon dans la liste triee */</span>
<a name="l00474"></a><a class="code" href="classOp__Diff__RotRot.html#ad47914f4e58b4324c20f0950b21bfc3a">00474</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__RotRot.html#ad47914f4e58b4324c20f0950b21bfc3a">Op_Diff_RotRot::Tri</a>(<a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a>&amp; liste_a_trier)<span class="keyword"> const</span>
<a name="l00475"></a>00475 <span class="keyword"></span>{
<a name="l00476"></a>00476   <span class="keywordflow">if</span> (liste_a_trier.<a class="code" href="classIntListElem.html#ab51c7ccf0b6cafff507e631d4203b5bd" title="renvoie 1 si la liste est vide renvoie 0 sinon.">est_vide</a>())
<a name="l00477"></a>00477     {
<a name="l00478"></a>00478       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans Op_Diff_RotRot::Tri().&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00479"></a>00479       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;La liste a trier est vide: sortie du programme.&quot;</span> &lt;&lt; finl;
<a name="l00480"></a>00480       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00481"></a>00481     }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483   <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a> temporaire;
<a name="l00484"></a>00484   <span class="keywordtype">int</span> <a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ade923cb828015cfde5aff245ecd65936">minimum</a>;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486   <span class="keywordflow">while</span> ( !liste_a_trier.<a class="code" href="classIntListElem.html#ab51c7ccf0b6cafff507e631d4203b5bd" title="renvoie 1 si la liste est vide renvoie 0 sinon.">est_vide</a>() )
<a name="l00487"></a>00487     {
<a name="l00488"></a>00488       minimum = liste_a_trier[0];
<a name="l00489"></a>00489 
<a name="l00490"></a>00490       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; liste_a_trier.<a class="code" href="classIntList.html#ae8b23a7b17410d1e0bdcc20da0594f9b" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>(); i++)
<a name="l00491"></a>00491         minimum = (minimum &lt;= liste_a_trier[i] ? minimum : liste_a_trier[i]);
<a name="l00492"></a>00492 
<a name="l00493"></a>00493       temporaire.<a class="code" href="classIntList.html#a251e57a817484f3c2bb8e9382ebb55b4" title="Ajout d&#39;un element a la liste ssi il n&#39;existe pas deja.">add_if_not</a>(minimum);
<a name="l00494"></a>00494       liste_a_trier.<a class="code" href="classIntList.html#a68bef5fbf040c0a0058272dbd69b1bce" title="Supprime un element contenu dans la liste.">suppr</a>(minimum);
<a name="l00495"></a>00495     }
<a name="l00496"></a>00496 
<a name="l00497"></a>00497   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0 ; i &lt; temporaire.<a class="code" href="classIntList.html#ae8b23a7b17410d1e0bdcc20da0594f9b" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>() ; i++)
<a name="l00498"></a>00498     liste_a_trier.<a class="code" href="classIntList.html#a251e57a817484f3c2bb8e9382ebb55b4" title="Ajout d&#39;un element a la liste ssi il n&#39;existe pas deja.">add_if_not</a>(temporaire[i]);
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 }
<a name="l00501"></a>00501 
<a name="l00502"></a>00502 <span class="comment">/* Pour l&#39;element &quot;numero_elem&quot; retourne le coefficient */</span>
<a name="l00503"></a>00503 <span class="comment">/* a placer dans la sous matrice de taille nb_elem * nb_elem */</span>
<a name="l00504"></a>00504 <span class="comment">/* a la ligne &quot;numero_elem&quot; , colonne &quot;numero_elem&quot;*/</span>
<a name="l00505"></a>00505 <span class="comment">/* Matrice EF */</span>
<a name="l00506"></a>00506 <span class="keywordtype">double</span>
<a name="l00507"></a><a class="code" href="classOp__Diff__RotRot.html#a79468e0b7c3f8e910422c15b01f5f6ad">00507</a> <a class="code" href="classOp__Diff__RotRot.html#a79468e0b7c3f8e910422c15b01f5f6ad">Op_Diff_RotRot::remplir_elem_elem_EF</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; numero_elem)<span class="keyword"> const</span>
<a name="l00508"></a>00508 <span class="keyword"></span>{
<a name="l00509"></a>00509   <span class="keywordflow">return</span> 1.*<a class="code" href="classOp__Diff__RotRot.html#afead7c7cedd99653b9eb38dafc9d1459">zone_Vef</a>().<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(numero_elem);
<a name="l00510"></a>00510 }
<a name="l00511"></a>00511 
<a name="l00512"></a>00512 <span class="comment">/* Pour l&#39;element &quot;numero_elem&quot; retourne le coefficient */</span>
<a name="l00513"></a>00513 <span class="comment">/* a placer dans la sous matrice de taille nb_elem * nb_som */</span>
<a name="l00514"></a>00514 <span class="comment">/* a la ligne &quot;numero_elem&quot; , colonne &quot;numero_som&quot;*/</span>
<a name="l00515"></a>00515 <span class="comment">/* Matrice EF */</span>
<a name="l00516"></a><a class="code" href="classOp__Diff__RotRot.html#ab00a3dc467baea961ec75e582073ae36">00516</a> <span class="keywordtype">double</span> <a class="code" href="classOp__Diff__RotRot.html#ab00a3dc467baea961ec75e582073ae36">Op_Diff_RotRot::remplir_elem_som_EF</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; numero_elem,
<a name="l00517"></a>00517                                            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; numero_som)<span class="keyword"></span>
<a name="l00518"></a>00518 <span class="keyword">const</span>
<a name="l00519"></a>00519 <span class="keyword"></span>{
<a name="l00520"></a>00520   <span class="keywordflow">return</span> (1.*<a class="code" href="classOp__Diff__RotRot.html#afead7c7cedd99653b9eb38dafc9d1459">zone_Vef</a>().volumes(numero_elem)/(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+1));
<a name="l00521"></a>00521 }
<a name="l00522"></a>00522 
<a name="l00523"></a>00523 <span class="comment">/* Pour le sommet &quot;numero_som&quot; retourne le coefficient */</span>
<a name="l00524"></a>00524 <span class="comment">/* a placer dans la sous matrice de taille nb_som * nb_elem */</span>
<a name="l00525"></a>00525 <span class="comment">/* a la ligne &quot;numero_som&quot; , colonne &quot;numero_elem&quot;*/</span>
<a name="l00526"></a>00526 <span class="comment">/* Matrice EF */</span>
<a name="l00527"></a>00527 <span class="keywordtype">double</span>
<a name="l00528"></a><a class="code" href="classOp__Diff__RotRot.html#a13e0f43be13978852558cb5d2f7fade9">00528</a> <a class="code" href="classOp__Diff__RotRot.html#a13e0f43be13978852558cb5d2f7fade9">Op_Diff_RotRot::remplir_som_elem_EF</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; numero_elem,
<a name="l00529"></a>00529                                     <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; numero_som)<span class="keyword"> const</span>
<a name="l00530"></a>00530 <span class="keyword"></span>{
<a name="l00531"></a>00531   <span class="keywordflow">return</span> (1.*<a class="code" href="classOp__Diff__RotRot.html#afead7c7cedd99653b9eb38dafc9d1459">zone_Vef</a>().volumes(numero_elem)/(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+1));
<a name="l00532"></a>00532 }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534 <span class="comment">/* Pour l&#39;element &quot;numero_som&quot; retourne le coefficient */</span>
<a name="l00535"></a>00535 <span class="comment">/* a placer dans la sous matrice de taille nb_som * nb_som */</span>
<a name="l00536"></a>00536 <span class="comment">/* a la ligne &quot;numero_som&quot; , colonne &quot;sommet_voisin&quot;*/</span>
<a name="l00537"></a>00537 <span class="comment">/* &quot;elem_voisins&quot; est le tableau des elements contenant &quot;numero_som&quot; */</span>
<a name="l00538"></a>00538 <span class="comment">/* Matrice EF */</span>
<a name="l00539"></a>00539 <span class="keywordtype">double</span>
<a name="l00540"></a><a class="code" href="classOp__Diff__RotRot.html#a4d95095e28decec9aa47326a14d92e11">00540</a> <a class="code" href="classOp__Diff__RotRot.html#a4d95095e28decec9aa47326a14d92e11">Op_Diff_RotRot::remplir_som_som_EF</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; numero_som,
<a name="l00541"></a>00541                                    <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; sommet_voisin,
<a name="l00542"></a>00542                                    <span class="keyword">const</span> <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a>&amp; elem_voisins)<span class="keyword"> const</span>
<a name="l00543"></a>00543 <span class="keyword"></span>{
<a name="l00544"></a>00544   <span class="keywordtype">double</span> resultat = 0.;
<a name="l00545"></a>00545   <span class="keywordtype">int</span> <a class="code" href="Op__Grad__EF_8cpp.html#abc0897c211f7aa4541da5833388f868b">test</a> = 0;
<a name="l00546"></a>00546 
<a name="l00547"></a>00547 <span class="comment">// Premier test: si numero_som = sommet_voisin</span>
<a name="l00548"></a>00548 <span class="comment">// Alors on peut tout de suite retourner le resultat</span>
<a name="l00549"></a>00549   <span class="keywordflow">if</span> (numero_som == sommet_voisin)
<a name="l00550"></a>00550     {
<a name="l00551"></a>00551       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;elem_voisins.<a class="code" href="classIntList.html#ae8b23a7b17410d1e0bdcc20da0594f9b" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>(); i++)
<a name="l00552"></a>00552         {
<a name="l00553"></a>00553           resultat += <a class="code" href="classOp__Diff__RotRot.html#afead7c7cedd99653b9eb38dafc9d1459">zone_Vef</a>().<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem_voisins[i]);
<a name="l00554"></a>00554         }
<a name="l00555"></a>00555 
<a name="l00556"></a>00556 <span class="comment">// On tient compte de la dimension dans nos calculs</span>
<a name="l00557"></a>00557       resultat *= 2./((<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+1)*(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+2));
<a name="l00558"></a>00558 
<a name="l00559"></a>00559       <span class="keywordflow">return</span> resultat;
<a name="l00560"></a>00560     }
<a name="l00561"></a>00561 
<a name="l00562"></a>00562 <span class="comment">// Sinon:</span>
<a name="l00563"></a>00563 <span class="comment">// On calcule la contribution au resultat</span>
<a name="l00564"></a>00564 
<a name="l00565"></a>00565   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;elem_voisins.<a class="code" href="classIntList.html#ae8b23a7b17410d1e0bdcc20da0594f9b" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>() ; i++)
<a name="l00566"></a>00566     {
<a name="l00567"></a>00567       <span class="keywordflow">if</span> (<a class="code" href="classOp__Diff__RotRot.html#a9cd512857a9c0992557f0f57ace95ebb">sommets_pour_element</a>(elem_voisins[i]).<a class="code" href="classIntList.html#a545a62e316ce95d5b1931d216b97fd35" title="Verifie si un element appartient ou non a la liste.">contient</a>(sommet_voisin))
<a name="l00568"></a>00568         {
<a name="l00569"></a>00569           resultat += <a class="code" href="classOp__Diff__RotRot.html#afead7c7cedd99653b9eb38dafc9d1459">zone_Vef</a>().<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>(elem_voisins[i]);
<a name="l00570"></a>00570           test++;
<a name="l00571"></a>00571         }
<a name="l00572"></a>00572     }
<a name="l00573"></a>00573 
<a name="l00574"></a>00574 <span class="comment">// On tient compte de la dimension dans laquelle on evolue</span>
<a name="l00575"></a>00575   resultat *= 1./((<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+1)*(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+2));
<a name="l00576"></a>00576 
<a name="l00577"></a>00577 <span class="comment">// On verifier que sommet_voisin etait bien dans le voisinage de numero_voisin</span>
<a name="l00578"></a>00578   <span class="keywordflow">if</span> (test == 0)
<a name="l00579"></a>00579     {
<a name="l00580"></a>00580       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur Op_Diff_RotRot::remplir_som_som_EF.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00581"></a>00581       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;sommet_voisin n&#39;est pas dans le voisinage de numero_voisin.&quot;</span>
<a name="l00582"></a>00582            &lt;&lt; finl;
<a name="l00583"></a>00583       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Sortie du programme.&quot;</span> &lt;&lt; finl;
<a name="l00584"></a>00584       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00585"></a>00585     }
<a name="l00586"></a>00586 
<a name="l00587"></a>00587   <span class="keywordflow">return</span> resultat;
<a name="l00588"></a>00588 
<a name="l00589"></a>00589 }
<a name="l00590"></a>00590 
<a name="l00591"></a>00591 
<a name="l00592"></a>00592 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>
<a name="l00593"></a><a class="code" href="classOp__Diff__RotRot.html#aa4923e1a6a2ac52b0c30b19ede9bad4f">00593</a> <a class="code" href="classOp__Diff__RotRot.html#aa4923e1a6a2ac52b0c30b19ede9bad4f">Op_Diff_RotRot::vecteur_normal</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; face, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; elem)<span class="keyword"> const</span>
<a name="l00594"></a>00594 <span class="keyword"></span>{
<a name="l00595"></a>00595   assert(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2);
<a name="l00596"></a>00596 
<a name="l00597"></a>00597   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Diff__RotRot.html#acfc857bb8f14b3f69e5418810ff59efd">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
<a name="l00598"></a>00598   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> le_vecteur_normal(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00599"></a>00599 
<a name="l00600"></a>00600   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a> = 0; <a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; <a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>++)
<a name="l00601"></a>00601 
<a name="l00602"></a>00602     le_vecteur_normal(<a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>) = zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>(face,<a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>)
<a name="l00603"></a>00603                                     * zone_VEF.<a class="code" href="classZone__VEF.html#a5c3e9d7f89d87989e338f5d725853e48">oriente_normale</a>(face,elem);
<a name="l00604"></a>00604 
<a name="l00605"></a>00605   <span class="keywordflow">return</span> le_vecteur_normal;
<a name="l00606"></a>00606 }
<a name="l00607"></a>00607 
<a name="l00608"></a><a class="code" href="classOp__Diff__RotRot.html#abb50cce2f67e16b350cbd37a2751d7b2">00608</a> <span class="keywordtype">int</span> <a class="code" href="classOp__Diff__RotRot.html#abb50cce2f67e16b350cbd37a2751d7b2">Op_Diff_RotRot::tester</a>()<span class="keyword"> const</span>
<a name="l00609"></a>00609 <span class="keyword"></span>{
<a name="l00610"></a>00610 <span class="comment">// const Zone&amp; zone = zone_Vef().zone();</span>
<a name="l00611"></a>00611 
<a name="l00612"></a>00612 <span class="comment">// if (vorticite_.valeur().nb_valeurs_nodales() !=</span>
<a name="l00613"></a>00613 <span class="comment">// zone.nb_elem()+zone.nb_som()-1 )</span>
<a name="l00614"></a>00614 <span class="comment">// {</span>
<a name="l00615"></a>00615 <span class="comment">// Cerr &lt;&lt; &quot;Probleme dans la definition de la vorticite.&quot; &lt;&lt; finl;</span>
<a name="l00616"></a>00616 <span class="comment">// Cerr &lt;&lt; &quot;Le nombre de composante enregistree n&#39;est pas le bon.&quot; &lt;&lt; finl;</span>
<a name="l00617"></a>00617 <span class="comment">// Process::exit();</span>
<a name="l00618"></a>00618 <span class="comment">// }</span>
<a name="l00619"></a>00619 
<a name="l00620"></a>00620 <span class="comment">// Test de la matrice de vorticite</span>
<a name="l00621"></a>00621   <span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; la_matrice=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,
<a name="l00622"></a>00622                                                <a class="code" href="classOp__Diff__RotRot.html#ac7de3a6a93b09d8a3d83140c683fb885">matrice_vorticite_</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l00623"></a>00623   <a class="code" href="classSolv__GCP.html">Solv_GCP</a>&amp; solv = <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classSolv__GCP.html">Solv_GCP</a>,<a class="code" href="classOp__Diff__RotRot.html#ad5ecf818aaf1e95f85482dbfa76eacc8">solveur_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>());
<a name="l00624"></a>00624 
<a name="l00625"></a>00625   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> resultat(la_matrice.<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>());
<a name="l00626"></a>00626   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> resultat1(la_matrice.<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>());
<a name="l00627"></a>00627   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> secmem(la_matrice.<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>());
<a name="l00628"></a>00628   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> secmem1(la_matrice.<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>());
<a name="l00629"></a>00629   secmem = 0.;
<a name="l00630"></a>00630   secmem[0]=-0.25;
<a name="l00631"></a>00631   secmem[4]=-0.0833333;
<a name="l00632"></a>00632   secmem[5]=-0.0833333;
<a name="l00633"></a>00633   secmem1 = 1e-10 + 1e-15;
<a name="l00634"></a>00634 
<a name="l00635"></a>00635   <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> fic(<span class="stringliteral">&quot;Matrice.test&quot;</span>);
<a name="l00636"></a>00636   la_matrice.<a class="code" href="classMatrice__Morse__Sym.html#abdc9966827b915d03d440994ff3fe7de">imprimer_formatte</a>(fic);
<a name="l00637"></a>00637 
<a name="l00638"></a>00638   resultat = 0.;
<a name="l00639"></a>00639   solv.set_seuil(1e-17);
<a name="l00640"></a>00640   solv.resoudre_systeme(la_matrice,secmem,resultat);
<a name="l00641"></a>00641   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Resultat de l&#39;inversion&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00642"></a>00642   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)
<a name="l00643"></a>00643     <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; resultat[i] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span>;
<a name="l00644"></a>00644   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl;
<a name="l00645"></a>00645 
<a name="l00646"></a>00646   solv.resoudre_systeme(la_matrice,secmem1,resultat);
<a name="l00647"></a>00647   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Resultat de l&#39;inversion&quot;</span> &lt;&lt; finl;
<a name="l00648"></a>00648   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)
<a name="l00649"></a>00649     <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; resultat[i] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span>;
<a name="l00650"></a>00650   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl;
<a name="l00651"></a>00651 
<a name="l00652"></a>00652   <span class="keywordflow">return</span> 1;
<a name="l00653"></a>00653 }
<a name="l00654"></a>00654 
<a name="l00655"></a><a class="code" href="classOp__Diff__RotRot.html#a8345ed4e1cc613633202f7453b32a9ad">00655</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__RotRot.html#a8345ed4e1cc613633202f7453b32a9ad">Op_Diff_RotRot::associer_diffusivite</a>(<span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; diffu)
<a name="l00656"></a>00656 {
<a name="l00657"></a>00657   <a class="code" href="classOp__Diff__RotRot.html#adc504199273c14f1cf58b8e2f0e3fbcb">diffusivite_</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Uniforme.html" title="classe Champ_Uniforme Represente un champ constant dans l&#39;espace et dans le temps.">Champ_Uniforme</a>, diffu);
<a name="l00658"></a>00658 }
<a name="l00659"></a>00659 
<a name="l00660"></a><a class="code" href="classOp__Diff__RotRot.html#af7e886571c8d30dc978f4013ae85fdd8">00660</a> <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; <a class="code" href="classOp__Diff__RotRot.html#af7e886571c8d30dc978f4013ae85fdd8">Op_Diff_RotRot::diffusivite</a>()<span class="keyword"> const</span>
<a name="l00661"></a>00661 <span class="keyword"></span>{
<a name="l00662"></a>00662   <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__RotRot.html#adc504199273c14f1cf58b8e2f0e3fbcb">diffusivite_</a>;
<a name="l00663"></a>00663 }
<a name="l00664"></a>00664 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:28 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
