<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Math/Matrices/Matrice_Morse_Sym.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Math/Matrices/Matrice_Morse_Sym.cpp</div>  </div>
</div>
<div class="contents">
<a href="Matrice__Morse__Sym_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Matrice_Morse_Sym.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Math/Matrices</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/38</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse__Sym_8h.html">Matrice_Morse_Sym.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="IntList_8h.html">IntList.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="DoubleList_8h.html">DoubleList.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Sparskit_8h.html">Sparskit.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="comm__incl_8h.html">comm_incl.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Noms_8h.html">Noms.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Vect__ArrOfInt_8h.html">Vect_ArrOfInt.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Vect__IntTab_8h.html">Vect_IntTab.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Array__tools_8h.html">Array_tools.h</a>&gt;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="Matrice__Morse__Sym_8cpp.html#a6767dab5015e1c922f79bbb371f355ed">00033</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,<span class="stringliteral">&quot;Matrice_Morse_Sym&quot;</span>,<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>);
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">// Precondition:</span>
<a name="l00036"></a>00036 <span class="comment">// Parametre: Sortie&amp; s</span>
<a name="l00037"></a>00037 <span class="comment">// Signification: un flot de sortie</span>
<a name="l00038"></a>00038 <span class="comment">// Valeurs par defaut:</span>
<a name="l00039"></a>00039 <span class="comment">// Contraintes:</span>
<a name="l00040"></a>00040 <span class="comment">// Acces: entree/sortie</span>
<a name="l00041"></a>00041 <span class="comment">// Exception:</span>
<a name="l00042"></a>00042 <span class="comment">// Effets de bord:</span>
<a name="l00043"></a>00043 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00044"></a>00044 <span class="comment">//</span>
<a name="l00045"></a>00045 <span class="comment">//</span><span class="comment"></span>
<a name="l00046"></a>00046 <span class="comment">//! Ecrit les trois tableaux de la structure de stockage&lt;br&gt;Morse sur un flot de sortie.</span>
<a name="l00047"></a>00047 <span class="comment"></span><span class="comment">/** \return Sortie\&amp; s&lt;br&gt;</span>
<a name="l00048"></a>00048 <span class="comment">Signification: le flot de sortie modifie&lt;br&gt;</span>
<a name="l00049"></a>00049 <span class="comment">Contraintes: */</span>
<a name="l00050"></a><a class="code" href="classMatrice__Morse__Sym.html#a04868f779d1134885b629937513a9d94">00050</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classMatrice__Morse__Sym.html#a04868f779d1134885b629937513a9d94" title="Ecrit les trois tableaux de la structure de stockage Morse sur un flot de sortie.">Matrice_Morse_Sym::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00051"></a>00051 <span class="keyword"></span>{
<a name="l00052"></a>00052   s&lt;&lt;<a class="code" href="classMatrice__Sym.html#a5cbcf1c7de27ffb81664ea574a37ebdc">get_est_definie</a>()&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00053"></a>00053   <span class="keywordflow">return</span>  <a class="code" href="classMatrice__Morse__Sym.html#a04868f779d1134885b629937513a9d94" title="Ecrit les trois tableaux de la structure de stockage Morse sur un flot de sortie.">Matrice_Morse::printOn</a>(s);
<a name="l00054"></a>00054 }
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">// Precondition:</span>
<a name="l00058"></a>00058 <span class="comment">// Parametre: Entree&amp; s</span>
<a name="l00059"></a>00059 <span class="comment">// Signification: un flot d&#39;entree</span>
<a name="l00060"></a>00060 <span class="comment">// Valeurs par defaut:</span>
<a name="l00061"></a>00061 <span class="comment">// Contraintes:</span>
<a name="l00062"></a>00062 <span class="comment">// Acces:</span>
<a name="l00063"></a>00063 <span class="comment">// Exception: NON CODE</span>
<a name="l00064"></a>00064 <span class="comment">// Effets de bord:</span>
<a name="l00065"></a>00065 <span class="comment">// Postcondition:</span>
<a name="l00066"></a>00066 <span class="comment">//</span><span class="comment"></span>
<a name="l00067"></a>00067 <span class="comment">//! NON CODE</span>
<a name="l00068"></a>00068 <span class="comment"></span><span class="comment">/** \return Entree\&amp; s&lt;br&gt;</span>
<a name="l00069"></a>00069 <span class="comment">Signification: le flot d&#39;entree&lt;br&gt;</span>
<a name="l00070"></a>00070 <span class="comment">Contraintes: */</span>
<a name="l00071"></a><a class="code" href="classMatrice__Morse__Sym.html#a429f76393ea7a45fcdde4f04582fb909">00071</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classMatrice__Morse__Sym.html#a429f76393ea7a45fcdde4f04582fb909" title="NON CODE.">Matrice_Morse_Sym::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s)
<a name="l00072"></a>00072 {
<a name="l00073"></a>00073   <span class="keywordtype">int</span> est_def;
<a name="l00074"></a>00074   s&gt;&gt;est_def;
<a name="l00075"></a>00075   <a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(est_def);
<a name="l00076"></a>00076   <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse__Sym.html#a429f76393ea7a45fcdde4f04582fb909" title="NON CODE.">Matrice_Morse::readOn</a>(s) ;
<a name="l00077"></a>00077 }
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="comment">// Precondition:</span>
<a name="l00080"></a>00080 <span class="comment">// Parametre: int n1</span>
<a name="l00081"></a>00081 <span class="comment">// Signification: le nombre de ligne de la matrice</span>
<a name="l00082"></a>00082 <span class="comment">// Valeurs par defaut:</span>
<a name="l00083"></a>00083 <span class="comment">// Contraintes:</span>
<a name="l00084"></a>00084 <span class="comment">// Acces:</span>
<a name="l00085"></a>00085 <span class="comment">// Parametre: int n2</span>
<a name="l00086"></a>00086 <span class="comment">// Signification: le nombre d&#39;element non nuls stockable</span>
<a name="l00087"></a>00087 <span class="comment">// par la matrice</span>
<a name="l00088"></a>00088 <span class="comment">// Valeurs par defaut:</span>
<a name="l00089"></a>00089 <span class="comment">// Contraintes:</span>
<a name="l00090"></a>00090 <span class="comment">// Acces:</span>
<a name="l00091"></a>00091 <span class="comment">// Parametre: IntLists&amp; voisins</span>
<a name="l00092"></a>00092 <span class="comment">// Signification: liste des voisins de chaque lignes</span>
<a name="l00093"></a>00093 <span class="comment">// Valeurs par defaut:</span>
<a name="l00094"></a>00094 <span class="comment">// Contraintes: reference constante</span>
<a name="l00095"></a>00095 <span class="comment">// Acces: entree</span>
<a name="l00096"></a>00096 <span class="comment">// Parametre: DoubleLists&amp; valeurs</span>
<a name="l00097"></a>00097 <span class="comment">// Signification: liste des valeurs</span>
<a name="l00098"></a>00098 <span class="comment">// Valeurs par defaut:</span>
<a name="l00099"></a>00099 <span class="comment">// Contraintes: reference constante</span>
<a name="l00100"></a>00100 <span class="comment">// Acces: entree</span>
<a name="l00101"></a>00101 <span class="comment">// Parametre: DoubleVect&amp; terme_diag</span>
<a name="l00102"></a>00102 <span class="comment">// Signification: le vecteur des termes diagonaux</span>
<a name="l00103"></a>00103 <span class="comment">// Valeurs par defaut:</span>
<a name="l00104"></a>00104 <span class="comment">// Contraintes: reference constante</span>
<a name="l00105"></a>00105 <span class="comment">// Acces: entree</span>
<a name="l00106"></a>00106 <span class="comment">// </span>
<a name="l00107"></a>00107 <span class="comment">// Signification:</span>
<a name="l00108"></a>00108 <span class="comment">// Contraintes:</span>
<a name="l00109"></a>00109 <span class="comment">// Exception:</span>
<a name="l00110"></a>00110 <span class="comment">// Effets de bord:</span>
<a name="l00111"></a>00111 <span class="comment">// Postcondition:</span>
<a name="l00112"></a>00112 <span class="comment">//</span>
<a name="l00113"></a>00113 <span class="comment">//</span>
<a name="l00114"></a>00114 <span class="comment">//</span>
<a name="l00115"></a>00115 <span class="comment">//</span><span class="comment"></span>
<a name="l00116"></a>00116 <span class="comment">//! Constructeur d&#39;une Matrice_Morse_Sym comportant&lt;br&gt;n1 lignes et pouvant stocker n2 elements non-nuls (au maximum).&lt;br&gt;Les elements de la matrice et la table des connectivites&lt;br&gt;sont donnes dans les 3 derniers parametres.</span>
<a name="l00117"></a><a class="code" href="classMatrice__Morse__Sym.html#a17ccd7052b2127471d5f9b2165c39909">00117</a> <span class="comment"></span><a class="code" href="classMatrice__Morse__Sym.html#a46004c1d36ecc881d303d197df44b5bd">Matrice_Morse_Sym::Matrice_Morse_Sym</a>(<span class="keywordtype">int</span> n1, <span class="keywordtype">int</span> n2, <span class="keyword">const</span> <a class="code" href="classIntLists.html" title="Un tableau de listes de type IntList.">IntLists</a>&amp; voisins,
<a name="l00118"></a>00118                                      <span class="keyword">const</span> <a class="code" href="classDoubleLists.html" title="Un tableau de listes de type DoubleList.">DoubleLists</a>&amp; valeurs,
<a name="l00119"></a>00119                                      <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; terme_diag)
<a name="l00120"></a>00120   : <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>(n1, n2)
<a name="l00121"></a>00121 {
<a name="l00122"></a>00122   <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>=1;
<a name="l00123"></a>00123   <a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">remplir</a>(voisins, valeurs, terme_diag);
<a name="l00124"></a>00124   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00125"></a>00125 }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="comment">// Precondition:</span>
<a name="l00129"></a>00129 <span class="comment">// Parametre: Matrice_Morse&amp; acopier</span>
<a name="l00130"></a>00130 <span class="comment">// Signification: la matrice a copier</span>
<a name="l00131"></a>00131 <span class="comment">// Valeurs par defaut:</span>
<a name="l00132"></a>00132 <span class="comment">// Contraintes: reference constante</span>
<a name="l00133"></a>00133 <span class="comment">// Acces: entree</span>
<a name="l00134"></a>00134 <span class="comment">// </span>
<a name="l00135"></a>00135 <span class="comment">// Signification:</span>
<a name="l00136"></a>00136 <span class="comment">// Contraintes:</span>
<a name="l00137"></a>00137 <span class="comment">// Exception:</span>
<a name="l00138"></a>00138 <span class="comment">// Effets de bord:</span>
<a name="l00139"></a>00139 <span class="comment">// Postcondition:</span>
<a name="l00140"></a>00140 <span class="comment">//</span>
<a name="l00141"></a>00141 <span class="comment">//</span><span class="comment"></span>
<a name="l00142"></a>00142 <span class="comment">//! Constructeur d&#39;une Matrice_Morse_Sym par copie&lt;br&gt;d&#39;une Matrice_Morse.</span>
<a name="l00143"></a><a class="code" href="classMatrice__Morse__Sym.html#af70b860119743ab711f850277f0ae8d7">00143</a> <span class="comment"></span><a class="code" href="classMatrice__Morse__Sym.html#a46004c1d36ecc881d303d197df44b5bd">Matrice_Morse_Sym::Matrice_Morse_Sym</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; A)
<a name="l00144"></a>00144   :<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>(A)
<a name="l00145"></a>00145 {
<a name="l00146"></a>00146   <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>=1;
<a name="l00147"></a>00147   <a class="code" href="classMatrice__Morse.html#af1142c6d58bd4b5d01cfbb9bdc600fe9">partie_sup</a>(A);
<a name="l00148"></a>00148   <a class="code" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69" title="Suppression des doublons on ordonne tab2; Verification de la diagonale: tous ses elements doivent etr...">compacte</a>();
<a name="l00149"></a>00149   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00150"></a>00150 }
<a name="l00151"></a><a class="code" href="classMatrice__Morse__Sym.html#acd3dbb1c63b431a6da8dd76af9b4e3bf">00151</a> <a class="code" href="classMatrice__Morse__Sym.html#a46004c1d36ecc881d303d197df44b5bd">Matrice_Morse_Sym::Matrice_Morse_Sym</a>(<span class="keyword">const</span> <a class="code" href="classMatrice.html">Matrice</a>&amp; A)
<a name="l00152"></a>00152 {
<a name="l00153"></a>00153   <span class="keyword">const</span> <a class="code" href="classMatrice__Base.html">Matrice_Base</a>&amp; A_base=A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>();
<a name="l00154"></a>00154   <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, A_base))
<a name="l00155"></a>00155     *<span class="keyword">this</span>=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, A_base);
<a name="l00156"></a>00156   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>, A_base))
<a name="l00157"></a>00157     *<span class="keyword">this</span>=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>, A_base);
<a name="l00158"></a>00158   <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>=1;
<a name="l00159"></a>00159   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00160"></a>00160 }
<a name="l00161"></a><a class="code" href="classMatrice__Morse__Sym.html#aa7bc2a550de22b700d1e09a28173629d">00161</a> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; <a class="code" href="classMatrice__Morse__Sym.html#ab4afafb3e5027f6dbf51a02eb4b872ec" title="Operateur d&#39;affectatiob d&#39;une Matrice_Morse_Sym dans une Matrice_Morse_Sym.">Matrice_Morse_Sym::operator=</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; A)
<a name="l00162"></a>00162 {
<a name="l00163"></a>00163   <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>=A.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>();
<a name="l00164"></a>00164   <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>=A.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>();
<a name="l00165"></a>00165   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>=A.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>();
<a name="l00166"></a>00166   <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a>=A.<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();
<a name="l00167"></a>00167   <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>=A.<a class="code" href="classMatrice__Morse.html#a6f50c254db1753e72f23c6d051590fe7">get_symmetric</a>();
<a name="l00168"></a>00168   <a class="code" href="classMatrice__Morse.html#af1142c6d58bd4b5d01cfbb9bdc600fe9">partie_sup</a>(A);
<a name="l00169"></a>00169   <a class="code" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69" title="Suppression des doublons on ordonne tab2; Verification de la diagonale: tous ses elements doivent etr...">compacte</a>();
<a name="l00170"></a>00170   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00171"></a>00171   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=A.<a class="code" href="classMatrice__Base.html#aa1828bab9e4980e6980b7e71ae280c1c">is_stencil_up_to_date</a>();
<a name="l00172"></a>00172   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00173"></a>00173 }
<a name="l00174"></a><a class="code" href="classMatrice__Morse__Sym.html#af851ed8ed57b42bc66389bfdac4239a3">00174</a> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; <a class="code" href="classMatrice__Morse__Sym.html#ab4afafb3e5027f6dbf51a02eb4b872ec" title="Operateur d&#39;affectatiob d&#39;une Matrice_Morse_Sym dans une Matrice_Morse_Sym.">Matrice_Morse_Sym::operator=</a>(<span class="keyword">const</span> <a class="code" href="classMatrice.html">Matrice</a>&amp; A)
<a name="l00175"></a>00175 {
<a name="l00176"></a>00176   <span class="keyword">const</span> <a class="code" href="classMatrice__Base.html">Matrice_Base</a>&amp; A_base=A.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>();
<a name="l00177"></a>00177   <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, A_base))
<a name="l00178"></a>00178     *<span class="keyword">this</span>=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, A_base);
<a name="l00179"></a>00179   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>, A_base))
<a name="l00180"></a>00180     *<span class="keyword">this</span>=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>, A_base);
<a name="l00181"></a>00181   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00182"></a>00182   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00183"></a>00183 }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 <span class="comment">// Precondition:</span>
<a name="l00186"></a>00186 <span class="comment">// Parametre: Matrice_Morse&amp; acopier</span>
<a name="l00187"></a>00187 <span class="comment">// Signification: la matrice a copier</span>
<a name="l00188"></a>00188 <span class="comment">// Valeurs par defaut:</span>
<a name="l00189"></a>00189 <span class="comment">// Contraintes: reference constante</span>
<a name="l00190"></a>00190 <span class="comment">// Acces: entree</span>
<a name="l00191"></a>00191 <span class="comment">// </span>
<a name="l00192"></a>00192 <span class="comment">// Signification:</span>
<a name="l00193"></a>00193 <span class="comment">// Contraintes:</span>
<a name="l00194"></a>00194 <span class="comment">// Exception:</span>
<a name="l00195"></a>00195 <span class="comment">// Effets de bord:</span>
<a name="l00196"></a>00196 <span class="comment">// Postcondition:</span>
<a name="l00197"></a>00197 <span class="comment">//</span>
<a name="l00198"></a>00198 <span class="comment">//</span><span class="comment"></span>
<a name="l00199"></a>00199 <span class="comment">//! Constructeur d&#39;une Matrice_Morse_Sym par copie&lt;br&gt;d&#39;une Matrice_Morse.</span>
<a name="l00200"></a><a class="code" href="classMatrice__Morse__Sym.html#ab710e4e2d024cb8cab3e36ef2f16ffac">00200</a> <span class="comment"></span><a class="code" href="classMatrice__Morse__Sym.html#a46004c1d36ecc881d303d197df44b5bd">Matrice_Morse_Sym::Matrice_Morse_Sym</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; acopier) :
<a name="l00201"></a>00201   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>(acopier),<a class="code" href="classMatrice__Sym.html" title="Classe Matrice_Sym Cette classe est la classe de base pour la representantion des matrices symetrique...">Matrice_Sym</a>()
<a name="l00202"></a>00202 {
<a name="l00203"></a>00203   <a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(acopier.<a class="code" href="classMatrice__Sym.html#a5cbcf1c7de27ffb81664ea574a37ebdc">get_est_definie</a>());
<a name="l00204"></a>00204   <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>=1;
<a name="l00205"></a>00205   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00206"></a>00206 }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <span class="comment">// Precondition:</span>
<a name="l00209"></a>00209 <span class="comment">// Parametre: DoubleTab&amp; x</span>
<a name="l00210"></a>00210 <span class="comment">// Signification: la matrice a multiplier</span>
<a name="l00211"></a>00211 <span class="comment">// Valeurs par defaut:</span>
<a name="l00212"></a>00212 <span class="comment">// Contraintes: reference constante</span>
<a name="l00213"></a>00213 <span class="comment">// Acces: entree</span>
<a name="l00214"></a>00214 <span class="comment">// Parametre: DoubleTab&amp; resu</span>
<a name="l00215"></a>00215 <span class="comment">// Signification: la matrice resultat de l&#39;operation</span>
<a name="l00216"></a>00216 <span class="comment">// Valeurs par defaut:</span>
<a name="l00217"></a>00217 <span class="comment">// Contraintes:</span>
<a name="l00218"></a>00218 <span class="comment">// Acces: entree/sortie</span>
<a name="l00219"></a>00219 <span class="comment">// Exception: taille du resultat incompatible avec la taille de x</span>
<a name="l00220"></a>00220 <span class="comment">// Effets de bord:</span>
<a name="l00221"></a>00221 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00222"></a>00222 <span class="comment">//</span>
<a name="l00223"></a>00223 <span class="comment">//</span>
<a name="l00224"></a>00224 <span class="comment">//</span><span class="comment"></span>
<a name="l00225"></a>00225 <span class="comment">//! Operation de multiplication-accumulation (saxpy) matrice matrice&lt;br&gt;(matrice represente par un tableau)&lt;br&gt;Operation: RESU = RESU + A*X</span>
<a name="l00226"></a>00226 <span class="comment"></span><span class="comment">/** \return DoubleTab\&amp;&lt;br&gt;</span>
<a name="l00227"></a>00227 <span class="comment">Signification: la matrice resultat de l&#39;operation&lt;br&gt;</span>
<a name="l00228"></a>00228 <span class="comment">Contraintes: */</span>
<a name="l00229"></a><a class="code" href="classMatrice__Morse__Sym.html#a9aaf9f8c5d9066345a411aa19daaf99d">00229</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classMatrice__Morse__Sym.html#a9aaf9f8c5d9066345a411aa19daaf99d" title="Operation de multiplication-accumulation (saxpy) matrice matrice&lt;br&gt;(matrice represente par un tablea...">Matrice_Morse_Sym::ajouter_multTab_</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; x, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00230"></a>00230 <span class="keyword"></span>{
<a name="l00231"></a>00231   <span class="keywordflow">if</span> ( (x.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 1) &amp;&amp; (resu.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 1))
<a name="l00232"></a>00232     {
<a name="l00233"></a>00233       <a class="code" href="classMatrice__Base.html#a6ccb4d20d3877cf09f5178ff72af5406" title="Operation de multiplication-accumulation (saxpy) matrice vecteur. Operation: r = r + A*x...">ajouter_multvect</a>(x,resu);
<a name="l00234"></a>00234       <span class="keywordflow">return</span> resu;
<a name="l00235"></a>00235     }
<a name="l00236"></a>00236 
<a name="l00237"></a>00237   <a class="code" href="classMatrice__Morse__Sym.html#a840956dbca5097382324a5dd4d35db76">assert_check_symmetric_morse_matrix_structure</a>( );
<a name="l00238"></a>00238   <span class="keywordtype">int</span> i,k,j;
<a name="l00239"></a>00239   <span class="keywordtype">double</span> aij;
<a name="l00240"></a>00240   <span class="keywordtype">int</span> comp;
<a name="l00241"></a>00241   <span class="keywordtype">int</span> nb_com=x.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00242"></a>00242   assert(resu.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1)==nb_com);
<a name="l00243"></a>00243   <span class="keywordtype">double</span>* t=<span class="keyword">new</span> <span class="keywordtype">double</span>[nb_com];
<a name="l00244"></a>00244   <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00245"></a>00245   <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
<a name="l00246"></a>00246     {
<a name="l00247"></a>00247       <span class="keywordflow">for</span>(comp=0; comp&lt;nb_com; comp++)
<a name="l00248"></a>00248         t[comp] = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1)*x(i,comp);
<a name="l00249"></a>00249       <span class="keywordflow">for</span> (k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i); k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
<a name="l00250"></a>00250         {
<a name="l00251"></a>00251           j = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1;
<a name="l00252"></a>00252           aij = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k);
<a name="l00253"></a>00253           <span class="keywordflow">for</span>(comp=0; comp&lt;nb_com; comp++)
<a name="l00254"></a>00254             {
<a name="l00255"></a>00255               t[comp] += aij*x(j,comp);
<a name="l00256"></a>00256               resu(j,comp) += aij*x(i,comp);
<a name="l00257"></a>00257             }
<a name="l00258"></a>00258         }
<a name="l00259"></a>00259       <span class="keywordflow">for</span>(comp=0; comp&lt;nb_com; comp++)
<a name="l00260"></a>00260         resu(i,comp) += t[comp] ;
<a name="l00261"></a>00261     }
<a name="l00262"></a>00262   <span class="keyword">delete</span> [] t;
<a name="l00263"></a>00263   <span class="keywordflow">return</span> resu;
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 
<a name="l00266"></a><a class="code" href="classMatrice__Morse__Sym.html#a32f04eb58027168900262c381afc7c89">00266</a> <span class="keywordtype">double</span> <a class="code" href="classMatrice__Morse__Sym.html#a32f04eb58027168900262c381afc7c89">Matrice_Morse_Sym::multvect_et_prodscal</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; x, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00267"></a>00267 <span class="keyword"></span>{
<a name="l00268"></a>00268   <a class="code" href="classMatrice__Morse__Sym.html#a840956dbca5097382324a5dd4d35db76">assert_check_symmetric_morse_matrix_structure</a>( );
<a name="l00269"></a>00269 
<a name="l00270"></a>00270   assert(x.<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>() == <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() || x.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>());
<a name="l00271"></a>00271   assert(resu.<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>() == <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() || resu.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>());
<a name="l00272"></a>00272   assert(<a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a> &lt;= x.<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>());
<a name="l00273"></a>00273 
<a name="l00274"></a>00274   <span class="keywordtype">double</span> prod_scal_local = 0.;
<a name="l00275"></a>00275   <a class="code" href="DoubleVect_8cpp.html#ad0e13908fed9f476adc797982dce010a">operator_egal</a>(resu, 0.);
<a name="l00276"></a>00276 
<a name="l00277"></a>00277   <span class="keyword">const</span> <span class="keywordtype">int</span> fin = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() + 1;
<a name="l00278"></a>00278   {
<a name="l00279"></a>00279     <span class="keyword">const</span> <span class="keywordtype">double</span> * thecoef = <a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>().<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() - 1;
<a name="l00280"></a>00280     <span class="keyword">const</span> <span class="keywordtype">double</span> * xx = x.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() - 1;
<a name="l00281"></a>00281     <span class="keywordtype">double</span> * res = resu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() - 1;
<a name="l00282"></a>00282     <span class="keyword">const</span> <span class="keywordtype">int</span> * index1 = <a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() - 1;
<a name="l00283"></a>00283     <span class="keyword">const</span> <span class="keywordtype">int</span> * index2 = <a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() - 1;
<a name="l00284"></a>00284 <span class="preprocessor">#ifdef COMPILER_BLRTS_XLC</span>
<a name="l00285"></a>00285 <span class="preprocessor"></span><span class="preprocessor">#pragma disjoint (*coef, *xx, *res)</span>
<a name="l00286"></a>00286 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00287"></a>00287 <span class="preprocessor"></span>    <span class="keywordtype">int</span> i;
<a name="l00288"></a>00288     <span class="keywordflow">for</span> (i = 1; i &lt; fin; i++)
<a name="l00289"></a>00289       {
<a name="l00290"></a>00290         <span class="keywordtype">int</span> j = index1[i];
<a name="l00291"></a>00291         <span class="keywordtype">int</span> j_next= index1[i+1];
<a name="l00292"></a>00292 <span class="comment">// int ncoeffs = j_next - j;</span>
<a name="l00293"></a>00293         assert(i==index2[j]); <span class="comment">//!&lt; La diagonale meme nulle doit etre stockee dans une Mat_Morse_Sym</span>
<a name="l00294"></a>00294 <span class="comment"></span>        <span class="keywordtype">double</span> xi = xx[i];
<a name="l00295"></a>00295         <span class="keywordtype">double</span> resu_tmp = res[i] + thecoef[j] * xi;
<a name="l00296"></a>00296         j++;
<a name="l00297"></a>00297         <span class="keywordflow">for</span> (; j &lt; j_next; j++)
<a name="l00298"></a>00298           {
<a name="l00299"></a>00299             <span class="keywordtype">int</span> nj     = index2[j];
<a name="l00300"></a>00300             <span class="keywordtype">double</span> coef_j = thecoef[j];
<a name="l00301"></a>00301             <span class="keywordtype">double</span> xn     = xx[nj];
<a name="l00302"></a>00302             resu_tmp   += coef_j * xn;
<a name="l00303"></a>00303             res[nj] += coef_j * xi;
<a name="l00304"></a>00304           }
<a name="l00305"></a>00305         res[i] = resu_tmp;
<a name="l00306"></a>00306         prod_scal_local += resu_tmp * xi;
<a name="l00307"></a>00307       }
<a name="l00308"></a>00308   }
<a name="l00309"></a>00309 
<a name="l00310"></a>00310   <span class="keywordflow">return</span> prod_scal_local;
<a name="l00311"></a>00311 }
<a name="l00312"></a>00312 
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 <span class="comment">// Precondition:</span>
<a name="l00315"></a>00315 <span class="comment">// Parametre: DoubleVect&amp; x</span>
<a name="l00316"></a>00316 <span class="comment">// Signification: le vecteur a multiplier</span>
<a name="l00317"></a>00317 <span class="comment">// Valeurs par defaut:</span>
<a name="l00318"></a>00318 <span class="comment">// Contraintes: reference constante</span>
<a name="l00319"></a>00319 <span class="comment">// Acces: entree</span>
<a name="l00320"></a>00320 <span class="comment">// Parametre: DoubleVect&amp; resu</span>
<a name="l00321"></a>00321 <span class="comment">// Signification: le vecteur resultat de l&#39;operation</span>
<a name="l00322"></a>00322 <span class="comment">// Valeurs par defaut:</span>
<a name="l00323"></a>00323 <span class="comment">// Contraintes:</span>
<a name="l00324"></a>00324 <span class="comment">// Acces: entree/sortie</span>
<a name="l00325"></a>00325 <span class="comment">// Exception:</span>
<a name="l00326"></a>00326 <span class="comment">// Effets de bord:</span>
<a name="l00327"></a>00327 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00328"></a>00328 <span class="comment">//</span>
<a name="l00329"></a>00329 <span class="comment">//</span><span class="comment"></span>
<a name="l00330"></a>00330 <span class="comment">//! Operation de multiplication-accumulation (saxpy) matrice vecteur.&lt;br&gt;Operation: resu = resu + A*x</span>
<a name="l00331"></a>00331 <span class="comment"></span><span class="comment">/** \return DoubleVect\&amp;&lt;br&gt;</span>
<a name="l00332"></a>00332 <span class="comment">Signification: le vecteur resultat de l&#39;operation&lt;br&gt;</span>
<a name="l00333"></a>00333 <span class="comment">Contraintes: */</span>
<a name="l00334"></a>00334 
<a name="l00335"></a><a class="code" href="classMatrice__Morse__Sym.html#af26200777293b4b2813bf264f92a7bea">00335</a> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classMatrice__Morse__Sym.html#af26200777293b4b2813bf264f92a7bea" title="Operation de multiplication-accumulation (saxpy) matrice vecteur. Operation: resu = resu + A*x...">Matrice_Morse_Sym::ajouter_multvect_</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; x, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00336"></a>00336 <span class="keyword"></span>{
<a name="l00337"></a>00337   <a class="code" href="classMatrice__Morse__Sym.html#a840956dbca5097382324a5dd4d35db76">assert_check_symmetric_morse_matrix_structure</a>( );
<a name="l00338"></a>00338 
<a name="l00339"></a>00339   assert(x.<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>() == <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() || x.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>());
<a name="l00340"></a>00340   assert(resu.<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>() == <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() || resu.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>());
<a name="l00341"></a>00341   assert(<a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a> &lt;= x.<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>());
<a name="l00342"></a>00342 
<a name="l00343"></a>00343   <span class="keyword">const</span> <span class="keywordtype">int</span> fin = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() + 1;
<a name="l00344"></a>00344   {
<a name="l00345"></a>00345     <span class="keyword">const</span> <span class="keywordtype">double</span> * thecoef = <a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>().<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() - 1;
<a name="l00346"></a>00346     <span class="keyword">const</span> <span class="keywordtype">double</span> * xx = x.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() - 1;
<a name="l00347"></a>00347     <span class="keywordtype">double</span> * res = resu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() - 1;
<a name="l00348"></a>00348     <span class="keyword">const</span> <span class="keywordtype">int</span> * index1 = <a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() - 1;
<a name="l00349"></a>00349     <span class="keyword">const</span> <span class="keywordtype">int</span> * index2 = <a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() - 1;
<a name="l00350"></a>00350 <span class="preprocessor">#ifdef COMPILER_BLRTS_XLC</span>
<a name="l00351"></a>00351 <span class="preprocessor"></span><span class="preprocessor">#pragma disjoint (*coef, *xx, *res)</span>
<a name="l00352"></a>00352 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00353"></a>00353 <span class="preprocessor"></span>    <span class="keywordtype">int</span> i;
<a name="l00354"></a>00354     <span class="keywordflow">for</span> (i = 1; i &lt; fin; i++)
<a name="l00355"></a>00355       {
<a name="l00356"></a>00356         <span class="keywordtype">int</span> j = index1[i];
<a name="l00357"></a>00357         <span class="keywordtype">int</span> j_next= index1[i+1];
<a name="l00358"></a>00358         assert(i==index2[j]); <span class="comment">//!&lt; La diagonale meme nulle doit etre stockee dans une Mat_Morse_Sym</span>
<a name="l00359"></a>00359 <span class="comment"></span><span class="preprocessor">#if 0</span>
<a name="l00360"></a>00360 <span class="preprocessor"></span><span class="comment">// Note B.M.: sur les procs intel ce deroulage n&#39;a aucun effet benefique.</span>
<a name="l00361"></a>00361         <span class="keywordtype">int</span> ncoeffs = j_next - j;
<a name="l00362"></a>00362         <span class="keywordflow">if</span> (ncoeffs == 4)
<a name="l00363"></a>00363           {
<a name="l00364"></a>00364             <span class="keywordtype">int</span> n2 = index2[j+1];
<a name="l00365"></a>00365             <span class="keywordtype">int</span> n3 = index2[j+2];
<a name="l00366"></a>00366             <span class="keywordtype">int</span> n4 = index2[j+3];
<a name="l00367"></a>00367             <span class="keywordtype">double</span> xi = xx[i];
<a name="l00368"></a>00368             <span class="keywordtype">double</span> res_i  = res[i];
<a name="l00369"></a>00369             <span class="keywordtype">double</span> res_n2 = res[n2];
<a name="l00370"></a>00370             <span class="keywordtype">double</span> res_n3 = res[n3];
<a name="l00371"></a>00371             <span class="keywordtype">double</span> res_n4 = res[n4];
<a name="l00372"></a>00372             <span class="keywordtype">double</span> a1 = thecoef[j];
<a name="l00373"></a>00373             <span class="keywordtype">double</span> a2 = thecoef[j+1];
<a name="l00374"></a>00374             <span class="keywordtype">double</span> a3 = thecoef[j+2];
<a name="l00375"></a>00375             <span class="keywordtype">double</span> a4 = thecoef[j+3];
<a name="l00376"></a>00376             res[i] = res_i + a1 * xi + a2 * xx[n2] + a3 * xx[n3] + a4 * xx[n4];
<a name="l00377"></a>00377             res[n2] = res_n2 + a2 * xi;
<a name="l00378"></a>00378             res[n3] = res_n3 + a3 * xi;
<a name="l00379"></a>00379             res[n4] = res_n4 + a4 * xi;
<a name="l00380"></a>00380           }
<a name="l00381"></a>00381         <span class="keywordflow">else</span>
<a name="l00382"></a>00382 <span class="preprocessor">#endif</span>
<a name="l00383"></a>00383 <span class="preprocessor"></span>          {
<a name="l00384"></a>00384             <span class="keywordtype">double</span> xi = xx[i];
<a name="l00385"></a>00385             <span class="keywordtype">double</span> resu_tmp = res[i] + thecoef[j] * xi;
<a name="l00386"></a>00386             j++;
<a name="l00387"></a>00387             <span class="keywordflow">for</span> (; j &lt; j_next; j++)
<a name="l00388"></a>00388               {
<a name="l00389"></a>00389                 <span class="keywordtype">int</span> nj     = index2[j];
<a name="l00390"></a>00390                 <span class="keywordtype">double</span> coef_j = thecoef[j];
<a name="l00391"></a>00391                 <span class="keywordtype">double</span> xn     = xx[nj];
<a name="l00392"></a>00392                 resu_tmp   += coef_j * xn;
<a name="l00393"></a>00393                 res[nj] += coef_j * xi;
<a name="l00394"></a>00394               }
<a name="l00395"></a>00395             res[i] = resu_tmp;
<a name="l00396"></a>00396           }
<a name="l00397"></a>00397       }
<a name="l00398"></a>00398   }
<a name="l00399"></a>00399 <span class="preprocessor">#if 0</span>
<a name="l00400"></a>00400 <span class="preprocessor"></span>  <span class="keywordtype">int</span> fin2,l;
<a name="l00401"></a>00401   m=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(0);
<a name="l00402"></a>00402   <span class="keywordflow">for</span>(i=debut; i&lt;n; i++)
<a name="l00403"></a>00403     {
<a name="l00404"></a>00404       xi=x(i);
<a name="l00405"></a>00405       l=m;
<a name="l00406"></a>00406       m=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1);
<a name="l00407"></a>00407       t = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(l-1)*xi;
<a name="l00408"></a>00408       assert(i==tab2(l-1)-1); <span class="comment">//!&lt; La diagonale meme nulle doit etre stockee dans une Mat_Morse_Sym aij=coeff_(tab1_(i)-1);</span>
<a name="l00409"></a>00409 <span class="comment"></span><span class="comment">//</span>
<a name="l00410"></a>00410       fin2=m-1;
<a name="l00411"></a>00411       <span class="keywordflow">for</span> (k=l; k&lt;fin2; k++)
<a name="l00412"></a>00412         {
<a name="l00413"></a>00413           j = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1;
<a name="l00414"></a>00414           assert(j&lt;n);
<a name="l00415"></a>00415           aij = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k);
<a name="l00416"></a>00416           t += aij*x(j);
<a name="l00417"></a>00417           resu(j) += aij*xi;
<a name="l00418"></a>00418         }
<a name="l00419"></a>00419       resu(i) += t ;
<a name="l00420"></a>00420     }
<a name="l00421"></a>00421 <span class="preprocessor">#endif</span>
<a name="l00422"></a>00422 <span class="preprocessor"></span>  <span class="keywordflow">return</span> resu;
<a name="l00423"></a>00423 }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425 
<a name="l00426"></a>00426 <span class="comment">// Precondition:</span>
<a name="l00427"></a>00427 <span class="comment">// Parametre: DoubleVect&amp; x</span>
<a name="l00428"></a>00428 <span class="comment">// Signification: le vecteur a multiplier</span>
<a name="l00429"></a>00429 <span class="comment">// Valeurs par defaut:</span>
<a name="l00430"></a>00430 <span class="comment">// Contraintes: reference constante</span>
<a name="l00431"></a>00431 <span class="comment">// Acces: entree</span>
<a name="l00432"></a>00432 <span class="comment">// Parametre: DoubleVect&amp; resu</span>
<a name="l00433"></a>00433 <span class="comment">// Signification: le vecteur resultat de l&#39;operation</span>
<a name="l00434"></a>00434 <span class="comment">// Valeurs par defaut:</span>
<a name="l00435"></a>00435 <span class="comment">// Contraintes:</span>
<a name="l00436"></a>00436 <span class="comment">// Acces: entree/sortie</span>
<a name="l00437"></a>00437 <span class="comment">// Exception:</span>
<a name="l00438"></a>00438 <span class="comment">// Effets de bord:</span>
<a name="l00439"></a>00439 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00440"></a>00440 <span class="comment">//</span>
<a name="l00441"></a>00441 <span class="comment">//</span>
<a name="l00442"></a>00442 <span class="comment">//</span><span class="comment"></span>
<a name="l00443"></a>00443 <span class="comment">//! Operation de multiplication-accumulation (saxpy) matrice vecteur,&lt;br&gt;par la matrice transposee.&lt;br&gt;Operation: resu = resu + A^{T}*x</span>
<a name="l00444"></a>00444 <span class="comment"></span><span class="comment">/** \return DoubleVect\&amp;&lt;br&gt;</span>
<a name="l00445"></a>00445 <span class="comment">Signification: le vecteur resultat de l&#39;operation&lt;br&gt;</span>
<a name="l00446"></a>00446 <span class="comment">Contraintes: */</span>
<a name="l00447"></a><a class="code" href="classMatrice__Morse__Sym.html#a745d059b38d2b7c9698cf1428fe1bfb1">00447</a> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classMatrice__Morse__Sym.html#a745d059b38d2b7c9698cf1428fe1bfb1" title="Operation de multiplication-accumulation (saxpy) matrice vecteur, par la matrice transposee. Operation: resu = resu + A^{T}*x.">Matrice_Morse_Sym::ajouter_multvectT_</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; x,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00448"></a>00448 <span class="keyword"></span>{
<a name="l00449"></a>00449   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt;<span class="stringliteral">&quot;Matrice_Morse_Sym::ajouter_multvectT_ is not coded&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00450"></a>00450   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00451"></a>00451   <span class="keywordflow">return</span> resu;
<a name="l00452"></a>00452 }
<a name="l00453"></a>00453 
<a name="l00454"></a>00454 
<a name="l00455"></a>00455 <span class="comment">// Precondition:</span>
<a name="l00456"></a>00456 <span class="comment">// Parametre: Matrice_Morse_Sym&amp;</span>
<a name="l00457"></a>00457 <span class="comment">// Signification:</span>
<a name="l00458"></a>00458 <span class="comment">// Valeurs par defaut:</span>
<a name="l00459"></a>00459 <span class="comment">// Contraintes: reference constante</span>
<a name="l00460"></a>00460 <span class="comment">// Acces: NON ACCEDE</span>
<a name="l00461"></a>00461 <span class="comment">// Parametre: Matrice_Morse_Sym&amp;</span>
<a name="l00462"></a>00462 <span class="comment">// Signification:</span>
<a name="l00463"></a>00463 <span class="comment">// Valeurs par defaut:</span>
<a name="l00464"></a>00464 <span class="comment">// Contraintes: reference constante</span>
<a name="l00465"></a>00465 <span class="comment">// Acces: NON ACCEDE</span>
<a name="l00466"></a>00466 <span class="comment">// Exception:</span>
<a name="l00467"></a>00467 <span class="comment">// Effets de bord:</span>
<a name="l00468"></a>00468 <span class="comment">// Postcondition:</span>
<a name="l00469"></a>00469 <span class="comment">//</span>
<a name="l00470"></a>00470 <span class="comment">//</span><span class="comment"></span>
<a name="l00471"></a>00471 <span class="comment">//! Fonction (hors classe) amie de la classe Matrice_Morse_Sym&lt;br&gt;NE FAIT RIEN : NON CODE</span>
<a name="l00472"></a>00472 <span class="comment"></span><span class="comment">/** \return Matrice_Morse_Sym&lt;br&gt;</span>
<a name="l00473"></a>00473 <span class="comment">Signification:&lt;br&gt;</span>
<a name="l00474"></a>00474 <span class="comment">Contraintes: */</span>
<a name="l00475"></a><a class="code" href="Matrice__Morse__Sym_8h.html#a81022edd57add341568ebad7cc21847f">00475</a> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a> <a class="code" href="Matrice__Morse_8cpp.html#a17a186d3ca06dea0e9b1ad445a4ea482" title="Fonction (hors classe) amie de la classe Matrice_Morse Addition de 2 matrices au format Morse...">operator+</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; A,<span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; B)
<a name="l00476"></a>00476 {
<a name="l00477"></a>00477 <span class="comment">// Il faut evidemment que les matrices soient de meme taille</span>
<a name="l00478"></a>00478   <span class="keywordflow">if</span> (A.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() != B.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>())
<a name="l00479"></a>00479     {
<a name="l00480"></a>00480       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Matrice_Morse_Sym::operator+&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00481"></a>00481       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The 2 matrices must have the same dimension&quot;</span> &lt;&lt; finl;
<a name="l00482"></a>00482       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The first matrix is of dimension: &quot;</span> &lt;&lt; A.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>()&lt;&lt; finl;
<a name="l00483"></a>00483       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The second matrix is of dimension: &quot;</span> &lt;&lt; B.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>()&lt;&lt; finl;
<a name="l00484"></a>00484       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00485"></a>00485     }
<a name="l00486"></a>00486 
<a name="l00487"></a>00487   <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a> somme(A.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>(),A.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>()+B.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>());
<a name="l00488"></a>00488   <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a> colonnes_A_ligne_i,colonnes_B_ligne_i;
<a name="l00489"></a>00489   <span class="keywordtype">int</span> min_colonnes_A,min_colonnes_B,non_nuls_ligne_i;
<a name="l00490"></a>00490   <a class="code" href="classDoubleList.html" title="Classe qui sert a representer une liste de reels double precision. On ne peut pas utiliser la classe ...">DoubleList</a> coeffs_A_ligne_i,coeffs_B_ligne_i;
<a name="l00491"></a>00491   <span class="keywordtype">double</span> coeff_A,coeff_B;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 <span class="comment">// Pour s&#39;assurer que compacte() va marcher</span>
<a name="l00494"></a>00494   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;somme.get_coeff().size(); i++)
<a name="l00495"></a>00495     somme.get_set_coeff()(i) = 0.;
<a name="l00496"></a>00496 
<a name="l00497"></a>00497 <span class="comment">// On va remplir tab2_ par ordre croissant de colonnes</span>
<a name="l00498"></a>00498   somme.get_set_tab1()(0) = 1;
<a name="l00499"></a>00499   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;A.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>(); i++) <span class="comment">//boucle sur les lignes</span>
<a name="l00500"></a>00500     {
<a name="l00501"></a>00501 <span class="comment">// Pour eviter les effets de bord</span>
<a name="l00502"></a>00502       <span class="keywordflow">if</span> (!colonnes_A_ligne_i.est_vide()) colonnes_A_ligne_i.<a class="code" href="classDoubleList.html#aae05a1c0527362651081f64e204e7c5c" title="Vide la liste.">vide</a>();
<a name="l00503"></a>00503       <span class="keywordflow">if</span> (!colonnes_B_ligne_i.est_vide()) colonnes_B_ligne_i.vide();
<a name="l00504"></a>00504 
<a name="l00505"></a>00505 <span class="comment">// Initialisation des colonnes_A et colonnes_B</span>
<a name="l00506"></a>00506 <span class="comment">// ATTENTION a la numerotation C++</span>
<a name="l00507"></a>00507       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;A.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i+1)-A.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i); j++)
<a name="l00508"></a>00508         {
<a name="l00509"></a>00509           colonnes_A_ligne_i.add_if_not(A.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>()(A.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i)+j-1));
<a name="l00510"></a>00510           coeffs_A_ligne_i.<a class="code" href="classDoubleList.html#ac5009562ee7ed83808aa48bb4cc363d9" title="insertion en queue">add</a>(A.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>()(A.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i)+j-1));
<a name="l00511"></a>00511         }<span class="comment">//fin for</span>
<a name="l00512"></a>00512 
<a name="l00513"></a>00513       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;B.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i+1)-B.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i); j++)
<a name="l00514"></a>00514         {
<a name="l00515"></a>00515           colonnes_B_ligne_i.<a class="code" href="classDoubleList.html#a09d4563db75cdcab4a7b796dd2779eff" title="Ajout d&#39;un element a la liste ssi il n&#39;existe pas deja.">add_if_not</a>(B.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>()(B.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i)+j-1));
<a name="l00516"></a>00516           coeffs_B_ligne_i.<a class="code" href="classDoubleList.html#ac5009562ee7ed83808aa48bb4cc363d9" title="insertion en queue">add</a>(B.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>()(B.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i)+j-1));
<a name="l00517"></a>00517         }<span class="comment">//fin for</span>
<a name="l00518"></a>00518 
<a name="l00519"></a>00519 <span class="comment">// On initialise d&#39;autres varibles</span>
<a name="l00520"></a>00520       non_nuls_ligne_i = 0;
<a name="l00521"></a>00521 
<a name="l00522"></a>00522 <span class="comment">// Debut de l&#39;algorithme</span>
<a name="l00523"></a>00523       <span class="keywordflow">while</span> (!colonnes_A_ligne_i.est_vide() || !colonnes_B_ligne_i.est_vide())
<a name="l00524"></a>00524         {
<a name="l00525"></a>00525 <span class="comment">// Si l&#39;une des listes est vide et pas l&#39;autre</span>
<a name="l00526"></a>00526           <span class="keywordflow">if</span> (colonnes_A_ligne_i.est_vide() &amp;&amp; !colonnes_B_ligne_i.est_vide())
<a name="l00527"></a>00527             {
<a name="l00528"></a>00528               somme.get_set_tab2()(somme.get_tab1()(i)+non_nuls_ligne_i-1) =
<a name="l00529"></a>00529                 colonnes_B_ligne_i[0];
<a name="l00530"></a>00530 
<a name="l00531"></a>00531               somme.get_set_coeff()(somme.get_tab1()(i)+non_nuls_ligne_i-1) =
<a name="l00532"></a>00532                 coeffs_B_ligne_i[0] ;
<a name="l00533"></a>00533 
<a name="l00534"></a>00534               colonnes_B_ligne_i.<a class="code" href="classDoubleList.html#a47ce98cd0acad997044986fda2cf6bef" title="Supprime un element contenu dans la liste.">suppr</a>(colonnes_B_ligne_i[0]);
<a name="l00535"></a>00535               coeffs_B_ligne_i.<a class="code" href="classDoubleList.html#a47ce98cd0acad997044986fda2cf6bef" title="Supprime un element contenu dans la liste.">suppr</a>(coeffs_B_ligne_i[0]);
<a name="l00536"></a>00536               non_nuls_ligne_i++;
<a name="l00537"></a>00537             }<span class="comment">//fin if</span>
<a name="l00538"></a>00538 
<a name="l00539"></a>00539           <span class="keywordflow">if</span> (colonnes_B_ligne_i.est_vide() &amp;&amp; !colonnes_A_ligne_i.est_vide())
<a name="l00540"></a>00540             {
<a name="l00541"></a>00541               somme.get_set_tab2()(somme.get_tab1()(i)+non_nuls_ligne_i-1) =
<a name="l00542"></a>00542                 colonnes_A_ligne_i[0];
<a name="l00543"></a>00543 
<a name="l00544"></a>00544               somme.get_set_coeff()(somme.get_tab1()(i)+non_nuls_ligne_i-1) =
<a name="l00545"></a>00545                 coeffs_A_ligne_i[0];
<a name="l00546"></a>00546 
<a name="l00547"></a>00547               colonnes_A_ligne_i.<a class="code" href="classDoubleList.html#a47ce98cd0acad997044986fda2cf6bef" title="Supprime un element contenu dans la liste.">suppr</a>(colonnes_A_ligne_i[0]);
<a name="l00548"></a>00548               coeffs_A_ligne_i.<a class="code" href="classDoubleList.html#a47ce98cd0acad997044986fda2cf6bef" title="Supprime un element contenu dans la liste.">suppr</a>(coeffs_A_ligne_i[0]);
<a name="l00549"></a>00549               non_nuls_ligne_i++;
<a name="l00550"></a>00550             }<span class="comment">//fin if</span>
<a name="l00551"></a>00551 
<a name="l00552"></a>00552 <span class="comment">// Aucune des deux listes n&#39;est vide</span>
<a name="l00553"></a>00553           min_colonnes_A = colonnes_A_ligne_i[0];
<a name="l00554"></a>00554           min_colonnes_B = colonnes_B_ligne_i[0];
<a name="l00555"></a>00555           coeff_A = coeffs_A_ligne_i[0];
<a name="l00556"></a>00556           coeff_B = coeffs_B_ligne_i[0];
<a name="l00557"></a>00557 
<a name="l00558"></a>00558           <span class="keywordflow">if</span> (min_colonnes_A &lt; min_colonnes_B)
<a name="l00559"></a>00559             {
<a name="l00560"></a>00560               somme.get_set_tab2()(somme.get_tab1()(i)+non_nuls_ligne_i-1) = min_colonnes_A;
<a name="l00561"></a>00561               somme.get_set_coeff()(somme.get_tab1()(i)+non_nuls_ligne_i-1) = coeff_A;
<a name="l00562"></a>00562 
<a name="l00563"></a>00563               colonnes_A_ligne_i.<a class="code" href="classDoubleList.html#a47ce98cd0acad997044986fda2cf6bef" title="Supprime un element contenu dans la liste.">suppr</a>(min_colonnes_A);
<a name="l00564"></a>00564               coeffs_A_ligne_i.<a class="code" href="classDoubleList.html#a47ce98cd0acad997044986fda2cf6bef" title="Supprime un element contenu dans la liste.">suppr</a>(coeff_A);
<a name="l00565"></a>00565               non_nuls_ligne_i++;
<a name="l00566"></a>00566             }<span class="comment">//fin if</span>
<a name="l00567"></a>00567 
<a name="l00568"></a>00568           <span class="keywordflow">if</span> (min_colonnes_B &lt; min_colonnes_A)
<a name="l00569"></a>00569             {
<a name="l00570"></a>00570               somme.get_set_tab2()(somme.get_tab1()(i)+non_nuls_ligne_i-1) = min_colonnes_B;
<a name="l00571"></a>00571               somme.get_set_coeff()(somme.get_tab1()(i)+non_nuls_ligne_i-1) = coeff_B;
<a name="l00572"></a>00572 
<a name="l00573"></a>00573               colonnes_B_ligne_i.suppr(min_colonnes_B);
<a name="l00574"></a>00574               coeffs_B_ligne_i.<a class="code" href="classDoubleList.html#a47ce98cd0acad997044986fda2cf6bef" title="Supprime un element contenu dans la liste.">suppr</a>(coeff_B);
<a name="l00575"></a>00575               non_nuls_ligne_i++;
<a name="l00576"></a>00576             }<span class="comment">//fin if</span>
<a name="l00577"></a>00577 
<a name="l00578"></a>00578           <span class="keywordflow">if</span> (min_colonnes_A == min_colonnes_B)
<a name="l00579"></a>00579             {
<a name="l00580"></a>00580               somme.get_set_tab2()(somme.get_tab1()(i)+non_nuls_ligne_i-1) = min_colonnes_A;
<a name="l00581"></a>00581               somme.get_set_coeff()(somme.get_tab1()(i)+non_nuls_ligne_i-1) = coeff_A+coeff_B;
<a name="l00582"></a>00582 
<a name="l00583"></a>00583               colonnes_A_ligne_i.suppr(min_colonnes_A);
<a name="l00584"></a>00584               colonnes_B_ligne_i.suppr(min_colonnes_B);
<a name="l00585"></a>00585               coeffs_A_ligne_i.<a class="code" href="classDoubleList.html#a47ce98cd0acad997044986fda2cf6bef" title="Supprime un element contenu dans la liste.">suppr</a>(coeff_A);
<a name="l00586"></a>00586               coeffs_B_ligne_i.<a class="code" href="classDoubleList.html#a47ce98cd0acad997044986fda2cf6bef" title="Supprime un element contenu dans la liste.">suppr</a>(coeff_B);
<a name="l00587"></a>00587               non_nuls_ligne_i++;
<a name="l00588"></a>00588             }<span class="comment">//fin if</span>
<a name="l00589"></a>00589 
<a name="l00590"></a>00590         }<span class="comment">//!&lt; fin while</span>
<a name="l00591"></a>00591 <span class="comment"></span>
<a name="l00592"></a>00592       somme.get_set_tab1()(i+1) = somme.get_tab1()(i)+non_nuls_ligne_i;<span class="comment">//?????</span>
<a name="l00593"></a>00593     }<span class="comment">//!&lt; fin for</span>
<a name="l00594"></a>00594 <span class="comment"></span>
<a name="l00595"></a>00595   somme.compacte();
<a name="l00596"></a>00596   somme.morse_matrix_structure_has_changed_=1;
<a name="l00597"></a>00597   <span class="keywordflow">return</span> somme;
<a name="l00598"></a>00598 }
<a name="l00599"></a>00599 
<a name="l00600"></a>00600 
<a name="l00601"></a>00601 <span class="comment">// Precondition:</span>
<a name="l00602"></a>00602 <span class="comment">// Parametre: double</span>
<a name="l00603"></a>00603 <span class="comment">// Signification:</span>
<a name="l00604"></a>00604 <span class="comment">// Valeurs par defaut:</span>
<a name="l00605"></a>00605 <span class="comment">// Contraintes:</span>
<a name="l00606"></a>00606 <span class="comment">// Acces: NON ACCEDE</span>
<a name="l00607"></a>00607 <span class="comment">// Parametre: Matrice_Morse_Sym&amp; A</span>
<a name="l00608"></a>00608 <span class="comment">// Signification:</span>
<a name="l00609"></a>00609 <span class="comment">// Valeurs par defaut:</span>
<a name="l00610"></a>00610 <span class="comment">// Contraintes: reference constante</span>
<a name="l00611"></a>00611 <span class="comment">// Acces: entree</span>
<a name="l00612"></a>00612 <span class="comment">// Exception: NON CODE</span>
<a name="l00613"></a>00613 <span class="comment">// Effets de bord:</span>
<a name="l00614"></a>00614 <span class="comment">// Postcondition:</span>
<a name="l00615"></a>00615 <span class="comment">//</span>
<a name="l00616"></a>00616 <span class="comment">//</span><span class="comment"></span>
<a name="l00617"></a>00617 <span class="comment">//! Fonction (hors classe) amie de la classe Matrice_Morse_Sym&lt;br&gt;NE FAIT RIEN : NON CODE</span>
<a name="l00618"></a>00618 <span class="comment"></span><span class="comment">/** \return Matrice_Morse_Sym&lt;br&gt;</span>
<a name="l00619"></a>00619 <span class="comment">Signification:&lt;br&gt;</span>
<a name="l00620"></a>00620 <span class="comment">Contraintes: */</span>
<a name="l00621"></a><a class="code" href="Matrice__Morse__Sym_8h.html#a8ce721a6bd70d433e2f0282b272100f9">00621</a> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a> <a class="code" href="Matrice_8cpp.html#afcceccee0de5afbd99c47e2b68752a9f">operator *</a>(<span class="keywordtype">double</span> x, <span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; A)
<a name="l00622"></a>00622 {
<a name="l00623"></a>00623   <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a> mat_res(A);
<a name="l00624"></a>00624   mat_res.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>()*=x;
<a name="l00625"></a>00625   mat_res.<a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00626"></a>00626   <span class="keywordflow">return</span>(mat_res);
<a name="l00627"></a>00627 }
<a name="l00628"></a>00628 
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 <span class="comment">// Precondition:</span>
<a name="l00631"></a>00631 <span class="comment">// Parametre: Matrice_Morse_Sym&amp; A</span>
<a name="l00632"></a>00632 <span class="comment">// Signification: la matrice a multiplier par x</span>
<a name="l00633"></a>00633 <span class="comment">// Valeurs par defaut:</span>
<a name="l00634"></a>00634 <span class="comment">// Contraintes:</span>
<a name="l00635"></a>00635 <span class="comment">// Acces: entree</span>
<a name="l00636"></a>00636 <span class="comment">// Parametre: double x</span>
<a name="l00637"></a>00637 <span class="comment">// Signification: un scalaire</span>
<a name="l00638"></a>00638 <span class="comment">// Valeurs par defaut:</span>
<a name="l00639"></a>00639 <span class="comment">// Contraintes:</span>
<a name="l00640"></a>00640 <span class="comment">// Acces:</span>
<a name="l00641"></a>00641 <span class="comment">// Exception:</span>
<a name="l00642"></a>00642 <span class="comment">// Effets de bord:</span>
<a name="l00643"></a>00643 <span class="comment">// Postcondition:</span>
<a name="l00644"></a>00644 <span class="comment">//</span>
<a name="l00645"></a>00645 <span class="comment">//</span><span class="comment"></span>
<a name="l00646"></a>00646 <span class="comment">//! Fonction (hors classe) amie de la classe Matrice_Morse_Sym&lt;br&gt;Simple appel a operator*(double,const Matrice_Morse_Sym\&amp;) (qui est NON CODE)</span>
<a name="l00647"></a>00647 <span class="comment"></span><span class="comment">/** \return Matrice_Morse_Sym&lt;br&gt;</span>
<a name="l00648"></a>00648 <span class="comment">Signification: le resultat de l&#39;appel sous-jacent&lt;br&gt;</span>
<a name="l00649"></a>00649 <span class="comment">Contraintes: */</span>
<a name="l00650"></a><a class="code" href="Matrice__Morse__Sym_8h.html#ac12cb44f78baf4bfb0729b288b4451b4">00650</a> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a> <a class="code" href="Matrice_8cpp.html#afcceccee0de5afbd99c47e2b68752a9f">operator *</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; A, <span class="keywordtype">double</span> x)
<a name="l00651"></a>00651 {
<a name="l00652"></a>00652   <span class="keywordflow">return</span>(x*A);
<a name="l00653"></a>00653 }
<a name="l00654"></a>00654 
<a name="l00655"></a>00655 
<a name="l00656"></a>00656 <span class="comment">// Precondition:</span>
<a name="l00657"></a>00657 <span class="comment">// Parametre: double</span>
<a name="l00658"></a>00658 <span class="comment">// Signification:</span>
<a name="l00659"></a>00659 <span class="comment">// Valeurs par defaut:</span>
<a name="l00660"></a>00660 <span class="comment">// Contraintes:</span>
<a name="l00661"></a>00661 <span class="comment">// Acces: NON ACCEDE</span>
<a name="l00662"></a>00662 <span class="comment">// Exception: NON CODE</span>
<a name="l00663"></a>00663 <span class="comment">// Effets de bord:</span>
<a name="l00664"></a>00664 <span class="comment">// Postcondition:</span>
<a name="l00665"></a>00665 <span class="comment">//</span><span class="comment"></span>
<a name="l00666"></a>00666 <span class="comment">//! NE FAIT RIEN : NON CODE</span>
<a name="l00667"></a>00667 <span class="comment"></span><span class="comment">/** \return Matrice_Morse_Sym&lt;br&gt;</span>
<a name="l00668"></a>00668 <span class="comment">Signification:&lt;br&gt;</span>
<a name="l00669"></a>00669 <span class="comment">Contraintes: */</span>
<a name="l00670"></a><a class="code" href="classMatrice__Morse__Sym.html#a0b09b056a9a64233fb4078e6aa19c6d7">00670</a> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; <a class="code" href="classMatrice__Morse__Sym.html#a0b09b056a9a64233fb4078e6aa19c6d7" title="NE FAIT RIEN : NON CODE.">Matrice_Morse_Sym::operator *=</a>( <span class="keywordtype">double</span> x )
<a name="l00671"></a>00671 {
<a name="l00672"></a>00672   <a class="code" href="classMatrice__Morse__Sym.html#aa4bd6cb0778e4c98d4a75520b4569f5c">scale</a>( x );
<a name="l00673"></a>00673   <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
<a name="l00674"></a>00674 }
<a name="l00675"></a>00675 
<a name="l00676"></a><a class="code" href="classMatrice__Morse__Sym.html#aa4bd6cb0778e4c98d4a75520b4569f5c">00676</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse__Sym.html#aa4bd6cb0778e4c98d4a75520b4569f5c">Matrice_Morse_Sym::scale</a>( <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; x )
<a name="l00677"></a>00677 {
<a name="l00678"></a>00678   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> *= x;
<a name="l00679"></a>00679 }
<a name="l00680"></a>00680 
<a name="l00681"></a><a class="code" href="classMatrice__Morse__Sym.html#a29493153da9292516103125b527a609c">00681</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse__Sym.html#a29493153da9292516103125b527a609c">Matrice_Morse_Sym::get_stencil</a>( <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; stencil )<span class="keyword"> const</span>
<a name="l00682"></a>00682 <span class="keyword"></span>{
<a name="l00683"></a>00683   <a class="code" href="classMatrice__Morse__Sym.html#a840956dbca5097382324a5dd4d35db76">assert_check_symmetric_morse_matrix_structure</a>( );
<a name="l00684"></a>00684 
<a name="l00685"></a>00685   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> symmetric_stencil;
<a name="l00686"></a>00686   <a class="code" href="classMatrice__Morse__Sym.html#a1e8152eeb118b25170046fdcf6835d87">get_symmetric_stencil</a>( symmetric_stencil );
<a name="l00687"></a>00687 
<a name="l00688"></a>00688   <a class="code" href="classMatrice__Sym.html#a5387bb8e0a4341ffba550225d9a99699">Matrice_Sym::unsymmetrize_stencil</a>( <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( ),
<a name="l00689"></a>00689                                      symmetric_stencil,
<a name="l00690"></a>00690                                      stencil );
<a name="l00691"></a>00691 }
<a name="l00692"></a>00692 
<a name="l00693"></a><a class="code" href="classMatrice__Morse__Sym.html#a1e8152eeb118b25170046fdcf6835d87">00693</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse__Sym.html#a1e8152eeb118b25170046fdcf6835d87">Matrice_Morse_Sym::get_symmetric_stencil</a>( <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; stencil )<span class="keyword"> const</span>
<a name="l00694"></a>00694 <span class="keyword"></span>{
<a name="l00695"></a>00695   <a class="code" href="classMatrice__Morse__Sym.html#a840956dbca5097382324a5dd4d35db76">assert_check_symmetric_morse_matrix_structure</a>( );
<a name="l00696"></a>00696 
<a name="l00697"></a>00697   stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( 0, 2 );
<a name="l00698"></a>00698   stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l00699"></a>00699 
<a name="l00700"></a>00700   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> tmp;
<a name="l00701"></a>00701   tmp.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l00702"></a>00702 
<a name="l00703"></a>00703   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l00704"></a>00704   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
<a name="l00705"></a>00705     {
<a name="l00706"></a>00706       <span class="keywordtype">int</span> k0 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;
<a name="l00707"></a>00707       <span class="keywordtype">int</span> k1 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;
<a name="l00708"></a>00708       <span class="keywordtype">int</span> size = k1 - k0;
<a name="l00709"></a>00709 
<a name="l00710"></a>00710       tmp.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>( 0 );
<a name="l00711"></a>00711       tmp.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>( size );
<a name="l00712"></a>00712 
<a name="l00713"></a>00713       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )
<a name="l00714"></a>00714         {
<a name="l00715"></a>00715           tmp[ k ] = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k + k0 ) - 1;
<a name="l00716"></a>00716         }
<a name="l00717"></a>00717 
<a name="l00718"></a>00718       tmp.<a class="code" href="classArrOfInt.html#abb0f48cf5a4be4b70edcc90baaebd521" title="Tri des valeurs du tableau dans l&#39;ordre croissant. La fonction utilisee est qsort de stdlib (elle est...">ordonne_array</a>( );
<a name="l00719"></a>00719 
<a name="l00720"></a>00720       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )
<a name="l00721"></a>00721         {
<a name="l00722"></a>00722           stencil.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>( i, tmp[ k ] );
<a name="l00723"></a>00723         }
<a name="l00724"></a>00724     }
<a name="l00725"></a>00725 
<a name="l00726"></a>00726   <span class="keyword">const</span> <span class="keywordtype">int</span> new_size = stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00727"></a>00727   stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 0 );
<a name="l00728"></a>00728   stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( new_size, 2 );
<a name="l00729"></a>00729 }
<a name="l00730"></a>00730 
<a name="l00731"></a><a class="code" href="classMatrice__Morse__Sym.html#a13817ba06b04d515958bf7a84b8838d8">00731</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse__Sym.html#a13817ba06b04d515958bf7a84b8838d8">Matrice_Morse_Sym::get_stencil_and_coefficients</a>( <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp;      stencil,
<a name="l00732"></a>00732                                                       <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; coefficients )<span class="keyword"> const</span>
<a name="l00733"></a>00733 <span class="keyword"></span>{
<a name="l00734"></a>00734   <a class="code" href="classMatrice__Morse__Sym.html#a840956dbca5097382324a5dd4d35db76">assert_check_symmetric_morse_matrix_structure</a>( );
<a name="l00735"></a>00735 
<a name="l00736"></a>00736   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> symmetric_stencil;
<a name="l00737"></a>00737   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> symmetric_coefficients;
<a name="l00738"></a>00738   <a class="code" href="classMatrice__Morse__Sym.html#a8d543a229c8b0582e77c4b719d3ac333">get_symmetric_stencil_and_coefficients</a>( symmetric_stencil, symmetric_coefficients );
<a name="l00739"></a>00739 
<a name="l00740"></a>00740   <a class="code" href="classMatrice__Sym.html#a709aa65aa8f025cefe7b08ae5807b4a4">Matrice_Sym::unsymmetrize_stencil_and_coefficients</a>( <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( ),
<a name="l00741"></a>00741                                                       symmetric_stencil,
<a name="l00742"></a>00742                                                       symmetric_coefficients,
<a name="l00743"></a>00743                                                       stencil,
<a name="l00744"></a>00744                                                       coefficients );
<a name="l00745"></a>00745 }
<a name="l00746"></a>00746 
<a name="l00747"></a>00747 
<a name="l00748"></a><a class="code" href="classMatrice__Morse__Sym.html#a8d543a229c8b0582e77c4b719d3ac333">00748</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse__Sym.html#a8d543a229c8b0582e77c4b719d3ac333">Matrice_Morse_Sym::get_symmetric_stencil_and_coefficients</a>( <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp;      stencil,
<a name="l00749"></a>00749                                                                 <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; coefficients )<span class="keyword"> const</span>
<a name="l00750"></a>00750 <span class="keyword"></span>{
<a name="l00751"></a>00751   <a class="code" href="classMatrice__Morse__Sym.html#a840956dbca5097382324a5dd4d35db76">assert_check_symmetric_morse_matrix_structure</a>( );
<a name="l00752"></a>00752 
<a name="l00753"></a>00753   stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( 0, 2 );
<a name="l00754"></a>00754   stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l00755"></a>00755 
<a name="l00756"></a>00756   coefficients.<a class="code" href="classArrOfDouble.html#aa5d7035f2e4f451c484aabd5dffb873b" title="appel a ArrOfDouble::resize_array()">resize</a>( 0 );
<a name="l00757"></a>00757   coefficients.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l00758"></a>00758 
<a name="l00759"></a>00759   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> tmp1(0);
<a name="l00760"></a>00760   tmp1.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l00761"></a>00761 
<a name="l00762"></a>00762   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> tmp2;
<a name="l00763"></a>00763   tmp2.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l00764"></a>00764 
<a name="l00765"></a>00765   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> index;
<a name="l00766"></a>00766   index.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l00767"></a>00767 
<a name="l00768"></a>00768   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l00769"></a>00769   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
<a name="l00770"></a>00770     {
<a name="l00771"></a>00771       <span class="keywordtype">int</span> k0   = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;
<a name="l00772"></a>00772       <span class="keywordtype">int</span> k1   = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;
<a name="l00773"></a>00773       <span class="keywordtype">int</span> size = k1 - k0;
<a name="l00774"></a>00774 
<a name="l00775"></a>00775       index.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>( 0 );
<a name="l00776"></a>00776 
<a name="l00777"></a>00777       tmp1.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( 0 );
<a name="l00778"></a>00778       tmp1.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( size );
<a name="l00779"></a>00779 
<a name="l00780"></a>00780       tmp2.<a class="code" href="classArrOfDouble.html#a610464f4b3dccac6f814915b526783ed">resize_array</a>( 0 );
<a name="l00781"></a>00781       tmp2.<a class="code" href="classArrOfDouble.html#a610464f4b3dccac6f814915b526783ed">resize_array</a>( size );
<a name="l00782"></a>00782 
<a name="l00783"></a>00783       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )
<a name="l00784"></a>00784         {
<a name="l00785"></a>00785           tmp1( k ) = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k + k0 ) - 1;
<a name="l00786"></a>00786           tmp2[ k ] = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>( k + k0 );
<a name="l00787"></a>00787         }
<a name="l00788"></a>00788 
<a name="l00789"></a>00789       <a class="code" href="Array__tools_8cpp.html#ad62171ccb6e8fd4b2be47d286c164999" title="Idem que tri_lexicographique_tableau mais on trie le tableau index qui contient les indices de lignes...">tri_lexicographique_tableau_indirect</a>( tmp1, index );
<a name="l00790"></a>00790 
<a name="l00791"></a>00791       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )
<a name="l00792"></a>00792         {
<a name="l00793"></a>00793           <span class="keywordtype">int</span> l = index[ k ];
<a name="l00794"></a>00794           stencil.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>( i, tmp1[ l ] );
<a name="l00795"></a>00795           coefficients.<a class="code" href="classArrOfDouble.html#a989b455da23fcea97918c7fca5349c85" title="Ajoute une case en fin de tableau et y stocke la &quot;valeur&quot;.">append_array</a>( tmp2[ l ] );
<a name="l00796"></a>00796         }
<a name="l00797"></a>00797     }
<a name="l00798"></a>00798 
<a name="l00799"></a>00799   <span class="keyword">const</span> <span class="keywordtype">int</span> new_size = stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00800"></a>00800   assert( coefficients.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) == new_size );
<a name="l00801"></a>00801 
<a name="l00802"></a>00802   stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 0 );
<a name="l00803"></a>00803   stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( new_size, 2 );
<a name="l00804"></a>00804 
<a name="l00805"></a>00805   coefficients.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 0 );
<a name="l00806"></a>00806   coefficients.<a class="code" href="classArrOfDouble.html#a610464f4b3dccac6f814915b526783ed">resize_array</a>( new_size );
<a name="l00807"></a>00807 }
<a name="l00808"></a>00808 
<a name="l00809"></a>00809 <span class="comment">// Precondition:</span>
<a name="l00810"></a>00810 <span class="comment">// Parametre:</span>
<a name="l00811"></a>00811 <span class="comment">// Signification:</span>
<a name="l00812"></a>00812 <span class="comment">// Valeurs par defaut:</span>
<a name="l00813"></a>00813 <span class="comment">// Contraintes:</span>
<a name="l00814"></a>00814 <span class="comment">// Acces:</span>
<a name="l00815"></a>00815 <span class="comment">// </span>
<a name="l00816"></a>00816 <span class="comment">// Signification:</span>
<a name="l00817"></a>00817 <span class="comment">// Contraintes:</span>
<a name="l00818"></a>00818 <span class="comment">// Exception:</span>
<a name="l00819"></a>00819 <span class="comment">// Effets de bord:</span>
<a name="l00820"></a>00820 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00821"></a>00821 <span class="comment">//</span>
<a name="l00822"></a>00822 <span class="comment">//</span>
<a name="l00823"></a>00823 <span class="comment">//</span><span class="comment"></span>
<a name="l00824"></a>00824 <span class="comment">//! Operateur de negation unaire,&lt;br&gt;renvoie l&#39;opposee de la matrice:  - A.&lt;br&gt;Appelle operator*(const Matrice_Morse_Sym\&amp;,double)</span>
<a name="l00825"></a><a class="code" href="classMatrice__Morse__Sym.html#a920fb9eb9b3faa1a680cec91c5c00de7">00825</a> <span class="comment"></span><a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a> <a class="code" href="classMatrice__Morse__Sym.html#a920fb9eb9b3faa1a680cec91c5c00de7" title="Operateur de negation unaire, renvoie l&#39;opposee de la matrice: - A. Appelle operator*(const Matrice_M...">Matrice_Morse_Sym::operator -</a>()<span class="keyword"> const</span>
<a name="l00826"></a>00826 <span class="keyword"></span>{
<a name="l00827"></a>00827   <span class="keywordflow">return</span>((*<span class="keyword">this</span>)*(-1));
<a name="l00828"></a>00828 }
<a name="l00829"></a>00829 <span class="comment">/*</span>
<a name="l00830"></a>00830 <span class="comment">static int commun(const ArrOfInt&amp; items,</span>
<a name="l00831"></a>00831 <span class="comment">                  int prems,</span>
<a name="l00832"></a>00832 <span class="comment">                  int der,</span>
<a name="l00833"></a>00833 <span class="comment">                  int val,</span>
<a name="l00834"></a>00834 <span class="comment">                  int&amp; item_courant)</span>
<a name="l00835"></a>00835 <span class="comment">{</span>
<a name="l00836"></a>00836 <span class="comment">  if (val==items[item_courant])</span>
<a name="l00837"></a>00837 <span class="comment">    return item_courant;</span>
<a name="l00838"></a>00838 <span class="comment">  if((val&lt;items[0]) || (val&gt;items[der]))</span>
<a name="l00839"></a>00839 <span class="comment">    return item_courant;</span>
<a name="l00840"></a>00840 <span class="comment">  if (val&lt;items[item_courant])</span>
<a name="l00841"></a>00841 <span class="comment">    {</span>
<a name="l00842"></a>00842 <span class="comment">      --item_courant;</span>
<a name="l00843"></a>00843 <span class="comment">      if(val&gt;=items[item_courant]) return item_courant;</span>
<a name="l00844"></a>00844 <span class="comment">      der=item_courant;</span>
<a name="l00845"></a>00845 <span class="comment">      item_courant=(prems+item_courant)/2;</span>
<a name="l00846"></a>00846 <span class="comment">      return commun(items,prems,der,val,item_courant);</span>
<a name="l00847"></a>00847 <span class="comment">    }</span>
<a name="l00848"></a>00848 <span class="comment">  if (val&gt;items[item_courant])</span>
<a name="l00849"></a>00849 <span class="comment">    {</span>
<a name="l00850"></a>00850 <span class="comment">      ++item_courant;</span>
<a name="l00851"></a>00851 <span class="comment">      if(val&lt;items[item_courant]) return (--item_courant);</span>
<a name="l00852"></a>00852 <span class="comment">      if(val==items[item_courant]) return (item_courant);</span>
<a name="l00853"></a>00853 <span class="comment">      prems=item_courant;</span>
<a name="l00854"></a>00854 <span class="comment">      item_courant=(item_courant+der)/2;</span>
<a name="l00855"></a>00855 <span class="comment">      return commun(items,prems,der,val,item_courant);</span>
<a name="l00856"></a>00856 <span class="comment">    }</span>
<a name="l00857"></a>00857 <span class="comment">  return item_courant;</span>
<a name="l00858"></a>00858 <span class="comment">}</span>
<a name="l00859"></a>00859 <span class="comment">*/</span>
<a name="l00860"></a>00860 
<a name="l00861"></a>00861 
<a name="l00862"></a>00862 <span class="comment">// Precondition:</span>
<a name="l00863"></a>00863 <span class="comment">// Parametre: Matrice_Morse_Sym&amp; a</span>
<a name="l00864"></a>00864 <span class="comment">// Signification: la partie droite de l&#39;affectation</span>
<a name="l00865"></a>00865 <span class="comment">// Valeurs par defaut:</span>
<a name="l00866"></a>00866 <span class="comment">// Contraintes: reference constante</span>
<a name="l00867"></a>00867 <span class="comment">// Acces: entree</span>
<a name="l00868"></a>00868 <span class="comment">// Exception:</span>
<a name="l00869"></a>00869 <span class="comment">// Effets de bord:</span>
<a name="l00870"></a>00870 <span class="comment">// Postcondition:</span>
<a name="l00871"></a>00871 <span class="comment">//</span>
<a name="l00872"></a>00872 <span class="comment">//</span><span class="comment"></span>
<a name="l00873"></a>00873 <span class="comment">//! Operateur d&#39;affectatiob d&#39;une Matrice_Morse_Sym&lt;br&gt;dans une Matrice_Morse_Sym.</span>
<a name="l00874"></a>00874 <span class="comment"></span><span class="comment">/** \return Matrice_Morse_Sym\&amp;&lt;br&gt;</span>
<a name="l00875"></a>00875 <span class="comment">Signification: le resultat de l&#39;affectation (*this)&lt;br&gt;</span>
<a name="l00876"></a>00876 <span class="comment">Contraintes: */</span>
<a name="l00877"></a><a class="code" href="classMatrice__Morse__Sym.html#ab4afafb3e5027f6dbf51a02eb4b872ec">00877</a> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; <a class="code" href="classMatrice__Morse__Sym.html#ab4afafb3e5027f6dbf51a02eb4b872ec" title="Operateur d&#39;affectatiob d&#39;une Matrice_Morse_Sym dans une Matrice_Morse_Sym.">Matrice_Morse_Sym::operator=</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; a )
<a name="l00878"></a>00878 {
<a name="l00879"></a>00879   <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>  =a.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>();
<a name="l00880"></a>00880   <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>  =a.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>();
<a name="l00881"></a>00881   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> =a.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>();
<a name="l00882"></a>00882   <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a>=a.<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();
<a name="l00883"></a>00883   <a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(a.<a class="code" href="classMatrice__Sym.html#a5cbcf1c7de27ffb81664ea574a37ebdc">get_est_definie</a>());
<a name="l00884"></a>00884   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00885"></a>00885   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> =  a.<a class="code" href="classMatrice__Base.html#aa1828bab9e4980e6980b7e71ae280c1c">is_stencil_up_to_date</a>() ;
<a name="l00886"></a>00886   <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
<a name="l00887"></a>00887 }
<a name="l00888"></a>00888 
<a name="l00889"></a><a class="code" href="Matrice__Morse__Sym_8h.html#ad262a260faabf8f067cb0a5375b605cc">00889</a> <span class="keywordtype">int</span> <a class="code" href="Matrice__Morse__Sym_8cpp.html#ad262a260faabf8f067cb0a5375b605cc">Matrice_Morse_Sym_test</a>()
<a name="l00890"></a>00890 {
<a name="l00891"></a>00891   <span class="keywordflow">return</span> 1;
<a name="l00892"></a>00892 }
<a name="l00893"></a>00893 
<a name="l00894"></a>00894 
<a name="l00895"></a><a class="code" href="classMatrice__Morse__Sym.html#a7af0681f55e332a566fe7e3b37603571">00895</a> <span class="keywordtype">int</span> <a class="code" href="classMatrice__Morse__Sym.html#a7af0681f55e332a566fe7e3b37603571" title="Calcule la solution du systeme lineaire: A * solution = secmem. La methode utilisee est GMRES precond...">Matrice_Morse_Sym::inverse</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; secmem, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; solution,
<a name="l00896"></a>00896                                <span class="keywordtype">double</span> coeff_seuil)<span class="keyword"> const</span>
<a name="l00897"></a>00897 <span class="keyword"></span>{
<a name="l00898"></a>00898   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Not coded.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00899"></a>00899   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00900"></a>00900   <span class="keywordflow">return</span> 0;
<a name="l00901"></a>00901 }
<a name="l00902"></a>00902 
<a name="l00903"></a><a class="code" href="classMatrice__Morse__Sym.html#aea34cf2169878d74b980b3f0187537a0">00903</a> <span class="keywordtype">int</span> <a class="code" href="classMatrice__Morse__Sym.html#a7af0681f55e332a566fe7e3b37603571" title="Calcule la solution du systeme lineaire: A * solution = secmem. La methode utilisee est GMRES precond...">Matrice_Morse_Sym::inverse</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; secmem, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; solution,
<a name="l00904"></a>00904                                <span class="keywordtype">double</span> coeff_seuil, <span class="keywordtype">int</span> max_iter)<span class="keyword"> const</span>
<a name="l00905"></a>00905 <span class="keyword"></span>{
<a name="l00906"></a>00906   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Not coded.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00907"></a>00907   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00908"></a>00908   <span class="keywordflow">return</span> 0;
<a name="l00909"></a>00909 }
<a name="l00910"></a>00910 
<a name="l00911"></a><a class="code" href="classMatrice__Morse__Sym.html#abdc9966827b915d03d440994ff3fe7de">00911</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classMatrice__Morse__Sym.html#abdc9966827b915d03d440994ff3fe7de">Matrice_Morse_Sym::imprimer_formatte</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00912"></a>00912 <span class="keyword"></span>{
<a name="l00913"></a>00913   <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse__Sym.html#abdc9966827b915d03d440994ff3fe7de">Matrice_Morse::imprimer_formatte</a>(s, 1);
<a name="l00914"></a>00914 }
<a name="l00915"></a>00915 
<a name="l00916"></a>00916 <span class="comment">// Precondition:</span>
<a name="l00917"></a>00917 <span class="comment">// Parametre:</span>
<a name="l00918"></a>00918 <span class="comment">// </span>
<a name="l00919"></a>00919 <span class="comment">// Signification:</span>
<a name="l00920"></a>00920 <span class="comment">// Contraintes:</span>
<a name="l00921"></a>00921 <span class="comment">// Exception:</span>
<a name="l00922"></a>00922 <span class="comment">// Effets de bord:</span>
<a name="l00923"></a>00923 <span class="comment">// Postcondition:</span>
<a name="l00924"></a>00924 <span class="comment">//</span>
<a name="l00925"></a>00925 <span class="comment">//</span>
<a name="l00926"></a>00926 <span class="comment">//</span><span class="comment"></span>
<a name="l00927"></a>00927 <span class="comment">//! Suppression des doublons&lt;br&gt;on ordonne tab2;&lt;br&gt;Verification de la diagonale: tous ses elements doivent etre stockes</span>
<a name="l00928"></a><a class="code" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69">00928</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69" title="Suppression des doublons on ordonne tab2; Verification de la diagonale: tous ses elements doivent etr...">Matrice_Morse_Sym::compacte</a>(<span class="keywordtype">int</span> elim_coeff_nul)
<a name="l00929"></a>00929 {
<a name="l00930"></a>00930   <a class="code" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69" title="Suppression des doublons on ordonne tab2; Verification de la diagonale: tous ses elements doivent etr...">Matrice_Morse::compacte</a>(elim_coeff_nul);
<a name="l00931"></a>00931 <span class="comment">// Verification si tous les elements de la diagonale sont bien stockes</span>
<a name="l00932"></a>00932   <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00933"></a>00933   <span class="keywordtype">int</span> elements_diagonaux_non_stockes=0;
<a name="l00934"></a>00934   <span class="keywordtype">int</span> size_tab2_ = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00935"></a>00935   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00936"></a>00936     {
<a name="l00937"></a>00937       <span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1;
<a name="l00938"></a>00938       <span class="keywordflow">if</span> (k&gt;=size_tab2_ || i!=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1)
<a name="l00939"></a>00939         {
<a name="l00940"></a>00940           elements_diagonaux_non_stockes++;
<a name="l00941"></a>00941 <span class="comment">// Cerr &lt;&lt; &quot;Probleme rencontre dans une Matrice_Morse_Sym:&quot; &lt;&lt; finl;</span>
<a name="l00942"></a>00942 <span class="comment">// Cerr &lt;&lt; &quot;La ligne &quot;&lt;&lt;i&lt;&lt;&quot; n&#39;a pas sa diagonale correctement stockee.&quot; &lt;&lt; finl;</span>
<a name="l00943"></a>00943 <span class="comment">// Cerr &lt;&lt; &quot;Les elements diagonaux meme nuls doivent etre stockes dans une Mat_Morse_Sym TRUST.&quot; &lt;&lt; finl;</span>
<a name="l00944"></a>00944         }
<a name="l00945"></a>00945     }
<a name="l00946"></a>00946   <span class="keywordflow">if</span> (elements_diagonaux_non_stockes)
<a name="l00947"></a>00947     {
<a name="l00948"></a>00948 <span class="comment">// On resize</span>
<a name="l00949"></a>00949       <span class="keywordtype">int</span> nnz=size_tab2_+elements_diagonaux_non_stockes;
<a name="l00950"></a>00950       <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);
<a name="l00951"></a>00951       <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);
<a name="l00952"></a>00952 <span class="comment">// On change la matrice en partant de la fin</span>
<a name="l00953"></a>00953       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=n-1; i&gt;=0; i--)
<a name="l00954"></a>00954         {
<a name="l00955"></a>00955 <span class="comment">// On copie en decalant</span>
<a name="l00956"></a>00956           <span class="keywordtype">int</span> k1=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1;
<a name="l00957"></a>00957           <span class="keywordtype">int</span> k2=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1;
<a name="l00958"></a>00958           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=k2-1; j&gt;=k1; j--)
<a name="l00959"></a>00959             {
<a name="l00960"></a>00960               <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(j+elements_diagonaux_non_stockes)=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(j);
<a name="l00961"></a>00961               <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(j+elements_diagonaux_non_stockes)=<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(j);
<a name="l00962"></a>00962             }
<a name="l00963"></a>00963           <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)+=elements_diagonaux_non_stockes;
<a name="l00964"></a>00964 
<a name="l00965"></a>00965           <span class="keywordflow">if</span> (k1&gt;=size_tab2_ || i!=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k1)-1)
<a name="l00966"></a>00966             {
<a name="l00967"></a>00967 <span class="comment">// On insere l&#39;element diagonal nul manquant</span>
<a name="l00968"></a>00968               elements_diagonaux_non_stockes--;
<a name="l00969"></a>00969               <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k1+elements_diagonaux_non_stockes)=i+1;
<a name="l00970"></a>00970               <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k1+elements_diagonaux_non_stockes)=0.;
<a name="l00971"></a>00971             }
<a name="l00972"></a>00972         }
<a name="l00973"></a>00973       assert(elements_diagonaux_non_stockes==0);
<a name="l00974"></a>00974     }
<a name="l00975"></a>00975   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00976"></a>00976 }
<a name="l00977"></a>00977 
<a name="l00978"></a>00978 <span class="comment">// Precondition:</span>
<a name="l00979"></a>00979 <span class="comment">// Parametre:</span>
<a name="l00980"></a>00980 <span class="comment">// </span>
<a name="l00981"></a>00981 <span class="comment">// Signification:</span>
<a name="l00982"></a>00982 <span class="comment">// Contraintes:</span>
<a name="l00983"></a>00983 <span class="comment">// Exception:</span>
<a name="l00984"></a>00984 <span class="comment">// Effets de bord:</span>
<a name="l00985"></a>00985 <span class="comment">// Postcondition:</span>
<a name="l00986"></a>00986 <span class="comment">//</span><span class="comment"></span>
<a name="l00987"></a>00987 <span class="comment">//! Renumerotation d&#39;une matrice afin de reduire la largeur de bande</span>
<a name="l00988"></a><a class="code" href="classMatrice__Morse__Sym.html#a05f377af554105aba8dc91bcd19b88eb">00988</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse__Sym.html#a05f377af554105aba8dc91bcd19b88eb" title="Creation d&#39;une matrice renumerotee pour reduire la largeur de bande.">Matrice_Morse_Sym::renumerote</a>()<span class="keyword"> const</span>
<a name="l00989"></a>00989 <span class="keyword"></span>{
<a name="l00990"></a>00990   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Bandwidth of the matrix : &quot;</span> &lt;&lt; <a class="code" href="classMatrice__Morse.html#a95c8d6e95a8ad58710856f60bf07cd43" title="Retourne la largeur de bande.">largeur_de_bande</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00991"></a>00991   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Renumbering the matrix ...&quot;</span> &lt;&lt; finl;
<a name="l00992"></a>00992 <span class="comment">// rovisoire chercher a reecrire</span>
<a name="l00993"></a>00993   <span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; matrice_initial = *<span class="keyword">this</span>;
<a name="l00994"></a>00994   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; tab_iperm = matrice_initial.<a class="code" href="classMatrice__Morse__Sym.html#a846ac2322f27e64a45a64f0aa25ebb7d">permutation_inverse</a>();
<a name="l00995"></a>00995 
<a name="l00996"></a>00996 <span class="comment">// transformation d une matrice morse symetrique en matrice morse</span>
<a name="l00997"></a>00997 
<a name="l00998"></a>00998   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> matrice2(matrice_initial);
<a name="l00999"></a>00999   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> matrice(matrice_initial);
<a name="l01000"></a>01000 
<a name="l01001"></a>01001   <span class="keywordtype">int</span> mon_ordre = matrice.<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>();
<a name="l01002"></a>01002 <span class="comment">// int i;</span>
<a name="l01003"></a>01003 
<a name="l01004"></a>01004   matrice2.<a class="code" href="classMatrice__Morse.html#a9859a88c59daf0b968b3c5090e18f264" title="*this = a transposee.">transpose</a>(matrice);
<a name="l01005"></a>01005   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;mon_ordre; i++) matrice2(i, i) = 0.;
<a name="l01006"></a>01006   matrice2 += matrice ;
<a name="l01007"></a>01007 
<a name="l01008"></a>01008 
<a name="l01009"></a>01009 <span class="comment">// Matrice_Bande_Sym matrice_tmp;</span>
<a name="l01010"></a>01010 <span class="comment">// matrice_tmp.charger_coeff(matrice);</span>
<a name="l01011"></a>01011 <span class="comment">// Cout&lt;&lt;&quot;avant renumerotation largeur de bande:&quot;&lt;&lt;matrice_tmp.dim(0)&lt;&lt;finl;</span>
<a name="l01012"></a>01012 
<a name="l01013"></a>01013 
<a name="l01014"></a>01014 <span class="comment">// calcul de la permutation a effectuer</span>
<a name="l01015"></a>01015 
<a name="l01016"></a>01016 <span class="comment">// int nnz = matrice2.coeff_.size();</span>
<a name="l01017"></a>01017   <span class="keyword">const</span> <span class="keywordtype">int</span> n = mon_ordre;
<a name="l01018"></a>01018   <span class="keyword">const</span> <span class="keywordtype">int</span>* tab1tmp = matrice2.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l01019"></a>01019   <span class="keyword">const</span> <span class="keywordtype">int</span>* tab2tmp = matrice2.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l01020"></a>01020 <span class="comment">// const int nfirst=1;</span>
<a name="l01021"></a>01021 
<a name="l01022"></a>01022 
<a name="l01023"></a>01023   <span class="keywordtype">int</span> init = 1;
<a name="l01024"></a>01024 
<a name="l01025"></a>01025 
<a name="l01026"></a>01026   tab_iperm.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(n);
<a name="l01027"></a>01027   tab_iperm[0] = 1;
<a name="l01028"></a>01028 
<a name="l01029"></a>01029   <span class="keywordtype">int</span>* masktmp  = <span class="keyword">new</span> <span class="keywordtype">int</span>[n];
<a name="l01030"></a>01030   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;n; i++ ) masktmp[i] = 1;
<a name="l01031"></a>01031   <span class="keyword">const</span> <span class="keywordtype">int</span>* mask = (<span class="keyword">const</span> <span class="keywordtype">int</span>*) masktmp;
<a name="l01032"></a>01032   <span class="keyword">const</span> <span class="keywordtype">int</span> maskval = 1;
<a name="l01033"></a>01033 <span class="comment">// GF passage a n+1 pour permettre de faire du Cholesky sur 1 maillage 1xN</span>
<a name="l01034"></a>01034   <span class="keywordtype">int</span>*  level = <span class="keyword">new</span> <span class="keywordtype">int</span>[n+1];
<a name="l01035"></a>01035   <span class="keywordtype">int</span> nlev;
<a name="l01036"></a>01036 
<a name="l01037"></a>01037 <span class="comment">// renumerotation des noeuds</span>
<a name="l01038"></a>01038 <span class="comment">// subroutine perphn(n,ja,ia,init,iperm,mask,maskval,nlev,riord,levels)</span>
<a name="l01039"></a>01039 <span class="comment">// SPARSKIT2/ORDERINGS/levset.f</span>
<a name="l01040"></a>01040   <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(PERPHN)(&amp;n, tab2tmp, tab1tmp, &amp;init,  mask, &amp;maskval,
<a name="l01041"></a>01041                   &amp;nlev, tab_iperm.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), level);
<a name="l01042"></a>01042 
<a name="l01043"></a>01043 
<a name="l01044"></a>01044   <span class="keyword">delete</span> []masktmp;
<a name="l01045"></a>01045   <span class="keyword">delete</span> []level;
<a name="l01046"></a>01046 
<a name="l01047"></a>01047   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> tab_perm(n);
<a name="l01048"></a>01048   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;n; i++ ) tab_perm[tab_iperm[i] - 1] = i + 1;
<a name="l01049"></a>01049 
<a name="l01050"></a>01050   matrice2 = matrice;
<a name="l01051"></a>01051 
<a name="l01052"></a>01052   <span class="keyword">const</span> <span class="keywordtype">double</span>* a = matrice.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>().<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l01053"></a>01053   <span class="keyword">const</span> <span class="keywordtype">int</span>* ja = matrice.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l01054"></a>01054   <span class="keyword">const</span> <span class="keywordtype">int</span>* ia = matrice.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l01055"></a>01055   <span class="keyword">const</span> <span class="keywordtype">double</span>* tao = matrice2.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>().<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l01056"></a>01056   <span class="keywordtype">double</span>* ao = (<span class="keywordtype">double</span>*)tao;
<a name="l01057"></a>01057   <span class="keyword">const</span>  <span class="keywordtype">int</span>* tjao = matrice2.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l01058"></a>01058   <span class="keywordtype">int</span>* jao = (<span class="keywordtype">int</span>*)tjao;
<a name="l01059"></a>01059   <span class="keyword">const</span>  <span class="keywordtype">int</span>* tiao = matrice2.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l01060"></a>01060   <span class="keywordtype">int</span>* iao = (<span class="keywordtype">int</span>*)tiao;
<a name="l01061"></a>01061 
<a name="l01062"></a>01062   <span class="keyword">const</span> <span class="keywordtype">int</span>* perm = tab_perm.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l01063"></a>01063   <span class="keyword">const</span> <span class="keywordtype">int</span>* perm_inv = tab_iperm.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();<span class="comment">//normalement inutile</span>
<a name="l01064"></a>01064   <span class="keyword">const</span> <span class="keywordtype">int</span> job = 1;
<a name="l01065"></a>01065 
<a name="l01066"></a>01066 
<a name="l01067"></a>01067 <span class="comment">// permutation de la matrice i.e. calcul de P A tP</span>
<a name="l01068"></a>01068 <span class="comment">// ici on ne permute que la partie supeieure</span>
<a name="l01069"></a>01069 
<a name="l01070"></a>01070 <span class="comment">// subroutine dperm (nrow,a,ja,ia,ao,jao,iao,perm,qperm,job)</span>
<a name="l01071"></a>01071 <span class="comment">// SPARSKIT2/FORMATS/unary.f</span>
<a name="l01072"></a>01072   <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(DPERM) (&amp;n, a, ja, ia, ao, jao, iao, perm, perm_inv, &amp;job);
<a name="l01073"></a>01073 
<a name="l01074"></a>01074   matrice.<a class="code" href="classMatrice__Morse.html#a9859a88c59daf0b968b3c5090e18f264" title="*this = a transposee.">transpose</a>(matrice2);
<a name="l01075"></a>01075   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;mon_ordre; i++) matrice2(i, i) = 0.;
<a name="l01076"></a>01076   matrice2 += matrice ;
<a name="l01077"></a>01077   matrice.<a class="code" href="classMatrice__Morse.html#af1142c6d58bd4b5d01cfbb9bdc600fe9">partie_sup</a>(matrice2);
<a name="l01078"></a>01078   <a class="code" href="classMatrice__Morse__Sym.html#a13907fd734806adae2c5d0df828aa969">matrice_renumerotee_</a>.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Matrice_Morse_Sym&quot;</span>);
<a name="l01079"></a>01079   <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,<a class="code" href="classMatrice__Morse__Sym.html#a13907fd734806adae2c5d0df828aa969">matrice_renumerotee_</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>()) = matrice;
<a name="l01080"></a>01080 
<a name="l01081"></a>01081 <span class="comment">// Construction de permutation() rovisoire deja fait avec</span>
<a name="l01082"></a>01082   <span class="keywordtype">int</span> size=<a class="code" href="classMatrice__Morse__Sym.html#a846ac2322f27e64a45a64f0aa25ebb7d">permutation_inverse</a>().<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l01083"></a>01083   <a class="code" href="classMatrice__Morse__Sym.html#a18f82b80ae6ec21b442c382b9783048e" title="Renvoie la matrice renumerotee.">permutation</a>().<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(size);
<a name="l01084"></a>01084   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;size; i++)
<a name="l01085"></a>01085     <a class="code" href="classMatrice__Morse__Sym.html#a18f82b80ae6ec21b442c382b9783048e" title="Renvoie la matrice renumerotee.">permutation</a>()[<a class="code" href="classMatrice__Morse__Sym.html#a846ac2322f27e64a45a64f0aa25ebb7d">permutation_inverse</a>()[i]-1]=i+1;
<a name="l01086"></a>01086   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Bandwidth of the renumbered matrix : &quot;</span> &lt;&lt; <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>,<a class="code" href="classMatrice__Morse__Sym.html#a13907fd734806adae2c5d0df828aa969">matrice_renumerotee_</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>()).<a class="code" href="classMatrice__Morse.html#a95c8d6e95a8ad58710856f60bf07cd43" title="Retourne la largeur de bande.">largeur_de_bande</a>() &lt;&lt; finl;
<a name="l01087"></a>01087   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l01088"></a>01088 }
<a name="l01089"></a>01089 
<a name="l01090"></a><a class="code" href="classMatrice__Morse__Sym.html#a260ccf43c1e00c4bcebcb76f1a1e45fe">01090</a> <span class="keywordtype">bool</span> <a class="code" href="classMatrice__Morse__Sym.html#a260ccf43c1e00c4bcebcb76f1a1e45fe">Matrice_Morse_Sym::check_symmetric_morse_matrix_structure</a>( <span class="keywordtype">void</span> )<span class="keyword"> const</span>
<a name="l01091"></a>01091 <span class="keyword"></span>{
<a name="l01092"></a>01092   <span class="keywordflow">if</span> ( ! ( <a class="code" href="classMatrice__Morse.html#a8852df62bb7604061e8a7873bebddda4">check_morse_matrix_structure</a>( ) ) )
<a name="l01093"></a>01093     {
<a name="l01094"></a>01094       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Invalid morse structure&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01095"></a>01095       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01096"></a>01096     }
<a name="l01097"></a>01097 
<a name="l01098"></a>01098   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l01099"></a>01099   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
<a name="l01100"></a>01100     {
<a name="l01101"></a>01101       <span class="keywordtype">int</span> k0 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;
<a name="l01102"></a>01102       <span class="keywordtype">int</span> k1 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;
<a name="l01103"></a>01103 
<a name="l01104"></a>01104       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=k0; k&lt;k1; ++k )
<a name="l01105"></a>01105         {
<a name="l01106"></a>01106           <span class="keywordtype">int</span> j = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k ) - 1;
<a name="l01107"></a>01107           <span class="keywordflow">if</span>  ( j &lt; i )
<a name="l01108"></a>01108             {
<a name="l01109"></a>01109               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;( j &lt; i ) : line index : &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; and column index &quot;</span> &lt;&lt; j &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01110"></a>01110               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01111"></a>01111             }
<a name="l01112"></a>01112         }
<a name="l01113"></a>01113     }
<a name="l01114"></a>01114   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01115"></a>01115 }
<a name="l01116"></a>01116 
<a name="l01117"></a><a class="code" href="classMatrice__Morse__Sym.html#a9a861d39c6c10c5095db3aac51be4b22">01117</a> <span class="keywordtype">bool</span> <a class="code" href="classMatrice__Morse__Sym.html#a9a861d39c6c10c5095db3aac51be4b22">Matrice_Morse_Sym::check_sorted_symmetric_morse_matrix_structure</a>( <span class="keywordtype">void</span> )<span class="keyword"> const</span>
<a name="l01118"></a>01118 <span class="keyword"></span>{
<a name="l01119"></a>01119   <span class="keywordflow">if</span> ( ! ( <a class="code" href="classMatrice__Morse.html#a16be4586cacf33093dcd6a8fd804f7f0">check_sorted_morse_matrix_structure</a>( ) ) )
<a name="l01120"></a>01120     {
<a name="l01121"></a>01121       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01122"></a>01122     }
<a name="l01123"></a>01123 
<a name="l01124"></a>01124   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l01125"></a>01125   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
<a name="l01126"></a>01126     {
<a name="l01127"></a>01127       <span class="keywordtype">int</span> k0 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;
<a name="l01128"></a>01128       <span class="keywordtype">int</span> k1 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;
<a name="l01129"></a>01129 
<a name="l01130"></a>01130       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=k0; k&lt;k1; ++k )
<a name="l01131"></a>01131         {
<a name="l01132"></a>01132           <span class="keywordtype">int</span> j = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k ) - 1;
<a name="l01133"></a>01133           <span class="keywordflow">if</span>  ( j &lt; i )
<a name="l01134"></a>01134             {
<a name="l01135"></a>01135               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;( j &lt; i ) : line index : &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; and column index &quot;</span> &lt;&lt; j &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01136"></a>01136               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01137"></a>01137             }
<a name="l01138"></a>01138         }
<a name="l01139"></a>01139     }
<a name="l01140"></a>01140   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01141"></a>01141 }
<a name="l01142"></a>01142 
<a name="l01143"></a>01143 
<a name="l01144"></a><a class="code" href="classMatrice__Morse__Sym.html#a840956dbca5097382324a5dd4d35db76">01144</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse__Sym.html#a840956dbca5097382324a5dd4d35db76">Matrice_Morse_Sym::assert_check_symmetric_morse_matrix_structure</a>( <span class="keywordtype">void</span> )<span class="keyword"> const</span>
<a name="l01145"></a>01145 <span class="keyword"></span>{
<a name="l01146"></a>01146   <span class="keywordflow">if</span> (!<a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>) <span class="keywordflow">return</span>;
<a name="l01147"></a>01147 <span class="preprocessor">#ifndef NDEBUG</span>
<a name="l01148"></a>01148 <span class="preprocessor"></span>  <span class="keywordflow">if</span> ( ! ( <a class="code" href="classMatrice__Morse__Sym.html#a260ccf43c1e00c4bcebcb76f1a1e45fe">check_symmetric_morse_matrix_structure</a>( ) ) )
<a name="l01149"></a>01149     {
<a name="l01150"></a>01150       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in &#39;Matrice_Morse_Sym::assert_check_symmetric_morse_matrix_structure( )&#39;:&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01151"></a>01151       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  Exiting...&quot;</span> &lt;&lt; finl;
<a name="l01152"></a>01152       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>( );
<a name="l01153"></a>01153     }
<a name="l01154"></a>01154   <span class="keywordflow">else</span>
<a name="l01155"></a>01155     <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=0;
<a name="l01156"></a>01156 <span class="preprocessor">#endif</span>
<a name="l01157"></a>01157 <span class="preprocessor"></span>}
<a name="l01158"></a>01158 
<a name="l01159"></a><a class="code" href="classMatrice__Morse__Sym.html#af6f8c3a0e0dc252aea51111b7bebb269">01159</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse__Sym.html#af6f8c3a0e0dc252aea51111b7bebb269">Matrice_Morse_Sym::assert_check_sorted_symmetric_morse_matrix_structure</a>( <span class="keywordtype">void</span> )<span class="keyword"> const</span>
<a name="l01160"></a>01160 <span class="keyword"></span>{
<a name="l01161"></a>01161   <span class="keywordflow">if</span> (!<a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>) <span class="keywordflow">return</span>;
<a name="l01162"></a>01162 <span class="preprocessor">#ifndef NDEBUG</span>
<a name="l01163"></a>01163 <span class="preprocessor"></span>  <span class="keywordflow">if</span> ( ! ( <a class="code" href="classMatrice__Morse__Sym.html#a260ccf43c1e00c4bcebcb76f1a1e45fe">check_symmetric_morse_matrix_structure</a>( ) ) )
<a name="l01164"></a>01164     {
<a name="l01165"></a>01165       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in &#39;Matrice_Morse_Sym::assert_check_sorted_symmetric_morse_matrix_structure( )&#39;:&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01166"></a>01166       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  Exiting...&quot;</span> &lt;&lt; finl;
<a name="l01167"></a>01167       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>( );
<a name="l01168"></a>01168     }
<a name="l01169"></a>01169   <span class="keywordflow">else</span>
<a name="l01170"></a>01170     <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=0;
<a name="l01171"></a>01171 <span class="preprocessor">#endif</span>
<a name="l01172"></a>01172 <span class="preprocessor"></span>}
<a name="l01173"></a>01173 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:22 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
