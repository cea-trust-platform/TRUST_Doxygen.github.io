<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VEF/Operateurs/Op_Conv_EF_VEF_P1NC.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VEF/Operateurs/Op_Conv_EF_VEF_P1NC.cpp</div>  </div>
</div>
<div class="contents">
<a href="Op__Conv__EF__VEF__P1NC_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Op_Conv_EF_VEF_P1NC.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VEF/Operateurs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/22</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Op__Conv__EF__VEF__P1NC_8h.html">Op_Conv_EF_VEF_P1NC.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Champ__P1NC_8h.html">Champ_P1NC.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Porosites__champ_8h.html">Porosites_champ.h</a>&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="Op__Conv__EF__VEF__P1NC_8cpp.html#aea0b9b6a2f97c13b28d58fca517559f6">00028</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classOp__Conv__EF__VEF__P1NC.html" title="class Op_Conv_EF_VEF_P1NC Cette classe represente l&#39;operateur de convection associe a une equation de...">Op_Conv_EF_VEF_P1NC</a>,<span class="stringliteral">&quot;Op_Conv_EF_VEF_P1NC&quot;</span>,<a class="code" href="classOp__Conv__VEF__base.html" title="class Op_Conv_VEF_base Classe de base des operateurs de convection VEF">Op_Conv_VEF_base</a>);
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="comment"></span>
<a name="l00031"></a>00031 <span class="comment">////!&lt; printOn </span>
<a name="l00032"></a>00032 <span class="comment"></span><span class="comment">//</span>
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a40a2fef397b3e47fa3065d7c23b1beff">00034</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a40a2fef397b3e47fa3065d7c23b1beff" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Conv_EF_VEF_P1NC::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00035"></a>00035 <span class="keyword"></span>{
<a name="l00036"></a>00036   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() ;
<a name="l00037"></a>00037 }
<a name="l00038"></a>00038 <span class="comment"></span>
<a name="l00039"></a>00039 <span class="comment">////!&lt; readOn </span>
<a name="l00040"></a>00040 <span class="comment"></span><span class="comment">//</span>
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="classOp__Conv__EF__VEF__P1NC.html#aee8fb2276b657a7d6831ae695ebaa7c5">00042</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#aee8fb2276b657a7d6831ae695ebaa7c5" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Conv_EF_VEF_P1NC::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s )
<a name="l00043"></a>00043 {
<a name="l00044"></a>00044   <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a36ff01900b5bf6aac5074cd4b6bc0597">transportant_bar</a>=0;
<a name="l00045"></a>00045   <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a7fc4f8397861f859a821c8557757e5e4">transporte_bar</a>=1;
<a name="l00046"></a>00046   <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a3ebbc043cac55736ec05adf1e3338d7e">filtrer_resu</a>=1;
<a name="l00047"></a>00047   <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a2431a71a65192b0b199f32a18d33e220">antisym</a>=1;
<a name="l00048"></a>00048   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> motlu;
<a name="l00049"></a>00049   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; i++)
<a name="l00050"></a>00050     {
<a name="l00051"></a>00051       s &gt;&gt; motlu;
<a name="l00052"></a>00052       <span class="keywordflow">if</span> (motlu==<span class="stringliteral">&quot;defaut_bar&quot;</span>)
<a name="l00053"></a>00053         <span class="keywordflow">break</span>;
<a name="l00054"></a>00054       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu==<span class="stringliteral">&quot;transportant_bar&quot;</span>)
<a name="l00055"></a>00055         s &gt;&gt; <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a36ff01900b5bf6aac5074cd4b6bc0597">transportant_bar</a>;
<a name="l00056"></a>00056       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu==<span class="stringliteral">&quot;transporte_bar&quot;</span>)
<a name="l00057"></a>00057         s &gt;&gt; <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a7fc4f8397861f859a821c8557757e5e4">transporte_bar</a>;
<a name="l00058"></a>00058       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu==<span class="stringliteral">&quot;filtrer_resu&quot;</span>)
<a name="l00059"></a>00059         s &gt;&gt; <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a3ebbc043cac55736ec05adf1e3338d7e">filtrer_resu</a>;
<a name="l00060"></a>00060       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu==<span class="stringliteral">&quot;antisym&quot;</span>)
<a name="l00061"></a>00061         s &gt;&gt; <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a2431a71a65192b0b199f32a18d33e220">antisym</a>;
<a name="l00062"></a>00062       <span class="keywordflow">else</span>
<a name="l00063"></a>00063         {
<a name="l00064"></a>00064           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; motlu &lt;&lt; <span class="stringliteral">&quot;n&#39;est pas compris par &quot;</span>
<a name="l00065"></a>00065                &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00066"></a>00066           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00067"></a>00067         }
<a name="l00068"></a>00068     }
<a name="l00069"></a>00069 
<a name="l00070"></a>00070   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a36ff01900b5bf6aac5074cd4b6bc0597">transportant_bar</a> &lt;0)
<a name="l00071"></a>00071     {
<a name="l00072"></a>00072       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;il manque le mot cle transportant_bar&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00073"></a>00073       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00074"></a>00074     }
<a name="l00075"></a>00075   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a7fc4f8397861f859a821c8557757e5e4">transporte_bar</a> &lt;0)
<a name="l00076"></a>00076     {
<a name="l00077"></a>00077       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;il manque le mot cle transporte_bar&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00078"></a>00078       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00079"></a>00079     }
<a name="l00080"></a>00080   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a3ebbc043cac55736ec05adf1e3338d7e">filtrer_resu</a> &lt;0)
<a name="l00081"></a>00081     {
<a name="l00082"></a>00082       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;il manque le mot cle filtrer_resu&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00083"></a>00083       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00084"></a>00084     }
<a name="l00085"></a>00085   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a2431a71a65192b0b199f32a18d33e220">antisym</a> &lt;0)
<a name="l00086"></a>00086     {
<a name="l00087"></a>00087       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;il manque le mot cle antisym&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00088"></a>00088       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00089"></a>00089     }
<a name="l00090"></a>00090   <span class="keywordflow">return</span> s ;
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <span class="comment">// </span>
<a name="l00094"></a>00094 <span class="comment">// Fonctions de la classe Op_Conv_EF_VEF_P1NC</span>
<a name="l00095"></a>00095 <span class="comment">// </span>
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="comment">// convbis correspond au calcul de -1*terme_convection</span>
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 
<a name="l00100"></a>00100 <span class="comment">//</span>
<a name="l00101"></a>00101 <span class="comment">// </span>
<a name="l00102"></a>00102 <span class="comment">// Implementation des fonctions</span>
<a name="l00103"></a>00103 <span class="comment">// </span>
<a name="l00104"></a>00104 <span class="comment">// de la classe Op_Conv_EF_VEF_P1NC</span>
<a name="l00105"></a>00105 <span class="comment">// </span>
<a name="l00106"></a>00106 <span class="comment">//</span>
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 
<a name="l00109"></a><a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a6eec2807dd80eddb6c9ce693e6c46027">00109</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a6eec2807dd80eddb6c9ce693e6c46027">Op_Conv_EF_VEF_P1NC::ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte_2,
<a name="l00110"></a>00110                                         <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00111"></a>00111 <span class="keyword"></span>{
<a name="l00112"></a>00112 <span class="comment">// Cerr &lt;&lt; &quot;Op_Conv_EF_VEF_P1NC::ajouter&quot; &lt;&lt; finl;</span>
<a name="l00113"></a>00113   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> sauv(resu);
<a name="l00114"></a>00114   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
<a name="l00115"></a>00115   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
<a name="l00116"></a>00116   <span class="keyword">const</span> <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; la_vitesse=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>( <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>, <a class="code" href="classOp__Conv__VEF__base.html#a5547875832fb45e09b1115372fb76ffd">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>());
<a name="l00117"></a>00117   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse_face_absolue=la_vitesse.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00118"></a>00118   <span class="keyword">const</span> <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; ch=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,<a class="code" href="classMorEqn.html#a47b12fa29b57783a8a5897f7611e2176">mon_equation</a>-&gt;inconnue().<a class="code" href="classRef__Equation__base.html#a7bb6fb60cb55bef0eef1b0e8718300a4">valeur</a>());
<a name="l00119"></a>00119 
<a name="l00120"></a>00120   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00121"></a>00121   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00122"></a>00122   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales=zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00123"></a>00123   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_face = zone_VEF.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>();
<a name="l00124"></a>00124   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
<a name="l00125"></a>00125   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.dimension(1);
<a name="l00126"></a>00126 
<a name="l00127"></a>00127   assert(nb_faces_elem==(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+1));
<a name="l00128"></a>00128   {
<a name="l00129"></a>00129 <span class="comment">// calcul de la CFL.</span>
<a name="l00130"></a>00130     <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; fluent_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>, <a class="code" href="classOp__Conv__VEF__base.html#a32b54e8fd5340e238cf4f28ff6e743ec" title="tableau qui sert pour le calcul du pas de temps de stabilite">fluent</a>);
<a name="l00131"></a>00131     <span class="keywordtype">double</span> psc;
<a name="l00132"></a>00132 <span class="comment">// On remet a zero le tableau qui sert pour</span>
<a name="l00133"></a>00133 <span class="comment">// le calcul du pas de temps de stabilite</span>
<a name="l00134"></a>00134     fluent_ = 0;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136     <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces = zone_VEF.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
<a name="l00137"></a>00137     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> num_face=0; num_face&lt;nb_faces; num_face++)
<a name="l00138"></a>00138       {
<a name="l00139"></a>00139         psc=0.;
<a name="l00140"></a>00140         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)
<a name="l00141"></a>00141           psc+=vitesse_face_absolue(num_face,i)*face_normales(num_face,i);
<a name="l00142"></a>00142         fluent_(num_face)=<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(psc);
<a name="l00143"></a>00143       }
<a name="l00144"></a>00144   }
<a name="l00145"></a>00145   <span class="keywordtype">int</span> marq=<a class="code" href="classOp__Conv__VEF__base.html#ad380b9b9ca1d70282b289838a604a4b0" title="definit si l&#39;on convecte psi avec phi*u ou avec u">phi_u_transportant</a>(<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>());
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> <a class="code" href="Op__Conv__EF_8cpp.html#aec139ab06c54f3c620f1e9944627c994">transporte_</a>;
<a name="l00148"></a>00148   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vitesse_face_;
<a name="l00149"></a>00149 <span class="comment">// soit on a transporte=phi*transporte_ et vitesse_face=vitesse_</span>
<a name="l00150"></a>00150 <span class="comment">// soit transporte=transporte_ et vitesse_face=phi*vitesse_</span>
<a name="l00151"></a>00151 <span class="comment">// cela d~pend si on transporte avec phi u ou avec u.</span>
<a name="l00152"></a>00152   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte=<a class="code" href="Porosites__champ_8cpp.html#a2340e7d73d0f9d34926d012fe1b1d884" title="renvoit le tableau res, res=org si flag=0, res= porosite*org sinon attention ne pas modifier res car ...">modif_par_porosite_si_flag</a>(transporte_2,transporte_,!marq,porosite_face);
<a name="l00153"></a>00153   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_vitesse=<a class="code" href="Porosites__champ_8cpp.html#a2340e7d73d0f9d34926d012fe1b1d884" title="renvoit le tableau res, res=org si flag=0, res= porosite*org sinon attention ne pas modifier res car ...">modif_par_porosite_si_flag</a>(vitesse_face_absolue,vitesse_face_,marq,porosite_face);
<a name="l00154"></a>00154 <span class="comment">// DoubleTab ubar(transporte);</span>
<a name="l00155"></a>00155 <span class="comment">// la_vitesse.filtrer_L2(ubar);</span>
<a name="l00156"></a>00156 <span class="comment">// DoubleTab uprime(transporte);</span>
<a name="l00157"></a>00157 <span class="comment">// uprime-=ubar;</span>
<a name="l00158"></a>00158 
<a name="l00159"></a>00159   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> uT(transporte);
<a name="l00160"></a>00160   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> u(tab_vitesse);
<a name="l00161"></a>00161 
<a name="l00162"></a>00162   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a7fc4f8397861f859a821c8557757e5e4">transporte_bar</a>) ch.<a class="code" href="classChamp__P1NC.html#a75f9ba41c7f6f9eddf9d33f9223326b6">filtrer_L2</a>(uT);
<a name="l00163"></a>00163   <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a36ff01900b5bf6aac5074cd4b6bc0597">transportant_bar</a>) la_vitesse.<a class="code" href="classChamp__P1NC.html#a75f9ba41c7f6f9eddf9d33f9223326b6">filtrer_L2</a>(u);
<a name="l00164"></a>00164 
<a name="l00165"></a>00165   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp =resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00166"></a>00166   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> grad_uT(nb_comp, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00167"></a>00167   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> grad_phi(nb_faces_elem,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00168"></a>00168   <span class="keywordtype">int</span> elem, num_face, j, i, face;
<a name="l00169"></a>00169   <span class="keywordtype">double</span> d_inv=(1./nb_faces_elem);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171   resu=0;
<a name="l00172"></a>00172   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> sigma(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00173"></a>00173   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> contrib_elem(nb_faces_elem, nb_comp);
<a name="l00174"></a>00174   <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00175"></a>00175     {
<a name="l00176"></a>00176 <span class="comment">// for elem</span>
<a name="l00177"></a>00177       sigma=0, contrib_elem=0, grad_uT=0., grad_phi=0.;
<a name="l00178"></a>00178       <span class="keywordflow">for</span>(num_face=0; num_face&lt;nb_faces_elem; num_face++)
<a name="l00179"></a>00179         {
<a name="l00180"></a>00180 <span class="comment">// for num_face</span>
<a name="l00181"></a>00181           face=elem_faces(elem, num_face);
<a name="l00182"></a>00182           <span class="keywordtype">double</span> cc=1.;
<a name="l00183"></a>00183           <span class="keywordflow">if</span>(face_voisins(face,0)!=elem)
<a name="l00184"></a>00184             cc*=-1;
<a name="l00185"></a>00185           <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)
<a name="l00186"></a>00186             {
<a name="l00187"></a>00187               grad_phi(num_face,i)=face_normales(face,i)*cc;
<a name="l00188"></a>00188               <span class="keywordflow">for</span> (j=0; j&lt;nb_comp; j++)
<a name="l00189"></a>00189                 {
<a name="l00190"></a>00190                   sigma(i,j)+=u(face,i)*uT(face,j);
<a name="l00191"></a>00191                   grad_uT(j,i)+=uT(face,j)*grad_phi(num_face,i);
<a name="l00192"></a>00192                 }
<a name="l00193"></a>00193             }
<a name="l00194"></a>00194         }
<a name="l00195"></a>00195 
<a name="l00196"></a>00196       <span class="keywordflow">if</span>(<a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a2431a71a65192b0b199f32a18d33e220">antisym</a>==1)
<a name="l00197"></a>00197         {
<a name="l00198"></a>00198           <span class="keywordflow">for</span>(num_face=0; num_face&lt;nb_faces_elem; num_face++)
<a name="l00199"></a>00199             {
<a name="l00200"></a>00200 <span class="comment">// for num_face</span>
<a name="l00201"></a>00201               face=elem_faces(elem, num_face);
<a name="l00202"></a>00202               <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)
<a name="l00203"></a>00203                 <span class="keywordflow">for</span> (j=0; j&lt;nb_comp; j++)
<a name="l00204"></a>00204                   contrib_elem(num_face,j)-=0.5*d_inv*(u(face,i)*grad_uT(j,i)-sigma(i,j)*grad_phi(num_face,i));<span class="comment">//!&lt; Ui Uj,i Vj - Ui Vj,i Uj</span>
<a name="l00205"></a>00205 <span class="comment"></span>            }
<a name="l00206"></a>00206         }
<a name="l00207"></a>00207       <span class="keywordflow">else</span>
<a name="l00208"></a>00208         {
<a name="l00209"></a>00209           <span class="keywordflow">for</span>(num_face=0; num_face&lt;nb_faces_elem; num_face++)
<a name="l00210"></a>00210             {
<a name="l00211"></a>00211 <span class="comment">// for num_face</span>
<a name="l00212"></a>00212               face=elem_faces(elem, num_face);
<a name="l00213"></a>00213               <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)
<a name="l00214"></a>00214                 <span class="keywordflow">for</span> (j=0; j&lt;nb_comp; j++)
<a name="l00215"></a>00215                   contrib_elem(num_face,j)-=d_inv*(u(face,i)*grad_uT(j, i));<span class="comment">//!&lt; Ui Uj,i Vj</span>
<a name="l00216"></a>00216 <span class="comment"></span>            }
<a name="l00217"></a>00217         }
<a name="l00218"></a>00218 
<a name="l00219"></a>00219       <span class="keywordflow">for</span>(num_face=0; num_face&lt;nb_faces_elem; num_face++)
<a name="l00220"></a>00220         {
<a name="l00221"></a>00221           face=elem_faces(elem, num_face);
<a name="l00222"></a>00222           <span class="keywordflow">for</span> (i=0; i&lt;nb_comp; i++)
<a name="l00223"></a>00223             resu(face,i)+=contrib_elem(num_face,i);
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225     }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00228"></a>00228     {
<a name="l00229"></a>00229       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00230"></a>00230       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00231"></a>00231       <span class="keywordtype">int</span> nb_faces_bord_tot=le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00232"></a>00232       <span class="keywordtype">int</span> num10 = 0, num20 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00233"></a>00233 
<a name="l00234"></a>00234       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00235"></a>00235         {
<a name="l00236"></a>00236           <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00237"></a>00237           <span class="keywordtype">int</span> <a class="code" href="AssembleurPP1BUtil_8cpp.html#a3e374d53ebc7860e1c2f0b7906f2936d">face_associee</a>;
<a name="l00238"></a>00238           <a class="code" href="classIntVect.html">IntVect</a> fait(nb_faces_bord_tot);
<a name="l00239"></a>00239           fait = 0;
<a name="l00240"></a>00240 
<a name="l00241"></a>00241           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num10; ind_face&lt;num20; ind_face++)
<a name="l00242"></a>00242             {
<a name="l00243"></a>00243               face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00244"></a>00244               <span class="keywordflow">if</span> (fait(ind_face) == 0)
<a name="l00245"></a>00245                 {
<a name="l00246"></a>00246                   fait(ind_face) = 1;
<a name="l00247"></a>00247                   face_associee=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(ind_face);
<a name="l00248"></a>00248                   fait(face_associee) = 1;
<a name="l00249"></a>00249                   face_associee = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(face_associee);
<a name="l00250"></a>00250 
<a name="l00251"></a>00251                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l00252"></a>00252                     {
<a name="l00253"></a>00253                       <span class="keywordtype">double</span> som;
<a name="l00254"></a>00254                       som=resu(face_associee,comp)+resu(face,comp);
<a name="l00255"></a>00255                       resu(face,comp)=resu(face_associee,comp)=som;
<a name="l00256"></a>00256                     }
<a name="l00257"></a>00257                 }<span class="comment">//!&lt; if fait</span>
<a name="l00258"></a>00258 <span class="comment"></span>            }<span class="comment">//!&lt; for face</span>
<a name="l00259"></a>00259 <span class="comment"></span>
<a name="l00260"></a>00260         }<span class="comment">//!&lt; sub_type Perio</span>
<a name="l00261"></a>00261 <span class="comment"></span>
<a name="l00262"></a>00262       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a2431a71a65192b0b199f32a18d33e220">antisym</a>==1) &amp;&amp; (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classSymetrie.html" title="classe Symetrie Sur les faces de symetrie on a les proprietes suivantes: - composante normale de la v...">Symetrie</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())) )
<a name="l00263"></a>00263         {
<a name="l00264"></a>00264 <span class="comment">// Cerr &lt;&lt; &quot;Ajout des termes de bords :&quot; &lt;&lt; finl;</span>
<a name="l00265"></a>00265           <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00266"></a>00266           <span class="keywordtype">int</span> nb_faces=le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00267"></a>00267           <span class="keywordtype">int</span> num2 = num1 + nb_faces;
<a name="l00268"></a>00268 
<a name="l00269"></a>00269           <span class="keywordflow">for</span> (face=num1; face&lt;num2; face++)
<a name="l00270"></a>00270             {
<a name="l00271"></a>00271               <span class="keywordtype">int</span> comp;
<a name="l00272"></a>00272               <span class="keywordtype">double</span> psc = 0;
<a name="l00273"></a>00273               <span class="keywordflow">for</span> (comp=0; comp&lt;nb_comp; comp++)
<a name="l00274"></a>00274                 psc += face_normales(face,comp)*u(face, comp);
<a name="l00275"></a>00275               psc *=0.5;
<a name="l00276"></a>00276               <span class="keywordflow">for</span> (comp=0; comp&lt;nb_comp; comp++)
<a name="l00277"></a>00277                 resu(face, comp)-=psc*uT(face, comp);
<a name="l00278"></a>00278 
<a name="l00279"></a>00279             }
<a name="l00280"></a>00280         }
<a name="l00281"></a>00281     }<span class="comment">//!&lt; for nbord</span>
<a name="l00282"></a>00282 <span class="comment"></span>
<a name="l00283"></a>00283   <span class="keywordflow">if</span>(<a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a3ebbc043cac55736ec05adf1e3338d7e">filtrer_resu</a>)
<a name="l00284"></a>00284     ch.<a class="code" href="classChamp__P1NC.html#a518597ace3e16644867a6798b3a4025a">filtrer_resu</a>(resu);
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 <span class="comment">// On desactive le calcul et l&#39;impression des energies u&#39;......</span>
<a name="l00287"></a>00287 <span class="comment">// on garde le codage au cas ou..</span>
<a name="l00288"></a>00288   <span class="keywordflow">if</span> (0)
<a name="l00289"></a>00289     {
<a name="l00290"></a>00290       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;filtrage petites echelles : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00291"></a>00291 
<a name="l00292"></a>00292       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> ubar(transporte);
<a name="l00293"></a>00293       ch.<a class="code" href="classChamp__P1NC.html#a75f9ba41c7f6f9eddf9d33f9223326b6">filtrer_L2</a>(ubar);
<a name="l00294"></a>00294       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> uprime(transporte);
<a name="l00295"></a>00295       uprime-=ubar;
<a name="l00296"></a>00296 
<a name="l00297"></a>00297       <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces = zone_VEF.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
<a name="l00298"></a>00298       <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_entrelaces=zone_VEF.<a class="code" href="classZone__VF.html#a64f0b549e5aea1656855113e3510f418">volumes_entrelaces</a>();
<a name="l00299"></a>00299       <span class="keywordtype">int</span> face2, k;
<a name="l00300"></a>00300       <span class="keywordtype">double</span> psc=0., pscprim=0., ec=0., ecprime=0.;
<a name="l00301"></a>00301       <span class="keywordtype">int</span> deb=zone_VEF.<a class="code" href="classZone__VF.html#a12869806fa4834aca8f2964e16509dfd" title="une face est interne ssi elle separe deux elements. renvoie le numero de la premiere face interne...">premiere_face_int</a>();
<a name="l00302"></a>00302       <span class="keywordflow">for</span>(face2=deb; face2&lt;nb_faces; face2++)
<a name="l00303"></a>00303         <span class="keywordflow">for</span>(k=0; k&lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; k++)
<a name="l00304"></a>00304           {
<a name="l00305"></a>00305             <span class="keywordtype">double</span> v=volumes_entrelaces(face2);
<a name="l00306"></a>00306             <span class="keywordtype">double</span> up, u2, r;
<a name="l00307"></a>00307             <span class="keywordflow">if</span>(nb_comp&gt;1)
<a name="l00308"></a>00308               {
<a name="l00309"></a>00309                 up=uprime(face2,k);
<a name="l00310"></a>00310                 uprime(face2,k)*=v;
<a name="l00311"></a>00311                 u2=ubar(face2,k);
<a name="l00312"></a>00312                 r=resu(face2,k);
<a name="l00313"></a>00313               }
<a name="l00314"></a>00314             <span class="keywordflow">else</span>
<a name="l00315"></a>00315               {
<a name="l00316"></a>00316                 up=uprime(face2);
<a name="l00317"></a>00317                 uprime(face2)*=v;
<a name="l00318"></a>00318                 u2=ubar(face2);
<a name="l00319"></a>00319                 r=resu(face2);
<a name="l00320"></a>00320               }
<a name="l00321"></a>00321             pscprim+=r*up;
<a name="l00322"></a>00322             psc+=r*u2;
<a name="l00323"></a>00323             ec+=u2*u2*v;
<a name="l00324"></a>00324             ecprime+=up*up*v;
<a name="l00325"></a>00325           }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 
<a name="l00329"></a>00329       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00330"></a>00330         {
<a name="l00331"></a>00331           <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00332"></a>00332           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00333"></a>00333           <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00334"></a>00334           <span class="keywordtype">int</span> nb_faces_b=le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00335"></a>00335           <span class="keywordtype">int</span> num2 = num1 + nb_faces_b;
<a name="l00336"></a>00336           <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00337"></a>00337             {
<a name="l00338"></a>00338               <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00339"></a>00339               <span class="keywordtype">int</span> <a class="code" href="AssembleurPP1BUtil_8cpp.html#a3e374d53ebc7860e1c2f0b7906f2936d">face_associee</a>;
<a name="l00340"></a>00340               <a class="code" href="classIntVect.html">IntVect</a> fait(nb_faces_b);
<a name="l00341"></a>00341               fait = 0;
<a name="l00342"></a>00342 
<a name="l00343"></a>00343               <span class="keywordflow">for</span> (face2=num1; face2&lt;num2; face2++)
<a name="l00344"></a>00344                 {
<a name="l00345"></a>00345                   <span class="keywordflow">if</span> (fait(face2-num1) == 0)
<a name="l00346"></a>00346                     {
<a name="l00347"></a>00347                       fait(face2-num1) = 1;
<a name="l00348"></a>00348                       face_associee=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(face2-num1);
<a name="l00349"></a>00349                       fait(face_associee) = 1;
<a name="l00350"></a>00350                       face_associee+=num1;
<a name="l00351"></a>00351                       <span class="keywordtype">double</span> v=volumes_entrelaces(face2);
<a name="l00352"></a>00352                       <span class="keywordtype">double</span> up, u2, r;
<a name="l00353"></a>00353                       <span class="keywordflow">for</span>(k=0; k&lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; k++)
<a name="l00354"></a>00354                         {
<a name="l00355"></a>00355                           <span class="keywordflow">if</span>(nb_comp&gt;1)
<a name="l00356"></a>00356                             {
<a name="l00357"></a>00357                               up=(uprime(face2,k));
<a name="l00358"></a>00358                               uprime(face2,k)*=v;
<a name="l00359"></a>00359                               uprime(face_associee,k)=uprime(face2,k);
<a name="l00360"></a>00360                               u2=ubar(face2,k);
<a name="l00361"></a>00361                               r=resu(face2,k);
<a name="l00362"></a>00362                             }
<a name="l00363"></a>00363                           <span class="keywordflow">else</span>
<a name="l00364"></a>00364                             {
<a name="l00365"></a>00365                               up=uprime(face2);
<a name="l00366"></a>00366                               uprime(face2)*=v;
<a name="l00367"></a>00367                               uprime(face_associee)=uprime(face2);
<a name="l00368"></a>00368                               u2=ubar(face2);
<a name="l00369"></a>00369                               r=resu(face2);
<a name="l00370"></a>00370                             }
<a name="l00371"></a>00371                           pscprim+=r*up;
<a name="l00372"></a>00372                           psc+=r*u2;
<a name="l00373"></a>00373                           ec+=u2*u2*v;
<a name="l00374"></a>00374                           ecprime+=up*up*v;
<a name="l00375"></a>00375                         }
<a name="l00376"></a>00376                     }
<a name="l00377"></a>00377                 }
<a name="l00378"></a>00378             }
<a name="l00379"></a>00379           <span class="keywordflow">else</span>
<a name="l00380"></a>00380             {
<a name="l00381"></a>00381               <span class="keywordflow">for</span> (face2=num1; face2&lt;num2; face2++)
<a name="l00382"></a>00382                 {
<a name="l00383"></a>00383                   <span class="keywordtype">double</span> v=volumes_entrelaces(face2);
<a name="l00384"></a>00384                   <span class="keywordtype">double</span> up, u2, r;
<a name="l00385"></a>00385                   <span class="keywordflow">for</span>(k=0; k&lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; k++)
<a name="l00386"></a>00386                     {
<a name="l00387"></a>00387                       <span class="keywordflow">if</span>(nb_comp&gt;1)
<a name="l00388"></a>00388                         {
<a name="l00389"></a>00389                           up=(uprime(face2,k));
<a name="l00390"></a>00390                           uprime(face2,k)*=v;
<a name="l00391"></a>00391                           u2=ubar(face2,k);
<a name="l00392"></a>00392                           r=resu(face2,k);
<a name="l00393"></a>00393                         }
<a name="l00394"></a>00394                       <span class="keywordflow">else</span>
<a name="l00395"></a>00395                         {
<a name="l00396"></a>00396                           up=uprime(face2);
<a name="l00397"></a>00397                           uprime(face2)*=v;
<a name="l00398"></a>00398                           u2=ubar(face2);
<a name="l00399"></a>00399                           r=resu(face2);
<a name="l00400"></a>00400                         }
<a name="l00401"></a>00401                       pscprim+=r*up;
<a name="l00402"></a>00402                       psc+=r*u2;
<a name="l00403"></a>00403                       ec+=u2*u2*v;
<a name="l00404"></a>00404                       ecprime+=up*up*v;
<a name="l00405"></a>00405                     }
<a name="l00406"></a>00406                 }
<a name="l00407"></a>00407             }
<a name="l00408"></a>00408         }
<a name="l00409"></a>00409       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;(u,u) &quot;</span>&lt;&lt; ec &lt;&lt;finl;
<a name="l00410"></a>00410       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;(u&#39;,u&#39;) &quot;</span>&lt;&lt; ecprime &lt;&lt;finl;
<a name="l00411"></a>00411       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;(u grad u ,u) &quot;</span>&lt;&lt; psc &lt;&lt;finl;
<a name="l00412"></a>00412       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;(u grad u ,u&#39;) &quot;</span>&lt;&lt; pscprim &lt;&lt;finl;
<a name="l00413"></a>00413       <span class="keywordtype">double</span> pourcent=0;
<a name="l00414"></a>00414       <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(ec,0))
<a name="l00415"></a>00415         pourcent=100*sqrt(ecprime/ec);
<a name="l00416"></a>00416       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;||u&#39;||/||u|| :  &quot;</span> &lt;&lt; pourcent &lt;&lt; <span class="stringliteral">&quot; %&quot;</span> &lt;&lt; finl;
<a name="l00417"></a>00417     }
<a name="l00418"></a>00418   resu+=sauv;
<a name="l00419"></a>00419   <a class="code" href="classOp__VEF__Face.html#a6c8ce571769b4f2e20b07cbb7a6944f2">modifier_flux</a>(*<span class="keyword">this</span>);
<a name="l00420"></a>00420   <span class="keywordflow">return</span> resu;
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 
<a name="l00424"></a><a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a99bf959fc355a1700b3c55ded1514d37">00424</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a99bf959fc355a1700b3c55ded1514d37">Op_Conv_EF_VEF_P1NC::ajouter_contribution</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice )<span class="keyword"> const</span>
<a name="l00425"></a>00425 <span class="keyword"></span>{
<a name="l00426"></a>00426   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Op_Conv_EF_VEF_P1NC::ajouter_contribution non code.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00427"></a>00427   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00428"></a>00428 }
<a name="l00429"></a>00429 
<a name="l00430"></a><a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a492b587fa9a096ddfaeaa80ea53f7446">00430</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Conv__EF__VEF__P1NC.html#a492b587fa9a096ddfaeaa80ea53f7446">Op_Conv_EF_VEF_P1NC::contribue_au_second_membre</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu )<span class="keyword"> const</span>
<a name="l00431"></a>00431 <span class="keyword"></span>{
<a name="l00432"></a>00432   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Op_Conv_EF_VEF_P1NC::contribue_au_second_membre non code.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00433"></a>00433   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00434"></a>00434 }
<a name="l00435"></a>00435 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:42 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
