<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Math/Matrices/Matrice_Dense.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Math/Matrices/Matrice_Dense.cpp</div>  </div>
</div>
<div class="contents">
<a href="Matrice__Dense_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Matrice_Dense.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Math/Matrices</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/62</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Dense_8h.html">Matrice_Dense.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Lapack_8h.html">Lapack.h</a>&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="Matrice__Dense_8cpp.html#a0d072b672880b747b2f57dfe228f28b7">00028</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classMatrice__Dense.html">Matrice_Dense</a>,<span class="stringliteral">&quot;Matrice_Dense&quot;</span>,<a class="code" href="classMatrice__Base.html">Matrice_Base</a>);
<a name="l00029"></a>00029 
<a name="l00030"></a><a class="code" href="classMatrice__Dense.html#aa2eee9b8006b840d7e123bd28dcb9a72">00030</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classMatrice__Dense.html#aa2eee9b8006b840d7e123bd28dcb9a72" title="Ecriture de l&#39;objet sur un flot de sortie Methode a surcharger.">Matrice_Dense::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00031"></a>00031 <span class="keyword"></span>{
<a name="l00032"></a>00032   <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( );
<a name="l00033"></a>00033   <span class="keywordtype">int</span> nb_cols  = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( );
<a name="l00034"></a>00034 <span class="comment">// s &lt;&lt; nb_lines &lt;&lt; &quot; &quot;&lt;&lt; nb_cols &lt;&lt; &quot;\n&quot;;</span>
<a name="l00035"></a>00035   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_lines; i++)
<a name="l00036"></a>00036     {
<a name="l00037"></a>00037       <span class="keywordflow">for</span>( <span class="keywordtype">int</span> j=0; j&lt;nb_cols; j++)
<a name="l00038"></a>00038         {
<a name="l00039"></a>00039           s &lt;&lt; <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>( i , j )&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;
<a name="l00040"></a>00040         }
<a name="l00041"></a>00041       s &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00042"></a>00042     }
<a name="l00043"></a>00043   <span class="keywordflow">return</span> s;
<a name="l00044"></a>00044 }
<a name="l00045"></a>00045 
<a name="l00046"></a><a class="code" href="classMatrice__Dense.html#aa3d18d7339dde3ba2ff1b11600c8fe42">00046</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classMatrice__Dense.html#aa3d18d7339dde3ba2ff1b11600c8fe42" title="Lecture d&#39;un Objet_U sur un flot d&#39;entree Methode a surcharger.">Matrice_Dense::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s)
<a name="l00047"></a>00047 {
<a name="l00048"></a>00048   <span class="keywordflow">return</span> s;
<a name="l00049"></a>00049 }
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 
<a name="l00052"></a><a class="code" href="classMatrice__Dense.html#a1cbdb1c7a870b8380490899fa9fb4461">00052</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classMatrice__Dense.html#a1cbdb1c7a870b8380490899fa9fb4461">Matrice_Dense::imprimer_formatte</a>( <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00053"></a>00053 <span class="keyword"></span>{
<a name="l00054"></a>00054   <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( );
<a name="l00055"></a>00055   <span class="keywordtype">int</span> nb_cols  = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( );
<a name="l00056"></a>00056   s &lt;&lt; nb_lines &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00057"></a>00057   s &lt;&lt; nb_cols &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span>;
<a name="l00058"></a>00058   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_lines; i++)
<a name="l00059"></a>00059     {
<a name="l00060"></a>00060       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nb_cols; j++)
<a name="l00061"></a>00061         {
<a name="l00062"></a>00062           s &lt;&lt; <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>( i , j )&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;
<a name="l00063"></a>00063         }
<a name="l00064"></a>00064       s &lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;
<a name="l00065"></a>00065     }
<a name="l00066"></a>00066   <span class="keywordflow">return</span> s;
<a name="l00067"></a>00067 }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="classMatrice__Dense.html#a6b0de2a7ec7d6a119007a280e87f0493">00070</a> <a class="code" href="classMatrice__Dense.html#a6b0de2a7ec7d6a119007a280e87f0493">Matrice_Dense::Matrice_Dense</a>( <span class="keywordtype">void</span> )
<a name="l00071"></a>00071 {
<a name="l00072"></a>00072   <a class="code" href="classMatrice__Dense.html#adde998614725b13e6ae892dd42bf4936">dimensionner</a>( 0 , 0 );
<a name="l00073"></a>00073 }
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="classMatrice__Dense.html#a5142b1cbfe9ed7ecad21aebb9d5ee9d4">00075</a> <a class="code" href="classMatrice__Dense.html#a6b0de2a7ec7d6a119007a280e87f0493">Matrice_Dense::Matrice_Dense</a>( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nb_lines , <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nb_cols )
<a name="l00076"></a>00076 {
<a name="l00077"></a>00077   <a class="code" href="classMatrice__Dense.html#adde998614725b13e6ae892dd42bf4936">dimensionner</a>( nb_lines , nb_cols );
<a name="l00078"></a>00078 }
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="comment">// This function allow to build a dense matrix from a file</span>
<a name="l00082"></a>00082 <span class="comment">// the format expected is the following :</span>
<a name="l00083"></a>00083 <span class="comment">// nb_lines  nb_columns</span>
<a name="l00084"></a>00084 <span class="comment">// first  line values ...</span>
<a name="l00085"></a>00085 <span class="comment">// second line values ...</span>
<a name="l00086"></a>00086 <span class="comment">// ...</span>
<a name="l00087"></a>00087 <span class="comment">// last   line values ...</span>
<a name="l00088"></a><a class="code" href="classMatrice__Dense.html#a25eec13fb5ed14645066631474f643f1">00088</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Dense.html#a25eec13fb5ed14645066631474f643f1">Matrice_Dense::read_from_file</a>( <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; filename )
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090   std::ifstream file(filename, ios::in);
<a name="l00091"></a>00091   <span class="keywordtype">int</span> nb_lines, nb_cols;
<a name="l00092"></a>00092 
<a name="l00093"></a>00093   <span class="keywordflow">if</span>( file )
<a name="l00094"></a>00094     {
<a name="l00095"></a>00095       file &gt;&gt; nb_lines ;
<a name="l00096"></a>00096       file &gt;&gt; nb_cols  ;
<a name="l00097"></a>00097       <a class="code" href="classMatrice__Dense.html#adde998614725b13e6ae892dd42bf4936">dimensionner</a>( nb_lines , nb_cols );
<a name="l00098"></a>00098       <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; i++)
<a name="l00099"></a>00099         {
<a name="l00100"></a>00100           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nb_cols; j++)
<a name="l00101"></a>00101             {
<a name="l00102"></a>00102               file &gt;&gt; <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>( i , j );
<a name="l00103"></a>00103             }
<a name="l00104"></a>00104         }
<a name="l00105"></a>00105     }
<a name="l00106"></a>00106   <span class="keywordflow">else</span>
<a name="l00107"></a>00107     {
<a name="l00108"></a>00108       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Error in Matrice_Dense::read_from_file&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00109"></a>00109       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;The file &quot;</span>&lt;&lt;filename&lt;&lt;<span class="stringliteral">&quot; was not found or a problem occured while opening the file&quot;</span>&lt;&lt;finl;
<a name="l00110"></a>00110       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Aborting...&quot;</span>&lt;&lt;finl;
<a name="l00111"></a>00111       <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">Process::abort</a>( );
<a name="l00112"></a>00112     }
<a name="l00113"></a>00113 }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 <span class="comment">// input : a vector of coefficients organized lines by lines</span>
<a name="l00117"></a>00117 <span class="comment">// for example, let&#39;s say that we have nbl lines and nbc columns</span>
<a name="l00118"></a>00118 <span class="comment">// then the first nbc coefficients are coefficients associated to the first line of the matrix</span>
<a name="l00119"></a>00119 <span class="comment">// then the next nbc coefficients are coefficients associated to the second line of the matrix, ect...</span>
<a name="l00120"></a>00120 <span class="comment">// Warning : the user need to resize correctly the matrix before to call this function</span>
<a name="l00121"></a><a class="code" href="classMatrice__Dense.html#a37fcf6bf33046c58cf4917ec5d60145f">00121</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Dense.html#a37fcf6bf33046c58cf4917ec5d60145f">Matrice_Dense::build_matrix_from_coefficients_line_by_line</a>( <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; coefficients )
<a name="l00122"></a>00122 {
<a name="l00123"></a>00123   <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( );
<a name="l00124"></a>00124   <span class="keywordtype">int</span> nb_cols  = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( );
<a name="l00125"></a>00125   assert( coefficients.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>( ) == nb_lines * nb_cols );
<a name="l00126"></a>00126   <a class="code" href="classMatrice__Dense.html#adde998614725b13e6ae892dd42bf4936">dimensionner</a>( nb_lines , nb_cols );
<a name="l00127"></a>00127   <span class="keywordtype">int</span> counter=0;
<a name="l00128"></a>00128   <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; i++)
<a name="l00129"></a>00129     {
<a name="l00130"></a>00130       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nb_cols; j++)
<a name="l00131"></a>00131         {
<a name="l00132"></a>00132           <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>( i , j ) = coefficients( counter );
<a name="l00133"></a>00133           counter++;
<a name="l00134"></a>00134         }
<a name="l00135"></a>00135     }
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00138"></a><a class="code" href="classMatrice__Dense.html#a744be8ef38aa150b47c8a6d21033b851">00138</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Dense.html#a744be8ef38aa150b47c8a6d21033b851">Matrice_Dense::build_matrix_from_coefficients_column_by_column</a>( <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; coefficients )
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140   <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( );
<a name="l00141"></a>00141   <span class="keywordtype">int</span> nb_cols  = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( );
<a name="l00142"></a>00142   assert( coefficients.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>( ) == nb_lines * nb_cols );
<a name="l00143"></a>00143   <a class="code" href="classMatrice__Dense.html#adde998614725b13e6ae892dd42bf4936">dimensionner</a>( nb_lines , nb_cols );
<a name="l00144"></a>00144   <span class="keywordtype">int</span> counter=0;
<a name="l00145"></a>00145   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nb_cols; j++)
<a name="l00146"></a>00146     {
<a name="l00147"></a>00147       <span class="keywordflow">for</span>( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; i++)
<a name="l00148"></a>00148         {
<a name="l00149"></a>00149           <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>( i , j ) = coefficients( counter );
<a name="l00150"></a>00150           counter++;
<a name="l00151"></a>00151         }
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153 }
<a name="l00154"></a>00154 
<a name="l00155"></a>00155 <span class="comment">// this function fills the matrix morse_matrix</span>
<a name="l00156"></a><a class="code" href="classMatrice__Dense.html#ad2b897097a1e24083bdf22b045522a8a">00156</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Dense.html#ad2b897097a1e24083bdf22b045522a8a">Matrice_Dense::convert_to_morse_matrix</a>( <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; morse_matrix )<span class="keyword"> const</span>
<a name="l00157"></a>00157 <span class="keyword"></span>{
<a name="l00158"></a>00158   <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( );
<a name="l00159"></a>00159   <span class="keywordtype">int</span> nb_cols  = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( ) ;
<a name="l00160"></a>00160   <span class="keywordtype">int</span> nnz = nb_lines * nb_cols ;
<a name="l00161"></a>00161 
<a name="l00162"></a>00162   morse_matrix.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>( nb_lines , nb_cols , nnz );
<a name="l00163"></a>00163 
<a name="l00164"></a>00164   <span class="keywordtype">int</span> size_tab1 = nb_lines + 1 ;
<a name="l00165"></a>00165   <span class="keywordtype">int</span> size_tab2 = nnz ;
<a name="l00166"></a>00166   morse_matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>().<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( size_tab1 );
<a name="l00167"></a>00167   morse_matrix.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>().<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( size_tab2 );
<a name="l00168"></a>00168   morse_matrix.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>().<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( nnz );
<a name="l00169"></a>00169 
<a name="l00170"></a>00170   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;size_tab1; i++)
<a name="l00171"></a>00171     {
<a name="l00172"></a>00172       morse_matrix.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>()( i ) =  <span class="comment">/*already registred*/</span>i*nb_cols + <span class="comment">/*fortran index*/</span> 1 ;
<a name="l00173"></a>00173     }
<a name="l00174"></a>00174   <span class="keywordtype">int</span> count = 0;
<a name="l00175"></a>00175   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0 ; i&lt;nb_lines ; i++)
<a name="l00176"></a>00176     {
<a name="l00177"></a>00177       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nb_cols; j++)
<a name="l00178"></a>00178         {
<a name="l00179"></a>00179           morse_matrix.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>()( count ) = j+1 ;
<a name="l00180"></a>00180           morse_matrix.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>()( count ) = <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>( i , j );
<a name="l00181"></a>00181           count++;
<a name="l00182"></a>00182         }
<a name="l00183"></a>00183     }
<a name="l00184"></a>00184 }
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 
<a name="l00187"></a><a class="code" href="classMatrice__Dense.html#adde998614725b13e6ae892dd42bf4936">00187</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Dense.html#adde998614725b13e6ae892dd42bf4936">Matrice_Dense::dimensionner</a>( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nb_lines , <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nb_cols )
<a name="l00188"></a>00188 {
<a name="l00189"></a>00189   <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( nb_lines , nb_cols );
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">00192</a> <span class="keywordtype">int</span> <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">Matrice_Dense::nb_lignes</a>( )<span class="keyword"> const</span>
<a name="l00193"></a>00193 <span class="keyword"></span>{
<a name="l00194"></a>00194   <span class="keywordflow">return</span> <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00195"></a>00195 }
<a name="l00196"></a>00196 
<a name="l00197"></a><a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">00197</a> <span class="keywordtype">int</span> <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">Matrice_Dense::nb_colonnes</a>( )<span class="keyword"> const</span>
<a name="l00198"></a>00198 <span class="keyword"></span>{
<a name="l00199"></a>00199   <span class="keywordflow">return</span> <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 1 );
<a name="l00200"></a>00200 }
<a name="l00201"></a>00201 
<a name="l00202"></a><a class="code" href="classMatrice__Dense.html#ad25f8586702c18e45ed906a2c5b3e36a">00202</a> <span class="keywordtype">int</span> <a class="code" href="classMatrice__Dense.html#ad25f8586702c18e45ed906a2c5b3e36a">Matrice_Dense::ordre</a>( )<span class="keyword"> const</span>
<a name="l00203"></a>00203 <span class="keyword"></span>{
<a name="l00204"></a>00204   <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( );
<a name="l00205"></a>00205   <span class="keywordtype">int</span> nb_cols  = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( );
<a name="l00206"></a>00206   <span class="keywordflow">if</span>( nb_lines == nb_cols )
<a name="l00207"></a>00207     {
<a name="l00208"></a>00208       <span class="keywordflow">return</span> nb_lines ;
<a name="l00209"></a>00209     }
<a name="l00210"></a>00210   <span class="keywordflow">else</span>
<a name="l00211"></a>00211     {
<a name="l00212"></a>00212       <span class="keywordflow">return</span> 0 ;
<a name="l00213"></a>00213     }
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 <span class="comment">//</span>
<a name="l00217"></a>00217 <span class="comment">//</span><span class="comment"></span>
<a name="l00218"></a>00218 <span class="comment">//! Operation de multiplication-accumulation (saxpy) matrice vecteur.&lt;br&gt;Operation: resu = resu + Matrix_ * x</span>
<a name="l00219"></a><a class="code" href="classMatrice__Dense.html#a3127e66c8f7b1a863435d10b713e3ca3">00219</a> <span class="comment"></span><a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classMatrice__Dense.html#a3127e66c8f7b1a863435d10b713e3ca3" title="Operation de multiplication-accumulation (saxpy) matrice vecteur. Operation: resu = resu + Matrix_ * ...">Matrice_Dense::ajouter_multvect_</a>( <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; x , <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resu )<span class="keyword"> const</span>
<a name="l00220"></a>00220 <span class="keyword"></span>{
<a name="l00221"></a>00221   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( ) ;
<a name="l00222"></a>00222   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_cols  = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( );
<a name="l00223"></a>00223   assert( x.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) == nb_cols );
<a name="l00224"></a>00224 <span class="comment">// the test is in this order because size( ) maybe invalid</span>
<a name="l00225"></a>00225   assert( resu.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) == nb_lines || resu.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>( ) == nb_lines );
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 <span class="comment">// for a given i such that 0 &lt;= i &lt;= nb_lines we have</span>
<a name="l00228"></a>00228 <span class="comment">// resu( i ) = resu( i ) + Matrix_( i , j ) * x( j )</span>
<a name="l00229"></a>00229 <span class="comment">// with 0 &lt;= j &lt;= nb_cols</span>
<a name="l00230"></a>00230   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_lines; i++)
<a name="l00231"></a>00231     {
<a name="l00232"></a>00232       <span class="keywordtype">double</span> old_resu = resu( i );
<a name="l00233"></a>00233       <span class="keywordtype">double</span> prod_mat_vect = 0; <span class="comment">//!&lt; store the result of Matrix_( i , j ) * x( j ) with 0&lt;= j &lt;=nb_cols</span>
<a name="l00234"></a>00234 <span class="comment"></span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nb_cols; j++)
<a name="l00235"></a>00235         {
<a name="l00236"></a>00236           prod_mat_vect += <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>( i , j ) * x( j );
<a name="l00237"></a>00237         }
<a name="l00238"></a>00238       resu( i ) = old_resu + prod_mat_vect ;
<a name="l00239"></a>00239     }
<a name="l00240"></a>00240 
<a name="l00241"></a>00241   <span class="keywordflow">return</span> resu;
<a name="l00242"></a>00242 }
<a name="l00243"></a>00243 
<a name="l00244"></a>00244 <span class="comment">// set the coefficient Matrix( i , j ) at value</span>
<a name="l00245"></a><a class="code" href="classMatrice__Dense.html#a600a0641e619eed5269a9b9c245b440e">00245</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Dense.html#a600a0641e619eed5269a9b9c245b440e">Matrice_Dense::set_coefficient</a>( <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; i , <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; j , <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; value )
<a name="l00246"></a>00246 {
<a name="l00247"></a>00247   assert( i &lt; <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( ) );
<a name="l00248"></a>00248   assert( j &lt; <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( ) );
<a name="l00249"></a>00249   <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>( i , j ) = value;
<a name="l00250"></a>00250 }
<a name="l00251"></a>00251 
<a name="l00252"></a><a class="code" href="classMatrice__Dense.html#a03efcc0bf1f4ac5bb9b596e4d80a1072">00252</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Dense.html#a03efcc0bf1f4ac5bb9b596e4d80a1072">Matrice_Dense::build_the_transposed</a>( <a class="code" href="classMatrice__Dense.html">Matrice_Dense</a>&amp; transposed )<span class="keyword"> const</span>
<a name="l00253"></a>00253 <span class="keyword"></span>{
<a name="l00254"></a>00254   <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( );
<a name="l00255"></a>00255   <span class="keywordtype">int</span> nb_cols  = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( );
<a name="l00256"></a>00256   transposed.<a class="code" href="classMatrice__Dense.html#adde998614725b13e6ae892dd42bf4936">dimensionner</a>( nb_lines , nb_cols );
<a name="l00257"></a>00257   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nb_cols; j++)
<a name="l00258"></a>00258     {
<a name="l00259"></a>00259       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_lines; i++)
<a name="l00260"></a>00260         {
<a name="l00261"></a>00261           <span class="keywordtype">double</span> value = <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>( i , j );
<a name="l00262"></a>00262           transposed.<a class="code" href="classMatrice__Dense.html#a600a0641e619eed5269a9b9c245b440e">set_coefficient</a>( j , i , value ) ;
<a name="l00263"></a>00263         }
<a name="l00264"></a>00264     }
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="comment">// return a bool which indicates if the other matrix is the same or not</span>
<a name="l00268"></a>00268 <span class="comment">// return true  : Matrix_ and other_matrix are the same for a given tolerance tol</span>
<a name="l00269"></a>00269 <span class="comment">// return false :  Matrix_ and other_matrix are NOT the same for a given tolerance tol</span>
<a name="l00270"></a><a class="code" href="classMatrice__Dense.html#ad294868b78524a29df7936baf82d3c49">00270</a> <span class="keywordtype">bool</span> <a class="code" href="classMatrice__Dense.html#ad294868b78524a29df7936baf82d3c49">Matrice_Dense::is_the_same</a>( <span class="keyword">const</span> <a class="code" href="classMatrice__Dense.html">Matrice_Dense</a>&amp; other_matrix , <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; tol )<span class="keyword"> const</span>
<a name="l00271"></a>00271 <span class="keyword"></span>{
<a name="l00272"></a>00272   <span class="keywordtype">bool</span> <a class="code" href="Faces2_8cpp.html#a45f26ea1c30b9b00e7ba13e01347c6b8" title="Fonction hors classe Compare 2 faces de 2 ensembles de faces f1 et f2 et Renvoie 1 si elles sont egal...">same</a> = <span class="keyword">true</span>;
<a name="l00273"></a>00273   <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( );
<a name="l00274"></a>00274   <span class="keywordtype">int</span> nb_cols  = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( );
<a name="l00275"></a>00275 <span class="comment">// check if the other has same number of lines/columns</span>
<a name="l00276"></a>00276   <span class="keywordflow">if</span>( other_matrix.<a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( ) != nb_lines )
<a name="l00277"></a>00277     {
<a name="l00278"></a>00278       same = <span class="keyword">false</span>;
<a name="l00279"></a>00279     }
<a name="l00280"></a>00280   <span class="keywordflow">if</span>( other_matrix.<a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( ) != nb_cols )
<a name="l00281"></a>00281     {
<a name="l00282"></a>00282       same = <span class="keyword">false</span>;
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284 <span class="comment">// check each coefficient</span>
<a name="l00285"></a>00285   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_lines; i++)
<a name="l00286"></a>00286     {
<a name="l00287"></a>00287       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nb_cols; j++)
<a name="l00288"></a>00288         {
<a name="l00289"></a>00289           <span class="keywordflow">if</span>( <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>( other_matrix( i , j ) - <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>( i , j )) &gt;= tol  )
<a name="l00290"></a>00290             {
<a name="l00291"></a>00291               same = <span class="keyword">false</span>;
<a name="l00292"></a>00292             }
<a name="l00293"></a>00293         }
<a name="l00294"></a>00294     }
<a name="l00295"></a>00295   <span class="keywordflow">return</span> <a class="code" href="Faces2_8cpp.html#a45f26ea1c30b9b00e7ba13e01347c6b8" title="Fonction hors classe Compare 2 faces de 2 ensembles de faces f1 et f2 et Renvoie 1 si elles sont egal...">same</a>;
<a name="l00296"></a>00296 }
<a name="l00297"></a>00297 
<a name="l00298"></a>00298 <span class="comment">//</span>
<a name="l00299"></a>00299 <span class="comment">//</span>
<a name="l00300"></a>00300 <span class="comment">//</span><span class="comment"></span>
<a name="l00301"></a>00301 <span class="comment">//! Operation de multiplication-accumulation (saxpy) matrice vecteur,&lt;br&gt;par la matrice transposee.&lt;br&gt;Operation: resu = resu + A^{T}*x</span>
<a name="l00302"></a><a class="code" href="classMatrice__Dense.html#a184e88e798fa5d74337e5e0eb76cd174">00302</a> <span class="comment"></span><a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classMatrice__Dense.html#a184e88e798fa5d74337e5e0eb76cd174" title="Operation de multiplication-accumulation (saxpy) matrice vecteur, par la matrice transposee. Operation: resu = resu + A^{T}*x.">Matrice_Dense::ajouter_multvectT_</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; x,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00303"></a>00303 <span class="keyword"></span>{
<a name="l00304"></a>00304 
<a name="l00305"></a>00305   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( ) ;
<a name="l00306"></a>00306   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_cols  = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( );
<a name="l00307"></a>00307   assert( x.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) == nb_lines );
<a name="l00308"></a>00308 <span class="comment">// the test is in this order because size( ) maybe invalid</span>
<a name="l00309"></a>00309   assert( resu.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) == nb_cols || resu.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>( ) == nb_cols );
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="comment">// for a given i such that 0 &lt;= i &lt;= nb_cols we have</span>
<a name="l00312"></a>00312 <span class="comment">// resu( i ) = resu( i ) + Matrix_( j , i ) * x( j )</span>
<a name="l00313"></a>00313 <span class="comment">// with 0 &lt;= j &lt;= nb_lines</span>
<a name="l00314"></a>00314   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_cols; i++)
<a name="l00315"></a>00315     {
<a name="l00316"></a>00316       <span class="keywordtype">double</span> old_resu = resu( i );
<a name="l00317"></a>00317       <span class="keywordtype">double</span> prod_mat_vect = 0;
<a name="l00318"></a>00318       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nb_lines; j++)
<a name="l00319"></a>00319         {
<a name="l00320"></a>00320           prod_mat_vect += <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>( j , i ) * x( j );
<a name="l00321"></a>00321         }
<a name="l00322"></a>00322       resu( i ) = old_resu + prod_mat_vect ;
<a name="l00323"></a>00323     }
<a name="l00324"></a>00324 
<a name="l00325"></a>00325   <span class="keywordflow">return</span> resu;
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 
<a name="l00328"></a><a class="code" href="classMatrice__Dense.html#a2ab82f3936f33af475f22f010315e230">00328</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Dense.html#a2ab82f3936f33af475f22f010315e230">Matrice_Dense::scale</a>( <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; x )
<a name="l00329"></a>00329 {
<a name="l00330"></a>00330   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( );
<a name="l00331"></a>00331   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_cols  = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( );
<a name="l00332"></a>00332   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_lines; i++)
<a name="l00333"></a>00333     {
<a name="l00334"></a>00334       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nb_cols; j++)
<a name="l00335"></a>00335         {
<a name="l00336"></a>00336           <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>( i , j ) *= x ;
<a name="l00337"></a>00337         }
<a name="l00338"></a>00338     }
<a name="l00339"></a>00339 }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 
<a name="l00343"></a><a class="code" href="classMatrice__Dense.html#a9ef9b59fbeaa77b563f2b11d41cc8188">00343</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Dense.html#a9ef9b59fbeaa77b563f2b11d41cc8188">Matrice_Dense::get_stencil</a>( <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; stencil )<span class="keyword"> const</span>
<a name="l00344"></a>00344 <span class="keyword"></span>{
<a name="l00345"></a>00345 
<a name="l00346"></a>00346   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>( );
<a name="l00347"></a>00347   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_cols  = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>( );
<a name="l00348"></a>00348 
<a name="l00349"></a>00349   stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( 0, 2 );
<a name="l00350"></a>00350   stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l00351"></a>00351 
<a name="l00352"></a>00352   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_lines; i++)
<a name="l00353"></a>00353     {
<a name="l00354"></a>00354       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nb_cols; j++)
<a name="l00355"></a>00355         {
<a name="l00356"></a>00356           stencil.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>( i , j );
<a name="l00357"></a>00357         }
<a name="l00358"></a>00358     }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360   <span class="keyword">const</span> <span class="keywordtype">int</span> new_size = stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 );
<a name="l00361"></a>00361   stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 0 );
<a name="l00362"></a>00362   stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( new_size, 2 );
<a name="l00363"></a>00363 
<a name="l00364"></a>00364 }
<a name="l00365"></a>00365 
<a name="l00366"></a>00366 
<a name="l00367"></a><a class="code" href="classMatrice__Dense.html#adb23fb46d39ca973b822c1878ae405d9">00367</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classMatrice__Dense.html#adb23fb46d39ca973b822c1878ae405d9">Matrice_Dense::ajouter_multTab_</a>( <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; x , <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu )<span class="keyword"> const</span>
<a name="l00368"></a>00368 <span class="keyword"></span>{
<a name="l00369"></a>00369   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Error in Matrice_Dense::ajouter_multTab_ .&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00370"></a>00370   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;This function is virtual pure in Matrice_Base but seems never used.&quot;</span>&lt;&lt;finl;
<a name="l00371"></a>00371   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;One should get rid off it.&quot;</span>&lt;&lt;finl;
<a name="l00372"></a>00372   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Aborting...&quot;</span>&lt;&lt;finl;
<a name="l00373"></a>00373   <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">Process::abort</a>( );
<a name="l00374"></a>00374   <span class="keywordflow">return</span> resu;
<a name="l00375"></a>00375 }
<a name="l00376"></a>00376 
<a name="l00377"></a><a class="code" href="classMatrice__Dense.html#aaa4b4b53d851421cec0fc54d5c036c61">00377</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Dense.html#aaa4b4b53d851421cec0fc54d5c036c61">Matrice_Dense::inverse</a>()
<a name="l00378"></a>00378 {
<a name="l00379"></a>00379 <span class="comment">// This method compute the inverse of the matrix.</span>
<a name="l00380"></a>00380 <span class="comment">// It uses the LAPACK library.</span>
<a name="l00381"></a>00381   <span class="keyword">const</span> <span class="keywordtype">int</span> nbLines = <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>();
<a name="l00382"></a>00382   <span class="keyword">const</span> <span class="keywordtype">int</span> nbCols = <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>();
<a name="l00383"></a>00383   <span class="keywordtype">int</span> infoerr = 0;
<a name="l00384"></a>00384   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> ipiv(nbLines);
<a name="l00385"></a>00385   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> work(nbLines);
<a name="l00386"></a>00386 
<a name="l00387"></a>00387   <span class="keywordflow">if</span> (nbLines != nbCols)
<a name="l00388"></a>00388     {
<a name="l00389"></a>00389       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Matrice_Dense::inverse&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00390"></a>00390       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The matrix is not a square matrix !&quot;</span> &lt;&lt; finl;
<a name="l00391"></a>00391       <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">Process::abort</a>( );
<a name="l00392"></a>00392     }
<a name="l00393"></a>00393 
<a name="l00394"></a>00394   <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(DGETRF)(&amp;nbLines, &amp;nbLines, <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;nbLines, ipiv.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;infoerr);
<a name="l00395"></a>00395   assert(infoerr == 0);
<a name="l00396"></a>00396   <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(DGETRI)(&amp;nbLines, <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;nbLines, ipiv.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), work.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;nbLines, &amp;infoerr);
<a name="l00397"></a>00397   assert(infoerr == 0);
<a name="l00398"></a>00398 
<a name="l00399"></a>00399   <span class="keywordflow">return</span>;
<a name="l00400"></a>00400 }
<a name="l00401"></a>00401 
<a name="l00402"></a><a class="code" href="classMatrice__Dense.html#abd25bf4c555ad16b4f7c66cfbcc08331">00402</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Dense.html#abd25bf4c555ad16b4f7c66cfbcc08331">Matrice_Dense::multiplyToRight</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Dense.html">Matrice_Dense</a>&amp; B, <a class="code" href="classMatrice__Dense.html">Matrice_Dense</a>&amp; RES)<span class="keyword"> const</span>
<a name="l00403"></a>00403 <span class="keyword"></span>{
<a name="l00404"></a>00404 <span class="comment">// This method allows to perform the multiplication of two matrix.</span>
<a name="l00405"></a>00405 <span class="comment">// It is the &quot;right&quot; multiplication : (*this) * B = RES</span>
<a name="l00406"></a>00406 
<a name="l00407"></a>00407   assert(<a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>() == B.<a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>());
<a name="l00408"></a>00408   assert(<a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>() == RES.<a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>());
<a name="l00409"></a>00409   assert(B.<a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>() == RES.<a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>());
<a name="l00410"></a>00410 
<a name="l00411"></a>00411   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classMatrice__Dense.html#abb3b49deef58fa78fa7f53b2b5dd6841">nb_lignes</a>(); ++i)
<a name="l00412"></a>00412     {
<a name="l00413"></a>00413       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; B.<a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>(); ++j)
<a name="l00414"></a>00414         {
<a name="l00415"></a>00415           RES.<a class="code" href="classMatrice__Dense.html#a600a0641e619eed5269a9b9c245b440e">set_coefficient</a>(i, j, 0.0);
<a name="l00416"></a>00416           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classMatrice__Dense.html#aab6f0b645377ae46e6715a43cb8872ce">nb_colonnes</a>(); ++k)
<a name="l00417"></a>00417             {
<a name="l00418"></a>00418               RES.<a class="code" href="classMatrice__Dense.html#a600a0641e619eed5269a9b9c245b440e">set_coefficient</a>(i, j, RES(i, j) + <a class="code" href="classMatrice__Dense.html#af395aea6ffa6a083ba01d8a739eb4ad8">Matrix_</a>(i, k) * B(k, j));
<a name="l00419"></a>00419             }
<a name="l00420"></a>00420         }
<a name="l00421"></a>00421     }
<a name="l00422"></a>00422   <span class="keywordflow">return</span>;
<a name="l00423"></a>00423 }
<a name="l00424"></a>00424 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:22 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
