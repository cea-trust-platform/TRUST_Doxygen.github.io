<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/P1NCP1B/Champs/Champ_P1iP1B_implementation.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/P1NCP1B/Champs/Champ_P1iP1B_implementation.cpp</div>  </div>
</div>
<div class="contents">
<a href="Champ__P1iP1B__implementation_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Champ_P1iP1B_implementation.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/P1NCP1B/Champs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/40</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Champ__P1iP1B__implementation_8h.html">Champ_P1iP1B_implementation.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Champ__implementation__P1_8h.html">Champ_implementation_P1.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VEF__PreP1b_8h.html">Zone_VEF_PreP1b.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__VEFP1B_8h.html">Zone_Cl_VEFP1B.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="IntList_8h.html">IntList.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse__Sym_8h.html">Matrice_Morse_Sym.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="IntLists_8h.html">IntLists.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="DoubleLists_8h.html">DoubleLists.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="SolveurSys_8h.html">SolveurSys.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Solv__GCP_8h.html">Solv_GCP.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="SSOR_8h.html">SSOR.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="Check__espace__virtuel_8h.html">Check_espace_virtuel.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="Neumann__sortie__libre_8h.html">Neumann_sortie_libre.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="Champ__P0__VEF_8h.html">Champ_P0_VEF.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="ConstDoubleTab__parts_8h.html">ConstDoubleTab_parts.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="Frontiere__dis__base_8h.html">Frontiere_dis_base.h</a>&gt;</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classChamp__P1iP1B__implementation.html#a8fc63e434d55cfb8b56347bdfc90aa8b">Champ_P1iP1B_implementation::</a>
<a name="l00043"></a><a class="code" href="classChamp__P1iP1B__implementation.html#a8fc63e434d55cfb8b56347bdfc90aa8b">00043</a> <a class="code" href="classChamp__P1iP1B__implementation.html#a8fc63e434d55cfb8b56347bdfc90aa8b">valeur_a_elem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; position,
<a name="l00044"></a>00044               <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; val,
<a name="l00045"></a>00045               <span class="keywordtype">int</span> le_poly)<span class="keyword"> const</span>
<a name="l00046"></a>00046 <span class="keyword"></span>{
<a name="l00047"></a>00047   <span class="keywordtype">int</span> dimension=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00048"></a>00048   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vals(1,1);
<a name="l00049"></a>00049   <a class="code" href="classIntVect.html">IntVect</a> les_polys(1);
<a name="l00050"></a>00050   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> positions(1,dimension);
<a name="l00051"></a>00051 
<a name="l00052"></a>00052   les_polys(0) = le_poly;
<a name="l00053"></a>00053   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;dimension; i++)
<a name="l00054"></a>00054     positions(0,i) = position(i);
<a name="l00055"></a>00055 
<a name="l00056"></a>00056   <a class="code" href="classChamp__P1iP1B__implementation.html#ac7344e00a197a783b92f7f8ebef6921d">valeur_aux_elems</a>(positions, les_polys, vals);
<a name="l00057"></a>00057 
<a name="l00058"></a>00058   val(0) = vals(0,0);
<a name="l00059"></a>00059   <span class="keywordflow">return</span> val;
<a name="l00060"></a>00060 }
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="keywordtype">double</span> <a class="code" href="classChamp__P1iP1B__implementation.html#a9f191af637cb9cac4d2faf045abc3836">Champ_P1iP1B_implementation::</a>
<a name="l00063"></a><a class="code" href="classChamp__P1iP1B__implementation.html#a9f191af637cb9cac4d2faf045abc3836">00063</a> <a class="code" href="classChamp__P1iP1B__implementation.html#a9f191af637cb9cac4d2faf045abc3836">valeur_a_elem_compo</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; position,
<a name="l00064"></a>00064                     <span class="keywordtype">int</span> le_poly, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00065"></a>00065 <span class="keyword"></span>{
<a name="l00066"></a>00066   <span class="keywordtype">double</span> val=0;
<a name="l00067"></a>00067   <span class="keywordtype">int</span> dimension=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069   <a class="code" href="classDoubleVect.html">DoubleVect</a> vals(1);
<a name="l00070"></a>00070   <a class="code" href="classIntVect.html">IntVect</a> les_polys(1);
<a name="l00071"></a>00071   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> positions(1,dimension);
<a name="l00072"></a>00072 
<a name="l00073"></a>00073   les_polys(0) = le_poly;
<a name="l00074"></a>00074   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;dimension; i++)
<a name="l00075"></a>00075     positions(0,i) = position(i);
<a name="l00076"></a>00076 
<a name="l00077"></a>00077   <a class="code" href="classChamp__P1iP1B__implementation.html#a94ba951e946164544c98093a205fa161">valeur_aux_elems_compo</a>(positions, les_polys, vals, ncomp);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079   val = vals(0);
<a name="l00080"></a>00080 
<a name="l00081"></a>00081   <span class="keywordflow">return</span> val;
<a name="l00082"></a>00082 }
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="comment">// Recupere un tableau positions contenant des coordonnees de points</span>
<a name="l00085"></a>00085 <span class="comment">// contenus dans les elements ranges dans le tableau les_polys</span>
<a name="l00086"></a>00086 <span class="comment">// Renvoie le tableau val contenant les valeurs du champ aux points</span>
<a name="l00087"></a>00087 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__P1iP1B__implementation.html#ac7344e00a197a783b92f7f8ebef6921d">Champ_P1iP1B_implementation::</a>
<a name="l00088"></a><a class="code" href="classChamp__P1iP1B__implementation.html#ac7344e00a197a783b92f7f8ebef6921d">00088</a> <a class="code" href="classChamp__P1iP1B__implementation.html#ac7344e00a197a783b92f7f8ebef6921d">valeur_aux_elems</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions,
<a name="l00089"></a>00089                  <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; les_polys,
<a name="l00090"></a>00090                  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val)<span class="keyword"> const</span>
<a name="l00091"></a>00091 <span class="keyword"></span>{
<a name="l00092"></a>00092   <span class="keywordtype">int</span> som;
<a name="l00093"></a>00093   <span class="keywordtype">double</span> xs,ys,zs=0;
<a name="l00094"></a>00094 <span class="comment">// zs bien initialise en 3D</span>
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zvef = <a class="code" href="classChamp__P1iP1B__implementation.html#ad40a4e303d45f69df200378cc5d17251">zone_vef</a>();
<a name="l00097"></a>00097   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zvef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00098"></a>00098   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00099"></a>00099   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_poly = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00100"></a>00100   <span class="keywordtype">int</span> prs=zvef.<a class="code" href="classZone__VEF__PreP1b.html#ab469e7b0d67ddcc27e5cf16c3c85e8f4">numero_premier_sommet</a>();
<a name="l00101"></a>00101   <span class="keywordtype">int</span> nb_compo_=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>();
<a name="l00102"></a>00102   <span class="keywordtype">int</span> dimension=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00103"></a>00103   <span class="keyword">const</span> <span class="keywordtype">int</span> les_polys_size=les_polys.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>();
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="comment">// TODO : FIXME</span>
<a name="l00106"></a>00106 <span class="comment">// For FT the resize should be done in its good position and not here ...</span>
<a name="l00107"></a>00107   <span class="keywordflow">if</span> (val.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 1 ) val.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(les_polys_size,1);
<a name="l00108"></a>00108 
<a name="l00109"></a>00109   assert((val.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0) == les_polys.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>())||(val.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0) == les_polys.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>()));
<a name="l00110"></a>00110   assert(val.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>() == nb_compo_);
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 <span class="comment">// Filtrage du champ dans le tableau champ_filtre_</span>
<a name="l00113"></a>00113   <a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>=<a class="code" href="classChamp__P1iP1B__implementation.html#a0a7bce96d7fb122bf0da44aa824c0ee5" title="Methode pour filtrer le champ.">filtrage</a>(zvef,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="keywordflow">if</span> (nb_compo_ == 1)
<a name="l00116"></a>00116     {
<a name="l00117"></a>00117       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rang_poly=0; rang_poly&lt;les_polys_size; rang_poly++)
<a name="l00118"></a>00118         {
<a name="l00119"></a>00119 <span class="comment">// On initialise</span>
<a name="l00120"></a>00120           val(rang_poly,0) = 0.;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="comment">// On prend le_poly</span>
<a name="l00123"></a>00123           <span class="keywordtype">int</span> le_poly=les_polys(rang_poly);
<a name="l00124"></a>00124           <span class="keywordflow">if</span> (le_poly != -1)
<a name="l00125"></a>00125             {
<a name="l00126"></a>00126 <span class="comment">// Contribution P0</span>
<a name="l00127"></a>00127               <span class="keywordflow">if</span> (zvef.<a class="code" href="classZone__VEF__PreP1b.html#aee2def53aa92584d7945e7c3d0d98963">get_alphaE</a>())
<a name="l00128"></a>00128                 val(rang_poly,0) += <a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>(le_poly);
<a name="l00129"></a>00129 <span class="comment">// Contribution P1</span>
<a name="l00130"></a>00130               <span class="keywordflow">if</span> (zvef.<a class="code" href="classZone__VEF__PreP1b.html#ad7fbcb5567dcc2e6f0a0ed85ce90a4fa">get_alphaS</a>())
<a name="l00131"></a>00131                 {
<a name="l00132"></a>00132                   xs = positions(rang_poly,0);
<a name="l00133"></a>00133                   ys = positions(rang_poly,1);
<a name="l00134"></a>00134                   <span class="keywordflow">if</span> (dimension == 3)
<a name="l00135"></a>00135                     zs = positions(rang_poly,2);
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="comment">// Calcul par les fonctions de forme P1 du champ filtre</span>
<a name="l00138"></a>00138 <span class="comment">// au point (xs,yz,zs)</span>
<a name="l00139"></a>00139                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;dimension+1; i++)
<a name="l00140"></a>00140                     {
<a name="l00141"></a>00141                       som = prs+sommet_poly(le_poly,i);
<a name="l00142"></a>00142                       <span class="keywordtype">double</span> champ_filtre_som=<a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>(som);
<a name="l00143"></a>00143                       <span class="keywordtype">double</span> li=0.;
<a name="l00144"></a>00144 
<a name="l00145"></a>00145                       <span class="keywordflow">if</span> (dimension == 2)
<a name="l00146"></a>00146                         li=<a class="code" href="Champ__implementation__P1_8h.html#a9c0b4e243a99d689224836eaaa32ee61">coord_barycentrique_P1_triangle</a>(sommet_poly,
<a name="l00147"></a>00147                                                            coord, xs, ys,
<a name="l00148"></a>00148                                                            le_poly, i);
<a name="l00149"></a>00149                       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dimension == 3)
<a name="l00150"></a>00150                         li=<a class="code" href="Champ__implementation__P1_8h.html#ab40ad27af50075ee8b2c9d9e9f786357">coord_barycentrique_P1_tetraedre</a>(sommet_poly,
<a name="l00151"></a>00151                                                             coord, xs, ys, zs,
<a name="l00152"></a>00152                                                             le_poly, i);
<a name="l00153"></a>00153                       val(rang_poly,0) += champ_filtre_som * li;
<a name="l00154"></a>00154                     }
<a name="l00155"></a>00155                 }
<a name="l00156"></a>00156             }
<a name="l00157"></a>00157         }
<a name="l00158"></a>00158     }
<a name="l00159"></a>00159   <span class="keywordflow">else</span> <span class="comment">//!&lt; nb_compo_ &gt; 1</span>
<a name="l00160"></a>00160 <span class="comment"></span>    {
<a name="l00161"></a>00161       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Vous en etes deja la vous ?&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00162"></a>00162       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164   <span class="keywordflow">return</span> val;
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 <span class="comment">// Idem que valeur_aux_elems mais pour une composante d&#39;un champ vecteur</span>
<a name="l00168"></a>00168 <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classChamp__P1iP1B__implementation.html#a94ba951e946164544c98093a205fa161">Champ_P1iP1B_implementation::</a>
<a name="l00169"></a><a class="code" href="classChamp__P1iP1B__implementation.html#a94ba951e946164544c98093a205fa161">00169</a> <a class="code" href="classChamp__P1iP1B__implementation.html#a94ba951e946164544c98093a205fa161">valeur_aux_elems_compo</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions,
<a name="l00170"></a>00170                        <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; les_polys,
<a name="l00171"></a>00171                        <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; val,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00172"></a>00172 <span class="keyword"></span>{
<a name="l00173"></a>00173   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Champ_P1iP1B_implementation::valeur_aux_elems_compo non code.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00174"></a>00174 <span class="comment">// Factoriser le code avec la methode valeur_aux_elems()</span>
<a name="l00175"></a>00175   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00176"></a>00176   <span class="keywordflow">return</span> val;
<a name="l00177"></a>00177 }
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 
<a name="l00180"></a>00180 <span class="comment">// Recupere un domaine</span>
<a name="l00181"></a>00181 <span class="comment">// Renvoie un tableau contenant les valeurs du champ aux sommets du domaine</span>
<a name="l00182"></a>00182 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__P1iP1B__implementation.html#ad8700b5f9840db302877486c3135a709">Champ_P1iP1B_implementation::</a>
<a name="l00183"></a><a class="code" href="classChamp__P1iP1B__implementation.html#ad8700b5f9840db302877486c3135a709">00183</a> <a class="code" href="classChamp__P1iP1B__implementation.html#ad8700b5f9840db302877486c3135a709">valeur_aux_sommets</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,
<a name="l00184"></a>00184                    <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val)<span class="keyword"> const</span>
<a name="l00185"></a>00185 <span class="keyword"></span>{
<a name="l00186"></a>00186   <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zvef = <a class="code" href="classChamp__P1iP1B__implementation.html#ad40a4e303d45f69df200378cc5d17251">zone_vef</a>();
<a name="l00187"></a>00187   <span class="keywordtype">int</span> nb_compo_=<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>().<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>();
<a name="l00188"></a>00188   assert(nb_compo_ == val.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>());
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 <span class="comment">// Filtrage du champ pour le postraitement (contenu dans le tableau champ_filtre_)</span>
<a name="l00191"></a>00191   <a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>=<a class="code" href="classChamp__P1iP1B__implementation.html#a0a7bce96d7fb122bf0da44aa824c0ee5" title="Methode pour filtrer le champ.">filtrage</a>(zvef,<a class="code" href="classChamp__implementation.html#acef977877647c519ea01aa4b19ba6613">le_champ</a>());
<a name="l00192"></a>00192 
<a name="l00193"></a>00193   <span class="keywordflow">if</span> (zvef.<a class="code" href="classZone__VEF__PreP1b.html#aee2def53aa92584d7945e7c3d0d98963">get_alphaE</a>()) <span class="comment">//!&lt; Support P0</span>
<a name="l00194"></a>00194 <span class="comment"></span>    {
<a name="l00195"></a>00195       <a class="code" href="classChamp__P0__VEF.html" title="classe Champ_P0_VEF Classe qui represente un champ discret P0 par element associe a une zone discreti...">Champ_P0_VEF</a> tmp;
<a name="l00196"></a>00196       tmp.<a class="code" href="classChamp__P0__VEF.html#aa8e06b7cb67bc3b54f509cca0cda1d41">associer_zone_dis_base</a>(zvef);
<a name="l00197"></a>00197       tmp.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>() = <a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>;
<a name="l00198"></a>00198       tmp.<a class="code" href="classChamp__Inc__P0__base.html#a7dcb0616e9ce44a990262ef82efa42f1">valeur_aux_sommets</a>(zvef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>(), val);
<a name="l00199"></a>00199     }
<a name="l00200"></a>00200 
<a name="l00201"></a>00201   <span class="keywordflow">if</span> (zvef.<a class="code" href="classZone__VEF__PreP1b.html#ad7fbcb5567dcc2e6f0a0ed85ce90a4fa">get_alphaS</a>()) <span class="comment">//!&lt; Support P1</span>
<a name="l00202"></a>00202 <span class="comment"></span>    {
<a name="l00203"></a>00203       <span class="keywordtype">int</span> nbs=zvef.<a class="code" href="classZone__VEF__PreP1b.html#a7fa6f80d06f2f6d193e9311abc68412c">nb_som</a>();
<a name="l00204"></a>00204       <span class="keywordtype">int</span> prs=zvef.<a class="code" href="classZone__VEF__PreP1b.html#ab469e7b0d67ddcc27e5cf16c3c85e8f4">numero_premier_sommet</a>();
<a name="l00205"></a>00205       <span class="keywordflow">if</span> (nb_compo_ == 1)
<a name="l00206"></a>00206         {
<a name="l00207"></a>00207           <span class="keywordtype">int</span> som,num_som;
<a name="l00208"></a>00208           <span class="keywordflow">for</span> (num_som = 0; num_som&lt;nbs; num_som++)
<a name="l00209"></a>00209             {
<a name="l00210"></a>00210               som = prs+num_som;
<a name="l00211"></a>00211               val(num_som,0) += <a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>(som);
<a name="l00212"></a>00212             }
<a name="l00213"></a>00213         }
<a name="l00214"></a>00214       <span class="keywordflow">else</span> <span class="comment">//!&lt; nb_compo_ &gt; 1</span>
<a name="l00215"></a>00215 <span class="comment"></span>        {
<a name="l00216"></a>00216           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Vous en etes deja la vous ?&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00217"></a>00217           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00218"></a>00218         }
<a name="l00219"></a>00219     }
<a name="l00220"></a>00220   <span class="keywordflow">return</span> val;
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 <span class="comment">// </span>
<a name="l00225"></a>00225 <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classChamp__P1iP1B__implementation.html#a8e8ac0ede83dfda2516ecc0698e5ad6b">Champ_P1iP1B_implementation::</a>
<a name="l00226"></a><a class="code" href="classChamp__P1iP1B__implementation.html#a8e8ac0ede83dfda2516ecc0698e5ad6b">00226</a> <a class="code" href="classChamp__P1iP1B__implementation.html#a8e8ac0ede83dfda2516ecc0698e5ad6b">valeur_aux_sommets_compo</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,
<a name="l00227"></a>00227                          <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; val,
<a name="l00228"></a>00228                          <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00229"></a>00229 <span class="keyword"></span>{
<a name="l00230"></a>00230   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Champ_P1iP1B_implementation::valeur_aux_sommets_compo pas code.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00231"></a>00231 <span class="comment">// Factoriser avec la methode valeur_aux_sommets()</span>
<a name="l00232"></a>00232   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00233"></a>00233   <span class="keywordflow">return</span> val;
<a name="l00234"></a>00234 }
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__P1iP1B__implementation.html#acc0ea501bd27618965e89ee1568d5e68">Champ_P1iP1B_implementation::</a>
<a name="l00237"></a><a class="code" href="classChamp__P1iP1B__implementation.html#acc0ea501bd27618965e89ee1568d5e68">00237</a> <a class="code" href="classChamp__P1iP1B__implementation.html#acc0ea501bd27618965e89ee1568d5e68">remplir_coord_noeuds</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord)<span class="keyword"> const</span>
<a name="l00238"></a>00238 <span class="keyword"></span>{
<a name="l00239"></a>00239   <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zvef=<a class="code" href="classChamp__P1iP1B__implementation.html#ad40a4e303d45f69df200378cc5d17251">zone_vef</a>();
<a name="l00240"></a>00240   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; la_zone=zvef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00241"></a>00241   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=la_zone.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00242"></a>00242   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord_sommets=dom.<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00243"></a>00243   <span class="keywordtype">int</span> nbe=zvef.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
<a name="l00244"></a>00244   <span class="keywordtype">int</span> nbs=zvef.<a class="code" href="classZone__dis__base.html#a8f793341b7a41d67561ba563ae0f69a0">nb_som_tot</a>();
<a name="l00245"></a>00245   <span class="keywordtype">int</span> pre=zvef.<a class="code" href="classZone__VEF__PreP1b.html#a8bd98d63db7eb79a014f27b7d3d3b52d">numero_premier_element</a>();
<a name="l00246"></a>00246   <span class="keywordtype">int</span> prs=zvef.<a class="code" href="classZone__VEF__PreP1b.html#ab469e7b0d67ddcc27e5cf16c3c85e8f4">numero_premier_sommet</a>();
<a name="l00247"></a>00247   <span class="keywordtype">int</span> dimension=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00248"></a>00248 
<a name="l00249"></a>00249   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xg = zvef.<a class="code" href="classZone__VF.html#a87a29f0223c71256a25ee343c9277599">xp</a>();
<a name="l00250"></a>00250 
<a name="l00251"></a>00251   <span class="keywordtype">int</span> k=pre;
<a name="l00252"></a>00252   coord.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nbe+nbs,dimension);
<a name="l00253"></a>00253   {
<a name="l00254"></a>00254     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nbe; i++)
<a name="l00255"></a>00255       {
<a name="l00256"></a>00256         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;dimension; j++)
<a name="l00257"></a>00257           coord(k,j)=xg(i,j);
<a name="l00258"></a>00258         k++;
<a name="l00259"></a>00259       }
<a name="l00260"></a>00260   }
<a name="l00261"></a>00261   k=prs;
<a name="l00262"></a>00262   {
<a name="l00263"></a>00263     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nbs; i++)
<a name="l00264"></a>00264       {
<a name="l00265"></a>00265         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;dimension; j++)
<a name="l00266"></a>00266           coord(k,j)=coord_sommets(i,j);
<a name="l00267"></a>00267         k++;
<a name="l00268"></a>00268       }
<a name="l00269"></a>00269   }
<a name="l00270"></a>00270   <span class="keywordflow">return</span> coord;
<a name="l00271"></a>00271 }
<a name="l00272"></a>00272 
<a name="l00273"></a>00273 <span class="keywordtype">int</span> <a class="code" href="classChamp__P1iP1B__implementation.html#a5fcc197029adf09d4819b1113d24530c">Champ_P1iP1B_implementation::</a>
<a name="l00274"></a><a class="code" href="classChamp__P1iP1B__implementation.html#a5fcc197029adf09d4819b1113d24530c">00274</a> <a class="code" href="classChamp__P1iP1B__implementation.html#a5fcc197029adf09d4819b1113d24530c">remplir_coord_noeuds_et_polys</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions,
<a name="l00275"></a>00275                               <a class="code" href="classIntVect.html">IntVect</a>&amp; polys)<span class="keyword"> const</span>
<a name="l00276"></a>00276 <span class="keyword"></span>{
<a name="l00277"></a>00277   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Pas code &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00278"></a>00278   assert(0);
<a name="l00279"></a>00279   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00280"></a>00280   <span class="keywordflow">return</span> 1;
<a name="l00281"></a>00281 }
<a name="l00282"></a>00282 
<a name="l00283"></a><a class="code" href="Champ__P1iP1B__implementation_8cpp.html#a66b05ebb3893c77d400802a0828ab94d">00283</a> <span class="keywordtype">void</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#a66b05ebb3893c77d400802a0828ab94d">assembler</a>(<span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_VEF, <a class="code" href="classMatrice.html">Matrice</a>&amp; matrice)
<a name="l00284"></a>00284 {
<a name="l00285"></a>00285   matrice.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Matrice_Morse_Sym&quot;</span>);
<a name="l00286"></a>00286   <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; MatPoisson=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, matrice.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l00287"></a>00287   <span class="keywordtype">int</span> nb_som_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
<a name="l00288"></a>00288   <span class="keywordtype">int</span> nb_arete_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a59ae0ababf85ce303a7c6f339430e335" title="renvoie le nombre d&#39;aretes total (reelles+virtuelles).">nb_aretes_tot</a>();
<a name="l00289"></a>00289   <span class="keywordtype">int</span> nnz=nb_som_tot+nb_arete_tot;
<a name="l00290"></a>00290   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; aretes_som=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#affa60690e1b372fa4c01d6088267dbe4" title="renvoie le tableau de connectivite aretes/sommets.">aretes_som</a>();
<a name="l00291"></a>00291   <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; renum_arete_perio=zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a43767f8684512d1ee950dc07eea76c5b">get_renum_arete_perio</a>();
<a name="l00292"></a>00292   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00293"></a>00293 
<a name="l00294"></a>00294   <a class="code" href="classIntLists.html" title="Un tableau de listes de type IntList.">IntLists</a> voisins(nb_som_tot);
<a name="l00295"></a>00295   <a class="code" href="classDoubleLists.html" title="Un tableau de listes de type DoubleList.">DoubleLists</a> coeffs(nb_som_tot);
<a name="l00296"></a>00296   <a class="code" href="classDoubleVect.html">DoubleVect</a> diag(nb_som_tot);
<a name="l00297"></a>00297 <span class="comment">// On parcourt toutes les aretes non periodiques:</span>
<a name="l00298"></a>00298   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> arete=0; arete&lt;nb_arete_tot; arete++)
<a name="l00299"></a>00299     {
<a name="l00300"></a>00300       <span class="keywordflow">if</span> (renum_arete_perio(arete)==arete)
<a name="l00301"></a>00301         {
<a name="l00302"></a>00302           <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(aretes_som(arete, 0));
<a name="l00303"></a>00303           <span class="keywordtype">int</span> som2=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(aretes_som(arete, 1));
<a name="l00304"></a>00304           <span class="keywordflow">if</span>(som1&gt;som2)
<a name="l00305"></a>00305             {
<a name="l00306"></a>00306               <span class="keywordtype">int</span> tmp=som1;
<a name="l00307"></a>00307               som1=som2;
<a name="l00308"></a>00308               som2=tmp;
<a name="l00309"></a>00309             }
<a name="l00310"></a>00310           voisins[som1].add(som2);
<a name="l00311"></a>00311           coeffs[som1].add(1);
<a name="l00312"></a>00312           diag(som1)++;
<a name="l00313"></a>00313           diag(som2)++;
<a name="l00314"></a>00314         }
<a name="l00315"></a>00315     }
<a name="l00316"></a>00316   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som_tot; i++)
<a name="l00317"></a>00317     {
<a name="l00318"></a>00318       <span class="keywordflow">if</span> (diag(i)==0)
<a name="l00319"></a>00319         {
<a name="l00320"></a>00320           assert(i!=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(i));
<a name="l00321"></a>00321           diag(i)=1; <span class="comment">//!&lt; Sommets periodiques</span>
<a name="l00322"></a>00322 <span class="comment"></span>        }
<a name="l00323"></a>00323     }
<a name="l00324"></a>00324   MatPoisson.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nb_som_tot, nnz) ;
<a name="l00325"></a>00325   MatPoisson.<a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">remplir</a>(voisins, coeffs, diag) ;
<a name="l00326"></a>00326   MatPoisson.<a class="code" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69" title="Suppression des doublons on ordonne tab2; Verification de la diagonale: tous ses elements doivent etr...">compacte</a>() ;
<a name="l00327"></a>00327   MatPoisson.<a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(1);
<a name="l00328"></a>00328 <span class="comment">// Cerr &lt;&lt; &quot;Matrice P1&quot;;MatPoisson.imprimer(Cerr);</span>
<a name="l00329"></a>00329 }
<a name="l00330"></a>00330 
<a name="l00331"></a><a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">00331</a> <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>=4./5.;
<a name="l00332"></a><a class="code" href="Champ__P1iP1B__implementation_8cpp.html#a7de7465587c2da590f1ebee99ccb19d5">00332</a> <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#a7de7465587c2da590f1ebee99ccb19d5">coeff_inv</a>=1/<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
<a name="l00333"></a><a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aab7dbd110ac0ba30b0495bdf088e3fc4">00333</a> <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aab7dbd110ac0ba30b0495bdf088e3fc4">second_membre</a>(<span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_VEF, <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; Pa, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; secmem)
<a name="l00334"></a>00334 {
<a name="l00335"></a>00335   <span class="keywordtype">int</span> nb_arete_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a59ae0ababf85ce303a7c6f339430e335" title="renvoie le nombre d&#39;aretes total (reelles+virtuelles).">nb_aretes_tot</a>();
<a name="l00336"></a>00336   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; aretes_som=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#affa60690e1b372fa4c01d6088267dbe4" title="renvoie le tableau de connectivite aretes/sommets.">aretes_som</a>();
<a name="l00337"></a>00337   <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; renum_arete_perio=zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a43767f8684512d1ee950dc07eea76c5b">get_renum_arete_perio</a>();
<a name="l00338"></a>00338   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00339"></a>00339   secmem=0;
<a name="l00340"></a>00340 <span class="comment">// On parcourt toutes les aretes non periodiques</span>
<a name="l00341"></a>00341   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> arete=0; arete&lt;nb_arete_tot; arete++)
<a name="l00342"></a>00342     {
<a name="l00343"></a>00343       <span class="keywordflow">if</span> (renum_arete_perio(arete)==arete)
<a name="l00344"></a>00344         {
<a name="l00345"></a>00345           <span class="keywordtype">double</span> x=Pa(arete);
<a name="l00346"></a>00346           <span class="keywordtype">int</span> som1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(aretes_som(arete, 0));
<a name="l00347"></a>00347           <span class="keywordtype">int</span> som2=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(aretes_som(arete, 1));
<a name="l00348"></a>00348           secmem(som1)+=x;
<a name="l00349"></a>00349           secmem(som2)+=x;
<a name="l00350"></a>00350         }
<a name="l00351"></a>00351     }
<a name="l00352"></a>00352   secmem*=<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
<a name="l00353"></a>00353   secmem.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00354"></a>00354   <span class="keywordtype">double</span> <a class="code" href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a>=<a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(secmem);
<a name="l00355"></a>00355 <span class="comment">// Cerr &lt;&lt; &quot;||somme Pa||= &quot; &lt;&lt; norme &lt;&lt; finl;</span>
<a name="l00356"></a>00356   <span class="keywordflow">return</span> <a class="code" href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a>;
<a name="l00357"></a>00357 }
<a name="l00358"></a>00358 
<a name="l00359"></a><a class="code" href="Champ__P1iP1B__implementation_8cpp.html#a4bfcde3dfa87014cb9762f50e572f2d3">00359</a> <span class="keywordtype">void</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#a4bfcde3dfa87014cb9762f50e572f2d3">corriger</a>(<span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_VEF, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; champ_filtre_, <a class="code" href="classMatrice.html">Matrice</a>&amp; matrice, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; Condition_Neumann_imposee_)
<a name="l00360"></a>00360 {
<a name="l00361"></a>00361   <span class="keywordtype">int</span> nb_elem=zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a9178667a73115864c83558530b401e9d">nb_elem</a>();
<a name="l00362"></a>00362   <span class="keywordtype">int</span> nb_som=zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a7fa6f80d06f2f6d193e9311abc68412c">nb_som</a>();
<a name="l00363"></a>00363 
<a name="l00364"></a>00364 <span class="comment">// Tableaux d&#39;acces aux valeurs Pk et Ps</span>
<a name="l00365"></a>00365   <span class="keywordflow">if</span> (!zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#aee2def53aa92584d7945e7c3d0d98963">get_alphaE</a>() || !zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#ad7fbcb5567dcc2e6f0a0ed85ce90a4fa">get_alphaS</a>())
<a name="l00366"></a>00366     {
<a name="l00367"></a>00367       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans Champ_P1iP1B_impl.cpp: corriger(...), le champ doit avoir une partie sommets et elements&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00368"></a>00368       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00369"></a>00369     }
<a name="l00370"></a>00370   <a class="code" href="classDoubleTab__parts.html">DoubleTab_parts</a> parties_P(champ_filtre_);
<a name="l00371"></a>00371   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; Pk = parties_P[0];  <span class="comment">//!&lt; partie elements</span>
<a name="l00372"></a>00372 <span class="comment"></span>  <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; Ps = parties_P[1];  <span class="comment">//!&lt; partie sommets</span>
<a name="l00373"></a>00373 <span class="comment"></span>
<a name="l00374"></a>00374 <span class="comment">// Filtrage si support arete</span>
<a name="l00375"></a>00375   <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a9d02e2431efb6e75c3d733ff06f89549">get_alphaA</a>())
<a name="l00376"></a>00376     {
<a name="l00377"></a>00377       <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a43767f8684512d1ee950dc07eea76c5b">get_renum_arete_perio</a>().<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()==0)
<a name="l00378"></a>00378         {
<a name="l00379"></a>00379           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;We try to Champ_P1iP1B_impl::corriger but get_renum_arete_perio&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00380"></a>00380         }
<a name="l00381"></a>00381     }
<a name="l00382"></a>00382   <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a9d02e2431efb6e75c3d733ff06f89549">get_alphaA</a>()&amp;&amp; zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a43767f8684512d1ee950dc07eea76c5b">get_renum_arete_perio</a>().<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>())
<a name="l00383"></a>00383     {
<a name="l00384"></a>00384       <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; Pa = parties_P[2];  <span class="comment">//!&lt; partie aretes</span>
<a name="l00385"></a>00385 <span class="comment"></span>
<a name="l00386"></a>00386 <span class="comment">// Si premier passage on assemble la matrice</span>
<a name="l00387"></a>00387       <span class="keywordflow">if</span> (!matrice.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>()) <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#a66b05ebb3893c77d400802a0828ab94d">assembler</a>(zone_VEF, matrice);
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 <span class="comment">// Construction du second membre</span>
<a name="l00390"></a>00390       <a class="code" href="classDoubleVect.html">DoubleVect</a> secmem;
<a name="l00391"></a>00391       zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a32c7de9f9e8e78e3d5ea68715b2ceb2b" title="Cree un tableau ayant une &quot;ligne&quot; par sommet du maillage. Voir MD_Vector_tools::creer_tableau_distrib...">creer_tableau_sommets</a>(secmem);
<a name="l00392"></a>00392       <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aab7dbd110ac0ba30b0495bdf088e3fc4">second_membre</a>(zone_VEF, Pa, secmem);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394 <span class="comment">// Calcul de la correction</span>
<a name="l00395"></a>00395       <a class="code" href="classDoubleVect.html">DoubleVect</a> solution;
<a name="l00396"></a>00396       solution.<a class="code" href="classDoubleVect.html#aaccfc72d49151e3105aba476fa9f414b" title="copie de la structure et des valeurs (si opt==COPY_INIT) du tableau v. Attention, v doit vraiment etr...">copy</a>(secmem, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">ArrOfDouble::NOCOPY_NOINIT</a>); <span class="comment">//!&lt; Copie de la structure</span>
<a name="l00397"></a>00397 <span class="comment"></span>      solution = 0.;
<a name="l00398"></a>00398 
<a name="l00399"></a>00399       <a class="code" href="classSolveurSys.html">SolveurSys</a> solveur;
<a name="l00400"></a>00400       solveur.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Solv_GCP&quot;</span>);
<a name="l00401"></a>00401       <a class="code" href="classPrecond.html">Precond</a> p;
<a name="l00402"></a>00402       p.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;SSOR&quot;</span>);
<a name="l00403"></a>00403       <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSolv__GCP.html">Solv_GCP</a>,solveur.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>()).set_precond(p);
<a name="l00404"></a>00404       solveur.<a class="code" href="classSolveurSys.html#a17fa90c93f514a6d2a898e682e724d3b" title="Donne un nom a l&#39;Objet_U Methode virtuelle a surcharger.">nommer</a>(<span class="stringliteral">&quot;Pa_filter_solver&quot;</span>);
<a name="l00405"></a>00405       solveur.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(matrice, secmem, solution);
<a name="l00406"></a>00406 
<a name="l00407"></a>00407 <span class="comment">// Application de la periodicite sur la solution:</span>
<a name="l00408"></a>00408       <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00409"></a>00409       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_som; i++)
<a name="l00410"></a>00410         {
<a name="l00411"></a>00411           <span class="keywordtype">int</span> som=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(i);
<a name="l00412"></a>00412           <span class="keywordflow">if</span> (som!=i)
<a name="l00413"></a>00413             solution(i)=solution(som);
<a name="l00414"></a>00414         }
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 <span class="comment">// Correction de Ps:</span>
<a name="l00417"></a>00417       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> som=0; som&lt;nb_som; som++)
<a name="l00418"></a>00418         Ps(som) += solution(som);
<a name="l00419"></a>00419 
<a name="l00420"></a>00420 <span class="comment">// Correction de Pa:</span>
<a name="l00421"></a>00421       <span class="keywordtype">int</span> nb_arete = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a3e3b48691911fd85574c7bc10a1a4fb8" title="renvoie le nombre d&#39;aretes reelles.">nb_aretes</a>();
<a name="l00422"></a>00422       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; aretes_som=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#affa60690e1b372fa4c01d6088267dbe4" title="renvoie le tableau de connectivite aretes/sommets.">aretes_som</a>();
<a name="l00423"></a>00423       <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; ok_arete=zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a83771f784d487e346b2ef22a389472a2">get_ok_arete</a>();
<a name="l00424"></a>00424       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> arete=0; arete&lt;nb_arete; arete++)
<a name="l00425"></a>00425         {
<a name="l00426"></a>00426           <span class="keywordflow">if</span>(!ok_arete(arete) &amp;&amp; Pa(arete)!=0)
<a name="l00427"></a>00427             {
<a name="l00428"></a>00428               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Pa(arete_superflue)!=0 dans Champ_P1iP1B_implementation::corriger&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00429"></a>00429               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Contacter le support TRUST.&quot;</span> &lt;&lt; finl;
<a name="l00430"></a>00430               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;S&#39;il s&#39;agit d&#39;une reprise au format xyz d&#39;un calcul&quot;</span> &lt;&lt; finl;
<a name="l00431"></a>00431               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;alors il faut ecraser le fichier .ok_arete de votre calcul de reprise&quot;</span> &lt;&lt; finl;
<a name="l00432"></a>00432               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;par le fichier .ok_arete de votre calcul precedant afin d&#39;avoir les&quot;</span> &lt;&lt; finl;
<a name="l00433"></a>00433               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;memes aretes superflues.&quot;</span> &lt;&lt; finl;
<a name="l00434"></a>00434               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00435"></a>00435             }
<a name="l00436"></a>00436           <span class="keywordtype">int</span> som1=aretes_som(arete, 0);
<a name="l00437"></a>00437           <span class="keywordtype">int</span> som2=aretes_som(arete, 1);
<a name="l00438"></a>00438           <span class="keywordtype">double</span> sigma=solution(som1)+solution(som2);
<a name="l00439"></a>00439           Pa(arete)-=sigma*<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#a7de7465587c2da590f1ebee99ccb19d5">coeff_inv</a>;
<a name="l00440"></a>00440         }
<a name="l00441"></a>00441 
<a name="l00442"></a>00442 <span class="comment">// Correction de Pk:</span>
<a name="l00443"></a>00443       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; les_elems = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00444"></a>00444       <span class="keywordtype">int</span> nb_som_par_elem=les_elems.<a class="code" href="classIntTab.html#a71e9b9ddc1793094b1b3f109377952b1" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(1);
<a name="l00445"></a>00445       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem; elem++)
<a name="l00446"></a>00446         {
<a name="l00447"></a>00447           <span class="keywordtype">double</span> sigma=0;
<a name="l00448"></a>00448           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> som=0; som&lt;nb_som_par_elem; som++)
<a name="l00449"></a>00449             sigma+=solution(les_elems(elem,som));
<a name="l00450"></a>00450           Pk(elem)-=sigma/4;
<a name="l00451"></a>00451         }
<a name="l00452"></a>00452     }
<a name="l00453"></a>00453 
<a name="l00454"></a>00454 <span class="comment">// Filtrage L2:</span>
<a name="l00455"></a>00455   <span class="keywordtype">double</span> moyenne_K = <a class="code" href="DoubleVect_8cpp.html#a71135d1749309bf589342004b76df614">mp_moyenne_vect</a>(Pk);                <span class="comment">//!&lt; Calcul de la moyenne du champ aux elements</span>
<a name="l00456"></a>00456 <span class="comment"></span>  Pk -= moyenne_K;                                 <span class="comment">//!&lt; Correction des elements du champ_filtre_</span>
<a name="l00457"></a>00457 <span class="comment"></span>  Ps += moyenne_K;                                 <span class="comment">//!&lt; Correction des sommets du champ_filtre_</span>
<a name="l00458"></a>00458 <span class="comment"></span>
<a name="l00459"></a>00459 <span class="comment">// On retranche a Ps sa moyenne si pas de Cl de Neumann pour avoir une moyenne nulle</span>
<a name="l00460"></a>00460 <span class="comment">// Il faudrait peut etre mieux faire cela dans Assembleur_P_VEFPreP1B::modifier_solution</span>
<a name="l00461"></a>00461 <span class="comment">// si cela est possible...</span>
<a name="l00462"></a>00462   assert(Condition_Neumann_imposee_!=-1);
<a name="l00463"></a>00463 
<a name="l00464"></a>00464   <span class="keywordflow">if</span> (!Condition_Neumann_imposee_)
<a name="l00465"></a>00465     {
<a name="l00466"></a>00466 <span class="comment">// L&#39;espace virtuel de Ps n&#39;a pas besoin d&#39;etre a jour pour calculer correctement la moyenne</span>
<a name="l00467"></a>00467       Ps -= <a class="code" href="DoubleVect_8cpp.html#a71135d1749309bf589342004b76df614">mp_moyenne_vect</a>(Ps); <span class="comment">//!&lt; Correction des sommets du champ_filtre_</span>
<a name="l00468"></a>00468 <span class="comment"></span>    }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470   champ_filtre_.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();         <span class="comment">//!&lt; Mise a jour des espaces virtuels</span>
<a name="l00471"></a>00471 <span class="comment"></span>}
<a name="l00472"></a>00472 
<a name="l00473"></a><a class="code" href="classChamp__P1iP1B__implementation.html#a0a7bce96d7fb122bf0da44aa824c0ee5">00473</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__P1iP1B__implementation.html#a0a7bce96d7fb122bf0da44aa824c0ee5" title="Methode pour filtrer le champ.">Champ_P1iP1B_implementation::filtrage</a>(<span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zvef, <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; un_champ)<span class="keyword"> const</span>
<a name="l00474"></a>00474 <span class="keyword"></span>{
<a name="l00475"></a>00475 <span class="comment">// Filtrage si supports element et sommet presents au moins</span>
<a name="l00476"></a>00476   <span class="keywordflow">if</span> (zvef.<a class="code" href="classZone__VEF__PreP1b.html#aee2def53aa92584d7945e7c3d0d98963">get_alphaE</a>() &amp;&amp; zvef.<a class="code" href="classZone__VEF__PreP1b.html#ad7fbcb5567dcc2e6f0a0ed85ce90a4fa">get_alphaS</a>())
<a name="l00477"></a>00477     {
<a name="l00478"></a>00478 <span class="comment">// Pas de filtrage si deja fait sur ce champ:</span>
<a name="l00479"></a>00479       <span class="keywordflow">if</span> (un_champ.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>().<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>()==<a class="code" href="classChamp__P1iP1B__implementation.html#a8cd5bd7cd354de42ff48a75339ae712e" title="Adresse du champ filtre (va servir a ne pas refiltrer inutilement)">adresse_champ_filtre_</a> &amp;&amp; un_champ.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()==<a class="code" href="classChamp__P1iP1B__implementation.html#a5b4e75a52a53b9700079be8da55ea406" title="Temps du dernier filtrage (va servir a ne pas refiltrer inutilement)">temps_filtrage_</a>)
<a name="l00480"></a>00480         <span class="keywordflow">return</span> <a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>;
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 <span class="comment">// On copie le champ a filtrer dans le tableau qui contiendra le champ filtre</span>
<a name="l00483"></a>00483       <a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>=un_champ.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l00484"></a>00484       <a class="code" href="classChamp__P1iP1B__implementation.html#a5b4e75a52a53b9700079be8da55ea406" title="Temps du dernier filtrage (va servir a ne pas refiltrer inutilement)">temps_filtrage_</a>=un_champ.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>();
<a name="l00485"></a>00485       <a class="code" href="classChamp__P1iP1B__implementation.html#a8cd5bd7cd354de42ff48a75339ae712e" title="Adresse du champ filtre (va servir a ne pas refiltrer inutilement)">adresse_champ_filtre_</a>=un_champ.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>().<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00486"></a>00486 <span class="comment">// Cout &lt;&lt; &quot;Filtrage du champ &quot; &lt;&lt; un_champ.le_nom() &lt;&lt; &quot; au temps &quot; &lt;&lt; un_champ.temps() &lt;&lt; finl;</span>
<a name="l00487"></a>00487 
<a name="l00488"></a>00488 <span class="comment">// Correction du champ</span>
<a name="l00489"></a>00489       <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#a4bfcde3dfa87014cb9762f50e572f2d3">corriger</a>(zvef, <a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>, <a class="code" href="classChamp__P1iP1B__implementation.html#a138a29f6c0ff114621fce5e102733ca1" title="Contient la matrice necessaire au filtrage (evite d&#39;avoir a la recalculer)">matrice_filtrage_</a>, <a class="code" href="classChamp__P1iP1B__implementation.html#aee9f9b7409940ee4d50c7e2b4f695af8" title="Drapeau pour savoir s&#39;il y&#39;a des CL de Neumann (influe sur le filtrage)">Condition_Neumann_imposee_</a>);
<a name="l00490"></a>00490       <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;champ apres filtre=&quot;</span>, <a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>);
<a name="l00491"></a>00491       <span class="keywordflow">return</span> <a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>;
<a name="l00492"></a>00492     }
<a name="l00493"></a>00493   <span class="keywordflow">else</span>
<a name="l00494"></a>00494     {
<a name="l00495"></a>00495       <a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>=un_champ.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l00496"></a>00496       <span class="keywordflow">return</span> <a class="code" href="classChamp__P1iP1B__implementation.html#a4b8438bf00892a60e3098bbca4ccefde" title="Contient les valeurs du champ filtre.">champ_filtre_</a>;
<a name="l00497"></a>00497     }
<a name="l00498"></a>00498 }
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 <span class="comment">// Fixe Condition_Neumann_imposee_ a 1 si il existe une CL de Neumann 0 sinon</span>
<a name="l00501"></a>00501 <span class="comment">// Si pas de condition de Neumann, on imposera une moyenne nulle dans le filtrage du champ</span>
<a name="l00502"></a>00502 <span class="comment">// pour avoir le meme champ en sequentiel et en parallele</span>
<a name="l00503"></a><a class="code" href="classChamp__P1iP1B__implementation.html#a91c60cdb16486cb664604c2ba7d874d0">00503</a> <span class="keywordtype">void</span> <a class="code" href="classChamp__P1iP1B__implementation.html#a91c60cdb16486cb664604c2ba7d874d0">Champ_P1iP1B_implementation::completer</a>(<span class="keyword">const</span> <a class="code" href="classZone__Cl__dis__base.html" title="classe Zone_Cl_dis_base Les objets Zone_Cl_dis_base representent les conditions aux limites discretis...">Zone_Cl_dis_base</a>&amp; zcl)
<a name="l00504"></a>00504 {
<a name="l00505"></a>00505   <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; les_cl = zcl.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>();
<a name="l00506"></a>00506   <a class="code" href="classChamp__P1iP1B__implementation.html#aee9f9b7409940ee4d50c7e2b4f695af8" title="Drapeau pour savoir s&#39;il y&#39;a des CL de Neumann (influe sur le filtrage)">Condition_Neumann_imposee_</a> = 0;
<a name="l00507"></a>00507   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;les_cl.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); i++)
<a name="l00508"></a>00508     <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,les_cl[i].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>()))
<a name="l00509"></a>00509       <a class="code" href="classChamp__P1iP1B__implementation.html#aee9f9b7409940ee4d50c7e2b4f695af8" title="Drapeau pour savoir s&#39;il y&#39;a des CL de Neumann (influe sur le filtrage)">Condition_Neumann_imposee_</a> = 1;
<a name="l00510"></a>00510 }
<a name="l00511"></a>00511 
<a name="l00512"></a><a class="code" href="classChamp__P1iP1B__implementation.html#ab90b54f2d70580a4e72530db01cb02f8">00512</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__P1iP1B__implementation.html#ab90b54f2d70580a4e72530db01cb02f8">Champ_P1iP1B_implementation::trace</a>(<span class="keyword">const</span> <a class="code" href="classFrontiere__dis__base.html" title="classe Frontiere_dis_base Classe representant une frontiere discretisee. Les objets Frontiere_dis_bas...">Frontiere_dis_base</a>&amp; fr, <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; y, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; x,<span class="keywordtype">int</span> distant)<span class="keyword"> const</span>
<a name="l00513"></a>00513 <span class="keyword"></span>{
<a name="l00514"></a>00514   assert(distant==0);
<a name="l00515"></a>00515   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; fr_vf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>, fr);
<a name="l00516"></a>00516   <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_dis = <a class="code" href="classChamp__P1iP1B__implementation.html#ad40a4e303d45f69df200378cc5d17251">zone_vef</a>();
<a name="l00517"></a>00517   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; cg_faces = zone_dis.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00518"></a>00518   <span class="keywordtype">int</span> nb_faces_fr = fr_vf.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00519"></a>00519   <span class="keywordtype">int</span> face, elem;
<a name="l00520"></a>00520 
<a name="l00521"></a>00521   assert(x.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)==fr_vf.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>());
<a name="l00522"></a>00522 
<a name="l00523"></a>00523   <a class="code" href="classIntVect.html">IntVect</a> elem_voisins(nb_faces_fr);
<a name="l00524"></a>00524   elem_voisins = -1;
<a name="l00525"></a>00525   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> cg_faces_fr(nb_faces_fr,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>);
<a name="l00526"></a>00526   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> val_interp(nb_faces_fr, 1);
<a name="l00527"></a>00527 
<a name="l00528"></a>00528 <span class="comment">// On recupere les elements voisins des faces de la frontiere</span>
<a name="l00529"></a>00529   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_faces_fr; i++)
<a name="l00530"></a>00530     {
<a name="l00531"></a>00531       face = fr_vf.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>()+i;
<a name="l00532"></a>00532       elem = zone_dis.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(face,0);
<a name="l00533"></a>00533       <span class="keywordflow">if</span> (elem==-1)
<a name="l00534"></a>00534         elem = zone_dis.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(face,1);
<a name="l00535"></a>00535       elem_voisins(i) = elem;
<a name="l00536"></a>00536     }
<a name="l00537"></a>00537 
<a name="l00538"></a>00538 <span class="comment">// Remplissage du tableau contenant les coordonnees</span>
<a name="l00539"></a>00539 <span class="comment">// du centre de gravite des faces de la frontiere</span>
<a name="l00540"></a>00540   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=0; num_face&lt;nb_faces_fr; num_face++)
<a name="l00541"></a>00541     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dim=0; dim&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; dim++)
<a name="l00542"></a>00542       {
<a name="l00543"></a>00543         face = fr_vf.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>()+num_face;
<a name="l00544"></a>00544         cg_faces_fr(num_face,dim) = cg_faces(face,dim);
<a name="l00545"></a>00545       }
<a name="l00546"></a>00546 
<a name="l00547"></a>00547 <span class="comment">// Interpolation des valeurs du champ au centre de gravite des faces frontieres</span>
<a name="l00548"></a>00548   <a class="code" href="classChamp__P1iP1B__implementation.html#ac7344e00a197a783b92f7f8ebef6921d">valeur_aux_elems</a>(cg_faces_fr,elem_voisins,val_interp);
<a name="l00549"></a>00549 
<a name="l00550"></a>00550   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_faces_fr; i++)
<a name="l00551"></a>00551     {
<a name="l00552"></a>00552       x(i,0) = val_interp(i);
<a name="l00553"></a>00553     }
<a name="l00554"></a>00554 <span class="comment">// Useless ? x.echange_espace_virtuel();</span>
<a name="l00555"></a>00555   <span class="keywordflow">return</span> x;
<a name="l00556"></a>00556 }
<a name="l00557"></a>00557 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:28 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
