<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/EF/Operateurs/Op_Grad_EF.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/EF/Operateurs/Op_Grad_EF.cpp</div>  </div>
</div>
<div class="contents">
<a href="Op__Grad__EF_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2019, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Op_Grad_EF.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/EF/Operateurs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/17</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Op__Grad__EF_8h.html">Op_Grad_EF.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Neumann__sortie__libre_8h.html">Neumann_sortie_libre.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet_8h.html">Dirichlet.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Navier__Stokes__std_8h.html">Navier_Stokes_std.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps__base_8h.html">Schema_Temps_base.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="EcrFicPartage_8h.html">EcrFicPartage.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="SFichier_8h.html">SFichier.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Champ__P0__EF_8h.html">Champ_P0_EF.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Check__espace__virtuel_8h.html">Check_espace_virtuel.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Discretisation__base_8h.html">Discretisation_base.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="EChaine_8h.html">EChaine.h</a>&gt;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="interface__INITGAUSS_8h.html">interface_INITGAUSS.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="interface__CALCULSI_8h.html">interface_CALCULSI.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="Op__Grad__EF_8cpp.html#afcd0c185f68e8dcb666cccbf76ddfb74">00041</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classOp__Grad__EF.html" title="class Op_Grad_EF Cette classe represente l&#39;operateur de gradient La discretisation est EF On calcule ...">Op_Grad_EF</a>,<span class="stringliteral">&quot;Op_Grad_EF&quot;</span>,<a class="code" href="classOperateur__Grad__base.html" title="Classe Operateur_Grad_base Cette classe est la base de la hierarchie des operateurs representant le c...">Operateur_Grad_base</a>);
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment"></span>
<a name="l00044"></a>00044 <span class="comment">////!&lt; printOn </span>
<a name="l00045"></a>00045 <span class="comment"></span><span class="comment">//</span>
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="classOp__Grad__EF.html#a7e4e20165eb342163df203e2c90a549b">00047</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classOp__Grad__EF.html#a7e4e20165eb342163df203e2c90a549b" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Grad_EF::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00048"></a>00048 <span class="keyword"></span>{
<a name="l00049"></a>00049   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() ;
<a name="l00050"></a>00050 }
<a name="l00051"></a>00051 <span class="comment"></span>
<a name="l00052"></a>00052 <span class="comment">////!&lt; readOn </span>
<a name="l00053"></a>00053 <span class="comment"></span><span class="comment">//</span>
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="classOp__Grad__EF.html#a9295af102be30b836be8d386a2c08205">00055</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classOp__Grad__EF.html#a9295af102be30b836be8d386a2c08205" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Grad_EF::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s)
<a name="l00056"></a>00056 {
<a name="l00057"></a>00057   <span class="keywordflow">return</span> s ;
<a name="l00058"></a>00058 }
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="classOp__Grad__EF.html#a7f971674273e5ac6451a55681604263e">00060</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Grad__EF.html#a7f971674273e5ac6451a55681604263e" title="NE FAIT RIEN A surcharger dans les classes derivees. Mise a jour de l&#39;operateur.">Op_Grad_EF::mettre_a_jour</a>(<span class="keywordtype">double</span> temps)
<a name="l00061"></a>00061 {
<a name="l00062"></a>00062   <a class="code" href="classOp__Grad__EF.html#a7f971674273e5ac6451a55681604263e" title="NE FAIT RIEN A surcharger dans les classes derivees. Mise a jour de l&#39;operateur.">Operateur_Grad_base::mettre_a_jour</a>(temps);
<a name="l00063"></a>00063 }
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="preprocessor">#undef lire_valimp_dans_med_</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>
<a name="l00067"></a>00067 <span class="comment">//</span>
<a name="l00068"></a><a class="code" href="classOp__Grad__EF.html#a7b44225a4bdefeb40e1047cb5b9688d0">00068</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Grad__EF.html#a7b44225a4bdefeb40e1047cb5b9688d0">Op_Grad_EF::associer</a>(<span class="keyword">const</span> <a class="code" href="classZone__dis.html" title="classe Zone_dis Classe generique de la hierarchie des zones discretisees. Un objet de type Zone_dis p...">Zone_dis</a>&amp; zone_dis,
<a name="l00069"></a>00069                           <span class="keyword">const</span> <a class="code" href="classZone__Cl__dis.html" title="classe Zone_Cl_dis Classe generique de la hierarchie des conditions aux limites discretisees. Un objet Zone_Cl_dis peut referencer n&#39;importe quel derivant de Zone_Cl_dis_base. La plupart des methodes appellent les methodes de l&#39;objet Probleme sous-jacent via la methode valeur() declaree grace a la macro Declare_deriv().;">Zone_Cl_dis</a>&amp; zone_Cl_dis,
<a name="l00070"></a>00070                           <span class="keyword">const</span> <a class="code" href="classChamp__Inc.html">Champ_Inc</a>&amp; inc)
<a name="l00071"></a>00071 {
<a name="l00072"></a>00072   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>, zone_dis.<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>());
<a name="l00073"></a>00073   <span class="keyword">const</span> <a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>&amp; zclEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>, zone_Cl_dis.<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00074"></a>00074   <a class="code" href="classOp__Grad__EF.html#ade03d56c46d8acd474b0df4e39a945e5">la_zone_EF</a> = zEF;
<a name="l00075"></a>00075   <a class="code" href="classOp__Grad__EF.html#a28d9e5cecd807704214245c4cd613f1b">la_zcl_EF</a> = zclEF;
<a name="l00076"></a>00076 <span class="comment">// const IntTab&amp; face_sommets=zEF.face_sommets();</span>
<a name="l00077"></a>00077 <span class="preprocessor">#ifdef  lire_valimp_dans_med_</span>
<a name="l00078"></a>00078 <span class="preprocessor"></span><span class="comment">// assert(face_sommets.dimension(1)==4);</span>
<a name="l00079"></a>00079 <span class="comment">// if (face_sommets.dimension(1)==4)</span>
<a name="l00080"></a>00080   {
<a name="l00081"></a>00081     zclEF.equation().probleme().discretisation().discretiser_champ(<span class="stringliteral">&quot;CHAMP_SOMMETS&quot;</span>,zEF,<span class="stringliteral">&quot;int_P_bord&quot;</span>,<span class="stringliteral">&quot;?&quot;</span>,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>,0.,<a class="code" href="classOp__Grad__EF.html#a53fa3277e5fa66d772050d2a3c55d179">int_P_bord_</a>);
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 
<a name="l00084"></a>00084     {
<a name="l00085"></a>00085       <a class="code" href="classChamp__Don.html" title="classe Champ_Don Classe generique de la hierarchie des champs donnes, un objet Champ_Don peut referen...">Champ_Don</a> champ_lu;
<a name="l00086"></a>00086       <a class="code" href="classEChaine.html" title="Une entree dont la source est une chaine de caracteres. Le constructeur cree sa propre copie de la ch...">EChaine</a> ee(<span class="stringliteral">&quot;champ_fonc_med last_time termes.med MAILLAGE_GENEPI terme_pression_limite_qdm_10 som 0.&quot;</span>);
<a name="l00087"></a>00087       ee&gt;&gt;champ_lu;
<a name="l00088"></a>00088       <a class="code" href="classOp__Grad__EF.html#a53fa3277e5fa66d772050d2a3c55d179">int_P_bord_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__base.html#a336a105699c70cd8c4d9b066a39264a8" title="Affecter un champ dans un autre. Rebvoie le resultat de l&#39;affectation.">affecter</a>(champ_lu);
<a name="l00089"></a>00089     }
<a name="l00090"></a>00090   }
<a name="l00091"></a>00091 <span class="preprocessor">#endif</span>
<a name="l00092"></a>00092 <span class="preprocessor"></span>
<a name="l00093"></a>00093 }
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="Op__Grad__EF_8cpp.html#a3f481600e87b7e0473e1d72f45fb1b7e">00098</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="Op__Grad__EF_8cpp.html#a3f481600e87b7e0473e1d72f45fb1b7e">bid</a>=0;
<a name="l00099"></a><a class="code" href="Op__Grad__EF_8cpp.html#abc0897c211f7aa4541da5833388f868b">00099</a> <span class="keywordtype">void</span> <a class="code" href="Op__Grad__EF_8cpp.html#abc0897c211f7aa4541da5833388f868b">test</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pression, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; grad,<span class="keyword">const</span> <a class="code" href="classOp__Grad__EF.html" title="class Op_Grad_EF Cette classe represente l&#39;operateur de gradient La discretisation est EF On calcule ...">Op_Grad_EF</a>&amp;  op)
<a name="l00100"></a>00100 {
<a name="l00101"></a>00101   <span class="keywordflow">if</span> (<a class="code" href="Op__Grad__EF_8cpp.html#a3f481600e87b7e0473e1d72f45fb1b7e">bid</a>==0)
<a name="l00102"></a>00102     {
<a name="l00103"></a>00103       <a class="code" href="Op__Grad__EF_8cpp.html#a3f481600e87b7e0473e1d72f45fb1b7e">bid</a>=1;
<a name="l00104"></a>00104       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> pe(pression);
<a name="l00105"></a>00105       pe=1;
<a name="l00106"></a>00106       op.<a class="code" href="classOp__Grad__EF.html#a482b37876465fa35052c208ec013b23c">ajouter</a>(pe,grad);
<a name="l00107"></a>00107       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;ici max grad &quot;</span>&lt;&lt;grad.<a class="code" href="classDoubleVect.html#a461fddb9456562779ce10f709ece6807">mp_max_abs_vect</a>()&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00108"></a>00108 <span class="comment">// Cerr&lt;&lt;grad&lt;&lt;finl;</span>
<a name="l00109"></a>00109     }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 
<a name="l00116"></a><a class="code" href="Op__Grad__EF_8cpp.html#abe042c102d5d9aca9ea67789a316b63a">00116</a> <span class="keywordtype">void</span> <a class="code" href="Op__Grad__EF_8cpp.html#abe042c102d5d9aca9ea67789a316b63a">ajouter_bord</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF,<span class="keyword">const</span>  <a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>&amp; zone_Cl_EF, <span class="keyword">const</span> <a class="code" href="classChamp__Don.html" title="classe Champ_Don Classe generique de la hierarchie des champs donnes, un objet Champ_Don peut referen...">Champ_Don</a>&amp; int_P_bord_ )
<a name="l00117"></a>00117 {
<a name="l00118"></a>00118 <span class="comment">// const IntTab&amp; face_voisins = zone_EF.face_voisins();</span>
<a name="l00119"></a>00119   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales = zone_EF.<a class="code" href="classZone__EF.html#a6c5db13c18d9793f63bc0678e6c5eb7d">face_normales</a>();
<a name="l00120"></a>00120 
<a name="l00121"></a>00121   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets=zone_EF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l00122"></a>00122   <span class="keywordtype">int</span> nb_som_face=zone_EF.<a class="code" href="classZone__VF.html#a990808f967f351edbb83ff11d60b7445" title="renvoie le nombre de sommets par face. Rque : on a suppose que toutes les faces avait le meme nombre ...">nb_som_face</a>();
<a name="l00123"></a>00123 
<a name="l00124"></a>00124   <span class="keywordflow">if</span> (int_P_bord_.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l00125"></a>00125     {
<a name="l00126"></a>00126       resu+= int_P_bord_.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00127"></a>00127     }
<a name="l00128"></a>00128   <span class="keywordflow">else</span>
<a name="l00129"></a>00129 
<a name="l00130"></a>00130     {
<a name="l00131"></a>00131       <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_sommet = zone_EF.<a class="code" href="classZone__EF.html#adf7b5abf51854c3430a8f632fa8fd3ba">porosite_sommet</a>();
<a name="l00132"></a>00132 
<a name="l00133"></a>00133       <span class="keywordflow">if</span> (face_sommets.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1)==4)
<a name="l00134"></a>00134         {
<a name="l00135"></a>00135           <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> filter(4) ;
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 
<a name="l00138"></a>00138           filter[0] = 0 ;
<a name="l00139"></a>00139           filter[1] = 2 ;
<a name="l00140"></a>00140           filter[2] = 3 ;
<a name="l00141"></a>00141           filter[3] = 1 ;
<a name="l00142"></a>00142           <a class="code" href="classinterface__INITGAUSS.html">interface_INITGAUSS</a> init_gauss;
<a name="l00143"></a>00143           <span class="keywordtype">int</span> npgau=9;
<a name="l00144"></a>00144           <span class="keywordtype">int</span> nbnn=4;
<a name="l00145"></a>00145           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> xgau(npgau,3),frgau(npgau,nbnn),dfrgau(npgau,nbnn,(<span class="keywordtype">int</span>)3),poigau(npgau);
<a name="l00146"></a>00146           <span class="keywordtype">int</span> dim=2;
<a name="l00147"></a>00147 <span class="comment">// init_gauss.compute(&amp;dim,&amp;nbnn,&amp;npgau,xgau.addr(),frgau.addr(),dfrgau.addr(),poigau.addr());</span>
<a name="l00148"></a>00148           init_gauss.<a class="code" href="classinterface__INITGAUSS.html#ab91511f22486001829853c9179117b4c">Compute</a>(dim,nbnn,npgau,xgau,frgau,dfrgau,poigau);
<a name="l00149"></a>00149 <span class="comment">// ArrOfInt num(nbnn);</span>
<a name="l00150"></a>00150           <a class="code" href="classinterface__CALCULSI.html">interface_CALCULSI</a> CALCULSI;
<a name="l00151"></a>00151           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> xl(3,8),poro(4),detj(npgau), cnorm(3),si(4);
<a name="l00152"></a>00152           <span class="keywordtype">int</span> ip=0;
<a name="l00153"></a>00153           <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00154"></a>00154 
<a name="l00155"></a>00155 <span class="comment">// const DoubleTab&amp; face_normales = zone_EF.face_normales();</span>
<a name="l00156"></a>00156 
<a name="l00157"></a>00157           <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> num(4);
<a name="l00158"></a>00158           <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> n_bord=0; n_bord&lt;zone_EF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00159"></a>00159             {
<a name="l00160"></a>00160               <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_EF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00161"></a>00161               <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00162"></a>00162 
<a name="l00163"></a>00163               <span class="keywordtype">int</span> nfin = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00164"></a>00164               <span class="keywordflow">if</span> ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) )
<a name="l00165"></a>00165                 {
<a name="l00166"></a>00166                   <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; la_cl_typee =
<a name="l00167"></a>00167                     <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>, la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00168"></a>00168 
<a name="l00169"></a>00169                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face&lt;nfin; ind_face++)
<a name="l00170"></a>00170                     {
<a name="l00171"></a>00171                       <span class="keywordtype">int</span> face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00172"></a>00172                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;3; i++)
<a name="l00173"></a>00173                         cnorm(i)=face_normales(face,i);
<a name="l00174"></a>00174                       cnorm/=<a class="code" href="ArrOfDouble_8cpp.html#af3b2ac08cde80e3eadd7a83f5fd06ab7" title="Calcul de la norme du vecteur dx (fonction blas DNRM2, soit racine carree(somme des dx[i]*dx[i])...">norme_array</a>(cnorm);
<a name="l00175"></a>00175 <span class="comment">// int elem = face_voisins(face,0);</span>
<a name="l00176"></a>00176                       <span class="keywordtype">double</span> val_imp= la_cl_typee.<a class="code" href="classNeumann.html#a4f6ee6cc54ca6471254c2a530c5b70b5" title="Renvoie la valeur du flux impose sur la i-eme composante du champ representant le flux a la frontiere...">flux_impose</a>(ind_face);
<a name="l00177"></a>00177 
<a name="l00178"></a>00178                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nbnn; i++)
<a name="l00179"></a>00179                         {
<a name="l00180"></a>00180                           num(i)=face_sommets(face,filter(i));
<a name="l00181"></a>00181                         }
<a name="l00182"></a>00182 
<a name="l00183"></a>00183                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nbnn; i++)
<a name="l00184"></a>00184                         {
<a name="l00185"></a>00185                           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; d++)
<a name="l00186"></a>00186                             xl(d,i)=coord(num(i),d);
<a name="l00187"></a>00187                           poro(i)=porosite_sommet(num(i));
<a name="l00188"></a>00188                         }
<a name="l00189"></a>00189 
<a name="l00190"></a>00190                       ip=1;
<a name="l00191"></a>00191                       CALCULSI.<a class="code" href="classinterface__CALCULSI.html#af145ac4a75efef07bb1e5f6bf3c92930">Compute</a>(nbnn, xl,
<a name="l00192"></a>00192                                        poro,ip,
<a name="l00193"></a>00193                                        npgau, xgau, frgau, dfrgau,
<a name="l00194"></a>00194                                        poigau,detj, cnorm,si);
<a name="l00195"></a>00195                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nbnn; i++)
<a name="l00196"></a>00196                         {
<a name="l00197"></a>00197 
<a name="l00198"></a>00198                           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; d++)
<a name="l00199"></a>00199                             {
<a name="l00200"></a>00200                               <span class="keywordtype">int</span> som=num((i));
<a name="l00201"></a>00201                               resu(som,d)+=si(i)*cnorm(d)*val_imp;
<a name="l00202"></a>00202                             }
<a name="l00203"></a>00203                         }
<a name="l00204"></a>00204                     }
<a name="l00205"></a>00205                 }
<a name="l00206"></a>00206             }
<a name="l00207"></a>00207         }
<a name="l00208"></a>00208       <span class="keywordflow">else</span>
<a name="l00209"></a>00209         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> n_bord=0; n_bord&lt;zone_EF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00210"></a>00210           {
<a name="l00211"></a>00211             <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_EF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00212"></a>00212             <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00213"></a>00213 
<a name="l00214"></a>00214             <span class="keywordtype">int</span> nfin = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00215"></a>00215             <span class="keywordflow">if</span> ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) )
<a name="l00216"></a>00216               {
<a name="l00217"></a>00217                 <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; la_cl_typee =
<a name="l00218"></a>00218                   <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>, la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00219"></a>00219 
<a name="l00220"></a>00220                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face&lt;nfin; ind_face++)
<a name="l00221"></a>00221                   {
<a name="l00222"></a>00222                     <span class="keywordtype">int</span> face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00223"></a>00223 <span class="comment">// int elem = face_voisins(face,0);</span>
<a name="l00224"></a>00224                     <span class="keywordtype">double</span> val_imp= la_cl_typee.<a class="code" href="classNeumann.html#a4f6ee6cc54ca6471254c2a530c5b70b5" title="Renvoie la valeur du flux impose sur la i-eme composante du champ representant le flux a la frontiere...">flux_impose</a>(ind_face);
<a name="l00225"></a>00225                     val_imp/=nb_som_face;
<a name="l00226"></a>00226                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=0; s&lt;nb_som_face; s++)
<a name="l00227"></a>00227                       {
<a name="l00228"></a>00228                         <span class="keywordtype">int</span> som=face_sommets(face,s);
<a name="l00229"></a>00229                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir=0; dir&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; dir++)
<a name="l00230"></a>00230                           resu(som,dir)+=val_imp*face_normales(face,dir)*porosite_sommet(som);
<a name="l00231"></a>00231                       }
<a name="l00232"></a>00232                   }
<a name="l00233"></a>00233               }
<a name="l00234"></a>00234           }
<a name="l00235"></a>00235     }
<a name="l00236"></a>00236   zone_Cl_EF.<a class="code" href="classZone__Cl__EF.html#a10696e08ab5fb42ca5948b732f2455f3" title="Impose les conditions de symetrie c.a.d annules les composantes du champ sur la ou les normales si to...">imposer_symetrie</a>(resu);
<a name="l00237"></a>00237 }
<a name="l00238"></a>00238 
<a name="l00239"></a>00239 
<a name="l00240"></a><a class="code" href="classOp__Grad__EF.html#a482b37876465fa35052c208ec013b23c">00240</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Grad__EF.html#a482b37876465fa35052c208ec013b23c">Op_Grad_EF::ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pression, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; grad)<span class="keyword"> const</span>
<a name="l00241"></a>00241 <span class="keyword"></span>{
<a name="l00242"></a>00242 
<a name="l00243"></a>00243   <a class="code" href="Op__Grad__EF_8cpp.html#abc0897c211f7aa4541da5833388f868b">test</a>(pression,grad,(*<span class="keyword">this</span>));
<a name="l00244"></a>00244 <span class="comment">// Gradient d&#39;un champ scalaire localise aux centres des elements</span>
<a name="l00245"></a>00245 
<a name="l00246"></a>00246 <span class="comment">// On initialise grad a zero</span>
<a name="l00247"></a>00247   grad = 0;
<a name="l00248"></a>00248   <a class="code" href="Check__espace__virtuel_8cpp.html#a2ea8fcf12c28d0454bdc4126f8c4b186" title="en mode comm_check_enabled(), verifie si l&#39;espace virtuel du vecteur est a jour, si ce n&#39;est pas le c...">assert_espace_virtuel_vect</a>(pression);
<a name="l00249"></a>00249   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;pression dans Op_Grad_EF&quot;</span>,pression);
<a name="l00250"></a>00250   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_ef=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().zone_dis().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00251"></a>00251 
<a name="l00252"></a>00252 
<a name="l00253"></a>00253   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; Bij_thilde=zone_ef.<a class="code" href="classZone__EF.html#a19670025b345d5a9125180fb960052be">Bij_thilde</a>();
<a name="l00254"></a>00254   <span class="keywordtype">int</span> nb_elem_tot=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00255"></a>00255   <span class="keywordtype">int</span> nb_som_elem=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00256"></a>00256   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=zone_ef.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00257"></a>00257 
<a name="l00258"></a>00258   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00259"></a>00259     {
<a name="l00260"></a>00260       <span class="keywordtype">double</span> pe=pression(elem);
<a name="l00261"></a>00261       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=0; s&lt;nb_som_elem; s++)
<a name="l00262"></a>00262         {
<a name="l00263"></a>00263           <span class="keywordtype">int</span> som=elems(elem,s);
<a name="l00264"></a>00264           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)
<a name="l00265"></a>00265             {
<a name="l00266"></a>00266               grad(som,i)-=Bij_thilde(elem,s,i)*pe;
<a name="l00267"></a>00267             }
<a name="l00268"></a>00268         }
<a name="l00269"></a>00269     }
<a name="l00270"></a>00270 
<a name="l00271"></a>00271   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_sommets=zone_ef.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l00272"></a>00272   <span class="keywordtype">int</span> nb_som_face=faces_sommets.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00273"></a>00273 <span class="comment">// const IntTab&amp; face_voisins = zone_ef.face_voisins();</span>
<a name="l00274"></a>00274   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales = zone_ef.<a class="code" href="classZone__EF.html#a6c5db13c18d9793f63bc0678e6c5eb7d">face_normales</a>();
<a name="l00275"></a>00275   <span class="keyword">const</span> <a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>&amp; zone_Cl_EF = <a class="code" href="classOp__Grad__EF.html#a28d9e5cecd807704214245c4cd613f1b">la_zcl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>();
<a name="l00276"></a>00276 
<a name="l00277"></a>00277 
<a name="l00278"></a>00278 
<a name="l00279"></a>00279 <span class="comment">// prise en compte des &quot; cl &quot; ajout du temr - int P sur le bord</span>
<a name="l00280"></a>00280 <span class="comment">// test ...</span>
<a name="l00281"></a>00281   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;zone_ef.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>()*1; n_bord++)
<a name="l00282"></a>00282     {
<a name="l00283"></a>00283       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_EF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00284"></a>00284       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) )
<a name="l00285"></a>00285         <span class="keywordflow">continue</span>;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00288"></a>00288       <span class="keywordtype">int</span> num1 = 0;
<a name="l00289"></a>00289       <span class="keywordtype">int</span> num2 = + le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00290"></a>00290       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) )
<a name="l00291"></a>00291 <span class="comment">// ca ne sert a rien</span>
<a name="l00292"></a>00292         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2; ind_face++)
<a name="l00293"></a>00293           {
<a name="l00294"></a>00294             <span class="keywordtype">int</span> face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00295"></a>00295             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=0; s&lt;nb_som_face; s++)
<a name="l00296"></a>00296               {
<a name="l00297"></a>00297                 <span class="keywordtype">int</span> som=faces_sommets(face,s);
<a name="l00298"></a>00298                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00299"></a>00299                   grad(som,comp) = 0;
<a name="l00300"></a>00300               }
<a name="l00301"></a>00301           }
<a name="l00302"></a>00302 
<a name="l00303"></a>00303 
<a name="l00304"></a>00304       <span class="keywordflow">else</span>
<a name="l00305"></a>00305         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=num1; ind_face&lt;num2*0; ind_face++)
<a name="l00306"></a>00306           {
<a name="l00307"></a>00307             <span class="keywordtype">int</span> face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00308"></a>00308 <span class="comment">// int elem1 = face_voisins(face,0);</span>
<a name="l00309"></a>00309 <span class="comment">// double diff =  - pression[elem1]/nb_som_face;</span>
<a name="l00310"></a>00310 
<a name="l00311"></a>00311             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=0; s&lt;nb_som_face; s++)
<a name="l00312"></a>00312               {
<a name="l00313"></a>00313                 <span class="keywordtype">int</span> som=faces_sommets(face,s);
<a name="l00314"></a>00314 <span class="comment">// on calcule grad.S /S2</span>
<a name="l00315"></a>00315                 <span class="keywordtype">double</span> grad_n=0;
<a name="l00316"></a>00316                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00317"></a>00317                   grad_n+=grad(som,comp)*face_normales(face,comp);
<a name="l00318"></a>00318                 grad_n/=(zone_ef.<a class="code" href="classZone__VF.html#af42306af8f7398c037e978377924ebe8">surface</a>(face)*zone_ef.<a class="code" href="classZone__VF.html#af42306af8f7398c037e978377924ebe8">surface</a>(face));
<a name="l00319"></a>00319                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00320"></a>00320                   grad(som,comp) -= grad_n*face_normales(face,comp);
<a name="l00321"></a>00321               }
<a name="l00322"></a>00322           }
<a name="l00323"></a>00323     }
<a name="l00324"></a>00324   <a class="code" href="Op__Grad__EF_8cpp.html#abe042c102d5d9aca9ea67789a316b63a">ajouter_bord</a>(grad,zone_ef,<a class="code" href="classOp__Grad__EF.html#a28d9e5cecd807704214245c4cd613f1b">la_zcl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>(),<a class="code" href="classOp__Grad__EF.html#a53fa3277e5fa66d772050d2a3c55d179">int_P_bord_</a>);
<a name="l00325"></a>00325   grad.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00326"></a>00326   <span class="keywordflow">return</span> grad;
<a name="l00327"></a>00327 }
<a name="l00328"></a>00328 
<a name="l00329"></a><a class="code" href="classOp__Grad__EF.html#adde0da2f93707d84ce019d529d69dd78">00329</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Grad__EF.html#adde0da2f93707d84ce019d529d69dd78">Op_Grad_EF::calculer</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pre, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; grad)<span class="keyword"> const</span>
<a name="l00330"></a>00330 <span class="keyword"></span>{
<a name="l00331"></a>00331   grad = 0;
<a name="l00332"></a>00332   <span class="keywordflow">return</span> <a class="code" href="classOp__Grad__EF.html#a482b37876465fa35052c208ec013b23c">ajouter</a>(pre,grad);
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 }
<a name="l00335"></a>00335 
<a name="l00336"></a><a class="code" href="classOp__Grad__EF.html#a9a02014dfbcf3c905d0044b1416ea4ea">00336</a> <span class="keywordtype">int</span> <a class="code" href="classOp__Grad__EF.html#a9a02014dfbcf3c905d0044b1416ea4ea" title="NE FAIT RIEN A surcharger dans les classes derivees. Imprime l&#39;operateur sur un flot de sortie...">Op_Grad_EF::impr</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00337"></a>00337 <span class="keyword"></span>{
<a name="l00338"></a>00338   <span class="keyword">const</span> <span class="keywordtype">int</span> impr_mom=<a class="code" href="classOp__Grad__EF.html#ade03d56c46d8acd474b0df4e39a945e5">la_zone_EF</a>-&gt;zone().Moments_a_imprimer();
<a name="l00339"></a>00339   <span class="keyword">const</span> <span class="keywordtype">int</span> impr_sum=(<a class="code" href="classOp__Grad__EF.html#ade03d56c46d8acd474b0df4e39a945e5">la_zone_EF</a>-&gt;zone().Bords_a_imprimer_sum().est_vide() ? 0:1);
<a name="l00340"></a>00340   <span class="keyword">const</span> <span class="keywordtype">int</span> impr_bord=(<a class="code" href="classOp__Grad__EF.html#ade03d56c46d8acd474b0df4e39a945e5">la_zone_EF</a>-&gt;zone().Bords_a_imprimer().est_vide() ? 0:1);
<a name="l00341"></a>00341   <span class="keyword">const</span> <a class="code" href="classSchema__Temps__base.html" title="classe Schema_Temps_base">Schema_Temps_base</a>&amp; sch = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>();
<a name="l00342"></a>00342   <span class="keywordtype">double</span> temps = sch.<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>();
<a name="l00343"></a>00343   <span class="keyword">const</span> <a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>&amp; zone_Cl_EF = <a class="code" href="classOp__Grad__EF.html#a28d9e5cecd807704214245c4cd613f1b">la_zcl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>();
<a name="l00344"></a>00344   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classOp__Grad__EF.html#ade03d56c46d8acd474b0df4e39a945e5">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00345"></a>00345   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_EF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00346"></a>00346   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales = zone_EF.<a class="code" href="classZone__EF.html#a6c5db13c18d9793f63bc0678e6c5eb7d">face_normales</a>();
<a name="l00347"></a>00347   <span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>();
<a name="l00348"></a>00348   <span class="keyword">const</span> <a class="code" href="classNavier__Stokes__std.html" title="classe Navier_Stokes_std Cette classe porte les termes de l&#39;equation de la dynamique pour un fluide s...">Navier_Stokes_std</a>&amp; eqn_hydr = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classNavier__Stokes__std.html" title="classe Navier_Stokes_std Cette classe porte les termes de l&#39;equation de la dynamique pour un fluide s...">Navier_Stokes_std</a>,eqn);
<a name="l00349"></a>00349   <span class="keyword">const</span> <a class="code" href="classChamp__P0__EF.html">Champ_P0_EF</a>&amp; la_pression_P0 = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P0__EF.html">Champ_P0_EF</a>,eqn_hydr.<a class="code" href="classNavier__Stokes__std.html#a2233a18979d8e301c9d376d8639877ee">pression_pa</a>().<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>());
<a name="l00350"></a>00350   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pression_P0 = la_pression_P0.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00351"></a>00351   <span class="keywordtype">int</span> n_bord, elem ;
<a name="l00352"></a>00352   <span class="keywordtype">int</span> face;
<a name="l00353"></a>00353   <span class="keywordtype">double</span> n0, n1, n2 ;
<a name="l00354"></a>00354   <span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; c_grav=<a class="code" href="classOp__Grad__EF.html#ade03d56c46d8acd474b0df4e39a945e5">la_zone_EF</a>-&gt;zone().cg_moments();
<a name="l00355"></a>00355   <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(zone_EF.<a class="code" href="classZone__VF.html#a8815e2276637c0db23868f043dc43e58" title="renvoie le nombre de faces sur lesquelles sont appliquees les conditions limites : bords...">nb_faces_bord</a>(),<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00356"></a>00356   <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a> = 0.;
<a name="l00357"></a>00357   <span class="keywordtype">int</span> flag=<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>();
<a name="l00358"></a>00358   <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> Flux_grad;
<a name="l00359"></a>00359   <a class="code" href="classOperateur__base.html#a163b8e77d9ad86d8c0cdd28d29903538" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier</a>(Flux_grad,<span class="stringliteral">&quot;&quot;</span>,flag);
<a name="l00360"></a>00360   <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> Flux_grad_moment;
<a name="l00361"></a>00361   <a class="code" href="classOperateur__base.html#a163b8e77d9ad86d8c0cdd28d29903538" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier</a>( Flux_grad_moment,<span class="stringliteral">&quot;moment&quot;</span>,impr_mom&amp;&amp;flag);
<a name="l00362"></a>00362   <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> Flux_grad_sum;
<a name="l00363"></a>00363   <a class="code" href="classOperateur__base.html#a163b8e77d9ad86d8c0cdd28d29903538" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier</a>(Flux_grad_sum,<span class="stringliteral">&quot;sum&quot;</span>,impr_sum&amp;&amp;flag);
<a name="l00364"></a>00364   <a class="code" href="classEcrFicPartage.html">EcrFicPartage</a> Flux_grad_face;
<a name="l00365"></a>00365   <a class="code" href="classOperateur__base.html#a75f3b320ba6d2b58ab1a43a10f317de4" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier_partage</a>(Flux_grad_face,<span class="stringliteral">&quot;&quot;</span>,impr_bord);
<a name="l00366"></a>00366   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00367"></a>00367     {
<a name="l00368"></a>00368       Flux_grad.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(temps);
<a name="l00369"></a>00369       <span class="keywordflow">if</span> (impr_mom) Flux_grad_moment.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(temps);
<a name="l00370"></a>00370       <span class="keywordflow">if</span> (impr_sum) Flux_grad_sum.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(temps);
<a name="l00371"></a>00371     }
<a name="l00372"></a>00372   <span class="keywordflow">for</span> ( n_bord=0; n_bord&lt;zone_EF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00373"></a>00373     {
<a name="l00374"></a>00374       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_EF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00375"></a>00375       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00376"></a>00376 
<a name="l00377"></a>00377       <span class="keywordtype">int</span> ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00378"></a>00378       <span class="keywordtype">int</span> nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00379"></a>00379 
<a name="l00380"></a>00380       <span class="keywordtype">double</span> fluxx_s = 0. ;
<a name="l00381"></a>00381       <span class="keywordtype">double</span> fluxy_s = 0. ;
<a name="l00382"></a>00382       <span class="keywordtype">double</span> fluxz_s = 0. ;
<a name="l00383"></a>00383       <span class="keywordtype">double</span> fluxx_sum_s = 0. ;
<a name="l00384"></a>00384       <span class="keywordtype">double</span> fluxy_sum_s = 0. ;
<a name="l00385"></a>00385       <span class="keywordtype">double</span> fluxz_sum_s = 0. ;
<a name="l00386"></a>00386       <span class="keywordtype">double</span> moment_x = 0.;
<a name="l00387"></a>00387       <span class="keywordtype">double</span> moment_y = 0.;
<a name="l00388"></a>00388       <span class="keywordtype">double</span> moment_z = 0.;
<a name="l00389"></a>00389       <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l00390"></a>00390         {
<a name="l00391"></a>00391 
<a name="l00392"></a>00392           elem = face_voisins(face,0);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394 
<a name="l00395"></a>00395           <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2)
<a name="l00396"></a>00396             {
<a name="l00397"></a>00397               n0   = face_normales(face,0) ;
<a name="l00398"></a>00398               n1   = face_normales(face,1) ;
<a name="l00399"></a>00399 
<a name="l00400"></a>00400               <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) = pression_P0(elem)*n0 ;
<a name="l00401"></a>00401               <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) = pression_P0(elem)*n1 ;
<a name="l00402"></a>00402 
<a name="l00403"></a>00403               fluxx_s += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) ;
<a name="l00404"></a>00404               fluxy_s += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) ;
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 <span class="comment">// Calcul du moment exerce par le fluide sur le bord (OM/\F)</span>
<a name="l00407"></a>00407               <span class="keywordflow">if</span> (impr_mom) moment_z+=<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1)*c_grav(0)-<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0)*c_grav(1);
<a name="l00408"></a>00408 
<a name="l00409"></a>00409               <span class="keywordflow">if</span> (zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa5780fa644b13f8172c4805336846dec">Bords_a_imprimer_sum</a>().<a class="code" href="classList__Nom.html#aafe66fe06c0dd82cb2641fcaf774db07">contient</a>(le_bord.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>()))
<a name="l00410"></a>00410                 {
<a name="l00411"></a>00411                   fluxx_sum_s += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) ;
<a name="l00412"></a>00412                   fluxy_sum_s += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) ;
<a name="l00413"></a>00413                 }
<a name="l00414"></a>00414             }
<a name="l00415"></a>00415           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00416"></a>00416             {
<a name="l00417"></a>00417               n0   = face_normales(face,0) ;
<a name="l00418"></a>00418               n1   = face_normales(face,1) ;
<a name="l00419"></a>00419               n2   = face_normales(face,2) ;
<a name="l00420"></a>00420 
<a name="l00421"></a>00421               <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) = pression_P0(elem)*n0 ;
<a name="l00422"></a>00422               <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) = pression_P0(elem)*n1 ;
<a name="l00423"></a>00423               <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,2) = pression_P0(elem)*n2 ;
<a name="l00424"></a>00424 
<a name="l00425"></a>00425               fluxx_s += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) ;
<a name="l00426"></a>00426               fluxy_s += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) ;
<a name="l00427"></a>00427               fluxz_s += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,2) ;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429 <span class="comment">// Calcul du moment exerce par le fluide sur le bord (OM/\F)</span>
<a name="l00430"></a>00430               moment_x+=<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,2)*c_grav(1)-<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1)*c_grav(2);
<a name="l00431"></a>00431               moment_y+=<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0)*c_grav(2)-<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,2)*c_grav(0);
<a name="l00432"></a>00432               moment_z+=<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1)*c_grav(0)-<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0)*c_grav(1);
<a name="l00433"></a>00433               <span class="keywordflow">if</span> (zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa5780fa644b13f8172c4805336846dec">Bords_a_imprimer_sum</a>().<a class="code" href="classList__Nom.html#aafe66fe06c0dd82cb2641fcaf774db07">contient</a>(le_bord.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>()))
<a name="l00434"></a>00434                 {
<a name="l00435"></a>00435                   fluxx_sum_s += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) ;
<a name="l00436"></a>00436                   fluxy_sum_s += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) ;
<a name="l00437"></a>00437                   fluxz_sum_s += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,2) ;
<a name="l00438"></a>00438                 }
<a name="l00439"></a>00439             }
<a name="l00440"></a>00440         }
<a name="l00441"></a>00441       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2)
<a name="l00442"></a>00442         {
<a name="l00443"></a>00443           fluxx_s=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(fluxx_s);
<a name="l00444"></a>00444           fluxy_s=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(fluxy_s);
<a name="l00445"></a>00445           fluxx_sum_s=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(fluxx_sum_s);
<a name="l00446"></a>00446           fluxy_sum_s=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(fluxy_sum_s);
<a name="l00447"></a>00447           moment_z=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(moment_z);
<a name="l00448"></a>00448           <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00449"></a>00449             {
<a name="l00450"></a>00450               Flux_grad.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(fluxx_s);
<a name="l00451"></a>00451               Flux_grad.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(fluxy_s);
<a name="l00452"></a>00452               <span class="keywordflow">if</span> (impr_sum)
<a name="l00453"></a>00453                 {
<a name="l00454"></a>00454                   Flux_grad_sum.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(fluxx_sum_s);
<a name="l00455"></a>00455                   Flux_grad_sum.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(fluxy_sum_s);
<a name="l00456"></a>00456                 }
<a name="l00457"></a>00457               <span class="keywordflow">if</span> (impr_mom) Flux_grad_moment.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(moment_z);
<a name="l00458"></a>00458             }
<a name="l00459"></a>00459         }
<a name="l00460"></a>00460       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00461"></a>00461         {
<a name="l00462"></a>00462           fluxx_s=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(fluxx_s);
<a name="l00463"></a>00463           fluxy_s=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(fluxy_s);
<a name="l00464"></a>00464           fluxz_s=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(fluxz_s);
<a name="l00465"></a>00465           fluxx_sum_s=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(fluxx_sum_s);
<a name="l00466"></a>00466           fluxy_sum_s=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(fluxy_sum_s);
<a name="l00467"></a>00467           fluxz_sum_s=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(fluxz_sum_s);
<a name="l00468"></a>00468           moment_x=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(moment_x);
<a name="l00469"></a>00469           moment_y=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(moment_y);
<a name="l00470"></a>00470           moment_z=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(moment_z);
<a name="l00471"></a>00471           <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00472"></a>00472             {
<a name="l00473"></a>00473               Flux_grad.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(fluxx_s);
<a name="l00474"></a>00474               Flux_grad.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(fluxy_s);
<a name="l00475"></a>00475               Flux_grad.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(fluxz_s);
<a name="l00476"></a>00476               <span class="keywordflow">if</span> (impr_sum)
<a name="l00477"></a>00477                 {
<a name="l00478"></a>00478                   Flux_grad_sum.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(fluxx_sum_s);
<a name="l00479"></a>00479                   Flux_grad_sum.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(fluxy_sum_s);
<a name="l00480"></a>00480                   Flux_grad_sum.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(fluxz_sum_s);
<a name="l00481"></a>00481                 }
<a name="l00482"></a>00482               <span class="keywordflow">if</span> (impr_mom)
<a name="l00483"></a>00483                 {
<a name="l00484"></a>00484                   Flux_grad_moment.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(moment_x);
<a name="l00485"></a>00485                   Flux_grad_moment.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(moment_y);
<a name="l00486"></a>00486                   Flux_grad_moment.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(moment_z);
<a name="l00487"></a>00487                 }
<a name="l00488"></a>00488             }
<a name="l00489"></a>00489         }
<a name="l00490"></a>00490     }
<a name="l00491"></a>00491   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00492"></a>00492     {
<a name="l00493"></a>00493       Flux_grad &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00494"></a>00494       <span class="keywordflow">if</span> (impr_mom) Flux_grad_moment&lt;&lt;finl;
<a name="l00495"></a>00495       <span class="keywordflow">if</span> (impr_sum) Flux_grad_sum&lt;&lt;finl;
<a name="l00496"></a>00496     }
<a name="l00497"></a>00497   <span class="keywordflow">for</span> ( n_bord=0; n_bord&lt;zone_EF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l00498"></a>00498     {
<a name="l00499"></a>00499       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_EF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00500"></a>00500       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00501"></a>00501 
<a name="l00502"></a>00502       <span class="keywordtype">int</span> ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00503"></a>00503       <span class="keywordtype">int</span> nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00504"></a>00504       <span class="keywordflow">if</span> (zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a2e4f80965f20d39334b470af7aec494a">Bords_a_imprimer</a>().<a class="code" href="classList__Nom.html#aafe66fe06c0dd82cb2641fcaf774db07">contient</a>(le_bord.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>()))
<a name="l00505"></a>00505         {
<a name="l00506"></a>00506           <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>()) Flux_grad_face &lt;&lt; <span class="stringliteral">&quot;# Force par face sur &quot;</span> &lt;&lt; le_bord.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; au temps &quot;</span> &lt;&lt; temps &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00507"></a>00507           <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l00508"></a>00508             {
<a name="l00509"></a>00509               <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==2)
<a name="l00510"></a>00510                 Flux_grad_face &lt;&lt; <span class="stringliteral">&quot;# Face a x= &quot;</span> &lt;&lt; zone_EF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>(face,0) &lt;&lt; <span class="stringliteral">&quot; y= &quot;</span> &lt;&lt; zone_EF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>(face,1) &lt;&lt; <span class="stringliteral">&quot; flux_x= &quot;</span> &lt;&lt; <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) &lt;&lt; <span class="stringliteral">&quot; flux_y= &quot;</span> &lt;&lt; <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) &lt;&lt; finl;
<a name="l00511"></a>00511               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00512"></a>00512                 Flux_grad_face &lt;&lt; <span class="stringliteral">&quot;# Face a x= &quot;</span> &lt;&lt; zone_EF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>(face,0) &lt;&lt; <span class="stringliteral">&quot; y= &quot;</span> &lt;&lt; zone_EF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>(face,1) &lt;&lt; <span class="stringliteral">&quot; z= &quot;</span> &lt;&lt; zone_EF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>(face,3) &lt;&lt; <span class="stringliteral">&quot; flux_x= &quot;</span> &lt;&lt; <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) &lt;&lt; <span class="stringliteral">&quot; flux_y= &quot;</span> &lt;&lt; <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) &lt;&lt; <span class="stringliteral">&quot; flux_z= &quot;</span> &lt;&lt; <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,2) &lt;&lt; finl;
<a name="l00513"></a>00513             }
<a name="l00514"></a>00514           Flux_grad_face.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00515"></a>00515         }
<a name="l00516"></a>00516     }
<a name="l00517"></a>00517 
<a name="l00518"></a>00518   <span class="keywordflow">return</span> 1;
<a name="l00519"></a>00519 }
<a name="l00520"></a>00520 
<a name="l00521"></a>00521 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:11 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
