<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/EF/Operateurs/Op_EF_base.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/EF/Operateurs/Op_EF_base.cpp</div>  </div>
</div>
<div class="contents">
<a href="Op__EF__base_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Op_EF_base.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/EF/Operateurs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     1</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Op__EF__base_8h.html">Op_EF_base.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Zone__EF_8h.html">Zone_EF.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__EF_8h.html">Zone_Cl_EF.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet_8h.html">Dirichlet.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__homogene_8h.html">Dirichlet_homogene.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Symetrie_8h.html">Symetrie.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse_8h.html">Matrice_Morse.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Equation__base_8h.html">Equation_base.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Inc_8h.html">Champ_Inc.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Sortie_8h.html">Sortie.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Operateur_8h.html">Operateur.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Don_8h.html">Champ_Don.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Uniforme_8h.html">Champ_Uniforme.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps__base_8h.html">Schema_Temps_base.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="Milieu__base_8h.html">Milieu_base.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="Operateur__base_8h.html">Operateur_base.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="Operateur__Diff__base_8h.html">Operateur_Diff_base.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="EcrFicPartage_8h.html">EcrFicPartage.h</a>&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;<a class="code" href="Array__tools_8h.html">Array_tools.h</a>&gt;</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="comment">// Description</span>
<a name="l00045"></a>00045 <span class="comment">// Dimensionnement de la matrice qui devra recevoir les coefficients provenant de</span>
<a name="l00046"></a>00046 <span class="comment">// la convection, de la diffusion pour le cas des faces.</span>
<a name="l00047"></a>00047 <span class="comment">// Cette matrice a une structure de matrice morse.</span>
<a name="l00048"></a>00048 <span class="comment">// Nous commencons par calculer les tailles des tableaux tab1 et tab2.</span>
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="classOp__EF__base.html#ad711a8160961be2d2b32bcd6ed58e5c5">00050</a> <span class="keywordtype">void</span> <a class="code" href="classOp__EF__base.html#ad711a8160961be2d2b32bcd6ed58e5c5">Op_EF_base::dimensionner</a>(<span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; la_zone,
<a name="l00051"></a>00051                               <span class="keyword">const</span> <a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>&amp; la_zone_cl,
<a name="l00052"></a>00052                               <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; la_matrice)<span class="keyword"> const</span>
<a name="l00053"></a>00053 <span class="keyword"></span>{
<a name="l00054"></a>00054 
<a name="l00055"></a>00055   <span class="keywordtype">int</span> matrice_stocke=1;
<a name="l00056"></a>00056   <span class="keywordflow">if</span> (matrice_stocke)
<a name="l00057"></a>00057     {
<a name="l00058"></a>00058       <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#a1dd50d47cf5aea0c0b45e306497510a6">matrice_sto_</a>.<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>())
<a name="l00059"></a>00059         {
<a name="l00060"></a>00060           la_matrice=<a class="code" href="classOp__EF__base.html#a1dd50d47cf5aea0c0b45e306497510a6">matrice_sto_</a>;
<a name="l00061"></a>00061           <span class="keywordflow">return</span>;
<a name="l00062"></a>00062         }
<a name="l00063"></a>00063 
<a name="l00064"></a>00064     }
<a name="l00065"></a>00065 <span class="comment">// Dimensionnement de la matrice qui devra recevoir les coefficients provenant de</span>
<a name="l00066"></a>00066 <span class="comment">// la convection, de la diffusion pour le cas des faces.</span>
<a name="l00067"></a>00067 <span class="comment">// Cette matrice a une structure de matrice morse.</span>
<a name="l00068"></a>00068 <span class="comment">// Nous commencons par calculer les tailles des tableaux tab1 et tab2.</span>
<a name="l00069"></a>00069 <span class="comment">// Pour ce faire il faut chercher les sommets voisins du sommet considere.</span>
<a name="l00070"></a>00070 
<a name="l00071"></a>00071   <span class="keywordtype">int</span> nb_som=la_zone.<a class="code" href="classZone__dis__base.html#acc9921d6a29cb719fd832fd573e47825">nb_som</a>();
<a name="l00072"></a>00072   <span class="keywordtype">int</span> nfin = la_zone.<a class="code" href="classZone__dis__base.html#a8f793341b7a41d67561ba563ae0f69a0">nb_som_tot</a>();
<a name="l00073"></a>00073 <span class="comment">// essai</span>
<a name="l00074"></a>00074   nb_som=nfin;
<a name="l00075"></a>00075 
<a name="l00076"></a>00076   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; champ_inconnue = la_zone_cl.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00077"></a>00077   <span class="keywordtype">int</span> nb_comp = champ_inconnue.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="comment">// on ne s&#39;occupe pas dans un premier temps des composantes</span>
<a name="l00080"></a>00080 
<a name="l00081"></a>00081   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems=la_zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00082"></a>00082 <span class="comment">// int nb_elem=la_zone.zone().nb_elem();</span>
<a name="l00083"></a>00083   <span class="keywordtype">int</span> nb_elem_tot=la_zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00084"></a>00084   <span class="keywordtype">int</span> nb_som_elem=la_zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00085"></a>00085   <span class="keywordtype">int</span> nb_coeff=(int)(nb_elem_tot*(nb_som_elem*(nb_som_elem)));
<a name="l00086"></a>00086   la_matrice.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nb_som*nb_comp,nfin*nb_comp,0);
<a name="l00087"></a>00087   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> Indice(nb_coeff,2),p(1,2);
<a name="l00088"></a>00088   <span class="keywordtype">int</span> tot=0;
<a name="l00089"></a>00089   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00090"></a>00090     {
<a name="l00091"></a>00091       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1=0; i1&lt;nb_som_elem; i1++)
<a name="l00092"></a>00092         {
<a name="l00093"></a>00093           <span class="keywordtype">int</span> glob=elems(elem,i1);
<a name="l00094"></a>00094           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i2=0; i2&lt;nb_som_elem; i2++)
<a name="l00095"></a>00095             {
<a name="l00096"></a>00096               <span class="keywordtype">int</span> glob2=elems(elem,i2);
<a name="l00097"></a>00097               <span class="keywordflow">if</span> (glob&lt;nb_som)
<a name="l00098"></a>00098                 {
<a name="l00099"></a>00099                   Indice(tot,0)=glob;
<a name="l00100"></a>00100                   Indice(tot,1)=glob2;
<a name="l00101"></a>00101                   tot++;
<a name="l00102"></a>00102                 }
<a name="l00103"></a>00103             }
<a name="l00104"></a>00104         }
<a name="l00105"></a>00105     }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   Indice.resize(tot,2);
<a name="l00108"></a>00108 
<a name="l00109"></a>00109   <a class="code" href="Array__tools_8cpp.html#a07eed4c823b0632bdbf353fdab2a3c6b" title="Trie le tableau tab dans l&#39;ordre lexicographique et retire les doublons (attention [1...">tableau_trier_retirer_doublons</a>(Indice);
<a name="l00110"></a>00110   <span class="keywordflow">if</span> (nb_comp==1)
<a name="l00111"></a>00111     la_matrice.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(Indice);
<a name="l00112"></a>00112   <span class="keywordflow">else</span>
<a name="l00113"></a>00113     {
<a name="l00114"></a>00114       <span class="keywordtype">int</span> ntot=Indice.dimension(0);
<a name="l00115"></a>00115 <span class="comment">// on cree pour chaque coeff d&#39;origine un bloc nb_comp*nb_comp</span>
<a name="l00116"></a>00116       <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> Indice_v(ntot*nb_comp*nb_comp,2);
<a name="l00117"></a>00117       <span class="keywordtype">int</span> newcas=0;
<a name="l00118"></a>00118       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cas=0; cas&lt;ntot; cas++)
<a name="l00119"></a>00119         {
<a name="l00120"></a>00120           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_comp; i++)
<a name="l00121"></a>00121             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nb_comp; j++)
<a name="l00122"></a>00122               {
<a name="l00123"></a>00123                 <span class="keywordtype">int</span> newi=Indice(cas,0)*nb_comp+i;
<a name="l00124"></a>00124                 <span class="keywordtype">int</span> newj=Indice(cas,1)*nb_comp+j;
<a name="l00125"></a>00125                 Indice_v(newcas,0)=newi;
<a name="l00126"></a>00126                 Indice_v(newcas,1)=newj;
<a name="l00127"></a>00127                 newcas++;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129               }
<a name="l00130"></a>00130         }
<a name="l00131"></a>00131       <a class="code" href="Array__tools_8cpp.html#a07eed4c823b0632bdbf353fdab2a3c6b" title="Trie le tableau tab dans l&#39;ordre lexicographique et retire les doublons (attention [1...">tableau_trier_retirer_doublons</a>(Indice_v);
<a name="l00132"></a>00132       la_matrice.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(Indice_v);
<a name="l00133"></a>00133 <span class="comment">// Cerr&lt;&lt;Indice&lt;&lt;&quot; nnnnnnnnn &quot;&lt;&lt;Indice_v&lt;&lt;finl;</span>
<a name="l00134"></a>00134 <span class="comment">// abort();</span>
<a name="l00135"></a>00135     }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137   assert(<a class="code" href="DoubleVect_8cpp.html#a55e600bcf8a03e258531f83869c4d060">mp_min_vect</a>(la_matrice.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>())&gt;-1);
<a name="l00138"></a>00138 
<a name="l00139"></a>00139   <span class="keywordflow">if</span> (matrice_stocke)
<a name="l00140"></a>00140     {
<a name="l00141"></a>00141       <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>,<a class="code" href="classOp__EF__base.html#a1dd50d47cf5aea0c0b45e306497510a6">matrice_sto_</a>)=la_matrice;
<a name="l00142"></a>00142     }
<a name="l00143"></a>00143 <span class="comment">// </span>
<a name="l00144"></a>00144   <span class="keywordflow">if</span> (0)
<a name="l00145"></a>00145     {
<a name="l00146"></a>00146       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;la_matrice.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00147"></a>00147       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;la_matrice.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>()&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00148"></a>00148       la_matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>() = 1;
<a name="l00149"></a>00149       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;ici &quot;</span>&lt;&lt;tot &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt; nb_coeff&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00150"></a>00150       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Indice&quot;</span>&lt;&lt;Indice&lt;&lt;finl;
<a name="l00151"></a>00151       la_matrice.<a class="code" href="classMatrice__Morse.html#a60c1de967d05b21b9b96a9bf6d73334e">imprimer_formatte</a>(<a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00154"></a>00154     }
<a name="l00155"></a>00155 
<a name="l00156"></a>00156 }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 <span class="comment">// Description</span>
<a name="l00159"></a>00159 <span class="comment">// Modification des coef de la matrice et du second membre pour les conditions</span>
<a name="l00160"></a>00160 <span class="comment">// de Dirichlet</span>
<a name="l00161"></a>00161 
<a name="l00162"></a><a class="code" href="classOp__EF__base.html#aa5af83bf8b04516f29f9bfc7ffd32e95">00162</a> <span class="keywordtype">void</span> <a class="code" href="classOp__EF__base.html#aa5af83bf8b04516f29f9bfc7ffd32e95">Op_EF_base::modifier_pour_Cl</a>(<span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; la_zone,
<a name="l00163"></a>00163                                   <span class="keyword">const</span> <a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>&amp; la_zone_cl,
<a name="l00164"></a>00164                                   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; la_matrice, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; secmem)<span class="keyword"> const</span>
<a name="l00165"></a>00165 <span class="keyword"></span>{
<a name="l00166"></a>00166 <span class="comment">// Cerr&lt;&lt;__PRETTY_FUNCTION__&lt;&lt;&quot; ne fait rien &quot;&lt;&lt;finl; return;</span>
<a name="l00167"></a>00167   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;__PRETTY_FUNCTION__&lt;&lt;<span class="stringliteral">&quot; a revoir &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 <span class="comment">// Dimensionnement de la matrice qui devra recevoir les coefficients provenant de</span>
<a name="l00170"></a>00170 <span class="comment">// la convection, de la diffusion pour le cas des faces.</span>
<a name="l00171"></a>00171 <span class="comment">// Cette matrice a une structure de matrice morse.</span>
<a name="l00172"></a>00172 <span class="comment">// Nous commencons par calculer les tailles des tableaux tab1 et tab2.</span>
<a name="l00173"></a>00173 
<a name="l00174"></a>00174   <span class="keywordtype">int</span>   k, nbvois;
<a name="l00175"></a>00175 <span class="comment">// int nfin = la_zone.nb_faces();</span>
<a name="l00176"></a>00176   <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; les_cl = la_zone_cl.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>();
<a name="l00177"></a>00177 
<a name="l00178"></a>00178   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1=la_matrice.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>();
<a name="l00179"></a>00179   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = la_matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l00180"></a>00180 
<a name="l00181"></a>00181 <span class="comment">// determination de la taille du champ inconnue.</span>
<a name="l00182"></a>00182 <span class="comment">// Cerr &lt;&lt; &quot;dans modifier cl &quot; &lt;&lt; finl;</span>
<a name="l00183"></a>00183   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; champ_inconnue = la_zone_cl.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00184"></a>00184   <span class="keywordtype">int</span> nb_comp = champ_inconnue.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00185"></a>00185 
<a name="l00186"></a>00186   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_sommets=la_zone.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l00187"></a>00187   <span class="keywordtype">int</span> nb_som_face=faces_sommets.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00188"></a>00188 
<a name="l00189"></a>00189   <span class="keywordtype">int</span> nb_som=secmem.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00190"></a>00190 <span class="comment">// Cerr &lt;&lt; &quot;nb_comp &quot; &lt;&lt; nb_comp &lt;&lt; finl;</span>
<a name="l00191"></a>00191   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;les_cl.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); i++)
<a name="l00192"></a>00192     {
<a name="l00193"></a>00193       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = les_cl[i];
<a name="l00194"></a>00194       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00195"></a>00195       <span class="keywordtype">int</span> nfaces = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00196"></a>00196       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00197"></a>00197         {
<a name="l00198"></a>00198           <span class="keyword">const</span> <a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>&amp; la_cl_Dirichlet = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00199"></a>00199           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face &lt; nfaces; ind_face++)
<a name="l00200"></a>00200             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=0; s&lt;nb_som_face; s++)
<a name="l00201"></a>00201               {
<a name="l00202"></a>00202                 <span class="keywordtype">int</span> face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00203"></a>00203                 <span class="keywordtype">int</span> som=faces_sommets(face,s);
<a name="l00204"></a>00204                 <span class="keywordflow">if</span> (som&lt;nb_som)
<a name="l00205"></a>00205                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l00206"></a>00206                     {
<a name="l00207"></a>00207                       <span class="keywordtype">int</span> m=som*nb_comp+comp;
<a name="l00208"></a>00208                       <span class="keywordtype">int</span> idiag = tab1[som*nb_comp+comp]-1;
<a name="l00209"></a>00209                       nbvois = tab1[som*nb_comp+1+comp] - tab1[som*nb_comp+comp];
<a name="l00210"></a>00210                       <span class="keywordflow">for</span> (k=0; k &lt; nbvois; k++)
<a name="l00211"></a>00211                         {
<a name="l00212"></a>00212                           coeff[idiag+k]=0;
<a name="l00213"></a>00213                         }
<a name="l00214"></a>00214                       la_matrice.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>(m,m)=1;
<a name="l00215"></a>00215                       assert(la_matrice.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>(som*nb_comp+comp,som*nb_comp+comp)==1);
<a name="l00216"></a>00216 <span class="comment">// pour les voisins</span>
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 <span class="comment">// pour le second membre</span>
<a name="l00220"></a>00220                       secmem(som,comp)= la_cl_Dirichlet.<a class="code" href="classDirichlet.html#ab59a2214e3208ac45048a2232c132803" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps par defaut du cham...">val_imp</a>(ind_face,comp);
<a name="l00221"></a>00221                       secmem(som,comp)= champ_inconnue(som,comp);
<a name="l00222"></a>00222                     }
<a name="l00223"></a>00223               }
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00226"></a>00226         {
<a name="l00227"></a>00227           <span class="keyword">const</span> <a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>&amp; la_cl_Dirichlet = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00228"></a>00228           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face &lt; nfaces; ind_face++)
<a name="l00229"></a>00229             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=0; s&lt;nb_som_face; s++)
<a name="l00230"></a>00230               {
<a name="l00231"></a>00231                 <span class="keywordtype">int</span> face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00232"></a>00232                 <span class="keywordtype">int</span> som=faces_sommets(face,s);
<a name="l00233"></a>00233 
<a name="l00234"></a>00234                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l00235"></a>00235                   {
<a name="l00236"></a>00236                     <span class="keywordtype">int</span> m=som*nb_comp+comp;
<a name="l00237"></a>00237                     <span class="keywordtype">int</span> idiag = tab1[som*nb_comp+comp]-1;
<a name="l00238"></a>00238                     nbvois = tab1[som*nb_comp+1+comp] - tab1[som*nb_comp+comp];
<a name="l00239"></a>00239                     <span class="keywordflow">for</span> (k=0; k &lt; nbvois; k++)
<a name="l00240"></a>00240                       {
<a name="l00241"></a>00241                         coeff[idiag+k]=0;
<a name="l00242"></a>00242                       }
<a name="l00243"></a>00243                     la_matrice.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>(m,m)=1;
<a name="l00244"></a>00244                     assert(la_matrice.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>(som*nb_comp+comp,som*nb_comp+comp)==1);
<a name="l00245"></a>00245 <span class="comment">// pour les voisins</span>
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 <span class="comment">// pour le second membre</span>
<a name="l00249"></a>00249                     secmem(som,comp)= 0;
<a name="l00250"></a>00250                     <span class="keywordflow">if</span> (la_cl_Dirichlet.<a class="code" href="classDirichlet__homogene.html#a79fd7fbac0243313b42a2c6b79eb546a" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere. Toujours 0 pour Dirichlet ...">val_imp</a>(ind_face,comp)!=0)
<a name="l00251"></a>00251                       {
<a name="l00252"></a>00252                         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;impossible non ??? &quot;</span>&lt;&lt;finl;
<a name="l00253"></a>00253                         <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00254"></a>00254                       }
<a name="l00255"></a>00255                   }
<a name="l00256"></a>00256               }
<a name="l00257"></a>00257         }
<a name="l00258"></a>00258 
<a name="l00259"></a>00259       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classSymetrie.html" title="classe Symetrie Sur les faces de symetrie on a les proprietes suivantes: - composante normale de la v...">Symetrie</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00260"></a>00260         {
<a name="l00261"></a>00261 <span class="comment">// on ne fait rien ici on fait ensuite</span>
<a name="l00262"></a>00262         }
<a name="l00263"></a>00263     }
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 <span class="comment">// On modifie pour la symetrie</span>
<a name="l00266"></a>00266 
<a name="l00267"></a>00267   <span class="keywordflow">if</span> (la_zone_cl.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>().<a class="code" href="classField__base.html#a75bf4e0a6258589a83801c0383d049cc" title="Renvoie la nature d&#39;un champ (scalaire, multiscalaire, vectoriel).">nature_du_champ</a>()==<a class="code" href="Field__base_8h.html#a1b86c8f670a9b34da7f628a821fb646ba66d795f4e2fbb5636a3966c73964c5e7">vectoriel</a>)
<a name="l00268"></a>00268     {
<a name="l00269"></a>00269       la_zone_cl.<a class="code" href="classZone__Cl__EF.html#a9c1a86d8d701b4849c23a6756ca68f43">imposer_symetrie_matrice_secmem</a>(la_matrice,secmem);
<a name="l00270"></a>00270     }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272   <span class="comment">/*</span>
<a name="l00273"></a>00273 <span class="comment">    la_matrice.imprimer(Cerr);</span>
<a name="l00274"></a>00274 <span class="comment">    la_matrice.imprimer_formatte(Cerr);</span>
<a name="l00275"></a>00275 <span class="comment">    Cerr&lt;&lt;&quot;scd &quot;&lt;&lt;secmem&lt;&lt;finl;</span>
<a name="l00276"></a>00276 <span class="comment">    */</span>
<a name="l00277"></a>00277 <span class="comment">// exit();</span>
<a name="l00278"></a>00278 <span class="comment">// Prise en compte des conditions de type periodicite</span>
<a name="l00279"></a>00279 <span class="comment">// Cerr &lt;&lt; &quot;fin de modifier&quot; &lt;&lt; finl;</span>
<a name="l00280"></a>00280 }
<a name="l00281"></a>00281 
<a name="l00282"></a>00282 <span class="comment">// Description multiplie le flux bordpar rho cp ou rho si necessaire</span>
<a name="l00283"></a><a class="code" href="classOp__EF__base.html#a7d8b39ad16163676b21ee9b8456ce5fe">00283</a> <span class="keywordtype">void</span> <a class="code" href="classOp__EF__base.html#a7d8b39ad16163676b21ee9b8456ce5fe">Op_EF_base::modifier_flux</a>( <span class="keyword">const</span> <a class="code" href="classOperateur__base.html" title="classe Operateur_base Classe est la base de la hierarchie des objets representant un operateur utilis...">Operateur_base</a>&amp; op)<span class="keyword"> const</span>
<a name="l00284"></a>00284 <span class="keyword"></span>{
<a name="l00285"></a>00285   <a class="code" href="classOp__EF__base.html#ac6ea5a7906e83db93088c9cc1b5be686">controle_modifier_flux_</a>=1;
<a name="l00286"></a>00286   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; la_zone_EF=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,op.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>());
<a name="l00287"></a>00287   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; flux_bords_=op.<a class="code" href="classOperateur__base.html#ab547b37ace0f04931f6f09fcfa8fae0c">flux_bords</a>();
<a name="l00288"></a>00288   <span class="keywordtype">int</span> nb_compo=flux_bords_.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00289"></a>00289   <span class="keyword">const</span> <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb=op.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>();
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 <span class="comment">// On multiplie par rho si Navier Stokes incompressible</span>
<a name="l00292"></a>00292   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_eqn=op.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
<a name="l00293"></a>00293   <span class="keywordflow">if</span> (nom_eqn.<a class="code" href="classNom.html#a41b0ba18fb90d481c0828ed4372de8ee">debute_par</a>(<span class="stringliteral">&quot;Navier_Stokes&quot;</span>) &amp;&amp; pb.<a class="code" href="classProbleme__base.html#aa51e16d0fb82fdce0019358267307d18" title="Renvoie le milieu physique associe au probleme. (version const) On renvoie le milieu associe a la pre...">milieu</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;Fluide_Incompressible&quot;</span>)
<a name="l00294"></a>00294     {
<a name="l00295"></a>00295       <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; rho = op.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a181e9899e2d927eb14c835d9d9334f46">milieu</a>().<a class="code" href="classMilieu__base.html#a46a9a4bfb046ed22d0f267b6c052889f" title="Renvoie la masse volumique du milieu. (version const)">masse_volumique</a>();
<a name="l00296"></a>00296       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Uniforme.html" title="classe Champ_Uniforme Represente un champ constant dans l&#39;espace et dans le temps.">Champ_Uniforme</a>,rho))
<a name="l00297"></a>00297         {
<a name="l00298"></a>00298           <span class="keywordtype">double</span> coef = rho(0,0);
<a name="l00299"></a>00299           <span class="keywordtype">int</span> nb_faces_bord=la_zone_EF.<a class="code" href="classZone__VF.html#a8815e2276637c0db23868f043dc43e58" title="renvoie le nombre de faces sur lesquelles sont appliquees les conditions limites : bords...">nb_faces_bord</a>();
<a name="l00300"></a>00300           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=0; face&lt;nb_faces_bord; face++)
<a name="l00301"></a>00301             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_compo; k++)
<a name="l00302"></a>00302               flux_bords_(face,k) *= coef;
<a name="l00303"></a>00303         }
<a name="l00304"></a>00304     }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306 }
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 <span class="comment">// Description</span>
<a name="l00309"></a>00309 <span class="comment">// Impression des flux d&#39;un operateur EF aux faces (ie: diffusion, convection)</span>
<a name="l00310"></a>00310 <span class="comment">// </span>
<a name="l00311"></a><a class="code" href="classOp__EF__base.html#a4528faf155b549542c6884155851ad1a">00311</a> <span class="keywordtype">int</span> <a class="code" href="classOp__EF__base.html#a4528faf155b549542c6884155851ad1a">Op_EF_base::impr</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os, <span class="keyword">const</span> <a class="code" href="classOperateur__base.html" title="classe Operateur_base Classe est la base de la hierarchie des objets representant un operateur utilis...">Operateur_base</a>&amp; op)<span class="keyword"> const</span>
<a name="l00312"></a>00312 <span class="keyword"></span>{
<a name="l00313"></a>00313   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; la_zone_EF=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>,op.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>());
<a name="l00314"></a>00314   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; flux_bords_=op.<a class="code" href="classOperateur__base.html#ab547b37ace0f04931f6f09fcfa8fae0c">flux_bords</a>();
<a name="l00315"></a>00315   <span class="keywordflow">if</span> (flux_bords_.nb_dim()!=2)
<a name="l00316"></a>00316     {
<a name="l00317"></a>00317       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;L&#39;impression des flux n&#39;est pas codee pour l&#39;operateur &quot;</span> &lt;&lt; op.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00318"></a>00318       <span class="keywordflow">return</span> 1;
<a name="l00319"></a>00319     }
<a name="l00320"></a>00320   <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#ac6ea5a7906e83db93088c9cc1b5be686">controle_modifier_flux_</a>==0)
<a name="l00321"></a>00321     {
<a name="l00322"></a>00322       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;op.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot; appelle  Op_EF_base::impr sans avoir appeler  Op_EF_base::modifier_flux, on arrete tout &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00323"></a>00323       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00324"></a>00324     }
<a name="l00325"></a>00325 
<a name="l00326"></a>00326   <span class="keywordtype">int</span> nb_compo=flux_bords_.dimension(1);
<a name="l00327"></a>00327   <span class="keyword">const</span> <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb=op.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>();
<a name="l00328"></a>00328   <span class="keyword">const</span> <a class="code" href="classSchema__Temps__base.html" title="classe Schema_Temps_base">Schema_Temps_base</a>&amp; sch=pb.<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>();
<a name="l00329"></a>00329 <span class="comment">// On n&#39;imprime les moments que si demande et si on traite l&#39;operateur de diffusion de la vitesse</span>
<a name="l00330"></a>00330   <span class="keywordtype">int</span> impr_mom=0;
<a name="l00331"></a>00331   <span class="keywordflow">if</span> (la_zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a1147c5a9ff1ba84a899979712734cb28">Moments_a_imprimer</a>() &amp;&amp; <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classOperateur__Diff__base.html" title="classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...">Operateur_Diff_base</a>,op) &amp;&amp; op.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classO__U__Ptr.html#a5aae0c48048a40339f3847aa14109231" title="Renvoie ref_().le_nom() si le pointeur est non nul ou &quot;Pointeur Nul&quot;.">le_nom</a>()==<span class="stringliteral">&quot;vitesse&quot;</span>)
<a name="l00332"></a>00332     impr_mom=1;
<a name="l00333"></a>00333 
<a name="l00334"></a>00334   <span class="keyword">const</span> <span class="keywordtype">int</span> impr_sum=(la_zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa5780fa644b13f8172c4805336846dec">Bords_a_imprimer_sum</a>().<a class="code" href="classliste.html#a68a1377a9c67f05e76638da8d93e2d5a" title="Teste si la liste est vide.">est_vide</a>() ? 0:1);
<a name="l00335"></a>00335   <span class="keyword">const</span> <span class="keywordtype">int</span> impr_bord=(la_zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a2e4f80965f20d39334b470af7aec494a">Bords_a_imprimer</a>().<a class="code" href="classliste.html#a68a1377a9c67f05e76638da8d93e2d5a" title="Teste si la liste est vide.">est_vide</a>() ? 0:1);
<a name="l00336"></a>00336   <span class="keywordtype">int</span> flag=0;
<a name="l00337"></a>00337   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>()) flag=1;
<a name="l00338"></a>00338 <span class="comment">// SFichier Flux;</span>
<a name="l00339"></a>00339   <span class="keywordflow">if</span> (!<a class="code" href="classOp__EF__base.html#adc9b5bc3b26740db58ab943ceeacda72">Flux</a>.<a class="code" href="classSortie__Fichier__base.html#acc0244cc2feedba886b643e9b3c295db">is_open</a>()) op.<a class="code" href="classOperateur__base.html#a163b8e77d9ad86d8c0cdd28d29903538" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier</a>( <a class="code" href="classOp__EF__base.html#adc9b5bc3b26740db58ab943ceeacda72">Flux</a>,<span class="stringliteral">&quot;&quot;</span>,flag);
<a name="l00340"></a>00340 <span class="comment">// SFichier Flux_moment;</span>
<a name="l00341"></a>00341   <span class="keywordflow">if</span> (!<a class="code" href="classOp__EF__base.html#ae3c51f21f91f7edbffc87e99303b737a">Flux_moment</a>.<a class="code" href="classSortie__Fichier__base.html#acc0244cc2feedba886b643e9b3c295db">is_open</a>()) op.<a class="code" href="classOperateur__base.html#a163b8e77d9ad86d8c0cdd28d29903538" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier</a>(<a class="code" href="classOp__EF__base.html#ae3c51f21f91f7edbffc87e99303b737a">Flux_moment</a>,<span class="stringliteral">&quot;moment&quot;</span>,impr_mom&amp;&amp;flag);
<a name="l00342"></a>00342 <span class="comment">// SFichier Flux_sum;</span>
<a name="l00343"></a>00343   <span class="keywordflow">if</span> (!<a class="code" href="classOp__EF__base.html#a914a2e0692c5e3c2031b95b1c62a740a" title="Fichiers .out.">Flux_sum</a>.<a class="code" href="classSortie__Fichier__base.html#acc0244cc2feedba886b643e9b3c295db">is_open</a>()) op.<a class="code" href="classOperateur__base.html#a163b8e77d9ad86d8c0cdd28d29903538" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier</a>(<a class="code" href="classOp__EF__base.html#a914a2e0692c5e3c2031b95b1c62a740a" title="Fichiers .out.">Flux_sum</a>,<span class="stringliteral">&quot;sum&quot;</span>,impr_sum&amp;&amp;flag);
<a name="l00344"></a>00344   <a class="code" href="classEcrFicPartage.html">EcrFicPartage</a> Flux_face;
<a name="l00345"></a>00345   op.<a class="code" href="classOperateur__base.html#a75f3b320ba6d2b58ab1a43a10f317de4" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier_partage</a>(Flux_face,<span class="stringliteral">&quot;&quot;</span>,impr_bord);
<a name="l00346"></a>00346 
<a name="l00347"></a>00347 
<a name="l00348"></a>00348 <span class="comment">// Impression du temps</span>
<a name="l00349"></a>00349   <span class="keywordtype">double</span> temps=sch.<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>();
<a name="l00350"></a>00350   <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
<a name="l00351"></a>00351     {
<a name="l00352"></a>00352       <a class="code" href="classOp__EF__base.html#adc9b5bc3b26740db58ab943ceeacda72">Flux</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(temps);
<a name="l00353"></a>00353       <span class="keywordflow">if</span> (impr_mom) <a class="code" href="classOp__EF__base.html#ae3c51f21f91f7edbffc87e99303b737a">Flux_moment</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(temps);
<a name="l00354"></a>00354       <span class="keywordflow">if</span> (impr_sum) <a class="code" href="classOp__EF__base.html#a914a2e0692c5e3c2031b95b1c62a740a" title="Fichiers .out.">Flux_sum</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(temps);
<a name="l00355"></a>00355     }
<a name="l00356"></a>00356 
<a name="l00357"></a>00357 <span class="comment">// Calcul des moments</span>
<a name="l00358"></a>00358   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces =  la_zone_EF.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
<a name="l00359"></a>00359   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> xgr(nb_faces,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>);
<a name="l00360"></a>00360   xgr=0.;
<a name="l00361"></a>00361   <a class="code" href="classDoubleVect.html">DoubleVect</a> moment(nb_compo);
<a name="l00362"></a>00362   moment=0;
<a name="l00363"></a>00363   <span class="keywordflow">if</span> (impr_mom)
<a name="l00364"></a>00364     {
<a name="l00365"></a>00365       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xgrav = la_zone_EF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00366"></a>00366       <span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; c_grav=la_zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ab6b13609a679b31cc3a6931362490e2a">cg_moments</a>();
<a name="l00367"></a>00367       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=0; num_face &lt;nb_faces; num_face++)
<a name="l00368"></a>00368         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; i++)
<a name="l00369"></a>00369           xgr(num_face,i)=xgrav(num_face,i)-c_grav(i);
<a name="l00370"></a>00370     }
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 <span class="comment">// On parcours les frontieres pour sommer les flux par frontiere dans le tableau flux_bord</span>
<a name="l00373"></a>00373   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux_bord(nb_compo);
<a name="l00374"></a>00374   <a class="code" href="classDoubleVect.html">DoubleVect</a> bilan(nb_compo);
<a name="l00375"></a>00375   bilan = 0;
<a name="l00376"></a>00376   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;la_zone_EF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); num_cl++)
<a name="l00377"></a>00377     {
<a name="l00378"></a>00378       flux_bord=0;
<a name="l00379"></a>00379       <span class="keyword">const</span> <a class="code" href="classFrontiere__dis__base.html" title="classe Frontiere_dis_base Classe representant une frontiere discretisee. Les objets Frontiere_dis_bas...">Frontiere_dis_base</a>&amp; la_fr = op.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classZone__Cl__dis.html#aafbd0525703e23200e31796bcd4fcac6" title="Appel a l&#39;objet sous-jacent Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(num_cl).<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>();
<a name="l00380"></a>00380       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = op.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classZone__Cl__dis.html#aafbd0525703e23200e31796bcd4fcac6" title="Appel a l&#39;objet sous-jacent Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(num_cl);
<a name="l00381"></a>00381       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00382"></a>00382       <span class="keywordtype">int</span> ndeb = frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00383"></a>00383       <span class="keywordtype">int</span> nfin = ndeb + frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00384"></a>00384       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=ndeb; face&lt;nfin; face++)
<a name="l00385"></a>00385         {
<a name="l00386"></a>00386           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_compo; k++)
<a name="l00387"></a>00387             flux_bord(k)+=flux_bords_(face, k);
<a name="l00388"></a>00388 
<a name="l00389"></a>00389           <span class="keywordflow">if</span> (impr_mom)
<a name="l00390"></a>00390             {
<a name="l00391"></a>00391 <span class="comment">// Calcul du moment exerce par le fluide sur le bord (OM/\F)</span>
<a name="l00392"></a>00392               <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
<a name="l00393"></a>00393                 moment(0)+=flux_bords_(face,1)*xgr(face,0)-flux_bords_(face,0)*xgr(face,1);
<a name="l00394"></a>00394               <span class="keywordflow">else</span>
<a name="l00395"></a>00395                 {
<a name="l00396"></a>00396                   moment(0)+=flux_bords_(face,2)*xgr(face,1)-flux_bords_(face,1)*xgr(face,2);
<a name="l00397"></a>00397                   moment(1)+=flux_bords_(face,0)*xgr(face,2)-flux_bords_(face,2)*xgr(face,0);
<a name="l00398"></a>00398                   moment(2)+=flux_bords_(face,1)*xgr(face,0)-flux_bords_(face,0)*xgr(face,1);
<a name="l00399"></a>00399                 }
<a name="l00400"></a>00400             }
<a name="l00401"></a>00401         }
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 <span class="comment">// On somme les contributions de chaque processeur</span>
<a name="l00404"></a>00404       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_compo; k++)
<a name="l00405"></a>00405         {
<a name="l00406"></a>00406           flux_bord(k)=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(flux_bord(k));
<a name="l00407"></a>00407           <span class="keywordflow">if</span> (impr_mom) moment(k)=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(moment(k));
<a name="l00408"></a>00408         }
<a name="l00409"></a>00409 
<a name="l00410"></a>00410 <span class="comment">// Ecriture dans les fichiers</span>
<a name="l00411"></a>00411       <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
<a name="l00412"></a>00412         {
<a name="l00413"></a>00413           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_compo; k++)
<a name="l00414"></a>00414             {
<a name="l00415"></a>00415               <a class="code" href="classOp__EF__base.html#adc9b5bc3b26740db58ab943ceeacda72">Flux</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(flux_bord(k));
<a name="l00416"></a>00416               <span class="keywordflow">if</span> (impr_mom) <a class="code" href="classOp__EF__base.html#ae3c51f21f91f7edbffc87e99303b737a">Flux_moment</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(moment(k));
<a name="l00417"></a>00417               <span class="keywordflow">if</span> (la_zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa5780fa644b13f8172c4805336846dec">Bords_a_imprimer_sum</a>().<a class="code" href="classList__Nom.html#aafe66fe06c0dd82cb2641fcaf774db07">contient</a>(la_fr.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>())) <a class="code" href="classOp__EF__base.html#a914a2e0692c5e3c2031b95b1c62a740a" title="Fichiers .out.">Flux_sum</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(flux_bord(k));
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 <span class="comment">// On somme les flux de toutes les frontieres pour mettre dans le tableau bilan</span>
<a name="l00420"></a>00420               bilan(k)+=flux_bord(k);
<a name="l00421"></a>00421             }
<a name="l00422"></a>00422         }
<a name="l00423"></a>00423     }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425 <span class="comment">// On imprime les bilans et on va a la ligne</span>
<a name="l00426"></a>00426   <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
<a name="l00427"></a>00427     {
<a name="l00428"></a>00428       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_compo; k++)
<a name="l00429"></a>00429         <a class="code" href="classOp__EF__base.html#adc9b5bc3b26740db58ab943ceeacda72">Flux</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(bilan(k));
<a name="l00430"></a>00430 
<a name="l00431"></a>00431       <a class="code" href="classOp__EF__base.html#adc9b5bc3b26740db58ab943ceeacda72">Flux</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00432"></a>00432       <span class="keywordflow">if</span> (impr_mom) <a class="code" href="classOp__EF__base.html#ae3c51f21f91f7edbffc87e99303b737a">Flux_moment</a> &lt;&lt; finl;
<a name="l00433"></a>00433       <span class="keywordflow">if</span> (impr_sum) <a class="code" href="classOp__EF__base.html#a914a2e0692c5e3c2031b95b1c62a740a" title="Fichiers .out.">Flux_sum</a> &lt;&lt; finl;
<a name="l00434"></a>00434     }
<a name="l00435"></a>00435 
<a name="l00436"></a>00436 <span class="comment">// Impression sur chaque face si demande</span>
<a name="l00437"></a>00437   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;la_zone_EF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); num_cl++)
<a name="l00438"></a>00438     {
<a name="l00439"></a>00439       <span class="keyword">const</span> <a class="code" href="classFrontiere__dis__base.html" title="classe Frontiere_dis_base Classe representant une frontiere discretisee. Les objets Frontiere_dis_bas...">Frontiere_dis_base</a>&amp; la_fr = op.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classZone__Cl__dis.html#aafbd0525703e23200e31796bcd4fcac6" title="Appel a l&#39;objet sous-jacent Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(num_cl).<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>();
<a name="l00440"></a>00440       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = op.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classZone__Cl__dis.html#aafbd0525703e23200e31796bcd4fcac6" title="Appel a l&#39;objet sous-jacent Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(num_cl);
<a name="l00441"></a>00441       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00442"></a>00442       <span class="keywordtype">int</span> ndeb = frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00443"></a>00443       <span class="keywordtype">int</span> nfin = ndeb + frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00444"></a>00444 <span class="comment">// Impression sur chaque face</span>
<a name="l00445"></a>00445       <span class="keywordflow">if</span> (la_zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a2e4f80965f20d39334b470af7aec494a">Bords_a_imprimer</a>().<a class="code" href="classList__Nom.html#aafe66fe06c0dd82cb2641fcaf774db07">contient</a>(la_fr.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>()))
<a name="l00446"></a>00446         {
<a name="l00447"></a>00447           Flux_face &lt;&lt; <span class="stringliteral">&quot;# Flux par face sur &quot;</span> &lt;&lt; la_fr.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; au temps &quot;</span> &lt;&lt; temps &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00448"></a>00448           <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xv=la_zone_EF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00449"></a>00449           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=ndeb; face&lt;nfin; face++)
<a name="l00450"></a>00450             {
<a name="l00451"></a>00451               <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
<a name="l00452"></a>00452                 Flux_face &lt;&lt; <span class="stringliteral">&quot;# Face a x= &quot;</span> &lt;&lt; xv(face,0) &lt;&lt; <span class="stringliteral">&quot; y= &quot;</span> &lt;&lt; xv(face,1) &lt;&lt; <span class="stringliteral">&quot; flux=&quot;</span> ;
<a name="l00453"></a>00453               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
<a name="l00454"></a>00454                 Flux_face &lt;&lt; <span class="stringliteral">&quot;# Face a x= &quot;</span> &lt;&lt; xv(face,0) &lt;&lt; <span class="stringliteral">&quot; y= &quot;</span> &lt;&lt; xv(face,1) &lt;&lt; <span class="stringliteral">&quot; z= &quot;</span> &lt;&lt; xv(face,2) &lt;&lt; <span class="stringliteral">&quot; flux=&quot;</span> ;
<a name="l00455"></a>00455               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_compo; k++)
<a name="l00456"></a>00456                 Flux_face &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flux_bords_(face, k);
<a name="l00457"></a>00457               Flux_face &lt;&lt; finl;
<a name="l00458"></a>00458             }
<a name="l00459"></a>00459           Flux_face.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00460"></a>00460         }
<a name="l00461"></a>00461     }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463   <span class="keywordflow">return</span> 1;
<a name="l00464"></a>00464 }
<a name="l00465"></a>00465 
<a name="l00466"></a><a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">00466</a> <span class="keywordtype">int</span> <a class="code" href="classOp__EF__base.html#a0efe5445b9ba8c161385f5479722147d">Op_EF_base::elem_contribue</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; elem)<span class="keyword"> const</span>
<a name="l00467"></a>00467 <span class="keyword"></span>{
<a name="l00468"></a>00468   <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#ab375aec114aa55deb4c4e66d30b31b4e">marqueur_elem_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()==0)
<a name="l00469"></a>00469     <span class="keywordflow">return</span> 1;
<a name="l00470"></a>00470   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classOp__EF__base.html#ab375aec114aa55deb4c4e66d30b31b4e">marqueur_elem_</a>(elem)==1)
<a name="l00471"></a>00471     <span class="keywordflow">return</span> 0;
<a name="l00472"></a>00472   <span class="keywordflow">return</span> 1;
<a name="l00473"></a>00473 }
<a name="l00474"></a>00474 
<a name="l00475"></a><a class="code" href="classOp__EF__base.html#a080c1044520da3366eb94ec3a92eb9da">00475</a> <span class="keywordtype">void</span>  <a class="code" href="classOp__EF__base.html#a080c1044520da3366eb94ec3a92eb9da">Op_EF_base::marque_elem</a>(<span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn)
<a name="l00476"></a>00476 {
<a name="l00477"></a>00477   <span class="keywordflow">try</span>
<a name="l00478"></a>00478     {
<a name="l00479"></a>00479       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; marq=eqn.<a class="code" href="classEquation__base.html#ad6bcab0bb6d83b1b563a7aa30f0df721">get_champ</a>(<span class="stringliteral">&quot;marqueur_loi_de_paroi&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l00480"></a>00480       <span class="keywordtype">int</span> ntot=marq.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
<a name="l00481"></a>00481       <a class="code" href="classOp__EF__base.html#ab375aec114aa55deb4c4e66d30b31b4e">marqueur_elem_</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(ntot);
<a name="l00482"></a>00482       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n=0; n&lt;ntot; n++)
<a name="l00483"></a>00483         <span class="keywordflow">if</span> (marq(n)&gt;0)
<a name="l00484"></a>00484           <a class="code" href="classOp__EF__base.html#ab375aec114aa55deb4c4e66d30b31b4e">marqueur_elem_</a>(n)=1;
<a name="l00485"></a>00485     }
<a name="l00486"></a>00486   <span class="keywordflow">catch</span>  (<a class="code" href="classChamps__compris__erreur.html">Champs_compris_erreur</a>)
<a name="l00487"></a>00487     {
<a name="l00488"></a>00488     }
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 }
<a name="l00491"></a>00491 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:11 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
