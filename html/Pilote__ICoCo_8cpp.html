<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/ICoCo/Pilote_ICoCo.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">src/Kernel/ICoCo/Pilote_ICoCo.cpp File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="Pilote__ICoCo_8h_source.html">Pilote_ICoCo.h</a>&gt;</code><br/>
<code>#include &lt;ICoCoTrioField.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="ProblemTrio_8h_source.html">ProblemTrio.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="Param_8h_source.html">Param.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="Probleme__U_8h_source.html">Probleme_U.h</a>&gt;</code><br/>
</div>
<p><a href="Pilote__ICoCo_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Pilote__ICoCo_8cpp.html#a5df2bd0826f83142ec21936e36060599">main_pilote_icoco_1</a> (<a class="el" href="classProbleme__U.html">Probleme_U</a> &amp;pb_to_solve)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Fonction principale de l'interprete:<br/>
resoudre un probleme<br/>
Le probleme est pilote via l'interface <a class="el" href="namespaceICoCo.html">ICoCo</a><br/>
On lui fournit a chaque pas de temps les champs<br/>
d'entree "pression_sortie" et "vitesse_entree"<br/>
qui sont respectivement un ch_front_input et un ch_front_input_uniforme<br/>
Montre l'utilisation de l'avance en temps et des input fields.  <a href="#a5df2bd0826f83142ec21936e36060599"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Pilote__ICoCo_8cpp.html#a88a1cf32fde45cf76b772638a2cfc11b">main_pilote_icoco_2</a> (<a class="el" href="classProbleme__U.html">Probleme_U</a> &amp;pb_to_solve)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Fonction principale de l'interprete:<br/>
resoudre un probleme<br/>
Le probleme est pilote via l'interface <a class="el" href="namespaceICoCo.html">ICoCo</a>.<br/>
On lui fournit a chaque pas de temps le champ<br/>
d'entree "puissance" qui est un <a class="el" href="classChamp__input__P0.html" title="class Champ_input_P0 Cette classe represente un champ accessible par setInputField defini sur le doma...">Champ_input_P0</a><br/>
Montre l'utilisation de l'avance en temps et des input fields.  <a href="#a88a1cf32fde45cf76b772638a2cfc11b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Pilote__ICoCo_8cpp.html#ae72d158a0a398ed01579b25fa58dd550">main_abort</a> (<a class="el" href="classProbleme__U.html">Probleme_U</a> &amp;pb_to_solve)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Fonction principale de l'interprete:<br/>
resoudre un probleme<br/>
Le probleme est pilote via l'interface <a class="el" href="namespaceICoCo.html">ICoCo</a><br/>
Le troisieme pas de temps est effectue deux fois.  <a href="#ae72d158a0a398ed01579b25fa58dd550"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classType__info.html">Type_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Pilote__ICoCo_8cpp.html#af80d3da879e6abdebed575a2a19f38cd">Pilote_ICoCobases</a> [1] = { &amp;( <a class="el" href="classInterprete.html">Interprete</a> ::info_obj)}</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ae72d158a0a398ed01579b25fa58dd550"></a><!-- doxytag: member="Pilote_ICoCo.cpp::main_abort" ref="ae72d158a0a398ed01579b25fa58dd550" args="(Probleme_U &amp;pb_to_solve)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void main_abort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classProbleme__U.html">Probleme_U</a> &amp;&#160;</td>
          <td class="paramname"><em>pb_to_solve</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fonction principale de l'interprete:<br/>
resoudre un probleme<br/>
Le probleme est pilote via l'interface <a class="el" href="namespaceICoCo.html">ICoCo</a><br/>
Le troisieme pas de temps est effectue deux fois. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp;<br/>
 Signification: le flot d'entree modifie<br/>
 Contraintes: </dd></dl>

<p><p>&lt; Does the Problem want to stop ?</p>
<p>&lt; Is the time interval successfully solved ?</p>
<p>&lt; Loop on timesteps</p>
<p>&lt; Loop on timestep tries</p>
<p>&lt; The resolution failed, try with a new time interval</p>
<p>&lt; validate and go to the next time step </p>
</p>

<p>Definition at line <a class="el" href="Pilote__ICoCo_8cpp_source.html#l00317">317</a> of file <a class="el" href="Pilote__ICoCo_8cpp_source.html">Pilote_ICoCo.cpp</a>.</p>

<p>References <a class="el" href="ProblemTrio_8cpp_source.html#l00457">ICoCo::ProblemTrio::abortTimeStep()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00313">ICoCo::ProblemTrio::computeTimeStep()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Probleme__U_8cpp_source.html#l00705">ICoCo::ProblemTrio::getInputFieldTemplate()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00222">ICoCo::ProblemTrio::initialize_pb()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00337">ICoCo::ProblemTrio::initTimeStep()</a>, <a class="el" href="Probleme__U_8cpp_source.html#l00734">ICoCo::ProblemTrio::setInputField()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00359">ICoCo::ProblemTrio::solveTimeStep()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00247">ICoCo::ProblemTrio::terminate()</a>, and <a class="el" href="ProblemTrio_8cpp_source.html#l00388">ICoCo::ProblemTrio::validateTimeStep()</a>.</p>

<p>Referenced by <a class="el" href="Pilote__ICoCo_8cpp_source.html#l00379">Pilote_ICoCo::interpreter()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// char* pb_name=nom1.getChar();</span>
  <a class="code" href="classICoCo_1_1ProblemTrio.html" title="class ProblemTrio This class defines the API a problem has to implement in order to be coupled...">ProblemTrio</a> pb;
<span class="comment">// pb.setDataFile(pb_name);</span>

  pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#aa300012bfa1e8fdf8f0998ded6604476">initialize_pb</a>(pb_to_solve);

  <span class="keywordtype">bool</span> stop=<span class="keyword">false</span>; <span class="comment">//!&lt; Does the Problem want to stop ?</span>
<span class="comment"></span>  <span class="keywordtype">bool</span> ok=<span class="keyword">true</span>; <span class="comment">//!&lt; Is the time interval successfully solved ?</span>
<span class="comment"></span>  <span class="keywordtype">int</span> n=0;
<span class="comment">// loop on time step</span>
  <span class="keywordflow">while</span> (!stop)                       <span class="comment">//!&lt; Loop on timesteps</span>
<span class="comment"></span>    {

      ok=<span class="keyword">false</span>;

      <span class="keywordflow">while</span> (!ok &amp;&amp; !stop)                  <span class="comment">//!&lt; Loop on timestep tries</span>
<span class="comment"></span>        {

<span class="comment">// compute time step length</span>
          <span class="keywordtype">double</span> dt=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a5d5ae2c32f3b6019381bc82bc412d388" title="Compute the value the Problem would like for the next time step. This value will not necessarily be u...">computeTimeStep</a>(stop);

          <span class="keywordflow">if</span> (stop)
            <span class="keywordflow">break</span>;

<span class="comment">// prepare the new time step</span>
          pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#af8b628d457910075b2c6d14f2e07dd63" title="This method allocates and initializes the unknown and given fields for the future time step...">initTimeStep</a>(dt);

<span class="comment">// ---------------------</span>
<span class="comment">// Solve next time step</span>
<span class="comment">// ---------------------</span>

          {
            TrioField afield;
            <span class="keywordtype">int</span> nb_elems;
            pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#ade2266152954e04971eb6d6f4a7683c8" title="This method is used to get a template of a field expected for the given name.">getInputFieldTemplate</a>(<span class="stringliteral">&quot;temperature_bord&quot;</span>,afield);
            afield.set_standalone();
            nb_elems=afield._nb_elems;
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_elems; i++)
              afield._field[i]=600;
            pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#abf4fdc8b228db5e9f349b2c107cca7a6" title="This method is used to provide the Problem with an input field.">setInputField</a>(<span class="stringliteral">&quot;temperature_bord&quot;</span>,afield);
          }


          <span class="keywordtype">bool</span> ok2=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a1d5589f5f381269a9afdea61bbef9bc9" title="Calculates the unknown fields for the next time step. The default implementation uses iterations...">solveTimeStep</a>();

          n++;
          <span class="keywordflow">if</span> (!ok2 || n==3)   <span class="comment">//!&lt; The resolution failed, try with a new time interval</span>
<span class="comment"></span>            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; call of abortTimeStep&quot;</span> &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
              pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#ac4b3f7399bf44404a3d0602a9f49d56b" title="Aborts the resolution of the current time step.">abortTimeStep</a>();
            }
          <span class="keywordflow">else</span>   <span class="comment">//!&lt; validate and go to the next time step</span>
<span class="comment"></span>            {
              pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a80f50938a70bce9122d9d8f2b66636e9" title="Validates the calculated unknown by moving the present time at the end of the time step...">validateTimeStep</a>();
            }
        }                                     <span class="comment">//!&lt; End loop on timestep size</span>
<span class="comment"></span>    }                                   <span class="comment">//!&lt; End loop on timesteps</span>
<span class="comment"></span>
  pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#ac61416eacfa7c297e398d9d7a2ad499e" title="This method is called once at the end, after any other one. It frees the memory and saves anything th...">terminate</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5df2bd0826f83142ec21936e36060599"></a><!-- doxytag: member="Pilote_ICoCo.cpp::main_pilote_icoco_1" ref="a5df2bd0826f83142ec21936e36060599" args="(Probleme_U &amp;pb_to_solve)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void main_pilote_icoco_1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classProbleme__U.html">Probleme_U</a> &amp;&#160;</td>
          <td class="paramname"><em>pb_to_solve</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fonction principale de l'interprete:<br/>
resoudre un probleme<br/>
Le probleme est pilote via l'interface <a class="el" href="namespaceICoCo.html">ICoCo</a><br/>
On lui fournit a chaque pas de temps les champs<br/>
d'entree "pression_sortie" et "vitesse_entree"<br/>
qui sont respectivement un ch_front_input et un ch_front_input_uniforme<br/>
Montre l'utilisation de l'avance en temps et des input fields. </p>

<p><p>&lt; Does the Problem want to stop ?</p>
<p>&lt; Is the time interval successfully solved ?</p>
<p>&lt; Is the time interval successfully solved ?</p>
<p>&lt; ch_front_input_uniforme in the data file</p>
<p>&lt; The resolution failed, try with a new time interval.</p>
<p>&lt; The resolution was successful, validate and go to the next time step.</p>
<p>&lt; Impossible to solve the next time step, the Problem</p>
<p>&lt; has given up </p>
</p>

<p>Definition at line <a class="el" href="Pilote__ICoCo_8cpp_source.html#l00096">96</a> of file <a class="el" href="Pilote__ICoCo_8cpp_source.html">Pilote_ICoCo.cpp</a>.</p>

<p>References <a class="el" href="ProblemTrio_8cpp_source.html#l00457">ICoCo::ProblemTrio::abortTimeStep()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00313">ICoCo::ProblemTrio::computeTimeStep()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00511">ICoCo::ProblemTrio::getInputFieldsNames()</a>, <a class="el" href="Probleme__U_8cpp_source.html#l00705">ICoCo::ProblemTrio::getInputFieldTemplate()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00222">ICoCo::ProblemTrio::initialize_pb()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00337">ICoCo::ProblemTrio::initTimeStep()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00421">ICoCo::ProblemTrio::isStationary()</a>, <a class="el" href="Probleme__U_8h_source.html#l00110">Probleme_U::le_nom()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00290">ICoCo::ProblemTrio::presentTime()</a>, <a class="el" href="Probleme__U_8cpp_source.html#l00734">ICoCo::ProblemTrio::setInputField()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00359">ICoCo::ProblemTrio::solveTimeStep()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00247">ICoCo::ProblemTrio::terminate()</a>, and <a class="el" href="ProblemTrio_8cpp_source.html#l00388">ICoCo::ProblemTrio::validateTimeStep()</a>.</p>

<p>Referenced by <a class="el" href="Pilote__ICoCo_8cpp_source.html#l00379">Pilote_ICoCo::interpreter()</a>.</p>
<div class="fragment"><pre class="fragment">{

  <a class="code" href="classICoCo_1_1ProblemTrio.html" title="class ProblemTrio This class defines the API a problem has to implement in order to be coupled...">ProblemTrio</a> pb;

  <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> pb_name=pb_to_solve.<a class="code" href="classProbleme__U.html#af8a87e3d3e56126116071b75d9db19af" title="Donne le nom de l&#39;Objet_U Methode a surcharger : renvoie &quot;neant&quot; dans cette implementation.">le_nom</a>();
  pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#aa300012bfa1e8fdf8f0998ded6604476">initialize_pb</a>(pb_to_solve);

  <span class="keywordtype">bool</span> stop=<span class="keyword">false</span>; <span class="comment">//!&lt; Does the Problem want to stop ?</span>
<span class="comment"></span>  <span class="keywordtype">bool</span> ok=<span class="keyword">true</span>; <span class="comment">//!&lt; Is the time interval successfully solved ?</span>
<span class="comment"></span>
<span class="comment">// Compute the first time step length</span>
  <span class="keywordtype">double</span> dt=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a5d5ae2c32f3b6019381bc82bc412d388" title="Compute the value the Problem would like for the next time step. This value will not necessarily be u...">computeTimeStep</a>(stop);

<span class="comment">// Loop on the time steps</span>
  <span class="keywordflow">while</span>(!stop)
    {

      ok=<span class="keyword">false</span>; <span class="comment">//!&lt; Is the time interval successfully solved ?</span>
<span class="comment"></span>
<span class="comment">// Loop on the time interval tries</span>
      <span class="keywordflow">while</span> (!ok &amp;&amp; !stop)
        {

<span class="comment">// Prepare the next time step</span>
          ok=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#af8b628d457910075b2c6d14f2e07dd63" title="This method allocates and initializes the unknown and given fields for the future time step...">initTimeStep</a>(dt);
          <span class="keywordflow">if</span> (!ok)
            <span class="keywordflow">break</span>;

<span class="comment">// Example of field exchange</span>
          {
            vector&lt;string&gt; sv=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a6217ced035266ac0d92e9a433a0859a7" title="This method is used to find the names of input fields understood by the Problem.">getInputFieldsNames</a>();
            cout &lt;&lt; <span class="stringliteral">&quot;Input Fields for &quot;</span> &lt;&lt; pb_name &lt;&lt; <span class="stringliteral">&quot; :&quot;</span> &lt;&lt; endl;
            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;sv.size(); i++)
              std::cout &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;. &quot;</span> &lt;&lt; sv[i] &lt;&lt; std::endl;

            TrioField afield;
            <span class="keywordtype">int</span> nb_elems,nb_comp;

<span class="comment">// Get the right geometry &amp; nbcomp for &quot;pression_sortie&quot;</span>
            pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#ade2266152954e04971eb6d6f4a7683c8" title="This method is used to get a template of a field expected for the given name.">getInputFieldTemplate</a>(<span class="stringliteral">&quot;pression_sortie&quot;</span>,afield);
<span class="comment">// Allocate memory for the values (size=nb_elems*nb_comp)</span>
            afield.set_standalone();
<span class="comment">// Fill the values</span>
            nb_elems=afield._nb_elems;
            nb_comp=afield._nb_field_components;
            assert(nb_comp==1);
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_elems; i++)
              afield._field[i]=0;
<span class="comment">// Give the field to the problem</span>
            pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#abf4fdc8b228db5e9f349b2c107cca7a6" title="This method is used to provide the Problem with an input field.">setInputField</a>(<span class="stringliteral">&quot;pression_sortie&quot;</span>,afield);

<span class="comment">// Get the right geometry &amp; nbcomp for &quot;vitesse_entree&quot;</span>
            pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#ade2266152954e04971eb6d6f4a7683c8" title="This method is used to get a template of a field expected for the given name.">getInputFieldTemplate</a>(<span class="stringliteral">&quot;vitesse_entree&quot;</span>,afield);
<span class="comment">// Allocate memory for the values (size=nb_elems*nb_comp)</span>
            afield.set_standalone();
<span class="comment">// Fill the values</span>
            nb_elems=afield._nb_elems;
            nb_comp=afield._nb_field_components;
            assert(nb_elems==1); <span class="comment">//!&lt; ch_front_input_uniforme in the data file</span>
<span class="comment"></span>            <span class="keywordtype">double</span> t=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a64b414b9c2fae99214eb295e2be1323e" title="Returns the present time. This value may change only at the call of validateTimeStep. A surcharger.">presentTime</a>();
            t+=dt;
            <span class="keywordtype">double</span> vx=(t&gt;100)?100:t;
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_elems; i++)
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;afield._nb_field_components; j++)
                afield._field[i*nb_comp+j]=(j==0)?vx:0;
<span class="comment">// Give the field to the problem</span>
            pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#abf4fdc8b228db5e9f349b2c107cca7a6" title="This method is used to provide the Problem with an input field.">setInputField</a>(<span class="stringliteral">&quot;vitesse_entree&quot;</span>,afield);
          }

<span class="comment">// Solve the next time step</span>
          ok=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a1d5589f5f381269a9afdea61bbef9bc9" title="Calculates the unknown fields for the next time step. The default implementation uses iterations...">solveTimeStep</a>();

          <span class="keywordflow">if</span> (!ok)   <span class="comment">//!&lt; The resolution failed, try with a new time interval.</span>
<span class="comment"></span>            {
              pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#ac4b3f7399bf44404a3d0602a9f49d56b" title="Aborts the resolution of the current time step.">abortTimeStep</a>();
              dt=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a5d5ae2c32f3b6019381bc82bc412d388" title="Compute the value the Problem would like for the next time step. This value will not necessarily be u...">computeTimeStep</a>(stop);
            }

          <span class="keywordflow">else</span> <span class="comment">//!&lt; The resolution was successful, validate and go to the next time step.</span>
<span class="comment"></span><span class="comment">//</span>
            pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a80f50938a70bce9122d9d8f2b66636e9" title="Validates the calculated unknown by moving the present time at the end of the time step...">validateTimeStep</a>();
        }

      <span class="keywordflow">if</span> (!ok) <span class="comment">//!&lt; Impossible to solve the next time step, the Problem</span>
<span class="comment"></span>        <span class="keywordflow">break</span>; <span class="comment">//!&lt; has given up</span>
<span class="comment"></span>
<span class="comment">// Compute the next time step length</span>
      dt=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a5d5ae2c32f3b6019381bc82bc412d388" title="Compute the value the Problem would like for the next time step. This value will not necessarily be u...">computeTimeStep</a>(stop);

<span class="comment">// Stop the resolution if the Problem is stationnary</span>
      <span class="keywordflow">if</span> (pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a1bd32d1b1a3f422fa2f5c2c36f848a5e" title="Tells if the Problem unknowns have changed during the last time step.">isStationary</a>())
        stop=<span class="keyword">true</span>;
    }

  pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#ac61416eacfa7c297e398d9d7a2ad499e" title="This method is called once at the end, after any other one. It frees the memory and saves anything th...">terminate</a>();

}
</pre></div>
</div>
</div>
<a class="anchor" id="a88a1cf32fde45cf76b772638a2cfc11b"></a><!-- doxytag: member="Pilote_ICoCo.cpp::main_pilote_icoco_2" ref="a88a1cf32fde45cf76b772638a2cfc11b" args="(Probleme_U &amp;pb_to_solve)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void main_pilote_icoco_2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classProbleme__U.html">Probleme_U</a> &amp;&#160;</td>
          <td class="paramname"><em>pb_to_solve</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fonction principale de l'interprete:<br/>
resoudre un probleme<br/>
Le probleme est pilote via l'interface <a class="el" href="namespaceICoCo.html">ICoCo</a>.<br/>
On lui fournit a chaque pas de temps le champ<br/>
d'entree "puissance" qui est un <a class="el" href="classChamp__input__P0.html" title="class Champ_input_P0 Cette classe represente un champ accessible par setInputField defini sur le doma...">Champ_input_P0</a><br/>
Montre l'utilisation de l'avance en temps et des input fields. </p>

<p><p>&lt; Does the Problem want to stop ?</p>
<p>&lt; Is the time interval successfully solved ?</p>
<p>&lt; Is the time interval successfully solved ?</p>
<p>&lt; The resolution failed, try with a new time interval.</p>
<p>&lt; The resolution was successful, validate and go to the next time step.</p>
<p>&lt; Impossible to solve the next time step, the Problem</p>
<p>&lt; has given up </p>
</p>

<p>Definition at line <a class="el" href="Pilote__ICoCo_8cpp_source.html#l00204">204</a> of file <a class="el" href="Pilote__ICoCo_8cpp_source.html">Pilote_ICoCo.cpp</a>.</p>

<p>References <a class="el" href="ProblemTrio_8cpp_source.html#l00457">ICoCo::ProblemTrio::abortTimeStep()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00313">ICoCo::ProblemTrio::computeTimeStep()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00511">ICoCo::ProblemTrio::getInputFieldsNames()</a>, <a class="el" href="Probleme__U_8cpp_source.html#l00705">ICoCo::ProblemTrio::getInputFieldTemplate()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00222">ICoCo::ProblemTrio::initialize_pb()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00337">ICoCo::ProblemTrio::initTimeStep()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00421">ICoCo::ProblemTrio::isStationary()</a>, <a class="el" href="Probleme__U_8h_source.html#l00110">Probleme_U::le_nom()</a>, <a class="el" href="Probleme__U_8cpp_source.html#l00734">ICoCo::ProblemTrio::setInputField()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00359">ICoCo::ProblemTrio::solveTimeStep()</a>, <a class="el" href="ProblemTrio_8cpp_source.html#l00247">ICoCo::ProblemTrio::terminate()</a>, and <a class="el" href="ProblemTrio_8cpp_source.html#l00388">ICoCo::ProblemTrio::validateTimeStep()</a>.</p>

<p>Referenced by <a class="el" href="Pilote__ICoCo_8cpp_source.html#l00379">Pilote_ICoCo::interpreter()</a>.</p>
<div class="fragment"><pre class="fragment">{

  <a class="code" href="classICoCo_1_1ProblemTrio.html" title="class ProblemTrio This class defines the API a problem has to implement in order to be coupled...">ProblemTrio</a> pb;

  <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> pb_name=pb_to_solve.<a class="code" href="classProbleme__U.html#af8a87e3d3e56126116071b75d9db19af" title="Donne le nom de l&#39;Objet_U Methode a surcharger : renvoie &quot;neant&quot; dans cette implementation.">le_nom</a>();
  pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#aa300012bfa1e8fdf8f0998ded6604476">initialize_pb</a>(pb_to_solve);

  <span class="keywordtype">bool</span> stop=<span class="keyword">false</span>; <span class="comment">//!&lt; Does the Problem want to stop ?</span>
<span class="comment"></span>  <span class="keywordtype">bool</span> ok=<span class="keyword">true</span>; <span class="comment">//!&lt; Is the time interval successfully solved ?</span>
<span class="comment"></span>
<span class="comment">// Compute the first time step length</span>
  <span class="keywordtype">double</span> dt=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a5d5ae2c32f3b6019381bc82bc412d388" title="Compute the value the Problem would like for the next time step. This value will not necessarily be u...">computeTimeStep</a>(stop);

<span class="comment">// Loop on the time steps</span>
  <span class="keywordflow">while</span>(!stop)
    {

      ok=<span class="keyword">false</span>; <span class="comment">//!&lt; Is the time interval successfully solved ?</span>
<span class="comment"></span>
<span class="comment">// Loop on the time interval tries</span>
      <span class="keywordflow">while</span> (!ok &amp;&amp; !stop)
        {

<span class="comment">// Prepare the next time step</span>
          ok=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#af8b628d457910075b2c6d14f2e07dd63" title="This method allocates and initializes the unknown and given fields for the future time step...">initTimeStep</a>(dt);
          <span class="keywordflow">if</span> (!ok)
            <span class="keywordflow">break</span>;

<span class="comment">// Example of field exchange</span>
          {
            vector&lt;string&gt; sv=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a6217ced035266ac0d92e9a433a0859a7" title="This method is used to find the names of input fields understood by the Problem.">getInputFieldsNames</a>();
            cout &lt;&lt; <span class="stringliteral">&quot;Input Fields for &quot;</span> &lt;&lt; pb_name &lt;&lt; <span class="stringliteral">&quot; :&quot;</span> &lt;&lt; endl;
            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i&lt;sv.size(); i++)
              std::cout &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;. &quot;</span> &lt;&lt; sv[i] &lt;&lt; std::endl;

            TrioField afield;
            <span class="keywordtype">int</span> nb_elems;

<span class="comment">// Get the right geometry &amp; nbcomp for &quot;puissance&quot;</span>
            pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#ade2266152954e04971eb6d6f4a7683c8" title="This method is used to get a template of a field expected for the given name.">getInputFieldTemplate</a>(<span class="stringliteral">&quot;puissance&quot;</span>,afield);
<span class="comment">// Allocate memory for the values (size=nb_elems*nb_comp)</span>
            afield.set_standalone();
<span class="comment">// Fill the values</span>
            nb_elems=afield._nb_elems;
<span class="comment">// nb_comp=afield._nb_field_components;</span>
            assert(afield._nb_field_components==1);
            assert(afield._space_dim==2);
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_elems; i++)
              {
<span class="comment">// Find gravity center of the element.</span>
                <span class="keywordtype">double</span> x=0,y=0;
                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;afield._nodes_per_elem; j++)
                  {
                    <span class="keywordtype">int</span> som=afield._connectivity[afield._nodes_per_elem*i+j];
                    x+=afield._coords[som*2];
                    y+=afield._coords[som*2+1];
                  }
                x/=afield._nodes_per_elem;
                y/=afield._nodes_per_elem;
                afield._field[i]=(((x-0.5)*(x-0.5)+(y-0.5)*(y-0.5))&lt;0.3*0.3)*10;
              }
<span class="comment">// Give the field to the problem</span>
            pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#abf4fdc8b228db5e9f349b2c107cca7a6" title="This method is used to provide the Problem with an input field.">setInputField</a>(<span class="stringliteral">&quot;puissance&quot;</span>,afield);
          }

<span class="comment">// Solve the next time step</span>
          ok=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a1d5589f5f381269a9afdea61bbef9bc9" title="Calculates the unknown fields for the next time step. The default implementation uses iterations...">solveTimeStep</a>();

          <span class="keywordflow">if</span> (!ok)   <span class="comment">//!&lt; The resolution failed, try with a new time interval.</span>
<span class="comment"></span>            {
              pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#ac4b3f7399bf44404a3d0602a9f49d56b" title="Aborts the resolution of the current time step.">abortTimeStep</a>();
              dt=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a5d5ae2c32f3b6019381bc82bc412d388" title="Compute the value the Problem would like for the next time step. This value will not necessarily be u...">computeTimeStep</a>(stop);
            }

          <span class="keywordflow">else</span> <span class="comment">//!&lt; The resolution was successful, validate and go to the next time step.</span>
<span class="comment"></span><span class="comment">//</span>
            pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a80f50938a70bce9122d9d8f2b66636e9" title="Validates the calculated unknown by moving the present time at the end of the time step...">validateTimeStep</a>();
        }

      <span class="keywordflow">if</span> (!ok) <span class="comment">//!&lt; Impossible to solve the next time step, the Problem</span>
<span class="comment"></span>        <span class="keywordflow">break</span>; <span class="comment">//!&lt; has given up</span>
<span class="comment"></span>
<span class="comment">// Compute the next time step length</span>
      dt=pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a5d5ae2c32f3b6019381bc82bc412d388" title="Compute the value the Problem would like for the next time step. This value will not necessarily be u...">computeTimeStep</a>(stop);

<span class="comment">// Stop the resolution if the Problem is stationnary</span>
      <span class="keywordflow">if</span> (pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#a1bd32d1b1a3f422fa2f5c2c36f848a5e" title="Tells if the Problem unknowns have changed during the last time step.">isStationary</a>())
        stop=<span class="keyword">true</span>;
    }

  pb.<a class="code" href="classICoCo_1_1ProblemTrio.html#ac61416eacfa7c297e398d9d7a2ad499e" title="This method is called once at the end, after any other one. It frees the memory and saves anything th...">terminate</a>();
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="af80d3da879e6abdebed575a2a19f38cd"></a><!-- doxytag: member="Pilote_ICoCo.cpp::Pilote_ICoCobases" ref="af80d3da879e6abdebed575a2a19f38cd" args="[1]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a>* <a class="el" href="Pilote__ICoCo_8cpp.html#af80d3da879e6abdebed575a2a19f38cd">Pilote_ICoCobases</a>[1] = { &amp;( <a class="el" href="classInterprete.html">Interprete</a> ::info_obj)}</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Pilote__ICoCo_8cpp_source.html#l00039">39</a> of file <a class="el" href="Pilote__ICoCo_8cpp_source.html">Pilote_ICoCo.cpp</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:51 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
