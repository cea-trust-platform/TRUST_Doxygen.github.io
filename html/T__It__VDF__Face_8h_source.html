<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VDF/Operateurs/Iterateurs/T_It_VDF_Face.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VDF/Operateurs/Iterateurs/T_It_VDF_Face.h</div>  </div>
</div>
<div class="contents">
<a href="T__It__VDF__Face_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        T_It_VDF_Face.h</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VDF/Operateurs/Iterateurs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/39</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 <span class="preprocessor">#ifndef T_It_VDF_Face_included</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor">#define T_It_VDF_Face_included</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Equation__base_8h.html">Equation_base.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Milieu__base_8h.html">Milieu_base.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Uniforme_8h.html">Champ_Uniforme.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Iterateur__VDF__base_8h.html">Iterateur_VDF_base.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps__base_8h.html">Schema_Temps_base.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Operateur__base_8h.html">Operateur_base.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="EcrFicPartage_8h.html">EcrFicPartage.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="communications_8h.html">communications.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="DoubleTrav_8h.html">DoubleTrav.h</a>&gt;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00037"></a><a class="code" href="classT__It__VDF__Face.html">00037</a> <span class="keyword">class </span><a class="code" href="classT__It__VDF__Face.html">T_It_VDF_Face</a> : <span class="keyword">public</span> <a class="code" href="classIterateur__VDF__base.html">Iterateur_VDF_base</a>
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039 <span class="comment">// Declare_instanciable(T_It_VDF_Face(_TYPE_));</span>
<a name="l00040"></a><a class="code" href="classT__It__VDF__Face.html#a9d47181a838212368bb99de0a00233a0">00040</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classT__It__VDF__Face.html#a9d47181a838212368bb99de0a00233a0">duplique</a>()<span class="keyword"> const</span>
<a name="l00041"></a>00041 <span class="keyword">  </span>{
<a name="l00042"></a>00042     <a class="code" href="classT__It__VDF__Face.html">T_It_VDF_Face</a>* xxx = <span class="keyword">new</span>  <a class="code" href="classT__It__VDF__Face.html#ae595ecdc0952924474c2b4773625efa2">T_It_VDF_Face</a>(*<span class="keyword">this</span>);
<a name="l00043"></a>00043     <span class="keywordflow">if</span>(!xxx)
<a name="l00044"></a>00044       {
<a name="l00045"></a>00045         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Not enough memory &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00046"></a>00046         <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00047"></a>00047       }
<a name="l00048"></a>00048     <span class="keywordflow">return</span> xxx-&gt;<a class="code" href="classObjet__U.html#a299d10d1be93af1c2b9f2f43f50141f5" title="Renvoie l&#39;indice de l&#39;objet dans Memoire::data.">numero</a>();
<a name="l00049"></a>00049   };
<a name="l00050"></a><a class="code" href="classT__It__VDF__Face.html#acfc3ea35f131e865f068eeda9bc601ae">00050</a>   <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="classT__It__VDF__Face.html#acfc3ea35f131e865f068eeda9bc601ae">taille_memoire</a>()<span class="keyword"> const</span>
<a name="l00051"></a>00051 <span class="keyword">  </span>{
<a name="l00052"></a>00052     <span class="keywordflow">throw</span>;
<a name="l00053"></a>00053   };
<a name="l00054"></a>00054 <span class="keyword">public</span>:
<a name="l00055"></a><a class="code" href="classT__It__VDF__Face.html#ae595ecdc0952924474c2b4773625efa2">00055</a>   <span class="keyword">inline</span> <a class="code" href="classT__It__VDF__Face.html#ae595ecdc0952924474c2b4773625efa2">T_It_VDF_Face</a>() { } ;
<a name="l00056"></a>00056   <span class="keyword">inline</span> <a class="code" href="classT__It__VDF__Face.html#ae595ecdc0952924474c2b4773625efa2">T_It_VDF_Face</a>(<span class="keyword">const</span> <a class="code" href="classT__It__VDF__Face.html">T_It_VDF_Face&lt;_TYPE_&gt;</a>&amp;);
<a name="l00057"></a>00057   <span class="keyword">inline</span> <a class="code" href="classEvaluateur__VDF.html" title="class Evaluateur_VDF Classe de base des evaluateurs VDF. Cette classe n&#39;appartient pas a la hierarchi...">Evaluateur_VDF</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a0b0aec950e4df3c04e1b00a6ada98024">evaluateur</a>();
<a name="l00058"></a>00058   <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classEvaluateur__VDF.html" title="class Evaluateur_VDF Classe de base des evaluateurs VDF. Cette classe n&#39;appartient pas a la hierarchi...">Evaluateur_VDF</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a0b0aec950e4df3c04e1b00a6ada98024">evaluateur</a>() <span class="keyword">const</span>;
<a name="l00059"></a>00059   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a16ebbb068382dce1ad248e8e7daf8a12">calculer</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00060"></a>00060   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#aad1679a8ca0bdf9af94a6286638175ef">ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00061"></a>00061   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a27c51a9b862181105613928e02dd66e0">contribuer_au_second_membre</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00062"></a>00062   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a3bcd7c17ffd49e0a916b46bb330cca22">ajouter_contribution</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; ) <span class="keyword">const</span>;
<a name="l00063"></a>00063   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#ada94c89530cc3268ffc58310b176e2e9">ajouter_contribution_vitesse</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; ) <span class="keyword">const</span>;
<a name="l00064"></a>00064   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a572af03dc1904cf7d1d2b420de686e7d">completer_</a>();
<a name="l00065"></a>00065   <span class="keywordtype">int</span> <a class="code" href="classT__It__VDF__Face.html#a682a9660cfa690647532980dfca0bff0">impr</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os) <span class="keyword">const</span>;
<a name="l00066"></a>00066 <span class="keyword">protected</span>:
<a name="l00067"></a><a class="code" href="classT__It__VDF__Face.html#a1eb0955ff18b6b488292980dbe5a7d12">00067</a>   _TYPE_ <a class="code" href="classT__It__VDF__Face.html#a1eb0955ff18b6b488292980dbe5a7d12">flux_evaluateur</a>;
<a name="l00068"></a>00068   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a7d501b46aec6ed455978031bf7419cbe">ajouter_fa7_elem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00069"></a>00069   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a7d501b46aec6ed455978031bf7419cbe">ajouter_fa7_elem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00070"></a>00070   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#ac15491a7c838c15459174fef78b7bb8c">corriger_flux_fa7_elem_periodicite</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00071"></a>00071   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#ac15491a7c838c15459174fef78b7bb8c">corriger_flux_fa7_elem_periodicite</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00072"></a>00072   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a64f5c6f7a2219d3feec89c3e3a61483b">ajouter_fa7_sortie_libre</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00073"></a>00073   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a64f5c6f7a2219d3feec89c3e3a61483b">ajouter_fa7_sortie_libre</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;,
<a name="l00074"></a>00074                                       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00075"></a>00075   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a4a998b55936203f2147e48522223b3b7">ajouter_aretes_internes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00076"></a>00076   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a4a998b55936203f2147e48522223b3b7">ajouter_aretes_internes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;,
<a name="l00077"></a>00077                                      <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00078"></a>00078   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a454d1736355e7bf9a9673544666a3069">ajouter_aretes_mixtes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00079"></a>00079   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a454d1736355e7bf9a9673544666a3069">ajouter_aretes_mixtes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;,
<a name="l00080"></a>00080                                    <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00081"></a>00081   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a87a730438dae0bf204485223bdc1cb81">ajouter_aretes_bords</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00082"></a>00082   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a87a730438dae0bf204485223bdc1cb81">ajouter_aretes_bords</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;,
<a name="l00083"></a>00083                                   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00084"></a>00084   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a9a7cff4f2529285137354b2297579b8d">ajouter_aretes_coins</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00085"></a>00085   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a9a7cff4f2529285137354b2297579b8d">ajouter_aretes_coins</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;,
<a name="l00086"></a>00086                                   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00087"></a>00087   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a17c8e580e948b3014c269a0efed2895b">contribuer_au_second_membre_fa7_elem</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00088"></a>00088   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a17c8e580e948b3014c269a0efed2895b">contribuer_au_second_membre_fa7_elem</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00089"></a>00089   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a1f6bfe9ff87696e7ca413b5f9c9d8bf9">corriger_secmem_fa7_elem_periodicite</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00090"></a>00090   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a1f6bfe9ff87696e7ca413b5f9c9d8bf9">corriger_secmem_fa7_elem_periodicite</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00091"></a>00091   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a392dd1c6c0eed77f938ff358c5331099">contribuer_au_second_membre_fa7_sortie_libre</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00092"></a>00092   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a392dd1c6c0eed77f938ff358c5331099">contribuer_au_second_membre_fa7_sortie_libre</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00093"></a>00093   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a86d3f070afdd8b66530f9e5177738d26">contribuer_au_second_membre_aretes_internes</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00094"></a>00094   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a86d3f070afdd8b66530f9e5177738d26">contribuer_au_second_membre_aretes_internes</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00095"></a>00095   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#ae6acf0134a78827f4e4ca9a3354d3c74">contribuer_au_second_membre_aretes_mixtes</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00096"></a>00096   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#ae6acf0134a78827f4e4ca9a3354d3c74">contribuer_au_second_membre_aretes_mixtes</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00097"></a>00097   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#afd6bdbda1ce73524f5e14f51fc141895">contribuer_au_second_membre_aretes_bords</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00098"></a>00098   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#afd6bdbda1ce73524f5e14f51fc141895">contribuer_au_second_membre_aretes_bords</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00099"></a>00099   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a498be5af06fe656b739bf6d5f09d5853">contribuer_au_second_membre_aretes_coins</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ) <span class="keyword">const</span>;
<a name="l00100"></a>00100   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a498be5af06fe656b739bf6d5f09d5853">contribuer_au_second_membre_aretes_coins</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span>) <span class="keyword">const</span>;
<a name="l00101"></a>00101   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a8fa47245e0a3dd72517feecf5ebc240d">ajouter_contribution_fa7_elem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; ) <span class="keyword">const</span>;
<a name="l00102"></a>00102   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a8fa47245e0a3dd72517feecf5ebc240d">ajouter_contribution_fa7_elem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00103"></a>00103   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a033048035c9fcd6b098a675980fb0ab5">corriger_coeffs_fa7_elem_periodicite</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; ) <span class="keyword">const</span>;
<a name="l00104"></a>00104   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a033048035c9fcd6b098a675980fb0ab5">corriger_coeffs_fa7_elem_periodicite</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00105"></a>00105   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a8de510613a09415a2c12a14ace715656">ajouter_contribution_fa7_sortie_libre</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; ) <span class="keyword">const</span>;
<a name="l00106"></a>00106   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a8de510613a09415a2c12a14ace715656">ajouter_contribution_fa7_sortie_libre</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00107"></a>00107   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a16c609e6369722487976c95dc411aaea">ajouter_contribution_aretes_internes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; ) <span class="keyword">const</span>;
<a name="l00108"></a>00108   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a16c609e6369722487976c95dc411aaea">ajouter_contribution_aretes_internes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00109"></a>00109   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a50552913434ed4b79072869e0127d35b">ajouter_contribution_aretes_mixtes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; ) <span class="keyword">const</span>;
<a name="l00110"></a>00110   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a50552913434ed4b79072869e0127d35b">ajouter_contribution_aretes_mixtes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00111"></a>00111   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a0c730b1cfd84d69100aee165b3e7a1d5">ajouter_contribution_aretes_bords</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; ) <span class="keyword">const</span>;
<a name="l00112"></a>00112   <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a0c730b1cfd84d69100aee165b3e7a1d5">ajouter_contribution_aretes_bords</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00113"></a>00113   <span class="keywordtype">void</span>  <a class="code" href="classT__It__VDF__Face.html#ad6294531c7bf5bca60496607982ec4ca">ajouter_contribution_aretes_coins</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; ) <span class="keyword">const</span> ;
<a name="l00114"></a>00114   <span class="keywordtype">void</span>  <a class="code" href="classT__It__VDF__Face.html#ad6294531c7bf5bca60496607982ec4ca">ajouter_contribution_aretes_coins</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; , <span class="keywordtype">int</span>) <span class="keyword">const</span> ;
<a name="l00115"></a><a class="code" href="classT__It__VDF__Face.html#a4f70f9ac96f160521bc509f1b6238f6b">00115</a>   <span class="keywordtype">int</span> <a class="code" href="classT__It__VDF__Face.html#a4f70f9ac96f160521bc509f1b6238f6b">nb_elem</a>;
<a name="l00116"></a><a class="code" href="classT__It__VDF__Face.html#a0d5915c2c13a6459a5cf2a9869b0221f">00116</a>   <a class="code" href="classIntVect.html">IntVect</a> <a class="code" href="classT__It__VDF__Face.html#a0d5915c2c13a6459a5cf2a9869b0221f">orientation</a>;
<a name="l00117"></a><a class="code" href="classT__It__VDF__Face.html#a799b0d80670895d8f8db8f1a040b4ed4">00117</a>   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> <a class="code" href="classT__It__VDF__Face.html#a799b0d80670895d8f8db8f1a040b4ed4">Qdm</a>;
<a name="l00118"></a><a class="code" href="classT__It__VDF__Face.html#a37bb7a406c8a8c381571887e1781b193">00118</a>   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> <a class="code" href="classT__It__VDF__Face.html#a37bb7a406c8a8c381571887e1781b193">elem</a>;
<a name="l00119"></a><a class="code" href="classT__It__VDF__Face.html#a1a3f0fb994b6c2f462101d0ede1e19fa">00119</a>   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> <a class="code" href="classT__It__VDF__Face.html#a1a3f0fb994b6c2f462101d0ede1e19fa">elem_faces</a>;
<a name="l00120"></a><a class="code" href="classT__It__VDF__Face.html#aff7b6f1b7d677877175b76c9a95c3c05">00120</a>   <a class="code" href="classIntVect.html">IntVect</a> <a class="code" href="classT__It__VDF__Face.html#aff7b6f1b7d677877175b76c9a95c3c05">type_arete_bord</a>;
<a name="l00121"></a><a class="code" href="classT__It__VDF__Face.html#addd8c6fdfedb7b52b3774a36a043b6e0">00121</a>   <a class="code" href="classIntVect.html">IntVect</a> <a class="code" href="classT__It__VDF__Face.html#addd8c6fdfedb7b52b3774a36a043b6e0">type_arete_coin</a>;
<a name="l00122"></a><a class="code" href="classT__It__VDF__Face.html#a2ce95945e26430e2f88f89878af57c2f">00122</a>   <span class="keywordtype">int</span> <a class="code" href="classT__It__VDF__Face.html#a2ce95945e26430e2f88f89878af57c2f">premiere_arete_interne</a>;
<a name="l00123"></a><a class="code" href="classT__It__VDF__Face.html#acd2826ac6ad5d33e6df74bc854f86c91">00123</a>   <span class="keywordtype">int</span> <a class="code" href="classT__It__VDF__Face.html#acd2826ac6ad5d33e6df74bc854f86c91">derniere_arete_interne</a>;
<a name="l00124"></a><a class="code" href="classT__It__VDF__Face.html#a93cf62fd68444a63a8e62dee0e538bbb">00124</a>   <span class="keywordtype">int</span> <a class="code" href="classT__It__VDF__Face.html#a93cf62fd68444a63a8e62dee0e538bbb">premiere_arete_mixte</a>;
<a name="l00125"></a><a class="code" href="classT__It__VDF__Face.html#a2bd158dd59e756c46195990487ea555e">00125</a>   <span class="keywordtype">int</span> <a class="code" href="classT__It__VDF__Face.html#a2bd158dd59e756c46195990487ea555e">derniere_arete_mixte</a>;
<a name="l00126"></a><a class="code" href="classT__It__VDF__Face.html#a6b349d45b5fbc6b5195fc4b4478660f6">00126</a>   <span class="keywordtype">int</span> <a class="code" href="classT__It__VDF__Face.html#a6b349d45b5fbc6b5195fc4b4478660f6">premiere_arete_bord</a>;
<a name="l00127"></a><a class="code" href="classT__It__VDF__Face.html#a0dd1f14a5e91d68a4dc84578c71b7a13">00127</a>   <span class="keywordtype">int</span> <a class="code" href="classT__It__VDF__Face.html#a0dd1f14a5e91d68a4dc84578c71b7a13">derniere_arete_bord</a>;
<a name="l00128"></a><a class="code" href="classT__It__VDF__Face.html#af8e227c982bb8694fb34c615a2103996">00128</a>   <span class="keywordtype">int</span> <a class="code" href="classT__It__VDF__Face.html#af8e227c982bb8694fb34c615a2103996">premiere_arete_coin</a>;
<a name="l00129"></a><a class="code" href="classT__It__VDF__Face.html#aee98b46a7a8ceb12cf6d3bced7c3b785">00129</a>   <span class="keywordtype">int</span> <a class="code" href="classT__It__VDF__Face.html#aee98b46a7a8ceb12cf6d3bced7c3b785">derniere_arete_coin</a>;
<a name="l00130"></a><a class="code" href="classT__It__VDF__Face.html#adae89a2b0136656b8042445bbdbcf8a8">00130</a>   <span class="keyword">mutable</span> <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> <a class="code" href="classT__It__VDF__Face.html#a39259884a9ea817b611f4c541ebed2a8">Flux</a>, <a class="code" href="classT__It__VDF__Face.html#a0cf545678ad03fdaa483419cb5ca7686">Flux_moment</a>, <a class="code" href="classT__It__VDF__Face.html#adae89a2b0136656b8042445bbdbcf8a8">Flux_sum</a>;
<a name="l00131"></a>00131 };
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00134"></a><a class="code" href="classT__It__VDF__Face.html#a265fbf7e30e752d8621cab17a6e9a01e">00134</a> <span class="keyword">inline</span> <a class="code" href="classT__It__VDF__Face.html#ae595ecdc0952924474c2b4773625efa2">T_It_VDF_Face&lt;_TYPE_&gt;::T_It_VDF_Face</a>(<span class="keyword">const</span> <a class="code" href="classT__It__VDF__Face.html">T_It_VDF_Face&lt;_TYPE_&gt;</a>&amp; iter) :
<a name="l00135"></a>00135   <a class="code" href="classIterateur__VDF__base.html">Iterateur_VDF_base</a>(iter),
<a name="l00136"></a>00136   flux_evaluateur(iter.flux_evaluateur),
<a name="l00137"></a>00137   nb_elem(iter.nb_elem), premiere_arete_interne(iter.premiere_arete_interne),
<a name="l00138"></a>00138   derniere_arete_interne(iter.derniere_arete_interne),
<a name="l00139"></a>00139   premiere_arete_mixte(iter.premiere_arete_mixte),
<a name="l00140"></a>00140   derniere_arete_mixte(iter.derniere_arete_mixte),
<a name="l00141"></a>00141   premiere_arete_bord(iter.premiere_arete_bord),
<a name="l00142"></a>00142   derniere_arete_bord(iter.derniere_arete_bord),
<a name="l00143"></a>00143   premiere_arete_coin(iter.premiere_arete_coin),
<a name="l00144"></a>00144   derniere_arete_coin(iter.derniere_arete_coin)
<a name="l00145"></a>00145 {
<a name="l00146"></a>00146   <a class="code" href="classT__It__VDF__Face.html#a0d5915c2c13a6459a5cf2a9869b0221f">orientation</a>.<a class="code" href="classIntVect.html#a165455689c6d27ac93c9cf8823e47a0f" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(iter.<a class="code" href="classT__It__VDF__Face.html#a0d5915c2c13a6459a5cf2a9869b0221f">orientation</a>);
<a name="l00147"></a>00147   <a class="code" href="classT__It__VDF__Face.html#a799b0d80670895d8f8db8f1a040b4ed4">Qdm</a>.<a class="code" href="classIntTab.html#ae9ae8fefb1fda4a5c035229ab420a96d" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(iter.<a class="code" href="classT__It__VDF__Face.html#a799b0d80670895d8f8db8f1a040b4ed4">Qdm</a>);
<a name="l00148"></a>00148   <a class="code" href="classT__It__VDF__Face.html#a37bb7a406c8a8c381571887e1781b193">elem</a>.<a class="code" href="classIntTab.html#ae9ae8fefb1fda4a5c035229ab420a96d" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(iter.<a class="code" href="classT__It__VDF__Face.html#a37bb7a406c8a8c381571887e1781b193">elem</a>);
<a name="l00149"></a>00149   <a class="code" href="classT__It__VDF__Face.html#a1a3f0fb994b6c2f462101d0ede1e19fa">elem_faces</a>.<a class="code" href="classIntTab.html#ae9ae8fefb1fda4a5c035229ab420a96d" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(iter.<a class="code" href="classT__It__VDF__Face.html#a1a3f0fb994b6c2f462101d0ede1e19fa">elem_faces</a>);
<a name="l00150"></a>00150   <a class="code" href="classT__It__VDF__Face.html#aff7b6f1b7d677877175b76c9a95c3c05">type_arete_bord</a>.<a class="code" href="classIntVect.html#a165455689c6d27ac93c9cf8823e47a0f" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(iter.<a class="code" href="classT__It__VDF__Face.html#aff7b6f1b7d677877175b76c9a95c3c05">type_arete_bord</a>);
<a name="l00151"></a>00151   <a class="code" href="classT__It__VDF__Face.html#addd8c6fdfedb7b52b3774a36a043b6e0">type_arete_coin</a>.<a class="code" href="classIntVect.html#a165455689c6d27ac93c9cf8823e47a0f" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(iter.<a class="code" href="classT__It__VDF__Face.html#addd8c6fdfedb7b52b3774a36a043b6e0">type_arete_coin</a>);
<a name="l00152"></a>00152 }
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00155"></a><a class="code" href="classT__It__VDF__Face.html#a0b0aec950e4df3c04e1b00a6ada98024">00155</a> <span class="keyword">inline</span> <a class="code" href="classEvaluateur__VDF.html" title="class Evaluateur_VDF Classe de base des evaluateurs VDF. Cette classe n&#39;appartient pas a la hierarchi...">Evaluateur_VDF</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a0b0aec950e4df3c04e1b00a6ada98024">T_It_VDF_Face&lt;_TYPE_&gt;::evaluateur</a>()
<a name="l00156"></a>00156 {
<a name="l00157"></a>00157   <a class="code" href="classEvaluateur__VDF.html" title="class Evaluateur_VDF Classe de base des evaluateurs VDF. Cette classe n&#39;appartient pas a la hierarchi...">Evaluateur_VDF</a>&amp; eval = (<a class="code" href="classEvaluateur__VDF.html" title="class Evaluateur_VDF Classe de base des evaluateurs VDF. Cette classe n&#39;appartient pas a la hierarchi...">Evaluateur_VDF</a>&amp;) flux_evaluateur;
<a name="l00158"></a>00158   <span class="keywordflow">return</span> eval;
<a name="l00159"></a>00159 }
<a name="l00160"></a>00160 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00161"></a><a class="code" href="classT__It__VDF__Face.html#a47c205cfad4c28bdad5a8709608cdc38">00161</a> <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classEvaluateur__VDF.html" title="class Evaluateur_VDF Classe de base des evaluateurs VDF. Cette classe n&#39;appartient pas a la hierarchi...">Evaluateur_VDF</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a0b0aec950e4df3c04e1b00a6ada98024">T_It_VDF_Face&lt;_TYPE_&gt;::evaluateur</a>()<span class="keyword"> const</span>
<a name="l00162"></a>00162 <span class="keyword"></span>{
<a name="l00163"></a>00163   <a class="code" href="classEvaluateur__VDF.html" title="class Evaluateur_VDF Classe de base des evaluateurs VDF. Cette classe n&#39;appartient pas a la hierarchi...">Evaluateur_VDF</a>&amp; eval = (<a class="code" href="classEvaluateur__VDF.html" title="class Evaluateur_VDF Classe de base des evaluateurs VDF. Cette classe n&#39;appartient pas a la hierarchi...">Evaluateur_VDF</a>&amp;) flux_evaluateur;
<a name="l00164"></a>00164   <span class="keywordflow">return</span> eval;
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 <span class="comment">/*</span>
<a name="l00168"></a>00168 <span class="comment">template &lt;class _TYPE_&gt;</span>
<a name="l00169"></a>00169 <span class="comment">Sortie&amp; T_It_VDF_Face&lt;_TYPE_&gt;::printOn(Sortie&amp; s ) const {</span>
<a name="l00170"></a>00170 <span class="comment">    return s &lt;&lt; que_suis_je() ;</span>
<a name="l00171"></a>00171 <span class="comment">  }</span>
<a name="l00172"></a>00172 <span class="comment">template &lt;class _TYPE_&gt;</span>
<a name="l00173"></a>00173 <span class="comment">  Entree&amp; T_It_VDF_Face&lt;_TYPE_&gt;::readOn(Entree&amp; s ) {</span>
<a name="l00174"></a>00174 <span class="comment">    return s ;</span>
<a name="l00175"></a>00175 <span class="comment">  }</span>
<a name="l00176"></a>00176 <span class="comment">// Implemente_instanciable(T_It_VDF_Face(_TYPE_),&quot;Iterateur_VDF_Face&quot;,Iterateur_VDF_base);</span>
<a name="l00177"></a>00177 <span class="comment">*/</span>
<a name="l00178"></a>00178 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00179"></a><a class="code" href="classT__It__VDF__Face.html#aad1679a8ca0bdf9af94a6286638175ef">00179</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#aad1679a8ca0bdf9af94a6286638175ef">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00180"></a>00180 <span class="keyword"></span>{
<a name="l00181"></a>00181   ((_TYPE_&amp;) flux_evaluateur).mettre_a_jour();
<a name="l00182"></a>00182   assert(inco.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() &lt; 3);
<a name="l00183"></a>00183   <span class="keywordtype">int</span> ncomp=1;
<a name="l00184"></a>00184   <span class="keywordflow">if</span> (inco.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 2)
<a name="l00185"></a>00185     ncomp=inco.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00186"></a>00186   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords=op_base-&gt;flux_bords();
<a name="l00187"></a>00187   tab_flux_bords.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(la_zone-&gt;nb_faces_bord(),dimension);
<a name="l00188"></a>00188   tab_flux_bords=0;
<a name="l00189"></a>00189   <span class="keywordflow">if</span>( ncomp == 1)
<a name="l00190"></a>00190     {
<a name="l00191"></a>00191       ajouter_aretes_bords(inco, resu) ;
<a name="l00192"></a>00192       ajouter_aretes_coins(inco, resu) ;
<a name="l00193"></a>00193       ajouter_aretes_internes(inco,resu);
<a name="l00194"></a>00194       ajouter_aretes_mixtes(inco,resu);
<a name="l00195"></a>00195       ajouter_fa7_sortie_libre(inco,resu);
<a name="l00196"></a>00196       ajouter_fa7_elem(inco,resu);
<a name="l00197"></a>00197     }
<a name="l00198"></a>00198   <span class="keywordflow">else</span>
<a name="l00199"></a>00199     {
<a name="l00200"></a>00200       ajouter_aretes_bords(inco, resu, ncomp) ;
<a name="l00201"></a>00201       ajouter_aretes_coins(inco, resu, ncomp) ;
<a name="l00202"></a>00202       ajouter_aretes_internes(inco, resu, ncomp) ;
<a name="l00203"></a>00203       ajouter_aretes_mixtes(inco,resu, ncomp);
<a name="l00204"></a>00204       ajouter_fa7_sortie_libre(inco,resu, ncomp);
<a name="l00205"></a>00205       ajouter_fa7_elem(inco,resu, ncomp);
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207   <span class="comment">/* On multiplie les flux au bord par rho en hydraulique */</span>
<a name="l00208"></a>00208   <span class="comment">/*  (sert uniquement a la sortie) */</span>
<a name="l00209"></a>00209   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_eqn=la_zcl-&gt;equation().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
<a name="l00210"></a>00210   <span class="keywordtype">int</span> face,k;
<a name="l00211"></a>00211   <span class="comment">/* Modif B.Mathieu pour front-tracking: masse_volumique() invalide en f.t.*/</span>
<a name="l00212"></a>00212   <span class="keywordflow">if</span> (nom_eqn.<a class="code" href="classNom.html#a41b0ba18fb90d481c0828ed4372de8ee">debute_par</a>(<span class="stringliteral">&quot;Navier_Stokes&quot;</span>)
<a name="l00213"></a>00213       &amp;&amp;nom_eqn!=<span class="stringliteral">&quot;Navier_Stokes_Melange&quot;</span>
<a name="l00214"></a>00214       &amp;&amp;nom_eqn!=<span class="stringliteral">&quot;Navier_Stokes_FT_Disc&quot;</span>)
<a name="l00215"></a>00215     {
<a name="l00216"></a>00216       <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; rho = la_zcl-&gt;equation().milieu().masse_volumique();
<a name="l00217"></a>00217       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Uniforme.html" title="classe Champ_Uniforme Represente un champ constant dans l&#39;espace et dans le temps.">Champ_Uniforme</a>,rho))
<a name="l00218"></a>00218         {
<a name="l00219"></a>00219           <span class="keywordtype">double</span> coef = rho(0,0);
<a name="l00220"></a>00220           <span class="keywordtype">int</span> nb_faces_bord=la_zone-&gt;nb_faces_bord();
<a name="l00221"></a>00221           <span class="keywordflow">for</span> (face=0; face&lt;nb_faces_bord; face++)
<a name="l00222"></a>00222             <span class="keywordflow">for</span>(k=0; k&lt;tab_flux_bords.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1); k++)
<a name="l00223"></a>00223               tab_flux_bords(face,k) *= coef;
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225     }
<a name="l00226"></a>00226   <span class="keywordflow">return</span> resu;
<a name="l00227"></a>00227 }
<a name="l00228"></a>00228 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00229"></a><a class="code" href="classT__It__VDF__Face.html#a87a730438dae0bf204485223bdc1cb81">00229</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a87a730438dae0bf204485223bdc1cb81">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_aretes_bords</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00230"></a>00230 <span class="keyword"></span>{
<a name="l00231"></a>00231   <span class="keywordflow">if</span> (!flux_evaluateur.calculer_arete_bord())
<a name="l00232"></a>00232     <span class="keywordflow">return</span> resu;
<a name="l00233"></a>00233   <span class="keywordtype">int</span> n_arete;
<a name="l00234"></a>00234   <span class="keywordtype">int</span> signe;
<a name="l00235"></a>00235   <span class="keywordtype">int</span> n_type;
<a name="l00236"></a>00236   <span class="keywordtype">double</span> flux,flux3=0,flux3_4=0,flux1_2=0;
<a name="l00237"></a>00237   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l00238"></a>00238   <span class="keywordtype">int</span> n=la_zone-&gt;nb_faces_bord();
<a name="l00239"></a>00239   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords=op_base-&gt;flux_bords();
<a name="l00240"></a>00240   <span class="keywordflow">for</span> (n_arete=premiere_arete_bord; n_arete&lt;derniere_arete_bord; n_arete++)
<a name="l00241"></a>00241     {
<a name="l00242"></a>00242       n_type=type_arete_bord(n_arete-premiere_arete_bord);
<a name="l00243"></a>00243       <span class="keywordflow">switch</span>(n_type)
<a name="l00244"></a>00244         {
<a name="l00245"></a>00245         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>:
<a name="l00246"></a>00246           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l00247"></a>00247             {
<a name="l00248"></a>00248               fac1 = Qdm(n_arete,0);
<a name="l00249"></a>00249               fac2 = Qdm(n_arete,1);
<a name="l00250"></a>00250               fac3 = Qdm(n_arete,2);
<a name="l00251"></a>00251               signe = Qdm(n_arete,3);
<a name="l00252"></a>00252               flux=flux_evaluateur.flux_arete_paroi(inco, fac1, fac2, fac3, signe);
<a name="l00253"></a>00253               resu[fac3]+=signe*flux;
<a name="l00254"></a>00254               <span class="keywordflow">if</span> (fac1&lt;n)
<a name="l00255"></a>00255                 tab_flux_bords(fac1,orientation(fac3))-=0.5*signe*flux;
<a name="l00256"></a>00256               <span class="keywordflow">if</span> (fac2&lt;n)
<a name="l00257"></a>00257                 tab_flux_bords(fac2,orientation(fac3))-=0.5*signe*flux;
<a name="l00258"></a>00258             }
<a name="l00259"></a>00259           <span class="keywordflow">break</span>;
<a name="l00260"></a>00260         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a>:
<a name="l00261"></a>00261           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_fluide())
<a name="l00262"></a>00262             {
<a name="l00263"></a>00263               fac1 = Qdm(n_arete,0);
<a name="l00264"></a>00264               fac2 = Qdm(n_arete,1);
<a name="l00265"></a>00265               fac3 = Qdm(n_arete,2);
<a name="l00266"></a>00266               signe = Qdm(n_arete,3);
<a name="l00267"></a>00267               flux_evaluateur.flux_arete_fluide(inco, fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l00268"></a>00268               resu[fac3]+=signe*flux3;
<a name="l00269"></a>00269               resu[fac1]+=flux1_2;
<a name="l00270"></a>00270               resu[fac2]-=flux1_2;
<a name="l00271"></a>00271               <span class="keywordflow">if</span> (fac1&lt;n)
<a name="l00272"></a>00272                 tab_flux_bords(fac1,orientation(fac3))-=0.5*signe*flux3;
<a name="l00273"></a>00273               <span class="keywordflow">if</span> (fac2&lt;n)
<a name="l00274"></a>00274                 tab_flux_bords(fac2,orientation(fac3))-=0.5*signe*flux3;
<a name="l00275"></a>00275             }
<a name="l00276"></a>00276           <span class="keywordflow">break</span>;
<a name="l00277"></a>00277         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>:
<a name="l00278"></a>00278           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi_fluide())
<a name="l00279"></a>00279             {
<a name="l00280"></a>00280               fac1 = Qdm(n_arete,0);
<a name="l00281"></a>00281               fac2 = Qdm(n_arete,1);
<a name="l00282"></a>00282               fac3 = Qdm(n_arete,2);
<a name="l00283"></a>00283               signe = Qdm(n_arete,3);
<a name="l00284"></a>00284               flux_evaluateur.flux_arete_paroi_fluide(inco, fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l00285"></a>00285               resu[fac3]+=signe*flux3;
<a name="l00286"></a>00286               resu[fac1]+=flux1_2;
<a name="l00287"></a>00287               resu[fac2]-=flux1_2;
<a name="l00288"></a>00288               <span class="keywordflow">if</span> (fac1&lt;n)
<a name="l00289"></a>00289                 tab_flux_bords(fac1,orientation(fac3))-=0.5*signe*flux3;
<a name="l00290"></a>00290               <span class="keywordflow">if</span> (fac2&lt;n)
<a name="l00291"></a>00291                 tab_flux_bords(fac2,orientation(fac3))-=0.5*signe*flux3;
<a name="l00292"></a>00292             }
<a name="l00293"></a>00293           <span class="keywordflow">break</span>;
<a name="l00294"></a>00294         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a8ffe822aae0518f507be135120ec23b8">TypeAreteBordVDF::SYM_SYM</a>:
<a name="l00295"></a>00295           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie())
<a name="l00296"></a>00296             {
<a name="l00297"></a>00297               fac1 = Qdm(n_arete,0);
<a name="l00298"></a>00298               fac2 = Qdm(n_arete,1);
<a name="l00299"></a>00299               fac3 = Qdm(n_arete,2);
<a name="l00300"></a>00300               signe = Qdm(n_arete,3);
<a name="l00301"></a>00301               flux=flux_evaluateur.flux_arete_symetrie(inco, fac1, fac2, fac3, signe);
<a name="l00302"></a>00302               resu[fac3]+=signe*flux;
<a name="l00303"></a>00303             }
<a name="l00304"></a>00304           <span class="keywordflow">break</span>;
<a name="l00305"></a>00305         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a37713c7b918ab812a24573ce30b2a322">TypeAreteBordVDF::PERIO_PERIO</a>:
<a name="l00306"></a>00306           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_periodicite())
<a name="l00307"></a>00307             {
<a name="l00308"></a>00308               fac1 = Qdm(n_arete,0);
<a name="l00309"></a>00309               fac2 = Qdm(n_arete,1);
<a name="l00310"></a>00310               fac3 = Qdm(n_arete,2);
<a name="l00311"></a>00311               fac4 = Qdm(n_arete,3);
<a name="l00312"></a>00312               flux_evaluateur.flux_arete_periodicite(inco, fac1, fac2, fac3, fac4, flux3_4, flux1_2);
<a name="l00313"></a>00313               resu[fac3]+=0.5*flux3_4;
<a name="l00314"></a>00314               resu[fac4]-=0.5*flux3_4;
<a name="l00315"></a>00315               resu[fac1]+=flux1_2;
<a name="l00316"></a>00316               resu[fac2]-=flux1_2;
<a name="l00317"></a>00317             }
<a name="l00318"></a>00318           <span class="keywordflow">break</span>;
<a name="l00319"></a>00319         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac0b72d665d0d8eb58248f5c6c65f410c">TypeAreteBordVDF::PAROI_SYM</a>:
<a name="l00320"></a>00320           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie_paroi())
<a name="l00321"></a>00321             {
<a name="l00322"></a>00322               fac1 = Qdm(n_arete,0);
<a name="l00323"></a>00323               fac2 = Qdm(n_arete,1);
<a name="l00324"></a>00324               fac3 = Qdm(n_arete,2);
<a name="l00325"></a>00325               signe = Qdm(n_arete,3);
<a name="l00326"></a>00326               flux=flux_evaluateur.flux_arete_symetrie_paroi(inco, fac1, fac2, fac3, signe);
<a name="l00327"></a>00327               resu[fac3]+=signe*flux;
<a name="l00328"></a>00328             }
<a name="l00329"></a>00329           <span class="keywordflow">break</span>;
<a name="l00330"></a>00330         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a460c2f242b0d8c910f37c8940e504707">TypeAreteBordVDF::FLUIDE_SYM</a>:
<a name="l00331"></a>00331           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie_fluide())
<a name="l00332"></a>00332             {
<a name="l00333"></a>00333               fac1 = Qdm(n_arete,0);
<a name="l00334"></a>00334               fac2 = Qdm(n_arete,1);
<a name="l00335"></a>00335               fac3 = Qdm(n_arete,2);
<a name="l00336"></a>00336               signe = Qdm(n_arete,3);
<a name="l00337"></a>00337               flux_evaluateur.flux_arete_symetrie_fluide(inco, fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l00338"></a>00338               resu[fac3]+=signe*flux3;
<a name="l00339"></a>00339               resu[fac1]+=flux1_2;
<a name="l00340"></a>00340               resu[fac2]-=flux1_2;
<a name="l00341"></a>00341             }
<a name="l00342"></a>00342           <span class="keywordflow">break</span>;
<a name="l00343"></a>00343         <span class="keywordflow">default</span> :
<a name="l00344"></a>00344           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l00345"></a>00345           \
<a name="l00346"></a>00346           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l00347"></a>00347           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l00348"></a>00348           exit();
<a name="l00349"></a>00349           <span class="keywordflow">break</span>;
<a name="l00350"></a>00350         }
<a name="l00351"></a>00351     }
<a name="l00352"></a>00352   <span class="keywordflow">return</span> resu;
<a name="l00353"></a>00353 }
<a name="l00354"></a>00354 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00355"></a><a class="code" href="classT__It__VDF__Face.html#a1a48d3c8c14988b49dd597db43102189">00355</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a87a730438dae0bf204485223bdc1cb81">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_aretes_bords</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,
<a name="l00356"></a>00356                                                        <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00357"></a>00357 <span class="keyword"></span>{
<a name="l00358"></a>00358   <span class="keywordflow">if</span> (!flux_evaluateur.calculer_arete_bord())
<a name="l00359"></a>00359     <span class="keywordflow">return</span> resu;
<a name="l00360"></a>00360   <span class="keywordtype">int</span> n_arete;
<a name="l00361"></a>00361   <span class="keywordtype">int</span> signe;
<a name="l00362"></a>00362   <span class="keywordtype">int</span> n_type;
<a name="l00363"></a>00363   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp), flux3(ncomp), flux3_4(ncomp), flux1_2(ncomp);
<a name="l00364"></a>00364   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l00365"></a>00365   <span class="keywordtype">int</span> k;
<a name="l00366"></a>00366   <span class="keywordtype">int</span> n=la_zone-&gt;nb_faces_bord();
<a name="l00367"></a>00367   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords=op_base-&gt;flux_bords();
<a name="l00368"></a>00368   <span class="keywordflow">for</span> (n_arete=premiere_arete_bord; n_arete&lt;derniere_arete_bord; n_arete++)
<a name="l00369"></a>00369     {
<a name="l00370"></a>00370       n_type=type_arete_bord(n_arete-premiere_arete_bord);
<a name="l00371"></a>00371       <span class="keywordflow">switch</span>(n_type)
<a name="l00372"></a>00372         {
<a name="l00373"></a>00373         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>:
<a name="l00374"></a>00374           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l00375"></a>00375             {
<a name="l00376"></a>00376               fac1 = Qdm(n_arete,0);
<a name="l00377"></a>00377               fac2 = Qdm(n_arete,1);
<a name="l00378"></a>00378               fac3 = Qdm(n_arete,2);
<a name="l00379"></a>00379               signe = Qdm(n_arete,3);
<a name="l00380"></a>00380               flux_evaluateur.flux_arete_paroi(inco, fac1, fac2, fac3, signe, flux);
<a name="l00381"></a>00381               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00382"></a>00382                 {
<a name="l00383"></a>00383                   resu(fac3,k)+=signe*flux(k);
<a name="l00384"></a>00384                   <span class="keywordflow">if</span> (fac1&lt;n)
<a name="l00385"></a>00385                     tab_flux_bords(fac1,k)-=0.5*signe*flux(k);
<a name="l00386"></a>00386                   <span class="keywordflow">if</span> (fac2&lt;n)
<a name="l00387"></a>00387                     tab_flux_bords(fac2,k)-=0.5*signe*flux(k);
<a name="l00388"></a>00388                 }
<a name="l00389"></a>00389             }
<a name="l00390"></a>00390           <span class="keywordflow">break</span>;
<a name="l00391"></a>00391         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a>:
<a name="l00392"></a>00392           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_fluide())
<a name="l00393"></a>00393             {
<a name="l00394"></a>00394               fac1 = Qdm(n_arete,0);
<a name="l00395"></a>00395               fac2 = Qdm(n_arete,1);
<a name="l00396"></a>00396               fac3 = Qdm(n_arete,2);
<a name="l00397"></a>00397               signe = Qdm(n_arete,3);
<a name="l00398"></a>00398               flux_evaluateur.flux_arete_fluide(inco, fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l00399"></a>00399               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00400"></a>00400                 {
<a name="l00401"></a>00401                   resu(fac3,k)+=signe*flux3(k);
<a name="l00402"></a>00402                   resu(fac1,k)+=flux1_2(k);
<a name="l00403"></a>00403                   resu(fac2,k)-=flux1_2(k);
<a name="l00404"></a>00404                   <span class="keywordflow">if</span> (fac1&lt;n)
<a name="l00405"></a>00405                     tab_flux_bords(fac1,k)-=0.5*signe*flux3(k);
<a name="l00406"></a>00406                   <span class="keywordflow">if</span> (fac2&lt;n)
<a name="l00407"></a>00407                     tab_flux_bords(fac2,k)-=0.5*signe*flux3(k);
<a name="l00408"></a>00408                 }
<a name="l00409"></a>00409             }
<a name="l00410"></a>00410           <span class="keywordflow">break</span>;
<a name="l00411"></a>00411         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>:
<a name="l00412"></a>00412           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi_fluide())
<a name="l00413"></a>00413             {
<a name="l00414"></a>00414               fac1 = Qdm(n_arete,0);
<a name="l00415"></a>00415               fac2 = Qdm(n_arete,1);
<a name="l00416"></a>00416               fac3 = Qdm(n_arete,2);
<a name="l00417"></a>00417               signe = Qdm(n_arete,3);
<a name="l00418"></a>00418               flux_evaluateur.flux_arete_paroi_fluide(inco, fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l00419"></a>00419               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00420"></a>00420                 {
<a name="l00421"></a>00421                   resu(fac3,k)+=signe*flux3(k);
<a name="l00422"></a>00422                   resu(fac1,k)+=flux1_2(k);
<a name="l00423"></a>00423                   resu(fac2,k)-=flux1_2(k);
<a name="l00424"></a>00424                   <span class="keywordflow">if</span> (fac1&lt;n)
<a name="l00425"></a>00425                     tab_flux_bords(fac1,k)-=0.5*signe*flux3(k);
<a name="l00426"></a>00426                   <span class="keywordflow">if</span> (fac2&lt;n)
<a name="l00427"></a>00427                     tab_flux_bords(fac2,k)-=0.5*signe*flux3(k);
<a name="l00428"></a>00428                 }
<a name="l00429"></a>00429             }
<a name="l00430"></a>00430           <span class="keywordflow">break</span>;
<a name="l00431"></a>00431         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a8ffe822aae0518f507be135120ec23b8">TypeAreteBordVDF::SYM_SYM</a>:
<a name="l00432"></a>00432           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie())
<a name="l00433"></a>00433             {
<a name="l00434"></a>00434               fac1 = Qdm(n_arete,0);
<a name="l00435"></a>00435               fac2 = Qdm(n_arete,1);
<a name="l00436"></a>00436               fac3 = Qdm(n_arete,2);
<a name="l00437"></a>00437               signe = Qdm(n_arete,3);
<a name="l00438"></a>00438               flux_evaluateur.flux_arete_symetrie(inco, fac1, fac2, fac3, signe, flux);
<a name="l00439"></a>00439               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00440"></a>00440                 resu(fac3,k)+=signe*flux(k);
<a name="l00441"></a>00441             }
<a name="l00442"></a>00442           <span class="keywordflow">break</span>;
<a name="l00443"></a>00443         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a37713c7b918ab812a24573ce30b2a322">TypeAreteBordVDF::PERIO_PERIO</a>:
<a name="l00444"></a>00444           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_periodicite())
<a name="l00445"></a>00445             {
<a name="l00446"></a>00446               fac1 = Qdm(n_arete,0);
<a name="l00447"></a>00447               fac2 = Qdm(n_arete,1);
<a name="l00448"></a>00448               fac3 = Qdm(n_arete,2);
<a name="l00449"></a>00449               fac4 = Qdm(n_arete,3);
<a name="l00450"></a>00450               flux_evaluateur.flux_arete_periodicite(inco, fac1, fac2, fac3, fac4, flux3_4, flux1_2);
<a name="l00451"></a>00451               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00452"></a>00452                 {
<a name="l00453"></a>00453                   resu(fac3,k)+=0.5*flux3_4(k);
<a name="l00454"></a>00454                   resu(fac4,k)-=0.5*flux3_4(k);
<a name="l00455"></a>00455                   resu(fac1,k)+=flux1_2(k);
<a name="l00456"></a>00456                   resu(fac2,k)-=flux1_2(k);
<a name="l00457"></a>00457                 }
<a name="l00458"></a>00458             }
<a name="l00459"></a>00459           <span class="keywordflow">break</span>;
<a name="l00460"></a>00460         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac0b72d665d0d8eb58248f5c6c65f410c">TypeAreteBordVDF::PAROI_SYM</a>:
<a name="l00461"></a>00461           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie_paroi())
<a name="l00462"></a>00462             {
<a name="l00463"></a>00463               fac1 = Qdm(n_arete,0);
<a name="l00464"></a>00464               fac2 = Qdm(n_arete,1);
<a name="l00465"></a>00465               fac3 = Qdm(n_arete,2);
<a name="l00466"></a>00466               signe = Qdm(n_arete,3);
<a name="l00467"></a>00467               flux_evaluateur.flux_arete_symetrie_paroi(inco, fac1, fac2, fac3, signe, flux);
<a name="l00468"></a>00468               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00469"></a>00469                 resu(fac3,k)+=signe*flux(k);
<a name="l00470"></a>00470             }
<a name="l00471"></a>00471           <span class="keywordflow">break</span>;
<a name="l00472"></a>00472         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a460c2f242b0d8c910f37c8940e504707">TypeAreteBordVDF::FLUIDE_SYM</a>:
<a name="l00473"></a>00473           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie_fluide())
<a name="l00474"></a>00474             {
<a name="l00475"></a>00475               fac1 = Qdm(n_arete,0);
<a name="l00476"></a>00476               fac2 = Qdm(n_arete,1);
<a name="l00477"></a>00477               fac3 = Qdm(n_arete,2);
<a name="l00478"></a>00478               signe = Qdm(n_arete,3);
<a name="l00479"></a>00479               flux_evaluateur.flux_arete_symetrie_fluide(inco, fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l00480"></a>00480               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00481"></a>00481                 {
<a name="l00482"></a>00482                   resu(fac3,k)+=signe*flux3(k);
<a name="l00483"></a>00483                   resu(fac1,k)+=flux1_2(k);
<a name="l00484"></a>00484                   resu(fac2,k)-=flux1_2(k);
<a name="l00485"></a>00485                 }
<a name="l00486"></a>00486             }
<a name="l00487"></a>00487           <span class="keywordflow">break</span>;
<a name="l00488"></a>00488         <span class="keywordflow">default</span> :
<a name="l00489"></a>00489           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l00490"></a>00490           \
<a name="l00491"></a>00491           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l00492"></a>00492           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l00493"></a>00493           exit();
<a name="l00494"></a>00494           <span class="keywordflow">break</span>;
<a name="l00495"></a>00495         }
<a name="l00496"></a>00496     }
<a name="l00497"></a>00497   <span class="keywordflow">return</span> resu;
<a name="l00498"></a>00498 }
<a name="l00499"></a>00499 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00500"></a><a class="code" href="classT__It__VDF__Face.html#a9a7cff4f2529285137354b2297579b8d">00500</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a9a7cff4f2529285137354b2297579b8d">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_aretes_coins</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00501"></a>00501 <span class="keyword"></span>{
<a name="l00502"></a>00502   <span class="keywordtype">int</span> n_arete;
<a name="l00503"></a>00503   <span class="keywordtype">int</span> signe;
<a name="l00504"></a>00504   <span class="keywordtype">int</span> n_type;
<a name="l00505"></a>00505   <span class="keywordtype">double</span> flux,flux3_4=0,flux1_2=0;
<a name="l00506"></a>00506   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l00507"></a>00507   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords=op_base-&gt;flux_bords();
<a name="l00508"></a>00508   <span class="keywordflow">for</span> (n_arete=premiere_arete_coin; n_arete&lt;derniere_arete_coin; n_arete++)
<a name="l00509"></a>00509     {
<a name="l00510"></a>00510       n_type=type_arete_coin(n_arete-premiere_arete_coin);
<a name="l00511"></a>00511       <span class="keywordflow">switch</span>(n_type)
<a name="l00512"></a>00512         {
<a name="l00513"></a>00513         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aad369ed721afc9b287b160c7a91a284a4">TypeAreteCoinVDF::PERIO_PERIO</a>:
<a name="l00514"></a>00514           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_periodicite())
<a name="l00515"></a>00515             {
<a name="l00516"></a>00516               fac1 = Qdm(n_arete,0);
<a name="l00517"></a>00517               fac2 = Qdm(n_arete,1);
<a name="l00518"></a>00518               fac3 = Qdm(n_arete,2);
<a name="l00519"></a>00519               fac4 = Qdm(n_arete,3);
<a name="l00520"></a>00520               flux_evaluateur.flux_arete_periodicite(inco, fac1, fac2, fac3, fac4, flux3_4, flux1_2);
<a name="l00521"></a>00521               resu[fac3]+=0.5*flux3_4;
<a name="l00522"></a>00522               resu[fac4]-=0.5*flux3_4;
<a name="l00523"></a>00523               resu[fac1]+=0.5*flux1_2;
<a name="l00524"></a>00524               resu[fac2]-=0.5*flux1_2;
<a name="l00525"></a>00525             }
<a name="l00526"></a>00526           <span class="keywordflow">break</span>;
<a name="l00527"></a>00527         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa5203ea39fbbb2afbe1cac55f4919f144">TypeAreteCoinVDF::PERIO_PAROI</a>:
<a name="l00528"></a>00528           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l00529"></a>00529             {
<a name="l00530"></a>00530               fac1 = Qdm(n_arete,0);
<a name="l00531"></a>00531               fac2 = Qdm(n_arete,1);
<a name="l00532"></a>00532               fac3 = Qdm(n_arete,2);
<a name="l00533"></a>00533               signe = Qdm(n_arete,3);
<a name="l00534"></a>00534               flux=flux_evaluateur.flux_arete_paroi(inco, fac1, fac2, fac3, signe);
<a name="l00535"></a>00535               resu[fac3]+=signe*flux;
<a name="l00536"></a>00536               <span class="comment">/* on ajoute la contribution du coin paroi-perio au flux_bord */</span>
<a name="l00537"></a>00537               <span class="comment">/* classiquement -0.5*signe*flux */</span>
<a name="l00538"></a>00538               <span class="comment">/* on met 0.25 sur les deux faces (car on  ajoutera deux fois la contrib) */</span>
<a name="l00539"></a>00539               tab_flux_bords(fac1,orientation(fac3))-=0.25*signe*flux;
<a name="l00540"></a>00540               tab_flux_bords(fac2,orientation(fac3))-=0.25*signe*flux;
<a name="l00541"></a>00541             }
<a name="l00542"></a>00542           <span class="keywordflow">break</span>;
<a name="l00543"></a>00543         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa8d6cb48990b19d4ad52f6414b83d72d9">TypeAreteCoinVDF::PAROI_FLUIDE</a>:
<a name="l00544"></a>00544           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l00545"></a>00545             {
<a name="l00546"></a>00546               <span class="comment">/*               int i=0;  while ( Qdm(n_arete,i)==-1) i++;</span>
<a name="l00547"></a>00547 <span class="comment">                               fac1=Qdm(n_arete,i);i++;</span>
<a name="l00548"></a>00548 <span class="comment">                               while ( Qdm(n_arete,i)==-1) i++;</span>
<a name="l00549"></a>00549 <span class="comment">                               fac3 = Qdm(n_arete,i);</span>
<a name="l00550"></a>00550 <span class="comment">                               signe = 1;</span>
<a name="l00551"></a>00551 <span class="comment">                               flux=flux_evaluateur.flux_arete_paroi(inco, fac1, fac1,fac3, signe);*/</span> \
<a name="l00552"></a>00552               <span class="comment">/*Cerr&lt;&lt;&quot;coin &quot;&lt;&lt;fac1&lt;&lt;&quot; &quot;&lt;&lt;fac3&lt;&lt;&quot; &quot;&lt;&lt;signe&lt;&lt;finl;*/</span>
<a name="l00553"></a>00553               fac1 = Qdm(n_arete,0);
<a name="l00554"></a>00554               fac2 = Qdm(n_arete,1);
<a name="l00555"></a>00555               fac3 = Qdm(n_arete,2);
<a name="l00556"></a>00556               signe = Qdm(n_arete,3);
<a name="l00557"></a>00557               flux=flux_evaluateur.flux_arete_paroi(inco, fac1, fac2, fac3, signe);
<a name="l00558"></a>00558               resu[fac3]+=signe*flux;
<a name="l00559"></a>00559               <span class="comment">/*Cerr&lt;&lt;&quot;coin &quot;&lt;&lt;fac1&lt;&lt;&quot; &quot;&lt;&lt;fac2&lt;&lt;&quot; &quot;&lt;&lt;fac3&lt;&lt;&quot; &quot;&lt;&lt;signe &lt;&lt; &quot; &quot; &lt;&lt; flux&lt;&lt;finl;*/</span>
<a name="l00560"></a>00560               ((<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;)(tab_flux_bords))(fac1,orientation(fac3))-=0.5*signe*flux;
<a name="l00561"></a>00561             }
<a name="l00562"></a>00562           <span class="keywordflow">break</span>;
<a name="l00563"></a>00563         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa0f79a01fe58c2a6a8ffde290a2ebc660">TypeAreteCoinVDF::FLUIDE_PAROI</a>:
<a name="l00564"></a>00564           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l00565"></a>00565             {
<a name="l00566"></a>00566               <span class="comment">/*int i=0;  while ( Qdm(n_arete,i)==-1) i++;</span>
<a name="l00567"></a>00567 <span class="comment">                fac3=Qdm(n_arete,i);i++;</span>
<a name="l00568"></a>00568 <span class="comment">                while ( Qdm(n_arete,i)==-1) i++;</span>
<a name="l00569"></a>00569 <span class="comment">                fac1 = Qdm(n_arete,i);</span>
<a name="l00570"></a>00570 <span class="comment">                signe = 1;</span>
<a name="l00571"></a>00571 <span class="comment">                flux=flux_evaluateur.flux_arete_paroi(inco, fac1, fac1,fac3, signe);*/</span>
<a name="l00572"></a>00572               <span class="comment">/*Cerr&lt;&lt;&quot;coin2 &quot;&lt;&lt;fac1&lt;&lt;&quot; &quot;&lt;&lt;fac3&lt;&lt;&quot; &quot;&lt;&lt;signe&lt;&lt;finl;*/</span>
<a name="l00573"></a>00573               fac1 = Qdm(n_arete,0);
<a name="l00574"></a>00574               fac2 = Qdm(n_arete,1);
<a name="l00575"></a>00575               fac3 = Qdm(n_arete,2);
<a name="l00576"></a>00576               signe = Qdm(n_arete,3);
<a name="l00577"></a>00577               flux=flux_evaluateur.flux_arete_paroi(inco, fac1, fac2, fac3, signe);
<a name="l00578"></a>00578               resu[fac3]+=signe*flux;
<a name="l00579"></a>00579               ((<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;)(tab_flux_bords))(fac1,orientation(fac3))-=0.5*signe*flux;
<a name="l00580"></a>00580             }
<a name="l00581"></a>00581           <span class="keywordflow">break</span>;
<a name="l00582"></a>00582         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa42458df5735cf406f85838495b654982">TypeAreteCoinVDF::FLUIDE_FLUIDE</a>:
<a name="l00583"></a>00583           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_coin_fluide())
<a name="l00584"></a>00584             {
<a name="l00585"></a>00585               <span class="keywordtype">double</span> flux3=0;
<a name="l00586"></a>00586               <span class="keywordtype">int</span> n=la_zone-&gt;nb_faces_bord();
<a name="l00587"></a>00587               fac1 = Qdm(n_arete,0);
<a name="l00588"></a>00588               fac2 = Qdm(n_arete,1);
<a name="l00589"></a>00589               fac3 = Qdm(n_arete,2);
<a name="l00590"></a>00590               signe = Qdm(n_arete,3);
<a name="l00591"></a>00591               flux_evaluateur.flux_arete_coin_fluide(inco, fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l00592"></a>00592               resu[fac3]+=signe*flux3;
<a name="l00593"></a>00593               resu[fac1]+=flux1_2;
<a name="l00594"></a>00594 <span class="comment">// resu[fac2]-=flux1_2;</span>
<a name="l00595"></a>00595               <span class="keywordflow">if</span> (fac1&lt;n)
<a name="l00596"></a>00596                 tab_flux_bords(fac1,orientation(fac3))-=0.5*signe*flux3;
<a name="l00597"></a>00597 <span class="comment">// if (fac2&lt;n)</span>
<a name="l00598"></a>00598 <span class="comment">// tab_flux_bords(fac2,orientation(fac3))-=0.5*signe*flux3;</span>
<a name="l00599"></a>00599             }
<a name="l00600"></a>00600           <span class="keywordflow">break</span>;
<a name="l00601"></a>00601         <span class="keywordflow">default</span> :
<a name="l00602"></a>00602           <span class="keywordflow">break</span>;
<a name="l00603"></a>00603         }
<a name="l00604"></a>00604     }
<a name="l00605"></a>00605   <span class="keywordflow">return</span> resu;
<a name="l00606"></a>00606 }
<a name="l00607"></a>00607 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00608"></a><a class="code" href="classT__It__VDF__Face.html#a786ef2ae93b53140d156c3666079c14e">00608</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a9a7cff4f2529285137354b2297579b8d">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_aretes_coins</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,
<a name="l00609"></a>00609                                                        <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00610"></a>00610 <span class="keyword"></span>{
<a name="l00611"></a>00611   <span class="keywordtype">int</span> n_arete;
<a name="l00612"></a>00612   <span class="keywordtype">int</span> signe;
<a name="l00613"></a>00613   <span class="keywordtype">int</span> n_type;
<a name="l00614"></a>00614   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp), flux3(ncomp), flux3_4(ncomp), flux1_2(ncomp);
<a name="l00615"></a>00615   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l00616"></a>00616   <span class="keywordtype">int</span> k;
<a name="l00617"></a>00617   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords=op_base-&gt;flux_bords();
<a name="l00618"></a>00618   <span class="keywordflow">for</span> (n_arete=premiere_arete_coin; n_arete&lt;derniere_arete_coin; n_arete++)
<a name="l00619"></a>00619     {
<a name="l00620"></a>00620       <span class="comment">/* OC 01/2005 : bug dans la ligne suivante ? type_arete_bord-&gt;type_arete_coin*/</span>
<a name="l00621"></a>00621       <span class="comment">/* n_type=type_arete_bord(n_arete-premiere_arete_coin);*/</span>
<a name="l00622"></a>00622       n_type=type_arete_coin(n_arete-premiere_arete_coin);
<a name="l00623"></a>00623       <span class="keywordflow">switch</span>(n_type)
<a name="l00624"></a>00624         {
<a name="l00625"></a>00625         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aad369ed721afc9b287b160c7a91a284a4">TypeAreteCoinVDF::PERIO_PERIO</a>:
<a name="l00626"></a>00626           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_periodicite())
<a name="l00627"></a>00627             {
<a name="l00628"></a>00628               fac1 = Qdm(n_arete,0);
<a name="l00629"></a>00629               fac2 = Qdm(n_arete,1);
<a name="l00630"></a>00630               fac3 = Qdm(n_arete,2);
<a name="l00631"></a>00631               fac4 = Qdm(n_arete,3);
<a name="l00632"></a>00632               flux_evaluateur.flux_arete_periodicite(inco, fac1, fac2, fac3, fac4, flux3_4, flux1_2);
<a name="l00633"></a>00633               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00634"></a>00634                 {
<a name="l00635"></a>00635                   resu(fac3,k)+=0.5*flux3_4(k);
<a name="l00636"></a>00636                   resu(fac4,k)-=0.5*flux3_4(k);
<a name="l00637"></a>00637                   resu(fac1,k)+=flux1_2(k);
<a name="l00638"></a>00638                   resu(fac2,k)-=flux1_2(k);
<a name="l00639"></a>00639                 }
<a name="l00640"></a>00640             }
<a name="l00641"></a>00641           <span class="keywordflow">break</span>;
<a name="l00642"></a>00642         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa5203ea39fbbb2afbe1cac55f4919f144">TypeAreteCoinVDF::PERIO_PAROI</a>:
<a name="l00643"></a>00643           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l00644"></a>00644             {
<a name="l00645"></a>00645               fac1 = Qdm(n_arete,0);
<a name="l00646"></a>00646               fac2 = Qdm(n_arete,1);
<a name="l00647"></a>00647               fac3 = Qdm(n_arete,2);
<a name="l00648"></a>00648               signe = Qdm(n_arete,3);
<a name="l00649"></a>00649               flux_evaluateur.flux_arete_paroi(inco, fac1, fac2, fac3, signe, flux);
<a name="l00650"></a>00650               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00651"></a>00651                 {
<a name="l00652"></a>00652                   resu(fac3,k)+=signe*flux(k);
<a name="l00653"></a>00653                   <span class="comment">/* on ajoute la contribution du coin paroi-perio au flux_bord */</span>
<a name="l00654"></a>00654                   <span class="comment">/* classiquement -0.5*signe*flux */</span>
<a name="l00655"></a>00655                   <span class="comment">/* on met 0.25 sur les deux faces (car on  ajoutera deux fois la contrib) */</span>
<a name="l00656"></a>00656                   tab_flux_bords(fac1,k)-=0.25*signe*flux(k);
<a name="l00657"></a>00657                   tab_flux_bords(fac2,k)-=0.25*signe*flux(k);
<a name="l00658"></a>00658                 }
<a name="l00659"></a>00659             }
<a name="l00660"></a>00660           <span class="keywordflow">break</span>;
<a name="l00661"></a>00661         <span class="keywordflow">default</span> :
<a name="l00662"></a>00662           <span class="keywordflow">break</span>;
<a name="l00663"></a>00663         }
<a name="l00664"></a>00664     }
<a name="l00665"></a>00665   <span class="keywordflow">return</span> resu;
<a name="l00666"></a>00666 }
<a name="l00667"></a>00667 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00668"></a><a class="code" href="classT__It__VDF__Face.html#a4a998b55936203f2147e48522223b3b7">00668</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a4a998b55936203f2147e48522223b3b7">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_aretes_internes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,
<a name="l00669"></a>00669                                                           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00670"></a>00670 <span class="keyword"></span>{
<a name="l00671"></a>00671   <span class="keywordflow">if</span>(!flux_evaluateur.calculer_arete_interne())
<a name="l00672"></a>00672     <span class="keywordflow">return</span> resu;
<a name="l00673"></a>00673   <span class="keywordtype">double</span> flux;
<a name="l00674"></a>00674   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l00675"></a>00675   <span class="keywordtype">int</span> n_arete;
<a name="l00676"></a>00676   <span class="keywordflow">for</span> (n_arete=premiere_arete_interne; n_arete&lt;derniere_arete_interne; n_arete++)
<a name="l00677"></a>00677     {
<a name="l00678"></a>00678       fac1=Qdm(n_arete,0);
<a name="l00679"></a>00679       fac2=Qdm(n_arete,1);
<a name="l00680"></a>00680       fac3=Qdm(n_arete,2);
<a name="l00681"></a>00681       fac4=Qdm(n_arete,3);
<a name="l00682"></a>00682       flux=flux_evaluateur.flux_arete_interne(inco, fac1, fac2, fac3, fac4);
<a name="l00683"></a>00683       resu[fac3] += flux;
<a name="l00684"></a>00684       resu[fac4] -= flux;
<a name="l00685"></a>00685       flux=flux_evaluateur.flux_arete_interne(inco, fac3, fac4, fac1, fac2);
<a name="l00686"></a>00686       resu[fac1] += flux;
<a name="l00687"></a>00687       resu[fac2] -= flux;
<a name="l00688"></a>00688     }
<a name="l00689"></a>00689   <span class="keywordflow">return</span> resu;
<a name="l00690"></a>00690 }
<a name="l00691"></a>00691 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00692"></a><a class="code" href="classT__It__VDF__Face.html#aebdaa69ad2b9db41a9e1d20c4e25516e">00692</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a4a998b55936203f2147e48522223b3b7">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_aretes_internes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,
<a name="l00693"></a>00693                                                           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00694"></a>00694 <span class="keyword"></span>{
<a name="l00695"></a>00695   <span class="keywordflow">if</span>(!flux_evaluateur.calculer_arete_interne())
<a name="l00696"></a>00696     <span class="keywordflow">return</span> resu;
<a name="l00697"></a>00697   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp);
<a name="l00698"></a>00698   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l00699"></a>00699   <span class="keywordtype">int</span> n_arete,k;
<a name="l00700"></a>00700   <span class="keywordflow">for</span> (n_arete=premiere_arete_interne; n_arete&lt;derniere_arete_interne; n_arete++)
<a name="l00701"></a>00701     {
<a name="l00702"></a>00702       fac1=Qdm(n_arete,0);
<a name="l00703"></a>00703       fac2=Qdm(n_arete,1);
<a name="l00704"></a>00704       fac3=Qdm(n_arete,2);
<a name="l00705"></a>00705       fac4=Qdm(n_arete,3);
<a name="l00706"></a>00706       flux_evaluateur.flux_arete_interne(inco, fac1, fac2, fac3, fac4,flux);
<a name="l00707"></a>00707       <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00708"></a>00708         {
<a name="l00709"></a>00709           resu(fac3,k) += flux(k);
<a name="l00710"></a>00710           resu(fac4,k) -= flux(k);
<a name="l00711"></a>00711         }
<a name="l00712"></a>00712       flux_evaluateur.flux_arete_interne(inco, fac3, fac4, fac1, fac2, flux);
<a name="l00713"></a>00713       <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00714"></a>00714         {
<a name="l00715"></a>00715           resu(fac1,k) += flux(k);
<a name="l00716"></a>00716           resu(fac2,k) -= flux(k);
<a name="l00717"></a>00717         }
<a name="l00718"></a>00718     }
<a name="l00719"></a>00719   <span class="keywordflow">return</span> resu;
<a name="l00720"></a>00720 }
<a name="l00721"></a>00721 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00722"></a><a class="code" href="classT__It__VDF__Face.html#a454d1736355e7bf9a9673544666a3069">00722</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a454d1736355e7bf9a9673544666a3069">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_aretes_mixtes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,
<a name="l00723"></a>00723                                                         <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00724"></a>00724 <span class="keyword"></span>{
<a name="l00725"></a>00725   <span class="keywordflow">if</span>(!flux_evaluateur.calculer_arete_mixte())
<a name="l00726"></a>00726     <span class="keywordflow">return</span> resu;
<a name="l00727"></a>00727   <span class="keywordtype">double</span> flux;
<a name="l00728"></a>00728   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l00729"></a>00729   <span class="keywordtype">int</span> n_arete;
<a name="l00730"></a>00730   <span class="keywordtype">int</span> n=la_zone-&gt;nb_faces_bord();
<a name="l00731"></a>00731   <span class="keywordtype">int</span> n2=la_zone-&gt;nb_faces_tot();  <span class="comment">/* GF pour assurer bilan seq= para */</span>
<a name="l00732"></a>00732   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords=op_base-&gt;flux_bords();
<a name="l00733"></a>00733   <span class="keywordflow">for</span> (n_arete=premiere_arete_mixte; n_arete&lt;derniere_arete_mixte; n_arete++)
<a name="l00734"></a>00734     {
<a name="l00735"></a>00735       fac1=Qdm(n_arete,0);
<a name="l00736"></a>00736       fac2=Qdm(n_arete,1);
<a name="l00737"></a>00737       fac3=Qdm(n_arete,2);
<a name="l00738"></a>00738       fac4=Qdm(n_arete,3);
<a name="l00739"></a>00739       flux=flux_evaluateur.flux_arete_mixte(inco, fac1, fac2, fac3, fac4);
<a name="l00740"></a>00740       resu[fac3] += flux;
<a name="l00741"></a>00741       resu[fac4] -= flux;
<a name="l00742"></a>00742       <span class="keywordflow">if</span> (fac4&lt;n2)
<a name="l00743"></a>00743         {
<a name="l00744"></a>00744           <span class="keywordflow">if</span> (fac1&lt;n)
<a name="l00745"></a>00745             tab_flux_bords(fac1,orientation(fac3))-=flux;
<a name="l00746"></a>00746           <span class="keywordflow">if</span> (fac2&lt;n)
<a name="l00747"></a>00747             tab_flux_bords(fac2,orientation(fac4))-=flux;
<a name="l00748"></a>00748         }
<a name="l00749"></a>00749       <span class="keywordflow">if</span> (fac3&lt;n2)
<a name="l00750"></a>00750         {
<a name="l00751"></a>00751           <span class="keywordflow">if</span> (fac1&lt;n)
<a name="l00752"></a>00752             tab_flux_bords(fac1,orientation(fac3))+=flux;
<a name="l00753"></a>00753           <span class="keywordflow">if</span> (fac2&lt;n)
<a name="l00754"></a>00754             tab_flux_bords(fac2,orientation(fac4))+=flux;
<a name="l00755"></a>00755         }
<a name="l00756"></a>00756       flux=flux_evaluateur.flux_arete_mixte(inco, fac3, fac4, fac1, fac2);
<a name="l00757"></a>00757       resu[fac1] += flux;
<a name="l00758"></a>00758       resu[fac2] -= flux;
<a name="l00759"></a>00759       <span class="keywordflow">if</span> (fac2&lt;n2)
<a name="l00760"></a>00760         {
<a name="l00761"></a>00761           <span class="keywordflow">if</span> (fac3&lt;n)
<a name="l00762"></a>00762             tab_flux_bords(fac3,orientation(fac1))-=flux;
<a name="l00763"></a>00763           <span class="keywordflow">if</span> (fac4&lt;n)
<a name="l00764"></a>00764             tab_flux_bords(fac4,orientation(fac2))-=flux;
<a name="l00765"></a>00765         }
<a name="l00766"></a>00766       <span class="keywordflow">if</span> (fac1&lt;n2)
<a name="l00767"></a>00767         {
<a name="l00768"></a>00768           <span class="keywordflow">if</span> (fac3&lt;n)
<a name="l00769"></a>00769             tab_flux_bords(fac3,orientation(fac1))+=flux;
<a name="l00770"></a>00770           <span class="keywordflow">if</span> (fac4&lt;n)
<a name="l00771"></a>00771             tab_flux_bords(fac4,orientation(fac2))+=flux;
<a name="l00772"></a>00772         }
<a name="l00773"></a>00773     }
<a name="l00774"></a>00774   <span class="keywordflow">return</span> resu;
<a name="l00775"></a>00775 }
<a name="l00776"></a><a class="code" href="classT__It__VDF__Face.html#abf11881f6d1af23be883c134b2864783">00776</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;                                                             <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a454d1736355e7bf9a9673544666a3069">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_aretes_mixtes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,
<a name="l00777"></a>00777     <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00778"></a>00778 <span class="keyword"></span>{
<a name="l00779"></a>00779   <span class="keywordflow">if</span>(!flux_evaluateur.calculer_arete_mixte())
<a name="l00780"></a>00780     <span class="keywordflow">return</span> resu;
<a name="l00781"></a>00781   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp);
<a name="l00782"></a>00782   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l00783"></a>00783   <span class="keywordtype">int</span> n_arete,k;
<a name="l00784"></a>00784   <span class="keywordflow">for</span> (n_arete=premiere_arete_mixte; n_arete&lt;derniere_arete_mixte; n_arete++)
<a name="l00785"></a>00785     {
<a name="l00786"></a>00786       fac1=Qdm(n_arete,0);
<a name="l00787"></a>00787       fac2=Qdm(n_arete,1);
<a name="l00788"></a>00788       fac3=Qdm(n_arete,2);
<a name="l00789"></a>00789       fac4=Qdm(n_arete,3);
<a name="l00790"></a>00790       flux_evaluateur.flux_arete_mixte(inco, fac1, fac2, fac3, fac4, flux);
<a name="l00791"></a>00791       <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00792"></a>00792         {
<a name="l00793"></a>00793           resu(fac3,k) += flux(k);
<a name="l00794"></a>00794           resu(fac4,k) -= flux(k);
<a name="l00795"></a>00795         }
<a name="l00796"></a>00796       flux_evaluateur.flux_arete_mixte(inco, fac3, fac4, fac1, fac2, flux);
<a name="l00797"></a>00797       <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00798"></a>00798         {
<a name="l00799"></a>00799           resu(fac1,k) += flux(k);
<a name="l00800"></a>00800           resu(fac2,k) -= flux(k);
<a name="l00801"></a>00801         }
<a name="l00802"></a>00802     }
<a name="l00803"></a>00803   <span class="keywordflow">return</span> resu;
<a name="l00804"></a>00804 }
<a name="l00805"></a>00805 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00806"></a><a class="code" href="classT__It__VDF__Face.html#a64f5c6f7a2219d3feec89c3e3a61483b">00806</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a64f5c6f7a2219d3feec89c3e3a61483b">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_fa7_sortie_libre</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00807"></a>00807 <span class="keyword"></span>{
<a name="l00808"></a>00808   <span class="keywordtype">int</span> num_cl;
<a name="l00809"></a>00809   <span class="keywordtype">int</span> ndeb, nfin;
<a name="l00810"></a>00810   <span class="keywordtype">int</span> face;
<a name="l00811"></a>00811   <span class="keywordtype">int</span> nb_front_Cl=la_zone-&gt;nb_front_Cl();
<a name="l00812"></a>00812   <span class="keywordflow">for</span> (num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l00813"></a>00813     {
<a name="l00814"></a>00814       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl-&gt;les_conditions_limites(num_cl);
<a name="l00815"></a>00815       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00816"></a>00816       ndeb = frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00817"></a>00817       nfin = ndeb + frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00818"></a>00818       <span class="keywordflow">switch</span>(type_cl(la_cl))
<a name="l00819"></a>00819         {
<a name="l00820"></a>00820         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac4317ef27513bbab3cd0ccfd0d9ed199" title="Neumann_sortie_libre ou derivees.">sortie_libre</a> :
<a name="l00821"></a>00821           <span class="keywordflow">if</span> (flux_evaluateur.calculer_fa7_sortie_libre())
<a name="l00822"></a>00822             {
<a name="l00823"></a>00823               <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; cl =(<span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp;) (la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00824"></a>00824               <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l00825"></a>00825                 {
<a name="l00826"></a>00826                   <span class="keywordtype">double</span> flux=flux_evaluateur.flux_fa7_sortie_libre(inco, face, cl, ndeb);
<a name="l00827"></a>00827                   <span class="keywordflow">if</span> ( (elem(face,0)) &gt; -1)
<a name="l00828"></a>00828                     resu[face]+=flux;
<a name="l00829"></a>00829                   <span class="keywordflow">if</span> ( (elem(face,1)) &gt; -1)
<a name="l00830"></a>00830                     resu[face]-=flux;
<a name="l00831"></a>00831                 }
<a name="l00832"></a>00832             }
<a name="l00833"></a>00833           <span class="keywordflow">break</span>;
<a name="l00834"></a>00834         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac938491055e13993f3eed68c989f90b0" title="Symetrie.">symetrie</a> :
<a name="l00835"></a>00835           <span class="keywordflow">break</span>;
<a name="l00836"></a>00836         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a594fd60a4576f47654eed7df53dee9be" title="Dirichlet_entree_fluide.">entree_fluide</a> :
<a name="l00837"></a>00837           <span class="keywordflow">break</span>;
<a name="l00838"></a>00838         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a497d92e00f36c1c7ec874c0a318db91e" title="Dirichlet_paroi_fixe.">paroi_fixe</a> :
<a name="l00839"></a>00839           <span class="keywordflow">break</span>;
<a name="l00840"></a>00840         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649acdd1bf461cb105b93d5a9b003ce33141" title="Dirichlet_paroi_defilante.">paroi_defilante</a> :
<a name="l00841"></a>00841           <span class="keywordflow">break</span>;
<a name="l00842"></a>00842         <span class="keywordflow">case</span> <a class="code" href="classparoi__adiabatique.html">paroi_adiabatique</a> :
<a name="l00843"></a>00843           <span class="keywordflow">break</span>;
<a name="l00844"></a>00844         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649af695f3ba17490e07dc3259c85875d8d6" title="Neumann_paroi.">paroi</a>:
<a name="l00845"></a>00845           <span class="keywordflow">break</span>;
<a name="l00846"></a>00846         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a38f997f881a13a46f2d06012162cf833" title="Echange_externe_impose.">echange_externe_impose</a> :
<a name="l00847"></a>00847           <span class="keywordflow">break</span>;
<a name="l00848"></a>00848         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a9201b83c6fe44d3928abbe5f73364323" title="Echange_global_impose.">echange_global_impose</a> :
<a name="l00849"></a>00849           <span class="keywordflow">break</span>;
<a name="l00850"></a>00850         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ab83c671c148d8664c5c87f343d2ab9fd" title="periodique">periodique</a> :
<a name="l00851"></a>00851           <span class="keywordflow">break</span>;
<a name="l00852"></a>00852         <span class="keywordflow">default</span> :
<a name="l00853"></a>00853           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On ne reconnait pas la condition limite : &quot;</span> &lt;&lt; la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>();
<a name="l00854"></a>00854           exit();
<a name="l00855"></a>00855           <span class="keywordflow">break</span>;
<a name="l00856"></a>00856         }
<a name="l00857"></a>00857     }
<a name="l00858"></a>00858   <span class="keywordflow">return</span> resu;
<a name="l00859"></a>00859 }
<a name="l00860"></a>00860 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00861"></a><a class="code" href="classT__It__VDF__Face.html#a5ef72bd17876f115df4fbc254e0ffa6b">00861</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a64f5c6f7a2219d3feec89c3e3a61483b">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_fa7_sortie_libre</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00862"></a>00862 <span class="keyword"></span>{
<a name="l00863"></a>00863   <span class="keywordtype">int</span> num_cl;
<a name="l00864"></a>00864   <span class="keywordtype">int</span> ndeb, nfin;
<a name="l00865"></a>00865   <span class="keywordtype">int</span> face,k;
<a name="l00866"></a>00866   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp);
<a name="l00867"></a>00867   <span class="keywordtype">int</span> nb_front_Cl=la_zone-&gt;nb_front_Cl();
<a name="l00868"></a>00868   <span class="keywordtype">int</span> n=la_zone-&gt;nb_faces_bord();
<a name="l00869"></a>00869   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords=op_base-&gt;flux_bords();
<a name="l00870"></a>00870   <span class="keywordflow">for</span> (num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l00871"></a>00871     {
<a name="l00872"></a>00872       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl-&gt;les_conditions_limites(num_cl);
<a name="l00873"></a>00873       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00874"></a>00874       ndeb = frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00875"></a>00875       nfin = ndeb + frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00876"></a>00876       <span class="keywordflow">switch</span>(type_cl(la_cl))
<a name="l00877"></a>00877         {
<a name="l00878"></a>00878         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac4317ef27513bbab3cd0ccfd0d9ed199" title="Neumann_sortie_libre ou derivees.">sortie_libre</a> :
<a name="l00879"></a>00879           <span class="keywordflow">if</span> (flux_evaluateur.calculer_fa7_sortie_libre())
<a name="l00880"></a>00880             {
<a name="l00881"></a>00881               <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; cl =(<span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp;) (la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00882"></a>00882               <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l00883"></a>00883                 {
<a name="l00884"></a>00884                   flux_evaluateur.flux_fa7_sortie_libre(inco, face, cl, ndeb, flux);
<a name="l00885"></a>00885                   <span class="keywordflow">if</span> ( (elem(face,0)) &gt; -1)
<a name="l00886"></a>00886                     <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00887"></a>00887                       resu(face,k) += flux(k);
<a name="l00888"></a>00888                   <span class="keywordflow">if</span> ( (elem(face,1)) &gt; -1)
<a name="l00889"></a>00889                     <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00890"></a>00890                       resu(face,k) -= flux(k);
<a name="l00891"></a>00891                   <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00892"></a>00892                     <span class="keywordflow">if</span> (face&lt;n)
<a name="l00893"></a>00893                       tab_flux_bords(face,k)-=flux(k);
<a name="l00894"></a>00894                 }
<a name="l00895"></a>00895             }
<a name="l00896"></a>00896           <span class="keywordflow">break</span>;
<a name="l00897"></a>00897         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac938491055e13993f3eed68c989f90b0" title="Symetrie.">symetrie</a> :
<a name="l00898"></a>00898           <span class="keywordflow">break</span>;
<a name="l00899"></a>00899         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a594fd60a4576f47654eed7df53dee9be" title="Dirichlet_entree_fluide.">entree_fluide</a> :
<a name="l00900"></a>00900           <span class="keywordflow">break</span>;
<a name="l00901"></a>00901         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a497d92e00f36c1c7ec874c0a318db91e" title="Dirichlet_paroi_fixe.">paroi_fixe</a> :
<a name="l00902"></a>00902           <span class="keywordflow">break</span>;
<a name="l00903"></a>00903         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649acdd1bf461cb105b93d5a9b003ce33141" title="Dirichlet_paroi_defilante.">paroi_defilante</a> :
<a name="l00904"></a>00904           <span class="keywordflow">break</span>;
<a name="l00905"></a>00905         <span class="keywordflow">case</span> <a class="code" href="classparoi__adiabatique.html">paroi_adiabatique</a> :
<a name="l00906"></a>00906           <span class="keywordflow">break</span>;
<a name="l00907"></a>00907         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649af695f3ba17490e07dc3259c85875d8d6" title="Neumann_paroi.">paroi</a>:
<a name="l00908"></a>00908           <span class="keywordflow">break</span>;
<a name="l00909"></a>00909         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a38f997f881a13a46f2d06012162cf833" title="Echange_externe_impose.">echange_externe_impose</a> :
<a name="l00910"></a>00910           <span class="keywordflow">break</span>;
<a name="l00911"></a>00911         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a9201b83c6fe44d3928abbe5f73364323" title="Echange_global_impose.">echange_global_impose</a> :
<a name="l00912"></a>00912           <span class="keywordflow">break</span>;
<a name="l00913"></a>00913         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ab83c671c148d8664c5c87f343d2ab9fd" title="periodique">periodique</a> :
<a name="l00914"></a>00914           <span class="keywordflow">break</span>;
<a name="l00915"></a>00915         <span class="keywordflow">default</span> :
<a name="l00916"></a>00916           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On ne reconnait pas la condition limite : &quot;</span> &lt;&lt; la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>();
<a name="l00917"></a>00917           exit();
<a name="l00918"></a>00918           <span class="keywordflow">break</span>;
<a name="l00919"></a>00919         }
<a name="l00920"></a>00920     }
<a name="l00921"></a>00921   <span class="keywordflow">return</span> resu;
<a name="l00922"></a>00922 }
<a name="l00923"></a>00923 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00924"></a><a class="code" href="classT__It__VDF__Face.html#a7d501b46aec6ed455978031bf7419cbe">00924</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a7d501b46aec6ed455978031bf7419cbe">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_fa7_elem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00925"></a>00925 <span class="keyword"></span>{
<a name="l00926"></a>00926   <span class="keywordtype">double</span> flux;
<a name="l00927"></a>00927   <span class="keywordtype">int</span> fa7, fac1, fac2;
<a name="l00928"></a>00928   <span class="keywordtype">int</span> num_elem=0;
<a name="l00929"></a>00929   <span class="keywordtype">int</span> n=la_zone-&gt;nb_faces_bord();
<a name="l00930"></a>00930   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords=op_base-&gt;flux_bords();
<a name="l00931"></a>00931   <span class="keywordflow">for</span>( ; num_elem&lt;nb_elem; num_elem++)
<a name="l00932"></a>00932     {
<a name="l00933"></a>00933       <span class="keywordflow">for</span> (fa7=0; fa7&lt;dimension; fa7++)
<a name="l00934"></a>00934         {
<a name="l00935"></a>00935           fac1=elem_faces(num_elem,fa7);
<a name="l00936"></a>00936           fac2=elem_faces(num_elem,fa7+dimension);
<a name="l00937"></a>00937           flux=flux_evaluateur.flux_fa7_elem(inco, num_elem, fac1, fac2);
<a name="l00938"></a>00938           resu[fac1] += flux;
<a name="l00939"></a>00939           resu[fac2] -= flux;
<a name="l00940"></a>00940           <span class="keywordflow">if</span> (fac1&lt;n)
<a name="l00941"></a>00941             tab_flux_bords(fac1,orientation(fac1))+=flux;
<a name="l00942"></a>00942           <span class="keywordflow">if</span> (fac2&lt;n)
<a name="l00943"></a>00943             tab_flux_bords(fac2,orientation(fac2))-=flux;
<a name="l00944"></a>00944         }
<a name="l00945"></a>00945     }
<a name="l00946"></a>00946   corriger_flux_fa7_elem_periodicite(inco,resu);
<a name="l00947"></a>00947   <span class="keywordflow">return</span> resu;
<a name="l00948"></a>00948 }
<a name="l00949"></a>00949 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00950"></a><a class="code" href="classT__It__VDF__Face.html#a8db1726b9924b6705f1e56b0514577f3">00950</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a7d501b46aec6ed455978031bf7419cbe">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_fa7_elem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,
<a name="l00951"></a>00951                                                    <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00952"></a>00952 <span class="keyword"></span>{
<a name="l00953"></a>00953   <span class="keywordtype">int</span> fa7, fac1, fac2;
<a name="l00954"></a>00954   <span class="keywordtype">int</span> num_elem;
<a name="l00955"></a>00955   <span class="keywordtype">int</span> k;
<a name="l00956"></a>00956   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp);
<a name="l00957"></a>00957   <span class="keywordflow">for</span>(num_elem=0; num_elem&lt;nb_elem; num_elem++)
<a name="l00958"></a>00958     {
<a name="l00959"></a>00959       <span class="keywordflow">for</span> (fa7=0; fa7&lt;dimension; fa7++)
<a name="l00960"></a>00960         {
<a name="l00961"></a>00961           fac1=elem_faces(num_elem,fa7);
<a name="l00962"></a>00962           fac2=elem_faces(num_elem,fa7+dimension);
<a name="l00963"></a>00963           flux_evaluateur.flux_fa7_elem(inco, num_elem, fac1, fac2, flux);
<a name="l00964"></a>00964           <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l00965"></a>00965             {
<a name="l00966"></a>00966               resu(fac1,k) += flux(k);
<a name="l00967"></a>00967               resu(fac2,k) -= flux(k);
<a name="l00968"></a>00968             }
<a name="l00969"></a>00969         }
<a name="l00970"></a>00970     }
<a name="l00971"></a>00971   corriger_flux_fa7_elem_periodicite(inco,resu,ncomp);
<a name="l00972"></a>00972   <span class="keywordflow">return</span> resu;
<a name="l00973"></a>00973 }
<a name="l00974"></a>00974 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l00975"></a><a class="code" href="classT__It__VDF__Face.html#a2d15449fee540997105a0824ddbead63">00975</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#ac15491a7c838c15459174fef78b7bb8c">T_It_VDF_Face&lt;_TYPE_&gt;::corriger_flux_fa7_elem_periodicite</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00976"></a>00976 <span class="keyword"></span>{
<a name="l00977"></a>00977   <span class="keywordtype">int</span> nb_front_Cl=la_zone-&gt;nb_front_Cl();
<a name="l00978"></a>00978   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l00979"></a>00979     {
<a name="l00980"></a>00980       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl-&gt;les_conditions_limites(num_cl);
<a name="l00981"></a>00981       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00982"></a>00982         {
<a name="l00983"></a>00983           <span class="keywordtype">int</span> ndeb,nfin,elem1,elem2,num_elem,ori;
<a name="l00984"></a>00984           <span class="keywordtype">int</span> face,fac1,fac2,signe;
<a name="l00985"></a>00985           <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp);
<a name="l00986"></a>00986           <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00987"></a>00987           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl_perio.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00988"></a>00988           ndeb = le_bord.num_premiere_face();
<a name="l00989"></a>00989           nfin = ndeb + le_bord.nb_faces();
<a name="l00990"></a>00990           <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l00991"></a>00991             {
<a name="l00992"></a>00992               elem1 = elem(face,0);
<a name="l00993"></a>00993               elem2 = elem(face,1);
<a name="l00994"></a>00994               ori = orientation(face);
<a name="l00995"></a>00995               <span class="keywordflow">if</span> ( (face == elem_faces(elem1,ori)) || (face == elem_faces(elem1,ori+dimension)) )
<a name="l00996"></a>00996                 {
<a name="l00997"></a>00997                   num_elem = elem2;
<a name="l00998"></a>00998                   signe = 1;
<a name="l00999"></a>00999                 }
<a name="l01000"></a>01000               <span class="keywordflow">else</span>
<a name="l01001"></a>01001                 {
<a name="l01002"></a>01002                   num_elem = elem1;
<a name="l01003"></a>01003                   signe = -1;
<a name="l01004"></a>01004                 }
<a name="l01005"></a>01005               fac1 = elem_faces(num_elem,ori);
<a name="l01006"></a>01006               fac2 = elem_faces(num_elem,ori+dimension);
<a name="l01007"></a>01007               flux_evaluateur.flux_fa7_elem(inco,num_elem,fac1,fac2,flux);
<a name="l01008"></a>01008               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;ncomp; k++)
<a name="l01009"></a>01009                 resu(face,k) += signe*flux(k);
<a name="l01010"></a>01010             }
<a name="l01011"></a>01011         }
<a name="l01012"></a>01012     }
<a name="l01013"></a>01013   <span class="keywordflow">return</span> resu;
<a name="l01014"></a>01014 }
<a name="l01015"></a>01015 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01016"></a><a class="code" href="classT__It__VDF__Face.html#ac15491a7c838c15459174fef78b7bb8c">01016</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#ac15491a7c838c15459174fef78b7bb8c">T_It_VDF_Face&lt;_TYPE_&gt;::corriger_flux_fa7_elem_periodicite</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01017"></a>01017 <span class="keyword"></span>{
<a name="l01018"></a>01018   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; la_zcl_vdf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>,la_zcl.valeur());
<a name="l01019"></a>01019   <span class="keywordtype">int</span> nb_cond_lim = la_zcl_vdf.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
<a name="l01020"></a>01020   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;nb_cond_lim; num_cl++)
<a name="l01021"></a>01021     {
<a name="l01022"></a>01022       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl_vdf.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(num_cl);
<a name="l01023"></a>01023       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l01024"></a>01024       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l01025"></a>01025         {
<a name="l01026"></a>01026           <span class="keywordtype">int</span> ndeb,nfin,elem1,elem2,num_elem,ori;
<a name="l01027"></a>01027           <span class="keywordtype">int</span> face,fac1,fac2,signe;
<a name="l01028"></a>01028           <span class="keywordtype">double</span> flux;
<a name="l01029"></a>01029           <span class="comment">/* const Periodique&amp; la_cl_perio = ref_cast(Periodique,la_cl.valeur()); */</span>
<a name="l01030"></a>01030           ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l01031"></a>01031           nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l01032"></a>01032           <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l01033"></a>01033             {
<a name="l01034"></a>01034               elem1 = elem(face,0);
<a name="l01035"></a>01035               elem2 = elem(face,1);
<a name="l01036"></a>01036               ori = orientation(face);
<a name="l01037"></a>01037               <span class="keywordflow">if</span> ( (face == elem_faces(elem1,ori)) || (face == elem_faces(elem1,ori+dimension)) )
<a name="l01038"></a>01038                 {
<a name="l01039"></a>01039                   num_elem = elem2;
<a name="l01040"></a>01040                   signe = 1;
<a name="l01041"></a>01041                 }
<a name="l01042"></a>01042               <span class="keywordflow">else</span>
<a name="l01043"></a>01043                 {
<a name="l01044"></a>01044                   num_elem = elem1;
<a name="l01045"></a>01045                   signe = -1;
<a name="l01046"></a>01046                 }
<a name="l01047"></a>01047               fac1 = elem_faces(num_elem,ori);
<a name="l01048"></a>01048               fac2 = elem_faces(num_elem,ori+dimension);
<a name="l01049"></a>01049               flux=flux_evaluateur.flux_fa7_elem(inco,num_elem,fac1,fac2);
<a name="l01050"></a>01050               resu(face) += signe*flux;
<a name="l01051"></a>01051             }
<a name="l01052"></a>01052         }
<a name="l01053"></a>01053     }
<a name="l01054"></a>01054   <span class="keywordflow">return</span> resu;
<a name="l01055"></a>01055 }
<a name="l01056"></a>01056 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01057"></a><a class="code" href="classT__It__VDF__Face.html#a16ebbb068382dce1ad248e8e7daf8a12">01057</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classT__It__VDF__Face.html#a16ebbb068382dce1ad248e8e7daf8a12">T_It_VDF_Face&lt;_TYPE_&gt;::calculer</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01058"></a>01058 <span class="keyword"></span>{
<a name="l01059"></a>01059   resu=0;
<a name="l01060"></a>01060   <span class="keywordflow">return</span> <a class="code" href="Faces2_8cpp.html#a5763a31981073cc0c97bf903b1f120d9" title="Fonction hors classe.">ajouter</a>(inco,resu);
<a name="l01061"></a>01061 }
<a name="l01062"></a>01062 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01063"></a><a class="code" href="classT__It__VDF__Face.html#a572af03dc1904cf7d1d2b420de686e7d">01063</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a572af03dc1904cf7d1d2b420de686e7d">T_It_VDF_Face&lt;_TYPE_&gt;::completer_</a>()
<a name="l01064"></a>01064 {
<a name="l01065"></a>01065   nb_elem=la_zone-&gt;nb_elem_tot();
<a name="l01066"></a>01066   orientation.ref(la_zone-&gt;orientation());
<a name="l01067"></a>01067   Qdm.ref(la_zone-&gt;Qdm());
<a name="l01068"></a>01068   elem.ref(la_zone-&gt;face_voisins());
<a name="l01069"></a>01069   elem_faces.ref(la_zone-&gt;elem_faces());
<a name="l01070"></a>01070   type_arete_bord.ref(la_zcl-&gt;type_arete_bord());
<a name="l01071"></a>01071   type_arete_coin.ref(la_zcl-&gt;type_arete_coin());
<a name="l01072"></a>01072   premiere_arete_interne=la_zone-&gt;premiere_arete_interne();
<a name="l01073"></a>01073   derniere_arete_interne=premiere_arete_interne+la_zone-&gt;nb_aretes_internes();
<a name="l01074"></a>01074   premiere_arete_mixte=la_zone-&gt;premiere_arete_mixte();
<a name="l01075"></a>01075   derniere_arete_mixte=premiere_arete_mixte+la_zone-&gt;nb_aretes_mixtes();
<a name="l01076"></a>01076   premiere_arete_bord=la_zone-&gt;premiere_arete_bord();
<a name="l01077"></a>01077   derniere_arete_bord=premiere_arete_bord+la_zone-&gt;nb_aretes_bord();
<a name="l01078"></a>01078   premiere_arete_coin=la_zone-&gt;premiere_arete_coin();
<a name="l01079"></a>01079   derniere_arete_coin=premiere_arete_coin+la_zone-&gt;nb_aretes_coin();
<a name="l01080"></a>01080 }
<a name="l01081"></a>01081 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01082"></a><a class="code" href="classT__It__VDF__Face.html#a682a9660cfa690647532980dfca0bff0">01082</a> <span class="keywordtype">int</span> <a class="code" href="classT__It__VDF__Face.html#a682a9660cfa690647532980dfca0bff0">T_It_VDF_Face&lt;_TYPE_&gt;::impr</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l01083"></a>01083 <span class="keyword"></span>{
<a name="l01084"></a>01084   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; ma_zone=la_zone-&gt;zone();
<a name="l01085"></a>01085   <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; impr_mom=ma_zone.<a class="code" href="classZone.html#a1147c5a9ff1ba84a899979712734cb28">Moments_a_imprimer</a>();
<a name="l01086"></a>01086   <span class="keyword">const</span> <span class="keywordtype">int</span> impr_sum=(ma_zone.<a class="code" href="classZone.html#aa5780fa644b13f8172c4805336846dec">Bords_a_imprimer_sum</a>().<a class="code" href="classliste.html#a68a1377a9c67f05e76638da8d93e2d5a" title="Teste si la liste est vide.">est_vide</a>() ? 0:1);
<a name="l01087"></a>01087   <span class="keyword">const</span> <span class="keywordtype">int</span> impr_bord=(ma_zone.<a class="code" href="classZone.html#a2e4f80965f20d39334b470af7aec494a">Bords_a_imprimer</a>().<a class="code" href="classliste.html#a68a1377a9c67f05e76638da8d93e2d5a" title="Teste si la liste est vide.">est_vide</a>() ? 0:1);
<a name="l01088"></a>01088   <span class="keyword">const</span> <a class="code" href="classSchema__Temps__base.html" title="classe Schema_Temps_base">Schema_Temps_base</a>&amp; sch = la_zcl-&gt;equation().probleme().schema_temps();
<a name="l01089"></a>01089   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords=op_base-&gt;flux_bords();
<a name="l01090"></a>01090   <a class="code" href="classDoubleVect.html">DoubleVect</a> bilan(tab_flux_bords.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1));
<a name="l01091"></a>01091   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces = la_zone-&gt;nb_faces_tot();
<a name="l01092"></a>01092   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> xgr(nb_faces,dimension);
<a name="l01093"></a>01093   xgr=0.;
<a name="l01094"></a>01094   <span class="keywordflow">if</span> (impr_mom)
<a name="l01095"></a>01095     {
<a name="l01096"></a>01096       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xgrav = la_zone-&gt;xv();
<a name="l01097"></a>01097       <span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; c_grav=ma_zone.<a class="code" href="classZone.html#ab6b13609a679b31cc3a6931362490e2a">cg_moments</a>();
<a name="l01098"></a>01098       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=0; num_face &lt;nb_faces; num_face++)
<a name="l01099"></a>01099         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;dimension; i++)
<a name="l01100"></a>01100           xgr(num_face,i)=xgrav(num_face,i)-c_grav(i);
<a name="l01101"></a>01101     }
<a name="l01102"></a>01102   <span class="keywordtype">int</span> k,face;
<a name="l01103"></a>01103   <span class="keywordtype">int</span> nb_front_Cl=la_zone-&gt;nb_front_Cl();
<a name="l01104"></a>01104   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> flux_bords2( 5, nb_front_Cl , tab_flux_bords.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1)) ;
<a name="l01105"></a>01105   flux_bords2=0;
<a name="l01106"></a>01106   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l01107"></a>01107     {
<a name="l01108"></a>01108       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl-&gt;les_conditions_limites(num_cl);
<a name="l01109"></a>01109       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l01110"></a>01110       <span class="keywordtype">int</span> ndeb = frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l01111"></a>01111       <span class="keywordtype">int</span> nfin = ndeb + frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l01112"></a>01112       <span class="keywordtype">int</span> periodicite = (type_cl(la_cl)==<a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ab83c671c148d8664c5c87f343d2ab9fd" title="periodique">periodique</a>?1:0);
<a name="l01113"></a>01113       <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l01114"></a>01114         {
<a name="l01115"></a>01115           <span class="keywordflow">for</span>(k=0; k&lt;tab_flux_bords.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1); k++)
<a name="l01116"></a>01116             {
<a name="l01117"></a>01117               flux_bords2(0,num_cl,k)+=tab_flux_bords(face, k);
<a name="l01118"></a>01118               <span class="keywordflow">if</span>(periodicite)
<a name="l01119"></a>01119                 {
<a name="l01120"></a>01120                   <span class="keywordflow">if</span>( face &lt; (ndeb+frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>()/2) )
<a name="l01121"></a>01121                     flux_bords2(1,num_cl,k)+=tab_flux_bords(face, k);
<a name="l01122"></a>01122                   <span class="keywordflow">else</span>
<a name="l01123"></a>01123                     flux_bords2(2,num_cl,k)+=tab_flux_bords(face, k);
<a name="l01124"></a>01124                 }
<a name="l01125"></a>01125               <span class="keywordflow">if</span> (ma_zone.<a class="code" href="classZone.html#aa5780fa644b13f8172c4805336846dec">Bords_a_imprimer_sum</a>().<a class="code" href="classList__Nom.html#aafe66fe06c0dd82cb2641fcaf774db07">contient</a>(frontiere_dis.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>()))
<a name="l01126"></a>01126                 flux_bords2(3,num_cl,k)+=tab_flux_bords(face, k);
<a name="l01127"></a>01127             }  <span class="comment">/* fin for k */</span>
<a name="l01128"></a>01128           <span class="keywordflow">if</span> (impr_mom)
<a name="l01129"></a>01129             {
<a name="l01130"></a>01130               <span class="keywordflow">if</span> (dimension==2)
<a name="l01131"></a>01131                 {
<a name="l01132"></a>01132                   flux_bords2(4,num_cl,0)+=tab_flux_bords(face,1)*xgr(face,0)-tab_flux_bords(face,0)*xgr(face,1);
<a name="l01133"></a>01133                 }
<a name="l01134"></a>01134               <span class="keywordflow">else</span>
<a name="l01135"></a>01135                 {
<a name="l01136"></a>01136                   flux_bords2(4,num_cl,0)+=tab_flux_bords(face,2)*xgr(face,1)-tab_flux_bords(face,1)*xgr(face,2);
<a name="l01137"></a>01137                   flux_bords2(4,num_cl,1)+=tab_flux_bords(face,0)*xgr(face,2)-tab_flux_bords(face,2)*xgr(face,0);
<a name="l01138"></a>01138                   flux_bords2(4,num_cl,2)+=tab_flux_bords(face,1)*xgr(face,0)-tab_flux_bords(face,0)*xgr(face,1);
<a name="l01139"></a>01139                 }
<a name="l01140"></a>01140             }
<a name="l01141"></a>01141         } <span class="comment">/* fin for face */</span>
<a name="l01142"></a>01142     }
<a name="l01143"></a>01143   <a class="code" href="communications_8cpp.html#a5f15b8a5c15449d3277ff3cde06fa68a">mp_sum_for_each_item</a>(flux_bords2);
<a name="l01144"></a>01144   <span class="keywordflow">if</span> (je_suis_maitre())
<a name="l01145"></a>01145     {
<a name="l01146"></a>01146 <span class="comment">// SFichier Flux;</span>
<a name="l01147"></a>01147       <span class="keywordflow">if</span> (!Flux.is_open()) op_base-&gt;ouvrir_fichier(Flux,<span class="stringliteral">&quot;&quot;</span>,1);
<a name="l01148"></a>01148 <span class="comment">// SFichier Flux_moment;</span>
<a name="l01149"></a>01149       <span class="keywordflow">if</span> (!Flux_moment.is_open()) op_base-&gt;ouvrir_fichier(Flux_moment,<span class="stringliteral">&quot;moment&quot;</span>,impr_mom);
<a name="l01150"></a>01150 <span class="comment">// SFichier Flux_sum;</span>
<a name="l01151"></a>01151       <span class="keywordflow">if</span> (!Flux_sum.is_open()) op_base-&gt;ouvrir_fichier(Flux_sum,<span class="stringliteral">&quot;sum&quot;</span>,impr_sum);
<a name="l01152"></a>01152       Flux.add_col(sch.<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>());
<a name="l01153"></a>01153       <span class="keywordflow">if</span> (impr_mom) Flux_moment.add_col(sch.<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>());
<a name="l01154"></a>01154       <span class="keywordflow">if</span> (impr_sum) Flux_sum.add_col(sch.<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>());
<a name="l01155"></a>01155       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l01156"></a>01156         {
<a name="l01157"></a>01157           <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl-&gt;les_conditions_limites(num_cl);
<a name="l01158"></a>01158           <span class="keywordtype">int</span> periodicite = (type_cl(la_cl)==<a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ab83c671c148d8664c5c87f343d2ab9fd" title="periodique">periodique</a>?1:0);
<a name="l01159"></a>01159           <span class="keywordflow">for</span>(k=0; k&lt;tab_flux_bords.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1); k++)
<a name="l01160"></a>01160             {
<a name="l01161"></a>01161               <span class="keywordflow">if</span>(periodicite)
<a name="l01162"></a>01162                 {
<a name="l01163"></a>01163                   Flux.add_col(flux_bords2(1,num_cl,k));
<a name="l01164"></a>01164                   Flux.add_col(flux_bords2(2,num_cl,k));
<a name="l01165"></a>01165                 }
<a name="l01166"></a>01166               <span class="keywordflow">else</span>
<a name="l01167"></a>01167                 Flux.add_col(flux_bords2(0,num_cl,k));
<a name="l01168"></a>01168               <span class="keywordflow">if</span> (impr_sum) Flux_sum.add_col(flux_bords2(3,num_cl,k));
<a name="l01169"></a>01169               bilan(k)+=flux_bords2(0,num_cl,k);
<a name="l01170"></a>01170             }
<a name="l01171"></a>01171           <span class="keywordflow">if</span> (dimension==3)
<a name="l01172"></a>01172             {
<a name="l01173"></a>01173               <span class="keywordflow">for</span> (k=0; k&lt;tab_flux_bords.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1); k++)
<a name="l01174"></a>01174                 <span class="keywordflow">if</span> (impr_mom) Flux_moment.add_col(flux_bords2(4,num_cl,k));
<a name="l01175"></a>01175             }
<a name="l01176"></a>01176           <span class="keywordflow">else</span>
<a name="l01177"></a>01177             {
<a name="l01178"></a>01178               <span class="keywordflow">if</span> (impr_mom) Flux_moment.add_col(flux_bords2(4,num_cl,0));
<a name="l01179"></a>01179             }
<a name="l01180"></a>01180         } <span class="comment">/* fin for num_cl */</span>
<a name="l01181"></a>01181       <span class="keywordflow">for</span>(k=0; k&lt;tab_flux_bords.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1); k++)
<a name="l01182"></a>01182         Flux.add_col(bilan(k));
<a name="l01183"></a>01183       Flux &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01184"></a>01184       <span class="keywordflow">if</span> (impr_sum) Flux_sum &lt;&lt; finl;
<a name="l01185"></a>01185       <span class="keywordflow">if</span> (impr_mom) Flux_moment &lt;&lt; finl;
<a name="l01186"></a>01186     }
<a name="l01187"></a>01187   <span class="keyword">const</span> <a class="code" href="List_8h.html#a3149526fb499ddb08728c87daa32c5ad">LIST</a>(<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>)&amp; Liste_Bords_a_imprimer = la_zone-&gt;zone().Bords_a_imprimer();
<a name="l01188"></a>01188   <span class="keywordflow">if</span> (!Liste_Bords_a_imprimer.est_vide())
<a name="l01189"></a>01189     {
<a name="l01190"></a>01190       <a class="code" href="classEcrFicPartage.html">EcrFicPartage</a> Flux_face;
<a name="l01191"></a>01191       op_base-&gt;ouvrir_fichier_partage(Flux_face,<span class="stringliteral">&quot;&quot;</span>,impr_bord);
<a name="l01192"></a>01192       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l01193"></a>01193         {
<a name="l01194"></a>01194           <span class="keyword">const</span> <a class="code" href="classFrontiere__dis__base.html" title="classe Frontiere_dis_base Classe representant une frontiere discretisee. Les objets Frontiere_dis_bas...">Frontiere_dis_base</a>&amp; la_fr = la_zcl-&gt;les_conditions_limites(num_cl).frontiere_dis();
<a name="l01195"></a>01195           <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl-&gt;les_conditions_limites(num_cl);
<a name="l01196"></a>01196           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l01197"></a>01197           <span class="keywordtype">int</span> ndeb = frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l01198"></a>01198           <span class="keywordtype">int</span> nfin = ndeb + frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l01199"></a>01199           <span class="keywordflow">if</span> (ma_zone.<a class="code" href="classZone.html#a2e4f80965f20d39334b470af7aec494a">Bords_a_imprimer</a>().<a class="code" href="classList__Nom.html#aafe66fe06c0dd82cb2641fcaf774db07">contient</a>(la_fr.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>()))
<a name="l01200"></a>01200             {
<a name="l01201"></a>01201               <span class="keywordflow">if</span>(je_suis_maitre())
<a name="l01202"></a>01202                 {
<a name="l01203"></a>01203                   Flux_face &lt;&lt; <span class="stringliteral">&quot;# Flux par face sur &quot;</span> &lt;&lt; la_fr.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; au temps &quot;</span>;
<a name="l01204"></a>01204                   sch.<a class="code" href="classSchema__Temps__base.html#afb4a13da2e8149defb5339ef005ef231">imprimer_temps_courant</a>(Flux_face);
<a name="l01205"></a>01205                   Flux_face &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01206"></a>01206                 }
<a name="l01207"></a>01207               <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l01208"></a>01208                 {
<a name="l01209"></a>01209                   <span class="keywordflow">if</span> (dimension == 2)
<a name="l01210"></a>01210                     Flux_face &lt;&lt; <span class="stringliteral">&quot;# Face a x= &quot;</span> &lt;&lt; la_zone-&gt;xv(face,0) &lt;&lt; <span class="stringliteral">&quot; y= &quot;</span> &lt;&lt; la_zone-&gt;xv(face,1) &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;
<a name="l01211"></a>01211                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dimension == 3)
<a name="l01212"></a>01212                     Flux_face &lt;&lt; <span class="stringliteral">&quot;# Face a x= &quot;</span> &lt;&lt; la_zone-&gt;xv(face,0) &lt;&lt; <span class="stringliteral">&quot; y= &quot;</span> &lt;&lt; la_zone-&gt;xv(face,1) &lt;&lt; <span class="stringliteral">&quot; z= &quot;</span> &lt;&lt; la_zone-&gt;xv(face,2) &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;
<a name="l01213"></a>01213                   <span class="keywordflow">for</span>(k=0; k&lt;tab_flux_bords.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1); k++)
<a name="l01214"></a>01214                     Flux_face &lt;&lt; tab_flux_bords(face, k) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l01215"></a>01215                   Flux_face &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01216"></a>01216                 }
<a name="l01217"></a>01217               Flux_face.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l01218"></a>01218             }
<a name="l01219"></a>01219         }
<a name="l01220"></a>01220     }
<a name="l01221"></a>01221   <span class="keywordflow">return</span> 1;
<a name="l01222"></a>01222 }
<a name="l01223"></a>01223 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01224"></a><a class="code" href="classT__It__VDF__Face.html#a27c51a9b862181105613928e02dd66e0">01224</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a27c51a9b862181105613928e02dd66e0">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01225"></a>01225 <span class="keyword"></span>{
<a name="l01226"></a>01226   ((_TYPE_&amp;) flux_evaluateur).mettre_a_jour();
<a name="l01227"></a>01227   assert(resu.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() &lt; 3);
<a name="l01228"></a>01228   <span class="keywordtype">int</span> ncomp=1;
<a name="l01229"></a>01229   <span class="keywordflow">if</span> (resu.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 2)
<a name="l01230"></a>01230     ncomp=resu.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l01231"></a>01231   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords=op_base-&gt;flux_bords();
<a name="l01232"></a>01232   <span class="keywordflow">if</span> (la_zone-&gt;nb_faces_bord() &gt;0)
<a name="l01233"></a>01233     {
<a name="l01234"></a>01234       tab_flux_bords.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(la_zone-&gt;nb_faces_bord(),ncomp);
<a name="l01235"></a>01235       tab_flux_bords=0;
<a name="l01236"></a>01236     }
<a name="l01237"></a>01237   <span class="keywordflow">if</span>( ncomp == 1)
<a name="l01238"></a>01238     {
<a name="l01239"></a>01239       contribuer_au_second_membre_aretes_bords(resu) ;
<a name="l01240"></a>01240       contribuer_au_second_membre_aretes_coins(resu) ;
<a name="l01241"></a>01241       contribuer_au_second_membre_aretes_internes(resu);
<a name="l01242"></a>01242       contribuer_au_second_membre_aretes_mixtes(resu);
<a name="l01243"></a>01243       contribuer_au_second_membre_fa7_sortie_libre(resu);
<a name="l01244"></a>01244       contribuer_au_second_membre_fa7_elem(resu);
<a name="l01245"></a>01245     }
<a name="l01246"></a>01246   <span class="keywordflow">else</span>
<a name="l01247"></a>01247     {
<a name="l01248"></a>01248       contribuer_au_second_membre_aretes_bords(resu, ncomp) ;
<a name="l01249"></a>01249       contribuer_au_second_membre_aretes_coins(resu,ncomp) ;
<a name="l01250"></a>01250       contribuer_au_second_membre_aretes_internes(resu, ncomp) ;
<a name="l01251"></a>01251       contribuer_au_second_membre_aretes_mixtes(resu, ncomp);
<a name="l01252"></a>01252       contribuer_au_second_membre_fa7_sortie_libre(resu, ncomp);
<a name="l01253"></a>01253       contribuer_au_second_membre_fa7_elem(resu, ncomp);
<a name="l01254"></a>01254     }
<a name="l01255"></a>01255 }
<a name="l01256"></a>01256 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01257"></a><a class="code" href="classT__It__VDF__Face.html#afd6bdbda1ce73524f5e14f51fc141895">01257</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#afd6bdbda1ce73524f5e14f51fc141895">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre_aretes_bords</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01258"></a>01258 <span class="keyword"></span>{
<a name="l01259"></a>01259   <span class="keywordtype">int</span> n_arete;
<a name="l01260"></a>01260   <span class="keywordtype">int</span> signe;
<a name="l01261"></a>01261   <span class="keywordtype">int</span> n_type;
<a name="l01262"></a>01262   <span class="keywordtype">double</span> flux,flux3=0,flux3_4=0,flux1_2=0;
<a name="l01263"></a>01263   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l01264"></a>01264   <span class="keywordflow">for</span> (n_arete=premiere_arete_bord; n_arete&lt;derniere_arete_bord; n_arete++)
<a name="l01265"></a>01265     {
<a name="l01266"></a>01266       n_type=type_arete_bord(n_arete-premiere_arete_bord);
<a name="l01267"></a>01267       <span class="keywordflow">switch</span>(n_type)
<a name="l01268"></a>01268         {
<a name="l01269"></a>01269         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>:
<a name="l01270"></a>01270           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l01271"></a>01271             {
<a name="l01272"></a>01272               fac1 = Qdm(n_arete,0);
<a name="l01273"></a>01273               fac2 = Qdm(n_arete,1);
<a name="l01274"></a>01274               fac3 = Qdm(n_arete,2);
<a name="l01275"></a>01275               signe = Qdm(n_arete,3);
<a name="l01276"></a>01276               flux=flux_evaluateur.secmem_arete_paroi(fac1, fac2, fac3, signe);
<a name="l01277"></a>01277               resu[fac3]+=signe*flux;
<a name="l01278"></a>01278             }
<a name="l01279"></a>01279           <span class="keywordflow">break</span>;
<a name="l01280"></a>01280         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a>:
<a name="l01281"></a>01281           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_fluide())
<a name="l01282"></a>01282             {
<a name="l01283"></a>01283               fac1 = Qdm(n_arete,0);
<a name="l01284"></a>01284               fac2 = Qdm(n_arete,1);
<a name="l01285"></a>01285               fac3 = Qdm(n_arete,2);
<a name="l01286"></a>01286               signe = Qdm(n_arete,3);
<a name="l01287"></a>01287               flux_evaluateur.secmem_arete_fluide(fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l01288"></a>01288               resu[fac3]+=signe*flux3;
<a name="l01289"></a>01289               resu[fac1]+=flux1_2;
<a name="l01290"></a>01290               resu[fac2]-=flux1_2;
<a name="l01291"></a>01291             }
<a name="l01292"></a>01292           <span class="keywordflow">break</span>;
<a name="l01293"></a>01293         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>:
<a name="l01294"></a>01294           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi_fluide())
<a name="l01295"></a>01295             {
<a name="l01296"></a>01296               fac1 = Qdm(n_arete,0);
<a name="l01297"></a>01297               fac2 = Qdm(n_arete,1);
<a name="l01298"></a>01298               fac3 = Qdm(n_arete,2);
<a name="l01299"></a>01299               signe = Qdm(n_arete,3);
<a name="l01300"></a>01300               flux_evaluateur.secmem_arete_paroi_fluide(fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l01301"></a>01301               resu[fac3]+=signe*flux3;
<a name="l01302"></a>01302               resu[fac1]+=flux1_2;
<a name="l01303"></a>01303               resu[fac2]-=flux1_2;
<a name="l01304"></a>01304             }
<a name="l01305"></a>01305           <span class="keywordflow">break</span>;
<a name="l01306"></a>01306         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a8ffe822aae0518f507be135120ec23b8">TypeAreteBordVDF::SYM_SYM</a>:
<a name="l01307"></a>01307           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie())
<a name="l01308"></a>01308             {
<a name="l01309"></a>01309               fac1 = Qdm(n_arete,0);
<a name="l01310"></a>01310               fac2 = Qdm(n_arete,1);
<a name="l01311"></a>01311               fac3 = Qdm(n_arete,2);
<a name="l01312"></a>01312               signe = Qdm(n_arete,3);
<a name="l01313"></a>01313               flux=flux_evaluateur.secmem_arete_symetrie(fac1, fac2, fac3, signe);
<a name="l01314"></a>01314               resu[fac3]+=signe*flux;
<a name="l01315"></a>01315             }
<a name="l01316"></a>01316           <span class="keywordflow">break</span>;
<a name="l01317"></a>01317         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a37713c7b918ab812a24573ce30b2a322">TypeAreteBordVDF::PERIO_PERIO</a>:
<a name="l01318"></a>01318           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_periodicite())
<a name="l01319"></a>01319             {
<a name="l01320"></a>01320               fac1 = Qdm(n_arete,0);
<a name="l01321"></a>01321               fac2 = Qdm(n_arete,1);
<a name="l01322"></a>01322               fac3 = Qdm(n_arete,2);
<a name="l01323"></a>01323               fac4 = Qdm(n_arete,3);
<a name="l01324"></a>01324               flux_evaluateur.secmem_arete_periodicite(fac1, fac2, fac3, fac4, flux3_4, flux1_2);
<a name="l01325"></a>01325               resu[fac3]+=0.5*flux3_4;
<a name="l01326"></a>01326               resu[fac4]-=0.5*flux3_4;
<a name="l01327"></a>01327               resu[fac1]+=flux1_2;
<a name="l01328"></a>01328               resu[fac2]-=flux1_2;
<a name="l01329"></a>01329             }
<a name="l01330"></a>01330           <span class="keywordflow">break</span>;
<a name="l01331"></a>01331         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac0b72d665d0d8eb58248f5c6c65f410c">TypeAreteBordVDF::PAROI_SYM</a>:
<a name="l01332"></a>01332           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie_paroi())
<a name="l01333"></a>01333             {
<a name="l01334"></a>01334               fac1 = Qdm(n_arete,0);
<a name="l01335"></a>01335               fac2 = Qdm(n_arete,1);
<a name="l01336"></a>01336               fac3 = Qdm(n_arete,2);
<a name="l01337"></a>01337               signe = Qdm(n_arete,3);
<a name="l01338"></a>01338               flux=flux_evaluateur.secmem_arete_symetrie_paroi(fac1, fac2, fac3, signe);
<a name="l01339"></a>01339               resu[fac3]+=signe*flux;
<a name="l01340"></a>01340             }
<a name="l01341"></a>01341           <span class="keywordflow">break</span>;
<a name="l01342"></a>01342         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a460c2f242b0d8c910f37c8940e504707">TypeAreteBordVDF::FLUIDE_SYM</a>:
<a name="l01343"></a>01343           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie_fluide())
<a name="l01344"></a>01344             {
<a name="l01345"></a>01345               fac1 = Qdm(n_arete,0);
<a name="l01346"></a>01346               fac2 = Qdm(n_arete,1);
<a name="l01347"></a>01347               fac3 = Qdm(n_arete,2);
<a name="l01348"></a>01348               signe = Qdm(n_arete,3);
<a name="l01349"></a>01349               flux_evaluateur.secmem_arete_symetrie_fluide(fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l01350"></a>01350               resu[fac3]+=signe*flux3;
<a name="l01351"></a>01351               resu[fac1]+=flux1_2;
<a name="l01352"></a>01352               resu[fac2]-=flux1_2;
<a name="l01353"></a>01353             }
<a name="l01354"></a>01354           <span class="keywordflow">break</span>;
<a name="l01355"></a>01355         <span class="keywordflow">default</span> :
<a name="l01356"></a>01356           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l01357"></a>01357           \
<a name="l01358"></a>01358           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l01359"></a>01359           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l01360"></a>01360           exit();
<a name="l01361"></a>01361           <span class="keywordflow">break</span>;
<a name="l01362"></a>01362         }
<a name="l01363"></a>01363     }
<a name="l01364"></a>01364 }
<a name="l01365"></a>01365 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01366"></a><a class="code" href="classT__It__VDF__Face.html#a907a3d9deab7b3f104ee9298d43b7ec1">01366</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#afd6bdbda1ce73524f5e14f51fc141895">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre_aretes_bords</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l01367"></a>01367 <span class="keyword"></span>{
<a name="l01368"></a>01368   <span class="keywordtype">int</span> n_arete;
<a name="l01369"></a>01369   <span class="keywordtype">int</span> signe;
<a name="l01370"></a>01370   <span class="keywordtype">int</span> n_type;
<a name="l01371"></a>01371   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp), flux3(ncomp), flux3_4(ncomp), flux1_2(ncomp);
<a name="l01372"></a>01372   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l01373"></a>01373   <span class="keywordtype">int</span> k;
<a name="l01374"></a>01374   <span class="keywordflow">for</span> (n_arete=premiere_arete_bord; n_arete&lt;derniere_arete_bord; n_arete++)
<a name="l01375"></a>01375     {
<a name="l01376"></a>01376       n_type=type_arete_bord(n_arete-premiere_arete_bord);
<a name="l01377"></a>01377       <span class="keywordflow">switch</span>(n_type)
<a name="l01378"></a>01378         {
<a name="l01379"></a>01379         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>:
<a name="l01380"></a>01380           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l01381"></a>01381             {
<a name="l01382"></a>01382               fac1 = Qdm(n_arete,0);
<a name="l01383"></a>01383               fac2 = Qdm(n_arete,1);
<a name="l01384"></a>01384               fac3 = Qdm(n_arete,2);
<a name="l01385"></a>01385               signe = Qdm(n_arete,3);
<a name="l01386"></a>01386               flux_evaluateur.secmem_arete_paroi(fac1, fac2, fac3, signe, flux);
<a name="l01387"></a>01387               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01388"></a>01388                 resu(fac3,k)+=signe*flux(k);
<a name="l01389"></a>01389             }
<a name="l01390"></a>01390           <span class="keywordflow">break</span>;
<a name="l01391"></a>01391         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a>:
<a name="l01392"></a>01392           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_fluide())
<a name="l01393"></a>01393             {
<a name="l01394"></a>01394               fac1 = Qdm(n_arete,0);
<a name="l01395"></a>01395               fac2 = Qdm(n_arete,1);
<a name="l01396"></a>01396               fac3 = Qdm(n_arete,2);
<a name="l01397"></a>01397               signe = Qdm(n_arete,3);
<a name="l01398"></a>01398               flux_evaluateur.secmem_arete_fluide(fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l01399"></a>01399               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01400"></a>01400                 {
<a name="l01401"></a>01401                   resu(fac3,k)+=signe*flux3(k);
<a name="l01402"></a>01402                   resu(fac1,k)+=flux1_2(k);
<a name="l01403"></a>01403                   resu(fac2,k)-=flux1_2(k);
<a name="l01404"></a>01404                 }
<a name="l01405"></a>01405             }
<a name="l01406"></a>01406           <span class="keywordflow">break</span>;
<a name="l01407"></a>01407         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>:
<a name="l01408"></a>01408           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi_fluide())
<a name="l01409"></a>01409             {
<a name="l01410"></a>01410               fac1 = Qdm(n_arete,0);
<a name="l01411"></a>01411               fac2 = Qdm(n_arete,1);
<a name="l01412"></a>01412               fac3 = Qdm(n_arete,2);
<a name="l01413"></a>01413               signe = Qdm(n_arete,3);
<a name="l01414"></a>01414               flux_evaluateur.secmem_arete_paroi_fluide(fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l01415"></a>01415               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01416"></a>01416                 {
<a name="l01417"></a>01417                   resu(fac3,k)+=signe*flux3(k);
<a name="l01418"></a>01418                   resu(fac1,k)+=flux1_2(k);
<a name="l01419"></a>01419                   resu(fac2,k)-=flux1_2(k);
<a name="l01420"></a>01420                 }
<a name="l01421"></a>01421             }
<a name="l01422"></a>01422           <span class="keywordflow">break</span>;
<a name="l01423"></a>01423         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a8ffe822aae0518f507be135120ec23b8">TypeAreteBordVDF::SYM_SYM</a>:
<a name="l01424"></a>01424           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie())
<a name="l01425"></a>01425             {
<a name="l01426"></a>01426               fac1 = Qdm(n_arete,0);
<a name="l01427"></a>01427               fac2 = Qdm(n_arete,1);
<a name="l01428"></a>01428               fac3 = Qdm(n_arete,2);
<a name="l01429"></a>01429               signe = Qdm(n_arete,3);
<a name="l01430"></a>01430               flux_evaluateur.secmem_arete_symetrie(fac1, fac2, fac3, signe, flux);
<a name="l01431"></a>01431               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01432"></a>01432                 resu(fac3,k)+=signe*flux(k);
<a name="l01433"></a>01433             }
<a name="l01434"></a>01434           <span class="keywordflow">break</span>;
<a name="l01435"></a>01435         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a37713c7b918ab812a24573ce30b2a322">TypeAreteBordVDF::PERIO_PERIO</a>:
<a name="l01436"></a>01436           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_periodicite())
<a name="l01437"></a>01437             {
<a name="l01438"></a>01438               fac1 = Qdm(n_arete,0);
<a name="l01439"></a>01439               fac2 = Qdm(n_arete,1);
<a name="l01440"></a>01440               fac3 = Qdm(n_arete,2);
<a name="l01441"></a>01441               fac4 = Qdm(n_arete,3);
<a name="l01442"></a>01442               flux_evaluateur.secmem_arete_periodicite(fac1, fac2, fac3, fac4, flux3_4, flux1_2);
<a name="l01443"></a>01443               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01444"></a>01444                 {
<a name="l01445"></a>01445                   resu(fac3,k)+=0.5*flux3_4(k);
<a name="l01446"></a>01446                   resu(fac4,k)-=0.5*flux3_4(k);
<a name="l01447"></a>01447                   resu(fac1,k)+=flux1_2(k);
<a name="l01448"></a>01448                   resu(fac2,k)-=flux1_2(k);
<a name="l01449"></a>01449                 }
<a name="l01450"></a>01450             }
<a name="l01451"></a>01451           <span class="keywordflow">break</span>;
<a name="l01452"></a>01452         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac0b72d665d0d8eb58248f5c6c65f410c">TypeAreteBordVDF::PAROI_SYM</a>:
<a name="l01453"></a>01453           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie_paroi())
<a name="l01454"></a>01454             {
<a name="l01455"></a>01455               fac1 = Qdm(n_arete,0);
<a name="l01456"></a>01456               fac2 = Qdm(n_arete,1);
<a name="l01457"></a>01457               fac3 = Qdm(n_arete,2);
<a name="l01458"></a>01458               signe = Qdm(n_arete,3);
<a name="l01459"></a>01459               flux_evaluateur.secmem_arete_symetrie_paroi(fac1, fac2, fac3, signe, flux);
<a name="l01460"></a>01460               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01461"></a>01461                 resu(fac3,k)+=signe*flux(k);
<a name="l01462"></a>01462             }
<a name="l01463"></a>01463           <span class="keywordflow">break</span>;
<a name="l01464"></a>01464         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a460c2f242b0d8c910f37c8940e504707">TypeAreteBordVDF::FLUIDE_SYM</a>:
<a name="l01465"></a>01465           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie_fluide())
<a name="l01466"></a>01466             {
<a name="l01467"></a>01467               fac1 = Qdm(n_arete,0);
<a name="l01468"></a>01468               fac2 = Qdm(n_arete,1);
<a name="l01469"></a>01469               fac3 = Qdm(n_arete,2);
<a name="l01470"></a>01470               signe = Qdm(n_arete,3);
<a name="l01471"></a>01471               flux_evaluateur.secmem_arete_symetrie_fluide(fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l01472"></a>01472               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01473"></a>01473                 {
<a name="l01474"></a>01474                   resu(fac3,k)+=signe*flux3(k);
<a name="l01475"></a>01475                   resu(fac1,k)+=flux1_2(k);
<a name="l01476"></a>01476                   resu(fac2,k)-=flux1_2(k);
<a name="l01477"></a>01477                 }
<a name="l01478"></a>01478             }
<a name="l01479"></a>01479           <span class="keywordflow">break</span>;
<a name="l01480"></a>01480         <span class="keywordflow">default</span> :
<a name="l01481"></a>01481           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l01482"></a>01482           \
<a name="l01483"></a>01483           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l01484"></a>01484           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l01485"></a>01485           exit();
<a name="l01486"></a>01486           <span class="keywordflow">break</span>;
<a name="l01487"></a>01487         }
<a name="l01488"></a>01488     }
<a name="l01489"></a>01489 }
<a name="l01490"></a>01490 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01491"></a><a class="code" href="classT__It__VDF__Face.html#a498be5af06fe656b739bf6d5f09d5853">01491</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a498be5af06fe656b739bf6d5f09d5853">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre_aretes_coins</a>( <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01492"></a>01492 <span class="keyword"></span>{
<a name="l01493"></a>01493   <span class="keywordtype">int</span> n_arete;
<a name="l01494"></a>01494   <span class="keywordtype">int</span> signe;
<a name="l01495"></a>01495   <span class="keywordtype">int</span> n_type;
<a name="l01496"></a>01496   <span class="keywordtype">double</span> flux,flux3_4=0,flux1_2=0;
<a name="l01497"></a>01497   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l01498"></a>01498   <span class="keywordflow">for</span> (n_arete=premiere_arete_coin; n_arete&lt;derniere_arete_coin; n_arete++)
<a name="l01499"></a>01499     {
<a name="l01500"></a>01500       n_type=type_arete_coin(n_arete-premiere_arete_coin);
<a name="l01501"></a>01501       <span class="keywordflow">switch</span>(n_type)
<a name="l01502"></a>01502         {
<a name="l01503"></a>01503         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aad369ed721afc9b287b160c7a91a284a4">TypeAreteCoinVDF::PERIO_PERIO</a>:
<a name="l01504"></a>01504           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_periodicite())
<a name="l01505"></a>01505             {
<a name="l01506"></a>01506               fac1 = Qdm(n_arete,0);
<a name="l01507"></a>01507               fac2 = Qdm(n_arete,1);
<a name="l01508"></a>01508               fac3 = Qdm(n_arete,2);
<a name="l01509"></a>01509               fac4 = Qdm(n_arete,3);
<a name="l01510"></a>01510               flux_evaluateur.secmem_arete_periodicite(fac1, fac2, fac3, fac4, flux3_4, flux1_2);
<a name="l01511"></a>01511               resu[fac3]+=0.5*flux3_4;
<a name="l01512"></a>01512               resu[fac4]-=0.5*flux3_4;
<a name="l01513"></a>01513               resu[fac1]+=0.5*flux1_2;
<a name="l01514"></a>01514               resu[fac2]-=0.5*flux1_2;
<a name="l01515"></a>01515             }
<a name="l01516"></a>01516           <span class="keywordflow">break</span>;
<a name="l01517"></a>01517         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa5203ea39fbbb2afbe1cac55f4919f144">TypeAreteCoinVDF::PERIO_PAROI</a>:
<a name="l01518"></a>01518           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l01519"></a>01519             {
<a name="l01520"></a>01520               fac1 = Qdm(n_arete,0);
<a name="l01521"></a>01521               fac2 = Qdm(n_arete,1);
<a name="l01522"></a>01522               fac3 = Qdm(n_arete,2);
<a name="l01523"></a>01523               signe = Qdm(n_arete,3);
<a name="l01524"></a>01524               flux=flux_evaluateur.secmem_arete_paroi( fac1, fac2, fac3, signe);
<a name="l01525"></a>01525               resu[fac3]+=signe*flux;
<a name="l01526"></a>01526             }
<a name="l01527"></a>01527           <span class="keywordflow">break</span>;
<a name="l01528"></a>01528         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa8d6cb48990b19d4ad52f6414b83d72d9">TypeAreteCoinVDF::PAROI_FLUIDE</a>:
<a name="l01529"></a>01529           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l01530"></a>01530             {
<a name="l01531"></a>01531               <span class="comment">/*               int i=0;  while ( Qdm(n_arete,i)==-1) i++;</span>
<a name="l01532"></a>01532 <span class="comment">                               fac1=Qdm(n_arete,i);i++;</span>
<a name="l01533"></a>01533 <span class="comment">                               while ( Qdm(n_arete,i)==-1) i++;</span>
<a name="l01534"></a>01534 <span class="comment">                               fac3 = Qdm(n_arete,i);</span>
<a name="l01535"></a>01535 <span class="comment">                               signe = 1;</span>
<a name="l01536"></a>01536 <span class="comment">                               flux=flux_evaluateur.flux_arete_paroi(inco, fac1, fac1,fac3, signe);*/</span> \
<a name="l01537"></a>01537               <span class="comment">/*Cerr&lt;&lt;&quot;coin &quot;&lt;&lt;fac1&lt;&lt;&quot; &quot;&lt;&lt;fac3&lt;&lt;&quot; &quot;&lt;&lt;signe&lt;&lt;finl;*/</span>
<a name="l01538"></a>01538               fac1 = Qdm(n_arete,0);
<a name="l01539"></a>01539               fac2 = Qdm(n_arete,1);
<a name="l01540"></a>01540               fac3 = Qdm(n_arete,2);
<a name="l01541"></a>01541               signe = Qdm(n_arete,3);
<a name="l01542"></a>01542               flux=flux_evaluateur.secmem_arete_paroi( fac1, fac2, fac3, signe);
<a name="l01543"></a>01543               resu[fac3]+=signe*flux;
<a name="l01544"></a>01544               <span class="comment">/*Cerr&lt;&lt;&quot;coin &quot;&lt;&lt;fac1&lt;&lt;&quot; &quot;&lt;&lt;fac2&lt;&lt;&quot; &quot;&lt;&lt;fac3&lt;&lt;&quot; &quot;&lt;&lt;signe &lt;&lt; &quot; &quot; &lt;&lt; flux&lt;&lt;finl;*/</span>
<a name="l01545"></a>01545             }
<a name="l01546"></a>01546           <span class="keywordflow">break</span>;
<a name="l01547"></a>01547         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa0f79a01fe58c2a6a8ffde290a2ebc660">TypeAreteCoinVDF::FLUIDE_PAROI</a>:
<a name="l01548"></a>01548           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l01549"></a>01549             {
<a name="l01550"></a>01550               <span class="comment">/*int i=0;  while ( Qdm(n_arete,i)==-1) i++;</span>
<a name="l01551"></a>01551 <span class="comment">                fac3=Qdm(n_arete,i);i++;</span>
<a name="l01552"></a>01552 <span class="comment">                while ( Qdm(n_arete,i)==-1) i++;</span>
<a name="l01553"></a>01553 <span class="comment">                fac1 = Qdm(n_arete,i);</span>
<a name="l01554"></a>01554 <span class="comment">                signe = 1;</span>
<a name="l01555"></a>01555 <span class="comment">                flux=flux_evaluateur.flux_arete_paroi( fac1, fac1,fac3, signe);*/</span>
<a name="l01556"></a>01556               <span class="comment">/*Cerr&lt;&lt;&quot;coin2 &quot;&lt;&lt;fac1&lt;&lt;&quot; &quot;&lt;&lt;fac3&lt;&lt;&quot; &quot;&lt;&lt;signe&lt;&lt;finl;*/</span>
<a name="l01557"></a>01557               fac1 = Qdm(n_arete,0);
<a name="l01558"></a>01558               fac2 = Qdm(n_arete,1);
<a name="l01559"></a>01559               fac3 = Qdm(n_arete,2);
<a name="l01560"></a>01560               signe = Qdm(n_arete,3);
<a name="l01561"></a>01561               flux=flux_evaluateur.secmem_arete_paroi( fac1, fac2, fac3, signe);
<a name="l01562"></a>01562               resu[fac3]+=signe*flux;
<a name="l01563"></a>01563             }
<a name="l01564"></a>01564           <span class="keywordflow">break</span>;
<a name="l01565"></a>01565         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa42458df5735cf406f85838495b654982">TypeAreteCoinVDF::FLUIDE_FLUIDE</a>:
<a name="l01566"></a>01566           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_coin_fluide())
<a name="l01567"></a>01567             {
<a name="l01568"></a>01568               <span class="keywordtype">double</span> flux3=0;
<a name="l01569"></a>01569               fac1 = Qdm(n_arete,0);
<a name="l01570"></a>01570               fac2 = Qdm(n_arete,1);
<a name="l01571"></a>01571               fac3 = Qdm(n_arete,2);
<a name="l01572"></a>01572               signe = Qdm(n_arete,3);
<a name="l01573"></a>01573               flux_evaluateur.secmem_arete_coin_fluide(fac1, fac2, fac3, signe, flux3, flux1_2);
<a name="l01574"></a>01574               resu[fac3]+=signe*flux3;
<a name="l01575"></a>01575               resu[fac1]+=flux1_2;
<a name="l01576"></a>01576 <span class="comment">// resu[fac2]-=flux1_2;</span>
<a name="l01577"></a>01577             }
<a name="l01578"></a>01578           <span class="keywordflow">break</span>;
<a name="l01579"></a>01579         <span class="keywordflow">default</span> :
<a name="l01580"></a>01580           <span class="keywordflow">break</span>;
<a name="l01581"></a>01581         }
<a name="l01582"></a>01582     }
<a name="l01583"></a>01583 }
<a name="l01584"></a>01584 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01585"></a><a class="code" href="classT__It__VDF__Face.html#adb9b53e6f57feb89253b3f1b6f7452d4">01585</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a498be5af06fe656b739bf6d5f09d5853">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre_aretes_coins</a>(
<a name="l01586"></a>01586   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l01587"></a>01587 <span class="keyword"></span>{
<a name="l01588"></a>01588   <span class="keywordtype">int</span> n_arete;
<a name="l01589"></a>01589   <span class="keywordtype">int</span> signe;
<a name="l01590"></a>01590   <span class="keywordtype">int</span> n_type;
<a name="l01591"></a>01591   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp), flux3(ncomp), flux3_4(ncomp), flux1_2(ncomp);
<a name="l01592"></a>01592   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l01593"></a>01593   <span class="keywordtype">int</span> k;
<a name="l01594"></a>01594   <span class="keywordflow">for</span> (n_arete=premiere_arete_coin; n_arete&lt;derniere_arete_coin; n_arete++)
<a name="l01595"></a>01595     {
<a name="l01596"></a>01596       <span class="comment">/* OC 01/2005 : bug dans la ligne suivante ? type_arete_bord-&gt;type_arete_coin*/</span>
<a name="l01597"></a>01597       <span class="comment">/* n_type=type_arete_bord(n_arete-premiere_arete_coin);*/</span>
<a name="l01598"></a>01598       n_type=type_arete_coin(n_arete-premiere_arete_coin);
<a name="l01599"></a>01599       <span class="keywordflow">switch</span>(n_type)
<a name="l01600"></a>01600         {
<a name="l01601"></a>01601         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aad369ed721afc9b287b160c7a91a284a4">TypeAreteCoinVDF::PERIO_PERIO</a>:
<a name="l01602"></a>01602           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_periodicite())
<a name="l01603"></a>01603             {
<a name="l01604"></a>01604               fac1 = Qdm(n_arete,0);
<a name="l01605"></a>01605               fac2 = Qdm(n_arete,1);
<a name="l01606"></a>01606               fac3 = Qdm(n_arete,2);
<a name="l01607"></a>01607               fac4 = Qdm(n_arete,3);
<a name="l01608"></a>01608               flux_evaluateur.secmem_arete_periodicite( fac1, fac2, fac3, fac4, flux3_4, flux1_2);
<a name="l01609"></a>01609               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01610"></a>01610                 {
<a name="l01611"></a>01611                   resu(fac3,k)+=0.5*flux3_4(k);
<a name="l01612"></a>01612                   resu(fac4,k)-=0.5*flux3_4(k);
<a name="l01613"></a>01613                   resu(fac1,k)+=flux1_2(k);
<a name="l01614"></a>01614                   resu(fac2,k)-=flux1_2(k);
<a name="l01615"></a>01615                 }
<a name="l01616"></a>01616             }
<a name="l01617"></a>01617           <span class="keywordflow">break</span>;
<a name="l01618"></a>01618         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa5203ea39fbbb2afbe1cac55f4919f144">TypeAreteCoinVDF::PERIO_PAROI</a>:
<a name="l01619"></a>01619           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l01620"></a>01620             {
<a name="l01621"></a>01621               fac1 = Qdm(n_arete,0);
<a name="l01622"></a>01622               fac2 = Qdm(n_arete,1);
<a name="l01623"></a>01623               fac3 = Qdm(n_arete,2);
<a name="l01624"></a>01624               signe = Qdm(n_arete,3);
<a name="l01625"></a>01625               flux_evaluateur.secmem_arete_paroi(fac1, fac2, fac3, signe, flux);
<a name="l01626"></a>01626               <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01627"></a>01627                 {
<a name="l01628"></a>01628                   resu(fac3,k)+=signe*flux(k);
<a name="l01629"></a>01629                   <span class="comment">/* on ajoute la contribution du coin paroi-perio au flux_bord */</span>
<a name="l01630"></a>01630                   <span class="comment">/* classiquement -0.5*signe*flux */</span>
<a name="l01631"></a>01631                   <span class="comment">/* on met 0.25 sur les deux faces (car on  ajoutera deux fois la contrib) */</span>
<a name="l01632"></a>01632                 }
<a name="l01633"></a>01633             }
<a name="l01634"></a>01634           <span class="keywordflow">break</span>;
<a name="l01635"></a>01635         <span class="keywordflow">default</span> :
<a name="l01636"></a>01636           <span class="keywordflow">break</span>;
<a name="l01637"></a>01637         }
<a name="l01638"></a>01638     }
<a name="l01639"></a>01639 }
<a name="l01640"></a>01640 
<a name="l01641"></a>01641 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01642"></a><a class="code" href="classT__It__VDF__Face.html#a86d3f070afdd8b66530f9e5177738d26">01642</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a86d3f070afdd8b66530f9e5177738d26">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre_aretes_internes</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01643"></a>01643 <span class="keyword"></span>{
<a name="l01644"></a>01644   <span class="keywordtype">double</span> flux;
<a name="l01645"></a>01645   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l01646"></a>01646   <span class="keywordtype">int</span> n_arete;
<a name="l01647"></a>01647   <span class="keywordflow">for</span> (n_arete=premiere_arete_interne; n_arete&lt;derniere_arete_interne; n_arete++)
<a name="l01648"></a>01648     {
<a name="l01649"></a>01649       fac1=Qdm(n_arete,0);
<a name="l01650"></a>01650       fac2=Qdm(n_arete,1);
<a name="l01651"></a>01651       fac3=Qdm(n_arete,2);
<a name="l01652"></a>01652       fac4=Qdm(n_arete,3);
<a name="l01653"></a>01653       flux=flux_evaluateur.secmem_arete_interne(fac1, fac2, fac3, fac4);
<a name="l01654"></a>01654       resu[fac3] += flux;
<a name="l01655"></a>01655       resu[fac4] -= flux;
<a name="l01656"></a>01656       flux=flux_evaluateur.secmem_arete_interne(fac3, fac4, fac1, fac2);
<a name="l01657"></a>01657       resu[fac1] += flux;
<a name="l01658"></a>01658       resu[fac2] -= flux;
<a name="l01659"></a>01659     }
<a name="l01660"></a>01660 }
<a name="l01661"></a>01661 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01662"></a><a class="code" href="classT__It__VDF__Face.html#a6e6d435bfb1c5a0ae6e7b42d55b535a6">01662</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a86d3f070afdd8b66530f9e5177738d26">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre_aretes_internes</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l01663"></a>01663 <span class="keyword"></span>{
<a name="l01664"></a>01664   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp);
<a name="l01665"></a>01665   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l01666"></a>01666   <span class="keywordtype">int</span> n_arete,k;
<a name="l01667"></a>01667   <span class="keywordflow">for</span> (n_arete=premiere_arete_interne; n_arete&lt;derniere_arete_interne; n_arete++)
<a name="l01668"></a>01668     {
<a name="l01669"></a>01669       fac1=Qdm(n_arete,0);
<a name="l01670"></a>01670       fac2=Qdm(n_arete,1);
<a name="l01671"></a>01671       fac3=Qdm(n_arete,2);
<a name="l01672"></a>01672       fac4=Qdm(n_arete,3);
<a name="l01673"></a>01673       flux_evaluateur.secmem_arete_interne(fac1, fac2, fac3, fac4,flux);
<a name="l01674"></a>01674       <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01675"></a>01675         {
<a name="l01676"></a>01676           resu(fac3,k) += flux(k);
<a name="l01677"></a>01677           resu(fac4,k) -= flux(k);
<a name="l01678"></a>01678         }
<a name="l01679"></a>01679       flux_evaluateur.secmem_arete_interne(fac3, fac4, fac1, fac2, flux);
<a name="l01680"></a>01680       <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01681"></a>01681         {
<a name="l01682"></a>01682           resu(fac1,k) += flux(k);
<a name="l01683"></a>01683           resu(fac2,k) -= flux(k);
<a name="l01684"></a>01684         }
<a name="l01685"></a>01685     }
<a name="l01686"></a>01686 }
<a name="l01687"></a>01687 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01688"></a><a class="code" href="classT__It__VDF__Face.html#ae6acf0134a78827f4e4ca9a3354d3c74">01688</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#ae6acf0134a78827f4e4ca9a3354d3c74">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre_aretes_mixtes</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01689"></a>01689 <span class="keyword"></span>{
<a name="l01690"></a>01690   <span class="keywordtype">double</span> flux;
<a name="l01691"></a>01691   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l01692"></a>01692   <span class="keywordtype">int</span> n_arete;
<a name="l01693"></a>01693   <span class="keywordflow">for</span> (n_arete=premiere_arete_mixte; n_arete&lt;derniere_arete_mixte; n_arete++)
<a name="l01694"></a>01694     {
<a name="l01695"></a>01695       fac1=Qdm(n_arete,0);
<a name="l01696"></a>01696       fac2=Qdm(n_arete,1);
<a name="l01697"></a>01697       fac3=Qdm(n_arete,2);
<a name="l01698"></a>01698       fac4=Qdm(n_arete,3);
<a name="l01699"></a>01699       flux=flux_evaluateur.secmem_arete_mixte(fac1, fac2, fac3, fac4);
<a name="l01700"></a>01700       resu[fac3] += flux;
<a name="l01701"></a>01701       resu[fac4] -= flux;
<a name="l01702"></a>01702       flux=flux_evaluateur.secmem_arete_mixte(fac3, fac4, fac1, fac2);
<a name="l01703"></a>01703       resu[fac1] += flux;
<a name="l01704"></a>01704       resu[fac2] -= flux;
<a name="l01705"></a>01705     }
<a name="l01706"></a>01706 }
<a name="l01707"></a>01707 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01708"></a><a class="code" href="classT__It__VDF__Face.html#acef3e40fcb370f60e548861321c2fe84">01708</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#ae6acf0134a78827f4e4ca9a3354d3c74">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre_aretes_mixtes</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l01709"></a>01709 <span class="keyword"></span>{
<a name="l01710"></a>01710   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp);
<a name="l01711"></a>01711   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l01712"></a>01712   <span class="keywordtype">int</span> n_arete,k;
<a name="l01713"></a>01713   <span class="keywordflow">for</span> (n_arete=premiere_arete_mixte; n_arete&lt;derniere_arete_mixte; n_arete++)
<a name="l01714"></a>01714     {
<a name="l01715"></a>01715       fac1=Qdm(n_arete,0);
<a name="l01716"></a>01716       fac2=Qdm(n_arete,1);
<a name="l01717"></a>01717       fac3=Qdm(n_arete,2);
<a name="l01718"></a>01718       fac4=Qdm(n_arete,3);
<a name="l01719"></a>01719       flux_evaluateur.secmem_arete_mixte(fac1, fac2, fac3, fac4, flux);
<a name="l01720"></a>01720       <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01721"></a>01721         {
<a name="l01722"></a>01722           resu(fac3,k) += flux(k);
<a name="l01723"></a>01723           resu(fac4,k) -= flux(k);
<a name="l01724"></a>01724         }
<a name="l01725"></a>01725       flux_evaluateur.secmem_arete_mixte(fac3, fac4, fac1, fac2, flux);
<a name="l01726"></a>01726       <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01727"></a>01727         {
<a name="l01728"></a>01728           resu(fac1,k) += flux(k);
<a name="l01729"></a>01729           resu(fac2,k) -= flux(k);
<a name="l01730"></a>01730         }
<a name="l01731"></a>01731     }
<a name="l01732"></a>01732 }
<a name="l01733"></a>01733 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01734"></a><a class="code" href="classT__It__VDF__Face.html#a392dd1c6c0eed77f938ff358c5331099">01734</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a392dd1c6c0eed77f938ff358c5331099">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre_fa7_sortie_libre</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01735"></a>01735 <span class="keyword"></span>{
<a name="l01736"></a>01736   <span class="keywordtype">int</span> num_cl;
<a name="l01737"></a>01737   <span class="keywordtype">int</span> ndeb, nfin;
<a name="l01738"></a>01738   <span class="keywordtype">int</span> face;
<a name="l01739"></a>01739   <span class="keywordtype">int</span> nb_front_Cl=la_zone-&gt;nb_front_Cl();
<a name="l01740"></a>01740   <span class="keywordflow">for</span> (num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l01741"></a>01741     {
<a name="l01742"></a>01742       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl-&gt;les_conditions_limites(num_cl);
<a name="l01743"></a>01743       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l01744"></a>01744       ndeb = frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l01745"></a>01745       nfin = ndeb + frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l01746"></a>01746       <span class="keywordflow">switch</span>(type_cl(la_cl))
<a name="l01747"></a>01747         {
<a name="l01748"></a>01748         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac4317ef27513bbab3cd0ccfd0d9ed199" title="Neumann_sortie_libre ou derivees.">sortie_libre</a> :
<a name="l01749"></a>01749           <span class="keywordflow">if</span> (flux_evaluateur.calculer_fa7_sortie_libre())
<a name="l01750"></a>01750             {
<a name="l01751"></a>01751               <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; cl =(<span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp;) (la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l01752"></a>01752               <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l01753"></a>01753                 {
<a name="l01754"></a>01754                   <span class="keywordtype">double</span> flux=flux_evaluateur.secmem_fa7_sortie_libre(face, cl, ndeb);
<a name="l01755"></a>01755                   <span class="keywordflow">if</span> ( (elem(face,0)) &gt; -1)
<a name="l01756"></a>01756                     resu[face]+=flux;
<a name="l01757"></a>01757                   <span class="keywordflow">if</span> ( (elem(face,1)) &gt; -1)
<a name="l01758"></a>01758                     resu[face]-=flux;
<a name="l01759"></a>01759                 }
<a name="l01760"></a>01760             }
<a name="l01761"></a>01761           <span class="keywordflow">break</span>;
<a name="l01762"></a>01762         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac938491055e13993f3eed68c989f90b0" title="Symetrie.">symetrie</a> :
<a name="l01763"></a>01763           <span class="keywordflow">break</span>;
<a name="l01764"></a>01764         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a594fd60a4576f47654eed7df53dee9be" title="Dirichlet_entree_fluide.">entree_fluide</a> :
<a name="l01765"></a>01765           <span class="keywordflow">break</span>;
<a name="l01766"></a>01766         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a497d92e00f36c1c7ec874c0a318db91e" title="Dirichlet_paroi_fixe.">paroi_fixe</a> :
<a name="l01767"></a>01767           <span class="keywordflow">break</span>;
<a name="l01768"></a>01768         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649acdd1bf461cb105b93d5a9b003ce33141" title="Dirichlet_paroi_defilante.">paroi_defilante</a> :
<a name="l01769"></a>01769           <span class="keywordflow">break</span>;
<a name="l01770"></a>01770         <span class="keywordflow">case</span> <a class="code" href="classparoi__adiabatique.html">paroi_adiabatique</a> :
<a name="l01771"></a>01771           <span class="keywordflow">break</span>;
<a name="l01772"></a>01772         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649af695f3ba17490e07dc3259c85875d8d6" title="Neumann_paroi.">paroi</a>:
<a name="l01773"></a>01773           <span class="keywordflow">break</span>;
<a name="l01774"></a>01774         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a38f997f881a13a46f2d06012162cf833" title="Echange_externe_impose.">echange_externe_impose</a> :
<a name="l01775"></a>01775           <span class="keywordflow">break</span>;
<a name="l01776"></a>01776         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a9201b83c6fe44d3928abbe5f73364323" title="Echange_global_impose.">echange_global_impose</a> :
<a name="l01777"></a>01777           <span class="keywordflow">break</span>;
<a name="l01778"></a>01778         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ab83c671c148d8664c5c87f343d2ab9fd" title="periodique">periodique</a> :
<a name="l01779"></a>01779           <span class="keywordflow">break</span>;
<a name="l01780"></a>01780         <span class="keywordflow">default</span> :
<a name="l01781"></a>01781           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On ne reconnait pas la condition limite : &quot;</span> &lt;&lt; la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>();
<a name="l01782"></a>01782           exit();
<a name="l01783"></a>01783           <span class="keywordflow">break</span>;
<a name="l01784"></a>01784         }
<a name="l01785"></a>01785     }
<a name="l01786"></a>01786 }
<a name="l01787"></a>01787 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01788"></a><a class="code" href="classT__It__VDF__Face.html#af64d82d690a4f5df022847a535e9e228">01788</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a392dd1c6c0eed77f938ff358c5331099">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre_fa7_sortie_libre</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l01789"></a>01789 <span class="keyword"></span>{
<a name="l01790"></a>01790   <span class="keywordtype">int</span> num_cl;
<a name="l01791"></a>01791   <span class="keywordtype">int</span> ndeb, nfin;
<a name="l01792"></a>01792   <span class="keywordtype">int</span> face,k;
<a name="l01793"></a>01793   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp);
<a name="l01794"></a>01794   <span class="keywordtype">int</span> nb_front_Cl=la_zone-&gt;nb_front_Cl();
<a name="l01795"></a>01795   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords=op_base-&gt;flux_bords();
<a name="l01796"></a>01796   <span class="keywordflow">for</span> (num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l01797"></a>01797     {
<a name="l01798"></a>01798       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl-&gt;les_conditions_limites(num_cl);
<a name="l01799"></a>01799       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l01800"></a>01800       ndeb = frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l01801"></a>01801       nfin = ndeb + frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l01802"></a>01802       <span class="keywordflow">switch</span>(type_cl(la_cl))
<a name="l01803"></a>01803         {
<a name="l01804"></a>01804         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac4317ef27513bbab3cd0ccfd0d9ed199" title="Neumann_sortie_libre ou derivees.">sortie_libre</a> :
<a name="l01805"></a>01805           <span class="keywordflow">if</span> (flux_evaluateur.calculer_fa7_sortie_libre())
<a name="l01806"></a>01806             {
<a name="l01807"></a>01807               <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; cl =(<span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp;) (la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l01808"></a>01808               <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l01809"></a>01809                 {
<a name="l01810"></a>01810                   flux_evaluateur.secmem_fa7_sortie_libre(face, cl, ndeb, flux);
<a name="l01811"></a>01811                   <span class="keywordflow">if</span> ( (elem(face,0)) &gt; -1)
<a name="l01812"></a>01812                     <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01813"></a>01813                       resu(face,k) += flux(k);
<a name="l01814"></a>01814                   <span class="keywordflow">if</span> ( (elem(face,1)) &gt; -1)
<a name="l01815"></a>01815                     <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01816"></a>01816                       resu(face,k) -= flux(k);
<a name="l01817"></a>01817                   <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01818"></a>01818                     tab_flux_bords(face,k)-=flux(k);
<a name="l01819"></a>01819                 }
<a name="l01820"></a>01820             }
<a name="l01821"></a>01821           <span class="keywordflow">break</span>;
<a name="l01822"></a>01822         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac938491055e13993f3eed68c989f90b0" title="Symetrie.">symetrie</a> :
<a name="l01823"></a>01823           <span class="keywordflow">break</span>;
<a name="l01824"></a>01824         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a594fd60a4576f47654eed7df53dee9be" title="Dirichlet_entree_fluide.">entree_fluide</a> :
<a name="l01825"></a>01825           <span class="keywordflow">break</span>;
<a name="l01826"></a>01826         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a497d92e00f36c1c7ec874c0a318db91e" title="Dirichlet_paroi_fixe.">paroi_fixe</a> :
<a name="l01827"></a>01827           <span class="keywordflow">break</span>;
<a name="l01828"></a>01828         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649acdd1bf461cb105b93d5a9b003ce33141" title="Dirichlet_paroi_defilante.">paroi_defilante</a> :
<a name="l01829"></a>01829           <span class="keywordflow">break</span>;
<a name="l01830"></a>01830         <span class="keywordflow">case</span> <a class="code" href="classparoi__adiabatique.html">paroi_adiabatique</a> :
<a name="l01831"></a>01831           <span class="keywordflow">break</span>;
<a name="l01832"></a>01832         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649af695f3ba17490e07dc3259c85875d8d6" title="Neumann_paroi.">paroi</a>:
<a name="l01833"></a>01833           <span class="keywordflow">break</span>;
<a name="l01834"></a>01834         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a38f997f881a13a46f2d06012162cf833" title="Echange_externe_impose.">echange_externe_impose</a> :
<a name="l01835"></a>01835           <span class="keywordflow">break</span>;
<a name="l01836"></a>01836         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a9201b83c6fe44d3928abbe5f73364323" title="Echange_global_impose.">echange_global_impose</a> :
<a name="l01837"></a>01837           <span class="keywordflow">break</span>;
<a name="l01838"></a>01838         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ab83c671c148d8664c5c87f343d2ab9fd" title="periodique">periodique</a> :
<a name="l01839"></a>01839           <span class="keywordflow">break</span>;
<a name="l01840"></a>01840         <span class="keywordflow">default</span> :
<a name="l01841"></a>01841           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On ne reconnait pas la condition limite : &quot;</span> &lt;&lt; la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>();
<a name="l01842"></a>01842           exit();
<a name="l01843"></a>01843           <span class="keywordflow">break</span>;
<a name="l01844"></a>01844         }
<a name="l01845"></a>01845     }
<a name="l01846"></a>01846 }
<a name="l01847"></a>01847 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01848"></a><a class="code" href="classT__It__VDF__Face.html#a17c8e580e948b3014c269a0efed2895b">01848</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a17c8e580e948b3014c269a0efed2895b">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre_fa7_elem</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01849"></a>01849 <span class="keyword"></span>{
<a name="l01850"></a>01850   <span class="keywordtype">double</span> flux;
<a name="l01851"></a>01851   <span class="keywordtype">int</span> fa7, fac1, fac2;
<a name="l01852"></a>01852   <span class="keywordtype">int</span> num_elem=0;
<a name="l01853"></a>01853   <span class="keywordflow">for</span>( ; num_elem&lt;nb_elem; num_elem++)
<a name="l01854"></a>01854     {
<a name="l01855"></a>01855       <span class="keywordflow">for</span> (fa7=0; fa7&lt;dimension; fa7++)
<a name="l01856"></a>01856         {
<a name="l01857"></a>01857           fac1=elem_faces(num_elem,fa7);
<a name="l01858"></a>01858           fac2=elem_faces(num_elem,fa7+dimension);
<a name="l01859"></a>01859           flux=flux_evaluateur.secmem_fa7_elem(num_elem, fac1, fac2);
<a name="l01860"></a>01860           resu[fac1] += flux;
<a name="l01861"></a>01861           resu[fac2] -= flux;
<a name="l01862"></a>01862         }
<a name="l01863"></a>01863     }
<a name="l01864"></a>01864   corriger_secmem_fa7_elem_periodicite(resu);
<a name="l01865"></a>01865 }
<a name="l01866"></a>01866 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01867"></a><a class="code" href="classT__It__VDF__Face.html#a3b458db41e181d9b53cada0093ac32bf">01867</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a17c8e580e948b3014c269a0efed2895b">T_It_VDF_Face&lt;_TYPE_&gt;::contribuer_au_second_membre_fa7_elem</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l01868"></a>01868 <span class="keyword"></span>{
<a name="l01869"></a>01869   <span class="keywordtype">int</span> fa7, fac1, fac2;
<a name="l01870"></a>01870   <span class="keywordtype">int</span> num_elem;
<a name="l01871"></a>01871   <span class="keywordtype">int</span> k;
<a name="l01872"></a>01872   <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp);
<a name="l01873"></a>01873   <span class="keywordflow">for</span>(num_elem=0; num_elem&lt;nb_elem; num_elem++)
<a name="l01874"></a>01874     {
<a name="l01875"></a>01875       <span class="keywordflow">for</span> (fa7=0; fa7&lt;dimension; fa7++)
<a name="l01876"></a>01876         {
<a name="l01877"></a>01877           fac1=elem_faces(num_elem,fa7);
<a name="l01878"></a>01878           fac2=elem_faces(num_elem,fa7+dimension);
<a name="l01879"></a>01879           flux_evaluateur.secmem_fa7_elem(num_elem, fac1, fac2, flux);
<a name="l01880"></a>01880           <span class="keywordflow">for</span> (k=0; k&lt;ncomp; k++)
<a name="l01881"></a>01881             {
<a name="l01882"></a>01882               resu(fac1,k) += flux(k);
<a name="l01883"></a>01883               resu(fac2,k) -= flux(k);
<a name="l01884"></a>01884             }
<a name="l01885"></a>01885         }
<a name="l01886"></a>01886     }
<a name="l01887"></a>01887   corriger_secmem_fa7_elem_periodicite(resu,ncomp);
<a name="l01888"></a>01888 }
<a name="l01889"></a>01889 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01890"></a><a class="code" href="classT__It__VDF__Face.html#ac693aa1c977fd8d033af3e4c6efc083f">01890</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a1f6bfe9ff87696e7ca413b5f9c9d8bf9">T_It_VDF_Face&lt;_TYPE_&gt;::corriger_secmem_fa7_elem_periodicite</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l01891"></a>01891 <span class="keyword"></span>{
<a name="l01892"></a>01892   <span class="keywordtype">int</span> nb_front_Cl=la_zone-&gt;nb_front_Cl();
<a name="l01893"></a>01893   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l01894"></a>01894     {
<a name="l01895"></a>01895       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl-&gt;les_conditions_limites(num_cl);
<a name="l01896"></a>01896       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l01897"></a>01897         {
<a name="l01898"></a>01898           <span class="keywordtype">int</span> ndeb,nfin,elem1,elem2,num_elem,ori;
<a name="l01899"></a>01899           <span class="keywordtype">int</span> face,fac1,fac2,signe;
<a name="l01900"></a>01900           <a class="code" href="classDoubleVect.html">DoubleVect</a> flux(ncomp);
<a name="l01901"></a>01901           <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l01902"></a>01902           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl_perio.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l01903"></a>01903           ndeb = le_bord.num_premiere_face();
<a name="l01904"></a>01904           nfin = ndeb + le_bord.nb_faces();
<a name="l01905"></a>01905           <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l01906"></a>01906             {
<a name="l01907"></a>01907               elem1 = elem(face,0);
<a name="l01908"></a>01908               elem2 = elem(face,1);
<a name="l01909"></a>01909               ori = orientation(face);
<a name="l01910"></a>01910               <span class="keywordflow">if</span> ( (face == elem_faces(elem1,ori)) || (face == elem_faces(elem1,ori+dimension)) )
<a name="l01911"></a>01911                 {
<a name="l01912"></a>01912                   num_elem = elem2;
<a name="l01913"></a>01913                   signe = 1;
<a name="l01914"></a>01914                 }
<a name="l01915"></a>01915               <span class="keywordflow">else</span>
<a name="l01916"></a>01916                 {
<a name="l01917"></a>01917                   num_elem = elem1;
<a name="l01918"></a>01918                   signe = -1;
<a name="l01919"></a>01919                 }
<a name="l01920"></a>01920               fac1 = elem_faces(num_elem,ori);
<a name="l01921"></a>01921               fac2 = elem_faces(num_elem,ori+dimension);
<a name="l01922"></a>01922               flux_evaluateur.secmem_fa7_elem(num_elem,fac1,fac2,flux);
<a name="l01923"></a>01923               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;ncomp; k++)
<a name="l01924"></a>01924                 resu(face,k) += signe*flux(k);
<a name="l01925"></a>01925             }
<a name="l01926"></a>01926         }
<a name="l01927"></a>01927     }
<a name="l01928"></a>01928 }
<a name="l01929"></a>01929 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01930"></a><a class="code" href="classT__It__VDF__Face.html#a1f6bfe9ff87696e7ca413b5f9c9d8bf9">01930</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a1f6bfe9ff87696e7ca413b5f9c9d8bf9">T_It_VDF_Face&lt;_TYPE_&gt;::corriger_secmem_fa7_elem_periodicite</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01931"></a>01931 <span class="keyword"></span>{
<a name="l01932"></a>01932   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; la_zcl_vdf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>,la_zcl.valeur());
<a name="l01933"></a>01933   <span class="keywordtype">int</span> nb_cond_lim = la_zcl_vdf.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
<a name="l01934"></a>01934   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;nb_cond_lim; num_cl++)
<a name="l01935"></a>01935     {
<a name="l01936"></a>01936       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl_vdf.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(num_cl);
<a name="l01937"></a>01937       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l01938"></a>01938       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l01939"></a>01939         {
<a name="l01940"></a>01940           <span class="keywordtype">int</span> ndeb,nfin,elem1,elem2,num_elem,ori;
<a name="l01941"></a>01941           <span class="keywordtype">int</span> face,fac1,fac2,signe;
<a name="l01942"></a>01942           <span class="keywordtype">double</span> flux;
<a name="l01943"></a>01943           <span class="comment">/* const Periodique&amp; la_cl_perio = ref_cast(Periodique,la_cl.valeur()); */</span>
<a name="l01944"></a>01944           ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l01945"></a>01945           nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l01946"></a>01946           <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l01947"></a>01947             {
<a name="l01948"></a>01948               elem1 = elem(face,0);
<a name="l01949"></a>01949               elem2 = elem(face,1);
<a name="l01950"></a>01950               ori = orientation(face);
<a name="l01951"></a>01951               <span class="keywordflow">if</span> ( (face == elem_faces(elem1,ori)) || (face == elem_faces(elem1,ori+dimension)) )
<a name="l01952"></a>01952                 {
<a name="l01953"></a>01953                   num_elem = elem2;
<a name="l01954"></a>01954                   signe = 1;
<a name="l01955"></a>01955                 }
<a name="l01956"></a>01956               <span class="keywordflow">else</span>
<a name="l01957"></a>01957                 {
<a name="l01958"></a>01958                   num_elem = elem1;
<a name="l01959"></a>01959                   signe = -1;
<a name="l01960"></a>01960                 }
<a name="l01961"></a>01961               fac1 = elem_faces(num_elem,ori);
<a name="l01962"></a>01962               fac2 = elem_faces(num_elem,ori+dimension);
<a name="l01963"></a>01963               flux=flux_evaluateur.secmem_fa7_elem(num_elem,fac1,fac2);
<a name="l01964"></a>01964               resu(face) += signe*flux;
<a name="l01965"></a>01965             }
<a name="l01966"></a>01966         }
<a name="l01967"></a>01967     }
<a name="l01968"></a>01968 }
<a name="l01969"></a>01969 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l01970"></a><a class="code" href="classT__It__VDF__Face.html#a3bcd7c17ffd49e0a916b46bb330cca22">01970</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a3bcd7c17ffd49e0a916b46bb330cca22">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice)<span class="keyword"> const</span>
<a name="l01971"></a>01971 <span class="keyword"></span>{
<a name="l01972"></a>01972   ((_TYPE_&amp;) flux_evaluateur).mettre_a_jour();
<a name="l01973"></a>01973   assert(inco.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() &lt; 3);
<a name="l01974"></a>01974   <span class="keywordtype">int</span> ncomp=1;
<a name="l01975"></a>01975   <span class="keywordflow">if</span> (inco.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 2)
<a name="l01976"></a>01976     ncomp=inco.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l01977"></a>01977   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords=op_base-&gt;flux_bords();
<a name="l01978"></a>01978   tab_flux_bords.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(la_zone-&gt;nb_faces_bord(),ncomp);
<a name="l01979"></a>01979   tab_flux_bords=0;
<a name="l01980"></a>01980   <span class="keywordflow">if</span>( ncomp == 1)
<a name="l01981"></a>01981     {
<a name="l01982"></a>01982       ajouter_contribution_aretes_bords(inco, matrice) ;
<a name="l01983"></a>01983       ajouter_contribution_aretes_coins(inco, matrice) ;
<a name="l01984"></a>01984       ajouter_contribution_aretes_internes(inco, matrice );
<a name="l01985"></a>01985       ajouter_contribution_aretes_mixtes(inco, matrice);
<a name="l01986"></a>01986       ajouter_contribution_fa7_sortie_libre(inco, matrice);
<a name="l01987"></a>01987       ajouter_contribution_fa7_elem(inco, matrice);
<a name="l01988"></a>01988     }
<a name="l01989"></a>01989   <span class="keywordflow">else</span>
<a name="l01990"></a>01990     {
<a name="l01991"></a>01991       ajouter_contribution_aretes_bords(inco, matrice, ncomp) ;
<a name="l01992"></a>01992       ajouter_contribution_aretes_coins(inco, matrice, ncomp) ;
<a name="l01993"></a>01993       ajouter_contribution_aretes_internes(inco, matrice, ncomp) ;
<a name="l01994"></a>01994       ajouter_contribution_aretes_mixtes(inco, matrice, ncomp);
<a name="l01995"></a>01995       ajouter_contribution_fa7_sortie_libre(inco, matrice, ncomp);
<a name="l01996"></a>01996       ajouter_contribution_fa7_elem(inco, matrice, ncomp);
<a name="l01997"></a>01997     }
<a name="l01998"></a>01998 }
<a name="l01999"></a>01999 
<a name="l02000"></a>02000 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02001"></a><a class="code" href="classT__It__VDF__Face.html#ada94c89530cc3268ffc58310b176e2e9">02001</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#ada94c89530cc3268ffc58310b176e2e9">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_vitesse</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice)<span class="keyword"> const</span>
<a name="l02002"></a>02002 <span class="keyword"></span>{
<a name="l02003"></a>02003   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;ajouter_contribution_vitesse should not be called from &quot;</span> &lt;&lt;  op_base.que_suis_je() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02004"></a>02004   abort();
<a name="l02005"></a>02005 }
<a name="l02006"></a>02006 
<a name="l02007"></a>02007 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02008"></a><a class="code" href="classT__It__VDF__Face.html#a0c730b1cfd84d69100aee165b3e7a1d5">02008</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a0c730b1cfd84d69100aee165b3e7a1d5">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_aretes_bords</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice )<span class="keyword"> const</span>
<a name="l02009"></a>02009 <span class="keyword"></span>{
<a name="l02010"></a>02010   <span class="keywordtype">int</span> n_arete;
<a name="l02011"></a>02011   <span class="keywordtype">int</span> signe;
<a name="l02012"></a>02012   <span class="keywordtype">int</span> nb_face_reelle=la_zone-&gt;nb_faces();
<a name="l02013"></a>02013   <span class="keywordtype">double</span> aii=0, ajj=0, aii1_2=0, aii3_4=0, ajj1_2=0;
<a name="l02014"></a>02014   <span class="keywordtype">int</span> n_type;
<a name="l02015"></a>02015   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l02016"></a>02016   <span class="keywordflow">for</span> (n_arete=premiere_arete_bord; n_arete&lt;derniere_arete_bord; n_arete++)
<a name="l02017"></a>02017     {
<a name="l02018"></a>02018       n_type=type_arete_bord(n_arete-premiere_arete_bord);
<a name="l02019"></a>02019       <span class="keywordflow">switch</span>(n_type)
<a name="l02020"></a>02020         {
<a name="l02021"></a>02021         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>:
<a name="l02022"></a>02022           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l02023"></a>02023             {
<a name="l02024"></a>02024               fac1 = Qdm(n_arete,0);
<a name="l02025"></a>02025               fac2 = Qdm(n_arete,1);
<a name="l02026"></a>02026               fac3 = Qdm(n_arete,2);
<a name="l02027"></a>02027               signe = Qdm(n_arete,3);
<a name="l02028"></a>02028               flux_evaluateur.coeffs_arete_paroi(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02029"></a>02029               matrice(fac3,fac3)+=signe*aii3_4;
<a name="l02030"></a>02030             }
<a name="l02031"></a>02031           <span class="keywordflow">break</span>;
<a name="l02032"></a>02032         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a>:
<a name="l02033"></a>02033           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_fluide())
<a name="l02034"></a>02034             {
<a name="l02035"></a>02035               fac1 = Qdm(n_arete,0);
<a name="l02036"></a>02036               fac2 = Qdm(n_arete,1);
<a name="l02037"></a>02037               fac3 = Qdm(n_arete,2);
<a name="l02038"></a>02038               signe = Qdm(n_arete,3);
<a name="l02039"></a>02039               flux_evaluateur.coeffs_arete_fluide(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02040"></a>02040               matrice(fac3,fac3)+=signe*aii3_4;
<a name="l02041"></a>02041               matrice(fac1,fac1)+=aii1_2;
<a name="l02042"></a>02042               matrice(fac1,fac2)-=ajj1_2;
<a name="l02043"></a>02043               matrice(fac2,fac1)-=aii1_2;
<a name="l02044"></a>02044               matrice(fac2,fac2)+=ajj1_2;
<a name="l02045"></a>02045             }
<a name="l02046"></a>02046           <span class="keywordflow">break</span>;
<a name="l02047"></a>02047         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>:
<a name="l02048"></a>02048           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi_fluide())
<a name="l02049"></a>02049             {
<a name="l02050"></a>02050               fac1 = Qdm(n_arete,0);
<a name="l02051"></a>02051               fac2 = Qdm(n_arete,1);
<a name="l02052"></a>02052               fac3 = Qdm(n_arete,2);
<a name="l02053"></a>02053               signe = Qdm(n_arete,3);
<a name="l02054"></a>02054               flux_evaluateur.coeffs_arete_paroi_fluide(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02055"></a>02055               matrice(fac3,fac3)+=signe*aii3_4;
<a name="l02056"></a>02056               matrice(fac1,fac1)+=aii1_2;
<a name="l02057"></a>02057               matrice(fac1,fac2)-=ajj1_2;
<a name="l02058"></a>02058               matrice(fac2,fac1)-=aii1_2;
<a name="l02059"></a>02059               matrice(fac2,fac2)+=ajj1_2;
<a name="l02060"></a>02060             }
<a name="l02061"></a>02061           <span class="keywordflow">break</span>;
<a name="l02062"></a>02062         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a8ffe822aae0518f507be135120ec23b8">TypeAreteBordVDF::SYM_SYM</a>:
<a name="l02063"></a>02063           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie())
<a name="l02064"></a>02064             {
<a name="l02065"></a>02065               fac1 = Qdm(n_arete,0);
<a name="l02066"></a>02066               fac2 = Qdm(n_arete,1);
<a name="l02067"></a>02067               fac3 = Qdm(n_arete,2);
<a name="l02068"></a>02068               signe = Qdm(n_arete,3);
<a name="l02069"></a>02069               flux_evaluateur.coeffs_arete_symetrie(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02070"></a>02070               matrice(fac3,fac3)+=signe*aii3_4;
<a name="l02071"></a>02071             }
<a name="l02072"></a>02072           <span class="keywordflow">break</span>;
<a name="l02073"></a>02073         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a37713c7b918ab812a24573ce30b2a322">TypeAreteBordVDF::PERIO_PERIO</a>:
<a name="l02074"></a>02074           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_periodicite())
<a name="l02075"></a>02075             {
<a name="l02076"></a>02076               fac1 = Qdm(n_arete,0);
<a name="l02077"></a>02077               fac2 = Qdm(n_arete,1);
<a name="l02078"></a>02078               fac3 = Qdm(n_arete,2);
<a name="l02079"></a>02079               fac4 = Qdm(n_arete,3);
<a name="l02080"></a>02080               flux_evaluateur.coeffs_arete_periodicite(fac3, fac4, fac1, fac2, aii, ajj);
<a name="l02081"></a>02081               <span class="keywordflow">if</span> (fac1&lt;nb_face_reelle)
<a name="l02082"></a>02082                 {
<a name="l02083"></a>02083                   matrice(fac1,fac1)+=aii;
<a name="l02084"></a>02084                   matrice(fac1,fac2)-=ajj;
<a name="l02085"></a>02085                 }
<a name="l02086"></a>02086               <span class="keywordflow">if</span> (fac2&lt;nb_face_reelle)
<a name="l02087"></a>02087                 {
<a name="l02088"></a>02088                   matrice(fac2,fac1)-=aii;
<a name="l02089"></a>02089                   matrice(fac2,fac2)+=ajj;
<a name="l02090"></a>02090                 }
<a name="l02091"></a>02091               flux_evaluateur.coeffs_arete_periodicite(fac1, fac2, fac3, fac4, aii, ajj);
<a name="l02092"></a>02092               aii*=0.5;
<a name="l02093"></a>02093               ajj*=0.5;
<a name="l02094"></a>02094               <span class="keywordflow">if</span> (fac3&lt;nb_face_reelle)
<a name="l02095"></a>02095                 {
<a name="l02096"></a>02096                   matrice(fac3,fac3)+=aii;
<a name="l02097"></a>02097                   matrice(fac3,fac4)-=ajj;
<a name="l02098"></a>02098                 }
<a name="l02099"></a>02099               <span class="keywordflow">if</span> (fac4&lt;nb_face_reelle)
<a name="l02100"></a>02100                 {
<a name="l02101"></a>02101                   matrice(fac4,fac3)-=aii;
<a name="l02102"></a>02102                   matrice(fac4,fac4)+=ajj;
<a name="l02103"></a>02103                 }
<a name="l02104"></a>02104             }
<a name="l02105"></a>02105           <span class="keywordflow">break</span>;
<a name="l02106"></a>02106         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac0b72d665d0d8eb58248f5c6c65f410c">TypeAreteBordVDF::PAROI_SYM</a>:
<a name="l02107"></a>02107           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie_paroi())
<a name="l02108"></a>02108             {
<a name="l02109"></a>02109               fac1 = Qdm(n_arete,0);
<a name="l02110"></a>02110               fac2 = Qdm(n_arete,1);
<a name="l02111"></a>02111               fac3 = Qdm(n_arete,2);
<a name="l02112"></a>02112               signe = Qdm(n_arete,3);
<a name="l02113"></a>02113               flux_evaluateur.coeffs_arete_symetrie_paroi(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02114"></a>02114               matrice(fac3,fac3)+=signe*aii3_4;
<a name="l02115"></a>02115             }
<a name="l02116"></a>02116           <span class="keywordflow">break</span>;
<a name="l02117"></a>02117         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a460c2f242b0d8c910f37c8940e504707">TypeAreteBordVDF::FLUIDE_SYM</a>:
<a name="l02118"></a>02118           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie_fluide())
<a name="l02119"></a>02119             {
<a name="l02120"></a>02120               fac1 = Qdm(n_arete,0);
<a name="l02121"></a>02121               fac2 = Qdm(n_arete,1);
<a name="l02122"></a>02122               fac3 = Qdm(n_arete,2);
<a name="l02123"></a>02123               signe = Qdm(n_arete,3);
<a name="l02124"></a>02124               flux_evaluateur.coeffs_arete_symetrie_fluide(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02125"></a>02125               matrice(fac3,fac3)+=signe*aii3_4;
<a name="l02126"></a>02126               matrice(fac1,fac1)+=aii1_2;
<a name="l02127"></a>02127               matrice(fac1,fac2)-=ajj1_2;
<a name="l02128"></a>02128               matrice(fac2,fac1)-=aii1_2;
<a name="l02129"></a>02129               matrice(fac2,fac2)+=ajj1_2;
<a name="l02130"></a>02130             }
<a name="l02131"></a>02131           <span class="keywordflow">break</span>;
<a name="l02132"></a>02132         <span class="keywordflow">default</span> :
<a name="l02133"></a>02133           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l02134"></a>02134           \
<a name="l02135"></a>02135           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l02136"></a>02136           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l02137"></a>02137           exit();
<a name="l02138"></a>02138         }
<a name="l02139"></a>02139     }
<a name="l02140"></a>02140 }
<a name="l02141"></a>02141 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02142"></a><a class="code" href="classT__It__VDF__Face.html#affed891be2e488b424e5e641ba7f722a">02142</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a0c730b1cfd84d69100aee165b3e7a1d5">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_aretes_bords</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice ,<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l02143"></a>02143 <span class="keyword"></span>{
<a name="l02144"></a>02144   <span class="keywordtype">int</span> n_arete;
<a name="l02145"></a>02145   <span class="keywordtype">int</span> signe;
<a name="l02146"></a>02146   <a class="code" href="classDoubleVect.html">DoubleVect</a> aii(ncomp), ajj(ncomp), aii1_2(ncomp), aii3_4(ncomp), ajj1_2(ncomp), ajj3_4(ncomp);
<a name="l02147"></a>02147   <span class="keywordtype">int</span> n_type;
<a name="l02148"></a>02148   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l02149"></a>02149   <span class="keywordtype">int</span> k,i;
<a name="l02150"></a>02150   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = matrice.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l02151"></a>02151   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = matrice.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l02152"></a>02152   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l02153"></a>02153   <span class="keywordflow">for</span> (n_arete=premiere_arete_bord; n_arete&lt;derniere_arete_bord; n_arete++)
<a name="l02154"></a>02154     {
<a name="l02155"></a>02155       n_type=type_arete_bord(n_arete-premiere_arete_bord);
<a name="l02156"></a>02156       <span class="keywordflow">switch</span>(n_type)
<a name="l02157"></a>02157         {
<a name="l02158"></a>02158         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>:
<a name="l02159"></a>02159           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l02160"></a>02160             {
<a name="l02161"></a>02161               fac1 = Qdm(n_arete,0);
<a name="l02162"></a>02162               fac2 = Qdm(n_arete,1);
<a name="l02163"></a>02163               fac3 = Qdm(n_arete,2);
<a name="l02164"></a>02164               signe = Qdm(n_arete,3);
<a name="l02165"></a>02165               flux_evaluateur.coeffs_arete_paroi(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02166"></a>02166               <span class="keywordflow">for</span> (i=0; i&lt;ncomp; i++)
<a name="l02167"></a>02167                 {
<a name="l02168"></a>02168                   <span class="keywordflow">for</span> (k=tab1[fac3*ncomp+i]-1; k&lt;tab1[fac3*ncomp+1+i]-1; k++)
<a name="l02169"></a>02169                     {
<a name="l02170"></a>02170                       <span class="keywordflow">if</span> (tab2[k]-1==fac3*ncomp+i)
<a name="l02171"></a>02171                         {
<a name="l02172"></a>02172                           coeff[k]+=signe*aii3_4(i);
<a name="l02173"></a>02173                         }
<a name="l02174"></a>02174                     }
<a name="l02175"></a>02175                 }
<a name="l02176"></a>02176             }
<a name="l02177"></a>02177           <span class="keywordflow">break</span>;
<a name="l02178"></a>02178         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a>:
<a name="l02179"></a>02179           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_fluide())
<a name="l02180"></a>02180             {
<a name="l02181"></a>02181               fac1 = Qdm(n_arete,0);
<a name="l02182"></a>02182               fac2 = Qdm(n_arete,1);
<a name="l02183"></a>02183               fac3 = Qdm(n_arete,2);
<a name="l02184"></a>02184               signe = Qdm(n_arete,3);
<a name="l02185"></a>02185               flux_evaluateur.coeffs_arete_fluide(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02186"></a>02186               <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02187"></a>02187                 {
<a name="l02188"></a>02188                   <span class="keywordflow">for</span> (k=tab1[fac3*ncomp+i]-1; k&lt;tab1[fac3*ncomp+1+i]-1; k++)
<a name="l02189"></a>02189                     {
<a name="l02190"></a>02190                       <span class="keywordflow">if</span> (tab2[k]-1==fac3*ncomp+i)
<a name="l02191"></a>02191                         {
<a name="l02192"></a>02192                           coeff[k]+=signe*aii3_4(i);
<a name="l02193"></a>02193                         }
<a name="l02194"></a>02194                     }
<a name="l02195"></a>02195                   <span class="keywordflow">for</span> (k=tab1[fac1*ncomp+i]-1; k&lt;tab1[fac1*ncomp+1+i]-1; k++)
<a name="l02196"></a>02196                     {
<a name="l02197"></a>02197                       <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02198"></a>02198                         {
<a name="l02199"></a>02199                           <span class="comment">/* correction de coef[k,i] on fait planter */</span>
<a name="l02200"></a>02200                           assert(0);
<a name="l02201"></a>02201                           exit();
<a name="l02202"></a>02202                           coeff[k]+=aii1_2(i);
<a name="l02203"></a>02203                         }
<a name="l02204"></a>02204                       <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02205"></a>02205                         {
<a name="l02206"></a>02206                           coeff[k]-=ajj1_2(i);
<a name="l02207"></a>02207                         }
<a name="l02208"></a>02208                     }
<a name="l02209"></a>02209                   <span class="keywordflow">for</span> (k=tab1[fac2*ncomp+i]-1; k&lt;tab1[fac2*ncomp+1+i]-1; k++)
<a name="l02210"></a>02210                     {
<a name="l02211"></a>02211                       <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02212"></a>02212                         {
<a name="l02213"></a>02213                           coeff[k]-=aii1_2(i);
<a name="l02214"></a>02214                         }
<a name="l02215"></a>02215                       <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02216"></a>02216                         {
<a name="l02217"></a>02217                           coeff[k]+=ajj1_2(i);
<a name="l02218"></a>02218                         }
<a name="l02219"></a>02219                     }
<a name="l02220"></a>02220                 }
<a name="l02221"></a>02221             }
<a name="l02222"></a>02222           <span class="keywordflow">break</span>;
<a name="l02223"></a>02223         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>:
<a name="l02224"></a>02224           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi_fluide())
<a name="l02225"></a>02225             {
<a name="l02226"></a>02226               fac1 = Qdm(n_arete,0);
<a name="l02227"></a>02227               fac2 = Qdm(n_arete,1);
<a name="l02228"></a>02228               fac3 = Qdm(n_arete,2);
<a name="l02229"></a>02229               signe = Qdm(n_arete,3);
<a name="l02230"></a>02230               flux_evaluateur.coeffs_arete_paroi_fluide(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02231"></a>02231               <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02232"></a>02232                 {
<a name="l02233"></a>02233                   <span class="keywordflow">for</span> (k=tab1[fac3*ncomp+i]-1; k&lt;tab1[fac3*ncomp+1+i]-1; k++)
<a name="l02234"></a>02234                     {
<a name="l02235"></a>02235                       <span class="keywordflow">if</span> (tab2[k]-1==fac3*ncomp+i)
<a name="l02236"></a>02236                         {
<a name="l02237"></a>02237                           coeff[k]+=signe*aii3_4(i);
<a name="l02238"></a>02238                         }
<a name="l02239"></a>02239                     }
<a name="l02240"></a>02240                   <span class="keywordflow">for</span> (k=tab1[fac1*ncomp+i]-1; k&lt;tab1[fac1*ncomp+1+i]-1; k++)
<a name="l02241"></a>02241                     {
<a name="l02242"></a>02242                       <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02243"></a>02243                         {
<a name="l02244"></a>02244                           coeff[k]+=aii1_2(i);
<a name="l02245"></a>02245                         }
<a name="l02246"></a>02246                       <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02247"></a>02247                         {
<a name="l02248"></a>02248                           coeff[k]-=ajj1_2(i);
<a name="l02249"></a>02249                         }
<a name="l02250"></a>02250                     }
<a name="l02251"></a>02251                   <span class="keywordflow">for</span> (k=tab1[fac2*ncomp+i]-1; k&lt;tab1[fac2*ncomp+1+i]-1; k++)
<a name="l02252"></a>02252                     {
<a name="l02253"></a>02253                       <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02254"></a>02254                         {
<a name="l02255"></a>02255                           coeff[k]-=aii1_2(i);
<a name="l02256"></a>02256                         }
<a name="l02257"></a>02257                       <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02258"></a>02258                         {
<a name="l02259"></a>02259                           coeff[k]+=ajj1_2(i);
<a name="l02260"></a>02260                         }
<a name="l02261"></a>02261                     }
<a name="l02262"></a>02262                 }
<a name="l02263"></a>02263             }
<a name="l02264"></a>02264           <span class="keywordflow">break</span>;
<a name="l02265"></a>02265         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a8ffe822aae0518f507be135120ec23b8">TypeAreteBordVDF::SYM_SYM</a>:
<a name="l02266"></a>02266           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie())
<a name="l02267"></a>02267             {
<a name="l02268"></a>02268               fac1 = Qdm(n_arete,0);
<a name="l02269"></a>02269               fac2 = Qdm(n_arete,1);
<a name="l02270"></a>02270               fac3 = Qdm(n_arete,2);
<a name="l02271"></a>02271               signe = Qdm(n_arete,3);
<a name="l02272"></a>02272               flux_evaluateur.coeffs_arete_symetrie(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02273"></a>02273               <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02274"></a>02274                 {
<a name="l02275"></a>02275                   <span class="keywordflow">for</span> (k=tab1[fac3*ncomp+i]-1; k&lt;tab1[fac3*ncomp+1+i]-1; k++)
<a name="l02276"></a>02276                     {
<a name="l02277"></a>02277                       <span class="keywordflow">if</span> (tab2[k]-1==fac3*ncomp+i)
<a name="l02278"></a>02278                         {
<a name="l02279"></a>02279                           coeff[k]+=signe*aii3_4(i);
<a name="l02280"></a>02280                         }
<a name="l02281"></a>02281                     }
<a name="l02282"></a>02282                 }
<a name="l02283"></a>02283             }
<a name="l02284"></a>02284           <span class="keywordflow">break</span>;
<a name="l02285"></a>02285         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a37713c7b918ab812a24573ce30b2a322">TypeAreteBordVDF::PERIO_PERIO</a>:
<a name="l02286"></a>02286           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_periodicite())
<a name="l02287"></a>02287             {
<a name="l02288"></a>02288               fac1 = Qdm(n_arete,0);
<a name="l02289"></a>02289               fac2 = Qdm(n_arete,1);
<a name="l02290"></a>02290               fac3 = Qdm(n_arete,2);
<a name="l02291"></a>02291               fac4 = Qdm(n_arete,3);
<a name="l02292"></a>02292               flux_evaluateur.coeffs_arete_periodicite(fac3, fac4, fac1, fac2, aii, ajj);
<a name="l02293"></a>02293               <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02294"></a>02294                 {
<a name="l02295"></a>02295                   <span class="keywordflow">for</span> (k=tab1[fac1*ncomp+i]-1; k&lt;tab1[fac1*ncomp+1+i]-1; k++)
<a name="l02296"></a>02296                     {
<a name="l02297"></a>02297                       <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02298"></a>02298                         {
<a name="l02299"></a>02299                           coeff[k]+=aii(i);
<a name="l02300"></a>02300                         }
<a name="l02301"></a>02301                       <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02302"></a>02302                         {
<a name="l02303"></a>02303                           coeff[k]-=ajj(i);
<a name="l02304"></a>02304                         }
<a name="l02305"></a>02305                     }
<a name="l02306"></a>02306                   <span class="keywordflow">for</span> (k=tab1[fac2*ncomp+i]-1; k&lt;tab1[fac2*ncomp+1+i]-1; k++)
<a name="l02307"></a>02307                     {
<a name="l02308"></a>02308                       <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02309"></a>02309                         {
<a name="l02310"></a>02310                           coeff[k]-=aii(i);
<a name="l02311"></a>02311                         }
<a name="l02312"></a>02312                       <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02313"></a>02313                         {
<a name="l02314"></a>02314                           coeff[k]+=ajj(i);
<a name="l02315"></a>02315                         }
<a name="l02316"></a>02316                     }
<a name="l02317"></a>02317                 }
<a name="l02318"></a>02318               flux_evaluateur.coeffs_arete_periodicite(fac1, fac2, fac3, fac4, aii, ajj);
<a name="l02319"></a>02319               <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02320"></a>02320                 {
<a name="l02321"></a>02321                   <span class="keywordflow">for</span> (k=tab1[fac3*ncomp+i]-1; k&lt;tab1[fac3*ncomp+i+1]-1; k++)
<a name="l02322"></a>02322                     {
<a name="l02323"></a>02323                       <span class="keywordflow">if</span> (tab2[k]-1==fac3*ncomp+i)
<a name="l02324"></a>02324                         {
<a name="l02325"></a>02325                           coeff[k]+=aii(i);
<a name="l02326"></a>02326                         }
<a name="l02327"></a>02327                       <span class="keywordflow">if</span> (tab2[k]-1==fac4*ncomp+i)
<a name="l02328"></a>02328                         {
<a name="l02329"></a>02329                           coeff[k]-=ajj(i);
<a name="l02330"></a>02330                         }
<a name="l02331"></a>02331                     }
<a name="l02332"></a>02332                   <span class="keywordflow">for</span> (k=tab1[fac4*ncomp+i]-1; k&lt;tab1[fac4*ncomp+1+i]-1; k++)
<a name="l02333"></a>02333                     {
<a name="l02334"></a>02334                       <span class="keywordflow">if</span> (tab2[k]-1==fac3*ncomp+i)
<a name="l02335"></a>02335                         {
<a name="l02336"></a>02336                           coeff[k]-=aii(i);
<a name="l02337"></a>02337                         }
<a name="l02338"></a>02338                       <span class="keywordflow">if</span> (tab2[k]-1==fac4*ncomp+i)
<a name="l02339"></a>02339                         {
<a name="l02340"></a>02340                           coeff[k]+=ajj(i);
<a name="l02341"></a>02341                         }
<a name="l02342"></a>02342                     }
<a name="l02343"></a>02343                 }
<a name="l02344"></a>02344             }
<a name="l02345"></a>02345           <span class="keywordflow">break</span>;
<a name="l02346"></a>02346         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac0b72d665d0d8eb58248f5c6c65f410c">TypeAreteBordVDF::PAROI_SYM</a>:
<a name="l02347"></a>02347           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie_paroi())
<a name="l02348"></a>02348             {
<a name="l02349"></a>02349               fac1 = Qdm(n_arete,0);
<a name="l02350"></a>02350               fac2 = Qdm(n_arete,1);
<a name="l02351"></a>02351               fac3 = Qdm(n_arete,2);
<a name="l02352"></a>02352               signe = Qdm(n_arete,3);
<a name="l02353"></a>02353               flux_evaluateur.coeffs_arete_symetrie_paroi(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02354"></a>02354               <span class="keywordflow">for</span> (i=0; i&lt;ncomp; i++)
<a name="l02355"></a>02355                 {
<a name="l02356"></a>02356                   <span class="keywordflow">for</span> (k=tab1[fac3*ncomp+i]-1; k&lt;tab1[fac3*ncomp+1+i]-1; k++)
<a name="l02357"></a>02357                     {
<a name="l02358"></a>02358                       <span class="keywordflow">if</span> (tab2[k]-1==fac3*ncomp+i)
<a name="l02359"></a>02359                         {
<a name="l02360"></a>02360                           coeff[k]+=signe*aii3_4(i);
<a name="l02361"></a>02361                         }
<a name="l02362"></a>02362                     }
<a name="l02363"></a>02363                 }
<a name="l02364"></a>02364             }
<a name="l02365"></a>02365           <span class="keywordflow">break</span>;
<a name="l02366"></a>02366         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a460c2f242b0d8c910f37c8940e504707">TypeAreteBordVDF::FLUIDE_SYM</a>:
<a name="l02367"></a>02367           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_symetrie_fluide())
<a name="l02368"></a>02368             {
<a name="l02369"></a>02369               fac1 = Qdm(n_arete,0);
<a name="l02370"></a>02370               fac2 = Qdm(n_arete,1);
<a name="l02371"></a>02371               fac3 = Qdm(n_arete,2);
<a name="l02372"></a>02372               signe = Qdm(n_arete,3);
<a name="l02373"></a>02373               flux_evaluateur.coeffs_arete_symetrie_fluide(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02374"></a>02374               <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02375"></a>02375                 {
<a name="l02376"></a>02376                   <span class="keywordflow">for</span> (k=tab1[fac3*ncomp+i]-1; k&lt;tab1[fac3*ncomp+1+i]-1; k++)
<a name="l02377"></a>02377                     {
<a name="l02378"></a>02378                       <span class="keywordflow">if</span> (tab2[k]-1==fac3*ncomp+i)
<a name="l02379"></a>02379                         {
<a name="l02380"></a>02380                           coeff[k]+=signe*aii3_4(i);
<a name="l02381"></a>02381                         }
<a name="l02382"></a>02382                     }
<a name="l02383"></a>02383                   <span class="keywordflow">for</span> (k=tab1[fac1*ncomp+i]-1; k&lt;tab1[fac1*ncomp+1+i]-1; k++)
<a name="l02384"></a>02384                     {
<a name="l02385"></a>02385                       <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02386"></a>02386                         {
<a name="l02387"></a>02387                           <span class="comment">/* correction de coef[k,i] on fait planter */</span>
<a name="l02388"></a>02388                           assert(0);
<a name="l02389"></a>02389                           exit();
<a name="l02390"></a>02390                           coeff[k]+=aii1_2(i);
<a name="l02391"></a>02391                         }
<a name="l02392"></a>02392                       <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02393"></a>02393                         {
<a name="l02394"></a>02394                           coeff[k]-=ajj1_2(i);
<a name="l02395"></a>02395                         }
<a name="l02396"></a>02396                     }
<a name="l02397"></a>02397                   <span class="keywordflow">for</span> (k=tab1[fac2*ncomp+i]-1; k&lt;tab1[fac2*ncomp+1+i]-1; k++)
<a name="l02398"></a>02398                     {
<a name="l02399"></a>02399                       <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02400"></a>02400                         {
<a name="l02401"></a>02401                           coeff[k]-=aii1_2(i);
<a name="l02402"></a>02402                         }
<a name="l02403"></a>02403                       <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02404"></a>02404                         {
<a name="l02405"></a>02405                           coeff[k]+=ajj1_2(i);
<a name="l02406"></a>02406                         }
<a name="l02407"></a>02407                     }
<a name="l02408"></a>02408                 }
<a name="l02409"></a>02409             }
<a name="l02410"></a>02410           <span class="keywordflow">break</span>;
<a name="l02411"></a>02411         <span class="keywordflow">default</span> :
<a name="l02412"></a>02412           {
<a name="l02413"></a>02413             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l02414"></a>02414             \
<a name="l02415"></a>02415             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l02416"></a>02416             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l02417"></a>02417             exit();
<a name="l02418"></a>02418           }
<a name="l02419"></a>02419         }
<a name="l02420"></a>02420     }
<a name="l02421"></a>02421 }
<a name="l02422"></a>02422 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02423"></a><a class="code" href="classT__It__VDF__Face.html#ad6294531c7bf5bca60496607982ec4ca">02423</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#ad6294531c7bf5bca60496607982ec4ca">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_aretes_coins</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco , <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice )<span class="keyword"> const</span>
<a name="l02424"></a>02424 <span class="keyword"></span>{
<a name="l02425"></a>02425   <span class="keywordtype">int</span> n_arete;
<a name="l02426"></a>02426   <span class="keywordtype">int</span> signe;
<a name="l02427"></a>02427   <span class="keywordtype">int</span> n_type;
<a name="l02428"></a>02428   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l02429"></a>02429   <span class="keywordtype">double</span> aii=0, ajj=0, aii1_2=0, aii3_4=0, ajj1_2;
<a name="l02430"></a>02430   <span class="keywordflow">for</span> (n_arete=premiere_arete_coin; n_arete&lt;derniere_arete_coin; n_arete++)
<a name="l02431"></a>02431     {
<a name="l02432"></a>02432       n_type=type_arete_coin(n_arete-premiere_arete_coin);
<a name="l02433"></a>02433       <span class="keywordflow">switch</span>(n_type)
<a name="l02434"></a>02434         {
<a name="l02435"></a>02435         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aad369ed721afc9b287b160c7a91a284a4">TypeAreteCoinVDF::PERIO_PERIO</a>:
<a name="l02436"></a>02436           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_periodicite())
<a name="l02437"></a>02437             {
<a name="l02438"></a>02438               fac1 = Qdm(n_arete,0);
<a name="l02439"></a>02439               fac2 = Qdm(n_arete,1);
<a name="l02440"></a>02440               fac3 = Qdm(n_arete,2);
<a name="l02441"></a>02441               fac4 = Qdm(n_arete,3);
<a name="l02442"></a>02442               flux_evaluateur.coeffs_arete_periodicite(fac3, fac4, fac1, fac2, aii, ajj);
<a name="l02443"></a>02443               matrice(fac1,fac1)+=aii;
<a name="l02444"></a>02444               matrice(fac1,fac2)-=ajj;
<a name="l02445"></a>02445               matrice(fac2,fac1)-=aii;
<a name="l02446"></a>02446               matrice(fac2,fac2)+=ajj;
<a name="l02447"></a>02447               flux_evaluateur.coeffs_arete_periodicite(fac1, fac2, fac3, fac4, aii, ajj);
<a name="l02448"></a>02448               matrice(fac3,fac3)+=aii;
<a name="l02449"></a>02449               matrice(fac3,fac4)-=ajj;
<a name="l02450"></a>02450               matrice(fac4,fac3)-=aii;
<a name="l02451"></a>02451               matrice(fac4,fac4)+=ajj;
<a name="l02452"></a>02452             }
<a name="l02453"></a>02453           <span class="keywordflow">break</span>;
<a name="l02454"></a>02454         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa5203ea39fbbb2afbe1cac55f4919f144">TypeAreteCoinVDF::PERIO_PAROI</a>:
<a name="l02455"></a>02455           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l02456"></a>02456             {
<a name="l02457"></a>02457               fac1 = Qdm(n_arete,0);
<a name="l02458"></a>02458               fac2 = Qdm(n_arete,1);
<a name="l02459"></a>02459               fac3 = Qdm(n_arete,2);
<a name="l02460"></a>02460               signe = Qdm(n_arete,3);
<a name="l02461"></a>02461               flux_evaluateur.coeffs_arete_paroi(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02462"></a>02462               matrice(fac3,fac3)+=signe*aii3_4;
<a name="l02463"></a>02463             }
<a name="l02464"></a>02464           <span class="keywordflow">break</span>;
<a name="l02465"></a>02465         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa8d6cb48990b19d4ad52f6414b83d72d9">TypeAreteCoinVDF::PAROI_FLUIDE</a>:
<a name="l02466"></a>02466           exit(); <span class="comment">/* pas fini */</span>
<a name="l02467"></a>02467           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l02468"></a>02468             {
<a name="l02469"></a>02469               fac1 = Qdm(n_arete,0);
<a name="l02470"></a>02470               fac2 = Qdm(n_arete,1);
<a name="l02471"></a>02471               fac3 = Qdm(n_arete,2);
<a name="l02472"></a>02472               signe = Qdm(n_arete,3);
<a name="l02473"></a>02473               <span class="comment">/* flux=flux_evaluateur.flux_arete_paroi(inco, fac1, fac2, fac3, signe);  */</span>
<a name="l02474"></a>02474               <span class="comment">/*               resu[fac3]+=signe*flux;        */</span>
<a name="l02475"></a>02475             }
<a name="l02476"></a>02476           <span class="keywordflow">break</span>;
<a name="l02477"></a>02477         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa0f79a01fe58c2a6a8ffde290a2ebc660">TypeAreteCoinVDF::FLUIDE_PAROI</a>:
<a name="l02478"></a>02478           exit(); <span class="comment">/* pas fini */</span>
<a name="l02479"></a>02479           <span class="keywordflow">if</span> (flux_evaluateur.calculer_arete_paroi())
<a name="l02480"></a>02480             {
<a name="l02481"></a>02481               fac1 = Qdm(n_arete,0);
<a name="l02482"></a>02482               fac2 = Qdm(n_arete,1);
<a name="l02483"></a>02483               fac3 = Qdm(n_arete,2);
<a name="l02484"></a>02484               signe = Qdm(n_arete,3);
<a name="l02485"></a>02485               <span class="comment">/* flux=flux_evaluateur.flux_arete_paroi(inco, fac1, fac2, fac3, signe);</span>
<a name="l02486"></a>02486 <span class="comment">                 resu[fac3]+=signe*flux; */</span>
<a name="l02487"></a>02487             }
<a name="l02488"></a>02488           <span class="keywordflow">break</span>;
<a name="l02489"></a>02489         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa42458df5735cf406f85838495b654982">TypeAreteCoinVDF::FLUIDE_FLUIDE</a>:
<a name="l02490"></a>02490           fac1 = Qdm(n_arete,0);
<a name="l02491"></a>02491           fac2 = Qdm(n_arete,1);
<a name="l02492"></a>02492           fac3 = Qdm(n_arete,2);
<a name="l02493"></a>02493           signe = Qdm(n_arete,3);
<a name="l02494"></a>02494           flux_evaluateur.coeffs_arete_coin_fluide(fac1, fac2, fac3, signe, aii1_2, aii3_4, ajj1_2);
<a name="l02495"></a>02495           matrice(fac3,fac3)+=signe*aii3_4;
<a name="l02496"></a>02496           matrice(fac1,fac1)+=aii1_2;
<a name="l02497"></a>02497 <span class="comment">// matrice(fac1,fac2)-=ajj1_2;</span>
<a name="l02498"></a>02498 <span class="comment">// matrice(fac2,fac1)-=aii1_2;</span>
<a name="l02499"></a>02499 <span class="comment">// matrice(fac2,fac2)+=ajj1_2;</span>
<a name="l02500"></a>02500           <span class="keywordflow">break</span>;
<a name="l02501"></a>02501         <span class="keywordflow">default</span> :
<a name="l02502"></a>02502           <span class="keywordflow">break</span>;
<a name="l02503"></a>02503         }
<a name="l02504"></a>02504     }
<a name="l02505"></a>02505 }
<a name="l02506"></a>02506 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02507"></a><a class="code" href="classT__It__VDF__Face.html#a00565832c23d124ea63ed5d23d30a1eb">02507</a> <span class="keywordtype">void</span>   <a class="code" href="classT__It__VDF__Face.html#ad6294531c7bf5bca60496607982ec4ca">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_aretes_coins</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp;,<span class="keywordtype">int</span> )<span class="keyword"> const</span>
<a name="l02508"></a>02508 <span class="keyword"></span>{
<a name="l02509"></a>02509   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;non code &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02510"></a>02510   exit();
<a name="l02511"></a>02511 }
<a name="l02512"></a>02512 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02513"></a><a class="code" href="classT__It__VDF__Face.html#a16c609e6369722487976c95dc411aaea">02513</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a16c609e6369722487976c95dc411aaea">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_aretes_internes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,
<a name="l02514"></a>02514                                                                  <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice)<span class="keyword"> const</span>
<a name="l02515"></a>02515 <span class="keyword"></span>{
<a name="l02516"></a>02516   <span class="keywordflow">if</span>(!flux_evaluateur.calculer_arete_interne())
<a name="l02517"></a>02517     <span class="keywordflow">return</span>;
<a name="l02518"></a>02518   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l02519"></a>02519   <span class="keywordtype">int</span> n_arete;
<a name="l02520"></a>02520   <span class="keywordtype">double</span> aii=0, ajj=0;
<a name="l02521"></a>02521   <span class="keywordflow">for</span> (n_arete=premiere_arete_interne; n_arete&lt;derniere_arete_interne; n_arete++)
<a name="l02522"></a>02522     {
<a name="l02523"></a>02523       fac1=Qdm(n_arete,0);
<a name="l02524"></a>02524       fac2=Qdm(n_arete,1);
<a name="l02525"></a>02525       fac3=Qdm(n_arete,2);
<a name="l02526"></a>02526       fac4=Qdm(n_arete,3);
<a name="l02527"></a>02527       flux_evaluateur.coeffs_arete_interne(fac3, fac4, fac1, fac2, aii, ajj);
<a name="l02528"></a>02528       matrice(fac1,fac1)+=aii;
<a name="l02529"></a>02529       matrice(fac1,fac2)-=ajj;
<a name="l02530"></a>02530       matrice(fac2,fac1)-=aii;
<a name="l02531"></a>02531       matrice(fac2,fac2)+=ajj;
<a name="l02532"></a>02532       flux_evaluateur.coeffs_arete_interne(fac1, fac2, fac3, fac4, aii, ajj);
<a name="l02533"></a>02533       matrice(fac3,fac3)+=aii;
<a name="l02534"></a>02534       matrice(fac3,fac4)-=ajj;
<a name="l02535"></a>02535       matrice(fac4,fac3)-=aii;
<a name="l02536"></a>02536       matrice(fac4,fac4)+=ajj;
<a name="l02537"></a>02537     }
<a name="l02538"></a>02538 }
<a name="l02539"></a>02539 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02540"></a><a class="code" href="classT__It__VDF__Face.html#aaf0627ad2722954bd1c948785a46aa64">02540</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a16c609e6369722487976c95dc411aaea">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_aretes_internes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,
<a name="l02541"></a>02541                                                                  <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l02542"></a>02542 <span class="keyword"></span>{
<a name="l02543"></a>02543   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l02544"></a>02544   <a class="code" href="classDoubleVect.html">DoubleVect</a> aii(ncomp), ajj(ncomp);
<a name="l02545"></a>02545   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = matrice.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l02546"></a>02546   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = matrice.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l02547"></a>02547   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l02548"></a>02548   <span class="keywordtype">int</span> n_arete,k,i;
<a name="l02549"></a>02549   <span class="keywordflow">for</span> (n_arete=premiere_arete_interne; n_arete&lt;derniere_arete_interne; n_arete++)
<a name="l02550"></a>02550     {
<a name="l02551"></a>02551       fac1=Qdm(n_arete,0);
<a name="l02552"></a>02552       fac2=Qdm(n_arete,1);
<a name="l02553"></a>02553       fac3=Qdm(n_arete,2);
<a name="l02554"></a>02554       fac4=Qdm(n_arete,3);
<a name="l02555"></a>02555       flux_evaluateur.coeffs_arete_interne(fac3, fac4, fac1, fac2, aii, ajj);
<a name="l02556"></a>02556       <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02557"></a>02557         {
<a name="l02558"></a>02558           <span class="keywordflow">for</span> (k=tab1[fac1*ncomp+i]-1; k&lt;tab1[fac1*ncomp+1+i]-1; k++)
<a name="l02559"></a>02559             {
<a name="l02560"></a>02560               <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02561"></a>02561                 {
<a name="l02562"></a>02562                   coeff[k]+=aii(i);
<a name="l02563"></a>02563                 }
<a name="l02564"></a>02564               <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02565"></a>02565                 {
<a name="l02566"></a>02566                   coeff[k]-=ajj(i);
<a name="l02567"></a>02567                 }
<a name="l02568"></a>02568             }
<a name="l02569"></a>02569           <span class="keywordflow">for</span> (k=tab1[fac2*ncomp+i]-1; k&lt;tab1[fac2*ncomp+1+i]-1; k++)
<a name="l02570"></a>02570             {
<a name="l02571"></a>02571               <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02572"></a>02572                 {
<a name="l02573"></a>02573                   coeff[k]-=aii(i);
<a name="l02574"></a>02574                 }
<a name="l02575"></a>02575               <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02576"></a>02576                 {
<a name="l02577"></a>02577                   coeff[k]+=ajj(i);
<a name="l02578"></a>02578                 }
<a name="l02579"></a>02579             }
<a name="l02580"></a>02580         }
<a name="l02581"></a>02581       flux_evaluateur.coeffs_arete_interne(fac1, fac2, fac3, fac4, aii, ajj);
<a name="l02582"></a>02582       <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02583"></a>02583         {
<a name="l02584"></a>02584           <span class="keywordflow">for</span> (k=tab1[fac3*ncomp+i]-1; k&lt;tab1[fac3*ncomp+1+i]-1; k++)
<a name="l02585"></a>02585             {
<a name="l02586"></a>02586               <span class="keywordflow">if</span> (tab2[k]-1==fac3*ncomp+i)
<a name="l02587"></a>02587                 {
<a name="l02588"></a>02588                   coeff[k]+=aii(i);
<a name="l02589"></a>02589                 }
<a name="l02590"></a>02590               <span class="keywordflow">if</span> (tab2[k]-1==fac4*ncomp+i)
<a name="l02591"></a>02591                 {
<a name="l02592"></a>02592                   coeff[k]-=ajj(i);
<a name="l02593"></a>02593                 }
<a name="l02594"></a>02594             }
<a name="l02595"></a>02595           <span class="keywordflow">for</span> (k=tab1[fac4*ncomp+i]-1; k&lt;tab1[fac4*ncomp+1+i]-1; k++)
<a name="l02596"></a>02596             {
<a name="l02597"></a>02597               <span class="keywordflow">if</span> (tab2[k]-1==fac3*ncomp+i)
<a name="l02598"></a>02598                 {
<a name="l02599"></a>02599                   coeff[k]-=aii(i);
<a name="l02600"></a>02600                 }
<a name="l02601"></a>02601               <span class="keywordflow">if</span> (tab2[k]-1==fac4*ncomp+i)
<a name="l02602"></a>02602                 {
<a name="l02603"></a>02603                   coeff[k]+=ajj(i);
<a name="l02604"></a>02604                 }
<a name="l02605"></a>02605             }
<a name="l02606"></a>02606         }
<a name="l02607"></a>02607     }
<a name="l02608"></a>02608 }
<a name="l02609"></a>02609 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02610"></a><a class="code" href="classT__It__VDF__Face.html#a50552913434ed4b79072869e0127d35b">02610</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a50552913434ed4b79072869e0127d35b">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_aretes_mixtes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,
<a name="l02611"></a>02611                                                                <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice)<span class="keyword"> const</span>
<a name="l02612"></a>02612 <span class="keyword"></span>{
<a name="l02613"></a>02613   <span class="keywordflow">if</span>(!flux_evaluateur.calculer_arete_mixte())
<a name="l02614"></a>02614     <span class="keywordflow">return</span> ;
<a name="l02615"></a>02615   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l02616"></a>02616   <span class="keywordtype">double</span> aii=0, ajj=0;
<a name="l02617"></a>02617   <span class="keywordtype">int</span> n_arete;
<a name="l02618"></a>02618   <span class="keywordflow">for</span> (n_arete=premiere_arete_mixte; n_arete&lt;derniere_arete_mixte; n_arete++)
<a name="l02619"></a>02619     {
<a name="l02620"></a>02620       fac1=Qdm(n_arete,0);
<a name="l02621"></a>02621       fac2=Qdm(n_arete,1);
<a name="l02622"></a>02622       fac3=Qdm(n_arete,2);
<a name="l02623"></a>02623       fac4=Qdm(n_arete,3);
<a name="l02624"></a>02624       flux_evaluateur.coeffs_arete_mixte(fac1, fac2, fac3, fac4, aii, ajj);
<a name="l02625"></a>02625       matrice(fac3,fac3)+=aii;
<a name="l02626"></a>02626       matrice(fac3,fac4)-=ajj;
<a name="l02627"></a>02627       matrice(fac4,fac3)-=aii;
<a name="l02628"></a>02628       matrice(fac4,fac4)+=ajj;
<a name="l02629"></a>02629       flux_evaluateur.coeffs_arete_mixte(fac3, fac4, fac1, fac2, aii, ajj);
<a name="l02630"></a>02630       matrice(fac1,fac1)+=aii;
<a name="l02631"></a>02631       matrice(fac1,fac2)-=ajj;
<a name="l02632"></a>02632       matrice(fac2,fac1)-=aii;
<a name="l02633"></a>02633       matrice(fac2,fac2)+=ajj;
<a name="l02634"></a>02634     }
<a name="l02635"></a>02635 }
<a name="l02636"></a>02636 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02637"></a><a class="code" href="classT__It__VDF__Face.html#a3601ddbb94f5a65819aa24292b5e76ea">02637</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a50552913434ed4b79072869e0127d35b">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_aretes_mixtes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,
<a name="l02638"></a>02638                                                                <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l02639"></a>02639 <span class="keyword"></span>{
<a name="l02640"></a>02640   <span class="keywordtype">int</span> fac1, fac2, fac3, fac4;
<a name="l02641"></a>02641   <span class="keywordtype">int</span> n_arete,k,i;
<a name="l02642"></a>02642   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = matrice.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l02643"></a>02643   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = matrice.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l02644"></a>02644   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l02645"></a>02645   <a class="code" href="classDoubleVect.html">DoubleVect</a> aii(ncomp), ajj(ncomp);
<a name="l02646"></a>02646   <span class="keywordflow">for</span> (n_arete=premiere_arete_mixte; n_arete&lt;derniere_arete_mixte; n_arete++)
<a name="l02647"></a>02647     {
<a name="l02648"></a>02648       fac1=Qdm(n_arete,0);
<a name="l02649"></a>02649       fac2=Qdm(n_arete,1);
<a name="l02650"></a>02650       fac3=Qdm(n_arete,2);
<a name="l02651"></a>02651       fac4=Qdm(n_arete,3);
<a name="l02652"></a>02652       flux_evaluateur.coeffs_arete_mixte(fac1, fac2, fac3, fac4, aii, ajj);
<a name="l02653"></a>02653       <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02654"></a>02654         {
<a name="l02655"></a>02655           <span class="keywordflow">for</span> (k=tab1[fac1*ncomp+i]-1; k&lt;tab1[fac1*ncomp+1+i]-1; k++)
<a name="l02656"></a>02656             {
<a name="l02657"></a>02657               <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02658"></a>02658                 {
<a name="l02659"></a>02659                   coeff[k]+=aii(i);
<a name="l02660"></a>02660                 }
<a name="l02661"></a>02661               <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02662"></a>02662                 {
<a name="l02663"></a>02663                   coeff[k]-=ajj(i);
<a name="l02664"></a>02664                 }
<a name="l02665"></a>02665             }
<a name="l02666"></a>02666           <span class="keywordflow">for</span> (k=tab1[fac2*ncomp+i]-1; k&lt;tab1[fac2*ncomp+1+i]-1; k++)
<a name="l02667"></a>02667             {
<a name="l02668"></a>02668               <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02669"></a>02669                 {
<a name="l02670"></a>02670                   coeff[k]-=aii(i);
<a name="l02671"></a>02671                 }
<a name="l02672"></a>02672               <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02673"></a>02673                 {
<a name="l02674"></a>02674                   coeff[k]+=ajj(i);
<a name="l02675"></a>02675                 }
<a name="l02676"></a>02676             }
<a name="l02677"></a>02677         }
<a name="l02678"></a>02678       flux_evaluateur.coeffs_arete_mixte(fac3, fac4, fac1, fac2, aii, ajj);
<a name="l02679"></a>02679       <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02680"></a>02680         {
<a name="l02681"></a>02681           <span class="keywordflow">for</span> (k=tab1[fac3*ncomp+i]-1; k&lt;tab1[fac3*ncomp+1+i]-1; k++)
<a name="l02682"></a>02682             {
<a name="l02683"></a>02683               <span class="keywordflow">if</span> (tab2[k]-1==fac3*ncomp+i)
<a name="l02684"></a>02684                 {
<a name="l02685"></a>02685                   coeff[k]+=aii(i);
<a name="l02686"></a>02686                 }
<a name="l02687"></a>02687               <span class="keywordflow">if</span> (tab2[k]-1==fac4*ncomp+i)
<a name="l02688"></a>02688                 {
<a name="l02689"></a>02689                   coeff[k*i]-=ajj(i);
<a name="l02690"></a>02690                 }
<a name="l02691"></a>02691             }
<a name="l02692"></a>02692           <span class="keywordflow">for</span> (k=tab1[fac4*ncomp+i]-1; k&lt;tab1[fac4*ncomp+1+i]-1; k++)
<a name="l02693"></a>02693             {
<a name="l02694"></a>02694               <span class="keywordflow">if</span> (tab2[k]-1==fac3*ncomp+i)
<a name="l02695"></a>02695                 {
<a name="l02696"></a>02696                   coeff[k]-=aii(i);
<a name="l02697"></a>02697                 }
<a name="l02698"></a>02698               <span class="keywordflow">if</span> (tab2[k]-1==fac4*ncomp+i)
<a name="l02699"></a>02699                 {
<a name="l02700"></a>02700                   coeff[k]+=ajj(i);
<a name="l02701"></a>02701                 }
<a name="l02702"></a>02702             }
<a name="l02703"></a>02703         }
<a name="l02704"></a>02704     }
<a name="l02705"></a>02705 }
<a name="l02706"></a>02706 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02707"></a><a class="code" href="classT__It__VDF__Face.html#a8de510613a09415a2c12a14ace715656">02707</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a8de510613a09415a2c12a14ace715656">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_fa7_sortie_libre</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice )<span class="keyword"> const</span>
<a name="l02708"></a>02708 <span class="keyword"></span>{
<a name="l02709"></a>02709   <span class="keywordtype">int</span> num_cl;
<a name="l02710"></a>02710   <span class="keywordtype">int</span> ndeb, nfin,k;
<a name="l02711"></a>02711   <span class="keywordtype">double</span> aii=0, ajj=0;
<a name="l02712"></a>02712   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = matrice.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l02713"></a>02713   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = matrice.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l02714"></a>02714   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l02715"></a>02715   <span class="keywordtype">int</span> face;
<a name="l02716"></a>02716   <span class="keywordtype">int</span> nb_front_Cl=la_zone-&gt;nb_front_Cl();
<a name="l02717"></a>02717   <span class="keywordflow">for</span> (num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l02718"></a>02718     {
<a name="l02719"></a>02719       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl-&gt;les_conditions_limites(num_cl);
<a name="l02720"></a>02720       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l02721"></a>02721       ndeb = frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l02722"></a>02722       nfin = ndeb + frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l02723"></a>02723       <span class="keywordflow">switch</span>(type_cl(la_cl))
<a name="l02724"></a>02724         {
<a name="l02725"></a>02725         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac4317ef27513bbab3cd0ccfd0d9ed199" title="Neumann_sortie_libre ou derivees.">sortie_libre</a> :
<a name="l02726"></a>02726           <span class="keywordflow">if</span> (flux_evaluateur.calculer_fa7_sortie_libre())
<a name="l02727"></a>02727             {
<a name="l02728"></a>02728               <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; cl =(<span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp;) (la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l02729"></a>02729               <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l02730"></a>02730                 {
<a name="l02731"></a>02731                   flux_evaluateur.coeffs_fa7_sortie_libre(face, cl, aii, ajj);
<a name="l02732"></a>02732                   <span class="keywordflow">if</span> ( (elem(face,0)) &gt; -1)
<a name="l02733"></a>02733                     {
<a name="l02734"></a>02734                       <span class="keywordflow">for</span> (k=tab1[face]-1; k&lt;tab1[face+1]-1; k++)
<a name="l02735"></a>02735                         {
<a name="l02736"></a>02736                           <span class="keywordflow">if</span> (tab2[k]-1==face)
<a name="l02737"></a>02737                             coeff[k]+=aii;
<a name="l02738"></a>02738                         }
<a name="l02739"></a>02739                     }
<a name="l02740"></a>02740                   <span class="keywordflow">if</span> ( (elem(face,1)) &gt; -1)
<a name="l02741"></a>02741                     {
<a name="l02742"></a>02742                       <span class="keywordflow">for</span> (k=tab1[face]-1; k&lt;tab1[face+1]-1; k++)
<a name="l02743"></a>02743                         {
<a name="l02744"></a>02744                           <span class="keywordflow">if</span> (tab2[k]-1==face)
<a name="l02745"></a>02745                             coeff[k]+=ajj;
<a name="l02746"></a>02746                         }
<a name="l02747"></a>02747                     }
<a name="l02748"></a>02748                 }
<a name="l02749"></a>02749             }
<a name="l02750"></a>02750           <span class="keywordflow">break</span>;
<a name="l02751"></a>02751         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac938491055e13993f3eed68c989f90b0" title="Symetrie.">symetrie</a> :
<a name="l02752"></a>02752           <span class="keywordflow">break</span>;
<a name="l02753"></a>02753         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a594fd60a4576f47654eed7df53dee9be" title="Dirichlet_entree_fluide.">entree_fluide</a> :
<a name="l02754"></a>02754           <span class="keywordflow">break</span>;
<a name="l02755"></a>02755         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a497d92e00f36c1c7ec874c0a318db91e" title="Dirichlet_paroi_fixe.">paroi_fixe</a> :
<a name="l02756"></a>02756           <span class="keywordflow">break</span>;
<a name="l02757"></a>02757         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649acdd1bf461cb105b93d5a9b003ce33141" title="Dirichlet_paroi_defilante.">paroi_defilante</a> :
<a name="l02758"></a>02758           <span class="keywordflow">break</span>;
<a name="l02759"></a>02759         <span class="keywordflow">case</span> <a class="code" href="classparoi__adiabatique.html">paroi_adiabatique</a> :
<a name="l02760"></a>02760           <span class="keywordflow">break</span>;
<a name="l02761"></a>02761         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649af695f3ba17490e07dc3259c85875d8d6" title="Neumann_paroi.">paroi</a>:
<a name="l02762"></a>02762           <span class="keywordflow">break</span>;
<a name="l02763"></a>02763         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a38f997f881a13a46f2d06012162cf833" title="Echange_externe_impose.">echange_externe_impose</a> :
<a name="l02764"></a>02764           <span class="keywordflow">break</span>;
<a name="l02765"></a>02765         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a9201b83c6fe44d3928abbe5f73364323" title="Echange_global_impose.">echange_global_impose</a> :
<a name="l02766"></a>02766           <span class="keywordflow">break</span>;
<a name="l02767"></a>02767         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ab83c671c148d8664c5c87f343d2ab9fd" title="periodique">periodique</a> :
<a name="l02768"></a>02768           <span class="keywordflow">break</span>;
<a name="l02769"></a>02769         <span class="keywordflow">default</span> :
<a name="l02770"></a>02770           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On ne reconnait pas la condition limite : &quot;</span> &lt;&lt; la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>();
<a name="l02771"></a>02771           exit();
<a name="l02772"></a>02772           <span class="keywordflow">break</span>;
<a name="l02773"></a>02773         }
<a name="l02774"></a>02774     }
<a name="l02775"></a>02775 }
<a name="l02776"></a>02776 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02777"></a><a class="code" href="classT__It__VDF__Face.html#af4edaa6430cc9e16a1c5226100f1d151">02777</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a8de510613a09415a2c12a14ace715656">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_fa7_sortie_libre</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice , <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l02778"></a>02778 <span class="keyword"></span>{
<a name="l02779"></a>02779   <span class="keywordtype">int</span> num_cl;
<a name="l02780"></a>02780   <span class="keywordtype">int</span> ndeb, nfin;
<a name="l02781"></a>02781   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = matrice.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l02782"></a>02782   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = matrice.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l02783"></a>02783   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l02784"></a>02784   <a class="code" href="classDoubleVect.html">DoubleVect</a> aii(ncomp), ajj(ncomp);
<a name="l02785"></a>02785   <span class="keywordtype">int</span> face,k,i;
<a name="l02786"></a>02786   <span class="keywordtype">int</span> nb_front_Cl=la_zone-&gt;nb_front_Cl();
<a name="l02787"></a>02787   <span class="keywordflow">for</span> (num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l02788"></a>02788     {
<a name="l02789"></a>02789       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl-&gt;les_conditions_limites(num_cl);
<a name="l02790"></a>02790       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l02791"></a>02791       ndeb = frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l02792"></a>02792       nfin = ndeb + frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l02793"></a>02793       <span class="keywordflow">switch</span>(type_cl(la_cl))
<a name="l02794"></a>02794         {
<a name="l02795"></a>02795         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac4317ef27513bbab3cd0ccfd0d9ed199" title="Neumann_sortie_libre ou derivees.">sortie_libre</a> :
<a name="l02796"></a>02796           <span class="keywordflow">if</span> (flux_evaluateur.calculer_fa7_sortie_libre())
<a name="l02797"></a>02797             {
<a name="l02798"></a>02798               <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; cl =(<span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp;) (la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l02799"></a>02799               <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l02800"></a>02800                 {
<a name="l02801"></a>02801                   flux_evaluateur.coeffs_fa7_sortie_libre(face, cl, aii, ajj);
<a name="l02802"></a>02802                   <span class="keywordflow">if</span> ( (elem(face,0)) &gt; -1)
<a name="l02803"></a>02803                     {
<a name="l02804"></a>02804                       <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02805"></a>02805                         {
<a name="l02806"></a>02806                           <span class="keywordflow">for</span> (k=tab1[face*ncomp+i]-1; k&lt;tab1[face*ncomp+1+i]-1; k++)
<a name="l02807"></a>02807                             {
<a name="l02808"></a>02808                               <span class="keywordflow">if</span> (tab2[k]-1==face*ncomp+i)
<a name="l02809"></a>02809                                 {
<a name="l02810"></a>02810                                   coeff[k]+=aii(i);
<a name="l02811"></a>02811                                 }
<a name="l02812"></a>02812                             }
<a name="l02813"></a>02813                         }
<a name="l02814"></a>02814                     }
<a name="l02815"></a>02815                   <span class="keywordflow">if</span> ( (elem(face,1)) &gt; -1)
<a name="l02816"></a>02816                     {
<a name="l02817"></a>02817                       <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02818"></a>02818                         {
<a name="l02819"></a>02819                           <span class="keywordflow">for</span> (k=tab1[face*ncomp+i]-1; k&lt;tab1[face*ncomp+1+i]-1; k++)
<a name="l02820"></a>02820                             {
<a name="l02821"></a>02821                               <span class="keywordflow">if</span> (tab2[k]-1==face*ncomp+i)
<a name="l02822"></a>02822                                 {
<a name="l02823"></a>02823                                   coeff[k]+=ajj(i);
<a name="l02824"></a>02824                                 }
<a name="l02825"></a>02825                             }
<a name="l02826"></a>02826                         }
<a name="l02827"></a>02827                     }
<a name="l02828"></a>02828                 }
<a name="l02829"></a>02829             }
<a name="l02830"></a>02830           <span class="keywordflow">break</span>;
<a name="l02831"></a>02831         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac938491055e13993f3eed68c989f90b0" title="Symetrie.">symetrie</a> :
<a name="l02832"></a>02832           <span class="keywordflow">break</span>;
<a name="l02833"></a>02833         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a594fd60a4576f47654eed7df53dee9be" title="Dirichlet_entree_fluide.">entree_fluide</a> :
<a name="l02834"></a>02834           <span class="keywordflow">break</span>;
<a name="l02835"></a>02835         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a497d92e00f36c1c7ec874c0a318db91e" title="Dirichlet_paroi_fixe.">paroi_fixe</a> :
<a name="l02836"></a>02836           <span class="keywordflow">break</span>;
<a name="l02837"></a>02837         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649acdd1bf461cb105b93d5a9b003ce33141" title="Dirichlet_paroi_defilante.">paroi_defilante</a> :
<a name="l02838"></a>02838           <span class="keywordflow">break</span>;
<a name="l02839"></a>02839         <span class="keywordflow">case</span> <a class="code" href="classparoi__adiabatique.html">paroi_adiabatique</a> :
<a name="l02840"></a>02840           <span class="keywordflow">break</span>;
<a name="l02841"></a>02841         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649af695f3ba17490e07dc3259c85875d8d6" title="Neumann_paroi.">paroi</a> :
<a name="l02842"></a>02842           <span class="keywordflow">break</span>;
<a name="l02843"></a>02843         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a38f997f881a13a46f2d06012162cf833" title="Echange_externe_impose.">echange_externe_impose</a> :
<a name="l02844"></a>02844           <span class="keywordflow">break</span>;
<a name="l02845"></a>02845         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649a9201b83c6fe44d3928abbe5f73364323" title="Echange_global_impose.">echange_global_impose</a> :
<a name="l02846"></a>02846           <span class="keywordflow">break</span>;
<a name="l02847"></a>02847         <span class="keywordflow">case</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ab83c671c148d8664c5c87f343d2ab9fd" title="periodique">periodique</a> :
<a name="l02848"></a>02848           <span class="keywordflow">break</span>;
<a name="l02849"></a>02849         <span class="keywordflow">default</span> :
<a name="l02850"></a>02850           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On ne reconnait pas la condition limite : &quot;</span> &lt;&lt; la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>();
<a name="l02851"></a>02851           exit();
<a name="l02852"></a>02852           <span class="keywordflow">break</span>;
<a name="l02853"></a>02853         }
<a name="l02854"></a>02854     }
<a name="l02855"></a>02855 }
<a name="l02856"></a>02856 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02857"></a><a class="code" href="classT__It__VDF__Face.html#a8fa47245e0a3dd72517feecf5ebc240d">02857</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a8fa47245e0a3dd72517feecf5ebc240d">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_fa7_elem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice)<span class="keyword"> const</span>
<a name="l02858"></a>02858 <span class="keyword"></span>{
<a name="l02859"></a>02859   <span class="keywordtype">int</span> fa7, fac1, fac2;
<a name="l02860"></a>02860   <span class="keywordtype">int</span> num_elem=0;
<a name="l02861"></a>02861   <span class="keywordtype">double</span> aii=0, ajj=0;
<a name="l02862"></a>02862   <span class="keywordflow">for</span>( ; num_elem&lt;nb_elem; num_elem++)
<a name="l02863"></a>02863     {
<a name="l02864"></a>02864       <span class="keywordflow">for</span> (fa7=0; fa7&lt;dimension; fa7++)
<a name="l02865"></a>02865         {
<a name="l02866"></a>02866           fac1=elem_faces(num_elem,fa7);
<a name="l02867"></a>02867           fac2=elem_faces(num_elem,fa7+dimension);
<a name="l02868"></a>02868           flux_evaluateur.coeffs_fa7_elem(num_elem, fac1, fac2, aii, ajj);
<a name="l02869"></a>02869           matrice(fac1,fac1)+=aii;
<a name="l02870"></a>02870           matrice(fac1,fac2)-=ajj;
<a name="l02871"></a>02871           matrice(fac2,fac1)-=aii;
<a name="l02872"></a>02872           matrice(fac2,fac2)+=ajj;
<a name="l02873"></a>02873         }
<a name="l02874"></a>02874     }
<a name="l02875"></a>02875   corriger_coeffs_fa7_elem_periodicite(inco, matrice);
<a name="l02876"></a>02876 }
<a name="l02877"></a>02877 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02878"></a><a class="code" href="classT__It__VDF__Face.html#a870112c1658bc7ac958fd603af4018d8">02878</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a8fa47245e0a3dd72517feecf5ebc240d">T_It_VDF_Face&lt;_TYPE_&gt;::ajouter_contribution_fa7_elem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice, <span class="keywordtype">int</span> ncomp )<span class="keyword"> const</span>
<a name="l02879"></a>02879 <span class="keyword"></span>{
<a name="l02880"></a>02880   <span class="keywordtype">int</span> fa7, fac1, fac2;
<a name="l02881"></a>02881   <span class="keywordtype">int</span> num_elem;
<a name="l02882"></a>02882   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = matrice.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l02883"></a>02883   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = matrice.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l02884"></a>02884   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l02885"></a>02885   <a class="code" href="classDoubleVect.html">DoubleVect</a> aii(ncomp), ajj(ncomp);
<a name="l02886"></a>02886   <span class="keywordtype">int</span> k,i;
<a name="l02887"></a>02887   <span class="keywordflow">for</span>(num_elem=0; num_elem&lt;nb_elem; num_elem++)
<a name="l02888"></a>02888     {
<a name="l02889"></a>02889       <span class="keywordflow">for</span> (fa7=0; fa7&lt;dimension; fa7++)
<a name="l02890"></a>02890         {
<a name="l02891"></a>02891           fac1=elem_faces(num_elem,fa7);
<a name="l02892"></a>02892           fac2=elem_faces(num_elem,fa7+dimension);
<a name="l02893"></a>02893           flux_evaluateur.coeffs_fa7_elem(num_elem, fac1, fac2, aii, ajj);
<a name="l02894"></a>02894           <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l02895"></a>02895             {
<a name="l02896"></a>02896               <span class="keywordflow">for</span> (k=tab1[fac1*ncomp+i]-1; k&lt;tab1[fac1*ncomp+1+i]-1; k++)
<a name="l02897"></a>02897                 {
<a name="l02898"></a>02898                   <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02899"></a>02899                     {
<a name="l02900"></a>02900                       coeff[k]+=aii(i);
<a name="l02901"></a>02901                     }
<a name="l02902"></a>02902                   <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02903"></a>02903                     {
<a name="l02904"></a>02904                       coeff[k]-=ajj(i);
<a name="l02905"></a>02905                     }
<a name="l02906"></a>02906                 }
<a name="l02907"></a>02907               <span class="keywordflow">for</span> (k=tab1[fac2*ncomp+i]-1; k&lt;tab1[fac2*ncomp+1+i]-1; k++)
<a name="l02908"></a>02908                 {
<a name="l02909"></a>02909                   <span class="keywordflow">if</span> (tab2[k]-1==fac1*ncomp+i)
<a name="l02910"></a>02910                     {
<a name="l02911"></a>02911                       coeff[k]-=aii(i);
<a name="l02912"></a>02912                     }
<a name="l02913"></a>02913                   <span class="keywordflow">if</span> (tab2[k]-1==fac2*ncomp+i)
<a name="l02914"></a>02914                     {
<a name="l02915"></a>02915                       coeff[k]+=ajj(i);
<a name="l02916"></a>02916                     }
<a name="l02917"></a>02917                 }
<a name="l02918"></a>02918             }
<a name="l02919"></a>02919         }
<a name="l02920"></a>02920     }
<a name="l02921"></a>02921   corriger_coeffs_fa7_elem_periodicite(inco, matrice, ncomp);
<a name="l02922"></a>02922 }
<a name="l02923"></a>02923 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02924"></a><a class="code" href="classT__It__VDF__Face.html#a033048035c9fcd6b098a675980fb0ab5">02924</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a033048035c9fcd6b098a675980fb0ab5">T_It_VDF_Face&lt;_TYPE_&gt;::corriger_coeffs_fa7_elem_periodicite</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice)<span class="keyword"> const</span>
<a name="l02925"></a>02925 <span class="keyword"></span>{
<a name="l02926"></a>02926   <span class="keywordtype">int</span> nb_front_Cl=la_zone-&gt;nb_front_Cl();
<a name="l02927"></a>02927   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l02928"></a>02928     {
<a name="l02929"></a>02929       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl-&gt;les_conditions_limites(num_cl);
<a name="l02930"></a>02930       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l02931"></a>02931         {
<a name="l02932"></a>02932           <span class="keywordtype">int</span> ndeb,nfin,elem1,elem2,num_elem,ori;
<a name="l02933"></a>02933           <span class="keywordtype">int</span> face,fac1,fac2,signe;
<a name="l02934"></a>02934           <span class="keywordtype">double</span> aii=0, ajj=0;
<a name="l02935"></a>02935           <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l02936"></a>02936           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl_perio.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l02937"></a>02937           ndeb = le_bord.num_premiere_face();
<a name="l02938"></a>02938           nfin = ndeb + le_bord.nb_faces();
<a name="l02939"></a>02939           <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l02940"></a>02940             {
<a name="l02941"></a>02941               elem1 = elem(face,0);
<a name="l02942"></a>02942               elem2 = elem(face,1);
<a name="l02943"></a>02943               ori = orientation(face);
<a name="l02944"></a>02944               <span class="keywordflow">if</span> ( (face == elem_faces(elem1,ori)) || (face == elem_faces(elem1,ori+dimension)) )
<a name="l02945"></a>02945                 {
<a name="l02946"></a>02946                   num_elem = elem2;
<a name="l02947"></a>02947                   signe = 1;
<a name="l02948"></a>02948                 }
<a name="l02949"></a>02949               <span class="keywordflow">else</span>
<a name="l02950"></a>02950                 {
<a name="l02951"></a>02951                   num_elem = elem1;
<a name="l02952"></a>02952                   signe = -1;
<a name="l02953"></a>02953                 }
<a name="l02954"></a>02954               fac1 = elem_faces(num_elem,ori);
<a name="l02955"></a>02955               fac2 = elem_faces(num_elem,ori+dimension);
<a name="l02956"></a>02956               flux_evaluateur.coeffs_fa7_elem(num_elem, fac1, fac2, aii, ajj);
<a name="l02957"></a>02957               {
<a name="l02958"></a>02958                 <span class="keywordflow">if</span> (signe&gt;0)
<a name="l02959"></a>02959                   {
<a name="l02960"></a>02960                     <span class="comment">/* on a oublie a droite  la contribution de la gche */</span>
<a name="l02961"></a>02961                     matrice(face,face)+=aii ;
<a name="l02962"></a>02962                     matrice(face,fac2)-=ajj;
<a name="l02963"></a>02963                   }
<a name="l02964"></a>02964                 <span class="keywordflow">else</span>      <span class="comment">/* on a oublie a gauche  la contribution de la droite */</span>
<a name="l02965"></a>02965                   {
<a name="l02966"></a>02966                     matrice(face,fac1)-=aii; ;
<a name="l02967"></a>02967                     matrice(face,face)+=ajj;
<a name="l02968"></a>02968                   }
<a name="l02969"></a>02969               }
<a name="l02970"></a>02970             }
<a name="l02971"></a>02971         }
<a name="l02972"></a>02972     }
<a name="l02973"></a>02973 }
<a name="l02974"></a>02974 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _TYPE_&gt;
<a name="l02975"></a><a class="code" href="classT__It__VDF__Face.html#a7385b2ef63f2f6902d469baf2e5320be">02975</a> <span class="keywordtype">void</span> <a class="code" href="classT__It__VDF__Face.html#a033048035c9fcd6b098a675980fb0ab5">T_It_VDF_Face&lt;_TYPE_&gt;::corriger_coeffs_fa7_elem_periodicite</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l02976"></a>02976 <span class="keyword"></span>{
<a name="l02977"></a>02977   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; la_zcl_vdf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>,la_zcl.valeur());
<a name="l02978"></a>02978   <span class="keywordtype">int</span> nb_cond_lim = la_zcl_vdf.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
<a name="l02979"></a>02979   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;nb_cond_lim; num_cl++)
<a name="l02980"></a>02980     {
<a name="l02981"></a>02981       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = la_zcl_vdf.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(num_cl);
<a name="l02982"></a>02982       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l02983"></a>02983       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l02984"></a>02984         {
<a name="l02985"></a>02985           <span class="keywordtype">int</span> ndeb,nfin,elem1,elem2,num_elem,ori,k,i;
<a name="l02986"></a>02986           <span class="keywordtype">int</span> face,fac1,fac2,signe;
<a name="l02987"></a>02987           <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = matrice.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l02988"></a>02988           <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = matrice.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l02989"></a>02989           <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l02990"></a>02990           <a class="code" href="classDoubleVect.html">DoubleVect</a> aii(ncomp), ajj(ncomp);
<a name="l02991"></a>02991           <span class="comment">/* const Periodique&amp; la_cl_perio = ref_cast(Periodique,la_cl.valeur()); */</span>
<a name="l02992"></a>02992           ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l02993"></a>02993           nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l02994"></a>02994           <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l02995"></a>02995             {
<a name="l02996"></a>02996               elem1 = elem(face,0);
<a name="l02997"></a>02997               elem2 = elem(face,1);
<a name="l02998"></a>02998               ori = orientation(face);
<a name="l02999"></a>02999               <span class="keywordflow">if</span> ( (face == elem_faces(elem1,ori)) || (face == elem_faces(elem1,ori+dimension)) )
<a name="l03000"></a>03000                 {
<a name="l03001"></a>03001                   num_elem = elem2;
<a name="l03002"></a>03002                   signe = 1;
<a name="l03003"></a>03003                 }
<a name="l03004"></a>03004               <span class="keywordflow">else</span>
<a name="l03005"></a>03005                 {
<a name="l03006"></a>03006                   num_elem = elem1;
<a name="l03007"></a>03007                   signe = -1;
<a name="l03008"></a>03008                 }
<a name="l03009"></a>03009               fac1 = elem_faces(num_elem,ori);
<a name="l03010"></a>03010               fac2 = elem_faces(num_elem,ori+dimension);
<a name="l03011"></a>03011               flux_evaluateur.coeffs_fa7_elem(num_elem, fac1, fac2, aii, ajj);
<a name="l03012"></a>03012               <span class="keywordflow">for</span> (i=0; i&lt; ncomp; i++ )
<a name="l03013"></a>03013                 {
<a name="l03014"></a>03014                   <span class="keywordflow">for</span> (k=tab1[face*ncomp+i]-1; k&lt;tab1[face*ncomp+1+i]-1; k++)
<a name="l03015"></a>03015                     {
<a name="l03016"></a>03016                       <span class="keywordflow">if</span> (tab2[k]-1==face*ncomp+i)
<a name="l03017"></a>03017                         {
<a name="l03018"></a>03018                           coeff[k]+=signe*aii(i);
<a name="l03019"></a>03019                         }
<a name="l03020"></a>03020                     }
<a name="l03021"></a>03021                 }
<a name="l03022"></a>03022             }
<a name="l03023"></a>03023         }
<a name="l03024"></a>03024     }
<a name="l03025"></a>03025 }
<a name="l03026"></a>03026 
<a name="l03027"></a>03027 <span class="preprocessor">#endif</span>
<a name="l03028"></a>03028 <span class="preprocessor"></span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:39 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
