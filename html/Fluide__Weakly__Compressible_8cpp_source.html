<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/ThHyd/Dilatable/Weakly_Compressible/Milieu/Fluide_Weakly_Compressible.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/ThHyd/Dilatable/Weakly_Compressible/Milieu/Fluide_Weakly_Compressible.cpp</div>  </div>
</div>
<div class="contents">
<a href="Fluide__Weakly__Compressible_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="comment">/****************************************************************************</span>
<a name="l00003"></a>00003 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00004"></a>00004 <span class="comment">* All rights reserved.</span>
<a name="l00005"></a>00005 <span class="comment">*</span>
<a name="l00006"></a>00006 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00007"></a>00007 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00008"></a>00008 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00009"></a>00009 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00010"></a>00010 <span class="comment">*</span>
<a name="l00011"></a>00011 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00012"></a>00012 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00013"></a>00013 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00014"></a>00014 <span class="comment">*</span>
<a name="l00015"></a>00015 <span class="comment">*****************************************************************************/</span>
<a name="l00016"></a>00016 <span class="comment">//</span>
<a name="l00017"></a>00017 <span class="comment">// </span>
<a name="l00018"></a>00018 <span class="comment">// File:        Fluide_Weakly_Compressible.cpp</span>
<a name="l00019"></a>00019 <span class="comment">// Directory:   $TRUST_ROOT/src/ThHyd/Dilatable/Weakly_Compressible/Milieu</span>
<a name="l00020"></a>00020 <span class="comment">// Version:     /main/49</span>
<a name="l00021"></a>00021 <span class="comment">// </span>
<a name="l00022"></a>00022 <span class="comment">//</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Fluide__Weakly__Compressible_8h.html">Fluide_Weakly_Compressible.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Loi__Etat__Multi__GP__WC_8h.html">Loi_Etat_Multi_GP_WC.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Neumann__sortie__libre_8h.html">Neumann_sortie_libre.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Fonc__Fonction_8h.html">Champ_Fonc_Fonction.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Discretisation__base_8h.html">Discretisation_base.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps__base_8h.html">Schema_Temps_base.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Equation__base_8h.html">Equation_base.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__dis_8h.html">Zone_Cl_dis.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VF_8h.html">Zone_VF.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Param_8h.html">Param.h</a>&gt;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="Fluide__Weakly__Compressible_8cpp.html#a3d743105df9f26c892257ec9473e8270">00036</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classFluide__Weakly__Compressible.html" title="classe Fluide_Weakly_Compressible Cette classe represente un d&#39;un fluide faiblement compressible c&#39;es...">Fluide_Weakly_Compressible</a>,<span class="stringliteral">&quot;Fluide_Weakly_Compressible&quot;</span>,<a class="code" href="classFluide__Dilatable__base.html" title="classe Fluide_Dilatable_base Cette classe represente un d&#39;un fluide dilatable, heritant de fluide bas...">Fluide_Dilatable_base</a>);
<a name="l00037"></a>00037 <span class="comment">// XD fluide_weakly_compressible fluide_dilatable_base fluide_weakly_compressible -1 Weakly-compressible flow with a low mach number assumption; this means that the thermo-dynamic pressure (used in state law) can vary in space.</span>
<a name="l00038"></a>00038 <span class="comment">// XD attr loi_etat loi_etat_base loi_etat 1 The state law that will be associated to the Weakly-compressible fluid.</span>
<a name="l00039"></a>00039 <span class="comment">// XD attr sutherland bloc_sutherland sutherland 1 Sutherland law for viscosity and for conductivity.</span>
<a name="l00040"></a>00040 <span class="comment">// XD attr traitement_pth chaine(into=[&quot;constant&quot;]) traitement_pth 1 Particular treatment for the thermodynamic pressure Pth ; there is currently one possibility: NL2 1) the keyword \&#39;constant\&#39; makes it possible to have a constant Pth but not uniform in space ; it\&#39;s the good choice when the flow is open (e.g. with pressure boundary conditions).</span>
<a name="l00041"></a>00041 <span class="comment">// XD attr lambda field_base lambda_u 1 Conductivity (W.m-1.K-1).</span>
<a name="l00042"></a>00042 <span class="comment">// XD attr mu field_base mu 1 Dynamic viscosity (kg.m-1.s-1).</span>
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="classFluide__Weakly__Compressible.html#aa8a09549150aec244c382cde0c497e1f">00044</a> <a class="code" href="classFluide__Weakly__Compressible.html#aa8a09549150aec244c382cde0c497e1f">Fluide_Weakly_Compressible::Fluide_Weakly_Compressible</a>() : use_total_pressure_(0), use_hydrostatic_pressure_(0),
<a name="l00045"></a>00045   use_grad_pression_eos_(1), sim_resumed_(0), time_activate_ptot_(-1.) {}
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="classFluide__Weakly__Compressible.html#a9aa1aacc0ab2e58f1ec70ae7a7897379">00047</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classFluide__Weakly__Compressible.html#a9aa1aacc0ab2e58f1ec70ae7a7897379" title="Ecrit les proprietes du fluide sur un flot de sortie.">Fluide_Weakly_Compressible::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00048"></a>00048 <span class="keyword"></span>{
<a name="l00049"></a>00049   os &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00050"></a>00050   <a class="code" href="classMilieu__base.html#a4f822b3be5b1c7c5eed44dd72f805299" title="Ecrit un objet milieu sur un flot de sortie. Ecrit les caracteristiques du milieu: - masse volumique ...">Fluide_Dilatable_base::ecrire</a>(os);
<a name="l00051"></a>00051   <span class="keywordflow">return</span> os;
<a name="l00052"></a>00052 }
<a name="l00053"></a>00053 
<a name="l00054"></a><a class="code" href="classFluide__Weakly__Compressible.html#ae9398c2caad4bf38990842c133958903">00054</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classFluide__Weakly__Compressible.html#ae9398c2caad4bf38990842c133958903" title="Lit les caracteristiques du fluide a partir d&#39;un flot d&#39;entree. Format: Fluide_base { Mu type_champ b...">Fluide_Weakly_Compressible::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00055"></a>00055 {
<a name="l00056"></a>00056   <a class="code" href="classFluide__Weakly__Compressible.html#ae9398c2caad4bf38990842c133958903" title="Lit les caracteristiques du fluide a partir d&#39;un flot d&#39;entree. Format: Fluide_base { Mu type_champ b...">Fluide_Dilatable_base::readOn</a>(is);
<a name="l00057"></a>00057   <span class="keywordflow">return</span> is;
<a name="l00058"></a>00058 }
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="classFluide__Weakly__Compressible.html#aa26b3c375fab32c020476fe3c8311de9">00060</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#aa26b3c375fab32c020476fe3c8311de9">Fluide_Weakly_Compressible::set_param</a>(<a class="code" href="classParam.html" title="Defined below in this file.">Param</a>&amp; param)
<a name="l00061"></a>00061 {
<a name="l00062"></a>00062   <a class="code" href="classFluide__Weakly__Compressible.html#aa26b3c375fab32c020476fe3c8311de9">Fluide_Dilatable_base::set_param</a>(param);
<a name="l00063"></a>00063   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;pression_thermo&quot;</span>,&amp;<a class="code" href="classFluide__Dilatable__base.html#aa07d9ecb4d311a296048a52984ffabf5">Pth_</a>); <span class="comment">//!&lt; XD_ADD_P double Initial thermo-dynamic pressure used in the assosciated state law.</span>
<a name="l00064"></a>00064 <span class="comment"></span>  param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;pression_xyz&quot;</span>,&amp;<a class="code" href="classFluide__Weakly__Compressible.html#a8bdc541a163461128b2fe85423588989">Pth_xyz_</a>); <span class="comment">//!&lt; XD_ADD_P field_base Initial thermo-dynamic pressure used in the assosciated state law. It should be defined with as a Champ_Fonc_xyz.</span>
<a name="l00065"></a>00065 <span class="comment"></span>  param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;use_total_pressure&quot;</span>,&amp;<a class="code" href="classFluide__Weakly__Compressible.html#a68276538ef3787952e8b78068221bfb1">use_total_pressure_</a>); <span class="comment">//!&lt; XD_ADD_P int Flag (0 or 1) used to activate and use the total pressure in the assosciated state law. The default value of this Flag is 0.</span>
<a name="l00066"></a>00066 <span class="comment"></span>  param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;use_hydrostatic_pressure&quot;</span>,&amp;<a class="code" href="classFluide__Weakly__Compressible.html#afd59694ff732caa3e0e377608613de79">use_hydrostatic_pressure_</a>); <span class="comment">//!&lt; XD_ADD_P int Flag (0 or 1) used to activate and use the hydro-static pressure in the assosciated state law. The default value of this Flag is 0.</span>
<a name="l00067"></a>00067 <span class="comment"></span>  param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;use_grad_pression_eos&quot;</span>,&amp;<a class="code" href="classFluide__Weakly__Compressible.html#ae3fb33706a713b7560ba3706b5926d17">use_grad_pression_eos_</a>); <span class="comment">//!&lt; XD_ADD_P int Flag (0 or 1) used to specify whether or not the gradient of the thermo-dynamic pressure will be taken into account in the source term of the temperature equation (case of a non-uniform pressure). The default value of this Flag is 1 which means that the gradient is used in the source.</span>
<a name="l00068"></a>00068 <span class="comment"></span>  param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;time_activate_ptot&quot;</span>,&amp;<a class="code" href="classFluide__Weakly__Compressible.html#a64a91812d86348c70ff43e0401f71c6e">time_activate_ptot_</a>); <span class="comment">//!&lt; XD_ADD_P double Time (in seconds) at which the total pressure will be used in the assosciated state law.</span>
<a name="l00069"></a>00069 <span class="comment"></span>}
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="classFluide__Weakly__Compressible.html#af2cda8f9674f58bb4ed05c3440c98506">00071</a> <span class="keywordtype">int</span> <a class="code" href="classFluide__Weakly__Compressible.html#af2cda8f9674f58bb4ed05c3440c98506" title="Lecture des parametres de type non simple d&#39;un objet_U a partir d&#39;un flot d&#39;entree.">Fluide_Weakly_Compressible::lire_motcle_non_standard</a>(<span class="keyword">const</span> <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>&amp; mot, <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00072"></a>00072 {
<a name="l00073"></a>00073   <span class="keywordflow">if</span> (mot==<span class="stringliteral">&quot;Traitement_PTh&quot;</span>)
<a name="l00074"></a>00074     {
<a name="l00075"></a>00075       <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> trait;
<a name="l00076"></a>00076       is &gt;&gt; trait;
<a name="l00077"></a>00077 <span class="comment">// TODO : FIXME : should have CONSERVATION_MASSE too !!</span>
<a name="l00078"></a>00078       <a class="code" href="classMotcles.html" title="Un tableau d&#39;objets de la classe Motcle.">Motcles</a> les_options(1);
<a name="l00079"></a>00079       {
<a name="l00080"></a>00080         les_options[0] = <span class="stringliteral">&quot;constant&quot;</span>;
<a name="l00081"></a>00081       }
<a name="l00082"></a>00082       <a class="code" href="classFluide__Dilatable__base.html#a01daaa6fb56a5d6862b5b7f46cb35ff1" title="flag pour le traitement de la pression thermo">traitement_PTh</a>=les_options.<a class="code" href="classMotcles.html#afecd68f73e904bc129022a236ff6ab15">search</a>(trait);
<a name="l00083"></a>00083       <span class="keywordflow">if</span> (<a class="code" href="classFluide__Dilatable__base.html#a01daaa6fb56a5d6862b5b7f46cb35ff1" title="flag pour le traitement de la pression thermo">traitement_PTh</a> == -1)
<a name="l00084"></a>00084         {
<a name="l00085"></a>00085           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt; trait &lt;&lt; <span class="stringliteral">&quot; is not understood as an option of the keyword &quot;</span> &lt;&lt; mot &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00086"></a>00086           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt; <span class="stringliteral">&quot;One of the following options was expected : &quot;</span> &lt;&lt; les_options &lt;&lt; finl;
<a name="l00087"></a>00087           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00088"></a>00088         }
<a name="l00089"></a>00089       <span class="keywordflow">return</span> 1;
<a name="l00090"></a>00090     }
<a name="l00091"></a>00091   <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classFluide__Weakly__Compressible.html#af2cda8f9674f58bb4ed05c3440c98506" title="Lecture des parametres de type non simple d&#39;un objet_U a partir d&#39;un flot d&#39;entree.">Fluide_Dilatable_base::lire_motcle_non_standard</a>(mot,is);
<a name="l00092"></a>00092 }
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="comment">// Precondition:</span>
<a name="l00095"></a>00095 <span class="comment">// Parametre: Pb_Thermohydraulique&amp; pb</span>
<a name="l00096"></a>00096 <span class="comment">// Signification: le probleme a resoudre</span>
<a name="l00097"></a>00097 <span class="comment">// Valeurs par defaut:</span>
<a name="l00098"></a>00098 <span class="comment">// Contraintes:</span>
<a name="l00099"></a>00099 <span class="comment">// Acces: lecture</span>
<a name="l00100"></a>00100 <span class="comment">// </span>
<a name="l00101"></a>00101 <span class="comment">// Signification:</span>
<a name="l00102"></a>00102 <span class="comment">// Contraintes:</span>
<a name="l00103"></a>00103 <span class="comment">// Exception:</span>
<a name="l00104"></a>00104 <span class="comment">// Effets de bord:</span>
<a name="l00105"></a>00105 <span class="comment">// Postcondition:</span>
<a name="l00106"></a>00106 <span class="comment">//</span><span class="comment"></span>
<a name="l00107"></a>00107 <span class="comment">//! Complete le fluide avec les champs inconnus associes au probleme</span>
<a name="l00108"></a><a class="code" href="classFluide__Weakly__Compressible.html#a37ee731c46410ec02f720f0882d9e71b">00108</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a37ee731c46410ec02f720f0882d9e71b" title="Complete le fluide avec les champs inconnus associes au probleme.">Fluide_Weakly_Compressible::completer</a>(<span class="keyword">const</span> <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb)
<a name="l00109"></a>00109 {
<a name="l00110"></a>00110   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Fluide_Weakly_Compressible::completer&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 <span class="comment">// XXX : currently we support only open configurations if use_total_hydro_pressure</span>
<a name="l00113"></a>00113 <span class="comment">// THERE IS A PROBLEM HERE</span>
<a name="l00114"></a>00114 <span class="comment">// TODO : FIXME</span>
<a name="l00115"></a>00115   <span class="keywordflow">if</span> (<a class="code" href="classFluide__Weakly__Compressible.html#a5aa41c68d8d3417a359f21b6f5fb2087">use_total_hydro_pressure</a>()) <a class="code" href="classFluide__Weakly__Compressible.html#af306f12ae1ea454d5dd68abfe021c55c">checkTraitementPth</a>(pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(0).<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>());
<a name="l00116"></a>00116 
<a name="l00117"></a>00117   <span class="keywordflow">if</span> (<a class="code" href="classFluide__Weakly__Compressible.html#a8bdc541a163461128b2fe85423588989">Pth_xyz_</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l00118"></a>00118     {
<a name="l00119"></a>00119       <span class="keywordflow">if</span> (<a class="code" href="classFluide__Weakly__Compressible.html#a8bdc541a163461128b2fe85423588989">Pth_xyz_</a>-&gt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() != <span class="stringliteral">&quot;Champ_Fonc_xyz&quot;</span> ) <span class="comment">//!&lt; TODO : check if it is generic</span>
<a name="l00120"></a>00120 <span class="comment"></span>        {
<a name="l00121"></a>00121           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in your data file : This is not allowed !&quot;</span>&lt;&lt; finl;
<a name="l00122"></a>00122           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Pression_xyz should be defined with Champ_Fonc_xyz !&quot;</span> &lt;&lt; finl;
<a name="l00123"></a>00123           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00124"></a>00124         }
<a name="l00125"></a>00125       <span class="keywordflow">if</span> (<a class="code" href="classFluide__Dilatable__base.html#aa07d9ecb4d311a296048a52984ffabf5">Pth_</a> != -1 || <a class="code" href="classFluide__Dilatable__base.html#a4f06ab1ad30953302bb0daca97c5e18b">Pth_n</a> != -1)
<a name="l00126"></a>00126         {
<a name="l00127"></a>00127           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in your data file : This is not allowed !&quot;</span>&lt;&lt; finl;
<a name="l00128"></a>00128           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;You can not specify both pression_xyz and pression_thermo !&quot;</span> &lt;&lt; finl;
<a name="l00129"></a>00129           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00130"></a>00130         }
<a name="l00131"></a>00131       <span class="keywordflow">if</span> (<a class="code" href="classFluide__Weakly__Compressible.html#a5aa41c68d8d3417a359f21b6f5fb2087">use_total_hydro_pressure</a>())
<a name="l00132"></a>00132         {
<a name="l00133"></a>00133           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in your data file : This is not allowed !&quot;</span>&lt;&lt; finl;
<a name="l00134"></a>00134           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;You need to define pression_thermo when using the flags use_total_pressure or use_hydrostatic_pressure !&quot;</span> &lt;&lt; finl;
<a name="l00135"></a>00135           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00136"></a>00136         }
<a name="l00137"></a>00137     }
<a name="l00138"></a>00138   <span class="keywordflow">else</span> <span class="comment">//!&lt; pression_xyz not specified in data file</span>
<a name="l00139"></a>00139 <span class="comment"></span>    {
<a name="l00140"></a>00140       <span class="keywordflow">if</span> (<a class="code" href="classFluide__Dilatable__base.html#aa07d9ecb4d311a296048a52984ffabf5">Pth_</a> != -1) <a class="code" href="classFluide__Dilatable__base.html#a4f06ab1ad30953302bb0daca97c5e18b">Pth_n</a> = <a class="code" href="classFluide__Dilatable__base.html#aa07d9ecb4d311a296048a52984ffabf5">Pth_</a>;
<a name="l00141"></a>00141       <span class="keywordflow">else</span>
<a name="l00142"></a>00142         {
<a name="l00143"></a>00143           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in your data file : This is not allowed !&quot;</span>&lt;&lt; finl;
<a name="l00144"></a>00144           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;You need to specify either pression_xyz or pression_thermo !&quot;</span> &lt;&lt; finl;
<a name="l00145"></a>00145           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00146"></a>00146         }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148       <span class="keywordflow">if</span> ( <a class="code" href="classFluide__Weakly__Compressible.html#a68276538ef3787952e8b78068221bfb1">use_total_pressure_</a> &amp;&amp; <a class="code" href="classFluide__Weakly__Compressible.html#a64a91812d86348c70ff43e0401f71c6e">time_activate_ptot_</a>==-1. )
<a name="l00149"></a>00149         {
<a name="l00150"></a>00150           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in your data file : This is not allowed !&quot;</span>&lt;&lt; finl;
<a name="l00151"></a>00151           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;You should define time_activate_ptot when using the flag use_total_pressure !&quot;</span> &lt;&lt; finl;
<a name="l00152"></a>00152           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00153"></a>00153         }
<a name="l00154"></a>00154 
<a name="l00155"></a>00155       <span class="keywordflow">if</span> ( <a class="code" href="classFluide__Weakly__Compressible.html#a68276538ef3787952e8b78068221bfb1">use_total_pressure_</a> &amp;&amp; <a class="code" href="classFluide__Weakly__Compressible.html#afd59694ff732caa3e0e377608613de79">use_hydrostatic_pressure_</a> )
<a name="l00156"></a>00156         {
<a name="l00157"></a>00157           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in your data file : This is not allowed !&quot;</span>&lt;&lt; finl;
<a name="l00158"></a>00158           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Not possible to activate the two flags use_total_pressure and use_hydrostatic_pressure at same time !&quot;</span> &lt;&lt; finl;
<a name="l00159"></a>00159           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00160"></a>00160         }
<a name="l00161"></a>00161 
<a name="l00162"></a>00162       <span class="keywordflow">if</span> ( <a class="code" href="classFluide__Weakly__Compressible.html#afd59694ff732caa3e0e377608613de79">use_hydrostatic_pressure_</a> &amp;&amp; !<a class="code" href="classMilieu__base.html#a060498efd2d447037010c610438bac7a" title="Renvoie 1 si la gravite a ete initialisee.">a_gravite</a>() )
<a name="l00163"></a>00163         {
<a name="l00164"></a>00164           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in your data file : This is not allowed !&quot;</span>&lt;&lt; finl;
<a name="l00165"></a>00165           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Not possible to activate the flag use_hydrostatic_pressure without defining a gravity vector !&quot;</span> &lt;&lt; finl;
<a name="l00166"></a>00166           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00167"></a>00167         }
<a name="l00168"></a>00168     }
<a name="l00169"></a>00169 
<a name="l00170"></a>00170 <span class="comment">// XXX : On l&#39;a besoin pour initialiser rho ...</span>
<a name="l00171"></a>00171   <span class="keywordflow">if</span> ( !<a class="code" href="classFluide__Weakly__Compressible.html#ab4e368b7df633f22594439d2d786dc55">use_saved_data</a>() ) <a class="code" href="classFluide__Weakly__Compressible.html#a1972f46ce98e567a978f4f95168815d6">initialiser_pth_for_EOS</a>(pb); <span class="comment">//!&lt; soit à initialiser</span>
<a name="l00172"></a>00172 <span class="comment"></span>  <span class="keywordflow">else</span> <a class="code" href="classFluide__Weakly__Compressible.html#a304ddcacdd5bf220d5c0c340f4ceee47">pression_eos_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>() = <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>; <span class="comment">//!&lt; soit à reprendre</span>
<a name="l00173"></a>00173 <span class="comment"></span>
<a name="l00174"></a>00174 
<a name="l00175"></a>00175   <a class="code" href="classFluide__Weakly__Compressible.html#a37ee731c46410ec02f720f0882d9e71b" title="Complete le fluide avec les champs inconnus associes au probleme.">Fluide_Dilatable_base::completer</a>(pb);
<a name="l00176"></a>00176 
<a name="l00177"></a>00177   <a class="code" href="classFluide__Weakly__Compressible.html#a77471f014b5b388a1a73ed85f4a08d2c">mettre_a_jour_bis</a>();
<a name="l00178"></a>00178 }
<a name="l00179"></a>00179 
<a name="l00180"></a><a class="code" href="classFluide__Weakly__Compressible.html#a77471f014b5b388a1a73ed85f4a08d2c">00180</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a77471f014b5b388a1a73ed85f4a08d2c">Fluide_Weakly_Compressible::mettre_a_jour_bis</a>()
<a name="l00181"></a>00181 {
<a name="l00182"></a>00182   assert(<a class="code" href="classFluide__Weakly__Compressible.html#a304ddcacdd5bf220d5c0c340f4ceee47">pression_eos_</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>());
<a name="l00183"></a>00183   <a class="code" href="classFluide__Weakly__Compressible.html#a304ddcacdd5bf220d5c0c340f4ceee47">pression_eos_</a>.<a class="code" href="classChamp__Don.html#a8b0fe2933360f11ddc77237ee23b5b56" title="Appel a l&#39;objet sous-jacent Provoque la mise a jour du champ si il est instationnaire.">mettre_a_jour</a>(<a class="code" href="classFluide__Dilatable__base.html#a68f1590cd1e3864527256b45a92522f8">le_probleme_</a>-&gt;schema_temps().temps_courant());
<a name="l00184"></a>00184 
<a name="l00185"></a>00185   <span class="keywordflow">if</span> (<a class="code" href="classFluide__Weakly__Compressible.html#a679d9d2f7b2424d88a626e58489001ed">pression_hydro_</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l00186"></a>00186     <a class="code" href="classFluide__Weakly__Compressible.html#a679d9d2f7b2424d88a626e58489001ed">pression_hydro_</a>.<a class="code" href="classChamp__Don.html#a8b0fe2933360f11ddc77237ee23b5b56" title="Appel a l&#39;objet sous-jacent Provoque la mise a jour du champ si il est instationnaire.">mettre_a_jour</a>(<a class="code" href="classFluide__Dilatable__base.html#a68f1590cd1e3864527256b45a92522f8">le_probleme_</a>-&gt;schema_temps().temps_courant());
<a name="l00187"></a>00187 
<a name="l00188"></a>00188   <span class="keywordflow">if</span> (<a class="code" href="classFluide__Weakly__Compressible.html#af51ec03b2949fddffe9fc5b1f3be8cb3">unsolved_species_</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l00189"></a>00189     <a class="code" href="classFluide__Weakly__Compressible.html#af51ec03b2949fddffe9fc5b1f3be8cb3">unsolved_species_</a>.<a class="code" href="classChamp__Don.html#a8b0fe2933360f11ddc77237ee23b5b56" title="Appel a l&#39;objet sous-jacent Provoque la mise a jour du champ si il est instationnaire.">mettre_a_jour</a>(<a class="code" href="classFluide__Dilatable__base.html#a68f1590cd1e3864527256b45a92522f8">le_probleme_</a>-&gt;schema_temps().temps_courant());
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="classFluide__Weakly__Compressible.html#a1972f46ce98e567a978f4f95168815d6">00192</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a1972f46ce98e567a978f4f95168815d6">Fluide_Weakly_Compressible::initialiser_pth_for_EOS</a>(<span class="keyword">const</span> <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb)
<a name="l00193"></a>00193 {
<a name="l00194"></a>00194   <span class="keywordflow">if</span> (<a class="code" href="classFluide__Weakly__Compressible.html#a88250f56e323d59f9f75c32896752b2a">use_pth_xyz</a>()) <a class="code" href="classFluide__Weakly__Compressible.html#a8f0887970754daada18039042e932672">initialiser_pth_xyz</a>(pb);
<a name="l00195"></a>00195   <span class="keywordflow">else</span> <a class="code" href="classFluide__Weakly__Compressible.html#a09c19ffd8afc5fbfef45a1304edd0999">initialiser_pth</a>();
<a name="l00196"></a>00196 
<a name="l00197"></a>00197   <a class="code" href="classFluide__Weakly__Compressible.html#a304ddcacdd5bf220d5c0c340f4ceee47">pression_eos_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>() = <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>;
<a name="l00198"></a>00198 }
<a name="l00199"></a>00199 
<a name="l00200"></a><a class="code" href="classFluide__Weakly__Compressible.html#a8f0887970754daada18039042e932672">00200</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a8f0887970754daada18039042e932672">Fluide_Weakly_Compressible::initialiser_pth_xyz</a>(<span class="keyword">const</span> <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb)
<a name="l00201"></a>00201 {
<a name="l00202"></a>00202   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Initializing the thermo-dynamic pressure Pth_xyz ...&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00203"></a>00203   <span class="keywordtype">int</span> isVDF = 0; <span class="comment">//!&lt; VDF or VEF ??</span>
<a name="l00204"></a>00204 <span class="comment"></span>  <span class="keywordflow">if</span> (pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(0).<a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;VDF&quot;</span>) isVDF = 1;
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 <span class="comment">// We know that mu is always stored on elems and that Champ_Don rho_xyz_ is evaluated on elements</span>
<a name="l00207"></a>00207   assert (<a class="code" href="classFluide__Weakly__Compressible.html#a8bdc541a163461128b2fe85423588989">Pth_xyz_</a>-&gt;<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>().<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == <a class="code" href="classFluide__base.html#ae9d2bcde48c733b8b7652a32c6a80e49" title="Renvoie la viscosite dynamique, mu. (version const)">viscosite_dynamique</a>().<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>().<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>());
<a name="l00208"></a>00208 
<a name="l00209"></a>00209   <span class="keywordflow">if</span> (isVDF)
<a name="l00210"></a>00210     {
<a name="l00211"></a>00211 <span class="comment">// Disc VDF =&gt; Pth_xyz_ on elems =&gt; we do nothing</span>
<a name="l00212"></a>00212       <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>=<a class="code" href="classFluide__Weakly__Compressible.html#a487df0b5183d65264c949936982d7547">Pth_n_tab_</a>=<a class="code" href="classFluide__Weakly__Compressible.html#a8bdc541a163461128b2fe85423588989">Pth_xyz_</a>-&gt;<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00213"></a>00213     }
<a name="l00214"></a>00214   <span class="keywordflow">else</span>
<a name="l00215"></a>00215     {
<a name="l00216"></a>00216 <span class="comment">// we use rho for affecter because the field is on the faces in VEF (as rho)</span>
<a name="l00217"></a>00217       <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; ch_rho = <a class="code" href="classMilieu__base.html#a46a9a4bfb046ed22d0f267b6c052889f" title="Renvoie la masse volumique du milieu. (version const)">masse_volumique</a>();
<a name="l00218"></a>00218       ch_rho.<a class="code" href="classChamp__base.html#a7eb438102492017bc50afa9ddbdbed06">affecter_</a>(<a class="code" href="classFluide__Weakly__Compressible.html#a8bdc541a163461128b2fe85423588989">Pth_xyz_</a>);
<a name="l00219"></a>00219       <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>=<a class="code" href="classFluide__Weakly__Compressible.html#a487df0b5183d65264c949936982d7547">Pth_n_tab_</a>=ch_rho.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l00220"></a>00220     }
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="classFluide__Weakly__Compressible.html#a09c19ffd8afc5fbfef45a1304edd0999">00223</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a09c19ffd8afc5fbfef45a1304edd0999">Fluide_Weakly_Compressible::initialiser_pth</a>()
<a name="l00224"></a>00224 {
<a name="l00225"></a>00225   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Initializing the thermo-dynamic pressure ...&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00226"></a>00226 <span class="comment">// Pth_tab_ doit avoir meme dimensions que rho (elem en VDF et faces en VEF)</span>
<a name="l00227"></a>00227   <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a> = <a class="code" href="classMilieu__base.html#a46a9a4bfb046ed22d0f267b6c052889f" title="Renvoie la masse volumique du milieu. (version const)">masse_volumique</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l00228"></a>00228   <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
<a name="l00229"></a>00229   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++) <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>(i) = <a class="code" href="classFluide__Dilatable__base.html#aa07d9ecb4d311a296048a52984ffabf5">Pth_</a>;
<a name="l00230"></a>00230   <a class="code" href="classFluide__Weakly__Compressible.html#a487df0b5183d65264c949936982d7547">Pth_n_tab_</a> = <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>;
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 
<a name="l00233"></a><a class="code" href="classFluide__Weakly__Compressible.html#a86d9fcb48f0c040e7ee39d17a319b63f">00233</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a86d9fcb48f0c040e7ee39d17a319b63f" title="Prepare le pas de temps.">Fluide_Weakly_Compressible::preparer_pas_temps</a>()
<a name="l00234"></a>00234 {
<a name="l00235"></a>00235   <a class="code" href="classFluide__Weakly__Compressible.html#a86d9fcb48f0c040e7ee39d17a319b63f" title="Prepare le pas de temps.">Fluide_Dilatable_base::preparer_pas_temps</a>();
<a name="l00236"></a>00236 }
<a name="l00237"></a>00237 
<a name="l00238"></a><a class="code" href="classFluide__Weakly__Compressible.html#a3295c151d4e139825350c881d8240b10">00238</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a3295c151d4e139825350c881d8240b10">Fluide_Weakly_Compressible::prepare_pressure_edo</a>()
<a name="l00239"></a>00239 {
<a name="l00240"></a>00240   <span class="comment">/* Do nothing */</span>
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
<a name="l00243"></a><a class="code" href="classFluide__Weakly__Compressible.html#a719ae49a8a8fe370c59230bdca8df86f">00243</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a719ae49a8a8fe370c59230bdca8df86f">Fluide_Weakly_Compressible::write_mean_edo</a>(<span class="keywordtype">double</span> t)
<a name="l00244"></a>00244 {
<a name="l00245"></a>00245   <span class="comment">/* Do nothing */</span>
<a name="l00246"></a>00246 }
<a name="l00247"></a>00247 
<a name="l00248"></a><a class="code" href="classFluide__Weakly__Compressible.html#af306f12ae1ea454d5dd68abfe021c55c">00248</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#af306f12ae1ea454d5dd68abfe021c55c">Fluide_Weakly_Compressible::checkTraitementPth</a>(<span class="keyword">const</span> <a class="code" href="classZone__Cl__dis.html" title="classe Zone_Cl_dis Classe generique de la hierarchie des conditions aux limites discretisees. Un objet Zone_Cl_dis peut referencer n&#39;importe quel derivant de Zone_Cl_dis_base. La plupart des methodes appellent les methodes de l&#39;objet Probleme sous-jacent via la methode valeur() declaree grace a la macro Declare_deriv().;">Zone_Cl_dis</a>&amp; zone_cl)
<a name="l00249"></a>00249 {
<a name="l00250"></a>00250 <span class="comment">// TODO : FIXME : we should be able to use this in closed cavities too !!</span>
<a name="l00251"></a>00251   <span class="keywordtype">int</span> pression_imposee=0;
<a name="l00252"></a>00252   <span class="keywordtype">int</span> size=zone_cl.<a class="code" href="classZone__Cl__dis.html#aafbd0525703e23200e31796bcd4fcac6" title="Appel a l&#39;objet sous-jacent Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>().size();
<a name="l00253"></a>00253   assert(size!=0);
<a name="l00254"></a>00254   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n=0; n&lt;size; n++)
<a name="l00255"></a>00255     {
<a name="l00256"></a>00256       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_cl.<a class="code" href="classZone__Cl__dis.html#aafbd0525703e23200e31796bcd4fcac6" title="Appel a l&#39;objet sous-jacent Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n);
<a name="l00257"></a>00257       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>, la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())) pression_imposee=1;
<a name="l00258"></a>00258     }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260   <span class="keywordflow">if</span> (!pression_imposee)
<a name="l00261"></a>00261     {
<a name="l00262"></a>00262       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;At least one open boundary is currently required for the weakly compressible problem !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00263"></a>00263       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00264"></a>00264     }
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 
<a name="l00267"></a><a class="code" href="classFluide__Weakly__Compressible.html#ac7a6b0f51c26eef7ac5bc33b8302162a">00267</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#ac7a6b0f51c26eef7ac5bc33b8302162a">Fluide_Weakly_Compressible::discretiser</a>(<span class="keyword">const</span> <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb, <span class="keyword">const</span>  <a class="code" href="classDiscretisation__base.html" title="classe Discretisation_base Cette classe represente un schema de discretisation en espace...">Discretisation_base</a>&amp; dis)
<a name="l00268"></a>00268 {
<a name="l00269"></a>00269   <span class="keyword">const</span> <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; zone_dis=pb.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(0).<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>();
<a name="l00270"></a>00270   <span class="keywordtype">double</span> temps=pb.<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>();
<a name="l00271"></a>00271 
<a name="l00272"></a>00272 <span class="comment">// In *_Melange_Binaire_WC we do not even have a temperature variable ...</span>
<a name="l00273"></a>00273 <span class="comment">// it is the species mass fraction Y1... Although named ch_temperature</span>
<a name="l00274"></a>00274   <a class="code" href="classChamp__Don.html" title="classe Champ_Don Classe generique de la hierarchie des champs donnes, un objet Champ_Don peut referen...">Champ_Don</a>&amp; ch_TK = <a class="code" href="classFluide__Dilatable__base.html#afb2fe4b8a5681f0f762a0794aaa6df7c" title="Renvoie le champ de le temperature.">ch_temperature</a>();
<a name="l00275"></a>00275   <span class="keywordflow">if</span> (pb.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;Pb_Hydraulique_Melange_Binaire_WC&quot;</span> || pb.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;Pb_Hydraulique_Melange_Binaire_Turbulent_WC&quot;</span>)
<a name="l00276"></a>00276     dis.<a class="code" href="classDiscretisation__base.html#a03257807e08369739ccc39eba02f74b5">discretiser_champ</a>(<span class="stringliteral">&quot;temperature&quot;</span>,zone_dis,<span class="stringliteral">&quot;fraction_massique&quot;</span>,<span class="stringliteral">&quot;neant&quot;</span>,1,temps,ch_TK);
<a name="l00277"></a>00277   <span class="keywordflow">else</span>
<a name="l00278"></a>00278     dis.<a class="code" href="classDiscretisation__base.html#a03257807e08369739ccc39eba02f74b5">discretiser_champ</a>(<span class="stringliteral">&quot;temperature&quot;</span>,zone_dis,<span class="stringliteral">&quot;temperature&quot;</span>,<span class="stringliteral">&quot;K&quot;</span>,1,temps,ch_TK);
<a name="l00279"></a>00279 
<a name="l00280"></a>00280   <span class="keywordflow">if</span> (<a class="code" href="classFluide__Dilatable__base.html#af310e9aeafbd35af667d91bb88714537">type_fluide</a>()!=<span class="stringliteral">&quot;Gaz_Parfait&quot;</span>)
<a name="l00281"></a>00281     <a class="code" href="classFluide__Dilatable__base.html#a3225165b2a79168fd28eaafa1b879165">loi_etat</a>()-&gt;champs_compris().ajoute_champ(ch_TK);
<a name="l00282"></a>00282 
<a name="l00283"></a>00283   <a class="code" href="classFluide__Weakly__Compressible.html#ac7a6b0f51c26eef7ac5bc33b8302162a">Fluide_Dilatable_base::discretiser</a>(pb,dis);
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 <span class="comment">// XXX XXX : Champs pour WC : comme la temperature car elem en VDF et faces en VEF</span>
<a name="l00286"></a>00286   <a class="code" href="classChamp__Don.html" title="classe Champ_Don Classe generique de la hierarchie des champs donnes, un objet Champ_Don peut referen...">Champ_Don</a>&amp; phydro = <a class="code" href="classFluide__Weakly__Compressible.html#ae6ce534087ed3f0ba1e38d8b166f166f">pression_hydro</a>();
<a name="l00287"></a>00287   dis.<a class="code" href="classDiscretisation__base.html#a03257807e08369739ccc39eba02f74b5">discretiser_champ</a>(<span class="stringliteral">&quot;temperature&quot;</span>,zone_dis,<span class="stringliteral">&quot;pression_hydro&quot;</span>,<span class="stringliteral">&quot;Pa&quot;</span>,1,temps,phydro);
<a name="l00288"></a>00288   <a class="code" href="classMilieu__base.html#ac23515c92999b5ee05f11d0a4603ec52">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(phydro);
<a name="l00289"></a>00289 
<a name="l00290"></a>00290   <a class="code" href="classChamp__Don.html" title="classe Champ_Don Classe generique de la hierarchie des champs donnes, un objet Champ_Don peut referen...">Champ_Don</a>&amp; peos = <a class="code" href="classFluide__Weakly__Compressible.html#abca24dcfc46792074c55f1c83478df9f">pression_eos</a>();
<a name="l00291"></a>00291   dis.<a class="code" href="classDiscretisation__base.html#a03257807e08369739ccc39eba02f74b5">discretiser_champ</a>(<span class="stringliteral">&quot;temperature&quot;</span>,zone_dis,<span class="stringliteral">&quot;pression_eos&quot;</span>,<span class="stringliteral">&quot;Pa&quot;</span>,1,temps,peos);
<a name="l00292"></a>00292   <a class="code" href="classMilieu__base.html#ac23515c92999b5ee05f11d0a4603ec52">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(peos);
<a name="l00293"></a>00293 
<a name="l00294"></a>00294 <span class="comment">// Seulement pour multi-especes</span>
<a name="l00295"></a>00295   <span class="keywordflow">if</span> (pb.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;Pb_Thermohydraulique_Especes_WC&quot;</span>)
<a name="l00296"></a>00296     {
<a name="l00297"></a>00297       <a class="code" href="classChamp__Don.html" title="classe Champ_Don Classe generique de la hierarchie des champs donnes, un objet Champ_Don peut referen...">Champ_Don</a>&amp; yn = <a class="code" href="classFluide__Weakly__Compressible.html#a2f76138e6f1b6da449ebebbac912c465">fraction_massique_nonresolue</a>();
<a name="l00298"></a>00298       dis.<a class="code" href="classDiscretisation__base.html#a03257807e08369739ccc39eba02f74b5">discretiser_champ</a>(<span class="stringliteral">&quot;temperature&quot;</span>,zone_dis,<span class="stringliteral">&quot;fraction_massique_nonresolue&quot;</span>,<span class="stringliteral">&quot;neant&quot;</span>,1,temps,yn);
<a name="l00299"></a>00299       <a class="code" href="classMilieu__base.html#ac23515c92999b5ee05f11d0a4603ec52">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(yn);
<a name="l00300"></a>00300     }
<a name="l00301"></a>00301 }
<a name="l00302"></a>00302 
<a name="l00303"></a><a class="code" href="classFluide__Weakly__Compressible.html#a2f24e6043e81fa7a4277a3ad292bc825">00303</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a2f24e6043e81fa7a4277a3ad292bc825">Fluide_Weakly_Compressible::abortTimeStep</a>()
<a name="l00304"></a>00304 {
<a name="l00305"></a>00305   <a class="code" href="classFluide__Weakly__Compressible.html#a2f24e6043e81fa7a4277a3ad292bc825">Fluide_Dilatable_base::abortTimeStep</a>();
<a name="l00306"></a>00306   <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a> = <a class="code" href="classFluide__Weakly__Compressible.html#a487df0b5183d65264c949936982d7547">Pth_n_tab_</a>;
<a name="l00307"></a>00307 }
<a name="l00308"></a>00308 
<a name="l00309"></a><a class="code" href="classFluide__Weakly__Compressible.html#a9ef2d2e98a8a63fd7609df7f8e030422">00309</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a9ef2d2e98a8a63fd7609df7f8e030422">Fluide_Weakly_Compressible::update_pressure_fields</a>(<span class="keywordtype">double</span> temps)
<a name="l00310"></a>00310 {
<a name="l00311"></a>00311   <a class="code" href="classFluide__Weakly__Compressible.html#a487df0b5183d65264c949936982d7547">Pth_n_tab_</a>= <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>; <span class="comment">//!&lt; previous dt</span>
<a name="l00312"></a>00312 <span class="comment"></span>  <a class="code" href="classFluide__Weakly__Compressible.html#a9ef2d2e98a8a63fd7609df7f8e030422">Fluide_Dilatable_base::update_pressure_fields</a>(temps);
<a name="l00313"></a>00313   <span class="keywordflow">if</span> (<a class="code" href="classMilieu__base.html#a060498efd2d447037010c610438bac7a" title="Renvoie 1 si la gravite a ete initialisee.">a_gravite</a>())
<a name="l00314"></a>00314     {
<a name="l00315"></a>00315       <a class="code" href="classFluide__Weakly__Compressible.html#a7e1c5ea1017f353bce0c52403e33bb86" title="Calcule la pression hydrostatique = rho*g*z.">calculer_pression_hydro</a>();
<a name="l00316"></a>00316       <a class="code" href="classFluide__Weakly__Compressible.html#a679d9d2f7b2424d88a626e58489001ed">pression_hydro_</a>.<a class="code" href="classChamp__Don.html#a8b0fe2933360f11ddc77237ee23b5b56" title="Appel a l&#39;objet sous-jacent Provoque la mise a jour du champ si il est instationnaire.">mettre_a_jour</a>(temps);
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318 <span class="comment">// for post-processing</span>
<a name="l00319"></a>00319   <a class="code" href="classFluide__Weakly__Compressible.html#a304ddcacdd5bf220d5c0c340f4ceee47">pression_eos_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>() = <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>;
<a name="l00320"></a>00320   <a class="code" href="classFluide__Weakly__Compressible.html#a304ddcacdd5bf220d5c0c340f4ceee47">pression_eos_</a>.<a class="code" href="classChamp__Don.html#a8b0fe2933360f11ddc77237ee23b5b56" title="Appel a l&#39;objet sous-jacent Provoque la mise a jour du champ si il est instationnaire.">mettre_a_jour</a>(temps);
<a name="l00321"></a>00321 }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323 <span class="comment">// Precondition:</span>
<a name="l00324"></a>00324 <span class="comment">// Parametre:</span>
<a name="l00325"></a>00325 <span class="comment">// Signification:</span>
<a name="l00326"></a>00326 <span class="comment">// Valeurs par defaut:</span>
<a name="l00327"></a>00327 <span class="comment">// Contraintes:</span>
<a name="l00328"></a>00328 <span class="comment">// Acces:</span>
<a name="l00329"></a>00329 <span class="comment">// </span>
<a name="l00330"></a>00330 <span class="comment">// Signification:</span>
<a name="l00331"></a>00331 <span class="comment">// Contraintes:</span>
<a name="l00332"></a>00332 <span class="comment">// Exception:</span>
<a name="l00333"></a>00333 <span class="comment">// Effets de bord:</span>
<a name="l00334"></a>00334 <span class="comment">// Postcondition:</span>
<a name="l00335"></a>00335 <span class="comment">//</span><span class="comment"></span>
<a name="l00336"></a>00336 <span class="comment">//! Calcule la pression totale : pression thermodynamique + pression hydrodynamique</span>
<a name="l00337"></a><a class="code" href="classFluide__Weakly__Compressible.html#a534d55afca683e95c3d75c2e4465a055">00337</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a534d55afca683e95c3d75c2e4465a055" title="Calcule la pression totale : pression thermodynamique + pression hydrodynamique.">Fluide_Weakly_Compressible::calculer_pression_tot</a>()
<a name="l00338"></a>00338 {
<a name="l00339"></a>00339   <a class="code" href="classFluide__Weakly__Compressible.html#a534d55afca683e95c3d75c2e4465a055" title="Calcule la pression totale : pression thermodynamique + pression hydrodynamique.">Fluide_Dilatable_base::calculer_pression_tot</a>();
<a name="l00340"></a>00340   <span class="keywordflow">if</span> (<a class="code" href="classFluide__Weakly__Compressible.html#a5aa41c68d8d3417a359f21b6f5fb2087">use_total_hydro_pressure</a>()) <a class="code" href="classFluide__Weakly__Compressible.html#a5e57afb165ad8dff2acbb9bdae4d634c" title="Calcule la pression utilisee dans les lois d&#39;etat WC.">remplir_champ_pression_for_EOS</a>();
<a name="l00341"></a>00341 }
<a name="l00342"></a>00342 
<a name="l00343"></a><a class="code" href="classFluide__Weakly__Compressible.html#a03351b4a3beecf572d7bf62153288441">00343</a> <span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a03351b4a3beecf572d7bf62153288441">Fluide_Weakly_Compressible::remplir_champ_pression_tot</a>(<span class="keywordtype">int</span> n, <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; PHydro, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; PTot)
<a name="l00344"></a>00344 {
<a name="l00345"></a>00345   <a class="code" href="classFluide__Weakly__Compressible.html#a876a6a40a356197cdb61bc20e00066e7">P_NS_</a> = PHydro;
<a name="l00346"></a>00346   <span class="keywordflow">if</span> ( <a class="code" href="classFluide__Weakly__Compressible.html#a88250f56e323d59f9f75c32896752b2a">use_pth_xyz</a>() )
<a name="l00347"></a>00347     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;n ; i++) PTot(i,0) = PHydro(i,0) + <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>(i,0);
<a name="l00348"></a>00348   <span class="keywordflow">else</span>
<a name="l00349"></a>00349     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;n ; i++) PTot(i,0) = PHydro(i,0) + <a class="code" href="classFluide__Dilatable__base.html#aa07d9ecb4d311a296048a52984ffabf5">Pth_</a>;
<a name="l00350"></a>00350 }
<a name="l00351"></a>00351 
<a name="l00352"></a>00352 <span class="comment">// Precondition:</span>
<a name="l00353"></a>00353 <span class="comment">// Parametre:</span>
<a name="l00354"></a>00354 <span class="comment">// Signification:</span>
<a name="l00355"></a>00355 <span class="comment">// Valeurs par defaut:</span>
<a name="l00356"></a>00356 <span class="comment">// Contraintes:</span>
<a name="l00357"></a>00357 <span class="comment">// Acces:</span>
<a name="l00358"></a>00358 <span class="comment">// </span>
<a name="l00359"></a>00359 <span class="comment">// Signification:</span>
<a name="l00360"></a>00360 <span class="comment">// Contraintes:</span>
<a name="l00361"></a>00361 <span class="comment">// Exception:</span>
<a name="l00362"></a>00362 <span class="comment">// Effets de bord:</span>
<a name="l00363"></a>00363 <span class="comment">// Postcondition:</span>
<a name="l00364"></a>00364 <span class="comment">//</span><span class="comment"></span>
<a name="l00365"></a>00365 <span class="comment">//! Calcule la pression hydrostatique = rho*g*z</span>
<a name="l00366"></a><a class="code" href="classFluide__Weakly__Compressible.html#a7e1c5ea1017f353bce0c52403e33bb86">00366</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a7e1c5ea1017f353bce0c52403e33bb86" title="Calcule la pression hydrostatique = rho*g*z.">Fluide_Weakly_Compressible::calculer_pression_hydro</a>()
<a name="l00367"></a>00367 {
<a name="l00368"></a>00368   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_Phydro = <a class="code" href="classFluide__Weakly__Compressible.html#a679d9d2f7b2424d88a626e58489001ed">pression_hydro_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00369"></a>00369   <span class="keyword">const</span> <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; zone_dis= <a class="code" href="classFluide__Dilatable__base.html#a70ea84e003f8dc51bf60736d571a2c99">pression_</a>-&gt; zone_dis_base();
<a name="l00370"></a>00370   <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zone = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, zone_dis);
<a name="l00371"></a>00371   <span class="keywordtype">int</span> is_VDF = zone_dis.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() == <span class="stringliteral">&quot;Zone_VDF&quot;</span> ? 1 : 0;
<a name="l00372"></a>00372   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; centres_de_gravites = is_VDF ? zone.<a class="code" href="classZone__VF.html#a87a29f0223c71256a25ee343c9277599">xp</a>() : zone.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00373"></a>00373   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_rho = <a class="code" href="classFluide__Dilatable__base.html#afb36969923a4290daaa50b16865f9aa6">rho_np1</a>(), grav = <a class="code" href="classMilieu__base.html#a206e8e71c6afc96f24a3963e5c65d865" title="Renvoie la gravite du milieu si elle a ete associe provoque une erreur sinon. (version const)...">gravite</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00374"></a>00374   <span class="keyword">const</span> <span class="keywordtype">int</span> n = tab_Phydro.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
<a name="l00375"></a>00375   assert (n ==  tab_rho.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0) &amp;&amp; <a class="code" href="classMilieu__base.html#a060498efd2d447037010c610438bac7a" title="Renvoie 1 si la gravite a ete initialisee.">a_gravite</a>());
<a name="l00376"></a>00376   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;n ; i++)
<a name="l00377"></a>00377     {
<a name="l00378"></a>00378       <span class="keywordtype">double</span> gz=0.;
<a name="l00379"></a>00379       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir=0; dir&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; dir++) gz+=centres_de_gravites(i,dir)*grav(0,dir);
<a name="l00380"></a>00380 
<a name="l00381"></a>00381       tab_Phydro(i) =  tab_rho(i)*gz;
<a name="l00382"></a>00382     }
<a name="l00383"></a>00383   <span class="keywordflow">if</span> (<a class="code" href="classFluide__Weakly__Compressible.html#a5aa41c68d8d3417a359f21b6f5fb2087">use_total_hydro_pressure</a>()) <a class="code" href="classFluide__Weakly__Compressible.html#a5e57afb165ad8dff2acbb9bdae4d634c" title="Calcule la pression utilisee dans les lois d&#39;etat WC.">remplir_champ_pression_for_EOS</a>();
<a name="l00384"></a>00384 }
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 <span class="comment">// Precondition:</span>
<a name="l00387"></a>00387 <span class="comment">// Parametre:</span>
<a name="l00388"></a>00388 <span class="comment">// Signification:</span>
<a name="l00389"></a>00389 <span class="comment">// Valeurs par defaut:</span>
<a name="l00390"></a>00390 <span class="comment">// Contraintes:</span>
<a name="l00391"></a>00391 <span class="comment">// Acces:</span>
<a name="l00392"></a>00392 <span class="comment">// </span>
<a name="l00393"></a>00393 <span class="comment">// Signification:</span>
<a name="l00394"></a>00394 <span class="comment">// Contraintes:</span>
<a name="l00395"></a>00395 <span class="comment">// Exception:</span>
<a name="l00396"></a>00396 <span class="comment">// Effets de bord:</span>
<a name="l00397"></a>00397 <span class="comment">// Postcondition:</span>
<a name="l00398"></a>00398 <span class="comment">//</span><span class="comment"></span>
<a name="l00399"></a>00399 <span class="comment">//! Calcule la pression utilisee dans les lois d&#39;etat WC</span>
<a name="l00400"></a><a class="code" href="classFluide__Weakly__Compressible.html#a5e57afb165ad8dff2acbb9bdae4d634c">00400</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classFluide__Weakly__Compressible.html#a5e57afb165ad8dff2acbb9bdae4d634c" title="Calcule la pression utilisee dans les lois d&#39;etat WC.">Fluide_Weakly_Compressible::remplir_champ_pression_for_EOS</a>()
<a name="l00401"></a>00401 {
<a name="l00402"></a>00402   <span class="keywordflow">if</span> (<a class="code" href="classFluide__Weakly__Compressible.html#a64bc05ea77aa7dff8fd2d366c171bbfc">use_total_pressure</a>())
<a name="l00403"></a>00403     {
<a name="l00404"></a>00404       <span class="keywordtype">double</span> t0= <a class="code" href="classFluide__Dilatable__base.html#a68f1590cd1e3864527256b45a92522f8">le_probleme_</a>-&gt;schema_temps().temps_courant(), t1 = <a class="code" href="classFluide__Dilatable__base.html#a68f1590cd1e3864527256b45a92522f8">le_probleme_</a>-&gt;schema_temps().temps_futur(1);
<a name="l00405"></a>00405 <span class="comment">// time to activate ptot and change the eos pressure</span>
<a name="l00406"></a>00406       <span class="keywordflow">if</span> ( t0 &lt; time_activate_ptot_ &amp;&amp; t1 &gt; <a class="code" href="classFluide__Weakly__Compressible.html#a64a91812d86348c70ff43e0401f71c6e">time_activate_ptot_</a> )
<a name="l00407"></a>00407         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;<a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0) ; i++) <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>(i,0) = <a class="code" href="classFluide__Weakly__Compressible.html#a876a6a40a356197cdb61bc20e00066e7">P_NS_</a>(i,0) + <a class="code" href="classFluide__Dilatable__base.html#aa07d9ecb4d311a296048a52984ffabf5">Pth_</a>;
<a name="l00408"></a>00408     }
<a name="l00409"></a>00409   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classFluide__Weakly__Compressible.html#a7ac23cc6aefa8c3730fe52115e0b5cd2">use_hydrostatic_pressure</a>())
<a name="l00410"></a>00410     {
<a name="l00411"></a>00411       <span class="keywordflow">if</span> ( <a class="code" href="classFluide__Dilatable__base.html#a68f1590cd1e3864527256b45a92522f8">le_probleme_</a>-&gt;schema_temps().nb_pas_dt() ==0 &amp;&amp; <a class="code" href="classFluide__Weakly__Compressible.html#ab4e368b7df633f22594439d2d786dc55">use_saved_data</a>() ) { <span class="comment">/* do nothing &amp;  use saved data */</span> }
<a name="l00412"></a>00412       <span class="keywordflow">else</span>
<a name="l00413"></a>00413         {
<a name="l00414"></a>00414           <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a> = <a class="code" href="classFluide__Weakly__Compressible.html#a679d9d2f7b2424d88a626e58489001ed">pression_hydro_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00415"></a>00415           <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
<a name="l00416"></a>00416           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;n ; i++) <a class="code" href="classFluide__Weakly__Compressible.html#a8f85afda514d5fe23b2dd3037dc82b78">Pth_tab_</a>(i) += <a class="code" href="classFluide__Dilatable__base.html#aa07d9ecb4d311a296048a52984ffabf5">Pth_</a>; <span class="comment">//!&lt; present dt</span>
<a name="l00417"></a>00417 <span class="comment"></span>        }
<a name="l00418"></a>00418     }
<a name="l00419"></a>00419   <span class="keywordflow">else</span>
<a name="l00420"></a>00420     {
<a name="l00421"></a>00421       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The method Fluide_Weakly_Compressible::remplir_champ_pression_for_EOS() should not be called !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00422"></a>00422       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00423"></a>00423     }
<a name="l00424"></a>00424 }
<a name="l00425"></a>00425 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:33 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
