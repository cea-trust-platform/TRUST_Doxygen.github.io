<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Utilitaires/Statistiques.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Utilitaires/Statistiques.h</div>  </div>
</div>
<div class="contents">
<a href="Statistiques_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2020, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Statistiques.h</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Utilitaires</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/10</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#ifndef Statistiques_included</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor">#define Statistiques_included</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00027"></a>00027 <span class="keyword">class </span><a class="code" href="classStat__Counter__Id.html">Stat_Counter_Id</a>;
<a name="l00028"></a>00028 <span class="keyword">class </span><a class="code" href="classStat__Results.html">Stat_Results</a>;
<a name="l00029"></a>00029 <span class="keyword">class </span><a class="code" href="classStat__Internals.html">Stat_Internals</a>;
<a name="l00030"></a>00030 <span class="keyword">class </span><a class="code" href="classTime.html">Time</a>;
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="comment">// si 1, permet de faire demarrer les compteurs seulement apres les 3 premiers pas de temps</span>
<a name="l00033"></a><a class="code" href="Statistiques_8h.html#a1bcfabda5482a837da0f52c13f997a92">00033</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="Statistiques_8h.html#a1bcfabda5482a837da0f52c13f997a92">JUMP_3_FIRST_STEPS</a> = 0;
<a name="l00034"></a>00034 <span class="comment">// si 1, permet de traquer les communications dans les fonctions souhaitees</span>
<a name="l00035"></a><a class="code" href="Statistiques_8h.html#a7f6c434cd21697d3bafbdc2433f06c37">00035</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="Statistiques_8h.html#a7f6c434cd21697d3bafbdc2433f06c37">GET_COMM_DETAILS</a> = 1;
<a name="l00036"></a>00036 
<a name="l00037"></a><a class="code" href="classStatistiques.html">00037</a> <span class="keyword">class </span><a class="code" href="classStatistiques.html">Statistiques</a>
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039 <span class="keyword">public</span>:
<a name="l00040"></a>00040   <a class="code" href="classStatistiques.html#a4ecd522328776fb86ba21d6a3dfe8d70">Statistiques</a>();
<a name="l00041"></a>00041   <a class="code" href="classStatistiques.html#a0b3904d9f448c4eb3c88074932c25051">~Statistiques</a>();
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">// Niveau de debug (on peut le changer en cours de calcul, cela</span>
<a name="l00044"></a>00044 <span class="comment">// permet d&#39;activer ou non les compteurs)</span>
<a name="l00045"></a>00045 <span class="comment">// !!! Cette fonction doit obligatoirement etre appelee simultanement sur tous</span>
<a name="l00046"></a>00046 <span class="comment">// les processeurs.</span>
<a name="l00047"></a>00047   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a4cd169e5658c3181ed233bf3b4259d05">set_debug_level</a>(<span class="keywordtype">int</span> level);
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="comment">// Creation d&#39;un nouveau compteur</span>
<a name="l00050"></a>00050 <span class="comment">// !!! Cette fonction doit obligatoirement etre appelee simultanement sur tous</span>
<a name="l00051"></a>00051 <span class="comment">// les processeurs.</span>
<a name="l00052"></a>00052 <span class="comment">// level : niveau de debug, superieur ou egal a 1 (compteur active si debug_level &gt;= level)</span>
<a name="l00053"></a>00053 <span class="comment">// description : description du compteur affichee a la fin du calcul (non nul !)</span>
<a name="l00054"></a>00054 <span class="comment">// Attention, on ne fait pas de copie locale de la chaine, le pointeur doit</span>
<a name="l00055"></a>00055 <span class="comment">// rester valide jusqu&#39;a la fin de l&#39;execution.</span>
<a name="l00056"></a>00056 <span class="comment">// family : eventuellement zero, nom d&#39;une famille de compteurs pour grouper les stats.</span>
<a name="l00057"></a>00057   <a class="code" href="classStat__Counter__Id.html">Stat_Counter_Id</a> <a class="code" href="classStatistiques.html#ae1d5ab3d7354d4f748173dde67f9912d">new_counter</a>(<span class="keywordtype">int</span> level,
<a name="l00058"></a>00058                               <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> description,
<a name="l00059"></a>00059                               <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> familly = 0,
<a name="l00060"></a>00060                               <span class="keywordtype">int</span> <a class="code" href="MD__Vector__tools_8cpp.html#aff39c4429f5c1b24eb7ac0848f154ffc">comm</a> = 0);
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">// L&#39;appel a begin_count est en deux etages pour mettre le test de debug_level</span>
<a name="l00063"></a>00063 <span class="comment">// en inline et pas les details d&#39;implementation.</span>
<a name="l00064"></a>00064 <span class="comment">// Les deux fonctions suivantes peuvent etre appelees sur un seul processeur</span>
<a name="l00065"></a>00065 <span class="comment">// track_comm permet d&#39;indiquer si l&#39;on souhaite egalement traquer les communications</span>
<a name="l00066"></a>00066   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#affcd058809786918ed173aaf681d0843">begin_count</a>(<span class="keyword">const</span> <a class="code" href="classStat__Counter__Id.html">Stat_Counter_Id</a>&amp; counter_id, <span class="keywordtype">bool</span> track_comm = <span class="keyword">true</span>);
<a name="l00067"></a>00067   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a0faf52d1b518f5b0b2177f22efcc222d" title="Arret du compteur counter_id. On ajoute quantity a la somme des &#39;quantity&#39; (par defaut 0) stockees po...">end_count</a>(<span class="keyword">const</span> <a class="code" href="classStat__Counter__Id.html">Stat_Counter_Id</a>&amp; counter_id, <span class="keywordtype">int</span> quantity = 0, <span class="keywordtype">int</span> count = 1, <span class="keywordtype">bool</span> track_comm = <span class="keyword">true</span>);
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="comment">// Renvoie le dernier intervalle de temps mesure par un compteur, en secondes</span>
<a name="l00071"></a>00071   <span class="keywordtype">double</span> <a class="code" href="classStatistiques.html#a21c24113a2042f33ce1134b473ebc1ac">last_time</a>(<span class="keyword">const</span> <a class="code" href="classStat__Counter__Id.html">Stat_Counter_Id</a>&amp; counter_id);
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="comment">// !!! Les trois fonctions suivantes doivent etre appelees simultanement</span>
<a name="l00074"></a>00074 <span class="comment">// sur tous les processeurs.</span>
<a name="l00075"></a>00075 <span class="comment">// Impression des statistiques par processeur et globales.</span>
<a name="l00076"></a>00076 <span class="comment">// Tous les compteurs en cours sont arretes.</span>
<a name="l00077"></a>00077 <span class="comment">// (les fichiers .TU sont ouverts en mode append)</span>
<a name="l00078"></a>00078   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a53b4c3f5e2690ed40586dc62e086c5a8">dump</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * message_info, <span class="keywordtype">int</span> mode_append);
<a name="l00079"></a>00079 <span class="comment">// Remise a zero de tous les compteurs</span>
<a name="l00080"></a>00080   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#ae51f47e953e4e439d0929e2f0283bdef">reset_counters</a>();
<a name="l00081"></a>00081 <span class="comment">// Remise a zero du compteur counter_id</span>
<a name="l00082"></a>00082 <span class="comment">// (certaines donnees sont conservees, comme counters_avg_min_max_var_per_step et communication_tracking_info)</span>
<a name="l00083"></a>00083   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a9dcac2b83caee9e5f27c55134f000efc">reset_counter</a>(<span class="keywordtype">int</span> counter_id);
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 <span class="comment">// Exploitation des resultats</span>
<a name="l00087"></a>00087 <span class="comment">// !!! Les 4 fonctions suivantes doivent etre appelees simultanement</span>
<a name="l00088"></a>00088 <span class="comment">// sur tous les processeurs</span>
<a name="l00089"></a>00089   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a854ef63a0b657c147bb625bce97e4f4f">stop_counters</a>();
<a name="l00090"></a>00090   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a9c05facd54b457e522edda7a77273e35">restart_counters</a>();
<a name="l00091"></a>00091   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#ab17d748f8771fe4ce1f9194348751ea6">get_stats</a>(<span class="keyword">const</span> <a class="code" href="classStat__Counter__Id.html">Stat_Counter_Id</a>&amp; counter_id, <a class="code" href="classStat__Results.html">Stat_Results</a>&amp; result);
<a name="l00092"></a>00092   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a7f24347674a21d35dfe89f9bb1159455">get_stats_familly</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * familly, <a class="code" href="classStat__Results.html">Stat_Results</a>&amp; result);
<a name="l00093"></a>00093   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a072a355a4ec8a3bae3afbbf11959a82e">cumulate_stats</a>(<span class="keywordtype">int</span> counter_id, <a class="code" href="classStat__Results.html">Stat_Results</a>&amp; result);
<a name="l00094"></a>00094 
<a name="l00095"></a><a class="code" href="classStatistiques.html#a80ee370e419ba628a5248030ca889935">00095</a>   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classStatistiques.html#a80ee370e419ba628a5248030ca889935">get_total_time</a>()
<a name="l00096"></a>00096   {
<a name="l00097"></a>00097     <span class="keywordflow">return</span> <a class="code" href="classStatistiques.html#aedc55c74ea44d73052ef59db108b45ed">total_time_</a>;
<a name="l00098"></a>00098   };
<a name="l00099"></a>00099   <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="classStatistiques.html#afce574b1c6577fa642d288f6a6bd0253" title="Cette methode renvoie un temps en secondes depuis une origine qui depend de la methode de mesure de l...">get_time_now</a>();
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 <span class="comment">// calcule les moyennes, minimum, maximum et variance des temps passes dans chaque compteur lors d&#39;une iteration</span>
<a name="l00102"></a>00102   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a79fc47f625b87bec7ebaa39d8e52b8e6">compute_avg_min_max_var_per_step</a>(<span class="keywordtype">int</span> tstep);
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="comment">// le tableau communication_tracking_times ne peut etre alloue qu&#39;apres la declaration de tous les compteurs</span>
<a name="l00106"></a>00106   <span class="keywordtype">int</span> <a class="code" href="classStatistiques.html#aeee98421824a65c16bfc1a2d7d3d124a">allocate_communication_tracking_times</a>();
<a name="l00107"></a>00107   <span class="keywordtype">int</span> <a class="code" href="classStatistiques.html#a058942e8d7a9f68ef7f1354b3bdb5a15">delete_communication_tracking_times</a>();
<a name="l00108"></a>00108 
<a name="l00109"></a>00109   <span class="comment">/* Debut de la zone de code dont on veut traquer les communications :</span>
<a name="l00110"></a>00110 <span class="comment">   * on sauvegarde toutes les donnees des compteurs de communication dans le tableau communication_tracking_times,</span>
<a name="l00111"></a>00111 <span class="comment">   * puis on les remet a zero</span>
<a name="l00112"></a>00112 <span class="comment">   * Donnee d&#39;entree:</span>
<a name="l00113"></a>00113 <span class="comment">   *    - cid : identifiant de la zone qu&#39;on souhaite initialiser</span>
<a name="l00114"></a>00114 <span class="comment">   */</span>
<a name="l00115"></a>00115   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#ad910ba9f3122d52d668205df343b4261">begin_communication_tracking</a>(<span class="keywordtype">int</span> cid);
<a name="l00116"></a>00116 
<a name="l00117"></a>00117   <span class="comment">/* Fin de la zone de code dont on veut traquer les communications :</span>
<a name="l00118"></a>00118 <span class="comment">   * on recupere toutes les donnees des compteurs de communication qui ont ete produites</span>
<a name="l00119"></a>00119 <span class="comment">   * depuis la derniere remise a zero des compteurs</span>
<a name="l00120"></a>00120 <span class="comment">   * Donnee d&#39;entree:</span>
<a name="l00121"></a>00121 <span class="comment">   *    - cid : identifiant de la zone</span>
<a name="l00122"></a>00122 <span class="comment">   */</span>
<a name="l00123"></a>00123   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a7f9d786ac1f129124a35a129d030ba3c">end_communication_tracking</a>(<span class="keywordtype">int</span> cid);
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   <span class="comment">/* Affichage des statistiques de communication collectees:</span>
<a name="l00126"></a>00126 <span class="comment">   *  - pour chaque zone de communication declaree,</span>
<a name="l00127"></a>00127 <span class="comment">   *  on affiche le temps qu&#39;on y a passe en moyenne sur chaque proc dans chaque type de communication</span>
<a name="l00128"></a>00128 <span class="comment">   *  - pour chaque type de communication,</span>
<a name="l00129"></a>00129 <span class="comment">   *   on affiche le temps passe en moyenne sur chaque proc dans chaque zone delcaree</span>
<a name="l00130"></a>00130 <span class="comment">   */</span>
<a name="l00131"></a>00131   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a54c730ed76d3e1ce710392295369acaa">print_communciation_tracking_details</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="Reordonner__faces__periodiques_8cpp.html#a137d78a01e63d3b66d1b2ed0de0f4c4c">message</a>, <span class="keywordtype">int</span> mode_append);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133   <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classStatistiques.html#a6eb7e07b408a25885a8f0fc540347e2c">get_counter_family</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>);
<a name="l00134"></a>00134   <span class="keywordtype">int</span> <a class="code" href="classStatistiques.html#a78ae177921fa3b206e6306a0d782eb18">get_counter_id_from_index_in_comm_tracking_info</a>(<span class="keywordtype">int</span> index) <span class="keyword">const</span>;
<a name="l00135"></a>00135   <span class="keywordtype">int</span> <a class="code" href="classStatistiques.html#a74267755e9d140d541ab4e29a356da98">get_index_in_comm_tracking_info_from_counter_id</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>) <span class="keyword">const</span>;
<a name="l00136"></a>00136   <span class="keywordtype">int</span> <a class="code" href="classStatistiques.html#aaf2bb44b91707e74de0c71449f2fdc91">get_nb_comm_counters</a>() <span class="keyword">const</span>;
<a name="l00137"></a>00137   <a class="code" href="classStat__Results.html">Stat_Results</a> <a class="code" href="classStatistiques.html#a3f4276aa8c867366d16dd5e59e6394f8">get_communication_tracking_info</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j) <span class="keyword">const</span>;
<a name="l00138"></a>00138 
<a name="l00139"></a><a class="code" href="classStatistiques.html#a158c544a2f113b60345e389a2130ba02">00139</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a158c544a2f113b60345e389a2130ba02">set_three_first_steps_elapsed</a>(<span class="keywordtype">bool</span> b)
<a name="l00140"></a>00140   {
<a name="l00141"></a>00141     <a class="code" href="classStatistiques.html#a91eedfbf675836564ff5d7250a31a85c">three_first_steps_elapsed_</a> = b;
<a name="l00142"></a>00142   }
<a name="l00143"></a>00143 
<a name="l00144"></a>00144   <span class="keywordtype">int</span> <a class="code" href="classStatistiques.html#a9d583f199fceea865e1a064bc11ef0d4">get_counter_id_from_description</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* desc) <span class="keyword">const</span>;
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 <span class="keyword">protected</span>:
<a name="l00147"></a>00147 <span class="comment">// Les deux fonctions suivantes peuvent etre appelees sur un seul processeur</span>
<a name="l00148"></a>00148   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#ae1be075c9bd65c1534af067cfcee76c6">begin_count_</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> id_);
<a name="l00149"></a>00149   <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a068333577be7c53eeb27d2f067ed6b36">end_count_</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> id_, <span class="keywordtype">int</span> quantity, <span class="keywordtype">int</span> count);
<a name="l00150"></a>00150 
<a name="l00151"></a><a class="code" href="classStatistiques.html#a9cb454c21eb3395788b2bf386c103acb">00151</a>   <span class="keywordtype">int</span> <a class="code" href="classStatistiques.html#a9cb454c21eb3395788b2bf386c103acb">debug_level_</a>;
<a name="l00152"></a><a class="code" href="classStatistiques.html#ab06bd0468225719a0aa8b83960445575">00152</a>   <a class="code" href="classStat__Internals.html">Stat_Internals</a> * <a class="code" href="classStatistiques.html#ab06bd0468225719a0aa8b83960445575">stat_internals</a>;
<a name="l00153"></a><a class="code" href="classStatistiques.html#aedc55c74ea44d73052ef59db108b45ed">00153</a>   <span class="keywordtype">double</span> <a class="code" href="classStatistiques.html#aedc55c74ea44d73052ef59db108b45ed">total_time_</a>;
<a name="l00154"></a><a class="code" href="classStatistiques.html#a91eedfbf675836564ff5d7250a31a85c">00154</a>   <span class="keywordtype">bool</span> <a class="code" href="classStatistiques.html#a91eedfbf675836564ff5d7250a31a85c">three_first_steps_elapsed_</a>;  <span class="comment">//si true, indique que les 3 premiers pas de temps sont passes</span>
<a name="l00155"></a>00155 
<a name="l00156"></a>00156 };
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="comment">// Ceci est l&#39;identifiant fourni a l&#39;utilisateur pour acceder au compteur</span>
<a name="l00161"></a>00161 <span class="comment">// qu&#39;il a cree.</span>
<a name="l00162"></a><a class="code" href="classStat__Counter__Id.html">00162</a> <span class="keyword">class </span><a class="code" href="classStat__Counter__Id.html">Stat_Counter_Id</a>
<a name="l00163"></a>00163 {
<a name="l00164"></a>00164 <span class="keyword">public</span>:
<a name="l00165"></a><a class="code" href="classStat__Counter__Id.html#ad3339bb7535d615cc2d0aead52fa0360">00165</a>   <a class="code" href="classStat__Counter__Id.html#ad3339bb7535d615cc2d0aead52fa0360">Stat_Counter_Id</a>() : <a class="code" href="classStat__Counter__Id.html#a33db57ea355a4567d6677d71bde15901">id_</a>(-1), <a class="code" href="classStat__Counter__Id.html#a4661ade22736bb354f0e0e9145098e29">level_</a>(-1) {};
<a name="l00166"></a><a class="code" href="classStat__Counter__Id.html#a5633d67db7f5b75e6b4bd1be55a4133e">00166</a>   <span class="keywordtype">int</span> <a class="code" href="classStat__Counter__Id.html#a5633d67db7f5b75e6b4bd1be55a4133e">initialized</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00167"></a>00167 <span class="keyword">  </span>{
<a name="l00168"></a>00168     <span class="keywordflow">return</span> <a class="code" href="classStat__Counter__Id.html#a33db57ea355a4567d6677d71bde15901">id_</a> &gt;= 0;
<a name="l00169"></a>00169   };
<a name="l00170"></a><a class="code" href="classStat__Counter__Id.html#ae79505902274a860ed0d9d46e767b0b9">00170</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classStat__Counter__Id.html#ae79505902274a860ed0d9d46e767b0b9">id</a>()<span class="keyword"> const</span>
<a name="l00171"></a>00171 <span class="keyword">  </span>{
<a name="l00172"></a>00172     <span class="keywordflow">return</span> <a class="code" href="classStat__Counter__Id.html#a33db57ea355a4567d6677d71bde15901">id_</a>;
<a name="l00173"></a>00173   };
<a name="l00174"></a>00174 <span class="keyword">protected</span>:
<a name="l00175"></a><a class="code" href="classStat__Counter__Id.html#a8d5774a1e75ba378a3c17a70b417c063">00175</a>   <a class="code" href="classStat__Counter__Id.html#ad3339bb7535d615cc2d0aead52fa0360">Stat_Counter_Id</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> level) : <a class="code" href="classStat__Counter__Id.html#a33db57ea355a4567d6677d71bde15901">id_</a>(i), <a class="code" href="classStat__Counter__Id.html#a4661ade22736bb354f0e0e9145098e29">level_</a>(level) {};
<a name="l00176"></a>00176   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classStatistiques.html">Statistiques</a>;
<a name="l00177"></a><a class="code" href="classStat__Counter__Id.html#a33db57ea355a4567d6677d71bde15901">00177</a>   <span class="keywordtype">int</span> <a class="code" href="classStat__Counter__Id.html#a33db57ea355a4567d6677d71bde15901">id_</a>;
<a name="l00178"></a><a class="code" href="classStat__Counter__Id.html#a4661ade22736bb354f0e0e9145098e29">00178</a>   <span class="keywordtype">int</span> <a class="code" href="classStat__Counter__Id.html#a4661ade22736bb354f0e0e9145098e29">level_</a>;
<a name="l00179"></a>00179 <span class="comment">// Le niveau de debug est stocke ici pour un acces rapide</span>
<a name="l00180"></a>00180 <span class="comment">// lors de l&#39;appel a begin et end, il est aussi stocke dans</span>
<a name="l00181"></a>00181 <span class="comment">// Stat_Internals...</span>
<a name="l00182"></a>00182 };
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="comment">// La definition de ce pointeur est dans Statistiques.cpp</span>
<a name="l00185"></a>00185 <span class="comment">// NE PAS UTILISER CE POINTEUR DIRECTEMENT !</span>
<a name="l00186"></a>00186 <span class="comment">// Utiliser la methode d&#39;acces statistiques()</span>
<a name="l00187"></a>00187 <span class="keyword">class </span><a class="code" href="classStatistiques.html">Statistiques</a>;
<a name="l00188"></a>00188 <span class="keyword">extern</span> <a class="code" href="classStatistiques.html">Statistiques</a> * <a class="code" href="Statistiques_8cpp.html#a512a2b3ab1289af1ee1131d49e7a0d4b">les_statistiques_trio_U_nom_long_pour_decourager_l_utilisation_directe</a>;
<a name="l00189"></a>00189 
<a name="l00190"></a><a class="code" href="Statistiques_8h.html#a7bb2ce53a9ec088bba93ddcfce2b8cb1">00190</a> <span class="keyword">inline</span> <a class="code" href="classStatistiques.html">Statistiques</a>&amp; <a class="code" href="Statistiques_8h.html#a7bb2ce53a9ec088bba93ddcfce2b8cb1">statistiques</a>()
<a name="l00191"></a>00191 {
<a name="l00192"></a>00192   assert(les_statistiques_trio_U_nom_long_pour_decourager_l_utilisation_directe);
<a name="l00193"></a>00193   <span class="keywordflow">return</span> *<a class="code" href="Statistiques_8cpp.html#a512a2b3ab1289af1ee1131d49e7a0d4b">les_statistiques_trio_U_nom_long_pour_decourager_l_utilisation_directe</a>;
<a name="l00194"></a>00194 }
<a name="l00195"></a>00195 
<a name="l00196"></a>00196 <span class="comment">// Les details d&#39;implementation de Stat sont separes de Stat pour ne pas avoir</span>
<a name="l00197"></a>00197 <span class="comment">// a tout recompiler si on change Stat.</span>
<a name="l00198"></a>00198 <span class="keyword">class </span><a class="code" href="classStat__Internals.html">Stat_Internals</a>;
<a name="l00199"></a>00199 
<a name="l00200"></a><a class="code" href="classStat__Results.html">00200</a> <span class="keyword">class </span><a class="code" href="classStat__Results.html">Stat_Results</a>
<a name="l00201"></a>00201 {
<a name="l00202"></a>00202 <span class="keyword">public</span>:
<a name="l00203"></a><a class="code" href="classStat__Results.html#ac077a5a6df8fa16d12a079e8915fe5f8">00203</a>   <a class="code" href="classStat__Results.html#ac077a5a6df8fa16d12a079e8915fe5f8">Stat_Results</a>() : <a class="code" href="classStat__Results.html#a9ac46c2ac7225154b6893ac453e214ef">time</a>(0.0), <a class="code" href="classStat__Results.html#adf949d6c6658bccf46a263be04686a7a">min_time</a>(0.0), <a class="code" href="classStat__Results.html#a94dd53d2de3c447c34b5ed4d7c5aae25">max_time</a>(0.0), <a class="code" href="classStat__Results.html#a95d9ababbcf6e244207d7bec0ca67e84">avg_time</a>(0.0),
<a name="l00204"></a>00204     <a class="code" href="classStat__Results.html#a616f30fa3456aa88ed6b4c3f07c3f3d9">count</a>(0.0), <a class="code" href="classStat__Results.html#a62ed408ed837866dad9f23c9c9d23876">min_count</a>(0.0), <a class="code" href="classStat__Results.html#a75a8974bd6d2cb5f01f4cc9ad3d5b8cd">max_count</a>(0.0), <a class="code" href="classStat__Results.html#ac0bc2b3429e4545adcbb753c3edcdb44">avg_count</a>(0.0),
<a name="l00205"></a><a class="code" href="classStat__Results.html#a9ac46c2ac7225154b6893ac453e214ef">00205</a>     <a class="code" href="classStat__Results.html#affd1c9ac470125e25e499ca637e94f94">quantity</a>(0.0), <a class="code" href="classStat__Results.html#a0b52525cdfb7f79c065734d230ee3a83">min_quantity</a>(0.0), <a class="code" href="classStat__Results.html#aec36e8a11ca9889123bc5fc53d28b3ea">max_quantity</a>(0.0), <a class="code" href="classStat__Results.html#a26d15e661803c10b0be24f02b5b6f978">avg_quantity</a>(0.0) {};
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 <span class="comment">// Cumul de temps, min max et moyenne sur les differents processeurs</span>
<a name="l00208"></a>00208   <span class="keywordtype">double</span> <a class="code" href="classStat__Results.html#a9ac46c2ac7225154b6893ac453e214ef">time</a>, <a class="code" href="classStat__Results.html#adf949d6c6658bccf46a263be04686a7a">min_time</a>, <a class="code" href="classStat__Results.html#a94dd53d2de3c447c34b5ed4d7c5aae25">max_time</a>, <a class="code" href="classStat__Results.html#a95d9ababbcf6e244207d7bec0ca67e84">avg_time</a>;
<a name="l00209"></a>00209 <span class="comment">// Nombre de comptages</span>
<a name="l00210"></a><a class="code" href="classStat__Results.html#a62ed408ed837866dad9f23c9c9d23876">00210</a>   <span class="keywordtype">double</span> <a class="code" href="classStat__Results.html#a616f30fa3456aa88ed6b4c3f07c3f3d9">count</a>, <a class="code" href="classStat__Results.html#a62ed408ed837866dad9f23c9c9d23876">min_count</a>, <a class="code" href="classStat__Results.html#a75a8974bd6d2cb5f01f4cc9ad3d5b8cd">max_count</a>, <a class="code" href="classStat__Results.html#ac0bc2b3429e4545adcbb753c3edcdb44">avg_count</a>;
<a name="l00211"></a>00211 <span class="comment">// Cumul des quantites comptees</span>
<a name="l00212"></a><a class="code" href="classStat__Results.html#affd1c9ac470125e25e499ca637e94f94">00212</a>   <span class="keywordtype">double</span> <a class="code" href="classStat__Results.html#affd1c9ac470125e25e499ca637e94f94">quantity</a>, <a class="code" href="classStat__Results.html#a0b52525cdfb7f79c065734d230ee3a83">min_quantity</a>, <a class="code" href="classStat__Results.html#aec36e8a11ca9889123bc5fc53d28b3ea">max_quantity</a>, <a class="code" href="classStat__Results.html#a26d15e661803c10b0be24f02b5b6f978">avg_quantity</a>;
<a name="l00213"></a>00213 
<a name="l00214"></a>00214   <span class="keywordtype">void</span> <a class="code" href="classStat__Results.html#a3a05bd3af5a7f6eac5d08c7cd4cdf3e8">compute_min_max_avg</a>();  <span class="comment">//calcule le min, le max et la moyenne des temps sur les procs</span>
<a name="l00215"></a>00215 
<a name="l00216"></a>00216   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classStat__Results.html#adf1894eaee9742004680be08cb5470de">reset</a>();
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 };
<a name="l00219"></a><a class="code" href="classStatistiques.html#affcd058809786918ed173aaf681d0843">00219</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#affcd058809786918ed173aaf681d0843">Statistiques::begin_count</a>(<span class="keyword">const</span> <a class="code" href="classStat__Counter__Id.html">Stat_Counter_Id</a>&amp; counter_id, <span class="keywordtype">bool</span> track_comm)
<a name="l00220"></a>00220 {
<a name="l00221"></a>00221   assert(counter_id.<a class="code" href="classStat__Counter__Id.html#a5633d67db7f5b75e6b4bd1be55a4133e">initialized</a>());
<a name="l00222"></a>00222   <span class="keywordflow">if</span> (counter_id.<a class="code" href="classStat__Counter__Id.html#a4661ade22736bb354f0e0e9145098e29">level_</a> &lt;= <a class="code" href="classStatistiques.html#a9cb454c21eb3395788b2bf386c103acb">debug_level_</a>)
<a name="l00223"></a>00223     {
<a name="l00224"></a>00224       <a class="code" href="classStatistiques.html#ae1be075c9bd65c1534af067cfcee76c6">begin_count_</a>(counter_id.<a class="code" href="classStat__Counter__Id.html#a33db57ea355a4567d6677d71bde15901">id_</a>);
<a name="l00225"></a>00225       <span class="keywordflow">if</span>(track_comm) <a class="code" href="classStatistiques.html#ad910ba9f3122d52d668205df343b4261">begin_communication_tracking</a>(counter_id.<a class="code" href="classStat__Counter__Id.html#a33db57ea355a4567d6677d71bde15901">id_</a>);
<a name="l00226"></a>00226     }
<a name="l00227"></a>00227 
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 
<a name="l00230"></a>00230 }
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="comment">//</span>
<a name="l00233"></a>00233 <span class="comment">//</span>
<a name="l00234"></a>00234 <span class="comment">//</span>
<a name="l00235"></a>00235 <span class="comment">//</span><span class="comment"></span>
<a name="l00236"></a>00236 <span class="comment">//! Arret du compteur counter_id. On ajoute quantity a la somme des&lt;br&gt;&#39;quantity&#39; (par defaut 0) stockees pour ce compteur&lt;br&gt;et on ajoute &#39;count&#39; (par defaut 1) au compteur d&#39;appels a end_count pour ce compteur&lt;br&gt;(quantity sert a sommer par exemple la taille des donnees traitees pendant ce comptage&lt;br&gt;et count sert a compter combien de fois on a appele ce compteur)</span>
<a name="l00237"></a><a class="code" href="classStatistiques.html#a0faf52d1b518f5b0b2177f22efcc222d">00237</a> <span class="comment"></span><span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classStatistiques.html#a0faf52d1b518f5b0b2177f22efcc222d" title="Arret du compteur counter_id. On ajoute quantity a la somme des &#39;quantity&#39; (par defaut 0) stockees po...">Statistiques::end_count</a>(<span class="keyword">const</span> <a class="code" href="classStat__Counter__Id.html">Stat_Counter_Id</a>&amp; counter_id,
<a name="l00238"></a>00238                                     <span class="keywordtype">int</span> quantity,
<a name="l00239"></a>00239                                     <span class="keywordtype">int</span> count,
<a name="l00240"></a>00240                                     <span class="keywordtype">bool</span> track_comm)
<a name="l00241"></a>00241 {
<a name="l00242"></a>00242   assert(counter_id.<a class="code" href="classStat__Counter__Id.html#a5633d67db7f5b75e6b4bd1be55a4133e">initialized</a>());
<a name="l00243"></a>00243   <span class="keywordflow">if</span> (counter_id.<a class="code" href="classStat__Counter__Id.html#a4661ade22736bb354f0e0e9145098e29">level_</a> &lt;= <a class="code" href="classStatistiques.html#a9cb454c21eb3395788b2bf386c103acb">debug_level_</a>)
<a name="l00244"></a>00244     {
<a name="l00245"></a>00245       <a class="code" href="classStatistiques.html#a068333577be7c53eeb27d2f067ed6b36">end_count_</a>(counter_id.<a class="code" href="classStat__Counter__Id.html#a33db57ea355a4567d6677d71bde15901">id_</a>, quantity, count);
<a name="l00246"></a>00246       <span class="keywordflow">if</span>(track_comm) <a class="code" href="classStatistiques.html#a7f9d786ac1f129124a35a129d030ba3c">end_communication_tracking</a>(counter_id.<a class="code" href="classStat__Counter__Id.html#a33db57ea355a4567d6677d71bde15901">id_</a>);
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 
<a name="l00254"></a><a class="code" href="classStat__Results.html#adf1894eaee9742004680be08cb5470de">00254</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classStat__Results.html#adf1894eaee9742004680be08cb5470de">Stat_Results::reset</a>()
<a name="l00255"></a>00255 {
<a name="l00256"></a>00256 
<a name="l00257"></a>00257   <a class="code" href="classStat__Results.html#a9ac46c2ac7225154b6893ac453e214ef">time</a>=0.0, <a class="code" href="classStat__Results.html#adf949d6c6658bccf46a263be04686a7a">min_time</a>=0.0, <a class="code" href="classStat__Results.html#a94dd53d2de3c447c34b5ed4d7c5aae25">max_time</a>=0.0, <a class="code" href="classStat__Results.html#a95d9ababbcf6e244207d7bec0ca67e84">avg_time</a>=0.0;
<a name="l00258"></a>00258   <a class="code" href="classStat__Results.html#a616f30fa3456aa88ed6b4c3f07c3f3d9">count</a>=0.0, <a class="code" href="classStat__Results.html#a62ed408ed837866dad9f23c9c9d23876">min_count</a>=0.0, <a class="code" href="classStat__Results.html#a75a8974bd6d2cb5f01f4cc9ad3d5b8cd">max_count</a>=0.0, <a class="code" href="classStat__Results.html#ac0bc2b3429e4545adcbb753c3edcdb44">avg_count</a>=0.0;
<a name="l00259"></a>00259   <a class="code" href="classStat__Results.html#affd1c9ac470125e25e499ca637e94f94">quantity</a>=0.0, <a class="code" href="classStat__Results.html#a0b52525cdfb7f79c065734d230ee3a83">min_quantity</a>=0.0, <a class="code" href="classStat__Results.html#aec36e8a11ca9889123bc5fc53d28b3ea">max_quantity</a>=0.0, <a class="code" href="classStat__Results.html#a26d15e661803c10b0be24f02b5b6f978">avg_quantity</a>=0.0;
<a name="l00260"></a>00260 }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="preprocessor">#endif</span>
<a name="l00263"></a>00263 <span class="preprocessor"></span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:28 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
