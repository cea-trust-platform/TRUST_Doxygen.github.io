<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VDF/Operateurs/Operateurs_Diff/Op_Dift_VDF_Face_Axi.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VDF/Operateurs/Operateurs_Diff/Op_Dift_VDF_Face_Axi.cpp</div>  </div>
</div>
<div class="contents">
<a href="Op__Dift__VDF__Face__Axi_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Op_Dift_VDF_Face_Axi.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VDF/Operateurs/Operateurs_Diff</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/28</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Op__Dift__VDF__Face__Axi_8h.html">Op_Dift_VDF_Face_Axi.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps_8h.html">Schema_Temps.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Champ__base_8h.html">Champ_base.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="SFichier_8h.html">SFichier.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Mod__turb__hyd__base_8h.html">Mod_turb_hyd_base.h</a>&gt;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a><a class="code" href="Op__Dift__VDF__Face__Axi_8cpp.html#ab642097d08728df5720842eecdbd14d1">00029</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classOp__Dift__VDF__Face__Axi.html" title="class Op_Dift_VDF_Face_Axi Cette classe represente l&#39;operateur de diffusion global (diffusions lamina...">Op_Dift_VDF_Face_Axi</a>,<span class="stringliteral">&quot;Op_Dift_VDF_Face_Axi&quot;</span>,<a class="code" href="classOp__Dift__VDF__Face__base.html">Op_Dift_VDF_Face_base</a>);
<a name="l00030"></a>00030 
<a name="l00031"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#a86d91cea1fe5fc06ed606cb3373173d3">00031</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a86d91cea1fe5fc06ed606cb3373173d3" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Dift_VDF_Face_Axi::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00032"></a>00032 <span class="keyword"></span>{
<a name="l00033"></a>00033   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() ;
<a name="l00034"></a>00034 }
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#a1bda904851a58de9ad6e0760e34411ed">00036</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a1bda904851a58de9ad6e0760e34411ed" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Dift_VDF_Face_Axi::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s )
<a name="l00037"></a>00037 {
<a name="l00038"></a>00038   <span class="keywordflow">return</span> s ;
<a name="l00039"></a>00039 }
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#af66116e1f437db7b5f43ebe6ffa98b3d">00041</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#af66116e1f437db7b5f43ebe6ffa98b3d" title="complete l&#39;iterateur et l&#39;evaluateur">Op_Dift_VDF_Face_Axi::associer</a>(<span class="keyword">const</span> <a class="code" href="classZone__dis.html" title="classe Zone_dis Classe generique de la hierarchie des zones discretisees. Un objet de type Zone_dis p...">Zone_dis</a>&amp; zone_dis,
<a name="l00042"></a>00042                                     <span class="keyword">const</span> <a class="code" href="classZone__Cl__dis.html" title="classe Zone_Cl_dis Classe generique de la hierarchie des conditions aux limites discretisees. Un objet Zone_Cl_dis peut referencer n&#39;importe quel derivant de Zone_Cl_dis_base. La plupart des methodes appellent les methodes de l&#39;objet Probleme sous-jacent via la methode valeur() declaree grace a la macro Declare_deriv().;">Zone_Cl_dis</a>&amp; zone_cl_dis,
<a name="l00043"></a>00043                                     <span class="keyword">const</span> <a class="code" href="classChamp__Inc.html">Champ_Inc</a>&amp; ch_transporte)
<a name="l00044"></a>00044 {
<a name="l00045"></a>00045   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>,zone_dis.<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>());
<a name="l00046"></a>00046   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; zclvdf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>,zone_cl_dis.<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00047"></a>00047   <span class="keyword">const</span> <a class="code" href="classChamp__Face.html" title="class Champ_Face Cette classe sert a representer un champ vectoriel dont on ne calcule que les compos...">Champ_Face</a>&amp; inco = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Face.html" title="class Champ_Face Cette classe sert a representer un champ vectoriel dont on ne calcule que les compos...">Champ_Face</a>,ch_transporte.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>());
<a name="l00048"></a>00048   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a1c5f1cbcfc6e7c97490fa04287a8d989">la_zone_vdf</a> = zvdf;
<a name="l00049"></a>00049   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae1c32a53f9159425724fae235f5c0ef8">la_zcl_vdf</a> = zclvdf;
<a name="l00050"></a>00050   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#aaa1c42e7200c0fe959fe8a1e7498a113">inconnue</a> = inco;
<a name="l00051"></a>00051 
<a name="l00052"></a>00052   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>.<a class="code" href="classDoubleVect.html#a2b45ece955d7d57746fa32b5a6a89cc2" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(zvdf.<a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>());
<a name="l00053"></a>00053   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>.<a class="code" href="classDoubleVect.html#a2b45ece955d7d57746fa32b5a6a89cc2" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(zvdf.<a class="code" href="classZone__VF.html#a64f0b549e5aea1656855113e3510f418">volumes_entrelaces</a>());
<a name="l00054"></a>00054   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>.<a class="code" href="classIntVect.html#a165455689c6d27ac93c9cf8823e47a0f" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(zvdf.<a class="code" href="classZone__VDF.html#a9a9bd747218e463b3408a3590c12814c" title="inline DoubleVect&amp; Zone_VDF::porosite_face() { return porosite_face_; }">orientation</a>());
<a name="l00055"></a>00055   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>.<a class="code" href="classDoubleVect.html#a2b45ece955d7d57746fa32b5a6a89cc2" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(zvdf.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>());
<a name="l00056"></a>00056   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ab8cdb98f344dd0438605ff6cba36e2a7">xp</a>.<a class="code" href="classDoubleTab.html#afc7cddeeec2c80636e54eaf330ac41ad" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(zvdf.<a class="code" href="classZone__VF.html#a87a29f0223c71256a25ee343c9277599">xp</a>());
<a name="l00057"></a>00057   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>.<a class="code" href="classDoubleTab.html#afc7cddeeec2c80636e54eaf330ac41ad" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(zvdf.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>());
<a name="l00058"></a>00058   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>.<a class="code" href="classIntTab.html#ae9ae8fefb1fda4a5c035229ab420a96d" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(zvdf.<a class="code" href="classZone__VDF.html#a5383bb6bad103f0b37e3862e112f9370">Qdm</a>());
<a name="l00059"></a>00059   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>.<a class="code" href="classIntTab.html#ae9ae8fefb1fda4a5c035229ab420a96d" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(zvdf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>());
<a name="l00060"></a>00060   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>.<a class="code" href="classIntTab.html#ae9ae8fefb1fda4a5c035229ab420a96d" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(zvdf.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>());
<a name="l00061"></a>00061   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae8a443e04bc8afc20a83e550509af995">type_arete_bord</a>.<a class="code" href="classIntVect.html#a165455689c6d27ac93c9cf8823e47a0f" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(zclvdf.type_arete_bord());
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 
<a name="l00064"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#a83e7b491b700fe12eaea62ab4f4eb9d6">00064</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a83e7b491b700fe12eaea62ab4f4eb9d6" title="Associe l&#39;operateur a la zone_dis, la zone_Cl_dis, et a l&#39;inconnue de son equation.">Op_Dift_VDF_Face_Axi::completer</a>()
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a83e7b491b700fe12eaea62ab4f4eb9d6" title="Associe l&#39;operateur a la zone_dis, la zone_Cl_dis, et a l&#39;inconnue de son equation.">Op_Dift_VDF_base::completer</a>();
<a name="l00067"></a>00067   <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn_hydr = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>();
<a name="l00068"></a>00068   <a class="code" href="classChamp__Face.html" title="class Champ_Face Cette classe sert a representer un champ vectoriel dont on ne calcule que les compos...">Champ_Face</a>&amp; vitesse = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Face.html" title="class Champ_Face Cette classe sert a representer un champ vectoriel dont on ne calcule que les compos...">Champ_Face</a>,eqn_hydr.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>());
<a name="l00069"></a>00069   vitesse.<a class="code" href="classChamp__Face.html#a162a801021b0a2b56da18301d490f715">dimensionner_tenseur_Grad</a>();
<a name="l00070"></a>00070   <span class="keyword">const</span> <a class="code" href="classRef__Objet__U.html">RefObjU</a>&amp; modele_turbulence = eqn_hydr.<a class="code" href="classEquation__base.html#ab0bb5d06bdc91e131dc9d5f9d7b57095">get_modele</a>(<a class="code" href="Equation__base_8h.html#a2c9d34b2cc47e5b2b18347de20a77db5a0fecbd75e0b8b4c37ffd696e173a14c7">TURBULENCE</a>);
<a name="l00071"></a>00071   <span class="keyword">const</span> <a class="code" href="classMod__turb__hyd__base.html" title="Classe Mod_turb_hyd_base Cette classe sert de base a la hierarchie des classes qui representent un mo...">Mod_turb_hyd_base</a>&amp; mod_turb = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMod__turb__hyd__base.html" title="Classe Mod_turb_hyd_base Cette classe sert de base a la hierarchie des classes qui representent un mo...">Mod_turb_hyd_base</a>,modele_turbulence.<a class="code" href="classRef__Objet__U.html#ad875112c0fd275aa0c0aa710481ab11e">valeur</a>());
<a name="l00072"></a>00072   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a248d31d89f99b64b1e0f1a6c8a648769">associer_modele_turbulence</a>(mod_turb);
<a name="l00073"></a>00073 }
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 <span class="comment">//</span><span class="comment"></span>
<a name="l00076"></a>00076 <span class="comment">//! associe le champ de diffusivite</span>
<a name="l00077"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#a2ab7f861a72b9d4d9542a278c8af992e">00077</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a2ab7f861a72b9d4d9542a278c8af992e" title="associe le champ de diffusivite">Op_Dift_VDF_Face_Axi::associer_diffusivite</a>(<span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; diffu)
<a name="l00078"></a>00078 {
<a name="l00079"></a>00079   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a426fbfc5eea20776019057b9b366573b">diffusivite_</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Uniforme.html" title="classe Champ_Uniforme Represente un champ constant dans l&#39;espace et dans le temps.">Champ_Uniforme</a>, diffu);
<a name="l00080"></a>00080 }
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#a46e6ea12aec45fd8fc1c95ad42998e4d">00082</a> <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a46e6ea12aec45fd8fc1c95ad42998e4d">Op_Dift_VDF_Face_Axi::diffusivite</a>()<span class="keyword"> const</span>
<a name="l00083"></a>00083 <span class="keyword"></span>{
<a name="l00084"></a>00084   <span class="keywordflow">return</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a426fbfc5eea20776019057b9b366573b">diffusivite_</a>;
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00087"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#ad1d430916e7a7b74445c791ef4fcd97a">00087</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ad1d430916e7a7b74445c791ef4fcd97a">Op_Dift_VDF_Face_Axi::associer_diffusivite_turbulente</a>(<span class="keyword">const</span> <a class="code" href="classChamp__Fonc.html" title="classe Champ_Fonc Classe generique de la hierarchie des champs fontions du temps, un objet Champ_Fonc...">Champ_Fonc</a>&amp; visc_turb)
<a name="l00088"></a>00088 {
<a name="l00089"></a>00089   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ad1d430916e7a7b74445c791ef4fcd97a">Op_Diff_Turbulent_base::associer_diffusivite_turbulente</a>(visc_turb);
<a name="l00090"></a>00090 }
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#a42a3e2e1b07053d9957894e71c850d30">00092</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a42a3e2e1b07053d9957894e71c850d30">Op_Dift_VDF_Face_Axi::associer_loipar</a>(<span class="keyword">const</span> <a class="code" href="classTurbulence__paroi.html" title="Classe Turbulence_paroi Classe generique de la hierarchie des turbulences au niveau de la paroi...">Turbulence_paroi</a>&amp; loi_paroi)
<a name="l00093"></a>00093 {
<a name="l00094"></a>00094 <span class="comment">// loipar = loi_paroi;</span>
<a name="l00095"></a>00095 }
<a name="l00096"></a>00096 
<a name="l00097"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#a248d31d89f99b64b1e0f1a6c8a648769">00097</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a248d31d89f99b64b1e0f1a6c8a648769">Op_Dift_VDF_Face_Axi::associer_modele_turbulence</a>(<span class="keyword">const</span> <a class="code" href="classMod__turb__hyd__base.html" title="Classe Mod_turb_hyd_base Cette classe sert de base a la hierarchie des classes qui representent un mo...">Mod_turb_hyd_base</a>&amp; mod)
<a name="l00098"></a>00098 {
<a name="l00099"></a>00099   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#acb3012989f94a20d224ac904906d26ce">le_modele_turbulence</a> = mod;
<a name="l00100"></a>00100   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ad1d430916e7a7b74445c791ef4fcd97a">associer_diffusivite_turbulente</a>(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#acb3012989f94a20d224ac904906d26ce">le_modele_turbulence</a>-&gt;viscosite_turbulente());
<a name="l00101"></a>00101   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a42a3e2e1b07053d9957894e71c850d30">associer_loipar</a>(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#acb3012989f94a20d224ac904906d26ce">le_modele_turbulence</a>-&gt;loi_paroi());
<a name="l00102"></a>00102 }
<a name="l00103"></a>00103 <span class="comment"></span>
<a name="l00104"></a>00104 <span class="comment">////!&lt; mettre_a_jour </span>
<a name="l00105"></a>00105 <span class="comment"></span><span class="comment">//</span>
<a name="l00106"></a>00106 
<a name="l00107"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#a732fd82abef31edd67543fd6a41bf64b">00107</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a732fd82abef31edd67543fd6a41bf64b" title="NE FAIT RIEN A surcharger dans les classes derivees. Mise a jour de l&#39;operateur.">Op_Dift_VDF_Face_Axi::mettre_a_jour</a>(<span class="keywordtype">double</span> )
<a name="l00108"></a>00108 {
<a name="l00109"></a>00109   <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a85afc90e34f927d4af6fbde9e691f8ee">tau_tan</a>.<a class="code" href="classDoubleTab.html#afc7cddeeec2c80636e54eaf330ac41ad" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#acb3012989f94a20d224ac904906d26ce">le_modele_turbulence</a>-&gt;loi_paroi().<a class="code" href="classRef__Mod__turb__hyd__base.html#ac803bec0cd8343807d7ab4339346980e">valeur</a>().Cisaillement_paroi());
<a name="l00110"></a>00110 }
<a name="l00111"></a>00111 
<a name="l00112"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#ad50fc3f269f1e7c6b1033579a6de6ccb">00112</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ad50fc3f269f1e7c6b1033579a6de6ccb" title="ajoute la contribution de la diffusion au second membre resu renvoie resu">Op_Dift_VDF_Face_Axi::ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00113"></a>00113 <span class="keyword"></span>{
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="keywordflow">if</span> (inco.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>() &gt; 1)
<a name="l00116"></a>00116     {
<a name="l00117"></a>00117       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans Op_Dift_VDF_Face_Axi::ajouter&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00118"></a>00118       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On ne sait pas traiter la diffusion d&#39;un Champ_Face a plusieurs inconnues&quot;</span> &lt;&lt; finl;
<a name="l00119"></a>00119       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00120"></a>00120     }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="comment">// double temps=equation().schema_temps().temps_courant();</span>
<a name="l00123"></a>00123 <span class="comment">// ref_cast_non_const(Op_Dift_VDF_Face_Axi, (*this)).mettre_a_jour(temps);</span>
<a name="l00124"></a>00124   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a1c5f1cbcfc6e7c97490fa04287a8d989">la_zone_vdf</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00125"></a>00125   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; zclvdf = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae1c32a53f9159425724fae235f5c0ef8">la_zcl_vdf</a>.<a class="code" href="classRef__Zone__Cl__VDF.html#a1e655604e840cda5b393e45f975b73ff">valeur</a>();
<a name="l00126"></a>00126 <span class="comment">// int nb_elem = zvdf.nb_elem();</span>
<a name="l00127"></a>00127 <span class="comment">// int nb_aretes = zvdf.nb_aretes();</span>
<a name="l00128"></a>00128 
<a name="l00129"></a>00129   <span class="keyword">const</span> <a class="code" href="classChamp__Uniforme.html" title="classe Champ_Uniforme Represente un champ constant dans l&#39;espace et dans le temps.">Champ_Uniforme</a>&amp; viscosite_lam = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a426fbfc5eea20776019057b9b366573b">diffusivite_</a>;
<a name="l00130"></a>00130   <span class="keywordtype">double</span> visco_lam = viscosite_lam(0,0);
<a name="l00131"></a>00131   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; visco_turb = <a class="code" href="classOp__Diff__Turbulent__base.html#af674533b0786ba32fa6a408b6c8bba04">diffusivite_turbulente</a>()-&gt;<a class="code" href="classChamp__Fonc.html#a60b75eadb0987d488884e24fcb72d1e5" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs du champ.">valeurs</a>();
<a name="l00132"></a>00132   <span class="keywordtype">double</span> d_visco_turb;
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tau_diag = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#aaa1c42e7200c0fe959fe8a1e7498a113">inconnue</a>-&gt;tau_diag();
<a name="l00135"></a>00135   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tau_croises = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#aaa1c42e7200c0fe959fe8a1e7498a113">inconnue</a>-&gt;tau_croises();
<a name="l00136"></a>00136   <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Face.html" title="class Champ_Face Cette classe sert a representer un champ vectoriel dont on ne calcule que les compos...">Champ_Face</a>,<a class="code" href="classOp__Dift__VDF__Face__Axi.html#aaa1c42e7200c0fe959fe8a1e7498a113">inconnue</a>.<a class="code" href="classRef__Champ__Face.html#ab3bc856ba736c84e483378400b194290">valeur</a>()).calculer_dercov_axi(zclvdf);
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="comment">// Boucle sur les elements pour traiter les facettes situees</span>
<a name="l00140"></a>00140 <span class="comment">// a l&#39;interieur des elements</span>
<a name="l00141"></a>00141 
<a name="l00142"></a>00142   <span class="keywordtype">int</span> fx0,fx1,fy0,fy1;
<a name="l00143"></a>00143   <span class="keywordtype">double</span> flux_X,flux_Y;
<a name="l00144"></a>00144   <span class="keywordtype">double</span> coef_laplacien_axi;
<a name="l00145"></a>00145 
<a name="l00146"></a>00146   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;zvdf.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); num_elem++)
<a name="l00147"></a>00147     {
<a name="l00148"></a>00148       fx0 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>(num_elem,0);
<a name="l00149"></a>00149       fx1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>(num_elem,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00150"></a>00150       fy0 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>(num_elem,1);
<a name="l00151"></a>00151       fy1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>(num_elem,1+<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153       flux_X = ((visco_lam + 2*visco_turb(num_elem))*tau_diag(num_elem,0))*0.5*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fx0)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fx1));
<a name="l00154"></a>00154 
<a name="l00155"></a>00155       flux_Y = ((visco_lam + 2*visco_turb(num_elem))*tau_diag(num_elem,1))*0.5*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fy0)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fy1));
<a name="l00156"></a>00156 
<a name="l00157"></a>00157       resu(fx0) += flux_X;
<a name="l00158"></a>00158       resu(fx1) += flux_X;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160       resu(fy0) += flux_Y;
<a name="l00161"></a>00161       resu(fy1) += flux_Y;
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00164"></a>00164 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00165"></a>00165 
<a name="l00166"></a>00166       coef_laplacien_axi = -0.5*(tau_diag(num_elem,1)*(visco_lam+2*visco_turb(num_elem)));
<a name="l00167"></a>00167 
<a name="l00168"></a>00168       resu[fx0] += coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fx0)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fx0)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fx0,0);
<a name="l00169"></a>00169       resu[fx1] += coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fx1)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fx1)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fx1,0);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172 
<a name="l00173"></a>00173   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00174"></a>00174     {
<a name="l00175"></a>00175       <span class="keywordtype">int</span> fz0,fz1;
<a name="l00176"></a>00176       <span class="keywordtype">double</span> flux_Z;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;zvdf.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); num_elem++)
<a name="l00179"></a>00179         {
<a name="l00180"></a>00180           fz0 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>(num_elem,2);
<a name="l00181"></a>00181           fz1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>(num_elem,2+<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00182"></a>00182           flux_Z = ((visco_lam + 2*visco_turb(num_elem))*tau_diag(num_elem,2)) *0.5*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fz0)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fz1));
<a name="l00183"></a>00183 
<a name="l00184"></a>00184           resu[fz0] += flux_Z;
<a name="l00185"></a>00185           resu[fz1] -= flux_Z;
<a name="l00186"></a>00186         }
<a name="l00187"></a>00187     }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">// Boucle sur les bord pour traiter les faces de type sortie_libre</span>
<a name="l00192"></a>00192 
<a name="l00193"></a>00193   <span class="keywordtype">int</span> ndeb, nfin;
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 <span class="comment">// Boucle sur les aretes bord</span>
<a name="l00196"></a>00196 
<a name="l00197"></a>00197   <span class="keywordtype">int</span> n_arete;
<a name="l00198"></a>00198   ndeb = zvdf.<a class="code" href="classZone__VDF.html#aa272d66cc2d519b88c3d5e8f0f70d700">premiere_arete_bord</a>();
<a name="l00199"></a>00199   nfin = ndeb + zvdf.<a class="code" href="classZone__VDF.html#a88b3380a8314d855c0f30a138efd834c">nb_aretes_bord</a>();
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 <span class="comment">// double flux;</span>
<a name="l00202"></a>00202   <span class="keywordtype">int</span> ori1,ori3,n_type,fac1,fac2,fac3,signe;
<a name="l00203"></a>00203   <span class="keywordtype">double</span> tau12,tau21,tau13,tau31,tau23,tau32;
<a name="l00204"></a>00204 
<a name="l00205"></a>00205   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l00206"></a>00206     {
<a name="l00207"></a>00207       n_type=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae8a443e04bc8afc20a83e550509af995">type_arete_bord</a>(n_arete-ndeb);
<a name="l00208"></a>00208 
<a name="l00209"></a>00209       <span class="keywordflow">switch</span>(n_type)
<a name="l00210"></a>00210         {
<a name="l00211"></a>00211         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>: <span class="comment">//!&lt; paroi-paroi</span>
<a name="l00212"></a>00212 <span class="comment"></span>          {
<a name="l00213"></a>00213             <span class="keywordtype">double</span> flux0;
<a name="l00214"></a>00214             fac1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,0);
<a name="l00215"></a>00215             fac2 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,1);
<a name="l00216"></a>00216             fac3 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,2);
<a name="l00217"></a>00217             signe  = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,3);
<a name="l00218"></a>00218             ori1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac1);
<a name="l00219"></a>00219             ori3 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac3);
<a name="l00220"></a>00220             <span class="keywordtype">int</span> rang1 = (fac1-zvdf.<a class="code" href="classZone__VF.html#a9571f861dfb23f699da7042773644a42" title="renvoie le numero de la premiere des faces sur lesquelles sont appliquees les conditions limites : bo...">premiere_face_bord</a>());
<a name="l00221"></a>00221             <span class="keywordtype">int</span> rang2 = (fac2-zvdf.<a class="code" href="classZone__VF.html#a9571f861dfb23f699da7042773644a42" title="renvoie le numero de la premiere des faces sur lesquelles sont appliquees les conditions limites : bo...">premiere_face_bord</a>());
<a name="l00222"></a>00222             <span class="keywordtype">double</span> vit = inco(fac3);
<a name="l00223"></a>00223             <span class="keywordtype">double</span> vit_imp = 0.5*(<a class="code" href="Champ__Face_8cpp.html#ae2ba1e8935ec33397828bf564e63f6d7">Champ_Face_get_val_imp_face_bord</a>(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#aaa1c42e7200c0fe959fe8a1e7498a113">inconnue</a>-&gt;temps(),rang1,ori3,<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae1c32a53f9159425724fae235f5c0ef8">la_zcl_vdf</a>)+
<a name="l00224"></a>00224                                   <a class="code" href="Champ__Face_8cpp.html#ae2ba1e8935ec33397828bf564e63f6d7">Champ_Face_get_val_imp_face_bord</a>(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#aaa1c42e7200c0fe959fe8a1e7498a113">inconnue</a>-&gt;temps(),rang2,ori3,<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae1c32a53f9159425724fae235f5c0ef8">la_zcl_vdf</a>));
<a name="l00225"></a>00225 
<a name="l00226"></a>00226             <span class="keywordtype">double</span> tau1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a85afc90e34f927d4af6fbde9e691f8ee">tau_tan</a>(rang1,ori3)*0.5*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1);
<a name="l00227"></a>00227             <span class="keywordtype">double</span> tau2 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a85afc90e34f927d4af6fbde9e691f8ee">tau_tan</a>(rang2,ori3)*0.5*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2);
<a name="l00228"></a>00228             <span class="keywordtype">double</span> coef = tau1+tau2;
<a name="l00229"></a>00229 
<a name="l00230"></a>00230             <span class="keywordtype">int</span> signe_terme;
<a name="l00231"></a>00231 
<a name="l00232"></a>00232             <span class="keywordflow">if</span> ( vit &lt; vit_imp )
<a name="l00233"></a>00233               signe_terme = -1;
<a name="l00234"></a>00234             <span class="keywordflow">else</span>
<a name="l00235"></a>00235               signe_terme = 1;
<a name="l00236"></a>00236 
<a name="l00237"></a>00237 <span class="comment">// YB : 30/01/2004 :</span>
<a name="l00238"></a>00238 <span class="comment">// Elimination de la determination du signe du flux parietal par l&#39;evaluateur de l&#39;operateur de diffusion,</span>
<a name="l00239"></a>00239 <span class="comment">// en contre-partie le cisaillement parietal fournit par la loi paroi est signe (voir modif dans distances_VDF.cpp)</span>
<a name="l00240"></a>00240             signe_terme = 1;
<a name="l00241"></a>00241 <span class="comment">// Fin modif YB</span>
<a name="l00242"></a>00242 
<a name="l00243"></a>00243             flux0 = signe_terme*coef;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245             resu[fac3]+= flux0;
<a name="l00246"></a>00246             <span class="keywordflow">break</span>;
<a name="l00247"></a>00247           }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a>: <span class="comment">//!&lt; fluide-fluide</span>
<a name="l00250"></a>00250 <span class="comment"></span>        <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>: <span class="comment">//!&lt; paroi-fluide</span>
<a name="l00251"></a>00251 <span class="comment"></span>          {
<a name="l00252"></a>00252             <span class="keywordtype">double</span> flux1;
<a name="l00253"></a>00253             fac1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,0);
<a name="l00254"></a>00254             fac2 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,1);
<a name="l00255"></a>00255             fac3 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,2);
<a name="l00256"></a>00256             signe  = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,3);
<a name="l00257"></a>00257             <span class="keywordtype">int</span> ori1b = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac1);
<a name="l00258"></a>00258             <span class="keywordtype">int</span> ori3b = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac3);
<a name="l00259"></a>00259 
<a name="l00260"></a>00260             d_visco_turb = 0.5*(visco_turb(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>(fac3,0))
<a name="l00261"></a>00261                                 + visco_turb(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>(fac3,1)));
<a name="l00262"></a>00262 
<a name="l00263"></a>00263             <span class="keywordflow">if</span> (ori1b == 0) <span class="comment">//!&lt; bord d&#39;equation R = cte</span>
<a name="l00264"></a>00264 <span class="comment"></span>              {
<a name="l00265"></a>00265                 <span class="keywordflow">if</span> (ori3b == 1)
<a name="l00266"></a>00266                   {
<a name="l00267"></a>00267                     tau12 = tau_croises(n_arete,0);
<a name="l00268"></a>00268                     tau21 = tau_croises(n_arete,1);
<a name="l00269"></a>00269 
<a name="l00270"></a>00270                     flux1 = (visco_lam*tau12 + d_visco_turb*(tau12+tau21))
<a name="l00271"></a>00271                             *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00272"></a>00272                   }
<a name="l00273"></a>00273                 <span class="keywordflow">else</span> <span class="comment">//if (ori3 == 2)</span>
<a name="l00274"></a>00274                   {
<a name="l00275"></a>00275                     assert(ori3b == 2) ;
<a name="l00276"></a>00276                     tau13 = tau_croises(n_arete,0);
<a name="l00277"></a>00277                     tau31 = tau_croises(n_arete,1);
<a name="l00278"></a>00278 
<a name="l00279"></a>00279                     flux1 = (visco_lam*tau13 + d_visco_turb*(tau13+tau31))
<a name="l00280"></a>00280                             *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00281"></a>00281                   }
<a name="l00282"></a>00282 
<a name="l00283"></a>00283                 resu[fac3]+=signe*flux1;
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l00286"></a>00286 <span class="comment">// resu[fac1] += flux1_2;</span>
<a name="l00287"></a>00287 <span class="comment">// resu[fac2] -= flux1_2;</span>
<a name="l00288"></a>00288 
<a name="l00289"></a>00289               }
<a name="l00290"></a>00290             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori1b == 1) <span class="comment">//!&lt; bord d&#39;equation teta = cte</span>
<a name="l00291"></a>00291 <span class="comment"></span>              {
<a name="l00292"></a>00292                 <span class="keywordflow">if</span> (ori3b == 0)
<a name="l00293"></a>00293                   {
<a name="l00294"></a>00294                     <span class="keywordtype">double</span> flux2;
<a name="l00295"></a>00295                     tau21 = tau_croises(n_arete,0);
<a name="l00296"></a>00296                     tau12 = tau_croises(n_arete,1);
<a name="l00297"></a>00297 
<a name="l00298"></a>00298                     flux2 = (visco_lam*tau21 + d_visco_turb*(tau12+tau21))
<a name="l00299"></a>00299                             *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00300"></a>00300 
<a name="l00301"></a>00301                     resu[fac3]+=signe*flux2;
<a name="l00302"></a>00302 
<a name="l00303"></a>00303 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l00304"></a>00304 <span class="comment">// resu[fac1]+= flux1_2;</span>
<a name="l00305"></a>00305 <span class="comment">// resu[fac2]-= flux1_2;</span>
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00308"></a>00308 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00309"></a>00309 
<a name="l00310"></a>00310                     coef_laplacien_axi = 0.5*(visco_lam*tau21 + d_visco_turb*(tau12+tau21));
<a name="l00311"></a>00311                     resu(fac1) += coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fac1)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fac1,0);
<a name="l00312"></a>00312                     resu(fac2) += coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fac2)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fac2,0);
<a name="l00313"></a>00313                   }
<a name="l00314"></a>00314                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3b == 2) <span class="comment">//!&lt; flux de tau23 a travers le bord</span>
<a name="l00315"></a>00315 <span class="comment"></span>                  {
<a name="l00316"></a>00316                     <span class="keywordtype">double</span> flux3;
<a name="l00317"></a>00317                     tau23 = tau_croises(n_arete,0);
<a name="l00318"></a>00318                     tau32 = tau_croises(n_arete,1);
<a name="l00319"></a>00319 
<a name="l00320"></a>00320                     flux3 = (visco_lam*tau23 + d_visco_turb*(tau23+tau32))
<a name="l00321"></a>00321                             *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00322"></a>00322 
<a name="l00323"></a>00323                     resu[fac3]+=signe*flux3;
<a name="l00324"></a>00324 
<a name="l00325"></a>00325 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l00326"></a>00326 <span class="comment">// resu[fac1]+= flux1_2;</span>
<a name="l00327"></a>00327 <span class="comment">// resu[fac2]-= flux1_2;</span>
<a name="l00328"></a>00328                   }
<a name="l00329"></a>00329 
<a name="l00330"></a>00330               }
<a name="l00331"></a>00331             <span class="keywordflow">else</span> <span class="comment">//!&lt; (ori1 == 2) bord d&#39;equation Z = cte</span>
<a name="l00332"></a>00332 <span class="comment"></span>              {
<a name="l00333"></a>00333                 <span class="keywordtype">double</span> flux4;
<a name="l00334"></a>00334                 <span class="keywordflow">if</span> (ori3b == 0)
<a name="l00335"></a>00335                   {
<a name="l00336"></a>00336 
<a name="l00337"></a>00337                     tau31 = tau_croises(n_arete,0);
<a name="l00338"></a>00338                     tau13 = tau_croises(n_arete,1);
<a name="l00339"></a>00339 
<a name="l00340"></a>00340                     flux4 = (visco_lam*tau31 + d_visco_turb*(tau13+tau31))
<a name="l00341"></a>00341                             *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00342"></a>00342                   }
<a name="l00343"></a>00343                 <span class="keywordflow">else</span> <span class="comment">//if (ori3 == 1)  flux de tau32 a travers le bord</span>
<a name="l00344"></a>00344                   {
<a name="l00345"></a>00345                     assert(ori3b == 1);
<a name="l00346"></a>00346                     tau32 = tau_croises(n_arete,0);
<a name="l00347"></a>00347                     tau23 = tau_croises(n_arete,1);
<a name="l00348"></a>00348 
<a name="l00349"></a>00349                     flux4 = (visco_lam*tau32 + d_visco_turb*(tau23+tau32))
<a name="l00350"></a>00350                             *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00351"></a>00351                   }
<a name="l00352"></a>00352 <span class="comment">// ATTENTION GROSSE CORRECTION LA PARANTHESE SUIVANTE ETAIT</span>
<a name="l00353"></a>00353 <span class="comment">// MAL PLACEE</span>
<a name="l00354"></a>00354 <span class="comment">// }</span>
<a name="l00355"></a>00355 
<a name="l00356"></a>00356 
<a name="l00357"></a>00357                 resu[fac3] += signe*flux4;
<a name="l00358"></a>00358               }
<a name="l00359"></a>00359             <span class="keywordflow">break</span>;
<a name="l00360"></a>00360           }
<a name="l00361"></a>00361         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a8ffe822aae0518f507be135120ec23b8">TypeAreteBordVDF::SYM_SYM</a>:
<a name="l00362"></a>00362           {
<a name="l00363"></a>00363 <span class="comment">// symetrie-symetrie</span>
<a name="l00364"></a>00364 <span class="comment">// pas de flux diffusif calcule</span>
<a name="l00365"></a>00365             <span class="keywordflow">break</span>;
<a name="l00366"></a>00366           }
<a name="l00367"></a>00367         <span class="keywordflow">default</span> :
<a name="l00368"></a>00368           {
<a name="l00369"></a>00369             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l00370"></a>00370             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l00371"></a>00371             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l00372"></a>00372             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00373"></a>00373             <span class="keywordflow">break</span>;
<a name="l00374"></a>00374           }
<a name="l00375"></a>00375         }
<a name="l00376"></a>00376     }
<a name="l00377"></a>00377 
<a name="l00378"></a>00378   <span class="keywordtype">int</span> fac4;
<a name="l00379"></a>00379 
<a name="l00380"></a>00380 <span class="comment">// Boucle sur les aretes mixtes</span>
<a name="l00381"></a>00381 <span class="comment">// Sur les aretes mixtes les termes croises du tenseur de Reynolds</span>
<a name="l00382"></a>00382 <span class="comment">// sont nuls: il ne reste donc que la diffusion laminaire</span>
<a name="l00383"></a>00383 
<a name="l00384"></a>00384   ndeb = zvdf.<a class="code" href="classZone__VDF.html#a1197e179e848063721cdf2121837bbc6">premiere_arete_mixte</a>();
<a name="l00385"></a>00385   nfin = zvdf.<a class="code" href="classZone__VDF.html#ae228e03cea92f748053ea0533368a030">premiere_arete_interne</a>();
<a name="l00386"></a>00386 
<a name="l00387"></a>00387   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l00388"></a>00388     {
<a name="l00389"></a>00389       fac1=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,0);
<a name="l00390"></a>00390       fac2=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,1);
<a name="l00391"></a>00391       fac3=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,2);
<a name="l00392"></a>00392       fac4=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,3);
<a name="l00393"></a>00393       ori1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac1);
<a name="l00394"></a>00394       ori3 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac3);
<a name="l00395"></a>00395 
<a name="l00396"></a>00396       <span class="keywordflow">if</span> (ori1 == 1)  <span class="comment">//!&lt; (seule possibilite : ori3 =0)  Arete XY</span>
<a name="l00397"></a>00397 <span class="comment"></span>        {
<a name="l00398"></a>00398           <span class="keywordtype">double</span> flux1;
<a name="l00399"></a>00399           tau12 = tau_croises(n_arete,0);
<a name="l00400"></a>00400           tau21 = tau_croises(n_arete,1);
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 <span class="comment">// flux de mu_lam*tau21</span>
<a name="l00403"></a>00403 <span class="comment">// sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00404"></a>00404 
<a name="l00405"></a>00405           flux1 = visco_lam*tau21*0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))
<a name="l00406"></a>00406                   *(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00407"></a>00407 
<a name="l00408"></a>00408           resu(fac3) += flux1;
<a name="l00409"></a>00409           resu(fac4) -= flux1;
<a name="l00410"></a>00410 
<a name="l00411"></a>00411 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00412"></a>00412 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00413"></a>00413 
<a name="l00414"></a>00414           coef_laplacien_axi = 0.5*visco_lam*tau21;
<a name="l00415"></a>00415 
<a name="l00416"></a>00416           resu(fac1) += coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fac1)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fac1,0);
<a name="l00417"></a>00417           resu(fac2) += coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fac2)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fac2,0);
<a name="l00418"></a>00418 
<a name="l00419"></a>00419 <span class="comment">// flux de mu_lam*tau12</span>
<a name="l00420"></a>00420 <span class="comment">// sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00421"></a>00421 
<a name="l00422"></a>00422           flux1 = visco_lam*tau12*0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac4))
<a name="l00423"></a>00423                   *(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac4));
<a name="l00424"></a>00424 
<a name="l00425"></a>00425           resu(fac1) += flux1;
<a name="l00426"></a>00426           resu(fac2) -= flux1;
<a name="l00427"></a>00427 
<a name="l00428"></a>00428         }
<a name="l00429"></a>00429       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3 == 1) <span class="comment">//!&lt; (seule possibilite ori1 = 2) arete YZ</span>
<a name="l00430"></a>00430 <span class="comment"></span>        {
<a name="l00431"></a>00431           <span class="keywordtype">double</span> flux2;
<a name="l00432"></a>00432           tau23 = tau_croises(n_arete,0);
<a name="l00433"></a>00433           tau32 = tau_croises(n_arete,1);
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 <span class="comment">// flux de mu_lam*tau32</span>
<a name="l00436"></a>00436 <span class="comment">// sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00437"></a>00437 
<a name="l00438"></a>00438           flux2 = visco_lam*tau32*0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))
<a name="l00439"></a>00439                   *(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00440"></a>00440 
<a name="l00441"></a>00441           resu(fac3) += flux2;
<a name="l00442"></a>00442           resu(fac4) -= flux2;
<a name="l00443"></a>00443 
<a name="l00444"></a>00444 <span class="comment">// flux de mu_lam*tau23</span>
<a name="l00445"></a>00445 <span class="comment">// sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00446"></a>00446 
<a name="l00447"></a>00447           flux2 = visco_lam*tau23*0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac4))
<a name="l00448"></a>00448                   *(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac4));
<a name="l00449"></a>00449 
<a name="l00450"></a>00450           resu(fac1) += flux2;
<a name="l00451"></a>00451           resu(fac2) -= flux2;
<a name="l00452"></a>00452         }
<a name="l00453"></a>00453       <span class="keywordflow">else</span> <span class="comment">//!&lt; seule possibilite ori1 = 2 et ori3 = 0:  arete XZ</span>
<a name="l00454"></a>00454 <span class="comment"></span>        {
<a name="l00455"></a>00455           <span class="keywordtype">double</span> flux3;
<a name="l00456"></a>00456           tau13 = tau_croises(n_arete,0);
<a name="l00457"></a>00457           tau31 = tau_croises(n_arete,1);
<a name="l00458"></a>00458 
<a name="l00459"></a>00459 <span class="comment">// flux de mu_lam*tau31</span>
<a name="l00460"></a>00460 <span class="comment">// sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00461"></a>00461 
<a name="l00462"></a>00462           flux3 = visco_lam*tau31*0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))
<a name="l00463"></a>00463                   *(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00464"></a>00464 
<a name="l00465"></a>00465           resu(fac3) += flux3;
<a name="l00466"></a>00466           resu(fac4) -= flux3;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468 <span class="comment">// flux de mu_lam*tau13</span>
<a name="l00469"></a>00469 <span class="comment">// sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00470"></a>00470 
<a name="l00471"></a>00471           flux3 = visco_lam*tau13*0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac4))
<a name="l00472"></a>00472                   *(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac4));
<a name="l00473"></a>00473 
<a name="l00474"></a>00474           resu(fac1) += flux3;
<a name="l00475"></a>00475           resu(fac2) -= flux3;
<a name="l00476"></a>00476         }
<a name="l00477"></a>00477     }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479 <span class="comment">// Boucle sur les aretes internes</span>
<a name="l00480"></a>00480 
<a name="l00481"></a>00481   ndeb = zvdf.<a class="code" href="classZone__VDF.html#ae228e03cea92f748053ea0533368a030">premiere_arete_interne</a>();
<a name="l00482"></a>00482   nfin = zvdf.<a class="code" href="classZone__VDF.html#add0341183f527326bc526c92bbb19225">nb_aretes</a>();
<a name="l00483"></a>00483 
<a name="l00484"></a>00484   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l00485"></a>00485     {
<a name="l00486"></a>00486       fac1=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,0);
<a name="l00487"></a>00487       fac2=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,1);
<a name="l00488"></a>00488       fac3=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,2);
<a name="l00489"></a>00489       fac4=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,3);
<a name="l00490"></a>00490       ori1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac1);
<a name="l00491"></a>00491       ori3 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac3);
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 <span class="comment">// Calcul de la viscosite turbulente au milieu de l&#39;arete</span>
<a name="l00494"></a>00494 
<a name="l00495"></a>00495       d_visco_turb = 0.25*(visco_turb(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>(fac3,0)) + visco_turb(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>(fac3,1))
<a name="l00496"></a>00496                            + visco_turb(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>(fac4,0)) + visco_turb(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>(fac4,1)));
<a name="l00497"></a>00497 
<a name="l00498"></a>00498       <span class="keywordflow">if</span> (ori1 == 1)  <span class="comment">//!&lt; (seule possibilite : ori3 =0)  Arete XY</span>
<a name="l00499"></a>00499 <span class="comment"></span>        {
<a name="l00500"></a>00500           <span class="keywordtype">double</span> flux1;
<a name="l00501"></a>00501           tau12 = tau_croises(n_arete,0);
<a name="l00502"></a>00502           tau21 = tau_croises(n_arete,1);
<a name="l00503"></a>00503 
<a name="l00504"></a>00504 <span class="comment">// flux de mu_lam*tau21 + mu_turb*(tau21+tau12)</span>
<a name="l00505"></a>00505 <span class="comment">// sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00506"></a>00506 
<a name="l00507"></a>00507           flux1 = (visco_lam*tau21 + d_visco_turb*(tau21+tau12))
<a name="l00508"></a>00508                   *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00509"></a>00509 
<a name="l00510"></a>00510           resu(fac3) += flux1;
<a name="l00511"></a>00511           resu(fac4) -= flux1;
<a name="l00512"></a>00512 
<a name="l00513"></a>00513 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00514"></a>00514 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00515"></a>00515 
<a name="l00516"></a>00516           coef_laplacien_axi = 0.5*(visco_lam*tau21 + d_visco_turb*(tau21+tau12));
<a name="l00517"></a>00517 
<a name="l00518"></a>00518           resu(fac1) += coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fac1)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fac1,0);
<a name="l00519"></a>00519           resu(fac2) += coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fac2)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fac2,0);
<a name="l00520"></a>00520 
<a name="l00521"></a>00521 <span class="comment">// flux de mu_lam*tau12 + mu_turb*(tau21+tau12)</span>
<a name="l00522"></a>00522 <span class="comment">// sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00523"></a>00523 
<a name="l00524"></a>00524           flux1 = (visco_lam*tau12 + d_visco_turb*(tau12+tau21))
<a name="l00525"></a>00525                   *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac4))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac4));
<a name="l00526"></a>00526 
<a name="l00527"></a>00527           resu(fac1) += flux1;
<a name="l00528"></a>00528           resu(fac2) -= flux1;
<a name="l00529"></a>00529 
<a name="l00530"></a>00530         }
<a name="l00531"></a>00531       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3 == 1) <span class="comment">//!&lt; (seule possibilite ori1 = 2) arete YZ</span>
<a name="l00532"></a>00532 <span class="comment"></span>        {
<a name="l00533"></a>00533           <span class="keywordtype">double</span> flux2;
<a name="l00534"></a>00534           tau23 = tau_croises(n_arete,0);
<a name="l00535"></a>00535           tau32 = tau_croises(n_arete,1);
<a name="l00536"></a>00536 
<a name="l00537"></a>00537 <span class="comment">// flux de mu_lam*tau32 + mu_turb*(tau32+tau23)</span>
<a name="l00538"></a>00538 <span class="comment">// sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00539"></a>00539 
<a name="l00540"></a>00540           flux2 = (visco_lam*tau32 + d_visco_turb*(tau32+tau23))
<a name="l00541"></a>00541                   *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00542"></a>00542 
<a name="l00543"></a>00543           resu(fac3) += flux2;
<a name="l00544"></a>00544           resu(fac4) -= flux2;
<a name="l00545"></a>00545 
<a name="l00546"></a>00546 <span class="comment">// flux de mu_lam*tau23 + mu_turb*(tau32+tau23)</span>
<a name="l00547"></a>00547 <span class="comment">// sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00548"></a>00548 
<a name="l00549"></a>00549           flux2 = (visco_lam*tau23 + d_visco_turb*(tau32+tau23))
<a name="l00550"></a>00550                   *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac4))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac4));
<a name="l00551"></a>00551 
<a name="l00552"></a>00552           resu(fac1) += flux2;
<a name="l00553"></a>00553           resu(fac2) -= flux2;
<a name="l00554"></a>00554         }
<a name="l00555"></a>00555       <span class="keywordflow">else</span> <span class="comment">//!&lt; seule possibilite ori1 = 2 et ori3 = 0:  arete XZ</span>
<a name="l00556"></a>00556 <span class="comment"></span>        {
<a name="l00557"></a>00557           <span class="keywordtype">double</span> flux3;
<a name="l00558"></a>00558           tau13 = tau_croises(n_arete,0);
<a name="l00559"></a>00559           tau31 = tau_croises(n_arete,1);
<a name="l00560"></a>00560 
<a name="l00561"></a>00561 <span class="comment">// flux de  mu_lam*tau31 + mu_turb*(tau31+tau13)</span>
<a name="l00562"></a>00562 <span class="comment">// sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00563"></a>00563 
<a name="l00564"></a>00564           flux3 = (visco_lam*tau31 + d_visco_turb*(tau31+tau13))
<a name="l00565"></a>00565                   *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00566"></a>00566 
<a name="l00567"></a>00567           resu(fac3) += flux3;
<a name="l00568"></a>00568           resu(fac4) -= flux3;
<a name="l00569"></a>00569 
<a name="l00570"></a>00570 <span class="comment">// flux de mu_lam*tau13 + mu_turb*(tau13+tau31)</span>
<a name="l00571"></a>00571 <span class="comment">// sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00572"></a>00572 
<a name="l00573"></a>00573           flux3 = (visco_lam*tau13 + d_visco_turb*(tau31+tau13))
<a name="l00574"></a>00574                   *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac4))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac4));
<a name="l00575"></a>00575 
<a name="l00576"></a>00576           resu(fac1) += flux3;
<a name="l00577"></a>00577           resu(fac2) -= flux3;
<a name="l00578"></a>00578         }
<a name="l00579"></a>00579 
<a name="l00580"></a>00580     }
<a name="l00581"></a>00581   <span class="keywordflow">return</span> resu;
<a name="l00582"></a>00582 }
<a name="l00583"></a>00583 
<a name="l00584"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#a58a12385224068f4c0e4d88d4ea75396">00584</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a58a12385224068f4c0e4d88d4ea75396" title="calcule la contribution de la diffusion, la range dans resu renvoie resu">Op_Dift_VDF_Face_Axi::calculer</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00585"></a>00585 <span class="keyword"></span>{
<a name="l00586"></a>00586   resu=0;
<a name="l00587"></a>00587   <span class="keywordflow">return</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ad50fc3f269f1e7c6b1033579a6de6ccb" title="ajoute la contribution de la diffusion au second membre resu renvoie resu">ajouter</a>(inco,resu);
<a name="l00588"></a>00588 }
<a name="l00589"></a>00589 
<a name="l00590"></a>00590 
<a name="l00591"></a>00591 <span class="comment">//</span>
<a name="l00592"></a>00592 <span class="comment">// Methode pour l&#39;implicite</span>
<a name="l00593"></a>00593 <span class="comment">//</span>
<a name="l00594"></a>00594 
<a name="l00595"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#abc8d5c025839bd1e919b13ba98075d48">00595</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#abc8d5c025839bd1e919b13ba98075d48">Op_Dift_VDF_Face_Axi::ajouter_contribution</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,                                                         <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice )<span class="keyword"> const</span>
<a name="l00596"></a>00596 <span class="keyword"></span>{
<a name="l00597"></a>00597 
<a name="l00598"></a>00598   <span class="keywordflow">if</span> (inco.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() &gt; 1)
<a name="l00599"></a>00599     {
<a name="l00600"></a>00600       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans Op_Dift_VDF_Face_Axi::ajouter&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00601"></a>00601       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On ne sait pas traiter la diffusion d&#39;un Champ_Face a plusieurs inconnues&quot;</span> &lt;&lt; finl;
<a name="l00602"></a>00602       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00603"></a>00603     }
<a name="l00604"></a>00604   <span class="keywordtype">int</span> l;
<a name="l00605"></a>00605 <span class="comment">// double temps=equation().schema_temps().temps_courant();</span>
<a name="l00606"></a>00606 <span class="comment">// ref_cast_non_const(Op_Dift_VDF_Face_Axi, (*this)).mettre_a_jour(temps);</span>
<a name="l00607"></a>00607   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a1c5f1cbcfc6e7c97490fa04287a8d989">la_zone_vdf</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00608"></a>00608   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; zclvdf = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae1c32a53f9159425724fae235f5c0ef8">la_zcl_vdf</a>.<a class="code" href="classRef__Zone__Cl__VDF.html#a1e655604e840cda5b393e45f975b73ff">valeur</a>();
<a name="l00609"></a>00609 <span class="comment">// int nb_elem = zvdf.nb_elem();</span>
<a name="l00610"></a>00610 <span class="comment">// int nb_aretes = zvdf.nb_aretes();</span>
<a name="l00611"></a>00611 
<a name="l00612"></a>00612   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = matrice.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l00613"></a>00613   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = matrice.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l00614"></a>00614   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l00615"></a>00615 
<a name="l00616"></a>00616 
<a name="l00617"></a>00617   <span class="keyword">const</span> <a class="code" href="classChamp__Uniforme.html" title="classe Champ_Uniforme Represente un champ constant dans l&#39;espace et dans le temps.">Champ_Uniforme</a>&amp; viscosite_lam = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a426fbfc5eea20776019057b9b366573b">diffusivite_</a>;
<a name="l00618"></a>00618   <span class="keywordtype">double</span> visco_lam = viscosite_lam(0,0);
<a name="l00619"></a>00619   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; visco_turb = <a class="code" href="classOp__Diff__Turbulent__base.html#af674533b0786ba32fa6a408b6c8bba04">diffusivite_turbulente</a>()-&gt;<a class="code" href="classChamp__Fonc.html#a60b75eadb0987d488884e24fcb72d1e5" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs du champ.">valeurs</a>();
<a name="l00620"></a>00620   <span class="keywordtype">double</span> d_visco_turb;
<a name="l00621"></a>00621 
<a name="l00622"></a>00622 <span class="comment">// DoubleTab&amp; tau_diag = inconnue-&gt;tau_diag();</span>
<a name="l00623"></a>00623 <span class="comment">// DoubleTab&amp; tau_croises = inconnue-&gt;tau_croises();</span>
<a name="l00624"></a>00624   <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Face.html" title="class Champ_Face Cette classe sert a representer un champ vectoriel dont on ne calcule que les compos...">Champ_Face</a>, <a class="code" href="classOp__Dift__VDF__Face__Axi.html#aaa1c42e7200c0fe959fe8a1e7498a113">inconnue</a>.<a class="code" href="classRef__Champ__Face.html#ab3bc856ba736c84e483378400b194290">valeur</a>()).calculer_dercov_axi(zclvdf);
<a name="l00625"></a>00625 
<a name="l00626"></a>00626 
<a name="l00627"></a>00627 <span class="comment">// Boucle sur les elements pour traiter les facettes situees</span>
<a name="l00628"></a>00628 <span class="comment">// a l&#39;interieur des elements</span>
<a name="l00629"></a>00629 
<a name="l00630"></a>00630   <span class="keywordtype">int</span> fx0,fx1,fy0,fy1;
<a name="l00631"></a>00631   <span class="keywordtype">double</span> flux_X,flux_Y;
<a name="l00632"></a>00632   <span class="keywordtype">double</span> coef_laplacien_axi;
<a name="l00633"></a>00633 
<a name="l00634"></a>00634   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;zvdf.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); num_elem++)
<a name="l00635"></a>00635     {
<a name="l00636"></a>00636       fx0 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>(num_elem,0);
<a name="l00637"></a>00637       fx1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>(num_elem,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00638"></a>00638       fy0 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>(num_elem,1);
<a name="l00639"></a>00639       fy1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>(num_elem,1+<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00640"></a>00640       flux_X = ((visco_lam + 2*visco_turb(num_elem)))*0.5*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fx0)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fx1));
<a name="l00641"></a>00641 
<a name="l00642"></a>00642       flux_Y = ((visco_lam + 2*visco_turb(num_elem)))*0.5*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fy0)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fy1));
<a name="l00643"></a>00643 
<a name="l00644"></a>00644       <span class="keywordflow">for</span> (l=tab1[fx0]-1; l&lt;tab1[fx0+1]-1; l++)
<a name="l00645"></a>00645         {
<a name="l00646"></a>00646           <span class="keywordflow">if</span> (tab2[l]-1==fx0)
<a name="l00647"></a>00647             coeff[l]+=flux_X;
<a name="l00648"></a>00648           <span class="keywordflow">if</span> (tab2[l]-1==fx1)
<a name="l00649"></a>00649             coeff[l]-=flux_X;
<a name="l00650"></a>00650         }
<a name="l00651"></a>00651       <span class="keywordflow">for</span> (l=tab1[fx1]-1; l&lt;tab1[fx1+1]-1; l++)
<a name="l00652"></a>00652         {
<a name="l00653"></a>00653           <span class="keywordflow">if</span> (tab2[l]-1==fx0)
<a name="l00654"></a>00654             coeff[l]-=flux_X;
<a name="l00655"></a>00655           <span class="keywordflow">if</span> (tab2[l]-1==fx1)
<a name="l00656"></a>00656             coeff[l]+=flux_X;
<a name="l00657"></a>00657         }
<a name="l00658"></a>00658       <span class="keywordflow">for</span> (l=tab1[fy0]-1; l&lt;tab1[fy0+1]-1; l++)
<a name="l00659"></a>00659         {
<a name="l00660"></a>00660           <span class="keywordflow">if</span> (tab2[l]-1==fy0)
<a name="l00661"></a>00661             coeff[l]+=flux_Y;
<a name="l00662"></a>00662           <span class="keywordflow">if</span> (tab2[l]-1==fy1)
<a name="l00663"></a>00663             coeff[l]-=flux_Y;
<a name="l00664"></a>00664         }
<a name="l00665"></a>00665       <span class="keywordflow">for</span> (l=tab1[fy1]-1; l&lt;tab1[fy1+1]-1; l++)
<a name="l00666"></a>00666         {
<a name="l00667"></a>00667           <span class="keywordflow">if</span> (tab2[l]-1==fy0)
<a name="l00668"></a>00668             coeff[l]-=flux_Y;
<a name="l00669"></a>00669           <span class="keywordflow">if</span> (tab2[l]-1==fy1)
<a name="l00670"></a>00670             coeff[l]+=flux_Y;
<a name="l00671"></a>00671         }
<a name="l00672"></a>00672 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00673"></a>00673 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00674"></a>00674 
<a name="l00675"></a>00675       coef_laplacien_axi = -0.5*(visco_lam+2*visco_turb(num_elem));
<a name="l00676"></a>00676       <span class="keywordflow">for</span> (l=tab1[fx0]-1; l&lt;tab1[fx0+1]-1; l++)
<a name="l00677"></a>00677         {
<a name="l00678"></a>00678           <span class="keywordflow">if</span> (tab2[l]-1==fx0)
<a name="l00679"></a>00679             coeff[l]+= coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fx0)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fx0)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fx0,0);
<a name="l00680"></a>00680 
<a name="l00681"></a>00681         }
<a name="l00682"></a>00682       <span class="keywordflow">for</span> (l=tab1[fx1]-1; l&lt;tab1[fx1+1]-1; l++)
<a name="l00683"></a>00683         {
<a name="l00684"></a>00684           <span class="keywordflow">if</span> (tab2[l]-1==fx1)
<a name="l00685"></a>00685             coeff[l]+=coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fx1)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fx1)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fx1,0);
<a name="l00686"></a>00686         }
<a name="l00687"></a>00687     }
<a name="l00688"></a>00688   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00689"></a>00689     {
<a name="l00690"></a>00690       <span class="keywordtype">int</span> fz0,fz1;
<a name="l00691"></a>00691       <span class="keywordtype">double</span> flux_Z;
<a name="l00692"></a>00692 
<a name="l00693"></a>00693       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;zvdf.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); num_elem++)
<a name="l00694"></a>00694         {
<a name="l00695"></a>00695           fz0 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>(num_elem,2);
<a name="l00696"></a>00696           fz1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#afac23a7073d2c9511ef8dd04b09588ad">elem_faces</a>(num_elem,2+<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00697"></a>00697 
<a name="l00698"></a>00698           flux_Z = ((visco_lam + 2*visco_turb(num_elem))) *0.5*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fz0)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fz1));
<a name="l00699"></a>00699           <span class="keywordflow">for</span> (l=tab1[fz0]-1; l&lt;tab1[fz0+1]-1; l++)
<a name="l00700"></a>00700             {
<a name="l00701"></a>00701               <span class="keywordflow">if</span> (tab2[l]-1==fz0)
<a name="l00702"></a>00702                 coeff[l]+=flux_Z;
<a name="l00703"></a>00703               <span class="keywordflow">if</span> (tab2[l]-1==fz1)
<a name="l00704"></a>00704                 coeff[l]-=flux_Z;
<a name="l00705"></a>00705             }
<a name="l00706"></a>00706           <span class="keywordflow">for</span> (l=tab1[fz1]-1; l&lt;tab1[fz1+1]-1; l++)
<a name="l00707"></a>00707             {
<a name="l00708"></a>00708               <span class="keywordflow">if</span> (tab2[l]-1==fz0)
<a name="l00709"></a>00709                 coeff[l]-=flux_Z;
<a name="l00710"></a>00710               <span class="keywordflow">if</span> (tab2[l]-1==fz1)
<a name="l00711"></a>00711                 coeff[l]+=flux_Z;
<a name="l00712"></a>00712             }
<a name="l00713"></a>00713         }
<a name="l00714"></a>00714     }
<a name="l00715"></a>00715 
<a name="l00716"></a>00716 
<a name="l00717"></a>00717 <span class="comment">// Boucle sur les bord pour traiter les faces de type sortie_libre</span>
<a name="l00718"></a>00718 
<a name="l00719"></a>00719   <span class="keywordtype">int</span> ndeb, nfin;
<a name="l00720"></a>00720   <span class="keywordtype">int</span> n_arete;
<a name="l00721"></a>00721   ndeb = zvdf.<a class="code" href="classZone__VDF.html#aa272d66cc2d519b88c3d5e8f0f70d700">premiere_arete_bord</a>();
<a name="l00722"></a>00722   nfin = ndeb + zvdf.<a class="code" href="classZone__VDF.html#a88b3380a8314d855c0f30a138efd834c">nb_aretes_bord</a>();
<a name="l00723"></a>00723 
<a name="l00724"></a>00724 
<a name="l00725"></a>00725   <span class="keywordtype">int</span> ori1,ori3,n_type,fac1,fac2,fac3,signe;
<a name="l00726"></a>00726 
<a name="l00727"></a>00727 
<a name="l00728"></a>00728   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l00729"></a>00729     {
<a name="l00730"></a>00730       n_type=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae8a443e04bc8afc20a83e550509af995">type_arete_bord</a>(n_arete-ndeb);
<a name="l00731"></a>00731 
<a name="l00732"></a>00732       <span class="keywordflow">switch</span>(n_type)
<a name="l00733"></a>00733         {
<a name="l00734"></a>00734         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>: <span class="comment">//!&lt; paroi-paroi</span>
<a name="l00735"></a>00735 <span class="comment"></span>          {
<a name="l00736"></a>00736             <span class="keywordflow">break</span>;
<a name="l00737"></a>00737           }
<a name="l00738"></a>00738 
<a name="l00739"></a>00739         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a>: <span class="comment">//!&lt; fluide-fluide</span>
<a name="l00740"></a>00740 <span class="comment"></span>        <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>: <span class="comment">//!&lt; paroi-fluide</span>
<a name="l00741"></a>00741 <span class="comment"></span>          {
<a name="l00742"></a>00742             fac1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,0);
<a name="l00743"></a>00743             fac2 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,1);
<a name="l00744"></a>00744             fac3 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,2);
<a name="l00745"></a>00745             signe  = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,3);
<a name="l00746"></a>00746             <span class="keywordtype">int</span> ori1b = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac1);
<a name="l00747"></a>00747             <span class="keywordtype">int</span> ori3b = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac3);
<a name="l00748"></a>00748 
<a name="l00749"></a>00749             d_visco_turb = 0.5*(visco_turb(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>(fac3,0))
<a name="l00750"></a>00750                                 + visco_turb(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>(fac3,1)));
<a name="l00751"></a>00751 
<a name="l00752"></a>00752             <span class="keywordflow">if</span> (ori1b == 0) <span class="comment">//!&lt; bord d&#39;equation R = cte</span>
<a name="l00753"></a>00753 <span class="comment"></span>              {
<a name="l00754"></a>00754                 <span class="keywordtype">double</span> flux1;
<a name="l00755"></a>00755                 <span class="keywordflow">if</span> (ori3b == 1)
<a name="l00756"></a>00756                   {
<a name="l00757"></a>00757                     flux1 = (visco_lam + d_visco_turb)
<a name="l00758"></a>00758                             *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00759"></a>00759                   }
<a name="l00760"></a>00760                 <span class="keywordflow">else</span> <span class="comment">//if (ori3 == 2)</span>
<a name="l00761"></a>00761                   {
<a name="l00762"></a>00762                     assert(ori3b == 2);
<a name="l00763"></a>00763                     flux1 = (visco_lam + d_visco_turb)
<a name="l00764"></a>00764                             *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00765"></a>00765                   }
<a name="l00766"></a>00766                 <span class="keywordflow">for</span> (l=tab1[fac3]-1; l&lt;tab1[fac3+1]-1; l++)
<a name="l00767"></a>00767                   {
<a name="l00768"></a>00768                     <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l00769"></a>00769                       coeff[l]+=signe*flux1;
<a name="l00770"></a>00770                   }
<a name="l00771"></a>00771 
<a name="l00772"></a>00772 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l00773"></a>00773 <span class="comment">// remplir les coeff des face fac1 et fac2</span>
<a name="l00774"></a>00774               }
<a name="l00775"></a>00775             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori1b == 1) <span class="comment">//!&lt; bord d&#39;equation teta = cte</span>
<a name="l00776"></a>00776 <span class="comment"></span>              {
<a name="l00777"></a>00777                 <span class="keywordflow">if</span> (ori3b == 0)
<a name="l00778"></a>00778                   {
<a name="l00779"></a>00779                     <span class="keywordtype">double</span> flux2;
<a name="l00780"></a>00780                     flux2 = (visco_lam + d_visco_turb)
<a name="l00781"></a>00781                             *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00782"></a>00782 
<a name="l00783"></a>00783                     <span class="keywordflow">for</span> (l=tab1[fac3]-1; l&lt;tab1[fac3+1]-1; l++)
<a name="l00784"></a>00784                       {
<a name="l00785"></a>00785                         <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l00786"></a>00786                           coeff[l]+=signe*flux2;
<a name="l00787"></a>00787                       }
<a name="l00788"></a>00788 
<a name="l00789"></a>00789 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l00790"></a>00790 <span class="comment">// et des coeff</span>
<a name="l00791"></a>00791 
<a name="l00792"></a>00792 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00793"></a>00793 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00794"></a>00794 
<a name="l00795"></a>00795                     coef_laplacien_axi = 0.5*(visco_lam + d_visco_turb);
<a name="l00796"></a>00796                     <span class="keywordflow">for</span> (l=tab1[fac1]-1; l&lt;tab1[fac1+1]-1; l++)
<a name="l00797"></a>00797                       {
<a name="l00798"></a>00798                         <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l00799"></a>00799                           coeff[l]+=coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fac1)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fac1,0);
<a name="l00800"></a>00800                       }
<a name="l00801"></a>00801                     <span class="keywordflow">for</span> (l=tab1[fac2]-1; l&lt;tab1[fac2+1]-1; l++)
<a name="l00802"></a>00802                       {
<a name="l00803"></a>00803                         <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l00804"></a>00804                           coeff[l]+=coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fac2)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fac2,0);
<a name="l00805"></a>00805                       }
<a name="l00806"></a>00806                   }
<a name="l00807"></a>00807                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3b == 2) <span class="comment">//!&lt; flux de tau23 a travers le bord</span>
<a name="l00808"></a>00808 <span class="comment"></span>                  {
<a name="l00809"></a>00809                     <span class="keywordtype">double</span> flux3;
<a name="l00810"></a>00810                     flux3 = (visco_lam+ d_visco_turb)
<a name="l00811"></a>00811                             *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00812"></a>00812 
<a name="l00813"></a>00813                     <span class="keywordflow">for</span> (l=tab1[fac3]-1; l&lt;tab1[fac3+1]-1; l++)
<a name="l00814"></a>00814                       {
<a name="l00815"></a>00815                         <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l00816"></a>00816                           coeff[l]+=signe*flux3;
<a name="l00817"></a>00817                       }
<a name="l00818"></a>00818 
<a name="l00819"></a>00819 <span class="comment">// Calcul de flux1_2 a coder</span>
<a name="l00820"></a>00820 <span class="comment">// resu[fac1]+= flux1_2;</span>
<a name="l00821"></a>00821 <span class="comment">// resu[fac2]-= flux1_2;</span>
<a name="l00822"></a>00822                   }
<a name="l00823"></a>00823 
<a name="l00824"></a>00824               }
<a name="l00825"></a>00825             <span class="keywordflow">else</span> <span class="comment">//!&lt; (ori1 == 2) bord d&#39;equation Z = cte</span>
<a name="l00826"></a>00826 <span class="comment"></span>              {
<a name="l00827"></a>00827                 <span class="keywordtype">double</span> flux4;
<a name="l00828"></a>00828                 <span class="keywordflow">if</span> (ori3b == 0)
<a name="l00829"></a>00829                   {
<a name="l00830"></a>00830                     flux4 = (visco_lam + d_visco_turb)
<a name="l00831"></a>00831                             *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00832"></a>00832                   }
<a name="l00833"></a>00833                 <span class="keywordflow">else</span><span class="comment">//!&lt; if (ori3 == 1)  flux de tau32 a travers le bord</span>
<a name="l00834"></a>00834 <span class="comment"></span>                  {
<a name="l00835"></a>00835                     assert(ori3b == 1);
<a name="l00836"></a>00836                     flux4 = (visco_lam + d_visco_turb)
<a name="l00837"></a>00837                             *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00838"></a>00838                   }
<a name="l00839"></a>00839 <span class="comment">// ATTENTION GROSSE CORRECTION LA PARANTHESE SUIVANTE ETAIT</span>
<a name="l00840"></a>00840 <span class="comment">// MAL PLACEE</span>
<a name="l00841"></a>00841 <span class="comment">// }</span>
<a name="l00842"></a>00842                 <span class="keywordflow">for</span> (l=tab1[fac3]-1; l&lt;tab1[fac3+1]-1; l++)
<a name="l00843"></a>00843                   {
<a name="l00844"></a>00844                     <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l00845"></a>00845                       coeff[l]+=signe*flux4;
<a name="l00846"></a>00846                   }
<a name="l00847"></a>00847               }
<a name="l00848"></a>00848             <span class="keywordflow">break</span>;
<a name="l00849"></a>00849           }
<a name="l00850"></a>00850         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a8ffe822aae0518f507be135120ec23b8">TypeAreteBordVDF::SYM_SYM</a>:
<a name="l00851"></a>00851           {
<a name="l00852"></a>00852 <span class="comment">// symetrie-symetrie</span>
<a name="l00853"></a>00853 <span class="comment">// pas de flux diffusif calcule</span>
<a name="l00854"></a>00854             <span class="keywordflow">break</span>;
<a name="l00855"></a>00855           }
<a name="l00856"></a>00856         <span class="keywordflow">default</span> :
<a name="l00857"></a>00857           {
<a name="l00858"></a>00858             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l00859"></a>00859             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l00860"></a>00860             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l00861"></a>00861             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00862"></a>00862             <span class="keywordflow">break</span>;
<a name="l00863"></a>00863           }
<a name="l00864"></a>00864         }
<a name="l00865"></a>00865     }
<a name="l00866"></a>00866 
<a name="l00867"></a>00867   <span class="keywordtype">int</span> fac4;
<a name="l00868"></a>00868 
<a name="l00869"></a>00869 <span class="comment">// Boucle sur les aretes mixtes</span>
<a name="l00870"></a>00870 <span class="comment">// Sur les aretes mixtes les termes croises du tenseur de Reynolds</span>
<a name="l00871"></a>00871 <span class="comment">// sont nuls: il ne reste donc que la diffusion laminaire</span>
<a name="l00872"></a>00872 
<a name="l00873"></a>00873   ndeb = zvdf.<a class="code" href="classZone__VDF.html#a1197e179e848063721cdf2121837bbc6">premiere_arete_mixte</a>();
<a name="l00874"></a>00874   nfin = zvdf.<a class="code" href="classZone__VDF.html#ae228e03cea92f748053ea0533368a030">premiere_arete_interne</a>();
<a name="l00875"></a>00875 
<a name="l00876"></a>00876   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l00877"></a>00877     {
<a name="l00878"></a>00878       fac1=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,0);
<a name="l00879"></a>00879       fac2=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,1);
<a name="l00880"></a>00880       fac3=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,2);
<a name="l00881"></a>00881       fac4=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,3);
<a name="l00882"></a>00882       ori1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac1);
<a name="l00883"></a>00883       ori3 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac3);
<a name="l00884"></a>00884 
<a name="l00885"></a>00885       <span class="keywordflow">if</span> (ori1 == 1)  <span class="comment">//!&lt; (seule possibilite : ori3 =0)  Arete XY</span>
<a name="l00886"></a>00886 <span class="comment"></span>        {
<a name="l00887"></a>00887           <span class="keywordtype">double</span> flux1;
<a name="l00888"></a>00888 <span class="comment">// flux de mu_lam</span>
<a name="l00889"></a>00889 <span class="comment">// sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00890"></a>00890 
<a name="l00891"></a>00891           flux1 = visco_lam*0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))
<a name="l00892"></a>00892                   *(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00893"></a>00893           <span class="keywordflow">for</span> (l=tab1[fac3]-1; l&lt;tab1[fac3+1]-1; l++)
<a name="l00894"></a>00894             {
<a name="l00895"></a>00895               <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l00896"></a>00896                 coeff[l]+=flux1;
<a name="l00897"></a>00897               <span class="keywordflow">if</span> (tab2[l]-1==fac4)
<a name="l00898"></a>00898                 coeff[l]-=flux1;
<a name="l00899"></a>00899             }
<a name="l00900"></a>00900           <span class="keywordflow">for</span> (l=tab1[fac4]-1; l&lt;tab1[fac4+1]-1; l++)
<a name="l00901"></a>00901             {
<a name="l00902"></a>00902               <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l00903"></a>00903                 coeff[l]-=flux1;
<a name="l00904"></a>00904               <span class="keywordflow">if</span> (tab2[l]-1==fac4)
<a name="l00905"></a>00905                 coeff[l]+=flux1;
<a name="l00906"></a>00906             }
<a name="l00907"></a>00907 
<a name="l00908"></a>00908 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l00909"></a>00909 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l00910"></a>00910 
<a name="l00911"></a>00911           coef_laplacien_axi = 0.5*visco_lam;
<a name="l00912"></a>00912           <span class="keywordflow">for</span> (l=tab1[fac1]-1; l&lt;tab1[fac1+1]-1; l++)
<a name="l00913"></a>00913             {
<a name="l00914"></a>00914               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l00915"></a>00915                 coeff[l]+=coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fac1)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fac1,0);
<a name="l00916"></a>00916             }
<a name="l00917"></a>00917           <span class="keywordflow">for</span> (l=tab1[fac2]-1; l&lt;tab1[fac2+1]-1; l++)
<a name="l00918"></a>00918             {
<a name="l00919"></a>00919               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l00920"></a>00920                 coeff[l]+=coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fac2)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fac2,0);
<a name="l00921"></a>00921             }
<a name="l00922"></a>00922 
<a name="l00923"></a>00923 <span class="comment">// flux de mu_lam</span>
<a name="l00924"></a>00924 <span class="comment">// sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00925"></a>00925 
<a name="l00926"></a>00926           flux1 = visco_lam*0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac4))
<a name="l00927"></a>00927                   *(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac4));
<a name="l00928"></a>00928           <span class="keywordflow">for</span> (l=tab1[fac1]-1; l&lt;tab1[fac1+1]-1; l++)
<a name="l00929"></a>00929             {
<a name="l00930"></a>00930               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l00931"></a>00931                 coeff[l]+=flux1;
<a name="l00932"></a>00932               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l00933"></a>00933                 coeff[l]-=flux1;
<a name="l00934"></a>00934             }
<a name="l00935"></a>00935           <span class="keywordflow">for</span> (l=tab1[fac2]-1; l&lt;tab1[fac2+1]-1; l++)
<a name="l00936"></a>00936             {
<a name="l00937"></a>00937               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l00938"></a>00938                 coeff[l]-=flux1;
<a name="l00939"></a>00939               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l00940"></a>00940                 coeff[l]+=flux1;
<a name="l00941"></a>00941             }
<a name="l00942"></a>00942         }
<a name="l00943"></a>00943       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3 == 1) <span class="comment">//!&lt; (seule possibilite ori1 = 2) arete YZ</span>
<a name="l00944"></a>00944 <span class="comment"></span>        {
<a name="l00945"></a>00945 <span class="comment">// flux de mu_lam*tau32</span>
<a name="l00946"></a>00946 <span class="comment">// sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00947"></a>00947           <span class="keywordtype">double</span> flux2;
<a name="l00948"></a>00948           flux2 = visco_lam*0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))
<a name="l00949"></a>00949                   *(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00950"></a>00950           <span class="keywordflow">for</span> (l=tab1[fac3]-1; l&lt;tab1[fac3+1]-1; l++)
<a name="l00951"></a>00951             {
<a name="l00952"></a>00952               <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l00953"></a>00953                 coeff[l]+=flux2;
<a name="l00954"></a>00954               <span class="keywordflow">if</span> (tab2[l]-1==fac4)
<a name="l00955"></a>00955                 coeff[l]-=flux2;
<a name="l00956"></a>00956             }
<a name="l00957"></a>00957           <span class="keywordflow">for</span> (l=tab1[fac4]-1; l&lt;tab1[fac4+1]-1; l++)
<a name="l00958"></a>00958             {
<a name="l00959"></a>00959               <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l00960"></a>00960                 coeff[l]-=flux2;
<a name="l00961"></a>00961               <span class="keywordflow">if</span> (tab2[l]-1==fac4)
<a name="l00962"></a>00962                 coeff[l]+=flux2;
<a name="l00963"></a>00963             }
<a name="l00964"></a>00964 
<a name="l00965"></a>00965 <span class="comment">// flux de mu_lam*tau23</span>
<a name="l00966"></a>00966 <span class="comment">// sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l00967"></a>00967 
<a name="l00968"></a>00968           flux2 = visco_lam*0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac4))
<a name="l00969"></a>00969                   *(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac4));
<a name="l00970"></a>00970           <span class="keywordflow">for</span> (l=tab1[fac1]-1; l&lt;tab1[fac1+1]-1; l++)
<a name="l00971"></a>00971             {
<a name="l00972"></a>00972               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l00973"></a>00973                 coeff[l]+=flux2;
<a name="l00974"></a>00974               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l00975"></a>00975                 coeff[l]-=flux2;
<a name="l00976"></a>00976             }
<a name="l00977"></a>00977           <span class="keywordflow">for</span> (l=tab1[fac2]-1; l&lt;tab1[fac2+1]-1; l++)
<a name="l00978"></a>00978             {
<a name="l00979"></a>00979               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l00980"></a>00980                 coeff[l]-=flux2;
<a name="l00981"></a>00981               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l00982"></a>00982                 coeff[l]+=flux2;
<a name="l00983"></a>00983             }
<a name="l00984"></a>00984         }
<a name="l00985"></a>00985       <span class="keywordflow">else</span> <span class="comment">//!&lt; seule possibilite ori1 = 2 et ori3 = 0:  arete XZ</span>
<a name="l00986"></a>00986 <span class="comment"></span>        {
<a name="l00987"></a>00987 <span class="comment">// flux de mu_lam*tau31</span>
<a name="l00988"></a>00988 <span class="comment">// sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l00989"></a>00989           <span class="keywordtype">double</span> flux3;
<a name="l00990"></a>00990           flux3 = visco_lam*0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))
<a name="l00991"></a>00991                   *(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l00992"></a>00992           <span class="keywordflow">for</span> (l=tab1[fac3]-1; l&lt;tab1[fac3+1]-1; l++)
<a name="l00993"></a>00993             {
<a name="l00994"></a>00994               <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l00995"></a>00995                 coeff[l]+=flux3;
<a name="l00996"></a>00996               <span class="keywordflow">if</span> (tab2[l]-1==fac4)
<a name="l00997"></a>00997                 coeff[l]-=flux3;
<a name="l00998"></a>00998             }
<a name="l00999"></a>00999           <span class="keywordflow">for</span> (l=tab1[fac4]-1; l&lt;tab1[fac4+1]-1; l++)
<a name="l01000"></a>01000             {
<a name="l01001"></a>01001               <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l01002"></a>01002                 coeff[l]-=flux3;
<a name="l01003"></a>01003               <span class="keywordflow">if</span> (tab2[l]-1==fac4)
<a name="l01004"></a>01004                 coeff[l]+=flux3;
<a name="l01005"></a>01005             }
<a name="l01006"></a>01006 
<a name="l01007"></a>01007 <span class="comment">// flux de mu_lam*tau13</span>
<a name="l01008"></a>01008 <span class="comment">// sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l01009"></a>01009 
<a name="l01010"></a>01010           flux3 = visco_lam*0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac4))
<a name="l01011"></a>01011                   *(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac4));
<a name="l01012"></a>01012           <span class="keywordflow">for</span> (l=tab1[fac1]-1; l&lt;tab1[fac1+1]-1; l++)
<a name="l01013"></a>01013             {
<a name="l01014"></a>01014               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l01015"></a>01015                 coeff[l]+=flux3;
<a name="l01016"></a>01016               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l01017"></a>01017                 coeff[l]-=flux3;
<a name="l01018"></a>01018             }
<a name="l01019"></a>01019           <span class="keywordflow">for</span> (l=tab1[fac2]-1; l&lt;tab1[fac2+1]-1; l++)
<a name="l01020"></a>01020             {
<a name="l01021"></a>01021               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l01022"></a>01022                 coeff[l]-=flux3;
<a name="l01023"></a>01023               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l01024"></a>01024                 coeff[l]+=flux3;
<a name="l01025"></a>01025             }
<a name="l01026"></a>01026         }
<a name="l01027"></a>01027     }
<a name="l01028"></a>01028 
<a name="l01029"></a>01029 <span class="comment">// Boucle sur les aretes internes</span>
<a name="l01030"></a>01030 
<a name="l01031"></a>01031   ndeb = zvdf.<a class="code" href="classZone__VDF.html#ae228e03cea92f748053ea0533368a030">premiere_arete_interne</a>();
<a name="l01032"></a>01032   nfin = zvdf.<a class="code" href="classZone__VDF.html#add0341183f527326bc526c92bbb19225">nb_aretes</a>();
<a name="l01033"></a>01033 
<a name="l01034"></a>01034   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l01035"></a>01035     {
<a name="l01036"></a>01036       fac1=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,0);
<a name="l01037"></a>01037       fac2=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,1);
<a name="l01038"></a>01038       fac3=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,2);
<a name="l01039"></a>01039       fac4=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,3);
<a name="l01040"></a>01040       ori1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac1);
<a name="l01041"></a>01041       ori3 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac3);
<a name="l01042"></a>01042 
<a name="l01043"></a>01043 <span class="comment">// Calcul de la viscosite turbulente au milieu de l&#39;arete</span>
<a name="l01044"></a>01044 
<a name="l01045"></a>01045       d_visco_turb = 0.25*(visco_turb(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>(fac3,0)) + visco_turb(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>(fac3,1))
<a name="l01046"></a>01046                            + visco_turb(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>(fac4,0)) + visco_turb(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ac1a626ee98da9a8761f94d1d18d5f1b1">face_voisins</a>(fac4,1)));
<a name="l01047"></a>01047 
<a name="l01048"></a>01048       <span class="keywordflow">if</span> (ori1 == 1)  <span class="comment">//!&lt; (seule possibilite : ori3 =0)  Arete XY</span>
<a name="l01049"></a>01049 <span class="comment"></span>        {
<a name="l01050"></a>01050 <span class="comment">// flux de mu_lam + mu_turb</span>
<a name="l01051"></a>01051 <span class="comment">// sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l01052"></a>01052           <span class="keywordtype">double</span> flux1;
<a name="l01053"></a>01053           flux1 = (visco_lam + d_visco_turb)
<a name="l01054"></a>01054                   *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l01055"></a>01055           <span class="keywordflow">for</span> (l=tab1[fac3]-1; l&lt;tab1[fac3+1]-1; l++)
<a name="l01056"></a>01056             {
<a name="l01057"></a>01057               <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l01058"></a>01058                 coeff[l]+=flux1;
<a name="l01059"></a>01059               <span class="keywordflow">if</span> (tab2[l]-1==fac4)
<a name="l01060"></a>01060                 coeff[l]-=flux1;
<a name="l01061"></a>01061             }
<a name="l01062"></a>01062           <span class="keywordflow">for</span> (l=tab1[fac4]-1; l&lt;tab1[fac4+1]-1; l++)
<a name="l01063"></a>01063             {
<a name="l01064"></a>01064               <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l01065"></a>01065                 coeff[l]-=flux1;
<a name="l01066"></a>01066               <span class="keywordflow">if</span> (tab2[l]-1==fac4)
<a name="l01067"></a>01067                 coeff[l]+=flux1;
<a name="l01068"></a>01068             }
<a name="l01069"></a>01069 
<a name="l01070"></a>01070 <span class="comment">// Termes supplementaires dans le laplacien en axi</span>
<a name="l01071"></a>01071 <span class="comment">// Ils sont integres comme des termes sources</span>
<a name="l01072"></a>01072 
<a name="l01073"></a>01073           coef_laplacien_axi = 0.5*(visco_lam + d_visco_turb);
<a name="l01074"></a>01074           <span class="keywordflow">for</span> (l=tab1[fac1]-1; l&lt;tab1[fac1+1]-1; l++)
<a name="l01075"></a>01075             {
<a name="l01076"></a>01076               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l01077"></a>01077                 coeff[l]+=coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fac1)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fac1,0);
<a name="l01078"></a>01078             }
<a name="l01079"></a>01079           <span class="keywordflow">for</span> (l=tab1[fac2]-1; l&lt;tab1[fac2+1]-1; l++)
<a name="l01080"></a>01080             {
<a name="l01081"></a>01081               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l01082"></a>01082                 coeff[l]+=coef_laplacien_axi*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a097f780f9ac937518426d596cdf3f997">volumes_entrelaces</a>(fac2)*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2)/<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a370661b29069bb08f884cf496389f19c">xv</a>(fac2,0);
<a name="l01083"></a>01083             }
<a name="l01084"></a>01084 
<a name="l01085"></a>01085 <span class="comment">// flux de mu_lam*tau12 + mu_turb*(tau21+tau12)</span>
<a name="l01086"></a>01086 <span class="comment">// sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l01087"></a>01087 
<a name="l01088"></a>01088           flux1 = (visco_lam + d_visco_turb)
<a name="l01089"></a>01089                   *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac4))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac4));
<a name="l01090"></a>01090           <span class="keywordflow">for</span> (l=tab1[fac1]-1; l&lt;tab1[fac1+1]-1; l++)
<a name="l01091"></a>01091             {
<a name="l01092"></a>01092               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l01093"></a>01093                 coeff[l]+=flux1;
<a name="l01094"></a>01094               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l01095"></a>01095                 coeff[l]-=flux1;
<a name="l01096"></a>01096             }
<a name="l01097"></a>01097           <span class="keywordflow">for</span> (l=tab1[fac2]-1; l&lt;tab1[fac2+1]-1; l++)
<a name="l01098"></a>01098             {
<a name="l01099"></a>01099               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l01100"></a>01100                 coeff[l]-=flux1;
<a name="l01101"></a>01101               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l01102"></a>01102                 coeff[l]+=flux1;
<a name="l01103"></a>01103             }
<a name="l01104"></a>01104         }
<a name="l01105"></a>01105       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ori3 == 1) <span class="comment">//!&lt; (seule possibilite ori1 = 2) arete YZ</span>
<a name="l01106"></a>01106 <span class="comment"></span>        {
<a name="l01107"></a>01107           <span class="keywordtype">double</span> flux2;
<a name="l01108"></a>01108 <span class="comment">// flux de mu_lam*tau32 + mu_turb*(tau32+tau23)</span>
<a name="l01109"></a>01109 <span class="comment">// sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l01110"></a>01110 
<a name="l01111"></a>01111           flux2 = (visco_lam + d_visco_turb)
<a name="l01112"></a>01112                   *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l01113"></a>01113 
<a name="l01114"></a>01114           <span class="keywordflow">for</span> (l=tab1[fac3]-1; l&lt;tab1[fac3+1]-1; l++)
<a name="l01115"></a>01115             {
<a name="l01116"></a>01116               <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l01117"></a>01117                 coeff[l]+=flux2;
<a name="l01118"></a>01118               <span class="keywordflow">if</span> (tab2[l]-1==fac4)
<a name="l01119"></a>01119                 coeff[l]-=flux2;
<a name="l01120"></a>01120             }
<a name="l01121"></a>01121           <span class="keywordflow">for</span> (l=tab1[fac4]-1; l&lt;tab1[fac4+1]-1; l++)
<a name="l01122"></a>01122             {
<a name="l01123"></a>01123               <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l01124"></a>01124                 coeff[l]-=flux2;
<a name="l01125"></a>01125               <span class="keywordflow">if</span> (tab2[l]-1==fac4)
<a name="l01126"></a>01126                 coeff[l]+=flux2;
<a name="l01127"></a>01127             }
<a name="l01128"></a>01128 
<a name="l01129"></a>01129 <span class="comment">// flux de mu_lam*tau23 + mu_turb*(tau32+tau23)</span>
<a name="l01130"></a>01130 <span class="comment">// sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l01131"></a>01131 
<a name="l01132"></a>01132           flux2 = (visco_lam + d_visco_turb)
<a name="l01133"></a>01133                   *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac4))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac4));
<a name="l01134"></a>01134           <span class="keywordflow">for</span> (l=tab1[fac1]-1; l&lt;tab1[fac1+1]-1; l++)
<a name="l01135"></a>01135             {
<a name="l01136"></a>01136               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l01137"></a>01137                 coeff[l]+=flux2;
<a name="l01138"></a>01138               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l01139"></a>01139                 coeff[l]-=flux2;
<a name="l01140"></a>01140             }
<a name="l01141"></a>01141           <span class="keywordflow">for</span> (l=tab1[fac2]-1; l&lt;tab1[fac2+1]-1; l++)
<a name="l01142"></a>01142             {
<a name="l01143"></a>01143               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l01144"></a>01144                 coeff[l]-=flux2;
<a name="l01145"></a>01145               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l01146"></a>01146                 coeff[l]+=flux2;
<a name="l01147"></a>01147             }
<a name="l01148"></a>01148         }
<a name="l01149"></a>01149       <span class="keywordflow">else</span> <span class="comment">//!&lt; seule possibilite ori1 = 2 et ori3 = 0:  arete XZ</span>
<a name="l01150"></a>01150 <span class="comment"></span>        {
<a name="l01151"></a>01151 <span class="comment">// flux de  mu_lam*tau31 + mu_turb*(tau31+tau13)</span>
<a name="l01152"></a>01152 <span class="comment">// sur la facette a cheval sur les faces fac1 et fac2</span>
<a name="l01153"></a>01153           <span class="keywordtype">double</span> flux3;
<a name="l01154"></a>01154           flux3 = (visco_lam + d_visco_turb)
<a name="l01155"></a>01155                   *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac1)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac2));
<a name="l01156"></a>01156           <span class="keywordflow">for</span> (l=tab1[fac3]-1; l&lt;tab1[fac3+1]-1; l++)
<a name="l01157"></a>01157             {
<a name="l01158"></a>01158               <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l01159"></a>01159                 coeff[l]+=flux3;
<a name="l01160"></a>01160               <span class="keywordflow">if</span> (tab2[l]-1==fac4)
<a name="l01161"></a>01161                 coeff[l]-=flux3;
<a name="l01162"></a>01162             }
<a name="l01163"></a>01163           <span class="keywordflow">for</span> (l=tab1[fac4]-1; l&lt;tab1[fac4+1]-1; l++)
<a name="l01164"></a>01164             {
<a name="l01165"></a>01165               <span class="keywordflow">if</span> (tab2[l]-1==fac3)
<a name="l01166"></a>01166                 coeff[l]-=flux3;
<a name="l01167"></a>01167               <span class="keywordflow">if</span> (tab2[l]-1==fac4)
<a name="l01168"></a>01168                 coeff[l]+=flux3;
<a name="l01169"></a>01169             }
<a name="l01170"></a>01170 
<a name="l01171"></a>01171 <span class="comment">// flux de mu_lam*tau13 + mu_turb*(tau13+tau31)</span>
<a name="l01172"></a>01172 <span class="comment">// sur la facette a cheval sur les faces fac3 et fac4</span>
<a name="l01173"></a>01173 
<a name="l01174"></a>01174           flux3 = (visco_lam + d_visco_turb)
<a name="l01175"></a>01175                   *0.25*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac4))*(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac3)+<a class="code" href="classOp__Dift__VDF__Face__Axi.html#adc4477a4daf2b51227915999635a51a4">porosite</a>(fac4));
<a name="l01176"></a>01176           <span class="keywordflow">for</span> (l=tab1[fac1]-1; l&lt;tab1[fac1+1]-1; l++)
<a name="l01177"></a>01177             {
<a name="l01178"></a>01178               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l01179"></a>01179                 coeff[l]+=flux3;
<a name="l01180"></a>01180               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l01181"></a>01181                 coeff[l]-=flux3;
<a name="l01182"></a>01182             }
<a name="l01183"></a>01183           <span class="keywordflow">for</span> (l=tab1[fac2]-1; l&lt;tab1[fac2+1]-1; l++)
<a name="l01184"></a>01184             {
<a name="l01185"></a>01185               <span class="keywordflow">if</span> (tab2[l]-1==fac1)
<a name="l01186"></a>01186                 coeff[l]-=flux3;
<a name="l01187"></a>01187               <span class="keywordflow">if</span> (tab2[l]-1==fac2)
<a name="l01188"></a>01188                 coeff[l]+=flux3;
<a name="l01189"></a>01189             }
<a name="l01190"></a>01190         }
<a name="l01191"></a>01191 
<a name="l01192"></a>01192     }
<a name="l01193"></a>01193 }
<a name="l01194"></a>01194 
<a name="l01195"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#a352917fa666f9482cebb6114b2bffe28">01195</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a352917fa666f9482cebb6114b2bffe28">Op_Dift_VDF_Face_Axi::contribue_au_second_membre</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu )<span class="keyword"> const</span>
<a name="l01196"></a>01196 <span class="keyword"></span>{
<a name="l01197"></a>01197 
<a name="l01198"></a>01198   <span class="keywordtype">double</span> temps=<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>();
<a name="l01199"></a>01199   <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classOp__Dift__VDF__Face__Axi.html" title="class Op_Dift_VDF_Face_Axi Cette classe represente l&#39;operateur de diffusion global (diffusions lamina...">Op_Dift_VDF_Face_Axi</a>, (*<span class="keyword">this</span>)).mettre_a_jour(temps);
<a name="l01200"></a>01200   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a1c5f1cbcfc6e7c97490fa04287a8d989">la_zone_vdf</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l01201"></a>01201 <span class="comment">// const Zone_Cl_VDF&amp; zclvdf = la_zcl_vdf.valeur();</span>
<a name="l01202"></a>01202 <span class="comment">// int nb_elem = zvdf.nb_elem();</span>
<a name="l01203"></a>01203 <span class="comment">// int nb_aretes = zvdf.nb_aretes();</span>
<a name="l01204"></a>01204 
<a name="l01205"></a>01205 <span class="comment">// const Champ_Uniforme&amp; viscosite_lam = diffusivite_;</span>
<a name="l01206"></a>01206 <span class="comment">// double visco_lam = viscosite_lam(0,0);</span>
<a name="l01207"></a>01207 <span class="comment">// const DoubleVect&amp; visco_turb = diffusivite_turbulente()-&gt;valeurs();</span>
<a name="l01208"></a>01208 
<a name="l01209"></a>01209 <span class="comment">// Boucle sur les bord pour traiter les faces de type sortie_libre</span>
<a name="l01210"></a>01210 
<a name="l01211"></a>01211   <span class="keywordtype">int</span> ndeb, nfin;
<a name="l01212"></a>01212 
<a name="l01213"></a>01213 <span class="comment">// Boucle sur les aretes bord</span>
<a name="l01214"></a>01214 
<a name="l01215"></a>01215   <span class="keywordtype">int</span> n_arete;
<a name="l01216"></a>01216   ndeb = zvdf.<a class="code" href="classZone__VDF.html#aa272d66cc2d519b88c3d5e8f0f70d700">premiere_arete_bord</a>();
<a name="l01217"></a>01217   nfin = ndeb + zvdf.<a class="code" href="classZone__VDF.html#a88b3380a8314d855c0f30a138efd834c">nb_aretes_bord</a>();
<a name="l01218"></a>01218 
<a name="l01219"></a>01219   <span class="keywordtype">double</span> flux;
<a name="l01220"></a>01220   <span class="keywordtype">int</span> n_type,ori3,fac1,fac2,fac3;
<a name="l01221"></a>01221 
<a name="l01222"></a>01222 
<a name="l01223"></a>01223   <span class="keywordflow">for</span> (n_arete=ndeb; n_arete&lt;nfin; n_arete++)
<a name="l01224"></a>01224     {
<a name="l01225"></a>01225       n_type=<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae8a443e04bc8afc20a83e550509af995">type_arete_bord</a>(n_arete-ndeb);
<a name="l01226"></a>01226 
<a name="l01227"></a>01227       <span class="keywordflow">switch</span>(n_type)
<a name="l01228"></a>01228         {
<a name="l01229"></a>01229         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515aa9710a2d7c9e127d8251241d728dbeca">TypeAreteBordVDF::PAROI_PAROI</a>: <span class="comment">//!&lt; paroi-paroi</span>
<a name="l01230"></a>01230 <span class="comment"></span>          {
<a name="l01231"></a>01231             fac1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,0);
<a name="l01232"></a>01232             fac2 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,1);
<a name="l01233"></a>01233             fac3 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae5cf93bf0a9b5208a421b78584903f10">Qdm</a>(n_arete,2);
<a name="l01234"></a>01234             ori3 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a22417b23f25ed430cf04ecd5447facd8">orientation</a>(fac3);
<a name="l01235"></a>01235             <span class="keywordtype">int</span> rang1 = (fac1-zvdf.<a class="code" href="classZone__VF.html#a9571f861dfb23f699da7042773644a42" title="renvoie le numero de la premiere des faces sur lesquelles sont appliquees les conditions limites : bo...">premiere_face_bord</a>());
<a name="l01236"></a>01236             <span class="keywordtype">int</span> rang2 = (fac2-zvdf.<a class="code" href="classZone__VF.html#a9571f861dfb23f699da7042773644a42" title="renvoie le numero de la premiere des faces sur lesquelles sont appliquees les conditions limites : bo...">premiere_face_bord</a>());
<a name="l01237"></a>01237             <span class="keywordtype">double</span> vit = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#aaa1c42e7200c0fe959fe8a1e7498a113">inconnue</a>.<a class="code" href="classRef__Champ__Face.html#ab3bc856ba736c84e483378400b194290">valeur</a>()(fac3);
<a name="l01238"></a>01238             <span class="keywordtype">double</span> vit_imp = 0.5*(<a class="code" href="Champ__Face_8cpp.html#ae2ba1e8935ec33397828bf564e63f6d7">Champ_Face_get_val_imp_face_bord</a>(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#aaa1c42e7200c0fe959fe8a1e7498a113">inconnue</a>-&gt;temps(),rang1,ori3,<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae1c32a53f9159425724fae235f5c0ef8">la_zcl_vdf</a>)+
<a name="l01239"></a>01239                                   <a class="code" href="Champ__Face_8cpp.html#ae2ba1e8935ec33397828bf564e63f6d7">Champ_Face_get_val_imp_face_bord</a>(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#aaa1c42e7200c0fe959fe8a1e7498a113">inconnue</a>-&gt;temps(),rang2,ori3,<a class="code" href="classOp__Dift__VDF__Face__Axi.html#ae1c32a53f9159425724fae235f5c0ef8">la_zcl_vdf</a>));
<a name="l01240"></a>01240 
<a name="l01241"></a>01241             <span class="keywordtype">double</span> tau1 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a85afc90e34f927d4af6fbde9e691f8ee">tau_tan</a>(rang1,ori3)*0.5*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac1);
<a name="l01242"></a>01242             <span class="keywordtype">double</span> tau2 = <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a85afc90e34f927d4af6fbde9e691f8ee">tau_tan</a>(rang2,ori3)*0.5*<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a7bddaf8302c1669a0695d36bd9742016">surface</a>(fac2);
<a name="l01243"></a>01243             <span class="keywordtype">double</span> coef = tau1+tau2;
<a name="l01244"></a>01244 
<a name="l01245"></a>01245             <span class="keywordtype">int</span> signe_terme;
<a name="l01246"></a>01246 
<a name="l01247"></a>01247             <span class="keywordflow">if</span> ( vit &lt; vit_imp )
<a name="l01248"></a>01248               signe_terme = -1;
<a name="l01249"></a>01249             <span class="keywordflow">else</span>
<a name="l01250"></a>01250               signe_terme = 1;
<a name="l01251"></a>01251 
<a name="l01252"></a>01252 <span class="comment">// YB : 30/01/2004 :</span>
<a name="l01253"></a>01253 <span class="comment">// Elimination de la determination du signe du flux parietal par l&#39;evaluateur de l&#39;operateur de diffusion,</span>
<a name="l01254"></a>01254 <span class="comment">// en contre-partie le cisaillement parietal fournit par la loi paroi est signe (voir modif dans distances_VDF.cpp)</span>
<a name="l01255"></a>01255             signe_terme = 1;
<a name="l01256"></a>01256 <span class="comment">// Fin modif YB</span>
<a name="l01257"></a>01257 
<a name="l01258"></a>01258             flux = signe_terme*coef;
<a name="l01259"></a>01259 
<a name="l01260"></a>01260             resu[fac3]+= flux;
<a name="l01261"></a>01261             <span class="keywordflow">break</span>;
<a name="l01262"></a>01262           }
<a name="l01263"></a>01263 
<a name="l01264"></a>01264         <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a656b9604972e0a5da058bdc15ee527eb">TypeAreteBordVDF::FLUIDE_FLUIDE</a> : <span class="comment">//!&lt; fluide-fluide</span>
<a name="l01265"></a>01265 <span class="comment"></span>        <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515ac8b6b758ccba8044caff44a9d35859aa">TypeAreteBordVDF::PAROI_FLUIDE</a>: <span class="comment">//!&lt; paroi-fluide</span>
<a name="l01266"></a>01266 <span class="comment"></span>        <span class="keywordflow">case</span> <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a8ffe822aae0518f507be135120ec23b8">TypeAreteBordVDF::SYM_SYM</a>:
<a name="l01267"></a>01267           {
<a name="l01268"></a>01268 <span class="comment">// symetrie-symetrie</span>
<a name="l01269"></a>01269 <span class="comment">// pas de flux diffusif calcule</span>
<a name="l01270"></a>01270             <span class="keywordflow">break</span>;
<a name="l01271"></a>01271           }
<a name="l01272"></a>01272         <span class="keywordflow">default</span> :
<a name="l01273"></a>01273           {
<a name="l01274"></a>01274             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On a rencontre un type d&#39;arete non prevu\n&quot;</span>;
<a name="l01275"></a>01275             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;num arete : &quot;</span> &lt;&lt; n_arete;
<a name="l01276"></a>01276             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; type : &quot;</span> &lt;&lt; n_type;
<a name="l01277"></a>01277             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01278"></a>01278             <span class="keywordflow">break</span>;
<a name="l01279"></a>01279           }
<a name="l01280"></a>01280         }
<a name="l01281"></a>01281     }
<a name="l01282"></a>01282 }
<a name="l01283"></a><a class="code" href="classOp__Dift__VDF__Face__Axi.html#a84408a40a9072a987d775e35c4f3eaf8">01283</a> <span class="keywordtype">double</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a84408a40a9072a987d775e35c4f3eaf8" title="Calcul dt_stab.">Op_Dift_VDF_Face_Axi::calculer_dt_stab</a>()<span class="keyword"> const</span>
<a name="l01284"></a>01284 <span class="keyword"></span>{
<a name="l01285"></a>01285   <span class="keywordflow">return</span> <a class="code" href="classOp__Dift__VDF__Face__Axi.html#a84408a40a9072a987d775e35c4f3eaf8" title="Calcul dt_stab.">Op_Dift_VDF_Face_base::calculer_dt_stab</a>(<a class="code" href="classOp__Dift__VDF__Face__Axi.html#a1c5f1cbcfc6e7c97490fa04287a8d989">la_zone_vdf</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>()) ;
<a name="l01286"></a>01286 }
<a name="l01287"></a>01287 
<a name="l01288"></a>01288 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:40 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
