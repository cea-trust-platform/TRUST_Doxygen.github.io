<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: Matrice_Morse Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a>  </div>
  <div class="headertitle">
<div class="title">Matrice_Morse Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Matrice_Morse" --><!-- doxytag: inherits="Matrice_Base" -->
<p>Classe <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a><br/>
Represente une matrice M (creuse), non necessairement carree<br/>
stockee au format Morse.<br/>
-----------------------------------------------------------------------<br/>
On utilise 3 tableaux tab1(n+1), tab2(nnz) et coeff_(nnz):<br/>
On note Vi = { j differents de i / M(i,j) est non nul }<br/>
tab1[i] = rang dans tab2 de la ieme ligne<br/>
pour tab1[i] &lt;= j &lt; tab1[i+1], tab2[j] decrit Vi<br/>
et coeff_[j] = M(i,tab2[j])<br/>
tab1 et tab2 sont des rangs au sens fortran:<br/>
1 &lt;= tab2[i] &lt;= n<br/>
tab1[n+1] = nnz+1<br/>
Remarque: dans ce commentaire le [] est a prendre au sens fortran:<br/>
tab1[1] designe la premiere valeur de tab1<br/>
C'est aussi le format décrit dans la page Wikipedia :<br/>
<a href="https://fr.wikipedia.org/wiki/Matrice_creuse">https://fr.wikipedia.org/wiki/Matrice_creuse</a><br/>
en faisant un +1 sur tous les éléments des tableaux d'indices (IA et JA dans la page)<br/>
-----------------------------------------------------------------------.  
 <a href="classMatrice__Morse.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Matrice_Morse:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classMatrice__Morse.png" usemap="#Matrice_Morse_map" alt=""/>
  <map id="Matrice_Morse_map" name="Matrice_Morse_map">
<area href="classMatrice__Base.html" alt="Matrice_Base" shape="rect" coords="0,112,131,136"/>
<area href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob..." alt="Objet_U" shape="rect" coords="0,56,131,80"/>
<area href="classProcess.html" title="Classe de base de TRUST (notamment Objet_U). Elle fournit quelques services de base accessibles de pa..." alt="Process" shape="rect" coords="0,0,131,24"/>
<area href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri..." alt="Matrice_Morse_Sym" shape="rect" coords="0,224,131,248"/>
<area href="classMatrice__Morse__Diag.html" title="Classe Matrice_Morse_Diag Represente une matrice M (creuse) symetrique stockee au format Morse Diaget..." alt="Matrice_Morse_Diag" shape="rect" coords="0,280,131,304"/>
</map>
 </div></div>

<p><a href="classMatrice__Morse-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#aa340a977754dbde89cf12b7075704732">~Matrice_Morse</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a4c1dd5b6b3f42e1c5360711353089b78">taille_memoire</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#ab4c3cc61f2b809197114f83b308b935e">duplique</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classType__info.html">Type_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a47c0dc151bd5b3026a2f0422e3a081d2">get_info</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Donne des informations sur le type de l'Objet_U.  <a href="#a47c0dc151bd5b3026a2f0422e3a081d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">Matrice_Morse</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a8763add3c9688e9b5c84c31107d7c15a">Matrice_Morse</a> (int n, int nnz)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructeur d'une matrice Morse carree d'ordre n<br/>
et pouvant stocker au maximum nnz elements non nuls.<br/>
Egalement constructeur par defaut car les 2 parametres<br/>
ont une valeur par defaut.  <a href="#a8763add3c9688e9b5c84c31107d7c15a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a77e544c96b37ab92ca8d5e3f964acc9f">Matrice_Morse</a> (int n, int m, int nnz)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructeur d'une matrice Morse avec n lignes et m colonnes<br/>
pouvant stocker au maximum nnz elements non nuls.  <a href="#a77e544c96b37ab92ca8d5e3f964acc9f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#ab114473e0598bf631416343daaa8be0e">Matrice_Morse</a> (const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructeur par copie d'une <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>.<br/>
Copie de chaque membre donne du paramtre.  <a href="#ab114473e0598bf631416343daaa8be0e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a48c84b2db8020db9e7e9e9855a17cbd4">Matrice_Morse</a> (int, int, const <a class="el" href="classIntLists.html">IntLists</a> &amp;, const <a class="el" href="classDoubleLists.html">DoubleLists</a> &amp;, const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a5061454fa787608b578aed2c4d5bf224">imprimer</a> (<a class="el" href="classSortie.html">Sortie</a> &amp;s) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a60c1de967d05b21b9b96a9bf6d73334e">imprimer_formatte</a> (<a class="el" href="classSortie.html">Sortie</a> &amp;s) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a66338277e3a4e8f250a151824e659171">imprimer_formatte</a> (<a class="el" href="classSortie.html">Sortie</a> &amp;s, int symetrie) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a518c0888db8297116700155dd97e58dc">imprimer_image</a> (<a class="el" href="classSortie.html">Sortie</a> &amp;s) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a28da443e8ba8168bf04e5368dfef7a8f">imprimer_image</a> (<a class="el" href="classSortie.html">Sortie</a> &amp;s, int symetrie) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a95c8d6e95a8ad58710856f60bf07cd43">largeur_de_bande</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Retourne la largeur de bande.  <a href="#a95c8d6e95a8ad58710856f60bf07cd43"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">remplir</a> (const <a class="el" href="classIntLists.html">IntLists</a> &amp;, const <a class="el" href="classDoubleLists.html">DoubleLists</a> &amp;, const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a0477806560509033e4b46b0b65ac6deb">remplir</a> (const <a class="el" href="classIntLists.html">IntLists</a> &amp;, const <a class="el" href="classDoubleLists.html">DoubleLists</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a0b13859051ee9505b3beb82ceb94c116">remplir</a> (const int, const int, const int, const int, const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Remplissage d'une matrice morse par une matrice morse plus petite.  <a href="#a0b13859051ee9505b3beb82ceb94c116"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">dimensionner</a> (int n, int nnz)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Size the matrix with n lines and n columns and nnz zero-values coefficients.  <a href="#ae95f9ed88a8a3fc637cd2a705cead9c8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a5d58732a34204377b1531de430b6230b">dimensionner</a> (int n, int m, int nnz)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Size the matrix with n lines, m columns with nnz zero-values coefficients.  <a href="#a5d58732a34204377b1531de430b6230b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a782ad0bcd14245c72494c85d7feab9f7">dimensionner</a> (const <a class="el" href="classIntTab.html">IntTab</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a">ordre</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Renvoie l'ordre de la matrice:<br/>
- le nombre de lignes si la matrice est carree<br/>
- 0 sinon.  <a href="#a24a51a119cc5068408773a983ce5f13a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#ab2fb02a8aba88f717c2285960f375fba">set_nb_columns</a> (const int)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#ae99753a8725a9a7f58b62d6e675a69d8">set_symmetric</a> (const int)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a6f50c254db1753e72f23c6d051590fe7">get_symmetric</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntVect.html">IntVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntVect.html">IntVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classIntVect.html">IntVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a> (void) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classIntVect.html">IntVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a> (void) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a> (void) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#aebca6e5632d935408e1f81674209a86c">nb_vois</a> (int i) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a3fe9dc9cd6e414e6781b2dcba28acf1f">clean</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Remplit la matrice avec des zeros.  <a href="#a3fe9dc9cd6e414e6781b2dcba28acf1f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#ad1238bc19f3f043e9a4af8282e5d6521">operator()</a> (int i, int j)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#acb3b84de4aa8089c9bd1fd7b123d0f62">operator()</a> (int i, int j) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a> (int i, int j) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a9ef96f721c59576db6d4460a4ef7c110">coef</a> (int i, int j)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a5ed8c0c5ce20ddb2dff99c2eec47006f">operator=</a> (const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a> d'affectation d'une <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> dans une<br/>
autre <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>.  <a href="#a5ed8c0c5ce20ddb2dff99c2eec47006f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#ac77dbfcd9310f3b356ad3d2766a5f100">operator+=</a> (const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">NE FAIT RIEN.  <a href="#ac77dbfcd9310f3b356ad3d2766a5f100"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a547bc77cbec07f7cb77f180d2a600149">operator*=</a> (double)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a> de multiplication (de tous les elements)<br/>
d'une matrice par un scalaire.<br/>
Operation: A = x * A.  <a href="#a547bc77cbec07f7cb77f180d2a600149"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a31b1e2dbaae22b47a6908ed7e073fc98">scale</a> (const double &amp;x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#af77867348031b93d7cf4ce63d5718030">get_stencil</a> (<a class="el" href="classIntTab.html">IntTab</a> &amp;stencil) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a547351090cbce6887a957abb3d081223">get_stencil_and_coefficients</a> (<a class="el" href="classIntTab.html">IntTab</a> &amp;stencil, <a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;coefficients) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a6e0753ddc2866580a7716588fafff24e">operator/=</a> (double)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a> de division (de tous les elements)<br/>
d'une matrice par un scalaire.<br/>
Operation: A = A / x.  <a href="#a6e0753ddc2866580a7716588fafff24e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a3bf78034a1ed02f3721b406183577f59">operator*=</a> (const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a> de multiplication d'une matrice par un vecteur:<br/>
scaling des lignes de la matrice par les coefficients<br/>
correspondants du vecteur passe en parametre.<br/>
A *= x, effectue les scaling suivants:<br/>
A(i,:) = A(i,:) * x(i), pour toutes les lignes i de A.  <a href="#a3bf78034a1ed02f3721b406183577f59"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#ad701760e949d89c0c3be1fc768af1a93">operator-</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a> de negation unaire, renvoie l'opposee de la matrice: - A<br/>
Appelle operator*(double,const <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp;)  <a href="#ad701760e949d89c0c3be1fc768af1a93"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a53383f880cbb5efcfddc92c1e570fc9c">inverse</a> (const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;, double) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calcule la solution du systeme lineaire: A * solution = secmem.<br/>
La methode utilisee est GMRES preconditionnee avec ILUT.<br/>
ATTENTION: cette methode n'a vraisemblablement jamais ete testee en parallele.  <a href="#a53383f880cbb5efcfddc92c1e570fc9c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a0c2a2537386dc03a8978da93fedc93ae">inverse</a> (const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;, double, int) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a1aa4f648fa4ada1731cd8ae41a8ec23e">affecte_prod</a> (const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;A, const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;B)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Affecte le produit de 2 matrices Morse A et B a l'objet (this).<br/>
Operation: this = A * B.  <a href="#a1aa4f648fa4ada1731cd8ae41a8ec23e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#af20143b6c3f18319cc28c326a64f031c">compacte</a> (int elim_coeff_nul=0)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to check/clean the <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> matrix:<br/>
-Suppress coefficient defined several times<br/>
-elim_coeff_nul=0, on ne supprime pas les coefficients nuls de la matrice<br/>
-elim_coeff_nul=1, on supprime les coefficients nuls de la matrice<br/>
-elim_coeff_nul=2, on supprime les coefficients nuls et quasi-nuls de la matrice.  <a href="#af20143b6c3f18319cc28c326a64f031c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a46680c7fbcd8478a9fdc774914de2a53">ajouter_multvect_</a> (const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Operation de multiplication-accumulation (saxpy) matrice vecteur.<br/>
Operation: resu = resu + A*x.  <a href="#a46680c7fbcd8478a9fdc774914de2a53"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#ae134fbd51a66dca2ccede1dbc3e45dc0">ajouter_multvect_</a> (const <a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;, <a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;, <a class="el" href="classArrOfInt.html">ArrOfInt</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a7bbc0c7773ecb51c01d76adc02356dc0">ajouter_multTab_</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Operation de multiplication-accumulation (saxpy) matrice matrice&lt;br&gt;(matrice X representee par un tableau)<br/>
Operation: RESU = RESU + A*X.  <a href="#a7bbc0c7773ecb51c01d76adc02356dc0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a2c69581723fcbf4eef3254119b20cc44">ajouter_multvectT_</a> (const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Operation de multiplication-accumulation (saxpy) matrice vecteur,<br/>
par la matrice transposee.<br/>
Operation: resu = resu + A^{T}*x.  <a href="#a2c69581723fcbf4eef3254119b20cc44"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#aecb0c25de76938492958d3676ed6d266">ajouter_multvectT_</a> (const <a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;, <a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;, <a class="el" href="classArrOfInt.html">ArrOfInt</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a9859a88c59daf0b968b3c5090e18f264">transpose</a> (const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;a)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">*this = a transposee.  <a href="#a9859a88c59daf0b968b3c5090e18f264"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a657f2db151b16ebb64ee5b78a6faed86">diagmulmat</a> (const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#af1142c6d58bd4b5d01cfbb9bdc600fe9">partie_sup</a> (const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;a)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#afc6dc20707960db1921c7e1ca90966a8">unite</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a071f82da63647c04faa2cee21dc38047">construire_sous_bloc</a> (int nl0, int nc0, int nl1, int nc1, <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;result) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a8bafab20c667e1bed56a463ffb30e349">formeC</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a3bcd59ac30cd776ea695a8c8f2d2776d">formeF</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a11eec428fe6de8eeba3113b682dd38f1">has_same_morse_matrix_structure</a> (const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a8852df62bb7604061e8a7873bebddda4">check_morse_matrix_structure</a> (void) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a16be4586cacf33093dcd6a8fd804f7f0">check_sorted_morse_matrix_structure</a> (void) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a> (void) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a4f6d3b49c29109b73048a7ba84cf543f">assert_check_sorted_morse_matrix_structure</a> (void) const </td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classObjet__U.html">Objet_U</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a559b3c34d5e44573fdaf1da7c5945bad">cree_instance</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classType__info.html">Type_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a50068a424014eb75d4fcdc1d45ec25e8">info</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Donne des informations sur le type de l'Objet_U.  <a href="#a50068a424014eb75d4fcdc1d45ec25e8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#aa191120d886b432f3a665b84f0b0b2ad">self_cast</a> (<a class="el" href="classObjet__U.html">Objet_U</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a145749c6fa53b79983ed7c65f7b817b6">self_cast</a> (const <a class="el" href="classObjet__U.html">Objet_U</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">methode ajoutee pour caster en python  <a href="#a145749c6fa53b79983ed7c65f7b817b6"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag if matrix structure changes.  <a href="#a1a9134b16e927cd79db6e6d75a15a312"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classType__info.html">Type_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a07f45a5fa9c163729cc79d0a480db940">info_obj</a></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a28b21c265cfd181b8ffb9fc1821abd33">printOn</a> (<a class="el" href="classSortie.html">Sortie</a> &amp;x) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Ecrit les trois tableaux de la structure de stockage<br/>
Morse sur un flot de sortie.  <a href="#a28b21c265cfd181b8ffb9fc1821abd33"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classEntree.html">Entree</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a49ab0e8938f70c06575ad81b02065915">readOn</a> (<a class="el" href="classEntree.html">Entree</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">NON CODE.  <a href="#a49ab0e8938f70c06575ad81b02065915"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntVect.html">IntVect</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntVect.html">IntVect</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleVect.html">DoubleVect</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0">m_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of columns.  <a href="#a44dbdb39389f6f17711f5072ce9cf2e0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816">symetrique_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Pour inliner operator()(i,j) afin d'optimiser.  <a href="#aa18902f5bb7084749524e6625ad35816"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a8e9254acaa95bbcb76a8ff1772b9b572">zero_</a></td></tr>
<tr><td colspan="2"><h2><a name="friends"></a>
Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#a9b2be70ec114aadae982e55d2c748db9">operator+</a> (const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;, const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Fonction (hors classe) amie de la classe <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a><br/>
Addition de 2 matrices au format Morse.<br/>
Operation: renvoie (A+B)  <a href="#a9b2be70ec114aadae982e55d2c748db9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMatrice__Morse.html#afc77ba81a0a4335b418508f9bae4941c">operator*</a> (double, const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Fonction (hors classe) amie de la classe <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a><br/>
Scaling de la matrice par un scalaire: multiplie tous<br/>
les elements de la matrice par un scalaire.<br/>
Operation: renvoie x*A.  <a href="#afc77ba81a0a4335b418508f9bae4941c"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Classe <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a><br/>
Represente une matrice M (creuse), non necessairement carree<br/>
stockee au format Morse.<br/>
-----------------------------------------------------------------------<br/>
On utilise 3 tableaux tab1(n+1), tab2(nnz) et coeff_(nnz):<br/>
On note Vi = { j differents de i / M(i,j) est non nul }<br/>
tab1[i] = rang dans tab2 de la ieme ligne<br/>
pour tab1[i] &lt;= j &lt; tab1[i+1], tab2[j] decrit Vi<br/>
et coeff_[j] = M(i,tab2[j])<br/>
tab1 et tab2 sont des rangs au sens fortran:<br/>
1 &lt;= tab2[i] &lt;= n<br/>
tab1[n+1] = nnz+1<br/>
Remarque: dans ce commentaire le [] est a prendre au sens fortran:<br/>
tab1[1] designe la premiere valeur de tab1<br/>
C'est aussi le format décrit dans la page Wikipedia :<br/>
<a href="https://fr.wikipedia.org/wiki/Matrice_creuse">https://fr.wikipedia.org/wiki/Matrice_creuse</a><br/>
en faisant un +1 sur tous les éléments des tableaux d'indices (IA et JA dans la page)<br/>
-----------------------------------------------------------------------. </p>

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00059">59</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa340a977754dbde89cf12b7075704732"></a><!-- doxytag: member="Matrice_Morse::~Matrice_Morse" ref="aa340a977754dbde89cf12b7075704732" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Matrice_Morse::~Matrice_Morse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00037">37</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6c3f7ff3eb33b4f893a98f93f485d133"></a><!-- doxytag: member="Matrice_Morse::Matrice_Morse" ref="a6c3f7ff3eb33b4f893a98f93f485d133" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Matrice_Morse::Matrice_Morse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00280">280</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8cpp_source.html#l00346">dimensionner()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00236">symetrique_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00240">zero_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(0,0);
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a> = 0;
  <a class="code" href="classMatrice__Morse.html#a8e9254acaa95bbcb76a8ff1772b9b572">zero_</a> = 0;
  <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = false ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8763add3c9688e9b5c84c31107d7c15a"></a><!-- doxytag: member="Matrice_Morse::Matrice_Morse" ref="a8763add3c9688e9b5c84c31107d7c15a" args="(int n, int nnz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Matrice_Morse::Matrice_Morse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructeur d'une matrice Morse carree d'ordre n<br/>
et pouvant stocker au maximum nnz elements non nuls.<br/>
Egalement constructeur par defaut car les 2 parametres<br/>
ont une valeur par defaut. </p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00273">273</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8cpp_source.html#l00346">dimensionner()</a>, and <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>.</p>
<div class="fragment"><pre class="fragment">                                           :
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>(1), <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>(0), <a class="code" href="classMatrice__Morse.html#a8e9254acaa95bbcb76a8ff1772b9b572">zero_</a>(0)
{
  <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n,nnz);
  <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = false ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a77e544c96b37ab92ca8d5e3f964acc9f"></a><!-- doxytag: member="Matrice_Morse::Matrice_Morse" ref="a77e544c96b37ab92ca8d5e3f964acc9f" args="(int n, int m, int nnz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Matrice_Morse::Matrice_Morse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructeur d'une matrice Morse avec n lignes et m colonnes<br/>
pouvant stocker au maximum nnz elements non nuls. </p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00316">316</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8cpp_source.html#l00346">dimensionner()</a>, and <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>.</p>
<div class="fragment"><pre class="fragment">                                                 :
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>(1), <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>(0), <a class="code" href="classMatrice__Morse.html#a8e9254acaa95bbcb76a8ff1772b9b572">zero_</a>(0)
{
  <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n,m,nnz);
  <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = false ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab114473e0598bf631416343daaa8be0e"></a><!-- doxytag: member="Matrice_Morse::Matrice_Morse" ref="ab114473e0598bf631416343daaa8be0e" args="(const Matrice_Morse &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Matrice_Morse::Matrice_Morse </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>acopier</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructeur par copie d'une <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>.<br/>
Copie de chaque membre donne du paramtre. </p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00239">239</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>.</p>
<div class="fragment"><pre class="fragment">                                                         :<a class="code" href="classMatrice__Base.html#a1923e12b4e15256aa4d591f2da443e3d">Matrice_Base</a>(),
  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(acopier.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>),
  <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(acopier.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>),
  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(acopier.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>),
  <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a>(acopier.<a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a>),
  <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>(0),
  <a class="code" href="classMatrice__Morse.html#a8e9254acaa95bbcb76a8ff1772b9b572">zero_</a>(0)
{
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = acopier.<a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a48c84b2db8020db9e7e9e9855a17cbd4"></a><!-- doxytag: member="Matrice_Morse::Matrice_Morse" ref="a48c84b2db8020db9e7e9e9855a17cbd4" args="(int, int, const IntLists &amp;, const DoubleLists &amp;, const DoubleVect &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Matrice_Morse::Matrice_Morse </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIntLists.html">IntLists</a> &amp;&#160;</td>
          <td class="paramname"><em>voisins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleLists.html">DoubleLists</a> &amp;&#160;</td>
          <td class="paramname"><em>valeurs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>terme_diag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00324">324</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8cpp_source.html#l00346">dimensionner()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l02068">remplir()</a>.</p>
<div class="fragment"><pre class="fragment">  :  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>(1), <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>(0) , <a class="code" href="classMatrice__Morse.html#a8e9254acaa95bbcb76a8ff1772b9b572">zero_</a>(0)
{
  <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n,n,nnz);
  <a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">remplir</a>(voisins, valeurs, terme_diag);
  <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a1aa4f648fa4ada1731cd8ae41a8ec23e"></a><!-- doxytag: member="Matrice_Morse::affecte_prod" ref="a1aa4f648fa4ada1731cd8ae41a8ec23e" args="(const Matrice_Morse &amp;A, const Matrice_Morse &amp;B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp; Matrice_Morse::affecte_prod </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Affecte le produit de 2 matrices Morse A et B a l'objet (this).<br/>
Operation: this = A * B. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp;<br/>
 Signification: le resultat de l'operation (*this)<br/>
 Contraintes: </dd></dl>

<p><p>&lt; nb de lignes de A</p>
<p>&lt; nb de colonnes de B assert(nrow==ncol); Jloi non?</p>
<p>&lt; on recupere tout (tab1, tab2, coeff de matrice_resu)</p>
<p>&lt; nb de valeurs maximales de la matrice resultante</p>
<p>&lt; tableau de travail </p>
</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01616">1616</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00107">nb_coeff()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="DoubleVect_8h_source.html#l00193">DoubleVect::resize()</a>, <a class="el" href="IntVect_8h_source.html#l00179">IntVect::resize()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> nrow= a.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();                <span class="comment">//!&lt; nb de lignes de A</span>
<span class="comment"></span>  <span class="keywordtype">int</span> ncol= b.<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();                <span class="comment">//!&lt; nb de colonnes de B assert(nrow==ncol); Jloi non?</span>
<span class="comment"></span><span class="comment">//</span>
<span class="comment">//</span>
  assert(nrow==ncol);
  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nrow+1);
  <span class="keywordtype">int</span> job = 1 ;                      <span class="comment">//!&lt; on recupere tout (tab1, tab2, coeff de matrice_resu)</span>
<span class="comment"></span>  <span class="keywordtype">int</span>  nzmax = <a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>();                <span class="comment">//!&lt; nb de valeurs maximales de la matrice resultante</span>
<span class="comment"></span>  <span class="keywordflow">if</span>(nzmax==0)
    {
      nzmax=a.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>();
      <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nzmax);
      <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nzmax);
      assert(nzmax==<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>());
    }
  <a class="code" href="classIntVect.html">IntVect</a> iw(ncol+1);                        <span class="comment">//!&lt; tableau de travail</span>
<span class="comment"></span>

<span class="comment">// Cerr &lt;&lt; &quot; iao1 &quot; &lt;&lt; a.tab1_ &lt;&lt; finl ;</span>
<span class="comment">// Cerr &lt;&lt; &quot; jao1 &quot; &lt;&lt; a.tab2_ &lt;&lt; finl ;</span>
<span class="comment">// Cerr &lt;&lt; &quot; aao1 &quot; &lt;&lt; a.coeff_ &lt;&lt; finl ;</span>
<span class="comment">// </span>
<span class="comment">// Cerr &lt;&lt; &quot; iao2 &quot; &lt;&lt; b.tab1_ &lt;&lt; finl ;</span>
<span class="comment">// Cerr &lt;&lt; &quot; jao2 &quot; &lt;&lt; b.tab2_ &lt;&lt; finl ;</span>
<span class="comment">// Cerr &lt;&lt; &quot; aao2 &quot; &lt;&lt; b.coeff_ &lt;&lt; finl ;</span>


<span class="comment">// while(ierr=0)</span>
<span class="comment">// {</span>
<span class="comment">// F77NAME(AMUB)(&amp;nb_lig, &amp;nb_col, &amp;job, A.coeff_, A.tab2_, A.tab1_,</span>
<span class="comment">// B.coeff_, B.tab2_, B.tab1_,</span>
<span class="comment">// coeff_.addr(), tab2_.addr(), tab1_.addr(), &amp;nzmax, iw, &amp;ierr);</span>
<span class="comment">// </span>
<span class="comment">// </span>
<span class="comment">// c----------------------------------------------------------------------c</span>
<span class="comment">// subroutine amub (nrow,ncol,job,a,ja,ia,b,jb,ib,</span>
<span class="comment">// *                 c,jc,ic,nzmax,iw,ierr)</span>
<span class="comment">// real*8 a(*), b(*), c(*)</span>
<span class="comment">// integer ja(*),jb(*),jc(*),ia(nrow+1),ib(ncol+1),</span>
<span class="comment">// *     ic(ncol+1),iw(ncol)</span>
<span class="comment">// c-----------------------------------------------------------------------</span>
<span class="comment">// c performs the matrix by matrix product C = A B</span>
<span class="comment">// c-----------------------------------------------------------------------</span>
<span class="comment">// c on entry:</span>
<span class="comment">// c ---------</span>
<span class="comment">// c nrow        = integer. The row dimension of A</span>
<span class="comment">// c ncol  = integer. The column dimension of B</span>
<span class="comment">// c job   = integer. Job indicator. When job = 0, only the structure</span>
<span class="comment">// c                  (i.e. the arrays jc, ic) is computed and the</span>
<span class="comment">// c                  real values are ignored.</span>
<span class="comment">// c</span>
<span class="comment">// c a,</span>
<span class="comment">// c ja,</span>
<span class="comment">// c ia   = Matrix A in compressed sparse row format.</span>
<span class="comment">// c</span>
<span class="comment">// c b,</span>
<span class="comment">// c jb,</span>
<span class="comment">// c ib        =  Matrix B in compressed sparse row format.</span>
<span class="comment">// c</span>
<span class="comment">// c nzmax        = integer. The  length of the arrays c and jc.</span>
<span class="comment">// c         amub will stop if the result matrix C  has a number</span>
<span class="comment">// c         of elements that exceeds exceeds nzmax. See ierr.</span>
<span class="comment">// c</span>
<span class="comment">// c on return:</span>
<span class="comment">// c----------</span>
<span class="comment">// c c,</span>
<span class="comment">// c jc,</span>
<span class="comment">// c ic        = resulting matrix C in compressed sparse row sparse format.</span>
<span class="comment">// c</span>
<span class="comment">// c ierr        = integer. serving as error message.</span>
<span class="comment">// c         ierr = 0 means normal return,</span>
<span class="comment">// c         ierr .gt. 0 means that amub stopped while computing the</span>
<span class="comment">// c         i-th row  of C with i=ierr, because the number</span>
<span class="comment">// c         of elements in C exceeds nzmax.</span>
<span class="comment">// c</span>
<span class="comment">// c work arrays:</span>
<span class="comment">// c------------</span>
<span class="comment">// c iw        = integer work array of length equal to the number of</span>
<span class="comment">// c         columns in A.</span>
<span class="comment">// c Notes:</span>
<span class="comment">// c-------</span>
<span class="comment">// c         The column dimension of B is not needed.</span>
<span class="comment">// c</span>
<span class="comment">// c-----------------------------------------------------------------</span>
<span class="comment">// real*8 scal</span>
<span class="comment">// logical values</span>
<span class="comment">// values = (job .ne. 0)</span>
<span class="comment">// len = 0</span>
<span class="comment">// ic(1) = 1</span>
<span class="comment">// ierr = 0</span>
<span class="comment">// c     initialize array iw.</span>
<span class="comment">// do 1 j=1, ncol</span>
<span class="comment">// iw(j) = 0</span>
<span class="comment">// 1    continue</span>
<span class="comment">// c</span>

  <span class="keywordtype">double</span> scal=0. ;
  <span class="keywordtype">int</span> ii, jj ,k , ka, kb ;
  <span class="keywordtype">int</span> values = 0;
  <span class="keywordflow">if</span> (job != 0) values = 1 ;
  <span class="keywordtype">int</span> len = -1 ;
  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[0] = 1  ;
  iw = -1 ;

<span class="comment">// do 500 ii=1, nrow</span>
<span class="comment">// c     row i</span>
<span class="comment">// do 200 ka=ia(ii), ia(ii+1)-1</span>
<span class="comment">// if (values) scal = a(ka)</span>
<span class="comment">// jj   = ja(ka)</span>
<span class="comment">// do 100 kb=ib(jj),ib(jj+1)-1</span>
<span class="comment">// jcol = jb(kb)</span>
<span class="comment">// jpos = iw(jcol)</span>
<span class="comment">// if (jpos .eq. 0) then</span>
<span class="comment">// len = len+1</span>
<span class="comment">// if (len .gt. nzmax) then</span>
<span class="comment">// ierr = ii</span>
<span class="comment">// return</span>
<span class="comment">// endif</span>
<span class="comment">// jc(len) = jcol</span>
<span class="comment">// iw(jcol)= len</span>
<span class="comment">// if (values) c(len)  = scal*b(kb)</span>
<span class="comment">// else</span>
<span class="comment">// if (values) c(jpos) = c(jpos) + scal*b(kb)</span>
<span class="comment">// endif</span>
<span class="comment">// 100            continue</span>
<span class="comment">// 200     continue</span>
<span class="comment">// do 201 k=ic(ii), len</span>
<span class="comment">// iw(jc(k)) = 0</span>
<span class="comment">// 201     continue</span>
<span class="comment">// ic(ii+1) = len+1</span>
<span class="comment">// 500  continue</span>

<span class="comment">// Cerr &lt;&lt; &quot;Matrice_Morse::affect_prod nrow &quot; &lt;&lt; nrow &lt;&lt; finl;</span>

  <span class="keywordflow">for</span>(ii=0; ii&lt; nrow; ii++)
    {
      <span class="keywordflow">for</span>(ka=a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[ii]-1; ka &lt; a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[ii+1]-1; ka++)
        {
          <span class="keywordflow">if</span> (values == 1) scal = a.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[ka] ;
          jj   = a.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[ka] - 1 ;
          <span class="keywordflow">for</span> (kb=b.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[jj]-1; kb &lt; b.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[jj+1]-1; kb++)
            {
              <span class="keywordtype">int</span> jcol = b.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kb] -1 ;
              <span class="keywordtype">int</span> jpos = iw[jcol]  ;
              <span class="keywordflow">if</span> (jpos == -1)
                {
                  len++ ;
                  <span class="keywordflow">if</span> (len &gt; nzmax-1)
                    {
<span class="comment">// Cerr &lt;&lt; &quot;Matrice_Morse::affect_prod len &gt; nzmax -1 &quot; &lt;&lt; nzmax &lt;&lt; finl;</span>
                      nzmax += nrow/ii*nzmax;
                      <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nzmax);
                      <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nzmax);
                    }
                  <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[len] = jcol + 1 ;
                  iw[jcol]= len ;
                  <span class="keywordflow">if</span> (values == 1) <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[len]  = scal*b.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kb] ;
                }
              <span class="keywordflow">else</span>
                {
                  <span class="keywordflow">if</span> (values == 1) <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[jpos] += scal*b.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kb] ;
                }
            }
        }

      <span class="keywordflow">for</span> (k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[ii]-1; k &lt; len+1 ; k++) iw[<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k]-1] = -1 ;
      <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[ii+1] = (len+1) + 1 ;
    }

<span class="comment">// return</span>
<span class="comment">// c-------------end-of-amub-----------------------------------------------</span>
<span class="comment">// c-----------------------------------------------------------------------</span>
<span class="comment">// </span>
<span class="comment">// if(ierr)</span>
<span class="comment">// {</span>
<span class="comment">// nzmax+=nrow/ierr*nzmax;</span>
<span class="comment">// coeff_.resize(nzmax);</span>
<span class="comment">// tab2_.resize(nzmax);</span>
<span class="comment">// }</span>
<span class="comment">// </span>
<span class="comment">// }</span>

  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[nrow]-1);
  <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[nrow]-1);
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <span class="keywordflow">return</span> *<span class="keyword">this</span>;

}
</pre></div>
</div>
</div>
<a class="anchor" id="a7bbc0c7773ecb51c01d76adc02356dc0"></a><!-- doxytag: member="Matrice_Morse::ajouter_multTab_" ref="a7bbc0c7773ecb51c01d76adc02356dc0" args="(const DoubleTab &amp;, DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Matrice_Morse::ajouter_multTab_ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Operation de multiplication-accumulation (saxpy) matrice matrice&lt;br&gt;(matrice X representee par un tableau)<br/>
Operation: RESU = RESU + A*X. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;<br/>
 Signification: la matrice resultat de l'operation<br/>
 Contraintes: </dd></dl>

<p>Implements <a class="el" href="classMatrice__Base.html#a4160528ba7847acfcca6c4639eefeb98">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#a7bea42d0f3d63ca6c0db2a0998eb15aa">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#a9aaf9f8c5d9066345a411aa19daaf99d">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01009">1009</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Base_8h_source.html#l00230">Matrice_Base::ajouter_multvect()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02422">assert_check_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="DoubleTab_8h_source.html#l00264">DoubleTab::nb_dim()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>

<p>Referenced by <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l03201">Op_Diff_VEFP1NCP1B_Face::test()</a>.</p>
<div class="fragment"><pre class="fragment">{

  <span class="keywordflow">if</span> ( (x.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 1) &amp;&amp; (resu.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 1))
    {
      <a class="code" href="classMatrice__Base.html#a6ccb4d20d3877cf09f5178ff72af5406" title="Operation de multiplication-accumulation (saxpy) matrice vecteur. Operation: r = r + A*x...">ajouter_multvect</a>(x,resu);
      <span class="keywordflow">return</span> resu;
    }

  <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
  <span class="keywordtype">int</span> i, k;
  <span class="keywordtype">int</span> nb_comp = x.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);

  assert(resu.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) == nb_comp);
  <span class="keywordtype">double</span>* t= <span class="keyword">new</span> <span class="keywordtype">double</span>[nb_comp];
  <span class="keywordtype">int</span> ncomp;
  <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
    {
      <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
        t[ncomp] = 0.0;
      <span class="keywordflow">for</span> (k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
        <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
          t[ncomp] += <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)*x(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1,ncomp);
      <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
        resu(i,ncomp) += t[ncomp] ;
    }
  <span class="keyword">delete</span> [] t;
  <span class="keywordflow">return</span> resu;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae134fbd51a66dca2ccede1dbc3e45dc0"></a><!-- doxytag: member="Matrice_Morse::ajouter_multvect_" ref="ae134fbd51a66dca2ccede1dbc3e45dc0" args="(const ArrOfDouble &amp;, ArrOfDouble &amp;, ArrOfInt &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp; Matrice_Morse::ajouter_multvect_ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArrOfInt.html">ArrOfInt</a> &amp;&#160;</td>
          <td class="paramname"><em>est_reel_pas_com</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00968">968</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8cpp_source.html#l02422">assert_check_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="ArrOfDouble_8h_source.html#l00350">ArrOfDouble::size_array()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
  <span class="keywordtype">int</span> n = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();

  assert(<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>()==x.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>());
  assert(n==resu.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>());
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
    {
      <span class="keywordtype">double</span> t = 0.0;
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
        {
          <span class="keywordtype">int</span> j=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1;
          <span class="keywordflow">if</span> (est_reel_pas_com(j)) t += <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)*x(j);
        }
      resu(i) += t ;
    }
  <span class="keywordflow">return</span> resu;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a46680c7fbcd8478a9fdc774914de2a53"></a><!-- doxytag: member="Matrice_Morse::ajouter_multvect_" ref="a46680c7fbcd8478a9fdc774914de2a53" args="(const DoubleVect &amp;, DoubleVect &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp; Matrice_Morse::ajouter_multvect_ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Operation de multiplication-accumulation (saxpy) matrice vecteur.<br/>
Operation: resu = resu + A*x. </p>

<p><p>&lt; Pour indexer x avec un indice fortran</p>
<p>&lt; indice fortran dans tab2 et coeff</p>
<p>&lt; tab1_[i+1] = indice fortran dans tab2_</p>
<p>&lt; indice fortran </p>
</p>

<p>Implements <a class="el" href="classMatrice__Base.html#a9297a0599dfa75179bbc488cd66d47c9">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#a39241c7b7fcb081c2fbec63fceb4a61f">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#af26200777293b4b2813bf264f92a7bea">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00936">936</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="ArrOfDouble_8h_source.html#l00379">ArrOfDouble::addr()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00371">ArrOfInt::addr()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02422">assert_check_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="DoubleVect_8h_source.html#l00153">DoubleVect::size()</a>, <a class="el" href="ArrOfDouble_8h_source.html#l00350">ArrOfDouble::size_array()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00342">ArrOfInt::size_array()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">Op_Conv_EF_VEF_P1NC_Stab::test_implicite()</a>, and <a class="el" href="Source__PDF__EF_8cpp_source.html#l00628">Source_PDF_EF::verif_ajouter_contrib()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
  <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() - 1;

  assert(x.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() == <a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>());
<span class="comment">// Test dans cet ordre car l&#39;attribut size() peut etre invalide:</span>
  assert(resu.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() == n || resu.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == n);

  <span class="keyword">const</span> <span class="keywordtype">int</span> *tab1_ptr = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() + 1;
  <span class="keyword">const</span> <span class="keywordtype">int</span> *tab2_ptr = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
  <span class="keyword">const</span> <span class="keywordtype">double</span> *coeff_ptr = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
  <span class="keyword">const</span> <span class="keywordtype">double</span> * x_fortran = x.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() - 1; <span class="comment">//!&lt; Pour indexer x avec un indice fortran</span>
<span class="comment"></span>  <span class="keywordtype">int</span> k_fortran = 1; <span class="comment">//!&lt; indice fortran dans tab2 et coeff</span>
<span class="comment"></span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++, tab1_ptr++)
    {
      <span class="keyword">const</span> <span class="keywordtype">int</span> kmax = *tab1_ptr; <span class="comment">//!&lt; tab1_[i+1] = indice fortran dans tab2_</span>
<span class="comment"></span>      assert(kmax &gt;= k_fortran &amp;&amp; kmax &lt;= (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()+1));
      <span class="keywordtype">double</span> t = resu[i];
      assert(k_fortran == <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] &amp;&amp; tab2_ptr == <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>()+(k_fortran-1));
      <span class="keywordflow">for</span> (; k_fortran &lt; kmax; k_fortran++, tab2_ptr++, coeff_ptr++)
        {
          <span class="keywordtype">int</span> colonne = *tab2_ptr; <span class="comment">//!&lt; indice fortran</span>
<span class="comment"></span>          assert(colonne &gt;= 1 &amp;&amp; colonne &lt;= <a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>());
          t += (*coeff_ptr) * x_fortran[colonne];
        }
      resu[i] = t;
    }
  <span class="keywordflow">return</span> resu;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2c69581723fcbf4eef3254119b20cc44"></a><!-- doxytag: member="Matrice_Morse::ajouter_multvectT_" ref="a2c69581723fcbf4eef3254119b20cc44" args="(const DoubleVect &amp;, DoubleVect &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp; Matrice_Morse::ajouter_multvectT_ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Operation de multiplication-accumulation (saxpy) matrice vecteur,<br/>
par la matrice transposee.<br/>
Operation: resu = resu + A^{T}*x. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classDoubleVect.html">DoubleVect</a>&amp;<br/>
 Signification: le vecteur resultat de l'operation<br/>
 Contraintes: </dd></dl>

<p>Implements <a class="el" href="classMatrice__Base.html#a93ee994b59360a580f93703b3020cbaf">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#a90a1263162d98c7961d020c2cb6ed324">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#a745d059b38d2b7c9698cf1428fe1bfb1">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01062">1062</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8cpp_source.html#l02422">assert_check_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );

  <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
    {
      <span class="keywordtype">double</span> xi = x(i);
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
        resu(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1) += <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) * xi;
    }
  <span class="keywordflow">return</span> resu;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aecb0c25de76938492958d3676ed6d266"></a><!-- doxytag: member="Matrice_Morse::ajouter_multvectT_" ref="aecb0c25de76938492958d3676ed6d266" args="(const ArrOfDouble &amp;, ArrOfDouble &amp;, ArrOfInt &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp; Matrice_Morse::ajouter_multvectT_ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArrOfInt.html">ArrOfInt</a> &amp;&#160;</td>
          <td class="paramname"><em>est_reel_pas_com</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01077">1077</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8cpp_source.html#l02422">assert_check_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="ArrOfDouble_8h_source.html#l00350">ArrOfDouble::size_array()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
  <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();

  assert(n==x.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>());
  assert(<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>()==resu.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>());
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
    {
      <span class="keywordflow">if</span> (est_reel_pas_com(i))
        {
          <span class="keywordtype">double</span> xi = x(i);
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
            resu(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1) += <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) * xi;
        }
    }
  <span class="keywordflow">return</span> resu;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a94b178d1ca13742303c6cead98ab6332"></a><!-- doxytag: member="Matrice_Morse::assert_check_morse_matrix_structure" ref="a94b178d1ca13742303c6cead98ab6332" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::assert_check_morse_matrix_structure </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02422">2422</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02300">check_morse_matrix_structure()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l01009">ajouter_multTab_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00936">ajouter_multvect_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01062">ajouter_multvectT_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00573">compacte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01920">get_stencil()</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l01968">get_stencil_and_coefficients()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (!<a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>) <span class="keywordflow">return</span>;
<span class="preprocessor">#ifndef NDEBUG</span>
<span class="preprocessor"></span>  <span class="keywordflow">if</span> ( ! ( <a class="code" href="classMatrice__Morse.html#a8852df62bb7604061e8a7873bebddda4">check_morse_matrix_structure</a>( ) ) )
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in &#39;Matrice_Morse::assert_check_morse_matrix_structure( )&#39;:&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  Exiting...&quot;</span> &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>( );
    }
  <span class="keywordflow">else</span>
    <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=0;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="a4f6d3b49c29109b73048a7ba84cf543f"></a><!-- doxytag: member="Matrice_Morse::assert_check_sorted_morse_matrix_structure" ref="a4f6d3b49c29109b73048a7ba84cf543f" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::assert_check_sorted_morse_matrix_structure </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02437">2437</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02356">check_sorted_morse_matrix_structure()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (!<a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>) <span class="keywordflow">return</span>;
<span class="preprocessor">#ifndef NDEBUG</span>
<span class="preprocessor"></span>  <span class="keywordflow">if</span> ( ! ( <a class="code" href="classMatrice__Morse.html#a16be4586cacf33093dcd6a8fd804f7f0">check_sorted_morse_matrix_structure</a>( ) ) )
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in &#39;Matrice_Morse::assert_check_sorted_morse_matrix_structure( )&#39;:&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  Exiting...&quot;</span> &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>( );
    }
  <span class="keywordflow">else</span>
    <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=0;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="a8852df62bb7604061e8a7873bebddda4"></a><!-- doxytag: member="Matrice_Morse::check_morse_matrix_structure" ref="a8852df62bb7604061e8a7873bebddda4" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Matrice_Morse::check_morse_matrix_structure </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02300">2300</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="ArrOfBit_8h_source.html#l00064">ArrOfBit::setbit()</a>, <a class="el" href="DoubleVect_8h_source.html#l00153">DoubleVect::size()</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l02422">assert_check_morse_matrix_structure()</a>, and <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l01090">Matrice_Morse_Sym::check_symmetric_morse_matrix_structure()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines   = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_columns = <a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>( );
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_coefficients = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( nb_lines ) - 1;

  <span class="keywordflow">if</span> ( <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>( ) != nb_coefficients )
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid tab2 size&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }

  <span class="keywordflow">if</span> ( <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>( ) != nb_coefficients )
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid coeff size&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }

  <a class="code" href="classArrOfBit.html">ArrOfBit</a> flags( nb_columns );

  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
    {
      flags = 0;

      <span class="keywordtype">int</span> k0 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;
      <span class="keywordtype">int</span> k1 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;

      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=k0; k&lt;k1; ++k )
        {
          <span class="keywordtype">int</span> j = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k ) - 1;

          <span class="keywordflow">if</span> ( j &lt; 0 )
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid column index (&lt;0): &quot;</span> &lt;&lt; j &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
              <span class="keywordflow">return</span> <span class="keyword">false</span>;
            }

          <span class="keywordflow">if</span> ( j &gt;= nb_columns )
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid column index (&gt;nb_cols): &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span> &lt;&lt; nb_columns &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
              <span class="keywordflow">return</span> <span class="keyword">false</span>;
            }

          <span class="keywordflow">if</span> ( flags[ j ] )
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid coefficient ( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; ): already defined ( &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
              <span class="keywordflow">return</span> <span class="keyword">false</span>;
            }

          flags.setbit( j );
        }
    }

  <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a16be4586cacf33093dcd6a8fd804f7f0"></a><!-- doxytag: member="Matrice_Morse::check_sorted_morse_matrix_structure" ref="a16be4586cacf33093dcd6a8fd804f7f0" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Matrice_Morse::check_sorted_morse_matrix_structure </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02356">2356</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="ArrOfBit_8h_source.html#l00064">ArrOfBit::setbit()</a>, <a class="el" href="DoubleVect_8h_source.html#l00153">DoubleVect::size()</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>

<p>Referenced by <a class="el" href="Matrix__tools_8cpp_source.html#l00356">Matrix_tools::add_scaled_matrices()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02437">assert_check_sorted_morse_matrix_structure()</a>, and <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l01117">Matrice_Morse_Sym::check_sorted_symmetric_morse_matrix_structure()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines   = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_columns = <a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>( );
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_coefficients = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( nb_lines ) - 1;

  <span class="keywordflow">if</span> ( <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>( ) != nb_coefficients )
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid tab2 size&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }

  <span class="keywordflow">if</span> ( <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>( ) != nb_coefficients )
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid coeff size&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <span class="keywordflow">return</span> <span class="keyword">false</span>;
    }

  <a class="code" href="classArrOfBit.html">ArrOfBit</a> flags( nb_columns );

  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
    {
      flags = 0;

      <span class="keywordtype">int</span> k0 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;
      <span class="keywordtype">int</span> k1 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;

      <span class="keywordtype">int</span> j0 = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k0 ) - 1 - 1;

      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=k0; k&lt;k1; ++k )
        {
          <span class="keywordtype">int</span> j = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k ) - 1;

          <span class="keywordflow">if</span> ( j &lt; 0 )
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid column index (&lt;0): &quot;</span> &lt;&lt; j &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
              <span class="keywordflow">return</span> <span class="keyword">false</span>;
            }

          <span class="keywordflow">if</span> ( j &gt;= nb_columns )
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid column index (&gt;nb_cols): &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span> &lt;&lt; nb_columns &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
              <span class="keywordflow">return</span> <span class="keyword">false</span>;
            }

          <span class="keywordflow">if</span> ( flags[ j ] )
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid coefficient ( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; ): already defined ( &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
              <span class="keywordflow">return</span> <span class="keyword">false</span>;
            }

          <span class="keywordflow">if</span> ( j &lt;= j0 )
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;unsorted coefficient: ( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; ) after ( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; j0 &lt;&lt; <span class="stringliteral">&quot; ) &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;;
              <span class="keywordflow">return</span> <span class="keyword">false</span>;
            }

          j0 = j;
          flags.setbit( j );
        }
    }

  <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3fe9dc9cd6e414e6781b2dcba28acf1f"></a><!-- doxytag: member="Matrice_Morse::clean" ref="a3fe9dc9cd6e414e6781b2dcba28acf1f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::clean </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Remplit la matrice avec des zeros. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>void<br/>
 Signification:<br/>
 Contraintes: </dd></dl>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02265">2265</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00107">nb_coeff()</a>.</p>

<p>Referenced by <a class="el" href="Equation__base_8cpp_source.html#l01832">Equation_base::Gradient_conjugue_diff_impl()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>(); i++)
    <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[i]=0.;
}
</pre></div>
</div>
</div>
<a class="anchor" id="abc28b59726c121e6196bc7eaa666e970"></a><!-- doxytag: member="Matrice_Morse::coef" ref="abc28b59726c121e6196bc7eaa666e970" args="(int i, int j) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Matrice_Morse::coef </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00162">162</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00259">operator()()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF_8cpp_source.html#l01033">Op_Conv_EF::ajouter_contribution_sous_cond()</a>, <a class="el" href="Assembleur__P__EF_8cpp_source.html#l00137">Assembleur_P_EF::assembler_mat()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02455">construire_sous_bloc()</a>, <a class="el" href="Perte__Charge__VEF_8cpp_source.html#l00137">Perte_Charge_VEF::contribuer_a_avec()</a>, <a class="el" href="Perte__Charge__Singuliere__VEF__Face_8cpp_source.html#l00126">Perte_Charge_Singuliere_VEF_Face::contribuer_a_avec()</a>, <a class="el" href="Perte__Charge__Reguliere__VEF__P1NC_8cpp_source.html#l00210">Perte_Charge_Reguliere_VEF_P1NC::contribuer_a_avec()</a>, <a class="el" href="Perte__Charge__Singuliere__PolyMAC__Face_8cpp_source.html#l00108">Perte_Charge_Singuliere_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Source__PDF__EF_8cpp_source.html#l00575">Source_PDF_EF::contribuer_a_avec()</a>, <a class="el" href="Zone__Cl__EF_8cpp_source.html#l00492">Zone_Cl_EF::imposer_symetrie_matrice_secmem()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00580">Matrix_tools::matdiag_mult_matmorse()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00604">Matrix_tools::matmorse_mult_matdiag()</a>, <a class="el" href="Op__EF__base_8cpp_source.html#l00162">Op_EF_base::modifier_pour_Cl()</a>, and <a class="el" href="Matrix__tools_8cpp_source.html#l00629">Matrix_tools::uniform_matdiag_mult_matmorse()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#ad1238bc19f3f043e9a4af8282e5d6521">operator()</a>(i,j);
  };
</pre></div>
</div>
</div>
<a class="anchor" id="a9ef96f721c59576db6d4460a4ef7c110"></a><!-- doxytag: member="Matrice_Morse::coef" ref="a9ef96f721c59576db6d4460a4ef7c110" args="(int i, int j)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double&amp; Matrice_Morse::coef </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00166">166</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00259">operator()()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#ad1238bc19f3f043e9a4af8282e5d6521">operator()</a>(i,j);
  };
</pre></div>
</div>
</div>
<a class="anchor" id="af20143b6c3f18319cc28c326a64f031c"></a><!-- doxytag: member="Matrice_Morse::compacte" ref="af20143b6c3f18319cc28c326a64f031c" args="(int elim_coeff_nul=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::compacte </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>elim_coeff_nul</em> = <code>0</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Method to check/clean the <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> matrix:<br/>
-Suppress coefficient defined several times<br/>
-elim_coeff_nul=0, on ne supprime pas les coefficients nuls de la matrice<br/>
-elim_coeff_nul=1, on supprime les coefficients nuls de la matrice<br/>
-elim_coeff_nul=2, on supprime les coefficients nuls et quasi-nuls de la matrice. </p>

<p><p>&lt; Le plus grand coefficient doit etre strictement positif</p>
<p>&lt; On ne supprime pas un coefficient quasi-nul d'une ligne ou la diagonale peut etre mise a 1e12</p>
<p>&lt; Les coefficients nuls ont deja ete trouves</p>
<p>&lt; Highest column of a coefficient in the line i</p>
<p>&lt; Nombre de coefficients supprimes </p>
</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Sym.html#a02a9b6a6a9b5f47bed207ff5a0f92e69">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00573">573</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8cpp_source.html#l02422">assert_check_morse_matrix_structure()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="Double_8h_source.html#l00273">est_egal()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="DoubleVect_8h_source.html#l00193">DoubleVect::resize()</a>, <a class="el" href="IntVect_8h_source.html#l00179">IntVect::resize()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Bloc_8cpp_source.html#l00676">Matrice_Bloc::remplir()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();

  <span class="keywordtype">int</span> coeff_nuls=0;
  <span class="keywordtype">int</span> coeff_quasi_nuls=0;
  <a class="code" href="classIntTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un IntTab avec allocation dans un pool de memoire gere...">IntTrav</a> elim_coeff(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>);
  <span class="keywordflow">if</span> (elim_coeff_nul)
    {
      <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> coeff_max(n);
<span class="comment">// Recherche des coefficients nuls hors diagonale a supprimer de la matrice morse</span>
      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
          {
            <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k))&gt;coeff_max(i)) coeff_max(i)=<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k));
            <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)==0)
              {
                coeff_nuls++;
                elim_coeff(k)=1;
              }
          }

      <span class="keywordflow">if</span> (elim_coeff_nul==2)
        {
<span class="comment">// Recherche des coefficients quasi nuls hors diagonale (1.e-12 plus petit que le coefficient le plus grand de la ligne) a supprimer de la matrice morse</span>
          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
            <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(coeff_max(i),0)         <span class="comment">//!&lt; Le plus grand coefficient doit etre strictement positif</span>
<span class="comment"></span>                &amp;&amp; coeff_max(i)&lt;1e10)          <span class="comment">//!&lt; On ne supprime pas un coefficient quasi-nul d&#39;une ligne ou la diagonale peut etre mise a 1e12</span>
<span class="comment"></span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
                <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)!=0                 <span class="comment">//!&lt; Les coefficients nuls ont deja ete trouves</span>
<span class="comment"></span>                    &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k))/coeff_max(i),0))
                  {
                    coeff_quasi_nuls++;
                    elim_coeff(k)=1;
                  }
        }
    }
<span class="comment">// Recherche des coefficients doublons</span>
  <span class="keywordtype">int</span> doublons=0;
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
    {
      <span class="keywordtype">int</span> kmin=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1;
      <span class="keywordtype">int</span> kmax=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1;
      <span class="keywordtype">int</span> jmax=-1; <span class="comment">//!&lt; Highest column of a coefficient in the line i</span>
<span class="comment"></span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=kmin; k&lt;kmax; k++)
        {
          <span class="keywordtype">int</span> j = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1;
          <span class="keywordflow">if</span> (j&gt;jmax)
            jmax=j;
          <span class="keywordflow">else</span>
            {
<span class="comment">// Found a column j lower than jmax, check if not defined before:</span>
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=k-1; kk&gt;=kmin; kk--)
                {
                  <span class="keywordtype">int</span> jj = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(kk)-1;
                  <span class="keywordflow">if</span> (jj == j)
                    {
<span class="comment">// Already defined!</span>
                      doublons=1;
                      elim_coeff(k)=1;
<span class="comment">// Check if same coefficients:</span>
                      <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(kk)!=<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k))
                        {
                          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in a Matrix Morse:&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
                          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;A(&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;j&lt;&lt;<span class="stringliteral">&quot;)=&quot;</span>&lt;&lt;<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)&lt;&lt;<span class="stringliteral">&quot; != &quot;</span>&lt;&lt;<span class="stringliteral">&quot;A(&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;jj&lt;&lt;<span class="stringliteral">&quot;)=&quot;</span>&lt;&lt;<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(kk)&lt;&lt;finl;
                          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
                        }
                      <span class="keywordflow">break</span>;
                    }
                }
            }
        }
    }

  <span class="keywordtype">int</span> nnz=0;
  <span class="keywordtype">int</span> kdeb = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(0)-1;
  <span class="keywordtype">int</span> coefficient_suppressed=0; <span class="comment">//!&lt; Nombre de coefficients supprimes</span>
<span class="comment"></span>  <span class="keywordflow">if</span> (doublons || coeff_nuls || coeff_quasi_nuls)
    {
<span class="comment">// Suppress coefficients</span>
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++)
        {
          <span class="keywordtype">int</span> kfin = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1;
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=kdeb; k&lt;kfin; k++)
            {
              <span class="keywordflow">if</span> (!elim_coeff(k))
                {
                  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(nnz) = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k);
                  <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(nnz) = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k);
                  nnz++;
                }
              <span class="keywordflow">else</span>
                coefficient_suppressed++;
            }
<span class="comment">// Modification de tab1_ en fonction du nombre de coefficients deja enleves</span>
          <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-=coefficient_suppressed;
          kdeb = kfin;
        }
    }
  <span class="keywordflow">else</span>
    {
      nnz = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[n] - 1;
    }


<span class="comment">// On redimensionne les tableaux</span>
  <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);
  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);

  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a071f82da63647c04faa2cee21dc38047"></a><!-- doxytag: member="Matrice_Morse::construire_sous_bloc" ref="a071f82da63647c04faa2cee21dc38047" args="(int nl0, int nc0, int nl1, int nc1, Matrice_Morse &amp;result) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::construire_sous_bloc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nl0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nc0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nl1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nc1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; maximum number of zeros that we will find</p>
<p>&lt; is the coeff in the window? </p>
</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02455">2455</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00162">coef()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00346">dimensionner()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// count non-zero entries:</span>
  assert(nl0 &gt;= 0);
  assert(nc0 &gt;= 0);
  assert(nl0 &lt;= nl1);
  assert(nc0 &lt;= nc1);

  <span class="keywordtype">int</span> max_nnz = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(nl1+1) - <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(nl0); <span class="comment">//!&lt; maximum number of zeros that we will find</span>
<span class="comment"></span>  <span class="keywordtype">int</span> tot=0;
  <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> loca(max_nnz, 2);
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> sub_coeffs(max_nnz);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> li=nl0; li &lt;= nl1; li++)
    {
      <span class="keywordtype">int</span> idx_coeff = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(li)-1;
      <span class="keywordtype">int</span> nb_coeff_on_line = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(li+1)-<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(li);
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; nb_coeff_on_line; j++)
        {
          <span class="keywordtype">int</span> col_idx = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(j+idx_coeff)-1;
          <span class="keywordflow">if</span> (col_idx &gt;= nc0 &amp;&amp; col_idx &lt;= nc1) <span class="comment">//!&lt; is the coeff in the window?</span>
<span class="comment"></span>            {
              loca(tot, 0) = li - nl0;
              loca(tot, 1) = col_idx - nc0;
              sub_coeffs(tot) = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(j+idx_coeff);
              tot++;
            }
        }
    }
  loca.resize(tot,2);
  sub_coeffs.resize(tot);

  result.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(loca);
<span class="comment">// Set coefficient values:</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0 ; i &lt; tot; i++)
    {
      <span class="keywordtype">int</span> il = loca(i, 0);
      <span class="keywordtype">int</span> ic = loca(i, 1);
      result.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>(il, ic) = sub_coeffs(i);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a559b3c34d5e44573fdaf1da7c5945bad"></a><!-- doxytag: member="Matrice_Morse::cree_instance" ref="a559b3c34d5e44573fdaf1da7c5945bad" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classObjet__U.html">Objet_U</a> * Matrice_Morse::cree_instance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#a491c04a024df76baa81ddacdc297b100">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#ab2bb9f9cebf42449cc374d0e524fb753">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00037">37</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a657f2db151b16ebb64ee5b78a6faed86"></a><!-- doxytag: member="Matrice_Morse::diagmulmat" ref="a657f2db151b16ebb64ee5b78a6faed86" args="(const DoubleVect &amp;x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp; Matrice_Morse::diagmulmat </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00864">864</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="ArrOfInt_8h_source.html#l00371">ArrOfInt::addr()</a>, <a class="el" href="ArrOfDouble_8h_source.html#l00379">ArrOfDouble::addr()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="arch_8h_source.html#l00075">F77NAME</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="ArrOfDouble_8h_source.html#l00350">ArrOfDouble::size_array()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> m=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordtype">int</span> l=0;
  <span class="keywordtype">int</span> n=x.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
  <span class="keywordflow">if</span>(n!=m)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::diagmulmat bad dimensions&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
    }
<span class="preprocessor">#ifndef CRAY</span>
<span class="preprocessor"></span>  <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(DIAMUA)(&amp;m ,&amp;l,
                  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),x.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
                  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>());
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::diagmulmat DIAMUA call invalid for CRAY&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae95f9ed88a8a3fc637cd2a705cead9c8"></a><!-- doxytag: member="Matrice_Morse::dimensionner" ref="ae95f9ed88a8a3fc637cd2a705cead9c8" args="(int n, int nnz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::dimensionner </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Size the matrix with n lines and n columns and nnz zero-values coefficients. </p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00346">346</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>Referenced by <a class="el" href="Matrix__tools_8cpp_source.html#l00112">Matrix_tools::allocate_morse_matrix()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00192">Matrix_tools::allocate_symmetric_morse_matrix()</a>, <a class="el" href="Assembleur__P__VDF__Q4_8cpp_source.html#l00040">Assembleur_P_VDF_Q4::assembler()</a>, <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00283">assembler()</a>, <a class="el" href="Assembleur__P__EF_8cpp_source.html#l00137">Assembleur_P_EF::assembler_mat()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00152">Matrix_tools::build_morse_matrix()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00228">Matrix_tools::build_symmetric_morse_matrix()</a>, <a class="el" href="Op__Dift__VEF__P1NCP1B__Face_8cpp_source.html#l00159">Op_Dift_VEF_P1NCP1B_Face::calculer_gradient_som()</a>, <a class="el" href="Assembleur__P__VDF_8cpp_source.html#l00112">Assembleur_P_VDF::construire()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02455">construire_sous_bloc()</a>, <a class="el" href="Matrice__Dense_8cpp_source.html#l00156">Matrice_Dense::convert_to_morse_matrix()</a>, <a class="el" href="Matrice__Morse__Diag_8cpp_source.html#l00088">Matrice_Morse_Diag::dimensionne_diag()</a>, <a class="el" href="Op__VEF__Face_8cpp_source.html#l00050">Op_VEF_Face::dimensionner()</a>, <a class="el" href="Op__VDF__Face_8cpp_source.html#l00056">Op_VDF_Face::dimensionner()</a>, <a class="el" href="Op__VDF__Elem_8cpp_source.html#l00033">Op_VDF_Elem::dimensionner()</a>, <a class="el" href="Op__PolyMAC__Elem_8cpp_source.html#l00033">Op_PolyMAC_Elem::dimensionner()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l03016">Op_Diff_VEFP1NCP1B_Face::dimensionner()</a>, <a class="el" href="Solveur__Masse__base_8cpp_source.html#l00408">Solveur_Masse_base::dimensionner()</a>, <a class="el" href="Op__EF__base_8cpp_source.html#l00050">Op_EF_base::dimensionner()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01975">Champ_P1NC_implementation::dimensionner_Mat_Bloc_Morse_Sym()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02278">Equation_base::dimensionner_termes_croises()</a>, <a class="el" href="ILU_8cpp_source.html#l00190">ILU::factorisation()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00273">Matrice_Morse()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, <a class="el" href="Assembleur__P__VEF_8cpp_source.html#l00134">Assembleur_P_VEF::remplir()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02154">remplir()</a>, <a class="el" href="Matrice__Bloc_8cpp_source.html#l00676">Matrice_Bloc::remplir()</a>, <a class="el" href="Precond__local_8cpp_source.html#l00183">Precond_local::res_syst_loc_hybride()</a>, <a class="el" href="Precond__local_8cpp_source.html#l00129">Precond_local::res_syst_loc_simple()</a>, <a class="el" href="Solv__Petsc_8cpp_source.html#l01553">Solv_Petsc::resoudre_systeme()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00716">valeur_P1_H1()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">valeur_P1_L2()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n,n,nnz);
  return ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5d58732a34204377b1531de430b6230b"></a><!-- doxytag: member="Matrice_Morse::dimensionner" ref="a5d58732a34204377b1531de430b6230b" args="(int n, int m, int nnz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::dimensionner </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nnz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Size the matrix with n lines, m columns with nnz zero-values coefficients. </p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00514">514</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00235">m_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="DoubleVect_8h_source.html#l00193">DoubleVect::resize()</a>, <a class="el" href="IntVect_8h_source.html#l00179">IntVect::resize()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00342">ArrOfInt::size_array()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);
  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);
  <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a>=m;

<span class="comment">// on regarde si tab1 a la bonne taille et si tab1[n1]==nnz.</span>
  <span class="keywordflow">if</span> ( <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()!=(n+1) || (<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[n]-1)!=nnz )
    {
      <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n+1);
      <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>=1;
    }
  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n+1);
  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[n]=nnz+1;

  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a782ad0bcd14245c72494c85d7feab9f7"></a><!-- doxytag: member="Matrice_Morse::dimensionner" ref="a782ad0bcd14245c72494c85d7feab9f7" args="(const IntTab &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::dimensionner </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Ind</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; On ne fait rien si la structure est vide </p>
</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00368">368</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00235">m_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="IntTab_8h_source.html#l00254">IntTab::nb_dim()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="DoubleVect_8h_source.html#l00193">DoubleVect::resize()</a>, <a class="el" href="IntVect_8h_source.html#l00179">IntVect::resize()</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (Ind.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>()==0) <span class="keywordflow">return</span>; <span class="comment">//!&lt; On ne fait rien si la structure est vide</span>
<span class="comment"></span>  <span class="keywordtype">int</span> n_ancien = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>(), m_ancien = <a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();

  assert(Ind.<a class="code" href="classIntTab.html#ae307ece7edbe1d5facfbb81953b3e2b1" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 2);
  assert(Ind.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) == 2);

<span class="comment">// Calcul du nouveau nombre de lignes</span>
<span class="comment">// = max (ancien, indices de ligne des nouveaux coeffs)</span>
<span class="comment">// </span>
<span class="comment">// et du nouveau nombre de colonnes</span>
<span class="comment">// = max (ancien, indices de colonne des nouveaux coeffs)</span>

  <span class="keywordtype">int</span> nInd = Ind.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
  <span class="keywordtype">int</span> n = 0;
  <span class="keywordtype">int</span> m = 0;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nInd; i++)
    {
      <span class="keywordflow">if</span> (n &lt; Ind(i,0)) n = Ind(i,0);
      <span class="keywordflow">if</span> (m &lt; Ind(i,1)) m = Ind(i,1);
    }
  n++;
  m++;
  <span class="keywordflow">if</span> (n &lt; n_ancien) n = n_ancien;
  <span class="keywordflow">if</span> (m &lt; m_ancien) m = m_ancien;

<span class="comment">// Copies des anciens tableaux d&#39;indices</span>

  <a class="code" href="classIntVect.html">IntVect</a> tab1_temp(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>);

<span class="comment">// Initialisation au nombre de coefficients deja presents a chaque ligne</span>

  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n+1);
  <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a> = m;

  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=n_ancien; i++)
    <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] = tab1_temp[i] - tab1_temp[i-1];
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=n_ancien+1; i&lt;=n; i++)
    <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] = 0;

<span class="comment">// Parcourt des indices des nouveaux coeffs pour voir s&#39;ils sont</span>
<span class="comment">// deja presents</span>

  <span class="keywordtype">int</span> i_nouveaux = 0;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nInd; i++)
    {
      <span class="keywordtype">int</span> i0 = Ind(i,0);
      <span class="keywordtype">int</span> i1 = Ind(i,1) + 1;

      <span class="keywordtype">int</span> test_present = 0;

      <span class="keywordflow">if</span> (i0 &lt; n_ancien)
        {
          <span class="keywordtype">int</span> kmin = tab1_temp[i0]-1;
          <span class="keywordtype">int</span> kmax = tab1_temp[i0+1]-1;
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=kmin; k&lt;kmax; k++)
            <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] == i1)
              {
                test_present = 1;
                <span class="keywordflow">break</span>;
              }
        }
      <span class="keywordflow">if</span> (!test_present)
        {
          i_nouveaux++;
          <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i0+1] += 1;
        }
    }
  <span class="keywordflow">if</span> (i_nouveaux == 0)
    {
      <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>=tab1_temp;
      <span class="keywordflow">return</span>;
    }

<span class="comment">// Nouveau tableau des positions des premiers coeffs de chaque ligne</span>
  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[0] = 1;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=n; i++)
    <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] += <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i-1];

  <span class="keywordtype">int</span> nnz_ancien = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>();
  <span class="keywordtype">int</span> nnz = nnz_ancien + i_nouveaux;

  <a class="code" href="classIntVect.html">IntVect</a> tab2_temp(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>);
  <a class="code" href="classDoubleVect.html">DoubleVect</a> coeff_temp(<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>);
  <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);
  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);

<span class="comment">// Recopie des anciens coefficients et de leurs indices</span>
<span class="comment">// de colonne dans les nouveaux tableaux</span>

  <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a> = -1;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_ancien; i++)
    {
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j1 = tab1_temp[i]-1, j2 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1;
           j1 &lt; tab1_temp[i+1]-1;
           j1++, j2++)
        {
          <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[j2] = tab2_temp[j1];
          <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[j2] = coeff_temp[j1];
        }
    }

  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nInd; i++)
    {
      <span class="keywordtype">int</span> j0 = Ind(i,0);
      <span class="keywordtype">int</span> j1 = Ind(i,1) + 1;
      <span class="keywordtype">int</span> k;
      <span class="keywordflow">for</span> (k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j0]-1; <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] &gt;= 0; k++)
        <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] == j1)
          {
            <span class="keywordflow">break</span>;
          }
      <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] &lt; 0)
        {
          <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] = j1;
          <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[k] = 0.0;
        }
    }
<span class="comment">// on remet les coeffs dans l&#39;ordre... pas optimal mais pour voir..</span>
  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>=0;
<span class="comment">// </span>
  {
    <span class="keywordtype">int</span> nbis=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nbis; i++)
      {
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
          {
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span>  k2=k; k2&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k2++)
              {
                <span class="keywordtype">int</span> j1=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k);
                <span class="keywordtype">int</span> j2=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k2);
                <span class="keywordflow">if</span> (j1&gt;j2)
                  {
                    <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)=j2;
                    <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k2)=j1;
                  }
              }
          }
      }
  }
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab4c3cc61f2b809197114f83b308b935e"></a><!-- doxytag: member="Matrice_Morse::duplique" ref="ab4c3cc61f2b809197114f83b308b935e" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Matrice_Morse::duplique </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classMatrice__Base.html#aa8b01ab05c4a12b7e38f573226abbaf2">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#a8e08a11ad9cbc6cdb93147998f827271">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#a33a7f4b20cb4daadf6b2f57eb95b5ea2">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00037">37</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8bafab20c667e1bed56a463ffb30e349"></a><!-- doxytag: member="Matrice_Morse::formeC" ref="a8bafab20c667e1bed56a463ffb30e349" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::formeC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02202">2202</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00107">nb_coeff()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00147">nb_vois()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> ii, k;
  <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordflow">for</span>( ii=0; ii&lt;=n; ii++)
    <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(ii)--;
  <span class="keywordflow">for</span>( ii=0; ii&lt;n; ii++)
    <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(ii))=<a class="code" href="classMatrice__Morse.html#aebca6e5632d935408e1f81674209a86c">nb_vois</a>(ii);
  <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>(); k++)
    <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)--;
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3bcd59ac30cd776ea695a8c8f2d2776d"></a><!-- doxytag: member="Matrice_Morse::formeF" ref="a3bcd59ac30cd776ea695a8c8f2d2776d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::formeF </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02216">2216</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00107">nb_coeff()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l02068">remplir()</a>, and <a class="el" href="Matrice__Bloc_8cpp_source.html#l00676">Matrice_Bloc::remplir()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> ii, k;
  <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordflow">for</span>( ii=0; ii&lt;=n; ii++)
    <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(ii)++;
  <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>(); k++)
    <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)++;
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aacb80dd518dcc0812e3b34edac6ab67e"></a><!-- doxytag: member="Matrice_Morse::get_coeff" ref="aacb80dd518dcc0812e3b34edac6ab67e" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classDoubleVect.html">DoubleVect</a>&amp; Matrice_Morse::get_coeff </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00142">142</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00335">Matrice_Morse_Sym::ajouter_multvect_()</a>, <a class="el" href="SETS_8cpp_source.html#l00496">SETS::assembler()</a>, <a class="el" href="Simpler__Base_8cpp_source.html#l00223">Simpler_Base::assembler_matrice_pression_implicite()</a>, <a class="el" href="Zone__CoviMAC_8cpp_source.html#l00618">disp_m()</a>, <a class="el" href="ILU_8cpp_source.html#l00190">ILU::factorisation()</a>, <a class="el" href="ILU_8cpp_source.html#l00126">ILU::factoriser()</a>, <a class="el" href="Simpler_8cpp_source.html#l00051">inverser_par_diagonale()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l02076">Champ_P1NC_implementation::Mat_Morse_to_Mat_Bloc()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00266">Matrice_Morse_Sym::multvect_et_prodscal()</a>, <a class="el" href="Assembleur__P__VEFPreP1B_8cpp_source.html#l01117">operation01()</a>, <a class="el" href="Assembleur__P__VEFPreP1B_8cpp_source.html#l01018">operation11()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01873">operator+=()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00161">Matrice_Morse_Sym::operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00701">operator=()</a>, <a class="el" href="Solv__GCP_8cpp_source.html#l00124">Solv_GCP::prepare_data()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00988">Matrice_Morse_Sym::renumerote()</a>, and <a class="el" href="SSOR_8cpp_source.html#l01459">SSOR::ssor()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> ;
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a47c0dc151bd5b3026a2f0422e3a081d2"></a><!-- doxytag: member="Matrice_Morse::get_info" ref="a47c0dc151bd5b3026a2f0422e3a081d2" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a> * Matrice_Morse::get_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Donne des informations sur le type de l'Objet_U. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>const Type_info*<br/>
 Signification: structure regroupant les informations sur le type de l'Objet_U<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classMatrice__Base.html#a4efa5d265e605815efad9df60b06c5ef">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#a8d0eb4659ca0299c201cbd5af9971a5c">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#af5e1cd6898c2c912c7ba042a1aedbebf">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00037">37</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acd067e8514e5741f52b18a1d99746d11"></a><!-- doxytag: member="Matrice_Morse::get_set_coeff" ref="acd067e8514e5741f52b18a1d99746d11" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a>&amp; Matrice_Morse::get_set_coeff </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00129">129</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>.</p>

<p>Referenced by <a class="el" href="Matrix__tools_8cpp_source.html#l00356">Matrix_tools::add_scaled_matrices()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00410">Matrix_tools::add_symmetric_scaled_matrices()</a>, <a class="el" href="Op__Dift__VEF__Face__Q1_8cpp_source.html#l00487">Op_Dift_VEF_Face_Q1::ajouter_contribution()</a>, <a class="el" href="Op__Diff__VEF__Face__Q1_8cpp_source.html#l00282">Op_Diff_VEF_Face_Q1::ajouter_contribution()</a>, <a class="el" href="Op__Conv__VEF__Face_8cpp_source.html#l00798">Op_Conv_VEF_Face::ajouter_contribution()</a>, <a class="el" href="Op__Conv__Amont__old__VEF__Face_8cpp_source.html#l00399">Op_Conv_Amont_old_VEF_Face::ajouter_contribution()</a>, <a class="el" href="Op__Dift__VDF__var__Face__Axi_8cpp_source.html#l00634">Op_Dift_VDF_var_Face_Axi::ajouter_contribution()</a>, <a class="el" href="Op__Dift__VDF__Face__Axi_8cpp_source.html#l00595">Op_Dift_VDF_Face_Axi::ajouter_contribution()</a>, <a class="el" href="Op__Diff__VDF__var__Face__Axi_8cpp_source.html#l00479">Op_Diff_VDF_var_Face_Axi::ajouter_contribution()</a>, <a class="el" href="Op__Diff__VDF__Face__Axi_8cpp_source.html#l00474">Op_Diff_VDF_Face_Axi::ajouter_contribution()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02142">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_aretes_bords()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02540">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_aretes_internes()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02637">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_aretes_mixtes()</a>, <a class="el" href="Op__Diff__VDF__Face__Axi_8cpp_source.html#l00790">Op_Diff_VDF_Face_Axi::ajouter_contribution_bord()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02878">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_fa7_elem()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02707">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_fa7_sortie_libre()</a>, <a class="el" href="Assembleur__P__VDF__Q4_8cpp_source.html#l00040">Assembleur_P_VDF_Q4::assembler()</a>, <a class="el" href="SETS_8cpp_source.html#l00496">SETS::assembler()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00705">Convection_Diffusion_Temperature::assembler()</a>, <a class="el" href="Convection__Diffusion__Espece__Multi__QC_8cpp_source.html#l00149">Convection_Diffusion_Espece_Multi_QC::assembler()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00169">Navier_Stokes_Fluide_Dilatable_Proto::assembler_avec_inertie_impl()</a>, <a class="el" href="Convection__Diffusion__Fluide__Dilatable__Proto_8cpp_source.html#l00203">Convection_Diffusion_Fluide_Dilatable_Proto::assembler_impl()</a>, <a class="el" href="Assembleur__P__PolyMAC_8cpp_source.html#l00091">Assembleur_P_PolyMAC::assembler_mat()</a>, <a class="el" href="Assembleur__P__EF_8cpp_source.html#l00137">Assembleur_P_EF::assembler_mat()</a>, <a class="el" href="Assembleur__P__CoviMAC_8cpp_source.html#l00068">Assembleur_P_CoviMAC::assembler_mat()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00152">Matrix_tools::build_morse_matrix()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00228">Matrix_tools::build_symmetric_morse_matrix()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l00975">Op_Diff_VEFP1NCP1B_Face::calculer_laplacien_som()</a>, <a class="el" href="Op__Diff__EF_8cpp_source.html#l00807">coeff_opt()</a>, <a class="el" href="Operateur__Grad__base_8cpp_source.html#l00085">Operateur_Grad_base::contribuer_a_avec()</a>, <a class="el" href="Matrice__Dense_8cpp_source.html#l00156">Matrice_Dense::convert_to_morse_matrix()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02975">T_It_VDF_Face&lt; _TYPE_ &gt;::corriger_coeffs_fa7_elem_periodicite()</a>, <a class="el" href="Op__VEF__Face_8cpp_source.html#l00050">Op_VEF_Face::dimensionner()</a>, <a class="el" href="Op__VDF__Face_8cpp_source.html#l00056">Op_VDF_Face::dimensionner()</a>, <a class="el" href="Op__VDF__Elem_8cpp_source.html#l00033">Op_VDF_Elem::dimensionner()</a>, <a class="el" href="Op__PolyMAC__Elem_8cpp_source.html#l00033">Op_PolyMAC_Elem::dimensionner()</a>, <a class="el" href="Op__EF__base_8cpp_source.html#l00050">Op_EF_base::dimensionner()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02202">Equation_base::dimensionner_matrice()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02227">Equation_base::dimensionner_matrice_sans_mem()</a>, <a class="el" href="ILU_8cpp_source.html#l00190">ILU::factorisation()</a>, <a class="el" href="Testeur_8cpp_source.html#l00046">Testeur::interpreter()</a>, <a class="el" href="Simple_8cpp_source.html#l00179">Simple::iterer_eqn()</a>, <a class="el" href="Simple_8cpp_source.html#l00357">Simple::iterer_eqs()</a>, <a class="el" href="Solveur__U__P_8cpp_source.html#l00061">Solveur_U_P::iterer_NS()</a>, <a class="el" href="Piso_8cpp_source.html#l00446">Piso::iterer_NS_PolyMAC()</a>, <a class="el" href="Op__VEF__Face_8cpp_source.html#l00185">Op_VEF_Face::modifier_pour_Cl()</a>, <a class="el" href="Op__VDF__Face_8cpp_source.html#l00265">Op_VDF_Face::modifier_pour_Cl()</a>, <a class="el" href="Op__EF__base_8cpp_source.html#l00162">Op_EF_base::modifier_pour_Cl()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00621">operator*()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, <a class="el" href="Solv__GCP_8cpp_source.html#l00124">Solv_GCP::prepare_data()</a>, <a class="el" href="Assembleur__P__VEF_8cpp_source.html#l00134">Assembleur_P_VEF::remplir()</a>, <a class="el" href="Matrice__Bloc_8cpp_source.html#l00676">Matrice_Bloc::remplir()</a>, and <a class="el" href="Operateur__base_8cpp_source.html#l00666">Operateur_base::tester_contribuer_a_avec()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> ;
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a7a49c763706dcfaed900f9d2cbb68716"></a><!-- doxytag: member="Matrice_Morse::get_set_tab1" ref="a7a49c763706dcfaed900f9d2cbb68716" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntVect.html">IntVect</a>&amp; Matrice_Morse::get_set_tab1 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00119">119</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>.</p>

<p>Referenced by <a class="el" href="Op__Dift__VEF__Face__Q1_8cpp_source.html#l00487">Op_Dift_VEF_Face_Q1::ajouter_contribution()</a>, <a class="el" href="Op__Diff__VEF__Face__Q1_8cpp_source.html#l00282">Op_Diff_VEF_Face_Q1::ajouter_contribution()</a>, <a class="el" href="Op__Conv__Amont__old__VEF__Face_8cpp_source.html#l00399">Op_Conv_Amont_old_VEF_Face::ajouter_contribution()</a>, <a class="el" href="Op__Dift__VDF__var__Face__Axi_8cpp_source.html#l00634">Op_Dift_VDF_var_Face_Axi::ajouter_contribution()</a>, <a class="el" href="Op__Dift__VDF__Face__Axi_8cpp_source.html#l00595">Op_Dift_VDF_Face_Axi::ajouter_contribution()</a>, <a class="el" href="Op__Diff__VDF__var__Face__Axi_8cpp_source.html#l00479">Op_Diff_VDF_var_Face_Axi::ajouter_contribution()</a>, <a class="el" href="Op__Diff__VDF__Face__Axi_8cpp_source.html#l00474">Op_Diff_VDF_Face_Axi::ajouter_contribution()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02142">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_aretes_bords()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02540">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_aretes_internes()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02637">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_aretes_mixtes()</a>, <a class="el" href="Op__Diff__VDF__Face__Axi_8cpp_source.html#l00790">Op_Diff_VDF_Face_Axi::ajouter_contribution_bord()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02878">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_fa7_elem()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02707">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_fa7_sortie_libre()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00112">Matrix_tools::allocate_morse_matrix()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00192">Matrix_tools::allocate_symmetric_morse_matrix()</a>, <a class="el" href="Assembleur__P__VDF__Q4_8cpp_source.html#l00040">Assembleur_P_VDF_Q4::assembler()</a>, <a class="el" href="Assembleur__P__PolyMAC_8cpp_source.html#l00091">Assembleur_P_PolyMAC::assembler_mat()</a>, <a class="el" href="Assembleur__P__CoviMAC_8cpp_source.html#l00068">Assembleur_P_CoviMAC::assembler_mat()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00152">Matrix_tools::build_morse_matrix()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00228">Matrix_tools::build_symmetric_morse_matrix()</a>, <a class="el" href="Assembleur__P__VDF_8cpp_source.html#l00112">Assembleur_P_VDF::construire()</a>, <a class="el" href="Op__Conv__Amont__old__VEF__Face_8cpp_source.html#l00073">convbisimplicite()</a>, <a class="el" href="Matrice__Dense_8cpp_source.html#l00156">Matrice_Dense::convert_to_morse_matrix()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02975">T_It_VDF_Face&lt; _TYPE_ &gt;::corriger_coeffs_fa7_elem_periodicite()</a>, <a class="el" href="Op__VEF__Face_8cpp_source.html#l00050">Op_VEF_Face::dimensionner()</a>, <a class="el" href="Op__VDF__Face_8cpp_source.html#l00056">Op_VDF_Face::dimensionner()</a>, <a class="el" href="Op__VDF__Elem_8cpp_source.html#l00033">Op_VDF_Elem::dimensionner()</a>, <a class="el" href="Op__PolyMAC__Elem_8cpp_source.html#l00033">Op_PolyMAC_Elem::dimensionner()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l03016">Op_Diff_VEFP1NCP1B_Face::dimensionner()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01975">Champ_P1NC_implementation::dimensionner_Mat_Bloc_Morse_Sym()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02202">Equation_base::dimensionner_matrice()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02227">Equation_base::dimensionner_matrice_sans_mem()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00660">Matrix_tools::extend_matrix()</a>, <a class="el" href="ILU_8cpp_source.html#l00190">ILU::factorisation()</a>, <a class="el" href="Testeur_8cpp_source.html#l00046">Testeur::interpreter()</a>, <a class="el" href="Solveur__U__P_8cpp_source.html#l00061">Solveur_U_P::iterer_NS()</a>, <a class="el" href="Op__VDF__Face_8cpp_source.html#l00265">Op_VDF_Face::modifier_pour_Cl()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, <a class="el" href="Solv__GCP_8cpp_source.html#l00124">Solv_GCP::prepare_data()</a>, <a class="el" href="Assembleur__P__VEF_8cpp_source.html#l00134">Assembleur_P_VEF::remplir()</a>, and <a class="el" href="Matrice__Bloc_8cpp_source.html#l00676">Matrice_Bloc::remplir()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = false ;
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a> ;
  }
</pre></div>
</div>
</div>
<a class="anchor" id="af11c5853518e9e6db4c7e6e6acc8d7fd"></a><!-- doxytag: member="Matrice_Morse::get_set_tab2" ref="af11c5853518e9e6db4c7e6e6acc8d7fd" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntVect.html">IntVect</a>&amp; Matrice_Morse::get_set_tab2 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00124">124</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>

<p>Referenced by <a class="el" href="Op__Dift__VEF__Face__Q1_8cpp_source.html#l00487">Op_Dift_VEF_Face_Q1::ajouter_contribution()</a>, <a class="el" href="Op__Diff__VEF__Face__Q1_8cpp_source.html#l00282">Op_Diff_VEF_Face_Q1::ajouter_contribution()</a>, <a class="el" href="Op__Conv__Amont__old__VEF__Face_8cpp_source.html#l00399">Op_Conv_Amont_old_VEF_Face::ajouter_contribution()</a>, <a class="el" href="Op__Dift__VDF__var__Face__Axi_8cpp_source.html#l00634">Op_Dift_VDF_var_Face_Axi::ajouter_contribution()</a>, <a class="el" href="Op__Dift__VDF__Face__Axi_8cpp_source.html#l00595">Op_Dift_VDF_Face_Axi::ajouter_contribution()</a>, <a class="el" href="Op__Diff__VDF__var__Face__Axi_8cpp_source.html#l00479">Op_Diff_VDF_var_Face_Axi::ajouter_contribution()</a>, <a class="el" href="Op__Diff__VDF__Face__Axi_8cpp_source.html#l00474">Op_Diff_VDF_Face_Axi::ajouter_contribution()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02142">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_aretes_bords()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02540">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_aretes_internes()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02637">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_aretes_mixtes()</a>, <a class="el" href="Op__Diff__VDF__Face__Axi_8cpp_source.html#l00790">Op_Diff_VDF_Face_Axi::ajouter_contribution_bord()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02878">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_fa7_elem()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02707">T_It_VDF_Face&lt; _TYPE_ &gt;::ajouter_contribution_fa7_sortie_libre()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00112">Matrix_tools::allocate_morse_matrix()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00192">Matrix_tools::allocate_symmetric_morse_matrix()</a>, <a class="el" href="Assembleur__P__VDF__Q4_8cpp_source.html#l00040">Assembleur_P_VDF_Q4::assembler()</a>, <a class="el" href="Assembleur__P__PolyMAC_8cpp_source.html#l00091">Assembleur_P_PolyMAC::assembler_mat()</a>, <a class="el" href="Assembleur__P__CoviMAC_8cpp_source.html#l00068">Assembleur_P_CoviMAC::assembler_mat()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00152">Matrix_tools::build_morse_matrix()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00228">Matrix_tools::build_symmetric_morse_matrix()</a>, <a class="el" href="Assembleur__P__VDF_8cpp_source.html#l00112">Assembleur_P_VDF::construire()</a>, <a class="el" href="Op__Conv__Amont__old__VEF__Face_8cpp_source.html#l00073">convbisimplicite()</a>, <a class="el" href="Matrice__Dense_8cpp_source.html#l00156">Matrice_Dense::convert_to_morse_matrix()</a>, <a class="el" href="T__It__VDF__Face_8h_source.html#l02975">T_It_VDF_Face&lt; _TYPE_ &gt;::corriger_coeffs_fa7_elem_periodicite()</a>, <a class="el" href="Op__VEF__Face_8cpp_source.html#l00050">Op_VEF_Face::dimensionner()</a>, <a class="el" href="Op__VDF__Face_8cpp_source.html#l00056">Op_VDF_Face::dimensionner()</a>, <a class="el" href="Op__VDF__Elem_8cpp_source.html#l00033">Op_VDF_Elem::dimensionner()</a>, <a class="el" href="Op__PolyMAC__Elem_8cpp_source.html#l00033">Op_PolyMAC_Elem::dimensionner()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l03016">Op_Diff_VEFP1NCP1B_Face::dimensionner()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01975">Champ_P1NC_implementation::dimensionner_Mat_Bloc_Morse_Sym()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02202">Equation_base::dimensionner_matrice()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02227">Equation_base::dimensionner_matrice_sans_mem()</a>, <a class="el" href="ILU_8cpp_source.html#l00190">ILU::factorisation()</a>, <a class="el" href="Testeur_8cpp_source.html#l00046">Testeur::interpreter()</a>, <a class="el" href="Simple_8cpp_source.html#l00357">Simple::iterer_eqs()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, <a class="el" href="Solv__GCP_8cpp_source.html#l00124">Solv_GCP::prepare_data()</a>, <a class="el" href="Assembleur__P__VEF_8cpp_source.html#l00134">Assembleur_P_VEF::remplir()</a>, and <a class="el" href="Matrice__Bloc_8cpp_source.html#l00676">Matrice_Bloc::remplir()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = false ;
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a> ;
  }
</pre></div>
</div>
</div>
<a class="anchor" id="af77867348031b93d7cf4ce63d5718030"></a><!-- doxytag: member="Matrice_Morse::get_stencil" ref="af77867348031b93d7cf4ce63d5718030" args="(IntTab &amp;stencil) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::get_stencil </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td>
          <td class="paramname"><em>stencil</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classMatrice__Base.html#a62ec15030f4e1395b28a85346a0886f2">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Sym.html#a29493153da9292516103125b527a609c">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01920">1920</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8cpp_source.html#l02422">assert_check_morse_matrix_structure()</a>, <a class="el" href="Memoire_8cpp_source.html#l00026">compteur</a>, <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00897">ArrOfInt::ordonne_array()</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00240">ArrOfInt::resize_array()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00443">ArrOfInt::set_smart_resize()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00342">ArrOfInt::size_array()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00101">Matrice_Base::stencil_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );

  <span class="keywordflow">if</span>( <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> )
    {
      stencil = <a class="code" href="classMatrice__Base.html#af782c401617e7acfef8cab70457f9b55">stencil_</a>;
      <span class="keywordflow">return</span>;
    }


  stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( 0, 2 );
  stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>(), 2);
  stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );

  <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> tmp;
  tmp.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );

  <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> = 0;

  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
    {
      <span class="keywordtype">int</span> k0   = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;
      <span class="keywordtype">int</span> k1   = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;
      <span class="keywordtype">int</span> size = k1 - k0;

      tmp.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>( 0 );
      tmp.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>( size );

      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )
        {
          tmp[ k ] = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k + k0 ) - 1;
        }

      tmp.<a class="code" href="classArrOfInt.html#abb0f48cf5a4be4b70edcc90baaebd521" title="Tri des valeurs du tableau dans l&#39;ordre croissant. La fonction utilisee est qsort de stdlib (elle est...">ordonne_array</a>( );

      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )
        {
          stencil( k+compteur , 0 ) = i;
          stencil( k+compteur , 1 ) =  tmp[ k ];
        }
      compteur += size;
    }

  stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 0 );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a547351090cbce6887a957abb3d081223"></a><!-- doxytag: member="Matrice_Morse::get_stencil_and_coefficients" ref="a547351090cbce6887a957abb3d081223" args="(IntTab &amp;stencil, ArrOfDouble &amp;coefficients) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::get_stencil_and_coefficients </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td>
          <td class="paramname"><em>stencil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;&#160;</td>
          <td class="paramname"><em>coefficients</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classMatrice__Base.html#abdb1a534ff53b8e4dba303cb1df9e90a">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Sym.html#a13817ba06b04d515958bf7a84b8838d8">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01968">1968</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Process_8cpp_source.html#l00329">Process::abort()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02422">assert_check_morse_matrix_structure()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Memoire_8cpp_source.html#l00026">compteur</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="ArrOfDouble_8h_source.html#l00252">ArrOfDouble::resize()</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00240">ArrOfInt::resize_array()</a>, <a class="el" href="ArrOfDouble_8h_source.html#l00244">ArrOfDouble::resize_array()</a>, <a class="el" href="ArrOfDouble_8cpp_source.html#l00442">ArrOfDouble::set_smart_resize()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00443">ArrOfInt::set_smart_resize()</a>, <a class="el" href="DoubleVect_8h_source.html#l00153">DoubleVect::size()</a>, <a class="el" href="ArrOfDouble_8h_source.html#l00350">ArrOfDouble::size_array()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00342">ArrOfInt::size_array()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00101">Matrice_Base::stencil_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>, and <a class="el" href="Array__tools_8cpp_source.html#l00342">tri_lexicographique_tableau_indirect()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );

  <span class="keywordflow">if</span>( <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> )
    {
      <span class="keywordflow">if</span>( <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>( ) == 0 )
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Matrice_Morse::get_stencil_and_coefficients( )&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  The coefficients are not filled.&quot;</span>&lt;&lt;finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  Aborting...&quot;</span> &lt;&lt; finl;
          <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">Process::abort</a>( );
        }
      stencil = <a class="code" href="classMatrice__Base.html#af782c401617e7acfef8cab70457f9b55">stencil_</a> ;
      coefficients = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> ;
      <span class="keywordflow">return</span>;
    }

  stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( 0, 2 );
  stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>(), 2);
  stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );

  coefficients.<a class="code" href="classArrOfDouble.html#aa5d7035f2e4f451c484aabd5dffb873b" title="appel a ArrOfDouble::resize_array()">resize</a>( 0 );
  coefficients.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
  coefficients.<a class="code" href="classArrOfDouble.html#aa5d7035f2e4f451c484aabd5dffb873b" title="appel a ArrOfDouble::resize_array()">resize</a>(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>());

  <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> tmp1(0);
  tmp1.set_smart_resize( 1 );

  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> tmp2;
  tmp2.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );

  <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> index;
  index.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );

  <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> = 0;

  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
    {
      <span class="keywordtype">int</span> k0   = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;
      <span class="keywordtype">int</span> k1   = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;
      <span class="keywordtype">int</span> size = k1 - k0;

      tmp1.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( 0 );
      tmp1.resize( size );

      tmp2.<a class="code" href="classArrOfDouble.html#a610464f4b3dccac6f814915b526783ed">resize_array</a>( 0 );
      tmp2.<a class="code" href="classArrOfDouble.html#a610464f4b3dccac6f814915b526783ed">resize_array</a>( size );

      index.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>( 0 );

      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )
        {
          tmp1( k ) = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k + k0 ) - 1;
          tmp2[ k ] = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>( k + k0 );
        }

      <a class="code" href="Array__tools_8cpp.html#ad62171ccb6e8fd4b2be47d286c164999" title="Idem que tri_lexicographique_tableau mais on trie le tableau index qui contient les indices de lignes...">tri_lexicographique_tableau_indirect</a>( tmp1, index );

      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )
        {
          <span class="keywordtype">int</span> l = index[ k ];
          stencil( compteur + k , 0 ) = i;
          stencil( compteur + k , 1 ) = tmp1[ l ];
          coefficients[ compteur + k ] = tmp2[ l ];
        }
      compteur += size;
    }

  assert( coefficients.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) == stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 ));

  stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 0 );

  coefficients.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 0 );
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6f50c254db1753e72f23c6d051590fe7"></a><!-- doxytag: member="Matrice_Morse::get_symmetric" ref="a6f50c254db1753e72f23c6d051590fe7" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Matrice_Morse::get_symmetric </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00114">114</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00236">symetrique_</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00161">Matrice_Morse_Sym::operator=()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>;
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a79b4e334152850bd36e53478debf3061"></a><!-- doxytag: member="Matrice_Morse::get_tab1" ref="a79b4e334152850bd36e53478debf3061" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classIntVect.html">IntVect</a>&amp; Matrice_Morse::get_tab1 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00134">134</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>.</p>

<p>Referenced by <a class="el" href="Matrix__tools_8cpp_source.html#l00356">Matrix_tools::add_scaled_matrices()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00410">Matrix_tools::add_symmetric_scaled_matrices()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00335">Matrice_Morse_Sym::ajouter_multvect_()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00112">Matrix_tools::allocate_morse_matrix()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00192">Matrix_tools::allocate_symmetric_morse_matrix()</a>, <a class="el" href="SETS_8cpp_source.html#l00496">SETS::assembler()</a>, <a class="el" href="Convection__Diffusion__Espece__Multi__QC_8cpp_source.html#l00149">Convection_Diffusion_Espece_Multi_QC::assembler()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00169">Navier_Stokes_Fluide_Dilatable_Proto::assembler_avec_inertie_impl()</a>, <a class="el" href="Convection__Diffusion__Fluide__Dilatable__Proto_8cpp_source.html#l00203">Convection_Diffusion_Fluide_Dilatable_Proto::assembler_impl()</a>, <a class="el" href="Simpler__Base_8cpp_source.html#l00223">Simpler_Base::assembler_matrice_pression_implicite()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00152">Matrix_tools::build_morse_matrix()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00228">Matrix_tools::build_symmetric_morse_matrix()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l01633">Op_Diff_VEFP1NCP1B_Face::coeff_matrice_som()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l01770">Op_Diff_VEFP1NCP1B_Face::coeff_matrice_som_CL()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l02048">Op_Diff_VEFP1NCP1B_Face::coeff_matrice_som_perio()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l01907">Op_Diff_VEFP1NCP1B_Face::coeff_matrice_som_symetrie()</a>, <a class="el" href="Op__Diff__EF_8cpp_source.html#l00807">coeff_opt()</a>, <a class="el" href="Domain__Graph_8cpp_source.html#l00102">Domain_Graph::construire_graph_from_segment()</a>, <a class="el" href="Op__EF__base_8cpp_source.html#l00050">Op_EF_base::dimensionner()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01975">Champ_P1NC_implementation::dimensionner_Mat_Bloc_Morse_Sym()</a>, <a class="el" href="Zone__CoviMAC_8cpp_source.html#l00618">disp_m()</a>, <a class="el" href="SETS_8cpp_source.html#l00331">SETS::eliminer()</a>, <a class="el" href="ILU_8cpp_source.html#l00190">ILU::factorisation()</a>, <a class="el" href="ILU_8cpp_source.html#l00126">ILU::factoriser()</a>, <a class="el" href="Zone__Cl__EF_8cpp_source.html#l00492">Zone_Cl_EF::imposer_symetrie_matrice_secmem()</a>, <a class="el" href="Simpler_8cpp_source.html#l00051">inverser_par_diagonale()</a>, <a class="el" href="Solveur__U__P_8cpp_source.html#l00061">Solveur_U_P::iterer_NS()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02281">largeur_de_bande()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l02076">Champ_P1NC_implementation::Mat_Morse_to_Mat_Bloc()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00580">Matrix_tools::matdiag_mult_matmorse()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00604">Matrix_tools::matmorse_mult_matdiag()</a>, <a class="el" href="Op__VEF__Face_8cpp_source.html#l00792">Op_VEF_Face::modifier_matrice_pour_periodique_apres_contribuer()</a>, <a class="el" href="Op__VEF__Face_8cpp_source.html#l00185">Op_VEF_Face::modifier_pour_Cl()</a>, <a class="el" href="Op__EF__base_8cpp_source.html#l00162">Op_EF_base::modifier_pour_Cl()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00266">Matrice_Morse_Sym::multvect_et_prodscal()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00147">nb_vois()</a>, <a class="el" href="Assembleur__P__VEFPreP1B_8cpp_source.html#l01117">operation01()</a>, <a class="el" href="Assembleur__P__VEFPreP1B_8cpp_source.html#l01018">operation11()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00161">Matrice_Morse_Sym::operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00701">operator=()</a>, <a class="el" href="Solv__GCP_8cpp_source.html#l00124">Solv_GCP::prepare_data()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00988">Matrice_Morse_Sym::renumerote()</a>, <a class="el" href="SSOR_8cpp_source.html#l01459">SSOR::ssor()</a>, and <a class="el" href="Matrix__tools_8cpp_source.html#l00629">Matrix_tools::uniform_matdiag_mult_matmorse()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a> ;
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a787b5a63f27063f9c891243d8f188cda"></a><!-- doxytag: member="Matrice_Morse::get_tab2" ref="a787b5a63f27063f9c891243d8f188cda" args="(void) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classIntVect.html">IntVect</a>&amp; Matrice_Morse::get_tab2 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00138">138</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>

<p>Referenced by <a class="el" href="Matrix__tools_8cpp_source.html#l00356">Matrix_tools::add_scaled_matrices()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00410">Matrix_tools::add_symmetric_scaled_matrices()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00335">Matrice_Morse_Sym::ajouter_multvect_()</a>, <a class="el" href="SETS_8cpp_source.html#l00496">SETS::assembler()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00169">Navier_Stokes_Fluide_Dilatable_Proto::assembler_avec_inertie_impl()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l01633">Op_Diff_VEFP1NCP1B_Face::coeff_matrice_som()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l01770">Op_Diff_VEFP1NCP1B_Face::coeff_matrice_som_CL()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l02048">Op_Diff_VEFP1NCP1B_Face::coeff_matrice_som_perio()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l01907">Op_Diff_VEFP1NCP1B_Face::coeff_matrice_som_symetrie()</a>, <a class="el" href="Op__Diff__EF_8cpp_source.html#l00807">coeff_opt()</a>, <a class="el" href="Domain__Graph_8cpp_source.html#l00102">Domain_Graph::construire_graph_from_segment()</a>, <a class="el" href="Op__EF__base_8cpp_source.html#l00050">Op_EF_base::dimensionner()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01975">Champ_P1NC_implementation::dimensionner_Mat_Bloc_Morse_Sym()</a>, <a class="el" href="Zone__CoviMAC_8cpp_source.html#l00618">disp_m()</a>, <a class="el" href="SETS_8cpp_source.html#l00331">SETS::eliminer()</a>, <a class="el" href="ILU_8cpp_source.html#l00190">ILU::factorisation()</a>, <a class="el" href="ILU_8cpp_source.html#l00126">ILU::factoriser()</a>, <a class="el" href="Zone__Cl__EF_8cpp_source.html#l00492">Zone_Cl_EF::imposer_symetrie_matrice_secmem()</a>, <a class="el" href="Simpler_8cpp_source.html#l00051">inverser_par_diagonale()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02281">largeur_de_bande()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l02076">Champ_P1NC_implementation::Mat_Morse_to_Mat_Bloc()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00580">Matrix_tools::matdiag_mult_matmorse()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00604">Matrix_tools::matmorse_mult_matdiag()</a>, <a class="el" href="Op__VEF__Face_8cpp_source.html#l00792">Op_VEF_Face::modifier_matrice_pour_periodique_apres_contribuer()</a>, <a class="el" href="Op__VEF__Face_8cpp_source.html#l00185">Op_VEF_Face::modifier_pour_Cl()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00266">Matrice_Morse_Sym::multvect_et_prodscal()</a>, <a class="el" href="Assembleur__P__VEFPreP1B_8cpp_source.html#l01117">operation01()</a>, <a class="el" href="Assembleur__P__VEFPreP1B_8cpp_source.html#l01018">operation11()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00161">Matrice_Morse_Sym::operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00701">operator=()</a>, <a class="el" href="Solv__GCP_8cpp_source.html#l00124">Solv_GCP::prepare_data()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00988">Matrice_Morse_Sym::renumerote()</a>, <a class="el" href="SSOR_8cpp_source.html#l01459">SSOR::ssor()</a>, and <a class="el" href="Matrix__tools_8cpp_source.html#l00629">Matrix_tools::uniform_matdiag_mult_matmorse()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a> ;
  }
</pre></div>
</div>
</div>
<a class="anchor" id="a11eec428fe6de8eeba3113b682dd38f1"></a><!-- doxytag: member="Matrice_Morse::has_same_morse_matrix_structure" ref="a11eec428fe6de8eeba3113b682dd38f1" args="(const Matrice_Morse &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Matrice_Morse::has_same_morse_matrix_structure </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01143">1143</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l01873">operator+=()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> nrow=A.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nrow; i++)
    <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)!=A.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i))
      <span class="keywordflow">return</span> <span class="keyword">false</span>;
  <span class="keywordflow">return</span> <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5061454fa787608b578aed2c4d5bf224"></a><!-- doxytag: member="Matrice_Morse::imprimer" ref="a5061454fa787608b578aed2c4d5bf224" args="(Sortie &amp;s) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSortie.html">Sortie</a> &amp; Matrice_Morse::imprimer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classMatrice__Base.html#ae24d1b259863668b943d3c19f4bc9340">Matrice_Base</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00087">87</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
    {
      s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      s &lt;&lt; <span class="stringliteral">&quot;--------------------------------&quot;</span> &lt;&lt; finl;
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
        {
          s &lt;&lt; <span class="stringliteral">&quot;(&quot;</span>&lt;&lt;(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1) &lt;&lt; <span class="stringliteral">&quot;),(&quot;</span> &lt;&lt;<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)&lt;&lt; <span class="stringliteral">&quot;) &quot;</span>
            &lt;&lt; <span class="stringliteral">&quot; k= &quot;</span> &lt;&lt; k &lt;&lt; finl;
        }
      s &lt;&lt;finl;
    }
  <span class="keywordflow">return</span> s;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a60c1de967d05b21b9b96a9bf6d73334e"></a><!-- doxytag: member="Matrice_Morse::imprimer_formatte" ref="a60c1de967d05b21b9b96a9bf6d73334e" args="(Sortie &amp;s) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSortie.html">Sortie</a> &amp; Matrice_Morse::imprimer_formatte </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classMatrice__Base.html#a2167f10f0e4efb71013a18aa44403f4e">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Sym.html#abdc9966827b915d03d440994ff3fe7de">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00104">104</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>Referenced by <a class="el" href="Op__EF__base_8cpp_source.html#l00050">Op_EF_base::dimensionner()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">Op_Conv_EF_VEF_P1NC_Stab::test_implicite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a60c1de967d05b21b9b96a9bf6d73334e">imprimer_formatte</a>(s,0);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a66338277e3a4e8f250a151824e659171"></a><!-- doxytag: member="Matrice_Morse::imprimer_formatte" ref="a66338277e3a4e8f250a151824e659171" args="(Sortie &amp;s, int symetrie) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSortie.html">Sortie</a> &amp; Matrice_Morse::imprimer_formatte </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>symetrie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00109">109</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Process_8cpp_source.html#l00127">Process::barrier()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="vect__impl_8cpp_source.html#l00145">vect_impl::dimensionner()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Process_8cpp_source.html#l00117">Process::me()</a>, <a class="el" href="IntVect_8cpp_source.html#l01597">IntVect::mp_min_vect()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Process_8cpp_source.html#l00109">Process::nproc()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> numerotation_fortran=(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a9001275280a9e5e22531a59c2993bcef">mp_min_vect</a>()==1);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> proc=0; proc&lt;<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>(); proc++)
    {
      <span class="keywordflow">if</span> (proc==<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>())
        {
          s &lt;&lt; <span class="stringliteral">&quot;Matrix morse on the processor &quot;</span> &lt;&lt; proc &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
          <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a> tab_imp;
          tab_imp.<a class="code" href="classvect__impl.html#ad841d6b676a796bae26ed2566b7b3b41">dimensionner</a>(<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>());
          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
            {
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>(); k++)
                tab_imp[k]=<span class="stringliteral">&quot;  .  &quot;</span>;
              <span class="keywordflow">if</span> (i&lt;10)
                s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot; :&quot;</span> ;
              <span class="keywordflow">else</span>
                s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> ;

              <span class="keywordflow">if</span> (<a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac938491055e13993f3eed68c989f90b0" title="Symetrie.">symetrie</a>)
                {
                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;i; j++)
                    {
                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(j)-numerotation_fortran; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(j+1)-numerotation_fortran; k++)
                        <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran==i)
                          tab_imp[j] = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k);
                    }
                  <span class="keywordtype">int</span> ligne=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-numerotation_fortran)-numerotation_fortran;
                  <span class="keywordflow">if</span> (i!=ligne)
                    {
                      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Problem detected on this Matrice_Morse_Sym.&quot;</span> &lt;&lt; finl;
                      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The diagonal of the line &quot;</span> &lt;&lt; ligne &lt;&lt; <span class="stringliteral">&quot; must be stored even if it is null.&quot;</span> &lt;&lt; finl;
                      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
                    }
                }
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-numerotation_fortran; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-numerotation_fortran; k++)
                <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)+!numerotation_fortran==0)
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Line &quot;</span> &lt;&lt;i&lt;&lt; <span class="stringliteral">&quot; no coefficient &quot;</span>&lt;&lt;k&lt;&lt;finl;
                <span class="keywordflow">else</span>
                  {
                    <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)&gt;=0)
                      tab_imp[<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran]=<span class="stringliteral">&quot; &quot;</span>;
                    <span class="keywordflow">else</span>
                      tab_imp[<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran]=<span class="stringliteral">&quot;&quot;</span>;
                    tab_imp[<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran] += (<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>)<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k);
                  }
              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>(); k++)
                s&lt;&lt;tab_imp[k];
              s&lt;&lt;finl;
            }
        }
      <a class="code" href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1" title="Synchronise tous les processeurs du groupe courant&lt;br&gt;(attend que tous les processeurs soient arrives...">Process::barrier</a>();
    }
  <span class="keywordflow">return</span> s;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a518c0888db8297116700155dd97e58dc"></a><!-- doxytag: member="Matrice_Morse::imprimer_image" ref="a518c0888db8297116700155dd97e58dc" args="(Sortie &amp;s) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSortie.html">Sortie</a> &amp; Matrice_Morse::imprimer_image </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00166">166</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a518c0888db8297116700155dd97e58dc">imprimer_image</a>(s,0);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a28da443e8ba8168bf04e5368dfef7a8f"></a><!-- doxytag: member="Matrice_Morse::imprimer_image" ref="a28da443e8ba8168bf04e5368dfef7a8f" args="(Sortie &amp;s, int symetrie) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSortie.html">Sortie</a> &amp; Matrice_Morse::imprimer_image </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>symetrie</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00171">171</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Process_8cpp_source.html#l00127">Process::barrier()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="vect__impl_8cpp_source.html#l00145">vect_impl::dimensionner()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Process_8cpp_source.html#l00117">Process::me()</a>, <a class="el" href="IntVect_8cpp_source.html#l01597">IntVect::mp_min_vect()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Process_8cpp_source.html#l00109">Process::nproc()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> numerotation_fortran=(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a9001275280a9e5e22531a59c2993bcef">mp_min_vect</a>()==1);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> proc=0; proc&lt;<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>(); proc++)
    {
      <span class="keywordflow">if</span> (proc==<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>())
        {
          s &lt;&lt; <span class="stringliteral">&quot;Matrix morse on the processor &quot;</span> &lt;&lt; proc &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
          <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a> tab_imp;
          tab_imp.<a class="code" href="classvect__impl.html#ad841d6b676a796bae26ed2566b7b3b41">dimensionner</a>(<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>());
          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
            {
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>(); k++)
                tab_imp[k]=<span class="stringliteral">&quot;\u2588\u2588&quot;</span>;
              <span class="keywordflow">if</span> (i&lt;10)
                s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot; :&quot;</span> ;
              <span class="keywordflow">else</span>
                s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> ;

              <span class="keywordflow">if</span> (<a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac938491055e13993f3eed68c989f90b0" title="Symetrie.">symetrie</a>)
                {
                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;i; j++)
                    {
                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(j)-numerotation_fortran; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(j+1)-numerotation_fortran; k++)
                        <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran==i)
                          tab_imp[j] = (<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) &gt;= 0) ? <span class="stringliteral">&quot;  &quot;</span> : <span class="stringliteral">&quot;\u2592\u2592&quot;</span>;
                    }
                  <span class="keywordtype">int</span> ligne=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-numerotation_fortran)-numerotation_fortran;
                  <span class="keywordflow">if</span> (i!=ligne)
                    {
                      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Problem detected on this Matrice_Morse_Sym.&quot;</span> &lt;&lt; finl;
                      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The diagonal of the line &quot;</span> &lt;&lt; ligne &lt;&lt; <span class="stringliteral">&quot; must be stored even if it is null.&quot;</span> &lt;&lt; finl;
                      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
                    }
                }
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-numerotation_fortran; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-numerotation_fortran; k++)
                <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)+!numerotation_fortran==0)
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Line &quot;</span> &lt;&lt;i&lt;&lt; <span class="stringliteral">&quot; no coefficient &quot;</span>&lt;&lt;k&lt;&lt;finl;
                <span class="keywordflow">else</span>
                  tab_imp[<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran] = (<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) &gt;= 0) ? <span class="stringliteral">&quot;  &quot;</span> : <span class="stringliteral">&quot;\u2592\u2592&quot;</span>;

              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>(); k++)
                s&lt;&lt;tab_imp[k];
              s&lt;&lt;finl;
            }
        }
      <a class="code" href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1" title="Synchronise tous les processeurs du groupe courant&lt;br&gt;(attend que tous les processeurs soient arrives...">Process::barrier</a>();
    }
  <span class="keywordflow">return</span> s;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a50068a424014eb75d4fcdc1d45ec25e8"></a><!-- doxytag: member="Matrice_Morse::info" ref="a50068a424014eb75d4fcdc1d45ec25e8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a> * Matrice_Morse::info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Donne des informations sur le type de l'Objet_U. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>const Type_info*<br/>
 Signification: structure regroupant les informations sur le type de l'Objet_U<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classMatrice__Base.html#afff08d5a839c55b8151631974298e08d">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#a6d4def39d28a5a82b39129d1aafe25a5">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#a19509c90e360d27b1f67a3f5b0ab2d21">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00037">37</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a53383f880cbb5efcfddc92c1e570fc9c"></a><!-- doxytag: member="Matrice_Morse::inverse" ref="a53383f880cbb5efcfddc92c1e570fc9c" args="(const DoubleVect &amp;, DoubleVect &amp;, double) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Matrice_Morse::inverse </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>secmem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>coeff_seuil</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calcule la solution du systeme lineaire: A * solution = secmem.<br/>
La methode utilisee est GMRES preconditionnee avec ILUT.<br/>
ATTENTION: cette methode n'a vraisemblablement jamais ete testee en parallele. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>int<br/>
 Signification: renvoie toujours 1<br/>
 Contraintes: </dd></dl>

<p><p>&lt; On ne calcul L et U que si prems =1</p>
<p>&lt; nombre de termes ajouter dans L et U</p>
<p>&lt; ordre de la matrice</p>
<p>&lt; degre de l'espace de Krilov</p>
<p>&lt; tableau pour L et U</p>
<p>&lt; tableau pour L et U</p>
<p>&lt; tableau pour L et U</p>
<p>&lt; tableau de travail pour pgmres <a class="el" href="classDoubleVect.html">DoubleVect</a> Resini(nn);</p>
<p>&lt; niveau d'erreur</p>
<p>&lt; nombre de termes non nuls dans LU</p>
<p>&lt; filtrage des coefficents de L U</p>
<p>&lt; tableau de travail pour ilut <a class="el" href="classDoubleVect.html">DoubleVect</a> wl(nn); // tableau de travail pour ilut</p>
<p>&lt; tableau de travail pour ilut <a class="el" href="classIntVect.html">IntVect</a> jwu(nn); // tableau de travail pour ilut <a class="el" href="classIntVect.html">IntVect</a> jwl(nn); // tableau de travail pour ilut coeff_[0]*=2.0; // pour rendre A non singuliere!</p>
<p>&lt; fichier de sortie </p>
</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Sym.html#a7af0681f55e332a566fe7e3b37603571">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01184">1184</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="ArrOfInt_8h_source.html#l00371">ArrOfInt::addr()</a>, <a class="el" href="ArrOfDouble_8h_source.html#l00379">ArrOfDouble::addr()</a>, <a class="el" href="Check__espace__virtuel_8cpp_source.html#l00118">assert_espace_virtuel_vect()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="EntreeSortie_8h_source.html#l00033">Cout</a>, <a class="el" href="Double_8h_source.html#l00072">DMAXFLOAT</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="arch_8h_source.html#l00075">F77NAME</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Double_8h_source.html#l00180">max()</a>, <a class="el" href="Double_8h_source.html#l00199">min()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l02342">mp_prodscal()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00127">Matrice_Base::multvect()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00107">nb_coeff()</a>, <a class="el" href="Process_8cpp_source.html#l00109">Process::nproc()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00559">ordre()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="DoubleVect_8h_source.html#l00193">DoubleVect::resize()</a>, <a class="el" href="IntVect_8h_source.html#l00179">IntVect::resize()</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>

<p>Referenced by <a class="el" href="Solv__Gmres_8cpp_source.html#l00415">Solv_Gmres::Gmres()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// B.Mat: au 20/4/2005, DoubleVect::norme() est bugge, donc la methode n&#39;a</span>
<span class="comment">// sans doute jamais ete validee en parallele. Je retire norme() et je mets</span>
<span class="comment">// ceci:</span>
  <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse(const DoubleVect&amp; secmem, DoubleVect&amp; solution, &quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;coeff_seuil double) const \n has never been tested in parallel&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Try &#39;Solveur Gmres { diag }&#39; or &#39;Solveur Petsc Gmres { precond diag { } }&#39;&quot;</span> &lt;&lt; finl;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;instead of &#39;Solveur Gmres { }&#39; which is not parallelized yet.&quot;</span> &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
    }

  <a class="code" href="classDoubleVect.html">DoubleVect</a> toto(secmem);
  <span class="keywordtype">int</span> prems=1;                        <span class="comment">//!&lt; On ne calcul L et U que si prems =1</span>
<span class="comment"></span>  <span class="keywordtype">int</span> lf = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(10,<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>()/2);        <span class="comment">//!&lt; nombre de termes ajouter dans L et U</span>
<span class="comment"></span>  <span class="keywordtype">int</span> nn = <a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>();                <span class="comment">//!&lt; ordre de la matrice</span>
<span class="comment"></span>  <span class="keywordtype">int</span> ima = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(10,<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>()/2);        <span class="comment">//!&lt; degre de l&#39;espace de Krilov</span>
<span class="comment"></span>  <a class="code" href="classIntVect.html">IntVect</a> ju;                        <span class="comment">//!&lt; tableau pour L et U</span>
<span class="comment"></span>  <a class="code" href="classDoubleVect.html">DoubleVect</a> alu;                <span class="comment">//!&lt; tableau pour L et U</span>
<span class="comment"></span>  <a class="code" href="classIntVect.html">IntVect</a> jlu;                        <span class="comment">//!&lt; tableau pour L et U</span>
<span class="comment"></span>  <a class="code" href="classDoubleVect.html">DoubleVect</a> vv;                <span class="comment">//!&lt; tableau de travail pour pgmres  DoubleVect Resini(nn);</span>
<span class="comment"></span><span class="comment">//</span>
  <a class="code" href="classDoubleVect.html">DoubleVect</a> Resini(toto);

  <span class="keywordtype">int</span> ie=1;                                <span class="comment">//!&lt; niveau d&#39;erreur</span>
<span class="comment"></span>  <span class="keywordtype">int</span> n2 = <a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>()+(2*lf*nn);        <span class="comment">//!&lt; nombre de termes non nuls dans LU</span>
<span class="comment"></span>
  <span class="keywordtype">double</span> r;
  <span class="keywordtype">double</span> coeff_seuilr;
precond :
  {
    <span class="keywordflow">if</span> (prems)
      {
<span class="comment">// Cerr &lt;&lt; &quot;  ordre de la matrice de pression = &quot; &lt;&lt; nn &lt;&lt; finl;</span>
<span class="comment">// Cerr &lt;&lt; &quot;  nb termes non nuls dans la matrice de pression = &quot;</span>
<span class="comment">// &lt;&lt; coeff_.size() &lt;&lt; finl;</span>
        <span class="keywordtype">int</span>  iw = n2 + 2;
        ju.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nn);
        jlu.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(iw);
        alu.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(iw);
        <span class="keywordtype">double</span> to = 1.e-10;                <span class="comment">//!&lt; filtrage des coefficents de L U</span>
<span class="comment"></span>        <a class="code" href="classDoubleVect.html">DoubleVect</a> w(nn+1);                <span class="comment">//!&lt; tableau de travail pour ilut        DoubleVect wl(nn);                // tableau de travail pour ilut</span>
<span class="comment"></span><span class="comment">//</span>
        <a class="code" href="classIntVect.html">IntVect</a> jw(2*nn);                        <span class="comment">//!&lt; tableau de travail pour ilut        IntVect jwu(nn);                        // tableau de travail pour ilut IntVect jwl(nn);                        // tableau de travail pour ilut coeff_[0]*=2.0;                        // pour rendre A non singuliere!</span>
<span class="comment"></span><span class="comment">//</span>
<span class="comment">//</span>
<span class="comment">//</span>

<span class="comment">// Cerr &lt;&lt; &quot;  ****  Preconditionnement ILUT de la matrice de pression  ****&quot; &lt;&lt; finl;</span>
<span class="preprocessor">#ifndef CRAY</span>
<span class="preprocessor"></span>        <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(ILUT)(&amp;nn, <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;lf,
                      &amp;to, alu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), jlu.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), ju.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
                      &amp;iw, w.addr(),
                      jw.addr(), &amp;ie);
<span class="comment">// to=0;</span>
<span class="comment">// wu=0.0;</span>
<span class="comment">// wl=0.0;</span>
<span class="comment">// jr=0;</span>
<span class="comment">// jwu=0;</span>
<span class="comment">// jwl=0;</span>
<span class="comment">// ie=0;</span>
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse ILUT call invalid for cray&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
        <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="comment">// coeff_[0]*=0.5;                        // pour rendre A singuliere!</span>
<span class="comment">// Cerr &lt;&lt; &quot;     nb termes non nuls dans LU = &quot; &lt;&lt; n2 &lt;&lt; finl;</span>
        <span class="keywordflow">switch</span>(ie)
          {
          <span class="keywordflow">case</span> 0 :
            <span class="comment">/*{</span>
<span class="comment">              Cerr &lt;&lt; &quot;     printing of the L and U matrixes : &quot; &lt;&lt; finl;</span>
<span class="comment">              Nom nom_fich = &quot;matrices_L_U.precond&quot;;</span>
<span class="comment">              ofstream os(nom_fich);</span>
<span class="comment">              os &lt;&lt; &quot;impression des matrices L et U :\n&quot;;</span>
<span class="comment">              int* tab2=jlu;</span>
<span class="comment">              double* coeff=alu;</span>
<span class="comment">              double x;</span>
<span class="comment">              os &lt;&lt; &quot;termes diagonaux :&quot; &lt;&lt; &quot;\n&quot;;</span>
<span class="comment">              for (int num=0; num&lt;nn; num++) {</span>
<span class="comment">              x=coeff[num];</span>
<span class="comment">              os &lt;&lt; &quot;(&quot; &lt;&lt; num+1 &lt;&lt; &quot; , &quot; &lt;&lt; num+1 &lt;&lt; &quot;)  =  &quot; &lt;&lt; x &lt;&lt; &quot;\n&quot;;</span>
<span class="comment">              }</span>
<span class="comment">              os &lt;&lt; &quot;hors diagonale : &quot; &lt;&lt; &quot;\n&quot;;</span>
<span class="comment">              for ( num=0; num&lt;nn; num++) {</span>
<span class="comment">              os &lt;&lt; &quot;ligne &quot; &lt;&lt; num+1 &lt;&lt; &quot; : &quot;;</span>
<span class="comment">              int nb_vois=tab2[num+1]-tab2[num];</span>
<span class="comment">              double x=0.;</span>
<span class="comment">              for(int vois=0; vois&lt;nb_vois; vois++) {</span>
<span class="comment">              int num_vois=tab2[tab2[num]+vois-1];</span>
<span class="comment">              x=coeff[tab2[num]+vois-1];</span>
<span class="comment">              os &lt;&lt; &quot;(&quot; &lt;&lt; num_vois &lt;&lt; &quot; , &quot; &lt;&lt; x &lt;&lt; &quot; ) &quot; ;</span>
<span class="comment">              }</span>
<span class="comment">              os &lt;&lt; &quot;\n&quot;;</span>
<span class="comment">              }</span>
<span class="comment">              os.flush();</span>
<span class="comment">              }</span>
<span class="comment">            */</span>
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> -1 :
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut &#39;matrix may be wrong&#39; dixit SAAD&quot;</span> &lt;&lt; finl;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span>  -2  :
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut : overflow in L &quot;</span> &lt;&lt; finl;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span>   -3  :
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut : overflow in U &quot;</span> &lt;&lt; finl;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span>    -4   :
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Illegal value for lfil : it may be a memory trouble &quot;</span> &lt;&lt; finl;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span>    -5  :
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Empty line met &quot;</span> &lt;&lt; finl;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
            <span class="keywordflow">break</span>;
          <span class="keywordflow">default</span> :
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Pivot empty met ! at step &quot;</span> &lt;&lt; ie &lt;&lt; finl;;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
            <span class="keywordflow">break</span>;
          }
        prems=0;
      }
  }
<span class="comment">// resol :</span>
  {
    vv.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nn*(ima+1));
<span class="comment">// Debog::verifier(&quot;Matrice_Morse::inverse solution 0 &quot;,solution);</span>
    <a class="code" href="Check__espace__virtuel_8cpp.html#a2ea8fcf12c28d0454bdc4126f8c4b186" title="en mode comm_check_enabled(), verifie si l&#39;espace virtuel du vecteur est a jour, si ce n&#39;est pas le c...">assert_espace_virtuel_vect</a>(solution);
    <a class="code" href="classMatrice__Base.html#a05caa487a25a6d5e7fbd38d4b2f4ee1e" title="Multiplication d&#39;un vecteur par la matrice. Operation: r = A*x.">multvect</a>(solution, Resini);
    Resini -= toto;
    {
      r = <a class="code" href="DoubleVect_8cpp.html#a07d13cbdadca6b60d5e128653f52a4bb">mp_prodscal</a>(Resini, Resini);
      r = sqrt(r);
    }
    <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot; Initial residu : &quot;</span> &lt;&lt; r &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
    <span class="keywordflow">if</span> (r==0)
      coeff_seuilr=<a class="code" href="Double_8h.html#ae0ee0cebfad5968da0ad6cc7a49e16b6">DMAXFLOAT</a>;
    <span class="keywordflow">else</span>
      coeff_seuilr=coeff_seuil/r;
    Resini=toto;
    <span class="keywordtype">int</span> maxits = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(10, nn);
    <span class="keywordtype">int</span> io = 0;                                <span class="comment">//!&lt; fichier de sortie</span>
<span class="comment"></span><span class="preprocessor">#ifndef CRAY</span>
<span class="preprocessor"></span>    <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(PGMRES)(&amp;nn, &amp;ima, toto.addr(), solution.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), vv.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;coeff_seuilr,
                    &amp;maxits, &amp;io, <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
                    alu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), jlu.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), ju.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;ie);

<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse PGMRES call invalid for CRAY&quot;</span>&lt;&lt;finl;
    <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    <span class="keywordflow">switch</span>(ie)
      {
      <span class="keywordflow">case</span> 0:
        <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;     ** PGMRES has converged **&quot;</span> &lt;&lt; finl;
        <span class="keywordflow">break</span>;
      <span class="keywordflow">case</span> 1:
        <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;     ** No convergence after &quot;</span> &lt;&lt; maxits &lt;&lt; <span class="stringliteral">&quot; iterations **&quot;</span> &lt;&lt; finl;
        <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>, toto)=Resini;
        <span class="keywordflow">if</span>( lf&lt;50)
          {
            lf +=5;
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  The degree of the preconditioning matrix LU is increased :   &quot;</span> &lt;&lt; lf &lt;&lt; finl;
            n2 = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>()+(2*lf*nn);
            prems=1;
            <span class="keywordflow">goto</span> precond ;
          }
        <span class="comment">/*else{</span>
<span class="comment">          if(ima==50)</span>
<span class="comment">          exit();</span>
<span class="comment">          Cout &lt;&lt; &quot;  The degree of the Krylov space for PGMRES is increased :   &quot; &lt;&lt; (ima+=2) &lt;&lt; finl;</span>
<span class="comment">          Cout &lt;&lt; &quot;    (=&gt; working array for pgmres at &quot; &lt;&lt; (nn*(ima+1)) &lt;&lt; &quot; elements.)&quot; &lt;&lt; finl;</span>
<span class="comment">          goto resol ;</span>
<span class="comment">          }*/</span>
        <span class="keywordflow">break</span>;
      <span class="keywordflow">case</span> -1:
        <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;convergence reached after &quot;</span> &lt;&lt; (int)0 &lt;&lt; <span class="stringliteral">&quot;iterations !! &quot;</span> &lt;&lt; finl;
        <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;&#39;stationnary state may be obtened&#39; dixit us &quot;</span> &lt;&lt; finl;
        <span class="keywordflow">break</span>;
      <span class="keywordflow">default</span> :
        <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something abnormal has happened : it is preferable to stop.&quot;</span> &lt;&lt; finl;
        <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
      }
  }
  <span class="keywordflow">return</span>(1);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0c2a2537386dc03a8978da93fedc93ae"></a><!-- doxytag: member="Matrice_Morse::inverse" ref="a0c2a2537386dc03a8978da93fedc93ae" args="(const DoubleVect &amp;, DoubleVect &amp;, double, int) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Matrice_Morse::inverse </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>secmem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>coeff_seuil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_iter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; On ne calcul L et U que si prems =1</p>
<p>&lt; nombre de termes ajouter dans L et U</p>
<p>&lt; ordre de la matrice</p>
<p>&lt; degre de l'espace de Krilov</p>
<p>&lt; tableau pour L et U</p>
<p>&lt; tableau pour L et U</p>
<p>&lt; tableau pour L et U</p>
<p>&lt; tableau de travail pour pgmres</p>
<p>&lt; niveau d'erreur</p>
<p>&lt; nombre de termes non nuls dans LU</p>
<p>&lt; filtrage des coefficents de L U</p>
<p>&lt; tableau de travail pour ilut</p>
<p>&lt; tableau de travail pour ilut <a class="el" href="classIntVect.html">IntVect</a> jwl(nn); // tableau de travail pour ilut coeff_[0]*=2.0; // pour rendre A non singuliere!</p>
<p>&lt; fichier de sortie </p>
</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Sym.html#aea34cf2169878d74b980b3f0187537a0">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01382">1382</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="ArrOfInt_8h_source.html#l00371">ArrOfInt::addr()</a>, <a class="el" href="ArrOfDouble_8h_source.html#l00379">ArrOfDouble::addr()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="EntreeSortie_8h_source.html#l00033">Cout</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="arch_8h_source.html#l00075">F77NAME</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Double_8h_source.html#l00180">max()</a>, <a class="el" href="Double_8h_source.html#l00199">min()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l02353">mp_norme_vect()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00127">Matrice_Base::multvect()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00107">nb_coeff()</a>, <a class="el" href="Process_8cpp_source.html#l00109">Process::nproc()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00559">ordre()</a>, <a class="el" href="DoubleVect_8h_source.html#l00193">DoubleVect::resize()</a>, <a class="el" href="IntVect_8h_source.html#l00179">IntVect::resize()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// B.Mat: au 20/4/2005, DoubleVect::norme() est bugge, donc la methode n&#39;a</span>
<span class="comment">// sans doute jamais ete validee en parallele. Je retire norme() et je mets</span>
<span class="comment">// ceci:</span>
  <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse(const DoubleVect&amp; secmem, DoubleVect&amp; solution, &quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;double coeff_seuil) const \n has never been tested in parallel&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      assert(0);
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
    }


  <a class="code" href="classDoubleVect.html">DoubleVect</a> toto(secmem);
  <span class="keywordtype">int</span> prems=1;                        <span class="comment">//!&lt; On ne calcul L et U que si prems =1</span>
<span class="comment"></span>  <span class="keywordtype">int</span> lf = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(10,<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>()/2);        <span class="comment">//!&lt; nombre de termes ajouter dans L et U</span>
<span class="comment"></span>  <span class="keywordtype">int</span> nn = <a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>();                <span class="comment">//!&lt; ordre de la matrice</span>
<span class="comment"></span>
  <span class="keywordtype">int</span> ima = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(10,<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>()/2);        <span class="comment">//!&lt; degre de l&#39;espace de Krilov</span>
<span class="comment"></span>  <a class="code" href="classIntVect.html">IntVect</a> ju;                        <span class="comment">//!&lt; tableau pour L et U</span>
<span class="comment"></span>  <a class="code" href="classDoubleVect.html">DoubleVect</a> alu;                <span class="comment">//!&lt; tableau pour L et U</span>
<span class="comment"></span>  <a class="code" href="classIntVect.html">IntVect</a> jlu;                        <span class="comment">//!&lt; tableau pour L et U</span>
<span class="comment"></span>  <a class="code" href="classDoubleVect.html">DoubleVect</a> vv;                <span class="comment">//!&lt; tableau de travail pour pgmres</span>
<span class="comment"></span>  <a class="code" href="classDoubleVect.html">DoubleVect</a> Resini(nn);

  <span class="keywordtype">int</span> ie=1;                                <span class="comment">//!&lt; niveau d&#39;erreur</span>
<span class="comment"></span>  <span class="keywordtype">int</span> n2 = <a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>()+(2*lf*nn);        <span class="comment">//!&lt; nombre de termes non nuls dans LU</span>
<span class="comment"></span>
  <span class="keywordtype">double</span> r;
  <span class="keywordtype">double</span> coeff_seuilr;
<span class="comment">// precond :</span>
  {
    <span class="keywordflow">if</span> (prems)
      {
<span class="comment">// Cerr &lt;&lt; &quot;  ordre de la matrice de pression = &quot; &lt;&lt; nn &lt;&lt; finl;</span>
<span class="comment">// Cerr &lt;&lt; &quot;  nb termes non nuls dans la matrice de pression = &quot;</span>
<span class="comment">// &lt;&lt; tab2_.size() &lt;&lt; finl;</span>
        <span class="keywordtype">int</span>  iw = n2 + 2;
        ju.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nn);
        jlu.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(iw);
        alu.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(iw);
        <span class="keywordtype">double</span> to = 1.e-10;                <span class="comment">//!&lt; filtrage des coefficents de L U</span>
<span class="comment"></span>        <a class="code" href="classDoubleVect.html">DoubleVect</a> w(nn+1);                <span class="comment">//!&lt; tableau de travail pour ilut</span>
<span class="comment"></span>
<span class="comment">// IntVect jr(nn);                        // tableau de travail pour ilut</span>
        <a class="code" href="classIntVect.html">IntVect</a> jw(2*nn);                        <span class="comment">//!&lt; tableau de travail pour ilut        IntVect jwl(nn);                        // tableau de travail pour ilut coeff_[0]*=2.0;                        // pour rendre A non singuliere!</span>
<span class="comment"></span><span class="comment">//</span>
<span class="comment">//</span>

<span class="comment">// Cerr &lt;&lt; &quot;  ****  Preconditionnement ILUT de la matrice de pression  ****&quot; &lt;&lt; finl;</span>
<span class="preprocessor">#ifndef CRAY</span>
<span class="preprocessor"></span>        <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(ILUT)(&amp;nn, <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;lf,
                      &amp;to, alu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), jlu.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), ju.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
                      &amp;iw, w.addr(),
                      jw.addr(), &amp;ie);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>        <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse ILUT call invalid for CRAY&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
        <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="comment">// coeff_[0]*=0.5;                        // pour rendre A singuliere!</span>
<span class="comment">// Cerr &lt;&lt; &quot;     nb termes non nuls dans LU = &quot; &lt;&lt; n2 &lt;&lt; finl;</span>
        <span class="keywordflow">switch</span>(ie)
          {
          <span class="keywordflow">case</span> 0 :
            <span class="comment">/*{</span>
<span class="comment">              Cerr &lt;&lt; &quot;     printing of L and U matrixes : &quot; &lt;&lt; finl;</span>
<span class="comment">              Nom nom_fich = &quot;matrices_L_U.precond&quot;;</span>
<span class="comment">              ofstream os(nom_fich);</span>
<span class="comment">              os &lt;&lt; &quot;impression des matrices L et U :\n&quot;;</span>
<span class="comment">              int* tab2=jlu;</span>
<span class="comment">              double* coeff=alu;</span>
<span class="comment">              double x;</span>
<span class="comment">              os &lt;&lt; &quot;termes diagonaux :&quot; &lt;&lt; &quot;\n&quot;;</span>
<span class="comment">              for (int num=0; num&lt;nn; num++) {</span>
<span class="comment">              x=coeff[num];</span>
<span class="comment">              os &lt;&lt; &quot;(&quot; &lt;&lt; num+1 &lt;&lt; &quot; , &quot; &lt;&lt; num+1 &lt;&lt; &quot;)  =  &quot; &lt;&lt; x &lt;&lt; &quot;\n&quot;;</span>
<span class="comment">              }</span>
<span class="comment">              os &lt;&lt; &quot;hors diagonale : &quot; &lt;&lt; &quot;\n&quot;;</span>
<span class="comment">              for ( num=0; num&lt;nn; num++) {</span>
<span class="comment">              os &lt;&lt; &quot;ligne &quot; &lt;&lt; num+1 &lt;&lt; &quot; : &quot;;</span>
<span class="comment">              int nb_vois=tab2[num+1]-tab2[num];</span>
<span class="comment">              double x=0.;</span>
<span class="comment">              for(int vois=0; vois&lt;nb_vois; vois++) {</span>
<span class="comment">              int num_vois=tab2[tab2[num]+vois-1];</span>
<span class="comment">              x=coeff[tab2[num]+vois-1];</span>
<span class="comment">              os &lt;&lt; &quot;(&quot; &lt;&lt; num_vois &lt;&lt; &quot; , &quot; &lt;&lt; x &lt;&lt; &quot; ) &quot; ;</span>
<span class="comment">              }</span>
<span class="comment">              os &lt;&lt; &quot;\n&quot;;</span>
<span class="comment">              }</span>
<span class="comment">              os.flush();</span>
<span class="comment">              }</span>
<span class="comment">            */</span>
<span class="comment">// Cerr &lt;&lt; &quot;     matrices L et U :  OK&quot; &lt;&lt; finl;</span>
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> -1 :
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut &#39;matrix may be wrong&#39; dixit SAAD&quot;</span> &lt;&lt; finl;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span>  -2  :
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut : overflow in L &quot;</span> &lt;&lt; finl;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span>   -3  :
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut : overflow in U &quot;</span> &lt;&lt; finl;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span>    -4   :
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Illegal value for lfil : it may be a memory trouble &quot;</span> &lt;&lt; finl;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span>    -5  :
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Empty line met &quot;</span> &lt;&lt; finl;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
            <span class="keywordflow">break</span>;
          <span class="keywordflow">default</span> :
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Pivot null met ! at step &quot;</span> &lt;&lt; ie &lt;&lt; finl;;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
            <span class="keywordflow">break</span>;
          }
        prems=0;
      }
  }
<span class="comment">// resol :</span>
  {
    vv.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nn*(ima+1));
    <a class="code" href="classMatrice__Base.html#a05caa487a25a6d5e7fbd38d4b2f4ee1e" title="Multiplication d&#39;un vecteur par la matrice. Operation: r = A*x.">multvect</a>(solution, Resini);
    Resini -= toto;
    r = <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(Resini);
    <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot; Initial residu : &quot;</span> &lt;&lt; r &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
    coeff_seuilr=coeff_seuil/r;
    Resini=toto;
    <span class="keywordtype">int</span> maxits = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(10, max_iter);
    <span class="keywordtype">int</span> io = 0;                                <span class="comment">//!&lt; fichier de sortie</span>
<span class="comment"></span><span class="preprocessor">#ifndef CRAY</span>
<span class="preprocessor"></span>    <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(PGMRES)(&amp;nn, &amp;ima, toto.addr(), solution.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), vv.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;coeff_seuilr,
                    &amp;maxits, &amp;io, <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
                    alu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), jlu.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), ju.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;ie);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>    <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse PGMRES call invalid for CRAY&quot;</span>&lt;&lt;finl;
    <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="comment">// multvect(solution, Resini);</span>
<span class="comment">// Resini -= secmem;</span>
<span class="comment">// r=Resini.norme();</span>
<span class="comment">// Cerr &lt;&lt; &quot; Residu final : &quot; &lt;&lt; r &lt;&lt;&quot; coeff &quot;&lt;&lt;coeff_seuilr*r&lt;&lt;&quot; Its &quot;&lt;&lt;maxits&lt;&lt; finl;</span>
    <span class="keywordflow">switch</span>(ie)
      {
      <span class="keywordflow">case</span> 0:
        <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;     ** PGMRES has converged ** &quot;</span> &lt;&lt; finl;
        <span class="keywordflow">break</span>;
      <span class="keywordflow">case</span> 1:
        <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;     ** No convergence after &quot;</span> &lt;&lt; maxits &lt;&lt; <span class="stringliteral">&quot; iterations **&quot;</span> &lt;&lt; finl;
        <span class="keywordflow">return</span>(0);
        <span class="comment">/*else{</span>
<span class="comment">          if(ima==50)</span>
<span class="comment">          exit();</span>
<span class="comment">          Cerr &lt;&lt; &quot;  The degree of the Krylov space for PGMRES is increased :   &quot; &lt;&lt; (ima+=2) &lt;&lt; finl;</span>
<span class="comment">          Cerr &lt;&lt; &quot;    (=&gt; working array for pgmres at &quot; &lt;&lt; (nn*(ima+1)) &lt;&lt; &quot; elements.)&quot; &lt;&lt; finl;</span>
<span class="comment">          goto resol ;</span>
<span class="comment">// (DoubleVect&amp;) toto=Resini;</span>
<span class="comment">// if( lf&lt;50){</span>
<span class="comment">// lf +=5;</span>
<span class="comment">// Cerr &lt;&lt; &quot;  J&#39;augmente le degre de la matrice de precondition. LU:   &quot; &lt;&lt; lf &lt;&lt; finl;</span>
<span class="comment">// n2 = coeff_.size()+(2*lf*nn);</span>
<span class="comment">// prems=1;</span>
<span class="comment">// goto precond ;</span>
<span class="comment">// }</span>
<span class="comment">          }*/</span>
      <span class="keywordflow">case</span> -1:
        <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Convergence after &quot;</span> &lt;&lt; (int)0 &lt;&lt; <span class="stringliteral">&quot;iterations !! &quot;</span> &lt;&lt; finl;
        <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;&#39;stationnary state may be obtened&#39; dixit us &quot;</span> &lt;&lt; finl;
        <span class="keywordflow">break</span>;
      <span class="keywordflow">default</span> :
        <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something abnormal has happened : it is preferable to stop.&quot;</span> &lt;&lt; finl;
        <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
      }
  }
  <span class="keywordflow">return</span>(1);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a95c8d6e95a8ad58710856f60bf07cd43"></a><!-- doxytag: member="Matrice_Morse::largeur_de_bande" ref="a95c8d6e95a8ad58710856f60bf07cd43" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Matrice_Morse::largeur_de_bande </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retourne la largeur de bande. </p>
<p>Calcule la largeur de bande d'une matrice morse. </p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02281">2281</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="ArrOfInt_8h_source.html#l00371">ArrOfInt::addr()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00134">get_tab1()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00138">get_tab2()</a>, <a class="el" href="Double_8h_source.html#l00199">min()</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l00559">ordre()</a>.</p>

<p>Referenced by <a class="el" href="Solv__Cholesky_8cpp_source.html#l00236">Solv_Cholesky::Fact_Cholesky()</a>, and <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00988">Matrice_Morse_Sym::renumerote()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> ldist,<a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a> = 0;
  <span class="keyword">const</span> <span class="keywordtype">int</span>* p_tab1_ = <a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span>* p_tab2_ = <a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
  <span class="keywordtype">int</span> N=<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>();

  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;N; i++)
    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = p_tab1_[i]; k &lt; p_tab1_[i+1]; k++)
      {
        <span class="keywordflow">if</span> (p_tab2_[k-1]-1&lt;N)
          {
            ldist = p_tab2_[k-1] - i;
            <span class="keywordflow">if</span>( min &lt; ldist ) min = ldist;
          }
      };
  <span class="keywordflow">return</span> <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="afb2d730697791b429d020575ae3388d0"></a><!-- doxytag: member="Matrice_Morse::nb_coeff" ref="afb2d730697791b429d020575ae3388d0" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Matrice_Morse::nb_coeff </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; nb_coeff retourne nnz </p>
</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00107">107</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, and <a class="el" href="DoubleVect_8h_source.html#l00153">DoubleVect::size()</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l01616">affecte_prod()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02265">clean()</a>, <a class="el" href="ILU_8cpp_source.html#l00126">ILU::factoriser()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02202">formeC()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02216">formeF()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01184">inverse()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01873">operator+=()</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l02154">remplir()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); <span class="comment">//!&lt; nb_coeff retourne nnz</span>
<span class="comment"></span>  }
</pre></div>
</div>
</div>
<a class="anchor" id="a94caf9937bc5a110a7179cb3e9eaa9d9"></a><!-- doxytag: member="Matrice_Morse::nb_colonnes" ref="a94caf9937bc5a110a7179cb3e9eaa9d9" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Matrice_Morse::nb_colonnes </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; nb_colonnes retourne m </p>
</p>

<p>Implements <a class="el" href="classMatrice__Base.html#a8aff414991f0c4f80d8581fbbda62cae">Matrice_Base</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00103">103</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00235">m_</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l01616">affecte_prod()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00936">ajouter_multvect_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01077">ajouter_multvectT_()</a>, <a class="el" href="SETS_8cpp_source.html#l00496">SETS::assembler()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02300">check_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02356">check_sorted_morse_matrix_structure()</a>, <a class="el" href="Op__Diff__EF_8cpp_source.html#l00807">coeff_opt()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00368">dimensionner()</a>, <a class="el" href="Sources_8cpp_source.html#l00291">Sources::dimensionner()</a>, <a class="el" href="Op__EF__base_8cpp_source.html#l00050">Op_EF_base::dimensionner()</a>, <a class="el" href="Masse__CoviMAC__Face_8cpp_source.html#l00096">Masse_CoviMAC_Face::dimensionner_blocs()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02202">Equation_base::dimensionner_matrice()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02227">Equation_base::dimensionner_matrice_sans_mem()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02278">Equation_base::dimensionner_termes_croises()</a>, <a class="el" href="Zone__CoviMAC_8cpp_source.html#l00618">disp_m()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00109">imprimer_formatte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00171">imprimer_image()</a>, <a class="el" href="Testeur_8cpp_source.html#l00046">Testeur::interpreter()</a>, <a class="el" href="Simpler_8cpp_source.html#l00051">inverser_par_diagonale()</a>, <a class="el" href="Op__VEF__Face_8cpp_source.html#l00185">Op_VEF_Face::modifier_pour_Cl()</a>, <a class="el" href="Assembleur__P__VEFPreP1B_8cpp_source.html#l01117">operation01()</a>, <a class="el" href="Assembleur__P__VEFPreP1B_8cpp_source.html#l01018">operation11()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00259">operator()()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00161">Matrice_Morse_Sym::operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00701">operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00559">ordre()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l03201">Op_Diff_VEFP1NCP1B_Face::test()</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l00726">transpose()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a>; <span class="comment">//!&lt; nb_colonnes retourne m</span>
<span class="comment"></span>  }
</pre></div>
</div>
</div>
<a class="anchor" id="a1f9bd6aedb226c86b7299689fa5b821a"></a><!-- doxytag: member="Matrice_Morse::nb_lignes" ref="a1f9bd6aedb226c86b7299689fa5b821a" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Matrice_Morse::nb_lignes </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; nb_lignes retourne n </p>
</p>

<p>Implements <a class="el" href="classMatrice__Base.html#a78420d19112a02c5808daa50151bbb09">Matrice_Base</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00099">99</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>.</p>

<p>Referenced by <a class="el" href="Matrix__tools_8cpp_source.html#l00356">Matrix_tools::add_scaled_matrices()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00410">Matrix_tools::add_symmetric_scaled_matrices()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01616">affecte_prod()</a>, <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00178">Masse_PolyMAC_Face::ajouter_masse()</a>, <a class="el" href="Masse__PolyMAC__Elem_8cpp_source.html#l00166">Masse_PolyMAC_Elem::ajouter_masse()</a>, <a class="el" href="Solveur__Masse__base_8cpp_source.html#l00263">Solveur_Masse_base::ajouter_masse_dt_local()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00229">Matrice_Morse_Sym::ajouter_multTab_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01009">ajouter_multTab_()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00335">Matrice_Morse_Sym::ajouter_multvect_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00968">ajouter_multvect_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01062">ajouter_multvectT_()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00169">Navier_Stokes_Fluide_Dilatable_Proto::assembler_avec_inertie_impl()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l00402">Op_Diff_VEFP1NCP1B_Face::calculer_dt_stab_som()</a>, <a class="el" href="Op__Dift__VEF__P1NCP1B__Face_8cpp_source.html#l00159">Op_Dift_VEF_P1NCP1B_Face::calculer_gradient_som()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l00975">Op_Diff_VEFP1NCP1B_Face::calculer_laplacien_som()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02300">check_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02356">check_sorted_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l01117">Matrice_Morse_Sym::check_sorted_symmetric_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l01090">Matrice_Morse_Sym::check_symmetric_morse_matrix_structure()</a>, <a class="el" href="Op__Diff__EF_8cpp_source.html#l00807">coeff_opt()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00928">Matrice_Morse_Sym::compacte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00573">compacte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00864">diagmulmat()</a>, <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00120">Masse_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Masse__PolyMAC__Elem_8cpp_source.html#l00120">Masse_PolyMAC_Elem::dimensionner()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00368">dimensionner()</a>, <a class="el" href="Zone__CoviMAC_8cpp_source.html#l00618">disp_m()</a>, <a class="el" href="ILU_8cpp_source.html#l00126">ILU::factoriser()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l01124">Champ_P1NC_implementation::filtrer_resu()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02202">formeC()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02216">formeF()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00681">Matrice_Morse_Sym::get_stencil()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01920">get_stencil()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00731">Matrice_Morse_Sym::get_stencil_and_coefficients()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01968">get_stencil_and_coefficients()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00693">Matrice_Morse_Sym::get_symmetric_stencil()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00748">Matrice_Morse_Sym::get_symmetric_stencil_and_coefficients()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01143">has_same_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00087">imprimer()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00109">imprimer_formatte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00171">imprimer_image()</a>, <a class="el" href="Solveur__U__P_8cpp_source.html#l00061">Solveur_U_P::iterer_NS()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00580">Matrix_tools::matdiag_mult_matmorse()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00604">Matrix_tools::matmorse_mult_matdiag()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00266">Matrice_Morse_Sym::multvect_et_prodscal()</a>, <a class="el" href="Assembleur__P__VEFPreP1B_8cpp_source.html#l01117">operation01()</a>, <a class="el" href="Assembleur__P__VEFPreP1B_8cpp_source.html#l01018">operation11()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00259">operator()()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01585">operator*=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00559">ordre()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00887">partie_sup()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02068">remplir()</a>, <a class="el" href="Op__Diff__VEFP1NCP1B__Face_8cpp_source.html#l03201">Op_Diff_VEFP1NCP1B_Face::test()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00726">transpose()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00629">Matrix_tools::uniform_matdiag_mult_matmorse()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00716">valeur_P1_H1()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">valeur_P1_L2()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>()-1; <span class="comment">//!&lt; nb_lignes retourne n</span>
<span class="comment"></span>  }
</pre></div>
</div>
</div>
<a class="anchor" id="aebca6e5632d935408e1f81674209a86c"></a><!-- doxytag: member="Matrice_Morse::nb_vois" ref="aebca6e5632d935408e1f81674209a86c" args="(int i) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Matrice_Morse::nb_vois </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; nb_vois(i) : nombre d'elements non nuls de la ligne i </p>
</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00147">147</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00134">get_tab1()</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l02202">formeC()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i+1)-<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>()(i); <span class="comment">//!&lt; nb_vois(i) : nombre d&#39;elements non nuls de la ligne i</span>
<span class="comment"></span>  }
</pre></div>
</div>
</div>
<a class="anchor" id="ad1238bc19f3f043e9a4af8282e5d6521"></a><!-- doxytag: member="Matrice_Morse::operator()" ref="ad1238bc19f3f043e9a4af8282e5d6521" args="(int i, int j)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double &amp; Matrice_Morse::operator() </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; Pour <a class="el" href="classMatrice__Morse__Diag.html" title="Classe Matrice_Morse_Diag Represente une matrice M (creuse) symetrique stockee au format Morse Diaget...">Matrice_Morse_Diag</a>, on ne verifie pas si la case est definie et l'on renvoie 0</p>
<p>&lt; On ne passe jamais ici </p>
</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00259">259</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Objet__U_8cpp_source.html#l00132">Objet_U::que_suis_je()</a>, <a class="el" href="AssembleurPP1BUtil_8cpp_source.html#l00335">swap()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00236">symetrique_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00240">zero_</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8h_source.html#l00162">coef()</a>.</p>
<div class="fragment"><pre class="fragment">{
  assert( (<a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>==0 &amp;&amp; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;Matrice_Morse&quot;</span>)
          || (<a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>==1 &amp;&amp; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;Matrice_Morse_Sym&quot;</span>)
          || (<a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>==2 &amp;&amp; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;Matrice_Morse_Diag&quot;</span>) );
<span class="comment">// if (symetrique_==1 &amp;&amp; j&lt;i) std::swap(i,j); // Do not use, possible error during compile: &quot;signed overflow does not occur when assuming that (X + c) &lt; X is always false&quot;</span>
  <span class="keywordflow">if</span> ((<a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>==1) &amp;&amp; ((j-i)&lt;0)) <a class="code" href="AssembleurPP1BUtil_8cpp.html#a3117b050530c46b4a15b6ab9ce6d0b41">std::swap</a>(i,j);
  <span class="keywordtype">int</span> k1=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1;
  <span class="keywordtype">int</span> k2=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1]-1;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=k1; k&lt;k2; k++)
    <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k]-1 == j) <span class="keywordflow">return</span>(<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[k]);
  <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>==2) <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a8e9254acaa95bbcb76a8ff1772b9b572">zero_</a>; <span class="comment">//!&lt; Pour Matrice_Morse_Diag, on ne verifie pas si la case est definie et l&#39;on renvoie 0</span>
<span class="comment"></span><span class="preprocessor">#ifndef NDEBUG</span>
<span class="preprocessor"></span><span class="comment">// Uniquement en debug afin de permettre l&#39;inline en optimise</span>
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;i or j are not suitable &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;i=&quot;</span> &lt;&lt; i &lt;&lt; finl;
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;j=&quot;</span> &lt;&lt; j &lt;&lt; finl;
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;n_lignes=&quot;</span> &lt;&lt; <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>() &lt;&lt; finl;
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;n_colonnes=&quot;</span> &lt;&lt; <a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>() &lt;&lt; finl;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span><span class="comment">// This message happens when you try to fill a coefficient in a matrix whereas is was not scheduled</span>
<span class="comment">// If it is a symmetric matrix, it -may- be a parallelism default. Check it by running a PETSc solver</span>
<span class="comment">// in debug mode: there is a test to check the parallelism of the symmetric matrix...</span>
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error Matrice_Morse::operator(&quot;</span>&lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;) not defined!&quot;</span> &lt;&lt; finl;
  <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
  <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[0];     <span class="comment">//!&lt; On ne passe jamais ici</span>
<span class="comment"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="acb3b84de4aa8089c9bd1fd7b123d0f62"></a><!-- doxytag: member="Matrice_Morse::operator()" ref="acb3b84de4aa8089c9bd1fd7b123d0f62" args="(int i, int j) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Matrice_Morse::operator() </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00245">245</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Objet__U_8cpp_source.html#l00132">Objet_U::que_suis_je()</a>, <a class="el" href="AssembleurPP1BUtil_8cpp_source.html#l00335">swap()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00236">symetrique_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  assert( (<a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>==0 &amp;&amp; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;Matrice_Morse&quot;</span>)
          || (<a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>==1 &amp;&amp; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;Matrice_Morse_Sym&quot;</span>)
          || (<a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>==2 &amp;&amp; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;Matrice_Morse_Diag&quot;</span>) );
  <span class="keywordflow">if</span> ((<a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a>==1) &amp;&amp; ((j-i)&lt;0)) <a class="code" href="AssembleurPP1BUtil_8cpp.html#a3117b050530c46b4a15b6ab9ce6d0b41">std::swap</a>(i,j);
  <span class="keywordtype">int</span> k1=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1;
  <span class="keywordtype">int</span> k2=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1]-1;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=k1; k&lt;k2; k++)
    <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k]-1 == j) <span class="keywordflow">return</span>(<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[k]);
<span class="comment">// Si coefficient non trouve c&#39;est qu&#39;il est nul:</span>
  <span class="keywordflow">return</span>(0);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a547bc77cbec07f7cb77f180d2a600149"></a><!-- doxytag: member="Matrice_Morse::operator*=" ref="a547bc77cbec07f7cb77f180d2a600149" args="(double)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp; Matrice_Morse::operator*= </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a> de multiplication (de tous les elements)<br/>
d'une matrice par un scalaire.<br/>
Operation: A = x * A. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp;<br/>
 Signification: le resultat de l'operation (*this)<br/>
 Contraintes: </dd></dl>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Sym.html#a0b09b056a9a64233fb4078e6aa19c6d7">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01909">1909</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8cpp_source.html#l01915">scale()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a31b1e2dbaae22b47a6908ed7e073fc98">scale</a>( x );
  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3bf78034a1ed02f3721b406183577f59"></a><!-- doxytag: member="Matrice_Morse::operator*=" ref="a3bf78034a1ed02f3721b406183577f59" args="(const DoubleVect &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp; Matrice_Morse::operator*= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a> de multiplication d'une matrice par un vecteur:<br/>
scaling des lignes de la matrice par les coefficients<br/>
correspondants du vecteur passe en parametre.<br/>
A *= x, effectue les scaling suivants:<br/>
A(i,:) = A(i,:) * x(i), pour toutes les lignes i de A. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp;<br/>
 Signification: le resultat de l'operation (*this)<br/>
 Contraintes: </dd></dl>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01585">1585</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i,k;
  <span class="keywordflow">for</span>(i = 0; i&lt;<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>(); i++)
    <span class="keywordflow">for</span>(k = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
      <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) *= x(i);
  <span class="keywordflow">return</span> *<span class="keyword">this</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac77dbfcd9310f3b356ad3d2766a5f100"></a><!-- doxytag: member="Matrice_Morse::operator+=" ref="ac77dbfcd9310f3b356ad3d2766a5f100" args="(const Matrice_Morse &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp; Matrice_Morse::operator+= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>NE FAIT RIEN. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp;<br/>
 Signification: renvoie toujours *this<br/>
 Contraintes: </dd></dl>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01873">1873</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00142">get_coeff()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01143">has_same_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00107">nb_coeff()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// PL: Avant de verifier de faire des operations couteuses en RAM, on verifie</span>
<span class="comment">// si ce n&#39;est pas la meme structure:</span>
  <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a11eec428fe6de8eeba3113b682dd38f1">has_same_morse_matrix_structure</a>(A))
    {
      <span class="keywordtype">int</span> size = A.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>();
      <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = A.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>();
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;size; i++)
        <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(i)+=<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(i);
    }
  <span class="keywordflow">else</span>
    {
      *<span class="keyword">this</span> = *<span class="keyword">this</span> + A;
      <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a> = 1;
    }
  <span class="keywordflow">return</span> *<span class="keyword">this</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad701760e949d89c0c3be1fc768af1a93"></a><!-- doxytag: member="Matrice_Morse::operator&#45;" ref="ad701760e949d89c0c3be1fc768af1a93" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> Matrice_Morse::operator- </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a> de negation unaire, renvoie l'opposee de la matrice: - A<br/>
Appelle operator*(double,const <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp;) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a><br/>
 Signification: le resultat de l'appel a operator*(double,const <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp;)<br/>
 Contraintes: </dd></dl>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Sym.html#a920fb9eb9b3faa1a680cec91c5c00de7">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01853">1853</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span>((-1)*(*<span class="keyword">this</span>));
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6e0753ddc2866580a7716588fafff24e"></a><!-- doxytag: member="Matrice_Morse::operator/=" ref="a6e0753ddc2866580a7716588fafff24e" args="(double)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp; Matrice_Morse::operator/= </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a> de division (de tous les elements)<br/>
d'une matrice par un scalaire.<br/>
Operation: A = A / x. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp;<br/>
 Signification: le resultat de l'operation (*this)<br/>
 Contraintes: </dd></dl>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02062">2062</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>/=x;
  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5ed8c0c5ce20ddb2dff99c2eec47006f"></a><!-- doxytag: member="Matrice_Morse::operator=" ref="a5ed8c0c5ce20ddb2dff99c2eec47006f" args="(const Matrice_Morse &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp; Matrice_Morse::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a> d'affectation d'une <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> dans une<br/>
autre <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>. </p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Sym.html#aa7bc2a550de22b700d1e09a28173629d">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00701">701</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00166">DoubleVect::copy()</a>, <a class="el" href="IntVect_8cpp_source.html#l00165">IntVect::copy()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00142">get_coeff()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00134">get_tab1()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00138">get_tab2()</a>, <a class="el" href="Matrice__Base_8cpp_source.html#l00126">Matrice_Base::is_stencil_up_to_date()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00235">m_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00111">DoubleVect::reset()</a>, <a class="el" href="IntVect_8cpp_source.html#l00110">IntVect::reset()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a273976ecf3d2d4fdbdc48ab446027e8e" title="met l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut. (voir ArrOfInt::reset())">reset</a>(), <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a94564e16be1ede0879c6aea2dfc810af" title="copie de la structure et des valeurs (si opt==COPY_INIT) du tableau v. Attention, v doit vraiment etr...">copy</a>(a.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>());
  <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a273976ecf3d2d4fdbdc48ab446027e8e" title="met l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut. (voir ArrOfInt::reset())">reset</a>(), <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a94564e16be1ede0879c6aea2dfc810af" title="copie de la structure et des valeurs (si opt==COPY_INIT) du tableau v. Attention, v doit vraiment etr...">copy</a>(a.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>());
  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#a990500e5bf63a8ca55fd833d111e135c" title="met l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut. (voir ArrOfDouble::reset())">reset</a>(), <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#aaccfc72d49151e3105aba476fa9f414b" title="copie de la structure et des valeurs (si opt==COPY_INIT) du tableau v. Attention, v doit vraiment etr...">copy</a>(a.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>());
  <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a>=a.<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=a.<a class="code" href="classMatrice__Base.html#aa1828bab9e4980e6980b7e71ae280c1c">is_stencil_up_to_date</a>();
  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a24a51a119cc5068408773a983ce5f13a"></a><!-- doxytag: member="Matrice_Morse::ordre" ref="a24a51a119cc5068408773a983ce5f13a" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Matrice_Morse::ordre </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renvoie l'ordre de la matrice:<br/>
- le nombre de lignes si la matrice est carree<br/>
- 0 sinon. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>int<br/>
 Signification: l'ordre de la matrice<br/>
 Contraintes: </dd></dl>

<p>Implements <a class="el" href="classMatrice__Base.html#aa72ae45ad33c9dd24c315c620d88dcb2">Matrice_Base</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00559">559</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>.</p>

<p>Referenced by <a class="el" href="Simple_8cpp_source.html#l00478">Simple::calculer_correction_en_vitesse()</a>, <a class="el" href="Op__Diff__RotRot_8cpp_source.html#l00127">Op_Diff_RotRot::calculer_vorticite()</a>, <a class="el" href="Solv__Cholesky_8cpp_source.html#l00143">Solv_Cholesky::Cholesky()</a>, <a class="el" href="Equation__base_8cpp_source.html#l01832">Equation_base::Gradient_conjugue_diff_impl()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01184">inverse()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02281">largeur_de_bande()</a>, <a class="el" href="ILU_8cpp_source.html#l00056">MorseSymToMorse()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02154">remplir()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00988">Matrice_Morse_Sym::renumerote()</a>, <a class="el" href="Op__Diff__RotRot_8cpp_source.html#l00608">Op_Diff_RotRot::tester()</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l00535">unite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span>(<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>()==<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>())
    <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordflow">else</span>
    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af1142c6d58bd4b5d01cfbb9bdc600fe9"></a><!-- doxytag: member="Matrice_Morse::partie_sup" ref="af1142c6d58bd4b5d01cfbb9bdc600fe9" args="(const Matrice_Morse &amp;a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp; Matrice_Morse::partie_sup </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00887">887</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="DoubleVect_8h_source.html#l00193">DoubleVect::resize()</a>, <a class="el" href="IntVect_8h_source.html#l00179">IntVect::resize()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00143">Matrice_Morse_Sym::Matrice_Morse_Sym()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00161">Matrice_Morse_Sym::operator=()</a>, and <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00988">Matrice_Morse_Sym::renumerote()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> m=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordtype">int</span> n=a.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordflow">if</span>(m!=n)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::partie_sup : bad dimensions m!=n.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
    }
  <span class="keywordtype">double</span> t ;
  <span class="keywordtype">int</span> ko, k, i, kdiag, kfirst ;
  ko = -1 ;
  <span class="keywordflow">for</span>( i=0; i&lt; n; i++)
    {
      kfirst = ko + 1 ;
      kdiag = -1 ;
      <span class="keywordflow">for</span>( k = a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1; k&lt; a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1]-1; k++)
        {
          <span class="keywordflow">if</span> (a.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k]-1 &gt;= i)
            {
              ko++ ;
              <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[ko] = a.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[k] ;
              <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[ko] = a.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] ;
              <span class="keywordflow">if</span> (a.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] == i) kdiag = ko ;
            }
        }
      <span class="keywordflow">if</span> (kdiag != -1 &amp;&amp; kdiag != kfirst)
        {
          t = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kdiag] ;
          <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kdiag] = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kfirst] ;
          <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kfirst] = t ;
          k = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kdiag] ;
          <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kdiag] = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kfirst] ;
          <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kfirst] = k ;
        }
      <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] = kfirst+1 ;
    }
  <span class="keywordtype">int</span> nnz = (ko + 1) ;

  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[n] = (nnz) + 1 ;
  <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( nnz );
  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( nnz );
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a28b21c265cfd181b8ffb9fc1821abd33"></a><!-- doxytag: member="Matrice_Morse::printOn" ref="a28b21c265cfd181b8ffb9fc1821abd33" args="(Sortie &amp;x) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSortie.html">Sortie</a> &amp; Matrice_Morse::printOn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td> const<code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Ecrit les trois tableaux de la structure de stockage<br/>
Morse sur un flot de sortie. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s<br/>
 Signification: le flot de sortie modifie<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classMatrice__Base.html#a4603c335af0f76e8ef2974de3e6ff825">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#a0869934f27aa371b8ab9464792526e05">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#a04868f779d1134885b629937513a9d94">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00054">54</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00235">m_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  s &lt;&lt; <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>;
  s &lt;&lt; <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>;
  s &lt;&lt; <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>;
  s &lt;&lt; <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  <span class="keywordflow">return</span> s;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a49ab0e8938f70c06575ad81b02065915"></a><!-- doxytag: member="Matrice_Morse::readOn" ref="a49ab0e8938f70c06575ad81b02065915" args="(Entree &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEntree.html">Entree</a> &amp; Matrice_Morse::readOn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEntree.html">Entree</a> &amp;&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>NON CODE. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s<br/>
 Signification: le flot d'entree<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classMatrice__Base.html#a084a2a8bf404b3784192f9802d170f60">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#a2f0b37e4b48ffe198682f22146e1d0bd">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#a429f76393ea7a45fcdde4f04582fb909">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00077">77</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00235">m_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>
<div class="fragment"><pre class="fragment">{
  s &gt;&gt; <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>;
  s &gt;&gt; <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>;
  s &gt;&gt; <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>;
  s &gt;&gt; <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a>;
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <span class="keywordflow">return</span> s;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0b13859051ee9505b3beb82ceb94c116"></a><!-- doxytag: member="Matrice_Morse::remplir" ref="a0b13859051ee9505b3beb82ceb94c116" args="(const int, const int, const int, const int, const Matrice_Morse &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::remplir </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>ideb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jdeb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>mat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Remplissage d'une matrice morse par une matrice morse plus petite. </p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02154">2154</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00346">dimensionner()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00107">nb_coeff()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00559">ordre()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l00726">transpose()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Verification</span>
  assert(ideb&lt;=n);
  assert(jdeb&lt;=m);

<span class="comment">// On va construire une matrice locale</span>
  <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> matrice_locale(mat);
<span class="comment">// Cas ou la matrice locale est symetrique</span>
  <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,mat))
    {
<span class="comment">// Creation de la partie inferieure L</span>
      <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> L(matrice_locale);
      L.transpose(matrice_locale);
      <span class="keywordtype">int</span> lordre = L.ordre();
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;lordre; i++)
        L(i, i) = 0.;
<span class="comment">// On ajoute M=U+L</span>
      matrice_locale += L;
    }

<span class="comment">// Dimensionnement de la matrice globale</span>
  <span class="keywordtype">int</span> nnz=matrice_locale.nb_coeff();
  <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n,m,nnz);

<span class="comment">// Remplissage de la matrice globale par la matrice locale:</span>
<span class="comment">// Remplissage de tab1_ avec le decalage par ideb:</span>
  <span class="keywordtype">int</span> mon_nb_lignes=matrice_locale.nb_lignes();
  assert(mon_nb_lignes+ideb&lt;=n);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ideb; i++)
    <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)=1;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;mon_nb_lignes; i++)
    <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+ideb)=matrice_locale.tab1_(i);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=mon_nb_lignes+ideb; i&lt;n+1; i++)
    <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)=matrice_locale.tab1_(mon_nb_lignes);

<span class="comment">// Remplissage de tab2_ avec le decalage par jdeb:</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nnz; i++)
    <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(i)=matrice_locale.tab2_(i)+jdeb;

<span class="comment">// Remplissage de coeff_:</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nnz; i++)
    <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(i)=matrice_locale.coeff_(i);

  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0477806560509033e4b46b0b65ac6deb"></a><!-- doxytag: member="Matrice_Morse::remplir" ref="a0477806560509033e4b46b0b65ac6deb" args="(const IntLists &amp;, const DoubleLists &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::remplir </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classIntLists.html">IntLists</a> &amp;&#160;</td>
          <td class="paramname"><em>voisins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleLists.html">DoubleLists</a> &amp;&#160;</td>
          <td class="paramname"><em>valeurs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02112">2112</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="ArrOfDouble_8h_source.html#l00379">ArrOfDouble::addr()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00371">ArrOfInt::addr()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Memoire_8cpp_source.html#l00026">compteur</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02216">formeF()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>, <a class="el" href="DoubleList_8h_source.html#l00225">DoubleList_Curseur::valeur()</a>, and <a class="el" href="IntList_8h_source.html#l00225">IntList_Curseur::valeur()</a>.</p>
<div class="fragment"><pre class="fragment">{

  <span class="keywordtype">int</span> num_elem;
  <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>,rang =0;

<span class="comment">// Remplissage des tableaux tab1, tab2 et coeff_ :</span>
  <span class="keywordtype">int</span>* p_tab1 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
  <span class="keywordtype">int</span>* p_tab2 = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
  <span class="keywordtype">double</span>* p_coeff = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();

  <span class="keywordtype">int</span>* tab2_ptr = p_tab2;
  <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();

  <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;n; num_elem++)
    {

      <a class="code" href="classIntList__Curseur.html" title="List_Curseur de reels int precision.">IntList_Curseur</a> liste_vois(voisins[num_elem]);
      <a class="code" href="classDoubleList__Curseur.html" title="List_Curseur de reels double precision.">DoubleList_Curseur</a> liste_val(valeurs[num_elem]);
      compteur =0;
      *p_tab1++ = rang;

      <span class="keywordflow">while</span>  (liste_vois)
        {
          *tab2_ptr++ = liste_vois.valeur();
          *p_coeff++ = liste_val.valeur();
          ++liste_vois;
          ++liste_val;
          compteur++;
        }
<span class="comment">// tab2[rang] = compteur;</span>
      rang += (<a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>);
    }
  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(num_elem)=rang;
  <a class="code" href="classMatrice__Morse.html#a3bcd59ac30cd776ea695a8c8f2d2776d">formeF</a>();
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aedf08423430f9c0b1a9a967d6bb80c9d"></a><!-- doxytag: member="Matrice_Morse::remplir" ref="aedf08423430f9c0b1a9a967d6bb80c9d" args="(const IntLists &amp;, const DoubleLists &amp;, const DoubleVect &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::remplir </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classIntLists.html">IntLists</a> &amp;&#160;</td>
          <td class="paramname"><em>voisins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleLists.html">DoubleLists</a> &amp;&#160;</td>
          <td class="paramname"><em>valeurs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>terme_diag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l02068">2068</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="ArrOfDouble_8h_source.html#l00379">ArrOfDouble::addr()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00371">ArrOfInt::addr()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Memoire_8cpp_source.html#l00026">compteur</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02216">formeF()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00100">Matrice_Base::is_stencil_up_to_date_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>, <a class="el" href="DoubleList_8h_source.html#l00225">DoubleList_Curseur::valeur()</a>, and <a class="el" href="IntList_8h_source.html#l00225">IntList_Curseur::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00283">assembler()</a>, <a class="el" href="Op__Dift__VEF__P1NCP1B__Face_8cpp_source.html#l00159">Op_Dift_VEF_P1NCP1B_Face::calculer_gradient_som()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00324">Matrice_Morse()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00117">Matrice_Morse_Sym::Matrice_Morse_Sym()</a>, <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00716">valeur_P1_H1()</a>, and <a class="el" href="Champ__P1NC__implementation_8cpp_source.html#l00076">valeur_P1_L2()</a>.</p>
<div class="fragment"><pre class="fragment">{

  <span class="keywordtype">int</span> num_elem;
  <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>,rang =0;

<span class="comment">// Remplissage des tableaux tab1, tab2 et coeff_ :</span>
  <span class="keywordtype">int</span>* p_tab1 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
  <span class="keywordtype">int</span>* p_tab2 = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
  <span class="keywordtype">double</span>* p_coeff = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();

  <span class="keywordtype">int</span>* tab2_ptr = p_tab2;
  <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();

  <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;n; num_elem++)
    {

      <a class="code" href="classIntList__Curseur.html" title="List_Curseur de reels int precision.">IntList_Curseur</a> liste_vois(voisins[num_elem]);
      <a class="code" href="classDoubleList__Curseur.html" title="List_Curseur de reels double precision.">DoubleList_Curseur</a> liste_val(valeurs[num_elem]);
      compteur =0;
      *p_tab1++ = rang;

      *tab2_ptr++=num_elem;
      *p_coeff++ = terme_diag[num_elem];

      <span class="keywordflow">while</span>  (liste_vois)
        {
          *tab2_ptr++ = liste_vois.valeur();
          *p_coeff++ = liste_val.valeur();
          ++liste_vois;
          ++liste_val;
          compteur++;
        }
<span class="comment">// tab2[rang] = compteur;</span>
      rang += (compteur + 1);
    }
  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(num_elem)=rang;
  <a class="code" href="classMatrice__Morse.html#a3bcd59ac30cd776ea695a8c8f2d2776d">formeF</a>();
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a31b1e2dbaae22b47a6908ed7e073fc98"></a><!-- doxytag: member="Matrice_Morse::scale" ref="a31b1e2dbaae22b47a6908ed7e073fc98" args="(const double &amp;x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::scale </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classMatrice__Base.html#afef7bebc806bb5efec83a9a579d35db1">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Sym.html#aa4bd6cb0778e4c98d4a75520b4569f5c">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01915">1915</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l01909">operator*=()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> *= x;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a145749c6fa53b79983ed7c65f7b817b6"></a><!-- doxytag: member="Matrice_Morse::self_cast" ref="a145749c6fa53b79983ed7c65f7b817b6" args="(const Objet_U &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp; Matrice_Morse::self_cast </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classObjet__U.html">Objet_U</a> &amp;&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>methode ajoutee pour caster en python </p>

<p>Reimplemented from <a class="el" href="classMatrice__Base.html#ae41a7d8ef3bd660f3c4f70999fea65d7">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#a975acefcfc0b7a210e4c835d91c542c3">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#a7b251d1fdc43efd971f087f0ca76d74d">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00037">37</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa191120d886b432f3a665b84f0b0b2ad"></a><!-- doxytag: member="Matrice_Morse::self_cast" ref="aa191120d886b432f3a665b84f0b0b2ad" args="(Objet_U &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp; Matrice_Morse::self_cast </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classObjet__U.html">Objet_U</a> &amp;&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classMatrice__Base.html#ab7fd1c796919293c5e21f7d5c32b3865">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#ad3b93cfe3a73651f0b402de59f3ab33b">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#adb469a49501fe69e954bc812f6dc9783">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00037">37</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab2fb02a8aba88f717c2285960f375fba"></a><!-- doxytag: member="Matrice_Morse::set_nb_columns" ref="ab2fb02a8aba88f717c2285960f375fba" args="(const int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::set_nb_columns </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>nb_col</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00334">334</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00235">m_</a>.</p>

<p>Referenced by <a class="el" href="Assembleur__P__PolyMAC_8cpp_source.html#l00091">Assembleur_P_PolyMAC::assembler_mat()</a>, <a class="el" href="Assembleur__P__CoviMAC_8cpp_source.html#l00068">Assembleur_P_CoviMAC::assembler_mat()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02202">Equation_base::dimensionner_matrice()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02227">Equation_base::dimensionner_matrice_sans_mem()</a>, <a class="el" href="Matrix__tools_8cpp_source.html#l00660">Matrix_tools::extend_matrix()</a>, <a class="el" href="Testeur_8cpp_source.html#l00046">Testeur::interpreter()</a>, <a class="el" href="Solveur__U__P_8cpp_source.html#l00061">Solveur_U_P::iterer_NS()</a>, and <a class="el" href="Solv__GCP_8cpp_source.html#l00124">Solv_GCP::prepare_data()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a> = nb_col;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae99753a8725a9a7f58b62d6e675a69d8"></a><!-- doxytag: member="Matrice_Morse::set_symmetric" ref="ae99753a8725a9a7f58b62d6e675a69d8" args="(const int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::set_symmetric </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>symmetric</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00339">339</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00236">symetrique_</a>.</p>

<p>Referenced by <a class="el" href="Matrix__tools_8cpp_source.html#l00192">Matrix_tools::allocate_symmetric_morse_matrix()</a>, and <a class="el" href="Matrix__tools_8cpp_source.html#l00228">Matrix_tools::build_symmetric_morse_matrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a> = symmetric ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4c1dd5b6b3f42e1c5360711353089b78"></a><!-- doxytag: member="Matrice_Morse::taille_memoire" ref="a4c1dd5b6b3f42e1c5360711353089b78" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned Matrice_Morse::taille_memoire </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classObjet__U.html#a0ee0946339f09a2c73c09fcda71c3be2">Objet_U</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#acaf299001123ed1564a8c594dbfe0ede">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#a1f5b604e5f50426bed012a2831c3cc6c">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00037">37</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9859a88c59daf0b968b3c5090e18f264"></a><!-- doxytag: member="Matrice_Morse::transpose" ref="a9859a88c59daf0b968b3c5090e18f264" args="(const Matrice_Morse &amp;a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp; Matrice_Morse::transpose </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>*this = a transposee. </p>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00726">726</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00228">morse_matrix_structure_has_changed_</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Zone__VEF__PreP1b_8cpp_source.html#l00204">next()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00231">tab1_</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00232">tab2_</a>.</p>

<p>Referenced by <a class="el" href="ILU_8cpp_source.html#l00056">MorseSymToMorse()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02154">remplir()</a>, and <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00988">Matrice_Morse_Sym::renumerote()</a>.</p>
<div class="fragment"><pre class="fragment">{

  <span class="keywordtype">int</span> n=a.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordtype">int</span> jk=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordtype">int</span> job=1;
  <span class="keywordtype">int</span> ipos=1;
  <span class="keywordtype">int</span> m=a.<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();
  <span class="keywordtype">int</span> l=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordflow">if</span>(m!=jk)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::transpose bad dimensions&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
    }
  m=a.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  l=<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();
  <span class="keywordflow">if</span>(m!=l)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::transpose bad dimensions&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
    }

  {
    <span class="keywordtype">int</span> i, j, k , <a class="code" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a>;

<span class="comment">// F77NAME(CSRCSC)(&amp;n,&amp;o,&amp;k,&amp;k,a.coeff_,a.tab2_,a.tab1_,coeff_.addr(),tab2_.addr(),tab1_.addr());</span>
<span class="comment">// subroutine csrcsc (n,jk,job,ipos,a,ja,ia,ao,jao,iao)</span>
<span class="comment">// integer ia(n+1),iao(n+1),ja(*),jao(*)</span>
<span class="comment">// real*8  a(*),ao(*)</span>
<span class="comment">// c-----------------------------------------------------------------------</span>
<span class="comment">// c Compressed Sparse Row     to      Compressed Sparse Column</span>
<span class="comment">// c</span>
<span class="comment">// c on entry:</span>
<span class="comment">// c----------</span>
<span class="comment">// c n        = dimension of A.</span>
<span class="comment">// c jk     = dimensoin of Ao</span>
<span class="comment">// c job        = integer to indicate whether to fill the values (job.eq.1) of the</span>
<span class="comment">// c         matrix ao or only the pattern., i.e.,ia, and ja (job .ne.1)</span>
<span class="comment">// c</span>
<span class="comment">// c ipos  = starting position in ao, jao of the transposed matrix.</span>
<span class="comment">// c         the iao array takes this into account (thus iao(1) is set to ipos.)</span>
<span class="comment">// c         Note: this may be useful if one needs to append the data structure</span>
<span class="comment">// c         of the transpose to that of A. In this case use for example</span>
<span class="comment">// c                call csrcsc (n,1,n+2,a,ja,ia,a,ja,ia(n+2))</span>
<span class="comment">// c          for any other normal usage, enter ipos=1.</span>
<span class="comment">// c a        = real array of length nnz (nnz=number of nonzero elements in input</span>
<span class="comment">// c         matrix) containing the nonzero elements.</span>
<span class="comment">// c ja        = integer array of length nnz containing the column positions</span>
<span class="comment">// c           of the corresponding elements in a.</span>
<span class="comment">// c ia        = integer of size n+1. ia(k) contains the position in a, ja of</span>
<span class="comment">// c          the beginning of the k-th row.</span>
<span class="comment">// c</span>
<span class="comment">// c on return:</span>
<span class="comment">// c ----------</span>
<span class="comment">// c output arguments:</span>
<span class="comment">// c ao        = real array of size nzz containing the &quot;a&quot; part of the transpose</span>
<span class="comment">// c jao        = integer array of size nnz containing the column indices.</span>
<span class="comment">// c iao        = integer array of size n+1 containing the &quot;ia&quot; index array of</span>
<span class="comment">// c          the transpose.</span>
<span class="comment">// c</span>
<span class="comment">// c-----------------------------------------------------------------------</span>
<span class="comment">// c----------------- compute lengths of rows of transp(A) ----------------</span>
<span class="comment">// do 1 i=1,jk+1</span>
<span class="comment">// iao(i) = 0</span>
<span class="comment">// 1    continue</span>

    <span class="keywordflow">for</span> (i=0; i&lt;=jk; i++ ) <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] = 0 ;

<span class="comment">// do 3 i=1, n</span>
<span class="comment">// do 2 k=ia(i), ia(i+1)-1</span>
<span class="comment">// j = ja(k)+1</span>
<span class="comment">// iao(j) = iao(j)+1</span>
<span class="comment">// 2       continue</span>
<span class="comment">// 3    continue</span>

    <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
      {
        <span class="keywordflow">for</span>(k=a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1; k&lt;a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1]-1; k++)
          {
            j = a.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] ;
            <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j] = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j] +1 ;
          }
      }

<span class="comment">// c---------- compute pointers from lengths ------------------------------</span>
<span class="comment">// iao(1) = ipos</span>
<span class="comment">// do 4 i=1,jk</span>
<span class="comment">// iao(i+1) = iao(i) + iao(i+1)</span>
<span class="comment">// 4    continue</span>

    <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[0] = ipos ;
    <span class="keywordflow">for</span>(i=0; i&lt;jk; i++) <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1] = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] + <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1] ;

<span class="comment">// c--------------- now do the actual copying -----------------------------</span>
<span class="comment">// do 6 i=1,n</span>
<span class="comment">// do 62 k=ia(i),ia(i+1)-1</span>
<span class="comment">// j = ja(k)</span>
<span class="comment">// next = iao(j)</span>
<span class="comment">// if (job .eq. 1)  ao(next) = a(k)</span>
<span class="comment">// jao(next) = i</span>
<span class="comment">// iao(j) = next+1</span>
<span class="comment">// 62      continue</span>
<span class="comment">// 6    continue</span>

    <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
      {
        <span class="keywordflow">for</span>(k=a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1; k&lt;a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1]-1; k++)
          {
            j    = a.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k]-1 ;
            next = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j] ;
            <span class="keywordflow">if</span> (job == 1)  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[next-1] = a.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[k] ;
            <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[next-1] = i+1 ;
            <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j]    = next+1 ;
          }
      }

<span class="comment">// c-------------------------- reshift iao and leave ----------------------</span>
<span class="comment">// do 7 i=jk,1,-1</span>
<span class="comment">// iao(i+1) = iao(i)</span>
<span class="comment">// 7    continue</span>
<span class="comment">// iao(1) = ipos</span>

    <span class="keywordflow">for</span>(i=jk-1; i&gt;=0; i--)  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1] = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] ;
    <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[0] = ipos ;

<span class="comment">// c--------------- end of csrcsc -----------------------------------------</span>
<span class="comment">// c-----------------------------------------------------------------------</span>
<span class="comment">// end</span>
<span class="comment">// c-----------------------------------------------------------------------</span>
  }
  <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="afc6dc20707960db1921c7e1ca90966a8"></a><!-- doxytag: member="Matrice_Morse::unite" ref="afc6dc20707960db1921c7e1ca90966a8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Matrice_Morse::unite </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l00535">535</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>

<p>References <a class="el" href="Matrice__Morse_8h_source.html#l00233">coeff_</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l00559">ordre()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> = 0.0;
  <span class="keywordtype">int</span> i,n  = <a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>();
  <span class="keywordflow">for</span> (i=0; i&lt;n; i++)
    <span class="keyword">operator</span>()(i,i) = 1.0;
}
</pre></div>
</div>
</div>
<hr/><h2>Friends And Related Function Documentation</h2>
<a class="anchor" id="afc77ba81a0a4335b418508f9bae4941c"></a><!-- doxytag: member="Matrice_Morse::operator*" ref="afc77ba81a0a4335b418508f9bae4941c" args="(double, const Matrice_Morse &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> operator* </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fonction (hors classe) amie de la classe <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a><br/>
Scaling de la matrice par un scalaire: multiplie tous<br/>
les elements de la matrice par un scalaire.<br/>
Operation: renvoie x*A. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a><br/>
 Signification: le resultat de l'operation<br/>
 Contraintes: la matrice resultat est allouee par la fonction </dd></dl>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01831">1831</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> mat_res(A);
  mat_res.coeff_*=x;
  <span class="keywordflow">return</span>(mat_res);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9b2be70ec114aadae982e55d2c748db9"></a><!-- doxytag: member="Matrice_Morse::operator+" ref="a9b2be70ec114aadae982e55d2c748db9" args="(const Matrice_Morse &amp;, const Matrice_Morse &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> operator+ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fonction (hors classe) amie de la classe <a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a><br/>
Addition de 2 matrices au format Morse.<br/>
Operation: renvoie (A+B) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a><br/>
 Signification: le resultat de l'operation<br/>
 Contraintes: la matrice resultat est allouee par la fonction </dd></dl>

<p>Definition at line <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">1117</a> of file <a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> nrow=A.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
  <span class="keywordtype">int</span> ncol=A.<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();
  <span class="keywordtype">int</span> job=1;
  <span class="keywordtype">int</span> ierr;
  <a class="code" href="classIntVect.html">IntVect</a> iw(ncol);
  <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> C;
<span class="comment">// PL: avant de dimensionner a nzmax on verifie si A et B n&#39;ont pas la meme structure par hasard...</span>
<span class="comment">// Cela evite un pic memoire provoque par l&#39;addition de matrices dans Equation_base::dimensionner_matrice</span>
<span class="comment">// Sinon, APLB n&#39;est pas optimal, voir une autre implementation genre MKL:</span>
<span class="comment">// https://software.intel.com/en-us/mkl-developer-reference-c-mkl-sparse-add</span>
  <span class="keywordtype">int</span> nzmax = A.<a class="code" href="classMatrice__Morse.html#a11eec428fe6de8eeba3113b682dd38f1">has_same_morse_matrix_structure</a>(B) ? A.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>() : A.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>()+B.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>();
  C.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nrow, ncol, nzmax);
  <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(APLB) (&amp;nrow, &amp;ncol, &amp;job, A.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>().<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), A.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), A.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
                 B.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>().<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), B.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), B.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), C.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>().<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
                 C.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), C.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
                 &amp;nzmax,iw.addr(),&amp;ierr);

  <span class="keyword">const</span> <span class="keywordtype">int</span> nnz = C.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[nrow] - 1;
  C.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>().<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( nnz );
  C.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>().<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( nnz );
  C.<a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
  <span class="keywordflow">return</span>(C);
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a780a72cd0f2c3b8b19bfa6d3201efb2e"></a><!-- doxytag: member="Matrice_Morse::coeff_" ref="a780a72cd0f2c3b8b19bfa6d3201efb2e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a> <a class="el" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">Matrice_Morse::coeff_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00233">233</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l01616">affecte_prod()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00229">Matrice_Morse_Sym::ajouter_multTab_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01009">ajouter_multTab_()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00335">Matrice_Morse_Sym::ajouter_multvect_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00936">ajouter_multvect_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01062">ajouter_multvectT_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02300">check_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02356">check_sorted_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02265">clean()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00928">Matrice_Morse_Sym::compacte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00573">compacte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02455">construire_sous_bloc()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00864">diagmulmat()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00368">dimensionner()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00142">get_coeff()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00129">get_set_coeff()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01968">get_stencil_and_coefficients()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00748">Matrice_Morse_Sym::get_symmetric_stencil_and_coefficients()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00087">imprimer()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00109">imprimer_formatte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00171">imprimer_image()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01184">inverse()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00107">nb_coeff()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00245">operator()()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01831">operator*()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01585">operator*=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01873">operator+=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02062">operator/=()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00161">Matrice_Morse_Sym::operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00701">operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00887">partie_sup()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00054">printOn()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00077">readOn()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02068">remplir()</a>, <a class="el" href="Precond__local_8cpp_source.html#l00183">Precond_local::res_syst_loc_hybride()</a>, <a class="el" href="Precond__local_8cpp_source.html#l00129">Precond_local::res_syst_loc_simple()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00676">Matrice_Morse_Sym::scale()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01915">scale()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00726">transpose()</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l00535">unite()</a>.</p>

</div>
</div>
<a class="anchor" id="a07f45a5fa9c163729cc79d0a480db940"></a><!-- doxytag: member="Matrice_Morse::info_obj" ref="a07f45a5fa9c163729cc79d0a480db940" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a> <a class="el" href="classMatrice__Morse.html#a07f45a5fa9c163729cc79d0a480db940">Matrice_Morse::info_obj</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classMatrice__Base.html#a93072d640873fe93a82f0ef420e807ca">Matrice_Base</a>.</p>

<p>Reimplemented in <a class="el" href="classMatrice__Morse__Diag.html#ae2aa26e454aff14d27def535fb42176d">Matrice_Morse_Diag</a>, and <a class="el" href="classMatrice__Morse__Sym.html#a253c7124fcc932531bcc63ce811e946d">Matrice_Morse_Sym</a>.</p>

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00062">62</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

</div>
</div>
<a class="anchor" id="a44dbdb39389f6f17711f5072ce9cf2e0"></a><!-- doxytag: member="Matrice_Morse::m_" ref="a44dbdb39389f6f17711f5072ce9cf2e0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0">Matrice_Morse::m_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of columns. </p>

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00235">235</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00335">Matrice_Morse_Sym::ajouter_multvect_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00368">dimensionner()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00266">Matrice_Morse_Sym::multvect_et_prodscal()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00103">nb_colonnes()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00161">Matrice_Morse_Sym::operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00701">operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00054">printOn()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00077">readOn()</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l00334">set_nb_columns()</a>.</p>

</div>
</div>
<a class="anchor" id="a1a9134b16e927cd79db6e6d75a15a312"></a><!-- doxytag: member="Matrice_Morse::morse_matrix_structure_has_changed_" ref="a1a9134b16e927cd79db6e6d75a15a312" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">Matrice_Morse::morse_matrix_structure_has_changed_</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Flag if matrix structure changes. </p>

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00228">228</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l01616">affecte_prod()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02422">assert_check_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02437">assert_check_sorted_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l01159">Matrice_Morse_Sym::assert_check_sorted_symmetric_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l01144">Matrice_Morse_Sym::assert_check_symmetric_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00928">Matrice_Morse_Sym::compacte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00573">compacte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00368">dimensionner()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02202">formeC()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02216">formeF()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00239">Matrice_Morse()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00117">Matrice_Morse_Sym::Matrice_Morse_Sym()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00621">operator*()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01873">operator+=()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00161">Matrice_Morse_Sym::operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00701">operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00887">partie_sup()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00077">readOn()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02068">remplir()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00988">Matrice_Morse_Sym::renumerote()</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l00726">transpose()</a>.</p>

</div>
</div>
<a class="anchor" id="aa18902f5bb7084749524e6625ad35816"></a><!-- doxytag: member="Matrice_Morse::symetrique_" ref="aa18902f5bb7084749524e6625ad35816" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816">Matrice_Morse::symetrique_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pour inliner operator()(i,j) afin d'optimiser. </p>

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00236">236</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8h_source.html#l00114">get_symmetric()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00280">Matrice_Morse()</a>, <a class="el" href="Matrice__Morse__Diag_8h_source.html#l00050">Matrice_Morse_Diag::Matrice_Morse_Diag()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00117">Matrice_Morse_Sym::Matrice_Morse_Sym()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00245">operator()()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00161">Matrice_Morse_Sym::operator=()</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l00339">set_symmetric()</a>.</p>

</div>
</div>
<a class="anchor" id="a906ba051649671139d2d5f6565c417d5"></a><!-- doxytag: member="Matrice_Morse::tab1_" ref="a906ba051649671139d2d5f6565c417d5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntVect.html">IntVect</a> <a class="el" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">Matrice_Morse::tab1_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00231">231</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l01616">affecte_prod()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00229">Matrice_Morse_Sym::ajouter_multTab_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01009">ajouter_multTab_()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00335">Matrice_Morse_Sym::ajouter_multvect_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00936">ajouter_multvect_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01062">ajouter_multvectT_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02300">check_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02356">check_sorted_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l01117">Matrice_Morse_Sym::check_sorted_symmetric_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l01090">Matrice_Morse_Sym::check_symmetric_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00928">Matrice_Morse_Sym::compacte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00573">compacte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02455">construire_sous_bloc()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00864">diagmulmat()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00368">dimensionner()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02202">formeC()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02216">formeF()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00119">get_set_tab1()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01920">get_stencil()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01968">get_stencil_and_coefficients()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00693">Matrice_Morse_Sym::get_symmetric_stencil()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00748">Matrice_Morse_Sym::get_symmetric_stencil_and_coefficients()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00134">get_tab1()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01143">has_same_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00087">imprimer()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00109">imprimer_formatte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00171">imprimer_image()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01184">inverse()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">nb_lignes()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00245">operator()()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01585">operator*=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01117">operator+()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00161">Matrice_Morse_Sym::operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00701">operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00887">partie_sup()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00054">printOn()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00077">readOn()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02068">remplir()</a>, <a class="el" href="Precond__local_8cpp_source.html#l00183">Precond_local::res_syst_loc_hybride()</a>, <a class="el" href="Precond__local_8cpp_source.html#l00129">Precond_local::res_syst_loc_simple()</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l00726">transpose()</a>.</p>

</div>
</div>
<a class="anchor" id="a5f6e112296154936cc1ec98fd5cd1667"></a><!-- doxytag: member="Matrice_Morse::tab2_" ref="a5f6e112296154936cc1ec98fd5cd1667" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntVect.html">IntVect</a> <a class="el" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">Matrice_Morse::tab2_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00232">232</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l01616">affecte_prod()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00229">Matrice_Morse_Sym::ajouter_multTab_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01009">ajouter_multTab_()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00335">Matrice_Morse_Sym::ajouter_multvect_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00936">ajouter_multvect_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01062">ajouter_multvectT_()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02300">check_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02356">check_sorted_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l01117">Matrice_Morse_Sym::check_sorted_symmetric_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l01090">Matrice_Morse_Sym::check_symmetric_morse_matrix_structure()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00928">Matrice_Morse_Sym::compacte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00573">compacte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02455">construire_sous_bloc()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00864">diagmulmat()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00368">dimensionner()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02202">formeC()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02216">formeF()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00124">get_set_tab2()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01920">get_stencil()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01968">get_stencil_and_coefficients()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00693">Matrice_Morse_Sym::get_symmetric_stencil()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00748">Matrice_Morse_Sym::get_symmetric_stencil_and_coefficients()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00138">get_tab2()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00087">imprimer()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00109">imprimer_formatte()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00171">imprimer_image()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l01184">inverse()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00245">operator()()</a>, <a class="el" href="Matrice__Morse__Sym_8cpp_source.html#l00161">Matrice_Morse_Sym::operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00701">operator=()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00887">partie_sup()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00054">printOn()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00077">readOn()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l02068">remplir()</a>, <a class="el" href="Precond__local_8cpp_source.html#l00183">Precond_local::res_syst_loc_hybride()</a>, <a class="el" href="Precond__local_8cpp_source.html#l00129">Precond_local::res_syst_loc_simple()</a>, and <a class="el" href="Matrice__Morse_8cpp_source.html#l00726">transpose()</a>.</p>

</div>
</div>
<a class="anchor" id="a8e9254acaa95bbcb76a8ff1772b9b572"></a><!-- doxytag: member="Matrice_Morse::zero_" ref="a8e9254acaa95bbcb76a8ff1772b9b572" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classMatrice__Morse.html#a8e9254acaa95bbcb76a8ff1772b9b572">Matrice_Morse::zero_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Matrice__Morse_8h_source.html#l00240">240</a> of file <a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a>.</p>

<p>Referenced by <a class="el" href="Matrice__Morse_8cpp_source.html#l00280">Matrice_Morse()</a>, and <a class="el" href="Matrice__Morse_8h_source.html#l00259">operator()()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/Kernel/Math/Matrices/<a class="el" href="Matrice__Morse_8h_source.html">Matrice_Morse.h</a></li>
<li>src/Kernel/Math/Matrices/<a class="el" href="Matrice__Morse_8cpp_source.html">Matrice_Morse.cpp</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:37:04 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
