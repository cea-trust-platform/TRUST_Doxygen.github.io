<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/P1NCP1B/Zones/Zone_VEF_PreP1b.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/P1NCP1B/Zones/Zone_VEF_PreP1b.cpp</div>  </div>
</div>
<div class="contents">
<a href="Zone__VEF__PreP1b_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2020, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Zone_VEF_PreP1b.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/P1NCP1B/Zones</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/31</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VEF__PreP1b_8h.html">Zone_VEF_PreP1b.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Scatter_8h.html">Scatter.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="IntLists_8h.html">IntLists.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Conds__lim_8h.html">Conds_lim.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Periodique_8h.html">Periodique.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="EcrFicPartageBin_8h.html">EcrFicPartageBin.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="EFichierBin_8h.html">EFichierBin.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="MD__Vector__tools_8h.html">MD_Vector_tools.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="ArrOfBit_8h.html">ArrOfBit.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Connectivite__som__elem_8h.html">Connectivite_som_elem.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="Static__Int__Lists_8h.html">Static_Int_Lists.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="MD__Vector__composite_8h.html">MD_Vector_composite.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="Check__espace__virtuel_8h.html">Check_espace_virtuel.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="VEFPreP1B_8h.html">VEFPreP1B.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="communications_8h.html">communications.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="Octree__Double_8h.html">Octree_Double.h</a>&gt;</span>
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="Zone__VEF__PreP1b_8cpp.html#a008a266c0ffaf46189aceaebfde6c6de">00042</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>,<span class="stringliteral">&quot;Zone_VEFPreP1b&quot;</span>,<a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>);
<a name="l00043"></a>00043 
<a name="l00044"></a><a class="code" href="classZone__VEF__PreP1b.html#a79dbed9db02e6c0d99929c2e8b04a984">00044</a> <a class="code" href="classZone__VEF__PreP1b.html#a79dbed9db02e6c0d99929c2e8b04a984">Zone_VEF_PreP1b::Zone_VEF_PreP1b</a>():P1Bulle(-1), alphaE(-1), alphaS(-1), alphaA(-1), modif_div_face_dirichlet(-1),cl_pression_sommet_faible(-1) {}
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="comment">// printOn et readOn</span>
<a name="l00047"></a><a class="code" href="classZone__VEF__PreP1b.html#a5aea3ac07967ad4c52a51f618146055d">00047</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classZone__VEF__PreP1b.html#a5aea3ac07967ad4c52a51f618146055d" title="Surcharge Objet_U::printOn(Sortie&amp;) NE FAIT RIEN A surcharger dans les classes derivees. Imprime la zone discretisee sur un flot de sortie.">Zone_VEF_PreP1b::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00048"></a>00048 <span class="keyword"></span>{
<a name="l00049"></a>00049   <span class="keywordflow">return</span> <a class="code" href="classZone__VEF__PreP1b.html#a5aea3ac07967ad4c52a51f618146055d" title="Surcharge Objet_U::printOn(Sortie&amp;) NE FAIT RIEN A surcharger dans les classes derivees. Imprime la zone discretisee sur un flot de sortie.">Zone_VEF::printOn</a>(s);
<a name="l00050"></a>00050 }
<a name="l00051"></a>00051 
<a name="l00052"></a><a class="code" href="classZone__VEF__PreP1b.html#a5a5dd96ae1f052be05700b3897ea87eb">00052</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classZone__VEF__PreP1b.html#a5a5dd96ae1f052be05700b3897ea87eb" title="Surcharge Objet_U::readOn(Sortie&amp;) NE FAIT RIEN A surcharger dans les classes derivees. Lit une zone discretisee a partir d&#39;un flot d&#39;entree.">Zone_VEF_PreP1b::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is )
<a name="l00053"></a>00053 {
<a name="l00054"></a>00054   <span class="keywordflow">return</span> <a class="code" href="classZone__VEF__PreP1b.html#a5a5dd96ae1f052be05700b3897ea87eb" title="Surcharge Objet_U::readOn(Sortie&amp;) NE FAIT RIEN A surcharger dans les classes derivees. Lit une zone discretisee a partir d&#39;un flot d&#39;entree.">Zone_VEF::readOn</a>(is);
<a name="l00055"></a>00055 }
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">//</span>
<a name="l00058"></a>00058 <span class="comment">//</span>
<a name="l00059"></a>00059 <span class="comment">//</span><span class="comment"></span>
<a name="l00060"></a>00060 <span class="comment">//! Les volumes calcules dans discretiser() ne tiennent pas compte de&lt;br&gt;la periodicite. Pour les sommets periodiques, on fait la somme&lt;br&gt;de tous les volumes des sommets &quot;identiques&quot; au sens de la periodicite.</span>
<a name="l00061"></a><a class="code" href="classZone__VEF__PreP1b.html#a1df89521d0415c4b8efe6d71fe1adac9">00061</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classZone__VEF__PreP1b.html#a1df89521d0415c4b8efe6d71fe1adac9" title="Les volumes calcules dans discretiser() ne tiennent pas compte de la periodicite. Pour les sommets pe...">Zone_VEF_PreP1b::discretiser</a>()
<a name="l00062"></a>00062 {
<a name="l00063"></a>00063   <a class="code" href="classZone__VEF__PreP1b.html#a1df89521d0415c4b8efe6d71fe1adac9" title="Les volumes calcules dans discretiser() ne tiennent pas compte de la periodicite. Pour les sommets pe...">Zone_VEF::discretiser</a>();
<a name="l00064"></a>00064 
<a name="l00065"></a>00065   <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a32c7de9f9e8e78e3d5ea68715b2ceb2b" title="Cree un tableau ayant une &quot;ligne&quot; par sommet du maillage. Voir MD_Vector_tools::creer_tableau_distrib...">creer_tableau_sommets</a>(<a class="code" href="classZone__VEF__PreP1b.html#ad34fbb4e40f1eef424d47437dd857d90">volumes_som</a>, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>);
<a name="l00066"></a>00066 
<a name="l00067"></a>00067   <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>=1./3.;
<a name="l00068"></a>00068   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)
<a name="l00069"></a>00069     coeff=1./4.;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elements = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00072"></a>00072   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_elem = elements.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00073"></a>00073 <span class="comment">// Boucle sur tous les elements car on ajoute des contributions aux sommets de joints:</span>
<a name="l00074"></a>00074   <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
<a name="l00075"></a>00075 <span class="comment">// On a besoin de l&#39;espace virtuel des volumes</span>
<a name="l00076"></a>00076   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volume_elem = <a class="code" href="classZone__VF.html#a9598b08cb9126f88cfafe72fc0eeca70" title="renvoie le tableaux des volumes des mailles.">volumes</a>();
<a name="l00077"></a>00077   <a class="code" href="Check__espace__virtuel_8cpp.html#a2ea8fcf12c28d0454bdc4126f8c4b186" title="en mode comm_check_enabled(), verifie si l&#39;espace virtuel du vecteur est a jour, si ce n&#39;est pas le c...">assert_espace_virtuel_vect</a>(volume_elem);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="comment">// Annule tout le tableau car on va faire += sur des items virtuels</span>
<a name="l00080"></a>00080 <span class="comment">// (sinon acces a des cases non initialisees)</span>
<a name="l00081"></a>00081   <a class="code" href="DoubleVect_8cpp.html#ad0e13908fed9f476adc797982dce010a">operator_egal</a>(<a class="code" href="classZone__VEF__PreP1b.html#ad34fbb4e40f1eef424d47437dd857d90">volumes_som</a>, 0., <a class="code" href="MD__Vector_8h.html#a3616a15fe105ad6150819554ee8b11caad18680091a9f62247573cb3caa6450b9">VECT_ALL_ITEMS</a>);
<a name="l00082"></a>00082   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;n; k++)
<a name="l00083"></a>00083     {
<a name="l00084"></a>00084       <span class="keywordtype">double</span> volume = coeff * volume_elem(k);
<a name="l00085"></a>00085       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;nb_som_elem; isom++)
<a name="l00086"></a>00086         {
<a name="l00087"></a>00087           <span class="keywordtype">int</span> som = elements(k, isom);
<a name="l00088"></a>00088           <a class="code" href="classZone__VEF__PreP1b.html#ad34fbb4e40f1eef424d47437dd857d90">volumes_som</a>(som)+=volume;
<a name="l00089"></a>00089         }
<a name="l00090"></a>00090     }
<a name="l00091"></a>00091   <a class="code" href="classZone__VEF__PreP1b.html#ad34fbb4e40f1eef424d47437dd857d90">volumes_som</a>.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00092"></a>00092 }
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="classZone__VEF__PreP1b.html#af174402f6f725935147ef578ff989493">00094</a> <span class="keywordtype">void</span> <a class="code" href="classZone__VEF__PreP1b.html#af174402f6f725935147ef578ff989493">Zone_VEF_PreP1b::discretiser_suite</a>(<span class="keyword">const</span> <a class="code" href="classVEFPreP1B.html">VEFPreP1B</a>&amp; discr)
<a name="l00095"></a>00095 {
<a name="l00096"></a>00096 <span class="comment">// Recuperation des parametres de la discretisation</span>
<a name="l00097"></a>00097   <a class="code" href="classZone__VEF__PreP1b.html#a3ccf7fa962fe9207955f3633761e5da5">alphaE</a> = discr.<a class="code" href="classVEFPreP1B.html#a103663f9d5aff7d5d443febaa48ba58d">get_alphaE</a>();
<a name="l00098"></a>00098   <a class="code" href="classZone__VEF__PreP1b.html#a605c6780a1af6677064315471996c17f">alphaS</a> = discr.<a class="code" href="classVEFPreP1B.html#a47d54a7ec1f84322cea14400c7ae07d4">get_alphaS</a>();
<a name="l00099"></a>00099   <a class="code" href="classZone__VEF__PreP1b.html#a46a6201d24bfe5df510983735e16e516">alphaA</a> = discr.<a class="code" href="classVEFPreP1B.html#a74160b0767ec3f998e08dcfc41361b26">get_alphaA</a>();
<a name="l00100"></a>00100   <a class="code" href="classZone__VEF__PreP1b.html#ae42fc601eedd85d07c3248f8345981cc">P1Bulle</a> = discr.<a class="code" href="classVEFPreP1B.html#a466a27dfb17bdb25f1282fdeb619ef38">get_P1Bulle</a>();
<a name="l00101"></a>00101   <a class="code" href="classZone__VEF__PreP1b.html#a4d48f0f982b2a7092583d2c8d9170d1a">modif_div_face_dirichlet</a>= discr.<a class="code" href="classVEFPreP1B.html#ab7cf983ed4dee938cb44a023d18a2053">get_modif_div_face_dirichlet</a>();
<a name="l00102"></a>00102   <a class="code" href="classZone__VEF__PreP1b.html#a22b35b7340ed300a42b99d8da4216f2b" title="determine si les cl de pression sont imposees de facon faible ou forte -&gt; voir divergence et assemble...">cl_pression_sommet_faible</a> = discr.<a class="code" href="classVEFPreP1B.html#a3287919c3b2d7ee19ef71e0a095b7ffc">get_cl_pression_sommet_faible</a>();
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <span class="keywordflow">if</span> (<a class="code" href="classZone__VEF__PreP1b.html#a46a6201d24bfe5df510983735e16e516">alphaA</a>)
<a name="l00106"></a>00106     <a class="code" href="classZone__VEF__PreP1b.html#ab7d9680fc94e8abfefc0fe86ff608cd0">discretiser_arete</a>();
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 <span class="comment">// Construction du descripteur pour les tableaux p1bulle</span>
<a name="l00109"></a>00109   {
<a name="l00110"></a>00110     <a class="code" href="classMD__Vector__composite.html" title="Metadata for a distributed composite vector. This class describes a vector that contains one or more ...">MD_Vector_composite</a> md_p1b;
<a name="l00111"></a>00111     <span class="keywordflow">if</span> (<a class="code" href="classZone__VEF__PreP1b.html#a3ccf7fa962fe9207955f3633761e5da5">alphaE</a>)
<a name="l00112"></a>00112       {
<a name="l00113"></a>00113         <span class="keyword">const</span> <a class="code" href="classMD__Vector.html" title=": Cette classe est un DERIV mais l&#39;objet pointe est partage entre plusieurs instances de cette classe...">MD_Vector</a>&amp; md = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ab4c6e0d58001c0cc98d4f06e98086544" title="renvoie le descripteur parallele des tableaux aux elements de la zone">md_vector_elements</a>();
<a name="l00114"></a>00114         md_p1b.<a class="code" href="classMD__Vector__composite.html#aef7b99d29af74b1eea8b7b414614e63f" title="Append the &quot;part&quot; descriptor to the composite vector. By default, shape=0 says that for each item in ...">add_part</a>(md);
<a name="l00115"></a>00115       }
<a name="l00116"></a>00116     <span class="keywordflow">if</span> (<a class="code" href="classZone__VEF__PreP1b.html#a605c6780a1af6677064315471996c17f">alphaS</a>)
<a name="l00117"></a>00117       {
<a name="l00118"></a>00118         <span class="keyword">const</span> <a class="code" href="classMD__Vector.html" title=": Cette classe est un DERIV mais l&#39;objet pointe est partage entre plusieurs instances de cette classe...">MD_Vector</a>&amp; md = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a94843a61bbc3e432cf87ef40c440fb80">md_vector_sommets</a>();
<a name="l00119"></a>00119         md_p1b.<a class="code" href="classMD__Vector__composite.html#aef7b99d29af74b1eea8b7b414614e63f" title="Append the &quot;part&quot; descriptor to the composite vector. By default, shape=0 says that for each item in ...">add_part</a>(md);
<a name="l00120"></a>00120       }
<a name="l00121"></a>00121     <span class="keywordflow">if</span> (<a class="code" href="classZone__VEF__PreP1b.html#a46a6201d24bfe5df510983735e16e516">alphaA</a>)
<a name="l00122"></a>00122       {
<a name="l00123"></a>00123         <span class="keyword">const</span> <a class="code" href="classMD__Vector.html" title=": Cette classe est un DERIV mais l&#39;objet pointe est partage entre plusieurs instances de cette classe...">MD_Vector</a>&amp; md = <a class="code" href="classZone__VF.html#a93f73d93187a780a1b927be5b3d5c2a2">md_vector_aretes</a>();
<a name="l00124"></a>00124         md_p1b.<a class="code" href="classMD__Vector__composite.html#aef7b99d29af74b1eea8b7b414614e63f" title="Append the &quot;part&quot; descriptor to the composite vector. By default, shape=0 says that for each item in ...">add_part</a>(md);
<a name="l00125"></a>00125       }
<a name="l00126"></a>00126     <a class="code" href="classZone__VEF__PreP1b.html#a77e67f31cfb088e064ca0e1135dc5dbd">md_vector_p1b_</a>.<a class="code" href="classMD__Vector.html#a063644dd8ca62e707a2d059eedeb58a7" title="construction d&#39;un objet MD_Vector par copie d&#39;un objet existant. C&#39;est la methode recommandee pour cr...">copy</a>(md_p1b);
<a name="l00127"></a>00127   }
<a name="l00128"></a>00128   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;La Zone_VEF_PreP1b a ete remplie avec succes&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00129"></a>00129 }
<a name="l00130"></a>00130 
<a name="l00131"></a><a class="code" href="classZone__VEF__PreP1b.html#ab7d9680fc94e8abfefc0fe86ff608cd0">00131</a> <span class="keywordtype">void</span> <a class="code" href="classZone__VEF__PreP1b.html#ab7d9680fc94e8abfefc0fe86ff608cd0">Zone_VEF_PreP1b::discretiser_arete</a>()
<a name="l00132"></a>00132 {
<a name="l00133"></a>00133   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00134"></a>00134 
<a name="l00135"></a>00135 <span class="comment">// Creation des aretes reelles (informations geometriques construites et stockees dans la zone)</span>
<a name="l00136"></a>00136   <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#af27e3cb93ea77b05069e6016f981e227">creer_aretes</a>();
<a name="l00137"></a>00137   <a class="code" href="classZone__VF.html#ae1b492b7e2ca6a4c22ec6f31996494a3">md_vector_aretes_</a> = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#affa60690e1b372fa4c01d6088267dbe4" title="renvoie le tableau de connectivite aretes/sommets.">aretes_som</a>().<a class="code" href="classIntVect.html#ae74e1fee6aca124d32718267e33a40c6">get_md_vector</a>();
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="comment">// Calcul des centres de gravite des aretes xa_ stockes dans la Zone_VF</span>
<a name="l00140"></a>00140   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; aretes_som = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#affa60690e1b372fa4c01d6088267dbe4" title="renvoie le tableau de connectivite aretes/sommets.">aretes_som</a>();
<a name="l00141"></a>00141   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_aretes = aretes_som.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00142"></a>00142   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = dom.<a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>();
<a name="l00143"></a>00143   <span class="keyword">const</span> <span class="keywordtype">int</span> dim = coord.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00144"></a>00144   <a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, dim);
<a name="l00145"></a>00145   <a class="code" href="classZone__VF.html#ae77f9ddf0711c0bcf2162921698d0bea">creer_tableau_aretes</a>(<a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">ArrOfDouble::NOCOPY_NOINIT</a>);
<a name="l00146"></a>00146   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_aretes; i++)
<a name="l00147"></a>00147     {
<a name="l00148"></a>00148       <span class="keyword">const</span> <span class="keywordtype">int</span> s0 = aretes_som(i, 0);
<a name="l00149"></a>00149       <span class="keyword">const</span> <span class="keywordtype">int</span> s1 = aretes_som(i, 1);
<a name="l00150"></a>00150       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dim; j++)
<a name="l00151"></a>00151         <a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(i, j) = (coord(s0, j) + coord(s1, j)) * 0.5;
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153   <a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00154"></a>00154 
<a name="l00155"></a>00155   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_aretes = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a1e1e86ef5b088c4d33d42cd38a967b4a" title="renvoie le numero de la jeme arete du ieme element.">elem_aretes</a>();
<a name="l00156"></a>00156 
<a name="l00157"></a>00157 <span class="comment">// Calcul du volume des aretes</span>
<a name="l00158"></a>00158 <span class="comment">// Creation d&#39;un tableau initialise a zero:</span>
<a name="l00159"></a>00159   <a class="code" href="classZone__VF.html#ae77f9ddf0711c0bcf2162921698d0bea">creer_tableau_aretes</a>(<a class="code" href="classZone__VEF__PreP1b.html#a2ba1341aab0c3a0e02ff6df3022cdafa">volumes_aretes</a>);
<a name="l00160"></a>00160 
<a name="l00161"></a>00161   <span class="keyword">const</span> <span class="keywordtype">int</span> nbr_elem = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>();
<a name="l00162"></a>00162   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_aretes_elem = elem_aretes.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00163"></a>00163 <span class="comment">// facteur 6 pour le calcul des volumes des aretes, est-ce correct pour autre chose qu&#39;un tetra ?</span>
<a name="l00164"></a>00164   assert(nb_aretes_elem == 6);
<a name="l00165"></a>00165 <span class="comment">// Essai d&#39;une autre facon de coder: calcul des contributions aux aretes par les elements reels,</span>
<a name="l00166"></a>00166 <span class="comment">// puis sommation des contributions des aretes partagees:</span>
<a name="l00167"></a>00167   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem = 0; elem &lt; nbr_elem; elem++)
<a name="l00168"></a>00168     {
<a name="l00169"></a>00169       <span class="keywordtype">double</span> vol = <a class="code" href="classZone__VF.html#a9598b08cb9126f88cfafe72fc0eeca70" title="renvoie le tableaux des volumes des mailles.">volumes</a>(elem) / 6.0;
<a name="l00170"></a>00170       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nb_aretes_elem; j++)
<a name="l00171"></a>00171         {
<a name="l00172"></a>00172           <span class="keywordtype">int</span> arete = elem_aretes(elem, j);
<a name="l00173"></a>00173           <a class="code" href="classZone__VEF__PreP1b.html#a2ba1341aab0c3a0e02ff6df3022cdafa">volumes_aretes</a>[arete] += vol;
<a name="l00174"></a>00174         }
<a name="l00175"></a>00175     }
<a name="l00176"></a>00176 <span class="comment">// Sommation des contributions des aretes joint et echange des espaces virtuels</span>
<a name="l00177"></a>00177   <a class="code" href="classMD__Vector__tools.html#a529704705758b2c8c9a688a3090011f6">MD_Vector_tools::echange_espace_virtuel</a>(<a class="code" href="classZone__VEF__PreP1b.html#a2ba1341aab0c3a0e02ff6df3022cdafa">volumes_aretes</a>, <a class="code" href="classMD__Vector__tools.html#ac0611ff35861322f7e1fe9b98a132b7ca5bd847265a61ded8631812d6e1f0a559">MD_Vector_tools::EV_SOMME_ECHANGE</a>);
<a name="l00178"></a>00178 }
<a name="l00179"></a>00179 
<a name="l00180"></a>00180 <span class="comment">/*</span>
<a name="l00181"></a>00181 <span class="comment">  static int arete(const IntTab&amp; som_aretes,</span>
<a name="l00182"></a>00182 <span class="comment">  const IntTab&amp; aretes_som,</span>
<a name="l00183"></a>00183 <span class="comment">  int S1, int S2, const Domaine&amp; dom)</span>
<a name="l00184"></a>00184 <span class="comment">  {</span>
<a name="l00185"></a>00185 <span class="comment">  //Cout &lt;&lt; &quot;S1,S2 = &quot; &lt;&lt; S1 &lt;&lt; &quot; &quot; &lt;&lt; S2 &lt;&lt; finl;</span>
<a name="l00186"></a>00186 <span class="comment">  for(int i=0; i&lt;nb_max_aretes_som; i++)</span>
<a name="l00187"></a>00187 <span class="comment">  {</span>
<a name="l00188"></a>00188 <span class="comment">  const int&amp; a=som_aretes(S1,i);</span>
<a name="l00189"></a>00189 <span class="comment">  if( (dom.get_renum_som_perio(aretes_som(a,0))==S2)</span>
<a name="l00190"></a>00190 <span class="comment">  ||</span>
<a name="l00191"></a>00191 <span class="comment">  (dom.get_renum_som_perio(aretes_som(a,1))==S2) )</span>
<a name="l00192"></a>00192 <span class="comment">  return a;</span>
<a name="l00193"></a>00193 <span class="comment">  }</span>
<a name="l00194"></a>00194 <span class="comment">  {</span>
<a name="l00195"></a>00195 <span class="comment">  Cerr &lt;&lt; &quot;arete pas Trouvee!!&quot; &lt;&lt; finl;</span>
<a name="l00196"></a>00196 <span class="comment">  Cout &lt;&lt; &quot;S1,S2 = &quot; &lt;&lt; S1 &lt;&lt; &quot; &quot; &lt;&lt; S2 &lt;&lt; finl;</span>
<a name="l00197"></a>00197 <span class="comment">  Cout &lt;&lt; &quot;som_aretes &quot; &lt;&lt; som_aretes &lt;&lt; finl;</span>
<a name="l00198"></a>00198 <span class="comment">  Cout &lt;&lt; &quot;aretes_som &quot; &lt;&lt; aretes_som &lt;&lt; finl;</span>
<a name="l00199"></a>00199 <span class="comment">  Process::exit();</span>
<a name="l00200"></a>00200 <span class="comment">  }</span>
<a name="l00201"></a>00201 <span class="comment">  return -1;</span>
<a name="l00202"></a>00202 <span class="comment">  } */</span>
<a name="l00203"></a>00203 
<a name="l00204"></a><a class="code" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">00204</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a>(<span class="keywordtype">int</span> S,
<a name="l00205"></a>00205                 <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; contenu)
<a name="l00206"></a>00206 {
<a name="l00207"></a>00207   <span class="keywordtype">int</span> nb_som=contenu.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00208"></a>00208   <span class="keywordtype">int</span> i=S+1;
<a name="l00209"></a>00209   <span class="keywordflow">while</span>(i&lt;nb_som)
<a name="l00210"></a>00210     <span class="keywordflow">if</span>(contenu(i)==1)
<a name="l00211"></a>00211       <span class="keywordflow">return</span> i;
<a name="l00212"></a>00212     <span class="keywordflow">else</span> i++;
<a name="l00213"></a>00213   i=0;
<a name="l00214"></a>00214   <span class="keywordflow">while</span>(i&lt;S)
<a name="l00215"></a>00215     <span class="keywordflow">if</span>(contenu(i)==1)
<a name="l00216"></a>00216       <span class="keywordflow">return</span> i;
<a name="l00217"></a>00217     <span class="keywordflow">else</span> i++;
<a name="l00218"></a>00218   <span class="keywordflow">return</span> -1;
<a name="l00219"></a>00219 }
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="classZone__VEF__PreP1b.html#a82652690ec77ff14224c96697b09bbcd">00223</a> <span class="keywordtype">void</span> <a class="code" href="classZone__VEF__PreP1b.html#a82652690ec77ff14224c96697b09bbcd">Zone_VEF_PreP1b::modifier_pour_Cl</a>(<span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; conds_lim)
<a name="l00224"></a>00224 {
<a name="l00225"></a>00225   <a class="code" href="classZone__VEF__PreP1b.html#a82652690ec77ff14224c96697b09bbcd">Zone_VEF::modifier_pour_Cl</a>(conds_lim);
<a name="l00226"></a>00226   <span class="keyword">static</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>* ptr=0;
<a name="l00227"></a>00227   <span class="keywordflow">if</span>(ptr!=&amp;<a class="code" href="classZone__VEF__PreP1b.html#ad34fbb4e40f1eef424d47437dd857d90">volumes_som</a>)
<a name="l00228"></a>00228     {
<a name="l00229"></a>00229       <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00230"></a>00230       <span class="keywordtype">int</span> i;
<a name="l00231"></a>00231       <span class="keyword">const</span> <span class="keywordtype">int</span> ns = <a class="code" href="classZone__VEF__PreP1b.html#a7fa6f80d06f2f6d193e9311abc68412c">nb_som</a>();
<a name="l00232"></a>00232       <span class="keywordflow">for</span>(i=0; i&lt;ns; i++)
<a name="l00233"></a>00233         {
<a name="l00234"></a>00234           <span class="keywordtype">int</span> j=(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(i));
<a name="l00235"></a>00235           <span class="keywordflow">if</span>(i!=j)
<a name="l00236"></a>00236             <a class="code" href="classZone__VEF__PreP1b.html#ad34fbb4e40f1eef424d47437dd857d90">volumes_som</a>(j)+=<a class="code" href="classZone__VEF__PreP1b.html#ad34fbb4e40f1eef424d47437dd857d90">volumes_som</a>(i);
<a name="l00237"></a>00237         }
<a name="l00238"></a>00238       <span class="keywordflow">for</span>(i=0; i&lt;ns; i++)
<a name="l00239"></a>00239         {
<a name="l00240"></a>00240           <span class="keywordtype">int</span> j=(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(i));
<a name="l00241"></a>00241           <span class="keywordflow">if</span>(i!=j)
<a name="l00242"></a>00242             <a class="code" href="classZone__VEF__PreP1b.html#ad34fbb4e40f1eef424d47437dd857d90">volumes_som</a>(i)=<a class="code" href="classZone__VEF__PreP1b.html#ad34fbb4e40f1eef424d47437dd857d90">volumes_som</a>(j);
<a name="l00243"></a>00243         }
<a name="l00244"></a>00244       <a class="code" href="classZone__VEF__PreP1b.html#ad34fbb4e40f1eef424d47437dd857d90">volumes_som</a>.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00245"></a>00245       ptr = &amp;<a class="code" href="classZone__VEF__PreP1b.html#ad34fbb4e40f1eef424d47437dd857d90">volumes_som</a>;
<a name="l00246"></a>00246     }
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 <span class="comment">// Verification du tableau renum_som_perio</span>
<a name="l00249"></a>00249   <span class="keywordflow">if</span> (<a class="code" href="classDebog.html#a76d8a5030a2cb72e4b4639a1ce97dc90" title="renvoie 1 si on est en mode Debog, 0 sinon">Debog::active</a>())
<a name="l00250"></a>00250     {
<a name="l00251"></a>00251       <a class="code" href="classIntVect.html">IntVect</a> tmp;
<a name="l00252"></a>00252       <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00253"></a>00253       dom.<a class="code" href="classDomaine.html#a32c7de9f9e8e78e3d5ea68715b2ceb2b" title="Cree un tableau ayant une &quot;ligne&quot; par sommet du maillage. Voir MD_Vector_tools::creer_tableau_distrib...">creer_tableau_sommets</a>(tmp, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>);
<a name="l00254"></a>00254       <span class="keyword">const</span> <span class="keywordtype">int</span> n = tmp.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00255"></a>00255       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00256"></a>00256         tmp[i] = dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(i);
<a name="l00257"></a>00257       <a class="code" href="classDebog.html#a45e9031473a651560a4d3843e41164ce" title="teste le contenu du vecteur v en supposant qu&#39;il contient des indices d&#39;items associes au descripteur...">Debog::verifier_indices_items</a>(<span class="stringliteral">&quot;renum_som_perio&quot;</span>,tmp.<a class="code" href="classIntVect.html#ae74e1fee6aca124d32718267e33a40c6">get_md_vector</a>(),tmp);
<a name="l00258"></a>00258     }
<a name="l00259"></a>00259 
<a name="l00260"></a>00260   <span class="keywordflow">if</span>(<a class="code" href="classZone__VEF__PreP1b.html#a9d02e2431efb6e75c3d733ff06f89549">get_alphaA</a>())
<a name="l00261"></a>00261     {
<a name="l00262"></a>00262 <span class="comment">// Construction de renum_arete_perio</span>
<a name="l00263"></a>00263       <a class="code" href="classZone__VEF__PreP1b.html#a96302abe56fcc7f49700d475d06a678c">construire_renum_arete_perio</a>(conds_lim);
<a name="l00264"></a>00264 
<a name="l00265"></a>00265 <span class="comment">// Creation d&#39;un tableau distribue pour ok_arete</span>
<a name="l00266"></a>00266       <a class="code" href="classZone__VF.html#ae77f9ddf0711c0bcf2162921698d0bea">creer_tableau_aretes</a>(<a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">ArrOfInt::NOCOPY_NOINIT</a>);
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 <span class="comment">// Si P1 alors on doit trouver les aretes superflues:</span>
<a name="l00269"></a>00269       <span class="keywordflow">if</span> (<a class="code" href="classZone__VEF__PreP1b.html#ad7fbcb5567dcc2e6f0a0ed85ce90a4fa">get_alphaS</a>())
<a name="l00270"></a>00270         {
<a name="l00271"></a>00271 <span class="comment">// On essaie de lire un fichier .ok_arete d&#39;un precedant calcul</span>
<a name="l00272"></a>00272 <span class="comment">// S&#39;il n&#39;existe pas ou est incoherent avec le maillage, on reconstruit ok_arete</span>
<a name="l00273"></a>00273           <span class="keywordflow">if</span> (!<a class="code" href="classZone__VEF__PreP1b.html#a59c954bb36bb58b883d4178fc6e05138">lecture_ok_arete</a>())
<a name="l00274"></a>00274             <a class="code" href="classZone__VEF__PreP1b.html#acc0c53df6b63047e7cfb2158e3ab1ca0">construire_ok_arete</a>();
<a name="l00275"></a>00275         }
<a name="l00276"></a>00276       <span class="keywordflow">else</span>
<a name="l00277"></a>00277         {
<a name="l00278"></a>00278 <span class="comment">// Toutes les aretes sont necessaires si pas support P1</span>
<a name="l00279"></a>00279           <a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>=1;
<a name="l00280"></a>00280         }
<a name="l00281"></a>00281       <a class="code" href="classDebog.html#a52ab9548f200a42da12cb62a4440266b" title="like verifier(), but, in &quot;read\&amp;compare&quot; mode, put the reference value found in the file in the ref v...">Debog::verifier_getref</a>(<span class="stringliteral">&quot;ok_arete&quot;</span>, <a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>, <a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>);
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 <span class="comment">// Debog::verifier(&quot;ok_arete (identique seulement si ok_arete relu dans le fichier .ok_arete):&quot;,ok_arete);</span>
<a name="l00284"></a>00284     }<span class="comment">//!&lt; fin if 3D</span>
<a name="l00285"></a>00285 <span class="comment"></span>}
<a name="l00286"></a>00286 
<a name="l00287"></a><a class="code" href="Zone__VEF__PreP1b_8h.html#a590475da5a2f0852de410163f60bfa70">00287</a> <span class="keywordtype">void</span> <a class="code" href="Zone__VEF__PreP1b_8cpp.html#ad8ba71244ad9a61cd78b6f388d7e503a">exemple_champ_non_homogene</a>(<span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_VEF, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab)
<a name="l00288"></a>00288 {
<a name="l00289"></a>00289   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xp = zone_VEF.<a class="code" href="classZone__VF.html#a87a29f0223c71256a25ee343c9277599">xp</a>();
<a name="l00290"></a>00290   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00291"></a>00291   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord=zone.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00292"></a>00292   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xa=zone_VEF.<a class="code" href="classZone__VF.html#a6ad5a2a03fc2cba4247a6ebe662b1320">xa</a>();
<a name="l00293"></a>00293   <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; renum_arete_perio=zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a43767f8684512d1ee950dc07eea76c5b">get_renum_arete_perio</a>();
<a name="l00294"></a>00294 <span class="comment">// Verification du tableau xa des coordonnees arete</span>
<a name="l00295"></a>00295   <span class="keywordflow">if</span> (xa.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()) <a class="code" href="classDebog.html#aa228f7e951ef67b9e9bb31ced928652f">Debog::verifier</a>(<span class="stringliteral">&quot;xa=&quot;</span>,xa);
<a name="l00296"></a>00296   <span class="keywordtype">int</span> nb_elem=zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>();
<a name="l00297"></a>00297   <span class="keywordtype">int</span> nb_elem_tot=zone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00298"></a>00298   <span class="keywordtype">int</span> nb_som=zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();
<a name="l00299"></a>00299   <span class="keywordtype">int</span> nb_som_tot=zone.<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
<a name="l00300"></a>00300   <span class="keywordtype">int</span> nb_aretes=zone.<a class="code" href="classZone.html#a3e3b48691911fd85574c7bc10a1a4fb8" title="renvoie le nombre d&#39;aretes reelles.">nb_aretes</a>();
<a name="l00301"></a>00301   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> I=0 ; I&lt;nb_elem; I++)
<a name="l00302"></a>00302     {
<a name="l00303"></a>00303       tab(I)=(1.1+xp(I,0))*(1.1+2*xp(I,1));
<a name="l00304"></a>00304       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3) tab(I)*=(1.1+3*xp(I,2));
<a name="l00305"></a>00305     }
<a name="l00306"></a>00306   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> I=0; I&lt;nb_som; I++)
<a name="l00307"></a>00307     {
<a name="l00308"></a>00308       tab(nb_elem_tot+I)=(1.1+coord(I,0))*(1.1+2*coord(I,1));
<a name="l00309"></a>00309       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3) tab(nb_elem_tot+I)*=(1.1+3*coord(I,2));
<a name="l00310"></a>00310 <span class="comment">// On applique la periodicite:</span>
<a name="l00311"></a>00311       tab(nb_elem_tot+I)=tab(nb_elem_tot+zone.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(I));
<a name="l00312"></a>00312     }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 <span class="preprocessor">#ifndef NDEBUG</span>
<a name="l00315"></a>00315 <span class="preprocessor"></span>  <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; ok_arete = zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a83771f784d487e346b2ef22a389472a2">get_ok_arete</a>();
<a name="l00316"></a>00316 <span class="preprocessor">#endif</span>
<a name="l00317"></a>00317 <span class="preprocessor"></span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> I=0; I&lt;nb_aretes; I++)
<a name="l00318"></a>00318     {
<a name="l00319"></a>00319       tab(nb_elem_tot+nb_som_tot+I)=(1.1+xa(I,0))*(1.1+2*xa(I,1))*(1.1+3*xa(I,2));
<a name="l00320"></a>00320 <span class="comment">// On applique la periodicite:</span>
<a name="l00321"></a>00321       tab(nb_elem_tot+nb_som_tot+I)=tab(nb_elem_tot+nb_som_tot+renum_arete_perio(I));
<a name="l00322"></a>00322 <span class="comment">// On verifie ok_arete au passage</span>
<a name="l00323"></a>00323       assert(ok_arete(I)==ok_arete(renum_arete_perio(I)));
<a name="l00324"></a>00324     }
<a name="l00325"></a>00325   tab.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 
<a name="l00328"></a><a class="code" href="classZone__VEF__PreP1b.html#acc0c53df6b63047e7cfb2158e3ab1ca0">00328</a> <span class="keywordtype">void</span> <a class="code" href="classZone__VEF__PreP1b.html#acc0c53df6b63047e7cfb2158e3ab1ca0">Zone_VEF_PreP1b::construire_ok_arete</a>()
<a name="l00329"></a>00329 {
<a name="l00330"></a>00330   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Build array ok_arete...&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00331"></a>00331   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00332"></a>00332   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; aretes_som=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#affa60690e1b372fa4c01d6088267dbe4" title="renvoie le tableau de connectivite aretes/sommets.">aretes_som</a>();
<a name="l00333"></a>00333   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_reel=<a class="code" href="classZone__VEF__PreP1b.html#a7fa6f80d06f2f6d193e9311abc68412c">nb_som</a>();
<a name="l00334"></a>00334 
<a name="l00335"></a>00335 <span class="comment">// Connectivite sommets-aretes (pour chaque sommet, liste des aretes adjacentes)</span>
<a name="l00336"></a>00336 <span class="comment">// B.M.: je remplace IntTab(n, 64) par une Static_Int_List et je reutilise</span>
<a name="l00337"></a>00337 <span class="comment">// la methode de calcul des connectivites... plus econome en memoire !</span>
<a name="l00338"></a>00338 <span class="comment">// som_aretes contient une connectivite modifiee pour les sommets periodiques</span>
<a name="l00339"></a>00339 <span class="comment">// (les aretes sont toujours rattachees au sommet get_renum_som_perio(),</span>
<a name="l00340"></a>00340 <span class="comment">// les aretes periodiques opposees sont remplacees par une arete [nb_som_reel,nb_som_reel]</span>
<a name="l00341"></a>00341 <span class="comment">// fictive, et les sommets perio opposes ne sont rattaches a aucune arete)</span>
<a name="l00342"></a>00342   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_aretes = aretes_som.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00343"></a>00343   <a class="code" href="classStatic__Int__Lists.html" title="Cette classe permet de stocker des listes d&#39;entiers accessibles en temps constant. La taille des listes ne peut pas changer sans perdre le contenu (ce sont des listes statiques). Exemple: Static_Int_List l; ArrOfInt tailles(3); tailles[0] = 2; tailles[1] = 3; tailles[2] = 0; // On reserve la memoire pour trois listes de taille 2, 3 et 0: l.set_list_sizes(tailles); // On affecte une valeur au deuxieme element de la premiere liste: l.set_value(0,1,765); // Affiche la valeur Cout &lt;&lt; l(0,1);.">Static_Int_Lists</a> som_aretes;
<a name="l00344"></a>00344   {
<a name="l00345"></a>00345 <span class="comment">// Creation d&#39;un tableau d&#39;aretes ou les sommets sont remplaces par le sommet</span>
<a name="l00346"></a>00346 <span class="comment">// periodique associe et sans les aretes periodiques opposees</span>
<a name="l00347"></a>00347     <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> aretes_som2;
<a name="l00348"></a>00348     aretes_som2.<a class="code" href="classIntTab.html#a3d200d04b7bf53a32c27867c42065a0e">copy</a>(aretes_som, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>);
<a name="l00349"></a>00349 
<a name="l00350"></a>00350     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_aretes; i++)
<a name="l00351"></a>00351       {
<a name="l00352"></a>00352         <span class="keywordflow">if</span> (<a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(i) == i)
<a name="l00353"></a>00353           {
<a name="l00354"></a>00354             aretes_som2(i, 0) = dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(aretes_som(i,0));
<a name="l00355"></a>00355             aretes_som2(i, 1) = dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(aretes_som(i,1));
<a name="l00356"></a>00356           }
<a name="l00357"></a>00357         <span class="keywordflow">else</span>
<a name="l00358"></a>00358           {
<a name="l00359"></a>00359 <span class="comment">// arete periodique opposee, non conservee, on cree une arete fictive pour</span>
<a name="l00360"></a>00360 <span class="comment">// construire_connectivite_som_elem: le sommet d&#39;indice nb_som_reel</span>
<a name="l00361"></a>00361 <span class="comment">// sera connecte a toutes les aretes periodiques supprimees</span>
<a name="l00362"></a>00362             aretes_som2(i, 0) = nb_som_reel;
<a name="l00363"></a>00363             aretes_som2(i, 1) = nb_som_reel;
<a name="l00364"></a>00364           }
<a name="l00365"></a>00365       }
<a name="l00366"></a>00366 <span class="comment">// On donne un sommet de plus (le sommet fictif connecte aux aretes supprimees)</span>
<a name="l00367"></a>00367     <a class="code" href="Connectivite__som__elem_8cpp.html#a82161461a228e43ae236c31101ff3ce6" title="construction de la structure som_elem pour la zone donnee On cree pour chaque sommet i la liste des e...">construire_connectivite_som_elem</a>(nb_som_reel+1, aretes_som2, som_aretes, 0 <span class="comment">/* do not include virtual items */</span>);
<a name="l00368"></a>00368   }
<a name="l00369"></a>00369 
<a name="l00370"></a>00370 <span class="comment">// Creation et initialisation du tableau contenu, initialise a zero par defaut</span>
<a name="l00371"></a>00371   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> contenu(nb_som_reel);
<a name="l00372"></a>00372 
<a name="l00373"></a>00373 <span class="comment">// Initialisation pour le parallele: contenu est mis a 2</span>
<a name="l00374"></a>00374 <span class="comment">// pour les sommets communs recus d&#39;un autre processeur</span>
<a name="l00375"></a>00375   {
<a name="l00376"></a>00376     <a class="code" href="classArrOfBit.html">ArrOfBit</a> flags;
<a name="l00377"></a>00377     <a class="code" href="classMD__Vector__tools.html#ad099d2407b0016920bd8c667a56fddd8">MD_Vector_tools::get_sequential_items_flags</a>(dom.<a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>().<a class="code" href="classDoubleVect.html#a0d16d30580c90526e4895388fb44be5d">get_md_vector</a>(), flags);
<a name="l00378"></a>00378     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_som_reel; i++)
<a name="l00379"></a>00379       {
<a name="l00380"></a>00380         <span class="keywordflow">if</span> (!flags[i])
<a name="l00381"></a>00381           {
<a name="l00382"></a>00382 <span class="comment">// Ce sommet est recu d&#39;un autre processeur</span>
<a name="l00383"></a>00383             <span class="keyword">const</span> <span class="keywordtype">int</span> i2 = dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(i);
<a name="l00384"></a>00384             contenu[i] = 2;
<a name="l00385"></a>00385             <span class="keywordflow">if</span> (i2 != i)
<a name="l00386"></a>00386               contenu[i2] = 2;
<a name="l00387"></a>00387           }
<a name="l00388"></a>00388       }
<a name="l00389"></a>00389   }
<a name="l00390"></a>00390 
<a name="l00391"></a>00391 <span class="comment">// Estimation du nombre d&#39;aretes superflues a trouver sur la zone</span>
<a name="l00392"></a>00392 <span class="comment">// en comptant les sommets reels non periodiques dont le contenu vaut 0</span>
<a name="l00393"></a>00393   <span class="keywordtype">int</span> nombre_aretes_superflues_prevues_sur_la_zone=0;
<a name="l00394"></a>00394   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som_reel; i++)
<a name="l00395"></a>00395     <span class="keywordflow">if</span> (i==dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(i) &amp;&amp; contenu(i)==0)
<a name="l00396"></a>00396       nombre_aretes_superflues_prevues_sur_la_zone++;
<a name="l00397"></a>00397 
<a name="l00398"></a>00398   <a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a> = -1;
<a name="l00399"></a>00399 
<a name="l00400"></a>00400 <span class="comment">// On boucle tant qu&#39;il y&#39;a des sommets avec le contenu 0</span>
<a name="l00401"></a>00401   <span class="keywordflow">while</span> (<a class="code" href="ArrOfDouble_8cpp.html#abd3998749a1a8dab00dd6ac1798327fb" title="Retourne la valeur minimale.">min_array</a>(contenu)==0)
<a name="l00402"></a>00402     {
<a name="l00403"></a>00403 <span class="comment">// On cherche le premier sommet avec contenu 0 en bouclant sur les aretes</span>
<a name="l00404"></a>00404       <span class="keywordtype">int</span> Aroot=-1,Sroot=-1;
<a name="l00405"></a>00405       <span class="keywordtype">int</span> S0,S1;
<a name="l00406"></a>00406       <span class="keywordflow">do</span>
<a name="l00407"></a>00407         {
<a name="l00408"></a>00408           <span class="keywordflow">while</span> (<a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>(++Aroot)==0) {};
<a name="l00409"></a>00409           S0=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(aretes_som(Aroot,0));
<a name="l00410"></a>00410           S1=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(aretes_som(Aroot,1));
<a name="l00411"></a>00411         }
<a name="l00412"></a>00412       <span class="keywordflow">while</span> (Aroot&lt;nb_aretes &amp;&amp; contenu(S0)!=0 &amp;&amp; contenu(S1)!=0);
<a name="l00413"></a>00413 
<a name="l00414"></a>00414       assert(Aroot&lt;nb_aretes);
<a name="l00415"></a>00415 
<a name="l00416"></a>00416       Aroot=<a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(Aroot);
<a name="l00417"></a>00417 
<a name="l00418"></a>00418       <a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>(Aroot)=0; <span class="comment">//!&lt; lockee</span>
<a name="l00419"></a>00419 <span class="comment"></span>      <span class="keywordflow">if</span> (!contenu(S0))
<a name="l00420"></a>00420         {
<a name="l00421"></a>00421           contenu(S0)=1;
<a name="l00422"></a>00422           Sroot=S0;
<a name="l00423"></a>00423         }
<a name="l00424"></a>00424       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!contenu(S1))
<a name="l00425"></a>00425         {
<a name="l00426"></a>00426           contenu(S1)=1;
<a name="l00427"></a>00427           Sroot=S1;
<a name="l00428"></a>00428         }
<a name="l00429"></a>00429 
<a name="l00430"></a>00430 <span class="comment">// Boucle sur les sommets</span>
<a name="l00431"></a>00431       <span class="keywordflow">do</span>
<a name="l00432"></a>00432         {
<a name="l00433"></a>00433           <span class="keyword">const</span> <span class="keywordtype">int</span> nb_aretes_voisines = som_aretes.<a class="code" href="classStatic__Int__Lists.html#adbf6903737c3c30bf87e05b29f5a5b56" title="renvoie le nombre d&#39;elements de la liste i">get_list_size</a>(Sroot);
<a name="l00434"></a>00434           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_aretes_voisines; i++)
<a name="l00435"></a>00435             {
<a name="l00436"></a>00436               <span class="keywordtype">int</span> A=<a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(som_aretes(Sroot,i));
<a name="l00437"></a>00437               <span class="keywordflow">if</span>(<a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>(A)==-1)
<a name="l00438"></a>00438                 {
<a name="l00439"></a>00439                   <span class="keywordtype">int</span> S=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(aretes_som(A,0));
<a name="l00440"></a>00440                   <span class="keywordflow">if</span>(S==Sroot)
<a name="l00441"></a>00441                     {
<a name="l00442"></a>00442                       S=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(aretes_som(A,1));
<a name="l00443"></a>00443                     }
<a name="l00444"></a>00444                   <span class="keywordflow">if</span>(!contenu(S))
<a name="l00445"></a>00445                     {
<a name="l00446"></a>00446                       <a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>(A)=0; <span class="comment">//!&lt; lockee</span>
<a name="l00447"></a>00447 <span class="comment"></span>                      contenu(S)=1;
<a name="l00448"></a>00448                     }
<a name="l00449"></a>00449                   <span class="keywordflow">else</span>
<a name="l00450"></a>00450                     {
<a name="l00451"></a>00451                       <a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>(A)=1; <span class="comment">//!&lt; libre</span>
<a name="l00452"></a>00452 <span class="comment"></span>                    }
<a name="l00453"></a>00453                 }
<a name="l00454"></a>00454             }
<a name="l00455"></a>00455           contenu(Sroot)=2;
<a name="l00456"></a>00456         }
<a name="l00457"></a>00457       <span class="keywordflow">while</span>((Sroot=<a class="code" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a>(Sroot, contenu))!=-1);
<a name="l00458"></a>00458 
<a name="l00459"></a>00459 <span class="comment">// Correction pour des tableaux ok_arete et contenu pour la periodicite</span>
<a name="l00460"></a>00460       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_aretes; i++)
<a name="l00461"></a>00461         <a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>(i)=<a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>(<a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(i));
<a name="l00462"></a>00462       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_som_reel; i++)
<a name="l00463"></a>00463         contenu(i)=contenu(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(i));
<a name="l00464"></a>00464     }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466 <span class="comment">// Mise a jour des parties virtuelles du tableau ok_arete</span>
<a name="l00467"></a>00467   <a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>.<a class="code" href="classIntVect.html#ad12bea67621d1a0ee82b27c9a37ca4ef">echange_espace_virtuel</a>();
<a name="l00468"></a>00468 
<a name="l00469"></a>00469 <span class="comment">// Verification des aretes superflues</span>
<a name="l00470"></a>00470   <a class="code" href="classZone__VEF__PreP1b.html#a9d92ed2ec1e522d752e616e1d8be26f4">verifie_ok_arete</a>(nombre_aretes_superflues_prevues_sur_la_zone);
<a name="l00471"></a>00471 
<a name="l00472"></a>00472 <span class="comment">// Ecriture des aretes superflues dans un fichier nom_du_cas.ok_arete afin de le relire la fois suivante</span>
<a name="l00473"></a>00473   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> fichier(<a class="code" href="classObjet__U.html#a7c27c4f80259eeef76ff8fe2d3bc61f7" title="Renvoie une reference constante vers le nom du cas. Cette methode est statique.">nom_du_cas</a>());
<a name="l00474"></a>00474   fichier+=<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00475"></a>00475   fichier+=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>()+<span class="stringliteral">&quot;.ok_arete&quot;</span>;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Writing file &quot;</span> &lt;&lt; fichier &lt;&lt; finl;
<a name="l00478"></a>00478   <a class="code" href="classEcrFicPartageBin.html" title="Ecriture dans un fichier partage Cette classe derive de Ecr_Fic_Par, en utilisant une sortie en binai...">EcrFicPartageBin</a> fic_ok_arete_;
<a name="l00479"></a>00479   <span class="keywordflow">if</span> (!fic_ok_arete_.<a class="code" href="classEcrFicPartage.html#aae9fd9a7163d0edcb12e0235a2eabdfa" title="Ouvre le fichier avec les parametres mode et prot donnes Ces parametres sont les parametres de la met...">ouvrir</a>(fichier,ios::out))
<a name="l00480"></a>00480     {
<a name="l00481"></a>00481       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error: cannot open file &quot;</span> &lt;&lt; fichier &lt;&lt; <span class="stringliteral">&quot; for writing.&quot;</span> &lt;&lt; finl;
<a name="l00482"></a>00482       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00483"></a>00483     }
<a name="l00484"></a>00484 
<a name="l00485"></a>00485   <a class="code" href="classArrOfBit.html">ArrOfBit</a> marqueurs_aretes;
<a name="l00486"></a>00486   <span class="keyword">const</span> <a class="code" href="classMD__Vector.html" title=": Cette classe est un DERIV mais l&#39;objet pointe est partage entre plusieurs instances de cette classe...">MD_Vector</a>&amp; md_aretes = <a class="code" href="classZone__VF.html#a93f73d93187a780a1b927be5b3d5c2a2">md_vector_aretes</a>();
<a name="l00487"></a>00487   <a class="code" href="classMD__Vector__tools.html#ad099d2407b0016920bd8c667a56fddd8">MD_Vector_tools::get_sequential_items_flags</a>(md_aretes, marqueurs_aretes);
<a name="l00488"></a>00488   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_aretes_seq = md_aretes.<a class="code" href="classMD__Vector.html#a41324dfaa7a973091d0a8276908d10e2">valeur</a>().<a class="code" href="classMD__Vector__base.html#a47d5867ac692b62645169eae6e2cafa0">nb_items_seq_tot</a>();
<a name="l00489"></a>00489 
<a name="l00490"></a>00490   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
<a name="l00491"></a>00491     fic_ok_arete_ &lt;&lt; nb_aretes_seq &lt;&lt; finl;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 <span class="comment">// Chaque processeur ecrit ses aretes non communes:</span>
<a name="l00494"></a>00494   <span class="keyword">const</span> <span class="keywordtype">int</span> n = marqueurs_aretes.<a class="code" href="classArrOfBit.html#a3dc47c19e757ec4c3c757abeec29dc3a" title="Renvoie la taille du tableau en bits.">size_array</a>();
<a name="l00495"></a>00495   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l00496"></a>00496     {
<a name="l00497"></a>00497       <span class="keywordflow">if</span> (marqueurs_aretes[i])
<a name="l00498"></a>00498         fic_ok_arete_ &lt;&lt; <a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(i,0) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#ae67efc620265981e3385b5f75837d3ef">space</a> &lt;&lt; <a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(i,1) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#ae67efc620265981e3385b5f75837d3ef">space</a> &lt;&lt; <a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(i,2) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#ae67efc620265981e3385b5f75837d3ef">space</a> &lt;&lt; <a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>(i) &lt;&lt; finl;
<a name="l00499"></a>00499     }
<a name="l00500"></a>00500   fic_ok_arete_.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00501"></a>00501   fic_ok_arete_.<a class="code" href="classEcrFicPartage.html#aa1268f27f87790ead9fc158587252134">close</a>();
<a name="l00502"></a>00502 }
<a name="l00503"></a>00503 
<a name="l00504"></a><a class="code" href="classZone__VEF__PreP1b.html#a96302abe56fcc7f49700d475d06a678c">00504</a> <span class="keywordtype">void</span> <a class="code" href="classZone__VEF__PreP1b.html#a96302abe56fcc7f49700d475d06a678c">Zone_VEF_PreP1b::construire_renum_arete_perio</a>(<span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; conds_lim)
<a name="l00505"></a>00505 {
<a name="l00506"></a>00506   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Build array renum_arete_perio...&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00507"></a>00507   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; aretes_som=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#affa60690e1b372fa4c01d6088267dbe4" title="renvoie le tableau de connectivite aretes/sommets.">aretes_som</a>();
<a name="l00508"></a>00508   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_aretes_tot=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a59ae0ababf85ce303a7c6f339430e335" title="renvoie le nombre d&#39;aretes total (reelles+virtuelles).">nb_aretes_tot</a>();
<a name="l00509"></a>00509   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00510"></a>00510 
<a name="l00511"></a>00511 <span class="comment">// Initialisation de renum_arete_perio</span>
<a name="l00512"></a>00512   <a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(nb_aretes_tot);
<a name="l00513"></a>00513   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_aretes_tot; i++)
<a name="l00514"></a>00514     <a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(i)=i;
<a name="l00515"></a>00515 
<a name="l00516"></a>00516   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_aretes=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a1e1e86ef5b088c4d33d42cd38a967b4a" title="renvoie le numero de la jeme arete du ieme element.">elem_aretes</a>();
<a name="l00517"></a>00517   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> aretes1(6);
<a name="l00518"></a>00518   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> aretes2(6);
<a name="l00519"></a>00519   <span class="keywordtype">int</span> nb_cond_lim=conds_lim.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>();
<a name="l00520"></a>00520 <span class="comment">// Premiere etape: faire pointer tous les aretes periodiques liees entre elles vers la meme arete</span>
<a name="l00521"></a>00521   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cond_lim=0; num_cond_lim&lt;nb_cond_lim; num_cond_lim++)
<a name="l00522"></a>00522     {
<a name="l00523"></a>00523 <span class="comment">// for cl</span>
<a name="l00524"></a>00524 
<a name="l00525"></a>00525       <span class="keyword">const</span> <a class="code" href="classCond__lim__base.html" title="classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...">Cond_lim_base</a>&amp; cl = conds_lim[num_cond_lim].valeur();
<a name="l00526"></a>00526       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>, cl))
<a name="l00527"></a>00527         {
<a name="l00528"></a>00528 <span class="comment">// if Perio</span>
<a name="l00529"></a>00529           <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,cl);
<a name="l00530"></a>00530           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00531"></a>00531 
<a name="l00532"></a>00532           <span class="keywordtype">int</span> nf_bord_tot = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00533"></a>00533           <a class="code" href="classIntVect.html">IntVect</a> fait(nf_bord_tot);
<a name="l00534"></a>00534           fait = 0;
<a name="l00535"></a>00535           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ind_face=0; ind_face&lt;nf_bord_tot; ind_face++)
<a name="l00536"></a>00536             <span class="keywordflow">if</span>(!fait(ind_face))
<a name="l00537"></a>00537               {
<a name="l00538"></a>00538                 <span class="keywordtype">int</span> face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00539"></a>00539                 <span class="keywordtype">int</span> ind_faassociee=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(ind_face);
<a name="l00540"></a>00540                 <span class="keywordtype">int</span> face_assciee=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_faassociee);
<a name="l00541"></a>00541                 fait(ind_faassociee)=fait(ind_face)=1;
<a name="l00542"></a>00542 
<a name="l00543"></a>00543                 <span class="keywordtype">int</span> elem1 = <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(face,0);
<a name="l00544"></a>00544                 <span class="keywordtype">int</span> elem2 = <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(face,1);
<a name="l00545"></a>00545 
<a name="l00546"></a>00546                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;6; j++)
<a name="l00547"></a>00547                   {
<a name="l00548"></a>00548                     aretes1(j)=elem_aretes(elem1,j);
<a name="l00549"></a>00549                     aretes2(j)=elem_aretes(elem2,j);
<a name="l00550"></a>00550                   }
<a name="l00551"></a>00551 
<a name="l00552"></a>00552                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j1=0; j1&lt;6; j1++)
<a name="l00553"></a>00553                   {
<a name="l00554"></a>00554                     <span class="keywordtype">int</span> ar1=aretes1(j1);
<a name="l00555"></a>00555                     <span class="keywordtype">int</span>&amp; ar1_perio = <a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(ar1);
<a name="l00556"></a>00556 <span class="comment">// On verifie que l&#39;arete appartient a la face (ok==2)</span>
<a name="l00557"></a>00557                     <span class="keywordtype">int</span> som11=aretes_som(ar1, 0);
<a name="l00558"></a>00558                     <span class="keywordtype">int</span> som12=aretes_som(ar1, 1);
<a name="l00559"></a>00559                     <span class="keywordtype">int</span> ok=0;
<a name="l00560"></a>00560                     <span class="keywordtype">int</span> nbf = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classElem__geom.html#ab55aa8b4ec6aa60cfde5d5fc134c5333" title="Appel a l&#39;objet sous-jacent Renvoie le nombre de sommets des faces du type specifie.">nb_som_face</a>();
<a name="l00561"></a>00561                     <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet = <a class="code" href="classZone__VF.html#a6cac6a6e8fc1e7b0381b7b15eb451257" title="renvoie le tableau de connectivite faces/sommets.">face_sommets</a>();
<a name="l00562"></a>00562                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nbf; k++)
<a name="l00563"></a>00563                       <span class="keywordflow">if</span> (sommet(face,k)==som11 || sommet(face,k)==som12) ok++;
<a name="l00564"></a>00564                     assert(ok&gt;0);
<a name="l00565"></a>00565                     <span class="keywordflow">if</span> (ok==2)
<a name="l00566"></a>00566                       {
<a name="l00567"></a>00567                         <span class="keywordtype">int</span> s11=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som11);
<a name="l00568"></a>00568                         <span class="keywordtype">int</span> s12=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som12);
<a name="l00569"></a>00569                         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j2=0; j2&lt;6; j2++)
<a name="l00570"></a>00570                           {
<a name="l00571"></a>00571                             <span class="keywordtype">int</span> ar2=aretes2(j2);
<a name="l00572"></a>00572                             <span class="keywordtype">int</span>&amp; ar2_perio = <a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(ar2);
<a name="l00573"></a>00573                             <span class="keywordtype">int</span> som21=aretes_som(ar2, 0);
<a name="l00574"></a>00574                             <span class="keywordtype">int</span> som22=aretes_som(ar2, 1);
<a name="l00575"></a>00575                             ok=0;
<a name="l00576"></a>00576 <span class="comment">// On verifie que l&#39;arete appartient a la face_assciee (ok==2)</span>
<a name="l00577"></a>00577                             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nbf; k++)
<a name="l00578"></a>00578                               <span class="keywordflow">if</span> (sommet(face_assciee,k)==som21 || sommet(face_assciee,k)==som22) ok++;
<a name="l00579"></a>00579                             assert(ok&gt;0);
<a name="l00580"></a>00580                             <span class="keywordflow">if</span> (ok==2)
<a name="l00581"></a>00581                               {
<a name="l00582"></a>00582                                 <span class="keywordtype">int</span> s21=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som21);
<a name="l00583"></a>00583                                 <span class="keywordtype">int</span> s22=dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som22);
<a name="l00584"></a>00584                                 assert(ar1!=ar2);
<a name="l00585"></a>00585 <span class="comment">// Les aretes sont donc periodiques si on rentre dans le &quot;if&quot;</span>
<a name="l00586"></a>00586                                 <span class="keywordflow">if</span> ( ( (s21==s11)||(s22==s11) ) &amp;&amp; ( (s22==s12)||(s21==s12) ) )
<a name="l00587"></a>00587                                   {
<a name="l00588"></a>00588 <span class="comment">// Critere I : choix de l&#39;arete perio en fonction d&#39;un critere geometrique</span>
<a name="l00589"></a>00589                                     <span class="keywordtype">int</span> dir_perio = la_cl_perio.<a class="code" href="classPeriodique.html#a449939e79c6fb0466c200cb121fa4c90">direction_periodicite</a>();
<a name="l00590"></a>00590                                     <span class="keywordtype">int</span> arete_perio = (<a class="code" href="classZone__VF.html#a725165b5d5c96636fb8699613ee2eeec">xa</a>(ar1_perio,dir_perio)&lt;=<a class="code" href="classZone__VF.html#a725165b5d5c96636fb8699613ee2eeec">xa</a>(ar2_perio,dir_perio)) ? ar1_perio : ar2_perio;
<a name="l00591"></a>00591                                     <span class="comment">/*</span>
<a name="l00592"></a>00592 <span class="comment">                                    // Critere II : choix de l&#39;arete perio en fonction des sommets periodiques</span>
<a name="l00593"></a>00593 <span class="comment">                                    int arete_perio;</span>
<a name="l00594"></a>00594 <span class="comment">                                    if (som11!=s11 &amp;&amp; som12!=s12) // Les sommets de l&#39;arete 1 sont periodiques</span>
<a name="l00595"></a>00595 <span class="comment">                                    arete_perio = ar2_perio;</span>
<a name="l00596"></a>00596 <span class="comment">                                    else if (som21!=s21 &amp;&amp; som22!=s22) // Les sommets de l&#39;arete 2 sont periodiques</span>
<a name="l00597"></a>00597 <span class="comment">                                    arete_perio = ar1_perio;</span>
<a name="l00598"></a>00598 <span class="comment">                                    else</span>
<a name="l00599"></a>00599 <span class="comment">                                    {</span>
<a name="l00600"></a>00600 <span class="comment">                                    Cerr &lt;&lt; &quot;Cas non prevu.&quot; &lt;&lt; finl;</span>
<a name="l00601"></a>00601 <span class="comment">                                    exit();</span>
<a name="l00602"></a>00602 <span class="comment">                                    } */</span>
<a name="l00603"></a>00603                                     ar2_perio = arete_perio;
<a name="l00604"></a>00604                                     ar1_perio = arete_perio;
<a name="l00605"></a>00605                                     <a class="code" href="classZone__VEF__PreP1b.html#a2ba1341aab0c3a0e02ff6df3022cdafa">volumes_aretes</a>(ar2)+=<a class="code" href="classZone__VEF__PreP1b.html#a2ba1341aab0c3a0e02ff6df3022cdafa">volumes_aretes</a>(ar1);
<a name="l00606"></a>00606                                     <a class="code" href="classZone__VEF__PreP1b.html#a2ba1341aab0c3a0e02ff6df3022cdafa">volumes_aretes</a>(ar1)+=<a class="code" href="classZone__VEF__PreP1b.html#a2ba1341aab0c3a0e02ff6df3022cdafa">volumes_aretes</a>(ar2);
<a name="l00607"></a>00607                                   }<span class="comment">//fin du if sur &quot;s21==s11&quot;</span>
<a name="l00608"></a>00608                               }
<a name="l00609"></a>00609                           }<span class="comment">//fin du for sur &quot;j2&quot;</span>
<a name="l00610"></a>00610                       }
<a name="l00611"></a>00611                   }<span class="comment">//fin du if sur &quot;renum_arete_perio(aretes1)&quot; et du for sur &quot;j1&quot;</span>
<a name="l00612"></a>00612               }<span class="comment">//fin du if sur &quot;fait&quot;</span>
<a name="l00613"></a>00613         }<span class="comment">//fin if Perio</span>
<a name="l00614"></a>00614     }<span class="comment">//!&lt; fin for cl</span>
<a name="l00615"></a>00615 <span class="comment"></span>
<a name="l00616"></a>00616 <span class="comment">// Deuxieme etape: faire pointer tous les aretes periodiques liees entre elles vers la meme arete</span>
<a name="l00617"></a>00617   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_aretes_tot; i++)
<a name="l00618"></a>00618     {
<a name="l00619"></a>00619       <span class="keywordtype">int</span> j = <a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>[i];
<a name="l00620"></a>00620 <span class="comment">// Parcourir les aretes reliees pour cette chaine:</span>
<a name="l00621"></a>00621       <span class="keywordflow">while</span> (j != <a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>[j])
<a name="l00622"></a>00622         j = <a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>[j];
<a name="l00623"></a>00623       <a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>[i] = j;
<a name="l00624"></a>00624     }
<a name="l00625"></a>00625 
<a name="l00626"></a>00626   <span class="keywordflow">if</span> (<a class="code" href="classDebog.html#a76d8a5030a2cb72e4b4639a1ce97dc90" title="renvoie 1 si on est en mode Debog, 0 sinon">Debog::active</a>())
<a name="l00627"></a>00627     {
<a name="l00628"></a>00628       <a class="code" href="classIntVect.html">IntVect</a> tmp;
<a name="l00629"></a>00629       <a class="code" href="classZone__VF.html#ae77f9ddf0711c0bcf2162921698d0bea">creer_tableau_aretes</a>(tmp, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>);
<a name="l00630"></a>00630       <span class="keyword">const</span> <span class="keywordtype">int</span> n = tmp.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00631"></a>00631       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00632"></a>00632         tmp[i] = <a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(i);
<a name="l00633"></a>00633       <a class="code" href="classDebog.html#a45e9031473a651560a4d3843e41164ce" title="teste le contenu du vecteur v en supposant qu&#39;il contient des indices d&#39;items associes au descripteur...">Debog::verifier_indices_items</a>(<span class="stringliteral">&quot;renum_arete_perio&quot;</span>,tmp.<a class="code" href="classIntVect.html#ae74e1fee6aca124d32718267e33a40c6">get_md_vector</a>(),tmp);
<a name="l00634"></a>00634     }
<a name="l00635"></a>00635   <span class="comment">/*</span>
<a name="l00636"></a>00636 <span class="comment">  // Verification complete du tableau renum_arete_perio</span>
<a name="l00637"></a>00637 <span class="comment">  // Chaque arete periodique a 2 sommets periodiques</span>
<a name="l00638"></a>00638 <span class="comment">  // si on utilise le critere II</span>
<a name="l00639"></a>00639 <span class="comment">  int ok=1;</span>
<a name="l00640"></a>00640 <span class="comment">  for (int i=0;i&lt;nb_aretes_tot;i++)</span>
<a name="l00641"></a>00641 <span class="comment">  {</span>
<a name="l00642"></a>00642 <span class="comment">  int arete=renum_arete_perio(i);</span>
<a name="l00643"></a>00643 <span class="comment">  if (arete!=i)</span>
<a name="l00644"></a>00644 <span class="comment">  {</span>
<a name="l00645"></a>00645 <span class="comment">  assert(arete==renum_arete_perio(arete));</span>
<a name="l00646"></a>00646 <span class="comment">  // i est une arete periodique donc ses deux sommets doivent etre periodiques</span>
<a name="l00647"></a>00647 <span class="comment">  int S0=aretes_som(i,0);</span>
<a name="l00648"></a>00648 <span class="comment">  int S1=aretes_som(i,1);</span>
<a name="l00649"></a>00649 <span class="comment">  int som0=dom.get_renum_som_perio(S0);</span>
<a name="l00650"></a>00650 <span class="comment">  int som1=dom.get_renum_som_perio(S1);</span>
<a name="l00651"></a>00651 <span class="comment">  if (S0==som0 || S1==som1)</span>
<a name="l00652"></a>00652 <span class="comment">  {</span>
<a name="l00653"></a>00653 <span class="comment">  Cerr &lt;&lt; &quot;[&quot; &lt;&lt; Process::me() &lt;&lt; &quot;] Probleme avec l&#39;arete periodique &quot; &lt;&lt; i &lt;&lt; &quot; qui pointe sur l&#39;arete &quot; &lt;&lt; arete &lt;&lt; &quot; car&quot; &lt;&lt; finl;</span>
<a name="l00654"></a>00654 <span class="comment">  if (S0==som0) Cerr &lt;&lt; &quot;son sommet &quot; &lt;&lt; S0 &lt;&lt; &quot; n&#39;est pas periodique.&quot; &lt;&lt; finl;</span>
<a name="l00655"></a>00655 <span class="comment">  if (S1==som1) Cerr &lt;&lt; &quot;son sommet &quot; &lt;&lt; S1 &lt;&lt; &quot; n&#39;est pas periodique.&quot; &lt;&lt; finl;</span>
<a name="l00656"></a>00656 <span class="comment">  ok=0;</span>
<a name="l00657"></a>00657 <span class="comment">  }</span>
<a name="l00658"></a>00658 <span class="comment">  else</span>
<a name="l00659"></a>00659 <span class="comment">  {</span>
<a name="l00660"></a>00660 <span class="comment">  S0=dom.get_renum_som_perio(aretes_som(arete,0));</span>
<a name="l00661"></a>00661 <span class="comment">  S1=dom.get_renum_som_perio(aretes_som(arete,1));</span>
<a name="l00662"></a>00662 <span class="comment">  if ( (S0!=som0 &amp;&amp; S0!=som1) || (S1!=som0 &amp;&amp; S1!=som1) )</span>
<a name="l00663"></a>00663 <span class="comment">  {</span>
<a name="l00664"></a>00664 <span class="comment">  Cerr &lt;&lt; &quot;[&quot; &lt;&lt; Process::me() &lt;&lt; &quot;] Probleme avec l&#39;arete periodique &quot; &lt;&lt; i &lt;&lt; &quot; car il n&#39;y a pas coherence avec les sommets periodiques.&quot; &lt;&lt; finl;</span>
<a name="l00665"></a>00665 <span class="comment">  ok=0;</span>
<a name="l00666"></a>00666 <span class="comment">  }</span>
<a name="l00667"></a>00667 <span class="comment">  }</span>
<a name="l00668"></a>00668 <span class="comment">  }</span>
<a name="l00669"></a>00669 <span class="comment">  }</span>
<a name="l00670"></a>00670 <span class="comment">  // Il semble qu&#39;il puisse y&#39;a avoir un probleme sur les aretes periodiques et memes les sommets</span>
<a name="l00671"></a>00671 <span class="comment">  // periodiques sur des petits maillages lorsque la largeur de joint recouvre des bords de direction</span>
<a name="l00672"></a>00672 <span class="comment">  // de periodicite differente</span>
<a name="l00673"></a>00673 <span class="comment">  if (!ok) Process::exit();</span>
<a name="l00674"></a>00674 <span class="comment">  */</span>
<a name="l00675"></a>00675 }
<a name="l00676"></a>00676 
<a name="l00677"></a><a class="code" href="classZone__VEF__PreP1b.html#a9d92ed2ec1e522d752e616e1d8be26f4">00677</a> <span class="keywordtype">void</span> <a class="code" href="classZone__VEF__PreP1b.html#a9d92ed2ec1e522d752e616e1d8be26f4">Zone_VEF_PreP1b::verifie_ok_arete</a>(<span class="keywordtype">int</span> nombre_aretes_superflues_prevues_sur_la_zone)<span class="keyword"> const</span>
<a name="l00678"></a>00678 <span class="keyword"></span>{
<a name="l00679"></a>00679   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Check array ok_arete...&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00680"></a>00680 <span class="comment">// Algorithme de verification du tableau des aretes superflues</span>
<a name="l00681"></a>00681 <span class="comment">// ok_arete(i)==0 : i arete superflue</span>
<a name="l00682"></a>00682 <span class="comment">// ok_arete(i)==2 : i arete necessaire</span>
<a name="l00683"></a>00683 <span class="comment">// ...</span>
<a name="l00684"></a>00684 <span class="comment">// contenu doit contenir uniquement 2 ce qui implique que tous les</span>
<a name="l00685"></a>00685 <span class="comment">// sommets ont ete analyses.</span>
<a name="l00686"></a>00686   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00687"></a>00687   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_reel=<a class="code" href="classZone__VEF__PreP1b.html#a7fa6f80d06f2f6d193e9311abc68412c">nb_som</a>();
<a name="l00688"></a>00688   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; aretes_som=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#affa60690e1b372fa4c01d6088267dbe4" title="renvoie le tableau de connectivite aretes/sommets.">aretes_som</a>();
<a name="l00689"></a>00689   <span class="keywordtype">int</span> nb_aretes_pour_verbose=60; <span class="comment">//!&lt; Pour verbose</span>
<a name="l00690"></a>00690 <span class="comment"></span>  <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> sommet_relie_arete_superflue(nb_som_reel);
<a name="l00691"></a>00691   sommet_relie_arete_superflue=0;
<a name="l00692"></a>00692   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som_reel; i++) <span class="comment">//!&lt; Si i est un sommet periodique:</span>
<a name="l00693"></a>00693 <span class="comment"></span>    <span class="keywordflow">if</span> (dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(i)!=i) <span class="comment">//!&lt; il suffit de faire la verification sur le sommet dom.get_renum_som_perio(i)</span>
<a name="l00694"></a>00694 <span class="comment"></span>      sommet_relie_arete_superflue(i)=1; <span class="comment">//!&lt; donc on ne verifie pas i</span>
<a name="l00695"></a>00695 <span class="comment"></span>
<a name="l00696"></a>00696   <span class="keywordtype">double</span> nombre_aretes_reelles_superflues=0;
<a name="l00697"></a>00697 <span class="comment">// On parcourt toutes les aretes mais on ne regarde que les sommets reels</span>
<a name="l00698"></a>00698   <span class="keywordtype">int</span> nb_aretes_tot=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a59ae0ababf85ce303a7c6f339430e335" title="renvoie le nombre d&#39;aretes total (reelles+virtuelles).">nb_aretes_tot</a>();
<a name="l00699"></a>00699   <span class="keywordtype">int</span> nb_aretes_reelles=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a3e3b48691911fd85574c7bc10a1a4fb8" title="renvoie le nombre d&#39;aretes reelles.">nb_aretes</a>();
<a name="l00700"></a>00700   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_aretes_tot; i++)
<a name="l00701"></a>00701     {
<a name="l00702"></a>00702       <span class="keywordflow">if</span> (!<a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>(i)) <span class="comment">//!&lt; arete superflue</span>
<a name="l00703"></a>00703 <span class="comment"></span>        {
<a name="l00704"></a>00704           <span class="keywordtype">int</span> S0=aretes_som(i,0);
<a name="l00705"></a>00705           <span class="keywordflow">if</span> (S0&lt;nb_som_reel)
<a name="l00706"></a>00706             {
<a name="l00707"></a>00707               sommet_relie_arete_superflue(S0)=1;
<a name="l00708"></a>00708               sommet_relie_arete_superflue(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(S0))=1;
<a name="l00709"></a>00709             }
<a name="l00710"></a>00710           <span class="keywordtype">int</span> S1=aretes_som(i,1);
<a name="l00711"></a>00711           <span class="keywordflow">if</span> (S1&lt;nb_som_reel)
<a name="l00712"></a>00712             {
<a name="l00713"></a>00713               sommet_relie_arete_superflue(S1)=1;
<a name="l00714"></a>00714               sommet_relie_arete_superflue(dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(S1))=1;
<a name="l00715"></a>00715             }
<a name="l00716"></a>00716           <span class="keywordflow">if</span> (<a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(i)==i) <span class="comment">//!&lt; Pour ne compter les aretes periodiques qu&#39;une fois</span>
<a name="l00717"></a>00717 <span class="comment"></span>            {
<a name="l00718"></a>00718               <span class="keywordflow">if</span> (nb_aretes_tot&lt;nb_aretes_pour_verbose)
<a name="l00719"></a>00719                 {
<a name="l00720"></a>00720                   <span class="keywordflow">if</span> (<a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(i)==i) <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot;] Arete &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; superflue non perio: &quot;</span> &lt;&lt; S0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; S1 &lt;&lt; finl;
<a name="l00721"></a>00721                   <span class="keywordflow">else</span> <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot;] Arete &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; superflue perio: &quot;</span> &lt;&lt; S0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; S1 &lt;&lt; <span class="stringliteral">&quot; Periodique avec &quot;</span> &lt;&lt; <a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(i) &lt;&lt; finl;
<a name="l00722"></a>00722                 }
<a name="l00723"></a>00723               <span class="keywordtype">int</span> aretes_superflues_communes=1;
<a name="l00724"></a>00724 <span class="comment">// Si l&#39;arete superflue est commune on en tient compte</span>
<a name="l00725"></a>00725               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a16f273a76321d31435995cdad664285a" title="Renvoie la liste des joints de la zone. (version const)">faces_joint</a>().<a class="code" href="classliste.html#ab47f280662ff68f9aa2e00e50431c5dc" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>(); j++)
<a name="l00726"></a>00726                 {
<a name="l00727"></a>00727                   <span class="keywordtype">int</span> nb_aretes_sur_le_joint = dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a16f273a76321d31435995cdad664285a" title="Renvoie la liste des joints de la zone. (version const)">faces_joint</a>()(j).joint_item(<a class="code" href="classJoint.html#a1e2d15d088c27c9b7b11c02bf4d2c926a7816c69408b98e1161f1f54e7b6b1cb4">Joint::ARETE</a>).items_communs().size_array();
<a name="l00728"></a>00728                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nb_aretes_sur_le_joint; k++)
<a name="l00729"></a>00729                     <span class="keywordflow">if</span> (dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a16f273a76321d31435995cdad664285a" title="Renvoie la liste des joints de la zone. (version const)">faces_joint</a>()(j).joint_item(<a class="code" href="classJoint.html#a1e2d15d088c27c9b7b11c02bf4d2c926a7816c69408b98e1161f1f54e7b6b1cb4">Joint::ARETE</a>).items_communs()(k)==i) aretes_superflues_communes++;
<a name="l00730"></a>00730                 }
<a name="l00731"></a>00731 <span class="comment">// On compte les aretes reelles superflues</span>
<a name="l00732"></a>00732               <span class="keywordflow">if</span> (i&lt;nb_aretes_reelles)
<a name="l00733"></a>00733                 nombre_aretes_reelles_superflues+=1./aretes_superflues_communes;
<a name="l00734"></a>00734             }
<a name="l00735"></a>00735         }
<a name="l00736"></a>00736     }
<a name="l00737"></a>00737 
<a name="l00738"></a>00738   <span class="keywordflow">if</span> (nb_som_reel &gt; 0 &amp;&amp; <a class="code" href="ArrOfDouble_8cpp.html#abd3998749a1a8dab00dd6ac1798327fb" title="Retourne la valeur minimale.">min_array</a>(sommet_relie_arete_superflue)==0)
<a name="l00739"></a>00739     {
<a name="l00740"></a>00740       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot;] Il y&#39;a au moins un sommet qui n&#39;est pas relie a une arete superflue :&quot;</span> &lt;&lt; finl;
<a name="l00741"></a>00741       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;sommet_relie_arete_superflue.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>(); i++)
<a name="l00742"></a>00742         <span class="keywordflow">if</span> (sommet_relie_arete_superflue(i)==0) <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Sommet &quot;</span> &lt;&lt; i &lt;&lt; finl;
<a name="l00743"></a>00743       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00744"></a>00744     }
<a name="l00745"></a>00745   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;[&quot;</span> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot;] Verification que chaque sommet non periodique est bien relie a au moins une arete superflue: OK!&quot;</span> &lt;&lt; finl;
<a name="l00746"></a>00746 <span class="comment">// On compte le nombre total de sommets en tenant compte de la periodicite et des sommets communs</span>
<a name="l00747"></a>00747   <span class="keywordtype">double</span> nb_sommets_non_periodiques=0;
<a name="l00748"></a>00748   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som_reel; i++)
<a name="l00749"></a>00749     <span class="keywordflow">if</span> (dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(i)==i) <span class="comment">//!&lt; Sommet non periodique</span>
<a name="l00750"></a>00750 <span class="comment"></span>      {
<a name="l00751"></a>00751         <span class="keywordtype">int</span> sommets_communs=1;
<a name="l00752"></a>00752 <span class="comment">// On tient compte des sommets communs</span>
<a name="l00753"></a>00753         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a16f273a76321d31435995cdad664285a" title="Renvoie la liste des joints de la zone. (version const)">faces_joint</a>().<a class="code" href="classliste.html#ab47f280662ff68f9aa2e00e50431c5dc" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>(); j++)
<a name="l00754"></a>00754           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a16f273a76321d31435995cdad664285a" title="Renvoie la liste des joints de la zone. (version const)">faces_joint</a>()(j).joint_item(<a class="code" href="classJoint.html#a1e2d15d088c27c9b7b11c02bf4d2c926a050aa4faf237e25faef6fff15ffc20f8">Joint::SOMMET</a>).items_communs().size_array(); k++)
<a name="l00755"></a>00755             <span class="keywordflow">if</span> (dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a16f273a76321d31435995cdad664285a" title="Renvoie la liste des joints de la zone. (version const)">faces_joint</a>()(j).joint_item(<a class="code" href="classJoint.html#a1e2d15d088c27c9b7b11c02bf4d2c926a050aa4faf237e25faef6fff15ffc20f8">Joint::SOMMET</a>).items_communs()(k)==i) sommets_communs++;
<a name="l00756"></a>00756         nb_sommets_non_periodiques+=1./sommets_communs;
<a name="l00757"></a>00757       }
<a name="l00758"></a>00758   <span class="keywordtype">double</span> total_nombre_aretes_superflues=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_sum</a>(nombre_aretes_reelles_superflues);
<a name="l00759"></a>00759   <span class="keywordtype">double</span> somme_nombre_aretes_superflues_prevues_par_zone=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_sum</a>(nombre_aretes_superflues_prevues_sur_la_zone);
<a name="l00760"></a>00760   <span class="keywordtype">double</span> total_nb_sommets_non_periodiques=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_sum</a>(nb_sommets_non_periodiques);
<a name="l00761"></a>00761 
<a name="l00762"></a>00762 
<a name="l00763"></a>00763 <span class="comment">// Cerr &lt;&lt; &quot;Nombre de sommets non periodiques           = &quot; &lt;&lt; total_nb_sommets_non_periodiques &lt;&lt; finl;</span>
<a name="l00764"></a>00764 <span class="comment">// Cerr &lt;&lt; &quot;Nombre de sommets periodiques               =  &quot; &lt;&lt; nb_som_reel-total_nb_sommets_non_periodiques &lt;&lt; finl;</span>
<a name="l00765"></a>00765   <span class="keywordtype">int</span> nb_aretes_periodiques=0;
<a name="l00766"></a>00766   <span class="keywordtype">int</span> nb_aretes_perio_superflues=0;
<a name="l00767"></a>00767   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_aretes_tot; i++)
<a name="l00768"></a>00768     {
<a name="l00769"></a>00769       <span class="keywordflow">if</span> (<a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(i)!=i)
<a name="l00770"></a>00770         {
<a name="l00771"></a>00771           nb_aretes_periodiques++;
<a name="l00772"></a>00772           assert(<a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>(i)==<a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>(<a class="code" href="classZone__VEF__PreP1b.html#a45e47bbfabf494b8d2573ffad5b47dee">renum_arete_perio</a>(i)));
<a name="l00773"></a>00773           <span class="keywordflow">if</span> (!<a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>(i))
<a name="l00774"></a>00774             nb_aretes_perio_superflues++;
<a name="l00775"></a>00775         }
<a name="l00776"></a>00776     }
<a name="l00777"></a>00777 <span class="comment">// Cerr &lt;&lt; &quot;Nombre d&#39;aretes non periodiques             = &quot; &lt;&lt; nb_aretes_tot-nb_aretes_periodiques &lt;&lt; finl;</span>
<a name="l00778"></a>00778 <span class="comment">// Cerr &lt;&lt; &quot;Nombre d&#39;aretes periodiques                 =  &quot; &lt;&lt; nb_aretes_periodiques &lt;&lt; finl;</span>
<a name="l00779"></a>00779 
<a name="l00780"></a>00780 <span class="comment">// Cerr &lt;&lt; &quot;Nombre d&#39;aretes superflues                  =  &quot; &lt;&lt; total_nombre_aretes_superflues &lt;&lt; finl;</span>
<a name="l00781"></a>00781 <span class="comment">// Cerr &lt;&lt; &quot;Nombre d&#39;aretes superflues periodiques      =  &quot; &lt;&lt; nb_aretes_perio_superflues &lt;&lt; finl;</span>
<a name="l00782"></a>00782 <span class="comment">// Cerr &lt;&lt; &quot;Nombre d&#39;aretes non superflues periodiques  =  &quot; &lt;&lt; nb_aretes_periodiques-nb_aretes_perio_superflues &lt;&lt; finl;</span>
<a name="l00783"></a>00783 
<a name="l00784"></a>00784   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>()==1) <span class="comment">//!&lt; On se limite au sequentiel car il y&#39;a un soucis pour le calcul de total_nombre_aretes_superflues (les items communs pour les aretes n&#39;est pas construit!)</span>
<a name="l00785"></a>00785 <span class="comment"></span>    <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(somme_nombre_aretes_superflues_prevues_par_zone,total_nombre_aretes_superflues) &amp;&amp; <a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00786"></a>00786       {
<a name="l00787"></a>00787         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;La somme des aretes superflues prevues par zone n&#39;est pas egale au nombre d&#39;aretes superflues trouvees sur le domaine.&quot;</span> &lt;&lt; finl;
<a name="l00788"></a>00788         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; somme_nombre_aretes_superflues_prevues_par_zone &lt;&lt; <span class="stringliteral">&quot; != &quot;</span> &lt;&lt; total_nombre_aretes_superflues &lt;&lt; finl;
<a name="l00789"></a>00789         <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00790"></a>00790       }
<a name="l00791"></a>00791   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
<a name="l00792"></a>00792     {
<a name="l00793"></a>00793       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Nombre total d&#39;aretes superflues: &quot;</span> &lt;&lt; somme_nombre_aretes_superflues_prevues_par_zone &lt;&lt; finl;
<a name="l00794"></a>00794       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Nombre total de sommets non periodiques = &quot;</span> &lt;&lt; total_nb_sommets_non_periodiques &lt;&lt; finl;
<a name="l00795"></a>00795       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Verification de l&#39;egalite du nombre total d&#39;aretes superflues et du nombre total de sommets: &quot;</span>;
<a name="l00796"></a>00796     }
<a name="l00797"></a>00797 <span class="comment">// Verification que le nombre d&#39;aretes superflues et egal au nombre de sommets</span>
<a name="l00798"></a>00798   <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(somme_nombre_aretes_superflues_prevues_par_zone,total_nb_sommets_non_periodiques) &amp;&amp; <a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00799"></a>00799     {
<a name="l00800"></a>00800       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Non correspondance. Echec de l&#39;algorithme de recherche des aretes superflues.&quot;</span> &lt;&lt; finl;
<a name="l00801"></a>00801       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00802"></a>00802     }
<a name="l00803"></a>00803   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;OK!&quot;</span> &lt;&lt; finl &lt;&lt; <span class="stringliteral">&quot;Verification correcte des aretes superflues.&quot;</span> &lt;&lt; finl;
<a name="l00804"></a>00804 }
<a name="l00805"></a>00805 
<a name="l00806"></a>00806 <span class="comment">// Valeur de retour:</span>
<a name="l00807"></a>00807 <span class="comment">// 1: ok</span>
<a name="l00808"></a>00808 <span class="comment">// 0: fichier inexistant</span>
<a name="l00809"></a>00809 <span class="comment">// -1: fichier existe mais pas le bon nombre d&#39;aretes</span>
<a name="l00810"></a><a class="code" href="classZone__VEF__PreP1b.html#a59c954bb36bb58b883d4178fc6e05138">00810</a> <span class="keywordtype">int</span> <a class="code" href="classZone__VEF__PreP1b.html#a59c954bb36bb58b883d4178fc6e05138">Zone_VEF_PreP1b::lecture_ok_arete</a>()
<a name="l00811"></a>00811 {
<a name="l00812"></a>00812   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> fichier(<a class="code" href="classObjet__U.html#a7c27c4f80259eeef76ff8fe2d3bc61f7" title="Renvoie une reference constante vers le nom du cas. Cette methode est statique.">nom_du_cas</a>());
<a name="l00813"></a>00813   fichier+=<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00814"></a>00814   fichier+=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>()+<span class="stringliteral">&quot;.ok_arete&quot;</span>;
<a name="l00815"></a>00815 
<a name="l00816"></a>00816   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Trying to read file &quot;</span> &lt;&lt; fichier &lt;&lt; <span class="stringliteral">&quot; (edges to remove from the set of degrees of freedom)&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00817"></a>00817   <a class="code" href="classEFichierBin.html" title="Lecture dans un fichier d&#39;objets ecrits au format binaire.">EFichierBin</a> fic_ok_arete_;
<a name="l00818"></a>00818 <span class="comment">// Lecture de ok_arete dans un fichier pour comparaison sequentiel-parallele</span>
<a name="l00819"></a>00819   <span class="keywordflow">if</span> (!fic_ok_arete_.<a class="code" href="classEntree__Fichier__base.html#a8e34b235668e94f335cc9ab18dd4e427">ouvrir</a>(fichier,ios::out))
<a name="l00820"></a>00820     {
<a name="l00821"></a>00821       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;File &quot;</span> &lt;&lt; fichier &lt;&lt; <span class="stringliteral">&quot; does not exist.&quot;</span> &lt;&lt; finl;
<a name="l00822"></a>00822       <span class="keywordflow">return</span> 0;
<a name="l00823"></a>00823     }
<a name="l00824"></a>00824 
<a name="l00825"></a>00825   <span class="keywordtype">int</span> n;
<a name="l00826"></a>00826   fic_ok_arete_ &gt;&gt; n;
<a name="l00827"></a>00827   <span class="keywordflow">if</span> (n != <a class="code" href="classZone__VF.html#a93f73d93187a780a1b927be5b3d5c2a2">md_vector_aretes</a>().<a class="code" href="classMD__Vector.html#a41324dfaa7a973091d0a8276908d10e2">valeur</a>().<a class="code" href="classMD__Vector__base.html#a47d5867ac692b62645169eae6e2cafa0">nb_items_seq_tot</a>())
<a name="l00828"></a>00828     {
<a name="l00829"></a>00829       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;File &quot;</span> &lt;&lt; fichier &lt;&lt; <span class="stringliteral">&quot; is not compatible with the current mesh.&quot;</span> &lt;&lt; finl;
<a name="l00830"></a>00830       <span class="keywordflow">return</span> 0;
<a name="l00831"></a>00831     }
<a name="l00832"></a>00832 
<a name="l00833"></a>00833   <a class="code" href="classOctree__Double.html" title=": Un octree permettant de chercher dans l&#39;espace des elements ou des points decrits par des coordonne...">Octree_Double</a> octree;
<a name="l00834"></a>00834   octree.<a class="code" href="classOctree__Double.html#a0b66bd315e7f45a024695b6a2764e7d4" title="construit un octree contenant les points de coordonnees coords. Si include_virtual=1, on stocke coords.dimension_tot(0) elements, sinon on en stocke coords.dimension(0) Si epsilon = 0, on construit un octree de points de taille nulle (chaque point se trouve dans un seul octree_floor) Sinon, on construit un octree d&#39;elements cubiques centres sur les coords, de demie-largeur epsilon. Un point peut alors se trouver dans plusieurs octree_floor.">build_nodes</a>(<a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>, 1 <span class="comment">/* include virtual nodes */</span>);
<a name="l00835"></a>00835   <span class="keyword">const</span> <span class="keywordtype">double</span> eps = <a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">precision_geom</a>;
<a name="l00836"></a>00836   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> liste_aretes;
<a name="l00837"></a>00837   liste_aretes.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);
<a name="l00838"></a>00838 
<a name="l00839"></a>00839   <a class="code" href="classIntVect.html">IntVect</a> marqueurs;
<a name="l00840"></a>00840   <a class="code" href="classZone__VF.html#ae77f9ddf0711c0bcf2162921698d0bea">creer_tableau_aretes</a>(marqueurs); <span class="comment">//!&lt; initialise a zero par defaut</span>
<a name="l00841"></a>00841 <span class="comment"></span>
<a name="l00842"></a>00842   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l00843"></a>00843     {
<a name="l00844"></a>00844       <span class="keywordtype">double</span> x, y, z;
<a name="l00845"></a>00845       <span class="keywordtype">int</span> flag;
<a name="l00846"></a>00846       fic_ok_arete_ &gt;&gt; x &gt;&gt; y &gt;&gt; z &gt;&gt; flag;
<a name="l00847"></a>00847       octree.<a class="code" href="classOctree__Double.html#a1dffcace51ca06cb52ff6e2330ab4b2e" title="cherche tous les elements ou points ayant potentiellement une intersection non vide avec la boite don...">search_elements_box</a>(x-eps, y-eps, z-eps, x+eps, y+eps, z+eps, liste_aretes);
<a name="l00848"></a>00848       octree.<a class="code" href="classOctree__Double.html#a8ba1f6ceba5dae2af587d2f9a766aac2" title="Methode hors classe Cherche parmi les sommets de la liste node_list ceux qui sont a une distance infe...">search_nodes_close_to</a>(x, y, z, <a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>, liste_aretes, eps);
<a name="l00849"></a>00849       <span class="keyword">const</span> <span class="keywordtype">int</span> m = liste_aretes.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00850"></a>00850       <span class="keywordflow">if</span> (m &gt; 1)
<a name="l00851"></a>00851         {
<a name="l00852"></a>00852           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;File &quot;</span> &lt;&lt; fichier &lt;&lt; <span class="stringliteral">&quot; is not compatible with the current mesh.&quot;</span> &lt;&lt; finl;
<a name="l00853"></a>00853           <span class="keywordflow">return</span> 0;
<a name="l00854"></a>00854         }
<a name="l00855"></a>00855       <span class="keywordflow">if</span> (m == 1)
<a name="l00856"></a>00856         {
<a name="l00857"></a>00857           <span class="keyword">const</span> <span class="keywordtype">int</span> arete = liste_aretes[0];
<a name="l00858"></a>00858           <a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>[arete] = flag;
<a name="l00859"></a>00859           marqueurs[arete]++;
<a name="l00860"></a>00860         }
<a name="l00861"></a>00861       <span class="keywordflow">else</span>
<a name="l00862"></a>00862         {
<a name="l00863"></a>00863 <span class="comment">// Normal en parallele: on n&#39;a pas toutes les aretes sur tous les procs...</span>
<a name="l00864"></a>00864         }
<a name="l00865"></a>00865     }
<a name="l00866"></a>00866 
<a name="l00867"></a>00867 <span class="comment">// On doit avoir trouve exactement une fois toutes les aretes:</span>
<a name="l00868"></a>00868   <span class="keywordflow">if</span> (<a class="code" href="ArrOfDouble_8cpp.html#a95241fccf4bed7fb7a4e2340b7735f14" title="Retourne la valeur maximale.">max_array</a>(marqueurs) &gt; 1 || <a class="code" href="ArrOfDouble_8cpp.html#abd3998749a1a8dab00dd6ac1798327fb" title="Retourne la valeur minimale.">min_array</a>(marqueurs) &lt; 1)
<a name="l00869"></a>00869     {
<a name="l00870"></a>00870       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;File &quot;</span> &lt;&lt; fichier &lt;&lt; <span class="stringliteral">&quot; is not compatible with the current mesh.&quot;</span> &lt;&lt; finl;
<a name="l00871"></a>00871       <span class="keywordflow">return</span> 0;
<a name="l00872"></a>00872     }
<a name="l00873"></a>00873   <span class="keywordflow">else</span>
<a name="l00874"></a>00874     <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;File &quot;</span> &lt;&lt; fichier &lt;&lt; <span class="stringliteral">&quot; is OK.&quot;</span> &lt;&lt; finl;
<a name="l00875"></a>00875   fic_ok_arete_.<a class="code" href="classEntree__Fichier__base.html#aca9165bc1712c1057b4d4b91a7ea4fb4">close</a>();
<a name="l00876"></a>00876   <a class="code" href="Check__espace__virtuel_8cpp.html#a2ea8fcf12c28d0454bdc4126f8c4b186" title="en mode comm_check_enabled(), verifie si l&#39;espace virtuel du vecteur est a jour, si ce n&#39;est pas le c...">assert_espace_virtuel_vect</a>(<a class="code" href="classZone__VEF__PreP1b.html#ab8280708583d04f81669f952736e8238">ok_arete</a>);
<a name="l00877"></a>00877 
<a name="l00878"></a>00878   <span class="keywordflow">return</span> 1;
<a name="l00879"></a>00879 }
<a name="l00880"></a>00880 
<a name="l00881"></a><a class="code" href="classZone__VEF__PreP1b.html#a64a6c29d09c05dc497565ada8f71dc7f">00881</a> <span class="keywordtype">void</span> <a class="code" href="classZone__VEF__PreP1b.html#a64a6c29d09c05dc497565ada8f71dc7f">Zone_VEF_PreP1b::creer_tableau_p1bulle</a>(<a class="code" href="classArray__base.html" title=": classe vide servant de base a tous les tableaux. (permet de passer un type generique quel que soit ...">Array_base</a>&amp; x, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ff">Array_base::Resize_Options</a> opt)<span class="keyword"> const</span>
<a name="l00882"></a>00882 <span class="keyword"></span>{
<a name="l00883"></a>00883   <span class="keyword">const</span> <a class="code" href="classMD__Vector.html" title=": Cette classe est un DERIV mais l&#39;objet pointe est partage entre plusieurs instances de cette classe...">MD_Vector</a>&amp; md = <a class="code" href="classZone__VEF__PreP1b.html#a5e28cf9f58082bbdeabe98c24684bec0">md_vector_p1b</a>();
<a name="l00884"></a>00884   <a class="code" href="MD__Vector__tools_8cpp.html#aff1ed2791dba1a76fdb300920147cfdf">MD_Vector_tools::creer_tableau_distribue</a>(md, x, opt);
<a name="l00885"></a>00885 }
<a name="l00886"></a>00886 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:29 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
