<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Champs_dis/Champ_Q4_implementation.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Champs_dis/Champ_Q4_implementation.h</div>  </div>
</div>
<div class="contents">
<a href="Champ__Q4__implementation_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2017, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Champ_Q4_implementation.h</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Champs_dis</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/10</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#ifndef Champ_Q4_implementation_included</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor">#define Champ_Q4_implementation_included</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Champ__implementation_8h.html">Champ_implementation.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="IntTab_8h.html">IntTab.h</a>&gt;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">// </span>
<a name="l00030"></a><a class="code" href="classChamp__Q4__implementation.html">00030</a> <span class="keyword">class </span><a class="code" href="classChamp__Q4__implementation.html">Champ_Q4_implementation</a> : <span class="keyword">public</span> <a class="code" href="classChamp__implementation.html">Champ_implementation</a>
<a name="l00031"></a>00031 {
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="keyword">public</span>:
<a name="l00034"></a>00034 
<a name="l00035"></a>00035   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classChamp__Q4__implementation.html#a0f6fe22db1b8e67e029e12987fc5b6ec">valeur_a_elem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; position,
<a name="l00036"></a>00036                             <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; val,
<a name="l00037"></a>00037                             <span class="keywordtype">int</span> le_poly) <span class="keyword">const</span>;
<a name="l00038"></a>00038   <span class="keywordtype">double</span> <a class="code" href="classChamp__Q4__implementation.html#a4de11350a5a5f4a4d895964972de6c24">valeur_a_elem_compo</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; position,
<a name="l00039"></a>00039                              <span class="keywordtype">int</span> le_poly, <span class="keywordtype">int</span> ncomp) <span class="keyword">const</span>;
<a name="l00040"></a>00040   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__Q4__implementation.html#af56b1b9d723c4f539915d1b6c20d60bd">valeur_aux_elems</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions,
<a name="l00041"></a>00041                               <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; les_polys,
<a name="l00042"></a>00042                               <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; valeurs) <span class="keyword">const</span>;
<a name="l00043"></a>00043   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classChamp__Q4__implementation.html#ab423d951ca85f02d8fa264124c0dbeb0">valeur_aux_elems_compo</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions,
<a name="l00044"></a>00044                                      <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; les_polys,
<a name="l00045"></a>00045                                      <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; valeurs,
<a name="l00046"></a>00046                                      <span class="keywordtype">int</span> ncomp) <span class="keyword">const</span> ;
<a name="l00047"></a>00047   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__Q4__implementation.html#a5abf0d7a12d4cead4ab734dd299ee592">valeur_aux_sommets</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp;, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;) <span class="keyword">const</span>;
<a name="l00048"></a>00048   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classChamp__Q4__implementation.html#a429ace6a77ffc78dd988d32d685c57ca">valeur_aux_sommets_compo</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp;,
<a name="l00049"></a>00049                                        <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp;, <span class="keywordtype">int</span>) <span class="keyword">const</span>;
<a name="l00050"></a>00050   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__Q4__implementation.html#ad6629c9fbd8c1a8d04346f4ffdd59c47">remplir_coord_noeuds</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions) <span class="keyword">const</span>;
<a name="l00051"></a>00051   <span class="keywordtype">int</span> <a class="code" href="classChamp__Q4__implementation.html#a5ce10d5bd40cfcb7bc77f1bd2f7de180">remplir_coord_noeuds_et_polys</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions,
<a name="l00052"></a>00052                                     <a class="code" href="classIntVect.html">IntVect</a>&amp; polys) <span class="keyword">const</span>;
<a name="l00053"></a>00053   <span class="keywordtype">int</span> <a class="code" href="classChamp__Q4__implementation.html#aef0aa8a407db8cdff57e80df0705859b">imprime_Q4</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; , <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00054"></a>00054 };
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="comment">// Precondition:</span>
<a name="l00057"></a>00057 <span class="comment">// Parametre: IntTab&amp; polys</span>
<a name="l00058"></a>00058 <span class="comment">// Signification: tableau contenant les numeros des elements</span>
<a name="l00059"></a>00059 <span class="comment">// par rapport auxquels on veut calculer une</span>
<a name="l00060"></a>00060 <span class="comment">// coordonnee barycentrique.</span>
<a name="l00061"></a>00061 <span class="comment">// polys(i,0) est l&#39;indice du sommet 0 de l&#39;element</span>
<a name="l00062"></a>00062 <span class="comment">// i dans le tableau des coordonnees (coord).</span>
<a name="l00063"></a>00063 <span class="comment">// Valeurs par defaut:</span>
<a name="l00064"></a>00064 <span class="comment">// Contraintes: reference constante</span>
<a name="l00065"></a>00065 <span class="comment">// Acces: entree</span>
<a name="l00066"></a>00066 <span class="comment">// Parametre: DoubleTab&amp; coord</span>
<a name="l00067"></a>00067 <span class="comment">// Signification: les coordonnees des sommets par auxquels on veut</span>
<a name="l00068"></a>00068 <span class="comment">// calculer les coordonnees barycentriques.</span>
<a name="l00069"></a>00069 <span class="comment">// Valeurs par defaut:</span>
<a name="l00070"></a>00070 <span class="comment">// Contraintes: reference constante</span>
<a name="l00071"></a>00071 <span class="comment">// Acces: entree</span>
<a name="l00072"></a>00072 <span class="comment">// Parametre: double x</span>
<a name="l00073"></a>00073 <span class="comment">// Signification: la premiere coordonnee cartesienne du point dont</span>
<a name="l00074"></a>00074 <span class="comment">// on veut calculer les coordonnees barycentriques</span>
<a name="l00075"></a>00075 <span class="comment">// Valeurs par defaut:</span>
<a name="l00076"></a>00076 <span class="comment">// Contraintes:</span>
<a name="l00077"></a>00077 <span class="comment">// Acces: entree</span>
<a name="l00078"></a>00078 <span class="comment">// Parametre: double y</span>
<a name="l00079"></a>00079 <span class="comment">// Signification: la deuxieme coordonnee cartesienne du point dont</span>
<a name="l00080"></a>00080 <span class="comment">// on veut calculer les coordonnees barycentriques</span>
<a name="l00081"></a>00081 <span class="comment">// Valeurs par defaut:</span>
<a name="l00082"></a>00082 <span class="comment">// Contraintes:</span>
<a name="l00083"></a>00083 <span class="comment">// Acces: entree</span>
<a name="l00084"></a>00084 <span class="comment">// Parametre: int le_poly</span>
<a name="l00085"></a>00085 <span class="comment">// Signification: le numero de l&#39;element (dans le tableau polys) par</span>
<a name="l00086"></a>00086 <span class="comment">// rapport auquel on calculera la coordonnee barycentrique.</span>
<a name="l00087"></a>00087 <span class="comment">// Valeurs par defaut:</span>
<a name="l00088"></a>00088 <span class="comment">// Contraintes:</span>
<a name="l00089"></a>00089 <span class="comment">// Acces: entre</span>
<a name="l00090"></a>00090 <span class="comment">// Parametre: int i</span>
<a name="l00091"></a>00091 <span class="comment">// Signification: le numero du sommet par rapport auquel on veut la</span>
<a name="l00092"></a>00092 <span class="comment">// coordonnee barycentrique.</span>
<a name="l00093"></a>00093 <span class="comment">// Valeurs par defaut:</span>
<a name="l00094"></a>00094 <span class="comment">// Contraintes: Triangle  0 &lt;= i &lt;= 2</span>
<a name="l00095"></a>00095 <span class="comment">// Contraintes: Rectangle 0 &lt;= i &lt;= 3</span>
<a name="l00096"></a>00096 <span class="comment">// Acces: entree</span>
<a name="l00097"></a>00097 <span class="comment">// Exception: erreur arithmetique, denominateur nul</span>
<a name="l00098"></a>00098 <span class="comment">// Exception: erreur de calcul, coordonnee barycentrique invalide</span>
<a name="l00099"></a>00099 <span class="comment">// Effets de bord:</span>
<a name="l00100"></a>00100 <span class="comment">// Postcondition:</span>
<a name="l00101"></a>00101 <span class="comment">//</span>
<a name="l00102"></a>00102 <span class="comment">//</span>
<a name="l00103"></a>00103 <span class="comment">//</span><span class="comment"></span>
<a name="l00104"></a>00104 <span class="comment">//! Calcule la coordonnee barycentrique d&#39;un point (x,y) par&lt;br&gt;rapport au sommet specifie d&#39;un triangle ou d&#39;un rectange (un element)&lt;br&gt;Ce calcul concerne un point 2D.</span>
<a name="l00105"></a>00105 <span class="comment"></span><span class="comment">/** \return double&lt;br&gt;</span>
<a name="l00106"></a>00106 <span class="comment">Signification: la coordonnee barycentrique du point (x,y) par rapport&lt;br&gt;</span>
<a name="l00107"></a>00107 <span class="comment">au sommet specifie (i) dans l&#39;element specifie (le_poly)&lt;br&gt;</span>
<a name="l00108"></a>00108 <span class="comment">Contraintes: 0 &lt;= valeur &lt;= 1&lt;br&gt;</span>
<a name="l00109"></a>00109 <span class="comment">Excpetion: un triangle n&#39;a pas plus de 3 sommets&lt;br&gt;</span>
<a name="l00110"></a>00110 <span class="comment">Excpetion: un rectangle n&#39;a pas plus de 4 sommets */</span>
<a name="l00111"></a><a class="code" href="Champ__Q4__implementation_8h.html#a60d40e1f406b741a2f8de05b560a7148">00111</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="Champ__Q4__implementation_8h.html#a60d40e1f406b741a2f8de05b560a7148" title="Calcule la coordonnee barycentrique d&#39;un point (x,y) par rapport au sommet specifie d&#39;un triangle ou ...">coord_barycentrique</a>(<span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; polys,
<a name="l00112"></a>00112                                   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord,
<a name="l00113"></a>00113                                   <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">int</span> le_poly, <span class="keywordtype">int</span> i)
<a name="l00114"></a>00114 {
<a name="l00115"></a>00115   <span class="keywordtype">int</span> som0,som1,som2;
<a name="l00116"></a>00116   <span class="keywordtype">int</span> nb_som_elem = polys.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00117"></a>00117 <span class="comment">// Distinction du calcul de la coordonnee barycentrique en fonction du type de l element</span>
<a name="l00118"></a>00118 <span class="comment">// Cas Triangle</span>
<a name="l00119"></a>00119   <span class="keywordflow">if</span> (nb_som_elem==3)
<a name="l00120"></a>00120     {
<a name="l00121"></a>00121       <span class="keywordflow">switch</span>(i)
<a name="l00122"></a>00122         {
<a name="l00123"></a>00123         <span class="keywordflow">case</span> 0 :
<a name="l00124"></a>00124           {
<a name="l00125"></a>00125             som0=polys(le_poly , 0);
<a name="l00126"></a>00126             som1=polys(le_poly , 1);
<a name="l00127"></a>00127             som2=polys(le_poly , 2);
<a name="l00128"></a>00128             <span class="keywordflow">break</span>;
<a name="l00129"></a>00129           }
<a name="l00130"></a>00130         <span class="keywordflow">case</span> 1 :
<a name="l00131"></a>00131           {
<a name="l00132"></a>00132             som0=polys(le_poly , 1);
<a name="l00133"></a>00133             som1=polys(le_poly , 2);
<a name="l00134"></a>00134             som2=polys(le_poly , 0);
<a name="l00135"></a>00135             <span class="keywordflow">break</span>;
<a name="l00136"></a>00136           }
<a name="l00137"></a>00137         <span class="keywordflow">case</span> 2 :
<a name="l00138"></a>00138           {
<a name="l00139"></a>00139             som0=polys(le_poly , 2);
<a name="l00140"></a>00140             som1=polys(le_poly , 0);
<a name="l00141"></a>00141             som2=polys(le_poly , 1);
<a name="l00142"></a>00142             <span class="keywordflow">break</span>;
<a name="l00143"></a>00143           }
<a name="l00144"></a>00144         <span class="keywordflow">default</span> :
<a name="l00145"></a>00145           {
<a name="l00146"></a>00146             som0=-1;
<a name="l00147"></a>00147             som1=-1;
<a name="l00148"></a>00148             som2=-1;
<a name="l00149"></a>00149             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Champ_P1::coord_barycentrique : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00150"></a>00150             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;A triangle does not have &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;nodes &quot;</span> &lt;&lt; finl;
<a name="l00151"></a>00151             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00152"></a>00152           }
<a name="l00153"></a>00153 
<a name="l00154"></a>00154         }
<a name="l00155"></a>00155       <span class="keywordtype">double</span> den = (coord(som2,0)-coord(som1,0))*(coord(som0,1)-coord(som1,1))
<a name="l00156"></a>00156                    - (coord(som2,1)-coord(som1,1))*(coord(som0,0)-coord(som1,0));
<a name="l00157"></a>00157 
<a name="l00158"></a>00158       <span class="keywordtype">double</span> num = (coord(som2,0)-coord(som1,0))*(y-coord(som1,1))
<a name="l00159"></a>00159                    - (coord(som2,1)-coord(som1,1))*(x-coord(som1,0));
<a name="l00160"></a>00160 
<a name="l00161"></a>00161       assert (den != 0.);
<a name="l00162"></a>00162       <span class="keywordtype">double</span> coord_bary=num/den;
<a name="l00163"></a>00163       <span class="keywordflow">if</span> ((coord_bary &lt; -<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>) || (coord_bary &gt; 1.+<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>))
<a name="l00164"></a>00164         {
<a name="l00165"></a>00165           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: The barycentric coordinate of point :&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00166"></a>00166           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;x= &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; y=&quot;</span> &lt;&lt; y &lt;&lt; finl;
<a name="l00167"></a>00167           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;is not between 0 and 1 : &quot;</span> &lt;&lt; coord_bary &lt;&lt; finl;
<a name="l00168"></a>00168           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On the element &quot;</span> &lt;&lt; le_poly &lt;&lt; <span class="stringliteral">&quot; of the processor &quot;</span> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; finl;
<a name="l00169"></a>00169         }
<a name="l00170"></a>00170       <span class="keywordflow">return</span> coord_bary;
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172 <span class="comment">// Cas Rectangle</span>
<a name="l00173"></a>00173   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nb_som_elem==4)
<a name="l00174"></a>00174     {
<a name="l00175"></a>00175       <span class="keywordtype">double</span> alpha_x=0.;
<a name="l00176"></a>00176       <span class="keywordtype">double</span> alpha_y=0.;
<a name="l00177"></a>00177       <span class="keywordtype">double</span> delta_x, delta_y;
<a name="l00178"></a>00178 <span class="comment">// int som0,som1,som2;</span>
<a name="l00179"></a>00179       <span class="keywordtype">double</span> x0,y0;
<a name="l00180"></a>00180 
<a name="l00181"></a>00181       <span class="keywordflow">switch</span>(i)
<a name="l00182"></a>00182         {
<a name="l00183"></a>00183         <span class="keywordflow">case</span> 0 :
<a name="l00184"></a>00184           {
<a name="l00185"></a>00185             alpha_x = -1.;
<a name="l00186"></a>00186             alpha_y = -1;
<a name="l00187"></a>00187 
<a name="l00188"></a>00188             <span class="keywordflow">break</span>;
<a name="l00189"></a>00189           }
<a name="l00190"></a>00190         <span class="keywordflow">case</span> 1 :
<a name="l00191"></a>00191           {
<a name="l00192"></a>00192             alpha_x = 1.;
<a name="l00193"></a>00193             alpha_y = -1.;
<a name="l00194"></a>00194 
<a name="l00195"></a>00195             <span class="keywordflow">break</span>;
<a name="l00196"></a>00196           }
<a name="l00197"></a>00197         <span class="keywordflow">case</span> 2 :
<a name="l00198"></a>00198           {
<a name="l00199"></a>00199             alpha_x = -1.;
<a name="l00200"></a>00200             alpha_y = 1.;
<a name="l00201"></a>00201 
<a name="l00202"></a>00202             <span class="keywordflow">break</span>;
<a name="l00203"></a>00203           }
<a name="l00204"></a>00204         <span class="keywordflow">case</span> 3 :
<a name="l00205"></a>00205           {
<a name="l00206"></a>00206             alpha_x = 1.;
<a name="l00207"></a>00207             alpha_y = 1.;
<a name="l00208"></a>00208 
<a name="l00209"></a>00209             <span class="keywordflow">break</span>;
<a name="l00210"></a>00210           }
<a name="l00211"></a>00211         <span class="keywordflow">default</span> :
<a name="l00212"></a>00212           {
<a name="l00213"></a>00213             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Champ_P1::coord_barycentrique : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00214"></a>00214             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00215"></a>00215           }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217         }
<a name="l00218"></a>00218 
<a name="l00219"></a>00219       som0=polys(le_poly , 0);
<a name="l00220"></a>00220       som1=polys(le_poly , 1);
<a name="l00221"></a>00221       som2=polys(le_poly , 2);
<a name="l00222"></a>00222       delta_x = coord(som1,0)-coord(som0,0);
<a name="l00223"></a>00223       delta_y = coord(som2,1)-coord(som0,1);
<a name="l00224"></a>00224       x0 = coord(som0,0)+delta_x/2.;
<a name="l00225"></a>00225       y0 = coord(som0,1)+delta_y/2.;
<a name="l00226"></a>00226       <span class="keywordtype">double</span> coord_bary = 0.25*(1.+2.*alpha_x*(x-x0)/delta_x)*(1.+2.*alpha_y*(y-y0)/delta_y);
<a name="l00227"></a>00227 
<a name="l00228"></a>00228 
<a name="l00229"></a>00229       <span class="keywordflow">if</span> ((coord_bary &lt; -<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>) || (coord_bary &gt; 1.+<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>))
<a name="l00230"></a>00230         {
<a name="l00231"></a>00231           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: The barycentric coordinate of point :&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00232"></a>00232           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;x= &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; y=&quot;</span> &lt;&lt; y &lt;&lt; finl;
<a name="l00233"></a>00233           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;is not between 0 and 1 : &quot;</span> &lt;&lt; coord_bary &lt;&lt; finl;
<a name="l00234"></a>00234           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On the element &quot;</span> &lt;&lt; le_poly &lt;&lt; <span class="stringliteral">&quot; of the processor &quot;</span> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; finl;
<a name="l00235"></a>00235         }
<a name="l00236"></a>00236       <span class="keywordflow">return</span> coord_bary;
<a name="l00237"></a>00237     }
<a name="l00238"></a>00238 
<a name="l00239"></a>00239   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;The number of nodes by element &quot;</span> &lt;&lt;nb_som_elem&lt;&lt;<span class="stringliteral">&quot; does not correspond to a treated situation.&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00240"></a>00240   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00241"></a>00241   <span class="keywordflow">return</span> 0.;
<a name="l00242"></a>00242 }
<a name="l00243"></a>00243 
<a name="l00244"></a>00244 <span class="comment">// Precondition:</span>
<a name="l00245"></a>00245 <span class="comment">// Parametre: IntTab&amp; polys</span>
<a name="l00246"></a>00246 <span class="comment">// Signification: tableau contenant les numeros des elements</span>
<a name="l00247"></a>00247 <span class="comment">// par rapport auxquels on veut calculer une</span>
<a name="l00248"></a>00248 <span class="comment">// coordonnee barycentrique.</span>
<a name="l00249"></a>00249 <span class="comment">// polys(i,0) est l&#39;indice du sommet 0 de l&#39;element</span>
<a name="l00250"></a>00250 <span class="comment">// i dans le tableau des coordonnees (coord).</span>
<a name="l00251"></a>00251 <span class="comment">// Valeurs par defaut:</span>
<a name="l00252"></a>00252 <span class="comment">// Contraintes: reference constante</span>
<a name="l00253"></a>00253 <span class="comment">// Acces: entree</span>
<a name="l00254"></a>00254 <span class="comment">// Parametre: DoubleTab&amp; coord</span>
<a name="l00255"></a>00255 <span class="comment">// Signification: les coordonnees des sommets par auxquels on veut</span>
<a name="l00256"></a>00256 <span class="comment">// calculer les coordonnees barycentriques.</span>
<a name="l00257"></a>00257 <span class="comment">// Valeurs par defaut:</span>
<a name="l00258"></a>00258 <span class="comment">// Contraintes: reference constante</span>
<a name="l00259"></a>00259 <span class="comment">// Acces: entree</span>
<a name="l00260"></a>00260 <span class="comment">// Parametre: double x</span>
<a name="l00261"></a>00261 <span class="comment">// Signification: la premiere coordonnee cartesienne du point dont</span>
<a name="l00262"></a>00262 <span class="comment">// on veut calculer les coordonnees barycentriques</span>
<a name="l00263"></a>00263 <span class="comment">// Valeurs par defaut:</span>
<a name="l00264"></a>00264 <span class="comment">// Contraintes:</span>
<a name="l00265"></a>00265 <span class="comment">// Acces: entree</span>
<a name="l00266"></a>00266 <span class="comment">// Parametre: double y</span>
<a name="l00267"></a>00267 <span class="comment">// Signification: la deuxieme coordonnee cartesienne du point dont</span>
<a name="l00268"></a>00268 <span class="comment">// on veut calculer les coordonnees barycentriques</span>
<a name="l00269"></a>00269 <span class="comment">// Valeurs par defaut:</span>
<a name="l00270"></a>00270 <span class="comment">// Contraintes:</span>
<a name="l00271"></a>00271 <span class="comment">// Acces: entree</span>
<a name="l00272"></a>00272 <span class="comment">// Parametre: double z</span>
<a name="l00273"></a>00273 <span class="comment">// Signification: la troisieme coordonnee cartesienne du point dont</span>
<a name="l00274"></a>00274 <span class="comment">// on veut calculer les coordonnees barycentriques</span>
<a name="l00275"></a>00275 <span class="comment">// Valeurs par defaut:</span>
<a name="l00276"></a>00276 <span class="comment">// Contraintes:</span>
<a name="l00277"></a>00277 <span class="comment">// Acces: entree</span>
<a name="l00278"></a>00278 <span class="comment">// Parametre: int le_poly</span>
<a name="l00279"></a>00279 <span class="comment">// Signification: le numero de l&#39;element (dans le tableau polys) par</span>
<a name="l00280"></a>00280 <span class="comment">// rapport auquel on calculera la coordonnee barycentrique.</span>
<a name="l00281"></a>00281 <span class="comment">// Valeurs par defaut:</span>
<a name="l00282"></a>00282 <span class="comment">// Contraintes:</span>
<a name="l00283"></a>00283 <span class="comment">// Acces: entre</span>
<a name="l00284"></a>00284 <span class="comment">// Parametre: int i</span>
<a name="l00285"></a>00285 <span class="comment">// Signification: le numero du sommet par rapport auquel on veut la</span>
<a name="l00286"></a>00286 <span class="comment">// coordonnee barycentrique.</span>
<a name="l00287"></a>00287 <span class="comment">// Valeurs par defaut:</span>
<a name="l00288"></a>00288 <span class="comment">// Contraintes: Tetraedre 0 &lt;= i &lt;= 3</span>
<a name="l00289"></a>00289 <span class="comment">// Contraintes: Hexaedre  0 &lt;= i &lt;= 7</span>
<a name="l00290"></a>00290 <span class="comment">// Acces: entree</span>
<a name="l00291"></a>00291 <span class="comment">// Exception: un tetraedre n&#39;a pas plus de 4 sommets</span>
<a name="l00292"></a>00292 <span class="comment">// Exception: un hexaedre n&#39;a pas plus de 8 sommets</span>
<a name="l00293"></a>00293 <span class="comment">// Exception: erreur arithmetique, denominateur nul</span>
<a name="l00294"></a>00294 <span class="comment">// Exception: erreur de calcul, coordonnee barycentrique invalide</span>
<a name="l00295"></a>00295 <span class="comment">// Effets de bord:</span>
<a name="l00296"></a>00296 <span class="comment">// Postcondition:</span>
<a name="l00297"></a>00297 <span class="comment">//</span>
<a name="l00298"></a>00298 <span class="comment">//</span>
<a name="l00299"></a>00299 <span class="comment">//</span><span class="comment"></span>
<a name="l00300"></a>00300 <span class="comment">//! Calcule la coordonnee barycentrique d&#39;un point (x,y,z) par&lt;br&gt;rapport au sommet specifie d&#39;un tetraedre ou d&#39;un hexaedre (un element)&lt;br&gt;Ce calcul concerne un point 3D.</span>
<a name="l00301"></a>00301 <span class="comment"></span><span class="comment">/** \return double&lt;br&gt;</span>
<a name="l00302"></a>00302 <span class="comment">Signification: la coordonnee barycentrique du point (x,y,z) par rapport&lt;br&gt;</span>
<a name="l00303"></a>00303 <span class="comment">au sommet specifie (i) dans l&#39;element specifie (le_poly)&lt;br&gt;</span>
<a name="l00304"></a>00304 <span class="comment">Contraintes: 0 &lt;= valeur &lt;= 1 */</span>
<a name="l00305"></a><a class="code" href="Champ__Q4__implementation_8h.html#a94999c5988842224e5a5affaeb414b41">00305</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="Champ__Q4__implementation_8h.html#a60d40e1f406b741a2f8de05b560a7148" title="Calcule la coordonnee barycentrique d&#39;un point (x,y) par rapport au sommet specifie d&#39;un triangle ou ...">coord_barycentrique</a>(<span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; polys,
<a name="l00306"></a>00306                                   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord,
<a name="l00307"></a>00307                                   <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z,
<a name="l00308"></a>00308                                   <span class="keywordtype">int</span> le_poly, <span class="keywordtype">int</span> i)
<a name="l00309"></a>00309 {
<a name="l00310"></a>00310   <span class="keywordtype">int</span> som0,som1,som2,som3;
<a name="l00311"></a>00311   <span class="keywordtype">int</span> nb_som_elem = polys.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00312"></a>00312 <span class="comment">// Distinction du calcul de la coordonnee barycentrique en fonction du type de l element</span>
<a name="l00313"></a>00313 <span class="comment">// Cas Tetraedre</span>
<a name="l00314"></a>00314   <span class="keywordflow">if</span> (nb_som_elem==4)
<a name="l00315"></a>00315     {
<a name="l00316"></a>00316       <span class="keywordflow">switch</span>(i)
<a name="l00317"></a>00317         {
<a name="l00318"></a>00318         <span class="keywordflow">case</span> 0 :
<a name="l00319"></a>00319           {
<a name="l00320"></a>00320             som0=polys(le_poly , 0);
<a name="l00321"></a>00321             som1=polys(le_poly , 1);
<a name="l00322"></a>00322             som2=polys(le_poly , 2);
<a name="l00323"></a>00323             som3=polys(le_poly , 3);
<a name="l00324"></a>00324             <span class="keywordflow">break</span>;
<a name="l00325"></a>00325           }
<a name="l00326"></a>00326         <span class="keywordflow">case</span> 1 :
<a name="l00327"></a>00327           {
<a name="l00328"></a>00328             som0=polys(le_poly , 1);
<a name="l00329"></a>00329             som1=polys(le_poly , 2);
<a name="l00330"></a>00330             som2=polys(le_poly , 3);
<a name="l00331"></a>00331             som3=polys(le_poly , 0);
<a name="l00332"></a>00332             <span class="keywordflow">break</span>;
<a name="l00333"></a>00333           }
<a name="l00334"></a>00334         <span class="keywordflow">case</span> 2 :
<a name="l00335"></a>00335           {
<a name="l00336"></a>00336             som0=polys(le_poly , 2);
<a name="l00337"></a>00337             som1=polys(le_poly , 3);
<a name="l00338"></a>00338             som2=polys(le_poly , 0);
<a name="l00339"></a>00339             som3=polys(le_poly , 1);
<a name="l00340"></a>00340             <span class="keywordflow">break</span>;
<a name="l00341"></a>00341           }
<a name="l00342"></a>00342         <span class="keywordflow">case</span> 3 :
<a name="l00343"></a>00343           {
<a name="l00344"></a>00344             som0=polys(le_poly , 3);
<a name="l00345"></a>00345             som1=polys(le_poly , 0);
<a name="l00346"></a>00346             som2=polys(le_poly , 1);
<a name="l00347"></a>00347             som3=polys(le_poly , 2);
<a name="l00348"></a>00348             <span class="keywordflow">break</span>;
<a name="l00349"></a>00349           }
<a name="l00350"></a>00350         <span class="keywordflow">default</span> :
<a name="l00351"></a>00351           {
<a name="l00352"></a>00352             som0=-1;
<a name="l00353"></a>00353             som1=-1;
<a name="l00354"></a>00354             som2=-1;
<a name="l00355"></a>00355             som3=-1;
<a name="l00356"></a>00356             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Champ_P1::coord_barycentrique : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00357"></a>00357             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;A tetrahedron does not have &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;nodes &quot;</span> &lt;&lt; finl;
<a name="l00358"></a>00358             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00359"></a>00359           }
<a name="l00360"></a>00360         }
<a name="l00361"></a>00361 
<a name="l00362"></a>00362       <span class="keywordtype">double</span> xp = (coord(som2,1)-coord(som1,1))*(coord(som0,2)-coord(som1,2))
<a name="l00363"></a>00363                   - (coord(som2,2)-coord(som1,2))*(coord(som0,1)-coord(som1,1));
<a name="l00364"></a>00364       <span class="keywordtype">double</span> yp = (coord(som2,2)-coord(som1,2))*(coord(som0,0)-coord(som1,0))
<a name="l00365"></a>00365                   - (coord(som2,0)-coord(som1,0))*(coord(som0,2)-coord(som1,2));
<a name="l00366"></a>00366       <span class="keywordtype">double</span> zp = (coord(som2,0)-coord(som1,0))*(coord(som0,1)-coord(som1,1))
<a name="l00367"></a>00367                   - (coord(som2,1)-coord(som1,1))*(coord(som0,0)-coord(som1,0));
<a name="l00368"></a>00368       <span class="keywordtype">double</span> den = xp * (coord(som3,0)-coord(som1,0))
<a name="l00369"></a>00369                    + yp * (coord(som3,1)-coord(som1,1))
<a name="l00370"></a>00370                    + zp * (coord(som3,2)-coord(som1,2));
<a name="l00371"></a>00371 
<a name="l00372"></a>00372       xp = (coord(som2,1)-coord(som1,1))*(z-coord(som1,2))
<a name="l00373"></a>00373            - (coord(som2,2)-coord(som1,2))*(y-coord(som1,1));
<a name="l00374"></a>00374       yp = (coord(som2,2)-coord(som1,2))*(x-coord(som1,0))
<a name="l00375"></a>00375            - (coord(som2,0)-coord(som1,0))*(z-coord(som1,2));
<a name="l00376"></a>00376       zp = (coord(som2,0)-coord(som1,0))*(y-coord(som1,1))
<a name="l00377"></a>00377            - (coord(som2,1)-coord(som1,1))*(x-coord(som1,0));
<a name="l00378"></a>00378       <span class="keywordtype">double</span> num = xp * (coord(som3,0)-coord(som1,0))
<a name="l00379"></a>00379                    + yp * (coord(som3,1)-coord(som1,1))
<a name="l00380"></a>00380                    + zp * (coord(som3,2)-coord(som1,2));
<a name="l00381"></a>00381 
<a name="l00382"></a>00382       assert (den != 0.);
<a name="l00383"></a>00383       <span class="keywordtype">double</span> coord_bary = num/den;
<a name="l00384"></a>00384       <span class="keywordflow">if</span> ((coord_bary &lt; -<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>) || (coord_bary &gt; 1.+<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>))
<a name="l00385"></a>00385         {
<a name="l00386"></a>00386           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: The barycentric coordinate of point :&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00387"></a>00387           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;x= &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; y=&quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot; z=&quot;</span> &lt;&lt; z &lt;&lt; finl;
<a name="l00388"></a>00388           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;is not between 0 and 1 : &quot;</span> &lt;&lt; coord_bary &lt;&lt; finl;
<a name="l00389"></a>00389           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On the element &quot;</span> &lt;&lt; le_poly &lt;&lt; <span class="stringliteral">&quot; of the processor &quot;</span> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; finl;
<a name="l00390"></a>00390         }
<a name="l00391"></a>00391       <span class="keywordflow">return</span> coord_bary;
<a name="l00392"></a>00392     }
<a name="l00393"></a>00393 <span class="comment">// Cas Hexaedre</span>
<a name="l00394"></a>00394   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nb_som_elem==8)
<a name="l00395"></a>00395     {
<a name="l00396"></a>00396       <span class="keywordtype">double</span> alpha_x=0.;
<a name="l00397"></a>00397       <span class="keywordtype">double</span> alpha_y=0.;
<a name="l00398"></a>00398       <span class="keywordtype">double</span> alpha_z=0.;
<a name="l00399"></a>00399       <span class="keywordtype">double</span> delta_x, delta_y, delta_z;
<a name="l00400"></a>00400 <span class="comment">// int som0,som1,som2;</span>
<a name="l00401"></a>00401       <span class="keywordtype">double</span> x0,y0,z0;
<a name="l00402"></a>00402 
<a name="l00403"></a>00403       <span class="keywordflow">switch</span>(i)
<a name="l00404"></a>00404         {
<a name="l00405"></a>00405         <span class="keywordflow">case</span> 0 :
<a name="l00406"></a>00406           {
<a name="l00407"></a>00407             alpha_x = -1.;
<a name="l00408"></a>00408             alpha_y = -1.;
<a name="l00409"></a>00409             alpha_z = -1.;
<a name="l00410"></a>00410             <span class="keywordflow">break</span>;
<a name="l00411"></a>00411           }
<a name="l00412"></a>00412         <span class="keywordflow">case</span> 1 :
<a name="l00413"></a>00413           {
<a name="l00414"></a>00414             alpha_x = 1.;
<a name="l00415"></a>00415             alpha_y = -1.;
<a name="l00416"></a>00416             alpha_z = -1.;
<a name="l00417"></a>00417             <span class="keywordflow">break</span>;
<a name="l00418"></a>00418           }
<a name="l00419"></a>00419         <span class="keywordflow">case</span> 2 :
<a name="l00420"></a>00420           {
<a name="l00421"></a>00421             alpha_x = -1.;
<a name="l00422"></a>00422             alpha_y = 1.;
<a name="l00423"></a>00423             alpha_z = -1.;
<a name="l00424"></a>00424             <span class="keywordflow">break</span>;
<a name="l00425"></a>00425           }
<a name="l00426"></a>00426         <span class="keywordflow">case</span> 3 :
<a name="l00427"></a>00427           {
<a name="l00428"></a>00428             alpha_x = 1.;
<a name="l00429"></a>00429             alpha_y = 1.;
<a name="l00430"></a>00430             alpha_z = -1.;
<a name="l00431"></a>00431             <span class="keywordflow">break</span>;
<a name="l00432"></a>00432           }
<a name="l00433"></a>00433         <span class="keywordflow">case</span> 4 :
<a name="l00434"></a>00434           {
<a name="l00435"></a>00435             alpha_x = -1.;
<a name="l00436"></a>00436             alpha_y = -1;
<a name="l00437"></a>00437             alpha_z = 1.;
<a name="l00438"></a>00438             <span class="keywordflow">break</span>;
<a name="l00439"></a>00439           }
<a name="l00440"></a>00440         <span class="keywordflow">case</span> 5 :
<a name="l00441"></a>00441           {
<a name="l00442"></a>00442             alpha_x = 1.;
<a name="l00443"></a>00443             alpha_y = -1.;
<a name="l00444"></a>00444             alpha_z = 1.;
<a name="l00445"></a>00445             <span class="keywordflow">break</span>;
<a name="l00446"></a>00446           }
<a name="l00447"></a>00447         <span class="keywordflow">case</span> 6 :
<a name="l00448"></a>00448           {
<a name="l00449"></a>00449             alpha_x = -1.;
<a name="l00450"></a>00450             alpha_y = 1.;
<a name="l00451"></a>00451             alpha_z = 1.;
<a name="l00452"></a>00452             <span class="keywordflow">break</span>;
<a name="l00453"></a>00453           }
<a name="l00454"></a>00454         <span class="keywordflow">case</span> 7 :
<a name="l00455"></a>00455           {
<a name="l00456"></a>00456             alpha_x = 1.;
<a name="l00457"></a>00457             alpha_y = 1.;
<a name="l00458"></a>00458             alpha_z = 1.;
<a name="l00459"></a>00459             <span class="keywordflow">break</span>;
<a name="l00460"></a>00460           }
<a name="l00461"></a>00461         <span class="keywordflow">default</span> :
<a name="l00462"></a>00462           {
<a name="l00463"></a>00463             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Champ_P1::coord_barycentrique : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00464"></a>00464             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00465"></a>00465           }
<a name="l00466"></a>00466         }
<a name="l00467"></a>00467 
<a name="l00468"></a>00468       som0=polys(le_poly , 0);
<a name="l00469"></a>00469       som1=polys(le_poly , 1);
<a name="l00470"></a>00470       som2=polys(le_poly , 2);
<a name="l00471"></a>00471       som3=polys(le_poly , 4);
<a name="l00472"></a>00472 
<a name="l00473"></a>00473       delta_x = coord(som1,0)-coord(som0,0);
<a name="l00474"></a>00474       delta_y = coord(som2,1)-coord(som0,1);
<a name="l00475"></a>00475       delta_z = coord(som3,2)-coord(som0,2);
<a name="l00476"></a>00476 
<a name="l00477"></a>00477       x0 = coord(som0,0)+delta_x/2.;
<a name="l00478"></a>00478       y0 = coord(som0,1)+delta_y/2.;
<a name="l00479"></a>00479       z0 = coord(som0,2)+delta_z/2.;
<a name="l00480"></a>00480 
<a name="l00481"></a>00481       <span class="keywordtype">double</span> coord_bary = (1./8.)*(1.+2.*alpha_x*(x-x0)/delta_x)*(1.+2.*alpha_y*(y-y0)/delta_y)*(1.+2.*alpha_z*(z-z0)/delta_z);
<a name="l00482"></a>00482 
<a name="l00483"></a>00483 
<a name="l00484"></a>00484       <span class="keywordflow">if</span> ((coord_bary &lt; -<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>) || (coord_bary &gt; 1.+<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>))
<a name="l00485"></a>00485         {
<a name="l00486"></a>00486           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: The barycentric coordinate of point :&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00487"></a>00487           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;x= &quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot; y=&quot;</span> &lt;&lt; y &lt;&lt;<span class="stringliteral">&quot; z=&quot;</span>&lt;&lt; z &lt;&lt;finl;
<a name="l00488"></a>00488           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;is not between 0 and 1 : &quot;</span> &lt;&lt; coord_bary &lt;&lt; finl;
<a name="l00489"></a>00489           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On the element &quot;</span> &lt;&lt; le_poly &lt;&lt; <span class="stringliteral">&quot; of the processor &quot;</span> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; finl;
<a name="l00490"></a>00490         }
<a name="l00491"></a>00491       <span class="keywordflow">return</span> coord_bary;
<a name="l00492"></a>00492     }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;The number of nodes by element &quot;</span> &lt;&lt;nb_som_elem&lt;&lt;<span class="stringliteral">&quot; does not correspond to a treated situation.&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00495"></a>00495   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00496"></a>00496   <span class="keywordflow">return</span> 0.;
<a name="l00497"></a>00497 }
<a name="l00498"></a>00498 
<a name="l00499"></a>00499 <span class="preprocessor">#endif</span>
<a name="l00500"></a>00500 <span class="preprocessor"></span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:14 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
