<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Geometrie/Polyedriser.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Geometrie/Polyedriser.cpp</div>  </div>
</div>
<div class="contents">
<a href="Polyedriser_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2020, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Polyedriser.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Geometrie</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/4</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Polyedriser_8h.html">Polyedriser.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Scatter_8h.html">Scatter.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Polyedre_8h.html">Polyedre.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="comment">// Convention de numerotation</span>
<a name="l00032"></a>00032 <span class="comment">// sommets         faces         4(face z=1)</span>
<a name="l00033"></a>00033 <span class="comment">// 6------7            *------*</span>
<a name="l00034"></a>00034 <span class="comment">// /|     /|           /| 3   /|</span>
<a name="l00035"></a>00035 <span class="comment">// 2------3 |          *------* |</span>
<a name="l00036"></a>00036 <span class="comment">// | |    | |          |0|    |1|</span>
<a name="l00037"></a>00037 <span class="comment">// | 4----|-5          | *----|-*</span>
<a name="l00038"></a>00038 <span class="comment">// |/     |/           |/  2  |/</span>
<a name="l00039"></a>00039 <span class="comment">// 0------1            *------*</span>
<a name="l00040"></a>00040 <span class="comment">// 5(face z=0)</span>
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="Polyedriser_8cpp.html#abf792e70b4c81afa16861f1ac6c106c6">00042</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="Polyedriser_8cpp.html#abf792e70b4c81afa16861f1ac6c106c6">faces_sommets_poly</a>[6][4] =
<a name="l00043"></a>00043 {
<a name="l00044"></a>00044   { 0, 4, 6, 2 },
<a name="l00045"></a>00045   { 1, 5, 7, 3 },
<a name="l00046"></a>00046   { 0, 2, 3, 1 },
<a name="l00047"></a>00047   { 4, 6, 7, 5 },
<a name="l00048"></a>00048   { 2, 6, 7, 3 },
<a name="l00049"></a>00049   { 0, 4, 5, 1 }
<a name="l00050"></a>00050 };
<a name="l00051"></a>00051 
<a name="l00052"></a><a class="code" href="Polyedriser_8cpp.html#acaf0280620200ee3134411f2421dba42">00052</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classPolyedriser.html" title="Polyedriser Classe destinee a convertir un hexaedre en polyedre.">Polyedriser</a>,<span class="stringliteral">&quot;Polyedriser&quot;</span>,<a class="code" href="classInterprete__geometrique__base.html" title="classe Interprete_geometrique_base .">Interprete_geometrique_base</a>);
<a name="l00053"></a>00053 <span class="comment">// XD polyedriser interprete polyedriser -1 cast hexahedra into polyhedra so that the indexing of the mesh vertices is compatible with PolyMAC discretization. Must be used in PolyMAC discretization if a hexahedral mesh has been produced with TRUST&#39;s internal mesh generator.</span>
<a name="l00054"></a>00054 <span class="comment">// XD attr domain_name ref_domaine domain_name 0 Name of domain.</span>
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="classPolyedriser.html#a1dc66e5c383574d663e5289f454d01d9">00056</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classPolyedriser.html#a1dc66e5c383574d663e5289f454d01d9" title="Ecriture de l&#39;objet sur un flot de sortie Methode a surcharger.">Polyedriser::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00057"></a>00057 <span class="keyword"></span>{
<a name="l00058"></a>00058   <span class="keywordflow">return</span> os;
<a name="l00059"></a>00059 }
<a name="l00060"></a>00060 
<a name="l00061"></a><a class="code" href="classPolyedriser.html#ab3ed42c07e187fcec03a1271ac406095">00061</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classPolyedriser.html#ab3ed42c07e187fcec03a1271ac406095" title="Lecture d&#39;un Objet_U sur un flot d&#39;entree Methode a surcharger.">Polyedriser::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00062"></a>00062 {
<a name="l00063"></a>00063   <span class="keywordflow">return</span> is;
<a name="l00064"></a>00064 }
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 <span class="comment">// compute the angle between the vectors u and v (which are coplanar)</span>
<a name="l00068"></a><a class="code" href="Polyedriser_8cpp.html#a6193838ccf5a14719486f7b01fcb2304">00068</a> <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="Polyedriser_8cpp.html#a6193838ccf5a14719486f7b01fcb2304">computeAngleBetweenCoplanarVectors</a>(std::vector&lt;double&gt; u, std::vector&lt;double&gt; v,
<a name="l00069"></a>00069                                                  std::vector&lt;double&gt; normale)
<a name="l00070"></a>00070 {
<a name="l00071"></a>00071   <span class="keywordtype">double</span> dot = u[0]*v[0] + u[1]*v[1] + u[2]*v[2];
<a name="l00072"></a>00072   <span class="keywordtype">double</span> det =   u[0]*v[1]*normale[2]
<a name="l00073"></a>00073                  +   v[0]*normale[1]*u[2]
<a name="l00074"></a>00074                  +   normale[0]*u[1]*v[2]
<a name="l00075"></a>00075                  -   u[2]* v[1] *normale[0]
<a name="l00076"></a>00076                  -   v[2]* normale[1] *u[0]
<a name="l00077"></a>00077                  -   normale[2]* u[1] *v[0];
<a name="l00078"></a>00078 
<a name="l00079"></a>00079   <span class="keywordtype">double</span> angle = atan2(det, dot);
<a name="l00080"></a>00080   <span class="keywordflow">if</span>(det == 0.0)
<a name="l00081"></a>00081     {
<a name="l00082"></a>00082       <span class="keywordtype">int</span> dir = 0;
<a name="l00083"></a>00083       <span class="keywordflow">while</span>(v[dir] == 0.0) dir++;
<a name="l00084"></a>00084       <span class="keywordtype">double</span> quotient = u[dir] / v[dir];
<a name="l00085"></a>00085       <span class="keywordflow">if</span>( quotient &gt; 0)
<a name="l00086"></a>00086         angle = 0.0;
<a name="l00087"></a>00087       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( quotient &lt; 0 )
<a name="l00088"></a>00088         angle = <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;
<a name="l00089"></a>00089     }
<a name="l00090"></a>00090   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(det &lt; 0)
<a name="l00091"></a>00091     angle += 2*<a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;
<a name="l00092"></a>00092 
<a name="l00093"></a>00093   <span class="keywordflow">return</span> angle;
<a name="l00094"></a>00094 }
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 <span class="comment">// reordering vertices inside the faces in trigonometric order</span>
<a name="l00097"></a>00097 <span class="comment">// (or anti-trigonometric, depending on the orientation of the normal)</span>
<a name="l00098"></a><a class="code" href="Polyedriser_8cpp.html#a74fc451f2bc94b5f9d3d7a49ef94e994">00098</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Polyedriser_8cpp.html#a74fc451f2bc94b5f9d3d7a49ef94e994">reorder_vertices</a>(<a class="code" href="classFaces.html" title="enum Type_Face Les differents types geometriques de faces.">Faces</a>&amp; faces, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> coords)
<a name="l00099"></a>00099 {
<a name="l00100"></a>00100   <span class="keywordtype">int</span> nb_sommets = faces.<a class="code" href="classFaces.html#a07b8d8db9e3d656b93a21a49c063430c">les_sommets</a>().<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00101"></a>00101   <span class="keywordtype">int</span> nb_faces = faces.<a class="code" href="classFaces.html#a64d898edb20c3687d357018f1821c50a" title="Renvoie le nombre de Faces.">nb_faces</a>();
<a name="l00102"></a>00102   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> face = 0; face &lt; nb_faces; face++)
<a name="l00103"></a>00103     {
<a name="l00104"></a>00104 <span class="comment">// computing the center of gravity of the face</span>
<a name="l00105"></a>00105       std::vector&lt;double&gt; center(3,0.0);
<a name="l00106"></a>00106       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s=0; s &lt; nb_sommets; s++)
<a name="l00107"></a>00107         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dir=0; dir&lt;3; dir++)
<a name="l00108"></a>00108           center[dir] += coords(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,s),dir);
<a name="l00109"></a>00109       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dir=0; dir&lt;3; dir++)
<a name="l00110"></a>00110         center[dir] /= nb_sommets;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 <span class="comment">// computing the normal to the face</span>
<a name="l00113"></a>00113       <span class="keywordtype">int</span> s0 = faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face, 0);
<a name="l00114"></a>00114       <span class="keywordtype">int</span> s1 = faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face, 1);
<a name="l00115"></a>00115       <span class="keywordtype">int</span> s2 = faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face, 2);
<a name="l00116"></a>00116       std::vector&lt;double&gt; u =
<a name="l00117"></a>00117       {
<a name="l00118"></a>00118         coords(s1,0) - coords(s0,0),
<a name="l00119"></a>00119         coords(s1,1) - coords(s0,1),
<a name="l00120"></a>00120         coords(s1,2) - coords(s0,2),
<a name="l00121"></a>00121       };
<a name="l00122"></a>00122       std::vector&lt;double&gt; v =
<a name="l00123"></a>00123       {
<a name="l00124"></a>00124         coords(s2,0) - coords(s0,0),
<a name="l00125"></a>00125         coords(s2,1) - coords(s0,1),
<a name="l00126"></a>00126         coords(s2,2) - coords(s0,2),
<a name="l00127"></a>00127       };
<a name="l00128"></a>00128       std::vector&lt;double&gt; normale =
<a name="l00129"></a>00129       {
<a name="l00130"></a>00130         u[1]*v[2] - u[2]*v[1] ,
<a name="l00131"></a>00131         u[2]*v[0] - u[0]*v[2] ,
<a name="l00132"></a>00132         u[0]*v[1] - u[1]*v[0] ,
<a name="l00133"></a>00133       };
<a name="l00134"></a>00134       <span class="keywordtype">double</span> normale_norm = sqrt( normale[0]*normale[0] + normale[1]*normale[1] + normale[2]*normale[2] );
<a name="l00135"></a>00135       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dir=0; dir&lt;3; dir++)  normale[dir] /= normale_norm;
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="comment">// reference vector used to compute angles</span>
<a name="l00138"></a>00138       std::vector&lt;double&gt; vec_ref = { coords(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,0),0) - center[0],
<a name="l00139"></a>00139                                       coords(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,0),1) - center[1],
<a name="l00140"></a>00140                                       coords(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,0),2) - center[2]
<a name="l00141"></a>00141                                     };
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 <span class="comment">// sorting the vertices in the face according to their angle formed with the reference vector</span>
<a name="l00144"></a>00144 <span class="comment">// in ascending order</span>
<a name="l00145"></a>00145       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_sommets-1; i++)
<a name="l00146"></a>00146         {
<a name="l00147"></a>00147           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_sommets-i-1; j++)
<a name="l00148"></a>00148             {
<a name="l00149"></a>00149               std::vector&lt;double&gt; vec1 = {coords(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,j),0)-center[0],
<a name="l00150"></a>00150                                           coords(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,j),1)-center[1],
<a name="l00151"></a>00151                                           coords(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,j),2)-center[2]
<a name="l00152"></a>00152                                          };
<a name="l00153"></a>00153               std::vector&lt;double&gt; vec2 = {coords(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,j+1),0)-center[0],
<a name="l00154"></a>00154                                           coords(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,j+1),1)-center[1],
<a name="l00155"></a>00155                                           coords(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,j+1),2)-center[2]
<a name="l00156"></a>00156                                          };
<a name="l00157"></a>00157               <span class="keywordtype">double</span> angle1 = <a class="code" href="Polyedriser_8cpp.html#a6193838ccf5a14719486f7b01fcb2304">computeAngleBetweenCoplanarVectors</a>(vec1, vec_ref, normale);
<a name="l00158"></a>00158               <span class="keywordtype">double</span> angle2 = <a class="code" href="Polyedriser_8cpp.html#a6193838ccf5a14719486f7b01fcb2304">computeAngleBetweenCoplanarVectors</a>(vec2, vec_ref, normale);
<a name="l00159"></a>00159 
<a name="l00160"></a>00160               <span class="keywordflow">if</span> (angle1 &gt; angle2)
<a name="l00161"></a>00161                 {
<a name="l00162"></a>00162                   <span class="keywordtype">int</span> tmp = faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,j);
<a name="l00163"></a>00163                   faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face, j) = faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,j+1);
<a name="l00164"></a>00164                   faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face, j+1) = tmp;
<a name="l00165"></a>00165                 }
<a name="l00166"></a>00166             }
<a name="l00167"></a>00167         }
<a name="l00168"></a>00168     }
<a name="l00169"></a>00169   <span class="keywordflow">return</span>;
<a name="l00170"></a>00170 }
<a name="l00171"></a>00171 
<a name="l00172"></a><a class="code" href="classPolyedriser.html#a3e3c87c9fef2ba4b5e959f613953df5d">00172</a> <span class="keywordtype">void</span> <a class="code" href="classPolyedriser.html#a3e3c87c9fef2ba4b5e959f613953df5d">Polyedriser::polyedriser</a>(<a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone)<span class="keyword"> const</span>
<a name="l00173"></a>00173 <span class="keyword"></span>{
<a name="l00174"></a>00174   <span class="keywordflow">if</span>(zone.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>()-&gt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() == <span class="stringliteral">&quot;Hexaedre&quot;</span>)
<a name="l00175"></a>00175     {
<a name="l00176"></a>00176       zone.<a class="code" href="classZone.html#ac1ff391994a372815b7f88c3fdc39f55" title="Type les elements de la zone avec le nom passe en parametre. Et associe le type d&#39;element a la zone...">typer</a>(<span class="stringliteral">&quot;Polyedre&quot;</span>);
<a name="l00177"></a>00177       <a class="code" href="classPolyedre.html" title="Classe Polyedre Cette represente l&#39;element geometrique Polyedre. Un polyedre est un element defini pa...">Polyedre</a>&amp; p = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPolyedre.html" title="Classe Polyedre Cette represente l&#39;element geometrique Polyedre. Un polyedre est un element defini pa...">Polyedre</a>, zone.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classDeriv__Elem__geom__base.html#a384b487459a33f9f521fb16539ec81de">valeur</a>());
<a name="l00178"></a>00178 
<a name="l00179"></a>00179       <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> Pi, Fi, N;
<a name="l00180"></a>00180       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elements = zone.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00181"></a>00181       <span class="keywordtype">int</span> nb_elems = elements.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00182"></a>00182       Pi.resize_array(nb_elems+1);
<a name="l00183"></a>00183       Fi.resize_array(nb_elems*6+1);
<a name="l00184"></a>00184       N.resize_array(nb_elems*24);
<a name="l00185"></a>00185 
<a name="l00186"></a>00186       <span class="keywordtype">int</span> face = 0;
<a name="l00187"></a>00187       <span class="keywordtype">int</span> node = 0;
<a name="l00188"></a>00188       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; nb_elems; e++)
<a name="l00189"></a>00189         {
<a name="l00190"></a>00190           Pi(e) = face; <span class="comment">//!&lt; Index des polyedres</span>
<a name="l00191"></a>00191 <span class="comment"></span>
<a name="l00192"></a>00192           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> f=0; f&lt;6; f++)
<a name="l00193"></a>00193             {
<a name="l00194"></a>00194               Fi(face) = face*4; <span class="comment">//!&lt; Index des faces:</span>
<a name="l00195"></a>00195 <span class="comment"></span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> s=0; s&lt;4; s++)
<a name="l00196"></a>00196                 {
<a name="l00197"></a>00197                   <span class="keywordtype">int</span> som_loc = <a class="code" href="Polyedriser_8cpp.html#abf792e70b4c81afa16861f1ac6c106c6">faces_sommets_poly</a>[f][s];
<a name="l00198"></a>00198                   N(node) = elements(e, som_loc);
<a name="l00199"></a>00199                   node++;
<a name="l00200"></a>00200                 }
<a name="l00201"></a>00201               face++;
<a name="l00202"></a>00202             }
<a name="l00203"></a>00203         }
<a name="l00204"></a>00204       Fi(nb_elems*6) = node;
<a name="l00205"></a>00205       Pi(nb_elems) = face;
<a name="l00206"></a>00206       p.<a class="code" href="classPolyedre.html#afc1db3819a4063723ff4bc251135bb9e">affecte_connectivite_numero_global</a>(N, Fi, Pi, zone.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>());
<a name="l00207"></a>00207     }
<a name="l00208"></a>00208   <span class="keywordflow">else</span>
<a name="l00209"></a>00209     {
<a name="l00210"></a>00210       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;We do not yet know how to Polyedriser the &quot;</span>
<a name="l00211"></a>00211            &lt;&lt; zone.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>()-&gt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt;<span class="stringliteral">&quot;s&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00212"></a>00212       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00213"></a>00213     }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> coords = zone.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00216"></a>00216   {
<a name="l00217"></a>00217     <a class="code" href="List_8h.html#a300f34d06c3e9d9918e439ede00ad7f4">LIST_CURSEUR</a>(<a class="code" href="classBord.html" title="Classe Bord Cette classe represente un bord d&#39;une zone, c&#39;est un type de frontiere&lt;br&gt;(derive de Fronti...">Bord</a>) curseur(zone.<a class="code" href="classZone.html#a4bc04163903c004c5c1383eaa5fa844d" title="Renvoie la liste des bords de la zone. (version const)">faces_bord</a>());
<a name="l00218"></a>00218     <span class="keywordflow">while</span>(curseur)
<a name="l00219"></a>00219       {
<a name="l00220"></a>00220         <a class="code" href="classFaces.html" title="enum Type_Face Les differents types geometriques de faces.">Faces</a>&amp; les_faces=curseur-&gt;faces();
<a name="l00221"></a>00221         les_faces.<a class="code" href="classFaces.html#a503fe687811445373b75dd8ac0991ec2" title="Type les faces.">typer</a>(<a class="code" href="classFaces.html#a62b7dbd959f99b997dc8111210ec8458acd0805076816031c49c07ac5aeacb10c">Faces::polygone_3D</a>);
<a name="l00222"></a>00222         <a class="code" href="Polyedriser_8cpp.html#a74fc451f2bc94b5f9d3d7a49ef94e994">reorder_vertices</a>(les_faces, coords);
<a name="l00223"></a>00223         ++curseur;
<a name="l00224"></a>00224       }
<a name="l00225"></a>00225   }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227   {
<a name="l00228"></a>00228 <span class="comment">// Les Raccords</span>
<a name="l00229"></a>00229     <a class="code" href="List_8h.html#a300f34d06c3e9d9918e439ede00ad7f4">LIST_CURSEUR</a>(<a class="code" href="classRaccord.html" title="Classe Raccord Classe generique de la hierarchie des raccords, un objet Raccord peut referencer n&#39;imp...">Raccord</a>) curseur(zone.<a class="code" href="classZone.html#ac2a20fe8fa5529c7eefd418b43c0131c" title="Renvoie la liste des racoords de la zone. (version const)">faces_raccord</a>());
<a name="l00230"></a>00230     <span class="keywordflow">while</span>(curseur)
<a name="l00231"></a>00231       {
<a name="l00232"></a>00232         <a class="code" href="classFaces.html" title="enum Type_Face Les differents types geometriques de faces.">Faces</a>&amp; les_faces=curseur.valeur()-&gt;faces();
<a name="l00233"></a>00233         les_faces.<a class="code" href="classFaces.html#a503fe687811445373b75dd8ac0991ec2" title="Type les faces.">typer</a>(<a class="code" href="classFaces.html#a62b7dbd959f99b997dc8111210ec8458acd0805076816031c49c07ac5aeacb10c">Faces::polygone_3D</a>);
<a name="l00234"></a>00234         <a class="code" href="Polyedriser_8cpp.html#a74fc451f2bc94b5f9d3d7a49ef94e994">reorder_vertices</a>(les_faces, coords);
<a name="l00235"></a>00235         ++curseur;
<a name="l00236"></a>00236       }
<a name="l00237"></a>00237   }
<a name="l00238"></a>00238   {
<a name="l00239"></a>00239 <span class="comment">// Les Faces internes</span>
<a name="l00240"></a>00240     <a class="code" href="List_8h.html#a300f34d06c3e9d9918e439ede00ad7f4">LIST_CURSEUR</a>(<a class="code" href="classFaces__Interne.html" title="Classe Faces_Interne La classe sert a representer un ensemble de faces qui sont internes d&#39;un point d...">Faces_Interne</a>) curseur(zone.<a class="code" href="classZone.html#ad1d5f91adfa5e56003ce778cab9610e8" title="Renvoie la liste des faces internes de la zone. (version const)">faces_int</a>());
<a name="l00241"></a>00241     <span class="keywordflow">while</span>(curseur)
<a name="l00242"></a>00242       {
<a name="l00243"></a>00243         <a class="code" href="classFaces.html" title="enum Type_Face Les differents types geometriques de faces.">Faces</a>&amp; les_faces=curseur-&gt;faces();
<a name="l00244"></a>00244         les_faces.<a class="code" href="classFaces.html#a503fe687811445373b75dd8ac0991ec2" title="Type les faces.">typer</a>(<a class="code" href="classFaces.html#a62b7dbd959f99b997dc8111210ec8458acd0805076816031c49c07ac5aeacb10c">Faces::polygone_3D</a>);
<a name="l00245"></a>00245         <a class="code" href="Polyedriser_8cpp.html#a74fc451f2bc94b5f9d3d7a49ef94e994">reorder_vertices</a>(les_faces, coords);
<a name="l00246"></a>00246         ++curseur;
<a name="l00247"></a>00247       }
<a name="l00248"></a>00248   }
<a name="l00249"></a>00249   <span class="keywordflow">return</span>;
<a name="l00250"></a>00250 }
<a name="l00251"></a>00251 
<a name="l00252"></a><a class="code" href="classPolyedriser.html#abeae4884cdcc9b942e1e7c651ee7f827">00252</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classPolyedriser.html#abeae4884cdcc9b942e1e7c651ee7f827">Polyedriser::interpreter_</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00253"></a>00253 {
<a name="l00254"></a>00254   <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> !=<a class="code" href="classPolyedriser.html#a0cb116b7925de3b7443bb7767d5d899a">dimension_application</a>())
<a name="l00255"></a>00255     {
<a name="l00256"></a>00256       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Interpreter &quot;</span>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot; cannot be applied for dimension &quot;</span> &lt;&lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00257"></a>00257       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00258"></a>00258     }
<a name="l00259"></a>00259   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>()&gt;1)
<a name="l00260"></a>00260     {
<a name="l00261"></a>00261       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Interpreter &quot;</span>&lt;&lt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<span class="stringliteral">&quot; cannot be applied during a parallel calculation !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00262"></a>00262       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The mesh can&#39;t be changed after it has been partitioned.&quot;</span> &lt;&lt; finl;
<a name="l00263"></a>00263       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00264"></a>00264     }
<a name="l00265"></a>00265 
<a name="l00266"></a>00266   <a class="code" href="classInterprete__geometrique__base.html#ac0d2fd316a4bb1585ec579f473684caa">associer_domaine</a>(is);
<a name="l00267"></a>00267   <a class="code" href="classScatter.html#a8cf934a9b5f7ecb7ef89f61c09804f45" title="methode utilisee par les interpretes qui modifient le domaine&lt;br&gt;(sequentiel), detruit les descripteu...">Scatter::uninit_sequential_domain</a>(<a class="code" href="classInterprete__geometrique__base.html#adeeb544dc732989761fb466c0d9cbcbe">domaine</a>());
<a name="l00268"></a>00268   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classInterprete__geometrique__base.html#adeeb544dc732989761fb466c0d9cbcbe">domaine</a>().<a class="code" href="classDomaine.html#a9f3fc389a1310d1fc8b4b27976855376" title="Renvoie le nombre de zone du domaine.">nb_zones</a>() ; i++)
<a name="l00269"></a>00269     {
<a name="l00270"></a>00270       <a class="code" href="classPolyedriser.html#a3e3c87c9fef2ba4b5e959f613953df5d">polyedriser</a>(<a class="code" href="classInterprete__geometrique__base.html#adeeb544dc732989761fb466c0d9cbcbe">domaine</a>().zone(i));
<a name="l00271"></a>00271     }
<a name="l00272"></a>00272   <a class="code" href="classScatter.html#a1874139ffd29d5a68191bc7828d3a5bd" title="cree des descripteurs sequentiels pour les tableaux sommets et elements du domaine (necessaire car Sc...">Scatter::init_sequential_domain</a>(<a class="code" href="classInterprete__geometrique__base.html#adeeb544dc732989761fb466c0d9cbcbe">domaine</a>());
<a name="l00273"></a>00273   <span class="keywordflow">return</span> is;
<a name="l00274"></a>00274 }
<a name="l00275"></a>00275 
<a name="l00276"></a>00276 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:19 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
