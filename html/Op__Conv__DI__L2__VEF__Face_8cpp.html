<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VEF/Operateurs/Op_Conv_DI_L2_VEF_Face.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">src/VEF/Operateurs/Op_Conv_DI_L2_VEF_Face.cpp File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="Op__Conv__DI__L2__VEF__Face_8h_source.html">Op_Conv_DI_L2_VEF_Face.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="Champ__P1NC_8h_source.html">Champ_P1NC.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="Schema__Temps__base_8h_source.html">Schema_Temps_base.h</a>&gt;</code><br/>
</div>
<p><a href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp.html#a2b16b9d1aa7325c6557e4d7dd8d9e68a">flora</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> A, int &amp;N, <a class="el" href="classDoubleVect.html">DoubleVect</a> B, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;U, int &amp;test_flora)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp.html#a7231c8f5ccebe8a7addc6f8b65d88d0f">flora_p</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;A, int &amp;N, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;B, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;U, int &amp;test_flora)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp.html#af302806fe220448c4a7acdcc3cf936d5">qrdcmp</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;A, int &amp;N, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;C, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;D, int &amp;sing)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp.html#a52eddf3029fda85a03ca998f5e5fc83d">rsolv</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;A, int &amp;N, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;D, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;B)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp.html#aeb9cb62959f7dc5e3b7695f8a22eaed5">qrsolv</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;A, int &amp;N, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;B, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;X, int &amp;sing, int &amp;ncomp, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;C, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;D)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp.html#a6bbe9284b04c135e7cd484dc3bca8e29">gradient_biconjugue</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> A, int n, <a class="el" href="classDoubleVect.html">DoubleVect</a> b, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;x, int &amp;sing, int &amp;niter)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp.html#a6e738f8d47f58274f5e8517a60d03104">convbis</a> (double psc, int num1, int num2, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;transporte, int ncomp, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;resu, <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;fluent)</td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classType__info.html">Type_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp.html#a501215bc3d37a94369ce7535e19171ae">Op_Conv_DI_L2_VEF_Facebases</a> [1] = { &amp;( <a class="el" href="classOp__Conv__VEF__base.html">Op_Conv_VEF_base</a> ::info_obj)}</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a6e738f8d47f58274f5e8517a60d03104"></a><!-- doxytag: member="Op_Conv_DI_L2_VEF_Face.cpp::convbis" ref="a6e738f8d47f58274f5e8517a60d03104" args="(double psc, int num1, int num2, const DoubleTab &amp;transporte, int ncomp, DoubleTab &amp;resu, DoubleVect &amp;fluent)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void convbis </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>psc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>fluent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00375">375</a> of file <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html">Op_Conv_DI_L2_VEF_Face.cpp</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00409">Op_Conv_DI_L2_VEF_Face::ajouter()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> comp,amont;
  <span class="keywordtype">double</span> flux;

  <span class="keywordflow">if</span> (psc &gt;= 0)
    {
      amont = num1;
      fluent[num2] += psc;
    }
  <span class="keywordflow">else</span>
    {
      amont = num2;
      fluent[num1] -= psc;
    }

  <span class="keywordflow">if</span> (ncomp == 1)
    {
      flux = transporte(amont)*psc;
      resu(num1) -= flux;
      resu(num2) += flux;
    }
  <span class="keywordflow">else</span>
    <span class="keywordflow">for</span> (comp=0; comp&lt;ncomp; comp++)
      {
        flux = transporte(amont,comp)*psc;
        resu(num1,comp) -= flux;
        resu(num2,comp) += flux;
      }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2b16b9d1aa7325c6557e4d7dd8d9e68a"></a><!-- doxytag: member="Op_Conv_DI_L2_VEF_Face.cpp::flora" ref="a2b16b9d1aa7325c6557e4d7dd8d9e68a" args="(DoubleTab A, int &amp;N, DoubleVect B, DoubleVect &amp;U, int &amp;test_flora)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flora </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a>&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a>&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>test_flora</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00059">59</a> of file <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html">Op_Conv_DI_L2_VEF_Face.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, and <a class="el" href="stat__counters_8cpp_source.html#l00079">m1</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// cette procedure correspond a la methode d&#39;elimination de Gauss</span>
  test_flora = 0; <span class="comment">//test pour savoir si la matrice est inversible(0) ou non(1)</span>
  <span class="keywordtype">int</span> N1 = N-1;
  <span class="keywordtype">int</span> m, <a class="code" href="stat__counters_8cpp.html#a0b22d8bb1162b491f7d0505b588a9d06">m1</a>, i, i1, k, l;
  <span class="keywordtype">double</span> quo,SU;
  <span class="keywordflow">for</span>(m=0; m&lt;N1; m++)
    {
      m1 = m+1;
      <span class="keywordflow">if</span>(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(A(m,m)) &gt; 1e-20)
        {
          <span class="keywordflow">for</span>(i=m1; i&lt;N; i++)
            {
              quo = A(i,m)/A(m,m);
              <span class="keywordflow">for</span>(k=m; k&lt;N; k++)
                A(i,k) =A(i,k)-quo*A(m,k);
              B(i) = B(i)-quo*B(m);
            }
        }
      <span class="keywordflow">else</span>
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Erreur flora: matrice non inversible a l&#39;indice &quot;</span>&lt;&lt;m&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          test_flora = 1;
        }

    }
  <span class="keywordflow">if</span>(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(A(N-1,N-1)) &gt;= 1e-20)
    {
      U(N-1) = B(N-1)/A(N-1,N-1);
      <span class="keywordflow">for</span>(l=0; l&lt;N1; l++)
        {
          i = N1-l-1;
          SU = 0;
          i1 = i+1;
          <span class="keywordflow">for</span>(k=i1; k&lt;N; k++)
            SU = SU+A(i,k)*U(k);
          U(i) = (B(i)-SU)/A(i,i);
        }
    }
  <span class="keywordflow">else</span>
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Erreur flora: matrice non inversible a l&#39;indice&quot;</span>&lt;&lt;N-1&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      test_flora = 1;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7231c8f5ccebe8a7addc6f8b65d88d0f"></a><!-- doxytag: member="Op_Conv_DI_L2_VEF_Face.cpp::flora_p" ref="a7231c8f5ccebe8a7addc6f8b65d88d0f" args="(DoubleTab &amp;A, int &amp;N, DoubleVect &amp;B, DoubleVect &amp;U, int &amp;test_flora)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flora_p </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>test_flora</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00107">107</a> of file <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html">Op_Conv_DI_L2_VEF_Face.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="stat__counters_8cpp_source.html#l00079">m1</a>, and <a class="el" href="Op__Grad__EF_8cpp_source.html#l00099">test()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// cette procedure correspond a la methode d&#39;elimination de Gauss</span>
  test_flora = 1;<span class="comment">//test pour savoir si la matrice est inversible(1) ou non(0)</span>
  <span class="keywordtype">int</span> N1 = N-1;
  <span class="keywordtype">int</span> m, <a class="code" href="stat__counters_8cpp.html#a0b22d8bb1162b491f7d0505b588a9d06">m1</a>, i, j, i1, k, l;
  <span class="keywordtype">int</span> <a class="code" href="Op__Grad__EF_8cpp.html#abc0897c211f7aa4541da5833388f868b">test</a>=0;
  <span class="keywordtype">double</span> quo, SU, x, y;
  <span class="keywordflow">for</span>(m=0; m&lt;N1; m++)
    {
      m1 = m+1;
      <span class="keywordflow">if</span>(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(A(m,m))  &gt;= 1.e-10)
        {
          <span class="keywordflow">for</span>(i=m1; i&lt;N; i++)
            {
              quo = A(i,m)/A(m,m);
              <span class="keywordflow">for</span>(k=m; k&lt;N; k++)
                A(i,k) =A(i,k)-quo*A(m,k);
              B(i) = B(i)-quo*B(m);
            }
        }
      <span class="keywordflow">else</span>
        {
          j=m+1;
          <span class="keywordflow">while</span>(j&lt;N &amp;&amp; test == 0)
            {
              <span class="keywordflow">if</span>(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(A(m,j)) &gt;= 1.e-10) test =1;
              j++;
            }
          <span class="keywordflow">if</span>(j == N)
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Erreur flora: matrice non inversible a l&#39;indice &quot;</span>&lt;&lt;m&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
              test_flora = 1;
            }
          <span class="keywordflow">else</span>         <span class="comment">//echange des colonnes m et j</span>
            {
              <span class="keywordflow">for</span>(i=0; i&lt;N; i++)
                {
                  x=A(i,m);
                  A(i,m)=A(i,j);
                  A(i,j)=x;
                  y=B(m);
                  B(m)=B(j);
                  B(j)=y;
                }
            }
          test_flora = 0;

        }

    }
  <span class="keywordflow">if</span>(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(A(N-1,N-1)) &gt;= 1.e-10)
    {
      U(N-1) = B(N-1)/A(N-1,N-1);
      <span class="keywordflow">for</span>(l=0; l&lt;N1; l++)
        {
          i = N1-l-1;
          SU = 0;
          i1 = i+1;
          <span class="keywordflow">for</span>(k=i1; k&lt;N; k++)
            SU = SU+A(i,k)*U(k);
          U(i) = (B(i)-SU)/A(i,i);
        }
    }
  <span class="keywordflow">else</span>
    {
<span class="comment">// Cerr&lt;&lt;&quot;Erreur flora: matrice non inversible a l&#39;indice&quot;&lt;&lt;N-1&lt;&lt;finl;</span>
      test_flora = 0;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6bbe9284b04c135e7cd484dc3bca8e29"></a><!-- doxytag: member="Op_Conv_DI_L2_VEF_Face.cpp::gradient_biconjugue" ref="a6bbe9284b04c135e7cd484dc3bca8e29" args="(DoubleTab A, int n, DoubleVect b, DoubleVect &amp;x, int &amp;sing, int &amp;niter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gradient_biconjugue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a>&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a>&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>sing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>niter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; B.M. code visiblement faux en parallele </p>
</p>

<p>Definition at line <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00269">269</a> of file <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html">Op_Conv_DI_L2_VEF_Face.cpp</a>.</p>

<p>References <a class="el" href="DoubleVect_8cpp_source.html#l02315">DoubleVect::ajoute_sans_ech_esp_virt()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="ArrOfDouble_8cpp_source.html#l01277">dotproduct_array()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="ArrOfDouble_8cpp_source.html#l01294">norme_array()</a>, and <a class="el" href="Process_8cpp_source.html#l00109">Process::nproc()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;OpVEF_DI_L2.cpp: gradient_biconjugue() n&#39;est pas parallele&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      assert(0);
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }

  <span class="keywordtype">double</span> seuil ;
  <span class="keywordtype">double</span> dnew  = 1. ;

  <span class="keywordtype">double</span> dold, alfa, beta ;
  niter = 0 ;
  sing = 0 ;

  <a class="code" href="classDoubleVect.html">DoubleVect</a> r(n) ;
  <a class="code" href="classDoubleVect.html">DoubleVect</a> r_tilda(n);
  <a class="code" href="classDoubleVect.html">DoubleVect</a> p(n) ;
  <a class="code" href="classDoubleVect.html">DoubleVect</a> p_tilda(n);
  <a class="code" href="classDoubleVect.html">DoubleVect</a> q(n) ;
  <a class="code" href="classDoubleVect.html">DoubleVect</a> u(n);
  <span class="keywordtype">double</span> r_norme, b_norme = <a class="code" href="ArrOfDouble_8cpp.html#af3b2ac08cde80e3eadd7a83f5fd06ab7" title="Calcul de la norme du vecteur dx (fonction blas DNRM2, soit racine carree(somme des dx[i]*dx[i])...">norme_array</a>(b);

  <span class="keywordtype">int</span> i,j;

  <span class="keywordflow">if</span>(b_norme &gt; 1.e-7 )
    seuil = 1.e-5/b_norme;
  <span class="keywordflow">else</span> seuil = 1.e-10;

  r = 0. ;
  p = 0. ;
  q = 0. ;

  <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
    p(i) = b(i);

  <span class="keywordtype">int</span> nmax = 50 ;

  <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
    <span class="keywordflow">for</span>(j=0; j&lt;n; j++)
      {
        r(i) = p(i)-A(i,j)*x(j) ;
        r_tilda(i) = r(i) ;
      }

  p = 0 ;
  dold = <a class="code" href="ArrOfDouble_8cpp.html#af541bfdadae7483016c96f13760598ac" title="Produit scalaire de deux &quot;array&quot;. (dotproduct_array remplace operator* car le nom indique clairemen...">dotproduct_array</a>(r_tilda, r);
  r_norme = <a class="code" href="ArrOfDouble_8cpp.html#af3b2ac08cde80e3eadd7a83f5fd06ab7" title="Calcul de la norme du vecteur dx (fonction blas DNRM2, soit racine carree(somme des dx[i]*dx[i])...">norme_array</a>(r);

  <span class="keywordflow">if</span>(sqrt(dold) &gt; seuil)
    {
      <span class="keywordflow">while</span> ( ( r_norme &gt; seuil ) &amp;&amp; (niter++ &lt; nmax) )
        {
          assert(<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() == 1); <span class="comment">//!&lt; B.M. code visiblement faux en parallele</span>
<span class="comment"></span>          dnew = <a class="code" href="ArrOfDouble_8cpp.html#af541bfdadae7483016c96f13760598ac" title="Produit scalaire de deux &quot;array&quot;. (dotproduct_array remplace operator* car le nom indique clairemen...">dotproduct_array</a>(r_tilda, r);

          <span class="keywordflow">if</span>(dold == 0.)        niter = nmax ;
          <span class="keywordflow">else</span>
            {
              beta = dnew/dold ;
              <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
                {
                  p(i) = r(i)+beta*p(i) ;
                  p_tilda(i) = r_tilda(i)+beta*p_tilda(i) ;
                }

              q = 0. ;
              <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
                <span class="keywordflow">for</span>(j=0; j&lt;n; j++)
                  q(i) += A(i,j)*p(j) ;

              beta = <a class="code" href="ArrOfDouble_8cpp.html#af541bfdadae7483016c96f13760598ac" title="Produit scalaire de deux &quot;array&quot;. (dotproduct_array remplace operator* car le nom indique clairemen...">dotproduct_array</a>(p_tilda, q) ;
<span class="comment">// Cerr&lt;&lt;&quot;beta :&quot;&lt;&lt;beta&lt;&lt;finl ;</span>
              <span class="keywordflow">if</span>(beta == 0.)        niter = nmax ;
              <span class="keywordflow">else</span>
                {
                  alfa = dnew / beta ;

                  x.<a class="code" href="classDoubleVect.html#a87fba260b7a2a4a051d7a591d19ac11d" title="x+=alpha*y sans echange_espace_virtuel">ajoute_sans_ech_esp_virt</a>(alfa, p);
                  r.ajoute_sans_ech_esp_virt(-alfa, q);

                  q = 0. ;
                  <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
                    <span class="keywordflow">for</span>(j=0; j&lt;n; j++)
                      q(i) += A(j,i)*p_tilda(j) ;

                  r_tilda.ajoute_sans_ech_esp_virt(-alfa, q);

                  dold = dnew;
<span class="comment">// assert(dnew &gt;= 0.);</span>
                  r_norme = <a class="code" href="ArrOfDouble_8cpp.html#af3b2ac08cde80e3eadd7a83f5fd06ab7" title="Calcul de la norme du vecteur dx (fonction blas DNRM2, soit racine carree(somme des dx[i]*dx[i])...">norme_array</a>(r);
<span class="comment">// Cerr &lt;&lt; &quot; niter &quot; &lt;&lt; niter &lt;&lt; &quot; dnew &quot; &lt;&lt; dnew &lt;&lt;finl ;</span>
<span class="comment">// Cerr &lt;&lt; &quot; r &quot; &lt;&lt; r.norme() &lt;&lt; finl;</span>
<span class="comment">// Cerr &lt;&lt; &quot; x &quot; &lt;&lt; x &lt;&lt; finl;</span>
                }
            }
        }
    }
  <span class="keywordflow">if</span> ( niter &gt;= nmax) sing = 1 ;
<span class="comment">// Cerr&lt;&lt;&quot;niter :&quot;&lt;&lt;niter&lt;&lt;finl;</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="af302806fe220448c4a7acdcc3cf936d5"></a><!-- doxytag: member="Op_Conv_DI_L2_VEF_Face.cpp::qrdcmp" ref="af302806fe220448c4a7acdcc3cf936d5" args="(DoubleTab &amp;A, int &amp;N, DoubleVect &amp;C, DoubleVect &amp;D, int &amp;sing)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qrdcmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>sing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00179">179</a> of file <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html">Op_Conv_DI_L2_VEF_Face.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, and <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00243">qrsolv()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// construit la decomposition QR de A. Le triangle superieur R est stockee dans le triangle superieur de A,</span>
<span class="comment">// exepte les elements de la diagonale, qui sont stockes dans D. La matrice orthogonale Q est representee</span>
<span class="comment">// comme un produit de N-1 matrice Q(1), ..., Q(N-1) ou Q(j) = Id-(uj*ujt)/cj. La ieme composante de uj est 0</span>
<span class="comment">// pour i=1, ...,j-1 et A(i,j) pour i=j, ..., N. sing retourne 0 si la decomposition est possible et 1 sinon.</span>

  <span class="keywordtype">int</span> i, j, k;
  <span class="keywordtype">double</span> scale, sigma, sum, tau;
  sing =0;
  <span class="keywordflow">for</span>(k=0; k&lt;N-1; k++)
    {
      scale = 0.;
      <span class="keywordflow">for</span>(i=k; i&lt;N; i++)
        <span class="keywordflow">if</span>(scale &lt; <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(A(i,k)))                scale = <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(A(i,k));
      <span class="keywordflow">if</span>(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(scale)&lt;1.e-15)
        {
<span class="comment">// cas singulier</span>
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; huhu &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a> ;
          sing = 1;
          C(k) = 0;
          D(k) = 0;
          return ;
        }
      <span class="keywordflow">else</span>
        {
          <span class="keywordflow">for</span>(i=k; i&lt;N; i++)        A(i,k) /= scale;
          <span class="keywordflow">for</span>(sum=0.0,i=k; i&lt;N; i++)        sum += (A(i,k) * A(i,k));
          <span class="keywordflow">if</span>(A(k,k)&gt;0) sigma = sqrt(sum);
          <span class="keywordflow">else</span>        sigma = -1*sqrt(sum);
          A(k,k) += sigma;
          C(k) = sigma*A(k,k);
          D(k) = -1*scale*sigma;
          <span class="keywordflow">for</span>(j=k+1; j&lt;N; j++)
            {
              <span class="keywordflow">for</span>(sum=0.0,i=k; i&lt;N; i++)        sum += A(i,k)*A(i,j);
              tau = sum/C(k);
              <span class="keywordflow">for</span>(i=k; i&lt;N; i++)        A(i,j) -= tau*A(i,k);
            }
        }
    }
  D(N-1) = A(N-1,N-1);
  <span class="keywordflow">if</span>(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(D(N-1)) &lt;1.e-12)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; hoho &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a> ;
      sing =1;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aeb9cb62959f7dc5e3b7695f8a22eaed5"></a><!-- doxytag: member="Op_Conv_DI_L2_VEF_Face.cpp::qrsolv" ref="aeb9cb62959f7dc5e3b7695f8a22eaed5" args="(DoubleTab &amp;A, int &amp;N, DoubleVect &amp;B, DoubleVect &amp;X, int &amp;sing, int &amp;ncomp, DoubleVect &amp;C, DoubleVect &amp;D)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qrsolv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>sing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>D</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00243">243</a> of file <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html">Op_Conv_DI_L2_VEF_Face.cpp</a>.</p>

<p>References <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00179">qrdcmp()</a>, and <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00229">rsolv()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l01197">Op_Conv_DI_L2_VEF_Face::poly_DI_L2_2d()</a>, and <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l01318">Op_Conv_DI_L2_VEF_Face::poly_DI_L2_3d()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// resout le systeme lineaire Ax=B</span>
<span class="comment">// DoubleVect C(N), D(N);</span>
  <span class="keywordtype">int</span> i, j;
  <span class="keywordtype">double</span> sum, tau;
  <span class="keywordflow">if</span>(ncomp == 0 ) <a class="code" href="Op__Conv__DI__L2__VEF__Face_8cpp.html#af302806fe220448c4a7acdcc3cf936d5">qrdcmp</a>(A, N, C, D, sing);
  <span class="keywordflow">if</span>(sing == 0)
    {
      <span class="keywordflow">for</span>(j=0; j&lt;N-1; j++)
        {
          <span class="keywordflow">for</span>(sum=0.0,i=j; i&lt;N; i++)        sum += A(i,j)*B(i);
          tau = sum/C(j);
          <span class="keywordflow">for</span>(i=j; i&lt;N; i++)        B(i) -= tau*A(i,j);
        }
      <a class="code" href="Op__Conv__DI__L2__VEF__Face_8cpp.html#a52eddf3029fda85a03ca998f5e5fc83d">rsolv</a>(A, N, D, B);<span class="comment">//resout Rx=QtB</span>
      <span class="keywordflow">for</span>(i=0; i&lt;N; i++)        X(i) = B(i);
    }
<span class="comment">// else        Cerr&lt;&lt;&quot;erreur&quot;&lt;&lt;finl;</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a52eddf3029fda85a03ca998f5e5fc83d"></a><!-- doxytag: member="Op_Conv_DI_L2_VEF_Face.cpp::rsolv" ref="a52eddf3029fda85a03ca998f5e5fc83d" args="(DoubleTab &amp;A, int &amp;N, DoubleVect &amp;D, DoubleVect &amp;B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rsolv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>B</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00229">229</a> of file <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html">Op_Conv_DI_L2_VEF_Face.cpp</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00243">qrsolv()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// resout le systeme Rx=B, ou R est triangulaire superieure stockee dans A et D, provenant de qrdcmp</span>
<span class="comment">// le resultat est stocke dans B.</span>
  <span class="keywordtype">int</span> i, j;
  <span class="keywordtype">double</span> sum;
  B(N-1) /= D(N-1);
  <span class="keywordflow">for</span>(i=N-2; i&gt;=0; i--)
    {
      <span class="keywordflow">for</span>(sum=0.0,j=i+1; j&lt;N; j++)        sum += A(i,j)*B(j);
      B(i) = (B(i)-sum)/D(i);
    }
}
</pre></div>
</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a501215bc3d37a94369ce7535e19171ae"></a><!-- doxytag: member="Op_Conv_DI_L2_VEF_Face.cpp::Op_Conv_DI_L2_VEF_Facebases" ref="a501215bc3d37a94369ce7535e19171ae" args="[1]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a>* <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp.html#a501215bc3d37a94369ce7535e19171ae">Op_Conv_DI_L2_VEF_Facebases</a>[1] = { &amp;( <a class="el" href="classOp__Conv__VEF__base.html">Op_Conv_VEF_base</a> ::info_obj)}</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html#l00029">29</a> of file <a class="el" href="Op__Conv__DI__L2__VEF__Face_8cpp_source.html">Op_Conv_DI_L2_VEF_Face.cpp</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:36:03 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
