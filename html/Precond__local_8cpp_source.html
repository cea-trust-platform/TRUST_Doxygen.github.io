<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Math/SolvSys/Precond_local.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Math/SolvSys/Precond_local.cpp</div>  </div>
</div>
<div class="contents">
<a href="Precond__local_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Precond_local.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Math/SolvSys</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/24</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Precond__local_8h.html">Precond_local.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Bloc__Sym_8h.html">Matrice_Bloc_Sym.h</a>&gt;</span>
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="Precond__local_8cpp.html#a40f381cab16236355e6cfeb1ce7416de">00026</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classPrecond__local.html">Precond_local</a>,<span class="stringliteral">&quot;Precond_local&quot;</span>,<a class="code" href="classPrecond__base.html">Precond_base</a>);
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="comment">// printOn et readOn</span>
<a name="l00029"></a><a class="code" href="classPrecond__local.html#af6ca7e29ceba8bdec8822e6755844348">00029</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classPrecond__local.html#af6ca7e29ceba8bdec8822e6755844348" title="Ecriture de l&#39;objet sur un flot de sortie Methode a surcharger.">Precond_local::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00030"></a>00030 <span class="keyword"></span>{
<a name="l00031"></a>00031   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classPrecond__local.html#ac862ec551dcd805cab020bcbb52eab02">le_precond_local_</a>.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00032"></a>00032 }
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="classPrecond__local.html#a41b7ea8d580e9066bf3797898c79e1bc">00034</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classPrecond__local.html#a41b7ea8d580e9066bf3797898c79e1bc" title="Lecture d&#39;un Objet_U sur un flot d&#39;entree Methode a surcharger.">Precond_local::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is )
<a name="l00035"></a>00035 {
<a name="l00036"></a>00036   is &gt;&gt; <a class="code" href="classPrecond__local.html#ac862ec551dcd805cab020bcbb52eab02">le_precond_local_</a>;
<a name="l00037"></a>00037 <span class="comment">// Pour eviter trop d&#39;affichage (Convergence)</span>
<a name="l00038"></a>00038   <span class="keywordflow">if</span> (!le_precond_local_.valeur().limpr())
<a name="l00039"></a>00039     le_precond_local_.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>().<a class="code" href="classSolveurSys__base.html#a987e97740c779c1ab4192c3c1f1bbd5d">fixer_limpr</a>(-1);
<a name="l00040"></a>00040   <span class="keywordflow">return</span> is;
<a name="l00041"></a>00041 }
<a name="l00042"></a>00042 
<a name="l00043"></a><a class="code" href="classPrecond__local.html#a73240c1e0c070b89f0e3d0293e8e588d">00043</a> <span class="keywordtype">void</span> <a class="code" href="classPrecond__local.html#a73240c1e0c070b89f0e3d0293e8e588d" title="this method must be overloaded if some preparation is necessary. It is called after a call to reinit(...">Precond_local::prepare_</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Base.html">Matrice_Base</a>&amp; la_matrice, <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; secmem)
<a name="l00044"></a>00044 {
<a name="l00045"></a>00045   <a class="code" href="classPrecond__local.html#ac862ec551dcd805cab020bcbb52eab02">le_precond_local_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>().<a class="code" href="classSolveurSys__base.html#a8737bd7292204c64e4b7bfe4c7bd88ef">reinit</a>();
<a name="l00046"></a>00046 
<a name="l00047"></a>00047   <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classMatrice__Bloc__Sym.html">Matrice_Bloc_Sym</a>,la_matrice))
<a name="l00048"></a>00048     {
<a name="l00049"></a>00049       <span class="keyword">const</span> <a class="code" href="classMatrice__Bloc__Sym.html">Matrice_Bloc_Sym</a>&amp; m = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Bloc__Sym.html">Matrice_Bloc_Sym</a>, la_matrice);
<a name="l00050"></a>00050       m.<a class="code" href="classMatrice__Bloc__Sym.html#a96c35afa279fe2fed65738f0afd7f16e">BlocSymToMatMorseSym</a>(<a class="code" href="classPrecond__local.html#af1ab5b5cb6ef8d7cb7c0fa3ba3081870">matrice_de_travail_</a>);
<a name="l00051"></a>00051 <span class="comment">// La matrice est t&#39;elle definie ? On regarde son bloc(0,0)</span>
<a name="l00052"></a>00052       <span class="keyword">const</span> <a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>&amp;       bloc     = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>, m.<a class="code" href="classMatrice__Bloc__Sym.html#a1002ce880ea2b2fb48dae444097c9f7a" title="(0&lt;=i&lt;N , i&lt;=j&lt;M)">get_bloc</a>(0,0).<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l00053"></a>00053       <span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; sous_bloc= <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>, bloc.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,0).<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l00054"></a>00054       <span class="keywordtype">int</span> ok = sous_bloc.get_est_definie();
<a name="l00055"></a>00055       <a class="code" href="classPrecond__local.html#af1ab5b5cb6ef8d7cb7c0fa3ba3081870">matrice_de_travail_</a>.<a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(ok);
<a name="l00056"></a>00056       <a class="code" href="classPrecond__local.html#a14959d9ada58dab0105242b5b4c3e35c">matrice_a_resoudre_</a> = <a class="code" href="classPrecond__local.html#af1ab5b5cb6ef8d7cb7c0fa3ba3081870">matrice_de_travail_</a>;
<a name="l00057"></a>00057     }
<a name="l00058"></a>00058   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>,la_matrice))
<a name="l00059"></a>00059     {
<a name="l00060"></a>00060       <span class="keyword">const</span> <a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>&amp; matrice = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Bloc.html">Matrice_Bloc</a>,la_matrice);
<a name="l00061"></a>00061       <span class="keyword">const</span> <a class="code" href="classMatrice.html">Matrice</a>&amp;      MB00 = matrice.<a class="code" href="classMatrice__Bloc.html#a7ffa38f7b93454432b2df7c616ed0a4e">get_bloc</a>(0,0);
<a name="l00062"></a>00062       <span class="keywordflow">if</span>(!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,MB00.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>()))
<a name="l00063"></a>00063         {
<a name="l00064"></a>00064           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Precond_local::prepare_ MB00 is not of type deriving from matrice_morse_sym &quot;</span>
<a name="l00065"></a>00065               &lt;&lt;MB00.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00066"></a>00066           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00067"></a>00067         }
<a name="l00068"></a>00068       <a class="code" href="classPrecond__local.html#a14959d9ada58dab0105242b5b4c3e35c">matrice_a_resoudre_</a> = MB00.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>();
<a name="l00069"></a>00069     }
<a name="l00070"></a>00070   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,la_matrice))
<a name="l00071"></a>00071     {
<a name="l00072"></a>00072       <a class="code" href="classPrecond__local.html#a14959d9ada58dab0105242b5b4c3e35c">matrice_a_resoudre_</a> = la_matrice;
<a name="l00073"></a>00073     }
<a name="l00074"></a>00074   <span class="keywordflow">else</span>
<a name="l00075"></a>00075     {
<a name="l00076"></a>00076       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;In Precond_local: prepare_, the type of the matrix &quot;</span> &lt;&lt; la_matrice.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00077"></a>00077       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;is not yet supported.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00078"></a>00078       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00079"></a>00079     }
<a name="l00080"></a>00080   <a class="code" href="classPrecond__local.html#a73240c1e0c070b89f0e3d0293e8e588d" title="this method must be overloaded if some preparation is necessary. It is called after a call to reinit(...">Precond_base::prepare_</a>(la_matrice, secmem);
<a name="l00081"></a>00081 }
<a name="l00082"></a>00082 
<a name="l00083"></a><a class="code" href="classPrecond__local.html#abdf21ee93af8a978b5b26da35316e071">00083</a> <span class="keywordtype">int</span> <a class="code" href="classPrecond__local.html#abdf21ee93af8a978b5b26da35316e071">Precond_local::preconditionner_</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Base.html">Matrice_Base</a>&amp; la_matrice,
<a name="l00084"></a>00084                                     <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; secmem,
<a name="l00085"></a>00085                                     <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; solution)
<a name="l00086"></a>00086 {
<a name="l00087"></a>00087   <span class="keyword">const</span> <a class="code" href="classMatrice__Base.html">Matrice_Base</a>&amp; m = <a class="code" href="classPrecond__local.html#a14959d9ada58dab0105242b5b4c3e35c">matrice_a_resoudre_</a>.<a class="code" href="classRef__Matrice__Base.html#ac4fb2d01ba605e18569b0b7aa8882785">valeur</a>();
<a name="l00088"></a>00088   <span class="keywordtype">int</span> ok = <a class="code" href="classPrecond__local.html#af265a086ecb16e14e085c37da0d1c9f4">precond</a>(m, secmem, solution);
<a name="l00089"></a>00089   <span class="keywordflow">return</span> ok;
<a name="l00090"></a>00090 }
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="classPrecond__local.html#af265a086ecb16e14e085c37da0d1c9f4">00092</a> <span class="keywordtype">int</span> <a class="code" href="classPrecond__local.html#af265a086ecb16e14e085c37da0d1c9f4">Precond_local::precond</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Base.html">Matrice_Base</a>&amp; mat,
<a name="l00093"></a>00093                            <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; secmem,
<a name="l00094"></a>00094                            <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; solution)
<a name="l00095"></a>00095 {
<a name="l00096"></a>00096   <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>()&gt;1)
<a name="l00097"></a>00097     {
<a name="l00098"></a>00098       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Precond_local::precond not coded for nproc &gt; 1&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00099"></a>00099       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00100"></a>00100 <span class="preprocessor">#if 0</span>
<a name="l00101"></a>00101 <span class="preprocessor"></span>      <a class="code" href="Vect_8h.html#adc7c7b04809c9aec2cb897cd2ef06378">VECT</a>(<a class="code" href="classDescripteur.html">Descripteur</a>)&amp; desc = solution.structure().descripteur();
<a name="l00102"></a>00102       <span class="keywordtype">int</span> nb_struct = desc.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l00103"></a>00103       <span class="keywordflow">if</span>(nb_struct==1)
<a name="l00104"></a>00104         <a class="code" href="classPrecond__local.html#a4475eeddf08b710dcdb6f8b8837bf14c">res_syst_loc_simple</a>(mat,secmem,solution,champ);
<a name="l00105"></a>00105       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nb_struct==2)
<a name="l00106"></a>00106         <a class="code" href="classPrecond__local.html#adb9b1714123094d99accd07307a11231">res_syst_loc_hybride</a>(mat,secmem,solution,champ);
<a name="l00107"></a>00107       <span class="keywordflow">else</span>
<a name="l00108"></a>00108         {
<a name="l00109"></a>00109           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Cases still not supported in Precond_local::preconditionner.&quot;</span> &lt;&lt; finl;
<a name="l00110"></a>00110 <span class="comment">// PL: Il suffit de generaliser res_syst_loc_hybride comme dans NP une</span>
<a name="l00111"></a>00111 <span class="comment">// taille nb_struct quelconque...pour supporter P0+P1+Pa (pas le temps de le faire).</span>
<a name="l00112"></a>00112           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00113"></a>00113         }
<a name="l00114"></a>00114 <span class="preprocessor">#endif</span>
<a name="l00115"></a>00115 <span class="preprocessor"></span>      <span class="keywordflow">return</span> 0;
<a name="l00116"></a>00116     }
<a name="l00117"></a>00117   <span class="keywordflow">else</span>
<a name="l00118"></a>00118     {
<a name="l00119"></a>00119       <span class="comment">/*</span>
<a name="l00120"></a>00120 <span class="comment">        if (ref_champ_inc_.non_nul())</span>
<a name="l00121"></a>00121 <span class="comment"></span>
<a name="l00122"></a>00122 <span class="comment">        return le_precond_local_.resoudre_systeme(mat,secmem,solution,ref_champ_inc_.valeur());</span>
<a name="l00123"></a>00123 <span class="comment">        else</span>
<a name="l00124"></a>00124 <span class="comment">      */</span>
<a name="l00125"></a>00125       <span class="keywordflow">return</span> <a class="code" href="classPrecond__local.html#ac862ec551dcd805cab020bcbb52eab02">le_precond_local_</a>.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(mat,secmem,solution);
<a name="l00126"></a>00126     }
<a name="l00127"></a>00127 }
<a name="l00128"></a>00128 
<a name="l00129"></a><a class="code" href="classPrecond__local.html#a4475eeddf08b710dcdb6f8b8837bf14c">00129</a> <span class="keywordtype">void</span> <a class="code" href="classPrecond__local.html#a4475eeddf08b710dcdb6f8b8837bf14c">Precond_local::res_syst_loc_simple</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; mat,
<a name="l00130"></a>00130                                         <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; secmem,
<a name="l00131"></a>00131                                         <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; solution,
<a name="l00132"></a>00132                                         <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; champ)
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00135"></a>00135 <span class="preprocessor">#if 0</span>
<a name="l00136"></a>00136 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(a_remplir_)
<a name="l00137"></a>00137     {
<a name="l00138"></a>00138       a_remplir_=0;
<a name="l00139"></a>00139       <span class="keywordtype">int</span> n_reel = secmem.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l00140"></a>00140       <a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n_reel,0);
<a name="l00141"></a>00141       <span class="keywordtype">int</span> ii,jj;
<a name="l00142"></a>00142       <span class="keywordtype">int</span> cpt=0;
<a name="l00143"></a>00143       <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1_tot = mat.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>;
<a name="l00144"></a>00144       <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2_tot = mat.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>;
<a name="l00145"></a>00145       <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; coeff_tot = mat.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>;
<a name="l00146"></a>00146       <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1_reel = <a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>;
<a name="l00147"></a>00147       <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2_reel = <a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>;
<a name="l00148"></a>00148       <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; coeff_reel = <a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>;
<a name="l00149"></a>00149       tab1_reel(0)=1;
<a name="l00150"></a>00150       <span class="keywordflow">for</span>(ii=0; ii&lt;n_reel; ii++)
<a name="l00151"></a>00151         {
<a name="l00152"></a>00152           <span class="keywordtype">int</span> dl = tab1_tot(ii);
<a name="l00153"></a>00153           <span class="keywordtype">int</span> fl = tab1_tot(ii+1);
<a name="l00154"></a>00154           <span class="keywordflow">for</span>(jj=dl; jj&lt;fl; jj++)
<a name="l00155"></a>00155             {
<a name="l00156"></a>00156               <span class="keywordflow">if</span>(tab2_tot(jj-1)&lt;=n_reel)
<a name="l00157"></a>00157                 cpt++;
<a name="l00158"></a>00158             }
<a name="l00159"></a>00159           tab1_reel(ii+1)=cpt+1;
<a name="l00160"></a>00160         }
<a name="l00161"></a>00161       <a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n_reel,tab1_reel(n_reel)-1);
<a name="l00162"></a>00162       cpt=0;
<a name="l00163"></a>00163       <span class="keywordflow">for</span>(ii=0; ii&lt;n_reel; ii++)
<a name="l00164"></a>00164         {
<a name="l00165"></a>00165           <span class="keywordtype">int</span> dl = tab1_tot(ii);
<a name="l00166"></a>00166           <span class="keywordtype">int</span> fl = tab1_tot(ii+1);
<a name="l00167"></a>00167           <span class="keywordflow">for</span>(jj=dl; jj&lt;fl; jj++)
<a name="l00168"></a>00168             {
<a name="l00169"></a>00169               <span class="keywordflow">if</span>(tab2_tot(jj-1)&lt;=n_reel)
<a name="l00170"></a>00170                 {
<a name="l00171"></a>00171                   tab2_reel(cpt)=tab2_tot(jj-1);
<a name="l00172"></a>00172                   coeff_reel(cpt++)=coeff_tot(jj-1);
<a name="l00173"></a>00173                 }
<a name="l00174"></a>00174             }
<a name="l00175"></a>00175         }
<a name="l00176"></a>00176       <a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>.<a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(mat.<a class="code" href="classMatrice__Sym.html#a5cbcf1c7de27ffb81664ea574a37ebdc">get_est_definie</a>());
<a name="l00177"></a>00177     }
<a name="l00178"></a>00178   <a class="code" href="classPrecond__local.html#ac862ec551dcd805cab020bcbb52eab02">le_precond_local_</a>.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(<a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>,
<a name="l00179"></a>00179                                      secmem,solution,champ);
<a name="l00180"></a>00180 <span class="preprocessor">#endif</span>
<a name="l00181"></a>00181 <span class="preprocessor"></span>}
<a name="l00182"></a>00182 
<a name="l00183"></a><a class="code" href="classPrecond__local.html#adb9b1714123094d99accd07307a11231">00183</a> <span class="keywordtype">void</span> <a class="code" href="classPrecond__local.html#adb9b1714123094d99accd07307a11231">Precond_local::res_syst_loc_hybride</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>&amp; mat,
<a name="l00184"></a>00184                                          <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; secmem,
<a name="l00185"></a>00185                                          <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; solution,
<a name="l00186"></a>00186                                          <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; champ)
<a name="l00187"></a>00187 {
<a name="l00188"></a>00188   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00189"></a>00189 <span class="preprocessor">#if 0</span>
<a name="l00190"></a>00190 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(a_remplir_)
<a name="l00191"></a>00191     {
<a name="l00192"></a>00192       a_remplir_=0;
<a name="l00193"></a>00193       {
<a name="l00194"></a>00194         <span class="keyword">const</span> <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; zdisb = champ.<a class="code" href="classChamp__base.html#a298ee24f3efdf2f60f39a13966a20bcd">zone_dis_base</a>();
<a name="l00195"></a>00195         <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = zdisb.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00196"></a>00196         <span class="keywordtype">int</span> nb_som = zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();
<a name="l00197"></a>00197         <span class="keywordtype">int</span> nb_elem = zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>();
<a name="l00198"></a>00198         <span class="keywordtype">int</span> nb_elem_tot = zone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00199"></a>00199 
<a name="l00200"></a>00200         <a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nb_elem+nb_som,0);
<a name="l00201"></a>00201         <span class="keywordtype">int</span> ii,jj;
<a name="l00202"></a>00202         <span class="keywordtype">int</span> cpt=0;
<a name="l00203"></a>00203         <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1_tot = mat.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>;
<a name="l00204"></a>00204         <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2_tot = mat.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>;
<a name="l00205"></a>00205         <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; coeff_tot = mat.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>;
<a name="l00206"></a>00206         <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1_reel = <a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>;
<a name="l00207"></a>00207         <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2_reel = <a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>;
<a name="l00208"></a>00208         <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; coeff_reel = <a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>;
<a name="l00209"></a>00209         tab1_reel(0)=1;
<a name="l00210"></a>00210         <span class="keywordflow">for</span>(ii=0; ii&lt;nb_elem; ii++)
<a name="l00211"></a>00211           {
<a name="l00212"></a>00212             <span class="keywordtype">int</span> dl = tab1_tot(ii);
<a name="l00213"></a>00213             <span class="keywordtype">int</span> fl = tab1_tot(ii+1);
<a name="l00214"></a>00214             <span class="keywordflow">for</span>(jj=dl; jj&lt;fl; jj++)
<a name="l00215"></a>00215               {
<a name="l00216"></a>00216                 <span class="keywordtype">int</span> i_col = tab2_tot(jj-1);
<a name="l00217"></a>00217                 <span class="keywordflow">if</span>( (i_col&lt;=nb_elem) ||
<a name="l00218"></a>00218                     ((i_col&gt;=nb_elem_tot+1) &amp;&amp; (i_col&lt;=(nb_elem_tot+nb_som))) )
<a name="l00219"></a>00219                   cpt++;
<a name="l00220"></a>00220               }
<a name="l00221"></a>00221             tab1_reel(ii+1)=cpt+1;
<a name="l00222"></a>00222           }
<a name="l00223"></a>00223         <span class="keywordflow">for</span>(ii=nb_elem_tot; ii&lt;(nb_elem_tot+nb_som); ii++)
<a name="l00224"></a>00224           {
<a name="l00225"></a>00225             <span class="keywordtype">int</span> dl = tab1_tot(ii);
<a name="l00226"></a>00226             <span class="keywordtype">int</span> fl = tab1_tot(ii+1);
<a name="l00227"></a>00227             <span class="keywordflow">for</span>(jj=dl; jj&lt;fl; jj++)
<a name="l00228"></a>00228               {
<a name="l00229"></a>00229                 <span class="keywordflow">if</span>(tab2_tot(jj-1)&lt;=(nb_elem_tot+nb_som))
<a name="l00230"></a>00230                   cpt++;
<a name="l00231"></a>00231               }
<a name="l00232"></a>00232             tab1_reel((ii-nb_elem_tot)+nb_elem+1)=cpt+1;
<a name="l00233"></a>00233           }
<a name="l00234"></a>00234         <a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nb_elem+nb_som,tab1_reel(nb_elem+nb_som)-1);
<a name="l00235"></a>00235         cpt=0;
<a name="l00236"></a>00236         <span class="keywordflow">for</span>(ii=0; ii&lt;nb_elem; ii++)
<a name="l00237"></a>00237           {
<a name="l00238"></a>00238             <span class="keywordtype">int</span> dl = tab1_tot(ii);
<a name="l00239"></a>00239             <span class="keywordtype">int</span> fl = tab1_tot(ii+1);
<a name="l00240"></a>00240             <span class="keywordflow">for</span>(jj=dl; jj&lt;fl; jj++)
<a name="l00241"></a>00241               {
<a name="l00242"></a>00242                 <span class="keywordtype">int</span> i_col = tab2_tot(jj-1);
<a name="l00243"></a>00243                 <span class="keywordflow">if</span>(i_col&lt;=nb_elem)
<a name="l00244"></a>00244                   {
<a name="l00245"></a>00245                     tab2_reel(cpt)=tab2_tot(jj-1);
<a name="l00246"></a>00246                     coeff_reel(cpt++)=coeff_tot(jj-1);
<a name="l00247"></a>00247                   }
<a name="l00248"></a>00248                 <span class="keywordflow">if</span>( (i_col&gt;=nb_elem_tot+1) &amp;&amp;
<a name="l00249"></a>00249                     (i_col&lt;=(nb_elem_tot+nb_som)) )
<a name="l00250"></a>00250                   {
<a name="l00251"></a>00251                     tab2_reel(cpt)=tab2_tot(jj-1)-nb_elem_tot+nb_elem;
<a name="l00252"></a>00252                     coeff_reel(cpt++)=coeff_tot(jj-1);
<a name="l00253"></a>00253                   }
<a name="l00254"></a>00254               }
<a name="l00255"></a>00255           }
<a name="l00256"></a>00256         <span class="keywordflow">for</span>(ii=nb_elem_tot; ii&lt;(nb_elem_tot+nb_som); ii++)
<a name="l00257"></a>00257           {
<a name="l00258"></a>00258             <span class="keywordtype">int</span> dl = tab1_tot(ii);
<a name="l00259"></a>00259             <span class="keywordtype">int</span> fl = tab1_tot(ii+1);
<a name="l00260"></a>00260             <span class="keywordflow">for</span>(jj=dl; jj&lt;fl; jj++)
<a name="l00261"></a>00261               {
<a name="l00262"></a>00262                 <span class="keywordflow">if</span>(tab2_tot(jj-1)&lt;=(nb_elem_tot+nb_som))
<a name="l00263"></a>00263                   {
<a name="l00264"></a>00264                     tab2_reel(cpt)=tab2_tot(jj-1)-nb_elem_tot+nb_elem;
<a name="l00265"></a>00265                     coeff_reel(cpt++)=coeff_tot(jj-1);
<a name="l00266"></a>00266                   }
<a name="l00267"></a>00267               }
<a name="l00268"></a>00268           }
<a name="l00269"></a>00269         <a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>.<a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(mat.<a class="code" href="classMatrice__Sym.html#a5cbcf1c7de27ffb81664ea574a37ebdc">get_est_definie</a>());
<a name="l00270"></a>00270         {
<a name="l00271"></a>00271           <span class="keywordtype">int</span> i,j,k,l;
<a name="l00272"></a>00272 
<a name="l00273"></a>00273           <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; items_tot = solution.get_items_communs_tot();
<a name="l00274"></a>00274           <span class="keywordflow">for</span>(i=0; i&lt;items_tot.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>(); i++)
<a name="l00275"></a>00275             {
<a name="l00276"></a>00276               k = items_tot[i]-nb_elem_tot+nb_elem;
<a name="l00277"></a>00277               <span class="keywordflow">for</span>(j=tab1_reel[k]+1; j&lt;tab1_reel[k+1]; j++)
<a name="l00278"></a>00278                 {
<a name="l00279"></a>00279                   coeff_reel(j-1) = 0. ;
<a name="l00280"></a>00280                 }
<a name="l00281"></a>00281 <span class="comment">// On parcourt les lignes au-dessus pour annuler la colonne k</span>
<a name="l00282"></a>00282               <span class="keywordflow">for</span>(j=0; j&lt;k; j++)
<a name="l00283"></a>00283                 {
<a name="l00284"></a>00284                   <span class="keywordflow">for</span>(l=tab1_reel[j]+1; l&lt;tab1_reel[j+1]; l++)
<a name="l00285"></a>00285                     {
<a name="l00286"></a>00286                       <span class="keywordflow">if</span>((tab2_reel[l-1]-1)==k)
<a name="l00287"></a>00287                         {
<a name="l00288"></a>00288                           coeff_reel(l-1) = 0. ;
<a name="l00289"></a>00289                         }
<a name="l00290"></a>00290                     }
<a name="l00291"></a>00291                 }
<a name="l00292"></a>00292             }
<a name="l00293"></a>00293         }
<a name="l00294"></a>00294       }
<a name="l00295"></a>00295     }
<a name="l00296"></a>00296   <a class="code" href="Vect_8h.html#adc7c7b04809c9aec2cb897cd2ef06378">VECT</a>(<a class="code" href="classDescripteur.html">Descripteur</a>)&amp; desc = solution.structure().descripteur();
<a name="l00297"></a>00297   <span class="keywordtype">int</span> nb_struct = desc.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l00298"></a>00298   <span class="keywordtype">int</span> ind_struct;
<a name="l00299"></a>00299   <span class="keywordtype">int</span> taille=0;
<a name="l00300"></a>00300   <span class="keywordflow">for</span>(ind_struct=0; ind_struct&lt;nb_struct; ind_struct++)
<a name="l00301"></a>00301     {
<a name="l00302"></a>00302       <a class="code" href="classDescripteur.html">Descripteur</a>&amp; desci=desc[ind_struct];
<a name="l00303"></a>00303       taille+=desci.nb();
<a name="l00304"></a>00304     }
<a name="l00305"></a>00305   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> sol_loc(taille);
<a name="l00306"></a>00306   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> sec_loc(taille);
<a name="l00307"></a>00307   <span class="keywordtype">int</span> cpt=0;
<a name="l00308"></a>00308   <span class="keywordflow">for</span>(ind_struct=0; ind_struct&lt;nb_struct; ind_struct++)
<a name="l00309"></a>00309     {
<a name="l00310"></a>00310       <a class="code" href="classDescripteur.html">Descripteur</a>&amp; desci=desc[ind_struct];
<a name="l00311"></a>00311       <span class="keywordtype">int</span> i;
<a name="l00312"></a>00312       <span class="keywordtype">int</span> deb=desci.deb();
<a name="l00313"></a>00313       <span class="keywordtype">int</span> fin=deb+desci.nb();
<a name="l00314"></a>00314       <span class="keywordflow">for</span>(i=deb; i&lt;fin; i++)
<a name="l00315"></a>00315         {
<a name="l00316"></a>00316           sol_loc[cpt] = solution[i];
<a name="l00317"></a>00317           sec_loc[cpt] = secmem[i];
<a name="l00318"></a>00318           cpt++;
<a name="l00319"></a>00319         }
<a name="l00320"></a>00320     }
<a name="l00321"></a>00321   <a class="code" href="classPrecond__local.html#ac862ec551dcd805cab020bcbb52eab02">le_precond_local_</a>.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(<a class="code" href="classPrecond__local.html#a2895c016495bc6bfeeaf3a70ec49df16">la_matrice_locale_</a>,
<a name="l00322"></a>00322                                      sec_loc,sol_loc,champ);
<a name="l00323"></a>00323   cpt=0;
<a name="l00324"></a>00324   <span class="keywordflow">for</span>(ind_struct=0; ind_struct&lt;nb_struct; ind_struct++)
<a name="l00325"></a>00325     {
<a name="l00326"></a>00326       <a class="code" href="classDescripteur.html">Descripteur</a>&amp; desci=desc[ind_struct];
<a name="l00327"></a>00327       <span class="keywordtype">int</span> i;
<a name="l00328"></a>00328       <span class="keywordtype">int</span> deb=desci.deb();
<a name="l00329"></a>00329       <span class="keywordtype">int</span> fin=deb+desci.nb();
<a name="l00330"></a>00330       <span class="keywordflow">for</span>(i=deb; i&lt;fin; i++)
<a name="l00331"></a>00331         solution[i]=sol_loc[cpt++];
<a name="l00332"></a>00332     }
<a name="l00333"></a>00333   solution.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00334"></a>00334 <span class="preprocessor">#endif</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span>}
<a name="l00336"></a>00336 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:23 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
