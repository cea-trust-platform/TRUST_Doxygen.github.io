<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TRUST: src/ThHyd/Multiphase/Schemas_Temps/SETS.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TRUST<span id="projectnumber">&#160;1.9.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b91833fa2d528be7aecedeb7fe4eea36.html">ThHyd</a></li><li class="navelem"><a class="el" href="dir_ae1602f8cbc6bb02b6536de9aa826f15.html">Multiphase</a></li><li class="navelem"><a class="el" href="dir_81aa6c0fa59c1676a3e13aed969edf3d.html">Schemas_Temps</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">SETS.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="SETS_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/****************************************************************************</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">* Copyright (c) 2022, CEA</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">* All rights reserved.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">*</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">*</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">*</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">*****************************************************************************/</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;<a class="code" href="Discretisation__base_8h.html">Discretisation_base.h</a>&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;<a class="code" href="Operateur__Diff__base_8h.html">Operateur_Diff_base.h</a>&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps__base_8h.html">Schema_Temps_base.h</a>&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;<a class="code" href="Masse__Multiphase_8h.html">Masse_Multiphase.h</a>&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;<a class="code" href="Neumann__val__ext_8h.html">Neumann_val_ext.h</a>&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;<a class="code" href="MD__Vector__tools_8h.html">MD_Vector_tools.h</a>&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;<a class="code" href="Assembleur__base_8h.html">Assembleur_base.h</a>&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;<a class="code" href="TRUSTTab__parts_8h.html">TRUSTTab_parts.h</a>&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;<a class="code" href="QDM__Multiphase_8h.html">QDM_Multiphase.h</a>&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;<a class="code" href="Pb__Multiphase_8h.html">Pb_Multiphase.h</a>&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;<a class="code" href="Pb__Conduction_8h.html">Pb_Conduction.h</a>&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;<a class="code" href="MD__Vector__std_8h.html">MD_Vector_std.h</a>&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;<a class="code" href="Matrix__tools_8h.html">Matrix_tools.h</a>&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;<a class="code" href="Matrice__Bloc_8h.html">Matrice_Bloc.h</a>&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;<a class="code" href="Statistiques_8h.html">Statistiques.h</a>&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &lt;<a class="code" href="Array__tools_8h.html">Array_tools.h</a>&gt;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;<a class="code" href="TRUSTTrav_8h.html">TRUSTTrav.h</a>&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &lt;<a class="code" href="Dirichlet_8h.html">Dirichlet.h</a>&gt;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &lt;<a class="code" href="Zone__VF_8h.html">Zone_VF.h</a>&gt;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &lt;<a class="code" href="EChaine_8h.html">EChaine.h</a>&gt;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &lt;<a class="code" href="Lapack_8h.html">Lapack.h</a>&gt;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &lt;<a class="code" href="SETS_8h.html">SETS.h</a>&gt;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &lt;<a class="code" href="TablePrinter_8h.html">TablePrinter.h</a>&gt;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="keyword">using</span> <a class="code hl_class" href="classbprinter_1_1TablePrinter.html">bprinter::TablePrinter</a>;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="keyword">template</span> <span class="keyword">class </span>std::map&lt;std::string, matrices_t&gt;;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="keyword">template</span> <span class="keyword">class </span>std::map&lt;std::string, Matrice_Morse&gt;;</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno"><a class="line" href="classSETS.html#aeae28bb29ca0bc249687f64a88a18096">   48</a></span><a class="code hl_define" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code hl_class" href="classSETS.html">SETS</a>,<span class="stringliteral">&quot;SETS&quot;</span>,<a class="code hl_class" href="classSimpler.html">Simpler</a>);</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno"><a class="line" href="classICE.html#aff9cd77459de20a0b35c10e875eb6879">   50</a></span><a class="code hl_define" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code hl_class" href="classICE.html">ICE</a>,<span class="stringliteral">&quot;ICE&quot;</span>,<a class="code hl_class" href="classSETS.html">SETS</a>);</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno"><a class="line" href="classSETS.html#a18b50ad40531ec8d3b01fdf02bec2cb4">   52</a></span><a class="code hl_function" href="classSETS.html#a18b50ad40531ec8d3b01fdf02bec2cb4">SETS::SETS</a>()</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>{</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>  <a class="code hl_variable" href="classSETS.html#a037404a748a911b2e260905354a6c7f2">sets_</a> = 1;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>}</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="classICE.html#a12220fedf13f3909a1638f526c978e0f">   57</a></span><a class="code hl_function" href="classICE.html#a12220fedf13f3909a1638f526c978e0f">ICE::ICE</a>()</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>{</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>  <a class="code hl_variable" href="classSETS.html#a037404a748a911b2e260905354a6c7f2">sets_</a> = 0;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>}</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno"><a class="line" href="classSETS.html#ada6340015cdfb27238ce2b334310506a">   62</a></span><a class="code hl_class" href="classSortie.html">Sortie</a>&amp; <a class="code hl_function" href="classSETS.html#ada6340015cdfb27238ce2b334310506a">SETS::printOn</a>(<a class="code hl_class" href="classSortie.html">Sortie</a>&amp; os )<span class="keyword"> const</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classSimpler.html#ab366344c23dbaab3f1a46620740bde65">Simpler::printOn</a>(os);</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>}</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno"><a class="line" href="classSETS.html#adb48a8df649985ae87a5c2ad6ab4a501">   67</a></span><a class="code hl_class" href="classEntree.html">Entree</a>&amp; <a class="code hl_function" href="classSETS.html#adb48a8df649985ae87a5c2ad6ab4a501">SETS::readOn</a>(<a class="code hl_class" href="classEntree.html">Entree</a>&amp; is )</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>{</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>  <span class="comment">/* valeurs par defaut des criteres de convergence */</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>  <a class="code hl_variable" href="classSETS.html#a2dc023a4074725a2d139135afb6859cf">crit_conv</a> = { { <span class="stringliteral">&quot;alpha&quot;</span>, 1e-2 }, { <span class="stringliteral">&quot;temperature&quot;</span>, 1e-1 }, { <span class="stringliteral">&quot;vitesse&quot;</span>, 1e-2 }, { <span class="stringliteral">&quot;pression&quot;</span>, 100 }, {<span class="stringliteral">&quot;k&quot;</span>, 1e-2}, {<span class="stringliteral">&quot;tau&quot;</span>, 1e-2}, {<span class="stringliteral">&quot;omega&quot;</span>, 1e-2}, {<span class="stringliteral">&quot;k_WIT&quot;</span>, 1e-2}, {<span class="stringliteral">&quot;interfacial_area&quot;</span>, 1e-2} };</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>  <a class="code hl_variable" href="classSETS.html#abc7f91897922f8e62d9b9a181ff35f51">first_call_</a> = 1;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>  <a class="code hl_function" href="classSimpler.html#a67c19f48bf7bd78b6c048a013664473f">Simpler::readOn</a>(is);</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>  <span class="keywordflow">return</span> is;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>}</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno"><a class="line" href="classSETS.html#a0700ecfee83528105f1d62437e07661b">   76</a></span><a class="code hl_class" href="classEntree.html">Entree</a>&amp; <a class="code hl_function" href="classSETS.html#a0700ecfee83528105f1d62437e07661b">SETS::lire</a>(<span class="keyword">const</span> <a class="code hl_class" href="classMotcle.html">Motcle</a>&amp; mot, <a class="code hl_class" href="classEntree.html">Entree</a>&amp; is)</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>{</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>  <span class="keywordflow">if</span> (mot == <a class="code hl_class" href="classMotcle.html">Motcle</a>(<span class="stringliteral">&quot;criteres_convergence&quot;</span>))</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    {</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>      <a class="code hl_class" href="classNom.html">Nom</a> nom;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>      is &gt;&gt; nom;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>      <span class="keywordflow">if</span> (nom != <span class="stringliteral">&quot;{&quot;</span>) <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;SETS::lire() : { expected instead of &quot;</span> &lt;&lt; nom &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">Process::exit</a>();</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>      <span class="keywordflow">for</span> (is &gt;&gt; nom; nom != <span class="stringliteral">&quot;}&quot;</span>; is &gt;&gt; nom)</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>        {</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>          <span class="keywordtype">double</span> val;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>          is &gt;&gt; val;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>          <a class="code hl_variable" href="classSETS.html#a2dc023a4074725a2d139135afb6859cf">crit_conv</a>[nom.<a class="code hl_function" href="classNom.html#ad71b1114cce16c93232450de03848dfc">getString</a>()] = val;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        }</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    }</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mot == <span class="stringliteral">&quot;iter_min&quot;</span>) is &gt;&gt; <a class="code hl_variable" href="classSETS.html#a416660a4c6b560c16a63ef41bc99383f">iter_min_</a>;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mot == <span class="stringliteral">&quot;iter_max&quot;</span>) is &gt;&gt; <a class="code hl_variable" href="classSETS.html#acf75db99aa6f39fb02552f774ac26d17">iter_max_</a>;</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mot == <span class="stringliteral">&quot;pression_degeneree&quot;</span>) is &gt;&gt; <a class="code hl_variable" href="classSETS.html#a3ac3e326835cd7b7e65512befd351443">p_degen</a>;</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>  <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code hl_function" href="classSimple.html#a7a1944e0157cae3713183c238f1296c9">Simpler::lire</a>(mot, is); <span class="comment">//la classe mere connait-elle ce mot cle?</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>  <span class="keywordflow">return</span> is;</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>}</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span> </div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno"><a class="line" href="classICE.html#a42f3140bc2e1fce3aa2aa0e46834e3e4">   98</a></span><a class="code hl_class" href="classSortie.html">Sortie</a>&amp; <a class="code hl_function" href="classICE.html#a42f3140bc2e1fce3aa2aa0e46834e3e4">ICE::printOn</a>(<a class="code hl_class" href="classSortie.html">Sortie</a>&amp; os )<span class="keyword"> const</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classSETS.html#ada6340015cdfb27238ce2b334310506a">SETS::printOn</a>(os);</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>}</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno"><a class="line" href="classICE.html#a4244d9c056eb00a763021dd3183193ad">  103</a></span><a class="code hl_class" href="classEntree.html">Entree</a>&amp; <a class="code hl_function" href="classICE.html#a4244d9c056eb00a763021dd3183193ad">ICE::readOn</a>(<a class="code hl_class" href="classEntree.html">Entree</a>&amp; is )</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>{</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>  <a class="code hl_function" href="classSETS.html#adb48a8df649985ae87a5c2ad6ab4a501">SETS::readOn</a>(is);</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>  <span class="keywordflow">return</span> is;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>}</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno"><a class="line" href="SETS_8cpp.html#a0ca1eedfe96bd2b8dff05676ebd8ba81">  109</a></span><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="SETS_8cpp.html#a0ca1eedfe96bd2b8dff05676ebd8ba81">corriger_incr_alpha</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; alpha, <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; incr, <span class="keywordtype">double</span>&amp; err_a_sum)</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>{</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>  <span class="keywordtype">int</span> i, n, N = alpha.<a class="code hl_function" href="classTRUSTVect.html#a649c67413e5406c514742aa39dd791b9">line_size</a>();</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>  <span class="keywordtype">double</span> a_sum, corr_max = 0;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>  <a class="code hl_class" href="classTRUSTTrav.html">DoubleTrav</a> n_a(N);</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>  <span class="keywordflow">for</span> (i = 0, err_a_sum = 0; i &lt; alpha.<a class="code hl_function" href="classTRUSTTab.html#a02f5d997850b88e5f307f6ddaf67286e">dimension_tot</a>(0); i++)</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    {</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>      <span class="keywordflow">for</span> (a_sum = 0, n = 0; n &lt; N; n++) n_a(n) = alpha(i, n) + incr(i, n), a_sum += n_a(n);</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>      err_a_sum = std::max(err_a_sum, std::abs(a_sum - 1));</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>      <span class="keywordflow">for</span> (a_sum = 0, n = 0; n &lt; N; n++) n_a(n) = std::max(n_a(n), 0.), a_sum += n_a(n);</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>      <span class="keywordflow">if</span> (a_sum)</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        <span class="keywordflow">for</span> (n = 0; n &lt; N; n++) n_a(n) /= a_sum;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>      <span class="keywordflow">else</span> <span class="keywordflow">for</span> (n = 0; n &lt; N; n++) n_a(n) = 1. / N;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>      <span class="keywordflow">for</span> (n = 0; n &lt; N; n++) corr_max = std::max(corr_max, std::fabs(alpha(i, n) + incr(i, n) - n_a(n))), incr(i, n) = n_a(n) - alpha(i, n);</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    }</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>  err_a_sum = <a class="code hl_function" href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d">Process::mp_max</a>(err_a_sum);</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d">Process::mp_max</a>(corr_max);</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>}</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno"><a class="line" href="classSETS.html#a818444b126b2bb412971d24b5f1acf2c">  128</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classSETS.html#a818444b126b2bb412971d24b5f1acf2c">SETS::unknown_positivation</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; uk, <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; incr)</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>{</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>  <span class="keywordtype">double</span> corr_max = 0;</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>  <span class="keywordtype">int</span> N = uk.<a class="code hl_function" href="classTRUSTVect.html#a649c67413e5406c514742aa39dd791b9">line_size</a>();</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;uk.<a class="code hl_function" href="classTRUSTTab.html#a02f5d997850b88e5f307f6ddaf67286e">dimension_tot</a>(0) ; i++)</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0 ; n&lt;N ; n++)</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>      <span class="keywordflow">if</span> (uk(i, n) + incr(i, n) &lt; 0)</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>        {</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>          <span class="keywordflow">if</span> (- uk(i, n) - incr(i, n) &gt; corr_max) corr_max =  std::abs(uk(i, n) + incr(i, n));</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>          incr(i, n) = -uk(i, n);</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>        }</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d">Process::mp_max</a>(corr_max);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>}</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span> </div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span><span class="preprocessor">#ifdef PETSCKSP_H</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span><span class="keywordtype">void</span> SETS::init_cv_ctx(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; secmem, <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; <a class="code hl_function" href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a>)</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>{</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>  cv_ctx = (SETS::cv_test_t *) calloc(1, <span class="keyword">sizeof</span>(SETS::cv_test_t));</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>  cv_ctx-&gt;obj = <span class="keyword">this</span>, cv_ctx-&gt;eps_alpha = <a class="code hl_variable" href="classSETS.html#a2dc023a4074725a2d139135afb6859cf">crit_conv</a>[<span class="stringliteral">&quot;alpha&quot;</span>];</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>  norm = <a class="code hl_function" href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a>, residu = secmem, cv_ctx-&gt;t = NULL, cv_ctx-&gt;v = NULL;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>  <span class="comment">/* numerotation pour recuperer le residu : on fait comme dans Solv_Petsc */</span></div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>  <a class="code hl_class" href="classArrOfBit.html">ArrOfBit</a> items_to_keep;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>  <span class="keywordtype">int</span> i, size = secmem.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>(), idx = <a class="code hl_function" href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071">mppartial_sum</a>(<a class="code hl_function" href="classMD__Vector__tools.html#ad099d2407b0016920bd8c667a56fddd8">MD_Vector_tools::get_sequential_items_flags</a>(secmem.<a class="code hl_function" href="classTRUSTVect.html#a7c824c9032be2e622561aa481fe1b8ae">get_md_vector</a>(), items_to_keep, secmem.<a class="code hl_function" href="classTRUSTVect.html#a649c67413e5406c514742aa39dd791b9">line_size</a>()));</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>  <span class="keywordflow">for</span> (ix.resize(size), i = 0; i &lt; size; i++)</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    <span class="keywordflow">if</span> (items_to_keep[i]) ix[i] = idx, idx++;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    <span class="keywordflow">else</span> ix[i] = -1;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>  KSPConvergedDefaultCreate(&amp;cv_ctx-&gt;defctx);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>}</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>PetscErrorCode destroy_cvctx(<span class="keywordtype">void</span> *mctx)</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>{</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>  SETS::cv_test_t *ctx = (SETS::cv_test_t *)mctx;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>  <span class="keywordflow">if</span> (ctx-&gt;v) VecDestroy(&amp;ctx-&gt;v);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>  <span class="keywordflow">if</span> (ctx-&gt;t) VecDestroy(&amp;ctx-&gt;t);</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>  PetscErrorCode err =  KSPConvergedDefaultDestroy(ctx-&gt;defctx);</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>  free(ctx);</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>  <span class="keywordflow">return</span> err;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>}</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span><span class="comment">/* test de convergence */</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>PetscErrorCode convergence_test(KSP ksp, PetscInt it, PetscReal rnorm, KSPConvergedReason *reason,<span class="keywordtype">void</span> *mctx)</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>{</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>  SETS::cv_test_t *ctx = (SETS::cv_test_t *)mctx;</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>  PetscErrorCode ret = KSPConvergedDefault(ksp, it, rnorm, reason, &amp;ctx-&gt;defctx); <span class="comment">//on appelle le test par defaut</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>  <span class="keywordflow">if</span> (ret || *reason &lt;= 0) <span class="keywordflow">return</span> ret; <span class="comment">//pas encore converge -&gt; rien a faire</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>  <span class="comment">/* sinon -&gt; on verfie que sum alpha = 1 est aussi OK */</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>  Vec resi;</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>  <span class="keywordflow">if</span> (ctx-&gt;t == NULL) <span class="comment">/* ctx-&gt;t, ctx-v non initialises -&gt; on les cree */</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    {</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>      Mat m;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>      KSPGetOperators(ksp,&amp;m,NULL);</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>      MatCreateVecs(m, &amp;ctx-&gt;v, &amp;ctx-&gt;t);</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>      VecSetOption(ctx-&gt;v, VEC_IGNORE_NEGATIVE_INDICES,PETSC_TRUE);</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    }</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>  KSPBuildResidual(ksp, ctx-&gt;t, ctx-&gt;v, &amp;resi);<span class="comment">//residu</span></div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>  VecGetValues(resi, ctx-&gt;obj-&gt;ix.size_array(), ctx-&gt;obj-&gt;ix.addr(), ctx-&gt;obj-&gt;residu.addr());</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>  <span class="keywordtype">bool</span> ok = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; ok &amp;&amp; i &lt; ctx-&gt;obj-&gt;norm.size(); i++)</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="keywordflow">if</span> (ctx-&gt;obj-&gt;ix[i] &gt;= 0)</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>      ok &amp;= std::abs(ctx-&gt;obj-&gt;residu[i]) &lt; ctx-&gt;obj-&gt;norm[i] * ctx-&gt;eps_alpha;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="classProcess.html#aeaa5f9b4e42dc41414bebc7df14e16f6">Process::mp_and</a>(ok)) *reason = KSP_CONVERGED_ITERATING;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>  <span class="keywordflow">return</span> ret;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>}</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno"><a class="line" href="classSETS.html#ac8f62874bd9a352e8def1cfc3d996186">  193</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classSETS.html#ac8f62874bd9a352e8def1cfc3d996186">SETS::iterer_eqn</a>(<a class="code hl_class" href="classEquation__base.html">Equation_base</a>&amp; eqn, <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; inut, <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; current, <span class="keywordtype">double</span> dt, <span class="keywordtype">int</span> numero_iteration, <span class="keywordtype">int</span>&amp; ok)</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>{</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>  <span class="keywordtype">int</span> cv;</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>  <span class="comment">/* on ne traite que Pb_Multiphase ou Pb_conduction */</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classPb__Multiphase.html">Pb_Multiphase</a>, eqn.<a class="code hl_function" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f">probleme</a>()) &amp;&amp; !<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classPb__Conduction.html">Pb_Conduction</a>, eqn.<a class="code hl_function" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f">probleme</a>()))</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">Process::exit</a>(<a class="code hl_function" href="classObjet__U.html#a58289bb63283588d31dc69b87b3f1d55">que_suis_je</a>() + <span class="stringliteral">&quot; cannot be applied to the problem &quot;</span> + eqn.<a class="code hl_function" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f">probleme</a>().<a class="code hl_function" href="classProbleme__base.html#aa210f18cdc711810f1b9c4819178af36">le_nom</a>() + <span class="stringliteral">&quot; of type &quot;</span> + eqn.<a class="code hl_function" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f">probleme</a>().<a class="code hl_function" href="classObjet__U.html#a58289bb63283588d31dc69b87b3f1d55">que_suis_je</a>() + <span class="stringliteral">&quot;!&quot;</span>);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>  <span class="comment">/* equations non resolues directement : Masse_Multiphase (toujours), Energie_Multiphase (en ICE), Convection_Diffusion_std i.e. quantites turbulentes (en ICE) */</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classMasse__Multiphase.html">Masse_Multiphase</a>, eqn) || (!<a class="code hl_variable" href="classSETS.html#a037404a748a911b2e260905354a6c7f2">sets_</a> &amp;&amp; <a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classEnergie__Multiphase.html">Energie_Multiphase</a>, eqn))|| (!<a class="code hl_variable" href="classSETS.html#a037404a748a911b2e260905354a6c7f2">sets_</a> &amp;&amp; <a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classConvection__Diffusion__std.html">Convection_Diffusion_std</a>, eqn)))</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span> </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>  <span class="comment">/* QDM_Multiphase: resolue par iterer_NS */</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classQDM__Multiphase.html">QDM_Multiphase</a>, eqn))</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    {</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>      <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a> matrix_unused;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>      <a class="code hl_class" href="classTRUSTTrav.html">DoubleTrav</a> secmem_unused;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>      <a class="code hl_function" href="classSETS.html#a6392580d0676326210dc7536c278c810">iterer_NS</a>(eqn, current, <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classQDM__Multiphase.html">QDM_Multiphase</a>, eqn).pression().valeurs(), dt, matrix_unused, 0, secmem_unused, numero_iteration, cv, ok);</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>      <span class="keywordflow">return</span> cv;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    }</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span> </div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>  <span class="comment">/* cas restant : equation thermique d&#39;un Pb_Multi ou d&#39;un Pb_conduction -&gt; on regle semi_impl si necessaire, puis on resout */</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>  <span class="keyword">const</span> std::string&amp; nom_inco = eqn.<a class="code hl_function" href="classEquation__base.html#a3cfe6b771e0ff255b3c93576b27019b0">inconnue</a>().<a class="code hl_function" href="classO__U__Ptr.html#a2e55c62a929a145d41b38061ff97bfa2">le_nom</a>().<a class="code hl_function" href="classNom.html#ad71b1114cce16c93232450de03848dfc">getString</a>(), nom_pb_inco = eqn.<a class="code hl_function" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f">probleme</a>().<a class="code hl_function" href="classProbleme__base.html#aa210f18cdc711810f1b9c4819178af36">le_nom</a>().<a class="code hl_function" href="classNom.html#ad71b1114cce16c93232450de03848dfc">getString</a>() + <span class="stringliteral">&quot;/&quot;</span> + nom_inco;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>  <a class="code hl_typedef" href="Interface__blocs_8h.html#a2d7480bf11fc9f791b1d2839fa30a5c3">tabs_t</a> semi_impl; <span class="comment">/* en ICE, les temperatures de tous les problemes sont explicites */</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>  <span class="keyword">const</span> <a class="code hl_class" href="classOperateur__Diff__base.html">Operateur_Diff_base</a>&amp; op_diff = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classOperateur__Diff__base.html">Operateur_Diff_base</a>, eqn.<a class="code hl_function" href="classEquation__base.html#ade7daf3cf58c49dd666f63b8911d4fe4">operateur</a>(0).<a class="code hl_function" href="classOperateur.html#a318f30b233e223685bb693c314554284">l_op_base</a>());</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classSETS.html#a037404a748a911b2e260905354a6c7f2">sets_</a>)</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;op_ext : op_diff.<a class="code hl_variable" href="classOperateur__Diff__base.html#a55bd9b2fad5e6ef816f89ea07371ddfc">op_ext</a>)</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>      semi_impl[nom_inco + (op_ext != &amp;op_diff ? <span class="stringliteral">&quot;/&quot;</span> + op_ext-&gt;<a class="code hl_function" href="classMorEqn.html#a233c714209593acce7aec1f55640bca2">equation</a>().<a class="code hl_function" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f">probleme</a>().<a class="code hl_function" href="classProbleme__base.html#aa210f18cdc711810f1b9c4819178af36">le_nom</a>().<a class="code hl_function" href="classNom.html#ad71b1114cce16c93232450de03848dfc">getString</a>() : <span class="stringliteral">&quot;&quot;</span>)] = op_ext-&gt;equation().inconnue().passe();</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classSETS.html#aa96e420735d53c9033c0031f4a02a379">mat_pred</a>.count(nom_pb_inco)) <span class="comment">/* matrice : dimensionnement au premier passage */</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    eqn.<a class="code hl_function" href="classEquation__base.html#a5f51df433a67d9aa3da8055e4d8c3b5c">dimensionner_blocs</a>({{ nom_inco, &amp;<a class="code hl_variable" href="classSETS.html#aa96e420735d53c9033c0031f4a02a379">mat_pred</a>[nom_pb_inco]}}, semi_impl);</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span> </div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  <span class="comment">/* assemblage et resolution */</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>  <a class="code hl_class" href="classTRUSTTrav.html">DoubleTrav</a> secmem(current);</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>  <a class="code hl_class" href="classSolveurSys.html">SolveurSys</a>&amp; solv = get_and_set_parametre_implicite(eqn).solveur();</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>  eqn.assembler_blocs_avec_inertie({{ nom_inco, &amp;mat_pred[nom_pb_inco] }}, secmem, semi_impl);</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>  mat_pred[nom_pb_inco].ajouter_multvect(current, secmem); <span class="comment">//passage increment -&gt; variable</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>  solv.<a class="code hl_function" href="classDeriv__SolveurSys__base.html#af20f1e9317a0d617a4862f19e7b17be4">valeur</a>().<a class="code hl_function" href="classSolveurSys__base.html#a8737bd7292204c64e4b7bfe4c7bd88ef">reinit</a>();</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>  solv.<a class="code hl_function" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(mat_pred[nom_pb_inco], secmem, current);</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  <span class="keywordflow">if</span> (eqn.positive_unkown()==1)</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    {</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>      <a class="code hl_class" href="classTRUSTTrav.html">DoubleTrav</a> incr ;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>      incr = current;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>      incr -= eqn.inconnue()-&gt;valeurs();</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>      unknown_positivation(eqn.inconnue()-&gt;valeurs(), incr);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>      incr += eqn.inconnue()-&gt;valeurs();</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>      current = incr;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    }</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span> </div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>  <span class="comment">/* mise a jour */</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>  eqn.probleme().mettre_a_jour(eqn.schema_temps().temps_courant());</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>  eqn.inconnue().futur() = current;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>}</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span> </div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span><span class="comment">// Entree Un ; Pn</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span><span class="comment">// Sortie Un+1 = U***_k ; Pn+1 = P**_k</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span><span class="comment">// n designe une etape temporelle</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno"><a class="line" href="classSETS.html#a6392580d0676326210dc7536c278c810">  252</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classSETS.html#a6392580d0676326210dc7536c278c810">SETS::iterer_NS</a>(<a class="code hl_class" href="classEquation__base.html">Equation_base</a>&amp; eqn,<a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; current,<a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; pression,</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>                     <span class="keywordtype">double</span> dt,<a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; matrice_unused,<span class="keywordtype">double</span> seuil_resol,<a class="code hl_class" href="classTRUSTTrav.html">DoubleTrav</a>&amp; secmem_unused,<span class="keywordtype">int</span> nb_ite,<span class="keywordtype">int</span>&amp; cv, <span class="keywordtype">int</span>&amp; ok)</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>{</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>  <a class="code hl_class" href="classPb__Multiphase.html">Pb_Multiphase</a>&amp; pb = *(<a class="code hl_class" href="classPb__Multiphase.html">Pb_Multiphase</a> *) &amp;<a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classPb__Multiphase.html">Pb_Multiphase</a>, eqn.<a class="code hl_function" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f">probleme</a>());</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>  <span class="keywordtype">int</span> i, j, &amp;it = <a class="code hl_variable" href="classSETS.html#a73c4e579bc537898da0bc707ac19fb3a">iteration</a>, n_eq = pb.<a class="code hl_function" href="classPb__Multiphase.html#aac3c0ff2843ff7748d199e2a5dde7f02">nombre_d_equations</a>();</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>  <a class="code hl_class" href="classQDM__Multiphase.html">QDM_Multiphase</a>&amp; eq_qdm = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classQDM__Multiphase.html">QDM_Multiphase</a>, eqn);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>  <span class="keywordtype">double</span> t = eqn.<a class="code hl_function" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4">schema_temps</a>().<a class="code hl_function" href="classSchema__Temps__base.html#a1e573b93ad40c737ecb2da65b68f968a">temps_courant</a>(), err_a_sum = 0;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>  std::vector&lt;Equation_base *&gt; eq_list; <span class="comment">//ordres des equations</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>  <span class="keywordflow">for</span> (i = 0; i &lt; n_eq; i++) eq_list.push_back(&amp;pb.<a class="code hl_function" href="classPb__Multiphase.html#aaf6fb8417722b043861e3e4be9b58c48">equation</a>(i));</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>  std::map&lt;std::string, Equation_base *&gt; eqs; <span class="comment">//eqs[inconnue] = equation</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>  std::vector&lt;std::string&gt; noms; <span class="comment">//ordre des inconnues : le meme que les equations, puis la pression</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>  <span class="keywordflow">for</span> (i = 0; i &lt; n_eq; i++) noms.push_back(eq_list[i]-&gt;inconnue().le_nom().getString()), eqs[noms[i]] = eq_list[i];</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>  noms.push_back(<span class="stringliteral">&quot;pression&quot;</span>); <span class="comment">//pas d&#39;equation associee a la pression!</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>  std::map&lt;std::string, Champ_Inc_base *&gt; inco; <span class="comment">//tous les Champ_Inc</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;i_eq : eqs) inco[i_eq.first] = &amp;i_eq.second-&gt;inconnue().valeur();</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>  inco[<span class="stringliteral">&quot;pression&quot;</span>] = &amp;eq_qdm.<a class="code hl_function" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a">pression</a>().<a class="code hl_function" href="classDeriv__Champ__Inc__base.html#adaa8a3a0efb270f0bbd11311787b5c8d">valeur</a>();</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span><span class="comment">// initialisation du Newton avec les valeurs presentes (stockees dans passe() en implicite), dimensionnement de incr / sec</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>  pb.<a class="code hl_function" href="classPb__Multiphase.html#a9de224106faa6405121c8103611a8a33">mettre_a_jour</a>(t); <span class="comment">//inconnues -&gt; milieu -&gt; champs conserves</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>  <span class="comment">/* valeurs semi-implicites : inconnues (alpha, v, T, ..) et champs conserves (alpha_rho, alpha_rho_e, ..) */</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>  <a class="code hl_typedef" href="Interface__blocs_8h.html#a2d7480bf11fc9f791b1d2839fa30a5c3">tabs_t</a> semi_impl;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;i_eq : eqs)</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <span class="keywordflow">if</span> (i_eq.second != &amp;eq_qdm)</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>      {</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>        semi_impl[i_eq.first] = i_eq.second-&gt;inconnue().passe();</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        <span class="keywordflow">if</span> (i_eq.second-&gt;has_champ_conserve()) semi_impl[i_eq.second-&gt;champ_conserve().le_nom().getString()] = i_eq.second-&gt;champ_conserve().passe();</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        <span class="keywordflow">if</span> (i_eq.second-&gt;has_champ_convecte()) semi_impl[i_eq.second-&gt;champ_convecte().le_nom().getString()] = i_eq.second-&gt;champ_convecte().passe();</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>      }</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span><span class="comment">// en SETS, on remplace la valeur passee de v par celle donnee par une etape de prediction</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSETS.html#a037404a748a911b2e260905354a6c7f2">sets_</a> &amp;&amp; !<a class="code hl_variable" href="classSETS.html#abc7f91897922f8e62d9b9a181ff35f51">first_call_</a>)</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    {</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>      <a class="code hl_class" href="classTRUSTTrav.html">DoubleTrav</a> secmem(current);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>      <span class="comment">/* assemblage &quot;implicite, vitesses seulement&quot; */</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classSETS.html#aa96e420735d53c9033c0031f4a02a379">mat_pred</a>.count(<span class="stringliteral">&quot;vitesse&quot;</span>)) eq_qdm.<a class="code hl_function" href="classQDM__Multiphase.html#a1561cd55d09c20fada811f0075a4a368">dimensionner_blocs</a>({{<span class="stringliteral">&quot;vitesse&quot;</span>, &amp;<a class="code hl_variable" href="classSETS.html#aa96e420735d53c9033c0031f4a02a379">mat_pred</a>[<span class="stringliteral">&quot;vitesse&quot;</span>] }}); <span class="comment">//premier passage : dimensionnement</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>      eq_qdm.<a class="code hl_function" href="classQDM__Multiphase.html#a7434d149a38184ddfeb27ba9d82ddd6b">assembler_blocs_avec_inertie</a>({{<span class="stringliteral">&quot;vitesse&quot;</span>, &amp;<a class="code hl_variable" href="classSETS.html#aa96e420735d53c9033c0031f4a02a379">mat_pred</a>[<span class="stringliteral">&quot;vitesse&quot;</span>] }}, secmem);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>      <span class="comment">/* resolution et stockage de la vitesse pedite dans current */</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>      <a class="code hl_class" href="classSolveurSys.html">SolveurSys</a>&amp; solv_qdm = <a class="code hl_function" href="classSimpler__Base.html#a48f161aca850ff2462803f62c040c173">get_and_set_parametre_implicite</a>(eqn).<a class="code hl_function" href="classParametre__implicite.html#a17400e45bc9f12d9eb3e228cf8696e16">solveur</a>();</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>      solv_qdm.<a class="code hl_function" href="classDeriv__SolveurSys__base.html#af20f1e9317a0d617a4862f19e7b17be4">valeur</a>().<a class="code hl_function" href="classSolveurSys__base.html#a8737bd7292204c64e4b7bfe4c7bd88ef">reinit</a>();</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>      <a class="code hl_variable" href="classSETS.html#aa96e420735d53c9033c0031f4a02a379">mat_pred</a>[<span class="stringliteral">&quot;vitesse&quot;</span>].ajouter_multvect(current, secmem); <span class="comment">//passage increment -&gt; variable pour faire plaisir aux solveurs iteratifs</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>      solv_qdm.<a class="code hl_function" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(<a class="code hl_variable" href="classSETS.html#aa96e420735d53c9033c0031f4a02a379">mat_pred</a>[<span class="stringliteral">&quot;vitesse&quot;</span>], secmem, current);</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>      semi_impl[<span class="stringliteral">&quot;vitesse&quot;</span>] = current;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    }</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>  <span class="keywordflow">else</span> semi_impl[<span class="stringliteral">&quot;vitesse&quot;</span>] = eq_qdm.<a class="code hl_function" href="classNavier__Stokes__std.html#a17aa9441decd5cd3c6a04f7d05ccf9cf">inconnue</a>().<a class="code hl_function" href="classChamp__Inc.html#a9eb0877acb8b81d59985898dbbb5417f">passe</a>();</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>  eqn.<a class="code hl_function" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e">solv_masse</a>().<a class="code hl_function" href="classSolveur__Masse.html#a856562aab8d40820986e2a68341c6fa4">corriger_solution</a>(current, current, 0); <span class="comment">//pour PolyMAC_P0 : vf -&gt; ve</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> </div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span><span class="comment">// premier passage : dimensionnement de mat_semi_impl, remplissage de p_degen_</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classSETS.html#a8ee91bd4406997e979f5157a55749010">mat_semi_impl</a>.<a class="code hl_function" href="classMatrice__Bloc.html#a9aba415d048c323f8cf498d4492f8127">nb_lignes</a>())</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    {</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>      <a class="code hl_variable" href="classSETS.html#a8ee91bd4406997e979f5157a55749010">mat_semi_impl</a>.<a class="code hl_function" href="classMatrice__Bloc.html#a1db7c549cc1be958d5f00c29cd0f3a8c">dimensionner</a>(n_eq + 1, n_eq + 1);<span class="comment">//derniere ligne -&gt; continuite</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>      <span class="keywordflow">for</span> (i = 0; i &lt;= n_eq; i++)</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        <span class="keywordflow">for</span> (j = 0; j &lt;= n_eq; j++)</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>          <a class="code hl_variable" href="classSETS.html#a8ee91bd4406997e979f5157a55749010">mat_semi_impl</a>.<a class="code hl_function" href="classMatrice__Bloc.html#a76a5691fecfea8b4dd877d2c449a7f21">get_bloc</a>(i, j).<a class="code hl_function" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719">typer</a>(<span class="stringliteral">&quot;Matrice_Morse&quot;</span>), <a class="code hl_variable" href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">mats</a>[noms[i]][noms[j]] = &amp;<a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>, <a class="code hl_variable" href="classSETS.html#a8ee91bd4406997e979f5157a55749010">mat_semi_impl</a>.<a class="code hl_function" href="classMatrice__Bloc.html#a76a5691fecfea8b4dd877d2c449a7f21">get_bloc</a>(i, j).<a class="code hl_function" href="classDeriv__Matrice__Base.html#a6d78a97ea87044a4b8c0cc2c6609f3e0">valeur</a>());</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;i_eq : eqs) i_eq.second-&gt;dimensionner_blocs(<a class="code hl_variable" href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">mats</a>[i_eq.first], semi_impl); <span class="comment">//option semi-implicite</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>      eq_qdm.<a class="code hl_function" href="classNavier__Stokes__std.html#af9f5e0396945755597f147bd424a4a08">assembleur_pression</a>()-&gt;dimensionner_continuite(<a class="code hl_variable" href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">mats</a>[<span class="stringliteral">&quot;pression&quot;</span>]);</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span> </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>      <span class="comment">/* reglage de p_degen si non lu : si incompressible sans CLs de pression imposee, alors la pression est degeneree */</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSETS.html#a3ac3e326835cd7b7e65512befd351443">p_degen</a> &lt; 0)</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        <span class="keywordflow">for</span> (<a class="code hl_variable" href="classSETS.html#a3ac3e326835cd7b7e65512befd351443">p_degen</a> = <a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classFluide__base.html">Fluide_base</a>, eq_qdm.<a class="code hl_function" href="classNavier__Stokes__std.html#a1b86014b53c283d1871d6e50a9489c7c">milieu</a>()), i = 0; i &lt; eq_qdm.<a class="code hl_function" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab">zone_Cl_dis</a>().<a class="code hl_function" href="classZone__Cl__dis.html#aa8bea2d873a74d7ec939ddc0cf6c41b7">nb_cond_lim</a>(); i++)</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>          <a class="code hl_variable" href="classSETS.html#a3ac3e326835cd7b7e65512befd351443">p_degen</a> &amp;= !<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classNeumann__val__ext.html">Neumann_val_ext</a>, eq_qdm.<a class="code hl_function" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab">zone_Cl_dis</a>().<a class="code hl_function" href="classZone__Cl__dis.html#a4777480745dd18899c4bc3e9cb774ea4">les_conditions_limites</a>(i).<a class="code hl_function" href="classDeriv__Cond__lim__base.html#afd7af50ad75a2cde929df2cedb684d58">valeur</a>());</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    }</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span> </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>  <span class="comment">/* Newton : assemblage de mat_semi_impl -&gt; assemblage de la matrice en pression -&gt; resolution -&gt; substitution */</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>  <a class="code hl_typedef" href="Interface__blocs_8h.html#a2d7480bf11fc9f791b1d2839fa30a5c3">tabs_t</a> incr, sec; <span class="comment">//increments / seconds membres associes</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;n_i : inco) incr[n_i.first] = sec[n_i.first] = n_i.second-&gt;valeurs();</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span> </div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>  <a class="code hl_class" href="classbprinter_1_1TablePrinter.html">TablePrinter</a> tp(&amp;<a class="code hl_function" href="EntreeSortie_8h.html#a5b79a31f0834a117406ebff0c6f907bd">get_Cerr</a>().get_ostream());</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4">Process::me</a>())</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    {</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>      tp.<a class="code hl_function" href="classbprinter_1_1TablePrinter.html#a271d4d46ec64e34f3b00093d0971101d">AddColumn</a>(<span class="stringliteral">&quot;it&quot;</span>, 5);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;n_i : inco) tp.<a class="code hl_function" href="classbprinter_1_1TablePrinter.html#a271d4d46ec64e34f3b00093d0971101d">AddColumn</a>(n_i.first, std::max(12, (<a class="code hl_typedef" href="arch_8h.html#a1caaf369d9c5f0817dbaa76b43b8d87b">True_int</a>) n_i.first.length()));</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>      tp.<a class="code hl_function" href="classbprinter_1_1TablePrinter.html#a4022eb59d90fec098cda994b147ce9b3">PrintHeader</a>();</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    }</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span> </div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>  <span class="keywordflow">for</span> (it = 0, cv = 0; it &lt; <a class="code hl_variable" href="classSETS.html#a416660a4c6b560c16a63ef41bc99383f">iter_min_</a> || (!cv &amp;&amp; it &lt; <a class="code hl_variable" href="classSETS.html#acf75db99aa6f39fb02552f774ac26d17">iter_max_</a>); it++)</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    {</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>      <span class="comment">/* remplissage par assembler_blocs */</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span><span class="comment">// equation d&#39;energie en premier pour pouvoir utiliser q_pi dans d&#39;autres equations</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>      eqs[<span class="stringliteral">&quot;temperature&quot;</span>]-&gt;assembler_blocs_avec_inertie(<a class="code hl_variable" href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">mats</a>[<span class="stringliteral">&quot;temperature&quot;</span>], sec[<span class="stringliteral">&quot;temperature&quot;</span>], semi_impl);</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span><span class="comment">// les autres</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;n_e : eqs)</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>        <span class="keywordflow">if</span> (n_e.first != <span class="stringliteral">&quot;temperature&quot;</span>) n_e.second-&gt;assembler_blocs_avec_inertie(<a class="code hl_variable" href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">mats</a>[n_e.first], sec[n_e.first], semi_impl);</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span><span class="comment">// equation de continuite sum_k alpha_k = 1</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>      eq_qdm.<a class="code hl_function" href="classNavier__Stokes__std.html#af9f5e0396945755597f147bd424a4a08">assembleur_pression</a>()-&gt;assembler_continuite(<a class="code hl_variable" href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">mats</a>[<span class="stringliteral">&quot;pression&quot;</span>], sec[<span class="stringliteral">&quot;pression&quot;</span>]);</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span> </div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>      <span class="comment">/* expression des autres inconnues (x) en fonction de p : vitesse, puis temperature / pression */</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>      <a class="code hl_typedef" href="Interface__blocs_8h.html#a2d7480bf11fc9f791b1d2839fa30a5c3">tabs_t</a> b_p;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>      std::vector&lt;std::set&lt;std::pair&lt;std::string, int&gt;&gt;&gt; ordre;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>      <span class="keywordflow">if</span> (eq_qdm.<a class="code hl_function" href="classEquation__base.html#a12d97ae801edc18f614523677921346e">zone_dis</a>().<a class="code hl_function" href="classDeriv__Zone__dis__base.html#a0d72b842885db3be30e1bf41a4136934">valeur</a>().<a class="code hl_function" href="classObjet__U.html#a93dacab7253df3f9df63d1aca21b1dd5">le_nom</a>() == <span class="stringliteral">&quot;PolyMAC_P0&quot;</span>) ordre.push_back({{ <span class="stringliteral">&quot;vitesse&quot;</span>, 1 }}); <span class="comment">//si PolyMAC_P0: on commence par ve</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>      ordre.push_back({{ <span class="stringliteral">&quot;vitesse&quot;</span>, 0 }}), ordre.push_back({}); <span class="comment">//puis vf, puis toutes les autres inconnues simultanément</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;nom : noms)</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>        <span class="keywordflow">if</span> (nom != <span class="stringliteral">&quot;vitesse&quot;</span> &amp;&amp; nom != <span class="stringliteral">&quot;pression&quot;</span>) ordre.back().insert({{ nom, 0 }});</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>      eliminer(ordre, <span class="stringliteral">&quot;pression&quot;</span>, mats, sec, A_p, b_p);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>      <span class="comment">/* assemblage du systeme en pression */</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>      <a class="code hl_class" href="classTRUSTTrav.html">DoubleTrav</a> secmem_pression;</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>      <a class="code hl_function" href="Champ__P1iP1B__implementation_8cpp.html#a66b05ebb3893c77d400802a0828ab94d">assembler</a>(<span class="stringliteral">&quot;pression&quot;</span>, A_p, b_p, mats, sec, matrice_pression, secmem_pression, p_degen);</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>      <a class="code hl_class" href="classSolveurSys.html">SolveurSys</a>&amp; solv_p = eq_qdm.solveur_pression();</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span><span class="preprocessor">#ifdef PETSCKSP_H</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>      <span class="keywordflow">if</span> (!cv_ctx &amp;&amp; <a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classSolv__Petsc.html">Solv_Petsc</a>, solv_p.<a class="code hl_function" href="classDeriv__SolveurSys__base.html#af20f1e9317a0d617a4862f19e7b17be4">valeur</a>()))</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>        {</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>          init_cv_ctx(secmem_pression, eq_qdm.assembleur_pression()-&gt;norme_continuite());</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>          <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classSolv__Petsc.html">Solv_Petsc</a>, solv_p.<a class="code hl_function" href="classDeriv__SolveurSys__base.html#af20f1e9317a0d617a4862f19e7b17be4">valeur</a>()).set_convergence_test(convergence_test, cv_ctx, destroy_cvctx);</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        }</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span> </div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>      <span class="comment">/* resolution : seulement si l&#39;erreur en alpha (dans secmem_pression) depasse un seuil */</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="TRUSTVect__tools_8tpp.html#a0116112e8e7962f9f0d797b0bf141c00">mp_max_abs_vect</a>(secmem_pression) &gt; 1e-16)</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        {</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>          matrice_pression.ajouter_multvect(inco[<span class="stringliteral">&quot;pression&quot;</span>]-&gt;valeurs(), secmem_pression); <span class="comment">//passage increment -&gt; variable pour faire plaisir aux solveurs iteratifs</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>          solv_p.<a class="code hl_function" href="classDeriv__SolveurSys__base.html#af20f1e9317a0d617a4862f19e7b17be4">valeur</a>().<a class="code hl_function" href="classSolveurSys__base.html#a8737bd7292204c64e4b7bfe4c7bd88ef">reinit</a>(), solv_p.<a class="code hl_function" href="classDeriv__SolveurSys__base.html#af20f1e9317a0d617a4862f19e7b17be4">valeur</a>().<a class="code hl_function" href="classSolveurSys__base.html#a27067468cf159dc2e08c693ac7432685">set_return_on_error</a>(1); <span class="comment">/* pour eviter un exit() en cas d&#39;echec */</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>          ok = (solv_p.<a class="code hl_function" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(matrice_pression, secmem_pression, incr[<span class="stringliteral">&quot;pression&quot;</span>]) &gt;= 0);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>          <span class="keywordflow">if</span> (!ok) <span class="keywordflow">break</span>; <span class="comment">//le solveur a echoue -&gt; on sort</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>          incr[<span class="stringliteral">&quot;pression&quot;</span>].<a class="code hl_function" href="classTRUSTVect.html#a7df489e59381e175b1df9cef48355fe5">echange_espace_virtuel</a>();</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>          incr[<span class="stringliteral">&quot;pression&quot;</span>] -= inco[<span class="stringliteral">&quot;pression&quot;</span>]-&gt;valeurs();</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>        }</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>      <span class="keywordflow">else</span> incr[<span class="stringliteral">&quot;pression&quot;</span>] = 0;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span><span class="comment">// increments des autres variables</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;n_v : b_p)</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>        {</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>          incr[n_v.first] = n_v.second; <span class="comment">//partie constante</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>          A_p[n_v.first].ajouter_multvect(incr[<span class="stringliteral">&quot;pression&quot;</span>], incr[n_v.first]); <span class="comment">//dependance en les increments de pression</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>          incr[n_v.first].<a class="code hl_function" href="classTRUSTVect.html#a7df489e59381e175b1df9cef48355fe5">echange_espace_virtuel</a>();</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        }</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>      eqn.solv_masse().corriger_solution(incr[<span class="stringliteral">&quot;vitesse&quot;</span>], incr[<span class="stringliteral">&quot;vitesse&quot;</span>], 1); <span class="comment">//pour PolyMAC_P0 : sert a corriger ve</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span> </div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4">Process::me</a>()) tp &lt;&lt; it + 1;</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;n_v : incr)</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>        {</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>          <span class="keywordtype">double</span> vm = <a class="code hl_function" href="TRUSTVect__tools_8tpp.html#a0bb4e8f4c68ebb7a65df50f6aad6fbb1">mp_min_vect</a>(n_v.second), vM = <a class="code hl_function" href="TRUSTVect__tools_8tpp.html#a76d21367b48f44f3164f6f7f91e58a92">mp_max_vect</a>(n_v.second), x = std::fabs(vM) &gt; std::fabs(vm) ? vM : vm;</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>          <span class="keywordflow">if</span> (!<a class="code hl_function" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4">Process::me</a>()) tp &lt;&lt; x;</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>        }</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>      <span class="comment">/* convergence? */</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>      cv = <a class="code hl_function" href="SETS_8cpp.html#a0ca1eedfe96bd2b8dff05676ebd8ba81">corriger_incr_alpha</a>(inco[<span class="stringliteral">&quot;alpha&quot;</span>]-&gt;valeurs(), incr[<span class="stringliteral">&quot;alpha&quot;</span>], err_a_sum) &lt; crit_conv[<span class="stringliteral">&quot;alpha&quot;</span>];</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp; n_v : incr)</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>        <span class="keywordflow">if</span> (crit_conv.count(n_v.first)) cv &amp;= <a class="code hl_function" href="TRUSTVect__tools_8tpp.html#a0116112e8e7962f9f0d797b0bf141c00">mp_max_abs_vect</a>(n_v.second) &lt; crit_conv.at(n_v.first);</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span> </div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>      <span class="comment">/* mises a jour : inconnues -&gt; milieu -&gt; champs/conserves -&gt; sources */</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp; n_i : inco) n_i.second-&gt;valeurs() += incr[n_i.first];</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>      <span class="keywordflow">if</span> (p_degen) inco[<span class="stringliteral">&quot;pression&quot;</span>]-&gt;valeurs() -= <a class="code hl_function" href="TRUSTVect__tools_8tpp.html#a0bb4e8f4c68ebb7a65df50f6aad6fbb1">mp_min_vect</a>(inco[<span class="stringliteral">&quot;pression&quot;</span>]-&gt;valeurs()); <span class="comment">//!&lt; On prend la pression minimale comme pression de reference afin d&#39;avoir la meme pression de reference en sequentiel et parallele</span></div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>      <span class="keywordflow">if</span> (!(ok = err_a_sum &lt; crit_conv[<span class="stringliteral">&quot;alpha&quot;</span>] &amp;&amp; eq_qdm.milieu().check_unknown_range())) <span class="keywordflow">break</span>; <span class="comment">//si on a depasse les bornes du milieu sur (p, T) ou si on manque de precision, on doit sortir</span></div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>      pb.mettre_a_jour(t); <span class="comment">//inconnues -&gt; milieu -&gt; champs conserves</span></div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    }</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4">Process::me</a>()) tp.PrintFooter();</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span><span class="comment">// ha ha ha</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>  <span class="keywordflow">if</span> (ok &amp;&amp; cv)</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    {</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>      <span class="keywordflow">for</span> (i = 0 ; i &lt; pb.nombre_d_equations(); i++)</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>        <span class="keywordflow">if</span> (pb.equation(i).positive_unkown()==1)</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>          {</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>            std::string nom_inco = pb.equation(i).inconnue().le_nom().getString() ;</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>            unknown_positivation(inco[nom_inco]-&gt;valeurs(), incr[nom_inco]) ;</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>          }</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>      pb.mettre_a_jour(t); <span class="comment">//inconnues -&gt; milieu -&gt; champs conserves</span></div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp; n_i : inco) n_i.second-&gt;futur() = n_i.second-&gt;valeurs();</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>      eq_qdm.pression().futur() = eq_qdm.pression().valeurs();</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>      <a class="code hl_class" href="classConstTRUSTTab__parts.html">ConstDoubleTab_parts</a> ppart(inco[<span class="stringliteral">&quot;pression&quot;</span>]-&gt;valeurs());</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span><span class="comment">// en multiphase, la pression est deja en Pa</span></div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>      <span class="comment">/* si pression_pa() est plus petit que pression() (ex. : variables auxiliaires PolyMAC), alors on ne copie que la 1ere partie */</span></div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>      eq_qdm.pression_pa().valeurs() = eq_qdm.pression_pa().valeurs().dimension_tot(0) &lt; inco[<span class="stringliteral">&quot;pression&quot;</span>]-&gt;valeurs().dimension_tot(0) ? ppart[0] : inco[<span class="stringliteral">&quot;pression&quot;</span>]-&gt;valeurs(); <span class="comment">//en multiphase, la pression est deja en Pa</span></div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>      first_call_ = 0;</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    }</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    {</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp; n_i : inco)  n_i.second-&gt;futur() = n_i.second-&gt;valeurs() = n_i.second-&gt;passe();</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>      <span class="keywordflow">if</span> (err_a_sum &gt; crit_conv[<span class="stringliteral">&quot;alpha&quot;</span>])</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; que_suis_je() + <span class="stringliteral">&quot;: pressure solver inaccuracy detected (requested precision &quot;</span> &lt;&lt; <a class="code hl_class" href="classNom.html">Nom</a>(crit_conv[<span class="stringliteral">&quot;alpha&quot;</span>]) &lt;&lt; <span class="stringliteral">&quot; , achieved precision &quot;</span> &lt;&lt; <a class="code hl_class" href="classNom.html">Nom</a>(err_a_sum) + <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>      ok = 0;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    }</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>}</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span> </div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno"><a class="line" href="classSETS.html#a65a91eb7e8b072a65446a80b7fc65781">  431</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classSETS.html#a65a91eb7e8b072a65446a80b7fc65781">SETS::eliminer</a>(<span class="keyword">const</span> std::vector&lt;std::set&lt;std::pair&lt;std::string, int&gt;&gt;&gt; ordre, <span class="keyword">const</span> std::string inco_p, <span class="keyword">const</span> std::map&lt;std::string, matrices_t&gt;&amp; mats,</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>                    <span class="keyword">const</span> <a class="code hl_typedef" href="Interface__blocs_8h.html#a2d7480bf11fc9f791b1d2839fa30a5c3">tabs_t</a>&amp; sec, std::map&lt;std::string, Matrice_Morse&gt;&amp; A_p, <a class="code hl_typedef" href="Interface__blocs_8h.html#a2d7480bf11fc9f791b1d2839fa30a5c3">tabs_t</a>&amp; b_p)</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>{</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>  <span class="keywordtype">int</span> i, j, jb, k, l, lb, m, oMl, oMg, M, n, oNl, oNg, N, prems = !<a class="code hl_variable" href="classSETS.html#a53cd8850df0e00210aa6c4cea0e978cd">A_p</a>.size(), infoo = 0; <span class="comment">//si A_p est vide, premier passage -&gt; on doit dimensionner</span></div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>  <span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a> * A;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>  <span class="keywordtype">char</span> trans = <span class="charliteral">&#39;T&#39;</span>;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span> </div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>  <span class="comment">/* decoupage des inconnues de sec en parties par DoubleTab_parts */</span></div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>  std::map&lt;std::pair&lt;std::string, int&gt;, <span class="keywordtype">int</span>&gt; offs; <span class="comment">//offs[{inco, bloc}] : offset du bloc k de l&#39;inconnue inco</span></div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>  std::map&lt;std::pair&lt;std::string, int&gt;, std::array&lt;int, 2&gt;&gt; dims; <span class="comment">//dims[{inco, bloc}] : dimension 0/ line_size() du bloc k de inco</span></div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;n_v : sec)</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    {</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>      <a class="code hl_class" href="classConstTRUSTTab__parts.html">ConstDoubleTab_parts</a> part(n_v.second);</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>      <span class="keywordflow">for</span> (i = 0; i &lt; part.<a class="code hl_function" href="classConstTRUSTTab__parts.html#ae10f3ef0c7e534ca9eba15590b4b7385">size</a>(); i++)</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>        {</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>          offs[ {n_v.first, i}] = offs.count({ n_v.first, i - 1 }) ? offs[ { n_v.first, i - 1 }] + dims[ { n_v.first, i - 1 }][0] * dims[ { n_v.first, i - 1 }][1] : 0;</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>          dims[ {n_v.first, i}] = { part[i].dimension_tot(0), part[i].line_size() };</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>        }</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>    }</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span> </div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>  <span class="comment">/* boucle sur les blocs */</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>  std::set&lt;std::pair&lt;std::string, int&gt;&gt; e_ib; <span class="comment">//liste des { variable, bloc } deja elimines</span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>  std::set&lt;std::string&gt; e_i; <span class="comment">//liste des variables deja eliminees</span></div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;bloc : ordre)</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    {</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>      std::set&lt;std::string&gt; i_bloc, dep; <span class="comment">//variables du bloc, variables deja eliminees dont le bloc depend</span></div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;i_b : bloc) i_bloc.insert(i_b.first);</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;i_b : bloc)</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp; v_m : <a class="code hl_variable" href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">mats</a>.at(i_b.first))</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>          <span class="keywordflow">if</span> (v_m.second-&gt;nb_colonnes() &amp;&amp; v_m.first != inco_p &amp;&amp; e_i.count(v_m.first) &amp;&amp; !i_bloc.count(v_m.first))</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>            dep.insert(v_m.first);</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span> </div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>      <span class="comment">/* lignes du bloc a traiter */</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>      std::pair&lt;std::string, int&gt; i_b0 = *bloc.begin();<span class="comment">//premiere inconnue du bloc</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>      <a class="code hl_class" href="classTRUSTTrav.html">IntTrav</a> calc(dims[i_b0][0]); <span class="comment">//calc[i] = 1 si on doit traiter l&#39;item i</span></div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>      <span class="keywordflow">for</span> (A = <a class="code hl_variable" href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">mats</a>.at(i_b0.first).at(i_b0.first), oMg = offs[i_b0], M = dims[i_b0][1], i = 0; i &lt; calc.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>(); i++)</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>        <span class="keywordflow">if</span> (A-&gt;<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>()(oMg + M * i + 1) &gt; A-&gt;<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>()(oMg + M * i)) calc(i) = 1; <span class="comment">//on traite toutes les lignes dont la matrice est remplie</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span> </div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>      <span class="keywordflow">if</span> (prems) <span class="comment">//premier passage -&gt; dimensionnement des A_p</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>        {</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>          <span class="comment">/* verification de la compatibilite des inconnues du bloc -&gt; avec les MD_Vector renseignes dans sec */</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;i_b : bloc)</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>            <span class="keywordflow">if</span> (dims[i_b0][0] != dims[i_b][0])</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;SETS::eliminer() : discretisation des inconnues&quot;</span> &lt;&lt; i_b0.first &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; i_b0.second &lt;&lt; <span class="stringliteral">&quot; et &quot;</span> &lt;&lt; i_b.first</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>                   &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; i_b.second &lt;&lt; <span class="stringliteral">&quot; incompatibles!&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">Process::exit</a>();</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>          std::vector&lt;std::set&lt;int&gt;&gt; stencil(calc.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>()); <span class="comment">//stencil[i] -&gt; stencil de l&#39;item i (a demultiplier par le line_size() de chaque variable)</span></div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;i_b : bloc)</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;v_m : <a class="code hl_variable" href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">mats</a>.at(i_b.first))</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>              <span class="keywordflow">if</span> (v_m.second-&gt;nb_colonnes())</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>                {</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>                  oMg = offs[i_b], M = dims[i_b][1];</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>                  <span class="keywordflow">if</span> (v_m.first == inco_p) <span class="comment">//dependance directe en inco_p</span></div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>                    {</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>                      <span class="keywordflow">for</span> (i = 0; i &lt; calc.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>(); i++)</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>                        <span class="keywordflow">if</span> (calc[i])</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>                          <span class="keywordflow">for</span> (j = v_m.second-&gt;get_tab1()(oMg + M * i) - 1; j &lt; v_m.second-&gt;get_tab1()(oMg + M * (i + 1)) - 1; j++) <span class="comment">//dependances de toutes les lignes</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>                            stencil[i].insert(v_m.second-&gt;get_tab2()(j) - 1);</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>                    }</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e_i.count(v_m.first) || i_bloc.count(v_m.first)) <span class="comment">//dependance en une variable partiellement / totalement eliminee</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>                    {</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>                      A = <a class="code hl_variable" href="classSETS.html#a53cd8850df0e00210aa6c4cea0e978cd">A_p</a>.count(v_m.first) ? &amp;<a class="code hl_variable" href="classSETS.html#a53cd8850df0e00210aa6c4cea0e978cd">A_p</a>.at(v_m.first) : NULL;</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>                      <span class="keywordflow">for</span> (i = 0; i &lt; calc.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>(); i++)</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>                        <span class="keywordflow">if</span> (calc[i])</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>                          <span class="keywordflow">for</span> (j = v_m.second-&gt;get_tab1()(oMg + M * i) - 1; j &lt; v_m.second-&gt;get_tab1()(oMg + M * (i + 1)) - 1; j++)</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>                            {</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>                              <span class="keywordflow">for</span> (jb = v_m.second-&gt;get_tab2()(j) - 1, k = 0; offs.count({ v_m.first, k + 1}) &amp;&amp; jb &gt;= offs.at({ v_m.first, k + 1 }); ) k++; <span class="comment">//l : bloc de l&#39;inconnue dont on depend</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>                              oNg = offs[ { v_m.first, k }], N = dims[ { v_m.first, k }][1], n = jb - oNg - N * i;</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>                              <span class="keywordflow">if</span> (bloc.count({ v_m.first, k }) &amp;&amp; n &gt;= 0 &amp;&amp; n &lt; N) <span class="keywordflow">continue</span>; <span class="comment">//(variable, bloc) en cours d&#39;elimination et coeff bloc-diagonal -&gt; ok</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>                              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e_ib.count({ v_m.first, k }))  <span class="comment">//(variable, bloc) elimine -&gt; dependance en inco_p dans A_p</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>                                <span class="keywordflow">for</span> (l = A-&gt;<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>()(jb) - 1; l &lt; A-&gt;get_tab1()(jb + 1) - 1; l++)</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>                                  stencil[i].insert(A-&gt;<a class="code hl_function" href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">get_tab2</a>()(l) - 1);</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>                              <span class="keywordflow">else</span> <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;SETS::eliminer() : dependance ( &quot;</span> &lt;&lt; i_b.first &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; i_b.second &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>                                          &lt;&lt; v_m.first &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; ) interdite!&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">Process::exit</a>();</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>                            }</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>                    }</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>                  <span class="keywordflow">else</span> <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;SETS::eliminer() : dependance ( &quot;</span> &lt;&lt; i_b.first &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; i_b.second &lt;&lt; <span class="stringliteral">&quot; , &quot;</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>                              &lt;&lt; v_m.first &lt;&lt; <span class="stringliteral">&quot; ) interdite!&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">Process::exit</a>();</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>                }</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;i_bl : bloc) <span class="comment">//stencil par inconnue -&gt; en demultipliant</span></div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>            {</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>              <a class="code hl_class" href="classTRUSTTrav.html">IntTrav</a> sten(0, 2);</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>              sten.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>(1);</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>              <span class="keywordflow">for</span> (oMg = offs[i_bl], M = dims[i_bl][1], i = 0; i &lt; calc.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>(); i++)</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>                <span class="keywordflow">if</span> (calc[i])</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>                  <span class="keywordflow">for</span> (m = 0; m &lt; M; m++)</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;col : stencil[i]) sten.<a class="code hl_function" href="classTRUSTTab.html#aeafea8c8242ddec97c6bacfd74b34fc3">append_line</a>(oMg + M * i + m, col);</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>              <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a> mat2;</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>              <a class="code hl_function" href="classMatrix__tools.html#a00e41ca3d70e9d0e937c883b17ad04b3">Matrix_tools::allocate_morse_matrix</a>(sec.at(i_bl.first).size_totale(), sec.at(inco_p).size_totale(), sten, mat2);</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>              <a class="code hl_variable" href="classSETS.html#a53cd8850df0e00210aa6c4cea0e978cd">A_p</a>[i_bl.first].nb_colonnes() ? <a class="code hl_variable" href="classSETS.html#a53cd8850df0e00210aa6c4cea0e978cd">A_p</a>[i_bl.first] += mat2 : <a class="code hl_variable" href="classSETS.html#a53cd8850df0e00210aa6c4cea0e978cd">A_p</a>[i_bl.first] = mat2; <span class="comment">//A_p peut deja etre partiellement creee</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>            }</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>        }</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span> </div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>      std::vector&lt;std::string&gt; vbloc(i_bloc.begin(), i_bloc.end()), vdep(dep.begin(), dep.end()); <span class="comment">//sous forme de liste</span></div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>      <span class="keywordtype">int</span> nv = vbloc.size(), nd = vdep.size(), nb = 0; <span class="comment">//nombre de variables du bloc, de dependances, taille totale</span></div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>      std::vector&lt;int&gt; size, off_l, off_g; <span class="comment">//par (variable, bloc) : taille dans le systeme local, offset dans le systeme local, offset dans les systemes globaux</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp; i_b : bloc) off_l.push_back(nb), size.push_back(dims[i_b][1]), off_g.push_back(offs[i_b]), nb += size.back();</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span> </div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>      std::vector&lt;const Matrice_Morse *&gt; pmat(nv), dAp(nd); <span class="comment">//par variable : dependance directe en inco_p, des variables du bloc / deja resolues</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>      std::vector&lt;std::vector&lt;const Matrice_Morse *&gt;&gt; mat(nv), dmat(nv); <span class="comment">//matrices des variables du bloc, des dependances</span></div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>      std::vector&lt;const DoubleTab*&gt; vsec(nv), dbp(nd); <span class="comment">//seconds membres des variables, vecteurs b_p des variables / des dependances</span></div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span> </div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>      std::vector&lt;Matrice_Morse *&gt; Ap(nv); <span class="comment">//resultats : d{inco} = A_p[inco].d{inco_p} + b_p[inco] pour les variables du bloc</span></div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>      std::vector&lt;DoubleTab*&gt; bp(nv);</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span> </div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>      <span class="keywordflow">for</span> (i = 0; i &lt; nv; i++)</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>        {</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>          Ap[i] = &amp;<a class="code hl_variable" href="classSETS.html#a53cd8850df0e00210aa6c4cea0e978cd">A_p</a>[vbloc[i]], vsec[i] = &amp;sec.at(vbloc[i]);</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>          <span class="keywordflow">if</span> (!b_p.count(vbloc[i])) b_p[vbloc[i]] = *vsec[i]; <span class="comment">//creation des b_p</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>          bp[i] = &amp;b_p[vbloc[i]];</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="Interface__blocs_8h.html#a68e4f5c4505f6b31305de844302660bb">matrices_t</a>&amp; line = <a class="code hl_variable" href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">mats</a>.at(vbloc[i]);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>          pmat[i] = line.count(inco_p) &amp;&amp; line.at(inco_p)-&gt;nb_colonnes() ? line.at(inco_p) : NULL;</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>          <span class="keywordflow">for</span> ( mat[i].resize(nv), j = 0; j &lt; nv; j++)  mat[i][j] = line.count(vbloc[j]) &amp;&amp; line.at(vbloc[j])-&gt;nb_colonnes() ? line.at(vbloc[j]) : NULL;</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>          <span class="keywordflow">for</span> (dmat[i].resize(nd), j = 0; j &lt; nd; j++) dmat[i][j] = line.count(vdep[j]) &amp;&amp; line.at(vdep[j])-&gt;nb_colonnes() ? line.at(vdep[j]) : NULL;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        }</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>      <span class="keywordflow">for</span> (i = 0; i &lt; nd; i++) dbp[i] = &amp;b_p.at(vdep[i]), dAp[i] = &amp;<a class="code hl_variable" href="classSETS.html#a53cd8850df0e00210aa6c4cea0e978cd">A_p</a>.at(vdep[i]); <span class="comment">//b_p / A_p des dependances</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span> </div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>      <a class="code hl_class" href="classTRUSTTrav.html">DoubleTrav</a> D(nb, nb), S; <span class="comment">//bloc diagonal, seconds membres</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>      S.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>(1);</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>      <a class="code hl_class" href="classTRUSTTrav.html">IntTrav</a> piv(nb);</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>      <span class="keywordflow">for</span> (i = 0; i &lt; calc.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>(); i++)</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>        <span class="keywordflow">if</span> (calc[i])</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>          {</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>            <span class="keywordtype">int</span> deb = Ap[0]-&gt;get_tab1()(off_g[0] + size[0] * i) - 1, fin = Ap[0]-&gt;get_tab1()(off_g[0] + size[0] * i + 1) - 1, ic = fin - deb, nc = ic + 1, pos, col;</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>            S.<a class="code hl_function" href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">resize</a>(nc, nb), S = 0; <span class="comment">//second membre : 5(i, .) -&gt; dependance en la i-eme colonne du stencil des Ap du bloc, S(ic, .) -&gt; partie constante</span></div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span><span class="comment">// partie &quot;second membre des equations&quot;</span></div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>            <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>              <span class="keywordflow">for</span> (M = size[j], oMg = off_g[j], oMl = off_l[j], m = 0; m &lt; M; m++) S(ic, oMl + m) = vsec[j]-&gt;<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>()[oMg + M * i + m];</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span> </div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>            <span class="comment">/* remplissage par les matrices du bloc : diagonale, second membre (si partie d&#39;une variable deja eliminee) */</span></div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>            <span class="keywordflow">for</span> (D = 0, j = 0; j &lt; nv; j++)</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>              <span class="keywordflow">for</span> (M = size[j], oMg = off_g[j], oMl = off_l[j], k = 0; k &lt; nv; k++)</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>                <span class="keywordflow">if</span> (mat[j][k])</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>                  {</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>                    <span class="keywordflow">for</span> (N = size[k], oNg = off_g[k], oNl = off_l[k], m = 0; m &lt; M; m++)</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>                      <span class="keywordflow">for</span> (l = mat[j][k]-&gt;get_tab1()(oMg + M * i + m) - 1; l &lt; mat[j][k]-&gt;get_tab1()(oMg + M * i + m + 1) - 1; l++)</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>                        <span class="keywordflow">if</span> ((n = (jb = mat[j][k]-&gt;get_tab2()(l) - 1) - oNg - N * i) &gt;= 0 &amp;&amp; n &lt; N) <span class="comment">//on est dans le bloc diagonal</span></div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>                          D(oMl + m, oNl + n) = mat[j][k]-&gt;get_coeff()(l);</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>                        <span class="keywordflow">else</span> <span class="comment">//dependance en un bloc deja elimine</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>                          {</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>                            <span class="keywordtype">double</span> <a class="code hl_variable" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = mat[j][k]-&gt;get_coeff()(l);</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>                            S(ic, oMl + m) -= <a class="code hl_variable" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> * bp[k]-&gt;addr()[jb];</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>                            <span class="keywordflow">for</span> (lb = Ap[k]-&gt;get_tab1()(jb) - 1, pos = deb - 1; lb &lt; Ap[k]-&gt;get_tab1()(jb + 1) - 1; lb++)</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>                              {</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>                                <span class="keywordflow">for</span> (col = Ap[k]-&gt;get_tab2()(lb), pos++; Ap[0]-&gt;get_tab2()(pos) != col &amp;&amp; pos &lt; fin; ) pos++;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>                                assert(Ap[0]-&gt;get_tab2()(pos) == col);</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>                                S(pos - deb, oMl + m) -= <a class="code hl_variable" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> * Ap[k]-&gt;get_coeff()(lb);</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>                              }</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>                          }</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>                  }</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span> </div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span><span class="comment">// partie &quot;dependance directe en inco_p&quot; -&gt; dans S([0, ic[, .)</span></div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>            <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>              <span class="keywordflow">if</span> (pmat[j])</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>                <span class="keywordflow">for</span> (M = size[j], oMg = off_g[j], oMl = off_l[j], m = 0; m &lt; M; m++)</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>                  <span class="keywordflow">for</span> (k = pmat[j]-&gt;get_tab1()(oMg + M * i + m) - 1, pos = deb - 1; k &lt; pmat[j]-&gt;get_tab1()(oMg + M * i + m + 1) - 1; k++)</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>                    {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>                      <span class="keywordflow">for</span> (col = pmat[j]-&gt;get_tab2()(k), pos++; Ap[0]-&gt;get_tab2()(pos) != col &amp;&amp; pos &lt; fin; ) pos++;</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>                      assert(Ap[0]-&gt;get_tab2()(pos) == col);</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>                      S(pos - deb, oMl + m) -= pmat[j]-&gt;get_coeff()(k);</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>                    }</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span><span class="comment">// partie &quot;dependance en une variable hors bloc eliminee&quot; -&gt; b_p contribue a S(0, .), A_p contribue a S(1..nc, .)</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>            <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>              <span class="keywordflow">for</span> (k = 0; k &lt; nd; k++)</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>                <span class="keywordflow">if</span> (dmat[j][k])</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>                  <span class="keywordflow">for</span> (M = size[j], oMg = off_g[j], oMl = off_l[j], m = 0; m &lt; M; m++)</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>                    <span class="keywordflow">for</span> (l = dmat[j][k]-&gt;get_tab1()(oMg + M * i + m) - 1; l &lt; dmat[j][k]-&gt;get_tab1()(oMg + M * i + m + 1) - 1; l++)</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>                      {</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>                        <span class="keywordtype">double</span> <a class="code hl_variable" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = dmat[j][k]-&gt;get_coeff()(l);</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>                        jb = dmat[j][k]-&gt;get_tab2()(l) - 1, S(ic, oMl + m) -= <a class="code hl_variable" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> * dbp[k]-&gt;addr()[jb]; <span class="comment">//partie &quot;constante&quot;</span></div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>                        <span class="keywordflow">for</span> (lb = dAp[k]-&gt;get_tab1()(jb) - 1, pos = deb - 1; lb &lt; dAp[k]-&gt;get_tab1()(jb + 1) - 1; lb++) <span class="comment">//partie &quot;dependance en inco_p&quot;</span></div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>                          {</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>                            <span class="keywordflow">for</span> (col = dAp[k]-&gt;get_tab2()(lb), pos++; Ap[0]-&gt;get_tab2()(pos) != col &amp;&amp; pos &lt; fin; ) pos++;</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>                            assert(Ap[0]-&gt;get_tab2()(pos) == col);</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>                            S(pos - deb, oMl + m) -= <a class="code hl_variable" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> * dAp[k]-&gt;get_coeff()(lb);</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>                          }</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>                      }</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span> </div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>            <span class="comment">/* factorisation et resolution */</span></div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span><span class="comment">// DoubleTrav D_back = D;</span></div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>            <a class="code hl_define" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(dgetrf)(&amp;nb, &amp;nb, &amp;D(0, 0), &amp;nb, &amp;piv(0), &amp;infoo);</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>            <a class="code hl_define" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(dgetrs)(&amp;trans, &amp;nb, &amp;nc, &amp;D(0, 0), &amp;nb, &amp;piv(0), &amp;S(0, 0), &amp;nb, &amp;infoo);</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span> </div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>            <span class="comment">/* stockage : S(0, .) dans b_p, S(1..nc, .) dans A_p */</span></div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>            <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>              <span class="keywordflow">for</span> (M = size[j], oMg = off_g[j], oMl = off_l[j], m = 0; m &lt; M; m++)</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>                <span class="keywordflow">for</span> (bp[j]-&gt;addr()[oMg + M * i + m] = S(ic, oMl + m), k = 0, l = Ap[j]-&gt;get_tab1()(oMg + M * i + m) - 1; k &lt; ic; k++, l++)</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>                  Ap[j]-&gt;get_set_coeff()(l) = S(k, oMl + m);</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>          }</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span> </div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;i_b : bloc) e_ib.insert(i_b), e_i.insert(i_b.first);</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>    }</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>}</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span> </div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno"><a class="line" href="classSETS.html#aee1d7ecf5c3afe47822a4f1a7705696b">  626</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classSETS.html#aee1d7ecf5c3afe47822a4f1a7705696b">SETS::assembler</a>(<span class="keyword">const</span> std::string inco_p, <span class="keyword">const</span> std::map&lt;std::string, Matrice_Morse&gt;&amp; A_p, <span class="keyword">const</span> <a class="code hl_typedef" href="Interface__blocs_8h.html#a2d7480bf11fc9f791b1d2839fa30a5c3">tabs_t</a>&amp; b_p,</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>                     <span class="keyword">const</span> std::map&lt;std::string, matrices_t&gt;&amp; mats, <span class="keyword">const</span> <a class="code hl_typedef" href="Interface__blocs_8h.html#a2d7480bf11fc9f791b1d2839fa30a5c3">tabs_t</a>&amp; sec, <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; P, <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; secmem, <span class="keywordtype">int</span> p_degen)</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>{</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>  secmem = sec.at(inco_p);</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>  <span class="keywordtype">int</span> i, ib, j, k, l, np = secmem.<a class="code hl_function" href="classTRUSTTab.html#a02f5d997850b88e5f307f6ddaf67286e">dimension_tot</a>(0), m, M = secmem.<a class="code hl_function" href="classTRUSTVect.html#a649c67413e5406c514742aa39dd791b9">line_size</a>(), deb, fin, pos, col;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span> </div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>  <span class="comment">/* calc(i) = 1 si on doit remplir les lignes [N * i, (N + 1) * i[ de la matrice */</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>  <a class="code hl_class" href="classArrOfBit.html">ArrOfBit</a> calc(np);</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>  <span class="keywordflow">if</span> (secmem.<a class="code hl_function" href="classTRUSTVect.html#a7c824c9032be2e622561aa481fe1b8ae">get_md_vector</a>().<a class="code hl_function" href="classMD__Vector.html#a036f2429ea40bd07b331500f6ff22b8f">non_nul</a>()) <a class="code hl_function" href="classMD__Vector__tools.html#ad099d2407b0016920bd8c667a56fddd8">MD_Vector_tools::get_sequential_items_flags</a>(secmem.<a class="code hl_function" href="classTRUSTVect.html#a7c824c9032be2e622561aa481fe1b8ae">get_md_vector</a>(), calc);</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>  <span class="keywordflow">else</span> calc = 1;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span> </div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>  <span class="keywordflow">if</span> (!P.<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>()) <span class="comment">//dimensionnement au premier passage</span></div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    {</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>      <a class="code hl_class" href="classTRUSTTrav.html">IntTrav</a> stencil(0, 2);</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>      stencil.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>(1);</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;n_m : <a class="code hl_variable" href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">mats</a>.at(inco_p))</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>        <span class="keywordflow">if</span> (n_m.second &amp;&amp; n_m.second-&gt;nb_colonnes())</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>          {</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>            <span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; Mp = *n_m.second, *Ap = n_m.first != inco_p ? &amp;<a class="code hl_variable" href="classSETS.html#a53cd8850df0e00210aa6c4cea0e978cd">A_p</a>.at(n_m.first) : NULL;</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>            <span class="keywordflow">for</span> (i = 0; i &lt; np; i++)</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>              <span class="keywordflow">if</span> (calc[i])</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>                <span class="keywordflow">for</span> (ib = M * i, m = 0; m &lt; M; m++, ib++)</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>                  <span class="keywordflow">for</span> (j = Mp.<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>()(ib) - 1; j &lt; Mp.<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>()(ib + 1) - 1; j++)</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>                    <span class="keywordflow">for</span> (k = Mp.<a class="code hl_function" href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">get_tab2</a>()(j) - 1, l = (Ap ? Ap-&gt;get_tab1()(k) - 1 : 0); l &lt; (Ap ? Ap-&gt;get_tab1()(k + 1) - 1 : 1); l++)</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>                      stencil.<a class="code hl_function" href="classTRUSTTab.html#aeafea8c8242ddec97c6bacfd74b34fc3">append_line</a>(ib, Ap ? Ap-&gt;get_tab2()(l) - 1 : k);</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>          }</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>      <a class="code hl_function" href="Array__tools_8cpp.html#a07eed4c823b0632bdbf353fdab2a3c6b">tableau_trier_retirer_doublons</a>(stencil);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>      <a class="code hl_function" href="classMatrix__tools.html#a00e41ca3d70e9d0e937c883b17ad04b3">Matrix_tools::allocate_morse_matrix</a>(secmem.<a class="code hl_function" href="classTRUSTVect.html#a5ae6fa5040fbdc708e54a7aba732413f">size_totale</a>(), secmem.<a class="code hl_function" href="classTRUSTVect.html#a5ae6fa5040fbdc708e54a7aba732413f">size_totale</a>(), stencil, P);</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>    }</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span> </div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>  <span class="comment">/* remplissage de P / secmem */</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>  P.<a class="code hl_function" href="classMatrice__Morse.html#a7654bbef11775a783790d3e9ad0b1501">get_set_coeff</a>() = 0;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;n_m : <a class="code hl_variable" href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">mats</a>.at(inco_p))</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>    <span class="keywordflow">if</span> (n_m.first == inco_p &amp;&amp; n_m.second &amp;&amp; n_m.second-&gt;nb_colonnes()) P += *n_m.second; <span class="comment">/* dependance directe en inco_p -&gt; on ajoute */</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n_m.second &amp;&amp; n_m.second-&gt;nb_colonnes()) <span class="comment">/* dependance en une autre inconnue -&gt; produit Mp.Ap + modif second membre */</span></div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>      {</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        <span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; Mp = *n_m.second, &amp;Ap = <a class="code hl_variable" href="classSETS.html#a53cd8850df0e00210aa6c4cea0e978cd">A_p</a>.at(n_m.first);</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>        <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; bp = b_p.at(n_m.first);</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>        <span class="keywordflow">for</span> (i = 0; i &lt; np; i++)</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>          <span class="keywordflow">if</span> (calc[i])</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>            <span class="keywordflow">for</span> (ib = M * i, m = 0; m &lt; M; m++, ib++)</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>              <span class="keywordflow">for</span> (deb = P.<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>()(ib) - 1, fin = P.<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>()(ib + 1) - 1, j = Mp.<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>()(ib) - 1; j &lt; Mp.<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>()(ib + 1) - 1; j++)</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>                <span class="keywordflow">for</span> (k = Mp.<a class="code hl_function" href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">get_tab2</a>()(j) - 1, secmem(i, m) -= Mp.<a class="code hl_function" href="classMatrice__Morse.html#a4a61f874a8a3ed671bbe60168a5855ac">get_coeff</a>()(j) * bp.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>()[k], l = Ap.get_tab1()(k) - 1, pos = deb - 1; l &lt; Ap.get_tab1()(k + 1) - 1; l++)</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>                  {</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>                    <span class="keywordflow">for</span> (col = Ap.get_tab2()(l), pos++; P.<a class="code hl_function" href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">get_tab2</a>()(pos) != col &amp;&amp; pos &lt; fin; ) pos++;</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>                    assert(P.<a class="code hl_function" href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">get_tab2</a>()(pos) == col);</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>                    P.<a class="code hl_function" href="classMatrice__Morse.html#a7654bbef11775a783790d3e9ad0b1501">get_set_coeff</a>()(pos) += Mp.<a class="code hl_function" href="classMatrice__Morse.html#a4a61f874a8a3ed671bbe60168a5855ac">get_coeff</a>()(j) * Ap.get_coeff()(l);</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>                  }</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span> </div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>      }</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>  <span class="keywordtype">double</span> diag = P.<a class="code hl_function" href="classMatrice__Morse.html#a4a61f874a8a3ed671bbe60168a5855ac">get_coeff</a>()(0);</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSETS.html#a3ac3e326835cd7b7e65512befd351443">p_degen</a> &amp;&amp; !<a class="code hl_function" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4">Process::me</a>())</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>    <span class="keywordflow">for</span> (i = 0; i &lt; P.<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>()(1) - 1; i++) P.<a class="code hl_function" href="classMatrice__Morse.html#a7654bbef11775a783790d3e9ad0b1501">get_set_coeff</a>()(i) += diag; <span class="comment">//de-degeneration de la matrice</span></div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>}</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span> </div>
<div class="ttc" id="aArray__tools_8cpp_html_a07eed4c823b0632bdbf353fdab2a3c6b"><div class="ttname"><a href="Array__tools_8cpp.html#a07eed4c823b0632bdbf353fdab2a3c6b">tableau_trier_retirer_doublons</a></div><div class="ttdeci">void tableau_trier_retirer_doublons(IntTab &amp;tab)</div><div class="ttdoc">Trie le tableau tab dans l'ordre lexicographique et retire les doublons (attention [1,...</div><div class="ttdef"><b>Definition:</b> <a href="Array__tools_8cpp_source.html#l00380">Array_tools.cpp:380</a></div></div>
<div class="ttc" id="aArray__tools_8h_html"><div class="ttname"><a href="Array__tools_8h.html">Array_tools.h</a></div></div>
<div class="ttc" id="aAssembleur__base_8h_html"><div class="ttname"><a href="Assembleur__base_8h.html">Assembleur_base.h</a></div></div>
<div class="ttc" id="aCast_8h_html_a9632e68536db6c29c2b754cb55381fbe"><div class="ttname"><a href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a></div><div class="ttdeci">#define sub_type(T, r)</div><div class="ttdef"><b>Definition:</b> <a href="Cast_8h_source.html#l00047">Cast.h:47</a></div></div>
<div class="ttc" id="aCast_8h_html_ad116a7acb85c9c91e5687c44941a0d0c"><div class="ttname"><a href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a></div><div class="ttdeci">#define ref_cast(T, r)</div><div class="ttdef"><b>Definition:</b> <a href="Cast_8h_source.html#l00052">Cast.h:52</a></div></div>
<div class="ttc" id="aChamp__P1iP1B__implementation_8cpp_html_a66b05ebb3893c77d400802a0828ab94d"><div class="ttname"><a href="Champ__P1iP1B__implementation_8cpp.html#a66b05ebb3893c77d400802a0828ab94d">assembler</a></div><div class="ttdeci">void assembler(const Zone_VEF_PreP1b &amp;zone_VEF, Matrice &amp;matrice)</div><div class="ttdef"><b>Definition:</b> <a href="Champ__P1iP1B__implementation_8cpp_source.html#l00261">Champ_P1iP1B_implementation.cpp:261</a></div></div>
<div class="ttc" id="aChamp__P1iP1B__implementation_8cpp_html_aa8c8f49390c3cf7c702d71a71bc977e3"><div class="ttname"><a href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a></div><div class="ttdeci">static double coeff</div><div class="ttdef"><b>Definition:</b> <a href="Champ__P1iP1B__implementation_8cpp_source.html#l00309">Champ_P1iP1B_implementation.cpp:309</a></div></div>
<div class="ttc" id="aDebog_8h_html"><div class="ttname"><a href="Debog_8h.html">Debog.h</a></div></div>
<div class="ttc" id="aDeclare__Inst_8h_html_afcab3f7633508e92f2077d767e19bc60"><div class="ttname"><a href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a></div><div class="ttdeci">#define Implemente_instanciable_sans_constructeur(_TYPE_, _NOM_, _BASE_)</div><div class="ttdef"><b>Definition:</b> <a href="Declare__Inst_8h_source.html#l00101">Declare_Inst.h:101</a></div></div>
<div class="ttc" id="aDirichlet_8h_html"><div class="ttname"><a href="Dirichlet_8h.html">Dirichlet.h</a></div></div>
<div class="ttc" id="aDiscretisation__base_8h_html"><div class="ttname"><a href="Discretisation__base_8h.html">Discretisation_base.h</a></div></div>
<div class="ttc" id="aDouble_8h_html_ac842198e9490fae75825cab2a03eed2d"><div class="ttname"><a href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a></div><div class="ttdeci">double norme(int n, const double *const a)</div><div class="ttdef"><b>Definition:</b> <a href="Double_8h_source.html#l00084">Double.h:84</a></div></div>
<div class="ttc" id="aEChaine_8h_html"><div class="ttname"><a href="EChaine_8h.html">EChaine.h</a></div></div>
<div class="ttc" id="aEntreeSortie_8h_html_a5b79a31f0834a117406ebff0c6f907bd"><div class="ttname"><a href="EntreeSortie_8h.html#a5b79a31f0834a117406ebff0c6f907bd">get_Cerr</a></div><div class="ttdeci">Sortie &amp; get_Cerr()</div><div class="ttdoc">Renvoie l'objet Sortie sur lequel seront redirigees les objets ecrits dans Cerr. Cela peut etre std_e...</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00452">Process.cpp:452</a></div></div>
<div class="ttc" id="aEntreeSortie_8h_html_a5ebb6b5243d6167369bddecb78d0b5b8"><div class="ttname"><a href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a></div><div class="ttdeci">#define Cerr</div><div class="ttdef"><b>Definition:</b> <a href="EntreeSortie_8h_source.html#l00025">EntreeSortie.h:25</a></div></div>
<div class="ttc" id="aEntreeSortie_8h_html_a7f716d3c5b6411631d5d0700ead09467"><div class="ttname"><a href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a></div><div class="ttdeci">const Separateur finl</div></div>
<div class="ttc" id="aInterface__blocs_8h_html_a2d7480bf11fc9f791b1d2839fa30a5c3"><div class="ttname"><a href="Interface__blocs_8h.html#a2d7480bf11fc9f791b1d2839fa30a5c3">tabs_t</a></div><div class="ttdeci">std::map&lt; std::string, DoubleTab &gt; tabs_t</div><div class="ttdef"><b>Definition:</b> <a href="Interface__blocs_8h_source.html#l00031">Interface_blocs.h:31</a></div></div>
<div class="ttc" id="aInterface__blocs_8h_html_a68e4f5c4505f6b31305de844302660bb"><div class="ttname"><a href="Interface__blocs_8h.html#a68e4f5c4505f6b31305de844302660bb">matrices_t</a></div><div class="ttdeci">std::map&lt; std::string, Matrice_Morse * &gt; matrices_t</div><div class="ttdef"><b>Definition:</b> <a href="Interface__blocs_8h_source.html#l00029">Interface_blocs.h:24</a></div></div>
<div class="ttc" id="aLapack_8h_html"><div class="ttname"><a href="Lapack_8h.html">Lapack.h</a></div></div>
<div class="ttc" id="aMD__Vector__std_8h_html"><div class="ttname"><a href="MD__Vector__std_8h.html">MD_Vector_std.h</a></div></div>
<div class="ttc" id="aMD__Vector__tools_8h_html"><div class="ttname"><a href="MD__Vector__tools_8h.html">MD_Vector_tools.h</a></div></div>
<div class="ttc" id="aMasse__Multiphase_8h_html"><div class="ttname"><a href="Masse__Multiphase_8h.html">Masse_Multiphase.h</a></div></div>
<div class="ttc" id="aMatrice__Bloc_8h_html"><div class="ttname"><a href="Matrice__Bloc_8h.html">Matrice_Bloc.h</a></div></div>
<div class="ttc" id="aMatrix__tools_8h_html"><div class="ttname"><a href="Matrix__tools_8h.html">Matrix_tools.h</a></div></div>
<div class="ttc" id="aNeumann__val__ext_8h_html"><div class="ttname"><a href="Neumann__val__ext_8h.html">Neumann_val_ext.h</a></div></div>
<div class="ttc" id="aOperateur__Diff__base_8h_html"><div class="ttname"><a href="Operateur__Diff__base_8h.html">Operateur_Diff_base.h</a></div></div>
<div class="ttc" id="aPb__Conduction_8h_html"><div class="ttname"><a href="Pb__Conduction_8h.html">Pb_Conduction.h</a></div></div>
<div class="ttc" id="aPb__Multiphase_8h_html"><div class="ttname"><a href="Pb__Multiphase_8h.html">Pb_Multiphase.h</a></div></div>
<div class="ttc" id="aQDM__Multiphase_8h_html"><div class="ttname"><a href="QDM__Multiphase_8h.html">QDM_Multiphase.h</a></div></div>
<div class="ttc" id="aSETS_8cpp_html_a0ca1eedfe96bd2b8dff05676ebd8ba81"><div class="ttname"><a href="SETS_8cpp.html#a0ca1eedfe96bd2b8dff05676ebd8ba81">corriger_incr_alpha</a></div><div class="ttdeci">static double corriger_incr_alpha(const DoubleTab &amp;alpha, DoubleTab &amp;incr, double &amp;err_a_sum)</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00109">SETS.cpp:109</a></div></div>
<div class="ttc" id="aSETS_8h_html"><div class="ttname"><a href="SETS_8h.html">SETS.h</a></div></div>
<div class="ttc" id="aSchema__Temps__base_8h_html"><div class="ttname"><a href="Schema__Temps__base_8h.html">Schema_Temps_base.h</a></div></div>
<div class="ttc" id="aStatistiques_8h_html"><div class="ttname"><a href="Statistiques_8h.html">Statistiques.h</a></div></div>
<div class="ttc" id="aTRUSTTab__parts_8h_html"><div class="ttname"><a href="TRUSTTab__parts_8h.html">TRUSTTab_parts.h</a></div></div>
<div class="ttc" id="aTRUSTTrav_8h_html"><div class="ttname"><a href="TRUSTTrav_8h.html">TRUSTTrav.h</a></div></div>
<div class="ttc" id="aTRUSTVect__tools_8tpp_html_a0116112e8e7962f9f0d797b0bf141c00"><div class="ttname"><a href="TRUSTVect__tools_8tpp.html#a0116112e8e7962f9f0d797b0bf141c00">mp_max_abs_vect</a></div><div class="ttdeci">_TYPE_ mp_max_abs_vect(const TRUSTVect&lt; _TYPE_ &gt; &amp;x, Mp_vect_options opt=VECT_REAL_ITEMS)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect__tools_8tpp_source.html#l00274">TRUSTVect_tools.tpp:274</a></div></div>
<div class="ttc" id="aTRUSTVect__tools_8tpp_html_a0bb4e8f4c68ebb7a65df50f6aad6fbb1"><div class="ttname"><a href="TRUSTVect__tools_8tpp.html#a0bb4e8f4c68ebb7a65df50f6aad6fbb1">mp_min_vect</a></div><div class="ttdeci">_TYPE_ mp_min_vect(const TRUSTVect&lt; _TYPE_ &gt; &amp;x, Mp_vect_options opt=VECT_REAL_ITEMS)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect__tools_8tpp_source.html#l00228">TRUSTVect_tools.tpp:228</a></div></div>
<div class="ttc" id="aTRUSTVect__tools_8tpp_html_a76d21367b48f44f3164f6f7f91e58a92"><div class="ttname"><a href="TRUSTVect__tools_8tpp.html#a76d21367b48f44f3164f6f7f91e58a92">mp_max_vect</a></div><div class="ttdeci">_TYPE_ mp_max_vect(const TRUSTVect&lt; _TYPE_ &gt; &amp;x, Mp_vect_options opt=VECT_REAL_ITEMS)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect__tools_8tpp_source.html#l00214">TRUSTVect_tools.tpp:214</a></div></div>
<div class="ttc" id="aTablePrinter_8h_html"><div class="ttname"><a href="TablePrinter_8h.html">TablePrinter.h</a></div></div>
<div class="ttc" id="aZone__VF_8h_html"><div class="ttname"><a href="Zone__VF_8h.html">Zone_VF.h</a></div></div>
<div class="ttc" id="aarch_8h_html_a1caaf369d9c5f0817dbaa76b43b8d87b"><div class="ttname"><a href="arch_8h.html#a1caaf369d9c5f0817dbaa76b43b8d87b">True_int</a></div><div class="ttdeci">int True_int</div><div class="ttdef"><b>Definition:</b> <a href="arch_8h_source.html#l00080">arch.h:80</a></div></div>
<div class="ttc" id="aarch_8h_html_a9b91c72ded7de2f0b393ea75de53929b"><div class="ttname"><a href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a></div><div class="ttdeci">#define F77NAME(x)</div><div class="ttdef"><b>Definition:</b> <a href="arch_8h_source.html#l00068">arch.h:68</a></div></div>
<div class="ttc" id="aclassArrOfBit_html"><div class="ttname"><a href="classArrOfBit.html">ArrOfBit</a></div><div class="ttdef"><b>Definition:</b> <a href="ArrOfBit_8h_source.html#l00022">ArrOfBit.h:23</a></div></div>
<div class="ttc" id="aclassChamp__Inc_html_a9eb0877acb8b81d59985898dbbb5417f"><div class="ttname"><a href="classChamp__Inc.html#a9eb0877acb8b81d59985898dbbb5417f">Champ_Inc::passe</a></div><div class="ttdeci">DoubleTab &amp; passe(int i=1) override</div><div class="ttdoc">Appel a l'objet sous-jacent Renvoie le tableau des valeurs au temps t-i.</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Inc_8cpp_source.html#l00320">Champ_Inc.cpp:320</a></div></div>
<div class="ttc" id="aclassConstTRUSTTab__parts_html"><div class="ttname"><a href="classConstTRUSTTab__parts.html">ConstTRUSTTab_parts</a></div><div class="ttdoc">This class allows to acces to individual sub-parts of const DoubleTab objects that have a MD_Vector_c...</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTab__parts_8h_source.html#l00054">TRUSTTab_parts.h:55</a></div></div>
<div class="ttc" id="aclassConstTRUSTTab__parts_html_ae10f3ef0c7e534ca9eba15590b4b7385"><div class="ttname"><a href="classConstTRUSTTab__parts.html#ae10f3ef0c7e534ca9eba15590b4b7385">ConstTRUSTTab_parts::size</a></div><div class="ttdeci">int size() const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTab__parts_8h_source.html#l00062">TRUSTTab_parts.h:62</a></div></div>
<div class="ttc" id="aclassConvection__Diffusion__std_html"><div class="ttname"><a href="classConvection__Diffusion__std.html">Convection_Diffusion_std</a></div><div class="ttdoc">classe Convection_Diffusion_std Cette classe est la base des equations modelisant le transport d'un s...</div><div class="ttdef"><b>Definition:</b> <a href="Convection__Diffusion__std_8h_source.html#l00049">Convection_Diffusion_std.h:50</a></div></div>
<div class="ttc" id="aclassDeriv__Champ__Inc__base_html_adaa8a3a0efb270f0bbd11311787b5c8d"><div class="ttname"><a href="classDeriv__Champ__Inc__base.html#adaa8a3a0efb270f0bbd11311787b5c8d">Deriv_Champ_Inc_base::valeur</a></div><div class="ttdeci">const Champ_Inc_base &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Inc_8h_source.html#l00035">Champ_Inc.h:35</a></div></div>
<div class="ttc" id="aclassDeriv__Cond__lim__base_html_afd7af50ad75a2cde929df2cedb684d58"><div class="ttname"><a href="classDeriv__Cond__lim__base.html#afd7af50ad75a2cde929df2cedb684d58">Deriv_Cond_lim_base::valeur</a></div><div class="ttdeci">const Cond_lim_base &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Cond__lim_8h_source.html#l00024">Cond_lim.h:24</a></div></div>
<div class="ttc" id="aclassDeriv__Matrice__Base_html_a6d78a97ea87044a4b8c0cc2c6609f3e0"><div class="ttname"><a href="classDeriv__Matrice__Base.html#a6d78a97ea87044a4b8c0cc2c6609f3e0">Deriv_Matrice_Base::valeur</a></div><div class="ttdeci">const Matrice_Base &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Deriv__Matrice__Base_8h_source.html#l00021">Deriv_Matrice_Base.h:21</a></div></div>
<div class="ttc" id="aclassDeriv__SolveurSys__base_html_af20f1e9317a0d617a4862f19e7b17be4"><div class="ttname"><a href="classDeriv__SolveurSys__base.html#af20f1e9317a0d617a4862f19e7b17be4">Deriv_SolveurSys_base::valeur</a></div><div class="ttdeci">const SolveurSys_base &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="SolveurSys_8h_source.html#l00030">SolveurSys.h:30</a></div></div>
<div class="ttc" id="aclassDeriv__Zone__dis__base_html_a0d72b842885db3be30e1bf41a4136934"><div class="ttname"><a href="classDeriv__Zone__dis__base.html#a0d72b842885db3be30e1bf41a4136934">Deriv_Zone_dis_base::valeur</a></div><div class="ttdeci">const Zone_dis_base &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__dis_8h_source.html#l00022">Zone_dis.h:22</a></div></div>
<div class="ttc" id="aclassDeriv___html_ad1d33400ed15b6ff96579ed82d9e2719"><div class="ttname"><a href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719">Deriv_::typer</a></div><div class="ttdeci">Objet_U * typer(const char *nom_type)</div><div class="ttdoc">Essaie de creer une instance du type &quot;type&quot;. si type n'est pas un type ou type n'est pas instanciable...</div><div class="ttdef"><b>Definition:</b> <a href="Deriv___8cpp_source.html#l00084">Deriv_.cpp:84</a></div></div>
<div class="ttc" id="aclassEnergie__Multiphase_html"><div class="ttname"><a href="classEnergie__Multiphase.html">Energie_Multiphase</a></div><div class="ttdoc">classe Energie_Multiphase Cas particulier de Convection_Diffusion_std pour un fluide quasi conpressib...</div><div class="ttdef"><b>Definition:</b> <a href="Energie__Multiphase_8h_source.html#l00035">Energie_Multiphase.h:36</a></div></div>
<div class="ttc" id="aclassEntree_html"><div class="ttname"><a href="classEntree.html">Entree</a></div><div class="ttdoc">Classe de definition des operateurs et methodes pour toute lecture dans un flot d'entree&lt;br&gt;(fichier,...</div><div class="ttdef"><b>Definition:</b> <a href="Entree_8h_source.html#l00041">Entree.h:42</a></div></div>
<div class="ttc" id="aclassEquation__base_html"><div class="ttname"><a href="classEquation__base.html">Equation_base</a></div><div class="ttdef"><b>Definition:</b> <a href="Equation__base_8h_source.html#l00086">Equation_base.h:87</a></div></div>
<div class="ttc" id="aclassEquation__base_html_a12d97ae801edc18f614523677921346e"><div class="ttname"><a href="classEquation__base.html#a12d97ae801edc18f614523677921346e">Equation_base::zone_dis</a></div><div class="ttdeci">Zone_dis &amp; zone_dis()</div><div class="ttdoc">Renvoie la zone discretisee associee a l'equation.</div><div class="ttdef"><b>Definition:</b> <a href="Equation__base_8cpp_source.html#l00100">Equation_base.cpp:100</a></div></div>
<div class="ttc" id="aclassEquation__base_html_a3cfe6b771e0ff255b3c93576b27019b0"><div class="ttname"><a href="classEquation__base.html#a3cfe6b771e0ff255b3c93576b27019b0">Equation_base::inconnue</a></div><div class="ttdeci">virtual const Champ_Inc &amp; inconnue() const =0</div></div>
<div class="ttc" id="aclassEquation__base_html_a5f51df433a67d9aa3da8055e4d8c3b5c"><div class="ttname"><a href="classEquation__base.html#a5f51df433a67d9aa3da8055e4d8c3b5c">Equation_base::dimensionner_blocs</a></div><div class="ttdeci">virtual void dimensionner_blocs(matrices_t matrices, const tabs_t &amp;semi_impl={}) const</div><div class="ttdef"><b>Definition:</b> <a href="Equation__base_8cpp_source.html#l02430">Equation_base.cpp:2430</a></div></div>
<div class="ttc" id="aclassEquation__base_html_aa8151a96f63719523bf50ddd832e0f8f"><div class="ttname"><a href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f">Equation_base::probleme</a></div><div class="ttdeci">Probleme_base &amp; probleme()</div><div class="ttdoc">Renvoie le probleme associe a l'equation.</div><div class="ttdef"><b>Definition:</b> <a href="Equation__base_8cpp_source.html#l00986">Equation_base.cpp:986</a></div></div>
<div class="ttc" id="aclassEquation__base_html_abc11e51aa75b4c7aa55c27f71eb2f2c4"><div class="ttname"><a href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4">Equation_base::schema_temps</a></div><div class="ttdeci">Schema_Temps_base &amp; schema_temps()</div><div class="ttdoc">Renvoie le schema en temps associe a l'equation.</div><div class="ttdef"><b>Definition:</b> <a href="Equation__base_8cpp_source.html#l01142">Equation_base.cpp:1142</a></div></div>
<div class="ttc" id="aclassEquation__base_html_ade7daf3cf58c49dd666f63b8911d4fe4"><div class="ttname"><a href="classEquation__base.html#ade7daf3cf58c49dd666f63b8911d4fe4">Equation_base::operateur</a></div><div class="ttdeci">virtual const Operateur &amp; operateur(int) const =0</div></div>
<div class="ttc" id="aclassEquation__base_html_adfedf474c07a92f6b2261ca2f1cee80e"><div class="ttname"><a href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e">Equation_base::solv_masse</a></div><div class="ttdeci">Solveur_Masse &amp; solv_masse()</div><div class="ttdoc">Renvoie le solveur de masse associe a l'equation.</div><div class="ttdef"><b>Definition:</b> <a href="Equation__base_8h_source.html#l00449">Equation_base.h:449</a></div></div>
<div class="ttc" id="aclassEquation__base_html_af265fe0ea30868eb2176a0c887e4efab"><div class="ttname"><a href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab">Equation_base::zone_Cl_dis</a></div><div class="ttdeci">virtual Zone_Cl_dis &amp; zone_Cl_dis()</div><div class="ttdoc">Renvoie la zone des conditions aux limite discretisee associee a l'equation.</div><div class="ttdef"><b>Definition:</b> <a href="Equation__base_8h_source.html#l00408">Equation_base.h:408</a></div></div>
<div class="ttc" id="aclassFluide__base_html"><div class="ttname"><a href="classFluide__base.html">Fluide_base</a></div><div class="ttdoc">classe Fluide_base Cette classe represente un d'un fluide incompressible ainsi que ses proprietes: - ...</div><div class="ttdef"><b>Definition:</b> <a href="Fluide__base_8h_source.html#l00039">Fluide_base.h:40</a></div></div>
<div class="ttc" id="aclassICE_html"><div class="ttname"><a href="classICE.html">ICE</a></div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00127">SETS.h:128</a></div></div>
<div class="ttc" id="aclassICE_html_a12220fedf13f3909a1638f526c978e0f"><div class="ttname"><a href="classICE.html#a12220fedf13f3909a1638f526c978e0f">ICE::ICE</a></div><div class="ttdeci">ICE()</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00057">SETS.cpp:57</a></div></div>
<div class="ttc" id="aclassICE_html_a4244d9c056eb00a763021dd3183193ad"><div class="ttname"><a href="classICE.html#a4244d9c056eb00a763021dd3183193ad">ICE::readOn</a></div><div class="ttdeci">Entree &amp; readOn(Entree &amp;) override</div><div class="ttdoc">Lecture d'un Objet_U sur un flot d'entree Methode a surcharger.</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00103">SETS.cpp:103</a></div></div>
<div class="ttc" id="aclassICE_html_a42f3140bc2e1fce3aa2aa0e46834e3e4"><div class="ttname"><a href="classICE.html#a42f3140bc2e1fce3aa2aa0e46834e3e4">ICE::printOn</a></div><div class="ttdeci">Sortie &amp; printOn(Sortie &amp;x) const override</div><div class="ttdoc">Ecriture de l'objet sur un flot de sortie Methode a surcharger.</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00098">SETS.cpp:98</a></div></div>
<div class="ttc" id="aclassMD__Vector__tools_html_ad099d2407b0016920bd8c667a56fddd8"><div class="ttname"><a href="classMD__Vector__tools.html#ad099d2407b0016920bd8c667a56fddd8">MD_Vector_tools::get_sequential_items_flags</a></div><div class="ttdeci">static int get_sequential_items_flags(const MD_Vector &amp;, ArrOfBit &amp;flags, int line_size=1)</div><div class="ttdef"><b>Definition:</b> <a href="MD__Vector__tools_8cpp_source.html#l00236">MD_Vector_tools.cpp:236</a></div></div>
<div class="ttc" id="aclassMD__Vector_html_a036f2429ea40bd07b331500f6ff22b8f"><div class="ttname"><a href="classMD__Vector.html#a036f2429ea40bd07b331500f6ff22b8f">MD_Vector::non_nul</a></div><div class="ttdeci">int non_nul() const</div><div class="ttdef"><b>Definition:</b> <a href="MD__Vector_8h_source.html#l00056">MD_Vector.h:56</a></div></div>
<div class="ttc" id="aclassMasse__Multiphase_html"><div class="ttname"><a href="classMasse__Multiphase.html">Masse_Multiphase</a></div><div class="ttdoc">classe Masse_Multiphase Cas particulier de Convection_Diffusion_std pour un fluide quasi conpressible...</div><div class="ttdef"><b>Definition:</b> <a href="Masse__Multiphase_8h_source.html#l00033">Masse_Multiphase.h:34</a></div></div>
<div class="ttc" id="aclassMatrice__Bloc_html_a1db7c549cc1be958d5f00c29cd0f3a8c"><div class="ttname"><a href="classMatrice__Bloc.html#a1db7c549cc1be958d5f00c29cd0f3a8c">Matrice_Bloc::dimensionner</a></div><div class="ttdeci">virtual void dimensionner(int N, int M)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Bloc_8cpp_source.html#l00551">Matrice_Bloc.cpp:551</a></div></div>
<div class="ttc" id="aclassMatrice__Bloc_html_a76a5691fecfea8b4dd877d2c449a7f21"><div class="ttname"><a href="classMatrice__Bloc.html#a76a5691fecfea8b4dd877d2c449a7f21">Matrice_Bloc::get_bloc</a></div><div class="ttdeci">virtual const Matrice &amp; get_bloc(int i, int j) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Bloc_8cpp_source.html#l00559">Matrice_Bloc.cpp:559</a></div></div>
<div class="ttc" id="aclassMatrice__Bloc_html_a9aba415d048c323f8cf498d4492f8127"><div class="ttname"><a href="classMatrice__Bloc.html#a9aba415d048c323f8cf498d4492f8127">Matrice_Bloc::nb_lignes</a></div><div class="ttdeci">int nb_lignes(void) const override</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Bloc_8cpp_source.html#l00085">Matrice_Bloc.cpp:85</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html"><div class="ttname"><a href="classMatrice__Morse.html">Matrice_Morse</a></div><div class="ttdoc">Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00050">Matrice_Morse.h:51</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a3eb6b49cf3ce0b36fc8964d3f02d6d50"><div class="ttname"><a href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">Matrice_Morse::get_tab1</a></div><div class="ttdeci">const IntVect &amp; get_tab1(void) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00110">Matrice_Morse.h:110</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a4a61f874a8a3ed671bbe60168a5855ac"><div class="ttname"><a href="classMatrice__Morse.html#a4a61f874a8a3ed671bbe60168a5855ac">Matrice_Morse::get_coeff</a></div><div class="ttdeci">const DoubleVect &amp; get_coeff(void) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00112">Matrice_Morse.h:112</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a7654bbef11775a783790d3e9ad0b1501"><div class="ttname"><a href="classMatrice__Morse.html#a7654bbef11775a783790d3e9ad0b1501">Matrice_Morse::get_set_coeff</a></div><div class="ttdeci">DoubleVect &amp; get_set_coeff(void)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00108">Matrice_Morse.h:108</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a807cf85a1b509639edb84d7276b3edb3"><div class="ttname"><a href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">Matrice_Morse::get_tab2</a></div><div class="ttdeci">const IntVect &amp; get_tab2(void) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00111">Matrice_Morse.h:111</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ad69929b5100f2785d737dd77e2c82196"><div class="ttname"><a href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">Matrice_Morse::nb_colonnes</a></div><div class="ttdeci">int nb_colonnes() const override</div><div class="ttdoc">nb_colonnes retourne m</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00091">Matrice_Morse.h:91</a></div></div>
<div class="ttc" id="aclassMatrix__tools_html_a00e41ca3d70e9d0e937c883b17ad04b3"><div class="ttname"><a href="classMatrix__tools.html#a00e41ca3d70e9d0e937c883b17ad04b3">Matrix_tools::allocate_morse_matrix</a></div><div class="ttdeci">static void allocate_morse_matrix(const int nb_lines, const int nb_columns, const IntTab &amp;stencil, Matrice_Morse &amp;matrix, const bool &amp;attach_stencil_to_matrix=false)</div><div class="ttdef"><b>Definition:</b> <a href="Matrix__tools_8cpp_source.html#l00104">Matrix_tools.cpp:104</a></div></div>
<div class="ttc" id="aclassMorEqn_html_a233c714209593acce7aec1f55640bca2"><div class="ttname"><a href="classMorEqn.html#a233c714209593acce7aec1f55640bca2">MorEqn::equation</a></div><div class="ttdeci">const Equation_base &amp; equation() const</div><div class="ttdoc">Renvoie la reference sur l'equation pointe par MorEqn::mon_equation. (version const)</div><div class="ttdef"><b>Definition:</b> <a href="MorEqn_8h_source.html#l00075">MorEqn.h:75</a></div></div>
<div class="ttc" id="aclassMotcle_html"><div class="ttname"><a href="classMotcle.html">Motcle</a></div><div class="ttdoc">Une chaine de caractere (Nom) en majuscules.</div><div class="ttdef"><b>Definition:</b> <a href="Motcle_8h_source.html#l00027">Motcle.h:28</a></div></div>
<div class="ttc" id="aclassNavier__Stokes__std_html_a17aa9441decd5cd3c6a04f7d05ccf9cf"><div class="ttname"><a href="classNavier__Stokes__std.html#a17aa9441decd5cd3c6a04f7d05ccf9cf">Navier_Stokes_std::inconnue</a></div><div class="ttdeci">const Champ_Inc &amp; inconnue() const override</div><div class="ttdoc">Renvoie la vitesse (champ inconnue de l'equation) (version const)</div><div class="ttdef"><b>Definition:</b> <a href="Navier__Stokes__std_8cpp_source.html#l00749">Navier_Stokes_std.cpp:749</a></div></div>
<div class="ttc" id="aclassNavier__Stokes__std_html_a1b86014b53c283d1871d6e50a9489c7c"><div class="ttname"><a href="classNavier__Stokes__std.html#a1b86014b53c283d1871d6e50a9489c7c">Navier_Stokes_std::milieu</a></div><div class="ttdeci">const Milieu_base &amp; milieu() const override</div><div class="ttdoc">Renvoie le milieu physique de l'equation&lt;br&gt;(le Fluide_base upcaste en Milieu_base)</div><div class="ttdef"><b>Definition:</b> <a href="Navier__Stokes__std_8cpp_source.html#l01678">Navier_Stokes_std.cpp:1678</a></div></div>
<div class="ttc" id="aclassNavier__Stokes__std_html_af9f5e0396945755597f147bd424a4a08"><div class="ttname"><a href="classNavier__Stokes__std.html#af9f5e0396945755597f147bd424a4a08">Navier_Stokes_std::assembleur_pression</a></div><div class="ttdeci">Assembleur &amp; assembleur_pression()</div><div class="ttdef"><b>Definition:</b> <a href="Navier__Stokes__std_8h_source.html#l00338">Navier_Stokes_std.h:338</a></div></div>
<div class="ttc" id="aclassNavier__Stokes__std_html_afbb8f39bdfd70328dfad21bf2b9dd45a"><div class="ttname"><a href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a">Navier_Stokes_std::pression</a></div><div class="ttdeci">Champ_Inc &amp; pression()</div><div class="ttdoc">Renvoie le champ de pression.</div><div class="ttdef"><b>Definition:</b> <a href="Navier__Stokes__std_8h_source.html#l00262">Navier_Stokes_std.h:262</a></div></div>
<div class="ttc" id="aclassNeumann__val__ext_html"><div class="ttname"><a href="classNeumann__val__ext.html">Neumann_val_ext</a></div><div class="ttdoc">Classe Neumann_val_ext Cette classe est la classe de base de la hierarchie des conditions aux limites...</div><div class="ttdef"><b>Definition:</b> <a href="Neumann__val__ext_8h_source.html#l00035">Neumann_val_ext.h:36</a></div></div>
<div class="ttc" id="aclassNom_html"><div class="ttname"><a href="classNom.html">Nom</a></div><div class="ttdoc">class Nom Une chaine de caractere pour nommer les objets de TRUST NOM_H</div><div class="ttdef"><b>Definition:</b> <a href="Nom_8h_source.html#l00034">Nom.h:35</a></div></div>
<div class="ttc" id="aclassNom_html_ad71b1114cce16c93232450de03848dfc"><div class="ttname"><a href="classNom.html#ad71b1114cce16c93232450de03848dfc">Nom::getString</a></div><div class="ttdeci">const std::string &amp; getString() const</div><div class="ttdef"><b>Definition:</b> <a href="Nom_8h_source.html#l00089">Nom.h:89</a></div></div>
<div class="ttc" id="aclassO__U__Ptr_html_a2e55c62a929a145d41b38061ff97bfa2"><div class="ttname"><a href="classO__U__Ptr.html#a2e55c62a929a145d41b38061ff97bfa2">O_U_Ptr::le_nom</a></div><div class="ttdeci">const Nom &amp; le_nom() const override</div><div class="ttdoc">Renvoie ref_().le_nom() si le pointeur est non nul ou &quot;Pointeur Nul&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="O__U__Ptr_8cpp_source.html#l00164">O_U_Ptr.cpp:164</a></div></div>
<div class="ttc" id="aclassObjet__U_html_a58289bb63283588d31dc69b87b3f1d55"><div class="ttname"><a href="classObjet__U.html#a58289bb63283588d31dc69b87b3f1d55">Objet_U::que_suis_je</a></div><div class="ttdeci">const Nom &amp; que_suis_je() const</div><div class="ttdoc">renvoie la chaine identifiant la classe.</div><div class="ttdef"><b>Definition:</b> <a href="Objet__U_8cpp_source.html#l00126">Objet_U.cpp:126</a></div></div>
<div class="ttc" id="aclassObjet__U_html_a93dacab7253df3f9df63d1aca21b1dd5"><div class="ttname"><a href="classObjet__U.html#a93dacab7253df3f9df63d1aca21b1dd5">Objet_U::le_nom</a></div><div class="ttdeci">virtual const Nom &amp; le_nom() const</div><div class="ttdoc">Donne le nom de l'Objet_U Methode a surcharger : renvoie &quot;neant&quot; dans cette implementation.</div><div class="ttdef"><b>Definition:</b> <a href="Objet__U_8cpp_source.html#l00254">Objet_U.cpp:254</a></div></div>
<div class="ttc" id="aclassOperateur__Diff__base_html"><div class="ttname"><a href="classOperateur__Diff__base.html">Operateur_Diff_base</a></div><div class="ttdoc">classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...</div><div class="ttdef"><b>Definition:</b> <a href="Operateur__Diff__base_8h_source.html#l00039">Operateur_Diff_base.h:41</a></div></div>
<div class="ttc" id="aclassOperateur__Diff__base_html_a55bd9b2fad5e6ef816f89ea07371ddfc"><div class="ttname"><a href="classOperateur__Diff__base.html#a55bd9b2fad5e6ef816f89ea07371ddfc">Operateur_Diff_base::op_ext</a></div><div class="ttdeci">std::vector&lt; const Operateur_Diff_base * &gt; op_ext</div><div class="ttdef"><b>Definition:</b> <a href="Operateur__Diff__base_8h_source.html#l00050">Operateur_Diff_base.h:47</a></div></div>
<div class="ttc" id="aclassOperateur_html_a318f30b233e223685bb693c314554284"><div class="ttname"><a href="classOperateur.html#a318f30b233e223685bb693c314554284">Operateur::l_op_base</a></div><div class="ttdeci">virtual Operateur_base &amp; l_op_base()=0</div></div>
<div class="ttc" id="aclassParametre__implicite_html_a17400e45bc9f12d9eb3e228cf8696e16"><div class="ttname"><a href="classParametre__implicite.html#a17400e45bc9f12d9eb3e228cf8696e16">Parametre_implicite::solveur</a></div><div class="ttdeci">SolveurSys &amp; solveur()</div><div class="ttdef"><b>Definition:</b> <a href="Parametre__implicite_8h_source.html#l00039">Parametre_implicite.h:39</a></div></div>
<div class="ttc" id="aclassPb__Conduction_html"><div class="ttname"><a href="classPb__Conduction.html">Pb_Conduction</a></div><div class="ttdoc">Classe Pb_Conduction Cette classe represente un probleme de conduction avec rho et Cp non uniformes :...</div><div class="ttdef"><b>Definition:</b> <a href="Pb__Conduction_8h_source.html#l00037">Pb_Conduction.h:38</a></div></div>
<div class="ttc" id="aclassPb__Multiphase_html"><div class="ttname"><a href="classPb__Multiphase.html">Pb_Multiphase</a></div><div class="ttdoc">classe Pb_Multiphase Cette classe represente un probleme de thermohydraulique multiphase de type &quot;3*N...</div><div class="ttdef"><b>Definition:</b> <a href="Pb__Multiphase_8h_source.html#l00047">Pb_Multiphase.h:48</a></div></div>
<div class="ttc" id="aclassPb__Multiphase_html_a9de224106faa6405121c8103611a8a33"><div class="ttname"><a href="classPb__Multiphase.html#a9de224106faa6405121c8103611a8a33">Pb_Multiphase::mettre_a_jour</a></div><div class="ttdeci">void mettre_a_jour(double temps) override</div><div class="ttdoc">Effectue une mise a jour en temps du probleme. Effectue la mise a jour sur toutes les equations du pr...</div><div class="ttdef"><b>Definition:</b> <a href="Pb__Multiphase_8cpp_source.html#l00291">Pb_Multiphase.cpp:291</a></div></div>
<div class="ttc" id="aclassPb__Multiphase_html_aac3c0ff2843ff7748d199e2a5dde7f02"><div class="ttname"><a href="classPb__Multiphase.html#aac3c0ff2843ff7748d199e2a5dde7f02">Pb_Multiphase::nombre_d_equations</a></div><div class="ttdeci">int nombre_d_equations() const override</div><div class="ttdoc">Renvoie le nombre d'equation, Renvoie 2 car il y a 2 equations a un probleme de thermo-hydraulique st...</div><div class="ttdef"><b>Definition:</b> <a href="Pb__Multiphase_8cpp_source.html#l00166">Pb_Multiphase.cpp:166</a></div></div>
<div class="ttc" id="aclassPb__Multiphase_html_aaf6fb8417722b043861e3e4be9b58c48"><div class="ttname"><a href="classPb__Multiphase.html#aaf6fb8417722b043861e3e4be9b58c48">Pb_Multiphase::equation</a></div><div class="ttdeci">const Equation_base &amp; equation(int) const override</div><div class="ttdoc">Renvoie l'equation d'hydraulique de type Navier_Stokes_std si i=0 Renvoie l'equation de la thermique ...</div><div class="ttdef"><b>Definition:</b> <a href="Pb__Multiphase_8cpp_source.html#l00188">Pb_Multiphase.cpp:188</a></div></div>
<div class="ttc" id="aclassProbleme__base_html_aa210f18cdc711810f1b9c4819178af36"><div class="ttname"><a href="classProbleme__base.html#aa210f18cdc711810f1b9c4819178af36">Probleme_base::le_nom</a></div><div class="ttdeci">const Nom &amp; le_nom() const override</div><div class="ttdoc">surcharge Objet_U::le_nom() Renvoie le nom du probleme</div><div class="ttdef"><b>Definition:</b> <a href="Probleme__base_8h_source.html#l00288">Probleme_base.h:288</a></div></div>
<div class="ttc" id="aclassProcess_html_a1e9d9f9899b71927cfafae14c7bd048d"><div class="ttname"><a href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d">Process::mp_max</a></div><div class="ttdeci">static double mp_max(double)</div><div class="ttdoc">Calcule le max de x sur tous les processeurs du groupe courant. Remarques : Cette methode doit etre a...</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00146">Process.cpp:146</a></div></div>
<div class="ttc" id="aclassProcess_html_ab55ba07167ec807ed3a145cac0f5dca4"><div class="ttname"><a href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4">Process::me</a></div><div class="ttdeci">static int me()</div><div class="ttdoc">renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00107">Process.cpp:107</a></div></div>
<div class="ttc" id="aclassProcess_html_acc2fbbe761e08e5870ae605c0705491c"><div class="ttname"><a href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">Process::exit</a></div><div class="ttdeci">static void exit(int exit_code=-1)</div><div class="ttdoc">Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00213">Process.cpp:213</a></div></div>
<div class="ttc" id="aclassProcess_html_aeaa5f9b4e42dc41414bebc7df14e16f6"><div class="ttname"><a href="classProcess.html#aeaa5f9b4e42dc41414bebc7df14e16f6">Process::mp_and</a></div><div class="ttdeci">static bool mp_and(bool)</div><div class="ttdoc">Calcule le 'et' logique de b sur tous les processeurs du groupe courant.</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00189">Process.cpp:189</a></div></div>
<div class="ttc" id="aclassQDM__Multiphase_html"><div class="ttname"><a href="classQDM__Multiphase.html">QDM_Multiphase</a></div><div class="ttdoc">classe QDM_Multiphase Cette classe porte les termes de l'equation de la dynamique pour un fluide sans...</div><div class="ttdef"><b>Definition:</b> <a href="QDM__Multiphase_8h_source.html#l00044">QDM_Multiphase.h:45</a></div></div>
<div class="ttc" id="aclassQDM__Multiphase_html_a1561cd55d09c20fada811f0075a4a368"><div class="ttname"><a href="classQDM__Multiphase.html#a1561cd55d09c20fada811f0075a4a368">QDM_Multiphase::dimensionner_blocs</a></div><div class="ttdeci">void dimensionner_blocs(matrices_t matrices, const tabs_t &amp;semi_impl={}) const override</div><div class="ttdef"><b>Definition:</b> <a href="QDM__Multiphase_8cpp_source.html#l00155">QDM_Multiphase.cpp:155</a></div></div>
<div class="ttc" id="aclassQDM__Multiphase_html_a7434d149a38184ddfeb27ba9d82ddd6b"><div class="ttname"><a href="classQDM__Multiphase.html#a7434d149a38184ddfeb27ba9d82ddd6b">QDM_Multiphase::assembler_blocs_avec_inertie</a></div><div class="ttdeci">void assembler_blocs_avec_inertie(matrices_t matrices, DoubleTab &amp;secmem, const tabs_t &amp;semi_impl={}) override</div><div class="ttdef"><b>Definition:</b> <a href="QDM__Multiphase_8cpp_source.html#l00161">QDM_Multiphase.cpp:161</a></div></div>
<div class="ttc" id="aclassSETS_html"><div class="ttname"><a href="classSETS.html">SETS</a></div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00032">SETS.h:33</a></div></div>
<div class="ttc" id="aclassSETS_html_a037404a748a911b2e260905354a6c7f2"><div class="ttname"><a href="classSETS.html#a037404a748a911b2e260905354a6c7f2">SETS::sets_</a></div><div class="ttdeci">int sets_</div><div class="ttdoc">1 si on fait l'etape de prediction des vitesses</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00084">SETS.h:84</a></div></div>
<div class="ttc" id="aclassSETS_html_a0700ecfee83528105f1d62437e07661b"><div class="ttname"><a href="classSETS.html#a0700ecfee83528105f1d62437e07661b">SETS::lire</a></div><div class="ttdeci">Entree &amp; lire(const Motcle &amp;, Entree &amp;) override</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00076">SETS.cpp:76</a></div></div>
<div class="ttc" id="aclassSETS_html_a18b50ad40531ec8d3b01fdf02bec2cb4"><div class="ttname"><a href="classSETS.html#a18b50ad40531ec8d3b01fdf02bec2cb4">SETS::SETS</a></div><div class="ttdeci">SETS()</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00052">SETS.cpp:52</a></div></div>
<div class="ttc" id="aclassSETS_html_a2dc023a4074725a2d139135afb6859cf"><div class="ttname"><a href="classSETS.html#a2dc023a4074725a2d139135afb6859cf">SETS::crit_conv</a></div><div class="ttdeci">std::map&lt; std::string, double &gt; crit_conv</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00109">SETS.h:109</a></div></div>
<div class="ttc" id="aclassSETS_html_a3ac3e326835cd7b7e65512befd351443"><div class="ttname"><a href="classSETS.html#a3ac3e326835cd7b7e65512befd351443">SETS::p_degen</a></div><div class="ttdeci">int p_degen</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00083">SETS.h:83</a></div></div>
<div class="ttc" id="aclassSETS_html_a416660a4c6b560c16a63ef41bc99383f"><div class="ttname"><a href="classSETS.html#a416660a4c6b560c16a63ef41bc99383f">SETS::iter_min_</a></div><div class="ttdeci">int iter_min_</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00105">SETS.h:105</a></div></div>
<div class="ttc" id="aclassSETS_html_a53cd8850df0e00210aa6c4cea0e978cd"><div class="ttname"><a href="classSETS.html#a53cd8850df0e00210aa6c4cea0e978cd">SETS::A_p</a></div><div class="ttdeci">std::map&lt; std::string, Matrice_Morse &gt; A_p</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00117">SETS.h:117</a></div></div>
<div class="ttc" id="aclassSETS_html_a6392580d0676326210dc7536c278c810"><div class="ttname"><a href="classSETS.html#a6392580d0676326210dc7536c278c810">SETS::iterer_NS</a></div><div class="ttdeci">void iterer_NS(Equation_base &amp;, DoubleTab &amp;current, DoubleTab &amp;pression, double, Matrice_Morse &amp;, double, DoubleTrav &amp;, int nb_iter, int &amp;converge, int &amp;ok) override</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00252">SETS.cpp:252</a></div></div>
<div class="ttc" id="aclassSETS_html_a65a91eb7e8b072a65446a80b7fc65781"><div class="ttname"><a href="classSETS.html#a65a91eb7e8b072a65446a80b7fc65781">SETS::eliminer</a></div><div class="ttdeci">static void eliminer(const std::vector&lt; std::set&lt; std::pair&lt; std::string, int &gt; &gt; &gt; ordre, const std::string inco_p, const std::map&lt; std::string, matrices_t &gt; &amp;mats, const tabs_t &amp;sec, std::map&lt; std::string, Matrice_Morse &gt; &amp;A_p, tabs_t &amp;b_p)</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00431">SETS.cpp:431</a></div></div>
<div class="ttc" id="aclassSETS_html_a73c4e579bc537898da0bc707ac19fb3a"><div class="ttname"><a href="classSETS.html#a73c4e579bc537898da0bc707ac19fb3a">SETS::iteration</a></div><div class="ttdeci">int iteration</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00082">SETS.h:82</a></div></div>
<div class="ttc" id="aclassSETS_html_a818444b126b2bb412971d24b5f1acf2c"><div class="ttname"><a href="classSETS.html#a818444b126b2bb412971d24b5f1acf2c">SETS::unknown_positivation</a></div><div class="ttdeci">double unknown_positivation(const DoubleTab &amp;uk, DoubleTab &amp;incr)</div><div class="ttdoc">brings to 0 unknowns that should stay positive</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00128">SETS.cpp:128</a></div></div>
<div class="ttc" id="aclassSETS_html_a8ee91bd4406997e979f5157a55749010"><div class="ttname"><a href="classSETS.html#a8ee91bd4406997e979f5157a55749010">SETS::mat_semi_impl</a></div><div class="ttdeci">Matrice_Bloc mat_semi_impl</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00113">SETS.h:113</a></div></div>
<div class="ttc" id="aclassSETS_html_aa1512e2ef91bb2c9ab5968a69b54600a"><div class="ttname"><a href="classSETS.html#aa1512e2ef91bb2c9ab5968a69b54600a">SETS::mats</a></div><div class="ttdeci">std::map&lt; std::string, matrices_t &gt; mats</div><div class="ttdoc">matrices : mats[nom de l'inconnue de l'equation][nom de l'autre inconnue] = matrice</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00112">SETS.h:112</a></div></div>
<div class="ttc" id="aclassSETS_html_aa96e420735d53c9033c0031f4a02a379"><div class="ttname"><a href="classSETS.html#aa96e420735d53c9033c0031f4a02a379">SETS::mat_pred</a></div><div class="ttdeci">std::map&lt; std::string, Matrice_Morse &gt; mat_pred</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00114">SETS.h:114</a></div></div>
<div class="ttc" id="aclassSETS_html_abc7f91897922f8e62d9b9a181ff35f51"><div class="ttname"><a href="classSETS.html#abc7f91897922f8e62d9b9a181ff35f51">SETS::first_call_</a></div><div class="ttdeci">int first_call_</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00106">SETS.h:106</a></div></div>
<div class="ttc" id="aclassSETS_html_ac8f62874bd9a352e8def1cfc3d996186"><div class="ttname"><a href="classSETS.html#ac8f62874bd9a352e8def1cfc3d996186">SETS::iterer_eqn</a></div><div class="ttdeci">bool iterer_eqn(Equation_base &amp;equation, const DoubleTab &amp;inconnue, DoubleTab &amp;result, double dt, int numero_iteration, int &amp;ok) override</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00193">SETS.cpp:193</a></div></div>
<div class="ttc" id="aclassSETS_html_acf75db99aa6f39fb02552f774ac26d17"><div class="ttname"><a href="classSETS.html#acf75db99aa6f39fb02552f774ac26d17">SETS::iter_max_</a></div><div class="ttdeci">int iter_max_</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8h_source.html#l00105">SETS.h:105</a></div></div>
<div class="ttc" id="aclassSETS_html_ada6340015cdfb27238ce2b334310506a"><div class="ttname"><a href="classSETS.html#ada6340015cdfb27238ce2b334310506a">SETS::printOn</a></div><div class="ttdeci">Sortie &amp; printOn(Sortie &amp;x) const override</div><div class="ttdoc">Ecriture de l'objet sur un flot de sortie Methode a surcharger.</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00062">SETS.cpp:62</a></div></div>
<div class="ttc" id="aclassSETS_html_adb48a8df649985ae87a5c2ad6ab4a501"><div class="ttname"><a href="classSETS.html#adb48a8df649985ae87a5c2ad6ab4a501">SETS::readOn</a></div><div class="ttdeci">Entree &amp; readOn(Entree &amp;) override</div><div class="ttdoc">Lecture d'un Objet_U sur un flot d'entree Methode a surcharger.</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00067">SETS.cpp:67</a></div></div>
<div class="ttc" id="aclassSETS_html_aee1d7ecf5c3afe47822a4f1a7705696b"><div class="ttname"><a href="classSETS.html#aee1d7ecf5c3afe47822a4f1a7705696b">SETS::assembler</a></div><div class="ttdeci">static void assembler(const std::string inco_p, const std::map&lt; std::string, Matrice_Morse &gt; &amp;A_p, const tabs_t &amp;b_p, const std::map&lt; std::string, matrices_t &gt; &amp;mats, const tabs_t &amp;sec, Matrice_Morse &amp;matrice, DoubleTab &amp;secmem, int p_degen)</div><div class="ttdef"><b>Definition:</b> <a href="SETS_8cpp_source.html#l00626">SETS.cpp:626</a></div></div>
<div class="ttc" id="aclassSchema__Temps__base_html_a1e573b93ad40c737ecb2da65b68f968a"><div class="ttname"><a href="classSchema__Temps__base.html#a1e573b93ad40c737ecb2da65b68f968a">Schema_Temps_base::temps_courant</a></div><div class="ttdeci">double temps_courant() const</div><div class="ttdoc">Renvoie le temps courant.</div><div class="ttdef"><b>Definition:</b> <a href="Schema__Temps__base_8h_source.html#l00672">Schema_Temps_base.h:672</a></div></div>
<div class="ttc" id="aclassSimple_html_a7a1944e0157cae3713183c238f1296c9"><div class="ttname"><a href="classSimple.html#a7a1944e0157cae3713183c238f1296c9">Simple::lire</a></div><div class="ttdeci">Entree &amp; lire(const Motcle &amp;, Entree &amp;) override</div><div class="ttdef"><b>Definition:</b> <a href="Simple_8cpp_source.html#l00057">Simple.cpp:57</a></div></div>
<div class="ttc" id="aclassSimpler__Base_html_a48f161aca850ff2462803f62c040c173"><div class="ttname"><a href="classSimpler__Base.html#a48f161aca850ff2462803f62c040c173">Simpler_Base::get_and_set_parametre_implicite</a></div><div class="ttdeci">Parametre_implicite &amp; get_and_set_parametre_implicite(Equation_base &amp;eqn)</div><div class="ttdef"><b>Definition:</b> <a href="Simpler__Base_8h_source.html#l00087">Simpler_Base.h:87</a></div></div>
<div class="ttc" id="aclassSimpler_html"><div class="ttname"><a href="classSimpler.html">Simpler</a></div><div class="ttdef"><b>Definition:</b> <a href="Simpler_8h_source.html#l00074">Simpler.h:75</a></div></div>
<div class="ttc" id="aclassSimpler_html_a67c19f48bf7bd78b6c048a013664473f"><div class="ttname"><a href="classSimpler.html#a67c19f48bf7bd78b6c048a013664473f">Simpler::readOn</a></div><div class="ttdeci">Entree &amp; readOn(Entree &amp;) override</div><div class="ttdoc">Lecture d'un Objet_U sur un flot d'entree Methode a surcharger.</div><div class="ttdef"><b>Definition:</b> <a href="Simpler_8cpp_source.html#l00035">Simpler.cpp:35</a></div></div>
<div class="ttc" id="aclassSimpler_html_ab366344c23dbaab3f1a46620740bde65"><div class="ttname"><a href="classSimpler.html#ab366344c23dbaab3f1a46620740bde65">Simpler::printOn</a></div><div class="ttdeci">Sortie &amp; printOn(Sortie &amp;x) const override</div><div class="ttdoc">Ecriture de l'objet sur un flot de sortie Methode a surcharger.</div><div class="ttdef"><b>Definition:</b> <a href="Simpler_8cpp_source.html#l00030">Simpler.cpp:30</a></div></div>
<div class="ttc" id="aclassSolv__Petsc_html"><div class="ttname"><a href="classSolv__Petsc.html">Solv_Petsc</a></div><div class="ttdef"><b>Definition:</b> <a href="Solv__Petsc_8h_source.html#l00036">Solv_Petsc.h:37</a></div></div>
<div class="ttc" id="aclassSolveurSys__base_html_a27067468cf159dc2e08c693ac7432685"><div class="ttname"><a href="classSolveurSys__base.html#a27067468cf159dc2e08c693ac7432685">SolveurSys_base::set_return_on_error</a></div><div class="ttdeci">void set_return_on_error(int ret)</div><div class="ttdef"><b>Definition:</b> <a href="SolveurSys__base_8h_source.html#l00038">SolveurSys_base.h:38</a></div></div>
<div class="ttc" id="aclassSolveurSys__base_html_a8737bd7292204c64e4b7bfe4c7bd88ef"><div class="ttname"><a href="classSolveurSys__base.html#a8737bd7292204c64e4b7bfe4c7bd88ef">SolveurSys_base::reinit</a></div><div class="ttdeci">virtual void reinit()</div><div class="ttdef"><b>Definition:</b> <a href="SolveurSys__base_8h_source.html#l00047">SolveurSys_base.h:47</a></div></div>
<div class="ttc" id="aclassSolveurSys_html"><div class="ttname"><a href="classSolveurSys.html">SolveurSys</a></div><div class="ttdef"><b>Definition:</b> <a href="SolveurSys_8h_source.html#l00032">SolveurSys.h:33</a></div></div>
<div class="ttc" id="aclassSolveurSys_html_a62ca198f0c5dc599e53b0535761e5138"><div class="ttname"><a href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">SolveurSys::resoudre_systeme</a></div><div class="ttdeci">int resoudre_systeme(const Matrice_Base &amp;matrice, const DoubleVect &amp;secmem, DoubleVect &amp;solution)</div><div class="ttdef"><b>Definition:</b> <a href="SolveurSys_8cpp_source.html#l00045">SolveurSys.cpp:45</a></div></div>
<div class="ttc" id="aclassSolveur__Masse_html_a856562aab8d40820986e2a68341c6fa4"><div class="ttname"><a href="classSolveur__Masse.html#a856562aab8d40820986e2a68341c6fa4">Solveur_Masse::corriger_solution</a></div><div class="ttdeci">DoubleTab &amp; corriger_solution(DoubleTab &amp;x, const DoubleTab &amp;y, int incr=0) const</div><div class="ttdef"><b>Definition:</b> <a href="Solveur__Masse_8h_source.html#l00173">Solveur_Masse.h:173</a></div></div>
<div class="ttc" id="aclassSortie_html"><div class="ttname"><a href="classSortie.html">Sortie</a></div><div class="ttdoc">Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers,...</div><div class="ttdef"><b>Definition:</b> <a href="Sortie_8h_source.html#l00050">Sortie.h:51</a></div></div>
<div class="ttc" id="aclassTRUSTArray_html_a12099f562e7ea212f5f2cbffab78b8e8"><div class="ttname"><a href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">TRUSTArray::addr</a></div><div class="ttdeci">_TYPE_ * addr()</div><div class="ttdoc">!&lt;</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTArray_8tpp_source.html#l00181">TRUSTArray.tpp:181</a></div></div>
<div class="ttc" id="aclassTRUSTArray_html_a7c2cb947c5f755b7bcc8256246ccfdb5"><div class="ttname"><a href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">TRUSTArray::set_smart_resize</a></div><div class="ttdeci">void set_smart_resize(int flag)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTArray_8tpp_source.html#l00058">TRUSTArray.tpp:58</a></div></div>
<div class="ttc" id="aclassTRUSTArray_html_ac03d475a56970fcc19cf624a0353e42e"><div class="ttname"><a href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">TRUSTArray::size_array</a></div><div class="ttdeci">int size_array() const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTArray_8tpp_source.html#l00195">TRUSTArray.tpp:195</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html"><div class="ttname"><a href="classTRUSTTab.html">TRUSTTab&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html_a02f5d997850b88e5f307f6ddaf67286e"><div class="ttname"><a href="classTRUSTTab.html#a02f5d997850b88e5f307f6ddaf67286e">TRUSTTab::dimension_tot</a></div><div class="ttdeci">int dimension_tot(int) const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTab_8tpp_source.html#l00129">TRUSTTab.tpp:129</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html_a33c4f72e40e49cdb553fc7311fe656bc"><div class="ttname"><a href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">TRUSTTab::resize</a></div><div class="ttdeci">void resize(int n, Array_base::Resize_Options opt=Array_base::COPY_INIT)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTab_8tpp_source.html#l00313">TRUSTTab.tpp:313</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html_aeafea8c8242ddec97c6bacfd74b34fc3"><div class="ttname"><a href="classTRUSTTab.html#aeafea8c8242ddec97c6bacfd74b34fc3">TRUSTTab::append_line</a></div><div class="ttdeci">void append_line(_TYPE_)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTab_8tpp_source.html#l00138">TRUSTTab.tpp:138</a></div></div>
<div class="ttc" id="aclassTRUSTTrav_html"><div class="ttname"><a href="classTRUSTTrav.html">TRUSTTrav</a></div><div class="ttdoc">: Tableau de travail a n entrees pour n&lt;= 4 C'est un TRUSTTab avec allocation dans un pool de memoire...</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTrav_8h_source.html#l00024">TRUSTTrav.h:25</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html"><div class="ttname"><a href="classTRUSTVect.html">TRUSTVect&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html_a5ae6fa5040fbdc708e54a7aba732413f"><div class="ttname"><a href="classTRUSTVect.html#a5ae6fa5040fbdc708e54a7aba732413f">TRUSTVect::size_totale</a></div><div class="ttdeci">int size_totale() const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect_8tpp_source.html#l00058">TRUSTVect.tpp:58</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html_a649c67413e5406c514742aa39dd791b9"><div class="ttname"><a href="classTRUSTVect.html#a649c67413e5406c514742aa39dd791b9">TRUSTVect::line_size</a></div><div class="ttdeci">int line_size() const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect_8tpp_source.html#l00064">TRUSTVect.tpp:64</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html_a7c824c9032be2e622561aa481fe1b8ae"><div class="ttname"><a href="classTRUSTVect.html#a7c824c9032be2e622561aa481fe1b8ae">TRUSTVect::get_md_vector</a></div><div class="ttdeci">virtual const MD_Vector &amp; get_md_vector() const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect_8h_source.html#l00144">TRUSTVect.h:144</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html_a7df489e59381e175b1df9cef48355fe5"><div class="ttname"><a href="classTRUSTVect.html#a7df489e59381e175b1df9cef48355fe5">TRUSTVect::echange_espace_virtuel</a></div><div class="ttdeci">virtual void echange_espace_virtuel()</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect_8tpp_source.html#l00267">TRUSTVect.tpp:267</a></div></div>
<div class="ttc" id="aclassZone__Cl__dis_html_a4777480745dd18899c4bc3e9cb774ea4"><div class="ttname"><a href="classZone__Cl__dis.html#a4777480745dd18899c4bc3e9cb774ea4">Zone_Cl_dis::les_conditions_limites</a></div><div class="ttdeci">const Cond_lim &amp; les_conditions_limites(int) const</div><div class="ttdoc">Appel a l'objet sous-jacent Renvoie la i-ieme condition aux limites. (version const)</div><div class="ttdef"><b>Definition:</b> <a href="Zone__Cl__dis_8h_source.html#l00123">Zone_Cl_dis.h:123</a></div></div>
<div class="ttc" id="aclassZone__Cl__dis_html_aa8bea2d873a74d7ec939ddc0cf6c41b7"><div class="ttname"><a href="classZone__Cl__dis.html#aa8bea2d873a74d7ec939ddc0cf6c41b7">Zone_Cl_dis::nb_cond_lim</a></div><div class="ttdeci">int nb_cond_lim() const</div><div class="ttdoc">Appel a l'objet sous-jacent Renvoie le nombre de conditions aux limites.</div><div class="ttdef"><b>Definition:</b> <a href="Zone__Cl__dis_8h_source.html#l00208">Zone_Cl_dis.h:208</a></div></div>
<div class="ttc" id="aclassbprinter_1_1TablePrinter_html"><div class="ttname"><a href="classbprinter_1_1TablePrinter.html">bprinter::TablePrinter</a></div><div class="ttdef"><b>Definition:</b> <a href="TablePrinter_8h_source.html#l00047">TablePrinter.h:48</a></div></div>
<div class="ttc" id="aclassbprinter_1_1TablePrinter_html_a271d4d46ec64e34f3b00093d0971101d"><div class="ttname"><a href="classbprinter_1_1TablePrinter.html#a271d4d46ec64e34f3b00093d0971101d">bprinter::TablePrinter::AddColumn</a></div><div class="ttdeci">void AddColumn(const std::string &amp;header_name, int column_width)</div><div class="ttdoc">Add a column to our table.</div><div class="ttdef"><b>Definition:</b> <a href="TablePrinter_8cpp_source.html#l00061">TablePrinter.cpp:61</a></div></div>
<div class="ttc" id="aclassbprinter_1_1TablePrinter_html_a4022eb59d90fec098cda994b147ce9b3"><div class="ttname"><a href="classbprinter_1_1TablePrinter.html#a4022eb59d90fec098cda994b147ce9b3">bprinter::TablePrinter::PrintHeader</a></div><div class="ttdeci">void PrintHeader()</div><div class="ttdef"><b>Definition:</b> <a href="TablePrinter_8cpp_source.html#l00084">TablePrinter.cpp:84</a></div></div>
<div class="ttc" id="acommunications_8cpp_html_a13b5bdc7cfe14771b52a033b1ecbc071"><div class="ttname"><a href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071">mppartial_sum</a></div><div class="ttdeci">int mppartial_sum(int x)</div><div class="ttdoc">Calul de la somme partielle de i sur les processeurs 0 a me()-1 (renvoie 0 sur le processeur 0)....</div><div class="ttdef"><b>Definition:</b> <a href="communications_8cpp_source.html#l00297">communications.cpp:297</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 29 2022 11:11:33 for TRUST by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
