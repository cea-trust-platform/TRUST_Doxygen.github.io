<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/EF/Sources/Source_PDF_EF.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/EF/Sources/Source_PDF_EF.cpp</div>  </div>
</div>
<div class="contents">
<a href="Source__PDF__EF_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Source_PDF_EF.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/EF/Sources</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/10</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Uniforme_8h.html">Champ_Uniforme.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Zone__EF_8h.html">Zone_EF.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__EF_8h.html">Zone_Cl_EF.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Equation__base_8h.html">Equation_base.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps__base_8h.html">Schema_Temps_base.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Q1__EF_8h.html">Champ_Q1_EF.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Discretisation__base_8h.html">Discretisation_base.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse_8h.html">Matrice_Morse.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Bloc_8h.html">Matrice_Bloc.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="DoubleTrav_8h.html">DoubleTrav.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="Interpolation__IBM__elem__fluid_8h.html">Interpolation_IBM_elem_fluid.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="Interpolation__IBM__mean__gradient_8h.html">Interpolation_IBM_mean_gradient.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="Interpolation__IBM__hybrid_8h.html">Interpolation_IBM_hybrid.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet_8h.html">Dirichlet.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="Symetrie_8h.html">Symetrie.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="SFichier_8h.html">SFichier.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="Source__PDF__EF_8h.html">Source_PDF_EF.h</a>&gt;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="Op__Conv__EF_8h.html">Op_Conv_EF.h</a>&gt;</span>
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="Source__PDF__EF_8cpp.html#aeca0d21cdaccf4e00b33395e50cca170">00045</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classSource__PDF__EF.html" title="class Source_PDF_EF Source term for the penalisation of the momentum in the Immersed Boundary Method ...">Source_PDF_EF</a>,<span class="stringliteral">&quot;Source_PDF_EF&quot;</span>,<a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>);
<a name="l00046"></a>00046 <span class="comment">// XD source_pdf source_pdf_base source_pdf 1 Source term for Penalised Direct Forcing (PDF) method.</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="comment">/*##################################################################################################</span>
<a name="l00049"></a>00049 <span class="comment">####################################################################################################</span>
<a name="l00050"></a>00050 <span class="comment">################################# READON AND PRINTON ###############################################</span>
<a name="l00051"></a>00051 <span class="comment">####################################################################################################</span>
<a name="l00052"></a>00052 <span class="comment">##################################################################################################*/</span>
<a name="l00053"></a>00053 
<a name="l00054"></a><a class="code" href="classSource__PDF__EF.html#a62487c7214d835bf368c6e5ccc947e3e">00054</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classSource__PDF__EF.html#a62487c7214d835bf368c6e5ccc947e3e" title="NE FAIT RIEN A surcharger dans les classes derivees. Lecture d&#39;un terme source sur un flot d&#39;entree...">Source_PDF_EF::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s)
<a name="l00055"></a>00055 {
<a name="l00056"></a>00056   <a class="code" href="classSource__PDF__EF.html#a62487c7214d835bf368c6e5ccc947e3e" title="NE FAIT RIEN A surcharger dans les classes derivees. Lecture d&#39;un terme source sur un flot d&#39;entree...">Source_PDF_base::readOn</a>(s);
<a name="l00057"></a>00057   <span class="keywordflow">return</span> s;
<a name="l00058"></a>00058 }
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="classSource__PDF__EF.html#a476f3cbee3d487bfe7049da5b254aa73">00060</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classSource__PDF__EF.html#a476f3cbee3d487bfe7049da5b254aa73" title="NE FAIT RIEN A surcharger dans les classes derivees. Imprime la source sur un flot de sortie...">Source_PDF_EF::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00061"></a>00061 <span class="keyword"></span>{
<a name="l00062"></a>00062   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
<a name="l00063"></a>00063 }
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="comment">/*##################################################################################################</span>
<a name="l00066"></a>00066 <span class="comment">####################################################################################################</span>
<a name="l00067"></a>00067 <span class="comment">################################# PROBLEM ASSOCIATION AND ZONES ####################################</span>
<a name="l00068"></a>00068 <span class="comment">####################################################################################################</span>
<a name="l00069"></a>00069 <span class="comment">##################################################################################################*/</span>
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="classSource__PDF__EF.html#af9cde8fb3709a0d9b96ef2bed3faece9">00071</a> <span class="keywordtype">void</span> <a class="code" href="classSource__PDF__EF.html#af9cde8fb3709a0d9b96ef2bed3faece9">Source_PDF_EF::associer_pb</a>(<span class="keyword">const</span> <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb)
<a name="l00072"></a>00072 {
<a name="l00073"></a>00073   assert(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3);
<a name="l00074"></a>00074   <span class="keywordtype">int</span> nb_comp=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>*<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00075"></a>00075   nb_comp=9;
<a name="l00076"></a>00076   <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a> nom_c(nb_comp);
<a name="l00077"></a>00077   <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a> unites(nb_comp);
<a name="l00078"></a>00078   pb.<a class="code" href="classProbleme__base.html#ac2bc635ab5b121c1cab78b6f98c0b203" title="Renvoie la discretisation associee au probleme.">discretisation</a>().<a class="code" href="classDiscretisation__base.html#a03257807e08369739ccc39eba02f74b5">discretiser_champ</a>(<span class="stringliteral">&quot;champ_elem&quot;</span>,<a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>,<a class="code" href="Field__base_8h.html#a1b86c8f670a9b34da7f628a821fb646ba66d795f4e2fbb5636a3966c73964c5e7">vectoriel</a>,nom_c,unites,nb_comp,0.,<a class="code" href="classSource__PDF__base.html#aeaa31d63e32bd5e117186897c087b225">champ_rotation_</a>);
<a name="l00079"></a>00079   <a class="code" href="classSource__PDF__base.html#aeaa31d63e32bd5e117186897c087b225">champ_rotation_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__base.html#a336a105699c70cd8c4d9b066a39264a8" title="Affecter un champ dans un autre. Rebvoie le resultat de l&#39;affectation.">affecter</a>(<a class="code" href="classSource__PDF__base.html#a4522e0b3108e013a45186510d0282aef">champ_rotation_lu_</a>);
<a name="l00080"></a>00080   nb_comp=3;
<a name="l00081"></a>00081   <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a> nom_c1(nb_comp);
<a name="l00082"></a>00082   <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a> unites1(nb_comp);
<a name="l00083"></a>00083   pb.<a class="code" href="classProbleme__base.html#ac2bc635ab5b121c1cab78b6f98c0b203" title="Renvoie la discretisation associee au probleme.">discretisation</a>().<a class="code" href="classDiscretisation__base.html#a03257807e08369739ccc39eba02f74b5">discretiser_champ</a>(<span class="stringliteral">&quot;champ_elem&quot;</span>,<a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>,<span class="stringliteral">&quot;aire&quot;</span>,<span class="stringliteral">&quot;m-1&quot;</span>,1,0., <a class="code" href="classSource__PDF__base.html#a9820811d5e6b5e31a40e7564a16c1ce7">champ_aire_</a>);
<a name="l00084"></a>00084   <a class="code" href="classSource__PDF__base.html#a9820811d5e6b5e31a40e7564a16c1ce7">champ_aire_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__base.html#a336a105699c70cd8c4d9b066a39264a8" title="Affecter un champ dans un autre. Rebvoie le resultat de l&#39;affectation.">affecter</a>(<a class="code" href="classSource__PDF__base.html#a68e3cce1f13bb6519ceef26868370d19">champ_aire_lu_</a>);
<a name="l00085"></a>00085   pb.<a class="code" href="classProbleme__base.html#ac2bc635ab5b121c1cab78b6f98c0b203" title="Renvoie la discretisation associee au probleme.">discretisation</a>().<a class="code" href="classDiscretisation__base.html#a03257807e08369739ccc39eba02f74b5">discretiser_champ</a>(<span class="stringliteral">&quot;champ_elem&quot;</span>,<a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>,<span class="stringliteral">&quot;rho&quot;</span>,<span class="stringliteral">&quot;kg.m-3&quot;</span>,1,0., <a class="code" href="classSource__PDF__base.html#a9fc1e064a50252b36c8e1d9228558190">champ_rho_</a>);
<a name="l00086"></a>00086   <a class="code" href="classSource__PDF__base.html#a9fc1e064a50252b36c8e1d9228558190">champ_rho_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__base.html#a336a105699c70cd8c4d9b066a39264a8" title="Affecter un champ dans un autre. Rebvoie le resultat de l&#39;affectation.">affecter</a>(<a class="code" href="classSource__PDF__base.html#a68e3cce1f13bb6519ceef26868370d19">champ_aire_lu_</a>);
<a name="l00087"></a>00087   <span class="keywordflow">if</span> (<a class="code" href="classSource__PDF__base.html#ab4c905ca6773fc77cff45774a2c9012c">transpose_rotation_</a>)
<a name="l00088"></a>00088     {
<a name="l00089"></a>00089 
<a name="l00090"></a>00090       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val=<a class="code" href="classSource__PDF__base.html#aeaa31d63e32bd5e117186897c087b225">champ_rotation_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00091"></a>00091 
<a name="l00092"></a>00092       <span class="keywordtype">int</span> nb_case=val.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
<a name="l00093"></a>00093       <span class="keywordtype">int</span> nb_dim=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00094"></a>00094       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ele=0; ele&lt;nb_case; ele++)
<a name="l00095"></a>00095         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nb_dim; k++)
<a name="l00096"></a>00096           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=k+1; i&lt;nb_dim; i++)
<a name="l00097"></a>00097             {
<a name="l00098"></a>00098               <span class="keywordtype">double</span> tmp=val(ele,3*k+i);
<a name="l00099"></a>00099               val(ele,3*k+i)=val(ele,3*i+k);
<a name="l00100"></a>00100               val(ele,3*i+k)=tmp;
<a name="l00101"></a>00101             }
<a name="l00102"></a>00102 
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <a class="code" href="classSource__PDF__base.html#a47afe4176fd865310109c31980b66176">temps_relax_</a> = <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#ae421217438aa20e2aad7a95627c81b9e">temps_relax_</a>;
<a name="l00106"></a>00106   <a class="code" href="classSource__PDF__base.html#ae5bcb9501df8964dfe7fc921ba7cf60c">echelle_relax_</a> = <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a44698e6cfd4f195dd6297cc9d6378ca7">echelle_relax_</a>;
<a name="l00107"></a>00107   <a class="code" href="classSource__PDF__base.html#a1537fd02975c93fe4bffdc18a7afb640">matrice_pression_variable_bool_</a> = <span class="keyword">false</span>;
<a name="l00108"></a>00108   <span class="keywordflow">if</span> (<a class="code" href="classSource__PDF__base.html#a47afe4176fd865310109c31980b66176">temps_relax_</a> != 1.0e+12) <a class="code" href="classSource__PDF__base.html#a1537fd02975c93fe4bffdc18a7afb640">matrice_pression_variable_bool_</a> = <span class="keyword">true</span>;
<a name="l00109"></a>00109   <a class="code" href="classSource__PDF__base.html#a5717a095ec70dca2cf7e60a1d36d897c">type_vitesse_imposee_</a> = <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a76a2347f6b52ea5d6138118f5a1583ff">type_vitesse_imposee_</a>;
<a name="l00110"></a>00110   pb.<a class="code" href="classProbleme__base.html#ac2bc635ab5b121c1cab78b6f98c0b203" title="Renvoie la discretisation associee au probleme.">discretisation</a>().<a class="code" href="classDiscretisation__base.html#a03257807e08369739ccc39eba02f74b5">discretiser_champ</a>(<span class="stringliteral">&quot;vitesse&quot;</span>,<a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>,<a class="code" href="Field__base_8h.html#a1b86c8f670a9b34da7f628a821fb646ba66d795f4e2fbb5636a3966c73964c5e7">vectoriel</a>,nom_c1,unites1,nb_comp,0.,<a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a1c3a633cde662b1580c16fb3a03fa76f">vitesse_imposee_</a>);
<a name="l00111"></a>00111 
<a name="l00112"></a>00112   <span class="keywordflow">if</span> (<a class="code" href="classSource__PDF__base.html#a996800987b2fe027dbb2ba80aba49fa8">interpolation_bool_</a>)
<a name="l00113"></a>00113     {
<a name="l00114"></a>00114       <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; la_zone_dis_base = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>,<a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>());
<a name="l00115"></a>00115       <a class="code" href="classSource__PDF__base.html#a7b003f7d350e0a8055a38025e2aa862e">interpolation_lue_</a>.<a class="code" href="classDeriv__Interpolation__IBM__base.html#a4b312578d1125810c6c3211788d81be4">valeur</a>().<a class="code" href="classInterpolation__IBM__base.html#a1257bea8092b732316252966e3af3733">discretise</a>(pb.<a class="code" href="classProbleme__base.html#ac2bc635ab5b121c1cab78b6f98c0b203" title="Renvoie la discretisation associee au probleme.">discretisation</a>(),la_zone_dis_base);
<a name="l00116"></a>00116       <span class="keywordflow">if</span> (<a class="code" href="classSource__PDF__base.html#a5717a095ec70dca2cf7e60a1d36d897c">type_vitesse_imposee_</a> == 1)
<a name="l00117"></a>00117         {
<a name="l00118"></a>00118           <span class="keywordflow">if</span> (<a class="code" href="classSource__PDF__base.html#a7b003f7d350e0a8055a38025e2aa862e">interpolation_lue_</a>.<a class="code" href="classDeriv__Interpolation__IBM__base.html#a4b312578d1125810c6c3211788d81be4">valeur</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() == <span class="stringliteral">&quot;Interpolation_IBM_gradient_moyen&quot;</span>)
<a name="l00119"></a>00119             {
<a name="l00120"></a>00120               <span class="keyword">const</span> <a class="code" href="classInterpolation__IBM__mean__gradient.html" title=": class Interpolation_IBM_mean_gradient &lt;Description of class Interpolation_IBM_mean_gradient&gt;">Interpolation_IBM_mean_gradient</a>&amp; interp = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classInterpolation__IBM__mean__gradient.html" title=": class Interpolation_IBM_mean_gradient &lt;Description of class Interpolation_IBM_mean_gradient&gt;">Interpolation_IBM_mean_gradient</a>,<a class="code" href="classSource__PDF__base.html#a7b003f7d350e0a8055a38025e2aa862e">interpolation_lue_</a>.<a class="code" href="classDeriv__Interpolation__IBM__base.html#a4b312578d1125810c6c3211788d81be4">valeur</a>());
<a name="l00121"></a>00121               this-&gt;<a class="code" href="classSource__PDF__EF.html#a6d7584c29c8e9477db7306ea6bf19b32">compute_vitesse_imposee_projete</a>(interp.<a class="code" href="classInterpolation__IBM__mean__gradient__proto.html#a0cac69be816b06c760f93d96c542a543">solid_elems_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>(), interp.<a class="code" href="classInterpolation__IBM__base.html#a1e94241f5f300dece3b98ec465304005">solid_points_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>(), -2, 1e-6);
<a name="l00122"></a>00122             }
<a name="l00123"></a>00123           <span class="keywordflow">else</span>
<a name="l00124"></a>00124             {
<a name="l00125"></a>00125               <span class="keyword">const</span> <a class="code" href="classInterpolation__IBM__elem__fluid.html" title=": class Interpolation_IBM_elem_fluid &lt;Description of class Interpolation_IBM_elem_fluid&gt;">Interpolation_IBM_elem_fluid</a>&amp; interp = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classInterpolation__IBM__elem__fluid.html" title=": class Interpolation_IBM_elem_fluid &lt;Description of class Interpolation_IBM_elem_fluid&gt;">Interpolation_IBM_elem_fluid</a>,<a class="code" href="classSource__PDF__base.html#a7b003f7d350e0a8055a38025e2aa862e">interpolation_lue_</a>.<a class="code" href="classDeriv__Interpolation__IBM__base.html#a4b312578d1125810c6c3211788d81be4">valeur</a>());
<a name="l00126"></a>00126               <a class="code" href="classSource__PDF__EF.html#a6d7584c29c8e9477db7306ea6bf19b32">compute_vitesse_imposee_projete</a>(interp.<a class="code" href="classInterpolation__IBM__elem__fluid.html#a41b15f7dee67cffceb9929a672a50108">fluid_elems_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>(), interp.<a class="code" href="classInterpolation__IBM__base.html#a1e94241f5f300dece3b98ec465304005">solid_points_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>(), -2.0, 1e-6);
<a name="l00127"></a>00127             }
<a name="l00128"></a>00128         }
<a name="l00129"></a>00129       <span class="keywordflow">else</span>
<a name="l00130"></a>00130         {
<a name="l00131"></a>00131           <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a1c3a633cde662b1580c16fb3a03fa76f">vitesse_imposee_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__base.html#a336a105699c70cd8c4d9b066a39264a8" title="Affecter un champ dans un autre. Rebvoie le resultat de l&#39;affectation.">affecter</a>(<a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a7afe5a52609ce649af93844a5449bf1d">vitesse_imposee_lu_</a>);
<a name="l00132"></a>00132         }
<a name="l00133"></a>00133     }
<a name="l00134"></a>00134   <span class="keywordflow">else</span>
<a name="l00135"></a>00135     {
<a name="l00136"></a>00136       <span class="keywordflow">if</span> (<a class="code" href="classSource__PDF__base.html#a5717a095ec70dca2cf7e60a1d36d897c">type_vitesse_imposee_</a> != 1)
<a name="l00137"></a>00137         {
<a name="l00138"></a>00138           <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a1c3a633cde662b1580c16fb3a03fa76f">vitesse_imposee_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__base.html#a336a105699c70cd8c4d9b066a39264a8" title="Affecter un champ dans un autre. Rebvoie le resultat de l&#39;affectation.">affecter</a>(<a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a7afe5a52609ce649af93844a5449bf1d">vitesse_imposee_lu_</a>);
<a name="l00139"></a>00139         }
<a name="l00140"></a>00140       <span class="keywordflow">else</span>
<a name="l00141"></a>00141         {
<a name="l00142"></a>00142           <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coords = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00143"></a>00143           <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a37de8def7d9a3e35939abb7bdd22b895">affecter_vitesse_imposee</a>(<a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>, coords);
<a name="l00144"></a>00144         }
<a name="l00145"></a>00145     }
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   <span class="keywordflow">if</span> (<a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a374e524176c1e38da0fa8e856d4e7f6e">local_</a> == 1)
<a name="l00148"></a>00148     {
<a name="l00149"></a>00149       <a class="code" href="classSource__PDF__EF.html#aaa4001acc6c3b4fdd5ab230afe5783d4">rotate_imposed_velocity</a>(<a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a1c3a633cde662b1580c16fb3a03fa76f">vitesse_imposee_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>());
<a name="l00150"></a>00150     }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="comment">/*pb.discretisation().discretiser_champ(&quot;vitesse&quot;,la_zone_EF,vectoriel,nom_c1,unites1,nb_comp,0.,vitesse_imposee_);</span>
<a name="l00153"></a>00153 <span class="comment">  vitesse_imposee_.valeur().affecter(mod_.vitesse_imposee_);*/</span>
<a name="l00154"></a>00154   <a class="code" href="classSource__PDF__base.html#af9c1db0d8c53f4a584c5dd7650039b8c">vitesse_imposee_</a> = <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a1c3a633cde662b1580c16fb3a03fa76f">vitesse_imposee_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00155"></a>00155   pb.<a class="code" href="classProbleme__base.html#ac2bc635ab5b121c1cab78b6f98c0b203" title="Renvoie la discretisation associee au probleme.">discretisation</a>().<a class="code" href="classDiscretisation__base.html#a03257807e08369739ccc39eba02f74b5">discretiser_champ</a>(<span class="stringliteral">&quot;champ_sommets&quot;</span>,<a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>,<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,1,0., <a class="code" href="classSource__PDF__EF.html#a5ba63c704748538d947f528a078b1f36">champ_nodal_</a>);
<a name="l00156"></a>00156 }
<a name="l00157"></a>00157 
<a name="l00158"></a><a class="code" href="classSource__PDF__EF.html#a6d7584c29c8e9477db7306ea6bf19b32">00158</a> <span class="keywordtype">void</span> <a class="code" href="classSource__PDF__EF.html#a6d7584c29c8e9477db7306ea6bf19b32">Source_PDF_EF::compute_vitesse_imposee_projete</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; marqueur, <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; points, <span class="keywordtype">double</span> val, <span class="keywordtype">double</span> eps)
<a name="l00159"></a>00159 {
<a name="l00160"></a>00160   <span class="keywordtype">int</span> nb_som=<a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();
<a name="l00161"></a>00161   <span class="keywordtype">int</span> dim = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00162"></a>00162   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coords = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00163"></a>00163   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> x(dim);
<a name="l00164"></a>00164   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_som; i++)
<a name="l00165"></a>00165     {
<a name="l00166"></a>00166       <span class="keywordflow">if</span> ((marqueur(i) &gt;= val + eps) || (marqueur(i) &lt;= val - eps))
<a name="l00167"></a>00167         {
<a name="l00168"></a>00168           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dim; j++)
<a name="l00169"></a>00169             {
<a name="l00170"></a>00170               x(j) = points(i,j);
<a name="l00171"></a>00171             }
<a name="l00172"></a>00172           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dim; j++)
<a name="l00173"></a>00173             {
<a name="l00174"></a>00174               <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a1c3a633cde662b1580c16fb3a03fa76f">vitesse_imposee_</a>(i,j) = <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a418ce8fdf995dee8bee32319b7d5b729">get_vitesse_imposee</a>(x,j);
<a name="l00175"></a>00175             }
<a name="l00176"></a>00176         }
<a name="l00177"></a>00177       <span class="keywordflow">else</span>
<a name="l00178"></a>00178         {
<a name="l00179"></a>00179           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dim; j++)
<a name="l00180"></a>00180             {
<a name="l00181"></a>00181               x(j) = coords(i,j);
<a name="l00182"></a>00182             }
<a name="l00183"></a>00183           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dim; j++)
<a name="l00184"></a>00184             {
<a name="l00185"></a>00185               <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a1c3a633cde662b1580c16fb3a03fa76f">vitesse_imposee_</a>(i,j) = <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a418ce8fdf995dee8bee32319b7d5b729">get_vitesse_imposee</a>(x,j);
<a name="l00186"></a>00186             }
<a name="l00187"></a>00187         }
<a name="l00188"></a>00188     }
<a name="l00189"></a>00189 }
<a name="l00190"></a>00190 
<a name="l00191"></a><a class="code" href="classSource__PDF__EF.html#aaa4001acc6c3b4fdd5ab230afe5783d4">00191</a> <span class="keywordtype">void</span> <a class="code" href="classSource__PDF__EF.html#aaa4001acc6c3b4fdd5ab230afe5783d4">Source_PDF_EF::rotate_imposed_velocity</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse_imposee)
<a name="l00192"></a>00192 {
<a name="l00193"></a>00193   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00194"></a>00194   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems= zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00195"></a>00195   <span class="keywordtype">int</span> nb_som_elem=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00196"></a>00196   <span class="keywordtype">int</span> nb_elem_tot=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00197"></a>00197   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rotation = <a class="code" href="classSource__PDF__base.html#aeaa31d63e32bd5e117186897c087b225">champ_rotation_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00198"></a>00198   <span class="keywordtype">int</span> nb_som_tot=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 <span class="comment">// COPIES</span>
<a name="l00202"></a>00202   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vitesse = vitesse_imposee;
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 <span class="comment">// vitesse_imposee.echange_espace_virtuel();</span>
<a name="l00205"></a>00205   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> marqueur=<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;vitesse&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l00206"></a>00206   vitesse_imposee = 0.;
<a name="l00207"></a>00207   marqueur = 0.;
<a name="l00208"></a>00208 
<a name="l00209"></a>00209   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elem_tot; num_elem++)
<a name="l00210"></a>00210     {
<a name="l00211"></a>00211       <span class="keywordtype">double</span> norm =  sqrt(rotation(num_elem,0)*rotation(num_elem,0)
<a name="l00212"></a>00212                           +rotation(num_elem,1)*rotation(num_elem,1)
<a name="l00213"></a>00213                           +rotation(num_elem,2)*rotation(num_elem,2)
<a name="l00214"></a>00214                           +rotation(num_elem,3)*rotation(num_elem,3)
<a name="l00215"></a>00215                           +rotation(num_elem,4)*rotation(num_elem,4)
<a name="l00216"></a>00216                           +rotation(num_elem,5)*rotation(num_elem,5)
<a name="l00217"></a>00217                           +rotation(num_elem,6)*rotation(num_elem,6)
<a name="l00218"></a>00218                           +rotation(num_elem,7)*rotation(num_elem,7)
<a name="l00219"></a>00219                           +rotation(num_elem,8)*rotation(num_elem,8));
<a name="l00220"></a>00220       <span class="keywordflow">if</span> (norm &gt; 1e-6)
<a name="l00221"></a>00221         {
<a name="l00222"></a>00222           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som_elem; i++)
<a name="l00223"></a>00223             {
<a name="l00224"></a>00224               <span class="keywordtype">int</span> s = elems(num_elem,i);
<a name="l00225"></a>00225               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;3; c++)
<a name="l00226"></a>00226                 {
<a name="l00227"></a>00227                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;3; k++)
<a name="l00228"></a>00228                     {
<a name="l00229"></a>00229                       vitesse_imposee(s,c) += rotation(num_elem,3*c+k)*vitesse(s,k);
<a name="l00230"></a>00230 <span class="comment">// Cerr &lt;&lt; &quot;k = &quot; &lt;&lt; k &lt;&lt; &quot;, c = &quot; &lt;&lt; c &lt;&lt; &quot;, 3*c+k = &quot; &lt;&lt; 3*c+k &lt;&lt; &quot;, rotation = &quot; &lt;&lt; rotation(num_elem,3*c+k) &lt;&lt; finl;</span>
<a name="l00231"></a>00231                     }
<a name="l00232"></a>00232                 }
<a name="l00233"></a>00233               marqueur(s,0) += 1.0;
<a name="l00234"></a>00234             }
<a name="l00235"></a>00235         }
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som_tot; i++)
<a name="l00238"></a>00238     {
<a name="l00239"></a>00239       <span class="keywordflow">if</span>(marqueur(i,0) &gt; 0.)
<a name="l00240"></a>00240         {
<a name="l00241"></a>00241           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;3; c++)
<a name="l00242"></a>00242             {
<a name="l00243"></a>00243               vitesse_imposee(i,c) /= marqueur(i,0);
<a name="l00244"></a>00244             }
<a name="l00245"></a>00245         }
<a name="l00246"></a>00246     }
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00249"></a><a class="code" href="classSource__PDF__EF.html#aabdff500a2a656841c37c4701a14c39b">00249</a> <span class="keywordtype">void</span> <a class="code" href="classSource__PDF__EF.html#aabdff500a2a656841c37c4701a14c39b">Source_PDF_EF::associer_zones</a>(<span class="keyword">const</span> <a class="code" href="classZone__dis.html" title="classe Zone_dis Classe generique de la hierarchie des zones discretisees. Un objet de type Zone_dis p...">Zone_dis</a>&amp; zone_dis,
<a name="l00250"></a>00250                                    <span class="keyword">const</span> <a class="code" href="classZone__Cl__dis.html" title="classe Zone_Cl_dis Classe generique de la hierarchie des conditions aux limites discretisees. Un objet Zone_Cl_dis peut referencer n&#39;importe quel derivant de Zone_Cl_dis_base. La plupart des methodes appellent les methodes de l&#39;objet Probleme sous-jacent via la methode valeur() declaree grace a la macro Declare_deriv().;">Zone_Cl_dis</a>&amp; zone_Cl_dis)
<a name="l00251"></a>00251 {
<a name="l00252"></a>00252   <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>, zone_dis.<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>());
<a name="l00253"></a>00253   <a class="code" href="classSource__PDF__EF.html#a5f877cd6d4e2b965cea9ca913f756013">la_zone_Cl_EF</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>, zone_Cl_dis.<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00254"></a>00254 }
<a name="l00255"></a>00255 
<a name="l00256"></a><a class="code" href="classSource__PDF__EF.html#aac107c1b5058326d873e2d0ed7a2ce67">00256</a> <a class="code" href="classDoubleVect.html">DoubleVect</a> <a class="code" href="classSource__PDF__EF.html#aac107c1b5058326d873e2d0ed7a2ce67">Source_PDF_EF::diag_coeff_elem</a>(<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; vitesse_elem, <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rotation, <span class="keywordtype">int</span> num_elem)<span class="keyword"> const</span>
<a name="l00257"></a>00257 <span class="keyword"></span>{
<a name="l00258"></a>00258   assert(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3);
<a name="l00259"></a>00259   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> tuvw(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00260"></a>00260 
<a name="l00261"></a>00261   tuvw = <a class="code" href="classSource__PDF__base.html#a928e50eace598b26dedaa35547ab517b">get_tuvw_local</a>();
<a name="l00262"></a>00262 
<a name="l00263"></a>00263   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> sum_dir_loc(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>) ;
<a name="l00264"></a>00264   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)
<a name="l00265"></a>00265     {
<a name="l00266"></a>00266       sum_dir_loc(i)=0.;
<a name="l00267"></a>00267       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; k++)
<a name="l00268"></a>00268         sum_dir_loc(i)+=rotation(num_elem,3*i+k);
<a name="l00269"></a>00269     }
<a name="l00270"></a>00270 
<a name="l00271"></a>00271   <a class="code" href="classDoubleVect.html">DoubleVect</a> diag_coef(dimension);
<a name="l00272"></a>00272   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00273"></a>00273     {
<a name="l00274"></a>00274       diag_coef(comp) = 0. ;
<a name="l00275"></a>00275       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; k++)
<a name="l00276"></a>00276         diag_coef(comp)+=tuvw(k)*sum_dir_loc(k)*rotation(num_elem,3*k+comp);
<a name="l00277"></a>00277     }
<a name="l00278"></a>00278 
<a name="l00279"></a>00279   <span class="keywordflow">return</span> diag_coef ;
<a name="l00280"></a>00280 }
<a name="l00281"></a>00281 
<a name="l00282"></a><a class="code" href="classSource__PDF__EF.html#a99f7323a69fdea85a515e8c91fa2bb9e">00282</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> <a class="code" href="classSource__PDF__EF.html#a99f7323a69fdea85a515e8c91fa2bb9e">Source_PDF_EF::compute_coeff_elem</a>()<span class="keyword"> const</span>
<a name="l00283"></a>00283 <span class="keyword"></span>{
<a name="l00284"></a>00284   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00285"></a>00285   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems= zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00286"></a>00286   <span class="keywordtype">int</span> nb_som_elem=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00287"></a>00287   <span class="keywordtype">int</span> nb_elems=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00288"></a>00288   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> vitesse_elem(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00289"></a>00289   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rotation=<a class="code" href="classSource__PDF__base.html#aeaa31d63e32bd5e117186897c087b225">champ_rotation_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00290"></a>00290   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; aire = <a class="code" href="classSource__PDF__base.html#a9820811d5e6b5e31a40e7564a16c1ce7">champ_aire_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00291"></a>00291 
<a name="l00292"></a>00292   <span class="keywordtype">int</span> dim_esp = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a> ;
<a name="l00293"></a>00293   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(nb_elems, dim_esp);
<a name="l00294"></a>00294 
<a name="l00295"></a>00295   <span class="keyword">const</span> <span class="keywordtype">double</span> dt_ref = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l00296"></a>00296   <span class="keyword">const</span> <span class="keywordtype">double</span> dt_min = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a38ad73d948a5c4e103e4e0b486356ab8" title="Renvoie le pas de temps minimum. (version const)">pas_temps_min</a>();
<a name="l00297"></a>00297   <span class="keywordtype">double</span> dt = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(dt_ref,dt_min);
<a name="l00298"></a>00298   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rho_m=<a class="code" href="classSource__PDF__base.html#a9fc1e064a50252b36c8e1d9228558190">champ_rho_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00299"></a>00299   <span class="keywordflow">if</span> (<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().probleme().schema_temps().temps_courant()==0)
<a name="l00300"></a>00300     {
<a name="l00301"></a>00301       dt = 1.0;
<a name="l00302"></a>00302     }
<a name="l00303"></a>00303 <span class="comment">// Cerr&lt;&lt;&quot;dt pour compute_coeff_elem : &quot;&lt;&lt; dt &lt;&lt;finl;</span>
<a name="l00304"></a>00304 
<a name="l00305"></a>00305   <span class="keywordtype">double</span> val_coeff ;
<a name="l00306"></a>00306   <a class="code" href="classDoubleVect.html">DoubleVect</a> val_diag_coef(dim_esp);
<a name="l00307"></a>00307   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elems; num_elem++)
<a name="l00308"></a>00308     {
<a name="l00309"></a>00309       <span class="keywordflow">if</span> (aire(num_elem)&lt;=0.)
<a name="l00310"></a>00310         {
<a name="l00311"></a>00311           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;dim_esp; comp++) <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(num_elem, comp) = 1. ;
<a name="l00312"></a>00312         }
<a name="l00313"></a>00313       <span class="keywordflow">else</span>
<a name="l00314"></a>00314         {
<a name="l00315"></a>00315           <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse=<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00316"></a>00316           vitesse_elem=0;
<a name="l00317"></a>00317           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=0; s&lt;nb_som_elem; s++)
<a name="l00318"></a>00318             {
<a name="l00319"></a>00319               <span class="keywordtype">int</span> som_glob=elems(num_elem,s);
<a name="l00320"></a>00320               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00321"></a>00321                 vitesse_elem(comp)+=vitesse(som_glob,comp);
<a name="l00322"></a>00322             }
<a name="l00323"></a>00323           val_coeff = <a class="code" href="classSource__PDF__base.html#a1a10dba92215d200d59139e1969af31a">fonct_coeff</a>(rho_m(num_elem), aire(num_elem), dt) ;
<a name="l00324"></a>00324           val_diag_coef = <a class="code" href="classSource__PDF__EF.html#aac107c1b5058326d873e2d0ed7a2ce67">diag_coeff_elem</a>(vitesse_elem, rotation, num_elem) ;
<a name="l00325"></a>00325           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;dim_esp; comp++)
<a name="l00326"></a>00326             <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(num_elem, comp) = 1.+ val_coeff * val_diag_coef(comp) * dt / rho_m(num_elem) ;
<a name="l00327"></a>00327         }
<a name="l00328"></a>00328     }
<a name="l00329"></a>00329   <span class="keywordflow">return</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
<a name="l00330"></a>00330 }
<a name="l00331"></a>00331 
<a name="l00332"></a><a class="code" href="classSource__PDF__EF.html#a8d42fe9ee8d1b5d08f5ce76c2f416e6e">00332</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> <a class="code" href="classSource__PDF__EF.html#a8d42fe9ee8d1b5d08f5ce76c2f416e6e">Source_PDF_EF::compute_coeff_matrice_pression</a>()<span class="keyword"> const</span>
<a name="l00333"></a>00333 <span class="keyword"></span>{
<a name="l00334"></a>00334   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00335"></a>00335   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems= zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00336"></a>00336   <span class="keywordtype">int</span> nb_som_elem=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00337"></a>00337   <span class="keywordtype">int</span> nb_elems=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00338"></a>00338   <span class="keywordtype">int</span> nb_som_tot=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
<a name="l00339"></a>00339   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> vitesse_elem(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00340"></a>00340   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rotation=<a class="code" href="classSource__PDF__base.html#aeaa31d63e32bd5e117186897c087b225">champ_rotation_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00341"></a>00341   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; aire = <a class="code" href="classSource__PDF__base.html#a9820811d5e6b5e31a40e7564a16c1ce7">champ_aire_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00342"></a>00342 
<a name="l00343"></a>00343   <span class="keywordtype">int</span> dim_esp = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a> ;
<a name="l00344"></a>00344   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse=<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00345"></a>00345   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(vitesse);
<a name="l00346"></a>00346   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> contrib(nb_som_tot, dim_esp);
<a name="l00347"></a>00347   contrib = 0;
<a name="l00348"></a>00348   coeff = 0.;
<a name="l00349"></a>00349 
<a name="l00350"></a>00350   <span class="keyword">const</span> <span class="keywordtype">double</span> dt_ref = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l00351"></a>00351   <span class="keyword">const</span> <span class="keywordtype">double</span> dt_min = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a38ad73d948a5c4e103e4e0b486356ab8" title="Renvoie le pas de temps minimum. (version const)">pas_temps_min</a>();
<a name="l00352"></a>00352   <span class="keywordtype">double</span> dt = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(dt_ref,dt_min);
<a name="l00353"></a>00353   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rho_m=<a class="code" href="classSource__PDF__base.html#a9fc1e064a50252b36c8e1d9228558190">champ_rho_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00354"></a>00354   <span class="keywordflow">if</span> (<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().probleme().schema_temps().temps_courant()==0)
<a name="l00355"></a>00355     {
<a name="l00356"></a>00356       dt = 1.0;
<a name="l00357"></a>00357     }
<a name="l00358"></a>00358 <span class="comment">// Cerr&lt;&lt;&quot;dt pour compute_coeff_matrice_pression : &quot;&lt;&lt; dt &lt;&lt;finl;</span>
<a name="l00359"></a>00359 
<a name="l00360"></a>00360   <span class="keywordtype">double</span> val_coeff ;
<a name="l00361"></a>00361   <a class="code" href="classDoubleVect.html">DoubleVect</a> val_diag_coef(dim_esp), coeff_el(dim_esp) ;
<a name="l00362"></a>00362   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elems; num_elem++)
<a name="l00363"></a>00363     {
<a name="l00364"></a>00364       <span class="keywordflow">if</span> (aire(num_elem)&lt;=0.)
<a name="l00365"></a>00365         {
<a name="l00366"></a>00366           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;dim_esp; comp++) coeff_el(comp) = 0. ;
<a name="l00367"></a>00367         }
<a name="l00368"></a>00368       <span class="keywordflow">else</span>
<a name="l00369"></a>00369         {
<a name="l00370"></a>00370           vitesse_elem=0.;
<a name="l00371"></a>00371           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=0; s&lt;nb_som_elem; s++)
<a name="l00372"></a>00372             {
<a name="l00373"></a>00373               <span class="keywordtype">int</span> som_glob=elems(num_elem,s);
<a name="l00374"></a>00374               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00375"></a>00375                 vitesse_elem(comp)+=vitesse(som_glob,comp);
<a name="l00376"></a>00376             }
<a name="l00377"></a>00377           val_coeff = <a class="code" href="classSource__PDF__base.html#a1a10dba92215d200d59139e1969af31a">fonct_coeff</a>(rho_m(num_elem), aire(num_elem), dt) ;
<a name="l00378"></a>00378           val_diag_coef = <a class="code" href="classSource__PDF__EF.html#aac107c1b5058326d873e2d0ed7a2ce67">diag_coeff_elem</a>(vitesse_elem, rotation, num_elem) ;
<a name="l00379"></a>00379           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;dim_esp; comp++)
<a name="l00380"></a>00380             coeff_el(comp) = val_coeff * val_diag_coef(comp) * dt / rho_m(num_elem) ;
<a name="l00381"></a>00381         }
<a name="l00382"></a>00382       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i&lt;nb_som_elem; i++)
<a name="l00383"></a>00383         {
<a name="l00384"></a>00384           <span class="keywordtype">int</span> s = elems(num_elem,i);
<a name="l00385"></a>00385           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;dim_esp; comp++)
<a name="l00386"></a>00386             {
<a name="l00387"></a>00387               <span class="keywordflow">if</span> (coeff_el(comp) &gt; 0.)
<a name="l00388"></a>00388                 {
<a name="l00389"></a>00389                   <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(s,comp)+= coeff_el(comp);
<a name="l00390"></a>00390                   contrib(s, comp) += 1;
<a name="l00391"></a>00391                 }
<a name="l00392"></a>00392             }
<a name="l00393"></a>00393         }
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396   <span class="keywordtype">double</span> val = 0.;
<a name="l00397"></a>00397   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = 0; s&lt;nb_som_tot; s++)
<a name="l00398"></a>00398     {
<a name="l00399"></a>00399       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;dim_esp; comp++)
<a name="l00400"></a>00400         {
<a name="l00401"></a>00401           val = 1.;
<a name="l00402"></a>00402           <span class="keywordflow">if</span> (contrib(s,comp) != 0)
<a name="l00403"></a>00403             {
<a name="l00404"></a>00404               val += <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(s,comp)/contrib(s,comp);
<a name="l00405"></a>00405             }
<a name="l00406"></a>00406           <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(s,comp) = val;
<a name="l00407"></a>00407         }
<a name="l00408"></a>00408     }
<a name="l00409"></a>00409   <span class="keywordflow">return</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
<a name="l00410"></a>00410 }
<a name="l00411"></a>00411 
<a name="l00412"></a><a class="code" href="classSource__PDF__EF.html#a30c8b65e88ea73d538b91b42b840ccfb">00412</a> <span class="keywordtype">void</span> <a class="code" href="classSource__PDF__EF.html#a30c8b65e88ea73d538b91b42b840ccfb">Source_PDF_EF::multiply_coeff_volume</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>)<span class="keyword"> const</span>
<a name="l00413"></a>00413 <span class="keyword"></span>{
<a name="l00414"></a>00414   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; vol_som=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>, <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>()).volumes_sommets_thilde();
<a name="l00415"></a>00415   <span class="keywordtype">int</span> n = vol_som.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l00416"></a>00416   <span class="keywordtype">int</span> ndim = coeff.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) ;
<a name="l00417"></a>00417   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00418"></a>00418     {
<a name="l00419"></a>00419       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;ndim; comp++) <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(i,comp) = <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(i,comp)*vol_som(i);
<a name="l00420"></a>00420     }
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a><a class="code" href="classSource__PDF__EF.html#aeea20a236fbb99fa30cd158787c0c28d">00423</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> <a class="code" href="classSource__PDF__EF.html#aeea20a236fbb99fa30cd158787c0c28d">Source_PDF_EF::compute_pond</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rho_m, <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; aire, <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volume_thilde, <span class="keywordtype">int</span>&amp; nb_som_elem, <span class="keywordtype">int</span>&amp; nb_elems)<span class="keyword"> const</span>
<a name="l00424"></a>00424 <span class="keyword"></span>{
<a name="l00425"></a>00425   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> pond = rho_m;
<a name="l00426"></a>00426   <span class="keywordtype">double</span> inv_nb_som = 1. / nb_som_elem;
<a name="l00427"></a>00427 
<a name="l00428"></a>00428   <span class="keyword">const</span> <span class="keywordtype">double</span> dt_ref = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l00429"></a>00429   <span class="keyword">const</span> <span class="keywordtype">double</span> dt_min = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a38ad73d948a5c4e103e4e0b486356ab8" title="Renvoie le pas de temps minimum. (version const)">pas_temps_min</a>();
<a name="l00430"></a>00430   <span class="keywordtype">double</span> dt = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(dt_ref,dt_min);
<a name="l00431"></a>00431   <span class="keywordflow">if</span> (<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().probleme().schema_temps().temps_courant()==0)
<a name="l00432"></a>00432     {
<a name="l00433"></a>00433       dt = 1.0;
<a name="l00434"></a>00434     }
<a name="l00435"></a>00435 
<a name="l00436"></a>00436   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elems; num_elem++)
<a name="l00437"></a>00437     {
<a name="l00438"></a>00438       pond(num_elem) = <a class="code" href="classSource__PDF__base.html#a1a10dba92215d200d59139e1969af31a">fonct_coeff</a>(rho_m(num_elem), aire(num_elem), dt) ;
<a name="l00439"></a>00439       pond(num_elem) *= volume_thilde(num_elem)*inv_nb_som*inv_nb_som;
<a name="l00440"></a>00440     }
<a name="l00441"></a>00441 
<a name="l00442"></a>00442   <span class="keywordflow">return</span> pond;
<a name="l00443"></a>00443 }
<a name="l00444"></a>00444 
<a name="l00445"></a>00445 <span class="comment">/*##################################################################################################</span>
<a name="l00446"></a>00446 <span class="comment">####################################################################################################</span>
<a name="l00447"></a>00447 <span class="comment">################################# TENSOR CALCULATION ###############################################</span>
<a name="l00448"></a>00448 <span class="comment">####################################################################################################</span>
<a name="l00449"></a>00449 <span class="comment">##################################################################################################*/</span>
<a name="l00450"></a>00450 
<a name="l00451"></a>00451 <span class="comment">/* static inline void calcul_vitesse_locale(const ArrOfDouble&amp; vitesse, ArrOfDouble&amp; vitesse_locale,const DoubleTab&amp; rotation,int elem)</span>
<a name="l00452"></a>00452 <span class="comment">{</span>
<a name="l00453"></a>00453 <span class="comment">  assert(Objet_U::dimension==3);</span>
<a name="l00454"></a>00454 <span class="comment">  // VL=rot*V</span>
<a name="l00455"></a>00455 <span class="comment">  // la matrice rotation est stockee comme un tabeau de taille 9 et non 3 3</span>
<a name="l00456"></a>00456 <span class="comment">  for (int i=0; i&lt;3; i++)</span>
<a name="l00457"></a>00457 <span class="comment">    {</span>
<a name="l00458"></a>00458 <span class="comment">      vitesse_locale(i)=0;</span>
<a name="l00459"></a>00459 <span class="comment">      for (int k=0; k&lt;3; k++)</span>
<a name="l00460"></a>00460 <span class="comment">        vitesse_locale(i)+=rotation(elem,3*i+k)*vitesse(k);</span>
<a name="l00461"></a>00461 <span class="comment">    }</span>
<a name="l00462"></a>00462 <span class="comment">  assert(est_egal(norme_array(vitesse_locale),norme_array(vitesse),1e-7));</span>
<a name="l00463"></a>00463 <span class="comment">} */</span>
<a name="l00464"></a>00464 
<a name="l00465"></a>00465 <span class="comment">/*##################################################################################################</span>
<a name="l00466"></a>00466 <span class="comment">####################################################################################################</span>
<a name="l00467"></a>00467 <span class="comment">################################# AJOUTER_ #########################################################</span>
<a name="l00468"></a>00468 <span class="comment">####################################################################################################</span>
<a name="l00469"></a>00469 <span class="comment">##################################################################################################*/</span>
<a name="l00470"></a>00470 
<a name="l00471"></a>00471 <span class="comment">/*</span>
<a name="l00472"></a>00472 <span class="comment">This function redirects toward the ajouter_ which correspond to the model chosen.</span>
<a name="l00473"></a>00473 <span class="comment">*/</span>
<a name="l00474"></a>00474 
<a name="l00475"></a><a class="code" href="classSource__PDF__EF.html#af598c8b23d6e91f31388ea40b1bb6239">00475</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classSource__PDF__EF.html#a425dd041e6f3604f1d7a8f0113ec2eec">Source_PDF_EF::ajouter_</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu, <span class="keyword">const</span> <span class="keywordtype">int</span> i_traitement_special)<span class="keyword"> const</span>
<a name="l00476"></a>00476 <span class="keyword"></span>{
<a name="l00477"></a>00477   <span class="comment">/* i_traitement_special = 0 =&gt; traitement classique; coefficient (1/eta) */</span>
<a name="l00478"></a>00478   <span class="comment">/* i_traitement_special = 1 =&gt; coefficient (1/eta -&gt; 1) */</span>
<a name="l00479"></a>00479   <span class="comment">/* i_traitement_special = 2 =&gt; coefficient (1/eta -&gt; 1 + 1/eta) */</span>
<a name="l00480"></a>00480 
<a name="l00481"></a>00481   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00482"></a>00482   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems= zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00483"></a>00483   <span class="keywordtype">int</span> nb_som_elem=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00484"></a>00484   <span class="keywordtype">int</span> nb_elems=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00485"></a>00485   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volume_thilde=zone_EF.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00486"></a>00486   <span class="keywordtype">int</span> ncomp=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00487"></a>00487   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> tuvw(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00488"></a>00488   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rotation=<a class="code" href="classSource__PDF__base.html#aeaa31d63e32bd5e117186897c087b225">champ_rotation_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00489"></a>00489   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; aire=<a class="code" href="classSource__PDF__base.html#a9820811d5e6b5e31a40e7564a16c1ce7">champ_aire_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00490"></a>00490   <a class="code" href="classChamp__Don.html" title="classe Champ_Don Classe generique de la hierarchie des champs donnes, un objet Champ_Don peut referen...">Champ_Don</a> rho_test;
<a name="l00491"></a>00491 <span class="comment">// champ_rho_.valeur().affecter(equation().probleme().get_champ(&quot;masse_volumique&quot;));</span>
<a name="l00492"></a>00492   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rho_m=<a class="code" href="classSource__PDF__base.html#a9fc1e064a50252b36c8e1d9228558190">champ_rho_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00493"></a>00493   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> pond;
<a name="l00494"></a>00494 
<a name="l00495"></a>00495   pond = <a class="code" href="classSource__PDF__EF.html#aeea20a236fbb99fa30cd158787c0c28d">compute_pond</a>(rho_m, aire, volume_thilde, nb_som_elem, nb_elems);
<a name="l00496"></a>00496 
<a name="l00497"></a>00497   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elems; num_elem++)
<a name="l00498"></a>00498     {
<a name="l00499"></a>00499       <span class="keywordflow">if</span> (aire(num_elem)&gt;0.)
<a name="l00500"></a>00500         {
<a name="l00501"></a>00501           <span class="keywordflow">if</span> (i_traitement_special == 0)
<a name="l00502"></a>00502             {
<a name="l00503"></a>00503               tuvw(0) =  1.0 / <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a6595cf9ce43a00e0274fc27ba1726cb5">eta_</a>;
<a name="l00504"></a>00504               tuvw(1) =  1.0 / <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a6595cf9ce43a00e0274fc27ba1726cb5">eta_</a>;
<a name="l00505"></a>00505               tuvw(2) =  1.0 / <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a6595cf9ce43a00e0274fc27ba1726cb5">eta_</a>;
<a name="l00506"></a>00506             }
<a name="l00507"></a>00507           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i_traitement_special == 1) <span class="comment">//terme temps en rho v</span>
<a name="l00508"></a>00508             {
<a name="l00509"></a>00509               tuvw(0) =  1.0;
<a name="l00510"></a>00510               tuvw(1) =  1.0;
<a name="l00511"></a>00511               tuvw(2) =  1.0;
<a name="l00512"></a>00512             }
<a name="l00513"></a>00513           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i_traitement_special == 101) <span class="comment">//terme temps en v</span>
<a name="l00514"></a>00514             {
<a name="l00515"></a>00515               tuvw(0) =  1.0 / rho_m(num_elem);
<a name="l00516"></a>00516               tuvw(1) =  1.0 / rho_m(num_elem);
<a name="l00517"></a>00517               tuvw(2) =  1.0 / rho_m(num_elem);
<a name="l00518"></a>00518             }
<a name="l00519"></a>00519           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i_traitement_special == 2)
<a name="l00520"></a>00520             {
<a name="l00521"></a>00521               tuvw(0) =  1.0 + 1.0 / <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a6595cf9ce43a00e0274fc27ba1726cb5">eta_</a>;
<a name="l00522"></a>00522               tuvw(1) =  1.0 + 1.0 / <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a6595cf9ce43a00e0274fc27ba1726cb5">eta_</a>;
<a name="l00523"></a>00523               tuvw(2) =  1.0 + 1.0 / <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a6595cf9ce43a00e0274fc27ba1726cb5">eta_</a>;
<a name="l00524"></a>00524             }
<a name="l00525"></a>00525           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i_traitement_special == 102)
<a name="l00526"></a>00526             {
<a name="l00527"></a>00527               tuvw(0) =  1.0 / rho_m(num_elem) + 1.0 / <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a6595cf9ce43a00e0274fc27ba1726cb5">eta_</a>;
<a name="l00528"></a>00528               tuvw(1) =  1.0 / rho_m(num_elem) + 1.0 / <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a6595cf9ce43a00e0274fc27ba1726cb5">eta_</a>;
<a name="l00529"></a>00529               tuvw(2) =  1.0 / rho_m(num_elem) + 1.0 / <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a6595cf9ce43a00e0274fc27ba1726cb5">eta_</a>;
<a name="l00530"></a>00530             }
<a name="l00531"></a>00531           <span class="keywordflow">else</span>
<a name="l00532"></a>00532             {
<a name="l00533"></a>00533               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Source_PDF_EF::ajouter_ : i_traitement_special should be 0, 1, 2, 101 or 102&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00534"></a>00534               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00535"></a>00535             }
<a name="l00536"></a>00536           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;ncomp; comp++)
<a name="l00537"></a>00537             {
<a name="l00538"></a>00538               <span class="keywordtype">double</span> tijvj=0;
<a name="l00539"></a>00539               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;ncomp; c++)
<a name="l00540"></a>00540                 {
<a name="l00541"></a>00541                   <span class="keywordtype">double</span> coeff_im=0;
<a name="l00542"></a>00542                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;ncomp; k++)
<a name="l00543"></a>00543                     {
<a name="l00544"></a>00544                       coeff_im+=rotation(num_elem,3*k+comp)*tuvw(k)*rotation(num_elem,3*k+c);
<a name="l00545"></a>00545                     }
<a name="l00546"></a>00546                   tijvj+=coeff_im ;
<a name="l00547"></a>00547                 }
<a name="l00548"></a>00548               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som_elem; i++)
<a name="l00549"></a>00549                 {
<a name="l00550"></a>00550                   resu(elems(num_elem,i),comp)-=pond(num_elem)*nb_som_elem*tijvj*vitesse(elems(num_elem,i),comp);
<a name="l00551"></a>00551                 }
<a name="l00552"></a>00552             }
<a name="l00553"></a>00553         }
<a name="l00554"></a>00554     }
<a name="l00555"></a>00555   <span class="keywordflow">return</span> resu;
<a name="l00556"></a>00556 }
<a name="l00557"></a>00557 
<a name="l00558"></a><a class="code" href="classSource__PDF__EF.html#a425dd041e6f3604f1d7a8f0113ec2eec">00558</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classSource__PDF__EF.html#a425dd041e6f3604f1d7a8f0113ec2eec">Source_PDF_EF::ajouter_</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00559"></a>00559 <span class="keyword"></span>{
<a name="l00560"></a>00560   <span class="keyword">const</span> <span class="keywordtype">int</span> i_traitement_special = 0 ;
<a name="l00561"></a>00561   <a class="code" href="classSource__PDF__EF.html#a425dd041e6f3604f1d7a8f0113ec2eec">ajouter_</a>(vitesse, resu, i_traitement_special) ;
<a name="l00562"></a>00562   <span class="keywordflow">return</span> resu;
<a name="l00563"></a>00563 }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 <span class="comment">/*##################################################################################################</span>
<a name="l00566"></a>00566 <span class="comment">####################################################################################################</span>
<a name="l00567"></a>00567 <span class="comment">################################# CONTRIBUER_A_AVEC ################################################</span>
<a name="l00568"></a>00568 <span class="comment">####################################################################################################</span>
<a name="l00569"></a>00569 <span class="comment">##################################################################################################*/</span>
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 <span class="comment">/*</span>
<a name="l00572"></a>00572 <span class="comment">This function redirects toward the contribuer_avec_ which correspond to the model chosen.</span>
<a name="l00573"></a>00573 <span class="comment">*/</span>
<a name="l00574"></a>00574 
<a name="l00575"></a><a class="code" href="classSource__PDF__EF.html#a2e662376774d319f960c50fb1655cfbf">00575</a> <span class="keywordtype">void</span>  <a class="code" href="classSource__PDF__EF.html#a2e662376774d319f960c50fb1655cfbf" title="contribution a la matrice implicite des termes sources par defaut pas de contribution">Source_PDF_EF::contribuer_a_avec</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice)<span class="keyword"> const</span>
<a name="l00576"></a>00576 <span class="keyword"></span>{
<a name="l00577"></a>00577   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00578"></a>00578   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems= zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00579"></a>00579   <span class="keywordtype">int</span> nb_som_elem=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00580"></a>00580   <span class="keywordtype">int</span> nb_elems=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00581"></a>00581   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volume_thilde=zone_EF.<a class="code" href="classZone__EF.html#abeb5a4c55016615d2fd1a4e4e07fcd58">volumes_thilde</a>();
<a name="l00582"></a>00582   <span class="keywordtype">int</span> ncomp=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00583"></a>00583   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> tuvw(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00584"></a>00584 <span class="comment">// const DoubleTab&amp; vitesse=equation().inconnue().valeurs();</span>
<a name="l00585"></a>00585   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rotation=<a class="code" href="classSource__PDF__base.html#aeaa31d63e32bd5e117186897c087b225">champ_rotation_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00586"></a>00586   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; aire=<a class="code" href="classSource__PDF__base.html#a9820811d5e6b5e31a40e7564a16c1ce7">champ_aire_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00587"></a>00587 <span class="comment">// champ_rho_.valeur().affecter(equation().probleme().get_champ(&quot;masse_volumique&quot;));</span>
<a name="l00588"></a>00588   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rho_m=<a class="code" href="classSource__PDF__base.html#a9fc1e064a50252b36c8e1d9228558190">champ_rho_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00589"></a>00589   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> pond ;
<a name="l00590"></a>00590 
<a name="l00591"></a>00591   pond = <a class="code" href="classSource__PDF__EF.html#aeea20a236fbb99fa30cd158787c0c28d">compute_pond</a>(rho_m, aire, volume_thilde, nb_som_elem, nb_elems);
<a name="l00592"></a>00592 
<a name="l00593"></a>00593   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elems; num_elem++) <span class="comment">//elements loop</span>
<a name="l00594"></a>00594     {
<a name="l00595"></a>00595       <span class="keywordflow">if</span> (aire(num_elem)&gt;0.)
<a name="l00596"></a>00596         {
<a name="l00597"></a>00597           tuvw(0) = 1.0 / <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a6595cf9ce43a00e0274fc27ba1726cb5">eta_</a>;
<a name="l00598"></a>00598           tuvw(1) = 1.0 / <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a6595cf9ce43a00e0274fc27ba1726cb5">eta_</a>;
<a name="l00599"></a>00599           tuvw(2) = 1.0 / <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a6595cf9ce43a00e0274fc27ba1726cb5">eta_</a>;
<a name="l00600"></a>00600 
<a name="l00601"></a>00601           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;ncomp; comp++)
<a name="l00602"></a>00602             {
<a name="l00603"></a>00603               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp2=0; comp2&lt;ncomp; comp2++)
<a name="l00604"></a>00604                 {
<a name="l00605"></a>00605                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som_elem; i++)
<a name="l00606"></a>00606                     {
<a name="l00607"></a>00607                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nb_som_elem; j++)
<a name="l00608"></a>00608                         {
<a name="l00609"></a>00609                           <span class="keywordtype">int</span> s1=elems(num_elem,i);
<a name="l00610"></a>00610 
<a name="l00611"></a>00611                           <span class="keywordtype">double</span> coeff_im=0;
<a name="l00612"></a>00612                           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;3; k++)
<a name="l00613"></a>00613                             {
<a name="l00614"></a>00614                               coeff_im+=rotation(num_elem,3*k+comp)*tuvw(k)*rotation(num_elem,3*k+comp2);
<a name="l00615"></a>00615                             }
<a name="l00616"></a>00616                           <span class="keywordtype">int</span> c1=s1*ncomp+comp;
<a name="l00617"></a>00617 
<a name="l00618"></a>00618                           matrice.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>(c1,c1)+=pond(num_elem)*coeff_im;
<a name="l00619"></a>00619                         }
<a name="l00620"></a>00620                     }
<a name="l00621"></a>00621                 }
<a name="l00622"></a>00622             }
<a name="l00623"></a>00623         }
<a name="l00624"></a>00624     }
<a name="l00625"></a>00625 <span class="comment">// verif_ajouter_contrib(vitesse, matrice) ;</span>
<a name="l00626"></a>00626 }
<a name="l00627"></a>00627 
<a name="l00628"></a><a class="code" href="classSource__PDF__EF.html#a76c1e0a362707e23190c0e78007f2258">00628</a> <span class="keywordtype">void</span>  <a class="code" href="classSource__PDF__EF.html#a76c1e0a362707e23190c0e78007f2258">Source_PDF_EF::verif_ajouter_contrib</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice)<span class="keyword"> const</span>
<a name="l00629"></a>00629 <span class="keyword"></span>{
<a name="l00630"></a>00630   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00631"></a>00631   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems= zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00632"></a>00632   <span class="keywordtype">int</span> nb_elems=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00633"></a>00633   <span class="keywordtype">int</span> nb_som_elem=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00634"></a>00634   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; aire=<a class="code" href="classSource__PDF__base.html#a9820811d5e6b5e31a40e7564a16c1ce7">champ_aire_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00635"></a>00635 
<a name="l00636"></a>00636   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> force(vitesse);
<a name="l00637"></a>00637   <a class="code" href="classSource__PDF__EF.html#a425dd041e6f3604f1d7a8f0113ec2eec">ajouter_</a>(vitesse,force);
<a name="l00638"></a>00638   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> force2(vitesse);
<a name="l00639"></a>00639   matrice.<a class="code" href="classMatrice__Morse.html#a46680c7fbcd8478a9fdc774914de2a53" title="Operation de multiplication-accumulation (saxpy) matrice vecteur. Operation: resu = resu + A*x...">ajouter_multvect_</a>(vitesse, force2) ;
<a name="l00640"></a>00640   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> diforce(force);
<a name="l00641"></a>00641   diforce += force2 ;
<a name="l00642"></a>00642   <span class="keywordtype">double</span> difmax = 0.;
<a name="l00643"></a>00643   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elems; num_elem++)
<a name="l00644"></a>00644     {
<a name="l00645"></a>00645       <span class="keywordflow">if</span> (aire(num_elem)&gt;0.)
<a name="l00646"></a>00646         {
<a name="l00647"></a>00647           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som_elem; i++)
<a name="l00648"></a>00648             {
<a name="l00649"></a>00649               <span class="keywordtype">int</span> s1=elems(num_elem,i);
<a name="l00650"></a>00650               <span class="keywordtype">double</span> difmod2 = diforce(s1,0)*diforce(s1,0) + diforce(s1,1)*diforce(s1,1) + diforce(s1,2)*diforce(s1,2);
<a name="l00651"></a>00651               <span class="keywordflow">if</span> (difmod2 &gt; 1.0e-5)
<a name="l00652"></a>00652                 {
<a name="l00653"></a>00653                   <span class="keywordflow">if</span> (difmod2 &gt; difmax) difmax = difmod2 ;
<a name="l00654"></a>00654 <span class="comment">// Cerr &lt;&lt; &quot; ajouter multvect diforce x = &quot;&lt;&lt; force(s1,0) &lt;&lt; &quot; &quot;&lt;&lt; force2(s1,0) &lt;&lt; &quot; &quot; &lt;&lt; diforce(s1,0)&lt;&lt;endl;</span>
<a name="l00655"></a>00655 <span class="comment">// Cerr &lt;&lt; &quot; ajouter multvect diforce y = &quot;&lt;&lt; force(s1,1) &lt;&lt; &quot; &quot;&lt;&lt; force2(s1,1) &lt;&lt; &quot; &quot; &lt;&lt; diforce(s1,1)&lt;&lt;endl;</span>
<a name="l00656"></a>00656 <span class="comment">// Cerr &lt;&lt; &quot; ajouter multvect diforce z = &quot;&lt;&lt; force(s1,2) &lt;&lt; &quot; &quot;&lt;&lt; force2(s1,2) &lt;&lt; &quot; &quot; &lt;&lt; diforce(s1,2)&lt;&lt;endl;</span>
<a name="l00657"></a>00657                 }
<a name="l00658"></a>00658             }
<a name="l00659"></a>00659         }
<a name="l00660"></a>00660     }
<a name="l00661"></a>00661   <span class="keywordflow">if</span> (difmax &gt; 0.)
<a name="l00662"></a>00662     {
<a name="l00663"></a>00663       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt; <span class="stringliteral">&quot;Source_PDF: Max norme caree diff. force absolue = &quot;</span>&lt;&lt;difmax&lt;&lt;endl;
<a name="l00664"></a>00664     }
<a name="l00665"></a>00665 }
<a name="l00666"></a>00666 
<a name="l00667"></a><a class="code" href="classSource__PDF__EF.html#af9561b4882fcd4abf6154d98bfd15bc6">00667</a> <span class="keywordtype">void</span> <a class="code" href="classSource__PDF__EF.html#af9561b4882fcd4abf6154d98bfd15bc6">Source_PDF_EF::calculer_vitesse_imposee_elem_fluid</a>()
<a name="l00668"></a>00668 {
<a name="l00669"></a>00669   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00670"></a>00670   <span class="keywordtype">int</span> nb_som=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();
<a name="l00671"></a>00671   <span class="keywordtype">int</span> nb_comp = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00672"></a>00672   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom = zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00673"></a>00673 <span class="comment">// const IntTab&amp; elems= zone_EF.zone().les_elems();</span>
<a name="l00674"></a>00674   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse_imposee_mod = <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a1c3a633cde662b1580c16fb3a03fa76f">vitesse_imposee_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00675"></a>00675   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse_imposee_calculee = <a class="code" href="classSource__PDF__base.html#af9c1db0d8c53f4a584c5dd7650039b8c">vitesse_imposee_</a>;
<a name="l00676"></a>00676   <a class="code" href="classInterpolation__IBM__elem__fluid.html" title=": class Interpolation_IBM_elem_fluid &lt;Description of class Interpolation_IBM_elem_fluid&gt;">Interpolation_IBM_elem_fluid</a>&amp; interp = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classInterpolation__IBM__elem__fluid.html" title=": class Interpolation_IBM_elem_fluid &lt;Description of class Interpolation_IBM_elem_fluid&gt;">Interpolation_IBM_elem_fluid</a>,<a class="code" href="classSource__PDF__base.html#a7b003f7d350e0a8055a38025e2aa862e">interpolation_lue_</a>.<a class="code" href="classDeriv__Interpolation__IBM__base.html#a4b312578d1125810c6c3211788d81be4">valeur</a>());
<a name="l00677"></a>00677   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; fluid_points = interp.<a class="code" href="classInterpolation__IBM__elem__fluid.html#a6a3f9e9f3131d7b01a2a657bfd3d4eae">fluid_points_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00678"></a>00678   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; solid_points = interp.<a class="code" href="classInterpolation__IBM__base.html#a1e94241f5f300dece3b98ec465304005">solid_points_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00679"></a>00679   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; fluid_elems = interp.<a class="code" href="classInterpolation__IBM__elem__fluid.html#a41b15f7dee67cffceb9929a672a50108">fluid_elems_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00680"></a>00680 
<a name="l00681"></a>00681   <a class="code" href="classChamp__Q1__EF.html">Champ_Q1_EF</a>&amp; champ_vitesse_inconnue = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Q1__EF.html">Champ_Q1_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().inconnue().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00682"></a>00682   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val_vitesse_inconnue = champ_vitesse_inconnue.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00683"></a>00683 
<a name="l00684"></a>00684   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> xf(1, nb_comp);
<a name="l00685"></a>00685   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vf(1, nb_comp);
<a name="l00686"></a>00686   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> cells(1);
<a name="l00687"></a>00687 
<a name="l00688"></a>00688   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_som; i++)
<a name="l00689"></a>00689     {
<a name="l00690"></a>00690       <span class="keywordflow">if</span> (fluid_elems(i) &gt;= 0.0)
<a name="l00691"></a>00691         {
<a name="l00692"></a>00692           <span class="keywordtype">double</span> d1 = 0.0;
<a name="l00693"></a>00693           <span class="keywordtype">double</span> d2 = 0.0;
<a name="l00694"></a>00694           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00695"></a>00695             {
<a name="l00696"></a>00696               <span class="keywordtype">double</span> xj = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(i,j);
<a name="l00697"></a>00697               <span class="keywordtype">double</span> xjf = fluid_points(i,j);
<a name="l00698"></a>00698               xf(0, j) = xjf;
<a name="l00699"></a>00699               <span class="keywordtype">double</span> xjs = solid_points(i,j);
<a name="l00700"></a>00700               d1 += (xj-xjs)*(xj-xjs);
<a name="l00701"></a>00701               d2 += (xjf-xj)*(xjf-xj);
<a name="l00702"></a>00702             }
<a name="l00703"></a>00703           d1 = sqrt(d1);
<a name="l00704"></a>00704           d2 = sqrt(d2);
<a name="l00705"></a>00705           <span class="keywordtype">double</span> inv_d = 1.0 / (d1 + d2);
<a name="l00706"></a>00706           cells(0) = int(fluid_elems(i));
<a name="l00707"></a>00707           champ_vitesse_inconnue.<a class="code" href="classChamp__implementation__Q1.html#a998df4075455bae029ec5705510ff258">value_interpolation</a>(xf,cells, val_vitesse_inconnue, vf);
<a name="l00708"></a>00708           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00709"></a>00709             {
<a name="l00710"></a>00710               <span class="keywordtype">double</span> vjs = vitesse_imposee_mod(i,j);
<a name="l00711"></a>00711               vitesse_imposee_calculee(i,j) = vjs + (vf(0, j)-vjs)*inv_d*d1;
<a name="l00712"></a>00712             }
<a name="l00713"></a>00713         }
<a name="l00714"></a>00714       <span class="keywordflow">else</span>
<a name="l00715"></a>00715         {
<a name="l00716"></a>00716           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00717"></a>00717             {
<a name="l00718"></a>00718               vitesse_imposee_calculee(i,j) = vitesse_imposee_mod(i,j);
<a name="l00719"></a>00719             }
<a name="l00720"></a>00720         }
<a name="l00721"></a>00721     }
<a name="l00722"></a>00722 <span class="comment">// vitesse_imposee_calculee.echange_espace_virtuel();</span>
<a name="l00723"></a>00723 }
<a name="l00724"></a>00724 
<a name="l00725"></a><a class="code" href="classSource__PDF__EF.html#aefd56399b05cef14061eefbd18c10b5b">00725</a> <span class="keywordtype">void</span> <a class="code" href="classSource__PDF__EF.html#aefd56399b05cef14061eefbd18c10b5b">Source_PDF_EF::calculer_vitesse_imposee_mean_grad</a>()
<a name="l00726"></a>00726 {
<a name="l00727"></a>00727   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00728"></a>00728   <span class="keywordtype">int</span> nb_som=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();
<a name="l00729"></a>00729   <span class="keywordtype">int</span> nb_comp = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00730"></a>00730   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom = zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00731"></a>00731 <span class="comment">// const IntTab&amp; elems= zone_EF.zone().les_elems();</span>
<a name="l00732"></a>00732   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse_imposee_mod = <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a1c3a633cde662b1580c16fb3a03fa76f">vitesse_imposee_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00733"></a>00733   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse_imposee_calculee = <a class="code" href="classSource__PDF__base.html#af9c1db0d8c53f4a584c5dd7650039b8c">vitesse_imposee_</a>;
<a name="l00734"></a>00734   <a class="code" href="classInterpolation__IBM__mean__gradient.html" title=": class Interpolation_IBM_mean_gradient &lt;Description of class Interpolation_IBM_mean_gradient&gt;">Interpolation_IBM_mean_gradient</a>&amp; interp = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classInterpolation__IBM__mean__gradient.html" title=": class Interpolation_IBM_mean_gradient &lt;Description of class Interpolation_IBM_mean_gradient&gt;">Interpolation_IBM_mean_gradient</a>,<a class="code" href="classSource__PDF__base.html#a7b003f7d350e0a8055a38025e2aa862e">interpolation_lue_</a>.<a class="code" href="classDeriv__Interpolation__IBM__base.html#a4b312578d1125810c6c3211788d81be4">valeur</a>());
<a name="l00735"></a>00735   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; solid_points = interp.<a class="code" href="classInterpolation__IBM__base.html#a1e94241f5f300dece3b98ec465304005">solid_points_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00736"></a>00736   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; is_dirichlet = interp.<a class="code" href="classInterpolation__IBM__mean__gradient__proto.html#a50fd687dc3011ee4165e5df166ca1b20">is_dirichlet_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00737"></a>00737   <span class="keywordtype">double</span> eps = 1e-12;
<a name="l00738"></a>00738   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse_inconnue = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>().<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00739"></a>00739 
<a name="l00740"></a>00740   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_som; i++)
<a name="l00741"></a>00741     {
<a name="l00742"></a>00742       <span class="keywordflow">if</span> (is_dirichlet(i) &gt; 0.0)
<a name="l00743"></a>00743         {
<a name="l00744"></a>00744           <span class="keywordtype">double</span> d2 = 0.0;
<a name="l00745"></a>00745           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00746"></a>00746             {
<a name="l00747"></a>00747               vitesse_imposee_calculee(i,j) = vitesse_imposee_mod(i,j);
<a name="l00748"></a>00748               <span class="keywordtype">double</span> x = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(i,j);
<a name="l00749"></a>00749               <span class="keywordtype">double</span> xp = solid_points(i,j);
<a name="l00750"></a>00750               d2 += (x - xp)*(x - xp);
<a name="l00751"></a>00751             }
<a name="l00752"></a>00752           d2 = sqrt(d2);
<a name="l00753"></a>00753           <span class="keywordflow">if</span> (d2 &gt; eps)
<a name="l00754"></a>00754             {
<a name="l00755"></a>00755               <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a>&amp; voisins = interp.<a class="code" href="classInterpolation__IBM__mean__gradient__proto.html#a0d659d09a0051a6cc22c4e5545c24c2a">getSommetsVoisinsOf</a>(i);
<a name="l00756"></a>00756               <span class="keywordflow">if</span> (!(voisins.<a class="code" href="classIntListElem.html#ab51c7ccf0b6cafff507e631d4203b5bd" title="renvoie 1 si la liste est vide renvoie 0 sinon.">est_vide</a>()))
<a name="l00757"></a>00757                 {
<a name="l00758"></a>00758                   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> mean_grad(nb_comp);
<a name="l00759"></a>00759                   mean_grad = 0.0;
<a name="l00760"></a>00760                   <span class="keywordtype">int</span> taille = voisins.<a class="code" href="classIntList.html#ae8b23a7b17410d1e0bdcc20da0594f9b" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>();
<a name="l00761"></a>00761                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; taille; k++)
<a name="l00762"></a>00762                     {
<a name="l00763"></a>00763                       <span class="keywordtype">int</span> num_som = voisins[k];
<a name="l00764"></a>00764                       <span class="keywordtype">double</span> d1 = 0.0;
<a name="l00765"></a>00765                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00766"></a>00766                         {
<a name="l00767"></a>00767                           <span class="keywordtype">double</span> xf = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(num_som,j);
<a name="l00768"></a>00768                           <span class="keywordtype">double</span> xpf = solid_points(num_som,j);
<a name="l00769"></a>00769                           d1 += (xf - xpf)*(xf - xpf);
<a name="l00770"></a>00770                         }
<a name="l00771"></a>00771                       d1 = sqrt(d1);
<a name="l00772"></a>00772                       <span class="keywordflow">if</span> (d1 &gt; eps)
<a name="l00773"></a>00773                         {
<a name="l00774"></a>00774                           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00775"></a>00775                             {
<a name="l00776"></a>00776                               <span class="keywordtype">double</span> vpf = vitesse_imposee_mod(num_som,j);
<a name="l00777"></a>00777                               <span class="keywordtype">double</span> vf = vitesse_inconnue(num_som,j);
<a name="l00778"></a>00778                               mean_grad(j) += (vf - vpf)/d1;
<a name="l00779"></a>00779                             }
<a name="l00780"></a>00780                         }
<a name="l00781"></a>00781                     }
<a name="l00782"></a>00782                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00783"></a>00783                     {
<a name="l00784"></a>00784                       mean_grad(j) /= taille;
<a name="l00785"></a>00785                       vitesse_imposee_calculee(i,j) += mean_grad(j)*d2;
<a name="l00786"></a>00786                     }
<a name="l00787"></a>00787                 }
<a name="l00788"></a>00788             }
<a name="l00789"></a>00789         }
<a name="l00790"></a>00790     }
<a name="l00791"></a>00791 <span class="comment">// vitesse_imposee_calculee.echange_espace_virtuel();</span>
<a name="l00792"></a>00792 }
<a name="l00793"></a>00793 
<a name="l00794"></a><a class="code" href="classSource__PDF__EF.html#aaa86b7045ba2dce8e6ffbc7d660de24f">00794</a> <span class="keywordtype">void</span> <a class="code" href="classSource__PDF__EF.html#aaa86b7045ba2dce8e6ffbc7d660de24f">Source_PDF_EF::calculer_vitesse_imposee_hybrid</a>()
<a name="l00795"></a>00795 {
<a name="l00796"></a>00796   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00797"></a>00797   <span class="keywordtype">int</span> nb_som=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();
<a name="l00798"></a>00798   <span class="keywordtype">int</span> nb_comp = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00799"></a>00799   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom = zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00800"></a>00800 <span class="comment">// const IntTab&amp; elems= zone_EF.zone().les_elems();</span>
<a name="l00801"></a>00801   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse_imposee_mod = <a class="code" href="classSource__PDF__base.html#ac0a8f8ec0725e0eacd5c865cda2c40bc">modele_lu_</a>.<a class="code" href="classPDF__model.html#a1c3a633cde662b1580c16fb3a03fa76f">vitesse_imposee_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00802"></a>00802   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse_imposee_calculee = <a class="code" href="classSource__PDF__base.html#af9c1db0d8c53f4a584c5dd7650039b8c">vitesse_imposee_</a>;
<a name="l00803"></a>00803   <a class="code" href="classInterpolation__IBM__hybrid.html" title=": class Interpolation_IBM_hybrid &lt;Description of class Interpolation_IBM_hybrid&gt;">Interpolation_IBM_hybrid</a>&amp; interp = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classInterpolation__IBM__hybrid.html" title=": class Interpolation_IBM_hybrid &lt;Description of class Interpolation_IBM_hybrid&gt;">Interpolation_IBM_hybrid</a>,<a class="code" href="classSource__PDF__base.html#a7b003f7d350e0a8055a38025e2aa862e">interpolation_lue_</a>.<a class="code" href="classDeriv__Interpolation__IBM__base.html#a4b312578d1125810c6c3211788d81be4">valeur</a>());
<a name="l00804"></a>00804   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; solid_points = interp.<a class="code" href="classInterpolation__IBM__base.html#a1e94241f5f300dece3b98ec465304005">solid_points_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00805"></a>00805   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; fluid_elems = interp.<a class="code" href="classInterpolation__IBM__elem__fluid.html#a41b15f7dee67cffceb9929a672a50108">fluid_elems_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00806"></a>00806   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; fluid_points = interp.<a class="code" href="classInterpolation__IBM__elem__fluid.html#a6a3f9e9f3131d7b01a2a657bfd3d4eae">fluid_points_</a>.<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00807"></a>00807   <span class="keywordtype">double</span> eps = 1e-12;
<a name="l00808"></a>00808   <a class="code" href="classChamp__Q1__EF.html">Champ_Q1_EF</a>&amp; champ_vitesse_inconnue = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Q1__EF.html">Champ_Q1_EF</a>,<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().inconnue().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00809"></a>00809   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse_inconnue = champ_vitesse_inconnue.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00810"></a>00810 
<a name="l00811"></a>00811   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> xf(1, nb_comp);
<a name="l00812"></a>00812   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vf(1, nb_comp);
<a name="l00813"></a>00813   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> cells(1);
<a name="l00814"></a>00814 
<a name="l00815"></a>00815   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_som; i++)
<a name="l00816"></a>00816     {
<a name="l00817"></a>00817       <span class="keywordflow">if</span> (fluid_elems(i) &gt;= 0.0)
<a name="l00818"></a>00818         {
<a name="l00819"></a>00819           <span class="keywordtype">double</span> d1 = 0.0;
<a name="l00820"></a>00820           <span class="keywordtype">double</span> d2 = 0.0;
<a name="l00821"></a>00821           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00822"></a>00822             {
<a name="l00823"></a>00823               <span class="keywordtype">double</span> xj = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(i,j);
<a name="l00824"></a>00824               <span class="keywordtype">double</span> xjf = fluid_points(i,j);
<a name="l00825"></a>00825               xf(0, j) = xjf;
<a name="l00826"></a>00826               <span class="keywordtype">double</span> xjs = solid_points(i,j);
<a name="l00827"></a>00827               d1 += (xj-xjs)*(xj-xjs);
<a name="l00828"></a>00828               d2 += (xjf-xj)*(xjf-xj);
<a name="l00829"></a>00829             }
<a name="l00830"></a>00830           d1 = sqrt(d1);
<a name="l00831"></a>00831           d2 = sqrt(d2);
<a name="l00832"></a>00832           <span class="keywordtype">double</span> inv_d = 1.0 / (d1 + d2);
<a name="l00833"></a>00833           cells(0) = int(fluid_elems(i));
<a name="l00834"></a>00834           champ_vitesse_inconnue.<a class="code" href="classChamp__implementation__Q1.html#a998df4075455bae029ec5705510ff258">value_interpolation</a>(xf,cells, vitesse_inconnue, vf);
<a name="l00835"></a>00835           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00836"></a>00836             {
<a name="l00837"></a>00837               <span class="keywordtype">double</span> vjs = vitesse_imposee_mod(i,j);
<a name="l00838"></a>00838               vitesse_imposee_calculee(i,j) = vitesse_imposee_mod(i,j) + (vf(0, j)-vjs)*inv_d*d1;
<a name="l00839"></a>00839             }
<a name="l00840"></a>00840         }
<a name="l00841"></a>00841       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fluid_elems(i) &gt; -1.5 &amp;&amp; fluid_elems(i) &lt; -0.5)
<a name="l00842"></a>00842         {
<a name="l00843"></a>00843           <span class="keywordtype">double</span> d2 = 0.0;
<a name="l00844"></a>00844           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00845"></a>00845             {
<a name="l00846"></a>00846               vitesse_imposee_calculee(i,j) = vitesse_imposee_mod(i,j);
<a name="l00847"></a>00847               <span class="keywordtype">double</span> x = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(i,j);
<a name="l00848"></a>00848               <span class="keywordtype">double</span> xp = solid_points(i,j);
<a name="l00849"></a>00849               d2 += (x - xp)*(x - xp);
<a name="l00850"></a>00850             }
<a name="l00851"></a>00851           d2 = sqrt(d2);
<a name="l00852"></a>00852           <span class="keywordflow">if</span> (d2 &gt; eps)
<a name="l00853"></a>00853             {
<a name="l00854"></a>00854               <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a>&amp; voisins = interp.<a class="code" href="classInterpolation__IBM__mean__gradient__proto.html#a0d659d09a0051a6cc22c4e5545c24c2a">getSommetsVoisinsOf</a>(i);
<a name="l00855"></a>00855               <span class="keywordflow">if</span> (!(voisins.<a class="code" href="classIntListElem.html#ab51c7ccf0b6cafff507e631d4203b5bd" title="renvoie 1 si la liste est vide renvoie 0 sinon.">est_vide</a>()))
<a name="l00856"></a>00856                 {
<a name="l00857"></a>00857                   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> mean_grad(nb_comp);
<a name="l00858"></a>00858                   mean_grad = 0.0;
<a name="l00859"></a>00859                   <span class="keywordtype">int</span> taille = voisins.<a class="code" href="classIntList.html#ae8b23a7b17410d1e0bdcc20da0594f9b" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>();
<a name="l00860"></a>00860                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; taille; k++)
<a name="l00861"></a>00861                     {
<a name="l00862"></a>00862                       <span class="keywordtype">int</span> num_som = voisins[k];
<a name="l00863"></a>00863                       <span class="keywordtype">double</span> d1 = 0.0;
<a name="l00864"></a>00864                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00865"></a>00865                         {
<a name="l00866"></a>00866                           <span class="keywordtype">double</span> xjf = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(num_som,j);
<a name="l00867"></a>00867                           <span class="keywordtype">double</span> xpf = solid_points(num_som,j);
<a name="l00868"></a>00868                           d1 += (xjf - xpf)*(xjf - xpf);
<a name="l00869"></a>00869                         }
<a name="l00870"></a>00870                       d1 = sqrt(d1);
<a name="l00871"></a>00871                       <span class="keywordflow">if</span> (d1 &gt; eps)
<a name="l00872"></a>00872                         {
<a name="l00873"></a>00873                           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00874"></a>00874                             {
<a name="l00875"></a>00875                               <span class="keywordtype">double</span> vpf = vitesse_imposee_mod(num_som,j);
<a name="l00876"></a>00876                               <span class="keywordtype">double</span> vjf = vitesse_inconnue(num_som,j);
<a name="l00877"></a>00877                               mean_grad(j) += (vjf - vpf)/d1;
<a name="l00878"></a>00878                             }
<a name="l00879"></a>00879                         }
<a name="l00880"></a>00880                     }
<a name="l00881"></a>00881                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00882"></a>00882                     {
<a name="l00883"></a>00883                       mean_grad(j) /= taille;
<a name="l00884"></a>00884                       vitesse_imposee_calculee(i,j) += mean_grad(j)*d2;
<a name="l00885"></a>00885                     }
<a name="l00886"></a>00886                 }
<a name="l00887"></a>00887             }
<a name="l00888"></a>00888         }
<a name="l00889"></a>00889       <span class="keywordflow">else</span>
<a name="l00890"></a>00890         {
<a name="l00891"></a>00891           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = 0; j &lt; nb_comp; j++)
<a name="l00892"></a>00892             {
<a name="l00893"></a>00893               vitesse_imposee_calculee(i,j) = vitesse_imposee_mod(i,j);
<a name="l00894"></a>00894             }
<a name="l00895"></a>00895         }
<a name="l00896"></a>00896     }
<a name="l00897"></a>00897 <span class="comment">// vitesse_imposee_calculee.echange_espace_virtuel();</span>
<a name="l00898"></a>00898 }
<a name="l00899"></a>00899 
<a name="l00900"></a><a class="code" href="classSource__PDF__EF.html#a0734cc40e439411577cdc67ac0a4f976">00900</a> <span class="keywordtype">void</span> <a class="code" href="classSource__PDF__EF.html#a0734cc40e439411577cdc67ac0a4f976">Source_PDF_EF::correct_incr_pressure</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coeff_node, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; correction_en_pression)<span class="keyword"> const</span>
<a name="l00901"></a>00901 <span class="keyword"></span>{
<a name="l00902"></a>00902   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; aire=<a class="code" href="classSource__PDF__base.html#a9820811d5e6b5e31a40e7564a16c1ce7">champ_aire_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00903"></a>00903   <span class="keywordtype">int</span> nb_elem = correction_en_pression.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l00904"></a>00904 
<a name="l00905"></a>00905   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00906"></a>00906   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems= zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00907"></a>00907   <span class="keywordtype">int</span> nb_som_elem=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00908"></a>00908   <span class="keywordtype">int</span> ncomp = coeff_node.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) ;
<a name="l00909"></a>00909   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> coef_elem(nb_elem);
<a name="l00910"></a>00910 
<a name="l00911"></a>00911   <span class="keyword">const</span> <a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>&amp; la_zone_cl = <a class="code" href="classSource__PDF__EF.html#a5f877cd6d4e2b965cea9ca913f756013">la_zone_Cl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>();
<a name="l00912"></a>00912   <span class="keywordtype">int</span> nb_cond_lim = la_zone_cl.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
<a name="l00913"></a>00913   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_sommets=zone_EF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l00914"></a>00914   <span class="keywordtype">int</span> nb_som_face=faces_sommets.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00915"></a>00915   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> flag_cl(coeff_node);
<a name="l00916"></a>00916   flag_cl = 1.;
<a name="l00917"></a>00917   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ij=0; ij&lt;nb_cond_lim; ij++)
<a name="l00918"></a>00918     {
<a name="l00919"></a>00919       <span class="keyword">const</span> <a class="code" href="classCond__lim__base.html" title="classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...">Cond_lim_base</a>&amp; la_cl_base = la_zone_cl.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(ij).<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>();
<a name="l00920"></a>00920       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_zone_cl.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(ij).<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00921"></a>00921       <span class="keywordtype">int</span> nfaces = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00922"></a>00922       <span class="keywordflow">if</span> <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl_base)
<a name="l00923"></a>00923         {
<a name="l00924"></a>00924           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face &lt; nfaces; ind_face++)
<a name="l00925"></a>00925             {
<a name="l00926"></a>00926               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=0; s&lt;nb_som_face; s++)
<a name="l00927"></a>00927                 {
<a name="l00928"></a>00928                   <span class="keywordtype">int</span> face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00929"></a>00929                   <span class="keywordtype">int</span> som=faces_sommets(face,s);
<a name="l00930"></a>00930                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;ncomp; comp++) flag_cl(som,comp) = 0. ;
<a name="l00931"></a>00931                 }
<a name="l00932"></a>00932             }
<a name="l00933"></a>00933         }
<a name="l00934"></a>00934     }
<a name="l00935"></a>00935   la_zone_cl.<a class="code" href="classZone__Cl__EF.html#a10696e08ab5fb42ca5948b732f2455f3" title="Impose les conditions de symetrie c.a.d annules les composantes du champ sur la ou les normales si to...">imposer_symetrie</a>(flag_cl,0);
<a name="l00936"></a>00936 <span class="comment">// int nb_som=zone_EF.zone().nb_som();</span>
<a name="l00937"></a>00937 <span class="comment">// for(int som=0; som&lt;nb_som; som++)Cerr&lt;&lt;&quot;som flag_c = &quot;&lt;&lt;som&lt;&lt;&quot; &quot;&lt;&lt;flag_cl(som,0)&lt;&lt;&quot; &quot;&lt;&lt;flag_cl(som,1)&lt;&lt;&quot; &quot;&lt;&lt;flag_cl(som,2)&lt;&lt;finl;</span>
<a name="l00938"></a>00938 
<a name="l00939"></a>00939   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elem; num_elem++)
<a name="l00940"></a>00940     {
<a name="l00941"></a>00941       <span class="keywordflow">if</span> (aire(num_elem)&gt;0.)
<a name="l00942"></a>00942         {
<a name="l00943"></a>00943           correction_en_pression(num_elem) = 0.;
<a name="l00944"></a>00944         }
<a name="l00945"></a>00945       <span class="keywordflow">else</span>
<a name="l00946"></a>00946         {
<a name="l00947"></a>00947           coef_elem(num_elem) = 0. ;
<a name="l00948"></a>00948           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som_elem; i++)
<a name="l00949"></a>00949             {
<a name="l00950"></a>00950               <span class="keywordtype">int</span> sii=elems(num_elem,i);
<a name="l00951"></a>00951               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;ncomp; comp++)
<a name="l00952"></a>00952                 {
<a name="l00953"></a>00953                   <span class="keywordflow">if</span> ((coeff_node(sii,comp)!= 1.0) || (flag_cl(sii,comp) != 1.0)) coef_elem(num_elem) += 1. ;
<a name="l00954"></a>00954                 }
<a name="l00955"></a>00955             }
<a name="l00956"></a>00956           <span class="keywordflow">if</span> (coef_elem(num_elem) == (ncomp*nb_som_elem)) correction_en_pression(num_elem) = 0.;
<a name="l00957"></a>00957         }
<a name="l00958"></a>00958     }
<a name="l00959"></a>00959 }
<a name="l00960"></a>00960 
<a name="l00961"></a><a class="code" href="classSource__PDF__EF.html#af8e50ff3d3f54a3920fff9e66c26a542">00961</a> <span class="keywordtype">void</span> <a class="code" href="classSource__PDF__EF.html#af8e50ff3d3f54a3920fff9e66c26a542">Source_PDF_EF::correct_pressure</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coeff_node, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pression, <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; correction_en_pression)<span class="keyword"> const</span>
<a name="l00962"></a>00962 <span class="keyword"></span>{
<a name="l00963"></a>00963   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; aire=<a class="code" href="classSource__PDF__base.html#a9820811d5e6b5e31a40e7564a16c1ce7">champ_aire_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00964"></a>00964   <span class="keywordtype">int</span> nb_elem = pression.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l00965"></a>00965 
<a name="l00966"></a>00966   <span class="keyword">const</span> <a class="code" href="classZone__EF.html" title="class Zone_EF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geome...">Zone_EF</a>&amp; zone_EF = <a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>();
<a name="l00967"></a>00967   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elems= zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00968"></a>00968   <span class="keywordtype">int</span> nb_som_elem=zone_EF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00969"></a>00969   <span class="keywordtype">int</span> ncomp = coeff_node.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) ;
<a name="l00970"></a>00970   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> coef_elem(nb_elem);
<a name="l00971"></a>00971 
<a name="l00972"></a>00972   <span class="keyword">const</span> <a class="code" href="classZone__Cl__EF.html">Zone_Cl_EF</a>&amp; la_zone_cl = <a class="code" href="classSource__PDF__EF.html#a5f877cd6d4e2b965cea9ca913f756013">la_zone_Cl_EF</a>.<a class="code" href="classRef__Zone__Cl__EF.html#a138abe771b80d779394788c6e093ec5c">valeur</a>();
<a name="l00973"></a>00973   <span class="keywordtype">int</span> nb_cond_lim = la_zone_cl.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
<a name="l00974"></a>00974   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_sommets=zone_EF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l00975"></a>00975   <span class="keywordtype">int</span> nb_som_face=faces_sommets.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00976"></a>00976   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> flag_cl(coeff_node);
<a name="l00977"></a>00977   flag_cl = 1.;
<a name="l00978"></a>00978   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ij=0; ij&lt;nb_cond_lim; ij++)
<a name="l00979"></a>00979     {
<a name="l00980"></a>00980       <span class="keyword">const</span> <a class="code" href="classCond__lim__base.html" title="classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...">Cond_lim_base</a>&amp; la_cl_base = la_zone_cl.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(ij).<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>();
<a name="l00981"></a>00981       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_zone_cl.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(ij).<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00982"></a>00982       <span class="keywordtype">int</span> nfaces = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<a name="l00983"></a>00983       <span class="keywordflow">if</span> <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl_base)
<a name="l00984"></a>00984         {
<a name="l00985"></a>00985           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face &lt; nfaces; ind_face++)
<a name="l00986"></a>00986             {
<a name="l00987"></a>00987               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=0; s&lt;nb_som_face; s++)
<a name="l00988"></a>00988                 {
<a name="l00989"></a>00989                   <span class="keywordtype">int</span> face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
<a name="l00990"></a>00990                   <span class="keywordtype">int</span> som=faces_sommets(face,s);
<a name="l00991"></a>00991                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;ncomp; comp++) flag_cl(som,comp) = 0. ;
<a name="l00992"></a>00992                 }
<a name="l00993"></a>00993             }
<a name="l00994"></a>00994         }
<a name="l00995"></a>00995     }
<a name="l00996"></a>00996   la_zone_cl.<a class="code" href="classZone__Cl__EF.html#a10696e08ab5fb42ca5948b732f2455f3" title="Impose les conditions de symetrie c.a.d annules les composantes du champ sur la ou les normales si to...">imposer_symetrie</a>(flag_cl,0);
<a name="l00997"></a>00997 
<a name="l00998"></a>00998   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elem; num_elem++)
<a name="l00999"></a>00999     {
<a name="l01000"></a>01000       <span class="keywordflow">if</span> (aire(num_elem)&lt;=0.)
<a name="l01001"></a>01001         {
<a name="l01002"></a>01002           coef_elem(num_elem) = 0. ;
<a name="l01003"></a>01003           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som_elem; i++)
<a name="l01004"></a>01004             {
<a name="l01005"></a>01005               <span class="keywordtype">int</span> sii=elems(num_elem,i);
<a name="l01006"></a>01006               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;ncomp; comp++)
<a name="l01007"></a>01007                 {
<a name="l01008"></a>01008                   <span class="keywordflow">if</span> ((coeff_node(sii,comp)!= 1.0) || (flag_cl(sii,comp) != 1.0)) coef_elem(num_elem) += 1. ;
<a name="l01009"></a>01009                 }
<a name="l01010"></a>01010             }
<a name="l01011"></a>01011           <span class="keywordflow">if</span> (coef_elem(num_elem) != (ncomp*nb_som_elem)) pression(num_elem)+=correction_en_pression(num_elem);
<a name="l01012"></a>01012         }
<a name="l01013"></a>01013     }
<a name="l01014"></a>01014 }
<a name="l01015"></a>01015 
<a name="l01016"></a><a class="code" href="classSource__PDF__EF.html#a602560743aacc986a2aa596ff9636204">01016</a> <span class="keywordtype">void</span> <a class="code" href="classSource__PDF__EF.html#a602560743aacc986a2aa596ff9636204">Source_PDF_EF::correct_vitesse</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coeff_node, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse)<span class="keyword"> const</span>
<a name="l01017"></a>01017 <span class="keyword"></span>{
<a name="l01018"></a>01018   <span class="keywordtype">int</span> nb_data_vit = vitesse.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l01019"></a>01019   <span class="keywordtype">int</span> nb_node_2 = coeff_node.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0) ;
<a name="l01020"></a>01020   <span class="keywordtype">int</span> ncomp = coeff_node.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) ;
<a name="l01021"></a>01021   <span class="keywordflow">if</span> (nb_data_vit != nb_node_2 * ncomp)
<a name="l01022"></a>01022     {
<a name="l01023"></a>01023       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Source_PDF: numbers of nodes are different for vitesse and champ_coeff_tfsdia_gb_som_&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01024"></a>01024       <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">abort</a>();
<a name="l01025"></a>01025     }
<a name="l01026"></a>01026   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit_dir=<a class="code" href="classSource__PDF__base.html#af9c1db0d8c53f4a584c5dd7650039b8c">vitesse_imposee_</a>;
<a name="l01027"></a>01027   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_node_2; i++)
<a name="l01028"></a>01028     {
<a name="l01029"></a>01029       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;ncomp; j++)
<a name="l01030"></a>01030         {
<a name="l01031"></a>01031           <span class="keywordflow">if</span> (coeff_node(i,j)!= 1.0)
<a name="l01032"></a>01032             {
<a name="l01033"></a>01033               vitesse(i,j)=vit_dir(i,j);
<a name="l01034"></a>01034             }
<a name="l01035"></a>01035         }
<a name="l01036"></a>01036     }
<a name="l01037"></a>01037 }
<a name="l01038"></a>01038 
<a name="l01039"></a><a class="code" href="classSource__PDF__EF.html#ad8c789ea1782fd9f3aedaad60c3012f9">01039</a> <span class="keywordtype">int</span> <a class="code" href="classSource__PDF__EF.html#ad8c789ea1782fd9f3aedaad60c3012f9">Source_PDF_EF::impr</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l01040"></a>01040 <span class="keyword"></span>{
<a name="l01041"></a>01041   <span class="keywordflow">if</span> (<a class="code" href="classSource__base.html#ac31044d0278d80bca2ae3f81e5660ed1" title="Nom du fichier .out pour l&#39;impression.">out_</a>==<span class="stringliteral">&quot;??&quot;</span>)
<a name="l01042"></a>01042     {
<a name="l01043"></a>01043       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; __FILE__ &lt;&lt; (int)__LINE__ &lt;&lt; <span class="stringliteral">&quot; ERROR / Source_PDF_EF::impr&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01044"></a>01044       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;No balance printed for &quot;</span> &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01045"></a>01045       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Because output file name is not specified.&quot;</span> &lt;&lt; finl;
<a name="l01046"></a>01046       <span class="keywordflow">return</span> 0;
<a name="l01047"></a>01047     }
<a name="l01048"></a>01048   <span class="keywordflow">else</span>
<a name="l01049"></a>01049     {
<a name="l01050"></a>01050       <span class="keywordtype">int</span> nb_compo=<a class="code" href="classSource__base.html#ad918e2d36e512f1f7ab6b8ecbaa1f80b" title="Vecteur contenant les valeurs du terme source dans le domaine.">bilan_</a>.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l01051"></a>01051       <span class="keywordflow">if</span> (nb_compo==0)
<a name="l01052"></a>01052         {
<a name="l01053"></a>01053           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; __FILE__ &lt;&lt; (int)__LINE__ &lt;&lt; <span class="stringliteral">&quot; ERROR / Source_PDF_EF::impr&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01054"></a>01054           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;No balance printed for &quot;</span> &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01055"></a>01055           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Because bilan_ array is not filled.&quot;</span> &lt;&lt; finl;
<a name="l01056"></a>01056           <span class="keywordflow">return</span> 0;
<a name="l01057"></a>01057         }
<a name="l01058"></a>01058       <span class="keywordflow">else</span>
<a name="l01059"></a>01059         {
<a name="l01060"></a>01060           <span class="keyword">const</span> <a class="code" href="classSchema__Temps__base.html" title="classe Schema_Temps_base">Schema_Temps_base</a>&amp; sch=<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>();
<a name="l01061"></a>01061           <span class="keywordtype">double</span> temps=sch.<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>();
<a name="l01062"></a>01062           <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse=<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l01063"></a>01063           <span class="keywordtype">int</span> nb_som_tot=<a class="code" href="classSource__PDF__EF.html#a48b40508482720c75a7ec650fc541d71">la_zone_EF</a>.<a class="code" href="classRef__Zone__EF.html#ad5f2da15b834bc7d9ca018a566d40715">valeur</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>();
<a name="l01064"></a>01064           <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> espace=<span class="stringliteral">&quot; \t&quot;</span>;
<a name="l01065"></a>01065 
<a name="l01066"></a>01066           <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eq_base = <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classEquation__base.html">Equation_base</a>, <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>());
<a name="l01067"></a>01067           <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> secmem_conv(vitesse);
<a name="l01068"></a>01068           <span class="keywordtype">int</span> transport_rhou=0;
<a name="l01069"></a>01069           <span class="keywordflow">if</span> (eq_base.<a class="code" href="classEquation__base.html#a68cdf54c4af72b23d0d2c8a1b3f7ebd9">nombre_d_operateurs</a>() &gt; 1)
<a name="l01070"></a>01070             {
<a name="l01071"></a>01071               <span class="keyword">const</span> <a class="code" href="classOp__Conv__EF.html" title="class Op_Conv_EF Cette classe represente l&#39;operateur de convection associe a une equation de transpor...">Op_Conv_EF</a>&amp; op_conv = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classOp__Conv__EF.html" title="class Op_Conv_EF Cette classe represente l&#39;operateur de convection associe a une equation de transpor...">Op_Conv_EF</a>, eq_base.<a class="code" href="classEquation__base.html#a8406eaa10e61a27e9a2e1cacea253c3e">operateur</a>(1).<a class="code" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">l_op_base</a>());
<a name="l01072"></a>01072               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;/////////////////////////!&lt; .vitesse() : &quot;</span> &lt;&lt; op_conv.<a class="code" href="classOp__Conv__EF__base.html#a206c7695f73a25760b685ca1c00598a4">vitesse</a>().<a class="code" href="classField__base.html#ae1377124eabe8387aced762115b062bb" title="Renvoie le nom du champ.">le_nom</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a> ;
<a name="l01073"></a>01073               transport_rhou= (op_conv.<a class="code" href="classOp__Conv__EF__base.html#a206c7695f73a25760b685ca1c00598a4">vitesse</a>().<a class="code" href="classField__base.html#ae1377124eabe8387aced762115b062bb" title="Renvoie le nom du champ.">le_nom</a>()==<span class="stringliteral">&quot;rho_u&quot;</span>?1:0);
<a name="l01074"></a>01074               eq_base.<a class="code" href="classEquation__base.html#a20d04d53bd0c4b48aa923c2b328bb1e3" title="Add convection term In: solution is the unknown I Out: secmem is increased by convection(I)">derivee_en_temps_conv</a>(secmem_conv , vitesse);
<a name="l01075"></a>01075             }
<a name="l01076"></a>01076 
<a name="l01077"></a>01077           <span class="keywordtype">int</span> i_traitement_special = (transport_rhou==1?2:102);
<a name="l01078"></a>01078           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> resu(vitesse);
<a name="l01079"></a>01079           <a class="code" href="classSource__PDF__base.html#a432d68c2ada2bbb554719237ea08a97c">calculer</a>(resu, i_traitement_special);
<a name="l01080"></a>01080 
<a name="l01081"></a>01081           <a class="code" href="classDoubleVect.html">DoubleVect</a> source_term[3];
<a name="l01082"></a>01082           <a class="code" href="classSource__base.html#ad918e2d36e512f1f7ab6b8ecbaa1f80b" title="Vecteur contenant les valeurs du terme source dans le domaine.">bilan_</a> = 0.0;
<a name="l01083"></a>01083           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)
<a name="l01084"></a>01084             {
<a name="l01085"></a>01085               source_term[i] = <a class="code" href="classSource__PDF__EF.html#a5ba63c704748538d947f528a078b1f36">champ_nodal_</a>.<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l01086"></a>01086               source_term[i] = 0.;
<a name="l01087"></a>01087               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nb_som_tot; j++)
<a name="l01088"></a>01088                 {
<a name="l01089"></a>01089                   <span class="keywordtype">int</span> filter = (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(resu(j,i)) &gt; 1.e-6?1:0);
<a name="l01090"></a>01090                   source_term[i](j) = resu(j,i) - <a class="code" href="classSource__PDF__base.html#ad36886b024527854a7b2e62ab4fb0c29" title="part of the source term computed with the imposed velocity FOR THE INTERPOLATION">sec_mem_pdf</a>(j,i) + secmem_conv(j,i)*filter;
<a name="l01091"></a>01091                 }
<a name="l01092"></a>01092               <a class="code" href="classSource__base.html#ad918e2d36e512f1f7ab6b8ecbaa1f80b" title="Vecteur contenant les valeurs du terme source dans le domaine.">bilan_</a>(i) = <a class="code" href="DoubleVect_8cpp.html#a07dd5e25d47ad3892ae0fa4e997ed011">mp_somme_vect</a>(source_term[i]);
<a name="l01093"></a>01093             }
<a name="l01094"></a>01094           <span class="keywordtype">int</span> flag = <a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>();
<a name="l01095"></a>01095           <span class="keywordflow">if</span>(flag)
<a name="l01096"></a>01096             {
<a name="l01097"></a>01097               <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> Flux;
<a name="l01098"></a>01098               <a class="code" href="classSource__PDF__base.html#a45417e1a4f06b2dfa3de26cbef2756a6" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un terme source A surcharger dans les classes derivees...">ouvrir_fichier</a>(Flux,<span class="stringliteral">&quot;&quot;</span>,flag);
<a name="l01099"></a>01099               Flux &lt;&lt; temps &lt;&lt; espace &lt;&lt; <a class="code" href="classSource__base.html#ad918e2d36e512f1f7ab6b8ecbaa1f80b" title="Vecteur contenant les valeurs du terme source dans le domaine.">bilan_</a>(0) &lt;&lt; espace &lt;&lt; <a class="code" href="classSource__base.html#ad918e2d36e512f1f7ab6b8ecbaa1f80b" title="Vecteur contenant les valeurs du terme source dans le domaine.">bilan_</a>(1) &lt;&lt; espace &lt;&lt; <a class="code" href="classSource__base.html#ad918e2d36e512f1f7ab6b8ecbaa1f80b" title="Vecteur contenant les valeurs du terme source dans le domaine.">bilan_</a>(2) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01100"></a>01100             }
<a name="l01101"></a>01101         }
<a name="l01102"></a>01102       <span class="keywordflow">return</span> 1;
<a name="l01103"></a>01103     }
<a name="l01104"></a>01104 }
<a name="l01105"></a>01105 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:11 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
