<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TRUST: src/Kernel/Math/Matrices/Matrice_Morse.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TRUST<span id="projectnumber">&#160;1.9.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_4ebb9cf478835123b919db691d6366a3.html">Kernel</a></li><li class="navelem"><a class="el" href="dir_65ad971e6c761419c1a7edd88c13347f.html">Math</a></li><li class="navelem"><a class="el" href="dir_89eaedc415f3dc0dd55a55271d066916.html">Matrices</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">Matrice_Morse.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="Matrice__Morse_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/****************************************************************************</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">* Copyright (c) 2022, CEA</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">* All rights reserved.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">*</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">*</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">*</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">*****************************************************************************/</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse_8h.html">Matrice_Morse.h</a>&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;<a class="code" href="Sparskit_8h.html">Sparskit.h</a>&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse__Sym_8h.html">Matrice_Morse_Sym.h</a>&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;<a class="code" href="Check__espace__virtuel_8h.html">Check_espace_virtuel.h</a>&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;<a class="code" href="Noms_8h.html">Noms.h</a>&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;<a class="code" href="ArrOfBit_8h.html">ArrOfBit.h</a>&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;<a class="code" href="Array__tools_8h.html">Array_tools.h</a>&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;<a class="code" href="TRUSTTrav_8h.html">TRUSTTrav.h</a>&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;<a class="code" href="TRUSTTrav_8h.html">TRUSTTrav.h</a>&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span> </div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a559b3c34d5e44573fdaf1da7c5945bad">   28</a></span><a class="code hl_define" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>,<span class="stringliteral">&quot;Matrice_Morse&quot;</span>,<a class="code hl_class" href="classMatrice__Base.html">Matrice_Base</a>);</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="comment">// Parametre: Sortie&amp; s</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="comment">// Signification: un flot de sortie</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="comment">// Acces: entree/sortie</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="comment">//</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="comment">//! Ecrit les trois tableaux de la structure de stockage&lt;br&gt;Morse sur un flot de sortie.</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="comment"></span><span class="comment">/** \return Sortie\&amp; s&lt;br&gt;</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="comment">Signification: le flot de sortie modifie&lt;br&gt;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#af9ea606bd195c151c6204210bb3d3eb4">   45</a></span><a class="code hl_class" href="classSortie.html">Sortie</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#af9ea606bd195c151c6204210bb3d3eb4">Matrice_Morse::printOn</a>(<a class="code hl_class" href="classSortie.html">Sortie</a>&amp; s)<span class="keyword"> const</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>  s &lt;&lt; <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>  s &lt;&lt; <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>  s &lt;&lt; <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>  s &lt;&lt; <a class="code hl_variable" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0">m_</a> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>  <span class="keywordflow">return</span> s;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>}</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="comment">// Parametre: Entree&amp; s</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="comment">// Signification: un flot d&#39;entree</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="comment">// Exception: NON CODE</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="comment">//! NON CODE</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="comment"></span><span class="comment">/** \return Entree\&amp; s&lt;br&gt;</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="comment">Signification: le flot d&#39;entree&lt;br&gt;</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a30fec8fc80640dc5543d6547c84455f0">   68</a></span><a class="code hl_class" href="classEntree.html">Entree</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#a30fec8fc80640dc5543d6547c84455f0">Matrice_Morse::readOn</a>(<a class="code hl_class" href="classEntree.html">Entree</a>&amp; s)</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>{</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>  s &gt;&gt; <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>  s &gt;&gt; <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>  s &gt;&gt; <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>  s &gt;&gt; <a class="code hl_variable" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0">m_</a>;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>  <span class="keywordflow">return</span> s;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>}</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#aa1bf9efc7e65b1fd96d7059997ff704a">   78</a></span><a class="code hl_class" href="classSortie.html">Sortie</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#aa1bf9efc7e65b1fd96d7059997ff704a">Matrice_Morse::imprimer</a>(<a class="code hl_class" href="classSortie.html">Sortie</a>&amp; s)<span class="keyword"> const</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>  <span class="keywordtype">int</span> n=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    {</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>      s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>      s &lt;&lt; <span class="stringliteral">&quot;--------------------------------&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>        {</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>          s &lt;&lt; <span class="stringliteral">&quot;(&quot;</span>&lt;&lt;(<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1) &lt;&lt; <span class="stringliteral">&quot;),(&quot;</span> &lt;&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)&lt;&lt; <span class="stringliteral">&quot;) &quot;</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>            &lt;&lt; <span class="stringliteral">&quot; k= &quot;</span> &lt;&lt; k &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        }</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>      s &lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    }</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>  <span class="keywordflow">return</span> s;</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>}</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a8c47c9e0f73591852cc8a7204d8ad6ac">   95</a></span><a class="code hl_class" href="classSortie.html">Sortie</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#a8c47c9e0f73591852cc8a7204d8ad6ac">Matrice_Morse::imprimer_formatte</a>(<a class="code hl_class" href="classSortie.html">Sortie</a>&amp; s)<span class="keyword"> const</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classMatrice__Morse.html#a8c47c9e0f73591852cc8a7204d8ad6ac">imprimer_formatte</a>(s,0);</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>}</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a92ed5048348f07a6b136d7ea0573fbe7">  100</a></span><a class="code hl_class" href="classSortie.html">Sortie</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#a8c47c9e0f73591852cc8a7204d8ad6ac">Matrice_Morse::imprimer_formatte</a>(<a class="code hl_class" href="classSortie.html">Sortie</a>&amp; s, <span class="keywordtype">int</span> <a class="code hl_enumvalue" href="Iterateur__VDF__base_8h.html#a407fbcf28d9550510074f0c887a0e0ceac938491055e13993f3eed68c989f90b0">symetrie</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>  <span class="keywordtype">int</span> numerotation_fortran=(<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTVect.html#a299ab30e32e399a721f3d215e64a0b33">mp_min_vect</a>()==1);</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> proc=0; proc&lt;<a class="code hl_function" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1">Process::nproc</a>(); proc++)</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    {</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>      <span class="keywordflow">if</span> (proc==<a class="code hl_function" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4">Process::me</a>())</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>        {</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>          s &lt;&lt; <span class="stringliteral">&quot;Matrix morse on the processor &quot;</span> &lt;&lt; proc &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>          <span class="keywordtype">int</span> n=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>          <a class="code hl_class" href="classNoms.html">Noms</a> tab_imp;</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>          tab_imp.<a class="code hl_function" href="classvect__impl.html#ad841d6b676a796bae26ed2566b7b3b41">dimensionner</a>(<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>());</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>            {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>(); k++)</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                tab_imp[k]=<span class="stringliteral">&quot;  .  &quot;</span>;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>              <span class="keywordflow">if</span> (i&lt;10)</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>                s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot; :&quot;</span> ;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>              <span class="keywordflow">else</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> ;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>              <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="Iterateur__VDF__base_8h.html#a407fbcf28d9550510074f0c887a0e0ceac938491055e13993f3eed68c989f90b0">symetrie</a>)</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>                {</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;i; j++)</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>                    {</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(j)-numerotation_fortran; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(j+1)-numerotation_fortran; k++)</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran==i)</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>                          tab_imp[j] = <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>                    }</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>                  <span class="keywordtype">int</span> ligne=<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-numerotation_fortran)-numerotation_fortran;</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>                  <span class="keywordflow">if</span> (i!=ligne)</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>                    {</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>                      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Problem detected on this Matrice_Morse_Sym.&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>                      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The diagonal of the line &quot;</span> &lt;&lt; ligne &lt;&lt; <span class="stringliteral">&quot; must be stored even if it is null.&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno"><a class="line" href="Matrice__Morse__Sym_8h.html#a9b2be70ec114aadae982e55d2c748db9">  133</a></span>                      <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>                    }</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>                }</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-numerotation_fortran; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-numerotation_fortran; k++)</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)+!numerotation_fortran==0)</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>                  <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Line &quot;</span> &lt;&lt;i&lt;&lt; <span class="stringliteral">&quot; no coefficient &quot;</span>&lt;&lt;k&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>                  {</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)&gt;=0)</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                      tab_imp[<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran]=<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>                    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>                      tab_imp[<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno"><a class="line" href="Matrice__Morse__Sym_8h.html#afc77ba81a0a4335b418508f9bae4941c">  145</a></span>                    tab_imp[<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran] += (<a class="code hl_class" href="classNom.html">Nom</a>)<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k);</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>                  }</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>(); k++)</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>                s&lt;&lt;tab_imp[k];</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>              s&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>            }</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>        }</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>      <a class="code hl_function" href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1">Process::barrier</a>();</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    }</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>  <span class="keywordflow">return</span> s;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>}</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a3ea62902f8656584c3922ca43d20b8fe">  157</a></span><a class="code hl_class" href="classSortie.html">Sortie</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#a3ea62902f8656584c3922ca43d20b8fe">Matrice_Morse::imprimer_image</a>(<a class="code hl_class" href="classSortie.html">Sortie</a>&amp; s)<span class="keyword"> const</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classMatrice__Morse.html#a3ea62902f8656584c3922ca43d20b8fe">imprimer_image</a>(s,0);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>}</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a2b85a1a388210a38390f8c53a97f7228">  162</a></span><a class="code hl_class" href="classSortie.html">Sortie</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#a3ea62902f8656584c3922ca43d20b8fe">Matrice_Morse::imprimer_image</a>(<a class="code hl_class" href="classSortie.html">Sortie</a>&amp; s, <span class="keywordtype">int</span> <a class="code hl_enumvalue" href="Iterateur__VDF__base_8h.html#a407fbcf28d9550510074f0c887a0e0ceac938491055e13993f3eed68c989f90b0">symetrie</a>)<span class="keyword"> const</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>  <span class="keywordtype">int</span> numerotation_fortran=(<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTVect.html#a299ab30e32e399a721f3d215e64a0b33">mp_min_vect</a>()==1);</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> proc=0; proc&lt;<a class="code hl_function" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1">Process::nproc</a>(); proc++)</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    {</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>      <span class="keywordflow">if</span> (proc==<a class="code hl_function" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4">Process::me</a>())</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        {</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>          s &lt;&lt; <span class="stringliteral">&quot;Matrix morse on the processor &quot;</span> &lt;&lt; proc &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>          <span class="keywordtype">int</span> n=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>          <a class="code hl_class" href="classNoms.html">Noms</a> tab_imp;</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>          tab_imp.<a class="code hl_function" href="classvect__impl.html#ad841d6b676a796bae26ed2566b7b3b41">dimensionner</a>(<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>());</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>            {</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>(); k++)</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                tab_imp[k]=<span class="stringliteral">&quot;\u2588\u2588&quot;</span>;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>              <span class="keywordflow">if</span> (i&lt;10)</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>                s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot; :&quot;</span> ;</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>              <span class="keywordflow">else</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>                s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> ;</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span> </div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>              <span class="keywordflow">if</span> (<a class="code hl_enumvalue" href="Iterateur__VDF__base_8h.html#a407fbcf28d9550510074f0c887a0e0ceac938491055e13993f3eed68c989f90b0">symetrie</a>)</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>                {</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;i; j++)</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>                    {</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(j)-numerotation_fortran; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(j+1)-numerotation_fortran; k++)</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran==i)</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>                          tab_imp[j] = (<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) &gt;= 0) ? <span class="stringliteral">&quot;  &quot;</span> : <span class="stringliteral">&quot;\u2592\u2592&quot;</span>;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>                    }</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>                  <span class="keywordtype">int</span> ligne=<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-numerotation_fortran)-numerotation_fortran;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>                  <span class="keywordflow">if</span> (i!=ligne)</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>                    {</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>                      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Problem detected on this Matrice_Morse_Sym.&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>                      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The diagonal of the line &quot;</span> &lt;&lt; ligne &lt;&lt; <span class="stringliteral">&quot; must be stored even if it is null.&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>                      <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>                    }</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>                }</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-numerotation_fortran; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-numerotation_fortran; k++)</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)+!numerotation_fortran==0)</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>                  <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Line &quot;</span> &lt;&lt;i&lt;&lt; <span class="stringliteral">&quot; no coefficient &quot;</span>&lt;&lt;k&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>                  tab_imp[<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran] = (<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) &gt;= 0) ? <span class="stringliteral">&quot;  &quot;</span> : <span class="stringliteral">&quot;\u2592\u2592&quot;</span>;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span> </div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>(); k++)</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>                s&lt;&lt;tab_imp[k];</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>              s&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>            }</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        }</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>      <a class="code hl_function" href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1">Process::barrier</a>();</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    }</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>  <span class="keywordflow">return</span> s;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>}</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span> </div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span><span class="comment">// Parametre: Matrice_Morse&amp; acopier</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span><span class="comment">// Signification: la matrice morse a copier</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span><span class="comment">// Acces: entree</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span><span class="comment">// </span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span><span class="comment">// Signification:</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span><span class="comment">//</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span><span class="comment">//! Constructeur par copie d&#39;une Matrice_Morse.&lt;br&gt;Copie de chaque membre donne du paramtre.</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#ab114473e0598bf631416343daaa8be0e">  230</a></span><span class="comment"></span><a class="code hl_function" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">Matrice_Morse::Matrice_Morse</a>(<span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; acopier) :<a class="code hl_class" href="classMatrice__Base.html">Matrice_Base</a>(),</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>  tab1_(acopier.tab1_),</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  tab2_(acopier.tab2_),</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>  coeff_(acopier.coeff_),</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>  m_(acopier.m_),</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>  symetrique_(0),</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>  zero_(0)</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>{</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>  <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = acopier.<a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> ;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>}</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span><span class="comment">// Parametre: int n</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span><span class="comment">// Signification: l&#39;ordre de la matrice carree a construire</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span><span class="comment">// Valeurs par defaut: 1</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span><span class="comment">// Parametre: int nnz</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span><span class="comment">// Signification: le nombre d&#39;elements non nuls que pourra</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span><span class="comment">// stocker la matrice.</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span><span class="comment">// Valeurs par defaut: 1</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span><span class="comment">// </span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span><span class="comment">// Signification:</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span><span class="comment">//</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span><span class="comment">//</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span><span class="comment">//</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span><span class="comment">//! Constructeur d&#39;une matrice Morse carree d&#39;ordre n&lt;br&gt;et pouvant stocker au maximum nnz elements non nuls.&lt;br&gt;Egalement constructeur par defaut car les 2 parametres&lt;br&gt;ont une valeur par defaut.</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a8763add3c9688e9b5c84c31107d7c15a">  264</a></span><span class="comment"></span><a class="code hl_function" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">Matrice_Morse::Matrice_Morse</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> nnz) :</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>  morse_matrix_structure_has_changed_(1), symetrique_(0), zero_(0)</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>{</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>  <a class="code hl_function" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">dimensionner</a>(n,nnz), <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>  <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = false ;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>}</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">  271</a></span><a class="code hl_function" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">Matrice_Morse::Matrice_Morse</a>()</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>{</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>  <a class="code hl_function" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">dimensionner</a>(0,0);</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>  <a class="code hl_variable" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816">symetrique_</a> = 0;</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a8e9254acaa95bbcb76a8ff1772b9b572">zero_</a> = 0;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>  <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = false ;</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>}</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span> </div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span><span class="comment">// Parametre: int n</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span><span class="comment">// Signification: le nombre de ligne de la matrice</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span><span class="comment">// Parametre: int m</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span><span class="comment">// Signification: le nombre de colonne de la matrice</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span><span class="comment">// Parametre: int nnz</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span><span class="comment">// Signification: le nombre d&#39;elements non nuls que pourra</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span><span class="comment">// stocker la matrice.</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span><span class="comment">// </span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span><span class="comment">// Signification:</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span><span class="comment">//</span></div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span><span class="comment">//! Constructeur d&#39;une matrice Morse avec n lignes et m colonnes&lt;br&gt;pouvant stocker au maximum nnz elements non nuls.</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a77e544c96b37ab92ca8d5e3f964acc9f">  308</a></span><span class="comment"></span><a class="code hl_function" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">Matrice_Morse::Matrice_Morse</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> nnz):</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>  morse_matrix_structure_has_changed_(1), symetrique_(0), zero_(0)</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>{</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>  <a class="code hl_function" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">dimensionner</a>(n,m,nnz);</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = <span class="keyword">false</span>, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0 ;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>}</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span> </div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span> </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a48c84b2db8020db9e7e9e9855a17cbd4">  316</a></span><a class="code hl_function" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">Matrice_Morse::Matrice_Morse</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> nnz, <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTLists.html">IntLists</a>&amp; voisins,</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>                             <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTLists.html">DoubleLists</a>&amp; valeurs,</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>                             <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; terme_diag)</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>  :  morse_matrix_structure_has_changed_(1), symetrique_(0) , zero_(0)</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>{</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>  <a class="code hl_function" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">dimensionner</a>(n,n,nnz);</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>  <a class="code hl_function" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">remplir</a>(voisins, valeurs, terme_diag);</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>  <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = <span class="keyword">false</span>, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>}</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#ab2fb02a8aba88f717c2285960f375fba">  326</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#ab2fb02a8aba88f717c2285960f375fba">Matrice_Morse::set_nb_columns</a>( <span class="keyword">const</span> <span class="keywordtype">int</span> nb_col )</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>{</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0">m_</a> = nb_col;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>}</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span> </div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#ae99753a8725a9a7f58b62d6e675a69d8">  331</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#ae99753a8725a9a7f58b62d6e675a69d8">Matrice_Morse::set_symmetric</a>( <span class="keyword">const</span> <span class="keywordtype">int</span> symmetric )</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>{</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>  <a class="code hl_variable" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816">symetrique_</a> = symmetric ;</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>}</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span><span class="comment">//! Size the matrix with n lines and n columns and nnz zero-values coefficients</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">  338</a></span><span class="comment"></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">Matrice_Morse::dimensionner</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> nnz)</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>{</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>  <a class="code hl_function" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">dimensionner</a>(n,n,nnz);</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>  return ;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>}</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span> </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span> </div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span><span class="comment">// Description</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span><span class="comment">// Redimensionne la matrice creuse en ajoutant eventuellement</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span><span class="comment">// des coefficients non nuls</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span><span class="comment">// </span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><span class="comment">// Parametre : const IntTab &amp;Ind</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="comment">// Signification : tableau de taille nc * 2</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span><span class="comment">// ou nc est le nombre de couples (i,j)</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span><span class="comment">// pour les indices des nouveaux coefficients</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span><span class="comment">// </span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span><span class="comment">// A la sortie, les coefficients non nuls sur une ligne</span></div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span><span class="comment">// ne sont plus necessairement trie par ordre croissant</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span><span class="comment">// d&#39;indice de colonne (a faire ?)</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span><span class="comment">// (modif MT)</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span><span class="comment">// </span></div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a782ad0bcd14245c72494c85d7feab9f7">  360</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">Matrice_Morse::dimensionner</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; Ind)</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>{</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>  <span class="keywordflow">if</span> (Ind.<a class="code hl_function" href="classTRUSTVect.html#ae94cb18641c81d97b4011f129dba7ba9">size</a>()==0) <span class="keywordflow">return</span>; <span class="comment">//!&lt; On ne fait rien si la structure est vide</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>  <span class="keywordtype">int</span> n_ancien = <a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>(), m_ancien = <a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>();</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span> </div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>  assert(Ind.<a class="code hl_function" href="classTRUSTTab.html#a2080aac630cb9bfd47030c0c01fdb35d">nb_dim</a>() == 2);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>  assert(Ind.<a class="code hl_function" href="classTRUSTTab.html#a8fecd3f1f3a13e933c3f767a25c54805">dimension</a>(1) == 2);</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span> </div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span><span class="comment">// Calcul du nouveau nombre de lignes</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span><span class="comment">// = max (ancien, indices de ligne des nouveaux coeffs)</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span><span class="comment">// </span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span><span class="comment">// et du nouveau nombre de colonnes</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span><span class="comment">// = max (ancien, indices de colonne des nouveaux coeffs)</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>  <span class="keywordtype">int</span> nInd = Ind.<a class="code hl_function" href="classTRUSTTab.html#a8fecd3f1f3a13e933c3f767a25c54805">dimension</a>(0);</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>  <span class="keywordtype">int</span> n = 0;</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>  <span class="keywordtype">int</span> m = 0;</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nInd; i++)</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>    {</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>      <span class="keywordflow">if</span> (n &lt; Ind(i,0)) n = Ind(i,0);</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>      <span class="keywordflow">if</span> (m &lt; Ind(i,1)) m = Ind(i,1);</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    }</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>  n++;</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>  m++;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>  <span class="keywordflow">if</span> (n &lt; n_ancien) n = n_ancien;</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>  <span class="keywordflow">if</span> (m &lt; m_ancien) m = m_ancien;</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span><span class="comment">// Copies des anciens tableaux d&#39;indices</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>  <a class="code hl_class" href="classTRUSTVect.html">IntVect</a> tab1_temp(<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>);</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span> </div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span><span class="comment">// Initialisation au nombre de coefficients deja presents a chaque ligne</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span> </div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(n+1);</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0">m_</a> = m;</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span> </div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=n_ancien; i++)</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] = tab1_temp[i] - tab1_temp[i-1];</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=n_ancien+1; i&lt;=n; i++)</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] = 0;</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span><span class="comment">// Parcourt des indices des nouveaux coeffs pour voir s&#39;ils sont</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span><span class="comment">// deja presents</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span> </div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>  <span class="keywordtype">int</span> i_nouveaux = 0;</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nInd; i++)</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>    {</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>      <span class="keywordtype">int</span> i0 = Ind(i,0);</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>      <span class="keywordtype">int</span> i1 = Ind(i,1) + 1;</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span> </div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>      <span class="keywordtype">int</span> test_present = 0;</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>      <span class="keywordflow">if</span> (i0 &lt; n_ancien)</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>        {</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>          <span class="keywordtype">int</span> kmin = tab1_temp[i0]-1;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>          <span class="keywordtype">int</span> kmax = tab1_temp[i0+1]-1;</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=kmin; k&lt;kmax; k++)</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] == i1)</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>              {</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>                test_present = 1;</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>              }</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        }</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>      <span class="keywordflow">if</span> (!test_present)</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>        {</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>          i_nouveaux++;</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>          <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i0+1] += 1;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        }</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    }</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>  <span class="keywordflow">if</span> (i_nouveaux == 0)</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    {</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>      <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>=tab1_temp;</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    }</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span> </div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span><span class="comment">// Nouveau tableau des positions des premiers coeffs de chaque ligne</span></div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[0] = 1;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=n; i++)</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] += <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i-1];</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>  <span class="keywordtype">int</span> nnz_ancien = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#ae94cb18641c81d97b4011f129dba7ba9">size</a>();</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>  <span class="keywordtype">int</span> nnz = nnz_ancien + i_nouveaux;</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>  <a class="code hl_class" href="classTRUSTVect.html">IntVect</a> tab2_temp(<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>);</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>  <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a> coeff_temp(<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>);</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nnz);</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nnz);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span> </div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span><span class="comment">// Recopie des anciens coefficients et de leurs indices</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span><span class="comment">// de colonne dans les nouveaux tableaux</span></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span> </div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a> = -1;</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_ancien; i++)</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    {</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j1 = tab1_temp[i]-1, j2 = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1;</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>           j1 &lt; tab1_temp[i+1]-1;</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>           j1++, j2++)</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        {</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>          <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[j2] = tab2_temp[j1];</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>          <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[j2] = coeff_temp[j1];</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        }</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>    }</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span> </div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nInd; i++)</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    {</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>      <span class="keywordtype">int</span> j0 = Ind(i,0);</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>      <span class="keywordtype">int</span> j1 = Ind(i,1) + 1;</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>      <span class="keywordtype">int</span> k;</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>      <span class="keywordflow">for</span> (k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j0]-1; <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] &gt;= 0; k++)</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] == j1)</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>          {</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>          }</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] &lt; 0)</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        {</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>          <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] = j1;</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>          <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[k] = 0.0;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>        }</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>    }</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span><span class="comment">// on remet les coeffs dans l&#39;ordre... pas optimal mais pour voir..</span></div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>=0;</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span><span class="comment">// </span></div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>  {</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    <span class="keywordtype">int</span> nbis=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nbis; i++)</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>      {</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>          {</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span>  k2=k; k2&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k2++)</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>              {</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>                <span class="keywordtype">int</span> j1=<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k);</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>                <span class="keywordtype">int</span> j2=<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k2);</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>                <span class="keywordflow">if</span> (j1&gt;j2)</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>                  {</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>                    <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)=j2;</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>                    <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k2)=j1;</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>                  }</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>              }</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>          }</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>      }</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>  }</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>}</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span> </div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span><span class="comment">//! Size the matrix with n lines, m columns with nnz zero-values coefficients</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a5d58732a34204377b1531de430b6230b">  506</a></span><span class="comment"></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">Matrice_Morse::dimensionner</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> nnz)</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>{</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nnz);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nnz);</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0">m_</a>=m;</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span><span class="comment">// on regarde si tab1 a la bonne taille et si tab1[n1]==nnz.</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>()!=(n+1) || (<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[n]-1)!=nnz )</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    {</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>      <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(n+1);</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>      <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>=1;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>    }</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(n+1);</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[n]=nnz+1;</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span> </div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>}</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span> </div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span><span class="comment">// Description</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span><span class="comment">// Initialisation a la matrice unite</span></div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span><span class="comment">// (modif MT)</span></div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#afc6dc20707960db1921c7e1ca90966a8">  527</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#afc6dc20707960db1921c7e1ca90966a8">Matrice_Morse::unite</a>()</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>{</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> = 0.0;</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>  <span class="keywordtype">int</span> i,n  = <a class="code hl_function" href="classMatrice__Morse.html#a7b783ffdef610de0ed645b15d8c0bf56">ordre</a>();</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>  <span class="keywordflow">for</span> (i=0; i&lt;n; i++)</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>    <span class="keyword">operator</span>()(i,i) = 1.0;</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>}</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span> </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span><span class="comment">// Parametre:</span></div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span><span class="comment">// Signification:</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span><span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span></div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span><span class="comment">//</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span><span class="comment">//</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span><span class="comment">//! Renvoie l&#39;ordre de la matrice:&lt;br&gt;- le nombre de lignes si la matrice est carree&lt;br&gt;- 0 sinon</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span><span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span></div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span><span class="comment">Signification: l&#39;ordre de la matrice&lt;br&gt;</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a7b783ffdef610de0ed645b15d8c0bf56">  551</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="classMatrice__Morse.html#a7b783ffdef610de0ed645b15d8c0bf56">Matrice_Morse::ordre</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>  <span class="keywordflow">if</span>(<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>()==<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>())</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>}</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span> </div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span><span class="comment">//</span></div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span><span class="comment">//</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span><span class="comment">//</span></div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span><span class="comment">//</span></div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span><span class="comment">//! Method to check/clean the Matrice_Morse matrix:&lt;br&gt;-Suppress coefficient defined several times&lt;br&gt;-elim_coeff_nul=0, on ne supprime pas les coefficients nuls de la matrice&lt;br&gt;-elim_coeff_nul=1, on supprime les coefficients nuls de la matrice&lt;br&gt;-elim_coeff_nul=2, on supprime les coefficients nuls et quasi-nuls de la matrice</span></div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#af20143b6c3f18319cc28c326a64f031c">  565</a></span><span class="comment"></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#af20143b6c3f18319cc28c326a64f031c">Matrice_Morse::compacte</a>(<span class="keywordtype">int</span> elim_coeff_nul)</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>{</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>  <span class="keywordtype">int</span> n=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span> </div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>  <span class="keywordtype">int</span> coeff_nuls=0;</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>  <span class="keywordtype">int</span> coeff_quasi_nuls=0;</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>  <a class="code hl_class" href="classTRUSTTrav.html">IntTrav</a> elim_coeff(<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>  <span class="keywordflow">if</span> (elim_coeff_nul)</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    {</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>      <a class="code hl_class" href="classTRUSTTrav.html">DoubleTrav</a> coeff_max(n);</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span><span class="comment">// Recherche des coefficients nuls hors diagonale a supprimer de la matrice morse</span></div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>          {</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>            <span class="keywordflow">if</span> (std::fabs(<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k))&gt;coeff_max(i)) coeff_max(i)=std::fabs(<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k));</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)==0)</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>              {</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>                coeff_nuls++;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>                elim_coeff(k)=1;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>              }</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>          }</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span> </div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>      <span class="keywordflow">if</span> (elim_coeff_nul==2)</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span><span class="comment">// Recherche des coefficients quasi nuls hors diagonale (1.e-12 plus petit que le coefficient le plus grand de la ligne) a supprimer de la matrice morse</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(coeff_max(i),0)         <span class="comment">//!&lt; Le plus grand coefficient doit etre strictement positif</span></div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>                &amp;&amp; coeff_max(i)&lt;1e10)          <span class="comment">//!&lt; On ne supprime pas un coefficient quasi-nul d&#39;une ligne ou la diagonale peut etre mise a 1e12</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)!=0                 <span class="comment">//!&lt; Les coefficients nuls ont deja ete trouves</span></div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>                    &amp;&amp; <a class="code hl_function" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(std::fabs(<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k))/coeff_max(i),0))</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>                  {</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>                    coeff_quasi_nuls++;</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>                    elim_coeff(k)=1;</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>                  }</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>        }</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>    }</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span><span class="comment">// Recherche des coefficients doublons</span></div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>  <span class="keywordtype">int</span> doublons=0;</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    {</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>      <span class="keywordtype">int</span> kmin=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1;</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>      <span class="keywordtype">int</span> kmax=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1;</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>      <span class="keywordtype">int</span> jmax=-1; <span class="comment">//!&lt; Highest column of a coefficient in the line i</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=kmin; k&lt;kmax; k++)</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>        {</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>          <span class="keywordtype">int</span> j = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1;</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>          <span class="keywordflow">if</span> (j&gt;jmax)</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>            jmax=j;</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>            {</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span><span class="comment">// Found a column j lower than jmax, check if not defined before:</span></div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=k-1; kk&gt;=kmin; kk--)</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>                {</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>                  <span class="keywordtype">int</span> jj = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(kk)-1;</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>                  <span class="keywordflow">if</span> (jj == j)</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>                    {</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span><span class="comment">// Already defined!</span></div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>                      doublons=1;</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>                      elim_coeff(k)=1;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span><span class="comment">// Check if same coefficients:</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>                      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(kk)!=<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k))</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>                        {</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>                          <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in a Matrix Morse:&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>                          <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;A(&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;j&lt;&lt;<span class="stringliteral">&quot;)=&quot;</span>&lt;&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)&lt;&lt;<span class="stringliteral">&quot; != &quot;</span>&lt;&lt;<span class="stringliteral">&quot;A(&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;jj&lt;&lt;<span class="stringliteral">&quot;)=&quot;</span>&lt;&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(kk)&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>                          <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>                        }</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>                      <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>                    }</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>                }</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>            }</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        }</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>    }</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span> </div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>  <span class="keywordtype">int</span> nnz=0;</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>  <span class="keywordtype">int</span> kdeb = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(0)-1;</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>  <span class="keywordtype">int</span> coefficient_suppressed=0; <span class="comment">//!&lt; Nombre de coefficients supprimes</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>  <span class="keywordflow">if</span> (doublons || coeff_nuls || coeff_quasi_nuls)</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    {</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span><span class="comment">// Suppress coefficients</span></div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++)</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>        {</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>          <span class="keywordtype">int</span> kfin = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1;</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=kdeb; k&lt;kfin; k++)</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>            {</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>              <span class="keywordflow">if</span> (!elim_coeff(k))</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>                {</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>                  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(nnz) = <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>                  <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(nnz) = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k);</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>                  nnz++;</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>                }</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>              <span class="keywordflow">else</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>                coefficient_suppressed++;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>            }</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span><span class="comment">// Modification de tab1_ en fonction du nombre de coefficients deja enleves</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>          <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-=coefficient_suppressed;</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>          kdeb = kfin;</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        }</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>    }</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>    {</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>      nnz = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[n] - 1;</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>    }</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span> </div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span> </div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span><span class="comment">// On redimensionne les tableaux</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nnz);</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nnz);</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span> </div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>  <a class="code hl_function" href="classMatrice__Morse.html#af852d9fa4d3ee121b87adfcf1cd2a14e">assert_check_morse_matrix_structure</a>( );</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>}</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span> </div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span><span class="comment">// Parametre: Matrice_Morse&amp; a</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span><span class="comment">// Signification: la partie droite de l&#39;affectation</span></div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span><span class="comment">// Acces: entree</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span><span class="comment">// </span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span><span class="comment">// Signification:</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span><span class="comment">//</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span><span class="comment">//! Operateur d&#39;affectation d&#39;une Matrice_Morse dans une&lt;br&gt;autre Matrice_Morse.</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a5ed8c0c5ce20ddb2dff99c2eec47006f">  693</a></span><span class="comment"></span><a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#a5ed8c0c5ce20ddb2dff99c2eec47006f">Matrice_Morse::operator=</a>(<span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; a )</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>{</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTVect.html#a894bec7d0626b78fe7cda4c4550f67f6">reset</a>(), <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTVect.html#a1c6e3546a922e5867797985a5a155197">copy</a>(a.<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>());</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#a894bec7d0626b78fe7cda4c4550f67f6">reset</a>(), <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#a1c6e3546a922e5867797985a5a155197">copy</a>(a.<a class="code hl_function" href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">get_tab2</a>());</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTVect.html#a894bec7d0626b78fe7cda4c4550f67f6">reset</a>(), <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTVect.html#a1c6e3546a922e5867797985a5a155197">copy</a>(a.<a class="code hl_function" href="classMatrice__Morse.html#a4a61f874a8a3ed671bbe60168a5855ac">get_coeff</a>());</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0">m_</a>=a.<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>();</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>  <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=a.<a class="code hl_function" href="classMatrice__Base.html#ac9e6f462755d116637e2cf0ace94bd8c">is_stencil_up_to_date</a>();</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>}</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span> </div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span><span class="comment">// Parametre: Matrice_Morse&amp; a</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span><span class="comment">// Signification: la matrice a transposee</span></div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span><span class="comment">// Acces: entree</span></div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span><span class="comment">// </span></div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span><span class="comment">// Signification:</span></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span><span class="comment">//! *this = a transposee.</span></div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a9859a88c59daf0b968b3c5090e18f264">  718</a></span><span class="comment"></span><a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#a9859a88c59daf0b968b3c5090e18f264">Matrice_Morse::transpose</a>(<span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; a)</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>{</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span> </div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>  <span class="keywordtype">int</span> n=a.<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>  <span class="keywordtype">int</span> jk=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>  <span class="keywordtype">int</span> job=1;</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>  <span class="keywordtype">int</span> ipos=1;</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>  <span class="keywordtype">int</span> m=a.<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>();</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>  <span class="keywordtype">int</span> l=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>  <span class="keywordflow">if</span>(m!=jk)</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>    {</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::transpose bad dimensions&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>      <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    }</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>  m=a.<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>  l=<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>();</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>  <span class="keywordflow">if</span>(m!=l)</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    {</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::transpose bad dimensions&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>      <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>    }</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span> </div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>  {</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>    <span class="keywordtype">int</span> i, j, k , <a class="code hl_function" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a>;</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span> </div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span><span class="comment">// F77NAME(CSRCSC)(&amp;n,&amp;o,&amp;k,&amp;k,a.coeff_,a.tab2_,a.tab1_,coeff_.addr(),tab2_.addr(),tab1_.addr());</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span><span class="comment">// subroutine csrcsc (n,jk,job,ipos,a,ja,ia,ao,jao,iao)</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span><span class="comment">// integer ia(n+1),iao(n+1),ja(*),jao(*)</span></div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span><span class="comment">// real*8  a(*),ao(*)</span></div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span><span class="comment">// c-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span><span class="comment">// c Compressed Sparse Row     to      Compressed Sparse Column</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span><span class="comment">// c</span></div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span><span class="comment">// c on entry:</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span><span class="comment">// c----------</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span><span class="comment">// c n        = dimension of A.</span></div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span><span class="comment">// c jk     = dimensoin of Ao</span></div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span><span class="comment">// c job        = integer to indicate whether to fill the values (job.eq.1) of the</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span><span class="comment">// c         matrix ao or only the pattern., i.e.,ia, and ja (job .ne.1)</span></div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span><span class="comment">// c</span></div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span><span class="comment">// c ipos  = starting position in ao, jao of the transposed matrix.</span></div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span><span class="comment">// c         the iao array takes this into account (thus iao(1) is set to ipos.)</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span><span class="comment">// c         Note: this may be useful if one needs to append the data structure</span></div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span><span class="comment">// c         of the transpose to that of A. In this case use for example</span></div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span><span class="comment">// c                call csrcsc (n,1,n+2,a,ja,ia,a,ja,ia(n+2))</span></div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span><span class="comment">// c          for any other normal usage, enter ipos=1.</span></div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span><span class="comment">// c a        = real array of length nnz (nnz=number of nonzero elements in input</span></div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span><span class="comment">// c         matrix) containing the nonzero elements.</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span><span class="comment">// c ja        = integer array of length nnz containing the column positions</span></div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span><span class="comment">// c           of the corresponding elements in a.</span></div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span><span class="comment">// c ia        = integer of size n+1. ia(k) contains the position in a, ja of</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span><span class="comment">// c          the beginning of the k-th row.</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span><span class="comment">// c</span></div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span><span class="comment">// c on return:</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span><span class="comment">// c ----------</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span><span class="comment">// c output arguments:</span></div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span><span class="comment">// c ao        = real array of size nzz containing the &quot;a&quot; part of the transpose</span></div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span><span class="comment">// c jao        = integer array of size nnz containing the column indices.</span></div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span><span class="comment">// c iao        = integer array of size n+1 containing the &quot;ia&quot; index array of</span></div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span><span class="comment">// c          the transpose.</span></div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span><span class="comment">// c</span></div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span><span class="comment">// c-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span><span class="comment">// c----------------- compute lengths of rows of transp(A) ----------------</span></div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span><span class="comment">// do 1 i=1,jk+1</span></div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span><span class="comment">// iao(i) = 0</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span><span class="comment">// 1    continue</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span> </div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>    <span class="keywordflow">for</span> (i=0; i&lt;=jk; i++ ) <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] = 0 ;</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span> </div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span><span class="comment">// do 3 i=1, n</span></div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span><span class="comment">// do 2 k=ia(i), ia(i+1)-1</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span><span class="comment">// j = ja(k)+1</span></div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span><span class="comment">// iao(j) = iao(j)+1</span></div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span><span class="comment">// 2       continue</span></div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span><span class="comment">// 3    continue</span></div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span> </div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>    <span class="keywordflow">for</span>(i=0; i&lt;n; i++)</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>      {</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>        <span class="keywordflow">for</span>(k=a.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1; k&lt;a.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1]-1; k++)</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>          {</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>            j = a.<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] ;</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>            <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j] = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j] +1 ;</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>          }</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>      }</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span> </div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span><span class="comment">// c---------- compute pointers from lengths ------------------------------</span></div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span><span class="comment">// iao(1) = ipos</span></div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span><span class="comment">// do 4 i=1,jk</span></div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span><span class="comment">// iao(i+1) = iao(i) + iao(i+1)</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span><span class="comment">// 4    continue</span></div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span> </div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[0] = ipos ;</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>    <span class="keywordflow">for</span>(i=0; i&lt;jk; i++) <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1] = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] + <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1] ;</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span> </div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span><span class="comment">// c--------------- now do the actual copying -----------------------------</span></div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span><span class="comment">// do 6 i=1,n</span></div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span><span class="comment">// do 62 k=ia(i),ia(i+1)-1</span></div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span><span class="comment">// j = ja(k)</span></div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span><span class="comment">// next = iao(j)</span></div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span><span class="comment">// if (job .eq. 1)  ao(next) = a(k)</span></div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span><span class="comment">// jao(next) = i</span></div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span><span class="comment">// iao(j) = next+1</span></div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span><span class="comment">// 62      continue</span></div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span><span class="comment">// 6    continue</span></div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span> </div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>    <span class="keywordflow">for</span>(i=0; i&lt;n; i++)</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>      {</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>        <span class="keywordflow">for</span>(k=a.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1; k&lt;a.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1]-1; k++)</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>          {</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>            j    = a.<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k]-1 ;</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>            <a class="code hl_function" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a> = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j] ;</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>            <span class="keywordflow">if</span> (job == 1)  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[<a class="code hl_function" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a>-1] = a.<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[k] ;</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>            <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[<a class="code hl_function" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a>-1] = i+1 ;</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>            <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j]    = <a class="code hl_function" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a>+1 ;</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>          }</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>      }</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span> </div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span><span class="comment">// c-------------------------- reshift iao and leave ----------------------</span></div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span><span class="comment">// do 7 i=jk,1,-1</span></div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span><span class="comment">// iao(i+1) = iao(i)</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span><span class="comment">// 7    continue</span></div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span><span class="comment">// iao(1) = ipos</span></div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span> </div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>    <span class="keywordflow">for</span>(i=jk-1; i&gt;=0; i--)  <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1] = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] ;</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[0] = ipos ;</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span> </div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span><span class="comment">// c--------------- end of csrcsc -----------------------------------------</span></div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span><span class="comment">// c-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span><span class="comment">// end</span></div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span><span class="comment">// c-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>  }</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>}</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span> </div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span> </div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span><span class="comment">// A=x*A avec x une matrice diagonale stockee dans un vecteur</span></div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span><span class="comment">// la meme methode peut etre utilisee pour stocke le resultat dans</span></div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span><span class="comment">// un autre matrice que la matrice initiale</span></div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a657f2db151b16ebb64ee5b78a6faed86">  856</a></span><a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#a657f2db151b16ebb64ee5b78a6faed86">Matrice_Morse::diagmulmat</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; x)</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>{</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>  <span class="keywordtype">int</span> m=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>  <span class="keywordtype">int</span> l=0;</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>  <span class="keywordtype">int</span> n=x.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>();</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>  <span class="keywordflow">if</span>(n!=m)</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>    {</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::diagmulmat bad dimensions&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>      <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>    }</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span><span class="preprocessor">#ifndef CRAY</span></div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>  <a class="code hl_define" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(DIAMUA)(&amp;m ,&amp;l,</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>                  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),x.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>                  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>());</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>  <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::diagmulmat DIAMUA call invalid for CRAY&quot;</span>&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>  <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>}</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span> </div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span><span class="comment">// extraction de la partie superieure d&#39;une matrice morse</span></div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span><span class="comment">// la matrice resultat est celle appelante</span></div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#af1142c6d58bd4b5d01cfbb9bdc600fe9">  879</a></span><a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#af1142c6d58bd4b5d01cfbb9bdc600fe9">Matrice_Morse::partie_sup</a>(<span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; a)</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>{</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>  <span class="keywordtype">int</span> m=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>  <span class="keywordtype">int</span> n=a.<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>  <span class="keywordflow">if</span>(m!=n)</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>    {</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::partie_sup : bad dimensions m!=n.&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>      <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>    }</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>  <span class="keywordtype">double</span> t ;</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>  <span class="keywordtype">int</span> ko, k, i, kdiag, kfirst ;</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>  ko = -1 ;</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>  <span class="keywordflow">for</span>( i=0; i&lt; n; i++)</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>    {</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>      kfirst = ko + 1 ;</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>      kdiag = -1 ;</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>      <span class="keywordflow">for</span>( k = a.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1; k&lt; a.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1]-1; k++)</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>        {</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>          <span class="keywordflow">if</span> (a.<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k]-1 &gt;= i)</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>            {</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>              ko++ ;</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>              <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[ko] = a.<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[k] ;</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>              <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[ko] = a.<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] ;</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>              <span class="keywordflow">if</span> (a.<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] == i) kdiag = ko ;</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>            }</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>        }</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>      <span class="keywordflow">if</span> (kdiag != -1 &amp;&amp; kdiag != kfirst)</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>        {</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>          t = <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kdiag] ;</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>          <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kdiag] = <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kfirst] ;</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>          <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kfirst] = t ;</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>          k = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kdiag] ;</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>          <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kdiag] = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kfirst] ;</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>          <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kfirst] = k ;</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>        }</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>      <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] = kfirst+1 ;</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>    }</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>  <span class="keywordtype">int</span> nnz = (ko + 1) ;</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span> </div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[n] = (nnz) + 1 ;</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>( nnz );</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>( nnz );</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>}</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span> </div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span><span class="comment">//</span></div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span><span class="comment">//! Operation de multiplication-accumulation (saxpy) matrice vecteur.&lt;br&gt;Operation: resu = resu + A*x</span></div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#ab53fa44fe7cb97fbae07b8543e9b4e93">  928</a></span><span class="comment"></span><a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#ab53fa44fe7cb97fbae07b8543e9b4e93">Matrice_Morse::ajouter_multvect_</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; x,<a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; resu)<span class="keyword"> const</span></div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>  <a class="code hl_function" href="classMatrice__Morse.html#af852d9fa4d3ee121b87adfcf1cd2a14e">assert_check_morse_matrix_structure</a>( );</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>() - 1;</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span> </div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>  assert(x.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>() == <a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>());</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span><span class="comment">// Test dans cet ordre car l&#39;attribut size() peut etre invalide:</span></div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>  assert(resu.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>() == n || resu.<a class="code hl_function" href="classTRUSTVect.html#ae94cb18641c81d97b4011f129dba7ba9">size</a>() == n);</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span> </div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> *tab1_ptr = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>() + 1;</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> *tab2_ptr = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>();</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> *coeff_ptr = <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>();</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> * x_fortran = x.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>() - 1; <span class="comment">//!&lt; Pour indexer x avec un indice fortran</span></div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>  <span class="keywordtype">int</span> k_fortran = 1; <span class="comment">//!&lt; indice fortran dans tab2 et coeff</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++, tab1_ptr++)</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>    {</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> kmax = *tab1_ptr; <span class="comment">//!&lt; tab1_[i+1] = indice fortran dans tab2_</span></div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>      assert(kmax &gt;= k_fortran &amp;&amp; kmax &lt;= (<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>()+1));</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>      <span class="keywordtype">double</span> t = resu[i];</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>      assert(k_fortran == <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] &amp;&amp; tab2_ptr == <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>()+(k_fortran-1));</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>      <span class="keywordflow">for</span> (; k_fortran &lt; kmax; k_fortran++, tab2_ptr++, coeff_ptr++)</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>        {</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>          <span class="keywordtype">int</span> colonne = *tab2_ptr; <span class="comment">//!&lt; indice fortran</span></div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>          assert(colonne &gt;= 1 &amp;&amp; colonne &lt;= <a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>());</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>          t += (*coeff_ptr) * x_fortran[colonne];</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>        }</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>      resu[i] = t;</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>    }</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>  <span class="keywordflow">return</span> resu;</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>}</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span> </div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span><span class="comment">// Multiplication de la matrice par un vecteur x en prenant uniquement les items reels non communs pour x</span></div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#ac6f26e5fd363c6a0ba11d156aaf65962">  960</a></span><a class="code hl_class" href="classTRUSTArray.html">ArrOfDouble</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#ab53fa44fe7cb97fbae07b8543e9b4e93">Matrice_Morse::ajouter_multvect_</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTArray.html">ArrOfDouble</a>&amp; x,<a class="code hl_class" href="classTRUSTArray.html">ArrOfDouble</a>&amp; resu,<a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a>&amp; est_reel_pas_com)<span class="keyword"> const</span></div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>  <a class="code hl_function" href="classMatrice__Morse.html#af852d9fa4d3ee121b87adfcf1cd2a14e">assert_check_morse_matrix_structure</a>( );</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>  <span class="keywordtype">int</span> n = <a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span> </div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>  assert(<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>()==x.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>());</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>  assert(n==resu.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>());</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>    {</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>      <span class="keywordtype">double</span> t = 0.0;</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>        {</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>          <span class="keywordtype">int</span> j=<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1;</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>          <span class="keywordflow">if</span> (est_reel_pas_com[j]) t += <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)*x[j];</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>        }</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>      resu[i] += t ;</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>    }</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>  <span class="keywordflow">return</span> resu;</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>}</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span> </div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span><span class="comment">// Parametre: DoubleTab&amp; x</span></div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span><span class="comment">// Signification: la matrice a multiplier</span></div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span><span class="comment">// Acces: entree</span></div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span><span class="comment">// Parametre: DoubleTab&amp; resu</span></div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span><span class="comment">// Signification: la matrice resultat de l&#39;operation</span></div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span><span class="comment">// Acces: entree/sortie</span></div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span><span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span></div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span><span class="comment">//</span></div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span><span class="comment">//</span></div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span><span class="comment">//! Operation de multiplication-accumulation (saxpy) matrice matrice&lt;br&gt;(matrice X representee par un tableau)&lt;br&gt;Operation: RESU = RESU + A*X</span></div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span><span class="comment"></span><span class="comment">/** \return DoubleTab\&amp;&lt;br&gt;</span></div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span><span class="comment">Signification: la matrice resultat de l&#39;operation&lt;br&gt;</span></div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#afec4fb59b905fea3bb2479ede04094c5"> 1001</a></span><a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#afec4fb59b905fea3bb2479ede04094c5">Matrice_Morse::ajouter_multTab_</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; x,<a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; resu)<span class="keyword"> const</span></div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span> </div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>  <span class="keywordflow">if</span> ( (x.<a class="code hl_function" href="classTRUSTTab.html#a2080aac630cb9bfd47030c0c01fdb35d">nb_dim</a>() == 1) &amp;&amp; (resu.<a class="code hl_function" href="classTRUSTTab.html#a2080aac630cb9bfd47030c0c01fdb35d">nb_dim</a>() == 1))</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>    {</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>      <a class="code hl_function" href="classMatrice__Base.html#aed652de189a541ffa30f802e407696cd">ajouter_multvect</a>(x,resu);</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>      <span class="keywordflow">return</span> resu;</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>    }</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span> </div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>  <a class="code hl_function" href="classMatrice__Morse.html#af852d9fa4d3ee121b87adfcf1cd2a14e">assert_check_morse_matrix_structure</a>( );</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>  <span class="keywordtype">int</span> i, k;</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>  <span class="keywordtype">int</span> nb_comp = x.<a class="code hl_function" href="classTRUSTTab.html#a8fecd3f1f3a13e933c3f767a25c54805">dimension</a>(1);</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span> </div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>  assert(resu.<a class="code hl_function" href="classTRUSTTab.html#a8fecd3f1f3a13e933c3f767a25c54805">dimension</a>(1) == nb_comp);</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>  <span class="keywordtype">double</span>* t= <span class="keyword">new</span> <span class="keywordtype">double</span>[nb_comp];</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>  <span class="keywordtype">int</span> ncomp;</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>  <span class="keywordtype">int</span> n=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>  <span class="keywordflow">for</span>(i=0; i&lt;n; i++)</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>    {</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>      <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>        t[ncomp] = 0.0;</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>      <span class="keywordflow">for</span> (k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>        <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>          t[ncomp] += <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)*x(<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1,ncomp);</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>      <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>        resu(i,ncomp) += t[ncomp] ;</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>    }</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>  <span class="keyword">delete</span> [] t;</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>  <span class="keywordflow">return</span> resu;</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>}</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span> </div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span> </div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span><span class="comment">// Parametre: DoubleVect&amp; x</span></div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span><span class="comment">// Signification: le vecteur a multiplier</span></div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span><span class="comment">// Acces: entree</span></div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span><span class="comment">// Parametre: DoubleVect&amp; resu</span></div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span><span class="comment">// Signification: le vecteur resultat de l&#39;operation</span></div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span><span class="comment">// Acces: entree/sortie</span></div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span><span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span></div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span><span class="comment">//</span></div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span><span class="comment">//</span></div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span><span class="comment">//! Operation de multiplication-accumulation (saxpy) matrice vecteur,&lt;br&gt;par la matrice transposee.&lt;br&gt;Operation: resu = resu + A^{T}*x</span></div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span><span class="comment"></span><span class="comment">/** \return DoubleVect\&amp;&lt;br&gt;</span></div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span><span class="comment">Signification: le vecteur resultat de l&#39;operation&lt;br&gt;</span></div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#ab8e5a78ec712cb3697a59105c662d4c3"> 1054</a></span><a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#ab8e5a78ec712cb3697a59105c662d4c3">Matrice_Morse::ajouter_multvectT_</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; x,<a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; resu)<span class="keyword"> const</span></div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>  <a class="code hl_function" href="classMatrice__Morse.html#af852d9fa4d3ee121b87adfcf1cd2a14e">assert_check_morse_matrix_structure</a>( );</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span> </div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>  <span class="keywordtype">int</span> n=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>    {</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>      <span class="keywordtype">double</span> xi = x(i);</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>        resu(<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1) += <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) * xi;</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>    }</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>  <span class="keywordflow">return</span> resu;</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>}</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span> </div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span><span class="comment">// Multiplication de la tranposee de la matrice par un vecteur x en prenant uniquement les items reels non communs</span></div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a2ec00340935aee7fe07bed3ddacb5091"> 1069</a></span><a class="code hl_class" href="classTRUSTArray.html">ArrOfDouble</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#ab8e5a78ec712cb3697a59105c662d4c3">Matrice_Morse::ajouter_multvectT_</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTArray.html">ArrOfDouble</a>&amp; x,<a class="code hl_class" href="classTRUSTArray.html">ArrOfDouble</a>&amp; resu,<a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a>&amp; est_reel_pas_com)<span class="keyword"> const</span></div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>  <a class="code hl_function" href="classMatrice__Morse.html#af852d9fa4d3ee121b87adfcf1cd2a14e">assert_check_morse_matrix_structure</a>( );</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>  <span class="keywordtype">int</span> n=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span> </div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>  assert(n==x.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>());</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>  assert(<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>()==resu.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>());</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>    {</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>      <span class="keywordflow">if</span> (est_reel_pas_com[i])</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>        {</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>          <span class="keywordtype">double</span> xi = x[i];</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>            resu[<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1] += <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) * xi;</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>        }</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>    }</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>  <span class="keywordflow">return</span> resu;</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>}</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span> </div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span><span class="comment">// Parametre: Matrice_Morse&amp; A</span></div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span><span class="comment">// Signification: une matrice au format Morse</span></div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span><span class="comment">// Acces: entree</span></div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span><span class="comment">// Parametre: Matrice_Morse&amp; B</span></div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span><span class="comment">// Signification: une matrice au format Morse</span></div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span><span class="comment">// Acces: entree</span></div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span><span class="comment">//</span></div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span><span class="comment">//</span></div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span><span class="comment">//! Fonction (hors classe) amie de la classe Matrice_Morse&lt;br&gt;Addition de 2 matrices au format Morse.&lt;br&gt;Operation: renvoie (A+B)</span></div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span><span class="comment"></span><span class="comment">/** \return Matrice_Morse&lt;br&gt;</span></div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span><span class="comment">Signification: le resultat de l&#39;operation&lt;br&gt;</span></div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span><span class="comment">Contraintes: la matrice resultat est allouee par la fonction */</span></div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a9b2be70ec114aadae982e55d2c748db9"> 1109</a></span><a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a> <a class="code hl_function" href="Matrice__Morse_8cpp.html#a17a186d3ca06dea0e9b1ad445a4ea482">operator+</a>(<span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; A , <span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; B )</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>{</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>  <span class="keywordtype">int</span> nrow=A.<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>  <span class="keywordtype">int</span> ncol=A.<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>();</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>  <span class="keywordtype">int</span> job=1;</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>  <span class="keywordtype">int</span> ierr;</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>  <a class="code hl_class" href="classTRUSTVect.html">IntVect</a> iw(ncol);</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>  <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a> C;</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span><span class="comment">// PL: avant de dimensionner a nzmax on verifie si A et B n&#39;ont pas la meme structure par hasard...</span></div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span><span class="comment">// Cela evite un pic memoire provoque par l&#39;addition de matrices dans Equation_base::dimensionner_matrice</span></div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span><span class="comment">// Sinon, APLB n&#39;est pas optimal, voir une autre implementation genre MKL:</span></div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span><span class="comment">// https://software.intel.com/en-us/mkl-developer-reference-c-mkl-sparse-add</span></div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>  <span class="keywordtype">int</span> nzmax = A.<a class="code hl_function" href="classMatrice__Morse.html#ad850cee630fca99173c2219659fa3ecb">has_same_morse_matrix_structure</a>(B) ? A.<a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>() : A.<a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>()+B.<a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>();</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>  C.<a class="code hl_function" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">dimensionner</a>(nrow, ncol, nzmax);</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>  <a class="code hl_define" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(APLB) (&amp;nrow, &amp;ncol, &amp;job, A.<a class="code hl_function" href="classMatrice__Morse.html#a4a61f874a8a3ed671bbe60168a5855ac">get_coeff</a>().<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), A.<a class="code hl_function" href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">get_tab2</a>().<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), A.<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>().<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>                 B.<a class="code hl_function" href="classMatrice__Morse.html#a4a61f874a8a3ed671bbe60168a5855ac">get_coeff</a>().<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), B.<a class="code hl_function" href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">get_tab2</a>().<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), B.<a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>().<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), C.<a class="code hl_function" href="classMatrice__Morse.html#a7654bbef11775a783790d3e9ad0b1501">get_set_coeff</a>().<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>                 C.<a class="code hl_function" href="classMatrice__Morse.html#af9addd0cf0fc821150da06b1f2e242ea">get_set_tab2</a>().<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), C.<a class="code hl_function" href="classMatrice__Morse.html#a6ef2f55690a596db1ef29742a2e580de">get_set_tab1</a>().<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>                 &amp;nzmax,iw.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),&amp;ierr);</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span> </div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nnz = C.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[nrow] - 1;</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>  C.<a class="code hl_function" href="classMatrice__Morse.html#af9addd0cf0fc821150da06b1f2e242ea">get_set_tab2</a>().<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>( nnz );</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>  C.<a class="code hl_function" href="classMatrice__Morse.html#a7654bbef11775a783790d3e9ad0b1501">get_set_coeff</a>().<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>( nnz );</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>  C.<a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, C.<a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>  <span class="keywordflow">return</span>(C);</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>}</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span> </div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#ad850cee630fca99173c2219659fa3ecb"> 1135</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classMatrice__Morse.html#ad850cee630fca99173c2219659fa3ecb">Matrice_Morse::has_same_morse_matrix_structure</a>(<span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; A)<span class="keyword"> const</span></div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>  <span class="keywordtype">int</span> nrow=A.<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nrow; i++)</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)!=A.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i))</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>}</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span> </div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span><span class="comment">// Parametre: DoubleVect&amp; secmem</span></div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span><span class="comment">// Signification: le second membre du systeme lineaire</span></div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span><span class="comment">// Acces: entree</span></div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span><span class="comment">// Parametre: DoubleVect&amp; solution</span></div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span><span class="comment">// Signification: la solution du systeme</span></div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span><span class="comment">// Acces: sortie</span></div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span><span class="comment">// Parametre: double coeff_seuil</span></div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span><span class="comment">// Signification:</span></div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span><span class="comment">// Exception: Erreur dans ilut &#39;matrix may be wrong&#39; dixit SAAD</span></div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span><span class="comment">// Exception: Erreur dans ilut : debordement dans L</span></div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span><span class="comment">// Exception: Erreur dans ilut : debordement dans U</span></div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span><span class="comment">// Exception: Valeur illegale de lfil : sans doute ecrasement memoire</span></div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span><span class="comment">// Exception: Ligne vide rencontree</span></div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span><span class="comment">// Exception: Pivot nul rencontre ! au pas</span></div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span><span class="comment">// Exception: Il s&#39;est passe quelque chose de bizarre : je prefere tout arreter.</span></div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span><span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span></div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span><span class="comment">//</span></div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span><span class="comment">//</span></div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span><span class="comment">//! Calcule la solution du systeme lineaire: A * solution = secmem.&lt;br&gt;La methode utilisee est GMRES preconditionnee avec ILUT.&lt;br&gt;ATTENTION: cette methode n&#39;a vraisemblablement jamais ete testee en parallele</span></div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span><span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span></div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span><span class="comment">Signification: renvoie toujours 1&lt;br&gt;</span></div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a930e2f0b2896d3bc7f58ef89e60239dc"> 1176</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="classMatrice__Morse.html#a930e2f0b2896d3bc7f58ef89e60239dc">Matrice_Morse::inverse</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; secmem, <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; solution,</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>                           <span class="keywordtype">double</span> coeff_seuil)<span class="keyword"> const</span></div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span><span class="comment">// B.Mat: au 20/4/2005, DoubleVect::norme() est bugge, donc la methode n&#39;a</span></div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span><span class="comment">// sans doute jamais ete validee en parallele. Je retire norme() et je mets</span></div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span><span class="comment">// ceci:</span></div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1">Process::nproc</a>() &gt; 1)</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>    {</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse(const DoubleVect&amp; secmem, DoubleVect&amp; solution, &quot;</span></div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>           &lt;&lt; <span class="stringliteral">&quot;coeff_seuil double) const \n has never been tested in parallel&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Try &#39;Solveur Gmres { diag }&#39; or &#39;Solveur Petsc Gmres { precond diag { } }&#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;instead of &#39;Solveur Gmres { }&#39; which is not parallelized yet.&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>      <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>    }</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span> </div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>  <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a> toto(secmem);</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>  <span class="keywordtype">int</span> prems=1;                        <span class="comment">//!&lt; On ne calcul L et U que si prems =1</span></div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>  <span class="keywordtype">int</span> lf_min = 10;</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>  <span class="keywordtype">int</span> lf = std::min(lf_min,<a class="code hl_function" href="classMatrice__Morse.html#a7b783ffdef610de0ed645b15d8c0bf56">ordre</a>()/2);        <span class="comment">//!&lt; nombre de termes ajouter dans L et U</span></div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>  <span class="keywordtype">int</span> nn = <a class="code hl_function" href="classMatrice__Morse.html#a7b783ffdef610de0ed645b15d8c0bf56">ordre</a>();                <span class="comment">//!&lt; ordre de la matrice</span></div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>  <span class="keywordtype">int</span> ima = std::min(lf_min,<a class="code hl_function" href="classMatrice__Morse.html#a7b783ffdef610de0ed645b15d8c0bf56">ordre</a>()/2);        <span class="comment">//!&lt; degre de l&#39;espace de Krilov</span></div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>  <a class="code hl_class" href="classTRUSTVect.html">IntVect</a> ju;                        <span class="comment">//!&lt; tableau pour L et U</span></div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>  <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a> alu;                <span class="comment">//!&lt; tableau pour L et U</span></div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>  <a class="code hl_class" href="classTRUSTVect.html">IntVect</a> jlu;                        <span class="comment">//!&lt; tableau pour L et U</span></div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>  <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a> vv;                <span class="comment">//!&lt; tableau de travail pour pgmres  DoubleVect Resini(nn);</span></div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span><span class="comment">//</span></div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>  <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a> Resini(toto);</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span> </div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>  <span class="keywordtype">int</span> ie=1;                                <span class="comment">//!&lt; niveau d&#39;erreur</span></div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>  <span class="keywordtype">int</span> n2 = <a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>()+(2*lf*nn);        <span class="comment">//!&lt; nombre de termes non nuls dans LU</span></div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span> </div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>  <span class="keywordtype">double</span> r;</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>  <span class="keywordtype">double</span> coeff_seuilr;</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>precond :</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>  {</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>    <span class="keywordflow">if</span> (prems)</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>      {</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span><span class="comment">// Cerr &lt;&lt; &quot;  ordre de la matrice de pression = &quot; &lt;&lt; nn &lt;&lt; finl;</span></div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span><span class="comment">// Cerr &lt;&lt; &quot;  nb termes non nuls dans la matrice de pression = &quot;</span></div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span><span class="comment">// &lt;&lt; coeff_.size() &lt;&lt; finl;</span></div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>        <span class="keywordtype">int</span>  iw = n2 + 2;</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>        ju.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nn);</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>        jlu.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(iw);</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>        alu.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(iw);</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>        <span class="keywordtype">double</span> to = 1.e-10;                <span class="comment">//!&lt; filtrage des coefficents de L U</span></div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>        <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a> w(nn+1);                <span class="comment">//!&lt; tableau de travail pour ilut        DoubleVect wl(nn);                // tableau de travail pour ilut</span></div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span><span class="comment">//</span></div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>        <a class="code hl_class" href="classTRUSTVect.html">IntVect</a> jw(2*nn);                        <span class="comment">//!&lt; tableau de travail pour ilut        IntVect jwu(nn);                        // tableau de travail pour ilut IntVect jwl(nn);                        // tableau de travail pour ilut coeff_[0]*=2.0;                        // pour rendre A non singuliere!</span></div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span><span class="comment">//</span></div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span><span class="comment">//</span></div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span><span class="comment">//</span></div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span> </div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span><span class="comment">// Cerr &lt;&lt; &quot;  ****  Preconditionnement ILUT de la matrice de pression  ****&quot; &lt;&lt; finl;</span></div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span><span class="preprocessor">#ifndef CRAY</span></div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>        <a class="code hl_define" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(ILUT)(&amp;nn, <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), &amp;lf,</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>                      &amp;to, alu.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), jlu.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), ju.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>                      &amp;iw, w.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>                      jw.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), &amp;ie);</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span><span class="comment">// to=0;</span></div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span><span class="comment">// wu=0.0;</span></div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span><span class="comment">// wl=0.0;</span></div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span><span class="comment">// jr=0;</span></div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span><span class="comment">// jwu=0;</span></div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span><span class="comment">// jwl=0;</span></div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span><span class="comment">// ie=0;</span></div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse ILUT call invalid for cray&quot;</span>&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>        <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span> </div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span><span class="comment">// coeff_[0]*=0.5;                        // pour rendre A singuliere!</span></div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span><span class="comment">// Cerr &lt;&lt; &quot;     nb termes non nuls dans LU = &quot; &lt;&lt; n2 &lt;&lt; finl;</span></div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>        <span class="keywordflow">switch</span>(ie)</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>          {</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>          <span class="keywordflow">case</span> 0 :</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>            <span class="comment">/*{</span></div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span><span class="comment">              Cerr &lt;&lt; &quot;     printing of the L and U matrixes : &quot; &lt;&lt; finl;</span></div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span><span class="comment">              Nom nom_fich = &quot;matrices_L_U.precond&quot;;</span></div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span><span class="comment">              ofstream os(nom_fich);</span></div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span><span class="comment">              os &lt;&lt; &quot;impression des matrices L et U :\n&quot;;</span></div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span><span class="comment">              int* tab2=jlu;</span></div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span><span class="comment">              double* coeff=alu;</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span><span class="comment">              double x;</span></div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span><span class="comment">              os &lt;&lt; &quot;termes diagonaux :&quot; &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span><span class="comment">              for (int num=0; num&lt;nn; num++) {</span></div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span><span class="comment">              x=coeff[num];</span></div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span><span class="comment">              os &lt;&lt; &quot;(&quot; &lt;&lt; num+1 &lt;&lt; &quot; , &quot; &lt;&lt; num+1 &lt;&lt; &quot;)  =  &quot; &lt;&lt; x &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span><span class="comment">              }</span></div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span><span class="comment">              os &lt;&lt; &quot;hors diagonale : &quot; &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span><span class="comment">              for ( num=0; num&lt;nn; num++) {</span></div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span><span class="comment">              os &lt;&lt; &quot;ligne &quot; &lt;&lt; num+1 &lt;&lt; &quot; : &quot;;</span></div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span><span class="comment">              int nb_vois=tab2[num+1]-tab2[num];</span></div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span><span class="comment">              double x=0.;</span></div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span><span class="comment">              for(int vois=0; vois&lt;nb_vois; vois++) {</span></div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span><span class="comment">              int num_vois=tab2[tab2[num]+vois-1];</span></div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span><span class="comment">              x=coeff[tab2[num]+vois-1];</span></div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span><span class="comment">              os &lt;&lt; &quot;(&quot; &lt;&lt; num_vois &lt;&lt; &quot; , &quot; &lt;&lt; x &lt;&lt; &quot; ) &quot; ;</span></div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span><span class="comment">              }</span></div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span><span class="comment">              os &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span><span class="comment">              }</span></div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span><span class="comment">              os.flush();</span></div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span><span class="comment">              }</span></div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span><span class="comment">            */</span></div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>          <span class="keywordflow">case</span> -1 :</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut &#39;matrix may be wrong&#39; dixit SAAD&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>            <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>          <span class="keywordflow">case</span>  -2  :</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut : overflow in L &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>            <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>          <span class="keywordflow">case</span>   -3  :</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut : overflow in U &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>            <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>          <span class="keywordflow">case</span>    -4   :</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Illegal value for lfil : it may be a memory trouble &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>            <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>          <span class="keywordflow">case</span>    -5  :</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Empty line met &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>            <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>          default :</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Pivot empty met ! at step &quot;</span> &lt;&lt; ie &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;;</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>            <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>          }</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>        prems=0;</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>      }</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>  }</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span><span class="comment">// resol :</span></div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>  {</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>    vv.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nn*(ima+1));</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span><span class="comment">// Debog::verifier(&quot;Matrice_Morse::inverse solution 0 &quot;,solution);</span></div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>    <a class="code hl_function" href="Check__espace__virtuel_8h.html#a5299d616e38b92a66b0dca6da4ff321e">assert_espace_virtuel_vect</a>(solution);</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>    <a class="code hl_function" href="classMatrice__Base.html#a91c98b86a0bdce6ccc483dd453ef9ab2">multvect</a>(solution, Resini);</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>    Resini -= toto;</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>    {</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>      r = <a class="code hl_function" href="TRUSTVect__tools_8tpp.html#ab45c540b1aca516409b0cbc857e4f103">mp_prodscal</a>(Resini, Resini);</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>      r = sqrt(r);</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>    }</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>    <a class="code hl_define" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot; Initial residu : &quot;</span> &lt;&lt; r &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>    <span class="keywordflow">if</span> (r==0)</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>      coeff_seuilr=<a class="code hl_define" href="Double_8h.html#ae0ee0cebfad5968da0ad6cc7a49e16b6">DMAXFLOAT</a>;</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>      coeff_seuilr=coeff_seuil/r;</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>    Resini=toto;</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>    <span class="keywordtype">int</span> minits = 10;</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>    <span class="keywordtype">int</span> maxits = std::max(minits, nn);</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>    <span class="keywordtype">int</span> io = 0;                                <span class="comment">//!&lt; fichier de sortie</span></div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span><span class="preprocessor">#ifndef CRAY</span></div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>    <a class="code hl_define" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(PGMRES)(&amp;nn, &amp;ima, toto.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), solution.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), vv.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), &amp;coeff_seuilr,</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>                    &amp;maxits, &amp;io, <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>                    alu.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), jlu.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), ju.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), &amp;ie);</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span> </div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>    <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse PGMRES call invalid for CRAY&quot;</span>&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>    <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>    <span class="keywordflow">switch</span>(ie)</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>      {</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>      <span class="keywordflow">case</span> 0:</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;     ** PGMRES has converged **&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;     ** No convergence after &quot;</span> &lt;&lt; maxits &lt;&lt; <span class="stringliteral">&quot; iterations **&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>        toto=Resini;</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>        <span class="keywordflow">if</span>( lf&lt;50)</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>          {</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>            lf +=5;</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  The degree of the preconditioning matrix LU is increased :   &quot;</span> &lt;&lt; lf &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>            n2 = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#ae94cb18641c81d97b4011f129dba7ba9">size</a>()+(2*lf*nn);</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>            prems=1;</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>            <span class="keywordflow">goto</span> precond ;</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>          }</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>        <span class="comment">/*else{</span></div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span><span class="comment">          if(ima==50)</span></div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span><span class="comment">          exit();</span></div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span><span class="comment">          Cout &lt;&lt; &quot;  The degree of the Krylov space for PGMRES is increased :   &quot; &lt;&lt; (ima+=2) &lt;&lt; finl;</span></div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span><span class="comment">          Cout &lt;&lt; &quot;    (=&gt; working array for pgmres at &quot; &lt;&lt; (nn*(ima+1)) &lt;&lt; &quot; elements.)&quot; &lt;&lt; finl;</span></div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span><span class="comment">          goto resol ;</span></div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span><span class="comment">          }*/</span></div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>      <span class="keywordflow">case</span> -1:</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;convergence reached after &quot;</span> &lt;&lt; (int)0 &lt;&lt; <span class="stringliteral">&quot;iterations !! &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;&#39;stationnary state may be obtened&#39; dixit us &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>      default :</div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something abnormal has happened : it is preferable to stop.&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>        <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>      }</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>  }</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>  <span class="keywordflow">return</span>(1);</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>}</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span> </div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span><span class="comment">// copie de la fonction precedente avec le parametre max_iteration en plus,</span></div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span><span class="comment">// et si ce nb d&#39;iterations est atteint, return(0), au lieu de recommencer preconditionnement</span></div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span><span class="comment">// utilise pour l&#39;implicite hyperbolique (si recoit 0 : divise le dt par 2 et recommence)</span></div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#aa0aa9271d6c618c6f8d6375aec4f6068"> 1376</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="classMatrice__Morse.html#a930e2f0b2896d3bc7f58ef89e60239dc">Matrice_Morse::inverse</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; secmem, <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; solution,</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>                           <span class="keywordtype">double</span> coeff_seuil, <span class="keywordtype">int</span> max_iter)<span class="keyword"> const</span></div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span><span class="comment">// B.Mat: au 20/4/2005, DoubleVect::norme() est bugge, donc la methode n&#39;a</span></div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span><span class="comment">// sans doute jamais ete validee en parallele. Je retire norme() et je mets</span></div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span><span class="comment">// ceci:</span></div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1">Process::nproc</a>() &gt; 1)</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>    {</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse(const DoubleVect&amp; secmem, DoubleVect&amp; solution, &quot;</span></div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>           &lt;&lt; <span class="stringliteral">&quot;double coeff_seuil) const \n has never been tested in parallel&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>      assert(0);</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>      <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>    }</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span> </div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span> </div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>  <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a> toto(secmem);</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>  <span class="keywordtype">int</span> prems=1;                        <span class="comment">//!&lt; On ne calcul L et U que si prems =1</span></div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>  <span class="keywordtype">int</span> lf_min = 10;</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>  <span class="keywordtype">int</span> lf = std::min(lf_min,<a class="code hl_function" href="classMatrice__Morse.html#a7b783ffdef610de0ed645b15d8c0bf56">ordre</a>()/2);        <span class="comment">//!&lt; nombre de termes ajouter dans L et U</span></div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>  <span class="keywordtype">int</span> nn = <a class="code hl_function" href="classMatrice__Morse.html#a7b783ffdef610de0ed645b15d8c0bf56">ordre</a>();                <span class="comment">//!&lt; ordre de la matrice</span></div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span> </div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>  <span class="keywordtype">int</span> ima = std::min(lf_min,<a class="code hl_function" href="classMatrice__Morse.html#a7b783ffdef610de0ed645b15d8c0bf56">ordre</a>()/2);        <span class="comment">//!&lt; degre de l&#39;espace de Krilov</span></div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>  <a class="code hl_class" href="classTRUSTVect.html">IntVect</a> ju;                        <span class="comment">//!&lt; tableau pour L et U</span></div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>  <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a> alu;                <span class="comment">//!&lt; tableau pour L et U</span></div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>  <a class="code hl_class" href="classTRUSTVect.html">IntVect</a> jlu;                        <span class="comment">//!&lt; tableau pour L et U</span></div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>  <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a> vv;                <span class="comment">//!&lt; tableau de travail pour pgmres</span></div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>  <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a> Resini(nn);</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span> </div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>  <span class="keywordtype">int</span> ie=1;                                <span class="comment">//!&lt; niveau d&#39;erreur</span></div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>  <span class="keywordtype">int</span> n2 = <a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>()+(2*lf*nn);        <span class="comment">//!&lt; nombre de termes non nuls dans LU</span></div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span> </div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>  <span class="keywordtype">double</span> r;</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>  <span class="keywordtype">double</span> coeff_seuilr;</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span><span class="comment">// precond :</span></div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>  {</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>    <span class="keywordflow">if</span> (prems)</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>      {</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span><span class="comment">// Cerr &lt;&lt; &quot;  ordre de la matrice de pression = &quot; &lt;&lt; nn &lt;&lt; finl;</span></div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span><span class="comment">// Cerr &lt;&lt; &quot;  nb termes non nuls dans la matrice de pression = &quot;</span></div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span><span class="comment">// &lt;&lt; tab2_.size() &lt;&lt; finl;</span></div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>        <span class="keywordtype">int</span>  iw = n2 + 2;</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>        ju.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nn);</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>        jlu.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(iw);</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>        alu.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(iw);</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>        <span class="keywordtype">double</span> to = 1.e-10;                <span class="comment">//!&lt; filtrage des coefficents de L U</span></div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>        <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a> w(nn+1);                <span class="comment">//!&lt; tableau de travail pour ilut</span></div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span> </div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span><span class="comment">// IntVect jr(nn);                        // tableau de travail pour ilut</span></div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>        <a class="code hl_class" href="classTRUSTVect.html">IntVect</a> jw(2*nn);                        <span class="comment">//!&lt; tableau de travail pour ilut        IntVect jwl(nn);                        // tableau de travail pour ilut coeff_[0]*=2.0;                        // pour rendre A non singuliere!</span></div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span><span class="comment">//</span></div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span><span class="comment">//</span></div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span> </div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span><span class="comment">// Cerr &lt;&lt; &quot;  ****  Preconditionnement ILUT de la matrice de pression  ****&quot; &lt;&lt; finl;</span></div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span><span class="preprocessor">#ifndef CRAY</span></div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>        <a class="code hl_define" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(ILUT)(&amp;nn, <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), &amp;lf,</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>                      &amp;to, alu.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), jlu.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), ju.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>                      &amp;iw, w.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>                      jw.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), &amp;ie);</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse ILUT call invalid for CRAY&quot;</span>&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>        <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span> </div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span><span class="comment">// coeff_[0]*=0.5;                        // pour rendre A singuliere!</span></div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span><span class="comment">// Cerr &lt;&lt; &quot;     nb termes non nuls dans LU = &quot; &lt;&lt; n2 &lt;&lt; finl;</span></div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>        <span class="keywordflow">switch</span>(ie)</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>          {</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>          <span class="keywordflow">case</span> 0 :</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>            <span class="comment">/*{</span></div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span><span class="comment">              Cerr &lt;&lt; &quot;     printing of L and U matrixes : &quot; &lt;&lt; finl;</span></div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span><span class="comment">              Nom nom_fich = &quot;matrices_L_U.precond&quot;;</span></div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span><span class="comment">              ofstream os(nom_fich);</span></div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span><span class="comment">              os &lt;&lt; &quot;impression des matrices L et U :\n&quot;;</span></div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span><span class="comment">              int* tab2=jlu;</span></div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span><span class="comment">              double* coeff=alu;</span></div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span><span class="comment">              double x;</span></div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span><span class="comment">              os &lt;&lt; &quot;termes diagonaux :&quot; &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span><span class="comment">              for (int num=0; num&lt;nn; num++) {</span></div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span><span class="comment">              x=coeff[num];</span></div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span><span class="comment">              os &lt;&lt; &quot;(&quot; &lt;&lt; num+1 &lt;&lt; &quot; , &quot; &lt;&lt; num+1 &lt;&lt; &quot;)  =  &quot; &lt;&lt; x &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span><span class="comment">              }</span></div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span><span class="comment">              os &lt;&lt; &quot;hors diagonale : &quot; &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span><span class="comment">              for ( num=0; num&lt;nn; num++) {</span></div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span><span class="comment">              os &lt;&lt; &quot;ligne &quot; &lt;&lt; num+1 &lt;&lt; &quot; : &quot;;</span></div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span><span class="comment">              int nb_vois=tab2[num+1]-tab2[num];</span></div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span><span class="comment">              double x=0.;</span></div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span><span class="comment">              for(int vois=0; vois&lt;nb_vois; vois++) {</span></div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span><span class="comment">              int num_vois=tab2[tab2[num]+vois-1];</span></div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span><span class="comment">              x=coeff[tab2[num]+vois-1];</span></div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span><span class="comment">              os &lt;&lt; &quot;(&quot; &lt;&lt; num_vois &lt;&lt; &quot; , &quot; &lt;&lt; x &lt;&lt; &quot; ) &quot; ;</span></div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span><span class="comment">              }</span></div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span><span class="comment">              os &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span><span class="comment">              }</span></div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span><span class="comment">              os.flush();</span></div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span><span class="comment">              }</span></div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span><span class="comment">            */</span></div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span><span class="comment">// Cerr &lt;&lt; &quot;     matrices L et U :  OK&quot; &lt;&lt; finl;</span></div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>          <span class="keywordflow">case</span> -1 :</div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut &#39;matrix may be wrong&#39; dixit SAAD&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>            <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>          <span class="keywordflow">case</span>  -2  :</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut : overflow in L &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>            <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>          <span class="keywordflow">case</span>   -3  :</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut : overflow in U &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>            <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>          <span class="keywordflow">case</span>    -4   :</div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Illegal value for lfil : it may be a memory trouble &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>            <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>          <span class="keywordflow">case</span>    -5  :</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Empty line met &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>            <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>          default :</div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>            <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Pivot null met ! at step &quot;</span> &lt;&lt; ie &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;;</div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>            <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>          }</div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>        prems=0;</div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>      }</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>  }</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span><span class="comment">// resol :</span></div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>  {</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>    vv.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nn*(ima+1));</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>    <a class="code hl_function" href="classMatrice__Base.html#a91c98b86a0bdce6ccc483dd453ef9ab2">multvect</a>(solution, Resini);</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>    Resini -= toto;</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>    r = <a class="code hl_function" href="TRUSTVect__tools_8tpp.html#a60579f2b9c6e65cce8d02f72f2ee653e">mp_norme_vect</a>(Resini);</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>    <a class="code hl_define" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot; Initial residu : &quot;</span> &lt;&lt; r &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span>    coeff_seuilr=coeff_seuil/r;</div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>    Resini=toto;</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>    <span class="keywordtype">int</span> minits = 10;</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>    <span class="keywordtype">int</span> maxits = std::max(minits, max_iter);</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>    <span class="keywordtype">int</span> io = 0;                                <span class="comment">//!&lt; fichier de sortie</span></div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span><span class="preprocessor">#ifndef CRAY</span></div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>    <a class="code hl_define" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(PGMRES)(&amp;nn, &amp;ima, toto.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), solution.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), vv.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), &amp;coeff_seuilr,</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>                    &amp;maxits, &amp;io, <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(),</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>                    alu.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), jlu.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), ju.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>(), &amp;ie);</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>    <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse PGMRES call invalid for CRAY&quot;</span>&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>    <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span> </div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span><span class="comment">// multvect(solution, Resini);</span></div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span><span class="comment">// Resini -= secmem;</span></div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span><span class="comment">// r=Resini.norme();</span></div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span><span class="comment">// Cerr &lt;&lt; &quot; Residu final : &quot; &lt;&lt; r &lt;&lt;&quot; coeff &quot;&lt;&lt;coeff_seuilr*r&lt;&lt;&quot; Its &quot;&lt;&lt;maxits&lt;&lt; finl;</span></div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>    <span class="keywordflow">switch</span>(ie)</div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>      {</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>      <span class="keywordflow">case</span> 0:</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;     ** PGMRES has converged ** &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;     ** No convergence after &quot;</span> &lt;&lt; maxits &lt;&lt; <span class="stringliteral">&quot; iterations **&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>        <span class="keywordflow">return</span>(0);</div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>        <span class="comment">/*else{</span></div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span><span class="comment">          if(ima==50)</span></div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span><span class="comment">          exit();</span></div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span><span class="comment">          Cerr &lt;&lt; &quot;  The degree of the Krylov space for PGMRES is increased :   &quot; &lt;&lt; (ima+=2) &lt;&lt; finl;</span></div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span><span class="comment">          Cerr &lt;&lt; &quot;    (=&gt; working array for pgmres at &quot; &lt;&lt; (nn*(ima+1)) &lt;&lt; &quot; elements.)&quot; &lt;&lt; finl;</span></div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span><span class="comment">          goto resol ;</span></div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span><span class="comment">// (DoubleVect&amp;) toto=Resini;</span></div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span><span class="comment">// if( lf&lt;50){</span></div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span><span class="comment">// lf +=5;</span></div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span><span class="comment">// Cerr &lt;&lt; &quot;  J&#39;augmente le degre de la matrice de precondition. LU:   &quot; &lt;&lt; lf &lt;&lt; finl;</span></div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span><span class="comment">// n2 = coeff_.size()+(2*lf*nn);</span></div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span><span class="comment">// prems=1;</span></div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span><span class="comment">// goto precond ;</span></div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span><span class="comment">// }</span></div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span><span class="comment">          }*/</span></div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>      <span class="keywordflow">case</span> -1:</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Convergence after &quot;</span> &lt;&lt; (int)0 &lt;&lt; <span class="stringliteral">&quot;iterations !! &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;&#39;stationnary state may be obtened&#39; dixit us &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>      default :</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something abnormal has happened : it is preferable to stop.&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>        <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>      }</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>  }</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>  <span class="keywordflow">return</span>(1);</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>}</div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span> </div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span> </div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span><span class="comment">// Parametre: DoubleVect&amp; x</span></div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span><span class="comment">// Signification: vecteur de scaling</span></div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span><span class="comment">// Contraintes: x.size() = nb ligne de la matrice</span></div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span><span class="comment">//</span></div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span><span class="comment">//</span></div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span><span class="comment">//</span></div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span><span class="comment">//</span></div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span><span class="comment">//! Operateur de multiplication d&#39;une matrice par un vecteur:&lt;br&gt;scaling des lignes de la matrice par les coefficients&lt;br&gt;correspondants du vecteur passe en parametre.&lt;br&gt;A *= x, effectue les scaling suivants:&lt;br&gt;A(i,:) = A(i,:) * x(i), pour toutes les lignes i de A</span></div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span><span class="comment"></span><span class="comment">/** \return Matrice_Morse\&amp;&lt;br&gt;</span></div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span><span class="comment">Signification: le resultat de l&#39;operation (*this)&lt;br&gt;</span></div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a3bf78034a1ed02f3721b406183577f59"> 1581</a></span><a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#a547bc77cbec07f7cb77f180d2a600149">Matrice_Morse::operator *=</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; x)</div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>{</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>  <span class="keywordtype">int</span> i,k;</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>  <span class="keywordflow">for</span>(i = 0; i&lt;<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>(); i++)</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>    <span class="keywordflow">for</span>(k = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>      <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) *= x(i);</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>}</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span> </div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span> </div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span><span class="comment">// Parametre: Matrice_Morse&amp; A</span></div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span><span class="comment">// Signification: une matrice au format Morse</span></div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span><span class="comment">// Acces: entree</span></div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span><span class="comment">// Parametre: Matrice_Morse&amp; B</span></div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span><span class="comment">// Signification: une matrice au format Morse</span></div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span><span class="comment">// Acces: entree</span></div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span><span class="comment">// Effets de bord: redimensionne la matrice en cas de besoin,</span></div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span><span class="comment">// si pas assez d&#39;espace pour les elements non nuls generes par le produit.</span></div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span><span class="comment">//</span></div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span><span class="comment">//! Affecte le produit de 2 matrices Morse A et B a l&#39;objet (this).&lt;br&gt;Operation: this = A * B</span></div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span><span class="comment"></span><span class="comment">/** \return Matrice_Morse\&amp;&lt;br&gt;</span></div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span><span class="comment">Signification: le resultat de l&#39;operation (*this)&lt;br&gt;</span></div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a1aa4f648fa4ada1731cd8ae41a8ec23e"> 1612</a></span><a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#a1aa4f648fa4ada1731cd8ae41a8ec23e">Matrice_Morse::affecte_prod</a>(<span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; a, <span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; b)</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>{</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>  <span class="keywordtype">int</span> nrow= a.<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();                <span class="comment">//!&lt; nb de lignes de A</span></div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>  <span class="keywordtype">int</span> ncol= b.<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>();                <span class="comment">//!&lt; nb de colonnes de B assert(nrow==ncol); Jloi non?</span></div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span><span class="comment">//</span></div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span><span class="comment">//</span></div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>  assert(nrow==ncol);</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nrow+1);</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>  <span class="keywordtype">int</span> job = 1 ;                      <span class="comment">//!&lt; on recupere tout (tab1, tab2, coeff de matrice_resu)</span></div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>  <span class="keywordtype">int</span>  nzmax = <a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>();                <span class="comment">//!&lt; nb de valeurs maximales de la matrice resultante</span></div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>  <span class="keywordflow">if</span>(nzmax==0)</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>    {</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>      nzmax=a.<a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>();</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>      <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nzmax);</div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>      <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nzmax);</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>      assert(nzmax==<a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>());</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>    }</div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>  <a class="code hl_class" href="classTRUSTVect.html">IntVect</a> iw(ncol+1);                        <span class="comment">//!&lt; tableau de travail</span></div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span> </div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span> </div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span><span class="comment">// Cerr &lt;&lt; &quot; iao1 &quot; &lt;&lt; a.tab1_ &lt;&lt; finl ;</span></div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span><span class="comment">// Cerr &lt;&lt; &quot; jao1 &quot; &lt;&lt; a.tab2_ &lt;&lt; finl ;</span></div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span><span class="comment">// Cerr &lt;&lt; &quot; aao1 &quot; &lt;&lt; a.coeff_ &lt;&lt; finl ;</span></div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span><span class="comment">// </span></div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span><span class="comment">// Cerr &lt;&lt; &quot; iao2 &quot; &lt;&lt; b.tab1_ &lt;&lt; finl ;</span></div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span><span class="comment">// Cerr &lt;&lt; &quot; jao2 &quot; &lt;&lt; b.tab2_ &lt;&lt; finl ;</span></div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span><span class="comment">// Cerr &lt;&lt; &quot; aao2 &quot; &lt;&lt; b.coeff_ &lt;&lt; finl ;</span></div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span> </div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span> </div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span><span class="comment">// while(ierr=0)</span></div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span><span class="comment">// {</span></div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span><span class="comment">// F77NAME(AMUB)(&amp;nb_lig, &amp;nb_col, &amp;job, A.coeff_, A.tab2_, A.tab1_,</span></div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span><span class="comment">// B.coeff_, B.tab2_, B.tab1_,</span></div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span><span class="comment">// coeff_.addr(), tab2_.addr(), tab1_.addr(), &amp;nzmax, iw, &amp;ierr);</span></div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span><span class="comment">// </span></div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span><span class="comment">// </span></div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span><span class="comment">// c----------------------------------------------------------------------c</span></div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span><span class="comment">// subroutine amub (nrow,ncol,job,a,ja,ia,b,jb,ib,</span></div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span><span class="comment">// *                 c,jc,ic,nzmax,iw,ierr)</span></div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span><span class="comment">// real*8 a(*), b(*), c(*)</span></div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span><span class="comment">// integer ja(*),jb(*),jc(*),ia(nrow+1),ib(ncol+1),</span></div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span><span class="comment">// *     ic(ncol+1),iw(ncol)</span></div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span><span class="comment">// c-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span><span class="comment">// c performs the matrix by matrix product C = A B</span></div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span><span class="comment">// c-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span><span class="comment">// c on entry:</span></div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span><span class="comment">// c ---------</span></div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span><span class="comment">// c nrow        = integer. The row dimension of A</span></div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span><span class="comment">// c ncol  = integer. The column dimension of B</span></div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span><span class="comment">// c job   = integer. Job indicator. When job = 0, only the structure</span></div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span><span class="comment">// c                  (i.e. the arrays jc, ic) is computed and the</span></div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span><span class="comment">// c                  real values are ignored.</span></div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span><span class="comment">// c</span></div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span><span class="comment">// c a,</span></div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span><span class="comment">// c ja,</span></div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span><span class="comment">// c ia   = Matrix A in compressed sparse row format.</span></div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span><span class="comment">// c</span></div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span><span class="comment">// c b,</span></div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span><span class="comment">// c jb,</span></div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span><span class="comment">// c ib        =  Matrix B in compressed sparse row format.</span></div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span><span class="comment">// c</span></div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span><span class="comment">// c nzmax        = integer. The  length of the arrays c and jc.</span></div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span><span class="comment">// c         amub will stop if the result matrix C  has a number</span></div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span><span class="comment">// c         of elements that exceeds exceeds nzmax. See ierr.</span></div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span><span class="comment">// c</span></div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span><span class="comment">// c on return:</span></div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span><span class="comment">// c----------</span></div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span><span class="comment">// c c,</span></div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span><span class="comment">// c jc,</span></div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span><span class="comment">// c ic        = resulting matrix C in compressed sparse row sparse format.</span></div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span><span class="comment">// c</span></div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span><span class="comment">// c ierr        = integer. serving as error message.</span></div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span><span class="comment">// c         ierr = 0 means normal return,</span></div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span><span class="comment">// c         ierr .gt. 0 means that amub stopped while computing the</span></div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span><span class="comment">// c         i-th row  of C with i=ierr, because the number</span></div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span><span class="comment">// c         of elements in C exceeds nzmax.</span></div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span><span class="comment">// c</span></div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span><span class="comment">// c work arrays:</span></div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span><span class="comment">// c------------</span></div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span><span class="comment">// c iw        = integer work array of length equal to the number of</span></div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span><span class="comment">// c         columns in A.</span></div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span><span class="comment">// c Notes:</span></div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span><span class="comment">// c-------</span></div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span><span class="comment">// c         The column dimension of B is not needed.</span></div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span><span class="comment">// c</span></div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span><span class="comment">// c-----------------------------------------------------------------</span></div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span><span class="comment">// real*8 scal</span></div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span><span class="comment">// logical values</span></div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span><span class="comment">// values = (job .ne. 0)</span></div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span><span class="comment">// len = 0</span></div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span><span class="comment">// ic(1) = 1</span></div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span><span class="comment">// ierr = 0</span></div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span><span class="comment">// c     initialize array iw.</span></div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span><span class="comment">// do 1 j=1, ncol</span></div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span><span class="comment">// iw(j) = 0</span></div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span><span class="comment">// 1    continue</span></div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span><span class="comment">// c</span></div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span> </div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>  <span class="keywordtype">double</span> scal=0. ;</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span>  <span class="keywordtype">int</span> ii, jj ,k , ka, kb ;</div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>  <span class="keywordtype">int</span> values = 0;</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>  <span class="keywordflow">if</span> (job != 0) values = 1 ;</div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>  <span class="keywordtype">int</span> len = -1 ;</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[0] = 1  ;</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>  iw = -1 ;</div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span> </div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span><span class="comment">// do 500 ii=1, nrow</span></div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span><span class="comment">// c     row i</span></div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span><span class="comment">// do 200 ka=ia(ii), ia(ii+1)-1</span></div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span><span class="comment">// if (values) scal = a(ka)</span></div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span><span class="comment">// jj   = ja(ka)</span></div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span><span class="comment">// do 100 kb=ib(jj),ib(jj+1)-1</span></div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span><span class="comment">// jcol = jb(kb)</span></div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span><span class="comment">// jpos = iw(jcol)</span></div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span><span class="comment">// if (jpos .eq. 0) then</span></div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span><span class="comment">// len = len+1</span></div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span><span class="comment">// if (len .gt. nzmax) then</span></div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span><span class="comment">// ierr = ii</span></div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span><span class="comment">// return</span></div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span><span class="comment">// endif</span></div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span><span class="comment">// jc(len) = jcol</span></div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span><span class="comment">// iw(jcol)= len</span></div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span><span class="comment">// if (values) c(len)  = scal*b(kb)</span></div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span><span class="comment">// else</span></div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span><span class="comment">// if (values) c(jpos) = c(jpos) + scal*b(kb)</span></div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span><span class="comment">// endif</span></div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span><span class="comment">// 100            continue</span></div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span><span class="comment">// 200     continue</span></div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span><span class="comment">// do 201 k=ic(ii), len</span></div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span><span class="comment">// iw(jc(k)) = 0</span></div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span><span class="comment">// 201     continue</span></div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span><span class="comment">// ic(ii+1) = len+1</span></div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span><span class="comment">// 500  continue</span></div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span> </div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span><span class="comment">// Cerr &lt;&lt; &quot;Matrice_Morse::affect_prod nrow &quot; &lt;&lt; nrow &lt;&lt; finl;</span></div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span> </div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span>  <span class="keywordflow">for</span>(ii=0; ii&lt; nrow; ii++)</div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>    {</div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span>      <span class="keywordflow">for</span>(ka=a.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[ii]-1; ka &lt; a.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[ii+1]-1; ka++)</div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>        {</div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>          <span class="keywordflow">if</span> (values == 1) scal = a.<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[ka] ;</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>          jj   = a.<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[ka] - 1 ;</div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span>          <span class="keywordflow">for</span> (kb=b.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[jj]-1; kb &lt; b.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[jj+1]-1; kb++)</div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>            {</div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>              <span class="keywordtype">int</span> jcol = b.<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kb] -1 ;</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>              <span class="keywordtype">int</span> jpos = iw[jcol]  ;</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>              <span class="keywordflow">if</span> (jpos == -1)</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>                {</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>                  len++ ;</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>                  <span class="keywordflow">if</span> (len &gt; nzmax-1)</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>                    {</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span><span class="comment">// Cerr &lt;&lt; &quot;Matrice_Morse::affect_prod len &gt; nzmax -1 &quot; &lt;&lt; nzmax &lt;&lt; finl;</span></div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>                      nzmax += nrow/ii*nzmax;</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span>                      <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nzmax);</div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span>                      <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(nzmax);</div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span>                    }</div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>                  <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[len] = jcol + 1 ;</div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>                  iw[jcol]= len ;</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span>                  <span class="keywordflow">if</span> (values == 1) <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[len]  = scal*b.<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kb] ;</div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>                }</div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>              <span class="keywordflow">else</span></div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>                {</div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>                  <span class="keywordflow">if</span> (values == 1) <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[jpos] += scal*b.<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kb] ;</div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span>                }</div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>            }</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span>        }</div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span> </div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>      <span class="keywordflow">for</span> (k=<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[ii]-1; k &lt; len+1 ; k++) iw[<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k]-1] = -1 ;</div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>      <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[ii+1] = (len+1) + 1 ;</div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>    }</div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span> </div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span><span class="comment">// return</span></div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span><span class="comment">// c-------------end-of-amub-----------------------------------------------</span></div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span><span class="comment">// c-----------------------------------------------------------------------</span></div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span><span class="comment">// </span></div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span><span class="comment">// if(ierr)</span></div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span><span class="comment">// {</span></div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span><span class="comment">// nzmax+=nrow/ierr*nzmax;</span></div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span><span class="comment">// coeff_.resize(nzmax);</span></div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span><span class="comment">// tab2_.resize(nzmax);</span></div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span><span class="comment">// }</span></div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span><span class="comment">// </span></div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span><span class="comment">// }</span></div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span> </div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[nrow]-1);</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">resize</a>(<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[nrow]-1);</div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span> </div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>}</div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span> </div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span> </div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span> </div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span><span class="comment">// Parametre: double x</span></div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span><span class="comment">// Signification: valeur du scaling</span></div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span><span class="comment">// Acces: entree</span></div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span><span class="comment">// Parametre: Matrice_Morse&amp; B</span></div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span><span class="comment">// Signification: une matrice au format Morse</span></div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span><span class="comment">// Acces: entree</span></div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span><span class="comment">//</span></div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span><span class="comment">//</span></div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span><span class="comment">//</span></div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span><span class="comment">//! Fonction (hors classe) amie de la classe Matrice_Morse&lt;br&gt;Scaling de la matrice par un scalaire: multiplie tous&lt;br&gt;les elements de la matrice par un scalaire.&lt;br&gt;Operation: renvoie x*A</span></div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span><span class="comment"></span><span class="comment">/** \return Matrice_Morse&lt;br&gt;</span></div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span><span class="comment">Signification: le resultat de l&#39;operation&lt;br&gt;</span></div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span><span class="comment">Contraintes: la matrice resultat est allouee par la fonction */</span></div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#afc77ba81a0a4335b418508f9bae4941c"> 1827</a></span><a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a> <a class="code hl_function" href="Matrice__Morse_8cpp.html#a11ec4963b0fdb75675b5a1603f073c5b">operator *</a>(<span class="keywordtype">double</span> x , <span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; A)</div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>{</div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>  <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a> mat_res(A);</div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>  mat_res.<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>*=x;</div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>  <span class="keywordflow">return</span>(mat_res);</div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>}</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span> </div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span><span class="comment">// Parametre:</span></div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span><span class="comment">// Signification:</span></div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span><span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span></div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span><span class="comment">//</span></div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span><span class="comment">//! Operateur de negation unaire, renvoie l&#39;opposee de la matrice: - A&lt;br&gt;Appelle operator*(double,const Matrice_Morse\&amp;)</span></div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span><span class="comment"></span><span class="comment">/** \return Matrice_Morse&lt;br&gt;</span></div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span><span class="comment">Signification: le resultat de l&#39;appel a operator*(double,const Matrice_Morse\&amp;)&lt;br&gt;</span></div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#adeb4633c27ae3aed97dc6a2fbe84f69a"> 1849</a></span><a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a> <a class="code hl_function" href="classMatrice__Morse.html#adeb4633c27ae3aed97dc6a2fbe84f69a">Matrice_Morse::operator -</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>  <span class="keywordflow">return</span>((-1)*(*<span class="keyword">this</span>));</div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>}</div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span> </div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span> </div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span><span class="comment">// Parametre: Matrice_Morse&amp;</span></div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span><span class="comment">// Signification: une matrice morse</span></div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span><span class="comment">// Acces: NON ACCEDE</span></div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span><span class="comment">//! NE FAIT RIEN</span></div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span><span class="comment"></span><span class="comment">/** \return Matrice_Morse\&amp;&lt;br&gt;</span></div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span><span class="comment">Signification: renvoie toujours *this&lt;br&gt;</span></div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#ac77dbfcd9310f3b356ad3d2766a5f100"> 1869</a></span><a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#ac77dbfcd9310f3b356ad3d2766a5f100">Matrice_Morse::operator +=</a>(<span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; A)</div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span>{</div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span><span class="comment">// PL: Avant de verifier de faire des operations couteuses en RAM, on verifie</span></div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span><span class="comment">// si ce n&#39;est pas la meme structure:</span></div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="classMatrice__Morse.html#ad850cee630fca99173c2219659fa3ecb">has_same_morse_matrix_structure</a>(A))</div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>    {</div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>      <span class="keywordtype">int</span> size = A.<a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>();</div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>      <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; <a class="code hl_variable" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = A.<a class="code hl_function" href="classMatrice__Morse.html#a4a61f874a8a3ed671bbe60168a5855ac">get_coeff</a>();</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;size; i++)</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>        <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(i)+=<a class="code hl_variable" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(i);</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>    }</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>    {</div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>      *<span class="keyword">this</span> = *<span class="keyword">this</span> + A;</div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span>      <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a> = 1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>    }</div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span>  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>}</div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span> </div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span> </div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span><span class="comment">// Parametre: double x</span></div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span><span class="comment">// Signification: le parametre de scaling</span></div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span><span class="comment">//</span></div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span><span class="comment">//</span></div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span><span class="comment">//! Operateur de multiplication (de tous les elements)&lt;br&gt;d&#39;une matrice par un scalaire.&lt;br&gt;Operation: A = x * A</span></div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span><span class="comment"></span><span class="comment">/** \return Matrice_Morse\&amp;&lt;br&gt;</span></div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span><span class="comment">Signification: le resultat de l&#39;operation (*this)&lt;br&gt;</span></div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a547bc77cbec07f7cb77f180d2a600149"> 1905</a></span><a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#a547bc77cbec07f7cb77f180d2a600149">Matrice_Morse::operator *=</a>(<span class="keywordtype">double</span> x )</div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>{</div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>  <a class="code hl_function" href="classMatrice__Morse.html#a63efece8f47f264f288a1a4a1ef271c9">scale</a>( x );</div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>}</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span> </div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a63efece8f47f264f288a1a4a1ef271c9"> 1911</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#a63efece8f47f264f288a1a4a1ef271c9">Matrice_Morse::scale</a>( <span class="keyword">const</span> <span class="keywordtype">double</span> x )</div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>{</div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> *= x;</div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span>}</div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span> </div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a4f528c2a17bbdaed073a98702c33ee66"> 1916</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#a4f528c2a17bbdaed073a98702c33ee66">Matrice_Morse::get_stencil</a>( <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; stencil )<span class="keyword"> const</span></div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>  <a class="code hl_function" href="classMatrice__Morse.html#af852d9fa4d3ee121b87adfcf1cd2a14e">assert_check_morse_matrix_structure</a>( );</div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span> </div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>  <span class="keywordflow">if</span>( <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> )</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>    {</div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>      stencil = <a class="code hl_variable" href="classMatrice__Base.html#af782c401617e7acfef8cab70457f9b55">stencil_</a>;</div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>    }</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span> </div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span> </div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span>  stencil.<a class="code hl_function" href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">resize</a>( 0, 2 );</div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span>  stencil.<a class="code hl_function" href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">resize</a>(<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>(), 2);</div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span>  stencil.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>( 1 );</div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span> </div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a> tmp;</div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>  tmp.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>( 1 );</div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span> </div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> = 0;</div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span> </div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>( );</div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )</div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span>    {</div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>      <span class="keywordtype">int</span> k0   = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>      <span class="keywordtype">int</span> k1   = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;</div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>      <span class="keywordtype">int</span> size = k1 - k0;</div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span> </div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>      tmp.<a class="code hl_function" href="classTRUSTArray.html#a7fdab39e76f6cb0f5a5691eaaee32d8c">resize_array</a>( 0 );</div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span>      tmp.<a class="code hl_function" href="classTRUSTArray.html#a7fdab39e76f6cb0f5a5691eaaee32d8c">resize_array</a>( size );</div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span> </div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span>      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )</div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span>        {</div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span>          tmp[ k ] = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k + k0 ) - 1;</div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>        }</div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span> </div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span>      tmp.<a class="code hl_function" href="classTRUSTArray.html#a6380491c50b8df1bc144b70836b73da5">ordonne_array</a>( );</div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span> </div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span>      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )</div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>        {</div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span>          stencil( k+<a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> , 0 ) = i;</div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span>          stencil( k+<a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> , 1 ) =  tmp[ k ];</div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span>        }</div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>      <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> += size;</div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>    }</div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span> </div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>  stencil.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>( 0 );</div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>}</div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span> </div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#afa44c8ee785f2b0c7a3c5b3c2a3e947c"> 1964</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#afa44c8ee785f2b0c7a3c5b3c2a3e947c">Matrice_Morse::get_stencil_and_coefficients</a>( <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp;      stencil,</div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>                                                  <a class="code hl_class" href="classTRUSTArray.html">ArrOfDouble</a>&amp; coefficients )<span class="keyword"> const</span></div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>  <a class="code hl_function" href="classMatrice__Morse.html#af852d9fa4d3ee121b87adfcf1cd2a14e">assert_check_morse_matrix_structure</a>( );</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span> </div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>  <span class="keywordflow">if</span>( <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> )</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>    {</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>      <span class="keywordflow">if</span>( <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTVect.html#ae94cb18641c81d97b4011f129dba7ba9">size</a>( ) == 0 )</div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span>        {</div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>          <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Matrice_Morse::get_stencil_and_coefficients( )&quot;</span>&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span>          <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  The coefficients are not filled.&quot;</span>&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span>          <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  Aborting...&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>          <a class="code hl_function" href="classProcess.html#a6a4b64571b10f150a70db229b839e881">Process::abort</a>( );</div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>        }</div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>      stencil = <a class="code hl_variable" href="classMatrice__Base.html#af782c401617e7acfef8cab70457f9b55">stencil_</a> ;</div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span>      coefficients = <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> ;</div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>    }</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span> </div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>  stencil.<a class="code hl_function" href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">resize</a>( 0, 2 );</div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span>  stencil.<a class="code hl_function" href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">resize</a>(<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>(), 2);</div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span>  stencil.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>( 1 );</div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span> </div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span>  coefficients.<a class="code hl_function" href="classTRUSTArray.html#a33bd14600da6b68883e6a74e3cb2db13">resize</a>( 0 );</div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>  coefficients.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>( 1 );</div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span>  coefficients.<a class="code hl_function" href="classTRUSTArray.html#a33bd14600da6b68883e6a74e3cb2db13">resize</a>(<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>());</div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span> </div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span>  <a class="code hl_class" href="classTRUSTTab.html">IntTab</a> tmp1(0);</div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>  tmp1.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>( 1 );</div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span> </div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfDouble</a> tmp2;</div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>  tmp2.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>( 1 );</div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span> </div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a> index;</div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span>  index.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>( 1 );</div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span> </div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> = 0;</div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span> </div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>( );</div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )</div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>    {</div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>      <span class="keywordtype">int</span> k0   = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;</div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span>      <span class="keywordtype">int</span> k1   = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;</div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>      <span class="keywordtype">int</span> size = k1 - k0;</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span> </div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>      tmp1.<a class="code hl_function" href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">resize</a>( 0 );</div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span>      tmp1.<a class="code hl_function" href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">resize</a>( size );</div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span> </div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>      tmp2.<a class="code hl_function" href="classTRUSTArray.html#a7fdab39e76f6cb0f5a5691eaaee32d8c">resize_array</a>( 0 );</div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span>      tmp2.<a class="code hl_function" href="classTRUSTArray.html#a7fdab39e76f6cb0f5a5691eaaee32d8c">resize_array</a>( size );</div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span> </div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span>      index.<a class="code hl_function" href="classTRUSTArray.html#a7fdab39e76f6cb0f5a5691eaaee32d8c">resize_array</a>( 0 );</div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span> </div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span>      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )</div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span>        {</div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span>          tmp1( k ) = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k + k0 ) - 1;</div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span>          tmp2[ k ] = <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>( k + k0 );</div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span>        }</div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span> </div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>      <a class="code hl_function" href="Array__tools_8cpp.html#ad62171ccb6e8fd4b2be47d286c164999">tri_lexicographique_tableau_indirect</a>( tmp1, index );</div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span> </div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span>      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>        {</div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>          <span class="keywordtype">int</span> l = index[ k ];</div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span>          stencil( <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> + k , 0 ) = i;</div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span>          stencil( <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> + k , 1 ) = tmp1[ l ];</div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span>          coefficients[ <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> + k ] = tmp2[ l ];</div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span>        }</div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span>      <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> += size;</div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span>    }</div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span> </div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span>  assert( coefficients.<a class="code hl_function" href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">size_array</a>( ) == stencil.<a class="code hl_function" href="classTRUSTTab.html#a8fecd3f1f3a13e933c3f767a25c54805">dimension</a>( 0 ));</div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span> </div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span>  stencil.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>( 0 );</div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span> </div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span>  coefficients.<a class="code hl_function" href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">set_smart_resize</a>( 0 );</div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span>}</div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span> </div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span><span class="comment">// Parametre: double x</span></div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span><span class="comment">// Signification: le parametre de scaling</span></div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span><span class="comment">// Contraintes: x doit etre different de zero</span></div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span><span class="comment">// Exception: division par zero impossible</span></div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"> 2050</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span><span class="comment">//</span></div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span><span class="comment">//</span></div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span><span class="comment">//! Operateur de division (de tous les elements)&lt;br&gt;d&#39;une matrice par un scalaire.&lt;br&gt;Operation: A =  A / x</span></div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span><span class="comment"></span><span class="comment">/** \return Matrice_Morse\&amp;&lt;br&gt;</span></div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span><span class="comment">Signification: le resultat de l&#39;operation (*this)&lt;br&gt;</span></div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a6e0753ddc2866580a7716588fafff24e"> 2058</a></span><a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; <a class="code hl_function" href="classMatrice__Morse.html#a6e0753ddc2866580a7716588fafff24e">Matrice_Morse::operator /=</a>(<span class="keywordtype">double</span> x )</div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span>{</div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>/=x;</div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span>  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);</div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span>}</div>
<div class="line"><a id="l02063" name="l02063"></a><span class="lineno"> 2063</span> </div>
<div class="line"><a id="l02064" name="l02064"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d"> 2064</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">Matrice_Morse::remplir</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTLists.html">IntLists</a>&amp; voisins,</div>
<div class="line"><a id="l02065" name="l02065"></a><span class="lineno"> 2065</span>                            <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTLists.html">DoubleLists</a>&amp; valeurs,</div>
<div class="line"><a id="l02066" name="l02066"></a><span class="lineno"> 2066</span>                            <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; terme_diag)</div>
<div class="line"><a id="l02067" name="l02067"></a><span class="lineno"> 2067</span>{</div>
<div class="line"><a id="l02068" name="l02068"></a><span class="lineno"> 2068</span> </div>
<div class="line"><a id="l02069" name="l02069"></a><span class="lineno"> 2069</span>  <span class="keywordtype">int</span> num_elem;</div>
<div class="line"><a id="l02070" name="l02070"></a><span class="lineno"> 2070</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>,rang =0;</div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span> </div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span><span class="comment">// Remplissage des tableaux tab1, tab2 et coeff_ :</span></div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>  <span class="keywordtype">int</span>* p_tab1 = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>();</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span>  <span class="keywordtype">int</span>* p_tab2 = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>();</div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span>  <span class="keywordtype">double</span>* p_coeff = <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>();</div>
<div class="line"><a id="l02076" name="l02076"></a><span class="lineno"> 2076</span> </div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span>  <span class="keywordtype">int</span>* tab2_ptr = p_tab2;</div>
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"> 2078</span>  <span class="keywordtype">int</span> n=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span> </div>
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"> 2080</span>  <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;n; num_elem++)</div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>    {</div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span> </div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span>      <a class="code hl_class" href="classTRUSTList__Curseur.html">IntList_Curseur</a> liste_vois(voisins[num_elem]);</div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span>      <a class="code hl_class" href="classTRUSTList__Curseur.html">DoubleList_Curseur</a> liste_val(valeurs[num_elem]);</div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span>      <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> =0;</div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span>      *p_tab1++ = rang;</div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span> </div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span>      *tab2_ptr++=num_elem;</div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span>      *p_coeff++ = terme_diag[num_elem];</div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span> </div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>      <span class="keywordflow">while</span>  (liste_vois)</div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span>        {</div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span>          *tab2_ptr++ = liste_vois.<a class="code hl_function" href="classTRUSTList__Curseur.html#a66755d0cacb3248751be784538d9d7e3">valeur</a>();</div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span>          *p_coeff++ = liste_val.<a class="code hl_function" href="classTRUSTList__Curseur.html#a66755d0cacb3248751be784538d9d7e3">valeur</a>();</div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span>          ++liste_vois;</div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span>          ++liste_val;</div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span>          <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>++;</div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>        }</div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span><span class="comment">// tab2[rang] = compteur;</span></div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span>      rang += (<a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> + 1);</div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span>    }</div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(num_elem)=rang;</div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span>  <a class="code hl_function" href="classMatrice__Morse.html#a3bcd59ac30cd776ea695a8c8f2d2776d">formeF</a>();</div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>  <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>}</div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span> </div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a0477806560509033e4b46b0b65ac6deb"> 2108</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">Matrice_Morse::remplir</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTLists.html">IntLists</a>&amp; voisins,</div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span>                            <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTLists.html">DoubleLists</a>&amp; valeurs)</div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span>{</div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span> </div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span>  <span class="keywordtype">int</span> num_elem;</div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>,rang =0;</div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span> </div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span><span class="comment">// Remplissage des tableaux tab1, tab2 et coeff_ :</span></div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span>  <span class="keywordtype">int</span>* p_tab1 = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>();</div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span>  <span class="keywordtype">int</span>* p_tab2 = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>();</div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span>  <span class="keywordtype">double</span>* p_coeff = <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>();</div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span> </div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span>  <span class="keywordtype">int</span>* tab2_ptr = p_tab2;</div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span>  <span class="keywordtype">int</span> n=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span> </div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span>  <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;n; num_elem++)</div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span>    {</div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span> </div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span>      <a class="code hl_class" href="classTRUSTList__Curseur.html">IntList_Curseur</a> liste_vois(voisins[num_elem]);</div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>      <a class="code hl_class" href="classTRUSTList__Curseur.html">DoubleList_Curseur</a> liste_val(valeurs[num_elem]);</div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span>      <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> =0;</div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span>      *p_tab1++ = rang;</div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span> </div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span>      <span class="keywordflow">while</span>  (liste_vois)</div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span>        {</div>
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"> 2133</span>          *tab2_ptr++ = liste_vois.<a class="code hl_function" href="classTRUSTList__Curseur.html#a66755d0cacb3248751be784538d9d7e3">valeur</a>();</div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span>          *p_coeff++ = liste_val.<a class="code hl_function" href="classTRUSTList__Curseur.html#a66755d0cacb3248751be784538d9d7e3">valeur</a>();</div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span>          ++liste_vois;</div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span>          ++liste_val;</div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span>          <a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>++;</div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span>        }</div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span><span class="comment">// tab2[rang] = compteur;</span></div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span>      rang += (<a class="code hl_variable" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>);</div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span>    }</div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(num_elem)=rang;</div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span>  <a class="code hl_function" href="classMatrice__Morse.html#a3bcd59ac30cd776ea695a8c8f2d2776d">formeF</a>();</div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span>  <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span>}</div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span> </div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span><span class="comment">//! Remplissage d&#39;une matrice morse par une matrice morse plus petite</span></div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a0b13859051ee9505b3beb82ceb94c116"> 2150</a></span><span class="comment"></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">Matrice_Morse::remplir</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> ideb, <span class="keyword">const</span> <span class="keywordtype">int</span> jdeb, <span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> m, <span class="keyword">const</span> <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; mat)</div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span>{</div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span><span class="comment">// Verification</span></div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span>  assert(ideb&lt;=n);</div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span>  assert(jdeb&lt;=m);</div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span> </div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span><span class="comment">// On va construire une matrice locale</span></div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span>  <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a> matrice_locale(mat);</div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span><span class="comment">// Cas ou la matrice locale est symetrique</span></div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a>,mat))</div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span>    {</div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span><span class="comment">// Creation de la partie inferieure L</span></div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span>      <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a> L(matrice_locale);</div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span>      L.<a class="code hl_function" href="classMatrice__Morse.html#a9859a88c59daf0b968b3c5090e18f264">transpose</a>(matrice_locale);</div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span>      <span class="keywordtype">int</span> lordre = L.<a class="code hl_function" href="classMatrice__Morse.html#a7b783ffdef610de0ed645b15d8c0bf56">ordre</a>();</div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;lordre; i++)</div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span>        L(i, i) = 0.;</div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span><span class="comment">// On ajoute M=U+L</span></div>
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"> 2168</span>      matrice_locale += L;</div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span>    }</div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span> </div>
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"> 2171</span><span class="comment">// Dimensionnement de la matrice globale</span></div>
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"> 2172</span>  <span class="keywordtype">int</span> nnz=matrice_locale.<a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>();</div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span>  <a class="code hl_function" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">dimensionner</a>(n,m,nnz);</div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span> </div>
<div class="line"><a id="l02175" name="l02175"></a><span class="lineno"> 2175</span><span class="comment">// Remplissage de la matrice globale par la matrice locale:</span></div>
<div class="line"><a id="l02176" name="l02176"></a><span class="lineno"> 2176</span><span class="comment">// Remplissage de tab1_ avec le decalage par ideb:</span></div>
<div class="line"><a id="l02177" name="l02177"></a><span class="lineno"> 2177</span>  <span class="keywordtype">int</span> mon_nb_lignes=matrice_locale.<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l02178" name="l02178"></a><span class="lineno"> 2178</span>  assert(mon_nb_lignes+ideb&lt;=n);</div>
<div class="line"><a id="l02179" name="l02179"></a><span class="lineno"> 2179</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ideb; i++)</div>
<div class="line"><a id="l02180" name="l02180"></a><span class="lineno"> 2180</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)=1;</div>
<div class="line"><a id="l02181" name="l02181"></a><span class="lineno"> 2181</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;mon_nb_lignes; i++)</div>
<div class="line"><a id="l02182" name="l02182"></a><span class="lineno"> 2182</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+ideb)=matrice_locale.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i);</div>
<div class="line"><a id="l02183" name="l02183"></a><span class="lineno"> 2183</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=mon_nb_lignes+ideb; i&lt;n+1; i++)</div>
<div class="line"><a id="l02184" name="l02184"></a><span class="lineno"> 2184</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)=matrice_locale.<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(mon_nb_lignes);</div>
<div class="line"><a id="l02185" name="l02185"></a><span class="lineno"> 2185</span> </div>
<div class="line"><a id="l02186" name="l02186"></a><span class="lineno"> 2186</span><span class="comment">// Remplissage de tab2_ avec le decalage par jdeb:</span></div>
<div class="line"><a id="l02187" name="l02187"></a><span class="lineno"> 2187</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nnz; i++)</div>
<div class="line"><a id="l02188" name="l02188"></a><span class="lineno"> 2188</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(i)=matrice_locale.<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(i)+jdeb;</div>
<div class="line"><a id="l02189" name="l02189"></a><span class="lineno"> 2189</span> </div>
<div class="line"><a id="l02190" name="l02190"></a><span class="lineno"> 2190</span><span class="comment">// Remplissage de coeff_:</span></div>
<div class="line"><a id="l02191" name="l02191"></a><span class="lineno"> 2191</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nnz; i++)</div>
<div class="line"><a id="l02192" name="l02192"></a><span class="lineno"> 2192</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(i)=matrice_locale.<a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(i);</div>
<div class="line"><a id="l02193" name="l02193"></a><span class="lineno"> 2193</span> </div>
<div class="line"><a id="l02194" name="l02194"></a><span class="lineno"> 2194</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1, <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 0;</div>
<div class="line"><a id="l02195" name="l02195"></a><span class="lineno"> 2195</span>  <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l02196" name="l02196"></a><span class="lineno"> 2196</span>}</div>
<div class="line"><a id="l02197" name="l02197"></a><span class="lineno"> 2197</span> </div>
<div class="line"><a id="l02198" name="l02198"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a8bafab20c667e1bed56a463ffb30e349"> 2198</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#a8bafab20c667e1bed56a463ffb30e349">Matrice_Morse::formeC</a>()</div>
<div class="line"><a id="l02199" name="l02199"></a><span class="lineno"> 2199</span>{</div>
<div class="line"><a id="l02200" name="l02200"></a><span class="lineno"> 2200</span>  <span class="keywordtype">int</span> ii, k;</div>
<div class="line"><a id="l02201" name="l02201"></a><span class="lineno"> 2201</span>  <span class="keywordtype">int</span> n=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l02202" name="l02202"></a><span class="lineno"> 2202</span>  <span class="keywordflow">for</span>( ii=0; ii&lt;=n; ii++)</div>
<div class="line"><a id="l02203" name="l02203"></a><span class="lineno"> 2203</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(ii)--;</div>
<div class="line"><a id="l02204" name="l02204"></a><span class="lineno"> 2204</span>  <span class="keywordflow">for</span>( ii=0; ii&lt;n; ii++)</div>
<div class="line"><a id="l02205" name="l02205"></a><span class="lineno"> 2205</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(ii))=<a class="code hl_function" href="classMatrice__Morse.html#a66eb615830b9e439123e6af27a8c2e4e">nb_vois</a>(ii);</div>
<div class="line"><a id="l02206" name="l02206"></a><span class="lineno"> 2206</span>  <span class="keywordflow">for</span>(k=0; k&lt;<a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>(); k++)</div>
<div class="line"><a id="l02207" name="l02207"></a><span class="lineno"> 2207</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)--;</div>
<div class="line"><a id="l02208" name="l02208"></a><span class="lineno"> 2208</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1;</div>
<div class="line"><a id="l02209" name="l02209"></a><span class="lineno"> 2209</span>  <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l02210" name="l02210"></a><span class="lineno"> 2210</span>}</div>
<div class="line"><a id="l02211" name="l02211"></a><span class="lineno"> 2211</span> </div>
<div class="line"><a id="l02212" name="l02212"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a3bcd59ac30cd776ea695a8c8f2d2776d"> 2212</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#a3bcd59ac30cd776ea695a8c8f2d2776d">Matrice_Morse::formeF</a>()</div>
<div class="line"><a id="l02213" name="l02213"></a><span class="lineno"> 2213</span>{</div>
<div class="line"><a id="l02214" name="l02214"></a><span class="lineno"> 2214</span>  <span class="keywordtype">int</span> ii, k;</div>
<div class="line"><a id="l02215" name="l02215"></a><span class="lineno"> 2215</span>  <span class="keywordtype">int</span> n=<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>();</div>
<div class="line"><a id="l02216" name="l02216"></a><span class="lineno"> 2216</span>  <span class="keywordflow">for</span>( ii=0; ii&lt;=n; ii++)</div>
<div class="line"><a id="l02217" name="l02217"></a><span class="lineno"> 2217</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(ii)++;</div>
<div class="line"><a id="l02218" name="l02218"></a><span class="lineno"> 2218</span>  <span class="keywordflow">for</span>(k=0; k&lt;<a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>(); k++)</div>
<div class="line"><a id="l02219" name="l02219"></a><span class="lineno"> 2219</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)++;</div>
<div class="line"><a id="l02220" name="l02220"></a><span class="lineno"> 2220</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=1;</div>
<div class="line"><a id="l02221" name="l02221"></a><span class="lineno"> 2221</span>  <a class="code hl_variable" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l02222" name="l02222"></a><span class="lineno"> 2222</span>}</div>
<div class="line"><a id="l02223" name="l02223"></a><span class="lineno"> 2223</span> </div>
<div class="line"><a id="l02224" name="l02224"></a><span class="lineno"> 2224</span> </div>
<div class="line"><a id="l02225" name="l02225"></a><span class="lineno"> 2225</span> </div>
<div class="line"><a id="l02226" name="l02226"></a><span class="lineno"> 2226</span> </div>
<div class="line"><a id="l02227" name="l02227"></a><span class="lineno"> 2227</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l02228" name="l02228"></a><span class="lineno"> 2228</span><span class="comment">// Parametre:</span></div>
<div class="line"><a id="l02229" name="l02229"></a><span class="lineno"> 2229</span><span class="comment">// Signification:</span></div>
<div class="line"><a id="l02230" name="l02230"></a><span class="lineno"> 2230</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l02231" name="l02231"></a><span class="lineno"> 2231</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l02232" name="l02232"></a><span class="lineno"> 2232</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l02233" name="l02233"></a><span class="lineno"> 2233</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l02234" name="l02234"></a><span class="lineno"> 2234</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l02235" name="l02235"></a><span class="lineno"> 2235</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l02236" name="l02236"></a><span class="lineno"> 2236</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l02237" name="l02237"></a><span class="lineno"> 2237</span><span class="comment">//! NE FAIT RIEN</span></div>
<div class="line"><a id="l02238" name="l02238"></a><span class="lineno"> 2238</span><span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span></div>
<div class="line"><a id="l02239" name="l02239"></a><span class="lineno"> 2239</span><span class="comment">Signification: renvoie toujours 1&lt;br&gt;</span></div>
<div class="line"><a id="l02240" name="l02240"></a><span class="lineno"> 2240</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l02241" name="l02241"></a><span class="lineno"><a class="line" href="Matrice__Morse_8cpp.html#a12a6ca74ab7a7c08a8eff461782112c6"> 2241</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="Matrice__Morse_8cpp.html#a12a6ca74ab7a7c08a8eff461782112c6">Matrice_Morse_test</a>()</div>
<div class="line"><a id="l02242" name="l02242"></a><span class="lineno"> 2242</span>{</div>
<div class="line"><a id="l02243" name="l02243"></a><span class="lineno"> 2243</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l02244" name="l02244"></a><span class="lineno"> 2244</span>}</div>
<div class="line"><a id="l02245" name="l02245"></a><span class="lineno"> 2245</span> </div>
<div class="line"><a id="l02246" name="l02246"></a><span class="lineno"> 2246</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l02247" name="l02247"></a><span class="lineno"> 2247</span><span class="comment">// Parametre:</span></div>
<div class="line"><a id="l02248" name="l02248"></a><span class="lineno"> 2248</span><span class="comment">// Signification:</span></div>
<div class="line"><a id="l02249" name="l02249"></a><span class="lineno"> 2249</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l02250" name="l02250"></a><span class="lineno"> 2250</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l02251" name="l02251"></a><span class="lineno"> 2251</span><span class="comment">// Acces:</span></div>
<div class="line"><a id="l02252" name="l02252"></a><span class="lineno"> 2252</span><span class="comment">// </span></div>
<div class="line"><a id="l02253" name="l02253"></a><span class="lineno"> 2253</span><span class="comment">// Signification:</span></div>
<div class="line"><a id="l02254" name="l02254"></a><span class="lineno"> 2254</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l02255" name="l02255"></a><span class="lineno"> 2255</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l02256" name="l02256"></a><span class="lineno"> 2256</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l02257" name="l02257"></a><span class="lineno"> 2257</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l02258" name="l02258"></a><span class="lineno"> 2258</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l02259" name="l02259"></a><span class="lineno"> 2259</span><span class="comment">//! Remplit la matrice avec des zeros.</span></div>
<div class="line"><a id="l02260" name="l02260"></a><span class="lineno"> 2260</span><span class="comment"></span> </div>
<div class="line"><a id="l02261" name="l02261"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a3fe9dc9cd6e414e6781b2dcba28acf1f"> 2261</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#a3fe9dc9cd6e414e6781b2dcba28acf1f">Matrice_Morse::clean</a>()</div>
<div class="line"><a id="l02262" name="l02262"></a><span class="lineno"> 2262</span>{</div>
<div class="line"><a id="l02263" name="l02263"></a><span class="lineno"> 2263</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code hl_function" href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">nb_coeff</a>(); i++)</div>
<div class="line"><a id="l02264" name="l02264"></a><span class="lineno"> 2264</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[i]=0.;</div>
<div class="line"><a id="l02265" name="l02265"></a><span class="lineno"> 2265</span>}</div>
<div class="line"><a id="l02266" name="l02266"></a><span class="lineno"> 2266</span> </div>
<div class="line"><a id="l02267" name="l02267"></a><span class="lineno"> 2267</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l02268" name="l02268"></a><span class="lineno"> 2268</span><span class="comment">// Parametre:</span></div>
<div class="line"><a id="l02269" name="l02269"></a><span class="lineno"> 2269</span><span class="comment">// </span></div>
<div class="line"><a id="l02270" name="l02270"></a><span class="lineno"> 2270</span><span class="comment">// Signification:</span></div>
<div class="line"><a id="l02271" name="l02271"></a><span class="lineno"> 2271</span><span class="comment">// Contraintes:</span></div>
<div class="line"><a id="l02272" name="l02272"></a><span class="lineno"> 2272</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l02273" name="l02273"></a><span class="lineno"> 2273</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l02274" name="l02274"></a><span class="lineno"> 2274</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l02275" name="l02275"></a><span class="lineno"> 2275</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l02276" name="l02276"></a><span class="lineno"> 2276</span><span class="comment">//! Calcule la largeur de bande d&#39;une matrice morse</span></div>
<div class="line"><a id="l02277" name="l02277"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a197676c917c6ce269eefbb3be171cb73"> 2277</a></span><span class="comment"></span><span class="keywordtype">int</span> <a class="code hl_function" href="classMatrice__Morse.html#a197676c917c6ce269eefbb3be171cb73">Matrice_Morse::largeur_de_bande</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l02278" name="l02278"></a><span class="lineno"> 2278</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02279" name="l02279"></a><span class="lineno"> 2279</span>  <span class="keywordtype">int</span> ldist,min = 0;</div>
<div class="line"><a id="l02280" name="l02280"></a><span class="lineno"> 2280</span>  <span class="keyword">const</span> <span class="keywordtype">int</span>* p_tab1_ = <a class="code hl_function" href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">get_tab1</a>().<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>();</div>
<div class="line"><a id="l02281" name="l02281"></a><span class="lineno"> 2281</span>  <span class="keyword">const</span> <span class="keywordtype">int</span>* p_tab2_ = <a class="code hl_function" href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">get_tab2</a>().<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>();</div>
<div class="line"><a id="l02282" name="l02282"></a><span class="lineno"> 2282</span>  <span class="keywordtype">int</span> N=<a class="code hl_function" href="classMatrice__Morse.html#a7b783ffdef610de0ed645b15d8c0bf56">ordre</a>();</div>
<div class="line"><a id="l02283" name="l02283"></a><span class="lineno"> 2283</span> </div>
<div class="line"><a id="l02284" name="l02284"></a><span class="lineno"> 2284</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;N; i++)</div>
<div class="line"><a id="l02285" name="l02285"></a><span class="lineno"> 2285</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = p_tab1_[i]; k &lt; p_tab1_[i+1]; k++)</div>
<div class="line"><a id="l02286" name="l02286"></a><span class="lineno"> 2286</span>      {</div>
<div class="line"><a id="l02287" name="l02287"></a><span class="lineno"> 2287</span>        <span class="keywordflow">if</span> (p_tab2_[k-1]-1&lt;N)</div>
<div class="line"><a id="l02288" name="l02288"></a><span class="lineno"> 2288</span>          {</div>
<div class="line"><a id="l02289" name="l02289"></a><span class="lineno"> 2289</span>            ldist = p_tab2_[k-1] - i;</div>
<div class="line"><a id="l02290" name="l02290"></a><span class="lineno"> 2290</span>            <span class="keywordflow">if</span>( min &lt; ldist ) min = ldist;</div>
<div class="line"><a id="l02291" name="l02291"></a><span class="lineno"> 2291</span>          }</div>
<div class="line"><a id="l02292" name="l02292"></a><span class="lineno"> 2292</span>      };</div>
<div class="line"><a id="l02293" name="l02293"></a><span class="lineno"> 2293</span>  <span class="keywordflow">return</span> min;</div>
<div class="line"><a id="l02294" name="l02294"></a><span class="lineno"> 2294</span>}</div>
<div class="line"><a id="l02295" name="l02295"></a><span class="lineno"> 2295</span> </div>
<div class="line"><a id="l02296" name="l02296"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#aad804c73c7c37d72bf6f34e0cdc5a702"> 2296</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classMatrice__Morse.html#aad804c73c7c37d72bf6f34e0cdc5a702">Matrice_Morse::check_morse_matrix_structure</a>( <span class="keywordtype">void</span> )<span class="keyword"> const</span></div>
<div class="line"><a id="l02297" name="l02297"></a><span class="lineno"> 2297</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02298" name="l02298"></a><span class="lineno"> 2298</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines   = <a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>( );</div>
<div class="line"><a id="l02299" name="l02299"></a><span class="lineno"> 2299</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_columns = <a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>( );</div>
<div class="line"><a id="l02300" name="l02300"></a><span class="lineno"> 2300</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_coefficients = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( nb_lines ) - 1;</div>
<div class="line"><a id="l02301" name="l02301"></a><span class="lineno"> 2301</span> </div>
<div class="line"><a id="l02302" name="l02302"></a><span class="lineno"> 2302</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#ae94cb18641c81d97b4011f129dba7ba9">size</a>( ) != nb_coefficients )</div>
<div class="line"><a id="l02303" name="l02303"></a><span class="lineno"> 2303</span>    {</div>
<div class="line"><a id="l02304" name="l02304"></a><span class="lineno"> 2304</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid tab2 size&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02305" name="l02305"></a><span class="lineno"> 2305</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02306" name="l02306"></a><span class="lineno"> 2306</span>    }</div>
<div class="line"><a id="l02307" name="l02307"></a><span class="lineno"> 2307</span> </div>
<div class="line"><a id="l02308" name="l02308"></a><span class="lineno"> 2308</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTVect.html#ae94cb18641c81d97b4011f129dba7ba9">size</a>( ) != nb_coefficients )</div>
<div class="line"><a id="l02309" name="l02309"></a><span class="lineno"> 2309</span>    {</div>
<div class="line"><a id="l02310" name="l02310"></a><span class="lineno"> 2310</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid coeff size&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02311" name="l02311"></a><span class="lineno"> 2311</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02312" name="l02312"></a><span class="lineno"> 2312</span>    }</div>
<div class="line"><a id="l02313" name="l02313"></a><span class="lineno"> 2313</span> </div>
<div class="line"><a id="l02314" name="l02314"></a><span class="lineno"> 2314</span>  <a class="code hl_class" href="classArrOfBit.html">ArrOfBit</a> flags( nb_columns );</div>
<div class="line"><a id="l02315" name="l02315"></a><span class="lineno"> 2315</span> </div>
<div class="line"><a id="l02316" name="l02316"></a><span class="lineno"> 2316</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )</div>
<div class="line"><a id="l02317" name="l02317"></a><span class="lineno"> 2317</span>    {</div>
<div class="line"><a id="l02318" name="l02318"></a><span class="lineno"> 2318</span>      flags = 0;</div>
<div class="line"><a id="l02319" name="l02319"></a><span class="lineno"> 2319</span> </div>
<div class="line"><a id="l02320" name="l02320"></a><span class="lineno"> 2320</span>      <span class="keywordtype">int</span> k0 = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;</div>
<div class="line"><a id="l02321" name="l02321"></a><span class="lineno"> 2321</span>      <span class="keywordtype">int</span> k1 = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;</div>
<div class="line"><a id="l02322" name="l02322"></a><span class="lineno"> 2322</span> </div>
<div class="line"><a id="l02323" name="l02323"></a><span class="lineno"> 2323</span>      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=k0; k&lt;k1; ++k )</div>
<div class="line"><a id="l02324" name="l02324"></a><span class="lineno"> 2324</span>        {</div>
<div class="line"><a id="l02325" name="l02325"></a><span class="lineno"> 2325</span>          <span class="keywordtype">int</span> j = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k ) - 1;</div>
<div class="line"><a id="l02326" name="l02326"></a><span class="lineno"> 2326</span> </div>
<div class="line"><a id="l02327" name="l02327"></a><span class="lineno"> 2327</span>          <span class="keywordflow">if</span> ( j &lt; 0 )</div>
<div class="line"><a id="l02328" name="l02328"></a><span class="lineno"> 2328</span>            {</div>
<div class="line"><a id="l02329" name="l02329"></a><span class="lineno"> 2329</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid column index (&lt;0): &quot;</span> &lt;&lt; j &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02330" name="l02330"></a><span class="lineno"> 2330</span>              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02331" name="l02331"></a><span class="lineno"> 2331</span>            }</div>
<div class="line"><a id="l02332" name="l02332"></a><span class="lineno"> 2332</span> </div>
<div class="line"><a id="l02333" name="l02333"></a><span class="lineno"> 2333</span>          <span class="keywordflow">if</span> ( j &gt;= nb_columns )</div>
<div class="line"><a id="l02334" name="l02334"></a><span class="lineno"> 2334</span>            {</div>
<div class="line"><a id="l02335" name="l02335"></a><span class="lineno"> 2335</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid column index (&gt;nb_cols): &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span> &lt;&lt; nb_columns &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02336" name="l02336"></a><span class="lineno"> 2336</span>              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02337" name="l02337"></a><span class="lineno"> 2337</span>            }</div>
<div class="line"><a id="l02338" name="l02338"></a><span class="lineno"> 2338</span> </div>
<div class="line"><a id="l02339" name="l02339"></a><span class="lineno"> 2339</span>          <span class="keywordflow">if</span> ( flags[ j ] )</div>
<div class="line"><a id="l02340" name="l02340"></a><span class="lineno"> 2340</span>            {</div>
<div class="line"><a id="l02341" name="l02341"></a><span class="lineno"> 2341</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid coefficient ( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; ): already defined ( &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02342" name="l02342"></a><span class="lineno"> 2342</span>              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02343" name="l02343"></a><span class="lineno"> 2343</span>            }</div>
<div class="line"><a id="l02344" name="l02344"></a><span class="lineno"> 2344</span> </div>
<div class="line"><a id="l02345" name="l02345"></a><span class="lineno"> 2345</span>          flags.<a class="code hl_function" href="classArrOfBit.html#a0a8b695966e2c1060dc6eb37d87898e0">setbit</a>( j );</div>
<div class="line"><a id="l02346" name="l02346"></a><span class="lineno"> 2346</span>        }</div>
<div class="line"><a id="l02347" name="l02347"></a><span class="lineno"> 2347</span>    }</div>
<div class="line"><a id="l02348" name="l02348"></a><span class="lineno"> 2348</span> </div>
<div class="line"><a id="l02349" name="l02349"></a><span class="lineno"> 2349</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02350" name="l02350"></a><span class="lineno"> 2350</span>}</div>
<div class="line"><a id="l02351" name="l02351"></a><span class="lineno"> 2351</span> </div>
<div class="line"><a id="l02352" name="l02352"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#ae774787a0ea9e0ab09a98336c820a871"> 2352</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classMatrice__Morse.html#ae774787a0ea9e0ab09a98336c820a871">Matrice_Morse::check_sorted_morse_matrix_structure</a>( <span class="keywordtype">void</span> )<span class="keyword"> const</span></div>
<div class="line"><a id="l02353" name="l02353"></a><span class="lineno"> 2353</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02354" name="l02354"></a><span class="lineno"> 2354</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines   = <a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>( );</div>
<div class="line"><a id="l02355" name="l02355"></a><span class="lineno"> 2355</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_columns = <a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>( );</div>
<div class="line"><a id="l02356" name="l02356"></a><span class="lineno"> 2356</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_coefficients = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( nb_lines ) - 1;</div>
<div class="line"><a id="l02357" name="l02357"></a><span class="lineno"> 2357</span> </div>
<div class="line"><a id="l02358" name="l02358"></a><span class="lineno"> 2358</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTVect.html#ae94cb18641c81d97b4011f129dba7ba9">size</a>( ) != nb_coefficients )</div>
<div class="line"><a id="l02359" name="l02359"></a><span class="lineno"> 2359</span>    {</div>
<div class="line"><a id="l02360" name="l02360"></a><span class="lineno"> 2360</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid tab2 size&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02361" name="l02361"></a><span class="lineno"> 2361</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02362" name="l02362"></a><span class="lineno"> 2362</span>    }</div>
<div class="line"><a id="l02363" name="l02363"></a><span class="lineno"> 2363</span> </div>
<div class="line"><a id="l02364" name="l02364"></a><span class="lineno"> 2364</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code hl_function" href="classTRUSTVect.html#ae94cb18641c81d97b4011f129dba7ba9">size</a>( ) != nb_coefficients )</div>
<div class="line"><a id="l02365" name="l02365"></a><span class="lineno"> 2365</span>    {</div>
<div class="line"><a id="l02366" name="l02366"></a><span class="lineno"> 2366</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid coeff size&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02367" name="l02367"></a><span class="lineno"> 2367</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02368" name="l02368"></a><span class="lineno"> 2368</span>    }</div>
<div class="line"><a id="l02369" name="l02369"></a><span class="lineno"> 2369</span> </div>
<div class="line"><a id="l02370" name="l02370"></a><span class="lineno"> 2370</span>  <a class="code hl_class" href="classArrOfBit.html">ArrOfBit</a> flags( nb_columns );</div>
<div class="line"><a id="l02371" name="l02371"></a><span class="lineno"> 2371</span> </div>
<div class="line"><a id="l02372" name="l02372"></a><span class="lineno"> 2372</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )</div>
<div class="line"><a id="l02373" name="l02373"></a><span class="lineno"> 2373</span>    {</div>
<div class="line"><a id="l02374" name="l02374"></a><span class="lineno"> 2374</span>      flags = 0;</div>
<div class="line"><a id="l02375" name="l02375"></a><span class="lineno"> 2375</span> </div>
<div class="line"><a id="l02376" name="l02376"></a><span class="lineno"> 2376</span>      <span class="keywordtype">int</span> k0 = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;</div>
<div class="line"><a id="l02377" name="l02377"></a><span class="lineno"> 2377</span>      <span class="keywordtype">int</span> k1 = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;</div>
<div class="line"><a id="l02378" name="l02378"></a><span class="lineno"> 2378</span> </div>
<div class="line"><a id="l02379" name="l02379"></a><span class="lineno"> 2379</span>      <span class="keywordtype">int</span> j0 = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k0 ) - 1 - 1;</div>
<div class="line"><a id="l02380" name="l02380"></a><span class="lineno"> 2380</span> </div>
<div class="line"><a id="l02381" name="l02381"></a><span class="lineno"> 2381</span>      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=k0; k&lt;k1; ++k )</div>
<div class="line"><a id="l02382" name="l02382"></a><span class="lineno"> 2382</span>        {</div>
<div class="line"><a id="l02383" name="l02383"></a><span class="lineno"> 2383</span>          <span class="keywordtype">int</span> j = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k ) - 1;</div>
<div class="line"><a id="l02384" name="l02384"></a><span class="lineno"> 2384</span> </div>
<div class="line"><a id="l02385" name="l02385"></a><span class="lineno"> 2385</span>          <span class="keywordflow">if</span> ( j &lt; 0 )</div>
<div class="line"><a id="l02386" name="l02386"></a><span class="lineno"> 2386</span>            {</div>
<div class="line"><a id="l02387" name="l02387"></a><span class="lineno"> 2387</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid column index (&lt;0): &quot;</span> &lt;&lt; j &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02388" name="l02388"></a><span class="lineno"> 2388</span>              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02389" name="l02389"></a><span class="lineno"> 2389</span>            }</div>
<div class="line"><a id="l02390" name="l02390"></a><span class="lineno"> 2390</span> </div>
<div class="line"><a id="l02391" name="l02391"></a><span class="lineno"> 2391</span>          <span class="keywordflow">if</span> ( j &gt;= nb_columns )</div>
<div class="line"><a id="l02392" name="l02392"></a><span class="lineno"> 2392</span>            {</div>
<div class="line"><a id="l02393" name="l02393"></a><span class="lineno"> 2393</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid column index (&gt;nb_cols): &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span> &lt;&lt; nb_columns &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02394" name="l02394"></a><span class="lineno"> 2394</span>              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02395" name="l02395"></a><span class="lineno"> 2395</span>            }</div>
<div class="line"><a id="l02396" name="l02396"></a><span class="lineno"> 2396</span> </div>
<div class="line"><a id="l02397" name="l02397"></a><span class="lineno"> 2397</span>          <span class="keywordflow">if</span> ( flags[ j ] )</div>
<div class="line"><a id="l02398" name="l02398"></a><span class="lineno"> 2398</span>            {</div>
<div class="line"><a id="l02399" name="l02399"></a><span class="lineno"> 2399</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid coefficient ( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; ): already defined ( &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02400" name="l02400"></a><span class="lineno"> 2400</span>              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02401" name="l02401"></a><span class="lineno"> 2401</span>            }</div>
<div class="line"><a id="l02402" name="l02402"></a><span class="lineno"> 2402</span> </div>
<div class="line"><a id="l02403" name="l02403"></a><span class="lineno"> 2403</span>          <span class="keywordflow">if</span> ( j &lt;= j0 )</div>
<div class="line"><a id="l02404" name="l02404"></a><span class="lineno"> 2404</span>            {</div>
<div class="line"><a id="l02405" name="l02405"></a><span class="lineno"> 2405</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;unsorted coefficient: ( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; ) after ( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; j0 &lt;&lt; <span class="stringliteral">&quot; ) &quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;;</div>
<div class="line"><a id="l02406" name="l02406"></a><span class="lineno"> 2406</span>              <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l02407" name="l02407"></a><span class="lineno"> 2407</span>            }</div>
<div class="line"><a id="l02408" name="l02408"></a><span class="lineno"> 2408</span> </div>
<div class="line"><a id="l02409" name="l02409"></a><span class="lineno"> 2409</span>          j0 = j;</div>
<div class="line"><a id="l02410" name="l02410"></a><span class="lineno"> 2410</span>          flags.<a class="code hl_function" href="classArrOfBit.html#a0a8b695966e2c1060dc6eb37d87898e0">setbit</a>( j );</div>
<div class="line"><a id="l02411" name="l02411"></a><span class="lineno"> 2411</span>        }</div>
<div class="line"><a id="l02412" name="l02412"></a><span class="lineno"> 2412</span>    }</div>
<div class="line"><a id="l02413" name="l02413"></a><span class="lineno"> 2413</span> </div>
<div class="line"><a id="l02414" name="l02414"></a><span class="lineno"> 2414</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l02415" name="l02415"></a><span class="lineno"> 2415</span>}</div>
<div class="line"><a id="l02416" name="l02416"></a><span class="lineno"> 2416</span> </div>
<div class="line"><a id="l02417" name="l02417"></a><span class="lineno"> 2417</span> </div>
<div class="line"><a id="l02418" name="l02418"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#af852d9fa4d3ee121b87adfcf1cd2a14e"> 2418</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#af852d9fa4d3ee121b87adfcf1cd2a14e">Matrice_Morse::assert_check_morse_matrix_structure</a>( <span class="keywordtype">void</span> )<span class="keyword"> const</span></div>
<div class="line"><a id="l02419" name="l02419"></a><span class="lineno"> 2419</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02420" name="l02420"></a><span class="lineno"> 2420</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l02421" name="l02421"></a><span class="lineno"> 2421</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a id="l02422" name="l02422"></a><span class="lineno"> 2422</span>  <span class="keywordflow">if</span> ( ! ( <a class="code hl_function" href="classMatrice__Morse.html#aad804c73c7c37d72bf6f34e0cdc5a702">check_morse_matrix_structure</a>( ) ) )</div>
<div class="line"><a id="l02423" name="l02423"></a><span class="lineno"> 2423</span>    {</div>
<div class="line"><a id="l02424" name="l02424"></a><span class="lineno"> 2424</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in &#39;Matrice_Morse::assert_check_morse_matrix_structure( )&#39;:&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02425" name="l02425"></a><span class="lineno"> 2425</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  Exiting...&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02426" name="l02426"></a><span class="lineno"> 2426</span>      <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">Process::exit</a>( );</div>
<div class="line"><a id="l02427" name="l02427"></a><span class="lineno"> 2427</span>    }</div>
<div class="line"><a id="l02428" name="l02428"></a><span class="lineno"> 2428</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l02429" name="l02429"></a><span class="lineno"> 2429</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=0;</div>
<div class="line"><a id="l02430" name="l02430"></a><span class="lineno"> 2430</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02431" name="l02431"></a><span class="lineno"> 2431</span>}</div>
<div class="line"><a id="l02432" name="l02432"></a><span class="lineno"> 2432</span> </div>
<div class="line"><a id="l02433" name="l02433"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#adb08fca2cee538bdb71a1b986fc70d93"> 2433</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#adb08fca2cee538bdb71a1b986fc70d93">Matrice_Morse::assert_check_sorted_morse_matrix_structure</a>( <span class="keywordtype">void</span> )<span class="keyword"> const</span></div>
<div class="line"><a id="l02434" name="l02434"></a><span class="lineno"> 2434</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02435" name="l02435"></a><span class="lineno"> 2435</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l02436" name="l02436"></a><span class="lineno"> 2436</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a id="l02437" name="l02437"></a><span class="lineno"> 2437</span>  <span class="keywordflow">if</span> ( ! ( <a class="code hl_function" href="classMatrice__Morse.html#ae774787a0ea9e0ab09a98336c820a871">check_sorted_morse_matrix_structure</a>( ) ) )</div>
<div class="line"><a id="l02438" name="l02438"></a><span class="lineno"> 2438</span>    {</div>
<div class="line"><a id="l02439" name="l02439"></a><span class="lineno"> 2439</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in &#39;Matrice_Morse::assert_check_sorted_morse_matrix_structure( )&#39;:&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02440" name="l02440"></a><span class="lineno"> 2440</span>      <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  Exiting...&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l02441" name="l02441"></a><span class="lineno"> 2441</span>      <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">Process::exit</a>( );</div>
<div class="line"><a id="l02442" name="l02442"></a><span class="lineno"> 2442</span>    }</div>
<div class="line"><a id="l02443" name="l02443"></a><span class="lineno"> 2443</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l02444" name="l02444"></a><span class="lineno"> 2444</span>    <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a>=0;</div>
<div class="line"><a id="l02445" name="l02445"></a><span class="lineno"> 2445</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l02446" name="l02446"></a><span class="lineno"> 2446</span>}</div>
<div class="line"><a id="l02447" name="l02447"></a><span class="lineno"> 2447</span> </div>
<div class="line"><a id="l02448" name="l02448"></a><span class="lineno"> 2448</span><span class="comment">// Build a new Morse matrix spanning the rectangular area defined by the two points (nl0, nc0) and (nl1, nc1)</span></div>
<div class="line"><a id="l02449" name="l02449"></a><span class="lineno"> 2449</span><span class="comment">// in the original matrix.</span></div>
<div class="line"><a id="l02450" name="l02450"></a><span class="lineno"> 2450</span><span class="comment">// Indices are provided in C mode (0-based indexing).</span></div>
<div class="line"><a id="l02451" name="l02451"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#af9d3268239d11dc4c541fb2e4a371b91"> 2451</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#af9d3268239d11dc4c541fb2e4a371b91">Matrice_Morse::construire_sous_bloc</a>(<span class="keywordtype">int</span> nl0, <span class="keywordtype">int</span> nc0, <span class="keywordtype">int</span> nl1, <span class="keywordtype">int</span> nc1, <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp; result)<span class="keyword"> const</span></div>
<div class="line"><a id="l02452" name="l02452"></a><span class="lineno"> 2452</span><span class="keyword"></span>{</div>
<div class="line"><a id="l02453" name="l02453"></a><span class="lineno"> 2453</span><span class="comment">// count non-zero entries:</span></div>
<div class="line"><a id="l02454" name="l02454"></a><span class="lineno"> 2454</span>  assert(nl0 &gt;= 0);</div>
<div class="line"><a id="l02455" name="l02455"></a><span class="lineno"> 2455</span>  assert(nc0 &gt;= 0);</div>
<div class="line"><a id="l02456" name="l02456"></a><span class="lineno"> 2456</span>  assert(nl0 &lt;= nl1);</div>
<div class="line"><a id="l02457" name="l02457"></a><span class="lineno"> 2457</span>  assert(nc0 &lt;= nc1);</div>
<div class="line"><a id="l02458" name="l02458"></a><span class="lineno"> 2458</span> </div>
<div class="line"><a id="l02459" name="l02459"></a><span class="lineno"> 2459</span>  <span class="keywordtype">int</span> max_nnz = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(nl1+1) - <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(nl0); <span class="comment">//!&lt; maximum number of zeros that we will find</span></div>
<div class="line"><a id="l02460" name="l02460"></a><span class="lineno"> 2460</span>  <span class="keywordtype">int</span> tot=0;</div>
<div class="line"><a id="l02461" name="l02461"></a><span class="lineno"> 2461</span>  <a class="code hl_class" href="classTRUSTTab.html">IntTab</a> loca(max_nnz, 2);</div>
<div class="line"><a id="l02462" name="l02462"></a><span class="lineno"> 2462</span>  <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a> sub_coeffs(max_nnz);</div>
<div class="line"><a id="l02463" name="l02463"></a><span class="lineno"> 2463</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> li=nl0; li &lt;= nl1; li++)</div>
<div class="line"><a id="l02464" name="l02464"></a><span class="lineno"> 2464</span>    {</div>
<div class="line"><a id="l02465" name="l02465"></a><span class="lineno"> 2465</span>      <span class="keywordtype">int</span> idx_coeff = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(li)-1;</div>
<div class="line"><a id="l02466" name="l02466"></a><span class="lineno"> 2466</span>      <span class="keywordtype">int</span> nb_coeff_on_line = <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(li+1)-<a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(li);</div>
<div class="line"><a id="l02467" name="l02467"></a><span class="lineno"> 2467</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; nb_coeff_on_line; j++)</div>
<div class="line"><a id="l02468" name="l02468"></a><span class="lineno"> 2468</span>        {</div>
<div class="line"><a id="l02469" name="l02469"></a><span class="lineno"> 2469</span>          <span class="keywordtype">int</span> col_idx = <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(j+idx_coeff)-1;</div>
<div class="line"><a id="l02470" name="l02470"></a><span class="lineno"> 2470</span>          <span class="keywordflow">if</span> (col_idx &gt;= nc0 &amp;&amp; col_idx &lt;= nc1) <span class="comment">//!&lt; is the coeff in the window?</span></div>
<div class="line"><a id="l02471" name="l02471"></a><span class="lineno"> 2471</span>            {</div>
<div class="line"><a id="l02472" name="l02472"></a><span class="lineno"> 2472</span>              loca(tot, 0) = li - nl0;</div>
<div class="line"><a id="l02473" name="l02473"></a><span class="lineno"> 2473</span>              loca(tot, 1) = col_idx - nc0;</div>
<div class="line"><a id="l02474" name="l02474"></a><span class="lineno"> 2474</span>              sub_coeffs(tot) = <a class="code hl_variable" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(j+idx_coeff);</div>
<div class="line"><a id="l02475" name="l02475"></a><span class="lineno"> 2475</span>              tot++;</div>
<div class="line"><a id="l02476" name="l02476"></a><span class="lineno"> 2476</span>            }</div>
<div class="line"><a id="l02477" name="l02477"></a><span class="lineno"> 2477</span>        }</div>
<div class="line"><a id="l02478" name="l02478"></a><span class="lineno"> 2478</span>    }</div>
<div class="line"><a id="l02479" name="l02479"></a><span class="lineno"> 2479</span>  loca.<a class="code hl_function" href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">resize</a>(tot,2);</div>
<div class="line"><a id="l02480" name="l02480"></a><span class="lineno"> 2480</span>  sub_coeffs.<a class="code hl_function" href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">resize</a>(tot);</div>
<div class="line"><a id="l02481" name="l02481"></a><span class="lineno"> 2481</span> </div>
<div class="line"><a id="l02482" name="l02482"></a><span class="lineno"> 2482</span>  result.<a class="code hl_function" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">dimensionner</a>(loca);</div>
<div class="line"><a id="l02483" name="l02483"></a><span class="lineno"> 2483</span><span class="comment">// Set coefficient values:</span></div>
<div class="line"><a id="l02484" name="l02484"></a><span class="lineno"> 2484</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0 ; i &lt; tot; i++)</div>
<div class="line"><a id="l02485" name="l02485"></a><span class="lineno"> 2485</span>    {</div>
<div class="line"><a id="l02486" name="l02486"></a><span class="lineno"> 2486</span>      <span class="keywordtype">int</span> il = loca(i, 0);</div>
<div class="line"><a id="l02487" name="l02487"></a><span class="lineno"> 2487</span>      <span class="keywordtype">int</span> ic = loca(i, 1);</div>
<div class="line"><a id="l02488" name="l02488"></a><span class="lineno"> 2488</span>      result.<a class="code hl_function" href="classMatrice__Morse.html#acdbacb66fea3875664eadd117c24ed07">coef</a>(il, ic) = sub_coeffs(i);</div>
<div class="line"><a id="l02489" name="l02489"></a><span class="lineno"> 2489</span>    }</div>
<div class="line"><a id="l02490" name="l02490"></a><span class="lineno"> 2490</span>}</div>
<div class="line"><a id="l02491" name="l02491"></a><span class="lineno"> 2491</span> </div>
<div class="line"><a id="l02492" name="l02492"></a><span class="lineno"><a class="line" href="classMatrice__Morse.html#a3cfa460b823e0127b78d62295071809e"> 2492</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classMatrice__Morse.html#a3cfa460b823e0127b78d62295071809e">Matrice_Morse::sort_stencil</a>()</div>
<div class="line"><a id="l02493" name="l02493"></a><span class="lineno"> 2493</span>{</div>
<div class="line"><a id="l02494" name="l02494"></a><span class="lineno"> 2494</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a>) <span class="keywordflow">return</span>; <span class="comment">//deja fait</span></div>
<div class="line"><a id="l02495" name="l02495"></a><span class="lineno"> 2495</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + 1 &lt; <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code hl_function" href="classTRUSTVect.html#ae94cb18641c81d97b4011f129dba7ba9">size</a>(); i++) <span class="comment">//indice de ligne</span></div>
<div class="line"><a id="l02496" name="l02496"></a><span class="lineno"> 2496</span>    <a class="code hl_function" href="AssembleurPP1BUtil_8cpp.html#acff816d35f8d4ce978f860e0cd958b8a">std::sort</a>(<a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>() + <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i) - 1, <a class="code hl_variable" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code hl_function" href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">addr</a>() + <a class="code hl_variable" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i + 1) - 1);</div>
<div class="line"><a id="l02497" name="l02497"></a><span class="lineno"> 2497</span>  <a class="code hl_variable" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">morse_matrix_structure_has_changed_</a> = <a class="code hl_variable" href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">sorted_</a> = 1;</div>
<div class="line"><a id="l02498" name="l02498"></a><span class="lineno"> 2498</span>}</div>
<div class="line"><a id="l02499" name="l02499"></a><span class="lineno"> 2499</span> </div>
<div class="ttc" id="aArrOfBit_8h_html"><div class="ttname"><a href="ArrOfBit_8h.html">ArrOfBit.h</a></div></div>
<div class="ttc" id="aArray__tools_8cpp_html_ad62171ccb6e8fd4b2be47d286c164999"><div class="ttname"><a href="Array__tools_8cpp.html#ad62171ccb6e8fd4b2be47d286c164999">tri_lexicographique_tableau_indirect</a></div><div class="ttdeci">int tri_lexicographique_tableau_indirect(const IntTab &amp;tab, ArrOfInt &amp;index)</div><div class="ttdoc">Idem que tri_lexicographique_tableau mais on trie le tableau index qui contient les indices de lignes...</div><div class="ttdef"><b>Definition:</b> <a href="Array__tools_8cpp_source.html#l00333">Array_tools.cpp:333</a></div></div>
<div class="ttc" id="aArray__tools_8h_html"><div class="ttname"><a href="Array__tools_8h.html">Array_tools.h</a></div></div>
<div class="ttc" id="aAssembleurPP1BUtil_8cpp_html_acff816d35f8d4ce978f860e0cd958b8a"><div class="ttname"><a href="AssembleurPP1BUtil_8cpp.html#acff816d35f8d4ce978f860e0cd958b8a">sort</a></div><div class="ttdeci">static void sort(ArrOfInt &amp;sommets, ArrOfInt &amp;faces_op1, ArrOfInt &amp;faces_op2)</div><div class="ttdef"><b>Definition:</b> <a href="AssembleurPP1BUtil_8cpp_source.html#l00273">AssembleurPP1BUtil.cpp:273</a></div></div>
<div class="ttc" id="aCast_8h_html_a9632e68536db6c29c2b754cb55381fbe"><div class="ttname"><a href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a></div><div class="ttdeci">#define sub_type(T, r)</div><div class="ttdef"><b>Definition:</b> <a href="Cast_8h_source.html#l00047">Cast.h:47</a></div></div>
<div class="ttc" id="aChamp__P1iP1B__implementation_8cpp_html_aa8c8f49390c3cf7c702d71a71bc977e3"><div class="ttname"><a href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a></div><div class="ttdeci">static double coeff</div><div class="ttdef"><b>Definition:</b> <a href="Champ__P1iP1B__implementation_8cpp_source.html#l00309">Champ_P1iP1B_implementation.cpp:309</a></div></div>
<div class="ttc" id="aCheck__espace__virtuel_8h_html"><div class="ttname"><a href="Check__espace__virtuel_8h.html">Check_espace_virtuel.h</a></div></div>
<div class="ttc" id="aCheck__espace__virtuel_8h_html_a5299d616e38b92a66b0dca6da4ff321e"><div class="ttname"><a href="Check__espace__virtuel_8h.html#a5299d616e38b92a66b0dca6da4ff321e">assert_espace_virtuel_vect</a></div><div class="ttdeci">void assert_espace_virtuel_vect(const TRUSTVect&lt; _TYPE_ &gt; &amp;v)</div><div class="ttdoc">en mode comm_check_enabled(), verifie si l'espace virtuel du vecteur est a jour, si ce n'est pas le c...</div><div class="ttdef"><b>Definition:</b> <a href="Check__espace__virtuel_8h_source.html#l00065">Check_espace_virtuel.h:65</a></div></div>
<div class="ttc" id="aDeclare__Inst_8h_html_afcab3f7633508e92f2077d767e19bc60"><div class="ttname"><a href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a></div><div class="ttdeci">#define Implemente_instanciable_sans_constructeur(_TYPE_, _NOM_, _BASE_)</div><div class="ttdef"><b>Definition:</b> <a href="Declare__Inst_8h_source.html#l00101">Declare_Inst.h:101</a></div></div>
<div class="ttc" id="aDouble_8h_html_ac86f5f350b0f95fd8c34b0ac8d720f6f"><div class="ttname"><a href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a></div><div class="ttdeci">int est_egal(double x1, double x2, double eps)</div><div class="ttdef"><b>Definition:</b> <a href="Double_8h_source.html#l00091">Double.h:91</a></div></div>
<div class="ttc" id="aDouble_8h_html_ae0ee0cebfad5968da0ad6cc7a49e16b6"><div class="ttname"><a href="Double_8h.html#ae0ee0cebfad5968da0ad6cc7a49e16b6">DMAXFLOAT</a></div><div class="ttdeci">#define DMAXFLOAT</div><div class="ttdef"><b>Definition:</b> <a href="Double_8h_source.html#l00064">Double.h:64</a></div></div>
<div class="ttc" id="aEntreeSortie_8h_html_a1007c2f57f1c8fc7334a3f62aab08414"><div class="ttname"><a href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a></div><div class="ttdeci">#define Cout</div><div class="ttdef"><b>Definition:</b> <a href="EntreeSortie_8h_source.html#l00026">EntreeSortie.h:26</a></div></div>
<div class="ttc" id="aEntreeSortie_8h_html_a5ebb6b5243d6167369bddecb78d0b5b8"><div class="ttname"><a href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a></div><div class="ttdeci">#define Cerr</div><div class="ttdef"><b>Definition:</b> <a href="EntreeSortie_8h_source.html#l00025">EntreeSortie.h:25</a></div></div>
<div class="ttc" id="aEntreeSortie_8h_html_a7f716d3c5b6411631d5d0700ead09467"><div class="ttname"><a href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a></div><div class="ttdeci">const Separateur finl</div></div>
<div class="ttc" id="aIterateur__VDF__base_8h_html_a407fbcf28d9550510074f0c887a0e0ceac938491055e13993f3eed68c989f90b0"><div class="ttname"><a href="Iterateur__VDF__base_8h.html#a407fbcf28d9550510074f0c887a0e0ceac938491055e13993f3eed68c989f90b0">symetrie</a></div><div class="ttdeci">@ symetrie</div><div class="ttdoc">Symetrie.</div><div class="ttdef"><b>Definition:</b> <a href="Iterateur__VDF__base_8h_source.html#l00033">Iterateur_VDF_base.h:32</a></div></div>
<div class="ttc" id="aMatrice__Morse_8cpp_html_a11ec4963b0fdb75675b5a1603f073c5b"><div class="ttname"><a href="Matrice__Morse_8cpp.html#a11ec4963b0fdb75675b5a1603f073c5b">operator*</a></div><div class="ttdeci">Matrice_Morse operator*(double x, const Matrice_Morse &amp;A)</div><div class="ttdoc">Fonction (hors classe) amie de la classe Matrice_Morse Scaling de la matrice par un scalaire: multipl...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01827">Matrice_Morse.cpp:1827</a></div></div>
<div class="ttc" id="aMatrice__Morse_8cpp_html_a12a6ca74ab7a7c08a8eff461782112c6"><div class="ttname"><a href="Matrice__Morse_8cpp.html#a12a6ca74ab7a7c08a8eff461782112c6">Matrice_Morse_test</a></div><div class="ttdeci">int Matrice_Morse_test()</div><div class="ttdoc">NE FAIT RIEN.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02241">Matrice_Morse.cpp:2241</a></div></div>
<div class="ttc" id="aMatrice__Morse_8cpp_html_a17a186d3ca06dea0e9b1ad445a4ea482"><div class="ttname"><a href="Matrice__Morse_8cpp.html#a17a186d3ca06dea0e9b1ad445a4ea482">operator+</a></div><div class="ttdeci">Matrice_Morse operator+(const Matrice_Morse &amp;A, const Matrice_Morse &amp;B)</div><div class="ttdoc">Fonction (hors classe) amie de la classe Matrice_Morse Addition de 2 matrices au format Morse....</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01109">Matrice_Morse.cpp:1109</a></div></div>
<div class="ttc" id="aMatrice__Morse_8h_html"><div class="ttname"><a href="Matrice__Morse_8h.html">Matrice_Morse.h</a></div></div>
<div class="ttc" id="aMatrice__Morse__Sym_8h_html"><div class="ttname"><a href="Matrice__Morse__Sym_8h.html">Matrice_Morse_Sym.h</a></div></div>
<div class="ttc" id="aMemoire_8cpp_html_ade857a99d48bcb8cfaa57c4cd8d7d2e8"><div class="ttname"><a href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a></div><div class="ttdeci">static int compteur</div><div class="ttdef"><b>Definition:</b> <a href="Memoire_8cpp_source.html#l00019">Memoire.cpp:19</a></div></div>
<div class="ttc" id="aNoms_8h_html"><div class="ttname"><a href="Noms_8h.html">Noms.h</a></div></div>
<div class="ttc" id="aSparskit_8h_html"><div class="ttname"><a href="Sparskit_8h.html">Sparskit.h</a></div></div>
<div class="ttc" id="aTRUSTTrav_8h_html"><div class="ttname"><a href="TRUSTTrav_8h.html">TRUSTTrav.h</a></div></div>
<div class="ttc" id="aTRUSTVect__tools_8tpp_html_a60579f2b9c6e65cce8d02f72f2ee653e"><div class="ttname"><a href="TRUSTVect__tools_8tpp.html#a60579f2b9c6e65cce8d02f72f2ee653e">mp_norme_vect</a></div><div class="ttdeci">int mp_norme_vect(const TRUSTVect&lt; int &gt; &amp;vx)=delete</div><div class="ttdoc">forbidden</div></div>
<div class="ttc" id="aTRUSTVect__tools_8tpp_html_ab45c540b1aca516409b0cbc857e4f103"><div class="ttname"><a href="TRUSTVect__tools_8tpp.html#ab45c540b1aca516409b0cbc857e4f103">mp_prodscal</a></div><div class="ttdeci">_TYPE_ mp_prodscal(const TRUSTVect&lt; _TYPE_ &gt; &amp;x, const TRUSTVect&lt; _TYPE_ &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect__tools_8tpp_source.html#l00428">TRUSTVect_tools.tpp:428</a></div></div>
<div class="ttc" id="aZone__VEF__PreP1b_8cpp_html_a24a462bbedad66c2a21f5f6f84b8ec5b"><div class="ttname"><a href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a></div><div class="ttdeci">static int next(int S, const ArrOfInt &amp;contenu)</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VEF__PreP1b_8cpp_source.html#l00196">Zone_VEF_PreP1b.cpp:196</a></div></div>
<div class="ttc" id="aarch_8h_html_a9b91c72ded7de2f0b393ea75de53929b"><div class="ttname"><a href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a></div><div class="ttdeci">#define F77NAME(x)</div><div class="ttdef"><b>Definition:</b> <a href="arch_8h_source.html#l00068">arch.h:68</a></div></div>
<div class="ttc" id="aclassArrOfBit_html"><div class="ttname"><a href="classArrOfBit.html">ArrOfBit</a></div><div class="ttdef"><b>Definition:</b> <a href="ArrOfBit_8h_source.html#l00022">ArrOfBit.h:23</a></div></div>
<div class="ttc" id="aclassArrOfBit_html_a0a8b695966e2c1060dc6eb37d87898e0"><div class="ttname"><a href="classArrOfBit.html#a0a8b695966e2c1060dc6eb37d87898e0">ArrOfBit::setbit</a></div><div class="ttdeci">void setbit(int i) const</div><div class="ttdoc">Met le bit e a 1.</div><div class="ttdef"><b>Definition:</b> <a href="ArrOfBit_8h_source.html#l00057">ArrOfBit.h:57</a></div></div>
<div class="ttc" id="aclassEntree_html"><div class="ttname"><a href="classEntree.html">Entree</a></div><div class="ttdoc">Classe de definition des operateurs et methodes pour toute lecture dans un flot d'entree&lt;br&gt;(fichier,...</div><div class="ttdef"><b>Definition:</b> <a href="Entree_8h_source.html#l00041">Entree.h:42</a></div></div>
<div class="ttc" id="aclassMatrice__Base_html"><div class="ttname"><a href="classMatrice__Base.html">Matrice_Base</a></div><div class="ttdoc">Classe Matrice_Base Classe de base de la hierarchie des matrices. Cette classe definie l'interface ge...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Base_8h_source.html#l00039">Matrice_Base.h:40</a></div></div>
<div class="ttc" id="aclassMatrice__Base_html_a557834907ba7acfb9338272ac243888a"><div class="ttname"><a href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">Matrice_Base::is_stencil_up_to_date_</a></div><div class="ttdeci">bool is_stencil_up_to_date_</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Base_8h_source.html#l00086">Matrice_Base.h:86</a></div></div>
<div class="ttc" id="aclassMatrice__Base_html_a91c98b86a0bdce6ccc483dd453ef9ab2"><div class="ttname"><a href="classMatrice__Base.html#a91c98b86a0bdce6ccc483dd453ef9ab2">Matrice_Base::multvect</a></div><div class="ttdeci">virtual DoubleVect &amp; multvect(const DoubleVect &amp;, DoubleVect &amp;) const</div><div class="ttdoc">Multiplication d'un vecteur par la matrice. Operation: r = A*x.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Base_8h_source.html#l00112">Matrice_Base.h:113</a></div></div>
<div class="ttc" id="aclassMatrice__Base_html_ac9e6f462755d116637e2cf0ace94bd8c"><div class="ttname"><a href="classMatrice__Base.html#ac9e6f462755d116637e2cf0ace94bd8c">Matrice_Base::is_stencil_up_to_date</a></div><div class="ttdeci">bool is_stencil_up_to_date(void) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Base_8cpp_source.html#l00119">Matrice_Base.cpp:119</a></div></div>
<div class="ttc" id="aclassMatrice__Base_html_aed652de189a541ffa30f802e407696cd"><div class="ttname"><a href="classMatrice__Base.html#aed652de189a541ffa30f802e407696cd">Matrice_Base::ajouter_multvect</a></div><div class="ttdeci">virtual DoubleVect &amp; ajouter_multvect(const DoubleVect &amp;x, DoubleVect &amp;r) const</div><div class="ttdoc">Operation de multiplication-accumulation (saxpy) matrice vecteur. Operation: r = r + A*x.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Base_8h_source.html#l00215">Matrice_Base.h:216</a></div></div>
<div class="ttc" id="aclassMatrice__Base_html_af782c401617e7acfef8cab70457f9b55"><div class="ttname"><a href="classMatrice__Base.html#af782c401617e7acfef8cab70457f9b55">Matrice_Base::stencil_</a></div><div class="ttdeci">IntTab stencil_</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Base_8h_source.html#l00087">Matrice_Base.h:87</a></div></div>
<div class="ttc" id="aclassMatrice__Morse__Sym_html"><div class="ttname"><a href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a></div><div class="ttdoc">Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse__Sym_8h_source.html#l00036">Matrice_Morse_Sym.h:37</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html"><div class="ttname"><a href="classMatrice__Morse.html">Matrice_Morse</a></div><div class="ttdoc">Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00050">Matrice_Morse.h:51</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a197676c917c6ce269eefbb3be171cb73"><div class="ttname"><a href="classMatrice__Morse.html#a197676c917c6ce269eefbb3be171cb73">Matrice_Morse::largeur_de_bande</a></div><div class="ttdeci">int largeur_de_bande() const</div><div class="ttdoc">Retourne la largeur de bande.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02277">Matrice_Morse.cpp:2277</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a1a9134b16e927cd79db6e6d75a15a312"><div class="ttname"><a href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312">Matrice_Morse::morse_matrix_structure_has_changed_</a></div><div class="ttdeci">int morse_matrix_structure_has_changed_</div><div class="ttdoc">Flag if matrix structure changes.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00189">Matrice_Morse.h:189</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a1aa4f648fa4ada1731cd8ae41a8ec23e"><div class="ttname"><a href="classMatrice__Morse.html#a1aa4f648fa4ada1731cd8ae41a8ec23e">Matrice_Morse::affecte_prod</a></div><div class="ttdeci">Matrice_Morse &amp; affecte_prod(const Matrice_Morse &amp;A, const Matrice_Morse &amp;B)</div><div class="ttdoc">Affecte le produit de 2 matrices Morse A et B a l'objet (this). Operation: this = A * B.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01612">Matrice_Morse.cpp:1612</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a30fec8fc80640dc5543d6547c84455f0"><div class="ttname"><a href="classMatrice__Morse.html#a30fec8fc80640dc5543d6547c84455f0">Matrice_Morse::readOn</a></div><div class="ttdeci">Entree &amp; readOn(Entree &amp;) override</div><div class="ttdoc">NON CODE.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00068">Matrice_Morse.cpp:68</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a3bcd59ac30cd776ea695a8c8f2d2776d"><div class="ttname"><a href="classMatrice__Morse.html#a3bcd59ac30cd776ea695a8c8f2d2776d">Matrice_Morse::formeF</a></div><div class="ttdeci">void formeF()</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02212">Matrice_Morse.cpp:2212</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a3cfa460b823e0127b78d62295071809e"><div class="ttname"><a href="classMatrice__Morse.html#a3cfa460b823e0127b78d62295071809e">Matrice_Morse::sort_stencil</a></div><div class="ttdeci">void sort_stencil()</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02492">Matrice_Morse.cpp:2492</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a3ea62902f8656584c3922ca43d20b8fe"><div class="ttname"><a href="classMatrice__Morse.html#a3ea62902f8656584c3922ca43d20b8fe">Matrice_Morse::imprimer_image</a></div><div class="ttdeci">Sortie &amp; imprimer_image(Sortie &amp;s) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00157">Matrice_Morse.cpp:157</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a3eb6b49cf3ce0b36fc8964d3f02d6d50"><div class="ttname"><a href="classMatrice__Morse.html#a3eb6b49cf3ce0b36fc8964d3f02d6d50">Matrice_Morse::get_tab1</a></div><div class="ttdeci">const IntVect &amp; get_tab1(void) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00110">Matrice_Morse.h:110</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a3fe9dc9cd6e414e6781b2dcba28acf1f"><div class="ttname"><a href="classMatrice__Morse.html#a3fe9dc9cd6e414e6781b2dcba28acf1f">Matrice_Morse::clean</a></div><div class="ttdeci">void clean()</div><div class="ttdoc">Remplit la matrice avec des zeros.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02261">Matrice_Morse.cpp:2261</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a44dbdb39389f6f17711f5072ce9cf2e0"><div class="ttname"><a href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0">Matrice_Morse::m_</a></div><div class="ttdeci">int m_</div><div class="ttdoc">Number of columns.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00197">Matrice_Morse.h:197</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a4a61f874a8a3ed671bbe60168a5855ac"><div class="ttname"><a href="classMatrice__Morse.html#a4a61f874a8a3ed671bbe60168a5855ac">Matrice_Morse::get_coeff</a></div><div class="ttdeci">const DoubleVect &amp; get_coeff(void) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00112">Matrice_Morse.h:112</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a4f528c2a17bbdaed073a98702c33ee66"><div class="ttname"><a href="classMatrice__Morse.html#a4f528c2a17bbdaed073a98702c33ee66">Matrice_Morse::get_stencil</a></div><div class="ttdeci">void get_stencil(IntTab &amp;stencil) const override</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01916">Matrice_Morse.cpp:1916</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a547bc77cbec07f7cb77f180d2a600149"><div class="ttname"><a href="classMatrice__Morse.html#a547bc77cbec07f7cb77f180d2a600149">Matrice_Morse::operator*=</a></div><div class="ttdeci">Matrice_Morse &amp; operator*=(double)</div><div class="ttdoc">Operateur de multiplication (de tous les elements) d'une matrice par un scalaire. Operation: A = x * ...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01905">Matrice_Morse.cpp:1905</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a5ed8c0c5ce20ddb2dff99c2eec47006f"><div class="ttname"><a href="classMatrice__Morse.html#a5ed8c0c5ce20ddb2dff99c2eec47006f">Matrice_Morse::operator=</a></div><div class="ttdeci">Matrice_Morse &amp; operator=(const Matrice_Morse &amp;)</div><div class="ttdoc">Operateur d'affectation d'une Matrice_Morse dans une autre Matrice_Morse.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00693">Matrice_Morse.cpp:693</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a5f6e112296154936cc1ec98fd5cd1667"><div class="ttname"><a href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">Matrice_Morse::tab2_</a></div><div class="ttdeci">IntVect tab2_</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00194">Matrice_Morse.h:194</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a63efece8f47f264f288a1a4a1ef271c9"><div class="ttname"><a href="classMatrice__Morse.html#a63efece8f47f264f288a1a4a1ef271c9">Matrice_Morse::scale</a></div><div class="ttdeci">void scale(const double x) override</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01911">Matrice_Morse.cpp:1911</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a657f2db151b16ebb64ee5b78a6faed86"><div class="ttname"><a href="classMatrice__Morse.html#a657f2db151b16ebb64ee5b78a6faed86">Matrice_Morse::diagmulmat</a></div><div class="ttdeci">virtual Matrice_Morse &amp; diagmulmat(const DoubleVect &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00856">Matrice_Morse.cpp:856</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a66eb615830b9e439123e6af27a8c2e4e"><div class="ttname"><a href="classMatrice__Morse.html#a66eb615830b9e439123e6af27a8c2e4e">Matrice_Morse::nb_vois</a></div><div class="ttdeci">int nb_vois(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00114">Matrice_Morse.h:114</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a6c3f7ff3eb33b4f893a98f93f485d133"><div class="ttname"><a href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">Matrice_Morse::Matrice_Morse</a></div><div class="ttdeci">Matrice_Morse()</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00271">Matrice_Morse.cpp:271</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a6e0753ddc2866580a7716588fafff24e"><div class="ttname"><a href="classMatrice__Morse.html#a6e0753ddc2866580a7716588fafff24e">Matrice_Morse::operator/=</a></div><div class="ttdeci">Matrice_Morse &amp; operator/=(double)</div><div class="ttdoc">Operateur de division (de tous les elements) d'une matrice par un scalaire. Operation: A = A / x.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02058">Matrice_Morse.cpp:2058</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a6ef2f55690a596db1ef29742a2e580de"><div class="ttname"><a href="classMatrice__Morse.html#a6ef2f55690a596db1ef29742a2e580de">Matrice_Morse::get_set_tab1</a></div><div class="ttdeci">IntVect &amp; get_set_tab1(void)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00098">Matrice_Morse.h:98</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a7654bbef11775a783790d3e9ad0b1501"><div class="ttname"><a href="classMatrice__Morse.html#a7654bbef11775a783790d3e9ad0b1501">Matrice_Morse::get_set_coeff</a></div><div class="ttdeci">DoubleVect &amp; get_set_coeff(void)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00108">Matrice_Morse.h:108</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a780a72cd0f2c3b8b19bfa6d3201efb2e"><div class="ttname"><a href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">Matrice_Morse::coeff_</a></div><div class="ttdeci">DoubleVect coeff_</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00195">Matrice_Morse.h:195</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a7b783ffdef610de0ed645b15d8c0bf56"><div class="ttname"><a href="classMatrice__Morse.html#a7b783ffdef610de0ed645b15d8c0bf56">Matrice_Morse::ordre</a></div><div class="ttdeci">int ordre() const override</div><div class="ttdoc">Renvoie l'ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00551">Matrice_Morse.cpp:551</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a807cf85a1b509639edb84d7276b3edb3"><div class="ttname"><a href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">Matrice_Morse::get_tab2</a></div><div class="ttdeci">const IntVect &amp; get_tab2(void) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00111">Matrice_Morse.h:111</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a823f96abb42ed1cde259eb30704af5e5"><div class="ttname"><a href="classMatrice__Morse.html#a823f96abb42ed1cde259eb30704af5e5">Matrice_Morse::sorted_</a></div><div class="ttdeci">int sorted_</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00190">Matrice_Morse.h:190</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a8bafab20c667e1bed56a463ffb30e349"><div class="ttname"><a href="classMatrice__Morse.html#a8bafab20c667e1bed56a463ffb30e349">Matrice_Morse::formeC</a></div><div class="ttdeci">void formeC()</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02198">Matrice_Morse.cpp:2198</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a8c47c9e0f73591852cc8a7204d8ad6ac"><div class="ttname"><a href="classMatrice__Morse.html#a8c47c9e0f73591852cc8a7204d8ad6ac">Matrice_Morse::imprimer_formatte</a></div><div class="ttdeci">Sortie &amp; imprimer_formatte(Sortie &amp;s) const override</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00095">Matrice_Morse.cpp:95</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a8e9254acaa95bbcb76a8ff1772b9b572"><div class="ttname"><a href="classMatrice__Morse.html#a8e9254acaa95bbcb76a8ff1772b9b572">Matrice_Morse::zero_</a></div><div class="ttdeci">double zero_</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00201">Matrice_Morse.h:201</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a906ba051649671139d2d5f6565c417d5"><div class="ttname"><a href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">Matrice_Morse::tab1_</a></div><div class="ttdeci">IntVect tab1_</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00193">Matrice_Morse.h:193</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a930e2f0b2896d3bc7f58ef89e60239dc"><div class="ttname"><a href="classMatrice__Morse.html#a930e2f0b2896d3bc7f58ef89e60239dc">Matrice_Morse::inverse</a></div><div class="ttdeci">virtual int inverse(const DoubleVect &amp;, DoubleVect &amp;, double) const</div><div class="ttdoc">Calcule la solution du systeme lineaire: A * solution = secmem. La methode utilisee est GMRES precond...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01176">Matrice_Morse.cpp:1176</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a9859a88c59daf0b968b3c5090e18f264"><div class="ttname"><a href="classMatrice__Morse.html#a9859a88c59daf0b968b3c5090e18f264">Matrice_Morse::transpose</a></div><div class="ttdeci">virtual Matrice_Morse &amp; transpose(const Matrice_Morse &amp;a)</div><div class="ttdoc">*this = a transposee.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00718">Matrice_Morse.cpp:718</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_aa18902f5bb7084749524e6625ad35816"><div class="ttname"><a href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816">Matrice_Morse::symetrique_</a></div><div class="ttdeci">int symetrique_</div><div class="ttdoc">Pour inliner operator()(i,j) afin d'optimiser.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00198">Matrice_Morse.h:198</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_aa1bf9efc7e65b1fd96d7059997ff704a"><div class="ttname"><a href="classMatrice__Morse.html#aa1bf9efc7e65b1fd96d7059997ff704a">Matrice_Morse::imprimer</a></div><div class="ttdeci">Sortie &amp; imprimer(Sortie &amp;s) const override</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00078">Matrice_Morse.cpp:78</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_aad804c73c7c37d72bf6f34e0cdc5a702"><div class="ttname"><a href="classMatrice__Morse.html#aad804c73c7c37d72bf6f34e0cdc5a702">Matrice_Morse::check_morse_matrix_structure</a></div><div class="ttdeci">bool check_morse_matrix_structure(void) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02296">Matrice_Morse.cpp:2296</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ab2fb02a8aba88f717c2285960f375fba"><div class="ttname"><a href="classMatrice__Morse.html#ab2fb02a8aba88f717c2285960f375fba">Matrice_Morse::set_nb_columns</a></div><div class="ttdeci">void set_nb_columns(const int)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00326">Matrice_Morse.cpp:326</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ab53fa44fe7cb97fbae07b8543e9b4e93"><div class="ttname"><a href="classMatrice__Morse.html#ab53fa44fe7cb97fbae07b8543e9b4e93">Matrice_Morse::ajouter_multvect_</a></div><div class="ttdeci">DoubleVect &amp; ajouter_multvect_(const DoubleVect &amp;, DoubleVect &amp;) const override</div><div class="ttdoc">Operation de multiplication-accumulation (saxpy) matrice vecteur. Operation: resu = resu + A*x.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00928">Matrice_Morse.cpp:928</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ab8e5a78ec712cb3697a59105c662d4c3"><div class="ttname"><a href="classMatrice__Morse.html#ab8e5a78ec712cb3697a59105c662d4c3">Matrice_Morse::ajouter_multvectT_</a></div><div class="ttdeci">DoubleVect &amp; ajouter_multvectT_(const DoubleVect &amp;, DoubleVect &amp;) const override</div><div class="ttdoc">Operation de multiplication-accumulation (saxpy) matrice vecteur, par la matrice transposee....</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01054">Matrice_Morse.cpp:1054</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ab909bc117774ec874e37f1f235b47816"><div class="ttname"><a href="classMatrice__Morse.html#ab909bc117774ec874e37f1f235b47816">Matrice_Morse::nb_coeff</a></div><div class="ttdeci">int nb_coeff() const</div><div class="ttdoc">nb_coeff retourne nnz</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00092">Matrice_Morse.h:92</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ac77dbfcd9310f3b356ad3d2766a5f100"><div class="ttname"><a href="classMatrice__Morse.html#ac77dbfcd9310f3b356ad3d2766a5f100">Matrice_Morse::operator+=</a></div><div class="ttdeci">Matrice_Morse &amp; operator+=(const Matrice_Morse &amp;)</div><div class="ttdoc">NE FAIT RIEN.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01869">Matrice_Morse.cpp:1869</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_acdbacb66fea3875664eadd117c24ed07"><div class="ttname"><a href="classMatrice__Morse.html#acdbacb66fea3875664eadd117c24ed07">Matrice_Morse::coef</a></div><div class="ttdeci">double coef(int i, int j) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00129">Matrice_Morse.h:129</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ad69929b5100f2785d737dd77e2c82196"><div class="ttname"><a href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">Matrice_Morse::nb_colonnes</a></div><div class="ttdeci">int nb_colonnes() const override</div><div class="ttdoc">nb_colonnes retourne m</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00091">Matrice_Morse.h:91</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ad850cee630fca99173c2219659fa3ecb"><div class="ttname"><a href="classMatrice__Morse.html#ad850cee630fca99173c2219659fa3ecb">Matrice_Morse::has_same_morse_matrix_structure</a></div><div class="ttdeci">bool has_same_morse_matrix_structure(const Matrice_Morse &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01135">Matrice_Morse.cpp:1135</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_adb08fca2cee538bdb71a1b986fc70d93"><div class="ttname"><a href="classMatrice__Morse.html#adb08fca2cee538bdb71a1b986fc70d93">Matrice_Morse::assert_check_sorted_morse_matrix_structure</a></div><div class="ttdeci">void assert_check_sorted_morse_matrix_structure(void) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02433">Matrice_Morse.cpp:2433</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_adeb4633c27ae3aed97dc6a2fbe84f69a"><div class="ttname"><a href="classMatrice__Morse.html#adeb4633c27ae3aed97dc6a2fbe84f69a">Matrice_Morse::operator-</a></div><div class="ttdeci">Matrice_Morse operator-() const</div><div class="ttdoc">Operateur de negation unaire, renvoie l'opposee de la matrice: - A Appelle operator*(double,...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01849">Matrice_Morse.cpp:1849</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ae774787a0ea9e0ab09a98336c820a871"><div class="ttname"><a href="classMatrice__Morse.html#ae774787a0ea9e0ab09a98336c820a871">Matrice_Morse::check_sorted_morse_matrix_structure</a></div><div class="ttdeci">bool check_sorted_morse_matrix_structure(void) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02352">Matrice_Morse.cpp:2352</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ae95f9ed88a8a3fc637cd2a705cead9c8"><div class="ttname"><a href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">Matrice_Morse::dimensionner</a></div><div class="ttdeci">void dimensionner(int n, int nnz)</div><div class="ttdoc">Size the matrix with n lines and n columns and nnz zero-values coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00338">Matrice_Morse.cpp:338</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ae99753a8725a9a7f58b62d6e675a69d8"><div class="ttname"><a href="classMatrice__Morse.html#ae99753a8725a9a7f58b62d6e675a69d8">Matrice_Morse::set_symmetric</a></div><div class="ttdeci">void set_symmetric(const int)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00331">Matrice_Morse.cpp:331</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_aedf08423430f9c0b1a9a967d6bb80c9d"><div class="ttname"><a href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">Matrice_Morse::remplir</a></div><div class="ttdeci">void remplir(const IntLists &amp;, const DoubleLists &amp;, const DoubleVect &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02064">Matrice_Morse.cpp:2064</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_af1142c6d58bd4b5d01cfbb9bdc600fe9"><div class="ttname"><a href="classMatrice__Morse.html#af1142c6d58bd4b5d01cfbb9bdc600fe9">Matrice_Morse::partie_sup</a></div><div class="ttdeci">virtual Matrice_Morse &amp; partie_sup(const Matrice_Morse &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00879">Matrice_Morse.cpp:879</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_af161208ab81be2aeeda07435876bdc32"><div class="ttname"><a href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">Matrice_Morse::nb_lignes</a></div><div class="ttdeci">int nb_lignes() const override</div><div class="ttdoc">nb_lignes retourne n</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00090">Matrice_Morse.h:90</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_af20143b6c3f18319cc28c326a64f031c"><div class="ttname"><a href="classMatrice__Morse.html#af20143b6c3f18319cc28c326a64f031c">Matrice_Morse::compacte</a></div><div class="ttdeci">void compacte(int elim_coeff_nul=0)</div><div class="ttdoc">Method to check/clean the Matrice_Morse matrix: -Suppress coefficient defined several times -elim_coe...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00565">Matrice_Morse.cpp:565</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_af852d9fa4d3ee121b87adfcf1cd2a14e"><div class="ttname"><a href="classMatrice__Morse.html#af852d9fa4d3ee121b87adfcf1cd2a14e">Matrice_Morse::assert_check_morse_matrix_structure</a></div><div class="ttdeci">void assert_check_morse_matrix_structure(void) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02418">Matrice_Morse.cpp:2418</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_af9addd0cf0fc821150da06b1f2e242ea"><div class="ttname"><a href="classMatrice__Morse.html#af9addd0cf0fc821150da06b1f2e242ea">Matrice_Morse::get_set_tab2</a></div><div class="ttdeci">IntVect &amp; get_set_tab2(void)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00103">Matrice_Morse.h:103</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_af9d3268239d11dc4c541fb2e4a371b91"><div class="ttname"><a href="classMatrice__Morse.html#af9d3268239d11dc4c541fb2e4a371b91">Matrice_Morse::construire_sous_bloc</a></div><div class="ttdeci">void construire_sous_bloc(int nl0, int nc0, int nl1, int nc1, Matrice_Morse &amp;result) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l02451">Matrice_Morse.cpp:2451</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_af9ea606bd195c151c6204210bb3d3eb4"><div class="ttname"><a href="classMatrice__Morse.html#af9ea606bd195c151c6204210bb3d3eb4">Matrice_Morse::printOn</a></div><div class="ttdeci">Sortie &amp; printOn(Sortie &amp;x) const override</div><div class="ttdoc">Ecrit les trois tableaux de la structure de stockage Morse sur un flot de sortie.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00045">Matrice_Morse.cpp:45</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_afa44c8ee785f2b0c7a3c5b3c2a3e947c"><div class="ttname"><a href="classMatrice__Morse.html#afa44c8ee785f2b0c7a3c5b3c2a3e947c">Matrice_Morse::get_stencil_and_coefficients</a></div><div class="ttdeci">void get_stencil_and_coefficients(IntTab &amp;stencil, ArrOfDouble &amp;coefficients) const override</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01964">Matrice_Morse.cpp:1964</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_afc6dc20707960db1921c7e1ca90966a8"><div class="ttname"><a href="classMatrice__Morse.html#afc6dc20707960db1921c7e1ca90966a8">Matrice_Morse::unite</a></div><div class="ttdeci">void unite()</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00527">Matrice_Morse.cpp:527</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_afec4fb59b905fea3bb2479ede04094c5"><div class="ttname"><a href="classMatrice__Morse.html#afec4fb59b905fea3bb2479ede04094c5">Matrice_Morse::ajouter_multTab_</a></div><div class="ttdeci">DoubleTab &amp; ajouter_multTab_(const DoubleTab &amp;, DoubleTab &amp;) const override</div><div class="ttdoc">Operation de multiplication-accumulation (saxpy) matrice matrice&lt;br&gt;(matrice X representee par un tab...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l01001">Matrice_Morse.cpp:1001</a></div></div>
<div class="ttc" id="aclassNom_html"><div class="ttname"><a href="classNom.html">Nom</a></div><div class="ttdoc">class Nom Une chaine de caractere pour nommer les objets de TRUST NOM_H</div><div class="ttdef"><b>Definition:</b> <a href="Nom_8h_source.html#l00034">Nom.h:35</a></div></div>
<div class="ttc" id="aclassNoms_html"><div class="ttname"><a href="classNoms.html">Noms</a></div><div class="ttdoc">Un tableau de chaine de caracteres (VECT(Nom))</div><div class="ttdef"><b>Definition:</b> <a href="Noms_8h_source.html#l00029">Noms.h:30</a></div></div>
<div class="ttc" id="aclassProcess_html_a6a4b64571b10f150a70db229b839e881"><div class="ttname"><a href="classProcess.html#a6a4b64571b10f150a70db229b839e881">Process::abort</a></div><div class="ttdeci">static void abort()</div><div class="ttdoc">Routine de sortie de Trio-U sur une erreur abort()</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00319">Process.cpp:319</a></div></div>
<div class="ttc" id="aclassProcess_html_a6bf692ce58d9578aa62ac3c07b8caaa1"><div class="ttname"><a href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1">Process::nproc</a></div><div class="ttdeci">static int nproc()</div><div class="ttdoc">renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00099">Process.cpp:99</a></div></div>
<div class="ttc" id="aclassProcess_html_aa9e74a5c06a68ea38298a08ea401e7b1"><div class="ttname"><a href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1">Process::barrier</a></div><div class="ttdeci">static void barrier()</div><div class="ttdoc">Synchronise tous les processeurs du groupe courant&lt;br&gt;(attend que tous les processeurs soient arrives...</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00117">Process.cpp:117</a></div></div>
<div class="ttc" id="aclassProcess_html_ab55ba07167ec807ed3a145cac0f5dca4"><div class="ttname"><a href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4">Process::me</a></div><div class="ttdeci">static int me()</div><div class="ttdoc">renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00107">Process.cpp:107</a></div></div>
<div class="ttc" id="aclassProcess_html_acc2fbbe761e08e5870ae605c0705491c"><div class="ttname"><a href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">Process::exit</a></div><div class="ttdeci">static void exit(int exit_code=-1)</div><div class="ttdoc">Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00213">Process.cpp:213</a></div></div>
<div class="ttc" id="aclassSortie_html"><div class="ttname"><a href="classSortie.html">Sortie</a></div><div class="ttdoc">Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers,...</div><div class="ttdef"><b>Definition:</b> <a href="Sortie_8h_source.html#l00050">Sortie.h:51</a></div></div>
<div class="ttc" id="aclassTRUSTArray_html"><div class="ttname"><a href="classTRUSTArray.html">TRUSTArray&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassTRUSTArray_html_a12099f562e7ea212f5f2cbffab78b8e8"><div class="ttname"><a href="classTRUSTArray.html#a12099f562e7ea212f5f2cbffab78b8e8">TRUSTArray::addr</a></div><div class="ttdeci">_TYPE_ * addr()</div><div class="ttdoc">!&lt;</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTArray_8tpp_source.html#l00181">TRUSTArray.tpp:181</a></div></div>
<div class="ttc" id="aclassTRUSTArray_html_a33bd14600da6b68883e6a74e3cb2db13"><div class="ttname"><a href="classTRUSTArray.html#a33bd14600da6b68883e6a74e3cb2db13">TRUSTArray::resize</a></div><div class="ttdeci">void resize(int new_size, Array_base::Resize_Options opt=COPY_INIT)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTArray_8h_source.html#l00145">TRUSTArray.h:145</a></div></div>
<div class="ttc" id="aclassTRUSTArray_html_a6380491c50b8df1bc144b70836b73da5"><div class="ttname"><a href="classTRUSTArray.html#a6380491c50b8df1bc144b70836b73da5">TRUSTArray::ordonne_array</a></div><div class="ttdeci">void ordonne_array()</div></div>
<div class="ttc" id="aclassTRUSTArray_html_a7c2cb947c5f755b7bcc8256246ccfdb5"><div class="ttname"><a href="classTRUSTArray.html#a7c2cb947c5f755b7bcc8256246ccfdb5">TRUSTArray::set_smart_resize</a></div><div class="ttdeci">void set_smart_resize(int flag)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTArray_8tpp_source.html#l00058">TRUSTArray.tpp:58</a></div></div>
<div class="ttc" id="aclassTRUSTArray_html_a7fdab39e76f6cb0f5a5691eaaee32d8c"><div class="ttname"><a href="classTRUSTArray.html#a7fdab39e76f6cb0f5a5691eaaee32d8c">TRUSTArray::resize_array</a></div><div class="ttdeci">void resize_array(int new_size, Array_base::Resize_Options opt=COPY_INIT)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTArray_8tpp_source.html#l00038">TRUSTArray.tpp:38</a></div></div>
<div class="ttc" id="aclassTRUSTArray_html_ac03d475a56970fcc19cf624a0353e42e"><div class="ttname"><a href="classTRUSTArray.html#ac03d475a56970fcc19cf624a0353e42e">TRUSTArray::size_array</a></div><div class="ttdeci">int size_array() const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTArray_8tpp_source.html#l00195">TRUSTArray.tpp:195</a></div></div>
<div class="ttc" id="aclassTRUSTList__Curseur_html"><div class="ttname"><a href="classTRUSTList__Curseur.html">TRUSTList_Curseur</a></div><div class="ttdoc">: List_Curseur de reels int/double precision</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTList_8h_source.html#l00093">TRUSTList.h:94</a></div></div>
<div class="ttc" id="aclassTRUSTList__Curseur_html_a66755d0cacb3248751be784538d9d7e3"><div class="ttname"><a href="classTRUSTList__Curseur.html#a66755d0cacb3248751be784538d9d7e3">TRUSTList_Curseur::valeur</a></div><div class="ttdeci">_TYPE_ valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTList_8h_source.html#l00105">TRUSTList.h:105</a></div></div>
<div class="ttc" id="aclassTRUSTLists_html"><div class="ttname"><a href="classTRUSTLists.html">TRUSTLists&lt; int &gt;</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html"><div class="ttname"><a href="classTRUSTTab.html">TRUSTTab&lt; int &gt;</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html_a2080aac630cb9bfd47030c0c01fdb35d"><div class="ttname"><a href="classTRUSTTab.html#a2080aac630cb9bfd47030c0c01fdb35d">TRUSTTab::nb_dim</a></div><div class="ttdeci">int nb_dim() const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTab_8h_source.html#l00201">TRUSTTab.h:201</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html_a33c4f72e40e49cdb553fc7311fe656bc"><div class="ttname"><a href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">TRUSTTab::resize</a></div><div class="ttdeci">void resize(int n, Array_base::Resize_Options opt=Array_base::COPY_INIT)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTab_8tpp_source.html#l00313">TRUSTTab.tpp:313</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html_a8fecd3f1f3a13e933c3f767a25c54805"><div class="ttname"><a href="classTRUSTTab.html#a8fecd3f1f3a13e933c3f767a25c54805">TRUSTTab::dimension</a></div><div class="ttdeci">int dimension(int) const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTab_8tpp_source.html#l00119">TRUSTTab.tpp:119</a></div></div>
<div class="ttc" id="aclassTRUSTTrav_html"><div class="ttname"><a href="classTRUSTTrav.html">TRUSTTrav</a></div><div class="ttdoc">: Tableau de travail a n entrees pour n&lt;= 4 C'est un TRUSTTab avec allocation dans un pool de memoire...</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTrav_8h_source.html#l00024">TRUSTTrav.h:25</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html"><div class="ttname"><a href="classTRUSTVect.html">TRUSTVect&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html_a1c6e3546a922e5867797985a5a155197"><div class="ttname"><a href="classTRUSTVect.html#a1c6e3546a922e5867797985a5a155197">TRUSTVect::copy</a></div><div class="ttdeci">void copy(const TRUSTArray&lt; _TYPE_ &gt; &amp;, Array_base::Resize_Options opt=Array_base::COPY_INIT)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect_8tpp_source.html#l00160">TRUSTVect.tpp:160</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html_a299ab30e32e399a721f3d215e64a0b33"><div class="ttname"><a href="classTRUSTVect.html#a299ab30e32e399a721f3d215e64a0b33">TRUSTVect::mp_min_vect</a></div><div class="ttdeci">_TYPE_ mp_min_vect(Mp_vect_options opt=VECT_REAL_ITEMS) const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect_8h_source.html#l00130">TRUSTVect.h:130</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html_a623374c6cf00ddf84c4bec1023496050"><div class="ttname"><a href="classTRUSTVect.html#a623374c6cf00ddf84c4bec1023496050">TRUSTVect::resize</a></div><div class="ttdeci">void resize(int, Array_base::Resize_Options opt=Array_base::COPY_INIT)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect_8tpp_source.html#l00088">TRUSTVect.tpp:88</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html_a894bec7d0626b78fe7cda4c4550f67f6"><div class="ttname"><a href="classTRUSTVect.html#a894bec7d0626b78fe7cda4c4550f67f6">TRUSTVect::reset</a></div><div class="ttdeci">void reset() override</div><div class="ttdoc">met l'objet dans l'etat obtenu par le constructeur par defaut.</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect_8h_source.html#l00150">TRUSTVect.h:150</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html_ae94cb18641c81d97b4011f129dba7ba9"><div class="ttname"><a href="classTRUSTVect.html#ae94cb18641c81d97b4011f129dba7ba9">TRUSTVect::size</a></div><div class="ttdeci">int size() const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect_8tpp_source.html#l00044">TRUSTVect.tpp:44</a></div></div>
<div class="ttc" id="aclassvect__impl_html_ad841d6b676a796bae26ed2566b7b3b41"><div class="ttname"><a href="classvect__impl.html#ad841d6b676a796bae26ed2566b7b3b41">vect_impl::dimensionner</a></div><div class="ttdeci">void dimensionner(int)</div><div class="ttdef"><b>Definition:</b> <a href="vect__impl_8cpp_source.html#l00138">vect_impl.cpp:138</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 29 2022 11:11:30 for TRUST by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
