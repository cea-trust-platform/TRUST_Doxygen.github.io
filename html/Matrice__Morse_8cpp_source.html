<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Math/Matrices/Matrice_Morse.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Math/Matrices/Matrice_Morse.cpp</div>  </div>
</div>
<div class="contents">
<a href="Matrice__Morse_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2020, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Matrice_Morse.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Math/Matrices</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/62</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse_8h.html">Matrice_Morse.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="DoubleLists_8h.html">DoubleLists.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="IntLists_8h.html">IntLists.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Sparskit_8h.html">Sparskit.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse__Sym_8h.html">Matrice_Morse_Sym.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Check__espace__virtuel_8h.html">Check_espace_virtuel.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="comm__incl_8h.html">comm_incl.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Noms_8h.html">Noms.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="ArrOfBit_8h.html">ArrOfBit.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Array__tools_8h.html">Array_tools.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="IntTrav_8h.html">IntTrav.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="DoubleTrav_8h.html">DoubleTrav.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="Matrix__tools_8h.html">Matrix_tools.h</a>&gt;</span>
<a name="l00036"></a>00036 
<a name="l00037"></a><a class="code" href="Matrice__Morse_8cpp.html#a0d430661dead3a6a1e05c1815366aed1">00037</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>,<span class="stringliteral">&quot;Matrice_Morse&quot;</span>,<a class="code" href="classMatrice__Base.html">Matrice_Base</a>);
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="comment">// Precondition:</span>
<a name="l00040"></a>00040 <span class="comment">// Parametre: Sortie&amp; s</span>
<a name="l00041"></a>00041 <span class="comment">// Signification: un flot de sortie</span>
<a name="l00042"></a>00042 <span class="comment">// Valeurs par defaut:</span>
<a name="l00043"></a>00043 <span class="comment">// Contraintes:</span>
<a name="l00044"></a>00044 <span class="comment">// Acces: entree/sortie</span>
<a name="l00045"></a>00045 <span class="comment">// Exception:</span>
<a name="l00046"></a>00046 <span class="comment">// Effets de bord:</span>
<a name="l00047"></a>00047 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00048"></a>00048 <span class="comment">//</span>
<a name="l00049"></a>00049 <span class="comment">//</span><span class="comment"></span>
<a name="l00050"></a>00050 <span class="comment">//! Ecrit les trois tableaux de la structure de stockage&lt;br&gt;Morse sur un flot de sortie.</span>
<a name="l00051"></a>00051 <span class="comment"></span><span class="comment">/** \return Sortie\&amp; s&lt;br&gt;</span>
<a name="l00052"></a>00052 <span class="comment">Signification: le flot de sortie modifie&lt;br&gt;</span>
<a name="l00053"></a>00053 <span class="comment">Contraintes: */</span>
<a name="l00054"></a><a class="code" href="classMatrice__Morse.html#a28b21c265cfd181b8ffb9fc1821abd33">00054</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classMatrice__Morse.html#a28b21c265cfd181b8ffb9fc1821abd33" title="Ecrit les trois tableaux de la structure de stockage Morse sur un flot de sortie.">Matrice_Morse::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00055"></a>00055 <span class="keyword"></span>{
<a name="l00056"></a>00056   s &lt;&lt; <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>;
<a name="l00057"></a>00057   s &lt;&lt; <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>;
<a name="l00058"></a>00058   s &lt;&lt; <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>;
<a name="l00059"></a>00059   s &lt;&lt; <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00060"></a>00060   <span class="keywordflow">return</span> s;
<a name="l00061"></a>00061 }
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="comment">// Precondition:</span>
<a name="l00064"></a>00064 <span class="comment">// Parametre: Entree&amp; s</span>
<a name="l00065"></a>00065 <span class="comment">// Signification: un flot d&#39;entree</span>
<a name="l00066"></a>00066 <span class="comment">// Valeurs par defaut:</span>
<a name="l00067"></a>00067 <span class="comment">// Contraintes:</span>
<a name="l00068"></a>00068 <span class="comment">// Acces:</span>
<a name="l00069"></a>00069 <span class="comment">// Exception: NON CODE</span>
<a name="l00070"></a>00070 <span class="comment">// Effets de bord:</span>
<a name="l00071"></a>00071 <span class="comment">// Postcondition:</span>
<a name="l00072"></a>00072 <span class="comment">//</span><span class="comment"></span>
<a name="l00073"></a>00073 <span class="comment">//! NON CODE</span>
<a name="l00074"></a>00074 <span class="comment"></span><span class="comment">/** \return Entree\&amp; s&lt;br&gt;</span>
<a name="l00075"></a>00075 <span class="comment">Signification: le flot d&#39;entree&lt;br&gt;</span>
<a name="l00076"></a>00076 <span class="comment">Contraintes: */</span>
<a name="l00077"></a><a class="code" href="classMatrice__Morse.html#a49ab0e8938f70c06575ad81b02065915">00077</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classMatrice__Morse.html#a49ab0e8938f70c06575ad81b02065915" title="NON CODE.">Matrice_Morse::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s)
<a name="l00078"></a>00078 {
<a name="l00079"></a>00079   s &gt;&gt; <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>;
<a name="l00080"></a>00080   s &gt;&gt; <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>;
<a name="l00081"></a>00081   s &gt;&gt; <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>;
<a name="l00082"></a>00082   s &gt;&gt; <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a>;
<a name="l00083"></a>00083   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00084"></a>00084   <span class="keywordflow">return</span> s;
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00087"></a><a class="code" href="classMatrice__Morse.html#a5061454fa787608b578aed2c4d5bf224">00087</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classMatrice__Morse.html#a5061454fa787608b578aed2c4d5bf224">Matrice_Morse::imprimer</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00088"></a>00088 <span class="keyword"></span>{
<a name="l00089"></a>00089   <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00090"></a>00090   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00091"></a>00091     {
<a name="l00092"></a>00092       s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00093"></a>00093       s &lt;&lt; <span class="stringliteral">&quot;--------------------------------&quot;</span> &lt;&lt; finl;
<a name="l00094"></a>00094       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
<a name="l00095"></a>00095         {
<a name="l00096"></a>00096           s &lt;&lt; <span class="stringliteral">&quot;(&quot;</span>&lt;&lt;(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1) &lt;&lt; <span class="stringliteral">&quot;),(&quot;</span> &lt;&lt;<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)&lt;&lt; <span class="stringliteral">&quot;) &quot;</span>
<a name="l00097"></a>00097             &lt;&lt; <span class="stringliteral">&quot; k= &quot;</span> &lt;&lt; k &lt;&lt; finl;
<a name="l00098"></a>00098         }
<a name="l00099"></a>00099       s &lt;&lt;finl;
<a name="l00100"></a>00100     }
<a name="l00101"></a>00101   <span class="keywordflow">return</span> s;
<a name="l00102"></a>00102 }
<a name="l00103"></a>00103 
<a name="l00104"></a><a class="code" href="classMatrice__Morse.html#a60c1de967d05b21b9b96a9bf6d73334e">00104</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classMatrice__Morse.html#a60c1de967d05b21b9b96a9bf6d73334e">Matrice_Morse::imprimer_formatte</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00105"></a>00105 <span class="keyword"></span>{
<a name="l00106"></a>00106   <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a60c1de967d05b21b9b96a9bf6d73334e">imprimer_formatte</a>(s,0);
<a name="l00107"></a>00107 }
<a name="l00108"></a>00108 
<a name="l00109"></a><a class="code" href="classMatrice__Morse.html#a66338277e3a4e8f250a151824e659171">00109</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classMatrice__Morse.html#a60c1de967d05b21b9b96a9bf6d73334e">Matrice_Morse::imprimer_formatte</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s, <span class="keywordtype">int</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac938491055e13993f3eed68c989f90b0" title="Symetrie.">symetrie</a>)<span class="keyword"> const</span>
<a name="l00110"></a>00110 <span class="keyword"></span>{
<a name="l00111"></a>00111   <span class="keywordtype">int</span> numerotation_fortran=(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a9001275280a9e5e22531a59c2993bcef">mp_min_vect</a>()==1);
<a name="l00112"></a>00112   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> proc=0; proc&lt;<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>(); proc++)
<a name="l00113"></a>00113     {
<a name="l00114"></a>00114       <span class="keywordflow">if</span> (proc==<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>())
<a name="l00115"></a>00115         {
<a name="l00116"></a>00116           s &lt;&lt; <span class="stringliteral">&quot;Matrix morse on the processor &quot;</span> &lt;&lt; proc &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00117"></a>00117           <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00118"></a>00118           <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a> tab_imp;
<a name="l00119"></a>00119           tab_imp.<a class="code" href="classvect__impl.html#ad841d6b676a796bae26ed2566b7b3b41">dimensionner</a>(<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>());
<a name="l00120"></a>00120           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00121"></a>00121             {
<a name="l00122"></a>00122               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>(); k++)
<a name="l00123"></a>00123                 tab_imp[k]=<span class="stringliteral">&quot;  .  &quot;</span>;
<a name="l00124"></a>00124               <span class="keywordflow">if</span> (i&lt;10)
<a name="l00125"></a>00125                 s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot; :&quot;</span> ;
<a name="l00126"></a>00126               <span class="keywordflow">else</span>
<a name="l00127"></a>00127                 s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> ;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129               <span class="keywordflow">if</span> (symetrie)
<a name="l00130"></a>00130                 {
<a name="l00131"></a>00131                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;i; j++)
<a name="l00132"></a>00132                     {
<a name="l00133"></a>00133                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(j)-numerotation_fortran; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(j+1)-numerotation_fortran; k++)
<a name="l00134"></a>00134                         <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran==i)
<a name="l00135"></a>00135                           tab_imp[j] = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k);
<a name="l00136"></a>00136                     }
<a name="l00137"></a>00137                   <span class="keywordtype">int</span> ligne=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-numerotation_fortran)-numerotation_fortran;
<a name="l00138"></a>00138                   <span class="keywordflow">if</span> (i!=ligne)
<a name="l00139"></a>00139                     {
<a name="l00140"></a>00140                       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Problem detected on this Matrice_Morse_Sym.&quot;</span> &lt;&lt; finl;
<a name="l00141"></a>00141                       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The diagonal of the line &quot;</span> &lt;&lt; ligne &lt;&lt; <span class="stringliteral">&quot; must be stored even if it is null.&quot;</span> &lt;&lt; finl;
<a name="l00142"></a>00142                       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00143"></a>00143                     }
<a name="l00144"></a>00144                 }
<a name="l00145"></a>00145               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-numerotation_fortran; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-numerotation_fortran; k++)
<a name="l00146"></a>00146                 <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)+!numerotation_fortran==0)
<a name="l00147"></a>00147                   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Line &quot;</span> &lt;&lt;i&lt;&lt; <span class="stringliteral">&quot; no coefficient &quot;</span>&lt;&lt;k&lt;&lt;finl;
<a name="l00148"></a>00148                 <span class="keywordflow">else</span>
<a name="l00149"></a>00149                   {
<a name="l00150"></a>00150                     <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)&gt;=0)
<a name="l00151"></a>00151                       tab_imp[<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran]=<span class="stringliteral">&quot; &quot;</span>;
<a name="l00152"></a>00152                     <span class="keywordflow">else</span>
<a name="l00153"></a>00153                       tab_imp[<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran]=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00154"></a>00154                     tab_imp[<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran] += (<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>)<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k);
<a name="l00155"></a>00155                   }
<a name="l00156"></a>00156               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>(); k++)
<a name="l00157"></a>00157                 s&lt;&lt;tab_imp[k];
<a name="l00158"></a>00158               s&lt;&lt;finl;
<a name="l00159"></a>00159             }
<a name="l00160"></a>00160         }
<a name="l00161"></a>00161       <a class="code" href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1" title="Synchronise tous les processeurs du groupe courant&lt;br&gt;(attend que tous les processeurs soient arrives...">Process::barrier</a>();
<a name="l00162"></a>00162     }
<a name="l00163"></a>00163   <span class="keywordflow">return</span> s;
<a name="l00164"></a>00164 }
<a name="l00165"></a>00165 
<a name="l00166"></a><a class="code" href="classMatrice__Morse.html#a518c0888db8297116700155dd97e58dc">00166</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classMatrice__Morse.html#a518c0888db8297116700155dd97e58dc">Matrice_Morse::imprimer_image</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00167"></a>00167 <span class="keyword"></span>{
<a name="l00168"></a>00168   <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a518c0888db8297116700155dd97e58dc">imprimer_image</a>(s,0);
<a name="l00169"></a>00169 }
<a name="l00170"></a>00170 
<a name="l00171"></a><a class="code" href="classMatrice__Morse.html#a28da443e8ba8168bf04e5368dfef7a8f">00171</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classMatrice__Morse.html#a518c0888db8297116700155dd97e58dc">Matrice_Morse::imprimer_image</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s, <span class="keywordtype">int</span> <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac938491055e13993f3eed68c989f90b0" title="Symetrie.">symetrie</a>)<span class="keyword"> const</span>
<a name="l00172"></a>00172 <span class="keyword"></span>{
<a name="l00173"></a>00173   <span class="keywordtype">int</span> numerotation_fortran=(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a9001275280a9e5e22531a59c2993bcef">mp_min_vect</a>()==1);
<a name="l00174"></a>00174   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> proc=0; proc&lt;<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>(); proc++)
<a name="l00175"></a>00175     {
<a name="l00176"></a>00176       <span class="keywordflow">if</span> (proc==<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>())
<a name="l00177"></a>00177         {
<a name="l00178"></a>00178           s &lt;&lt; <span class="stringliteral">&quot;Matrix morse on the processor &quot;</span> &lt;&lt; proc &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00179"></a>00179           <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00180"></a>00180           <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a> tab_imp;
<a name="l00181"></a>00181           tab_imp.<a class="code" href="classvect__impl.html#ad841d6b676a796bae26ed2566b7b3b41">dimensionner</a>(<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>());
<a name="l00182"></a>00182           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00183"></a>00183             {
<a name="l00184"></a>00184               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>(); k++)
<a name="l00185"></a>00185                 tab_imp[k]=<span class="stringliteral">&quot;\u2588\u2588&quot;</span>;
<a name="l00186"></a>00186               <span class="keywordflow">if</span> (i&lt;10)
<a name="l00187"></a>00187                 s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot; :&quot;</span> ;
<a name="l00188"></a>00188               <span class="keywordflow">else</span>
<a name="l00189"></a>00189                 s &lt;&lt;i &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> ;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191               <span class="keywordflow">if</span> (symetrie)
<a name="l00192"></a>00192                 {
<a name="l00193"></a>00193                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;i; j++)
<a name="l00194"></a>00194                     {
<a name="l00195"></a>00195                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(j)-numerotation_fortran; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(j+1)-numerotation_fortran; k++)
<a name="l00196"></a>00196                         <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran==i)
<a name="l00197"></a>00197                           tab_imp[j] = (<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) &gt;= 0) ? <span class="stringliteral">&quot;  &quot;</span> : <span class="stringliteral">&quot;\u2592\u2592&quot;</span>;
<a name="l00198"></a>00198                     }
<a name="l00199"></a>00199                   <span class="keywordtype">int</span> ligne=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-numerotation_fortran)-numerotation_fortran;
<a name="l00200"></a>00200                   <span class="keywordflow">if</span> (i!=ligne)
<a name="l00201"></a>00201                     {
<a name="l00202"></a>00202                       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Problem detected on this Matrice_Morse_Sym.&quot;</span> &lt;&lt; finl;
<a name="l00203"></a>00203                       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The diagonal of the line &quot;</span> &lt;&lt; ligne &lt;&lt; <span class="stringliteral">&quot; must be stored even if it is null.&quot;</span> &lt;&lt; finl;
<a name="l00204"></a>00204                       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00205"></a>00205                     }
<a name="l00206"></a>00206                 }
<a name="l00207"></a>00207               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-numerotation_fortran; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-numerotation_fortran; k++)
<a name="l00208"></a>00208                 <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)+!numerotation_fortran==0)
<a name="l00209"></a>00209                   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Line &quot;</span> &lt;&lt;i&lt;&lt; <span class="stringliteral">&quot; no coefficient &quot;</span>&lt;&lt;k&lt;&lt;finl;
<a name="l00210"></a>00210                 <span class="keywordflow">else</span>
<a name="l00211"></a>00211                   tab_imp[<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-numerotation_fortran] = (<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) &gt;= 0) ? <span class="stringliteral">&quot;  &quot;</span> : <span class="stringliteral">&quot;\u2592\u2592&quot;</span>;
<a name="l00212"></a>00212 
<a name="l00213"></a>00213               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>(); k++)
<a name="l00214"></a>00214                 s&lt;&lt;tab_imp[k];
<a name="l00215"></a>00215               s&lt;&lt;finl;
<a name="l00216"></a>00216             }
<a name="l00217"></a>00217         }
<a name="l00218"></a>00218       <a class="code" href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1" title="Synchronise tous les processeurs du groupe courant&lt;br&gt;(attend que tous les processeurs soient arrives...">Process::barrier</a>();
<a name="l00219"></a>00219     }
<a name="l00220"></a>00220   <span class="keywordflow">return</span> s;
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 <span class="comment">// Precondition:</span>
<a name="l00225"></a>00225 <span class="comment">// Parametre: Matrice_Morse&amp; acopier</span>
<a name="l00226"></a>00226 <span class="comment">// Signification: la matrice morse a copier</span>
<a name="l00227"></a>00227 <span class="comment">// Valeurs par defaut:</span>
<a name="l00228"></a>00228 <span class="comment">// Contraintes: reference constante</span>
<a name="l00229"></a>00229 <span class="comment">// Acces: entree</span>
<a name="l00230"></a>00230 <span class="comment">// </span>
<a name="l00231"></a>00231 <span class="comment">// Signification:</span>
<a name="l00232"></a>00232 <span class="comment">// Contraintes:</span>
<a name="l00233"></a>00233 <span class="comment">// Exception:</span>
<a name="l00234"></a>00234 <span class="comment">// Effets de bord:</span>
<a name="l00235"></a>00235 <span class="comment">// Postcondition:</span>
<a name="l00236"></a>00236 <span class="comment">//</span>
<a name="l00237"></a>00237 <span class="comment">//</span><span class="comment"></span>
<a name="l00238"></a>00238 <span class="comment">//! Constructeur par copie d&#39;une Matrice_Morse.&lt;br&gt;Copie de chaque membre donne du paramtre.</span>
<a name="l00239"></a><a class="code" href="classMatrice__Morse.html#ab114473e0598bf631416343daaa8be0e">00239</a> <span class="comment"></span><a class="code" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">Matrice_Morse::Matrice_Morse</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; acopier) :<a class="code" href="classMatrice__Base.html">Matrice_Base</a>(),
<a name="l00240"></a>00240   tab1_(acopier.tab1_),
<a name="l00241"></a>00241   tab2_(acopier.tab2_),
<a name="l00242"></a>00242   coeff_(acopier.coeff_),
<a name="l00243"></a>00243   m_(acopier.m_),
<a name="l00244"></a>00244   symetrique_(0),
<a name="l00245"></a>00245   zero_(0)
<a name="l00246"></a>00246 {
<a name="l00247"></a>00247   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00248"></a>00248   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = acopier.<a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> ;
<a name="l00249"></a>00249 }
<a name="l00250"></a>00250 <span class="comment">// Precondition:</span>
<a name="l00251"></a>00251 <span class="comment">// Parametre: int n</span>
<a name="l00252"></a>00252 <span class="comment">// Signification: l&#39;ordre de la matrice carree a construire</span>
<a name="l00253"></a>00253 <span class="comment">// Valeurs par defaut: 1</span>
<a name="l00254"></a>00254 <span class="comment">// Contraintes:</span>
<a name="l00255"></a>00255 <span class="comment">// Acces:</span>
<a name="l00256"></a>00256 <span class="comment">// Parametre: int nnz</span>
<a name="l00257"></a>00257 <span class="comment">// Signification: le nombre d&#39;elements non nuls que pourra</span>
<a name="l00258"></a>00258 <span class="comment">// stocker la matrice.</span>
<a name="l00259"></a>00259 <span class="comment">// Valeurs par defaut: 1</span>
<a name="l00260"></a>00260 <span class="comment">// Contraintes:</span>
<a name="l00261"></a>00261 <span class="comment">// Acces:</span>
<a name="l00262"></a>00262 <span class="comment">// </span>
<a name="l00263"></a>00263 <span class="comment">// Signification:</span>
<a name="l00264"></a>00264 <span class="comment">// Contraintes:</span>
<a name="l00265"></a>00265 <span class="comment">// Exception:</span>
<a name="l00266"></a>00266 <span class="comment">// Effets de bord:</span>
<a name="l00267"></a>00267 <span class="comment">// Postcondition:</span>
<a name="l00268"></a>00268 <span class="comment">//</span>
<a name="l00269"></a>00269 <span class="comment">//</span>
<a name="l00270"></a>00270 <span class="comment">//</span>
<a name="l00271"></a>00271 <span class="comment">//</span><span class="comment"></span>
<a name="l00272"></a>00272 <span class="comment">//! Constructeur d&#39;une matrice Morse carree d&#39;ordre n&lt;br&gt;et pouvant stocker au maximum nnz elements non nuls.&lt;br&gt;Egalement constructeur par defaut car les 2 parametres&lt;br&gt;ont une valeur par defaut.</span>
<a name="l00273"></a><a class="code" href="classMatrice__Morse.html#a8763add3c9688e9b5c84c31107d7c15a">00273</a> <span class="comment"></span><a class="code" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">Matrice_Morse::Matrice_Morse</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> nnz) :
<a name="l00274"></a>00274   morse_matrix_structure_has_changed_(1), symetrique_(0), zero_(0)
<a name="l00275"></a>00275 {
<a name="l00276"></a>00276   <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n,nnz);
<a name="l00277"></a>00277   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = false ;
<a name="l00278"></a>00278 }
<a name="l00279"></a>00279 
<a name="l00280"></a><a class="code" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">00280</a> <a class="code" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">Matrice_Morse::Matrice_Morse</a>()
<a name="l00281"></a>00281 {
<a name="l00282"></a>00282   <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(0,0);
<a name="l00283"></a>00283   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00284"></a>00284   <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a> = 0;
<a name="l00285"></a>00285   <a class="code" href="classMatrice__Morse.html#a8e9254acaa95bbcb76a8ff1772b9b572">zero_</a> = 0;
<a name="l00286"></a>00286   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = false ;
<a name="l00287"></a>00287 }
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 
<a name="l00290"></a>00290 <span class="comment">// Precondition:</span>
<a name="l00291"></a>00291 <span class="comment">// Parametre: int n</span>
<a name="l00292"></a>00292 <span class="comment">// Signification: le nombre de ligne de la matrice</span>
<a name="l00293"></a>00293 <span class="comment">// Valeurs par defaut:</span>
<a name="l00294"></a>00294 <span class="comment">// Contraintes:</span>
<a name="l00295"></a>00295 <span class="comment">// Acces:</span>
<a name="l00296"></a>00296 <span class="comment">// Parametre: int m</span>
<a name="l00297"></a>00297 <span class="comment">// Signification: le nombre de colonne de la matrice</span>
<a name="l00298"></a>00298 <span class="comment">// Valeurs par defaut:</span>
<a name="l00299"></a>00299 <span class="comment">// Contraintes:</span>
<a name="l00300"></a>00300 <span class="comment">// Acces:</span>
<a name="l00301"></a>00301 <span class="comment">// Parametre: int nnz</span>
<a name="l00302"></a>00302 <span class="comment">// Signification: le nombre d&#39;elements non nuls que pourra</span>
<a name="l00303"></a>00303 <span class="comment">// stocker la matrice.</span>
<a name="l00304"></a>00304 <span class="comment">// Valeurs par defaut:</span>
<a name="l00305"></a>00305 <span class="comment">// Contraintes:</span>
<a name="l00306"></a>00306 <span class="comment">// Acces:</span>
<a name="l00307"></a>00307 <span class="comment">// </span>
<a name="l00308"></a>00308 <span class="comment">// Signification:</span>
<a name="l00309"></a>00309 <span class="comment">// Contraintes:</span>
<a name="l00310"></a>00310 <span class="comment">// Exception:</span>
<a name="l00311"></a>00311 <span class="comment">// Effets de bord:</span>
<a name="l00312"></a>00312 <span class="comment">// Postcondition:</span>
<a name="l00313"></a>00313 <span class="comment">//</span>
<a name="l00314"></a>00314 <span class="comment">//</span><span class="comment"></span>
<a name="l00315"></a>00315 <span class="comment">//! Constructeur d&#39;une matrice Morse avec n lignes et m colonnes&lt;br&gt;pouvant stocker au maximum nnz elements non nuls.</span>
<a name="l00316"></a><a class="code" href="classMatrice__Morse.html#a77e544c96b37ab92ca8d5e3f964acc9f">00316</a> <span class="comment"></span><a class="code" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">Matrice_Morse::Matrice_Morse</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> nnz):
<a name="l00317"></a>00317   morse_matrix_structure_has_changed_(1), symetrique_(0), zero_(0)
<a name="l00318"></a>00318 {
<a name="l00319"></a>00319   <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n,m,nnz);
<a name="l00320"></a>00320   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = false ;
<a name="l00321"></a>00321 }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323 
<a name="l00324"></a><a class="code" href="classMatrice__Morse.html#a48c84b2db8020db9e7e9e9855a17cbd4">00324</a> <a class="code" href="classMatrice__Morse.html#a6c3f7ff3eb33b4f893a98f93f485d133">Matrice_Morse::Matrice_Morse</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> nnz, <span class="keyword">const</span> <a class="code" href="classIntLists.html" title="Un tableau de listes de type IntList.">IntLists</a>&amp; voisins,
<a name="l00325"></a>00325                              <span class="keyword">const</span> <a class="code" href="classDoubleLists.html" title="Un tableau de listes de type DoubleList.">DoubleLists</a>&amp; valeurs,
<a name="l00326"></a>00326                              <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; terme_diag)
<a name="l00327"></a>00327   :  morse_matrix_structure_has_changed_(1), symetrique_(0) , zero_(0)
<a name="l00328"></a>00328 {
<a name="l00329"></a>00329   <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n,n,nnz);
<a name="l00330"></a>00330   <a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">remplir</a>(voisins, valeurs, terme_diag);
<a name="l00331"></a>00331   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> = <span class="keyword">false</span>;
<a name="l00332"></a>00332 }
<a name="l00333"></a>00333 
<a name="l00334"></a><a class="code" href="classMatrice__Morse.html#ab2fb02a8aba88f717c2285960f375fba">00334</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#ab2fb02a8aba88f717c2285960f375fba">Matrice_Morse::set_nb_columns</a>( <span class="keyword">const</span> <span class="keywordtype">int</span> nb_col )
<a name="l00335"></a>00335 {
<a name="l00336"></a>00336   <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a> = nb_col;
<a name="l00337"></a>00337 }
<a name="l00338"></a>00338 
<a name="l00339"></a><a class="code" href="classMatrice__Morse.html#ae99753a8725a9a7f58b62d6e675a69d8">00339</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#ae99753a8725a9a7f58b62d6e675a69d8">Matrice_Morse::set_symmetric</a>( <span class="keyword">const</span> <span class="keywordtype">int</span> symmetric )
<a name="l00340"></a>00340 {
<a name="l00341"></a>00341   <a class="code" href="classMatrice__Morse.html#aa18902f5bb7084749524e6625ad35816" title="Pour inliner operator()(i,j) afin d&#39;optimiser.">symetrique_</a> = symmetric ;
<a name="l00342"></a>00342 }
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 <span class="comment">//</span><span class="comment"></span>
<a name="l00345"></a>00345 <span class="comment">//! Size the matrix with n lines and n columns and nnz zero-values coefficients</span>
<a name="l00346"></a><a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">00346</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">Matrice_Morse::dimensionner</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> nnz)
<a name="l00347"></a>00347 {
<a name="l00348"></a>00348   <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n,n,nnz);
<a name="l00349"></a>00349   return ;
<a name="l00350"></a>00350 }
<a name="l00351"></a>00351 
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 <span class="comment">// Description</span>
<a name="l00354"></a>00354 <span class="comment">// Redimensionne la matrice creuse en ajoutant eventuellement</span>
<a name="l00355"></a>00355 <span class="comment">// des coefficients non nuls</span>
<a name="l00356"></a>00356 <span class="comment">// </span>
<a name="l00357"></a>00357 <span class="comment">// Parametre : const IntTab &amp;Ind</span>
<a name="l00358"></a>00358 <span class="comment">// Signification : tableau de taille nc * 2</span>
<a name="l00359"></a>00359 <span class="comment">// ou nc est le nombre de couples (i,j)</span>
<a name="l00360"></a>00360 <span class="comment">// pour les indices des nouveaux coefficients</span>
<a name="l00361"></a>00361 <span class="comment">// </span>
<a name="l00362"></a>00362 <span class="comment">// Postcondition:</span>
<a name="l00363"></a>00363 <span class="comment">// A la sortie, les coefficients non nuls sur une ligne</span>
<a name="l00364"></a>00364 <span class="comment">// ne sont plus necessairement trie par ordre croissant</span>
<a name="l00365"></a>00365 <span class="comment">// d&#39;indice de colonne (a faire ?)</span>
<a name="l00366"></a>00366 <span class="comment">// (modif MT)</span>
<a name="l00367"></a>00367 <span class="comment">// </span>
<a name="l00368"></a><a class="code" href="classMatrice__Morse.html#a782ad0bcd14245c72494c85d7feab9f7">00368</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">Matrice_Morse::dimensionner</a>(<span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; Ind)
<a name="l00369"></a>00369 {
<a name="l00370"></a>00370   <span class="keywordflow">if</span> (Ind.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>()==0) <span class="keywordflow">return</span>; <span class="comment">//!&lt; On ne fait rien si la structure est vide</span>
<a name="l00371"></a>00371 <span class="comment"></span>  <span class="keywordtype">int</span> n_ancien = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>(), m_ancien = <a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();
<a name="l00372"></a>00372 
<a name="l00373"></a>00373   assert(Ind.<a class="code" href="classIntTab.html#ae307ece7edbe1d5facfbb81953b3e2b1" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 2);
<a name="l00374"></a>00374   assert(Ind.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) == 2);
<a name="l00375"></a>00375 
<a name="l00376"></a>00376 <span class="comment">// Calcul du nouveau nombre de lignes</span>
<a name="l00377"></a>00377 <span class="comment">// = max (ancien, indices de ligne des nouveaux coeffs)</span>
<a name="l00378"></a>00378 <span class="comment">// </span>
<a name="l00379"></a>00379 <span class="comment">// et du nouveau nombre de colonnes</span>
<a name="l00380"></a>00380 <span class="comment">// = max (ancien, indices de colonne des nouveaux coeffs)</span>
<a name="l00381"></a>00381 
<a name="l00382"></a>00382   <span class="keywordtype">int</span> nInd = Ind.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00383"></a>00383   <span class="keywordtype">int</span> n = 0;
<a name="l00384"></a>00384   <span class="keywordtype">int</span> m = 0;
<a name="l00385"></a>00385   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nInd; i++)
<a name="l00386"></a>00386     {
<a name="l00387"></a>00387       <span class="keywordflow">if</span> (n &lt; Ind(i,0)) n = Ind(i,0);
<a name="l00388"></a>00388       <span class="keywordflow">if</span> (m &lt; Ind(i,1)) m = Ind(i,1);
<a name="l00389"></a>00389     }
<a name="l00390"></a>00390   n++;
<a name="l00391"></a>00391   m++;
<a name="l00392"></a>00392   <span class="keywordflow">if</span> (n &lt; n_ancien) n = n_ancien;
<a name="l00393"></a>00393   <span class="keywordflow">if</span> (m &lt; m_ancien) m = m_ancien;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395 <span class="comment">// Copies des anciens tableaux d&#39;indices</span>
<a name="l00396"></a>00396 
<a name="l00397"></a>00397   <a class="code" href="classIntVect.html">IntVect</a> tab1_temp(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>);
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 <span class="comment">// Initialisation au nombre de coefficients deja presents a chaque ligne</span>
<a name="l00400"></a>00400 
<a name="l00401"></a>00401   <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n+1);
<a name="l00402"></a>00402   <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a> = m;
<a name="l00403"></a>00403 
<a name="l00404"></a>00404   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=n_ancien; i++)
<a name="l00405"></a>00405     <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] = tab1_temp[i] - tab1_temp[i-1];
<a name="l00406"></a>00406   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=n_ancien+1; i&lt;=n; i++)
<a name="l00407"></a>00407     <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] = 0;
<a name="l00408"></a>00408 
<a name="l00409"></a>00409 <span class="comment">// Parcourt des indices des nouveaux coeffs pour voir s&#39;ils sont</span>
<a name="l00410"></a>00410 <span class="comment">// deja presents</span>
<a name="l00411"></a>00411 
<a name="l00412"></a>00412   <span class="keywordtype">int</span> i_nouveaux = 0;
<a name="l00413"></a>00413   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nInd; i++)
<a name="l00414"></a>00414     {
<a name="l00415"></a>00415       <span class="keywordtype">int</span> i0 = Ind(i,0);
<a name="l00416"></a>00416       <span class="keywordtype">int</span> i1 = Ind(i,1) + 1;
<a name="l00417"></a>00417 
<a name="l00418"></a>00418       <span class="keywordtype">int</span> test_present = 0;
<a name="l00419"></a>00419 
<a name="l00420"></a>00420       <span class="keywordflow">if</span> (i0 &lt; n_ancien)
<a name="l00421"></a>00421         {
<a name="l00422"></a>00422           <span class="keywordtype">int</span> kmin = tab1_temp[i0]-1;
<a name="l00423"></a>00423           <span class="keywordtype">int</span> kmax = tab1_temp[i0+1]-1;
<a name="l00424"></a>00424           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=kmin; k&lt;kmax; k++)
<a name="l00425"></a>00425             <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] == i1)
<a name="l00426"></a>00426               {
<a name="l00427"></a>00427                 test_present = 1;
<a name="l00428"></a>00428                 <span class="keywordflow">break</span>;
<a name="l00429"></a>00429               }
<a name="l00430"></a>00430         }
<a name="l00431"></a>00431       <span class="keywordflow">if</span> (!test_present)
<a name="l00432"></a>00432         {
<a name="l00433"></a>00433           i_nouveaux++;
<a name="l00434"></a>00434           <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i0+1] += 1;
<a name="l00435"></a>00435         }
<a name="l00436"></a>00436     }
<a name="l00437"></a>00437   <span class="keywordflow">if</span> (i_nouveaux == 0)
<a name="l00438"></a>00438     {
<a name="l00439"></a>00439       <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>=tab1_temp;
<a name="l00440"></a>00440       <span class="keywordflow">return</span>;
<a name="l00441"></a>00441     }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443 <span class="comment">// Nouveau tableau des positions des premiers coeffs de chaque ligne</span>
<a name="l00444"></a>00444   <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[0] = 1;
<a name="l00445"></a>00445   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=n; i++)
<a name="l00446"></a>00446     <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] += <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i-1];
<a name="l00447"></a>00447 
<a name="l00448"></a>00448   <span class="keywordtype">int</span> nnz_ancien = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>();
<a name="l00449"></a>00449   <span class="keywordtype">int</span> nnz = nnz_ancien + i_nouveaux;
<a name="l00450"></a>00450 
<a name="l00451"></a>00451   <a class="code" href="classIntVect.html">IntVect</a> tab2_temp(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>);
<a name="l00452"></a>00452   <a class="code" href="classDoubleVect.html">DoubleVect</a> coeff_temp(<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>);
<a name="l00453"></a>00453   <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);
<a name="l00454"></a>00454   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);
<a name="l00455"></a>00455 
<a name="l00456"></a>00456 <span class="comment">// Recopie des anciens coefficients et de leurs indices</span>
<a name="l00457"></a>00457 <span class="comment">// de colonne dans les nouveaux tableaux</span>
<a name="l00458"></a>00458 
<a name="l00459"></a>00459   <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a> = -1;
<a name="l00460"></a>00460   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_ancien; i++)
<a name="l00461"></a>00461     {
<a name="l00462"></a>00462       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j1 = tab1_temp[i]-1, j2 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1;
<a name="l00463"></a>00463            j1 &lt; tab1_temp[i+1]-1;
<a name="l00464"></a>00464            j1++, j2++)
<a name="l00465"></a>00465         {
<a name="l00466"></a>00466           <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[j2] = tab2_temp[j1];
<a name="l00467"></a>00467           <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[j2] = coeff_temp[j1];
<a name="l00468"></a>00468         }
<a name="l00469"></a>00469     }
<a name="l00470"></a>00470 
<a name="l00471"></a>00471   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nInd; i++)
<a name="l00472"></a>00472     {
<a name="l00473"></a>00473       <span class="keywordtype">int</span> j0 = Ind(i,0);
<a name="l00474"></a>00474       <span class="keywordtype">int</span> j1 = Ind(i,1) + 1;
<a name="l00475"></a>00475       <span class="keywordtype">int</span> k;
<a name="l00476"></a>00476       <span class="keywordflow">for</span> (k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j0]-1; <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] &gt;= 0; k++)
<a name="l00477"></a>00477         <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] == j1)
<a name="l00478"></a>00478           {
<a name="l00479"></a>00479             <span class="keywordflow">break</span>;
<a name="l00480"></a>00480           }
<a name="l00481"></a>00481       <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] &lt; 0)
<a name="l00482"></a>00482         {
<a name="l00483"></a>00483           <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] = j1;
<a name="l00484"></a>00484           <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[k] = 0.0;
<a name="l00485"></a>00485         }
<a name="l00486"></a>00486     }
<a name="l00487"></a>00487 <span class="comment">// on remet les coeffs dans l&#39;ordre... pas optimal mais pour voir..</span>
<a name="l00488"></a>00488   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>=0;
<a name="l00489"></a>00489 <span class="comment">// </span>
<a name="l00490"></a>00490   {
<a name="l00491"></a>00491     <span class="keywordtype">int</span> nbis=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00492"></a>00492     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nbis; i++)
<a name="l00493"></a>00493       {
<a name="l00494"></a>00494         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
<a name="l00495"></a>00495           {
<a name="l00496"></a>00496             <span class="keywordflow">for</span> (<span class="keywordtype">int</span>  k2=k; k2&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k2++)
<a name="l00497"></a>00497               {
<a name="l00498"></a>00498                 <span class="keywordtype">int</span> j1=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k);
<a name="l00499"></a>00499                 <span class="keywordtype">int</span> j2=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k2);
<a name="l00500"></a>00500                 <span class="keywordflow">if</span> (j1&gt;j2)
<a name="l00501"></a>00501                   {
<a name="l00502"></a>00502                     <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)=j2;
<a name="l00503"></a>00503                     <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k2)=j1;
<a name="l00504"></a>00504                   }
<a name="l00505"></a>00505               }
<a name="l00506"></a>00506           }
<a name="l00507"></a>00507       }
<a name="l00508"></a>00508   }
<a name="l00509"></a>00509   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00510"></a>00510 }
<a name="l00511"></a>00511 
<a name="l00512"></a>00512 <span class="comment">//</span><span class="comment"></span>
<a name="l00513"></a>00513 <span class="comment">//! Size the matrix with n lines, m columns with nnz zero-values coefficients</span>
<a name="l00514"></a><a class="code" href="classMatrice__Morse.html#a5d58732a34204377b1531de430b6230b">00514</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">Matrice_Morse::dimensionner</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> nnz)
<a name="l00515"></a>00515 {
<a name="l00516"></a>00516   <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);
<a name="l00517"></a>00517   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);
<a name="l00518"></a>00518   <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a>=m;
<a name="l00519"></a>00519 
<a name="l00520"></a>00520 <span class="comment">// on regarde si tab1 a la bonne taille et si tab1[n1]==nnz.</span>
<a name="l00521"></a>00521   <span class="keywordflow">if</span> ( <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()!=(n+1) || (<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[n]-1)!=nnz )
<a name="l00522"></a>00522     {
<a name="l00523"></a>00523       <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n+1);
<a name="l00524"></a>00524       <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>=1;
<a name="l00525"></a>00525     }
<a name="l00526"></a>00526   <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n+1);
<a name="l00527"></a>00527   <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[n]=nnz+1;
<a name="l00528"></a>00528 
<a name="l00529"></a>00529   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00530"></a>00530 }
<a name="l00531"></a>00531 
<a name="l00532"></a>00532 <span class="comment">// Description</span>
<a name="l00533"></a>00533 <span class="comment">// Initialisation a la matrice unite</span>
<a name="l00534"></a>00534 <span class="comment">// (modif MT)</span>
<a name="l00535"></a><a class="code" href="classMatrice__Morse.html#afc6dc20707960db1921c7e1ca90966a8">00535</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#afc6dc20707960db1921c7e1ca90966a8">Matrice_Morse::unite</a>()
<a name="l00536"></a>00536 {
<a name="l00537"></a>00537   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> = 0.0;
<a name="l00538"></a>00538   <span class="keywordtype">int</span> i,n  = <a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>();
<a name="l00539"></a>00539   <span class="keywordflow">for</span> (i=0; i&lt;n; i++)
<a name="l00540"></a>00540     <span class="keyword">operator</span>()(i,i) = 1.0;
<a name="l00541"></a>00541 }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 <span class="comment">// Precondition:</span>
<a name="l00544"></a>00544 <span class="comment">// Parametre:</span>
<a name="l00545"></a>00545 <span class="comment">// Signification:</span>
<a name="l00546"></a>00546 <span class="comment">// Valeurs par defaut:</span>
<a name="l00547"></a>00547 <span class="comment">// Contraintes:</span>
<a name="l00548"></a>00548 <span class="comment">// Acces:</span>
<a name="l00549"></a>00549 <span class="comment">// Exception:</span>
<a name="l00550"></a>00550 <span class="comment">// Effets de bord:</span>
<a name="l00551"></a>00551 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00552"></a>00552 <span class="comment">//</span>
<a name="l00553"></a>00553 <span class="comment">//</span>
<a name="l00554"></a>00554 <span class="comment">//</span><span class="comment"></span>
<a name="l00555"></a>00555 <span class="comment">//! Renvoie l&#39;ordre de la matrice:&lt;br&gt;- le nombre de lignes si la matrice est carree&lt;br&gt;- 0 sinon</span>
<a name="l00556"></a>00556 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00557"></a>00557 <span class="comment">Signification: l&#39;ordre de la matrice&lt;br&gt;</span>
<a name="l00558"></a>00558 <span class="comment">Contraintes: */</span>
<a name="l00559"></a><a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a">00559</a> <span class="keywordtype">int</span> <a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">Matrice_Morse::ordre</a>()<span class="keyword"> const</span>
<a name="l00560"></a>00560 <span class="keyword"></span>{
<a name="l00561"></a>00561   <span class="keywordflow">if</span>(<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>()==<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>())
<a name="l00562"></a>00562     <span class="keywordflow">return</span> <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00563"></a>00563   <span class="keywordflow">else</span>
<a name="l00564"></a>00564     <span class="keywordflow">return</span> 0;
<a name="l00565"></a>00565 }
<a name="l00566"></a>00566 
<a name="l00567"></a>00567 <span class="comment">//</span>
<a name="l00568"></a>00568 <span class="comment">//</span>
<a name="l00569"></a>00569 <span class="comment">//</span>
<a name="l00570"></a>00570 <span class="comment">//</span>
<a name="l00571"></a>00571 <span class="comment">//</span><span class="comment"></span>
<a name="l00572"></a>00572 <span class="comment">//! Method to check/clean the Matrice_Morse matrix:&lt;br&gt;-Suppress coefficient defined several times&lt;br&gt;-elim_coeff_nul=0, on ne supprime pas les coefficients nuls de la matrice&lt;br&gt;-elim_coeff_nul=1, on supprime les coefficients nuls de la matrice&lt;br&gt;-elim_coeff_nul=2, on supprime les coefficients nuls et quasi-nuls de la matrice</span>
<a name="l00573"></a><a class="code" href="classMatrice__Morse.html#af20143b6c3f18319cc28c326a64f031c">00573</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#af20143b6c3f18319cc28c326a64f031c" title="Method to check/clean the Matrice_Morse matrix: -Suppress coefficient defined several times -elim_coe...">Matrice_Morse::compacte</a>(<span class="keywordtype">int</span> elim_coeff_nul)
<a name="l00574"></a>00574 {
<a name="l00575"></a>00575   <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00576"></a>00576 
<a name="l00577"></a>00577   <span class="keywordtype">int</span> coeff_nuls=0;
<a name="l00578"></a>00578   <span class="keywordtype">int</span> coeff_quasi_nuls=0;
<a name="l00579"></a>00579   <a class="code" href="classIntTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un IntTab avec allocation dans un pool de memoire gere...">IntTrav</a> elim_coeff(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>);
<a name="l00580"></a>00580   <span class="keywordflow">if</span> (elim_coeff_nul)
<a name="l00581"></a>00581     {
<a name="l00582"></a>00582       <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> coeff_max(n);
<a name="l00583"></a>00583 <span class="comment">// Recherche des coefficients nuls hors diagonale a supprimer de la matrice morse</span>
<a name="l00584"></a>00584       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00585"></a>00585         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
<a name="l00586"></a>00586           {
<a name="l00587"></a>00587             <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k))&gt;coeff_max(i)) coeff_max(i)=<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k));
<a name="l00588"></a>00588             <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)==0)
<a name="l00589"></a>00589               {
<a name="l00590"></a>00590                 coeff_nuls++;
<a name="l00591"></a>00591                 elim_coeff(k)=1;
<a name="l00592"></a>00592               }
<a name="l00593"></a>00593           }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595       <span class="keywordflow">if</span> (elim_coeff_nul==2)
<a name="l00596"></a>00596         {
<a name="l00597"></a>00597 <span class="comment">// Recherche des coefficients quasi nuls hors diagonale (1.e-12 plus petit que le coefficient le plus grand de la ligne) a supprimer de la matrice morse</span>
<a name="l00598"></a>00598           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00599"></a>00599             <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(coeff_max(i),0)         <span class="comment">//!&lt; Le plus grand coefficient doit etre strictement positif</span>
<a name="l00600"></a>00600 <span class="comment"></span>                &amp;&amp; coeff_max(i)&lt;1e10)          <span class="comment">//!&lt; On ne supprime pas un coefficient quasi-nul d&#39;une ligne ou la diagonale peut etre mise a 1e12</span>
<a name="l00601"></a>00601 <span class="comment"></span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
<a name="l00602"></a>00602                 <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)!=0                 <span class="comment">//!&lt; Les coefficients nuls ont deja ete trouves</span>
<a name="l00603"></a>00603 <span class="comment"></span>                    &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k))/coeff_max(i),0))
<a name="l00604"></a>00604                   {
<a name="l00605"></a>00605                     coeff_quasi_nuls++;
<a name="l00606"></a>00606                     elim_coeff(k)=1;
<a name="l00607"></a>00607                   }
<a name="l00608"></a>00608         }
<a name="l00609"></a>00609     }
<a name="l00610"></a>00610 <span class="comment">// Recherche des coefficients doublons</span>
<a name="l00611"></a>00611   <span class="keywordtype">int</span> doublons=0;
<a name="l00612"></a>00612   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00613"></a>00613     {
<a name="l00614"></a>00614       <span class="keywordtype">int</span> kmin=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1;
<a name="l00615"></a>00615       <span class="keywordtype">int</span> kmax=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1;
<a name="l00616"></a>00616       <span class="keywordtype">int</span> jmax=-1; <span class="comment">//!&lt; Highest column of a coefficient in the line i</span>
<a name="l00617"></a>00617 <span class="comment"></span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=kmin; k&lt;kmax; k++)
<a name="l00618"></a>00618         {
<a name="l00619"></a>00619           <span class="keywordtype">int</span> j = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1;
<a name="l00620"></a>00620           <span class="keywordflow">if</span> (j&gt;jmax)
<a name="l00621"></a>00621             jmax=j;
<a name="l00622"></a>00622           <span class="keywordflow">else</span>
<a name="l00623"></a>00623             {
<a name="l00624"></a>00624 <span class="comment">// Found a column j lower than jmax, check if not defined before:</span>
<a name="l00625"></a>00625               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk=k-1; kk&gt;=kmin; kk--)
<a name="l00626"></a>00626                 {
<a name="l00627"></a>00627                   <span class="keywordtype">int</span> jj = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(kk)-1;
<a name="l00628"></a>00628                   <span class="keywordflow">if</span> (jj == j)
<a name="l00629"></a>00629                     {
<a name="l00630"></a>00630 <span class="comment">// Already defined!</span>
<a name="l00631"></a>00631                       doublons=1;
<a name="l00632"></a>00632                       elim_coeff(k)=1;
<a name="l00633"></a>00633 <span class="comment">// Check if same coefficients:</span>
<a name="l00634"></a>00634                       <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(kk)!=<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k))
<a name="l00635"></a>00635                         {
<a name="l00636"></a>00636                           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in a Matrix Morse:&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00637"></a>00637                           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;A(&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;j&lt;&lt;<span class="stringliteral">&quot;)=&quot;</span>&lt;&lt;<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)&lt;&lt;<span class="stringliteral">&quot; != &quot;</span>&lt;&lt;<span class="stringliteral">&quot;A(&quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot;,&quot;</span>&lt;&lt;jj&lt;&lt;<span class="stringliteral">&quot;)=&quot;</span>&lt;&lt;<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(kk)&lt;&lt;finl;
<a name="l00638"></a>00638                           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00639"></a>00639                         }
<a name="l00640"></a>00640                       <span class="keywordflow">break</span>;
<a name="l00641"></a>00641                     }
<a name="l00642"></a>00642                 }
<a name="l00643"></a>00643             }
<a name="l00644"></a>00644         }
<a name="l00645"></a>00645     }
<a name="l00646"></a>00646 
<a name="l00647"></a>00647   <span class="keywordtype">int</span> nnz=0;
<a name="l00648"></a>00648   <span class="keywordtype">int</span> kdeb = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(0)-1;
<a name="l00649"></a>00649   <span class="keywordtype">int</span> coefficient_suppressed=0; <span class="comment">//!&lt; Nombre de coefficients supprimes</span>
<a name="l00650"></a>00650 <span class="comment"></span>  <span class="keywordflow">if</span> (doublons || coeff_nuls || coeff_quasi_nuls)
<a name="l00651"></a>00651     {
<a name="l00652"></a>00652 <span class="comment">// Suppress coefficients</span>
<a name="l00653"></a>00653       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00654"></a>00654         {
<a name="l00655"></a>00655           <span class="keywordtype">int</span> kfin = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1;
<a name="l00656"></a>00656           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=kdeb; k&lt;kfin; k++)
<a name="l00657"></a>00657             {
<a name="l00658"></a>00658               <span class="keywordflow">if</span> (!elim_coeff(k))
<a name="l00659"></a>00659                 {
<a name="l00660"></a>00660                   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(nnz) = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k);
<a name="l00661"></a>00661                   <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(nnz) = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k);
<a name="l00662"></a>00662                   nnz++;
<a name="l00663"></a>00663                 }
<a name="l00664"></a>00664               <span class="keywordflow">else</span>
<a name="l00665"></a>00665                 coefficient_suppressed++;
<a name="l00666"></a>00666             }
<a name="l00667"></a>00667 <span class="comment">// Modification de tab1_ en fonction du nombre de coefficients deja enleves</span>
<a name="l00668"></a>00668           <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-=coefficient_suppressed;
<a name="l00669"></a>00669           kdeb = kfin;
<a name="l00670"></a>00670         }
<a name="l00671"></a>00671     }
<a name="l00672"></a>00672   <span class="keywordflow">else</span>
<a name="l00673"></a>00673     {
<a name="l00674"></a>00674       nnz = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[n] - 1;
<a name="l00675"></a>00675     }
<a name="l00676"></a>00676 
<a name="l00677"></a>00677 
<a name="l00678"></a>00678 <span class="comment">// On redimensionne les tableaux</span>
<a name="l00679"></a>00679   <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);
<a name="l00680"></a>00680   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nnz);
<a name="l00681"></a>00681 
<a name="l00682"></a>00682   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00683"></a>00683   <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
<a name="l00684"></a>00684 }
<a name="l00685"></a>00685 
<a name="l00686"></a>00686 <span class="comment">// Precondition:</span>
<a name="l00687"></a>00687 <span class="comment">// Parametre: Matrice_Morse&amp; a</span>
<a name="l00688"></a>00688 <span class="comment">// Signification: la partie droite de l&#39;affectation</span>
<a name="l00689"></a>00689 <span class="comment">// Valeurs par defaut:</span>
<a name="l00690"></a>00690 <span class="comment">// Contraintes: reference constante</span>
<a name="l00691"></a>00691 <span class="comment">// Acces: entree</span>
<a name="l00692"></a>00692 <span class="comment">// </span>
<a name="l00693"></a>00693 <span class="comment">// Signification:</span>
<a name="l00694"></a>00694 <span class="comment">// Contraintes:</span>
<a name="l00695"></a>00695 <span class="comment">// Exception:</span>
<a name="l00696"></a>00696 <span class="comment">// Effets de bord:</span>
<a name="l00697"></a>00697 <span class="comment">// Postcondition:</span>
<a name="l00698"></a>00698 <span class="comment">//</span>
<a name="l00699"></a>00699 <span class="comment">//</span><span class="comment"></span>
<a name="l00700"></a>00700 <span class="comment">//! Operateur d&#39;affectation d&#39;une Matrice_Morse dans une&lt;br&gt;autre Matrice_Morse.</span>
<a name="l00701"></a><a class="code" href="classMatrice__Morse.html#a5ed8c0c5ce20ddb2dff99c2eec47006f">00701</a> <span class="comment"></span><a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; <a class="code" href="classMatrice__Morse.html#a5ed8c0c5ce20ddb2dff99c2eec47006f" title="Operateur d&#39;affectation d&#39;une Matrice_Morse dans une autre Matrice_Morse.">Matrice_Morse::operator=</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; a )
<a name="l00702"></a>00702 {
<a name="l00703"></a>00703   <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a273976ecf3d2d4fdbdc48ab446027e8e" title="met l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut. (voir ArrOfInt::reset())">reset</a>(), <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a94564e16be1ede0879c6aea2dfc810af" title="copie de la structure et des valeurs (si opt==COPY_INIT) du tableau v. Attention, v doit vraiment etr...">copy</a>(a.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>());
<a name="l00704"></a>00704   <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a273976ecf3d2d4fdbdc48ab446027e8e" title="met l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut. (voir ArrOfInt::reset())">reset</a>(), <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a94564e16be1ede0879c6aea2dfc810af" title="copie de la structure et des valeurs (si opt==COPY_INIT) du tableau v. Attention, v doit vraiment etr...">copy</a>(a.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>());
<a name="l00705"></a>00705   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#a990500e5bf63a8ca55fd833d111e135c" title="met l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut. (voir ArrOfDouble::reset())">reset</a>(), <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#aaccfc72d49151e3105aba476fa9f414b" title="copie de la structure et des valeurs (si opt==COPY_INIT) du tableau v. Attention, v doit vraiment etr...">copy</a>(a.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>());
<a name="l00706"></a>00706   <a class="code" href="classMatrice__Morse.html#a44dbdb39389f6f17711f5072ce9cf2e0" title="Number of columns.">m_</a>=a.<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();
<a name="l00707"></a>00707   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00708"></a>00708   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=a.<a class="code" href="classMatrice__Base.html#aa1828bab9e4980e6980b7e71ae280c1c">is_stencil_up_to_date</a>();
<a name="l00709"></a>00709   <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
<a name="l00710"></a>00710 }
<a name="l00711"></a>00711 
<a name="l00712"></a>00712 <span class="comment">// Precondition:</span>
<a name="l00713"></a>00713 <span class="comment">// Parametre: Matrice_Morse&amp; a</span>
<a name="l00714"></a>00714 <span class="comment">// Signification: la matrice a transposee</span>
<a name="l00715"></a>00715 <span class="comment">// Valeurs par defaut:</span>
<a name="l00716"></a>00716 <span class="comment">// Contraintes: reference constante</span>
<a name="l00717"></a>00717 <span class="comment">// Acces: entree</span>
<a name="l00718"></a>00718 <span class="comment">// </span>
<a name="l00719"></a>00719 <span class="comment">// Signification:</span>
<a name="l00720"></a>00720 <span class="comment">// Contraintes:</span>
<a name="l00721"></a>00721 <span class="comment">// Exception:</span>
<a name="l00722"></a>00722 <span class="comment">// Effets de bord:</span>
<a name="l00723"></a>00723 <span class="comment">// Postcondition:</span>
<a name="l00724"></a>00724 <span class="comment">//</span><span class="comment"></span>
<a name="l00725"></a>00725 <span class="comment">//! *this = a transposee.</span>
<a name="l00726"></a><a class="code" href="classMatrice__Morse.html#a9859a88c59daf0b968b3c5090e18f264">00726</a> <span class="comment"></span><a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; <a class="code" href="classMatrice__Morse.html#a9859a88c59daf0b968b3c5090e18f264" title="*this = a transposee.">Matrice_Morse::transpose</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; a)
<a name="l00727"></a>00727 {
<a name="l00728"></a>00728 
<a name="l00729"></a>00729   <span class="keywordtype">int</span> n=a.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00730"></a>00730   <span class="keywordtype">int</span> jk=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00731"></a>00731   <span class="keywordtype">int</span> job=1;
<a name="l00732"></a>00732   <span class="keywordtype">int</span> ipos=1;
<a name="l00733"></a>00733   <span class="keywordtype">int</span> m=a.<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();
<a name="l00734"></a>00734   <span class="keywordtype">int</span> l=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00735"></a>00735   <span class="keywordflow">if</span>(m!=jk)
<a name="l00736"></a>00736     {
<a name="l00737"></a>00737       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::transpose bad dimensions&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00738"></a>00738       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00739"></a>00739     }
<a name="l00740"></a>00740   m=a.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00741"></a>00741   l=<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();
<a name="l00742"></a>00742   <span class="keywordflow">if</span>(m!=l)
<a name="l00743"></a>00743     {
<a name="l00744"></a>00744       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::transpose bad dimensions&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00745"></a>00745       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00746"></a>00746     }
<a name="l00747"></a>00747 
<a name="l00748"></a>00748   {
<a name="l00749"></a>00749     <span class="keywordtype">int</span> i, j, k , <a class="code" href="Zone__VEF__PreP1b_8cpp.html#a24a462bbedad66c2a21f5f6f84b8ec5b">next</a>;
<a name="l00750"></a>00750 
<a name="l00751"></a>00751 <span class="comment">// F77NAME(CSRCSC)(&amp;n,&amp;o,&amp;k,&amp;k,a.coeff_,a.tab2_,a.tab1_,coeff_.addr(),tab2_.addr(),tab1_.addr());</span>
<a name="l00752"></a>00752 <span class="comment">// subroutine csrcsc (n,jk,job,ipos,a,ja,ia,ao,jao,iao)</span>
<a name="l00753"></a>00753 <span class="comment">// integer ia(n+1),iao(n+1),ja(*),jao(*)</span>
<a name="l00754"></a>00754 <span class="comment">// real*8  a(*),ao(*)</span>
<a name="l00755"></a>00755 <span class="comment">// c-----------------------------------------------------------------------</span>
<a name="l00756"></a>00756 <span class="comment">// c Compressed Sparse Row     to      Compressed Sparse Column</span>
<a name="l00757"></a>00757 <span class="comment">// c</span>
<a name="l00758"></a>00758 <span class="comment">// c on entry:</span>
<a name="l00759"></a>00759 <span class="comment">// c----------</span>
<a name="l00760"></a>00760 <span class="comment">// c n        = dimension of A.</span>
<a name="l00761"></a>00761 <span class="comment">// c jk     = dimensoin of Ao</span>
<a name="l00762"></a>00762 <span class="comment">// c job        = integer to indicate whether to fill the values (job.eq.1) of the</span>
<a name="l00763"></a>00763 <span class="comment">// c         matrix ao or only the pattern., i.e.,ia, and ja (job .ne.1)</span>
<a name="l00764"></a>00764 <span class="comment">// c</span>
<a name="l00765"></a>00765 <span class="comment">// c ipos  = starting position in ao, jao of the transposed matrix.</span>
<a name="l00766"></a>00766 <span class="comment">// c         the iao array takes this into account (thus iao(1) is set to ipos.)</span>
<a name="l00767"></a>00767 <span class="comment">// c         Note: this may be useful if one needs to append the data structure</span>
<a name="l00768"></a>00768 <span class="comment">// c         of the transpose to that of A. In this case use for example</span>
<a name="l00769"></a>00769 <span class="comment">// c                call csrcsc (n,1,n+2,a,ja,ia,a,ja,ia(n+2))</span>
<a name="l00770"></a>00770 <span class="comment">// c          for any other normal usage, enter ipos=1.</span>
<a name="l00771"></a>00771 <span class="comment">// c a        = real array of length nnz (nnz=number of nonzero elements in input</span>
<a name="l00772"></a>00772 <span class="comment">// c         matrix) containing the nonzero elements.</span>
<a name="l00773"></a>00773 <span class="comment">// c ja        = integer array of length nnz containing the column positions</span>
<a name="l00774"></a>00774 <span class="comment">// c           of the corresponding elements in a.</span>
<a name="l00775"></a>00775 <span class="comment">// c ia        = integer of size n+1. ia(k) contains the position in a, ja of</span>
<a name="l00776"></a>00776 <span class="comment">// c          the beginning of the k-th row.</span>
<a name="l00777"></a>00777 <span class="comment">// c</span>
<a name="l00778"></a>00778 <span class="comment">// c on return:</span>
<a name="l00779"></a>00779 <span class="comment">// c ----------</span>
<a name="l00780"></a>00780 <span class="comment">// c output arguments:</span>
<a name="l00781"></a>00781 <span class="comment">// c ao        = real array of size nzz containing the &quot;a&quot; part of the transpose</span>
<a name="l00782"></a>00782 <span class="comment">// c jao        = integer array of size nnz containing the column indices.</span>
<a name="l00783"></a>00783 <span class="comment">// c iao        = integer array of size n+1 containing the &quot;ia&quot; index array of</span>
<a name="l00784"></a>00784 <span class="comment">// c          the transpose.</span>
<a name="l00785"></a>00785 <span class="comment">// c</span>
<a name="l00786"></a>00786 <span class="comment">// c-----------------------------------------------------------------------</span>
<a name="l00787"></a>00787 <span class="comment">// c----------------- compute lengths of rows of transp(A) ----------------</span>
<a name="l00788"></a>00788 <span class="comment">// do 1 i=1,jk+1</span>
<a name="l00789"></a>00789 <span class="comment">// iao(i) = 0</span>
<a name="l00790"></a>00790 <span class="comment">// 1    continue</span>
<a name="l00791"></a>00791 
<a name="l00792"></a>00792     <span class="keywordflow">for</span> (i=0; i&lt;=jk; i++ ) <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] = 0 ;
<a name="l00793"></a>00793 
<a name="l00794"></a>00794 <span class="comment">// do 3 i=1, n</span>
<a name="l00795"></a>00795 <span class="comment">// do 2 k=ia(i), ia(i+1)-1</span>
<a name="l00796"></a>00796 <span class="comment">// j = ja(k)+1</span>
<a name="l00797"></a>00797 <span class="comment">// iao(j) = iao(j)+1</span>
<a name="l00798"></a>00798 <span class="comment">// 2       continue</span>
<a name="l00799"></a>00799 <span class="comment">// 3    continue</span>
<a name="l00800"></a>00800 
<a name="l00801"></a>00801     <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
<a name="l00802"></a>00802       {
<a name="l00803"></a>00803         <span class="keywordflow">for</span>(k=a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1; k&lt;a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1]-1; k++)
<a name="l00804"></a>00804           {
<a name="l00805"></a>00805             j = a.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] ;
<a name="l00806"></a>00806             <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j] = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j] +1 ;
<a name="l00807"></a>00807           }
<a name="l00808"></a>00808       }
<a name="l00809"></a>00809 
<a name="l00810"></a>00810 <span class="comment">// c---------- compute pointers from lengths ------------------------------</span>
<a name="l00811"></a>00811 <span class="comment">// iao(1) = ipos</span>
<a name="l00812"></a>00812 <span class="comment">// do 4 i=1,jk</span>
<a name="l00813"></a>00813 <span class="comment">// iao(i+1) = iao(i) + iao(i+1)</span>
<a name="l00814"></a>00814 <span class="comment">// 4    continue</span>
<a name="l00815"></a>00815 
<a name="l00816"></a>00816     <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[0] = ipos ;
<a name="l00817"></a>00817     <span class="keywordflow">for</span>(i=0; i&lt;jk; i++) <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1] = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] + <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1] ;
<a name="l00818"></a>00818 
<a name="l00819"></a>00819 <span class="comment">// c--------------- now do the actual copying -----------------------------</span>
<a name="l00820"></a>00820 <span class="comment">// do 6 i=1,n</span>
<a name="l00821"></a>00821 <span class="comment">// do 62 k=ia(i),ia(i+1)-1</span>
<a name="l00822"></a>00822 <span class="comment">// j = ja(k)</span>
<a name="l00823"></a>00823 <span class="comment">// next = iao(j)</span>
<a name="l00824"></a>00824 <span class="comment">// if (job .eq. 1)  ao(next) = a(k)</span>
<a name="l00825"></a>00825 <span class="comment">// jao(next) = i</span>
<a name="l00826"></a>00826 <span class="comment">// iao(j) = next+1</span>
<a name="l00827"></a>00827 <span class="comment">// 62      continue</span>
<a name="l00828"></a>00828 <span class="comment">// 6    continue</span>
<a name="l00829"></a>00829 
<a name="l00830"></a>00830     <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
<a name="l00831"></a>00831       {
<a name="l00832"></a>00832         <span class="keywordflow">for</span>(k=a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1; k&lt;a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1]-1; k++)
<a name="l00833"></a>00833           {
<a name="l00834"></a>00834             j    = a.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k]-1 ;
<a name="l00835"></a>00835             next = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j] ;
<a name="l00836"></a>00836             <span class="keywordflow">if</span> (job == 1)  <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[next-1] = a.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[k] ;
<a name="l00837"></a>00837             <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[next-1] = i+1 ;
<a name="l00838"></a>00838             <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[j]    = next+1 ;
<a name="l00839"></a>00839           }
<a name="l00840"></a>00840       }
<a name="l00841"></a>00841 
<a name="l00842"></a>00842 <span class="comment">// c-------------------------- reshift iao and leave ----------------------</span>
<a name="l00843"></a>00843 <span class="comment">// do 7 i=jk,1,-1</span>
<a name="l00844"></a>00844 <span class="comment">// iao(i+1) = iao(i)</span>
<a name="l00845"></a>00845 <span class="comment">// 7    continue</span>
<a name="l00846"></a>00846 <span class="comment">// iao(1) = ipos</span>
<a name="l00847"></a>00847 
<a name="l00848"></a>00848     <span class="keywordflow">for</span>(i=jk-1; i&gt;=0; i--)  <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1] = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] ;
<a name="l00849"></a>00849     <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[0] = ipos ;
<a name="l00850"></a>00850 
<a name="l00851"></a>00851 <span class="comment">// c--------------- end of csrcsc -----------------------------------------</span>
<a name="l00852"></a>00852 <span class="comment">// c-----------------------------------------------------------------------</span>
<a name="l00853"></a>00853 <span class="comment">// end</span>
<a name="l00854"></a>00854 <span class="comment">// c-----------------------------------------------------------------------</span>
<a name="l00855"></a>00855   }
<a name="l00856"></a>00856   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00857"></a>00857   <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
<a name="l00858"></a>00858 }
<a name="l00859"></a>00859 
<a name="l00860"></a>00860 
<a name="l00861"></a>00861 <span class="comment">// A=x*A avec x une matrice diagonale stockee dans un vecteur</span>
<a name="l00862"></a>00862 <span class="comment">// la meme methode peut etre utilisee pour stocke le resultat dans</span>
<a name="l00863"></a>00863 <span class="comment">// un autre matrice que la matrice initiale</span>
<a name="l00864"></a><a class="code" href="classMatrice__Morse.html#a657f2db151b16ebb64ee5b78a6faed86">00864</a> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; <a class="code" href="classMatrice__Morse.html#a657f2db151b16ebb64ee5b78a6faed86">Matrice_Morse::diagmulmat</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; x)
<a name="l00865"></a>00865 {
<a name="l00866"></a>00866   <span class="keywordtype">int</span> m=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00867"></a>00867   <span class="keywordtype">int</span> l=0;
<a name="l00868"></a>00868   <span class="keywordtype">int</span> n=x.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00869"></a>00869   <span class="keywordflow">if</span>(n!=m)
<a name="l00870"></a>00870     {
<a name="l00871"></a>00871       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::diagmulmat bad dimensions&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00872"></a>00872       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00873"></a>00873     }
<a name="l00874"></a>00874 <span class="preprocessor">#ifndef CRAY</span>
<a name="l00875"></a>00875 <span class="preprocessor"></span>  <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(DIAMUA)(&amp;m ,&amp;l,
<a name="l00876"></a>00876                   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),x.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
<a name="l00877"></a>00877                   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>());
<a name="l00878"></a>00878 <span class="preprocessor">#else</span>
<a name="l00879"></a>00879 <span class="preprocessor"></span>  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::diagmulmat DIAMUA call invalid for CRAY&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00880"></a>00880   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00881"></a>00881 <span class="preprocessor">#endif</span>
<a name="l00882"></a>00882 <span class="preprocessor"></span>  <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
<a name="l00883"></a>00883 }
<a name="l00884"></a>00884 
<a name="l00885"></a>00885 <span class="comment">// extraction de la partie superieure d&#39;une matrice morse</span>
<a name="l00886"></a>00886 <span class="comment">// la matrice resultat est celle appelante</span>
<a name="l00887"></a><a class="code" href="classMatrice__Morse.html#af1142c6d58bd4b5d01cfbb9bdc600fe9">00887</a> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; <a class="code" href="classMatrice__Morse.html#af1142c6d58bd4b5d01cfbb9bdc600fe9">Matrice_Morse::partie_sup</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; a)
<a name="l00888"></a>00888 {
<a name="l00889"></a>00889   <span class="keywordtype">int</span> m=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00890"></a>00890   <span class="keywordtype">int</span> n=a.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00891"></a>00891   <span class="keywordflow">if</span>(m!=n)
<a name="l00892"></a>00892     {
<a name="l00893"></a>00893       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::partie_sup : bad dimensions m!=n.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00894"></a>00894       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00895"></a>00895     }
<a name="l00896"></a>00896   <span class="keywordtype">double</span> t ;
<a name="l00897"></a>00897   <span class="keywordtype">int</span> ko, k, i, kdiag, kfirst ;
<a name="l00898"></a>00898   ko = -1 ;
<a name="l00899"></a>00899   <span class="keywordflow">for</span>( i=0; i&lt; n; i++)
<a name="l00900"></a>00900     {
<a name="l00901"></a>00901       kfirst = ko + 1 ;
<a name="l00902"></a>00902       kdiag = -1 ;
<a name="l00903"></a>00903       <span class="keywordflow">for</span>( k = a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i]-1; k&lt; a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i+1]-1; k++)
<a name="l00904"></a>00904         {
<a name="l00905"></a>00905           <span class="keywordflow">if</span> (a.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k]-1 &gt;= i)
<a name="l00906"></a>00906             {
<a name="l00907"></a>00907               ko++ ;
<a name="l00908"></a>00908               <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[ko] = a.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[k] ;
<a name="l00909"></a>00909               <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[ko] = a.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] ;
<a name="l00910"></a>00910               <span class="keywordflow">if</span> (a.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k] == i) kdiag = ko ;
<a name="l00911"></a>00911             }
<a name="l00912"></a>00912         }
<a name="l00913"></a>00913       <span class="keywordflow">if</span> (kdiag != -1 &amp;&amp; kdiag != kfirst)
<a name="l00914"></a>00914         {
<a name="l00915"></a>00915           t = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kdiag] ;
<a name="l00916"></a>00916           <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kdiag] = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kfirst] ;
<a name="l00917"></a>00917           <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kfirst] = t ;
<a name="l00918"></a>00918           k = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kdiag] ;
<a name="l00919"></a>00919           <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kdiag] = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kfirst] ;
<a name="l00920"></a>00920           <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kfirst] = k ;
<a name="l00921"></a>00921         }
<a name="l00922"></a>00922       <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] = kfirst+1 ;
<a name="l00923"></a>00923     }
<a name="l00924"></a>00924   <span class="keywordtype">int</span> nnz = (ko + 1) ;
<a name="l00925"></a>00925 
<a name="l00926"></a>00926   <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[n] = (nnz) + 1 ;
<a name="l00927"></a>00927   <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( nnz );
<a name="l00928"></a>00928   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( nnz );
<a name="l00929"></a>00929   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l00930"></a>00930   <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
<a name="l00931"></a>00931 }
<a name="l00932"></a>00932 
<a name="l00933"></a>00933 <span class="comment">//</span>
<a name="l00934"></a>00934 <span class="comment">//</span><span class="comment"></span>
<a name="l00935"></a>00935 <span class="comment">//! Operation de multiplication-accumulation (saxpy) matrice vecteur.&lt;br&gt;Operation: resu = resu + A*x</span>
<a name="l00936"></a><a class="code" href="classMatrice__Morse.html#a46680c7fbcd8478a9fdc774914de2a53">00936</a> <span class="comment"></span><a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classMatrice__Morse.html#a46680c7fbcd8478a9fdc774914de2a53" title="Operation de multiplication-accumulation (saxpy) matrice vecteur. Operation: resu = resu + A*x...">Matrice_Morse::ajouter_multvect_</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; x,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00937"></a>00937 <span class="keyword"></span>{
<a name="l00938"></a>00938   <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
<a name="l00939"></a>00939   <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() - 1;
<a name="l00940"></a>00940 
<a name="l00941"></a>00941   assert(x.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() == <a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>());
<a name="l00942"></a>00942 <span class="comment">// Test dans cet ordre car l&#39;attribut size() peut etre invalide:</span>
<a name="l00943"></a>00943   assert(resu.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() == n || resu.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() == n);
<a name="l00944"></a>00944 
<a name="l00945"></a>00945   <span class="keyword">const</span> <span class="keywordtype">int</span> *tab1_ptr = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() + 1;
<a name="l00946"></a>00946   <span class="keyword">const</span> <span class="keywordtype">int</span> *tab2_ptr = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00947"></a>00947   <span class="keyword">const</span> <span class="keywordtype">double</span> *coeff_ptr = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00948"></a>00948   <span class="keyword">const</span> <span class="keywordtype">double</span> * x_fortran = x.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() - 1; <span class="comment">//!&lt; Pour indexer x avec un indice fortran</span>
<a name="l00949"></a>00949 <span class="comment"></span>  <span class="keywordtype">int</span> k_fortran = 1; <span class="comment">//!&lt; indice fortran dans tab2 et coeff</span>
<a name="l00950"></a>00950 <span class="comment"></span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++, tab1_ptr++)
<a name="l00951"></a>00951     {
<a name="l00952"></a>00952       <span class="keyword">const</span> <span class="keywordtype">int</span> kmax = *tab1_ptr; <span class="comment">//!&lt; tab1_[i+1] = indice fortran dans tab2_</span>
<a name="l00953"></a>00953 <span class="comment"></span>      assert(kmax &gt;= k_fortran &amp;&amp; kmax &lt;= (<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()+1));
<a name="l00954"></a>00954       <span class="keywordtype">double</span> t = resu[i];
<a name="l00955"></a>00955       assert(k_fortran == <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[i] &amp;&amp; tab2_ptr == <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>()+(k_fortran-1));
<a name="l00956"></a>00956       <span class="keywordflow">for</span> (; k_fortran &lt; kmax; k_fortran++, tab2_ptr++, coeff_ptr++)
<a name="l00957"></a>00957         {
<a name="l00958"></a>00958           <span class="keywordtype">int</span> colonne = *tab2_ptr; <span class="comment">//!&lt; indice fortran</span>
<a name="l00959"></a>00959 <span class="comment"></span>          assert(colonne &gt;= 1 &amp;&amp; colonne &lt;= <a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>());
<a name="l00960"></a>00960           t += (*coeff_ptr) * x_fortran[colonne];
<a name="l00961"></a>00961         }
<a name="l00962"></a>00962       resu[i] = t;
<a name="l00963"></a>00963     }
<a name="l00964"></a>00964   <span class="keywordflow">return</span> resu;
<a name="l00965"></a>00965 }
<a name="l00966"></a>00966 
<a name="l00967"></a>00967 <span class="comment">// Multiplication de la matrice par un vecteur x en prenant uniquement les items reels non communs pour x</span>
<a name="l00968"></a><a class="code" href="classMatrice__Morse.html#ae134fbd51a66dca2ccede1dbc3e45dc0">00968</a> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; <a class="code" href="classMatrice__Morse.html#a46680c7fbcd8478a9fdc774914de2a53" title="Operation de multiplication-accumulation (saxpy) matrice vecteur. Operation: resu = resu + A*x...">Matrice_Morse::ajouter_multvect_</a>(<span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; x,<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; resu,<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; est_reel_pas_com)<span class="keyword"> const</span>
<a name="l00969"></a>00969 <span class="keyword"></span>{
<a name="l00970"></a>00970   <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
<a name="l00971"></a>00971   <span class="keywordtype">int</span> n = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l00972"></a>00972 
<a name="l00973"></a>00973   assert(<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>()==x.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>());
<a name="l00974"></a>00974   assert(n==resu.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>());
<a name="l00975"></a>00975   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l00976"></a>00976     {
<a name="l00977"></a>00977       <span class="keywordtype">double</span> t = 0.0;
<a name="l00978"></a>00978       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
<a name="l00979"></a>00979         {
<a name="l00980"></a>00980           <span class="keywordtype">int</span> j=<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1;
<a name="l00981"></a>00981           <span class="keywordflow">if</span> (est_reel_pas_com(j)) t += <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)*x(j);
<a name="l00982"></a>00982         }
<a name="l00983"></a>00983       resu(i) += t ;
<a name="l00984"></a>00984     }
<a name="l00985"></a>00985   <span class="keywordflow">return</span> resu;
<a name="l00986"></a>00986 }
<a name="l00987"></a>00987 
<a name="l00988"></a>00988 <span class="comment">// Precondition:</span>
<a name="l00989"></a>00989 <span class="comment">// Parametre: DoubleTab&amp; x</span>
<a name="l00990"></a>00990 <span class="comment">// Signification: la matrice a multiplier</span>
<a name="l00991"></a>00991 <span class="comment">// Valeurs par defaut:</span>
<a name="l00992"></a>00992 <span class="comment">// Contraintes: reference constante</span>
<a name="l00993"></a>00993 <span class="comment">// Acces: entree</span>
<a name="l00994"></a>00994 <span class="comment">// Parametre: DoubleTab&amp; resu</span>
<a name="l00995"></a>00995 <span class="comment">// Signification: la matrice resultat de l&#39;operation</span>
<a name="l00996"></a>00996 <span class="comment">// Valeurs par defaut:</span>
<a name="l00997"></a>00997 <span class="comment">// Contraintes:</span>
<a name="l00998"></a>00998 <span class="comment">// Acces: entree/sortie</span>
<a name="l00999"></a>00999 <span class="comment">// Exception:</span>
<a name="l01000"></a>01000 <span class="comment">// Effets de bord:</span>
<a name="l01001"></a>01001 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l01002"></a>01002 <span class="comment">//</span>
<a name="l01003"></a>01003 <span class="comment">//</span>
<a name="l01004"></a>01004 <span class="comment">//</span><span class="comment"></span>
<a name="l01005"></a>01005 <span class="comment">//! Operation de multiplication-accumulation (saxpy) matrice matrice&lt;br&gt;(matrice X representee par un tableau)&lt;br&gt;Operation: RESU = RESU + A*X</span>
<a name="l01006"></a>01006 <span class="comment"></span><span class="comment">/** \return DoubleTab\&amp;&lt;br&gt;</span>
<a name="l01007"></a>01007 <span class="comment">Signification: la matrice resultat de l&#39;operation&lt;br&gt;</span>
<a name="l01008"></a>01008 <span class="comment">Contraintes: */</span>
<a name="l01009"></a><a class="code" href="classMatrice__Morse.html#a7bbc0c7773ecb51c01d76adc02356dc0">01009</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classMatrice__Morse.html#a7bbc0c7773ecb51c01d76adc02356dc0" title="Operation de multiplication-accumulation (saxpy) matrice matrice&lt;br&gt;(matrice X representee par un tab...">Matrice_Morse::ajouter_multTab_</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; x,<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01010"></a>01010 <span class="keyword"></span>{
<a name="l01011"></a>01011 
<a name="l01012"></a>01012   <span class="keywordflow">if</span> ( (x.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 1) &amp;&amp; (resu.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 1))
<a name="l01013"></a>01013     {
<a name="l01014"></a>01014       <a class="code" href="classMatrice__Base.html#a6ccb4d20d3877cf09f5178ff72af5406" title="Operation de multiplication-accumulation (saxpy) matrice vecteur. Operation: r = r + A*x...">ajouter_multvect</a>(x,resu);
<a name="l01015"></a>01015       <span class="keywordflow">return</span> resu;
<a name="l01016"></a>01016     }
<a name="l01017"></a>01017 
<a name="l01018"></a>01018   <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
<a name="l01019"></a>01019   <span class="keywordtype">int</span> i, k;
<a name="l01020"></a>01020   <span class="keywordtype">int</span> nb_comp = x.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l01021"></a>01021 
<a name="l01022"></a>01022   assert(resu.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) == nb_comp);
<a name="l01023"></a>01023   <span class="keywordtype">double</span>* t= <span class="keyword">new</span> <span class="keywordtype">double</span>[nb_comp];
<a name="l01024"></a>01024   <span class="keywordtype">int</span> ncomp;
<a name="l01025"></a>01025   <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l01026"></a>01026   <span class="keywordflow">for</span>(i=0; i&lt;n; i++)
<a name="l01027"></a>01027     {
<a name="l01028"></a>01028       <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l01029"></a>01029         t[ncomp] = 0.0;
<a name="l01030"></a>01030       <span class="keywordflow">for</span> (k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
<a name="l01031"></a>01031         <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l01032"></a>01032           t[ncomp] += <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k)*x(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1,ncomp);
<a name="l01033"></a>01033       <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l01034"></a>01034         resu(i,ncomp) += t[ncomp] ;
<a name="l01035"></a>01035     }
<a name="l01036"></a>01036   <span class="keyword">delete</span> [] t;
<a name="l01037"></a>01037   <span class="keywordflow">return</span> resu;
<a name="l01038"></a>01038 }
<a name="l01039"></a>01039 
<a name="l01040"></a>01040 
<a name="l01041"></a>01041 <span class="comment">// Precondition:</span>
<a name="l01042"></a>01042 <span class="comment">// Parametre: DoubleVect&amp; x</span>
<a name="l01043"></a>01043 <span class="comment">// Signification: le vecteur a multiplier</span>
<a name="l01044"></a>01044 <span class="comment">// Valeurs par defaut:</span>
<a name="l01045"></a>01045 <span class="comment">// Contraintes: reference constante</span>
<a name="l01046"></a>01046 <span class="comment">// Acces: entree</span>
<a name="l01047"></a>01047 <span class="comment">// Parametre: DoubleVect&amp; resu</span>
<a name="l01048"></a>01048 <span class="comment">// Signification: le vecteur resultat de l&#39;operation</span>
<a name="l01049"></a>01049 <span class="comment">// Valeurs par defaut:</span>
<a name="l01050"></a>01050 <span class="comment">// Contraintes:</span>
<a name="l01051"></a>01051 <span class="comment">// Acces: entree/sortie</span>
<a name="l01052"></a>01052 <span class="comment">// Exception:</span>
<a name="l01053"></a>01053 <span class="comment">// Effets de bord:</span>
<a name="l01054"></a>01054 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l01055"></a>01055 <span class="comment">//</span>
<a name="l01056"></a>01056 <span class="comment">//</span>
<a name="l01057"></a>01057 <span class="comment">//</span><span class="comment"></span>
<a name="l01058"></a>01058 <span class="comment">//! Operation de multiplication-accumulation (saxpy) matrice vecteur,&lt;br&gt;par la matrice transposee.&lt;br&gt;Operation: resu = resu + A^{T}*x</span>
<a name="l01059"></a>01059 <span class="comment"></span><span class="comment">/** \return DoubleVect\&amp;&lt;br&gt;</span>
<a name="l01060"></a>01060 <span class="comment">Signification: le vecteur resultat de l&#39;operation&lt;br&gt;</span>
<a name="l01061"></a>01061 <span class="comment">Contraintes: */</span>
<a name="l01062"></a><a class="code" href="classMatrice__Morse.html#a2c69581723fcbf4eef3254119b20cc44">01062</a> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classMatrice__Morse.html#a2c69581723fcbf4eef3254119b20cc44" title="Operation de multiplication-accumulation (saxpy) matrice vecteur, par la matrice transposee. Operation: resu = resu + A^{T}*x.">Matrice_Morse::ajouter_multvectT_</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; x,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resu)<span class="keyword"> const</span>
<a name="l01063"></a>01063 <span class="keyword"></span>{
<a name="l01064"></a>01064   <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
<a name="l01065"></a>01065 
<a name="l01066"></a>01066   <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l01067"></a>01067   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l01068"></a>01068     {
<a name="l01069"></a>01069       <span class="keywordtype">double</span> xi = x(i);
<a name="l01070"></a>01070       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
<a name="l01071"></a>01071         resu(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1) += <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) * xi;
<a name="l01072"></a>01072     }
<a name="l01073"></a>01073   <span class="keywordflow">return</span> resu;
<a name="l01074"></a>01074 }
<a name="l01075"></a>01075 
<a name="l01076"></a>01076 <span class="comment">// Multiplication de la tranposee de la matrice par un vecteur x en prenant uniquement les items reels non communs</span>
<a name="l01077"></a><a class="code" href="classMatrice__Morse.html#aecb0c25de76938492958d3676ed6d266">01077</a> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; <a class="code" href="classMatrice__Morse.html#a2c69581723fcbf4eef3254119b20cc44" title="Operation de multiplication-accumulation (saxpy) matrice vecteur, par la matrice transposee. Operation: resu = resu + A^{T}*x.">Matrice_Morse::ajouter_multvectT_</a>(<span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; x,<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; resu,<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; est_reel_pas_com)<span class="keyword"> const</span>
<a name="l01078"></a>01078 <span class="keyword"></span>{
<a name="l01079"></a>01079   <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
<a name="l01080"></a>01080   <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l01081"></a>01081 
<a name="l01082"></a>01082   assert(n==x.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>());
<a name="l01083"></a>01083   assert(<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>()==resu.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>());
<a name="l01084"></a>01084   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;n; i++)
<a name="l01085"></a>01085     {
<a name="l01086"></a>01086       <span class="keywordflow">if</span> (est_reel_pas_com(i))
<a name="l01087"></a>01087         {
<a name="l01088"></a>01088           <span class="keywordtype">double</span> xi = x(i);
<a name="l01089"></a>01089           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
<a name="l01090"></a>01090             resu(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)-1) += <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) * xi;
<a name="l01091"></a>01091         }
<a name="l01092"></a>01092     }
<a name="l01093"></a>01093   <span class="keywordflow">return</span> resu;
<a name="l01094"></a>01094 }
<a name="l01095"></a>01095 
<a name="l01096"></a>01096 <span class="comment">// Precondition:</span>
<a name="l01097"></a>01097 <span class="comment">// Parametre: Matrice_Morse&amp; A</span>
<a name="l01098"></a>01098 <span class="comment">// Signification: une matrice au format Morse</span>
<a name="l01099"></a>01099 <span class="comment">// Valeurs par defaut:</span>
<a name="l01100"></a>01100 <span class="comment">// Contraintes: reference constante</span>
<a name="l01101"></a>01101 <span class="comment">// Acces: entree</span>
<a name="l01102"></a>01102 <span class="comment">// Parametre: Matrice_Morse&amp; B</span>
<a name="l01103"></a>01103 <span class="comment">// Signification: une matrice au format Morse</span>
<a name="l01104"></a>01104 <span class="comment">// Valeurs par defaut:</span>
<a name="l01105"></a>01105 <span class="comment">// Contraintes: reference constante</span>
<a name="l01106"></a>01106 <span class="comment">// Acces: entree</span>
<a name="l01107"></a>01107 <span class="comment">// Exception:</span>
<a name="l01108"></a>01108 <span class="comment">// Effets de bord:</span>
<a name="l01109"></a>01109 <span class="comment">// Postcondition:</span>
<a name="l01110"></a>01110 <span class="comment">//</span>
<a name="l01111"></a>01111 <span class="comment">//</span>
<a name="l01112"></a>01112 <span class="comment">//</span><span class="comment"></span>
<a name="l01113"></a>01113 <span class="comment">//! Fonction (hors classe) amie de la classe Matrice_Morse&lt;br&gt;Addition de 2 matrices au format Morse.&lt;br&gt;Operation: renvoie (A+B)</span>
<a name="l01114"></a>01114 <span class="comment"></span><span class="comment">/** \return Matrice_Morse&lt;br&gt;</span>
<a name="l01115"></a>01115 <span class="comment">Signification: le resultat de l&#39;operation&lt;br&gt;</span>
<a name="l01116"></a>01116 <span class="comment">Contraintes: la matrice resultat est allouee par la fonction */</span>
<a name="l01117"></a><a class="code" href="Matrice__Morse__Sym_8h.html#a9b2be70ec114aadae982e55d2c748db9">01117</a> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> <a class="code" href="Matrice__Morse_8cpp.html#a17a186d3ca06dea0e9b1ad445a4ea482" title="Fonction (hors classe) amie de la classe Matrice_Morse Addition de 2 matrices au format Morse...">operator+</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; A , <span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; B )
<a name="l01118"></a>01118 {
<a name="l01119"></a>01119   <span class="keywordtype">int</span> nrow=A.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l01120"></a>01120   <span class="keywordtype">int</span> ncol=A.<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();
<a name="l01121"></a>01121   <span class="keywordtype">int</span> job=1;
<a name="l01122"></a>01122   <span class="keywordtype">int</span> ierr;
<a name="l01123"></a>01123   <a class="code" href="classIntVect.html">IntVect</a> iw(ncol);
<a name="l01124"></a>01124   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> C;
<a name="l01125"></a>01125 <span class="comment">// PL: avant de dimensionner a nzmax on verifie si A et B n&#39;ont pas la meme structure par hasard...</span>
<a name="l01126"></a>01126 <span class="comment">// Cela evite un pic memoire provoque par l&#39;addition de matrices dans Equation_base::dimensionner_matrice</span>
<a name="l01127"></a>01127 <span class="comment">// Sinon, APLB n&#39;est pas optimal, voir une autre implementation genre MKL:</span>
<a name="l01128"></a>01128 <span class="comment">// https://software.intel.com/en-us/mkl-developer-reference-c-mkl-sparse-add</span>
<a name="l01129"></a>01129   <span class="keywordtype">int</span> nzmax = A.<a class="code" href="classMatrice__Morse.html#a11eec428fe6de8eeba3113b682dd38f1">has_same_morse_matrix_structure</a>(B) ? A.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>() : A.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>()+B.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>();
<a name="l01130"></a>01130   C.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nrow, ncol, nzmax);
<a name="l01131"></a>01131   <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(APLB) (&amp;nrow, &amp;ncol, &amp;job, A.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>().<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), A.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), A.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
<a name="l01132"></a>01132                  B.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>().<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), B.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), B.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), C.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>().<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
<a name="l01133"></a>01133                  C.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), C.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
<a name="l01134"></a>01134                  &amp;nzmax,iw.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),&amp;ierr);
<a name="l01135"></a>01135 
<a name="l01136"></a>01136   <span class="keyword">const</span> <span class="keywordtype">int</span> nnz = C.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[nrow] - 1;
<a name="l01137"></a>01137   C.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>().<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( nnz );
<a name="l01138"></a>01138   C.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>().<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( nnz );
<a name="l01139"></a>01139   C.<a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l01140"></a>01140   <span class="keywordflow">return</span>(C);
<a name="l01141"></a>01141 }
<a name="l01142"></a>01142 
<a name="l01143"></a><a class="code" href="classMatrice__Morse.html#a11eec428fe6de8eeba3113b682dd38f1">01143</a> <span class="keywordtype">bool</span> <a class="code" href="classMatrice__Morse.html#a11eec428fe6de8eeba3113b682dd38f1">Matrice_Morse::has_same_morse_matrix_structure</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; A)<span class="keyword"> const</span>
<a name="l01144"></a>01144 <span class="keyword"></span>{
<a name="l01145"></a>01145   <span class="keywordtype">int</span> nrow=A.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l01146"></a>01146   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nrow; i++)
<a name="l01147"></a>01147     <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)!=A.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i))
<a name="l01148"></a>01148       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01149"></a>01149   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01150"></a>01150 }
<a name="l01151"></a>01151 
<a name="l01152"></a>01152 <span class="comment">// Precondition:</span>
<a name="l01153"></a>01153 <span class="comment">// Parametre: DoubleVect&amp; secmem</span>
<a name="l01154"></a>01154 <span class="comment">// Signification: le second membre du systeme lineaire</span>
<a name="l01155"></a>01155 <span class="comment">// Valeurs par defaut:</span>
<a name="l01156"></a>01156 <span class="comment">// Contraintes: reference constante</span>
<a name="l01157"></a>01157 <span class="comment">// Acces: entree</span>
<a name="l01158"></a>01158 <span class="comment">// Parametre: DoubleVect&amp; solution</span>
<a name="l01159"></a>01159 <span class="comment">// Signification: la solution du systeme</span>
<a name="l01160"></a>01160 <span class="comment">// Valeurs par defaut:</span>
<a name="l01161"></a>01161 <span class="comment">// Contraintes:</span>
<a name="l01162"></a>01162 <span class="comment">// Acces: sortie</span>
<a name="l01163"></a>01163 <span class="comment">// Parametre: double coeff_seuil</span>
<a name="l01164"></a>01164 <span class="comment">// Signification:</span>
<a name="l01165"></a>01165 <span class="comment">// Valeurs par defaut:</span>
<a name="l01166"></a>01166 <span class="comment">// Contraintes:</span>
<a name="l01167"></a>01167 <span class="comment">// Acces:</span>
<a name="l01168"></a>01168 <span class="comment">// Exception: Erreur dans ilut &#39;matrix may be wrong&#39; dixit SAAD</span>
<a name="l01169"></a>01169 <span class="comment">// Exception: Erreur dans ilut : debordement dans L</span>
<a name="l01170"></a>01170 <span class="comment">// Exception: Erreur dans ilut : debordement dans U</span>
<a name="l01171"></a>01171 <span class="comment">// Exception: Valeur illegale de lfil : sans doute ecrasement memoire</span>
<a name="l01172"></a>01172 <span class="comment">// Exception: Ligne vide rencontree</span>
<a name="l01173"></a>01173 <span class="comment">// Exception: Pivot nul rencontre ! au pas</span>
<a name="l01174"></a>01174 <span class="comment">// Exception: Il s&#39;est passe quelque chose de bizarre : je prefere tout arreter.</span>
<a name="l01175"></a>01175 <span class="comment">// Effets de bord:</span>
<a name="l01176"></a>01176 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l01177"></a>01177 <span class="comment">//</span>
<a name="l01178"></a>01178 <span class="comment">//</span>
<a name="l01179"></a>01179 <span class="comment">//</span><span class="comment"></span>
<a name="l01180"></a>01180 <span class="comment">//! Calcule la solution du systeme lineaire: A * solution = secmem.&lt;br&gt;La methode utilisee est GMRES preconditionnee avec ILUT.&lt;br&gt;ATTENTION: cette methode n&#39;a vraisemblablement jamais ete testee en parallele</span>
<a name="l01181"></a>01181 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l01182"></a>01182 <span class="comment">Signification: renvoie toujours 1&lt;br&gt;</span>
<a name="l01183"></a>01183 <span class="comment">Contraintes: */</span>
<a name="l01184"></a><a class="code" href="classMatrice__Morse.html#a53383f880cbb5efcfddc92c1e570fc9c">01184</a> <span class="keywordtype">int</span> <a class="code" href="classMatrice__Morse.html#a53383f880cbb5efcfddc92c1e570fc9c" title="Calcule la solution du systeme lineaire: A * solution = secmem. La methode utilisee est GMRES precond...">Matrice_Morse::inverse</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; secmem, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; solution,
<a name="l01185"></a>01185                            <span class="keywordtype">double</span> coeff_seuil)<span class="keyword"> const</span>
<a name="l01186"></a>01186 <span class="keyword"></span>{
<a name="l01187"></a>01187 <span class="comment">// B.Mat: au 20/4/2005, DoubleVect::norme() est bugge, donc la methode n&#39;a</span>
<a name="l01188"></a>01188 <span class="comment">// sans doute jamais ete validee en parallele. Je retire norme() et je mets</span>
<a name="l01189"></a>01189 <span class="comment">// ceci:</span>
<a name="l01190"></a>01190   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
<a name="l01191"></a>01191     {
<a name="l01192"></a>01192       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse(const DoubleVect&amp; secmem, DoubleVect&amp; solution, &quot;</span>
<a name="l01193"></a>01193            &lt;&lt; <span class="stringliteral">&quot;coeff_seuil double) const \n has never been tested in parallel&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01194"></a>01194       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Try &#39;Solveur Gmres { diag }&#39; or &#39;Solveur Petsc Gmres { precond diag { } }&#39;&quot;</span> &lt;&lt; finl;
<a name="l01195"></a>01195       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;instead of &#39;Solveur Gmres { }&#39; which is not parallelized yet.&quot;</span> &lt;&lt; finl;
<a name="l01196"></a>01196       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01197"></a>01197     }
<a name="l01198"></a>01198 
<a name="l01199"></a>01199   <a class="code" href="classDoubleVect.html">DoubleVect</a> toto(secmem);
<a name="l01200"></a>01200   <span class="keywordtype">int</span> prems=1;                        <span class="comment">//!&lt; On ne calcul L et U que si prems =1</span>
<a name="l01201"></a>01201 <span class="comment"></span>  <span class="keywordtype">int</span> lf = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(10,<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>()/2);        <span class="comment">//!&lt; nombre de termes ajouter dans L et U</span>
<a name="l01202"></a>01202 <span class="comment"></span>  <span class="keywordtype">int</span> nn = <a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>();                <span class="comment">//!&lt; ordre de la matrice</span>
<a name="l01203"></a>01203 <span class="comment"></span>  <span class="keywordtype">int</span> ima = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(10,<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>()/2);        <span class="comment">//!&lt; degre de l&#39;espace de Krilov</span>
<a name="l01204"></a>01204 <span class="comment"></span>  <a class="code" href="classIntVect.html">IntVect</a> ju;                        <span class="comment">//!&lt; tableau pour L et U</span>
<a name="l01205"></a>01205 <span class="comment"></span>  <a class="code" href="classDoubleVect.html">DoubleVect</a> alu;                <span class="comment">//!&lt; tableau pour L et U</span>
<a name="l01206"></a>01206 <span class="comment"></span>  <a class="code" href="classIntVect.html">IntVect</a> jlu;                        <span class="comment">//!&lt; tableau pour L et U</span>
<a name="l01207"></a>01207 <span class="comment"></span>  <a class="code" href="classDoubleVect.html">DoubleVect</a> vv;                <span class="comment">//!&lt; tableau de travail pour pgmres  DoubleVect Resini(nn);</span>
<a name="l01208"></a>01208 <span class="comment"></span><span class="comment">//</span>
<a name="l01209"></a>01209   <a class="code" href="classDoubleVect.html">DoubleVect</a> Resini(toto);
<a name="l01210"></a>01210 
<a name="l01211"></a>01211   <span class="keywordtype">int</span> ie=1;                                <span class="comment">//!&lt; niveau d&#39;erreur</span>
<a name="l01212"></a>01212 <span class="comment"></span>  <span class="keywordtype">int</span> n2 = <a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>()+(2*lf*nn);        <span class="comment">//!&lt; nombre de termes non nuls dans LU</span>
<a name="l01213"></a>01213 <span class="comment"></span>
<a name="l01214"></a>01214   <span class="keywordtype">double</span> r;
<a name="l01215"></a>01215   <span class="keywordtype">double</span> coeff_seuilr;
<a name="l01216"></a>01216 precond :
<a name="l01217"></a>01217   {
<a name="l01218"></a>01218     <span class="keywordflow">if</span> (prems)
<a name="l01219"></a>01219       {
<a name="l01220"></a>01220 <span class="comment">// Cerr &lt;&lt; &quot;  ordre de la matrice de pression = &quot; &lt;&lt; nn &lt;&lt; finl;</span>
<a name="l01221"></a>01221 <span class="comment">// Cerr &lt;&lt; &quot;  nb termes non nuls dans la matrice de pression = &quot;</span>
<a name="l01222"></a>01222 <span class="comment">// &lt;&lt; coeff_.size() &lt;&lt; finl;</span>
<a name="l01223"></a>01223         <span class="keywordtype">int</span>  iw = n2 + 2;
<a name="l01224"></a>01224         ju.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nn);
<a name="l01225"></a>01225         jlu.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(iw);
<a name="l01226"></a>01226         alu.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(iw);
<a name="l01227"></a>01227         <span class="keywordtype">double</span> to = 1.e-10;                <span class="comment">//!&lt; filtrage des coefficents de L U</span>
<a name="l01228"></a>01228 <span class="comment"></span>        <a class="code" href="classDoubleVect.html">DoubleVect</a> w(nn+1);                <span class="comment">//!&lt; tableau de travail pour ilut        DoubleVect wl(nn);                // tableau de travail pour ilut</span>
<a name="l01229"></a>01229 <span class="comment"></span><span class="comment">//</span>
<a name="l01230"></a>01230         <a class="code" href="classIntVect.html">IntVect</a> jw(2*nn);                        <span class="comment">//!&lt; tableau de travail pour ilut        IntVect jwu(nn);                        // tableau de travail pour ilut IntVect jwl(nn);                        // tableau de travail pour ilut coeff_[0]*=2.0;                        // pour rendre A non singuliere!</span>
<a name="l01231"></a>01231 <span class="comment"></span><span class="comment">//</span>
<a name="l01232"></a>01232 <span class="comment">//</span>
<a name="l01233"></a>01233 <span class="comment">//</span>
<a name="l01234"></a>01234 
<a name="l01235"></a>01235 <span class="comment">// Cerr &lt;&lt; &quot;  ****  Preconditionnement ILUT de la matrice de pression  ****&quot; &lt;&lt; finl;</span>
<a name="l01236"></a>01236 <span class="preprocessor">#ifndef CRAY</span>
<a name="l01237"></a>01237 <span class="preprocessor"></span>        <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(ILUT)(&amp;nn, <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;lf,
<a name="l01238"></a>01238                       &amp;to, alu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), jlu.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), ju.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
<a name="l01239"></a>01239                       &amp;iw, w.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
<a name="l01240"></a>01240                       jw.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;ie);
<a name="l01241"></a>01241 <span class="comment">// to=0;</span>
<a name="l01242"></a>01242 <span class="comment">// wu=0.0;</span>
<a name="l01243"></a>01243 <span class="comment">// wl=0.0;</span>
<a name="l01244"></a>01244 <span class="comment">// jr=0;</span>
<a name="l01245"></a>01245 <span class="comment">// jwu=0;</span>
<a name="l01246"></a>01246 <span class="comment">// jwl=0;</span>
<a name="l01247"></a>01247 <span class="comment">// ie=0;</span>
<a name="l01248"></a>01248 <span class="preprocessor">#else</span>
<a name="l01249"></a>01249 <span class="preprocessor"></span>        <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse ILUT call invalid for cray&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01250"></a>01250         <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01251"></a>01251 <span class="preprocessor">#endif</span>
<a name="l01252"></a>01252 <span class="preprocessor"></span>
<a name="l01253"></a>01253 <span class="comment">// coeff_[0]*=0.5;                        // pour rendre A singuliere!</span>
<a name="l01254"></a>01254 <span class="comment">// Cerr &lt;&lt; &quot;     nb termes non nuls dans LU = &quot; &lt;&lt; n2 &lt;&lt; finl;</span>
<a name="l01255"></a>01255         <span class="keywordflow">switch</span>(ie)
<a name="l01256"></a>01256           {
<a name="l01257"></a>01257           <span class="keywordflow">case</span> 0 :
<a name="l01258"></a>01258             <span class="comment">/*{</span>
<a name="l01259"></a>01259 <span class="comment">              Cerr &lt;&lt; &quot;     printing of the L and U matrixes : &quot; &lt;&lt; finl;</span>
<a name="l01260"></a>01260 <span class="comment">              Nom nom_fich = &quot;matrices_L_U.precond&quot;;</span>
<a name="l01261"></a>01261 <span class="comment">              ofstream os(nom_fich);</span>
<a name="l01262"></a>01262 <span class="comment">              os &lt;&lt; &quot;impression des matrices L et U :\n&quot;;</span>
<a name="l01263"></a>01263 <span class="comment">              int* tab2=jlu;</span>
<a name="l01264"></a>01264 <span class="comment">              double* coeff=alu;</span>
<a name="l01265"></a>01265 <span class="comment">              double x;</span>
<a name="l01266"></a>01266 <span class="comment">              os &lt;&lt; &quot;termes diagonaux :&quot; &lt;&lt; &quot;\n&quot;;</span>
<a name="l01267"></a>01267 <span class="comment">              for (int num=0; num&lt;nn; num++) {</span>
<a name="l01268"></a>01268 <span class="comment">              x=coeff[num];</span>
<a name="l01269"></a>01269 <span class="comment">              os &lt;&lt; &quot;(&quot; &lt;&lt; num+1 &lt;&lt; &quot; , &quot; &lt;&lt; num+1 &lt;&lt; &quot;)  =  &quot; &lt;&lt; x &lt;&lt; &quot;\n&quot;;</span>
<a name="l01270"></a>01270 <span class="comment">              }</span>
<a name="l01271"></a>01271 <span class="comment">              os &lt;&lt; &quot;hors diagonale : &quot; &lt;&lt; &quot;\n&quot;;</span>
<a name="l01272"></a>01272 <span class="comment">              for ( num=0; num&lt;nn; num++) {</span>
<a name="l01273"></a>01273 <span class="comment">              os &lt;&lt; &quot;ligne &quot; &lt;&lt; num+1 &lt;&lt; &quot; : &quot;;</span>
<a name="l01274"></a>01274 <span class="comment">              int nb_vois=tab2[num+1]-tab2[num];</span>
<a name="l01275"></a>01275 <span class="comment">              double x=0.;</span>
<a name="l01276"></a>01276 <span class="comment">              for(int vois=0; vois&lt;nb_vois; vois++) {</span>
<a name="l01277"></a>01277 <span class="comment">              int num_vois=tab2[tab2[num]+vois-1];</span>
<a name="l01278"></a>01278 <span class="comment">              x=coeff[tab2[num]+vois-1];</span>
<a name="l01279"></a>01279 <span class="comment">              os &lt;&lt; &quot;(&quot; &lt;&lt; num_vois &lt;&lt; &quot; , &quot; &lt;&lt; x &lt;&lt; &quot; ) &quot; ;</span>
<a name="l01280"></a>01280 <span class="comment">              }</span>
<a name="l01281"></a>01281 <span class="comment">              os &lt;&lt; &quot;\n&quot;;</span>
<a name="l01282"></a>01282 <span class="comment">              }</span>
<a name="l01283"></a>01283 <span class="comment">              os.flush();</span>
<a name="l01284"></a>01284 <span class="comment">              }</span>
<a name="l01285"></a>01285 <span class="comment">            */</span>
<a name="l01286"></a>01286             <span class="keywordflow">break</span>;
<a name="l01287"></a>01287           <span class="keywordflow">case</span> -1 :
<a name="l01288"></a>01288             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut &#39;matrix may be wrong&#39; dixit SAAD&quot;</span> &lt;&lt; finl;
<a name="l01289"></a>01289             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01290"></a>01290             <span class="keywordflow">break</span>;
<a name="l01291"></a>01291           <span class="keywordflow">case</span>  -2  :
<a name="l01292"></a>01292             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut : overflow in L &quot;</span> &lt;&lt; finl;
<a name="l01293"></a>01293             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01294"></a>01294             <span class="keywordflow">break</span>;
<a name="l01295"></a>01295           <span class="keywordflow">case</span>   -3  :
<a name="l01296"></a>01296             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut : overflow in U &quot;</span> &lt;&lt; finl;
<a name="l01297"></a>01297             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01298"></a>01298             <span class="keywordflow">break</span>;
<a name="l01299"></a>01299           <span class="keywordflow">case</span>    -4   :
<a name="l01300"></a>01300             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Illegal value for lfil : it may be a memory trouble &quot;</span> &lt;&lt; finl;
<a name="l01301"></a>01301             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01302"></a>01302             <span class="keywordflow">break</span>;
<a name="l01303"></a>01303           <span class="keywordflow">case</span>    -5  :
<a name="l01304"></a>01304             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Empty line met &quot;</span> &lt;&lt; finl;
<a name="l01305"></a>01305             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01306"></a>01306             <span class="keywordflow">break</span>;
<a name="l01307"></a>01307           <span class="keywordflow">default</span> :
<a name="l01308"></a>01308             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Pivot empty met ! at step &quot;</span> &lt;&lt; ie &lt;&lt; finl;;
<a name="l01309"></a>01309             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01310"></a>01310             <span class="keywordflow">break</span>;
<a name="l01311"></a>01311           }
<a name="l01312"></a>01312         prems=0;
<a name="l01313"></a>01313       }
<a name="l01314"></a>01314   }
<a name="l01315"></a>01315 <span class="comment">// resol :</span>
<a name="l01316"></a>01316   {
<a name="l01317"></a>01317     vv.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nn*(ima+1));
<a name="l01318"></a>01318 <span class="comment">// Debog::verifier(&quot;Matrice_Morse::inverse solution 0 &quot;,solution);</span>
<a name="l01319"></a>01319     <a class="code" href="Check__espace__virtuel_8cpp.html#a2ea8fcf12c28d0454bdc4126f8c4b186" title="en mode comm_check_enabled(), verifie si l&#39;espace virtuel du vecteur est a jour, si ce n&#39;est pas le c...">assert_espace_virtuel_vect</a>(solution);
<a name="l01320"></a>01320     <a class="code" href="classMatrice__Base.html#a05caa487a25a6d5e7fbd38d4b2f4ee1e" title="Multiplication d&#39;un vecteur par la matrice. Operation: r = A*x.">multvect</a>(solution, Resini);
<a name="l01321"></a>01321     Resini -= toto;
<a name="l01322"></a>01322     {
<a name="l01323"></a>01323       r = <a class="code" href="DoubleVect_8cpp.html#a07d13cbdadca6b60d5e128653f52a4bb">mp_prodscal</a>(Resini, Resini);
<a name="l01324"></a>01324       r = sqrt(r);
<a name="l01325"></a>01325     }
<a name="l01326"></a>01326     <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot; Initial residu : &quot;</span> &lt;&lt; r &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01327"></a>01327     <span class="keywordflow">if</span> (r==0)
<a name="l01328"></a>01328       coeff_seuilr=<a class="code" href="Double_8h.html#ae0ee0cebfad5968da0ad6cc7a49e16b6">DMAXFLOAT</a>;
<a name="l01329"></a>01329     <span class="keywordflow">else</span>
<a name="l01330"></a>01330       coeff_seuilr=coeff_seuil/r;
<a name="l01331"></a>01331     Resini=toto;
<a name="l01332"></a>01332     <span class="keywordtype">int</span> maxits = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(10, nn);
<a name="l01333"></a>01333     <span class="keywordtype">int</span> io = 0;                                <span class="comment">//!&lt; fichier de sortie</span>
<a name="l01334"></a>01334 <span class="comment"></span><span class="preprocessor">#ifndef CRAY</span>
<a name="l01335"></a>01335 <span class="preprocessor"></span>    <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(PGMRES)(&amp;nn, &amp;ima, toto.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), solution.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), vv.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;coeff_seuilr,
<a name="l01336"></a>01336                     &amp;maxits, &amp;io, <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
<a name="l01337"></a>01337                     alu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), jlu.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), ju.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;ie);
<a name="l01338"></a>01338 
<a name="l01339"></a>01339 <span class="preprocessor">#else</span>
<a name="l01340"></a>01340 <span class="preprocessor"></span>    <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse PGMRES call invalid for CRAY&quot;</span>&lt;&lt;finl;
<a name="l01341"></a>01341     <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01342"></a>01342 <span class="preprocessor">#endif</span>
<a name="l01343"></a>01343 <span class="preprocessor"></span>    <span class="keywordflow">switch</span>(ie)
<a name="l01344"></a>01344       {
<a name="l01345"></a>01345       <span class="keywordflow">case</span> 0:
<a name="l01346"></a>01346         <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;     ** PGMRES has converged **&quot;</span> &lt;&lt; finl;
<a name="l01347"></a>01347         <span class="keywordflow">break</span>;
<a name="l01348"></a>01348       <span class="keywordflow">case</span> 1:
<a name="l01349"></a>01349         <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;     ** No convergence after &quot;</span> &lt;&lt; maxits &lt;&lt; <span class="stringliteral">&quot; iterations **&quot;</span> &lt;&lt; finl;
<a name="l01350"></a>01350         <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>, toto)=Resini;
<a name="l01351"></a>01351         <span class="keywordflow">if</span>( lf&lt;50)
<a name="l01352"></a>01352           {
<a name="l01353"></a>01353             lf +=5;
<a name="l01354"></a>01354             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  The degree of the preconditioning matrix LU is increased :   &quot;</span> &lt;&lt; lf &lt;&lt; finl;
<a name="l01355"></a>01355             n2 = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>()+(2*lf*nn);
<a name="l01356"></a>01356             prems=1;
<a name="l01357"></a>01357             <span class="keywordflow">goto</span> precond ;
<a name="l01358"></a>01358           }
<a name="l01359"></a>01359         <span class="comment">/*else{</span>
<a name="l01360"></a>01360 <span class="comment">          if(ima==50)</span>
<a name="l01361"></a>01361 <span class="comment">          exit();</span>
<a name="l01362"></a>01362 <span class="comment">          Cout &lt;&lt; &quot;  The degree of the Krylov space for PGMRES is increased :   &quot; &lt;&lt; (ima+=2) &lt;&lt; finl;</span>
<a name="l01363"></a>01363 <span class="comment">          Cout &lt;&lt; &quot;    (=&gt; working array for pgmres at &quot; &lt;&lt; (nn*(ima+1)) &lt;&lt; &quot; elements.)&quot; &lt;&lt; finl;</span>
<a name="l01364"></a>01364 <span class="comment">          goto resol ;</span>
<a name="l01365"></a>01365 <span class="comment">          }*/</span>
<a name="l01366"></a>01366         <span class="keywordflow">break</span>;
<a name="l01367"></a>01367       <span class="keywordflow">case</span> -1:
<a name="l01368"></a>01368         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;convergence reached after &quot;</span> &lt;&lt; (int)0 &lt;&lt; <span class="stringliteral">&quot;iterations !! &quot;</span> &lt;&lt; finl;
<a name="l01369"></a>01369         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;&#39;stationnary state may be obtened&#39; dixit us &quot;</span> &lt;&lt; finl;
<a name="l01370"></a>01370         <span class="keywordflow">break</span>;
<a name="l01371"></a>01371       <span class="keywordflow">default</span> :
<a name="l01372"></a>01372         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something abnormal has happened : it is preferable to stop.&quot;</span> &lt;&lt; finl;
<a name="l01373"></a>01373         <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01374"></a>01374       }
<a name="l01375"></a>01375   }
<a name="l01376"></a>01376   <span class="keywordflow">return</span>(1);
<a name="l01377"></a>01377 }
<a name="l01378"></a>01378 
<a name="l01379"></a>01379 <span class="comment">// copie de la fonction precedente avec le parametre max_iteration en plus,</span>
<a name="l01380"></a>01380 <span class="comment">// et si ce nb d&#39;iterations est atteint, return(0), au lieu de recommencer preconditionnement</span>
<a name="l01381"></a>01381 <span class="comment">// utilise pour l&#39;implicite hyperbolique (si recoit 0 : divise le dt par 2 et recommence)</span>
<a name="l01382"></a><a class="code" href="classMatrice__Morse.html#a0c2a2537386dc03a8978da93fedc93ae">01382</a> <span class="keywordtype">int</span> <a class="code" href="classMatrice__Morse.html#a53383f880cbb5efcfddc92c1e570fc9c" title="Calcule la solution du systeme lineaire: A * solution = secmem. La methode utilisee est GMRES precond...">Matrice_Morse::inverse</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; secmem, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; solution,
<a name="l01383"></a>01383                            <span class="keywordtype">double</span> coeff_seuil, <span class="keywordtype">int</span> max_iter)<span class="keyword"> const</span>
<a name="l01384"></a>01384 <span class="keyword"></span>{
<a name="l01385"></a>01385 <span class="comment">// B.Mat: au 20/4/2005, DoubleVect::norme() est bugge, donc la methode n&#39;a</span>
<a name="l01386"></a>01386 <span class="comment">// sans doute jamais ete validee en parallele. Je retire norme() et je mets</span>
<a name="l01387"></a>01387 <span class="comment">// ceci:</span>
<a name="l01388"></a>01388   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
<a name="l01389"></a>01389     {
<a name="l01390"></a>01390       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse(const DoubleVect&amp; secmem, DoubleVect&amp; solution, &quot;</span>
<a name="l01391"></a>01391            &lt;&lt; <span class="stringliteral">&quot;double coeff_seuil) const \n has never been tested in parallel&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01392"></a>01392       assert(0);
<a name="l01393"></a>01393       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01394"></a>01394     }
<a name="l01395"></a>01395 
<a name="l01396"></a>01396 
<a name="l01397"></a>01397   <a class="code" href="classDoubleVect.html">DoubleVect</a> toto(secmem);
<a name="l01398"></a>01398   <span class="keywordtype">int</span> prems=1;                        <span class="comment">//!&lt; On ne calcul L et U que si prems =1</span>
<a name="l01399"></a>01399 <span class="comment"></span>  <span class="keywordtype">int</span> lf = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(10,<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>()/2);        <span class="comment">//!&lt; nombre de termes ajouter dans L et U</span>
<a name="l01400"></a>01400 <span class="comment"></span>  <span class="keywordtype">int</span> nn = <a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>();                <span class="comment">//!&lt; ordre de la matrice</span>
<a name="l01401"></a>01401 <span class="comment"></span>
<a name="l01402"></a>01402   <span class="keywordtype">int</span> ima = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(10,<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>()/2);        <span class="comment">//!&lt; degre de l&#39;espace de Krilov</span>
<a name="l01403"></a>01403 <span class="comment"></span>  <a class="code" href="classIntVect.html">IntVect</a> ju;                        <span class="comment">//!&lt; tableau pour L et U</span>
<a name="l01404"></a>01404 <span class="comment"></span>  <a class="code" href="classDoubleVect.html">DoubleVect</a> alu;                <span class="comment">//!&lt; tableau pour L et U</span>
<a name="l01405"></a>01405 <span class="comment"></span>  <a class="code" href="classIntVect.html">IntVect</a> jlu;                        <span class="comment">//!&lt; tableau pour L et U</span>
<a name="l01406"></a>01406 <span class="comment"></span>  <a class="code" href="classDoubleVect.html">DoubleVect</a> vv;                <span class="comment">//!&lt; tableau de travail pour pgmres</span>
<a name="l01407"></a>01407 <span class="comment"></span>  <a class="code" href="classDoubleVect.html">DoubleVect</a> Resini(nn);
<a name="l01408"></a>01408 
<a name="l01409"></a>01409   <span class="keywordtype">int</span> ie=1;                                <span class="comment">//!&lt; niveau d&#39;erreur</span>
<a name="l01410"></a>01410 <span class="comment"></span>  <span class="keywordtype">int</span> n2 = <a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>()+(2*lf*nn);        <span class="comment">//!&lt; nombre de termes non nuls dans LU</span>
<a name="l01411"></a>01411 <span class="comment"></span>
<a name="l01412"></a>01412   <span class="keywordtype">double</span> r;
<a name="l01413"></a>01413   <span class="keywordtype">double</span> coeff_seuilr;
<a name="l01414"></a>01414 <span class="comment">// precond :</span>
<a name="l01415"></a>01415   {
<a name="l01416"></a>01416     <span class="keywordflow">if</span> (prems)
<a name="l01417"></a>01417       {
<a name="l01418"></a>01418 <span class="comment">// Cerr &lt;&lt; &quot;  ordre de la matrice de pression = &quot; &lt;&lt; nn &lt;&lt; finl;</span>
<a name="l01419"></a>01419 <span class="comment">// Cerr &lt;&lt; &quot;  nb termes non nuls dans la matrice de pression = &quot;</span>
<a name="l01420"></a>01420 <span class="comment">// &lt;&lt; tab2_.size() &lt;&lt; finl;</span>
<a name="l01421"></a>01421         <span class="keywordtype">int</span>  iw = n2 + 2;
<a name="l01422"></a>01422         ju.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nn);
<a name="l01423"></a>01423         jlu.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(iw);
<a name="l01424"></a>01424         alu.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(iw);
<a name="l01425"></a>01425         <span class="keywordtype">double</span> to = 1.e-10;                <span class="comment">//!&lt; filtrage des coefficents de L U</span>
<a name="l01426"></a>01426 <span class="comment"></span>        <a class="code" href="classDoubleVect.html">DoubleVect</a> w(nn+1);                <span class="comment">//!&lt; tableau de travail pour ilut</span>
<a name="l01427"></a>01427 <span class="comment"></span>
<a name="l01428"></a>01428 <span class="comment">// IntVect jr(nn);                        // tableau de travail pour ilut</span>
<a name="l01429"></a>01429         <a class="code" href="classIntVect.html">IntVect</a> jw(2*nn);                        <span class="comment">//!&lt; tableau de travail pour ilut        IntVect jwl(nn);                        // tableau de travail pour ilut coeff_[0]*=2.0;                        // pour rendre A non singuliere!</span>
<a name="l01430"></a>01430 <span class="comment"></span><span class="comment">//</span>
<a name="l01431"></a>01431 <span class="comment">//</span>
<a name="l01432"></a>01432 
<a name="l01433"></a>01433 <span class="comment">// Cerr &lt;&lt; &quot;  ****  Preconditionnement ILUT de la matrice de pression  ****&quot; &lt;&lt; finl;</span>
<a name="l01434"></a>01434 <span class="preprocessor">#ifndef CRAY</span>
<a name="l01435"></a>01435 <span class="preprocessor"></span>        <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(ILUT)(&amp;nn, <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;lf,
<a name="l01436"></a>01436                       &amp;to, alu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), jlu.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), ju.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
<a name="l01437"></a>01437                       &amp;iw, w.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
<a name="l01438"></a>01438                       jw.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;ie);
<a name="l01439"></a>01439 <span class="preprocessor">#else</span>
<a name="l01440"></a>01440 <span class="preprocessor"></span>        <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse ILUT call invalid for CRAY&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01441"></a>01441         <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01442"></a>01442 <span class="preprocessor">#endif</span>
<a name="l01443"></a>01443 <span class="preprocessor"></span>
<a name="l01444"></a>01444 <span class="comment">// coeff_[0]*=0.5;                        // pour rendre A singuliere!</span>
<a name="l01445"></a>01445 <span class="comment">// Cerr &lt;&lt; &quot;     nb termes non nuls dans LU = &quot; &lt;&lt; n2 &lt;&lt; finl;</span>
<a name="l01446"></a>01446         <span class="keywordflow">switch</span>(ie)
<a name="l01447"></a>01447           {
<a name="l01448"></a>01448           <span class="keywordflow">case</span> 0 :
<a name="l01449"></a>01449             <span class="comment">/*{</span>
<a name="l01450"></a>01450 <span class="comment">              Cerr &lt;&lt; &quot;     printing of L and U matrixes : &quot; &lt;&lt; finl;</span>
<a name="l01451"></a>01451 <span class="comment">              Nom nom_fich = &quot;matrices_L_U.precond&quot;;</span>
<a name="l01452"></a>01452 <span class="comment">              ofstream os(nom_fich);</span>
<a name="l01453"></a>01453 <span class="comment">              os &lt;&lt; &quot;impression des matrices L et U :\n&quot;;</span>
<a name="l01454"></a>01454 <span class="comment">              int* tab2=jlu;</span>
<a name="l01455"></a>01455 <span class="comment">              double* coeff=alu;</span>
<a name="l01456"></a>01456 <span class="comment">              double x;</span>
<a name="l01457"></a>01457 <span class="comment">              os &lt;&lt; &quot;termes diagonaux :&quot; &lt;&lt; &quot;\n&quot;;</span>
<a name="l01458"></a>01458 <span class="comment">              for (int num=0; num&lt;nn; num++) {</span>
<a name="l01459"></a>01459 <span class="comment">              x=coeff[num];</span>
<a name="l01460"></a>01460 <span class="comment">              os &lt;&lt; &quot;(&quot; &lt;&lt; num+1 &lt;&lt; &quot; , &quot; &lt;&lt; num+1 &lt;&lt; &quot;)  =  &quot; &lt;&lt; x &lt;&lt; &quot;\n&quot;;</span>
<a name="l01461"></a>01461 <span class="comment">              }</span>
<a name="l01462"></a>01462 <span class="comment">              os &lt;&lt; &quot;hors diagonale : &quot; &lt;&lt; &quot;\n&quot;;</span>
<a name="l01463"></a>01463 <span class="comment">              for ( num=0; num&lt;nn; num++) {</span>
<a name="l01464"></a>01464 <span class="comment">              os &lt;&lt; &quot;ligne &quot; &lt;&lt; num+1 &lt;&lt; &quot; : &quot;;</span>
<a name="l01465"></a>01465 <span class="comment">              int nb_vois=tab2[num+1]-tab2[num];</span>
<a name="l01466"></a>01466 <span class="comment">              double x=0.;</span>
<a name="l01467"></a>01467 <span class="comment">              for(int vois=0; vois&lt;nb_vois; vois++) {</span>
<a name="l01468"></a>01468 <span class="comment">              int num_vois=tab2[tab2[num]+vois-1];</span>
<a name="l01469"></a>01469 <span class="comment">              x=coeff[tab2[num]+vois-1];</span>
<a name="l01470"></a>01470 <span class="comment">              os &lt;&lt; &quot;(&quot; &lt;&lt; num_vois &lt;&lt; &quot; , &quot; &lt;&lt; x &lt;&lt; &quot; ) &quot; ;</span>
<a name="l01471"></a>01471 <span class="comment">              }</span>
<a name="l01472"></a>01472 <span class="comment">              os &lt;&lt; &quot;\n&quot;;</span>
<a name="l01473"></a>01473 <span class="comment">              }</span>
<a name="l01474"></a>01474 <span class="comment">              os.flush();</span>
<a name="l01475"></a>01475 <span class="comment">              }</span>
<a name="l01476"></a>01476 <span class="comment">            */</span>
<a name="l01477"></a>01477 <span class="comment">// Cerr &lt;&lt; &quot;     matrices L et U :  OK&quot; &lt;&lt; finl;</span>
<a name="l01478"></a>01478             <span class="keywordflow">break</span>;
<a name="l01479"></a>01479           <span class="keywordflow">case</span> -1 :
<a name="l01480"></a>01480             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut &#39;matrix may be wrong&#39; dixit SAAD&quot;</span> &lt;&lt; finl;
<a name="l01481"></a>01481             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01482"></a>01482             <span class="keywordflow">break</span>;
<a name="l01483"></a>01483           <span class="keywordflow">case</span>  -2  :
<a name="l01484"></a>01484             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut : overflow in L &quot;</span> &lt;&lt; finl;
<a name="l01485"></a>01485             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01486"></a>01486             <span class="keywordflow">break</span>;
<a name="l01487"></a>01487           <span class="keywordflow">case</span>   -3  :
<a name="l01488"></a>01488             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in ilut : overflow in U &quot;</span> &lt;&lt; finl;
<a name="l01489"></a>01489             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01490"></a>01490             <span class="keywordflow">break</span>;
<a name="l01491"></a>01491           <span class="keywordflow">case</span>    -4   :
<a name="l01492"></a>01492             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Illegal value for lfil : it may be a memory trouble &quot;</span> &lt;&lt; finl;
<a name="l01493"></a>01493             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01494"></a>01494             <span class="keywordflow">break</span>;
<a name="l01495"></a>01495           <span class="keywordflow">case</span>    -5  :
<a name="l01496"></a>01496             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Empty line met &quot;</span> &lt;&lt; finl;
<a name="l01497"></a>01497             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01498"></a>01498             <span class="keywordflow">break</span>;
<a name="l01499"></a>01499           <span class="keywordflow">default</span> :
<a name="l01500"></a>01500             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Pivot null met ! at step &quot;</span> &lt;&lt; ie &lt;&lt; finl;;
<a name="l01501"></a>01501             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01502"></a>01502             <span class="keywordflow">break</span>;
<a name="l01503"></a>01503           }
<a name="l01504"></a>01504         prems=0;
<a name="l01505"></a>01505       }
<a name="l01506"></a>01506   }
<a name="l01507"></a>01507 <span class="comment">// resol :</span>
<a name="l01508"></a>01508   {
<a name="l01509"></a>01509     vv.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nn*(ima+1));
<a name="l01510"></a>01510     <a class="code" href="classMatrice__Base.html#a05caa487a25a6d5e7fbd38d4b2f4ee1e" title="Multiplication d&#39;un vecteur par la matrice. Operation: r = A*x.">multvect</a>(solution, Resini);
<a name="l01511"></a>01511     Resini -= toto;
<a name="l01512"></a>01512     r = <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(Resini);
<a name="l01513"></a>01513     <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot; Initial residu : &quot;</span> &lt;&lt; r &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01514"></a>01514     coeff_seuilr=coeff_seuil/r;
<a name="l01515"></a>01515     Resini=toto;
<a name="l01516"></a>01516     <span class="keywordtype">int</span> maxits = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(10, max_iter);
<a name="l01517"></a>01517     <span class="keywordtype">int</span> io = 0;                                <span class="comment">//!&lt; fichier de sortie</span>
<a name="l01518"></a>01518 <span class="comment"></span><span class="preprocessor">#ifndef CRAY</span>
<a name="l01519"></a>01519 <span class="preprocessor"></span>    <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(PGMRES)(&amp;nn, &amp;ima, toto.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), solution.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), vv.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;coeff_seuilr,
<a name="l01520"></a>01520                     &amp;maxits, &amp;io, <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(),
<a name="l01521"></a>01521                     alu.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), jlu.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), ju.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;ie);
<a name="l01522"></a>01522 <span class="preprocessor">#else</span>
<a name="l01523"></a>01523 <span class="preprocessor"></span>    <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Matrice_Morse::inverse PGMRES call invalid for CRAY&quot;</span>&lt;&lt;finl;
<a name="l01524"></a>01524     <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01525"></a>01525 <span class="preprocessor">#endif</span>
<a name="l01526"></a>01526 <span class="preprocessor"></span>
<a name="l01527"></a>01527 <span class="comment">// multvect(solution, Resini);</span>
<a name="l01528"></a>01528 <span class="comment">// Resini -= secmem;</span>
<a name="l01529"></a>01529 <span class="comment">// r=Resini.norme();</span>
<a name="l01530"></a>01530 <span class="comment">// Cerr &lt;&lt; &quot; Residu final : &quot; &lt;&lt; r &lt;&lt;&quot; coeff &quot;&lt;&lt;coeff_seuilr*r&lt;&lt;&quot; Its &quot;&lt;&lt;maxits&lt;&lt; finl;</span>
<a name="l01531"></a>01531     <span class="keywordflow">switch</span>(ie)
<a name="l01532"></a>01532       {
<a name="l01533"></a>01533       <span class="keywordflow">case</span> 0:
<a name="l01534"></a>01534         <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;     ** PGMRES has converged ** &quot;</span> &lt;&lt; finl;
<a name="l01535"></a>01535         <span class="keywordflow">break</span>;
<a name="l01536"></a>01536       <span class="keywordflow">case</span> 1:
<a name="l01537"></a>01537         <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;     ** No convergence after &quot;</span> &lt;&lt; maxits &lt;&lt; <span class="stringliteral">&quot; iterations **&quot;</span> &lt;&lt; finl;
<a name="l01538"></a>01538         <span class="keywordflow">return</span>(0);
<a name="l01539"></a>01539         <span class="comment">/*else{</span>
<a name="l01540"></a>01540 <span class="comment">          if(ima==50)</span>
<a name="l01541"></a>01541 <span class="comment">          exit();</span>
<a name="l01542"></a>01542 <span class="comment">          Cerr &lt;&lt; &quot;  The degree of the Krylov space for PGMRES is increased :   &quot; &lt;&lt; (ima+=2) &lt;&lt; finl;</span>
<a name="l01543"></a>01543 <span class="comment">          Cerr &lt;&lt; &quot;    (=&gt; working array for pgmres at &quot; &lt;&lt; (nn*(ima+1)) &lt;&lt; &quot; elements.)&quot; &lt;&lt; finl;</span>
<a name="l01544"></a>01544 <span class="comment">          goto resol ;</span>
<a name="l01545"></a>01545 <span class="comment">// (DoubleVect&amp;) toto=Resini;</span>
<a name="l01546"></a>01546 <span class="comment">// if( lf&lt;50){</span>
<a name="l01547"></a>01547 <span class="comment">// lf +=5;</span>
<a name="l01548"></a>01548 <span class="comment">// Cerr &lt;&lt; &quot;  J&#39;augmente le degre de la matrice de precondition. LU:   &quot; &lt;&lt; lf &lt;&lt; finl;</span>
<a name="l01549"></a>01549 <span class="comment">// n2 = coeff_.size()+(2*lf*nn);</span>
<a name="l01550"></a>01550 <span class="comment">// prems=1;</span>
<a name="l01551"></a>01551 <span class="comment">// goto precond ;</span>
<a name="l01552"></a>01552 <span class="comment">// }</span>
<a name="l01553"></a>01553 <span class="comment">          }*/</span>
<a name="l01554"></a>01554       <span class="keywordflow">case</span> -1:
<a name="l01555"></a>01555         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Convergence after &quot;</span> &lt;&lt; (int)0 &lt;&lt; <span class="stringliteral">&quot;iterations !! &quot;</span> &lt;&lt; finl;
<a name="l01556"></a>01556         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;&#39;stationnary state may be obtened&#39; dixit us &quot;</span> &lt;&lt; finl;
<a name="l01557"></a>01557         <span class="keywordflow">break</span>;
<a name="l01558"></a>01558       <span class="keywordflow">default</span> :
<a name="l01559"></a>01559         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Something abnormal has happened : it is preferable to stop.&quot;</span> &lt;&lt; finl;
<a name="l01560"></a>01560         <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01561"></a>01561       }
<a name="l01562"></a>01562   }
<a name="l01563"></a>01563   <span class="keywordflow">return</span>(1);
<a name="l01564"></a>01564 }
<a name="l01565"></a>01565 
<a name="l01566"></a>01566 
<a name="l01567"></a>01567 <span class="comment">// Precondition:</span>
<a name="l01568"></a>01568 <span class="comment">// Parametre: DoubleVect&amp; x</span>
<a name="l01569"></a>01569 <span class="comment">// Signification: vecteur de scaling</span>
<a name="l01570"></a>01570 <span class="comment">// Valeurs par defaut:</span>
<a name="l01571"></a>01571 <span class="comment">// Contraintes: x.size() = nb ligne de la matrice</span>
<a name="l01572"></a>01572 <span class="comment">// Acces:</span>
<a name="l01573"></a>01573 <span class="comment">// Exception:</span>
<a name="l01574"></a>01574 <span class="comment">// Effets de bord:</span>
<a name="l01575"></a>01575 <span class="comment">// Postcondition:</span>
<a name="l01576"></a>01576 <span class="comment">//</span>
<a name="l01577"></a>01577 <span class="comment">//</span>
<a name="l01578"></a>01578 <span class="comment">//</span>
<a name="l01579"></a>01579 <span class="comment">//</span>
<a name="l01580"></a>01580 <span class="comment">//</span><span class="comment"></span>
<a name="l01581"></a>01581 <span class="comment">//! Operateur de multiplication d&#39;une matrice par un vecteur:&lt;br&gt;scaling des lignes de la matrice par les coefficients&lt;br&gt;correspondants du vecteur passe en parametre.&lt;br&gt;A *= x, effectue les scaling suivants:&lt;br&gt;A(i,:) = A(i,:) * x(i), pour toutes les lignes i de A</span>
<a name="l01582"></a>01582 <span class="comment"></span><span class="comment">/** \return Matrice_Morse\&amp;&lt;br&gt;</span>
<a name="l01583"></a>01583 <span class="comment">Signification: le resultat de l&#39;operation (*this)&lt;br&gt;</span>
<a name="l01584"></a>01584 <span class="comment">Contraintes: */</span>
<a name="l01585"></a><a class="code" href="classMatrice__Morse.html#a3bf78034a1ed02f3721b406183577f59">01585</a> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; <a class="code" href="classMatrice__Morse.html#a547bc77cbec07f7cb77f180d2a600149" title="Operateur de multiplication (de tous les elements) d&#39;une matrice par un scalaire. Operation: A = x * ...">Matrice_Morse::operator *=</a>(<span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; x)
<a name="l01586"></a>01586 {
<a name="l01587"></a>01587   <span class="keywordtype">int</span> i,k;
<a name="l01588"></a>01588   <span class="keywordflow">for</span>(i = 0; i&lt;<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>(); i++)
<a name="l01589"></a>01589     <span class="keywordflow">for</span>(k = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)-1; k&lt;<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+1)-1; k++)
<a name="l01590"></a>01590       <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(k) *= x(i);
<a name="l01591"></a>01591   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l01592"></a>01592 }
<a name="l01593"></a>01593 
<a name="l01594"></a>01594 
<a name="l01595"></a>01595 <span class="comment">// Precondition:</span>
<a name="l01596"></a>01596 <span class="comment">// Parametre: Matrice_Morse&amp; A</span>
<a name="l01597"></a>01597 <span class="comment">// Signification: une matrice au format Morse</span>
<a name="l01598"></a>01598 <span class="comment">// Valeurs par defaut:</span>
<a name="l01599"></a>01599 <span class="comment">// Contraintes: reference constante</span>
<a name="l01600"></a>01600 <span class="comment">// Acces: entree</span>
<a name="l01601"></a>01601 <span class="comment">// Parametre: Matrice_Morse&amp; B</span>
<a name="l01602"></a>01602 <span class="comment">// Signification: une matrice au format Morse</span>
<a name="l01603"></a>01603 <span class="comment">// Valeurs par defaut:</span>
<a name="l01604"></a>01604 <span class="comment">// Contraintes: reference constante</span>
<a name="l01605"></a>01605 <span class="comment">// Acces: entree</span>
<a name="l01606"></a>01606 <span class="comment">// Exception:</span>
<a name="l01607"></a>01607 <span class="comment">// Effets de bord: redimensionne la matrice en cas de besoin,</span>
<a name="l01608"></a>01608 <span class="comment">// si pas assez d&#39;espace pour les elements non nuls generes par le produit.</span>
<a name="l01609"></a>01609 <span class="comment">// Postcondition:</span>
<a name="l01610"></a>01610 <span class="comment">//</span>
<a name="l01611"></a>01611 <span class="comment">//</span><span class="comment"></span>
<a name="l01612"></a>01612 <span class="comment">//! Affecte le produit de 2 matrices Morse A et B a l&#39;objet (this).&lt;br&gt;Operation: this = A * B</span>
<a name="l01613"></a>01613 <span class="comment"></span><span class="comment">/** \return Matrice_Morse\&amp;&lt;br&gt;</span>
<a name="l01614"></a>01614 <span class="comment">Signification: le resultat de l&#39;operation (*this)&lt;br&gt;</span>
<a name="l01615"></a>01615 <span class="comment">Contraintes: */</span>
<a name="l01616"></a><a class="code" href="classMatrice__Morse.html#a1aa4f648fa4ada1731cd8ae41a8ec23e">01616</a> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; <a class="code" href="classMatrice__Morse.html#a1aa4f648fa4ada1731cd8ae41a8ec23e" title="Affecte le produit de 2 matrices Morse A et B a l&#39;objet (this). Operation: this = A * B...">Matrice_Morse::affecte_prod</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; a, <span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; b)
<a name="l01617"></a>01617 {
<a name="l01618"></a>01618   <span class="keywordtype">int</span> nrow= a.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();                <span class="comment">//!&lt; nb de lignes de A</span>
<a name="l01619"></a>01619 <span class="comment"></span>  <span class="keywordtype">int</span> ncol= b.<a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>();                <span class="comment">//!&lt; nb de colonnes de B assert(nrow==ncol); Jloi non?</span>
<a name="l01620"></a>01620 <span class="comment"></span><span class="comment">//</span>
<a name="l01621"></a>01621 <span class="comment">//</span>
<a name="l01622"></a>01622   assert(nrow==ncol);
<a name="l01623"></a>01623   <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nrow+1);
<a name="l01624"></a>01624   <span class="keywordtype">int</span> job = 1 ;                      <span class="comment">//!&lt; on recupere tout (tab1, tab2, coeff de matrice_resu)</span>
<a name="l01625"></a>01625 <span class="comment"></span>  <span class="keywordtype">int</span>  nzmax = <a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>();                <span class="comment">//!&lt; nb de valeurs maximales de la matrice resultante</span>
<a name="l01626"></a>01626 <span class="comment"></span>  <span class="keywordflow">if</span>(nzmax==0)
<a name="l01627"></a>01627     {
<a name="l01628"></a>01628       nzmax=a.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>();
<a name="l01629"></a>01629       <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nzmax);
<a name="l01630"></a>01630       <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nzmax);
<a name="l01631"></a>01631       assert(nzmax==<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>());
<a name="l01632"></a>01632     }
<a name="l01633"></a>01633   <a class="code" href="classIntVect.html">IntVect</a> iw(ncol+1);                        <span class="comment">//!&lt; tableau de travail</span>
<a name="l01634"></a>01634 <span class="comment"></span>
<a name="l01635"></a>01635 
<a name="l01636"></a>01636 <span class="comment">// Cerr &lt;&lt; &quot; iao1 &quot; &lt;&lt; a.tab1_ &lt;&lt; finl ;</span>
<a name="l01637"></a>01637 <span class="comment">// Cerr &lt;&lt; &quot; jao1 &quot; &lt;&lt; a.tab2_ &lt;&lt; finl ;</span>
<a name="l01638"></a>01638 <span class="comment">// Cerr &lt;&lt; &quot; aao1 &quot; &lt;&lt; a.coeff_ &lt;&lt; finl ;</span>
<a name="l01639"></a>01639 <span class="comment">// </span>
<a name="l01640"></a>01640 <span class="comment">// Cerr &lt;&lt; &quot; iao2 &quot; &lt;&lt; b.tab1_ &lt;&lt; finl ;</span>
<a name="l01641"></a>01641 <span class="comment">// Cerr &lt;&lt; &quot; jao2 &quot; &lt;&lt; b.tab2_ &lt;&lt; finl ;</span>
<a name="l01642"></a>01642 <span class="comment">// Cerr &lt;&lt; &quot; aao2 &quot; &lt;&lt; b.coeff_ &lt;&lt; finl ;</span>
<a name="l01643"></a>01643 
<a name="l01644"></a>01644 
<a name="l01645"></a>01645 <span class="comment">// while(ierr=0)</span>
<a name="l01646"></a>01646 <span class="comment">// {</span>
<a name="l01647"></a>01647 <span class="comment">// F77NAME(AMUB)(&amp;nb_lig, &amp;nb_col, &amp;job, A.coeff_, A.tab2_, A.tab1_,</span>
<a name="l01648"></a>01648 <span class="comment">// B.coeff_, B.tab2_, B.tab1_,</span>
<a name="l01649"></a>01649 <span class="comment">// coeff_.addr(), tab2_.addr(), tab1_.addr(), &amp;nzmax, iw, &amp;ierr);</span>
<a name="l01650"></a>01650 <span class="comment">// </span>
<a name="l01651"></a>01651 <span class="comment">// </span>
<a name="l01652"></a>01652 <span class="comment">// c----------------------------------------------------------------------c</span>
<a name="l01653"></a>01653 <span class="comment">// subroutine amub (nrow,ncol,job,a,ja,ia,b,jb,ib,</span>
<a name="l01654"></a>01654 <span class="comment">// *                 c,jc,ic,nzmax,iw,ierr)</span>
<a name="l01655"></a>01655 <span class="comment">// real*8 a(*), b(*), c(*)</span>
<a name="l01656"></a>01656 <span class="comment">// integer ja(*),jb(*),jc(*),ia(nrow+1),ib(ncol+1),</span>
<a name="l01657"></a>01657 <span class="comment">// *     ic(ncol+1),iw(ncol)</span>
<a name="l01658"></a>01658 <span class="comment">// c-----------------------------------------------------------------------</span>
<a name="l01659"></a>01659 <span class="comment">// c performs the matrix by matrix product C = A B</span>
<a name="l01660"></a>01660 <span class="comment">// c-----------------------------------------------------------------------</span>
<a name="l01661"></a>01661 <span class="comment">// c on entry:</span>
<a name="l01662"></a>01662 <span class="comment">// c ---------</span>
<a name="l01663"></a>01663 <span class="comment">// c nrow        = integer. The row dimension of A</span>
<a name="l01664"></a>01664 <span class="comment">// c ncol  = integer. The column dimension of B</span>
<a name="l01665"></a>01665 <span class="comment">// c job   = integer. Job indicator. When job = 0, only the structure</span>
<a name="l01666"></a>01666 <span class="comment">// c                  (i.e. the arrays jc, ic) is computed and the</span>
<a name="l01667"></a>01667 <span class="comment">// c                  real values are ignored.</span>
<a name="l01668"></a>01668 <span class="comment">// c</span>
<a name="l01669"></a>01669 <span class="comment">// c a,</span>
<a name="l01670"></a>01670 <span class="comment">// c ja,</span>
<a name="l01671"></a>01671 <span class="comment">// c ia   = Matrix A in compressed sparse row format.</span>
<a name="l01672"></a>01672 <span class="comment">// c</span>
<a name="l01673"></a>01673 <span class="comment">// c b,</span>
<a name="l01674"></a>01674 <span class="comment">// c jb,</span>
<a name="l01675"></a>01675 <span class="comment">// c ib        =  Matrix B in compressed sparse row format.</span>
<a name="l01676"></a>01676 <span class="comment">// c</span>
<a name="l01677"></a>01677 <span class="comment">// c nzmax        = integer. The  length of the arrays c and jc.</span>
<a name="l01678"></a>01678 <span class="comment">// c         amub will stop if the result matrix C  has a number</span>
<a name="l01679"></a>01679 <span class="comment">// c         of elements that exceeds exceeds nzmax. See ierr.</span>
<a name="l01680"></a>01680 <span class="comment">// c</span>
<a name="l01681"></a>01681 <span class="comment">// c on return:</span>
<a name="l01682"></a>01682 <span class="comment">// c----------</span>
<a name="l01683"></a>01683 <span class="comment">// c c,</span>
<a name="l01684"></a>01684 <span class="comment">// c jc,</span>
<a name="l01685"></a>01685 <span class="comment">// c ic        = resulting matrix C in compressed sparse row sparse format.</span>
<a name="l01686"></a>01686 <span class="comment">// c</span>
<a name="l01687"></a>01687 <span class="comment">// c ierr        = integer. serving as error message.</span>
<a name="l01688"></a>01688 <span class="comment">// c         ierr = 0 means normal return,</span>
<a name="l01689"></a>01689 <span class="comment">// c         ierr .gt. 0 means that amub stopped while computing the</span>
<a name="l01690"></a>01690 <span class="comment">// c         i-th row  of C with i=ierr, because the number</span>
<a name="l01691"></a>01691 <span class="comment">// c         of elements in C exceeds nzmax.</span>
<a name="l01692"></a>01692 <span class="comment">// c</span>
<a name="l01693"></a>01693 <span class="comment">// c work arrays:</span>
<a name="l01694"></a>01694 <span class="comment">// c------------</span>
<a name="l01695"></a>01695 <span class="comment">// c iw        = integer work array of length equal to the number of</span>
<a name="l01696"></a>01696 <span class="comment">// c         columns in A.</span>
<a name="l01697"></a>01697 <span class="comment">// c Notes:</span>
<a name="l01698"></a>01698 <span class="comment">// c-------</span>
<a name="l01699"></a>01699 <span class="comment">// c         The column dimension of B is not needed.</span>
<a name="l01700"></a>01700 <span class="comment">// c</span>
<a name="l01701"></a>01701 <span class="comment">// c-----------------------------------------------------------------</span>
<a name="l01702"></a>01702 <span class="comment">// real*8 scal</span>
<a name="l01703"></a>01703 <span class="comment">// logical values</span>
<a name="l01704"></a>01704 <span class="comment">// values = (job .ne. 0)</span>
<a name="l01705"></a>01705 <span class="comment">// len = 0</span>
<a name="l01706"></a>01706 <span class="comment">// ic(1) = 1</span>
<a name="l01707"></a>01707 <span class="comment">// ierr = 0</span>
<a name="l01708"></a>01708 <span class="comment">// c     initialize array iw.</span>
<a name="l01709"></a>01709 <span class="comment">// do 1 j=1, ncol</span>
<a name="l01710"></a>01710 <span class="comment">// iw(j) = 0</span>
<a name="l01711"></a>01711 <span class="comment">// 1    continue</span>
<a name="l01712"></a>01712 <span class="comment">// c</span>
<a name="l01713"></a>01713 
<a name="l01714"></a>01714   <span class="keywordtype">double</span> scal=0. ;
<a name="l01715"></a>01715   <span class="keywordtype">int</span> ii, jj ,k , ka, kb ;
<a name="l01716"></a>01716   <span class="keywordtype">int</span> values = 0;
<a name="l01717"></a>01717   <span class="keywordflow">if</span> (job != 0) values = 1 ;
<a name="l01718"></a>01718   <span class="keywordtype">int</span> len = -1 ;
<a name="l01719"></a>01719   <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[0] = 1  ;
<a name="l01720"></a>01720   iw = -1 ;
<a name="l01721"></a>01721 
<a name="l01722"></a>01722 <span class="comment">// do 500 ii=1, nrow</span>
<a name="l01723"></a>01723 <span class="comment">// c     row i</span>
<a name="l01724"></a>01724 <span class="comment">// do 200 ka=ia(ii), ia(ii+1)-1</span>
<a name="l01725"></a>01725 <span class="comment">// if (values) scal = a(ka)</span>
<a name="l01726"></a>01726 <span class="comment">// jj   = ja(ka)</span>
<a name="l01727"></a>01727 <span class="comment">// do 100 kb=ib(jj),ib(jj+1)-1</span>
<a name="l01728"></a>01728 <span class="comment">// jcol = jb(kb)</span>
<a name="l01729"></a>01729 <span class="comment">// jpos = iw(jcol)</span>
<a name="l01730"></a>01730 <span class="comment">// if (jpos .eq. 0) then</span>
<a name="l01731"></a>01731 <span class="comment">// len = len+1</span>
<a name="l01732"></a>01732 <span class="comment">// if (len .gt. nzmax) then</span>
<a name="l01733"></a>01733 <span class="comment">// ierr = ii</span>
<a name="l01734"></a>01734 <span class="comment">// return</span>
<a name="l01735"></a>01735 <span class="comment">// endif</span>
<a name="l01736"></a>01736 <span class="comment">// jc(len) = jcol</span>
<a name="l01737"></a>01737 <span class="comment">// iw(jcol)= len</span>
<a name="l01738"></a>01738 <span class="comment">// if (values) c(len)  = scal*b(kb)</span>
<a name="l01739"></a>01739 <span class="comment">// else</span>
<a name="l01740"></a>01740 <span class="comment">// if (values) c(jpos) = c(jpos) + scal*b(kb)</span>
<a name="l01741"></a>01741 <span class="comment">// endif</span>
<a name="l01742"></a>01742 <span class="comment">// 100            continue</span>
<a name="l01743"></a>01743 <span class="comment">// 200     continue</span>
<a name="l01744"></a>01744 <span class="comment">// do 201 k=ic(ii), len</span>
<a name="l01745"></a>01745 <span class="comment">// iw(jc(k)) = 0</span>
<a name="l01746"></a>01746 <span class="comment">// 201     continue</span>
<a name="l01747"></a>01747 <span class="comment">// ic(ii+1) = len+1</span>
<a name="l01748"></a>01748 <span class="comment">// 500  continue</span>
<a name="l01749"></a>01749 
<a name="l01750"></a>01750 <span class="comment">// Cerr &lt;&lt; &quot;Matrice_Morse::affect_prod nrow &quot; &lt;&lt; nrow &lt;&lt; finl;</span>
<a name="l01751"></a>01751 
<a name="l01752"></a>01752   <span class="keywordflow">for</span>(ii=0; ii&lt; nrow; ii++)
<a name="l01753"></a>01753     {
<a name="l01754"></a>01754       <span class="keywordflow">for</span>(ka=a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[ii]-1; ka &lt; a.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[ii+1]-1; ka++)
<a name="l01755"></a>01755         {
<a name="l01756"></a>01756           <span class="keywordflow">if</span> (values == 1) scal = a.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[ka] ;
<a name="l01757"></a>01757           jj   = a.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[ka] - 1 ;
<a name="l01758"></a>01758           <span class="keywordflow">for</span> (kb=b.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[jj]-1; kb &lt; b.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[jj+1]-1; kb++)
<a name="l01759"></a>01759             {
<a name="l01760"></a>01760               <span class="keywordtype">int</span> jcol = b.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[kb] -1 ;
<a name="l01761"></a>01761               <span class="keywordtype">int</span> jpos = iw[jcol]  ;
<a name="l01762"></a>01762               <span class="keywordflow">if</span> (jpos == -1)
<a name="l01763"></a>01763                 {
<a name="l01764"></a>01764                   len++ ;
<a name="l01765"></a>01765                   <span class="keywordflow">if</span> (len &gt; nzmax-1)
<a name="l01766"></a>01766                     {
<a name="l01767"></a>01767 <span class="comment">// Cerr &lt;&lt; &quot;Matrice_Morse::affect_prod len &gt; nzmax -1 &quot; &lt;&lt; nzmax &lt;&lt; finl;</span>
<a name="l01768"></a>01768                       nzmax += nrow/ii*nzmax;
<a name="l01769"></a>01769                       <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nzmax);
<a name="l01770"></a>01770                       <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nzmax);
<a name="l01771"></a>01771                     }
<a name="l01772"></a>01772                   <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[len] = jcol + 1 ;
<a name="l01773"></a>01773                   iw[jcol]= len ;
<a name="l01774"></a>01774                   <span class="keywordflow">if</span> (values == 1) <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[len]  = scal*b.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kb] ;
<a name="l01775"></a>01775                 }
<a name="l01776"></a>01776               <span class="keywordflow">else</span>
<a name="l01777"></a>01777                 {
<a name="l01778"></a>01778                   <span class="keywordflow">if</span> (values == 1) <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[jpos] += scal*b.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[kb] ;
<a name="l01779"></a>01779                 }
<a name="l01780"></a>01780             }
<a name="l01781"></a>01781         }
<a name="l01782"></a>01782 
<a name="l01783"></a>01783       <span class="keywordflow">for</span> (k=<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[ii]-1; k &lt; len+1 ; k++) iw[<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>[k]-1] = -1 ;
<a name="l01784"></a>01784       <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[ii+1] = (len+1) + 1 ;
<a name="l01785"></a>01785     }
<a name="l01786"></a>01786 
<a name="l01787"></a>01787 <span class="comment">// return</span>
<a name="l01788"></a>01788 <span class="comment">// c-------------end-of-amub-----------------------------------------------</span>
<a name="l01789"></a>01789 <span class="comment">// c-----------------------------------------------------------------------</span>
<a name="l01790"></a>01790 <span class="comment">// </span>
<a name="l01791"></a>01791 <span class="comment">// if(ierr)</span>
<a name="l01792"></a>01792 <span class="comment">// {</span>
<a name="l01793"></a>01793 <span class="comment">// nzmax+=nrow/ierr*nzmax;</span>
<a name="l01794"></a>01794 <span class="comment">// coeff_.resize(nzmax);</span>
<a name="l01795"></a>01795 <span class="comment">// tab2_.resize(nzmax);</span>
<a name="l01796"></a>01796 <span class="comment">// }</span>
<a name="l01797"></a>01797 <span class="comment">// </span>
<a name="l01798"></a>01798 <span class="comment">// }</span>
<a name="l01799"></a>01799 
<a name="l01800"></a>01800   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[nrow]-1);
<a name="l01801"></a>01801   <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>[nrow]-1);
<a name="l01802"></a>01802   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l01803"></a>01803   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l01804"></a>01804 
<a name="l01805"></a>01805 }
<a name="l01806"></a>01806 
<a name="l01807"></a>01807 
<a name="l01808"></a>01808 
<a name="l01809"></a>01809 <span class="comment">// Precondition:</span>
<a name="l01810"></a>01810 <span class="comment">// Parametre: double x</span>
<a name="l01811"></a>01811 <span class="comment">// Signification: valeur du scaling</span>
<a name="l01812"></a>01812 <span class="comment">// Valeurs par defaut:</span>
<a name="l01813"></a>01813 <span class="comment">// Contraintes:</span>
<a name="l01814"></a>01814 <span class="comment">// Acces: entree</span>
<a name="l01815"></a>01815 <span class="comment">// Parametre: Matrice_Morse&amp; B</span>
<a name="l01816"></a>01816 <span class="comment">// Signification: une matrice au format Morse</span>
<a name="l01817"></a>01817 <span class="comment">// Valeurs par defaut:</span>
<a name="l01818"></a>01818 <span class="comment">// Contraintes: reference constante</span>
<a name="l01819"></a>01819 <span class="comment">// Acces: entree</span>
<a name="l01820"></a>01820 <span class="comment">// Exception:</span>
<a name="l01821"></a>01821 <span class="comment">// Effets de bord:</span>
<a name="l01822"></a>01822 <span class="comment">// Postcondition:</span>
<a name="l01823"></a>01823 <span class="comment">//</span>
<a name="l01824"></a>01824 <span class="comment">//</span>
<a name="l01825"></a>01825 <span class="comment">//</span>
<a name="l01826"></a>01826 <span class="comment">//</span><span class="comment"></span>
<a name="l01827"></a>01827 <span class="comment">//! Fonction (hors classe) amie de la classe Matrice_Morse&lt;br&gt;Scaling de la matrice par un scalaire: multiplie tous&lt;br&gt;les elements de la matrice par un scalaire.&lt;br&gt;Operation: renvoie x*A</span>
<a name="l01828"></a>01828 <span class="comment"></span><span class="comment">/** \return Matrice_Morse&lt;br&gt;</span>
<a name="l01829"></a>01829 <span class="comment">Signification: le resultat de l&#39;operation&lt;br&gt;</span>
<a name="l01830"></a>01830 <span class="comment">Contraintes: la matrice resultat est allouee par la fonction */</span>
<a name="l01831"></a><a class="code" href="Matrice__Morse__Sym_8h.html#afc77ba81a0a4335b418508f9bae4941c">01831</a> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> <a class="code" href="Matrice_8cpp.html#afcceccee0de5afbd99c47e2b68752a9f">operator *</a>(<span class="keywordtype">double</span> x , <span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; A)
<a name="l01832"></a>01832 {
<a name="l01833"></a>01833   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> mat_res(A);
<a name="l01834"></a>01834   mat_res.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>*=x;
<a name="l01835"></a>01835   <span class="keywordflow">return</span>(mat_res);
<a name="l01836"></a>01836 }
<a name="l01837"></a>01837 
<a name="l01838"></a>01838 <span class="comment">// Precondition:</span>
<a name="l01839"></a>01839 <span class="comment">// Parametre:</span>
<a name="l01840"></a>01840 <span class="comment">// Signification:</span>
<a name="l01841"></a>01841 <span class="comment">// Valeurs par defaut:</span>
<a name="l01842"></a>01842 <span class="comment">// Contraintes:</span>
<a name="l01843"></a>01843 <span class="comment">// Acces:</span>
<a name="l01844"></a>01844 <span class="comment">// Exception:</span>
<a name="l01845"></a>01845 <span class="comment">// Effets de bord:</span>
<a name="l01846"></a>01846 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l01847"></a>01847 <span class="comment">//</span>
<a name="l01848"></a>01848 <span class="comment">//</span><span class="comment"></span>
<a name="l01849"></a>01849 <span class="comment">//! Operateur de negation unaire, renvoie l&#39;opposee de la matrice: - A&lt;br&gt;Appelle operator*(double,const Matrice_Morse\&amp;)</span>
<a name="l01850"></a>01850 <span class="comment"></span><span class="comment">/** \return Matrice_Morse&lt;br&gt;</span>
<a name="l01851"></a>01851 <span class="comment">Signification: le resultat de l&#39;appel a operator*(double,const Matrice_Morse\&amp;)&lt;br&gt;</span>
<a name="l01852"></a>01852 <span class="comment">Contraintes: */</span>
<a name="l01853"></a><a class="code" href="classMatrice__Morse.html#ad701760e949d89c0c3be1fc768af1a93">01853</a> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> <a class="code" href="classMatrice__Morse.html#ad701760e949d89c0c3be1fc768af1a93" title="Operateur de negation unaire, renvoie l&#39;opposee de la matrice: - A Appelle operator*(double,const Matrice_Morse&amp;)">Matrice_Morse::operator -</a>()<span class="keyword"> const</span>
<a name="l01854"></a>01854 <span class="keyword"></span>{
<a name="l01855"></a>01855   <span class="keywordflow">return</span>((-1)*(*<span class="keyword">this</span>));
<a name="l01856"></a>01856 }
<a name="l01857"></a>01857 
<a name="l01858"></a>01858 
<a name="l01859"></a>01859 <span class="comment">// Precondition:</span>
<a name="l01860"></a>01860 <span class="comment">// Parametre: Matrice_Morse&amp;</span>
<a name="l01861"></a>01861 <span class="comment">// Signification: une matrice morse</span>
<a name="l01862"></a>01862 <span class="comment">// Valeurs par defaut:</span>
<a name="l01863"></a>01863 <span class="comment">// Contraintes: reference constante</span>
<a name="l01864"></a>01864 <span class="comment">// Acces: NON ACCEDE</span>
<a name="l01865"></a>01865 <span class="comment">// Exception:</span>
<a name="l01866"></a>01866 <span class="comment">// Effets de bord:</span>
<a name="l01867"></a>01867 <span class="comment">// Postcondition:</span>
<a name="l01868"></a>01868 <span class="comment">//</span><span class="comment"></span>
<a name="l01869"></a>01869 <span class="comment">//! NE FAIT RIEN</span>
<a name="l01870"></a>01870 <span class="comment"></span><span class="comment">/** \return Matrice_Morse\&amp;&lt;br&gt;</span>
<a name="l01871"></a>01871 <span class="comment">Signification: renvoie toujours *this&lt;br&gt;</span>
<a name="l01872"></a>01872 <span class="comment">Contraintes: */</span>
<a name="l01873"></a><a class="code" href="classMatrice__Morse.html#ac77dbfcd9310f3b356ad3d2766a5f100">01873</a> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; <a class="code" href="classMatrice__Morse.html#ac77dbfcd9310f3b356ad3d2766a5f100" title="NE FAIT RIEN.">Matrice_Morse::operator +=</a>(<span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; A)
<a name="l01874"></a>01874 {
<a name="l01875"></a>01875 <span class="comment">// PL: Avant de verifier de faire des operations couteuses en RAM, on verifie</span>
<a name="l01876"></a>01876 <span class="comment">// si ce n&#39;est pas la meme structure:</span>
<a name="l01877"></a>01877   <span class="keywordflow">if</span> (<a class="code" href="classMatrice__Morse.html#a11eec428fe6de8eeba3113b682dd38f1">has_same_morse_matrix_structure</a>(A))
<a name="l01878"></a>01878     {
<a name="l01879"></a>01879       <span class="keywordtype">int</span> size = A.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>();
<a name="l01880"></a>01880       <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = A.<a class="code" href="classMatrice__Morse.html#aacb80dd518dcc0812e3b34edac6ab67e">get_coeff</a>();
<a name="l01881"></a>01881       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;size; i++)
<a name="l01882"></a>01882         <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(i)+=<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(i);
<a name="l01883"></a>01883     }
<a name="l01884"></a>01884   <span class="keywordflow">else</span>
<a name="l01885"></a>01885     {
<a name="l01886"></a>01886       *<span class="keyword">this</span> = *<span class="keyword">this</span> + A;
<a name="l01887"></a>01887       <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a> = 1;
<a name="l01888"></a>01888     }
<a name="l01889"></a>01889   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l01890"></a>01890 }
<a name="l01891"></a>01891 
<a name="l01892"></a>01892 
<a name="l01893"></a>01893 <span class="comment">// Precondition:</span>
<a name="l01894"></a>01894 <span class="comment">// Parametre: double x</span>
<a name="l01895"></a>01895 <span class="comment">// Signification: le parametre de scaling</span>
<a name="l01896"></a>01896 <span class="comment">// Valeurs par defaut:</span>
<a name="l01897"></a>01897 <span class="comment">// Contraintes:</span>
<a name="l01898"></a>01898 <span class="comment">// Acces:</span>
<a name="l01899"></a>01899 <span class="comment">// Exception:</span>
<a name="l01900"></a>01900 <span class="comment">// Effets de bord:</span>
<a name="l01901"></a>01901 <span class="comment">// Postcondition:</span>
<a name="l01902"></a>01902 <span class="comment">//</span>
<a name="l01903"></a>01903 <span class="comment">//</span>
<a name="l01904"></a>01904 <span class="comment">//</span><span class="comment"></span>
<a name="l01905"></a>01905 <span class="comment">//! Operateur de multiplication (de tous les elements)&lt;br&gt;d&#39;une matrice par un scalaire.&lt;br&gt;Operation: A = x * A</span>
<a name="l01906"></a>01906 <span class="comment"></span><span class="comment">/** \return Matrice_Morse\&amp;&lt;br&gt;</span>
<a name="l01907"></a>01907 <span class="comment">Signification: le resultat de l&#39;operation (*this)&lt;br&gt;</span>
<a name="l01908"></a>01908 <span class="comment">Contraintes: */</span>
<a name="l01909"></a><a class="code" href="classMatrice__Morse.html#a547bc77cbec07f7cb77f180d2a600149">01909</a> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; <a class="code" href="classMatrice__Morse.html#a547bc77cbec07f7cb77f180d2a600149" title="Operateur de multiplication (de tous les elements) d&#39;une matrice par un scalaire. Operation: A = x * ...">Matrice_Morse::operator *=</a>(<span class="keywordtype">double</span> x )
<a name="l01910"></a>01910 {
<a name="l01911"></a>01911   <a class="code" href="classMatrice__Morse.html#a31b1e2dbaae22b47a6908ed7e073fc98">scale</a>( x );
<a name="l01912"></a>01912   <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
<a name="l01913"></a>01913 }
<a name="l01914"></a>01914 
<a name="l01915"></a><a class="code" href="classMatrice__Morse.html#a31b1e2dbaae22b47a6908ed7e073fc98">01915</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#a31b1e2dbaae22b47a6908ed7e073fc98">Matrice_Morse::scale</a>( <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; x )
<a name="l01916"></a>01916 {
<a name="l01917"></a>01917   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> *= x;
<a name="l01918"></a>01918 }
<a name="l01919"></a>01919 
<a name="l01920"></a><a class="code" href="classMatrice__Morse.html#af77867348031b93d7cf4ce63d5718030">01920</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#af77867348031b93d7cf4ce63d5718030">Matrice_Morse::get_stencil</a>( <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; stencil )<span class="keyword"> const</span>
<a name="l01921"></a>01921 <span class="keyword"></span>{
<a name="l01922"></a>01922   <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
<a name="l01923"></a>01923 
<a name="l01924"></a>01924   <span class="keywordflow">if</span>( <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> )
<a name="l01925"></a>01925     {
<a name="l01926"></a>01926       stencil = <a class="code" href="classMatrice__Base.html#af782c401617e7acfef8cab70457f9b55">stencil_</a>;
<a name="l01927"></a>01927       <span class="keywordflow">return</span>;
<a name="l01928"></a>01928     }
<a name="l01929"></a>01929 
<a name="l01930"></a>01930 
<a name="l01931"></a>01931   stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( 0, 2 );
<a name="l01932"></a>01932   stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>(), 2);
<a name="l01933"></a>01933   stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l01934"></a>01934 
<a name="l01935"></a>01935   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> tmp;
<a name="l01936"></a>01936   tmp.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l01937"></a>01937 
<a name="l01938"></a>01938   <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> = 0;
<a name="l01939"></a>01939 
<a name="l01940"></a>01940   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l01941"></a>01941   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
<a name="l01942"></a>01942     {
<a name="l01943"></a>01943       <span class="keywordtype">int</span> k0   = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;
<a name="l01944"></a>01944       <span class="keywordtype">int</span> k1   = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;
<a name="l01945"></a>01945       <span class="keywordtype">int</span> size = k1 - k0;
<a name="l01946"></a>01946 
<a name="l01947"></a>01947       tmp.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>( 0 );
<a name="l01948"></a>01948       tmp.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>( size );
<a name="l01949"></a>01949 
<a name="l01950"></a>01950       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )
<a name="l01951"></a>01951         {
<a name="l01952"></a>01952           tmp[ k ] = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k + k0 ) - 1;
<a name="l01953"></a>01953         }
<a name="l01954"></a>01954 
<a name="l01955"></a>01955       tmp.<a class="code" href="classArrOfInt.html#abb0f48cf5a4be4b70edcc90baaebd521" title="Tri des valeurs du tableau dans l&#39;ordre croissant. La fonction utilisee est qsort de stdlib (elle est...">ordonne_array</a>( );
<a name="l01956"></a>01956 
<a name="l01957"></a>01957       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )
<a name="l01958"></a>01958         {
<a name="l01959"></a>01959           stencil( k+compteur , 0 ) = i;
<a name="l01960"></a>01960           stencil( k+compteur , 1 ) =  tmp[ k ];
<a name="l01961"></a>01961         }
<a name="l01962"></a>01962       compteur += size;
<a name="l01963"></a>01963     }
<a name="l01964"></a>01964 
<a name="l01965"></a>01965   stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 0 );
<a name="l01966"></a>01966 }
<a name="l01967"></a>01967 
<a name="l01968"></a><a class="code" href="classMatrice__Morse.html#a547351090cbce6887a957abb3d081223">01968</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#a547351090cbce6887a957abb3d081223">Matrice_Morse::get_stencil_and_coefficients</a>( <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp;      stencil,
<a name="l01969"></a>01969                                                   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; coefficients )<span class="keyword"> const</span>
<a name="l01970"></a>01970 <span class="keyword"></span>{
<a name="l01971"></a>01971   <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">assert_check_morse_matrix_structure</a>( );
<a name="l01972"></a>01972 
<a name="l01973"></a>01973   <span class="keywordflow">if</span>( <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a> )
<a name="l01974"></a>01974     {
<a name="l01975"></a>01975       <span class="keywordflow">if</span>( <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>( ) == 0 )
<a name="l01976"></a>01976         {
<a name="l01977"></a>01977           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Matrice_Morse::get_stencil_and_coefficients( )&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01978"></a>01978           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  The coefficients are not filled.&quot;</span>&lt;&lt;finl;
<a name="l01979"></a>01979           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  Aborting...&quot;</span> &lt;&lt; finl;
<a name="l01980"></a>01980           <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">Process::abort</a>( );
<a name="l01981"></a>01981         }
<a name="l01982"></a>01982       stencil = <a class="code" href="classMatrice__Base.html#af782c401617e7acfef8cab70457f9b55">stencil_</a> ;
<a name="l01983"></a>01983       coefficients = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a> ;
<a name="l01984"></a>01984       <span class="keywordflow">return</span>;
<a name="l01985"></a>01985     }
<a name="l01986"></a>01986 
<a name="l01987"></a>01987   stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( 0, 2 );
<a name="l01988"></a>01988   stencil.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>(), 2);
<a name="l01989"></a>01989   stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l01990"></a>01990 
<a name="l01991"></a>01991   coefficients.<a class="code" href="classArrOfDouble.html#aa5d7035f2e4f451c484aabd5dffb873b" title="appel a ArrOfDouble::resize_array()">resize</a>( 0 );
<a name="l01992"></a>01992   coefficients.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l01993"></a>01993   coefficients.<a class="code" href="classArrOfDouble.html#aa5d7035f2e4f451c484aabd5dffb873b" title="appel a ArrOfDouble::resize_array()">resize</a>(<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>());
<a name="l01994"></a>01994 
<a name="l01995"></a>01995   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> tmp1(0);
<a name="l01996"></a>01996   tmp1.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l01997"></a>01997 
<a name="l01998"></a>01998   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> tmp2;
<a name="l01999"></a>01999   tmp2.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l02000"></a>02000 
<a name="l02001"></a>02001   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> index;
<a name="l02002"></a>02002   index.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 1 );
<a name="l02003"></a>02003 
<a name="l02004"></a>02004   <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> = 0;
<a name="l02005"></a>02005 
<a name="l02006"></a>02006   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l02007"></a>02007   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
<a name="l02008"></a>02008     {
<a name="l02009"></a>02009       <span class="keywordtype">int</span> k0   = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;
<a name="l02010"></a>02010       <span class="keywordtype">int</span> k1   = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;
<a name="l02011"></a>02011       <span class="keywordtype">int</span> size = k1 - k0;
<a name="l02012"></a>02012 
<a name="l02013"></a>02013       tmp1.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( 0 );
<a name="l02014"></a>02014       tmp1.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>( size );
<a name="l02015"></a>02015 
<a name="l02016"></a>02016       tmp2.<a class="code" href="classArrOfDouble.html#a610464f4b3dccac6f814915b526783ed">resize_array</a>( 0 );
<a name="l02017"></a>02017       tmp2.<a class="code" href="classArrOfDouble.html#a610464f4b3dccac6f814915b526783ed">resize_array</a>( size );
<a name="l02018"></a>02018 
<a name="l02019"></a>02019       index.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>( 0 );
<a name="l02020"></a>02020 
<a name="l02021"></a>02021       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )
<a name="l02022"></a>02022         {
<a name="l02023"></a>02023           tmp1( k ) = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k + k0 ) - 1;
<a name="l02024"></a>02024           tmp2[ k ] = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>( k + k0 );
<a name="l02025"></a>02025         }
<a name="l02026"></a>02026 
<a name="l02027"></a>02027       <a class="code" href="Array__tools_8cpp.html#ad62171ccb6e8fd4b2be47d286c164999" title="Idem que tri_lexicographique_tableau mais on trie le tableau index qui contient les indices de lignes...">tri_lexicographique_tableau_indirect</a>( tmp1, index );
<a name="l02028"></a>02028 
<a name="l02029"></a>02029       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0; k&lt;size; ++k )
<a name="l02030"></a>02030         {
<a name="l02031"></a>02031           <span class="keywordtype">int</span> l = index[ k ];
<a name="l02032"></a>02032           stencil( compteur + k , 0 ) = i;
<a name="l02033"></a>02033           stencil( compteur + k , 1 ) = tmp1[ l ];
<a name="l02034"></a>02034           coefficients[ compteur + k ] = tmp2[ l ];
<a name="l02035"></a>02035         }
<a name="l02036"></a>02036       compteur += size;
<a name="l02037"></a>02037     }
<a name="l02038"></a>02038 
<a name="l02039"></a>02039   assert( coefficients.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>( ) == stencil.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>( 0 ));
<a name="l02040"></a>02040 
<a name="l02041"></a>02041   stencil.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 0 );
<a name="l02042"></a>02042 
<a name="l02043"></a>02043   coefficients.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>( 0 );
<a name="l02044"></a>02044 }
<a name="l02045"></a>02045 
<a name="l02046"></a>02046 <span class="comment">// Precondition:</span>
<a name="l02047"></a>02047 <span class="comment">// Parametre: double x</span>
<a name="l02048"></a>02048 <span class="comment">// Signification: le parametre de scaling</span>
<a name="l02049"></a>02049 <span class="comment">// Valeurs par defaut:</span>
<a name="l02050"></a>02050 <span class="comment">// Contraintes: x doit etre different de zero</span>
<a name="l02051"></a>02051 <span class="comment">// Acces:</span>
<a name="l02052"></a>02052 <span class="comment">// Exception: division par zero impossible</span>
<a name="l02053"></a>02053 <span class="comment">// Effets de bord:</span>
<a name="l02054"></a>02054 <span class="comment">// Postcondition:</span>
<a name="l02055"></a>02055 <span class="comment">//</span>
<a name="l02056"></a>02056 <span class="comment">//</span>
<a name="l02057"></a>02057 <span class="comment">//</span><span class="comment"></span>
<a name="l02058"></a>02058 <span class="comment">//! Operateur de division (de tous les elements)&lt;br&gt;d&#39;une matrice par un scalaire.&lt;br&gt;Operation: A =  A / x</span>
<a name="l02059"></a>02059 <span class="comment"></span><span class="comment">/** \return Matrice_Morse\&amp;&lt;br&gt;</span>
<a name="l02060"></a>02060 <span class="comment">Signification: le resultat de l&#39;operation (*this)&lt;br&gt;</span>
<a name="l02061"></a>02061 <span class="comment">Contraintes: */</span>
<a name="l02062"></a><a class="code" href="classMatrice__Morse.html#a6e0753ddc2866580a7716588fafff24e">02062</a> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; <a class="code" href="classMatrice__Morse.html#a6e0753ddc2866580a7716588fafff24e" title="Operateur de division (de tous les elements) d&#39;une matrice par un scalaire. Operation: A = A / x...">Matrice_Morse::operator /=</a>(<span class="keywordtype">double</span> x )
<a name="l02063"></a>02063 {
<a name="l02064"></a>02064   <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>/=x;
<a name="l02065"></a>02065   <span class="keywordflow">return</span>(*<span class="keyword">this</span>);
<a name="l02066"></a>02066 }
<a name="l02067"></a>02067 
<a name="l02068"></a><a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">02068</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">Matrice_Morse::remplir</a>(<span class="keyword">const</span> <a class="code" href="classIntLists.html" title="Un tableau de listes de type IntList.">IntLists</a>&amp; voisins,
<a name="l02069"></a>02069                             <span class="keyword">const</span> <a class="code" href="classDoubleLists.html" title="Un tableau de listes de type DoubleList.">DoubleLists</a>&amp; valeurs,
<a name="l02070"></a>02070                             <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; terme_diag)
<a name="l02071"></a>02071 {
<a name="l02072"></a>02072 
<a name="l02073"></a>02073   <span class="keywordtype">int</span> num_elem;
<a name="l02074"></a>02074   <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>,rang =0;
<a name="l02075"></a>02075 
<a name="l02076"></a>02076 <span class="comment">// Remplissage des tableaux tab1, tab2 et coeff_ :</span>
<a name="l02077"></a>02077   <span class="keywordtype">int</span>* p_tab1 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l02078"></a>02078   <span class="keywordtype">int</span>* p_tab2 = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l02079"></a>02079   <span class="keywordtype">double</span>* p_coeff = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l02080"></a>02080 
<a name="l02081"></a>02081   <span class="keywordtype">int</span>* tab2_ptr = p_tab2;
<a name="l02082"></a>02082   <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l02083"></a>02083 
<a name="l02084"></a>02084   <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;n; num_elem++)
<a name="l02085"></a>02085     {
<a name="l02086"></a>02086 
<a name="l02087"></a>02087       <a class="code" href="classIntList__Curseur.html" title="List_Curseur de reels int precision.">IntList_Curseur</a> liste_vois(voisins[num_elem]);
<a name="l02088"></a>02088       <a class="code" href="classDoubleList__Curseur.html" title="List_Curseur de reels double precision.">DoubleList_Curseur</a> liste_val(valeurs[num_elem]);
<a name="l02089"></a>02089       compteur =0;
<a name="l02090"></a>02090       *p_tab1++ = rang;
<a name="l02091"></a>02091 
<a name="l02092"></a>02092       *tab2_ptr++=num_elem;
<a name="l02093"></a>02093       *p_coeff++ = terme_diag[num_elem];
<a name="l02094"></a>02094 
<a name="l02095"></a>02095       <span class="keywordflow">while</span>  (liste_vois)
<a name="l02096"></a>02096         {
<a name="l02097"></a>02097           *tab2_ptr++ = liste_vois.<a class="code" href="classIntList__Curseur.html#a1c1121b2d0e2b29c02e121543ab728e8" title="retourne la valeur du curseur">valeur</a>();
<a name="l02098"></a>02098           *p_coeff++ = liste_val.<a class="code" href="classDoubleList__Curseur.html#a8f638e9787561d19ce78872be34014e4" title="retourne la valeur du curseur">valeur</a>();
<a name="l02099"></a>02099           ++liste_vois;
<a name="l02100"></a>02100           ++liste_val;
<a name="l02101"></a>02101           compteur++;
<a name="l02102"></a>02102         }
<a name="l02103"></a>02103 <span class="comment">// tab2[rang] = compteur;</span>
<a name="l02104"></a>02104       rang += (compteur + 1);
<a name="l02105"></a>02105     }
<a name="l02106"></a>02106   <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(num_elem)=rang;
<a name="l02107"></a>02107   <a class="code" href="classMatrice__Morse.html#a3bcd59ac30cd776ea695a8c8f2d2776d">formeF</a>();
<a name="l02108"></a>02108   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l02109"></a>02109   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;
<a name="l02110"></a>02110 }
<a name="l02111"></a>02111 
<a name="l02112"></a><a class="code" href="classMatrice__Morse.html#a0477806560509033e4b46b0b65ac6deb">02112</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">Matrice_Morse::remplir</a>(<span class="keyword">const</span> <a class="code" href="classIntLists.html" title="Un tableau de listes de type IntList.">IntLists</a>&amp; voisins,
<a name="l02113"></a>02113                             <span class="keyword">const</span> <a class="code" href="classDoubleLists.html" title="Un tableau de listes de type DoubleList.">DoubleLists</a>&amp; valeurs)
<a name="l02114"></a>02114 {
<a name="l02115"></a>02115 
<a name="l02116"></a>02116   <span class="keywordtype">int</span> num_elem;
<a name="l02117"></a>02117   <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>,rang =0;
<a name="l02118"></a>02118 
<a name="l02119"></a>02119 <span class="comment">// Remplissage des tableaux tab1, tab2 et coeff_ :</span>
<a name="l02120"></a>02120   <span class="keywordtype">int</span>* p_tab1 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l02121"></a>02121   <span class="keywordtype">int</span>* p_tab2 = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l02122"></a>02122   <span class="keywordtype">double</span>* p_coeff = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l02123"></a>02123 
<a name="l02124"></a>02124   <span class="keywordtype">int</span>* tab2_ptr = p_tab2;
<a name="l02125"></a>02125   <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l02126"></a>02126 
<a name="l02127"></a>02127   <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;n; num_elem++)
<a name="l02128"></a>02128     {
<a name="l02129"></a>02129 
<a name="l02130"></a>02130       <a class="code" href="classIntList__Curseur.html" title="List_Curseur de reels int precision.">IntList_Curseur</a> liste_vois(voisins[num_elem]);
<a name="l02131"></a>02131       <a class="code" href="classDoubleList__Curseur.html" title="List_Curseur de reels double precision.">DoubleList_Curseur</a> liste_val(valeurs[num_elem]);
<a name="l02132"></a>02132       compteur =0;
<a name="l02133"></a>02133       *p_tab1++ = rang;
<a name="l02134"></a>02134 
<a name="l02135"></a>02135       <span class="keywordflow">while</span>  (liste_vois)
<a name="l02136"></a>02136         {
<a name="l02137"></a>02137           *tab2_ptr++ = liste_vois.<a class="code" href="classIntList__Curseur.html#a1c1121b2d0e2b29c02e121543ab728e8" title="retourne la valeur du curseur">valeur</a>();
<a name="l02138"></a>02138           *p_coeff++ = liste_val.<a class="code" href="classDoubleList__Curseur.html#a8f638e9787561d19ce78872be34014e4" title="retourne la valeur du curseur">valeur</a>();
<a name="l02139"></a>02139           ++liste_vois;
<a name="l02140"></a>02140           ++liste_val;
<a name="l02141"></a>02141           compteur++;
<a name="l02142"></a>02142         }
<a name="l02143"></a>02143 <span class="comment">// tab2[rang] = compteur;</span>
<a name="l02144"></a>02144       rang += (<a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>);
<a name="l02145"></a>02145     }
<a name="l02146"></a>02146   <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(num_elem)=rang;
<a name="l02147"></a>02147   <a class="code" href="classMatrice__Morse.html#a3bcd59ac30cd776ea695a8c8f2d2776d">formeF</a>();
<a name="l02148"></a>02148   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l02149"></a>02149   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;
<a name="l02150"></a>02150 }
<a name="l02151"></a>02151 
<a name="l02152"></a>02152 <span class="comment">//</span><span class="comment"></span>
<a name="l02153"></a>02153 <span class="comment">//! Remplissage d&#39;une matrice morse par une matrice morse plus petite</span>
<a name="l02154"></a><a class="code" href="classMatrice__Morse.html#a0b13859051ee9505b3beb82ceb94c116">02154</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#aedf08423430f9c0b1a9a967d6bb80c9d">Matrice_Morse::remplir</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> ideb, <span class="keyword">const</span> <span class="keywordtype">int</span> jdeb, <span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> m, <span class="keyword">const</span> <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; mat)
<a name="l02155"></a>02155 {
<a name="l02156"></a>02156 <span class="comment">// Verification</span>
<a name="l02157"></a>02157   assert(ideb&lt;=n);
<a name="l02158"></a>02158   assert(jdeb&lt;=m);
<a name="l02159"></a>02159 
<a name="l02160"></a>02160 <span class="comment">// On va construire une matrice locale</span>
<a name="l02161"></a>02161   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> matrice_locale(mat);
<a name="l02162"></a>02162 <span class="comment">// Cas ou la matrice locale est symetrique</span>
<a name="l02163"></a>02163   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a>,mat))
<a name="l02164"></a>02164     {
<a name="l02165"></a>02165 <span class="comment">// Creation de la partie inferieure L</span>
<a name="l02166"></a>02166       <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> L(matrice_locale);
<a name="l02167"></a>02167       L.<a class="code" href="classMatrice__Morse.html#a9859a88c59daf0b968b3c5090e18f264" title="*this = a transposee.">transpose</a>(matrice_locale);
<a name="l02168"></a>02168       <span class="keywordtype">int</span> lordre = L.<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>();
<a name="l02169"></a>02169       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;lordre; i++)
<a name="l02170"></a>02170         L(i, i) = 0.;
<a name="l02171"></a>02171 <span class="comment">// On ajoute M=U+L</span>
<a name="l02172"></a>02172       matrice_locale += L;
<a name="l02173"></a>02173     }
<a name="l02174"></a>02174 
<a name="l02175"></a>02175 <span class="comment">// Dimensionnement de la matrice globale</span>
<a name="l02176"></a>02176   <span class="keywordtype">int</span> nnz=matrice_locale.<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>();
<a name="l02177"></a>02177   <a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(n,m,nnz);
<a name="l02178"></a>02178 
<a name="l02179"></a>02179 <span class="comment">// Remplissage de la matrice globale par la matrice locale:</span>
<a name="l02180"></a>02180 <span class="comment">// Remplissage de tab1_ avec le decalage par ideb:</span>
<a name="l02181"></a>02181   <span class="keywordtype">int</span> mon_nb_lignes=matrice_locale.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l02182"></a>02182   assert(mon_nb_lignes+ideb&lt;=n);
<a name="l02183"></a>02183   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ideb; i++)
<a name="l02184"></a>02184     <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)=1;
<a name="l02185"></a>02185   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;mon_nb_lignes; i++)
<a name="l02186"></a>02186     <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i+ideb)=matrice_locale.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i);
<a name="l02187"></a>02187   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=mon_nb_lignes+ideb; i&lt;n+1; i++)
<a name="l02188"></a>02188     <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(i)=matrice_locale.<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(mon_nb_lignes);
<a name="l02189"></a>02189 
<a name="l02190"></a>02190 <span class="comment">// Remplissage de tab2_ avec le decalage par jdeb:</span>
<a name="l02191"></a>02191   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nnz; i++)
<a name="l02192"></a>02192     <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(i)=matrice_locale.<a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(i)+jdeb;
<a name="l02193"></a>02193 
<a name="l02194"></a>02194 <span class="comment">// Remplissage de coeff_:</span>
<a name="l02195"></a>02195   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nnz; i++)
<a name="l02196"></a>02196     <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(i)=matrice_locale.<a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(i);
<a name="l02197"></a>02197 
<a name="l02198"></a>02198   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l02199"></a>02199   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;
<a name="l02200"></a>02200 }
<a name="l02201"></a>02201 
<a name="l02202"></a><a class="code" href="classMatrice__Morse.html#a8bafab20c667e1bed56a463ffb30e349">02202</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#a8bafab20c667e1bed56a463ffb30e349">Matrice_Morse::formeC</a>()
<a name="l02203"></a>02203 {
<a name="l02204"></a>02204   <span class="keywordtype">int</span> ii, k;
<a name="l02205"></a>02205   <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l02206"></a>02206   <span class="keywordflow">for</span>( ii=0; ii&lt;=n; ii++)
<a name="l02207"></a>02207     <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(ii)--;
<a name="l02208"></a>02208   <span class="keywordflow">for</span>( ii=0; ii&lt;n; ii++)
<a name="l02209"></a>02209     <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(ii))=<a class="code" href="classMatrice__Morse.html#aebca6e5632d935408e1f81674209a86c">nb_vois</a>(ii);
<a name="l02210"></a>02210   <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>(); k++)
<a name="l02211"></a>02211     <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)--;
<a name="l02212"></a>02212   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l02213"></a>02213   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;
<a name="l02214"></a>02214 }
<a name="l02215"></a>02215 
<a name="l02216"></a><a class="code" href="classMatrice__Morse.html#a3bcd59ac30cd776ea695a8c8f2d2776d">02216</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#a3bcd59ac30cd776ea695a8c8f2d2776d">Matrice_Morse::formeF</a>()
<a name="l02217"></a>02217 {
<a name="l02218"></a>02218   <span class="keywordtype">int</span> ii, k;
<a name="l02219"></a>02219   <span class="keywordtype">int</span> n=<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>();
<a name="l02220"></a>02220   <span class="keywordflow">for</span>( ii=0; ii&lt;=n; ii++)
<a name="l02221"></a>02221     <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(ii)++;
<a name="l02222"></a>02222   <span class="keywordflow">for</span>(k=0; k&lt;<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>(); k++)
<a name="l02223"></a>02223     <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(k)++;
<a name="l02224"></a>02224   <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=1;
<a name="l02225"></a>02225   <a class="code" href="classMatrice__Base.html#a557834907ba7acfb9338272ac243888a">is_stencil_up_to_date_</a>=<span class="keyword">false</span>;
<a name="l02226"></a>02226 }
<a name="l02227"></a>02227 
<a name="l02228"></a>02228 
<a name="l02229"></a>02229 
<a name="l02230"></a>02230 
<a name="l02231"></a>02231 <span class="comment">// Precondition:</span>
<a name="l02232"></a>02232 <span class="comment">// Parametre:</span>
<a name="l02233"></a>02233 <span class="comment">// Signification:</span>
<a name="l02234"></a>02234 <span class="comment">// Valeurs par defaut:</span>
<a name="l02235"></a>02235 <span class="comment">// Contraintes:</span>
<a name="l02236"></a>02236 <span class="comment">// Acces:</span>
<a name="l02237"></a>02237 <span class="comment">// Exception:</span>
<a name="l02238"></a>02238 <span class="comment">// Effets de bord:</span>
<a name="l02239"></a>02239 <span class="comment">// Postcondition:</span>
<a name="l02240"></a>02240 <span class="comment">//</span><span class="comment"></span>
<a name="l02241"></a>02241 <span class="comment">//! NE FAIT RIEN</span>
<a name="l02242"></a>02242 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l02243"></a>02243 <span class="comment">Signification: renvoie toujours 1&lt;br&gt;</span>
<a name="l02244"></a>02244 <span class="comment">Contraintes: */</span>
<a name="l02245"></a><a class="code" href="Matrice__Morse_8h.html#a12a6ca74ab7a7c08a8eff461782112c6">02245</a> <span class="keywordtype">int</span> <a class="code" href="Matrice__Morse_8cpp.html#a12a6ca74ab7a7c08a8eff461782112c6" title="NE FAIT RIEN.">Matrice_Morse_test</a>()
<a name="l02246"></a>02246 {
<a name="l02247"></a>02247   <span class="keywordflow">return</span> 1;
<a name="l02248"></a>02248 }
<a name="l02249"></a>02249 
<a name="l02250"></a>02250 <span class="comment">// Precondition:</span>
<a name="l02251"></a>02251 <span class="comment">// Parametre:</span>
<a name="l02252"></a>02252 <span class="comment">// Signification:</span>
<a name="l02253"></a>02253 <span class="comment">// Valeurs par defaut:</span>
<a name="l02254"></a>02254 <span class="comment">// Contraintes:</span>
<a name="l02255"></a>02255 <span class="comment">// Acces:</span>
<a name="l02256"></a>02256 <span class="comment">// Exception:</span>
<a name="l02257"></a>02257 <span class="comment">// Effets de bord:</span>
<a name="l02258"></a>02258 <span class="comment">// Postcondition:</span>
<a name="l02259"></a>02259 <span class="comment">//</span><span class="comment"></span>
<a name="l02260"></a>02260 <span class="comment">//! Remplit la matrice avec des zeros.</span>
<a name="l02261"></a>02261 <span class="comment"></span><span class="comment">/** \return void&lt;br&gt;</span>
<a name="l02262"></a>02262 <span class="comment">Signification:&lt;br&gt;</span>
<a name="l02263"></a>02263 <span class="comment">Contraintes: */</span>
<a name="l02264"></a>02264 
<a name="l02265"></a><a class="code" href="classMatrice__Morse.html#a3fe9dc9cd6e414e6781b2dcba28acf1f">02265</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#a3fe9dc9cd6e414e6781b2dcba28acf1f" title="Remplit la matrice avec des zeros.">Matrice_Morse::clean</a>()
<a name="l02266"></a>02266 {
<a name="l02267"></a>02267   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classMatrice__Morse.html#afb2d730697791b429d020575ae3388d0">nb_coeff</a>(); i++)
<a name="l02268"></a>02268     <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>[i]=0.;
<a name="l02269"></a>02269 }
<a name="l02270"></a>02270 
<a name="l02271"></a>02271 <span class="comment">// Precondition:</span>
<a name="l02272"></a>02272 <span class="comment">// Parametre:</span>
<a name="l02273"></a>02273 <span class="comment">// </span>
<a name="l02274"></a>02274 <span class="comment">// Signification:</span>
<a name="l02275"></a>02275 <span class="comment">// Contraintes:</span>
<a name="l02276"></a>02276 <span class="comment">// Exception:</span>
<a name="l02277"></a>02277 <span class="comment">// Effets de bord:</span>
<a name="l02278"></a>02278 <span class="comment">// Postcondition:</span>
<a name="l02279"></a>02279 <span class="comment">//</span><span class="comment"></span>
<a name="l02280"></a>02280 <span class="comment">//! Calcule la largeur de bande d&#39;une matrice morse</span>
<a name="l02281"></a><a class="code" href="classMatrice__Morse.html#a95c8d6e95a8ad58710856f60bf07cd43">02281</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classMatrice__Morse.html#a95c8d6e95a8ad58710856f60bf07cd43" title="Retourne la largeur de bande.">Matrice_Morse::largeur_de_bande</a>()<span class="keyword"> const</span>
<a name="l02282"></a>02282 <span class="keyword"></span>{
<a name="l02283"></a>02283   <span class="keywordtype">int</span> ldist,<a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a> = 0;
<a name="l02284"></a>02284   <span class="keyword">const</span> <span class="keywordtype">int</span>* p_tab1_ = <a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l02285"></a>02285   <span class="keyword">const</span> <span class="keywordtype">int</span>* p_tab2_ = <a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>().<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l02286"></a>02286   <span class="keywordtype">int</span> N=<a class="code" href="classMatrice__Morse.html#a24a51a119cc5068408773a983ce5f13a" title="Renvoie l&#39;ordre de la matrice: - le nombre de lignes si la matrice est carree - 0 sinon...">ordre</a>();
<a name="l02287"></a>02287 
<a name="l02288"></a>02288   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;N; i++)
<a name="l02289"></a>02289     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = p_tab1_[i]; k &lt; p_tab1_[i+1]; k++)
<a name="l02290"></a>02290       {
<a name="l02291"></a>02291         <span class="keywordflow">if</span> (p_tab2_[k-1]-1&lt;N)
<a name="l02292"></a>02292           {
<a name="l02293"></a>02293             ldist = p_tab2_[k-1] - i;
<a name="l02294"></a>02294             <span class="keywordflow">if</span>( min &lt; ldist ) min = ldist;
<a name="l02295"></a>02295           }
<a name="l02296"></a>02296       };
<a name="l02297"></a>02297   <span class="keywordflow">return</span> <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>;
<a name="l02298"></a>02298 }
<a name="l02299"></a>02299 
<a name="l02300"></a><a class="code" href="classMatrice__Morse.html#a8852df62bb7604061e8a7873bebddda4">02300</a> <span class="keywordtype">bool</span> <a class="code" href="classMatrice__Morse.html#a8852df62bb7604061e8a7873bebddda4">Matrice_Morse::check_morse_matrix_structure</a>( <span class="keywordtype">void</span> )<span class="keyword"> const</span>
<a name="l02301"></a>02301 <span class="keyword"></span>{
<a name="l02302"></a>02302   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines   = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l02303"></a>02303   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_columns = <a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>( );
<a name="l02304"></a>02304   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_coefficients = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( nb_lines ) - 1;
<a name="l02305"></a>02305 
<a name="l02306"></a>02306   <span class="keywordflow">if</span> ( <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>( ) != nb_coefficients )
<a name="l02307"></a>02307     {
<a name="l02308"></a>02308       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid tab2 size&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02309"></a>02309       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02310"></a>02310     }
<a name="l02311"></a>02311 
<a name="l02312"></a>02312   <span class="keywordflow">if</span> ( <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>( ) != nb_coefficients )
<a name="l02313"></a>02313     {
<a name="l02314"></a>02314       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid coeff size&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02315"></a>02315       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02316"></a>02316     }
<a name="l02317"></a>02317 
<a name="l02318"></a>02318   <a class="code" href="classArrOfBit.html">ArrOfBit</a> flags( nb_columns );
<a name="l02319"></a>02319 
<a name="l02320"></a>02320   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
<a name="l02321"></a>02321     {
<a name="l02322"></a>02322       flags = 0;
<a name="l02323"></a>02323 
<a name="l02324"></a>02324       <span class="keywordtype">int</span> k0 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;
<a name="l02325"></a>02325       <span class="keywordtype">int</span> k1 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;
<a name="l02326"></a>02326 
<a name="l02327"></a>02327       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=k0; k&lt;k1; ++k )
<a name="l02328"></a>02328         {
<a name="l02329"></a>02329           <span class="keywordtype">int</span> j = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k ) - 1;
<a name="l02330"></a>02330 
<a name="l02331"></a>02331           <span class="keywordflow">if</span> ( j &lt; 0 )
<a name="l02332"></a>02332             {
<a name="l02333"></a>02333               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid column index (&lt;0): &quot;</span> &lt;&lt; j &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02334"></a>02334               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02335"></a>02335             }
<a name="l02336"></a>02336 
<a name="l02337"></a>02337           <span class="keywordflow">if</span> ( j &gt;= nb_columns )
<a name="l02338"></a>02338             {
<a name="l02339"></a>02339               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid column index (&gt;nb_cols): &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span> &lt;&lt; nb_columns &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02340"></a>02340               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02341"></a>02341             }
<a name="l02342"></a>02342 
<a name="l02343"></a>02343           <span class="keywordflow">if</span> ( flags[ j ] )
<a name="l02344"></a>02344             {
<a name="l02345"></a>02345               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid coefficient ( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; ): already defined ( &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02346"></a>02346               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02347"></a>02347             }
<a name="l02348"></a>02348 
<a name="l02349"></a>02349           flags.<a class="code" href="classArrOfBit.html#a5c339cfd9dea141737e127131e52aaae" title="Met le bit e a 1.">setbit</a>( j );
<a name="l02350"></a>02350         }
<a name="l02351"></a>02351     }
<a name="l02352"></a>02352 
<a name="l02353"></a>02353   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02354"></a>02354 }
<a name="l02355"></a>02355 
<a name="l02356"></a><a class="code" href="classMatrice__Morse.html#a16be4586cacf33093dcd6a8fd804f7f0">02356</a> <span class="keywordtype">bool</span> <a class="code" href="classMatrice__Morse.html#a16be4586cacf33093dcd6a8fd804f7f0">Matrice_Morse::check_sorted_morse_matrix_structure</a>( <span class="keywordtype">void</span> )<span class="keyword"> const</span>
<a name="l02357"></a>02357 <span class="keyword"></span>{
<a name="l02358"></a>02358   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lines   = <a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>( );
<a name="l02359"></a>02359   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_columns = <a class="code" href="classMatrice__Morse.html#a94caf9937bc5a110a7179cb3e9eaa9d9">nb_colonnes</a>( );
<a name="l02360"></a>02360   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_coefficients = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( nb_lines ) - 1;
<a name="l02361"></a>02361 
<a name="l02362"></a>02362   <span class="keywordflow">if</span> ( <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>( ) != nb_coefficients )
<a name="l02363"></a>02363     {
<a name="l02364"></a>02364       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid tab2 size&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02365"></a>02365       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02366"></a>02366     }
<a name="l02367"></a>02367 
<a name="l02368"></a>02368   <span class="keywordflow">if</span> ( <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>( ) != nb_coefficients )
<a name="l02369"></a>02369     {
<a name="l02370"></a>02370       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid coeff size&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02371"></a>02371       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02372"></a>02372     }
<a name="l02373"></a>02373 
<a name="l02374"></a>02374   <a class="code" href="classArrOfBit.html">ArrOfBit</a> flags( nb_columns );
<a name="l02375"></a>02375 
<a name="l02376"></a>02376   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;nb_lines; ++i )
<a name="l02377"></a>02377     {
<a name="l02378"></a>02378       flags = 0;
<a name="l02379"></a>02379 
<a name="l02380"></a>02380       <span class="keywordtype">int</span> k0 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i ) - 1;
<a name="l02381"></a>02381       <span class="keywordtype">int</span> k1 = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>( i + 1 ) - 1;
<a name="l02382"></a>02382 
<a name="l02383"></a>02383       <span class="keywordtype">int</span> j0 = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k0 ) - 1 - 1;
<a name="l02384"></a>02384 
<a name="l02385"></a>02385       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=k0; k&lt;k1; ++k )
<a name="l02386"></a>02386         {
<a name="l02387"></a>02387           <span class="keywordtype">int</span> j = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>( k ) - 1;
<a name="l02388"></a>02388 
<a name="l02389"></a>02389           <span class="keywordflow">if</span> ( j &lt; 0 )
<a name="l02390"></a>02390             {
<a name="l02391"></a>02391               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid column index (&lt;0): &quot;</span> &lt;&lt; j &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02392"></a>02392               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02393"></a>02393             }
<a name="l02394"></a>02394 
<a name="l02395"></a>02395           <span class="keywordflow">if</span> ( j &gt;= nb_columns )
<a name="l02396"></a>02396             {
<a name="l02397"></a>02397               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid column index (&gt;nb_cols): &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &gt; &quot;</span> &lt;&lt; nb_columns &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02398"></a>02398               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02399"></a>02399             }
<a name="l02400"></a>02400 
<a name="l02401"></a>02401           <span class="keywordflow">if</span> ( flags[ j ] )
<a name="l02402"></a>02402             {
<a name="l02403"></a>02403               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;invalid coefficient ( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; ): already defined ( &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02404"></a>02404               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02405"></a>02405             }
<a name="l02406"></a>02406 
<a name="l02407"></a>02407           <span class="keywordflow">if</span> ( j &lt;= j0 )
<a name="l02408"></a>02408             {
<a name="l02409"></a>02409               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;unsorted coefficient: ( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; ) after ( &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; j0 &lt;&lt; <span class="stringliteral">&quot; ) &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;;
<a name="l02410"></a>02410               <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l02411"></a>02411             }
<a name="l02412"></a>02412 
<a name="l02413"></a>02413           j0 = j;
<a name="l02414"></a>02414           flags.<a class="code" href="classArrOfBit.html#a5c339cfd9dea141737e127131e52aaae" title="Met le bit e a 1.">setbit</a>( j );
<a name="l02415"></a>02415         }
<a name="l02416"></a>02416     }
<a name="l02417"></a>02417 
<a name="l02418"></a>02418   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l02419"></a>02419 }
<a name="l02420"></a>02420 
<a name="l02421"></a>02421 
<a name="l02422"></a><a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">02422</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#a94b178d1ca13742303c6cead98ab6332">Matrice_Morse::assert_check_morse_matrix_structure</a>( <span class="keywordtype">void</span> )<span class="keyword"> const</span>
<a name="l02423"></a>02423 <span class="keyword"></span>{
<a name="l02424"></a>02424   <span class="keywordflow">if</span> (!<a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>) <span class="keywordflow">return</span>;
<a name="l02425"></a>02425 <span class="preprocessor">#ifndef NDEBUG</span>
<a name="l02426"></a>02426 <span class="preprocessor"></span>  <span class="keywordflow">if</span> ( ! ( <a class="code" href="classMatrice__Morse.html#a8852df62bb7604061e8a7873bebddda4">check_morse_matrix_structure</a>( ) ) )
<a name="l02427"></a>02427     {
<a name="l02428"></a>02428       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in &#39;Matrice_Morse::assert_check_morse_matrix_structure( )&#39;:&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02429"></a>02429       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  Exiting...&quot;</span> &lt;&lt; finl;
<a name="l02430"></a>02430       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>( );
<a name="l02431"></a>02431     }
<a name="l02432"></a>02432   <span class="keywordflow">else</span>
<a name="l02433"></a>02433     <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=0;
<a name="l02434"></a>02434 <span class="preprocessor">#endif</span>
<a name="l02435"></a>02435 <span class="preprocessor"></span>}
<a name="l02436"></a>02436 
<a name="l02437"></a><a class="code" href="classMatrice__Morse.html#a4f6d3b49c29109b73048a7ba84cf543f">02437</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#a4f6d3b49c29109b73048a7ba84cf543f">Matrice_Morse::assert_check_sorted_morse_matrix_structure</a>( <span class="keywordtype">void</span> )<span class="keyword"> const</span>
<a name="l02438"></a>02438 <span class="keyword"></span>{
<a name="l02439"></a>02439   <span class="keywordflow">if</span> (!<a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>) <span class="keywordflow">return</span>;
<a name="l02440"></a>02440 <span class="preprocessor">#ifndef NDEBUG</span>
<a name="l02441"></a>02441 <span class="preprocessor"></span>  <span class="keywordflow">if</span> ( ! ( <a class="code" href="classMatrice__Morse.html#a16be4586cacf33093dcd6a8fd804f7f0">check_sorted_morse_matrix_structure</a>( ) ) )
<a name="l02442"></a>02442     {
<a name="l02443"></a>02443       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in &#39;Matrice_Morse::assert_check_sorted_morse_matrix_structure( )&#39;:&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02444"></a>02444       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;  Exiting...&quot;</span> &lt;&lt; finl;
<a name="l02445"></a>02445       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>( );
<a name="l02446"></a>02446     }
<a name="l02447"></a>02447   <span class="keywordflow">else</span>
<a name="l02448"></a>02448     <a class="code" href="classMatrice__Morse.html#a1a9134b16e927cd79db6e6d75a15a312" title="Flag if matrix structure changes.">morse_matrix_structure_has_changed_</a>=0;
<a name="l02449"></a>02449 <span class="preprocessor">#endif</span>
<a name="l02450"></a>02450 <span class="preprocessor"></span>}
<a name="l02451"></a>02451 
<a name="l02452"></a>02452 <span class="comment">// Build a new Morse matrix spanning the rectangular area defined by the two points (nl0, nc0) and (nl1, nc1)</span>
<a name="l02453"></a>02453 <span class="comment">// in the original matrix.</span>
<a name="l02454"></a>02454 <span class="comment">// Indices are provided in C mode (0-based indexing).</span>
<a name="l02455"></a><a class="code" href="classMatrice__Morse.html#a071f82da63647c04faa2cee21dc38047">02455</a> <span class="keywordtype">void</span> <a class="code" href="classMatrice__Morse.html#a071f82da63647c04faa2cee21dc38047">Matrice_Morse::construire_sous_bloc</a>(<span class="keywordtype">int</span> nl0, <span class="keywordtype">int</span> nc0, <span class="keywordtype">int</span> nl1, <span class="keywordtype">int</span> nc1, <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; result)<span class="keyword"> const</span>
<a name="l02456"></a>02456 <span class="keyword"></span>{
<a name="l02457"></a>02457 <span class="comment">// count non-zero entries:</span>
<a name="l02458"></a>02458   assert(nl0 &gt;= 0);
<a name="l02459"></a>02459   assert(nc0 &gt;= 0);
<a name="l02460"></a>02460   assert(nl0 &lt;= nl1);
<a name="l02461"></a>02461   assert(nc0 &lt;= nc1);
<a name="l02462"></a>02462 
<a name="l02463"></a>02463   <span class="keywordtype">int</span> max_nnz = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(nl1+1) - <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(nl0); <span class="comment">//!&lt; maximum number of zeros that we will find</span>
<a name="l02464"></a>02464 <span class="comment"></span>  <span class="keywordtype">int</span> tot=0;
<a name="l02465"></a>02465   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> loca(max_nnz, 2);
<a name="l02466"></a>02466   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> sub_coeffs(max_nnz);
<a name="l02467"></a>02467   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> li=nl0; li &lt;= nl1; li++)
<a name="l02468"></a>02468     {
<a name="l02469"></a>02469       <span class="keywordtype">int</span> idx_coeff = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(li)-1;
<a name="l02470"></a>02470       <span class="keywordtype">int</span> nb_coeff_on_line = <a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(li+1)-<a class="code" href="classMatrice__Morse.html#a906ba051649671139d2d5f6565c417d5">tab1_</a>(li);
<a name="l02471"></a>02471       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; nb_coeff_on_line; j++)
<a name="l02472"></a>02472         {
<a name="l02473"></a>02473           <span class="keywordtype">int</span> col_idx = <a class="code" href="classMatrice__Morse.html#a5f6e112296154936cc1ec98fd5cd1667">tab2_</a>(j+idx_coeff)-1;
<a name="l02474"></a>02474           <span class="keywordflow">if</span> (col_idx &gt;= nc0 &amp;&amp; col_idx &lt;= nc1) <span class="comment">//!&lt; is the coeff in the window?</span>
<a name="l02475"></a>02475 <span class="comment"></span>            {
<a name="l02476"></a>02476               loca(tot, 0) = li - nl0;
<a name="l02477"></a>02477               loca(tot, 1) = col_idx - nc0;
<a name="l02478"></a>02478               sub_coeffs(tot) = <a class="code" href="classMatrice__Morse.html#a780a72cd0f2c3b8b19bfa6d3201efb2e">coeff_</a>(j+idx_coeff);
<a name="l02479"></a>02479               tot++;
<a name="l02480"></a>02480             }
<a name="l02481"></a>02481         }
<a name="l02482"></a>02482     }
<a name="l02483"></a>02483   loca.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(tot,2);
<a name="l02484"></a>02484   sub_coeffs.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(tot);
<a name="l02485"></a>02485 
<a name="l02486"></a>02486   result.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(loca);
<a name="l02487"></a>02487 <span class="comment">// Set coefficient values:</span>
<a name="l02488"></a>02488   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0 ; i &lt; tot; i++)
<a name="l02489"></a>02489     {
<a name="l02490"></a>02490       <span class="keywordtype">int</span> il = loca(i, 0);
<a name="l02491"></a>02491       <span class="keywordtype">int</span> ic = loca(i, 1);
<a name="l02492"></a>02492       result.<a class="code" href="classMatrice__Morse.html#abc28b59726c121e6196bc7eaa666e970">coef</a>(il, ic) = sub_coeffs(i);
<a name="l02493"></a>02493     }
<a name="l02494"></a>02494 }
<a name="l02495"></a>02495 
<a name="l02496"></a>02496 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:22 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
