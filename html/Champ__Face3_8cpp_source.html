<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TRUST: src/VDF/Champs/Champ_Face3.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TRUST<span id="projectnumber">&#160;1.9.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_f999ad8736097ebdc524243ad7f1213b.html">VDF</a></li><li class="navelem"><a class="el" href="dir_0197979fff557feda0433ec01d8934c3.html">Champs</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">Champ_Face3.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="Champ__Face3_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/****************************************************************************</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">* Copyright (c) 2022, CEA</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">* All rights reserved.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">*</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">*</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">*</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">*****************************************************************************/</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;<a class="code" href="Champ__Face_8h.html">Champ_Face.h</a>&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;<a class="code" href="Champ__Uniforme_8h.html">Champ_Uniforme.h</a>&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__VDF_8h.html">Zone_Cl_VDF.h</a>&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__paroi__fixe_8h.html">Dirichlet_paroi_fixe.h</a>&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;<a class="code" href="Fluide__base_8h.html">Fluide_base.h</a>&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;<a class="code" href="Equation__base_8h.html">Equation_base.h</a>&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;<a class="code" href="Mod__turb__hyd__base_8h.html">Mod_turb_hyd_base.h</a>&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;<a class="code" href="distances__VDF_8h.html">distances_VDF.h</a>&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="keywordtype">void</span> <a class="code hl_function" href="Champ__Face3_8cpp.html#a55b486be8c7ed3ced7518eb23eb1a2a7">calrotord2centelemdim2</a>(<a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; rot, <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; val,</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>                            <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_VDF,</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>                            <span class="keywordtype">int</span> nb_elem, <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; face_voisins,</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>                            <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; elem_faces);</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="comment">// Traitement des elements internes</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="Champ__Face3_8cpp.html#a701e9944e0baf4b85e01159b39b6688e">   31</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="Champ__Face3_8cpp.html#a701e9944e0baf4b85e01159b39b6688e">calcul_interne3D</a>(<span class="keywordtype">int</span> num_elem,</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>                      <span class="keywordtype">int</span> elx0,<span class="keywordtype">int</span> elx1,</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>                      <span class="keywordtype">int</span> ely0,<span class="keywordtype">int</span> ely1,</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>                      <span class="keywordtype">int</span> elz0,<span class="keywordtype">int</span> elz1,</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>                      <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_VDF,</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>                      <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; val,<a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; rot)</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>{</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code hl_function" href="classZone__VF.html#a301c10a40fa5d518f3653d29a0fa621e">elem_faces</a>();</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>  <span class="keywordtype">double</span> delta_x_0,delta_x_1,delta_y_0,delta_y_1,delta_z_0,delta_z_1;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>  <span class="keywordtype">double</span> delta_x,delta_y,delta_z;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>  <span class="keywordtype">double</span> deriv_wy,deriv_vz,deriv_uz,deriv_wx,deriv_vx,deriv_uy;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>  deriv_wy = 0;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>  deriv_vz = 0;</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>  deriv_uz = 0;</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>  deriv_wx = 0;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>  deriv_vx = 0;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>  deriv_uy = 0;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>  delta_x_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,elx0,0);</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>  delta_x_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(elx1,num_elem,0);</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>  delta_y_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,ely0,1);</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>  delta_y_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(ely1,num_elem,1);</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>  delta_z_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,elz0,2);</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>  delta_z_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(elz1,num_elem,2);</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>  delta_x = (delta_x_1-delta_x_0)*(delta_x_1+delta_x_0)/(delta_x_1*delta_x_0);</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>  delta_y = (delta_y_1-delta_y_0)*(delta_y_1+delta_y_0)/(delta_y_1*delta_y_0);</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>  delta_z = (delta_z_1-delta_z_0)*(delta_z_1+delta_z_0)/(delta_z_1*delta_z_0);</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span> </div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>  deriv_vz = (delta_z_0/delta_z_1*val(elem_faces(elz1,1))</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>              + delta_z*val(elem_faces(num_elem,1))</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>              - delta_z_1/delta_z_0*val(elem_faces(elz0,1)));</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>  deriv_vz += (delta_z_0/delta_z_1*val(elem_faces(elz1,4))</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>               + delta_z*val(elem_faces(num_elem,4))</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>               - delta_z_1/delta_z_0*val(elem_faces(elz0,4)));</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>  deriv_vz *= 0.5/(delta_z_0 + delta_z_1);</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>  deriv_wy = (delta_y_0/delta_y_1*val(elem_faces(ely1,2))</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>              + delta_y*val(elem_faces(num_elem,2))</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>              - delta_y_1/delta_y_0*val(elem_faces(ely0,2)));</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>  deriv_wy += (delta_y_0/delta_y_1*val(elem_faces(ely1,5))</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>               + delta_y*val(elem_faces(num_elem,5))</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>               - delta_y_1/delta_y_0*val(elem_faces(ely0,5)));</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>  deriv_wy *= 0.5/(delta_y_0 + delta_y_1);</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>  deriv_uz = (delta_z_0/delta_z_1*val(elem_faces(elz1,0))</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>              + delta_z*val(elem_faces(num_elem,0))</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>              - delta_z_1/delta_z_0*val(elem_faces(elz0,0)));</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>  deriv_uz += (delta_z_0/delta_z_1*val(elem_faces(elz1,3))</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>               + delta_z*val(elem_faces(num_elem,3))</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>               - delta_z_1/delta_z_0*val(elem_faces(elz0,3)));</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>  deriv_uz *= 0.5/(delta_z_0 + delta_z_1);</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>  deriv_wx = (delta_x_0/delta_x_1*val(elem_faces(elx1,2))</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>              + delta_x*val(elem_faces(num_elem,2))</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>              - delta_x_1/delta_x_0*val(elem_faces(elx0,2)));</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>  deriv_wx += (delta_x_0/delta_x_1*val(elem_faces(elx1,5))</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>               + delta_x*val(elem_faces(num_elem,5))</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>               - delta_x_1/delta_x_0*val(elem_faces(elx0,5)));</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>  deriv_wx *= 0.5/(delta_x_0 + delta_x_1);</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span> </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>  deriv_vx = (delta_x_0/delta_x_1*val(elem_faces(elx1,1))</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>              + delta_x*val(elem_faces(num_elem,1))</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>              - delta_x_1/delta_x_0*val(elem_faces(elx0,1)));</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>  deriv_vx += (delta_x_0/delta_x_1*val(elem_faces(elx1,4))</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>               + delta_x*val(elem_faces(num_elem,4))</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>               - delta_x_1/delta_x_0*val(elem_faces(elx0,4)));</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>  deriv_vx *= 0.5/(delta_x_0 + delta_x_1);</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>  deriv_uy = (delta_y_0/delta_y_1*val(elem_faces(ely1,0))</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>              + delta_y*val(elem_faces(num_elem,0))</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>              - delta_y_1/delta_y_0*val(elem_faces(ely0,0)));</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>  deriv_uy += (delta_y_0/delta_y_1*val(elem_faces(ely1,3))</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>               + delta_y*val(elem_faces(num_elem,3))</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>               - delta_y_1/delta_y_0*val(elem_faces(ely0,3)));</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>  deriv_uy *= 0.5/(delta_y_0 + delta_y_1);</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>  rot(num_elem,0) = deriv_wy - deriv_vz;</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>  rot(num_elem,1) = deriv_uz - deriv_wx;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>  rot(num_elem,2) = deriv_vx - deriv_uy;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span> </div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>}</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span><span class="comment">// Traitement des elements bord</span></div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno"><a class="line" href="Champ__Face3_8cpp.html#a5e855238159aa648d515cdc0d8a5d8cf">  117</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="Champ__Face3_8cpp.html#a5e855238159aa648d515cdc0d8a5d8cf">calcul_bord3D</a>(<span class="keywordtype">int</span> num_elem,</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                   <span class="keywordtype">int</span> elx0,<span class="keywordtype">int</span> elx1,</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>                   <span class="keywordtype">int</span> ely0,<span class="keywordtype">int</span> ely1,</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>                   <span class="keywordtype">int</span> elz0,<span class="keywordtype">int</span> elz1,</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>                   <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_VDF,</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>                   <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; val,<a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; rot)</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>{</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code hl_function" href="classZone__VF.html#a301c10a40fa5d518f3653d29a0fa621e">elem_faces</a>();</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>  <span class="keywordtype">double</span> delta_x_0,delta_x_1,delta_y_0,delta_y_1,delta_z_0,delta_z_1;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>  <span class="keywordtype">double</span> delta_x,delta_y,delta_z;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>  <span class="keywordtype">double</span> deriv_wy,deriv_vz,deriv_uz,deriv_wx,deriv_vx,deriv_uy;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>  deriv_wy = 0;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>  deriv_vz = 0;</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>  deriv_uz = 0;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>  deriv_wx = 0;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>  deriv_vx = 0;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>  deriv_uy = 0;</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span> </div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span><span class="comment">// Traitement des elements bord</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span> </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>  <span class="keywordflow">if</span> ( (elx0 == -1) || (elx1 == -1) )</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    {</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>      <span class="keywordflow">if</span> (elx0 == -1)</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>        {</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>          <span class="keywordflow">if</span> (elx1 != -1)</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>            {</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>              delta_x_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(elx1,num_elem,0);</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>              deriv_vx = (val(elem_faces(elx1,1))-val(elem_faces(num_elem,1))</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>                          + val(elem_faces(elx1,4))-val(elem_faces(num_elem,4)));</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>              deriv_vx *= 0.5/delta_x_1;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>              deriv_wx = (val(elem_faces(elx1,2))-val(elem_faces(num_elem,2))</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>                          + val(elem_faces(elx1,5))-val(elem_faces(num_elem,5)));</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>              deriv_wx *= 0.5/delta_x_1;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>            }</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>            {</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>              deriv_vx = 0;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>              deriv_wx = 0;</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>            }</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>        }</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>      <span class="keywordflow">else</span> <span class="comment">//!&lt; elx1 = -1 et elx0 != -1</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        {</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>          delta_x_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,elx0,0);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>          deriv_vx = (val(elem_faces(num_elem,1))-val(elem_faces(elx0,1))</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>                      + val(elem_faces(num_elem,4))-val(elem_faces(elx0,4)));</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>          deriv_vx *= 0.5/delta_x_0;</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>          deriv_wx = (val(elem_faces(num_elem,2))-val(elem_faces(elx0,2))</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>                      + val(elem_faces(num_elem,5))-val(elem_faces(elx0,5)));</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>          deriv_wx *= 0.5/delta_x_0;</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>        }</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>      <span class="keywordflow">if</span> ( (ely0 == -1) || (ely1 == -1) )</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>        {</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>          <span class="keywordflow">if</span> (ely0 == -1)</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>            {</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>              <span class="keywordflow">if</span> (ely1 != -1)</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>                {</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>                  delta_y_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(ely1,num_elem,1);</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                  deriv_uy = (val(elem_faces(ely1,0))-val(elem_faces(num_elem,0))</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>                              + val(elem_faces(ely1,3))-val(elem_faces(num_elem,3)));</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>                  deriv_uy *= 0.5/delta_y_1;</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>                  deriv_wy = (val(elem_faces(ely1,2))-val(elem_faces(num_elem,2))</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>                              + val(elem_faces(ely1,5))-val(elem_faces(num_elem,5)));</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>                  deriv_wy *= 0.5/delta_y_1;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>                }</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>              <span class="keywordflow">else</span></div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>                {</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>                  deriv_uy = 0;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>                  deriv_wy = 0;</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>                }</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>            }</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>          <span class="keywordflow">else</span> <span class="comment">//!&lt; ely1 = -1 et ely0 != -1</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>            {</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>              delta_y_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,ely0,1);</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>              deriv_uy = (val(elem_faces(num_elem,0))-val(elem_faces(ely0,0))</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>                          + val(elem_faces(num_elem,3))-val(elem_faces(ely0,3)));</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>              deriv_uy *= 0.5/delta_y_0;</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>              deriv_wy = (val(elem_faces(num_elem,2))-val(elem_faces(ely0,2))</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>                          + val(elem_faces(num_elem,5))-val(elem_faces(ely0,5)));</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>              deriv_wy *= 0.5/delta_y_0;</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>            }</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>        }</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        {</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>          delta_y_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,ely0,1);</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>          delta_y_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(ely1,num_elem,1);</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>          delta_y = (delta_y_1-delta_y_0)*(delta_y_1+delta_y_0)/(delta_y_1*delta_y_0);</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>          deriv_uy = (delta_y_0/delta_y_1*val(elem_faces(ely1,0))</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>                      + delta_y*val(elem_faces(num_elem,0))</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>                      - delta_y_1/delta_y_0*val(elem_faces(ely0,0)));</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>          deriv_uy += (delta_y_0/delta_y_1*val(elem_faces(ely1,3))</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>                       + delta_y*val(elem_faces(num_elem,3))</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>                       - delta_y_1/delta_y_0*val(elem_faces(ely0,3)));</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>          deriv_uy *= 0.5/(delta_y_0 + delta_y_1);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>          deriv_wy = (delta_y_0/delta_y_1*val(elem_faces(ely1,2))</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>                      + delta_y*val(elem_faces(num_elem,2))</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>                      - delta_y_1/delta_y_0*val(elem_faces(ely0,2)));</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>          deriv_wy += (delta_y_0/delta_y_1*val(elem_faces(ely1,5))</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>                       + delta_y*val(elem_faces(num_elem,5))</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>                       - delta_y_1/delta_y_0*val(elem_faces(ely0,5)));</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>          deriv_wy *= 0.5/(delta_y_0 + delta_y_1);</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>        }</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>      <span class="keywordflow">if</span> ( (elz0 == -1) || (elz1 == -1) )</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>        {</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>          <span class="keywordflow">if</span> (elz0 == -1)</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>            {</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>              <span class="keywordflow">if</span> (elz1 != -1)</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>                {</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>                  delta_z_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(elz1,num_elem,2);</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>                  deriv_uz = (val(elem_faces(elz1,0))-val(elem_faces(num_elem,0))</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>                              + val(elem_faces(elz1,3))-val(elem_faces(num_elem,3)));</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>                  deriv_uz *= 0.5/delta_z_1;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>                  deriv_vz = (val(elem_faces(elz1,1))-val(elem_faces(num_elem,1))</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>                              + val(elem_faces(elz1,4))-val(elem_faces(num_elem,4)));</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>                  deriv_vz *= 0.5/delta_z_1;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>                }</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>              <span class="keywordflow">else</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>                {</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>                  deriv_uz = 0;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>                  deriv_vz = 0;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>                }</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>            }</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>          <span class="keywordflow">else</span> <span class="comment">//!&lt; elz1 = -1 et elz0 != -1</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>            {</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>              delta_z_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,elz0,2);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>              deriv_uz = (val(elem_faces(num_elem,0))-val(elem_faces(elz0,0))</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>                          + val(elem_faces(num_elem,3))-val(elem_faces(elz0,3)));</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>              deriv_uz *= 0.5/delta_z_0;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>              deriv_vz =(val(elem_faces(num_elem,1))-val(elem_faces(elz0,1))</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>                         + val(elem_faces(num_elem,4))-val(elem_faces(elz0,4)));</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>              deriv_vz *= 0.5/delta_z_0;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>            }</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        }</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>        {</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>          delta_z_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,elz0,2);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>          delta_z_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(elz1,num_elem,2);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>          delta_z = (delta_z_1-delta_z_0)*(delta_z_1+delta_z_0)/(delta_z_1*delta_z_0);</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>          deriv_uz = (delta_z_0/delta_z_1*val(elem_faces(elz1,0))</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>                      + delta_z*val(elem_faces(num_elem,0))</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>                      - delta_z_1/delta_z_0*val(elem_faces(elz0,0)));</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>          deriv_uz += (delta_z_0/delta_z_1*val(elem_faces(elz1,3))</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>                       + delta_z*val(elem_faces(num_elem,3))</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>                       - delta_z_1/delta_z_0*val(elem_faces(elz0,3)));</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>          deriv_uz *= 0.5/(delta_z_0 + delta_z_1);</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span> </div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>          deriv_vz = (delta_z_0/delta_z_1*val(elem_faces(elz1,1))</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>                      + delta_z*val(elem_faces(num_elem,1))</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>                      - delta_z_1/delta_z_0*val(elem_faces(elz0,1)));</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>          deriv_vz += (delta_z_0/delta_z_1*val(elem_faces(elz1,4))</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>                       + delta_z*val(elem_faces(num_elem,4))</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>                       - delta_z_1/delta_z_0*val(elem_faces(elz0,4)));</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>          deriv_vz *= 0.5/(delta_z_0 + delta_z_1);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>        }</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    }</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (ely0 == -1) || (ely1 == -1) )</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    {</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>      <span class="keywordflow">if</span> (ely0 == -1)</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>        {</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>          <span class="keywordflow">if</span> (ely1 != -1)</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>            {</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>              delta_y_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(ely1,num_elem,1);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>              deriv_uy = (val(elem_faces(ely1,0))-val(elem_faces(num_elem,0))</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>                          + val(elem_faces(ely1,3))-val(elem_faces(num_elem,3)));</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>              deriv_uy *= 0.5/delta_y_1;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>              deriv_wy = (val(elem_faces(ely1,2))-val(elem_faces(num_elem,2))</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>                          + val(elem_faces(ely1,5))-val(elem_faces(num_elem,5)));</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>              deriv_wy *= 0.5/delta_y_1;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>            }</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>            {</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>              deriv_uy = 0;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>              deriv_wy = 0;</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>            }</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        }</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>      <span class="keywordflow">else</span>  <span class="comment">//!&lt; ely1 = -1 et ely0 != -1</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>        {</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>          delta_y_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,ely0,1);</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>          deriv_uy = (val(elem_faces(num_elem,0))-val(elem_faces(ely0,0))</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>                      + val(elem_faces(num_elem,3))-val(elem_faces(ely0,3)));</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>          deriv_uy *= 0.5/delta_y_0;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>          deriv_wy = (val(elem_faces(num_elem,2))-val(elem_faces(ely0,2))</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>                      + val(elem_faces(num_elem,5))-val(elem_faces(ely0,5)));</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>          deriv_wy *= 0.5/delta_y_0;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>        }</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span> </div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>      delta_x_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,elx0,0);</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>      delta_x_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(elx1,num_elem,0);</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>      delta_x = (delta_x_1-delta_x_0)*(delta_x_1+delta_x_0)/(delta_x_1*delta_x_0);</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>      deriv_wx = (delta_x_0/delta_x_1*val(elem_faces(elx1,2))</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>                  + delta_x*val(elem_faces(num_elem,2))</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>                  - delta_x_1/delta_x_0*val(elem_faces(elx0,2)));</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>      deriv_wx += (delta_x_0/delta_x_1*val(elem_faces(elx1,5))</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>                   + delta_x*val(elem_faces(num_elem,5))</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>                   - delta_x_1/delta_x_0*val(elem_faces(elx0,5)));</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>      deriv_wx *= 0.5/(delta_x_0 + delta_x_1);</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>      deriv_vx = (delta_x_0/delta_x_1*val(elem_faces(elx1,1))</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>                  + delta_x*val(elem_faces(num_elem,1))</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>                  - delta_x_1/delta_x_0*val(elem_faces(elx0,1)));</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>      deriv_vx += (delta_x_0/delta_x_1*val(elem_faces(elx1,4))</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>                   + delta_x*val(elem_faces(num_elem,4))</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>                   - delta_x_1/delta_x_0*val(elem_faces(elx0,4)));</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>      deriv_vx *= 0.5/(delta_x_0 + delta_x_1);</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span> </div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>      <span class="keywordflow">if</span> ( (elz0 == -1) || (elz1 == -1) )</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>        {</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>          <span class="keywordflow">if</span> (elz0 == -1)</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>            {</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>              <span class="keywordflow">if</span> (elz1 != -1)</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>                {</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>                  delta_z_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(elz1,num_elem,2);</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>                  deriv_uz = (val(elem_faces(elz1,0))-val(elem_faces(num_elem,0))</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>                              + val(elem_faces(elz1,3))-val(elem_faces(num_elem,3)));</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>                  deriv_uz *= 0.5/delta_z_1;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>                  deriv_vz = (val(elem_faces(elz1,1))-val(elem_faces(num_elem,1))</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>                              + val(elem_faces(elz1,4))-val(elem_faces(num_elem,4)));</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>                  deriv_vz *= 0.5/delta_z_1;</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>                }</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>              <span class="keywordflow">else</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>                {</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>                  deriv_uz = 0;</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>                  deriv_vz = 0;</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>                }</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>            }</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>            {</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>              delta_z_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,elz0,2);</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>              deriv_uz = (val(elem_faces(num_elem,0))-val(elem_faces(elz0,0))</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>                          + val(elem_faces(num_elem,3))-val(elem_faces(elz0,3)));</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>              deriv_uz *= 0.5/delta_z_0;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>              deriv_vz =(val(elem_faces(num_elem,1))-val(elem_faces(elz0,1))</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>                         + val(elem_faces(num_elem,4))-val(elem_faces(elz0,4)));</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>              deriv_vz *= 0.5/delta_z_0;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>            }</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        }</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        {</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>          delta_z_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,elz0,2);</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>          delta_z_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(elz1,num_elem,2);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>          delta_z = (delta_z_1-delta_z_0)*(delta_z_1+delta_z_0)/(delta_z_1*delta_z_0);</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span> </div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>          deriv_uz = (delta_z_0/delta_z_1*val(elem_faces(elz1,0))</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>                      + delta_z*val(elem_faces(num_elem,0))</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>                      - delta_z_1/delta_z_0*val(elem_faces(elz0,0)));</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>          deriv_uz += (delta_z_0/delta_z_1*val(elem_faces(elz1,3))</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>                       + delta_z*val(elem_faces(num_elem,3))</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>                       - delta_z_1/delta_z_0*val(elem_faces(elz0,3)));</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>          deriv_uz *= 0.5/(delta_z_0 + delta_z_1);</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span> </div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>          deriv_vz = (delta_z_0/delta_z_1*val(elem_faces(elz1,1))</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>                      + delta_z*val(elem_faces(num_elem,1))</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>                      - delta_z_1/delta_z_0*val(elem_faces(elz0,1)));</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>          deriv_vz += (delta_z_0/delta_z_1*val(elem_faces(elz1,4))</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>                       + delta_z*val(elem_faces(num_elem,4))</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>                       - delta_z_1/delta_z_0*val(elem_faces(elz0,4)));</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>          deriv_vz *= 0.5/(delta_z_0 + delta_z_1);</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        }</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    }</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (elz0 == -1) || (elz1 == -1) )</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    {</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>      <span class="keywordflow">if</span> (elz0 == -1)</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>        {</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>          <span class="keywordflow">if</span> (elz1 != -1)</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>            {</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>              delta_z_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(elz1,num_elem,2);</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>              deriv_uz = (val(elem_faces(elz1,0))-val(elem_faces(num_elem,0))</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>                          + val(elem_faces(elz1,3))-val(elem_faces(num_elem,3)));</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>              deriv_uz *= 0.5/delta_z_1;</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>              deriv_vz = (val(elem_faces(elz1,1))-val(elem_faces(num_elem,1))</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>                          + val(elem_faces(elz1,4))-val(elem_faces(num_elem,4)));</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>              deriv_vz *= 0.5/delta_z_1;</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>            }</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>            {</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>              deriv_uz = 0;</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>              deriv_vz = 0;</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>            }</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>        }</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>      <span class="keywordflow">else</span> <span class="comment">//!&lt; elz1 = -1 et elz0 != -1</span></div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>        {</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>          delta_z_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,elz0,2);</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>          deriv_uz = (val(elem_faces(num_elem,0))-val(elem_faces(elz0,0))</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>                      + val(elem_faces(num_elem,3))-val(elem_faces(elz0,3)));</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>          deriv_uz *= 0.5/delta_z_0;</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>          deriv_vz =(val(elem_faces(num_elem,1))-val(elem_faces(elz0,1))</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>                     + val(elem_faces(num_elem,4))-val(elem_faces(elz0,4)));</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>          deriv_vz *= 0.5/delta_z_0;</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>        }</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span> </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>      delta_x_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,elx0,0);</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>      delta_x_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(elx1,num_elem,0);</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>      delta_x = (delta_x_1-delta_x_0)*(delta_x_1+delta_x_0)/(delta_x_1*delta_x_0);</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span> </div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>      deriv_wx = (delta_x_0/delta_x_1*val(elem_faces(elx1,2))</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>                  + delta_x*val(elem_faces(num_elem,2))</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>                  - delta_x_1/delta_x_0*val(elem_faces(elx0,2)));</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>      deriv_wx += (delta_x_0/delta_x_1*val(elem_faces(elx1,5))</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>                   + delta_x*val(elem_faces(num_elem,5))</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>                   - delta_x_1/delta_x_0*val(elem_faces(elx0,5)));</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>      deriv_wx *= 0.5/(delta_x_0 + delta_x_1);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span> </div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>      deriv_vx = (delta_x_0/delta_x_1*val(elem_faces(elx1,1))</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>                  + delta_x*val(elem_faces(num_elem,1))</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>                  - delta_x_1/delta_x_0*val(elem_faces(elx0,1)));</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>      deriv_vx += (delta_x_0/delta_x_1*val(elem_faces(elx1,4))</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>                   + delta_x*val(elem_faces(num_elem,4))</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>                   - delta_x_1/delta_x_0*val(elem_faces(elx0,4)));</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>      deriv_vx *= 0.5/(delta_x_0 + delta_x_1);</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span> </div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>      delta_y_0 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(num_elem,ely0,1);</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>      delta_y_1 = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">dist_elem_period</a>(ely1,num_elem,1);</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>      delta_y = (delta_y_1-delta_y_0)*(delta_y_1+delta_y_0)/(delta_y_1*delta_y_0);</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>      deriv_wy = (delta_y_0/delta_y_1*val(elem_faces(ely1,2))</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>                  + delta_y*val(elem_faces(num_elem,2))</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>                  - delta_y_1/delta_y_0*val(elem_faces(ely0,2)));</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>      deriv_wy += (delta_y_0/delta_y_1*val(elem_faces(ely1,5))</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>                   + delta_y*val(elem_faces(num_elem,5))</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>                   - delta_y_1/delta_y_0*val(elem_faces(ely0,5)));</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>      deriv_wy *= 0.5/(delta_y_0 + delta_y_1);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span> </div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>      deriv_uy = (delta_y_0/delta_y_1*val(elem_faces(ely1,0))</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>                  + delta_y*val(elem_faces(num_elem,0))</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>                  - delta_y_1/delta_y_0*val(elem_faces(ely0,0)));</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>      deriv_uy += (delta_y_0/delta_y_1*val(elem_faces(ely1,3))</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>                   + delta_y*val(elem_faces(num_elem,3))</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>                   - delta_y_1/delta_y_0*val(elem_faces(ely0,3)));</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>      deriv_uy *= 0.5/(delta_y_0 + delta_y_1);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    }</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span> </div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>  rot(num_elem,0) = deriv_wy - deriv_vz;</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>  rot(num_elem,1) = deriv_uz - deriv_wx;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>  rot(num_elem,2) = deriv_vx - deriv_uy;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>}</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno"><a class="line" href="Champ__Face3_8cpp.html#ad6f2d561a2b01a55d910955d7b4964a9">  462</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="Champ__Face3_8cpp.html#ad6f2d561a2b01a55d910955d7b4964a9">calrotord2centelemdim3</a>(<a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; rot, <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; val, <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_VDF,</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>                            <span class="keywordtype">int</span> nb_elem, <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; face_voisins, <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; elem_faces)</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>{</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>  <span class="keywordflow">if</span>(rot.<a class="code hl_function" href="classTRUSTTab.html#a8fecd3f1f3a13e933c3f767a25c54805">dimension</a>(0)!=nb_elem)</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>    rot.<a class="code hl_function" href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">resize</a>(nb_elem, 3);</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>  <span class="keywordtype">int</span> elx0,elx1,ely0,ely1,elz0,elz1;</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span> </div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elem; num_elem++)</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    {</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span> </div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>      elx0 = face_voisins(elem_faces(num_elem,0),0);</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>      elx1 = face_voisins(elem_faces(num_elem,3),1);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>      ely0 = face_voisins(elem_faces(num_elem,1),0);</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>      ely1 = face_voisins(elem_faces(num_elem,4),1);</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>      elz0 = face_voisins(elem_faces(num_elem,2),0);</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>      elz1 = face_voisins(elem_faces(num_elem,5),1);</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span> </div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>      <span class="keywordflow">if</span> ( (elx0 != -1) &amp;&amp; (elx1 != -1) &amp;&amp; (ely0 != -1)</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>           &amp;&amp; (ely1 != -1) &amp;&amp; (elz0 != -1) &amp;&amp; (elz1 != -1) )</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span><span class="comment">// Cas d&#39;un element interne</span></div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>        <a class="code hl_function" href="Champ__Face3_8cpp.html#a701e9944e0baf4b85e01159b39b6688e">calcul_interne3D</a>(num_elem,elx0,elx1,ely0,ely1,elz0,elz1,zone_VDF,val,rot);</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>        <a class="code hl_function" href="Champ__Face3_8cpp.html#a5e855238159aa648d515cdc0d8a5d8cf">calcul_bord3D</a>(num_elem,elx0,elx1,ely0,ely1,elz0,elz1,zone_VDF,val,rot);</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    }</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>}</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span> </div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span> </div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span> </div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno"><a class="line" href="classChamp__Face.html#a68c9c8c49e1a21437affa8abb0753910">  491</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classChamp__Face.html#a68c9c8c49e1a21437affa8abb0753910">Champ_Face::calculer_rotationnel_ordre2_centre_element</a>(<a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; rot)<span class="keyword"> const</span></div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; val = <a class="code hl_function" href="classChamp__Inc__base.html#a8c225229cff16292a3b78f075d93a26d">valeurs</a>();</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_VDF = <a class="code hl_variable" href="classChamp__Face.html#a84b6abcd128000e1d5759caaa7ae0dee">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>  <span class="keywordtype">int</span> nb_elem = zone_VDF.<a class="code hl_function" href="classZone__dis__base.html#a66f0610b6936eba8d959b63b15255b4f">nb_elem</a>();</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; face_voisins = zone_VDF.<a class="code hl_function" href="classZone__VF.html#a1935d5babef3e13a64d7b997ce94cdd0">face_voisins</a>();</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code hl_function" href="classZone__VF.html#a301c10a40fa5d518f3653d29a0fa621e">elem_faces</a>();</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> </div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2 )</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>    <a class="code hl_function" href="Champ__Face3_8cpp.html#a55b486be8c7ed3ced7518eb23eb1a2a7">calrotord2centelemdim2</a>(rot, val, zone_VDF, nb_elem, face_voisins, elem_faces);</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>    <a class="code hl_function" href="Champ__Face3_8cpp.html#ad6f2d561a2b01a55d910955d7b4964a9">calrotord2centelemdim3</a>(rot, val, zone_VDF, nb_elem, face_voisins, elem_faces);</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>}</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span> </div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno"><a class="line" href="classChamp__Face.html#ae4b07dcae66b9ff936f30962e9ee8254">  505</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="classChamp__Face.html#ae4b07dcae66b9ff936f30962e9ee8254">Champ_Face::imprime</a>(<a class="code hl_class" href="classSortie.html">Sortie</a>&amp; os, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>  <a class="code hl_function" href="classChamp__Face__implementation.html#a8827f54a9d587810a4ba2885837704ef">imprime_Face</a>(os,ncomp);</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>}</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno"><a class="line" href="classChamp__Face.html#a30c21c0f12fe00680722fc07cc3d54be">  512</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classChamp__Face.html#a30c21c0f12fe00680722fc07cc3d54be">Champ_Face::calcul_critere_Q</a>(<a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; Q, <span class="keyword">const</span> <a class="code hl_class" href="classZone__Cl__VDF.html">Zone_Cl_VDF</a>&amp; zone_Cl_VDF)</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>{</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span><span class="comment">// Q=0.5*(\Omega_{ij}*\Omega_{ij}-S_{ij}*S_{ij})=-0.25*du_i/dx_j*du_j/dx_i</span></div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span> </div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_VDF = <a class="code hl_variable" href="classChamp__Face.html#a84b6abcd128000e1d5759caaa7ae0dee">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem = zone_VDF.<a class="code hl_function" href="classZone__dis__base.html#a66f0610b6936eba8d959b63b15255b4f">nb_elem</a>();</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VDF.<a class="code hl_function" href="classZone__dis__base.html#a6e97d34e3642a259924718796298e09e">nb_elem_tot</a>();</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>  <span class="keywordtype">int</span> num_elem,i,j;</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>  <span class="keywordtype">double</span> crit,deriv1,deriv2;</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span> </div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>  <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a> gradient_elem(nb_elem_tot,<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>,<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>  gradient_elem=0.;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span> </div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>  <a class="code hl_class" href="classChamp__Face.html">Champ_Face</a>&amp; vit = *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; vitesse = <a class="code hl_function" href="classChamp__Inc__base.html#a8c225229cff16292a3b78f075d93a26d">valeurs</a>();</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span> </div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>  vit.<a class="code hl_function" href="classChamp__Face.html#a3917b4658637beba61fb02b45b85d8b6">calcul_duidxj</a>(vitesse,gradient_elem,zone_Cl_VDF);</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span> </div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>  <span class="keywordflow">for</span> (num_elem=0; num_elem&lt;nb_elem; num_elem++)</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    {</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>      crit = 0.;</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>      <span class="keywordflow">for</span> (i=0; i&lt;<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>        <span class="keywordflow">for</span>(j=0; j&lt;<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; j++)</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>          {</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>            deriv1 = gradient_elem(num_elem,i,j);</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>            deriv2 = gradient_elem(num_elem,j,i);</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span> </div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>            crit += -0.25*deriv1*deriv2;</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>          }</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>      Q[num_elem] = crit;</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>    }</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>}</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span> </div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span> </div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno"><a class="line" href="classChamp__Face.html#a7c36a9d06fd62b53ce2fe1d778f33128">  548</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classChamp__Face.html#a7c36a9d06fd62b53ce2fe1d778f33128">Champ_Face::calcul_y_plus</a>(<a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; y_plus, <span class="keyword">const</span> <a class="code hl_class" href="classZone__Cl__VDF.html">Zone_Cl_VDF</a>&amp; zone_Cl_VDF)</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>{</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span><span class="comment">// On initialise le champ y_plus avec une valeur negative,</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span><span class="comment">// comme ca lorsqu&#39;on veut visualiser le champ pres de la paroi,</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span><span class="comment">// on n&#39;a qu&#39;a supprimer les valeurs negatives et n&#39;apparaissent</span></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span><span class="comment">// que les valeurs aux parois.</span></div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span> </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>  <span class="keywordtype">int</span> ndeb,nfin,elem,ori,l_unif;</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  <span class="keywordtype">double</span> norm_tau,u_etoile,norm_v=0, dist, val0, val1, val2, d_visco=0, visco=1.;</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>  y_plus=-1.;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span> </div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>  <span class="keyword">const</span> <a class="code hl_class" href="classChamp__Face.html">Champ_Face</a>&amp; vit = *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_VDF = <a class="code hl_variable" href="classChamp__Face.html#a84b6abcd128000e1d5759caaa7ae0dee">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; face_voisins = zone_VDF.<a class="code hl_function" href="classZone__VF.html#a1935d5babef3e13a64d7b997ce94cdd0">face_voisins</a>();</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">IntVect</a>&amp; orientation = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a71671288eceb9fe858d5554b6ad2f039">orientation</a>();</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>  <span class="keyword">const</span> <a class="code hl_class" href="classEquation__base.html">Equation_base</a>&amp; eqn_hydr = <a class="code hl_function" href="classMorEqn.html#a233c714209593acce7aec1f55640bca2">equation</a>();</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>  <span class="keyword">const</span> <a class="code hl_class" href="classFluide__base.html">Fluide_base</a>&amp; le_fluide = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classFluide__base.html">Fluide_base</a>, eqn_hydr.<a class="code hl_function" href="classEquation__base.html#a1ca88930cf00c12a910ad27ac840719c">milieu</a>());</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>  <span class="keyword">const</span> <a class="code hl_class" href="classChamp__Don.html">Champ_Don</a>&amp; ch_visco_cin = le_fluide.<a class="code hl_function" href="classFluide__base.html#a8310bfe64ef9a45d7efc4636db43741b">viscosite_cinematique</a>();</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; tab_visco = ch_visco_cin-&gt;<a class="code hl_function" href="classChamp__Don.html#ab9bd14ad525a929cb7ea36409e41842c">valeurs</a>();</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span><span class="comment">// DoubleTab&amp; tab_visco = ch_visco_cin.valeur().valeurs();</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span> </div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classChamp__Uniforme.html">Champ_Uniforme</a>, ch_visco_cin.<a class="code hl_function" href="classDeriv__Champ__Don__base.html#a74180221a6f2723995588f60d416f284">valeur</a>()))</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>    {</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>      visco = tab_visco(0,0);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>      l_unif = 1;</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    }</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    l_unif = 0;</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span> </div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>  <span class="comment">/* GF on a pas a change tab_visco ici !</span></div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span><span class="comment">  if (!l_unif)</span></div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span><span class="comment">    {</span></div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span><span class="comment">      const int n = tab_visco.size_array();</span></div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span><span class="comment">      ArrOfDouble&amp; v = tab_visco;</span></div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span><span class="comment">      for (int i = 0; i &lt; n; i++)</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span><span class="comment">        if (v[i] &lt; DMINFLOAT)</span></div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span><span class="comment">          v[i] = DMINFLOAT;</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span><span class="comment">    }</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span><span class="comment">// Changer uniquement les valeurs &lt; DMINFLOAT (l&#39;ancien code n&#39;est pas parallele)</span></div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span><span class="comment">  */</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span> </div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>  <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a> yplus_faces( 1, 1 ); <span class="comment">//!&lt; will contain yplus values if available</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>  <span class="keywordtype">int</span> yplus_already_computed=0; <span class="comment">//!&lt; flag</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span> </div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>  <span class="keyword">const</span> <a class="code hl_class" href="classRef__Objet__U.html">RefObjU</a>&amp; modele_turbulence = eqn_hydr.<a class="code hl_function" href="classEquation__base.html#a26d510ff71f9cc45143a9f16bf4bd24a">get_modele</a>(<a class="code hl_enumvalue" href="Equation__base_8h.html#a2c9d34b2cc47e5b2b18347de20a77db5a0fecbd75e0b8b4c37ffd696e173a14c7">TURBULENCE</a>);</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>  <span class="keywordflow">if</span> (modele_turbulence.<a class="code hl_function" href="classO__U__Ptr.html#a8d368932ee397da5ae25a9916fd88a59">non_nul</a>() &amp;&amp; <a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classMod__turb__hyd__base.html">Mod_turb_hyd_base</a>,modele_turbulence.<a class="code hl_function" href="classRef__Objet__U.html#ae1559b18a55fa814ba0c334165359d9c">valeur</a>()))</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>    {</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>      <span class="keyword">const</span> <a class="code hl_class" href="classMod__turb__hyd__base.html">Mod_turb_hyd_base</a>&amp; mod_turb = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classMod__turb__hyd__base.html">Mod_turb_hyd_base</a>,modele_turbulence.<a class="code hl_function" href="classRef__Objet__U.html#ae1559b18a55fa814ba0c334165359d9c">valeur</a>());</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>      <span class="keyword">const</span> <a class="code hl_class" href="classTurbulence__paroi__base.html">Turbulence_paroi_base</a>&amp; loipar = mod_turb.<a class="code hl_function" href="classMod__turb__hyd__base.html#a407c307878b9a8e341e9d5bee78ae0b1">loi_paroi</a>();</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>      <span class="keywordflow">if</span>( loipar.<a class="code hl_function" href="classTurbulence__paroi__base.html#ae17a65c941097714aed5be9f36e5408a">use_shear</a>( ) )</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>        {</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>          yplus_faces.<a class="code hl_function" href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">resize</a>( <a class="code hl_variable" href="classChamp__Face.html#a84b6abcd128000e1d5759caaa7ae0dee">la_zone_VDF</a>-&gt;<a class="code hl_function" href="classZone__VF.html#a3125b6b5356f13a9827dbd0da606d2e7">nb_faces_tot</a>( ) );</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>          yplus_faces.<a class="code hl_function" href="classTRUSTTab.html#aa535c986ec7914b6da5845401d76a424">ref</a>( loipar.<a class="code hl_function" href="classTurbulence__paroi__base.html#a1e1399f945b92967378852ea383fffae">tab_d_plus</a>( ) );</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>          yplus_already_computed = 1;</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>        }</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>    }</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span> </div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;zone_VDF.<a class="code hl_function" href="classZone__dis__base.html#a0913a5b7b235f6c092523df5f5b8bacd">nb_front_Cl</a>(); n_bord++)</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>    {</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>      <span class="keyword">const</span> <a class="code hl_class" href="classCond__lim.html">Cond_lim</a>&amp; la_cl = zone_Cl_VDF.<a class="code hl_function" href="classZone__Cl__dis__base.html#a9b068b594ffc0a2cb2eb08841efcd1f5">les_conditions_limites</a>(n_bord);</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span> </div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>      <span class="keywordflow">if</span> ( <a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classDirichlet__paroi__fixe.html">Dirichlet_paroi_fixe</a>,la_cl.<a class="code hl_function" href="classDeriv__Cond__lim__base.html#afd7af50ad75a2cde929df2cedb684d58">valeur</a>()))</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>        {</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>          <span class="keyword">const</span> <a class="code hl_class" href="classFront__VF.html">Front_VF</a>&amp; le_bord = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classFront__VF.html">Front_VF</a>,la_cl.<a class="code hl_function" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22">frontiere_dis</a>());</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>          ndeb = le_bord.<a class="code hl_function" href="classFront__VF.html#a930e90fb5e8e79adaad93b5c405d00d1">num_premiere_face</a>();</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>          nfin = ndeb + le_bord.<a class="code hl_function" href="classFront__VF.html#a48eadf1b57ddc0d16e4953d19f259a9e">nb_faces</a>();</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span> </div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span> </div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=ndeb; num_face&lt;nfin; num_face++)</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>            {</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span> </div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>              <span class="keywordflow">if</span>( face_voisins( num_face, 0 ) != -1 )</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>                elem = face_voisins( num_face, 0 ) ;</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>              <span class="keywordflow">else</span></div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>                elem = face_voisins( num_face, 1 ) ;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span> </div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>              <span class="keywordflow">if</span>( yplus_already_computed )</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>                {</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span><span class="comment">// y+ is only defined on faces so we take the face value to put in the element</span></div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>                  y_plus( elem ) = yplus_faces( num_face );</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>                }</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>              <span class="keywordflow">else</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>                {</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span> </div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>                  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2 )</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>                    {</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>                      ori = orientation(num_face);</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>                      norm_v=<a class="code hl_function" href="distances__VDF_8cpp.html#af3a381c8e91b87fe5405eefe7df5c5e3">norm_2D_vit</a>(vit.<a class="code hl_function" href="classChamp__Inc__base.html#a8c225229cff16292a3b78f075d93a26d">valeurs</a>(),elem,ori,zone_VDF,val0);</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>                    }</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>                    {</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>                      ori = orientation(num_face);</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>                      norm_v=<a class="code hl_function" href="distances__VDF_8cpp.html#a15f59f570345b3bba6c96f78698709df">norm_3D_vit</a>(vit.<a class="code hl_function" href="classChamp__Inc__base.html#a8c225229cff16292a3b78f075d93a26d">valeurs</a>(),elem,ori,zone_VDF,val1,val2);</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>                    } <span class="comment">//!&lt; dim 3</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span> </div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>                  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classObjet__U.html#ad9b82ace9d4c7902ec704b6a78f76991">axi</a> )</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>                    dist=zone_VDF.<a class="code hl_function" href="classZone__VDF.html#ab6986523fd83072f4f06fe59e48a89fb">dist_norm_bord_axi</a>(num_face);</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>                  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>                    dist=zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9cef0210dfce071f039154ec8076044a">dist_norm_bord</a>(num_face);</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>                  <span class="keywordflow">if</span> ( l_unif )</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>                    d_visco = visco;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>                  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>                    d_visco = tab_visco[elem];</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span> </div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span><span class="comment">// PQ : 01/10/03 : corrections par rapport a la version premiere</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>                  norm_tau = d_visco*norm_v/dist;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span> </div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>                  u_etoile = sqrt(norm_tau);</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>                  y_plus(elem) = dist*u_etoile/d_visco;</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span> </div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>                } <span class="comment">//!&lt; else yplus already computed</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span> </div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>            } <span class="comment">//!&lt; loop on faces</span></div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span> </div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        } <span class="comment">//!&lt; Fin paroi fixe</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span> </div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>    } <span class="comment">//!&lt; Fin boucle sur les bords</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>}</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span> </div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span><span class="comment">//</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span><span class="comment">// Methode qui renvoie gij aux elements a partir de la vitesse aux faces</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span><span class="comment">// (gij represente la derivee partielle dui/dxj)</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span><span class="comment">// </span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span><span class="comment">// A partir de gij, on peut calculer Sij = 0.5(gij(i,j)+gij(j,i))</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span><span class="comment">// </span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span><span class="comment">//</span></div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span> </div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno"><a class="line" href="classChamp__Face.html#a87ccb7b5962da56fbaa66a4c7dbe8820">  675</a></span><a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; <a class="code hl_function" href="classChamp__Face.html#a3917b4658637beba61fb02b45b85d8b6">Champ_Face::calcul_duidxj</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; vitesse, <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; gij, <span class="keyword">const</span> <a class="code hl_class" href="classZone__Cl__VDF.html">Zone_Cl_VDF</a>&amp; zone_Cl_VDF)<span class="keyword"> const</span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span> </div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>  <span class="keyword">const</span> <a class="code hl_class" href="classChamp__Face.html">Champ_Face</a>&amp; vit = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classChamp__Face.html">Champ_Face</a>, <a class="code hl_variable" href="classMorEqn.html#a47b12fa29b57783a8a5897f7611e2176">mon_equation</a>-&gt;<a class="code hl_function" href="classEquation__base.html#a3cfe6b771e0ff255b3c93576b27019b0">inconnue</a>().<a class="code hl_function" href="classDeriv__Champ__Inc__base.html#adaa8a3a0efb270f0bbd11311787b5c8d">valeur</a>());</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_VDF = <a class="code hl_variable" href="classChamp__Face.html#a84b6abcd128000e1d5759caaa7ae0dee">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>  <span class="keywordtype">int</span> nb_elem = zone_VDF.<a class="code hl_function" href="classZone__dis__base.html#aae671a49c7b02a69054a38bddb486cf8">zone</a>().<a class="code hl_function" href="classZone.html#a19914240567d6e050f9129da531065d3">nb_elem_tot</a>();</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; face_voisins = zone_VDF.<a class="code hl_function" href="classZone__VF.html#a1935d5babef3e13a64d7b997ce94cdd0">face_voisins</a>();</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code hl_function" href="classZone__VF.html#a301c10a40fa5d518f3653d29a0fa621e">elem_faces</a>();</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; Qdm = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a584ecc1a81b2df74c2d7f673d5b20aef">Qdm</a>();</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">IntVect</a>&amp; orientation = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a71671288eceb9fe858d5554b6ad2f039">orientation</a>();</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span> </div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>  <span class="keywordtype">int</span> premiere_arete_mixte = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a6c148c4cdce19b3567307528ae04e750">premiere_arete_mixte</a>();</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>  <span class="keywordtype">int</span> premiere_arete_interne =  zone_VDF.<a class="code hl_function" href="classZone__VDF.html#afa03b1328f08c582e0d66b483ee593e8">premiere_arete_interne</a>();</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>  <span class="keywordtype">int</span> derniere_arete_mixte = premiere_arete_mixte+zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a08655f468ca47527b7a2a4e6a741a5c4">nb_aretes_mixtes</a>();</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>  <span class="keywordtype">int</span> derniere_arete_interne = premiere_arete_interne+zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a79e37e7e12b6ef3540c11103f3683424">nb_aretes_internes</a>();</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>  <span class="keywordtype">int</span> elem;</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>  <span class="keywordtype">int</span> num_arete;</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>  <a class="code hl_class" href="classTRUSTVect.html">IntVect</a> element(4);</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>  <span class="keywordtype">int</span> num0,num1,num2,num3,signe;</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>  <span class="keywordtype">int</span> ndeb = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#ac675a4264c083706bc6fd2c71b25d2b0">premiere_arete_bord</a>();</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>  <span class="keywordtype">int</span> nfin = ndeb + zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aed93093e7f0c2707c70aae768fdc5b38">nb_aretes_bord</a>();</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>  <span class="keywordtype">int</span> n_type;</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span> </div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>  gij = 0.;</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span> </div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span> </div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span><span class="comment">//</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span><span class="comment">// On parcourt toutes les aretes qui permettent</span></div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span><span class="comment">// de calculer les termes croises dui/dxj.</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span><span class="comment">// </span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span><span class="comment">// (les termes non-croises sont calcules</span></div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span><span class="comment">// en bouclant sur les elements)</span></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span><span class="comment">//</span></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span> </div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>  <span class="keywordflow">for</span> (num_arete=ndeb; num_arete&lt;nfin; num_arete++)</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>    {</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>      n_type=zone_Cl_VDF.<a class="code hl_function" href="classZone__Cl__VDF.html#ab16cb010aa77639debd69f3b93470d00">type_arete_bord</a>(num_arete-ndeb);</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span> </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>      <span class="keywordflow">if</span> (n_type == 4) <span class="comment">//!&lt; arete de type periodicite</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>        {</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>          num0 = Qdm(num_arete,0);</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>          num1 = Qdm(num_arete,1);</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>          num2 = Qdm(num_arete,2);</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>          num3 = Qdm(num_arete,3);</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>          <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>          <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>          i=orientation(num0);</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>          j=orientation(num2);</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span> </div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>          <span class="keywordtype">double</span> temp1 = (vitesse[num1]-vitesse[num0])</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j);            <span class="comment">//!&lt; dui/dxj</span></div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>          <span class="keywordtype">double</span> temp2 = (vitesse[num3]-vitesse[num2])</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num2,num3,i);            <span class="comment">//!&lt; duj/dxi</span></div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>          element(0) = face_voisins(num0,0);</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>          element(1) = face_voisins(num0,1);</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>          element(2) = face_voisins(num1,0);</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>          element(3) = face_voisins(num1,1);</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k&lt;4 ; k++)</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>            {</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>              gij(element(k),i,j)+=temp1*0.5*0.25;</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>              gij(element(k),j,i)+=temp2*0.5*0.25;</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span> </div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span><span class="comment">// Justification des coeff derriere :</span></div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span><span class="comment">// 1) 0.5 : pour la periodicite,</span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span><span class="comment">// car on distribuera deux fois sur</span></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span><span class="comment">// les elements qui &quot;touchent&quot; cette arete</span></div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span><span class="comment">// puisqu&#39;elle existe en double.</span></div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span><span class="comment">// 2) 0.25 : on distribue le gradient de vitesse</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span><span class="comment">// sur les 4 elements qui l&#39;entourent.</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>            }        <span class="comment">//!&lt; fin du for k</span></div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>        }</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>        {</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>          num0 = Qdm(num_arete,0);</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>          num1 = Qdm(num_arete,1);</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>          num2 = Qdm(num_arete,2);</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>          signe = Qdm(num_arete,3);</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>          <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>          j=orientation(num2);</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span> </div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>          <span class="keywordtype">double</span> temp2;</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>          <span class="keywordtype">double</span> temp1 = (vitesse[num1]-vitesse[num0])</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j);        <span class="comment">//!&lt; dui/dxj</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>          <span class="keywordtype">double</span> vit_imp = 0.5*(vit.<a class="code hl_function" href="classChamp__Face.html#ab6fe8ab6f95e95d166df36d07e0e1263">val_imp_face_bord_private</a>(num0,j)+</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>                                vit.<a class="code hl_function" href="classChamp__Face.html#ab6fe8ab6f95e95d166df36d07e0e1263">val_imp_face_bord_private</a>(num1,j));                <span class="comment">//!&lt; vitesse tangentielle Dans cette partie, on conserve le codage de Hyd_SGE_Wale_VDF (num1 et non num2) pour calculer la distance entre le centre de la maille et le bord.</span></div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span><span class="comment">//</span></div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span><span class="comment">//</span></div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span> </div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>          temp2 = -signe*(vitesse[num2]-vit_imp)/zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9cef0210dfce071f039154ec8076044a">dist_norm_bord</a>(num1);</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span> </div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>          element(0) = face_voisins(num2,0);</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>          element(1) = face_voisins(num2,1);</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span> </div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>          <span class="keywordtype">int</span> i=orientation(num0);</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span> </div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k&lt;2 ; k++)</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>            {</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>              gij(element(k),i,j)+=temp1*0.25;</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>              gij(element(k),j,i)+=temp2*0.25;</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span> </div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span><span class="comment">// Justification des coeff derriere :</span></div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span><span class="comment">// 1) 0.25 : on distribue le gradient de vitesse</span></div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span><span class="comment">// sur les 4 elements qui l&#39;entourent.</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>            } <span class="comment">//!&lt; fin du for k</span></div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>        }</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>    }</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span> </div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span> </div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>  <span class="comment">//*******************************</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>  <span class="comment">//On parcourt les aretes coins</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>  <span class="comment">//*******************************</span></div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span> </div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>  ndeb = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aa0c72355a8be1eacca235efab948ed6d">premiere_arete_coin</a>();</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>  nfin = ndeb + zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a3d078d9bcca8434dc676c2ef2b594f5a">nb_aretes_coin</a>();</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span> </div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>  <span class="keywordflow">for</span> (num_arete=ndeb; num_arete&lt;nfin; num_arete++)</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>    {</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>      n_type=zone_Cl_VDF.<a class="code hl_function" href="classZone__Cl__VDF.html#a6232c94f3b251914b7b3a0d05a92f00c">type_arete_coin</a>(num_arete-ndeb);</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>      <span class="comment">//***************************************</span></div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>      <span class="comment">// Traitement des aretes coin perio-perio</span></div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>      <span class="comment">//***************************************</span></div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span> </div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>      <span class="keywordflow">if</span> (n_type == 0) <span class="comment">// arete de type periodicite-periodicite</span></div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>        {</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>          num0 = Qdm(num_arete,0);</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>          num1 = Qdm(num_arete,1);</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>          num2 = Qdm(num_arete,2);</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>          num3 = Qdm(num_arete,3);</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>          <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>          <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>          i=orientation(num0);</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>          j=orientation(num2);</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span> </div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>          <span class="keywordtype">double</span> temp1 = (vitesse[num1]-vitesse[num0])</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j);        <span class="comment">// dui/dxj</span></div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>          <span class="keywordtype">double</span> temp2 = (vitesse[num3]-vitesse[num2])</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num2,num3,i);        <span class="comment">// duj/dxi</span></div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>          element(0) = face_voisins(num0,0);</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>          element(1) = face_voisins(num0,1);</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>          element(2) = face_voisins(num1,0);</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>          element(3) = face_voisins(num1,1);</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k&lt;4 ; k++)</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>            {</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>              gij(element(k),i,j)+=temp1*0.5*0.5*0.25;</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>              gij(element(k),j,i)+=temp2*0.5*0.5*0.25;</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span> </div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>              <span class="comment">// Justification des coeff derriere :</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>              <span class="comment">// 1) 0.5 : pour la periodicite,</span></div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>              <span class="comment">//           car on distribuera deux fois sur</span></div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>              <span class="comment">//           les elements qui &quot;touchent&quot; cette arete</span></div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>              <span class="comment">//           puisqu&#39;elle existe en double.</span></div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>              <span class="comment">// 2) 0.5 : idem ci-dessus, car cette fois-ci on a</span></div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>              <span class="comment">//           un coin perio-perio.</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>              <span class="comment">// 3) 0.25 : on distribue le gradient de vitesse</span></div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>              <span class="comment">//            sur les 4 elements qui l&#39;entourent.</span></div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>            } <span class="comment">// fin du for k</span></div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span> </div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>        }</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span> </div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>      <span class="comment">//***************************************</span></div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>      <span class="comment">// Traitement des aretes coin perio-paroi</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>      <span class="comment">//***************************************</span></div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>      <span class="keywordflow">if</span> (n_type == 1) <span class="comment">// arete de type periodicite-paroi</span></div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>        {</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>          num0 = Qdm(num_arete,0);</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>          num1 = Qdm(num_arete,1);</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>          num2 = Qdm(num_arete,2);</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>          signe = Qdm(num_arete,3);</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>          <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>          j=orientation(num2);</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span> </div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>          <span class="keywordtype">double</span> temp2;</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>          <span class="keywordtype">double</span> temp1 = (vitesse[num1]-vitesse[num0])</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j);                <span class="comment">// dui/dxj</span></div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>          <span class="keywordtype">double</span> vit_imp = 0.5*(vit.<a class="code hl_function" href="classChamp__Face.html#ab6fe8ab6f95e95d166df36d07e0e1263">val_imp_face_bord_private</a>(num0,j)+</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>                                vit.<a class="code hl_function" href="classChamp__Face.html#ab6fe8ab6f95e95d166df36d07e0e1263">val_imp_face_bord_private</a>(num1,j));        <span class="comment">// vitesse tangentielle</span></div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span> </div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>          temp2  = -signe*(vitesse[num2]-vit_imp)/zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9cef0210dfce071f039154ec8076044a">dist_norm_bord</a>(num1);</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span> </div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>          element(0) = face_voisins(num2,0);</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>          element(1) = face_voisins(num2,1);</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span> </div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>          <span class="keywordtype">int</span> i=orientation(num1);</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span> </div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k&lt;2 ; k++)</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>            {</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>              gij(element(k),i,j)+=temp1*0.5*0.25;</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>              gij(element(k),j,i)+=temp2*0.5*0.25;</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span> </div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>              <span class="comment">// Justification des coeff derriere :</span></div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>              <span class="comment">// 1) 0.5 : pour la periodicite,</span></div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>              <span class="comment">//           car on distribuera deux fois sur</span></div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>              <span class="comment">//           les elements qui &quot;touchent&quot; cette arete</span></div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>              <span class="comment">//           puisqu&#39;elle existe en double.</span></div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>              <span class="comment">// 2) 0.25 : on distribue le gradient de vitesse</span></div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>              <span class="comment">//            sur les 4 elements qui l&#39;entourent.</span></div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>            } <span class="comment">// fin du for k</span></div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>        }</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>    }</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span> </div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span> </div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>  <span class="comment">// 1ere partie:boucles sur les aretes et remplissage de Sij pour la partie</span></div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>  <span class="comment">// derivees croisees (dui/dxj)</span></div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>  <span class="comment">// vitesse[face] renvoie la vitesse NORMALE a la face</span></div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>  <span class="comment">//   for (num_arete = premiere_arete_bord ; num_arete&lt;derniere_arete_bord ; num_arete ++)</span></div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>  <span class="comment">//     {</span></div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>  <span class="comment">//       const IntVect&amp; type_arete_bord = zone_Cl_VDF.type_arete_bord();</span></div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span> </div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span> </div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>  <span class="keywordflow">for</span>(num_arete=premiere_arete_mixte ; num_arete&lt;derniere_arete_mixte ; num_arete ++)</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>    {</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>      num0 = Qdm(num_arete,0);</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>      num1 = Qdm(num_arete,1);</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>      num2 = Qdm(num_arete,2);</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>      num3 = Qdm(num_arete,3);</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>      <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>      <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>      i=orientation(num0);</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>      j=orientation(num2);</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span> </div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>      <span class="keywordtype">double</span> temp1 = (vitesse[num1]-vitesse[num0])</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>                     /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j);        <span class="comment">// dui/dxj</span></div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>      <span class="keywordtype">double</span> temp2 = (vitesse[num3]-vitesse[num2])</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>                     /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num2,num3,i);        <span class="comment">// duj/dxi</span></div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span> </div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>      element(0) = face_voisins(num0,0);</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>      element(1) = face_voisins(num0,1);</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>      element(2) = face_voisins(num1,0);</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>      element(3) = face_voisins(num1,1);</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span> </div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k&lt;4 ; k++)</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>        {</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>          <span class="keywordflow">if</span> (element(k)!=-1)</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>            {</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>              gij(element(k),i,j)+=temp1*0.25;</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>              gij(element(k),j,i)+=temp2*0.25;</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span> </div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>              <span class="comment">// Justification des coeff derriere :</span></div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>              <span class="comment">// 1) 0.25 : on distribue le gradient de vitesse</span></div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>              <span class="comment">//            sur les 3 elements qui l&#39;entourent.</span></div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>              <span class="comment">//            C&#39;est pour cela que l&#39;on regarde si element(k)!=-1,</span></div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>              <span class="comment">//            car dans ce cas la, c&#39;est qu&#39;il s&#39;agit de &quot;la case qui manque&quot; !</span></div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>            } <span class="comment">// fin de else if</span></div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>        } <span class="comment">// fin du for k</span></div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>    } <span class="comment">// fin de la boucle sur les aretes mixtes</span></div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span> </div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span> </div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>  <span class="keywordflow">for</span> (num_arete=premiere_arete_interne ; num_arete&lt;derniere_arete_interne ; num_arete ++)</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>    {</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>      num0 = Qdm(num_arete,0);</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>      num1 = Qdm(num_arete,1);</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>      num2 = Qdm(num_arete,2);</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>      num3 = Qdm(num_arete,3);</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>      <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>      <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>      i=orientation(num0);</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>      j=orientation(num2);</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span> </div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>      <span class="keywordtype">double</span> temp1 = (vitesse[num1]-vitesse[num0])</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>                     /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j);        <span class="comment">// dui/dxj</span></div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>      assert(<a class="code hl_function" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j),zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a0157fd22066ae44910e23ccaab511b1c">dist_face</a>(num0,num1,j)));</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>      <span class="keywordtype">double</span> temp2 = (vitesse[num3]-vitesse[num2])</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>                     /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num2,num3,i);        <span class="comment">// duj/dxi</span></div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>      assert(<a class="code hl_function" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num2,num3,j),zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a0157fd22066ae44910e23ccaab511b1c">dist_face</a>(num2,num3,j)));</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>      element(0) = face_voisins(num0,0);</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>      element(1) = face_voisins(num0,1);</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>      element(2) = face_voisins(num1,0);</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>      element(3) = face_voisins(num1,1);</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k&lt;4 ; k++)</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>        {</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>          gij(element(k),i,j)+=temp1*0.25;</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>          gij(element(k),j,i)+=temp2*0.25;</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span> </div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>          <span class="comment">// Justification des coeff :</span></div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>          <span class="comment">// 1) 0.25 : on distribue le gradient de vitesse</span></div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>          <span class="comment">//            sur les 4 elements qui l&#39;entourent.</span></div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>        } <span class="comment">// fin du for k</span></div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>    } <span class="comment">// fin de la boucle sur les aretes internes</span></div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span> </div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span> </div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span> </div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>  <span class="comment">// 2eme partie: boucle sur les elements et remplissage de Sij pour les</span></div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>  <span class="comment">//  derivees non croisees (dui/dxi).</span></div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>  <span class="comment">// En fait dans ces cas la, on calcul directement le gradient dans l&#39;element</span></div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>  <span class="comment">//  et on ne redistribue pas.</span></div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span> </div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>  <span class="keywordflow">for</span>(elem=0 ; elem&lt;nb_elem ; elem ++)</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>    {</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0 ; i&lt;<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>        {</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>          <span class="keywordtype">double</span> temp1 = (vitesse[elem_faces(elem,i)]</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>                          -vitesse[elem_faces(elem,i+<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>)])</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(elem,orientation(elem_faces(elem,i)));</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span> </div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>          gij(elem,i,i)=-temp1;</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span> </div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>        }</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>    }</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span> </div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>  <span class="keywordflow">return</span> gij;</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>}</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span><span class="comment"></span> </div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span><span class="comment">/////////////////////////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span><span class="comment"></span><span class="comment">//Methode qui renvoie gij aux elements a partir de la vitesse aux elements</span></div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span><span class="comment">//(gij represente la derivee partielle dui/dxj)</span></div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span><span class="comment">//</span></div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span><span class="comment">//A partir de gij, on peut calculer Sij = 0.5(gij(i,j)+gij(j,i))</span></div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span><span class="comment">////////////////////////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span><span class="comment"></span> </div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span> </div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno"><a class="line" href="classChamp__Face.html#a3917b4658637beba61fb02b45b85d8b6">  987</a></span><a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; <a class="code hl_function" href="classChamp__Face.html#a3917b4658637beba61fb02b45b85d8b6">Champ_Face::calcul_duidxj</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; in_vel, <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; gij)<span class="keyword"> const</span></div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span> </div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_VDF = <a class="code hl_variable" href="classChamp__Face.html#a84b6abcd128000e1d5759caaa7ae0dee">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>  <span class="keywordtype">int</span> nb_elem_tot = zone_VDF.<a class="code hl_function" href="classZone__dis__base.html#aae671a49c7b02a69054a38bddb486cf8">zone</a>().<a class="code hl_function" href="classZone.html#a19914240567d6e050f9129da531065d3">nb_elem_tot</a>();</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; face_voisins = zone_VDF.<a class="code hl_function" href="classZone__VF.html#a1935d5babef3e13a64d7b997ce94cdd0">face_voisins</a>();</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code hl_function" href="classZone__VF.html#a301c10a40fa5d518f3653d29a0fa621e">elem_faces</a>();</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span> </div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>  <span class="keywordtype">int</span> element_number;</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>  <span class="keywordtype">int</span> num0,num1,num2,num3,num4,num5;</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>  <span class="keywordtype">int</span> f0,<a class="code hl_define" href="Lois__sodium_8h.html#a3034a1fb8c782842a2b9473c0f02a448">f1</a>,<a class="code hl_define" href="Lois__sodium_8h.html#a23f45359b08cb1d0538697b4f2d3dbbe">f2</a>,f3,f4,f5;</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span> </div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span> </div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>  <span class="comment">//</span></div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>  <span class="comment">// Calculate the Sij tensor</span></div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>  <span class="comment">//</span></div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ==2)</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>    {</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>      <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem_tot ; element_number ++)</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>        {</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>          f0 = elem_faces(element_number,0);</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>          num0 = face_voisins(f0,0);</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>          <span class="keywordflow">if</span> (num0 == -1)</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>            num0 = element_number;</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>          <a class="code hl_define" href="Lois__sodium_8h.html#a3034a1fb8c782842a2b9473c0f02a448">f1</a> = elem_faces(element_number,1);</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>          num1 = face_voisins(<a class="code hl_define" href="Lois__sodium_8h.html#a3034a1fb8c782842a2b9473c0f02a448">f1</a>,0);</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>          <span class="keywordflow">if</span> (num1 == -1)</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>            num1 = element_number;</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>          <a class="code hl_define" href="Lois__sodium_8h.html#a23f45359b08cb1d0538697b4f2d3dbbe">f2</a> = elem_faces(element_number,2);</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>          num2 = face_voisins(<a class="code hl_define" href="Lois__sodium_8h.html#a23f45359b08cb1d0538697b4f2d3dbbe">f2</a>,1);</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>          <span class="keywordflow">if</span> (num2 == -1)</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>            num2 = element_number;</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>          f3 = elem_faces(element_number,3);</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>          num3 = face_voisins(f3,1);</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>          <span class="keywordflow">if</span> (num3 == -1)</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>            num3 = element_number;</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span> </div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>          gij(element_number,0,0)=0.5*((in_vel(num2,0)-in_vel(num0,0))/</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>                                       zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,0));</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>          gij(element_number,0,1) = 0.5*((in_vel(num3,0)-in_vel(num1,0))/zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,1));</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>          gij(element_number,1,0) = 0.5*((in_vel(num2,1)-in_vel(num0,1))/zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,0));</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>          gij(element_number,1,1)=0.5*((in_vel(num3,1)-in_vel(num1,1))/</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>                                       zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,1));</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>        }</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>    }</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>    {</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>      <span class="keywordflow">for</span> (element_number=0 ; element_number&lt;nb_elem_tot ; element_number ++)</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>        {</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>          f0 = elem_faces(element_number,0);</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>          num0 = face_voisins(f0,0);</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>          <span class="keywordflow">if</span> (num0 == -1)</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>            num0 = element_number;</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>          <a class="code hl_define" href="Lois__sodium_8h.html#a3034a1fb8c782842a2b9473c0f02a448">f1</a> = elem_faces(element_number,1);</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>          num1 = face_voisins(<a class="code hl_define" href="Lois__sodium_8h.html#a3034a1fb8c782842a2b9473c0f02a448">f1</a>,0);</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>          <span class="keywordflow">if</span> (num1 == -1)</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>            num1 = element_number;</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>          <a class="code hl_define" href="Lois__sodium_8h.html#a23f45359b08cb1d0538697b4f2d3dbbe">f2</a> = elem_faces(element_number,2);</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>          num2 = face_voisins(<a class="code hl_define" href="Lois__sodium_8h.html#a23f45359b08cb1d0538697b4f2d3dbbe">f2</a>,0);</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>          <span class="keywordflow">if</span> (num2 == -1)</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>            num2 = element_number;</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>          f3 = elem_faces(element_number,3);</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>          num3 = face_voisins(f3,1);</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>          <span class="keywordflow">if</span> (num3 == -1)</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>            num3 = element_number;</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>          f4 = elem_faces(element_number,4);</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>          num4 = face_voisins(f4,1);</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>          <span class="keywordflow">if</span> (num4 == -1)</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>            num4 = element_number;</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>          f5 = elem_faces(element_number,5);</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>          num5 = face_voisins(f5,1);</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>          <span class="keywordflow">if</span> (num5 == -1)</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>            num5 = element_number;</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span> </div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>          gij(element_number,0,0)=0.5*((in_vel(num3,0)-in_vel(num0,0))/</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>                                       zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,0));</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span> </div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>          gij(element_number,0,1) = 0.5*((in_vel(num4,0)-in_vel(num1,0))/</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>                                         zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,1));</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>          gij(element_number,1,0) = 0.5*((in_vel(num3,1)-in_vel(num0,1))/</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>                                         zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,0));</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span> </div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>          gij(element_number,0,2) =  0.5*((in_vel(num5,0)-in_vel(num2,0))/</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>                                          zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,2));</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span> </div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>          gij(element_number,2,0) = 0.5*((in_vel(num3,2)-in_vel(num0,2))/</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>                                         zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,0));</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span> </div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>          gij(element_number,1,1)=0.5*((in_vel(num4,1)-in_vel(num1,1))/</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>                                       zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,1));</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span> </div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>          gij(element_number,1,2) = 0.5*((in_vel(num5,1)-in_vel(num2,1))/</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>                                         zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,2));</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>          gij(element_number,2,1) = 0.5*((in_vel(num4,2)-in_vel(num1,2))/</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>                                         zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,1));</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span> </div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>          gij(element_number,2,2)=0.5*((in_vel(num5,2)-in_vel(num2,2))/</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>                                       zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(element_number,2));</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span> </div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>        }</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>    }</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span> </div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>  <span class="keywordflow">return</span> gij;</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span> </div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>}</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span><span class="comment">/*</span></div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span><span class="comment"></span> </div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span><span class="comment">DoubleTab&amp; Champ_Face::calcul_Sij(const DoubleTab&amp; duidxj, DoubleTab&amp; Sij, const Zone_Cl_VDF&amp; zone_Cl_VDF)</span></div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span><span class="comment">{</span></div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span><span class="comment"></span> </div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span><span class="comment">const Zone_VDF&amp; zone_VDF = la_zone_VDF.valeur();</span></div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span><span class="comment">const int nb_elem_tot = zone_VDF.nb_elem_tot();</span></div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span><span class="comment">int i,j,elem;</span></div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span><span class="comment"></span> </div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span><span class="comment">for(elem=0 ; elem&lt;nb_elem_tot ; elem ++)</span></div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span><span class="comment">{</span></div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span><span class="comment"></span> </div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span><span class="comment">for(i=0 ; i&lt;dimension ; i ++)</span></div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span><span class="comment">for(j=0 ; j&lt;dimension ; j ++)</span></div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span><span class="comment">{</span></div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span><span class="comment">Sij(elem,i,j)=0.5*(duidxj(elem,i,j) + duidxj(elem,j,i));</span></div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span><span class="comment">}</span></div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span><span class="comment">}</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span><span class="comment"></span> </div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span><span class="comment">return Sij;</span></div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span><span class="comment">}</span></div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span><span class="comment">*/</span></div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span> </div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span><span class="comment"></span> </div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span><span class="comment">/////////////////////////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span><span class="comment"></span><span class="comment">//Methode qui renvoie SMA_barre aux elements a partir de la vitesse aux faces</span></div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span><span class="comment">//SMA_barre = Sij*Sij (sommation sur les indices i et j)</span><span class="comment"></span></div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span><span class="comment">////////////////////////////////////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span><span class="comment"></span> </div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"><a class="line" href="classChamp__Face.html#a219fdd5c3a41ec14ad3d3d3e953ba84a"> 1121</a></span><a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; <a class="code hl_function" href="classChamp__Face.html#a219fdd5c3a41ec14ad3d3d3e953ba84a">Champ_Face::calcul_S_barre_sans_contrib_paroi</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; vitesse, <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; SMA_barre, <span class="keyword">const</span> <a class="code hl_class" href="classZone__Cl__VDF.html">Zone_Cl_VDF</a>&amp; zone_Cl_VDF)<span class="keyword"> const</span></div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>  <span class="comment">// On calcule directement S_barre(num_elem)!!!!!!!!!!</span></div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>  <span class="comment">// Le parametre contribution_paroi (ici fixe a 0) permet de ne pas prendre en compte</span></div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>  <span class="comment">// la contribution de la paroi au produit SMA_barre = Sij*Sij</span></div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span> </div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>  <span class="keywordtype">int</span> contribution_paroi;</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>  contribution_paroi=0;</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span> </div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>  <span class="keyword">const</span> <a class="code hl_class" href="classChamp__Face.html">Champ_Face</a>&amp; vit = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classChamp__Face.html">Champ_Face</a>, <a class="code hl_variable" href="classMorEqn.html#a47b12fa29b57783a8a5897f7611e2176">mon_equation</a>-&gt;<a class="code hl_function" href="classEquation__base.html#a3cfe6b771e0ff255b3c93576b27019b0">inconnue</a>().<a class="code hl_function" href="classDeriv__Champ__Inc__base.html#adaa8a3a0efb270f0bbd11311787b5c8d">valeur</a>());</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_VDF = <a class="code hl_variable" href="classChamp__Face.html#a84b6abcd128000e1d5759caaa7ae0dee">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span> </div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>  <span class="keywordtype">int</span> nb_elem = zone_VDF.<a class="code hl_function" href="classZone__dis__base.html#aae671a49c7b02a69054a38bddb486cf8">zone</a>().<a class="code hl_function" href="classZone.html#a8bdea22b5802d97c07acd9e97de5eb88">nb_elem</a>();</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; face_voisins = zone_VDF.<a class="code hl_function" href="classZone__VF.html#a1935d5babef3e13a64d7b997ce94cdd0">face_voisins</a>();</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code hl_function" href="classZone__VF.html#a301c10a40fa5d518f3653d29a0fa621e">elem_faces</a>();</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; Qdm = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a584ecc1a81b2df74c2d7f673d5b20aef">Qdm</a>();</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">IntVect</a>&amp; orientation = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a71671288eceb9fe858d5554b6ad2f039">orientation</a>();</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span> </div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>  <span class="keywordtype">int</span> premiere_arete_mixte = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a6c148c4cdce19b3567307528ae04e750">premiere_arete_mixte</a>();</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>  <span class="keywordtype">int</span> premiere_arete_interne =  zone_VDF.<a class="code hl_function" href="classZone__VDF.html#afa03b1328f08c582e0d66b483ee593e8">premiere_arete_interne</a>();</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>  <span class="keywordtype">int</span> derniere_arete_mixte = premiere_arete_mixte+zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a08655f468ca47527b7a2a4e6a741a5c4">nb_aretes_mixtes</a>();</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>  <span class="keywordtype">int</span> derniere_arete_interne = premiere_arete_interne+zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a79e37e7e12b6ef3540c11103f3683424">nb_aretes_internes</a>();</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>  <span class="keywordtype">int</span> elem;</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>  <span class="keywordtype">int</span> num_arete;</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a> element(4);</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span> </div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>  <span class="keywordtype">int</span> num0,num1,num2,num3,signe;</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>  <span class="keywordtype">int</span> ndeb = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#ac675a4264c083706bc6fd2c71b25d2b0">premiere_arete_bord</a>();</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>  <span class="keywordtype">int</span> nfin = ndeb + zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aed93093e7f0c2707c70aae768fdc5b38">nb_aretes_bord</a>();</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>  <span class="keywordtype">int</span> n_type;</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span> </div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>  <span class="keywordflow">for</span> (num_arete=ndeb; num_arete&lt;nfin; num_arete++)</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>    {</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>      n_type=zone_Cl_VDF.<a class="code hl_function" href="classZone__Cl__VDF.html#ab16cb010aa77639debd69f3b93470d00">type_arete_bord</a>(num_arete-ndeb);</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span> </div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>      <span class="keywordflow">if</span> (n_type == 4) <span class="comment">// arete de type periodicite</span></div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>        {</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>          num0 = Qdm(num_arete,0);</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>          num1 = Qdm(num_arete,1);</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>          num2 = Qdm(num_arete,2);</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>          num3 = Qdm(num_arete,3);</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>          <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>          <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>          i=orientation(num0);</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>          j=orientation(num2);</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span> </div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>          <span class="keywordtype">double</span> temp1 = (vitesse[num1]-vitesse[num0])</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j);            <span class="comment">// dv/dx</span></div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>          <span class="keywordtype">double</span> temp2 = (vitesse[num3]-vitesse[num2])</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num2,num3,i);            <span class="comment">// du/dy</span></div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>          element[0] = face_voisins(num0,0);</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>          element[1] = face_voisins(num0,1);</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>          element[2] = face_voisins(num1,0);</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>          element[3] = face_voisins(num1,1);</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k&lt;4 ; k++)</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>            {</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>              SMA_barre[element[k]]+=0.5*(temp1+temp2)*(temp1+temp2)*0.25;</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>              <span class="comment">// Justification du coeff :</span></div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>              <span class="comment">// on calcule la somme des termes croises :</span></div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>              <span class="comment">// 2*( (0.5*Sij)^2+(0.5*Sji)^2)</span></div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>              <span class="comment">// Comme on est sur les aretes et qu on distribue sur l&#39;element</span></div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>              <span class="comment">// il faut multiplier par 0.25</span></div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>              <span class="comment">// d ou : 0.25*(2*(2*0.5^2))=0.25*4*0.25=0.25!!!!!!</span></div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>              <span class="comment">// le 0.5 devant vient du fait que nous parcourons les faces de periodicite</span></div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>              <span class="comment">// comme les aretes periodiques sont les &quot;memes&quot;, on ajoute deux fois ce qu il faut</span></div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>              <span class="comment">// aux elements -&gt; 0.5!!!</span></div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>            }        <span class="comment">// fin du for k</span></div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>        }</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>        {</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>          num0 = Qdm(num_arete,0);</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>          num1 = Qdm(num_arete,1);</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>          num2 = Qdm(num_arete,2);</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>          signe = Qdm(num_arete,3);</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>          <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>          j=orientation(num2);</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span> </div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>          <span class="keywordtype">double</span> temp2;</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>          <span class="keywordtype">double</span> temp1 = (vitesse[num1]-vitesse[num0])</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j);        <span class="comment">// dv/dx</span></div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>          <span class="keywordtype">double</span> vit_imp = 0.5*(vit.<a class="code hl_function" href="classChamp__Face.html#ab6fe8ab6f95e95d166df36d07e0e1263">val_imp_face_bord_private</a>(num0,j)+</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>                                vit.<a class="code hl_function" href="classChamp__Face.html#ab6fe8ab6f95e95d166df36d07e0e1263">val_imp_face_bord_private</a>(num1,j));                <span class="comment">// vitesse tangentielle</span></div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span> </div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>          <span class="keywordflow">if</span> ( n_type == 0 &amp;&amp; contribution_paroi == 0 )</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>            temp2 = 0;</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>            temp2  = -signe*(vitesse[num2]-vit_imp)/zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9cef0210dfce071f039154ec8076044a">dist_norm_bord</a>(num1);</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span> </div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>          element[0] = face_voisins(num2,0);</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>          element[1] = face_voisins(num2,1);</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span> </div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k&lt;2 ; k++)</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>            {</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>              SMA_barre[element[k]]+=(temp1+temp2)*(temp1+temp2)*0.25;</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>              <span class="comment">// Justification du coeff :</span></div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>              <span class="comment">// on calcule la somme des termes croises :</span></div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>              <span class="comment">// 2*( (0.5*Sij)^2+(0.5*Sji)^2)</span></div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>              <span class="comment">// Comme on est sur les aretes et qu on distribue sur l&#39;element</span></div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>              <span class="comment">// il faut multiplier par 0.25</span></div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>              <span class="comment">// d ou : 0.25*(2*(2*0.5^2))=0.25*4*0.25=0.25!!!!!!</span></div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>              <span class="comment">// Prise en compte des 2 termes symetriques : SijSij+SjiSji</span></div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>            }                <span class="comment">// fin du for k</span></div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>        }</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>    }</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span> </div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span><span class="comment"></span> </div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span><span class="comment">  /////////////////////////////////</span></div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span><span class="comment"></span>  <span class="comment">//On parcourt les aretes coins</span><span class="comment"></span></div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span><span class="comment">  ////////////////////////////////</span></div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span><span class="comment"></span> </div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>  ndeb = zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aa0c72355a8be1eacca235efab948ed6d">premiere_arete_coin</a>();</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>  nfin = ndeb + zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a3d078d9bcca8434dc676c2ef2b594f5a">nb_aretes_coin</a>();</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span> </div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>  <span class="keywordflow">for</span> (num_arete=ndeb; num_arete&lt;nfin; num_arete++)</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>    {</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>      n_type=zone_Cl_VDF.<a class="code hl_function" href="classZone__Cl__VDF.html#a6232c94f3b251914b7b3a0d05a92f00c">type_arete_coin</a>(num_arete-ndeb);<span class="comment"></span></div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span><span class="comment">      //////////////////////////////////////////</span></div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span><span class="comment"></span>      <span class="comment">// Traitement des aretes coin perio-perio</span><span class="comment"></span></div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span><span class="comment">      //////////////////////////////////////////</span></div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span><span class="comment"></span> </div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>      <span class="keywordflow">if</span> (n_type == 0) <span class="comment">// arete de type periodicite-periodicite</span></div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>        {</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>          num0 = Qdm(num_arete,0);</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>          num1 = Qdm(num_arete,1);</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>          num2 = Qdm(num_arete,2);</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>          num3 = Qdm(num_arete,3);</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>          <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>          <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>          i=orientation(num0);</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>          j=orientation(num2);</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span> </div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>          <span class="keywordtype">double</span> temp1 = (vitesse[num1]-vitesse[num0])</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j);            <span class="comment">// dv/dx</span></div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>          <span class="keywordtype">double</span> temp2 = (vitesse[num3]-vitesse[num2])</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num2,num3,i);            <span class="comment">// du/dy</span></div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>          element[0] = face_voisins(num0,0);</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>          element[1] = face_voisins(num0,1);</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>          element[2] = face_voisins(num1,0);</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>          element[3] = face_voisins(num1,1);</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k&lt;4 ; k++)</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>            {</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>              SMA_barre[element[k]]+=0.5*0.5*(temp1+temp2)*(temp1+temp2)*0.25;</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>              <span class="comment">// Justification du coeff :</span></div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>              <span class="comment">// on calcule la somme des termes croises :</span></div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>              <span class="comment">// 2*( (0.5*Sij)^2+(0.5*Sji)^2)</span></div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>              <span class="comment">// Comme on est sur les aretes et qu on distribue sur l&#39;element</span></div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>              <span class="comment">// il faut multiplier par 0.25</span></div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>              <span class="comment">// d ou : 0.25*(2*(2*0.5^2))=0.25*4*0.25=0.25!!!!!!</span></div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>              <span class="comment">// le 0.5 devant vient du fait que nous parcourons les faces de periodicite</span></div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>              <span class="comment">// comme les aretes periodiques sont les &quot;memes&quot;, on ajoute deux fois ce qu il faut</span></div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>              <span class="comment">// aux elements -&gt; 0.5!!!</span></div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>              <span class="comment">// encore un *0.5 car ce sont des aretes perio perio donc que l on parcourt 4 fois!!!!</span></div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>            }        <span class="comment">// fin du for k</span></div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span> </div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>        }</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span><span class="comment"></span> </div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span><span class="comment">      //////////////////////////////////////////</span></div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span><span class="comment"></span>      <span class="comment">// Traitement des aretes coin perio-paroi</span><span class="comment"></span></div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span><span class="comment">      //////////////////////////////////////////</span></div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span><span class="comment"></span>      <span class="keywordflow">if</span> (n_type == 1) <span class="comment">// arete de type periodicite-paroi</span></div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>        {</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>          num0 = Qdm(num_arete,0);</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>          num1 = Qdm(num_arete,1);</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>          num2 = Qdm(num_arete,2);</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>          signe = Qdm(num_arete,3);</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>          <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>          j=orientation(num2);</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span> </div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>          <span class="keywordtype">double</span> temp2;</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>          <span class="keywordtype">double</span> temp1 = (vitesse[num1]-vitesse[num0])</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j);        <span class="comment">// dv/dx</span></div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>          <span class="keywordtype">double</span> vit_imp = 0.5*(vit.<a class="code hl_function" href="classChamp__Face.html#ab6fe8ab6f95e95d166df36d07e0e1263">val_imp_face_bord_private</a>(num0,j)+</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>                                vit.<a class="code hl_function" href="classChamp__Face.html#ab6fe8ab6f95e95d166df36d07e0e1263">val_imp_face_bord_private</a>(num1,j));             <span class="comment">// vitesse tangentielle</span></div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span> </div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>          <span class="keywordflow">if</span> ( contribution_paroi == 0 )</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>            temp2 = 0;</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>            temp2  = -signe*(vitesse[num2]-vit_imp)/zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9cef0210dfce071f039154ec8076044a">dist_norm_bord</a>(num1);</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span> </div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>          element[0] = face_voisins(num2,0);</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>          element[1] = face_voisins(num2,1);</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span> </div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k&lt;2 ; k++)</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>            {</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>              SMA_barre[element[k]]+=0.5*(temp1+temp2)*(temp1+temp2)*0.25;</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>              <span class="comment">// Justification du coeff :</span></div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>              <span class="comment">// on calcule la somme des termes croises :</span></div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>              <span class="comment">// 2*( (0.5*Sij)^2+(0.5*Sji)^2)</span></div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>              <span class="comment">// Comme on est sur les aretes et qu on distribue sur l&#39;element</span></div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>              <span class="comment">// il faut multiplier par 0.25</span></div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>              <span class="comment">// d ou : 0.25*(2*(2*0.5^2))=0.25*4*0.25=0.25!!!!!!</span></div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>              <span class="comment">// Prise en compte des 2 termes symetriques : SijSij+SjiSji</span></div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>              <span class="comment">// encore un *0.5 car ce sont des aretes perio perio donc que l on parcourt 2 fois!!!!</span></div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span> </div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>            }                <span class="comment">// fin du for k</span></div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>        }</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>    }</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span> </div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span> </div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>  <span class="comment">// 1ere partie:boucles sur les aretes et remplissage de Sij pour la partie</span></div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>  <span class="comment">// derivees croisees (dv/dx+du/dy)</span></div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>  <span class="comment">// vitesse[face] renvoie la vitesse NORMALE a la face</span></div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>  <span class="comment">//   for (num_arete = premiere_arete_bord ; num_arete&lt;derniere_arete_bord ; num_arete ++)</span></div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>  <span class="comment">//     {</span></div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>  <span class="comment">//       const IntVect&amp; type_arete_bord = zone_Cl_VDF.type_arete_bord();</span></div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span> </div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span> </div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>  <span class="keywordflow">for</span>(num_arete=premiere_arete_mixte ; num_arete&lt;derniere_arete_mixte ; num_arete ++)</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>    {</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>      num0 = Qdm(num_arete,0);</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>      num1 = Qdm(num_arete,1);</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>      num2 = Qdm(num_arete,2);</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>      num3 = Qdm(num_arete,3);</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>      <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>      <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>      i=orientation(num0);</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>      j=orientation(num2);</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span> </div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>      <span class="keywordtype">double</span> temp1 = (vitesse[num1]-vitesse[num0])</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>                     /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j);          <span class="comment">// dv/dx</span></div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>      <span class="keywordtype">double</span> temp2 = (vitesse[num3]-vitesse[num2])</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>                     /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num2,num3,i);          <span class="comment">// du/dy</span></div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span> </div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>      element[0] = face_voisins(num0,0);</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>      element[1] = face_voisins(num0,1);</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>      element[2] = face_voisins(num1,0);</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>      element[3] = face_voisins(num1,1);</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span> </div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k&lt;4 ; k++)</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>        {</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>          <span class="keywordflow">if</span> (element[k]!=-1)</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>            {</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>              SMA_barre[element[k]]+=(temp1+temp2)*(temp1+temp2)*0.25;</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>              <span class="comment">// Justification du coeff :</span></div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>              <span class="comment">// on calcule la somme des termes croises :</span></div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>              <span class="comment">// 2*( (0.5*Sij)^2+(0.5*Sji)^2)</span></div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>              <span class="comment">// Comme on est sur les aretes et qu on distribue sur l&#39;element</span></div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>              <span class="comment">// il faut multiplier par 0.25</span></div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>              <span class="comment">// d ou : 0.25*(2*(2*0.5^2))=0.25*4*0.25=0.25!!!!!!</span></div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>              <span class="comment">// Prise en compte des 2 termes symetriques : SijSij+SjiSji</span></div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>            }        <span class="comment">// fin de else if</span></div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>        }                <span class="comment">// fin du for k</span></div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>    }                <span class="comment">// fin de la boucle sur les aretes mixtes</span></div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span> </div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span> </div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>  <span class="keywordflow">for</span> (num_arete=premiere_arete_interne ; num_arete&lt;derniere_arete_interne ; num_arete ++)</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>    {</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>      num0 = Qdm(num_arete,0);</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>      num1 = Qdm(num_arete,1);</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>      num2 = Qdm(num_arete,2);</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>      num3 = Qdm(num_arete,3);</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>      <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>      <span class="keywordtype">int</span> j=0;</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>      i=orientation(num0);</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>      j=orientation(num2);</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span> </div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>      <span class="keywordtype">double</span> temp1 = (vitesse[num1]-vitesse[num0])</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>                     /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num0,num1,j);            <span class="comment">// dv/dx</span></div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>      <span class="keywordtype">double</span> temp2 = (vitesse[num3]-vitesse[num2])</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>                     /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">dist_face_period</a>(num2,num3,i);            <span class="comment">// du/dy</span></div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>      element[0] = face_voisins(num0,0);</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>      element[1] = face_voisins(num0,1);</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>      element[2] = face_voisins(num1,0);</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>      element[3] = face_voisins(num1,1);</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0 ; k&lt;4 ; k++)</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>        {</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>          SMA_barre[element[k]]+=(temp1+temp2)*(temp1+temp2)*0.25;</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>          <span class="comment">// Justification du coeff :</span></div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>          <span class="comment">// on calcule la somme des termes croises :</span></div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>          <span class="comment">// 2*( (0.5*Sij)^2+(0.5*Sji)^2)</span></div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>          <span class="comment">// Comme on est sur les aretes et qu on distribue sur l&#39;element</span></div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>          <span class="comment">// il faut multiplier par 0.25</span></div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>          <span class="comment">// d ou : 0.25*(2*(2*0.5^2))=0.25*4*0.25=0.25!!!!!!</span></div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>          <span class="comment">// Prise en compte des 2 termes symetriques : SijSij+SjiSji</span></div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>        }        <span class="comment">// fin du for k</span></div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>    }        <span class="comment">// fin de la boucle sur les aretes internes</span></div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span> </div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span> </div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>  <span class="comment">// 2eme partie: boucle sur les elements et remplissage de Sij pour les</span></div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>  <span class="comment">// derivees non croisees (du/dx et dv/dy)</span></div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span> </div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>  <span class="keywordflow">for</span>(elem=0 ; elem&lt;nb_elem ; elem ++)</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>    {</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0 ; i&lt;<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>        {</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>          <span class="keywordtype">double</span> temp1 = (vitesse[elem_faces(elem,i)]</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>                          -vitesse[elem_faces(elem,i+<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>)])</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>                         /zone_VDF.<a class="code hl_function" href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">dim_elem</a>(elem,orientation(elem_faces(elem,i)));</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>          SMA_barre(elem)+=2.0*temp1*temp1;</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>        }</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>    }</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span> </div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>  <span class="comment">// On prend la racine carre!!!!!  ATTENTION SMA_barre=invariant au carre!!!</span></div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>  <span class="comment">//  racine_carree(SMA_barre)</span></div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span> </div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span> </div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>  <span class="keywordflow">return</span> SMA_barre;</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>}</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span> </div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"><a class="line" href="classChamp__Face.html#ad32e166e138d4fa92ba4221b96ba9ee1"> 1420</a></span><a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; <a class="code hl_function" href="classChamp__Face.html#ad32e166e138d4fa92ba4221b96ba9ee1">Champ_Face::calcul_S_barre</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; vitesse,<a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; SMA_barre,<span class="keyword">const</span> <a class="code hl_class" href="classZone__Cl__VDF.html">Zone_Cl_VDF</a>&amp; zone_Cl_VDF)<span class="keyword"> const</span></div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span><span class="keyword"></span>{</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_VDF = <a class="code hl_variable" href="classChamp__Face.html#a84b6abcd128000e1d5759caaa7ae0dee">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VDF.<a class="code hl_function" href="classZone__dis__base.html#a6e97d34e3642a259924718796298e09e">nb_elem_tot</a>();</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem = zone_VDF.<a class="code hl_function" href="classZone__dis__base.html#a66f0610b6936eba8d959b63b15255b4f">nb_elem</a>();</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span> </div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>  <span class="keywordtype">int</span> i,j;</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>  <span class="keywordtype">int</span> elem;</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>  <span class="keywordtype">double</span> Sij,temp;</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span> </div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>  <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a> duidxj(nb_elem_tot,<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>,<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span> </div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>  <a class="code hl_function" href="classChamp__Face.html#a3917b4658637beba61fb02b45b85d8b6">calcul_duidxj</a>(vitesse,duidxj,zone_Cl_VDF);</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span> </div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>  <span class="keywordflow">for</span> (elem=0 ; elem&lt;nb_elem; elem++)</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>    {</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>      temp = 0.;</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>      <span class="keywordflow">for</span> ( i=0 ; i&lt;<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; i++)</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>        <span class="keywordflow">for</span> ( j=0 ; j&lt;<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> ; j++)</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>          {</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>            Sij=0.5*(duidxj(elem,i,j) + duidxj(elem,j,i));</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>            temp+=Sij*Sij;</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>          }</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>      SMA_barre(elem)=2.*temp;</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>    }</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span> </div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>  <span class="keywordflow">return</span> SMA_barre;</div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span> </div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>}</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span> </div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"><a class="line" href="classChamp__Face.html#ad4426ef99f2611353a16a374a5c2c2fb"> 1450</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classChamp__Face.html#ad4426ef99f2611353a16a374a5c2c2fb">Champ_Face::calcul_grad_u</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; vitesse, <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; grad_u, <span class="keyword">const</span> <a class="code hl_class" href="classZone__Cl__VDF.html">Zone_Cl_VDF</a>&amp; zone_Cl_VDF)</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>{</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_VDF = <a class="code hl_variable" href="classChamp__Face.html#a84b6abcd128000e1d5759caaa7ae0dee">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem = zone_VDF.<a class="code hl_function" href="classZone__dis__base.html#a66f0610b6936eba8d959b63b15255b4f">nb_elem</a>();</div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VDF.<a class="code hl_function" href="classZone__dis__base.html#a6e97d34e3642a259924718796298e09e">nb_elem_tot</a>();</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span> </div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>  <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a> gradient_elem(nb_elem_tot,<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>,<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span>  gradient_elem=0.;</div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span> </div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>  <a class="code hl_function" href="classChamp__Face.html#a3917b4658637beba61fb02b45b85d8b6">calcul_duidxj</a>(vitesse,gradient_elem,zone_Cl_VDF);</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span> </div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem; elem++)</div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>    {</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>      <span class="keywordtype">int</span> comp=0;</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)</div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;<a class="code hl_variable" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; j++)</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>          {</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>            grad_u(elem,comp) = gradient_elem(elem,i,j);</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>            comp++;</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>          }</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>    }</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>}</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span> </div>
<div class="ttc" id="aCast_8h_html_a9632e68536db6c29c2b754cb55381fbe"><div class="ttname"><a href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a></div><div class="ttdeci">#define sub_type(T, r)</div><div class="ttdef"><b>Definition:</b> <a href="Cast_8h_source.html#l00047">Cast.h:47</a></div></div>
<div class="ttc" id="aCast_8h_html_ad116a7acb85c9c91e5687c44941a0d0c"><div class="ttname"><a href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a></div><div class="ttdeci">#define ref_cast(T, r)</div><div class="ttdef"><b>Definition:</b> <a href="Cast_8h_source.html#l00052">Cast.h:52</a></div></div>
<div class="ttc" id="aChamp__Face3_8cpp_html_a55b486be8c7ed3ced7518eb23eb1a2a7"><div class="ttname"><a href="Champ__Face3_8cpp.html#a55b486be8c7ed3ced7518eb23eb1a2a7">calrotord2centelemdim2</a></div><div class="ttdeci">void calrotord2centelemdim2(DoubleTab &amp;rot, const DoubleTab &amp;val, const Zone_VDF &amp;zone_VDF, int nb_elem, const IntTab &amp;face_voisins, const IntTab &amp;elem_faces)</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face2_8cpp_source.html#l00427">Champ_Face2.cpp:427</a></div></div>
<div class="ttc" id="aChamp__Face3_8cpp_html_a5e855238159aa648d515cdc0d8a5d8cf"><div class="ttname"><a href="Champ__Face3_8cpp.html#a5e855238159aa648d515cdc0d8a5d8cf">calcul_bord3D</a></div><div class="ttdeci">void calcul_bord3D(int num_elem, int elx0, int elx1, int ely0, int ely1, int elz0, int elz1, const Zone_VDF &amp;zone_VDF, const DoubleTab &amp;val, DoubleTab &amp;rot)</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face3_8cpp_source.html#l00117">Champ_Face3.cpp:117</a></div></div>
<div class="ttc" id="aChamp__Face3_8cpp_html_a701e9944e0baf4b85e01159b39b6688e"><div class="ttname"><a href="Champ__Face3_8cpp.html#a701e9944e0baf4b85e01159b39b6688e">calcul_interne3D</a></div><div class="ttdeci">void calcul_interne3D(int num_elem, int elx0, int elx1, int ely0, int ely1, int elz0, int elz1, const Zone_VDF &amp;zone_VDF, const DoubleTab &amp;val, DoubleTab &amp;rot)</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face3_8cpp_source.html#l00031">Champ_Face3.cpp:31</a></div></div>
<div class="ttc" id="aChamp__Face3_8cpp_html_ad6f2d561a2b01a55d910955d7b4964a9"><div class="ttname"><a href="Champ__Face3_8cpp.html#ad6f2d561a2b01a55d910955d7b4964a9">calrotord2centelemdim3</a></div><div class="ttdeci">void calrotord2centelemdim3(DoubleTab &amp;rot, const DoubleTab &amp;val, const Zone_VDF &amp;zone_VDF, int nb_elem, const IntTab &amp;face_voisins, const IntTab &amp;elem_faces)</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face3_8cpp_source.html#l00462">Champ_Face3.cpp:462</a></div></div>
<div class="ttc" id="aChamp__Face_8h_html"><div class="ttname"><a href="Champ__Face_8h.html">Champ_Face.h</a></div></div>
<div class="ttc" id="aChamp__Uniforme_8h_html"><div class="ttname"><a href="Champ__Uniforme_8h.html">Champ_Uniforme.h</a></div></div>
<div class="ttc" id="aDirichlet__paroi__fixe_8h_html"><div class="ttname"><a href="Dirichlet__paroi__fixe_8h.html">Dirichlet_paroi_fixe.h</a></div></div>
<div class="ttc" id="aDouble_8h_html_ac86f5f350b0f95fd8c34b0ac8d720f6f"><div class="ttname"><a href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a></div><div class="ttdeci">int est_egal(double x1, double x2, double eps)</div><div class="ttdef"><b>Definition:</b> <a href="Double_8h_source.html#l00091">Double.h:91</a></div></div>
<div class="ttc" id="aEquation__base_8h_html"><div class="ttname"><a href="Equation__base_8h.html">Equation_base.h</a></div></div>
<div class="ttc" id="aEquation__base_8h_html_a2c9d34b2cc47e5b2b18347de20a77db5a0fecbd75e0b8b4c37ffd696e173a14c7"><div class="ttname"><a href="Equation__base_8h.html#a2c9d34b2cc47e5b2b18347de20a77db5a0fecbd75e0b8b4c37ffd696e173a14c7">TURBULENCE</a></div><div class="ttdeci">@ TURBULENCE</div><div class="ttdef"><b>Definition:</b> <a href="Equation__base_8h_source.html#l00046">Equation_base.h:46</a></div></div>
<div class="ttc" id="aFluide__base_8h_html"><div class="ttname"><a href="Fluide__base_8h.html">Fluide_base.h</a></div></div>
<div class="ttc" id="aLois__sodium_8h_html_a23f45359b08cb1d0538697b4f2d3dbbe"><div class="ttname"><a href="Lois__sodium_8h.html#a23f45359b08cb1d0538697b4f2d3dbbe">f2</a></div><div class="ttdeci">#define f2(dT)</div><div class="ttdef"><b>Definition:</b> <a href="Lois__sodium_8h_source.html#l00178">Lois_sodium.h:178</a></div></div>
<div class="ttc" id="aLois__sodium_8h_html_a3034a1fb8c782842a2b9473c0f02a448"><div class="ttname"><a href="Lois__sodium_8h.html#a3034a1fb8c782842a2b9473c0f02a448">f1</a></div><div class="ttdeci">#define f1(Ts)</div><div class="ttdef"><b>Definition:</b> <a href="Lois__sodium_8h_source.html#l00176">Lois_sodium.h:176</a></div></div>
<div class="ttc" id="aMod__turb__hyd__base_8h_html"><div class="ttname"><a href="Mod__turb__hyd__base_8h.html">Mod_turb_hyd_base.h</a></div></div>
<div class="ttc" id="aZone__Cl__VDF_8h_html"><div class="ttname"><a href="Zone__Cl__VDF_8h.html">Zone_Cl_VDF.h</a></div></div>
<div class="ttc" id="aclassChamp__Don_html"><div class="ttname"><a href="classChamp__Don.html">Champ_Don</a></div><div class="ttdoc">classe Champ_Don Classe generique de la hierarchie des champs donnes, un objet Champ_Don peut referen...</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Don_8h_source.html#l00040">Champ_Don.h:41</a></div></div>
<div class="ttc" id="aclassChamp__Don_html_ab9bd14ad525a929cb7ea36409e41842c"><div class="ttname"><a href="classChamp__Don.html#ab9bd14ad525a929cb7ea36409e41842c">Champ_Don::valeurs</a></div><div class="ttdeci">DoubleTab &amp; valeurs() override</div><div class="ttdoc">Appel a l'objet sous-jacent. Renvoie le tableau des valeurs.</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Don_8h_source.html#l00074">Champ_Don.h:74</a></div></div>
<div class="ttc" id="aclassChamp__Face__implementation_html_a8827f54a9d587810a4ba2885837704ef"><div class="ttname"><a href="classChamp__Face__implementation.html#a8827f54a9d587810a4ba2885837704ef">Champ_Face_implementation::imprime_Face</a></div><div class="ttdeci">int imprime_Face(Sortie &amp;, int) const</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face__implementation_8cpp_source.html#l00372">Champ_Face_implementation.cpp:372</a></div></div>
<div class="ttc" id="aclassChamp__Face_html"><div class="ttname"><a href="classChamp__Face.html">Champ_Face</a></div><div class="ttdoc">class Champ_Face Cette classe sert a representer un champ vectoriel dont on ne calcule que les compos...</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face_8h_source.html#l00043">Champ_Face.h:44</a></div></div>
<div class="ttc" id="aclassChamp__Face_html_a219fdd5c3a41ec14ad3d3d3e953ba84a"><div class="ttname"><a href="classChamp__Face.html#a219fdd5c3a41ec14ad3d3d3e953ba84a">Champ_Face::calcul_S_barre_sans_contrib_paroi</a></div><div class="ttdeci">DoubleVect &amp; calcul_S_barre_sans_contrib_paroi(const DoubleTab &amp;, DoubleVect &amp;, const Zone_Cl_VDF &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face3_8cpp_source.html#l01121">Champ_Face3.cpp:1121</a></div></div>
<div class="ttc" id="aclassChamp__Face_html_a30c21c0f12fe00680722fc07cc3d54be"><div class="ttname"><a href="classChamp__Face.html#a30c21c0f12fe00680722fc07cc3d54be">Champ_Face::calcul_critere_Q</a></div><div class="ttdeci">void calcul_critere_Q(DoubleTab &amp;, const Zone_Cl_VDF &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face3_8cpp_source.html#l00512">Champ_Face3.cpp:512</a></div></div>
<div class="ttc" id="aclassChamp__Face_html_a3917b4658637beba61fb02b45b85d8b6"><div class="ttname"><a href="classChamp__Face.html#a3917b4658637beba61fb02b45b85d8b6">Champ_Face::calcul_duidxj</a></div><div class="ttdeci">DoubleTab &amp; calcul_duidxj(const DoubleTab &amp;, DoubleTab &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face3_8cpp_source.html#l00987">Champ_Face3.cpp:987</a></div></div>
<div class="ttc" id="aclassChamp__Face_html_a68c9c8c49e1a21437affa8abb0753910"><div class="ttname"><a href="classChamp__Face.html#a68c9c8c49e1a21437affa8abb0753910">Champ_Face::calculer_rotationnel_ordre2_centre_element</a></div><div class="ttdeci">void calculer_rotationnel_ordre2_centre_element(DoubleTab &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face3_8cpp_source.html#l00491">Champ_Face3.cpp:491</a></div></div>
<div class="ttc" id="aclassChamp__Face_html_a7c36a9d06fd62b53ce2fe1d778f33128"><div class="ttname"><a href="classChamp__Face.html#a7c36a9d06fd62b53ce2fe1d778f33128">Champ_Face::calcul_y_plus</a></div><div class="ttdeci">void calcul_y_plus(DoubleTab &amp;, const Zone_Cl_VDF &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face3_8cpp_source.html#l00548">Champ_Face3.cpp:548</a></div></div>
<div class="ttc" id="aclassChamp__Face_html_a84b6abcd128000e1d5759caaa7ae0dee"><div class="ttname"><a href="classChamp__Face.html#a84b6abcd128000e1d5759caaa7ae0dee">Champ_Face::la_zone_VDF</a></div><div class="ttdeci">Ref_Zone_VDF la_zone_VDF</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face_8h_source.html#l00112">Champ_Face.h:112</a></div></div>
<div class="ttc" id="aclassChamp__Face_html_ab6fe8ab6f95e95d166df36d07e0e1263"><div class="ttname"><a href="classChamp__Face.html#ab6fe8ab6f95e95d166df36d07e0e1263">Champ_Face::val_imp_face_bord_private</a></div><div class="ttdeci">double val_imp_face_bord_private(int face, int comp) const</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face_8cpp_source.html#l00307">Champ_Face.cpp:307</a></div></div>
<div class="ttc" id="aclassChamp__Face_html_ad32e166e138d4fa92ba4221b96ba9ee1"><div class="ttname"><a href="classChamp__Face.html#ad32e166e138d4fa92ba4221b96ba9ee1">Champ_Face::calcul_S_barre</a></div><div class="ttdeci">DoubleVect &amp; calcul_S_barre(const DoubleTab &amp;, DoubleVect &amp;, const Zone_Cl_VDF &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face3_8cpp_source.html#l01420">Champ_Face3.cpp:1420</a></div></div>
<div class="ttc" id="aclassChamp__Face_html_ad4426ef99f2611353a16a374a5c2c2fb"><div class="ttname"><a href="classChamp__Face.html#ad4426ef99f2611353a16a374a5c2c2fb">Champ_Face::calcul_grad_u</a></div><div class="ttdeci">void calcul_grad_u(const DoubleTab &amp;, DoubleTab &amp;, const Zone_Cl_VDF &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face3_8cpp_source.html#l01450">Champ_Face3.cpp:1450</a></div></div>
<div class="ttc" id="aclassChamp__Face_html_ae4b07dcae66b9ff936f30962e9ee8254"><div class="ttname"><a href="classChamp__Face.html#ae4b07dcae66b9ff936f30962e9ee8254">Champ_Face::imprime</a></div><div class="ttdeci">int imprime(Sortie &amp;, int) const override</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Face3_8cpp_source.html#l00505">Champ_Face3.cpp:505</a></div></div>
<div class="ttc" id="aclassChamp__Inc__base_html_a8c225229cff16292a3b78f075d93a26d"><div class="ttname"><a href="classChamp__Inc__base.html#a8c225229cff16292a3b78f075d93a26d">Champ_Inc_base::valeurs</a></div><div class="ttdeci">DoubleTab &amp; valeurs() override</div><div class="ttdoc">Renvoie le tableau des valeurs du champ au temps courant.</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Inc__base_8cpp_source.html#l00214">Champ_Inc_base.cpp:214</a></div></div>
<div class="ttc" id="aclassChamp__Uniforme_html"><div class="ttname"><a href="classChamp__Uniforme.html">Champ_Uniforme</a></div><div class="ttdoc">classe Champ_Uniforme Represente un champ constant dans l'espace et dans le temps.</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Uniforme_8h_source.html#l00025">Champ_Uniforme.h:26</a></div></div>
<div class="ttc" id="aclassCond__lim_html"><div class="ttname"><a href="classCond__lim.html">Cond_lim</a></div><div class="ttdoc">classe Cond_lim Classe generique servant a representer n'importe quelle classe derivee de la classe C...</div><div class="ttdef"><b>Definition:</b> <a href="Cond__lim_8h_source.html#l00038">Cond_lim.h:39</a></div></div>
<div class="ttc" id="aclassCond__lim_html_a5b2d24809cee07727006a891d4ce8d22"><div class="ttname"><a href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22">Cond_lim::frontiere_dis</a></div><div class="ttdeci">Frontiere_dis_base &amp; frontiere_dis()</div><div class="ttdoc">Appel a l'objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites.</div><div class="ttdef"><b>Definition:</b> <a href="Cond__lim_8h_source.html#l00123">Cond_lim.h:123</a></div></div>
<div class="ttc" id="aclassDeriv__Champ__Don__base_html_a74180221a6f2723995588f60d416f284"><div class="ttname"><a href="classDeriv__Champ__Don__base.html#a74180221a6f2723995588f60d416f284">Deriv_Champ_Don_base::valeur</a></div><div class="ttdeci">const Champ_Don_base &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Don_8h_source.html#l00023">Champ_Don.h:23</a></div></div>
<div class="ttc" id="aclassDeriv__Champ__Inc__base_html_adaa8a3a0efb270f0bbd11311787b5c8d"><div class="ttname"><a href="classDeriv__Champ__Inc__base.html#adaa8a3a0efb270f0bbd11311787b5c8d">Deriv_Champ_Inc_base::valeur</a></div><div class="ttdeci">const Champ_Inc_base &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Inc_8h_source.html#l00035">Champ_Inc.h:35</a></div></div>
<div class="ttc" id="aclassDeriv__Cond__lim__base_html_afd7af50ad75a2cde929df2cedb684d58"><div class="ttname"><a href="classDeriv__Cond__lim__base.html#afd7af50ad75a2cde929df2cedb684d58">Deriv_Cond_lim_base::valeur</a></div><div class="ttdeci">const Cond_lim_base &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Cond__lim_8h_source.html#l00024">Cond_lim.h:24</a></div></div>
<div class="ttc" id="aclassDirichlet__paroi__fixe_html"><div class="ttname"><a href="classDirichlet__paroi__fixe.html">Dirichlet_paroi_fixe</a></div><div class="ttdoc">classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes.</div><div class="ttdef"><b>Definition:</b> <a href="Dirichlet__paroi__fixe_8h_source.html#l00036">Dirichlet_paroi_fixe.h:37</a></div></div>
<div class="ttc" id="aclassEquation__base_html"><div class="ttname"><a href="classEquation__base.html">Equation_base</a></div><div class="ttdef"><b>Definition:</b> <a href="Equation__base_8h_source.html#l00086">Equation_base.h:87</a></div></div>
<div class="ttc" id="aclassEquation__base_html_a1ca88930cf00c12a910ad27ac840719c"><div class="ttname"><a href="classEquation__base.html#a1ca88930cf00c12a910ad27ac840719c">Equation_base::milieu</a></div><div class="ttdeci">virtual const Milieu_base &amp; milieu() const =0</div></div>
<div class="ttc" id="aclassEquation__base_html_a26d510ff71f9cc45143a9f16bf4bd24a"><div class="ttname"><a href="classEquation__base.html#a26d510ff71f9cc45143a9f16bf4bd24a">Equation_base::get_modele</a></div><div class="ttdeci">virtual const Ref_Objet_U &amp; get_modele(Type_modele type) const</div><div class="ttdef"><b>Definition:</b> <a href="Equation__base_8cpp_source.html#l02213">Equation_base.cpp:2213</a></div></div>
<div class="ttc" id="aclassEquation__base_html_a3cfe6b771e0ff255b3c93576b27019b0"><div class="ttname"><a href="classEquation__base.html#a3cfe6b771e0ff255b3c93576b27019b0">Equation_base::inconnue</a></div><div class="ttdeci">virtual const Champ_Inc &amp; inconnue() const =0</div></div>
<div class="ttc" id="aclassFluide__base_html"><div class="ttname"><a href="classFluide__base.html">Fluide_base</a></div><div class="ttdoc">classe Fluide_base Cette classe represente un d'un fluide incompressible ainsi que ses proprietes: - ...</div><div class="ttdef"><b>Definition:</b> <a href="Fluide__base_8h_source.html#l00039">Fluide_base.h:40</a></div></div>
<div class="ttc" id="aclassFluide__base_html_a8310bfe64ef9a45d7efc4636db43741b"><div class="ttname"><a href="classFluide__base.html#a8310bfe64ef9a45d7efc4636db43741b">Fluide_base::viscosite_cinematique</a></div><div class="ttdeci">const Champ_Don &amp; viscosite_cinematique() const</div><div class="ttdoc">Renvoie la viscosite cinematique, nu. (vesrion const)</div><div class="ttdef"><b>Definition:</b> <a href="Fluide__base_8h_source.html#l00162">Fluide_base.h:162</a></div></div>
<div class="ttc" id="aclassFront__VF_html"><div class="ttname"><a href="classFront__VF.html">Front_VF</a></div><div class="ttdoc">class Front_VF</div><div class="ttdef"><b>Definition:</b> <a href="Front__VF_8h_source.html#l00036">Front_VF.h:37</a></div></div>
<div class="ttc" id="aclassFront__VF_html_a48eadf1b57ddc0d16e4953d19f259a9e"><div class="ttname"><a href="classFront__VF.html#a48eadf1b57ddc0d16e4953d19f259a9e">Front_VF::nb_faces</a></div><div class="ttdeci">int nb_faces() const</div><div class="ttdoc">Nombre de faces reelles du bord.</div><div class="ttdef"><b>Definition:</b> <a href="Front__VF_8h_source.html#l00054">Front_VF.h:54</a></div></div>
<div class="ttc" id="aclassFront__VF_html_a930e90fb5e8e79adaad93b5c405d00d1"><div class="ttname"><a href="classFront__VF.html#a930e90fb5e8e79adaad93b5c405d00d1">Front_VF::num_premiere_face</a></div><div class="ttdeci">int num_premiere_face() const</div><div class="ttdoc">Numero de la premiere face du bord dans la liste des faces.</div><div class="ttdef"><b>Definition:</b> <a href="Front__VF_8h_source.html#l00064">Front_VF.h:64</a></div></div>
<div class="ttc" id="aclassMod__turb__hyd__base_html"><div class="ttname"><a href="classMod__turb__hyd__base.html">Mod_turb_hyd_base</a></div><div class="ttdoc">Classe Mod_turb_hyd_base Cette classe sert de base a la hierarchie des classes qui representent un mo...</div><div class="ttdef"><b>Definition:</b> <a href="Mod__turb__hyd__base_8h_source.html#l00054">Mod_turb_hyd_base.h:57</a></div></div>
<div class="ttc" id="aclassMod__turb__hyd__base_html_a407c307878b9a8e341e9d5bee78ae0b1"><div class="ttname"><a href="classMod__turb__hyd__base.html#a407c307878b9a8e341e9d5bee78ae0b1">Mod_turb_hyd_base::loi_paroi</a></div><div class="ttdeci">const Turbulence_paroi &amp; loi_paroi() const</div><div class="ttdef"><b>Definition:</b> <a href="Mod__turb__hyd__base_8h_source.html#l00066">Mod_turb_hyd_base.h:66</a></div></div>
<div class="ttc" id="aclassMorEqn_html_a233c714209593acce7aec1f55640bca2"><div class="ttname"><a href="classMorEqn.html#a233c714209593acce7aec1f55640bca2">MorEqn::equation</a></div><div class="ttdeci">const Equation_base &amp; equation() const</div><div class="ttdoc">Renvoie la reference sur l'equation pointe par MorEqn::mon_equation. (version const)</div><div class="ttdef"><b>Definition:</b> <a href="MorEqn_8h_source.html#l00075">MorEqn.h:75</a></div></div>
<div class="ttc" id="aclassMorEqn_html_a47b12fa29b57783a8a5897f7611e2176"><div class="ttname"><a href="classMorEqn.html#a47b12fa29b57783a8a5897f7611e2176">MorEqn::mon_equation</a></div><div class="ttdeci">Ref_Equation_base mon_equation</div><div class="ttdef"><b>Definition:</b> <a href="MorEqn_8h_source.html#l00053">MorEqn.h:53</a></div></div>
<div class="ttc" id="aclassO__U__Ptr_html_a8d368932ee397da5ae25a9916fd88a59"><div class="ttname"><a href="classO__U__Ptr.html#a8d368932ee397da5ae25a9916fd88a59">O_U_Ptr::non_nul</a></div><div class="ttdeci">int non_nul() const</div><div class="ttdoc">Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.</div><div class="ttdef"><b>Definition:</b> <a href="O__U__Ptr_8cpp_source.html#l00090">O_U_Ptr.cpp:90</a></div></div>
<div class="ttc" id="aclassObjet__U_html_a3e23491c01f2f39245fb6f3b6d6d9b17"><div class="ttname"><a href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a></div><div class="ttdeci">static int dimension</div><div class="ttdef"><b>Definition:</b> <a href="Objet__U_8h_source.html#l00073">Objet_U.h:73</a></div></div>
<div class="ttc" id="aclassObjet__U_html_ad9b82ace9d4c7902ec704b6a78f76991"><div class="ttname"><a href="classObjet__U.html#ad9b82ace9d4c7902ec704b6a78f76991">Objet_U::axi</a></div><div class="ttdeci">static int axi</div><div class="ttdef"><b>Definition:</b> <a href="Objet__U_8h_source.html#l00076">Objet_U.h:76</a></div></div>
<div class="ttc" id="aclassRef__Objet__U_html"><div class="ttname"><a href="classRef__Objet__U.html">Ref_Objet_U</a></div><div class="ttdef"><b>Definition:</b> <a href="Ref__Objet__U_8h_source.html#l00085">Ref_Objet_U.h:85</a></div></div>
<div class="ttc" id="aclassRef__Objet__U_html_ae1559b18a55fa814ba0c334165359d9c"><div class="ttname"><a href="classRef__Objet__U.html#ae1559b18a55fa814ba0c334165359d9c">Ref_Objet_U::valeur</a></div><div class="ttdeci">const Objet_U &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Ref__Objet__U_8h_source.html#l00085">Ref_Objet_U.h:85</a></div></div>
<div class="ttc" id="aclassRef__Zone__VDF_html_af219e77d38517b134cf8175207d1cc11"><div class="ttname"><a href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">Ref_Zone_VDF::valeur</a></div><div class="ttdeci">const Zone_VDF &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Ref__Zone__VDF_8h_source.html#l00021">Ref_Zone_VDF.h:21</a></div></div>
<div class="ttc" id="aclassSortie_html"><div class="ttname"><a href="classSortie.html">Sortie</a></div><div class="ttdoc">Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers,...</div><div class="ttdef"><b>Definition:</b> <a href="Sortie_8h_source.html#l00050">Sortie.h:51</a></div></div>
<div class="ttc" id="aclassTRUSTArray_html"><div class="ttname"><a href="classTRUSTArray.html">TRUSTArray&lt; int &gt;</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html"><div class="ttname"><a href="classTRUSTTab.html">TRUSTTab&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html_a33c4f72e40e49cdb553fc7311fe656bc"><div class="ttname"><a href="classTRUSTTab.html#a33c4f72e40e49cdb553fc7311fe656bc">TRUSTTab::resize</a></div><div class="ttdeci">void resize(int n, Array_base::Resize_Options opt=Array_base::COPY_INIT)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTab_8tpp_source.html#l00313">TRUSTTab.tpp:313</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html_a8fecd3f1f3a13e933c3f767a25c54805"><div class="ttname"><a href="classTRUSTTab.html#a8fecd3f1f3a13e933c3f767a25c54805">TRUSTTab::dimension</a></div><div class="ttdeci">int dimension(int) const</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTab_8tpp_source.html#l00119">TRUSTTab.tpp:119</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html_aa535c986ec7914b6da5845401d76a424"><div class="ttname"><a href="classTRUSTTab.html#aa535c986ec7914b6da5845401d76a424">TRUSTTab::ref</a></div><div class="ttdeci">virtual void ref(const TRUSTTab &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTTab_8tpp_source.html#l00229">TRUSTTab.tpp:229</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html"><div class="ttname"><a href="classTRUSTVect.html">TRUSTVect&lt; int &gt;</a></div></div>
<div class="ttc" id="aclassTurbulence__paroi__base_html"><div class="ttname"><a href="classTurbulence__paroi__base.html">Turbulence_paroi_base</a></div><div class="ttdoc">Classe Turbulence_paroi_base Classe de base pour la hierarchie des classes representant les modeles d...</div><div class="ttdef"><b>Definition:</b> <a href="Turbulence__paroi__base_8h_source.html#l00050">Turbulence_paroi_base.h:51</a></div></div>
<div class="ttc" id="aclassTurbulence__paroi__base_html_a1e1399f945b92967378852ea383fffae"><div class="ttname"><a href="classTurbulence__paroi__base.html#a1e1399f945b92967378852ea383fffae">Turbulence_paroi_base::tab_d_plus</a></div><div class="ttdeci">const DoubleVect &amp; tab_d_plus() const</div><div class="ttdef"><b>Definition:</b> <a href="Turbulence__paroi__base_8h_source.html#l00213">Turbulence_paroi_base.h:213</a></div></div>
<div class="ttc" id="aclassTurbulence__paroi__base_html_ae17a65c941097714aed5be9f36e5408a"><div class="ttname"><a href="classTurbulence__paroi__base.html#ae17a65c941097714aed5be9f36e5408a">Turbulence_paroi_base::use_shear</a></div><div class="ttdeci">virtual bool use_shear() const</div><div class="ttdoc">Generalement true sauf par exemple pour loi paroi_negligeable_XXX.</div><div class="ttdef"><b>Definition:</b> <a href="Turbulence__paroi__base_8cpp_source.html#l00102">Turbulence_paroi_base.cpp:102</a></div></div>
<div class="ttc" id="aclassZone__Cl__VDF_html"><div class="ttname"><a href="classZone__Cl__VDF.html">Zone_Cl_VDF</a></div><div class="ttdoc">&lt; namespace TypeAreteCoinVDF</div><div class="ttdef"><b>Definition:</b> <a href="Zone__Cl__VDF_8h_source.html#l00073">Zone_Cl_VDF.h:74</a></div></div>
<div class="ttc" id="aclassZone__Cl__VDF_html_a6232c94f3b251914b7b3a0d05a92f00c"><div class="ttname"><a href="classZone__Cl__VDF.html#a6232c94f3b251914b7b3a0d05a92f00c">Zone_Cl_VDF::type_arete_coin</a></div><div class="ttdeci">const int &amp; type_arete_coin(int) const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__Cl__VDF_8h_source.html#l00124">Zone_Cl_VDF.h:124</a></div></div>
<div class="ttc" id="aclassZone__Cl__VDF_html_ab16cb010aa77639debd69f3b93470d00"><div class="ttname"><a href="classZone__Cl__VDF.html#ab16cb010aa77639debd69f3b93470d00">Zone_Cl_VDF::type_arete_bord</a></div><div class="ttdeci">int type_arete_bord(int) const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__Cl__VDF_8h_source.html#l00114">Zone_Cl_VDF.h:114</a></div></div>
<div class="ttc" id="aclassZone__Cl__dis__base_html_a9b068b594ffc0a2cb2eb08841efcd1f5"><div class="ttname"><a href="classZone__Cl__dis__base.html#a9b068b594ffc0a2cb2eb08841efcd1f5">Zone_Cl_dis_base::les_conditions_limites</a></div><div class="ttdeci">const Cond_lim &amp; les_conditions_limites(int) const</div><div class="ttdoc">Renvoie la i-ieme condition aux limites. (version const)</div><div class="ttdef"><b>Definition:</b> <a href="Zone__Cl__dis__base_8cpp_source.html#l00515">Zone_Cl_dis_base.cpp:515</a></div></div>
<div class="ttc" id="aclassZone__VDF_html"><div class="ttname"><a href="classZone__VDF.html">Zone_VDF</a></div><div class="ttdoc">class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00063">Zone_VDF.h:64</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_a0157fd22066ae44910e23ccaab511b1c"><div class="ttname"><a href="classZone__VDF.html#a0157fd22066ae44910e23ccaab511b1c">Zone_VDF::dist_face</a></div><div class="ttdeci">double dist_face(int, int, int k) const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00278">Zone_VDF.h:278</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_a08655f468ca47527b7a2a4e6a741a5c4"><div class="ttname"><a href="classZone__VDF.html#a08655f468ca47527b7a2a4e6a741a5c4">Zone_VDF::nb_aretes_mixtes</a></div><div class="ttdeci">int nb_aretes_mixtes() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00490">Zone_VDF.h:490</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_a3d078d9bcca8434dc676c2ef2b594f5a"><div class="ttname"><a href="classZone__VDF.html#a3d078d9bcca8434dc676c2ef2b594f5a">Zone_VDF::nb_aretes_coin</a></div><div class="ttdeci">int nb_aretes_coin() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00466">Zone_VDF.h:466</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_a584ecc1a81b2df74c2d7f673d5b20aef"><div class="ttname"><a href="classZone__VDF.html#a584ecc1a81b2df74c2d7f673d5b20aef">Zone_VDF::Qdm</a></div><div class="ttdeci">int Qdm(int num_arete, int) const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00205">Zone_VDF.h:205</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_a6c148c4cdce19b3567307528ae04e750"><div class="ttname"><a href="classZone__VDF.html#a6c148c4cdce19b3567307528ae04e750">Zone_VDF::premiere_arete_mixte</a></div><div class="ttdeci">int premiere_arete_mixte() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00496">Zone_VDF.h:496</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_a71671288eceb9fe858d5554b6ad2f039"><div class="ttname"><a href="classZone__VDF.html#a71671288eceb9fe858d5554b6ad2f039">Zone_VDF::orientation</a></div><div class="ttdeci">int orientation(int) const override</div><div class="ttdoc">inline DoubleVect&amp; Zone_VDF::porosite_face() { return porosite_face_; }</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00259">Zone_VDF.h:259</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_a79e37e7e12b6ef3540c11103f3683424"><div class="ttname"><a href="classZone__VDF.html#a79e37e7e12b6ef3540c11103f3683424">Zone_VDF::nb_aretes_internes</a></div><div class="ttdeci">int nb_aretes_internes() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00502">Zone_VDF.h:502</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_a9b73c567597fb356909751c946e3623e"><div class="ttname"><a href="classZone__VDF.html#a9b73c567597fb356909751c946e3623e">Zone_VDF::dist_face_period</a></div><div class="ttdeci">double dist_face_period(int, int, int) const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00752">Zone_VDF.h:752</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_a9cef0210dfce071f039154ec8076044a"><div class="ttname"><a href="classZone__VDF.html#a9cef0210dfce071f039154ec8076044a">Zone_VDF::dist_norm_bord</a></div><div class="ttdeci">double dist_norm_bord(int num_face) const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00344">Zone_VDF.h:344</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_aa0c72355a8be1eacca235efab948ed6d"><div class="ttname"><a href="classZone__VDF.html#aa0c72355a8be1eacca235efab948ed6d">Zone_VDF::premiere_arete_coin</a></div><div class="ttdeci">int premiere_arete_coin() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00472">Zone_VDF.h:472</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_aad205c7c743296f2e7e2e12bff9e7b89"><div class="ttname"><a href="classZone__VDF.html#aad205c7c743296f2e7e2e12bff9e7b89">Zone_VDF::dim_elem</a></div><div class="ttdeci">double dim_elem(int, int) const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00551">Zone_VDF.h:551</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_ab6986523fd83072f4f06fe59e48a89fb"><div class="ttname"><a href="classZone__VDF.html#ab6986523fd83072f4f06fe59e48a89fb">Zone_VDF::dist_norm_bord_axi</a></div><div class="ttdeci">double dist_norm_bord_axi(int num_face) const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00360">Zone_VDF.h:360</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_ac675a4264c083706bc6fd2c71b25d2b0"><div class="ttname"><a href="classZone__VDF.html#ac675a4264c083706bc6fd2c71b25d2b0">Zone_VDF::premiere_arete_bord</a></div><div class="ttdeci">int premiere_arete_bord() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00484">Zone_VDF.h:484</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_aed93093e7f0c2707c70aae768fdc5b38"><div class="ttname"><a href="classZone__VDF.html#aed93093e7f0c2707c70aae768fdc5b38">Zone_VDF::nb_aretes_bord</a></div><div class="ttdeci">int nb_aretes_bord() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00478">Zone_VDF.h:478</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_aede97c2a291a7be619b4857c5e98398a"><div class="ttname"><a href="classZone__VDF.html#aede97c2a291a7be619b4857c5e98398a">Zone_VDF::dist_elem_period</a></div><div class="ttdeci">double dist_elem_period(int, int, int) const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00544">Zone_VDF.h:544</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_afa03b1328f08c582e0d66b483ee593e8"><div class="ttname"><a href="classZone__VDF.html#afa03b1328f08c582e0d66b483ee593e8">Zone_VDF::premiere_arete_interne</a></div><div class="ttdeci">int premiere_arete_interne() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00514">Zone_VDF.h:514</a></div></div>
<div class="ttc" id="aclassZone__VF_html_a1935d5babef3e13a64d7b997ce94cdd0"><div class="ttname"><a href="classZone__VF.html#a1935d5babef3e13a64d7b997ce94cdd0">Zone_VF::face_voisins</a></div><div class="ttdeci">int face_voisins(int num_face, int i) const</div><div class="ttdoc">renvoie l'element voisin de numface dans la direction i. i=0 : dans le sens oppose de l'axe orthogona...</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VF_8h_source.html#l00442">Zone_VF.h:442</a></div></div>
<div class="ttc" id="aclassZone__VF_html_a301c10a40fa5d518f3653d29a0fa621e"><div class="ttname"><a href="classZone__VF.html#a301c10a40fa5d518f3653d29a0fa621e">Zone_VF::elem_faces</a></div><div class="ttdeci">int elem_faces(int i, int j) const</div><div class="ttdoc">renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VF_8h_source.html#l00558">Zone_VF.h:558</a></div></div>
<div class="ttc" id="aclassZone__VF_html_a3125b6b5356f13a9827dbd0da606d2e7"><div class="ttname"><a href="classZone__VF.html#a3125b6b5356f13a9827dbd0da606d2e7">Zone_VF::nb_faces_tot</a></div><div class="ttdeci">int nb_faces_tot() const</div><div class="ttdoc">renvoie le nombre total de faces. C'est-a-dire faces reelles + faces virtuelles</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VF_8h_source.html#l00511">Zone_VF.h:511</a></div></div>
<div class="ttc" id="aclassZone__dis__base_html_a0913a5b7b235f6c092523df5f5b8bacd"><div class="ttname"><a href="classZone__dis__base.html#a0913a5b7b235f6c092523df5f5b8bacd">Zone_dis_base::nb_front_Cl</a></div><div class="ttdeci">int nb_front_Cl() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__dis__base_8h_source.html#l00159">Zone_dis_base.h:159</a></div></div>
<div class="ttc" id="aclassZone__dis__base_html_a66f0610b6936eba8d959b63b15255b4f"><div class="ttname"><a href="classZone__dis__base.html#a66f0610b6936eba8d959b63b15255b4f">Zone_dis_base::nb_elem</a></div><div class="ttdeci">int nb_elem() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__dis__base_8h_source.html#l00143">Zone_dis_base.h:143</a></div></div>
<div class="ttc" id="aclassZone__dis__base_html_a6e97d34e3642a259924718796298e09e"><div class="ttname"><a href="classZone__dis__base.html#a6e97d34e3642a259924718796298e09e">Zone_dis_base::nb_elem_tot</a></div><div class="ttdeci">int nb_elem_tot() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__dis__base_8h_source.html#l00147">Zone_dis_base.h:147</a></div></div>
<div class="ttc" id="aclassZone__dis__base_html_aae671a49c7b02a69054a38bddb486cf8"><div class="ttname"><a href="classZone__dis__base.html#aae671a49c7b02a69054a38bddb486cf8">Zone_dis_base::zone</a></div><div class="ttdeci">const Zone &amp; zone() const</div><div class="ttdoc">Renvoie la Zone associee a l'objet. (version const)</div><div class="ttdef"><b>Definition:</b> <a href="Zone__dis__base_8h_source.html#l00109">Zone_dis_base.h:109</a></div></div>
<div class="ttc" id="aclassZone_html_a19914240567d6e050f9129da531065d3"><div class="ttname"><a href="classZone.html#a19914240567d6e050f9129da531065d3">Zone::nb_elem_tot</a></div><div class="ttdeci">int nb_elem_tot() const</div><div class="ttdoc">Renvoie le nombre total d'elements de la zone.</div><div class="ttdef"><b>Definition:</b> <a href="Zone_8h_source.html#l00312">Zone.h:312</a></div></div>
<div class="ttc" id="aclassZone_html_a8bdea22b5802d97c07acd9e97de5eb88"><div class="ttname"><a href="classZone.html#a8bdea22b5802d97c07acd9e97de5eb88">Zone::nb_elem</a></div><div class="ttdeci">int nb_elem() const</div><div class="ttdoc">Renvoie le nombre d'elements de la zone.</div><div class="ttdef"><b>Definition:</b> <a href="Zone_8h_source.html#l00293">Zone.h:293</a></div></div>
<div class="ttc" id="adistances__VDF_8cpp_html_a15f59f570345b3bba6c96f78698709df"><div class="ttname"><a href="distances__VDF_8cpp.html#a15f59f570345b3bba6c96f78698709df">norm_3D_vit</a></div><div class="ttdeci">double norm_3D_vit(const DoubleVect &amp;vit, int elem, int iori, const Zone_VDF &amp;zone, double &amp;val1, double &amp;val2)</div><div class="ttdef"><b>Definition:</b> <a href="distances__VDF_8cpp_source.html#l00121">distances_VDF.cpp:121</a></div></div>
<div class="ttc" id="adistances__VDF_8cpp_html_af3a381c8e91b87fe5405eefe7df5c5e3"><div class="ttname"><a href="distances__VDF_8cpp.html#af3a381c8e91b87fe5405eefe7df5c5e3">norm_2D_vit</a></div><div class="ttdeci">double norm_2D_vit(const DoubleVect &amp;vit, int elem, int iori, const Zone_VDF &amp;zone, double &amp;u)</div><div class="ttdef"><b>Definition:</b> <a href="distances__VDF_8cpp_source.html#l00039">distances_VDF.cpp:39</a></div></div>
<div class="ttc" id="adistances__VDF_8h_html"><div class="ttname"><a href="distances__VDF_8h.html">distances_VDF.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 29 2022 11:11:33 for TRUST by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
