<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TRUST: src/VDF/Solveurs/Assembleur_P_VDF.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TRUST<span id="projectnumber">&#160;1.9.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_f999ad8736097ebdc524243ad7f1213b.html">VDF</a></li><li class="navelem"><a class="el" href="dir_bc4ffc0cacce4978ffaa1a5dd64c4cc2.html">Solveurs</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">Assembleur_P_VDF.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="Assembleur__P__VDF_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/****************************************************************************</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">* Copyright (c) 2022, CEA</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">* All rights reserved.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">*</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">*</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment">*</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment">*****************************************************************************/</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;<a class="code" href="Assembleur__P__VDF_8h.html">Assembleur_P_VDF.h</a>&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__VDF_8h.html">Zone_Cl_VDF.h</a>&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;<a class="code" href="Zone__VDF_8h.html">Zone_VDF.h</a>&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;<a class="code" href="Periodique_8h.html">Periodique.h</a>&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;<a class="code" href="Symetrie_8h.html">Symetrie.h</a>&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;<a class="code" href="Neumann__sortie__libre_8h.html">Neumann_sortie_libre.h</a>&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;<a class="code" href="Entree__fluide__vitesse__imposee_8h.html">Entree_fluide_vitesse_imposee.h</a>&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__paroi__fixe_8h.html">Dirichlet_paroi_fixe.h</a>&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__paroi__defilante_8h.html">Dirichlet_paroi_defilante.h</a>&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;<a class="code" href="Champ__front__instationnaire__base_8h.html">Champ_front_instationnaire_base.h</a>&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;<a class="code" href="Champ__front__var__instationnaire_8h.html">Champ_front_var_instationnaire.h</a>&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;<a class="code" href="Matrice__Bloc_8h.html">Matrice_Bloc.h</a>&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;<a class="code" href="Option__VDF_8h.html">Option_VDF.h</a>&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;<a class="code" href="Champ__Fonc__Face_8h.html">Champ_Fonc_Face.h</a>&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse__Sym_8h.html">Matrice_Morse_Sym.h</a>&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#aca8f3849303b39954b9b194eda33e3dc">   32</a></span><a class="code hl_define" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code hl_class" href="classAssembleur__P__VDF.html">Assembleur_P_VDF</a>,<span class="stringliteral">&quot;Assembleur_P_VDF&quot;</span>,<a class="code hl_class" href="classAssembleur__base.html">Assembleur_base</a>);</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#af7a5bf2f0a8a8f6ba21650a19c3dc7f1">   34</a></span><a class="code hl_function" href="classAssembleur__P__VDF.html#af7a5bf2f0a8a8f6ba21650a19c3dc7f1">Assembleur_P_VDF::Assembleur_P_VDF</a>() :</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>  has_P_ref(0)</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>{</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>}</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#a1eb89e9a5ecba7f508ef2241936e063e">   39</a></span><a class="code hl_class" href="classSortie.html">Sortie</a>&amp; <a class="code hl_function" href="classAssembleur__P__VDF.html#a1eb89e9a5ecba7f508ef2241936e063e">Assembleur_P_VDF::printOn</a>(<a class="code hl_class" href="classSortie.html">Sortie</a>&amp; s )<span class="keyword"> const</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>  <span class="keywordflow">return</span> s &lt;&lt; <a class="code hl_function" href="classObjet__U.html#a58289bb63283588d31dc69b87b3f1d55">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_function" href="classObjet__U.html#a93dacab7253df3f9df63d1aca21b1dd5">le_nom</a>() ;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>}</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#a5ca1a2d4c78187e5c5b47c4c7119f954">   44</a></span><a class="code hl_class" href="classEntree.html">Entree</a>&amp; <a class="code hl_function" href="classAssembleur__P__VDF.html#a5ca1a2d4c78187e5c5b47c4c7119f954">Assembleur_P_VDF::readOn</a>(<a class="code hl_class" href="classEntree.html">Entree</a>&amp; s )</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>{</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classAssembleur__base.html#a4ca831196512e41293b71d701c64a8e4">Assembleur_base::readOn</a>(s);</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>}</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="comment">//</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="comment">//</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="comment">//</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="comment">//</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="comment">//</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="comment">//</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="comment">//! Remplit le tableau faces avec la liste des indices des faces periodiques&lt;br&gt;dans le tableau faces_voisins. Chaque face periodique figure deux fois&lt;br&gt;dans faces_voisins (a chaque face correspond la face opposee). On ne&lt;br&gt;met dans le tableau faces que celle des deux qui a l&#39;indice le + petit&lt;br&gt;dans la liste des faces de chaque bord periodique.&lt;br&gt;Valeur de retour:&lt;br&gt;nombre de faces periodiques (egal a la taille du tableau faces).</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#a48da6c5fc5769465a659da41fab00812">   57</a></span><span class="comment"></span><span class="keywordtype">int</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#a48da6c5fc5769465a659da41fab00812">Assembleur_P_VDF::liste_faces_periodiques</a>(<a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a>&amp; faces)</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>{</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="comment">// On commence par surestimer largement la taille du tableau :</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="comment">// nombre de faces de bord</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_bord = <a class="code hl_variable" href="classAssembleur__P__VDF.html#a4ce1358c35e162057c7968aa583cd581">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>().<a class="code hl_function" href="classZone__VF.html#a39f0c943ef5ed78280ed8e117ab9047e">nb_faces_bord</a>();</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>  faces.<a class="code hl_function" href="classTRUSTArray.html#a7fdab39e76f6cb0f5a5691eaaee32d8c">resize_array</a>(nb_faces_bord);</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="comment">// Recherche des faces periodiques dans les conditions aux limites:</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>  <span class="keyword">const</span> <a class="code hl_class" href="classConds__lim.html">Conds_lim</a>&amp; les_cl = <a class="code hl_variable" href="classAssembleur__P__VDF.html#a0b984a6831f2750865e12296e5e07a2b">la_zone_Cl_VDF</a>.<a class="code hl_function" href="classRef__Zone__Cl__VDF.html#a1c097927828f629a20594dfd86ce8b9f">valeur</a>().<a class="code hl_function" href="classZone__Cl__dis__base.html#a9b068b594ffc0a2cb2eb08841efcd1f5">les_conditions_limites</a>();</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_cl = les_cl.<a class="code hl_function" href="classvect__impl.html#aa4ead68b9a3b2cba74be2766cbafcad4">size</a>();</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>  <span class="keywordtype">int</span> nb_faces_periodiques = 0;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl = 0; num_cl &lt; nb_cl; num_cl++)</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    {</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>      <span class="keyword">const</span> <a class="code hl_class" href="classCond__lim__base.html">Cond_lim_base</a>&amp; la_cl = les_cl[num_cl].valeur();</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="comment">// Selectionne uniquement les conditions Periodique</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>      <span class="keywordflow">if</span> ( ! <a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classPeriodique.html">Periodique</a>,la_cl))</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>      <span class="keyword">const</span> <a class="code hl_class" href="classPeriodique.html">Periodique</a>&amp; la_cl_perio = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classPeriodique.html">Periodique</a>, la_cl);</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>      <span class="keyword">const</span> <a class="code hl_class" href="classFront__VF.html">Front_VF</a>&amp;    frontiere = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classFront__VF.html">Front_VF</a>, la_cl.<a class="code hl_function" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a">frontiere_dis</a>());</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_cl = frontiere.<a class="code hl_function" href="classFront__VF.html#a48eadf1b57ddc0d16e4953d19f259a9e">nb_faces</a>();</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> num_premiere_face = frontiere.<a class="code hl_function" href="classFront__VF.html#a930e90fb5e8e79adaad93b5c405d00d1">num_premiere_face</a>();</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_faces_cl; i++)</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        {</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span><span class="comment">// Numero de la face opposee dans le tableau des faces du bord:</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="AssembleurPP1BUtil_8cpp.html#a3e374d53ebc7860e1c2f0b7906f2936d">face_associee</a> = la_cl_perio.<a class="code hl_function" href="classPeriodique.html#a58591bbd91005803c7ea2a714197282b">face_associee</a>(i);</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="AssembleurPP1BUtil_8cpp.html#a3e374d53ebc7860e1c2f0b7906f2936d">face_associee</a> &gt; i)</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>            {</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> num_face_global = num_premiere_face + i;</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>              faces[nb_faces_periodiques] = num_face_global;</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>              nb_faces_periodiques++;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>            }</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>        }</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    }</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span><span class="comment">// Taille finale du tableau faces</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>  faces.<a class="code hl_function" href="classTRUSTArray.html#a7fdab39e76f6cb0f5a5691eaaee32d8c">resize_array</a>(nb_faces_periodiques);</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>  <span class="keywordflow">return</span> nb_faces_periodiques;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>}</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span><span class="comment">//</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span><span class="comment">//</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span><span class="comment">//</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span><span class="comment">//</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span><span class="comment">//</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span><span class="comment">//</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span><span class="comment">//! Determine les elements non nuls de la matrice et prepare le stockage.&lt;br&gt;Matrice creuse de taille nb_elements (lignes) * nb_elem_tot (colonnes)&lt;br&gt;Codee comme une matrice bloc composee de deux matrices morse:&lt;br&gt;* Matrice carree symetrique nb_elements * nb_elements&lt;br&gt;(contient les termes M(i,j) ou i et j sont des numeros d&#39;elements reels)&lt;br&gt;* Matrice rectangle nb_elements * (nb_elem_tot - nb_elem)&lt;br&gt;(contient les termes M(i,j) ou i est reel et j est virtuel</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#aa56befba8f81a9161c144f009d3cdddd">  104</a></span><span class="comment"></span><span class="keywordtype">int</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#aa56befba8f81a9161c144f009d3cdddd">Assembleur_P_VDF::construire</a>(<a class="code hl_class" href="classMatrice.html">Matrice</a>&amp; la_matrice)</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>{</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_vdf   = <a class="code hl_variable" href="classAssembleur__P__VDF.html#a4ce1358c35e162057c7968aa583cd581">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; face_voisins = zone_vdf.<a class="code hl_function" href="classZone__VF.html#a1935d5babef3e13a64d7b997ce94cdd0">face_voisins</a>();</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span><span class="comment">// Comptage du nombre total d&#39;elements non nuls:</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span><span class="comment">// matrice carree : nombre de faces internes / 2 + nb_elem + nbfaces periodiques</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span><span class="comment">// (chaque face interne donne un coef, et on a un element</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span><span class="comment">// diagonal et chaque face periodique donne aussi un coef)</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span><span class="comment">// matrice rectangle : nombre de faces de joint</span></div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span><span class="comment">// Premiere etape : comptage du nombre d&#39;elements non nuls sur chaque ligne</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span><span class="comment">// Pour chaque ligne de la matrice carree, nombre d&#39;elements non nuls</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem     = zone_vdf.<a class="code hl_function" href="classZone__dis__base.html#a66f0610b6936eba8d959b63b15255b4f">nb_elem</a>();</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_vdf.<a class="code hl_function" href="classZone__dis__base.html#a6e97d34e3642a259924718796298e09e">nb_elem_tot</a>();</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a> carre_nb_non_zero(nb_elem);</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span><span class="comment">// Idem pour le rectangle</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a> rect_nb_non_zero(nb_elem);</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span><span class="comment">// Il y a l&#39;element sur la diagonale :</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>  carre_nb_non_zero = 1;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>  rect_nb_non_zero = 0;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>  <span class="keywordtype">int</span> carre_nb_non_zero_tot = nb_elem;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>  <span class="keywordtype">int</span> rect_nb_non_zero_tot = 0;</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span> </div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span><span class="comment">// Plus un element non nul pour chaque face interne et chaque face periodique</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span><span class="comment">// (matrice symetrique, on ne stocke que l&#39;element m(line,col) avec col&gt;line)</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span> </div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a> liste_faces_perio;</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_periodiques = <a class="code hl_function" href="classAssembleur__P__VDF.html#a48da6c5fc5769465a659da41fab00812">liste_faces_periodiques</a>(liste_faces_perio);</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_internes = zone_vdf.<a class="code hl_function" href="classZone__VF.html#a3fbd9844ce625f7dd87e38337c75c025">nb_faces_internes</a>();</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> premiere_face_interne = zone_vdf.<a class="code hl_function" href="classZone__VF.html#ae1e579e3d4a6a29e27a0e82410ae5e49">premiere_face_int</a>();</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>  <span class="keywordflow">for</span> (i = 0; i &lt; nb_faces_internes + nb_faces_periodiques; i++)</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    {</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>      <span class="keywordtype">int</span> face;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>      <span class="keywordflow">if</span> (i &lt; nb_faces_internes) <span class="comment">//!&lt; Astuce pour boucler sur les faces internes et periodiques</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>        face = premiere_face_interne + i;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>        face = liste_faces_perio[i - nb_faces_internes];</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>      <span class="keywordtype">int</span> elem0 = face_voisins(face,0);</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>      <span class="keywordtype">int</span> elem1 = face_voisins(face,1);</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>      <span class="keywordflow">if</span> (elem0 &gt; elem1)</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        {</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>          <span class="keywordtype">int</span> tmp = elem1;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>          elem1 = elem0;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>          elem0 = tmp;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>        }</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>      <span class="keywordflow">if</span> (elem0 &lt; nb_elem)   <span class="comment">//!&lt; elem0 est reel</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>        {</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>          <span class="keywordflow">if</span> (elem1 &lt; nb_elem)      <span class="comment">//!&lt; elem1 reel</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>            {</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>              carre_nb_non_zero[elem0] ++;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>              carre_nb_non_zero_tot ++;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>            }</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>          <span class="keywordflow">else</span>                      <span class="comment">//!&lt; elem1 virtuel</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>            {</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>              rect_nb_non_zero[elem0] ++;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>              rect_nb_non_zero_tot ++;</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>            }</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        }</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    }</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span> </div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span><span class="comment">// Typage et dimensionnement de la matrice de pression</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>  la_matrice.<a class="code hl_function" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719">typer</a>(<span class="stringliteral">&quot;Matrice_Bloc&quot;</span>);</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>  <a class="code hl_class" href="classMatrice__Bloc.html">Matrice_Bloc</a>&amp; matrice =<a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classMatrice__Bloc.html">Matrice_Bloc</a> , la_matrice.<a class="code hl_function" href="classDeriv__Matrice__Base.html#a6d78a97ea87044a4b8c0cc2c6609f3e0">valeur</a>());</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>  matrice.<a class="code hl_function" href="classMatrice__Bloc.html#a1db7c549cc1be958d5f00c29cd0f3a8c">dimensionner</a>(1,2);</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>  matrice.<a class="code hl_function" href="classMatrice__Bloc.html#a76a5691fecfea8b4dd877d2c449a7f21">get_bloc</a>(0,0).<a class="code hl_function" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719">typer</a>(<span class="stringliteral">&quot;Matrice_Morse_Sym&quot;</span>);</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>  matrice.<a class="code hl_function" href="classMatrice__Bloc.html#a76a5691fecfea8b4dd877d2c449a7f21">get_bloc</a>(0,1).<a class="code hl_function" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719">typer</a>(<span class="stringliteral">&quot;Matrice_Morse&quot;</span>);</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>  <a class="code hl_class" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a>&amp; <a class="code hl_function" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a">carre</a> = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a> ,matrice.<a class="code hl_function" href="classMatrice__Bloc.html#a76a5691fecfea8b4dd877d2c449a7f21">get_bloc</a>(0,0).<a class="code hl_function" href="classDeriv__Matrice__Base.html#a6d78a97ea87044a4b8c0cc2c6609f3e0">valeur</a>());</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>  <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp;      rect  = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a> ,     matrice.<a class="code hl_function" href="classMatrice__Bloc.html#a76a5691fecfea8b4dd877d2c449a7f21">get_bloc</a>(0,1).<a class="code hl_function" href="classDeriv__Matrice__Base.html#a6d78a97ea87044a4b8c0cc2c6609f3e0">valeur</a>());</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>  <a class="code hl_function" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a">carre</a>.dimensionner(nb_elem, carre_nb_non_zero_tot);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>  rect.<a class="code hl_function" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">dimensionner</a>(nb_elem, nb_elem_tot - nb_elem, rect_nb_non_zero_tot);</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>  {</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_bord = zone_vdf.<a class="code hl_function" href="classZone__VF.html#a39f0c943ef5ed78280ed8e117ab9047e">nb_faces_bord</a>();</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <a class="code hl_variable" href="classAssembleur__P__VDF.html#af8eca29a2e48d27e8e1f77e0945dc38d">les_coeff_pression</a>.<a class="code hl_function" href="classTRUSTArray.html#a7fdab39e76f6cb0f5a5691eaaee32d8c">resize_array</a>(nb_faces_bord);</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>  }</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a>&amp; carre_tab1 = <a class="code hl_function" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a">carre</a>.get_set_tab1();</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a>&amp; rect_tab1 = rect.<a class="code hl_function" href="classMatrice__Morse.html#a6ef2f55690a596db1ef29742a2e580de">get_set_tab1</a>();</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span> </div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span><span class="comment">// Matrice creuse, stockage morse avec des indices fortran:</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span><span class="comment">// lignes numerotees 1..n, colonnes 1..m</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span><span class="comment">// Le k-ieme coefficient non nul de la ligne i (1&lt;=i&lt;=n) est (avec 1&lt;=k)</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span><span class="comment">// M(i,j) = coeff_[tab1_[k]]     en fortran</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span><span class="comment">// M(i,j) = coeff_[tab1_[k-1]-1] en C</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span><span class="comment">// Le numero j de la colonne ou se trouve ce coefficient (1&lt;=j&lt;=m) est</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span><span class="comment">// j = tab2_[tab1_[k]]     en fortran</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span><span class="comment">// j = tab2_[tab1_[k-1]-1] en C</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span><span class="comment">// </span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span><span class="comment">// Calcul de l&#39;indice du premier coefficient de la ligne i</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span><span class="comment">// dans le tableau d&#39;indices morse des deux matrices (tab1_)</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>  {</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    <span class="keywordtype">int</span> indice = 1; <span class="comment">//!&lt; tab1_ contient un indice fortran (1er element en 1)</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="keywordflow">for</span> (i = 0; i &lt; nb_elem; i++)</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>      {</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        carre_tab1[i] = indice;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        indice += carre_nb_non_zero[i];</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>      }</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    carre_tab1[i] = indice;</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    indice = 1;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <span class="keywordflow">for</span> (i = 0; i &lt; nb_elem; i++)</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>      {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        rect_tab1[i] = indice;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>        indice += rect_nb_non_zero[i];</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>      }</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    rect_tab1[i] = indice;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>  }</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span><span class="comment">// Deuxieme etape : remplissage de tab2_ = numero de la colonne de chaque</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span><span class="comment">// terme non nul de la matrice</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a>&amp; carre_tab2 = <a class="code hl_function" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a">carre</a>.get_set_tab2();</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a>&amp; rect_tab2 = rect.<a class="code hl_function" href="classMatrice__Morse.html#af9addd0cf0fc821150da06b1f2e242ea">get_set_tab2</a>();</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>  carre_tab2 = -1;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>  rect_tab2 = -1;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span> </div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span><span class="comment">// Terme diagonal:</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>  <span class="keywordflow">for</span> (i = 1; i &lt;= nb_elem; i++)</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    carre_tab2[carre_tab1[i-1]-1] = i; <span class="comment">//!&lt; Indice fortran 1&lt;=i&lt;=nb_elem</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span> </div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>  carre_nb_non_zero = 1; <span class="comment">//!&lt; Nombre de coefficients non nuls sur chaque ligne</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>  rect_nb_non_zero = 0;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span><span class="comment">// Termes extra-diagonaux:</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_face = 0; i_face &lt; nb_faces_internes + nb_faces_periodiques; i_face++)</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    {</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span><span class="comment">// Calcul du numero de la face a traiter</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> face = (i_face &lt; nb_faces_internes)</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>                       ? premiere_face_interne + i_face</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>                       : liste_faces_perio[i_face - nb_faces_internes];</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span> </div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>      <span class="keywordtype">int</span> elem0 = face_voisins(face,0);</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>      <span class="keywordtype">int</span> elem1 = face_voisins(face,1);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>      <span class="keywordflow">if</span> (elem0 &gt; elem1)</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        {</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>          <span class="keywordtype">int</span> tmp = elem1;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>          elem1 = elem0;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>          elem0 = tmp;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        }</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>      assert(elem0 &gt;= 0);            <span class="comment">//!&lt; Verifie qu&#39;on a bien deux elements voisins</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>      <span class="keywordflow">if</span> (elem0 &lt; nb_elem)                              <span class="comment">//!&lt; elem0 est reel</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        {</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> ligne = elem0 + 1;                 <span class="comment">//!&lt; Indice fortran</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>          <span class="keywordflow">if</span> (elem1 &lt; nb_elem)                            <span class="comment">//!&lt; elem1 est reel aussi</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>            {</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> colonne = elem1 + 1;             <span class="comment">//!&lt; Indice fortran</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> n = carre_nb_non_zero[ligne-1]++;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> index = carre_tab1[ligne-1] + n; <span class="comment">//!&lt; Indice fortran dans tab2</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>              carre_tab2[index - 1] = colonne;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>            }</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>          <span class="keywordflow">else</span>                                           <span class="comment">//!&lt; elem1 est virtuel</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>            {</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> colonne = elem1 - nb_elem + 1;  <span class="comment">//!&lt; Indice fortran</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> n = rect_nb_non_zero[ligne-1]++;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> index = rect_tab1[ligne-1] + n; <span class="comment">//!&lt; Indice fortran dans tab2</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>              rect_tab2[index - 1] = colonne;</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>            }</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        }</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    }</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>}</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span><span class="comment">// La matrice doit etre typee et dimensionnee, tab1_ et tab2_ remplis</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span><span class="comment">// avec les elements non nuls de la matrice.</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span><span class="comment">// On suppose que le tableau tab2_ est inchange depuis son remplissage dans</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span><span class="comment">// &quot;construire&quot;. Le remplissage se fait avec des boucles identiques pour que</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span><span class="comment">// tab2 et coeff se correspondent.</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span><span class="comment">// </span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span><span class="comment">// A essayer : trier les elements d&#39;une ligne par ordre croissant de numero de</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span><span class="comment">// colonne et utiliser un acces matrice(ligne,colonne) avec recherche binaire.</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span><span class="comment">// C&#39;est plus lisible.</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span><span class="comment">// </span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span><span class="comment">// La matrice M est telle que si le vecteur P(i) contient la valeur de la pression au centre</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span><span class="comment">// des elements Omega(i), alors le vecteur A=M*P est tel que A(i) vaut :</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span><span class="comment">// A(i) = - INTEGRALE sur Omega(i)             (div (porosite/rho * grad P) * dOmega)</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span><span class="comment">// = - INTEGRALE sur le bord de Omega(i)) (porosite/rho * gradP * Normale * ds)</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span><span class="comment">// </span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span><span class="comment">// On discretise grad P = (P(i+1) - P(i)) / h, avec h = volume(Omega&#39;) / surface(face)</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span><span class="comment">// (Omega&#39; est le volume de controle de la qdm)</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span><span class="comment">//</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span><span class="comment">//</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span><span class="comment">//! Calcul des coefficients de la matrice de pression avec un champ de rho.&lt;br&gt;Si rho_ptr == 0, on calcule la matrice -div( porosite * grad P ),&lt;br&gt;sinon on calcule -div( porosite/rho grad P ) et *rho_ptr doit etre un Champ_Fonc_Face.</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span><span class="comment"></span> </div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#ae6419915244b87d5c8f186d7c4fc1992">  295</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#ae6419915244b87d5c8f186d7c4fc1992">Assembleur_P_VDF::remplir</a>(<a class="code hl_class" href="classMatrice.html">Matrice</a>&amp; la_matrice, <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; volumes_entrelaces,<span class="keyword">const</span> <a class="code hl_class" href="classChamp__Don__base.html">Champ_Don_base</a> * rho_ptr)</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>{</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_vdf   = <a class="code hl_variable" href="classAssembleur__P__VDF.html#a4ce1358c35e162057c7968aa583cd581">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; face_voisins = zone_vdf.<a class="code hl_function" href="classZone__VF.html#a1935d5babef3e13a64d7b997ce94cdd0">face_voisins</a>();</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; face_surfaces = zone_vdf.<a class="code hl_function" href="classZone__VF.html#a81a853efbcf5659d78f6a788b379841e">face_surfaces</a>();</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span><span class="comment">// const DoubleVect &amp; volumes_entrelaces = zone_vdf.volumes_entrelaces();</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; porosite_face = zone_vdf.<a class="code hl_function" href="classZone__VF.html#ae6bef9af0a9ef1188cb2291f1e241cb2">porosite_face</a>();</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span> </div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a> * valeurs_rho = 0;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>  <span class="keywordflow">if</span> (rho_ptr)</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    {</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>      assert(<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classChamp__Fonc__Face.html">Champ_Fonc_Face</a>, *rho_ptr));</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>      valeurs_rho = &amp; (rho_ptr-&gt;<a class="code hl_function" href="classChamp__Don__base.html#abb194455f5439d74ce449f1bd937486a">valeurs</a>());</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    }</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span><span class="comment">// Raccourcis vers la partie carree (coefficients elements reels/reels)</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span><span class="comment">// et la partie rectangulaire (elements reels / elements virtuels) de la matrice</span></div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>  <a class="code hl_class" href="classMatrice__Bloc.html">Matrice_Bloc</a>&amp; matrice = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classMatrice__Bloc.html">Matrice_Bloc</a>, la_matrice.<a class="code hl_function" href="classDeriv__Matrice__Base.html#a6d78a97ea87044a4b8c0cc2c6609f3e0">valeur</a>());</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>  <a class="code hl_class" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a>&amp; <a class="code hl_function" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a">carre</a> = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a>, matrice.<a class="code hl_function" href="classMatrice__Bloc.html#a76a5691fecfea8b4dd877d2c449a7f21">get_bloc</a>(0,0).<a class="code hl_function" href="classDeriv__Matrice__Base.html#a6d78a97ea87044a4b8c0cc2c6609f3e0">valeur</a>());</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>  <a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>&amp;      rect  = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classMatrice__Morse.html">Matrice_Morse</a>,     matrice.<a class="code hl_function" href="classMatrice__Bloc.html#a76a5691fecfea8b4dd877d2c449a7f21">get_bloc</a>(0,1).<a class="code hl_function" href="classDeriv__Matrice__Base.html#a6d78a97ea87044a4b8c0cc2c6609f3e0">valeur</a>());</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span> </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem = zone_vdf.<a class="code hl_function" href="classZone__dis__base.html#a66f0610b6936eba8d959b63b15255b4f">nb_elem</a>();</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a> carre_nb_non_zero(nb_elem);</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a> rect_nb_non_zero(nb_elem);</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>  carre_nb_non_zero = 1;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>  rect_nb_non_zero = 0;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span> </div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a>&amp; carre_tab1 = <a class="code hl_function" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a">carre</a>.get_set_tab1();</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a>&amp; rect_tab1 = rect.<a class="code hl_function" href="classMatrice__Morse.html#a6ef2f55690a596db1ef29742a2e580de">get_set_tab1</a>();</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfDouble</a>&amp; carre_coeff = <a class="code hl_function" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a">carre</a>.get_set_coeff();</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfDouble</a>&amp; rect_coeff = rect.<a class="code hl_function" href="classMatrice__Morse.html#a7654bbef11775a783790d3e9ad0b1501">get_set_coeff</a>();</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span> </div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>  carre_coeff = 0.;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>  rect_coeff = 0.;</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span> </div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span><span class="comment">// Traitement des faces internes et periodiques :</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span><span class="comment">// Pour chaque face entre deux elements elem0 et elem1, y a quatre termes a ajouter :</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span><span class="comment">// M(elem0,elem0)</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span><span class="comment">// M(elem0,elem1)</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span><span class="comment">// M(elem1,elem1)</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span><span class="comment">// M(elem1,elem0)  (omis car la matrice est stockee symetrique)</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span><span class="comment">// Construction de la liste des faces periodiques</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>  <a class="code hl_class" href="classTRUSTArray.html">ArrOfInt</a> liste_faces_perio;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_periodiques = <a class="code hl_function" href="classAssembleur__P__VDF.html#a48da6c5fc5769465a659da41fab00812">liste_faces_periodiques</a>(liste_faces_perio);</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_internes = zone_vdf.<a class="code hl_function" href="classZone__VF.html#a3fbd9844ce625f7dd87e38337c75c025">nb_faces_internes</a>();</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> premiere_face_interne = zone_vdf.<a class="code hl_function" href="classZone__VF.html#ae1e579e3d4a6a29e27a0e82410ae5e49">premiere_face_int</a>();</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_face = 0; i_face &lt; nb_faces_internes + nb_faces_periodiques; i_face++)</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>    {</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span> </div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span><span class="comment">// Calcul du numero de la face a traiter</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> num_face = (i_face &lt; nb_faces_internes)</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>                           ? premiere_face_interne + i_face</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>                           : liste_faces_perio[i_face - nb_faces_internes];</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="comment">// Calcul de rho sur cette face</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> rho_face = (valeurs_rho) ? (*valeurs_rho)[num_face] : 1.;</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span><span class="comment">// Calcul du coefficient</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> surface  = face_surfaces[num_face];</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> volume   = volumes_entrelaces[num_face];</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> porosite = porosite_face[num_face];</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> coefficient = surface * surface * porosite / (volume * rho_face);</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span><span class="comment">// Numeros des deux elements voisins (le plus petit dans elem0)</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>      <span class="keywordtype">int</span> elem0 = face_voisins(num_face,0);</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>      <span class="keywordtype">int</span> elem1 = face_voisins(num_face,1);</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>      <span class="keywordflow">if</span> (elem0 &gt; elem1)</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        {</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>          <span class="keywordtype">int</span> tmp = elem1;</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>          elem1 = elem0;</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>          elem0 = tmp;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>        }</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>      <span class="keywordflow">if</span> (elem0 &lt; nb_elem)</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        {</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span><span class="comment">// elem0 est reel</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> ligne = elem0 + 1;   <span class="comment">//!&lt; Indice fortran Indice fortran de l&#39;element diagonal (elem0, elem0)</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span><span class="comment">//</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> index_diag = carre_tab1[ligne-1];</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>          carre_coeff[index_diag - 1] += coefficient;</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>          <span class="keywordflow">if</span> (elem1 &lt; nb_elem)</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>            {</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span><span class="comment">// elem1 est reel aussi</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span><span class="comment">// Indice fortran de l&#39;element diagonal (elem1, elem1)</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> index_diag1 = carre_tab1[elem1]; <span class="comment">//!&lt; a la ligne elem1+1 Indice fortran de l&#39;element extradiagonal (elem0, elem1)</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span><span class="comment">//</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> n = carre_nb_non_zero[ligne-1]++;</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> index = index_diag + n;</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span><span class="comment">// Coefficient diagonal</span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>              carre_coeff[index_diag1 - 1] += coefficient;</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span><span class="comment">// Coefficient extra-diagonal</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>              carre_coeff[index - 1] = - coefficient;</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>              assert(<a class="code hl_function" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a">carre</a>.get_tab2()(index - 1) == elem1 + 1);</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>            }</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>          <span class="keywordflow">else</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>            {</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span><span class="comment">// elem1 est virtuel</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> n = rect_nb_non_zero[ligne-1]++;</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> index = rect_tab1[ligne-1] + n; <span class="comment">//!&lt; Indice fortran dans tab2 Coefficient extra-diagonal</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span><span class="comment">//</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>              rect_coeff[index - 1] = - coefficient;</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>              assert(rect.<a class="code hl_function" href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">get_tab2</a>()(index - 1) == elem1 - nb_elem + 1);</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>            }</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>        }</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    }</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span><span class="comment">// Traitement des conditions aux limites</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>  <span class="keyword">const</span> <a class="code hl_class" href="classConds__lim.html">Conds_lim</a>&amp; les_cl = <a class="code hl_variable" href="classAssembleur__P__VDF.html#a0b984a6831f2750865e12296e5e07a2b">la_zone_Cl_VDF</a>.<a class="code hl_function" href="classRef__Zone__Cl__VDF.html#a1c097927828f629a20594dfd86ce8b9f">valeur</a>().<a class="code hl_function" href="classZone__Cl__dis__base.html#a9b068b594ffc0a2cb2eb08841efcd1f5">les_conditions_limites</a>();</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_cl = les_cl.<a class="code hl_function" href="classvect__impl.html#aa4ead68b9a3b2cba74be2766cbafcad4">size</a>();</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl = 0; num_cl &lt; nb_cl; num_cl++)</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    {</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>      <span class="keyword">const</span> <a class="code hl_class" href="classCond__lim__base.html">Cond_lim_base</a>&amp; la_cl = les_cl[num_cl].valeur();</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>      <span class="keyword">const</span> <a class="code hl_class" href="classFront__VF.html">Front_VF</a>&amp; la_front_dis = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classFront__VF.html">Front_VF</a>,la_cl.<a class="code hl_function" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a">frontiere_dis</a>());</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span><span class="comment">// Test sur les conditions limites en 2D RZ (on doit avoir symetrie selon l&#39;axe de revolution)</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classObjet__U.html#a9a47c1add9760324894500792c17a178">bidim_axi</a> &amp;&amp; !<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classSymetrie.html">Symetrie</a>,la_cl))</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>        {</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> ndeb = la_front_dis.<a class="code hl_function" href="classFront__VF.html#a930e90fb5e8e79adaad93b5c405d00d1">num_premiere_face</a>();</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> nfin = ndeb + la_front_dis.<a class="code hl_function" href="classFront__VF.html#a48eadf1b57ddc0d16e4953d19f259a9e">nb_faces</a>();</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>          <span class="keywordflow">if</span> (nfin&gt;ndeb &amp;&amp; <a class="code hl_function" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(face_surfaces[ndeb],0))</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>            {</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;\nFirst face surface is smaller than PrecisionGeom = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">precision_geom</a> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;May be you have an error in the definition of the boundary conditions.&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The axis of revolution for this 2D calculation is along Y.&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;So you must specify symmetry boundary condition (symetrie keyword) for the boundary &quot;</span> &lt;&lt; la_front_dis.<a class="code hl_function" href="classFrontiere__dis__base.html#ae02125bae550cff30ccd5140e272e04f">le_nom</a>() &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>              <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>            }</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>        }</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span> </div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span><span class="comment">// Pour chaque face de bord entre elem0 et un element fictif exterieur</span></div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span><span class="comment">// a pression imposee P0, on a :</span></div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span><span class="comment">// grad P = (P(elem0) - P0) * surface / volume_entrelace</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span><span class="comment">// elem0 est une inconnue, P0 est ajoute au second membre dans &quot;modifier_secmem&quot;.</span></div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>      <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classNeumann__sortie__libre.html">Neumann_sortie_libre</a>,la_cl))</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        {</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>          <a class="code hl_variable" href="classAssembleur__P__VDF.html#a9d277900967c598cd61dcc14dcb7ebbd">has_P_ref</a> = 1;</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>          <a class="code hl_function" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a">carre</a>.set_est_definie(1);</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> ndeb = la_front_dis.<a class="code hl_function" href="classFront__VF.html#a930e90fb5e8e79adaad93b5c405d00d1">num_premiere_face</a>();</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> nfin = ndeb + la_front_dis.<a class="code hl_function" href="classFront__VF.html#a48eadf1b57ddc0d16e4953d19f259a9e">nb_faces</a>();</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face = ndeb; num_face &lt; nfin; num_face++)</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>            {</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span><span class="comment">// Calcul de rho sur cette face</span></div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> rho_face = (valeurs_rho) ? (*valeurs_rho)[num_face] : 1.;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span><span class="comment">// Calcul du coefficient a ajouter dans la matrice</span></div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> surface  = face_surfaces[num_face];</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span><span class="comment">// Attention: le volume entrelace a une valeur particuliere au bord</span></div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span><span class="comment">// (voir Zone_VDF::calculer_volumes_entrelaces() )</span></div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> volume   = volumes_entrelaces[num_face];</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> porosite = porosite_face[num_face];</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> coefficient = <a class="code hl_variable" href="classOption__VDF.html#abc56a584319b990ca8259b5219d28270">Option_VDF::coeff_P_neumann</a> * surface * surface * porosite / (volume * rho_face);</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>              assert(coefficient &gt; 0.);</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span><span class="comment">// Numero de l&#39;element voisin (l&#39;un est -1, l&#39;autre est un element reel)</span></div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> elem0 = face_voisins(num_face, 0);</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> elem1 = face_voisins(num_face, 1);</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>              assert(elem0 == -1 || elem1 == -1);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> elem = elem0 + elem1 + 1;</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span><span class="comment">// Ajout du coefficient a la matrice</span></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>              assert(elem &lt; nb_elem);</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> index = carre_tab1[elem]; <span class="comment">//!&lt; Indice fortran</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>              carre_coeff[index - 1] += coefficient;</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>              <a class="code hl_variable" href="classAssembleur__P__VDF.html#af8eca29a2e48d27e8e1f77e0945dc38d">les_coeff_pression</a>[num_face] = coefficient;</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>            }</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>        }</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        {</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span><span class="comment">// Pour les autres conditions aux limites, aucun terme supplementaire dans</span></div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span><span class="comment">// la matrice (grad P scalaire n = 0 sur le bord,</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span><span class="comment">// ou derivee en temps de grad P scalaire n = 0 sur le bord)</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        }</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>    }</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>  <a class="code hl_variable" href="classAssembleur__P__VDF.html#a9d277900967c598cd61dcc14dcb7ebbd">has_P_ref</a> = (int)<a class="code hl_function" href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d">mp_max</a>(<a class="code hl_variable" href="classAssembleur__P__VDF.html#a9d277900967c598cd61dcc14dcb7ebbd">has_P_ref</a>);</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span> </div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span><span class="comment">// Verification sanitaire: pas d&#39;element nul sur la diagonale</span></div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_elem; i++)</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    {</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> index = carre_tab1[i];</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> coeff_diagonal = carre_coeff[index - 1];</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>      <span class="keywordflow">if</span> (coeff_diagonal == 0.)</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>        {</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span><span class="comment">// La maille i n&#39;a pas de voisin: pression quelconque</span></div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>          carre_coeff[index - 1] = 1.;</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        }</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    }</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>  <a class="code hl_function" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a">carre</a>.compacte();</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>  rect.<a class="code hl_function" href="classMatrice__Morse.html#af20143b6c3f18319cc28c326a64f031c">compacte</a>();</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>}</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span> </div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span><span class="comment">//</span></div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span><span class="comment">//</span></div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span><span class="comment">//</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span><span class="comment">//</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span><span class="comment">//</span></div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span><span class="comment">//</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span><span class="comment">//! Modification du second membre pour appliquer les conditions aux limites.&lt;br&gt;Les conditions prises en charge sont&lt;br&gt;Neumann_sortie_libre,&lt;br&gt;Entree_fluide_vitesse_imposee,&lt;br&gt;Dirichlet_paroi_defilante (rien a faire),&lt;br&gt;Dirichlet_paroi_fixe (rien a faire),&lt;br&gt;Symetrie (rien a faire)</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#a44ad326fcee9e70eea8f87dc3b2aa939">  490</a></span><span class="comment"></span><span class="keywordtype">int</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#a44ad326fcee9e70eea8f87dc3b2aa939">Assembleur_P_VDF::modifier_secmem</a>(<a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; secmem)</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>{</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__Cl__VDF.html">Zone_Cl_VDF</a>&amp; la_zone_cl = <a class="code hl_variable" href="classAssembleur__P__VDF.html#a0b984a6831f2750865e12296e5e07a2b">la_zone_Cl_VDF</a>.<a class="code hl_function" href="classRef__Zone__Cl__VDF.html#a1c097927828f629a20594dfd86ce8b9f">valeur</a>();</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>  <span class="keywordtype">int</span> nb_cond_lim = la_zone_cl.<a class="code hl_function" href="classZone__Cl__dis__base.html#ad9232707ebf3b339ecaf028072f268a4">nb_cond_lim</a>();</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span> </div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> indice_cl = 0; indice_cl &lt; nb_cond_lim; indice_cl++)</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>    {</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>      <span class="keyword">const</span> <a class="code hl_class" href="classCond__lim__base.html">Cond_lim_base</a>&amp; la_cl_base =</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>        la_zone_cl.<a class="code hl_function" href="classZone__Cl__dis__base.html#a9b068b594ffc0a2cb2eb08841efcd1f5">les_conditions_limites</a>(indice_cl).<a class="code hl_function" href="classDeriv__Cond__lim__base.html#afd7af50ad75a2cde929df2cedb684d58">valeur</a>();</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>      <span class="keyword">const</span> <a class="code hl_class" href="classFront__VF.html">Front_VF</a>&amp; frontiere_vf = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classFront__VF.html">Front_VF</a>, la_cl_base.<a class="code hl_function" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a">frontiere_dis</a>());</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span> </div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>      <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classNeumann__sortie__libre.html">Neumann_sortie_libre</a>, la_cl_base))</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>        {</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>          <a class="code hl_function" href="classAssembleur__P__VDF.html#a3e01aa32a7925771e8f8abf2f3556ebb">modifier_secmem_pression_imposee</a>(<a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>( <a class="code hl_class" href="classNeumann__sortie__libre.html">Neumann_sortie_libre</a>, la_cl_base),</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>                                           frontiere_vf,</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>                                           secmem);</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>        }</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classEntree__fluide__vitesse__imposee.html">Entree_fluide_vitesse_imposee</a>, la_cl_base))</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>        {</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>          <a class="code hl_function" href="classAssembleur__P__VDF.html#a9479432519c9424e8d5c6be2ce7a5493">modifier_secmem_vitesse_imposee</a>(<a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classEntree__fluide__vitesse__imposee.html">Entree_fluide_vitesse_imposee</a> ,la_cl_base),</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>                                          frontiere_vf,</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>                                          secmem);</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>        }</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classDirichlet__paroi__defilante.html">Dirichlet_paroi_defilante</a>, la_cl_base))</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>        {</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span><span class="comment">// Pour une paroi defilante, rien a faire.</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>        }</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classDirichlet__paroi__fixe.html">Dirichlet_paroi_fixe</a>, la_cl_base))</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>        {</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span><span class="comment">// Rien a faire non plus.</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>        }</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classSymetrie.html">Symetrie</a>, la_cl_base))</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>        {</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span><span class="comment">// Encore rien a faire</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>        }</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classPeriodique.html">Periodique</a>, la_cl_base))</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>        {</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span><span class="comment">// Rien a faire</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>        }</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>        {</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>          <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans Assembleur_P_VDF::modifier_secmem\n la condition aux limites &quot;</span>;</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>          <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; la_cl_base.<a class="code hl_function" href="classObjet__U.html#a58289bb63283588d31dc69b87b3f1d55">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; n&#39;est pas prise en charge.&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>          assert(0);</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>          <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>        }</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>    }</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>  secmem.<a class="code hl_function" href="classTRUSTVect.html#a7df489e59381e175b1df9cef48355fe5">echange_espace_virtuel</a>();</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>}</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span><span class="comment">//</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span><span class="comment">//</span></div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span><span class="comment">//</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span><span class="comment">//</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span><span class="comment">//</span></div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span><span class="comment">//</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span><span class="comment">//</span></div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span><span class="comment">//! Modification du second membre du solveur en pression pour une condition&lt;br&gt;&quot;Neumann_sortie_libre&quot;.&lt;br&gt;Calcul en &quot;increment de pression&quot; :&lt;br&gt;ajouter l&#39;increment de pression, c&#39;est a dire zero (c.l. instationnaire non supportee)&lt;br&gt;Calcul en &quot;pression&quot; :&lt;br&gt;Ajout du terme Pimpose * surface / volume_entrelace au second membre dans la discretisation de la&lt;br&gt;pression au bord (entre un element elem0 et un element fictif exterieur a pression imposee) :&lt;br&gt;grad P = (P(elem0) - Pimpose) * surface / volume_entrelace</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span><span class="comment"></span> </div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#a3e01aa32a7925771e8f8abf2f3556ebb">  552</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#a3e01aa32a7925771e8f8abf2f3556ebb">Assembleur_P_VDF::modifier_secmem_pression_imposee</a>(<span class="keyword">const</span> <a class="code hl_class" href="classNeumann__sortie__libre.html">Neumann_sortie_libre</a>&amp; cond_lim,</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>                                                        <span class="keyword">const</span> <a class="code hl_class" href="classFront__VF.html">Front_VF</a>&amp; frontiere_vf,</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>                                                        <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; secmem)</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>{</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; la_zone = <a class="code hl_variable" href="classAssembleur__P__VDF.html#a4ce1358c35e162057c7968aa583cd581">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; face_voisins = la_zone.<a class="code hl_function" href="classZone__VF.html#a1935d5babef3e13a64d7b997ce94cdd0">face_voisins</a>();</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="classAssembleur__base.html#aa2d92d66a1aac35c84a0e8cebe3050cb">get_resoudre_increment_pression</a>())</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>    {</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>      <span class="comment">/*</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span><span class="comment">        const Champ_front_base &amp; champ_front = cond_lim.champ_front().valeur();</span></div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span><span class="comment">        if (sub_type(Champ_front_instationnaire_base, champ_front)</span></div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span><span class="comment">        || sub_type(Champ_front_var_instationnaire, champ_front)) {</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span><span class="comment">        Cerr &lt;&lt; &quot;Erreur dans Assembleur_P_VDF::modifier_secmem_pression_imposee\n &quot;;</span></div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span><span class="comment">        Cerr &lt;&lt; champ_front.que_suis_je();</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span><span class="comment">        Cerr &lt;&lt; &quot; + resoudre_increment_pression non code&quot; &lt;&lt; finl;</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span><span class="comment">        assert(0);</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span><span class="comment">        exit();</span></div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span><span class="comment">        } else {</span></div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span><span class="comment">        // Champ stationnaire, on ajoute un increment de pression nul.</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span><span class="comment">        // Donc rien a faire.</span></div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span><span class="comment">        }</span></div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span><span class="comment">      */</span></div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    }</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    {</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces = frontiere_vf.<a class="code hl_function" href="classFront__VF.html#a48eadf1b57ddc0d16e4953d19f259a9e">nb_faces</a>();</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> num_premiere_face = frontiere_vf.<a class="code hl_function" href="classFront__VF.html#a930e90fb5e8e79adaad93b5c405d00d1">num_premiere_face</a>();</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_faces; i++)</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        {</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> num_face = num_premiere_face + i;</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> Pimp = cond_lim.<a class="code hl_function" href="classNeumann.html#a0b6ed33cc5c3ef854d46705c47e90c2a">flux_impose</a>(i);</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> coef = <a class="code hl_variable" href="classAssembleur__P__VDF.html#af8eca29a2e48d27e8e1f77e0945dc38d">les_coeff_pression</a>[num_face] * Pimp;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> elem = face_voisins(num_face, 0) + face_voisins(num_face, 1) + 1;</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>          secmem[elem] += coef;</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        }</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>    }</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>}</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span> </div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span><span class="comment">//</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span><span class="comment">//</span></div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span><span class="comment">//</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span><span class="comment">//! Modification du second membre du systeme en pression pour une condition aux limites&lt;br&gt;de vitesse imposee.&lt;br&gt;Si on resout en increment de pression, ...&lt;br&gt;sinon rien a faire.</span></div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#a9479432519c9424e8d5c6be2ce7a5493">  595</a></span><span class="comment"></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#a9479432519c9424e8d5c6be2ce7a5493">Assembleur_P_VDF::modifier_secmem_vitesse_imposee</a>(<span class="keyword">const</span> <a class="code hl_class" href="classEntree__fluide__vitesse__imposee.html">Entree_fluide_vitesse_imposee</a>&amp; cond_lim,</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>                                                       <span class="keyword">const</span> <a class="code hl_class" href="classFront__VF.html">Front_VF</a>&amp; frontiere_vf,</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>                                                       <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; secmem)</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>{</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>  <span class="keyword">const</span> <a class="code hl_class" href="classChamp__front__base.html">Champ_front_base</a>&amp; champ_front = cond_lim.<a class="code hl_function" href="classCond__lim__base.html#a8cddc02f544ee44bebd5bae0e6a9581c">champ_front</a>().<a class="code hl_function" href="classDeriv__Champ__front__base.html#afc0e0ae66b235e4468f2439fa15006d8">valeur</a>();</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; la_zone = <a class="code hl_variable" href="classAssembleur__P__VDF.html#a4ce1358c35e162057c7968aa583cd581">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; face_surfaces = la_zone.<a class="code hl_function" href="classZone__VF.html#a81a853efbcf5659d78f6a788b379841e">face_surfaces</a>();</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">IntTab</a>&amp; face_voisins = la_zone.<a class="code hl_function" href="classZone__VF.html#a1935d5babef3e13a64d7b997ce94cdd0">face_voisins</a>();</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span> </div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="classAssembleur__base.html#a46ffaff9861b8d91ff14dc83a3644774">get_resoudre_en_u</a>())</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    {</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>      <span class="keywordtype">int</span> gpoint_variable;</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>      <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classChamp__front__instationnaire__base.html">Champ_front_instationnaire_base</a>, champ_front))</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>        gpoint_variable = 0; <span class="comment">//!&lt; Instationnaire uniforme</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code hl_class" href="classChamp__front__var__instationnaire.html">Champ_front_var_instationnaire</a>, champ_front))</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>        gpoint_variable = 1; <span class="comment">//!&lt; Instationnaire variable</span></div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>        gpoint_variable = -1; <span class="comment">//!&lt; Stationnaire</span></div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span> </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>      <span class="keywordflow">if</span> (gpoint_variable &gt;= 0)</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>        {</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>          <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; tab_gpoint = (gpoint_variable)</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>                                        ? <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classChamp__front__var__instationnaire.html">Champ_front_var_instationnaire</a>,  champ_front).Gpoint()</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>                                        : <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classChamp__front__instationnaire__base.html">Champ_front_instationnaire_base</a>, champ_front).Gpoint();</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span> </div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces = frontiere_vf.<a class="code hl_function" href="classFront__VF.html#a48eadf1b57ddc0d16e4953d19f259a9e">nb_faces</a>();</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> num_premiere_face = frontiere_vf.<a class="code hl_function" href="classFront__VF.html#a930e90fb5e8e79adaad93b5c405d00d1">num_premiere_face</a>();</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_faces; i++)</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>            {</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> num_face = num_premiere_face + i;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> surface = face_surfaces(num_face);</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> elem0 = face_voisins(num_face, 0);</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> elem1 = face_voisins(num_face, 1);</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span><span class="comment">// gpoint est relatif a la normale a la face (elle pointe vers elem1)</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span><span class="comment">// La normale est-elle entrante ou sortante ?</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> signe = (elem0 &lt; 0) ? 1. : -1.;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span><span class="comment">// Numero de l&#39;element adjacent a la face de bord</span></div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> elem = elem0 + elem1 + 1;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>              <span class="keyword">const</span> <span class="keywordtype">int</span> ori = la_zone.<a class="code hl_function" href="classZone__VDF.html#a71671288eceb9fe858d5554b6ad2f039">orientation</a>(num_face);</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> gpoint = (gpoint_variable) ? tab_gpoint(i, ori) : tab_gpoint(ori);</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span> </div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>              secmem[elem] += signe * surface * gpoint;</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>            }</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>        }</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>        {</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span><span class="comment">// Le champ frontiere est stationnaire, rien a faire.</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>        }</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    }</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>    {</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span><span class="comment">// Resolution en pression: la condition aux limites est imposee ailleurs</span></div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>    }</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>}</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span> </div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#a66d0a9d3fb74cd5ea3bbfb2bbff10ae1">  650</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#a66d0a9d3fb74cd5ea3bbfb2bbff10ae1">Assembleur_P_VDF::modifier_solution</a>(<a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; pression)</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>{</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span><span class="comment">// Projection :</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>  <span class="keywordtype">double</span> press_0;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>  <span class="keywordflow">if</span>(!<a class="code hl_variable" href="classAssembleur__P__VDF.html#a9d277900967c598cd61dcc14dcb7ebbd">has_P_ref</a>)</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>    {</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span><span class="comment">// On prend la pression minimale comme pression de reference</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span><span class="comment">// afin d&#39;avoir la meme pression de reference en sequentiel et parallele</span></div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>      press_0=<a class="code hl_define" href="Double_8h.html#ae0ee0cebfad5968da0ad6cc7a49e16b6">DMAXFLOAT</a>;</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>      <span class="keywordtype">int</span> nb_elem=<a class="code hl_variable" href="classAssembleur__P__VDF.html#a4ce1358c35e162057c7968aa583cd581">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>().<a class="code hl_function" href="classZone__dis__base.html#aae671a49c7b02a69054a38bddb486cf8">zone</a>().<a class="code hl_function" href="classZone.html#a8bdea22b5802d97c07acd9e97de5eb88">nb_elem</a>();</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0; n&lt;nb_elem; n++)</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>        <span class="keywordflow">if</span> (pression[n] &lt; press_0)</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>          press_0 = pression[n];</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>      press_0 = <a class="code hl_function" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff">mp_min</a>(press_0);</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>      pression -=press_0;</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>      pression.<a class="code hl_function" href="classTRUSTVect.html#a7df489e59381e175b1df9cef48355fe5">echange_espace_virtuel</a>();</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>    }</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>}</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#a1ef951377983d30dd2d1fcb25044070e">  669</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#a1ef951377983d30dd2d1fcb25044070e">Assembleur_P_VDF::assembler_mat</a>(<a class="code hl_class" href="classMatrice.html">Matrice</a>&amp; matrice,<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; volumes_entrelaces,<span class="keywordtype">int</span> incr_pression,<span class="keywordtype">int</span> resoudre_en_u)</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>{</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>  <span class="keywordflow">if</span> (! matrice.<a class="code hl_function" href="classO__U__Ptr.html#a8d368932ee397da5ae25a9916fd88a59">non_nul</a>())</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>    {</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2">je_suis_maitre</a>())</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>        <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Assemblage de la matrice pression : Assembleur_P_VDF::assembler&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span><span class="comment">// Par defaut, resolution en increment de pression</span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>      <a class="code hl_function" href="classAssembleur__P__VDF.html#aa56befba8f81a9161c144f009d3cdddd">construire</a>(matrice);</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>    }</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>  <a class="code hl_function" href="classAssembleur__base.html#ad134c3371f3ced3768a1704be52e0fe8">set_resoudre_increment_pression</a>(incr_pression);</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>  <a class="code hl_function" href="classAssembleur__base.html#a9cdaa49e5340da74de179c2f22f08605">set_resoudre_en_u</a>(resoudre_en_u);</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span> </div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>  <a class="code hl_function" href="classAssembleur__P__VDF.html#ae6419915244b87d5c8f186d7c4fc1992">remplir</a>(matrice,volumes_entrelaces, 0);</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>}</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span> </div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span><span class="comment">//</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span><span class="comment">//</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span><span class="comment">//! Assemblage de la matrice de pression M telle que&lt;br&gt;M*P = div(porosite * grad (P))&lt;br&gt;et calcul des coefficients pour modifier_secmem.</span></div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#ae0ced9305ae0cfdaa9b514f82a6b937f">  689</a></span><span class="comment"></span><span class="keywordtype">int</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#ae0ced9305ae0cfdaa9b514f82a6b937f">Assembleur_P_VDF::assembler</a>(<a class="code hl_class" href="classMatrice.html">Matrice</a>&amp; matrice)</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>{</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2">je_suis_maitre</a>())</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>    <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Assemblage de la matrice pression : Assembleur_P_VDF::assembler&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span><span class="comment">// Par defaut, resolution en increment de pression</span></div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>  <a class="code hl_function" href="classAssembleur__base.html#ad134c3371f3ced3768a1704be52e0fe8">set_resoudre_increment_pression</a>(1);</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>  <a class="code hl_function" href="classAssembleur__base.html#a9cdaa49e5340da74de179c2f22f08605">set_resoudre_en_u</a>(1);</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>  <a class="code hl_function" href="classAssembleur__P__VDF.html#aa56befba8f81a9161c144f009d3cdddd">construire</a>(matrice);</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_vdf   = <a class="code hl_variable" href="classAssembleur__P__VDF.html#a4ce1358c35e162057c7968aa583cd581">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span> </div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; volumes_entrelaces = zone_vdf.<a class="code hl_function" href="classZone__VF.html#a64f0b549e5aea1656855113e3510f418">volumes_entrelaces</a>();</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>  <a class="code hl_function" href="classAssembleur__P__VDF.html#ae6419915244b87d5c8f186d7c4fc1992">remplir</a>(matrice,volumes_entrelaces, 0);</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>}</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span> </div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span><span class="comment">//</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span><span class="comment">//</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span><span class="comment">//</span></div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span><span class="comment">//</span></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span><span class="comment">//</span></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span><span class="comment">//</span></div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span><span class="comment">//</span></div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span><span class="comment">//</span></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span><span class="comment">//! Assemblage de la matrice de pression M telle que&lt;br&gt;M*P = div(porosite/rho * grad (P))&lt;br&gt;et calcul des coefficients pour modifier_secmem.&lt;br&gt;Parametre: matrice&lt;br&gt;Signification: La matrice a assembler.&lt;br&gt;Contrainte:    Soit la matrice n&#39;est pas encore typee (alors on la &quot;construit&quot;),&lt;br&gt;soit c&#39;est la meme que lors de l&#39;appel precedent.&lt;br&gt;Parametre: rho&lt;br&gt;Contrainte: Doit etre un champ de type Champ_Fonc_Face.</span></div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#aaa91031e4dce681de4413f54d157f1da">  714</a></span><span class="comment"></span><span class="keywordtype">int</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#aaa91031e4dce681de4413f54d157f1da">Assembleur_P_VDF::assembler_rho_variable</a>(<a class="code hl_class" href="classMatrice.html">Matrice</a>&amp; matrice,</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>                                             <span class="keyword">const</span> <a class="code hl_class" href="classChamp__Don__base.html">Champ_Don_base</a>&amp; rho)</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>{</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span><span class="comment">// assembler_rho_variable a ete introduit pour le front-tracking:</span></div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span><span class="comment">// il faut dire explicitement si on resout en increment de pression</span></div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>  assert(<a class="code hl_function" href="classAssembleur__base.html#aa2d92d66a1aac35c84a0e8cebe3050cb">get_resoudre_increment_pression</a>() &gt;= 0);</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span><span class="comment">// idem pour resoudre en u</span></div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>  assert(<a class="code hl_function" href="classAssembleur__base.html#a46ffaff9861b8d91ff14dc83a3644774">get_resoudre_en_u</a>() &gt;= 0);</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span><span class="comment">// Si la matrice n&#39;a pas encore ete typee, il faut la construire :</span></div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>  <span class="keywordflow">if</span> (! matrice.<a class="code hl_function" href="classO__U__Ptr.html#a8d368932ee397da5ae25a9916fd88a59">non_nul</a>())</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>    {</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2">je_suis_maitre</a>())</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>        {</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>          <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Assemblage de la matrice pression : &quot;</span>;</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>          <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Assembleur_P_VDF::assembler_rho_variable&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>        }</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>      <a class="code hl_function" href="classAssembleur__P__VDF.html#aa56befba8f81a9161c144f009d3cdddd">construire</a>(matrice);</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    }</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>  <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_vdf   = <a class="code hl_variable" href="classAssembleur__P__VDF.html#a4ce1358c35e162057c7968aa583cd581">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span> </div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>  <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; volumes_entrelaces = zone_vdf.<a class="code hl_function" href="classZone__VF.html#a64f0b549e5aea1656855113e3510f418">volumes_entrelaces</a>();</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>  <a class="code hl_function" href="classAssembleur__P__VDF.html#ae6419915244b87d5c8f186d7c4fc1992">remplir</a>(matrice,volumes_entrelaces, &amp; rho);</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>}</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span><span class="comment">// Precondition:</span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span><span class="comment">// Parametre: DoubleTab&amp; tab_rho</span></div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span><span class="comment">// Signification: mass volumique</span></div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span><span class="comment">// Valeurs par defaut:</span></div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span><span class="comment">// Contraintes: reference constante</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span><span class="comment">// Acces: lecture</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span><span class="comment">// Exception:</span></div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span><span class="comment">// Effets de bord:</span></div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span><span class="comment">// Postcondition:</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span><span class="comment">//</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span><span class="comment">//</span></div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span><span class="comment">//</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span><span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span><span class="comment">//! Assemble la matrice de pression pour un fluide quasi compressible.&lt;br&gt;La matrice M est telle que M*P = div( porosite * grad(P) ).&lt;br&gt;Le drapeau resoudre_increment_pression est mis a zero s&#39;il n&#39;a pas&lt;br&gt;encore ete assigne.</span></div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span><span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span></div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span><span class="comment">Signification: renvoie toujours 1&lt;br&gt;</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span><span class="comment">Contraintes: */</span></div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#a4a47b38cf91f940b0a7b139212214cf5">  756</a></span><span class="keywordtype">int</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#a4a47b38cf91f940b0a7b139212214cf5">Assembleur_P_VDF::assembler_QC</a>(<span class="keyword">const</span> <a class="code hl_class" href="classTRUSTTab.html">DoubleTab</a>&amp; tab_rho, <a class="code hl_class" href="classMatrice.html">Matrice</a>&amp; matrice)</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>{</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span><span class="comment">// Par defaut pour le qc: resolution en pression et pas en increment pression.</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="classAssembleur__base.html#aa2d92d66a1aac35c84a0e8cebe3050cb">get_resoudre_increment_pression</a>() &lt; 0)</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>    {</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>      <a class="code hl_function" href="classAssembleur__base.html#ad134c3371f3ced3768a1704be52e0fe8">set_resoudre_increment_pression</a>(1);</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>      <a class="code hl_function" href="classAssembleur__base.html#a9cdaa49e5340da74de179c2f22f08605">set_resoudre_en_u</a>(0);</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    }</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>  <span class="keywordflow">if</span> (! matrice.<a class="code hl_function" href="classO__U__Ptr.html#a8d368932ee397da5ae25a9916fd88a59">non_nul</a>())</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>    {</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2">je_suis_maitre</a>())</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>        {</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>          <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Assemblage de la matrice pression : &quot;</span>;</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>          <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Assembleur_P_VDF::assembler_QC&quot;</span> &lt;&lt; <a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>        }</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>      <a class="code hl_function" href="classAssembleur__P__VDF.html#aa56befba8f81a9161c144f009d3cdddd">construire</a>(matrice);</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>      <span class="keyword">const</span> <a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>&amp; zone_vdf   = <a class="code hl_variable" href="classAssembleur__P__VDF.html#a4ce1358c35e162057c7968aa583cd581">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span> </div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>      <span class="keyword">const</span> <a class="code hl_class" href="classTRUSTVect.html">DoubleVect</a>&amp; volumes_entrelaces = zone_vdf.<a class="code hl_function" href="classZone__VF.html#a64f0b549e5aea1656855113e3510f418">volumes_entrelaces</a>();</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>      <a class="code hl_function" href="classAssembleur__P__VDF.html#ae6419915244b87d5c8f186d7c4fc1992">remplir</a>(matrice,volumes_entrelaces, 0);</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span> </div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>      <a class="code hl_class" href="classMatrice__Bloc.html">Matrice_Bloc</a>&amp; matrice_bloc=<a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classMatrice__Bloc.html">Matrice_Bloc</a>,matrice.<a class="code hl_function" href="classDeriv__Matrice__Base.html#a6d78a97ea87044a4b8c0cc2c6609f3e0">valeur</a>());</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>      <a class="code hl_class" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a>&amp; la_matrice =<a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a>,matrice_bloc.<a class="code hl_function" href="classMatrice__Bloc.html#a76a5691fecfea8b4dd877d2c449a7f21">get_bloc</a>(0,0).<a class="code hl_function" href="classDeriv__Matrice__Base.html#a6d78a97ea87044a4b8c0cc2c6609f3e0">valeur</a>());</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>      <span class="keywordflow">if</span> (la_matrice.<a class="code hl_function" href="classMatrice__Sym.html#a8d800deeea9f4aea802d15cd1c3c83f2">get_est_definie</a>()!=1)</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>        {</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>          <span class="keywordflow">if</span> ((<a class="code hl_function" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2">je_suis_maitre</a>()) &amp;&amp; (la_matrice.<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>()==0) &amp;&amp; (la_matrice.<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>()==0))</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>            {</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Pressure matrix will not be defined.&quot;</span>&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>              <a class="code hl_function" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">exit</a>();</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>            }</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span> </div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>          <span class="keywordflow">if</span> ((la_matrice.<a class="code hl_function" href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">nb_lignes</a>()&gt;0) &amp;&amp; (la_matrice.<a class="code hl_function" href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">nb_colonnes</a>()&gt;0))</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>            {</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;la_matrice(0,0)&quot;</span>&lt;&lt;la_matrice(0,0)&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>              <a class="code hl_define" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Pas de pression imposee  --&gt; P(0)=0&quot;</span>&lt;&lt;<a class="code hl_variable" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>              <span class="keywordflow">if</span> (<a class="code hl_function" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2">je_suis_maitre</a>())    la_matrice(0,0) *= 2;</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>            }</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>          la_matrice.<a class="code hl_function" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(1);</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>        }</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>    }</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>}</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span> </div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#a8c611acb1b51a4d67f19e53d4fa7d81e">  799</a></span><span class="keyword">const</span> <a class="code hl_class" href="classZone__dis__base.html">Zone_dis_base</a>&amp; <a class="code hl_function" href="classAssembleur__P__VDF.html#a8c611acb1b51a4d67f19e53d4fa7d81e">Assembleur_P_VDF::zone_dis_base</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classAssembleur__P__VDF.html#a4ce1358c35e162057c7968aa583cd581">la_zone_VDF</a>.<a class="code hl_function" href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">valeur</a>();</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>}</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span> </div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#a3a94fb2f12592af4178bbc87998d3019">  804</a></span><span class="keyword">const</span> <a class="code hl_class" href="classZone__Cl__dis__base.html">Zone_Cl_dis_base</a>&amp; <a class="code hl_function" href="classAssembleur__P__VDF.html#a3a94fb2f12592af4178bbc87998d3019">Assembleur_P_VDF::zone_Cl_dis_base</a>()<span class="keyword"> const</span></div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classAssembleur__P__VDF.html#a0b984a6831f2750865e12296e5e07a2b">la_zone_Cl_VDF</a>.<a class="code hl_function" href="classRef__Zone__Cl__VDF.html#a1c097927828f629a20594dfd86ce8b9f">valeur</a>();</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>}</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span> </div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#a794efad4362070b0dcfe2fb90ce6e551">  809</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#a794efad4362070b0dcfe2fb90ce6e551">Assembleur_P_VDF::associer_zone_dis_base</a>(<span class="keyword">const</span> <a class="code hl_class" href="classZone__dis__base.html">Zone_dis_base</a>&amp; la_zone_dis)</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>{</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>  <a class="code hl_variable" href="classAssembleur__P__VDF.html#a4ce1358c35e162057c7968aa583cd581">la_zone_VDF</a> = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classZone__VDF.html">Zone_VDF</a>, la_zone_dis);</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>}</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span> </div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#ae0266e4567add4c0f61aa1bf6e63e732">  814</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#ae0266e4567add4c0f61aa1bf6e63e732">Assembleur_P_VDF::associer_zone_cl_dis_base</a>(<span class="keyword">const</span> <a class="code hl_class" href="classZone__Cl__dis__base.html">Zone_Cl_dis_base</a>&amp; la_zone_Cl_dis)</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>{</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>  <a class="code hl_variable" href="classAssembleur__P__VDF.html#a0b984a6831f2750865e12296e5e07a2b">la_zone_Cl_VDF</a> = <a class="code hl_define" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code hl_class" href="classZone__Cl__VDF.html">Zone_Cl_VDF</a>, la_zone_Cl_dis);</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>}</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span> </div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno"><a class="line" href="classAssembleur__P__VDF.html#ae265c9c69cd635de9b9cd825ba9b6d22">  819</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classAssembleur__P__VDF.html#ae265c9c69cd635de9b9cd825ba9b6d22">Assembleur_P_VDF::completer</a>(<span class="keyword">const</span> <a class="code hl_class" href="classEquation__base.html">Equation_base</a>&amp; Eqn)</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>{</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span><span class="comment">// CCa 30/04/99 : je ne sais pas si je dois faire qqchose</span></div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>  ;</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>}</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span> </div>
<div class="ttc" id="aAssembleurPP1BUtil_8cpp_html_a3e374d53ebc7860e1c2f0b7906f2936d"><div class="ttname"><a href="AssembleurPP1BUtil_8cpp.html#a3e374d53ebc7860e1c2f0b7906f2936d">face_associee</a></div><div class="ttdeci">static int face_associee</div><div class="ttdef"><b>Definition:</b> <a href="AssembleurPP1BUtil_8cpp_source.html#l00033">AssembleurPP1BUtil.cpp:33</a></div></div>
<div class="ttc" id="aAssembleur__P__VDF_8h_html"><div class="ttname"><a href="Assembleur__P__VDF_8h.html">Assembleur_P_VDF.h</a></div></div>
<div class="ttc" id="aCast_8h_html_a9632e68536db6c29c2b754cb55381fbe"><div class="ttname"><a href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a></div><div class="ttdeci">#define sub_type(T, r)</div><div class="ttdef"><b>Definition:</b> <a href="Cast_8h_source.html#l00047">Cast.h:47</a></div></div>
<div class="ttc" id="aCast_8h_html_ad116a7acb85c9c91e5687c44941a0d0c"><div class="ttname"><a href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a></div><div class="ttdeci">#define ref_cast(T, r)</div><div class="ttdef"><b>Definition:</b> <a href="Cast_8h_source.html#l00052">Cast.h:52</a></div></div>
<div class="ttc" id="aChamp__Fonc__Face_8h_html"><div class="ttname"><a href="Champ__Fonc__Face_8h.html">Champ_Fonc_Face.h</a></div></div>
<div class="ttc" id="aChamp__front__instationnaire__base_8h_html"><div class="ttname"><a href="Champ__front__instationnaire__base_8h.html">Champ_front_instationnaire_base.h</a></div></div>
<div class="ttc" id="aChamp__front__var__instationnaire_8h_html"><div class="ttname"><a href="Champ__front__var__instationnaire_8h.html">Champ_front_var_instationnaire.h</a></div></div>
<div class="ttc" id="aDeclare__Inst_8h_html_afcab3f7633508e92f2077d767e19bc60"><div class="ttname"><a href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a></div><div class="ttdeci">#define Implemente_instanciable_sans_constructeur(_TYPE_, _NOM_, _BASE_)</div><div class="ttdef"><b>Definition:</b> <a href="Declare__Inst_8h_source.html#l00101">Declare_Inst.h:101</a></div></div>
<div class="ttc" id="aDirichlet__paroi__defilante_8h_html"><div class="ttname"><a href="Dirichlet__paroi__defilante_8h.html">Dirichlet_paroi_defilante.h</a></div></div>
<div class="ttc" id="aDirichlet__paroi__fixe_8h_html"><div class="ttname"><a href="Dirichlet__paroi__fixe_8h.html">Dirichlet_paroi_fixe.h</a></div></div>
<div class="ttc" id="aDouble_8h_html_aa4be1ab61f49e9ebb241ed3f4957fd4a"><div class="ttname"><a href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a">carre</a></div><div class="ttdeci">double carre(double x)</div><div class="ttdoc">: fonctions utiles sur les double</div><div class="ttdef"><b>Definition:</b> <a href="Double_8h_source.html#l00072">Double.h:72</a></div></div>
<div class="ttc" id="aDouble_8h_html_ac86f5f350b0f95fd8c34b0ac8d720f6f"><div class="ttname"><a href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a></div><div class="ttdeci">int est_egal(double x1, double x2, double eps)</div><div class="ttdef"><b>Definition:</b> <a href="Double_8h_source.html#l00091">Double.h:91</a></div></div>
<div class="ttc" id="aDouble_8h_html_ae0ee0cebfad5968da0ad6cc7a49e16b6"><div class="ttname"><a href="Double_8h.html#ae0ee0cebfad5968da0ad6cc7a49e16b6">DMAXFLOAT</a></div><div class="ttdeci">#define DMAXFLOAT</div><div class="ttdef"><b>Definition:</b> <a href="Double_8h_source.html#l00064">Double.h:64</a></div></div>
<div class="ttc" id="aEntreeSortie_8h_html_a5ebb6b5243d6167369bddecb78d0b5b8"><div class="ttname"><a href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a></div><div class="ttdeci">#define Cerr</div><div class="ttdef"><b>Definition:</b> <a href="EntreeSortie_8h_source.html#l00025">EntreeSortie.h:25</a></div></div>
<div class="ttc" id="aEntreeSortie_8h_html_a7f716d3c5b6411631d5d0700ead09467"><div class="ttname"><a href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a></div><div class="ttdeci">const Separateur finl</div></div>
<div class="ttc" id="aEntree__fluide__vitesse__imposee_8h_html"><div class="ttname"><a href="Entree__fluide__vitesse__imposee_8h.html">Entree_fluide_vitesse_imposee.h</a></div></div>
<div class="ttc" id="aMatrice__Bloc_8h_html"><div class="ttname"><a href="Matrice__Bloc_8h.html">Matrice_Bloc.h</a></div></div>
<div class="ttc" id="aMatrice__Morse__Sym_8h_html"><div class="ttname"><a href="Matrice__Morse__Sym_8h.html">Matrice_Morse_Sym.h</a></div></div>
<div class="ttc" id="aNeumann__sortie__libre_8h_html"><div class="ttname"><a href="Neumann__sortie__libre_8h.html">Neumann_sortie_libre.h</a></div></div>
<div class="ttc" id="aOption__VDF_8h_html"><div class="ttname"><a href="Option__VDF_8h.html">Option_VDF.h</a></div></div>
<div class="ttc" id="aPeriodique_8h_html"><div class="ttname"><a href="Periodique_8h.html">Periodique.h</a></div></div>
<div class="ttc" id="aSymetrie_8h_html"><div class="ttname"><a href="Symetrie_8h.html">Symetrie.h</a></div></div>
<div class="ttc" id="aZone__Cl__VDF_8h_html"><div class="ttname"><a href="Zone__Cl__VDF_8h.html">Zone_Cl_VDF.h</a></div></div>
<div class="ttc" id="aZone__VDF_8h_html"><div class="ttname"><a href="Zone__VDF_8h.html">Zone_VDF.h</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html"><div class="ttname"><a href="classAssembleur__P__VDF.html">Assembleur_P_VDF</a></div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8h_source.html#l00033">Assembleur_P_VDF.h:34</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a0b984a6831f2750865e12296e5e07a2b"><div class="ttname"><a href="classAssembleur__P__VDF.html#a0b984a6831f2750865e12296e5e07a2b">Assembleur_P_VDF::la_zone_Cl_VDF</a></div><div class="ttdeci">Ref_Zone_Cl_VDF la_zone_Cl_VDF</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8h_source.html#l00062">Assembleur_P_VDF.h:62</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a1eb89e9a5ecba7f508ef2241936e063e"><div class="ttname"><a href="classAssembleur__P__VDF.html#a1eb89e9a5ecba7f508ef2241936e063e">Assembleur_P_VDF::printOn</a></div><div class="ttdeci">Sortie &amp; printOn(Sortie &amp;x) const override</div><div class="ttdoc">Ecriture de l'objet sur un flot de sortie Methode a surcharger.</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00039">Assembleur_P_VDF.cpp:39</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a1ef951377983d30dd2d1fcb25044070e"><div class="ttname"><a href="classAssembleur__P__VDF.html#a1ef951377983d30dd2d1fcb25044070e">Assembleur_P_VDF::assembler_mat</a></div><div class="ttdeci">int assembler_mat(Matrice &amp;, const DoubleVect &amp;, int incr_pression, int resoudre_en_u) override</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00669">Assembleur_P_VDF.cpp:669</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a3a94fb2f12592af4178bbc87998d3019"><div class="ttname"><a href="classAssembleur__P__VDF.html#a3a94fb2f12592af4178bbc87998d3019">Assembleur_P_VDF::zone_Cl_dis_base</a></div><div class="ttdeci">const Zone_Cl_dis_base &amp; zone_Cl_dis_base() const override</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00804">Assembleur_P_VDF.cpp:804</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a3e01aa32a7925771e8f8abf2f3556ebb"><div class="ttname"><a href="classAssembleur__P__VDF.html#a3e01aa32a7925771e8f8abf2f3556ebb">Assembleur_P_VDF::modifier_secmem_pression_imposee</a></div><div class="ttdeci">void modifier_secmem_pression_imposee(const Neumann_sortie_libre &amp;cond_lim, const Front_VF &amp;frontiere_vf, DoubleTab &amp;secmem)</div><div class="ttdoc">Modification du second membre du solveur en pression pour une condition &quot;Neumann_sortie_libre&quot;....</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00552">Assembleur_P_VDF.cpp:552</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a44ad326fcee9e70eea8f87dc3b2aa939"><div class="ttname"><a href="classAssembleur__P__VDF.html#a44ad326fcee9e70eea8f87dc3b2aa939">Assembleur_P_VDF::modifier_secmem</a></div><div class="ttdeci">int modifier_secmem(DoubleTab &amp;) override</div><div class="ttdoc">Modification du second membre pour appliquer les conditions aux limites. Les conditions prises en cha...</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00490">Assembleur_P_VDF.cpp:490</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a48da6c5fc5769465a659da41fab00812"><div class="ttname"><a href="classAssembleur__P__VDF.html#a48da6c5fc5769465a659da41fab00812">Assembleur_P_VDF::liste_faces_periodiques</a></div><div class="ttdeci">int liste_faces_periodiques(ArrOfInt &amp;faces)</div><div class="ttdoc">Remplit le tableau faces avec la liste des indices des faces periodiques dans le tableau faces_voisin...</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00057">Assembleur_P_VDF.cpp:57</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a4a47b38cf91f940b0a7b139212214cf5"><div class="ttname"><a href="classAssembleur__P__VDF.html#a4a47b38cf91f940b0a7b139212214cf5">Assembleur_P_VDF::assembler_QC</a></div><div class="ttdeci">int assembler_QC(const DoubleTab &amp;, Matrice &amp;) override</div><div class="ttdoc">Assemble la matrice de pression pour un fluide quasi compressible. La matrice M est telle que M*P = d...</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00756">Assembleur_P_VDF.cpp:756</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a4ce1358c35e162057c7968aa583cd581"><div class="ttname"><a href="classAssembleur__P__VDF.html#a4ce1358c35e162057c7968aa583cd581">Assembleur_P_VDF::la_zone_VDF</a></div><div class="ttdeci">Ref_Zone_VDF la_zone_VDF</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8h_source.html#l00061">Assembleur_P_VDF.h:61</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a5ca1a2d4c78187e5c5b47c4c7119f954"><div class="ttname"><a href="classAssembleur__P__VDF.html#a5ca1a2d4c78187e5c5b47c4c7119f954">Assembleur_P_VDF::readOn</a></div><div class="ttdeci">Entree &amp; readOn(Entree &amp;) override</div><div class="ttdoc">Lecture d'un Objet_U sur un flot d'entree Methode a surcharger.</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00044">Assembleur_P_VDF.cpp:44</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a66d0a9d3fb74cd5ea3bbfb2bbff10ae1"><div class="ttname"><a href="classAssembleur__P__VDF.html#a66d0a9d3fb74cd5ea3bbfb2bbff10ae1">Assembleur_P_VDF::modifier_solution</a></div><div class="ttdeci">int modifier_solution(DoubleTab &amp;) override</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00650">Assembleur_P_VDF.cpp:650</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a794efad4362070b0dcfe2fb90ce6e551"><div class="ttname"><a href="classAssembleur__P__VDF.html#a794efad4362070b0dcfe2fb90ce6e551">Assembleur_P_VDF::associer_zone_dis_base</a></div><div class="ttdeci">void associer_zone_dis_base(const Zone_dis_base &amp;) override</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00809">Assembleur_P_VDF.cpp:809</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a8c611acb1b51a4d67f19e53d4fa7d81e"><div class="ttname"><a href="classAssembleur__P__VDF.html#a8c611acb1b51a4d67f19e53d4fa7d81e">Assembleur_P_VDF::zone_dis_base</a></div><div class="ttdeci">const Zone_dis_base &amp; zone_dis_base() const override</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00799">Assembleur_P_VDF.cpp:799</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a9479432519c9424e8d5c6be2ce7a5493"><div class="ttname"><a href="classAssembleur__P__VDF.html#a9479432519c9424e8d5c6be2ce7a5493">Assembleur_P_VDF::modifier_secmem_vitesse_imposee</a></div><div class="ttdeci">void modifier_secmem_vitesse_imposee(const Entree_fluide_vitesse_imposee &amp;cond_lim, const Front_VF &amp;frontiere_vf, DoubleTab &amp;secmem)</div><div class="ttdoc">Modification du second membre du systeme en pression pour une condition aux limites de vitesse impose...</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00595">Assembleur_P_VDF.cpp:595</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_a9d277900967c598cd61dcc14dcb7ebbd"><div class="ttname"><a href="classAssembleur__P__VDF.html#a9d277900967c598cd61dcc14dcb7ebbd">Assembleur_P_VDF::has_P_ref</a></div><div class="ttdeci">int has_P_ref</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8h_source.html#l00066">Assembleur_P_VDF.h:66</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_aa56befba8f81a9161c144f009d3cdddd"><div class="ttname"><a href="classAssembleur__P__VDF.html#aa56befba8f81a9161c144f009d3cdddd">Assembleur_P_VDF::construire</a></div><div class="ttdeci">int construire(Matrice &amp;la_matrice)</div><div class="ttdoc">Determine les elements non nuls de la matrice et prepare le stockage. Matrice creuse de taille nb_ele...</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00104">Assembleur_P_VDF.cpp:104</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_aaa91031e4dce681de4413f54d157f1da"><div class="ttname"><a href="classAssembleur__P__VDF.html#aaa91031e4dce681de4413f54d157f1da">Assembleur_P_VDF::assembler_rho_variable</a></div><div class="ttdeci">int assembler_rho_variable(Matrice &amp;, const Champ_Don_base &amp;rho) override</div><div class="ttdoc">Assemblage de la matrice de pression M telle que M*P = div(porosite/rho * grad (P)) et calcul des coe...</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00714">Assembleur_P_VDF.cpp:714</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_ae0266e4567add4c0f61aa1bf6e63e732"><div class="ttname"><a href="classAssembleur__P__VDF.html#ae0266e4567add4c0f61aa1bf6e63e732">Assembleur_P_VDF::associer_zone_cl_dis_base</a></div><div class="ttdeci">void associer_zone_cl_dis_base(const Zone_Cl_dis_base &amp;) override</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00814">Assembleur_P_VDF.cpp:814</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_ae0ced9305ae0cfdaa9b514f82a6b937f"><div class="ttname"><a href="classAssembleur__P__VDF.html#ae0ced9305ae0cfdaa9b514f82a6b937f">Assembleur_P_VDF::assembler</a></div><div class="ttdeci">int assembler(Matrice &amp;) override</div><div class="ttdoc">Assemblage de la matrice de pression M telle que M*P = div(porosite * grad (P)) et calcul des coeffic...</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00689">Assembleur_P_VDF.cpp:689</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_ae265c9c69cd635de9b9cd825ba9b6d22"><div class="ttname"><a href="classAssembleur__P__VDF.html#ae265c9c69cd635de9b9cd825ba9b6d22">Assembleur_P_VDF::completer</a></div><div class="ttdeci">void completer(const Equation_base &amp;) override</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00819">Assembleur_P_VDF.cpp:819</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_ae6419915244b87d5c8f186d7c4fc1992"><div class="ttname"><a href="classAssembleur__P__VDF.html#ae6419915244b87d5c8f186d7c4fc1992">Assembleur_P_VDF::remplir</a></div><div class="ttdeci">int remplir(Matrice &amp;la_matrice, const DoubleVect &amp;volumes_entrelaces, const Champ_Don_base *rho_ptr)</div><div class="ttdoc">Calcul des coefficients de la matrice de pression avec un champ de rho. Si rho_ptr == 0,...</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00295">Assembleur_P_VDF.cpp:295</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_af7a5bf2f0a8a8f6ba21650a19c3dc7f1"><div class="ttname"><a href="classAssembleur__P__VDF.html#af7a5bf2f0a8a8f6ba21650a19c3dc7f1">Assembleur_P_VDF::Assembleur_P_VDF</a></div><div class="ttdeci">Assembleur_P_VDF()</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8cpp_source.html#l00034">Assembleur_P_VDF.cpp:34</a></div></div>
<div class="ttc" id="aclassAssembleur__P__VDF_html_af8eca29a2e48d27e8e1f77e0945dc38d"><div class="ttname"><a href="classAssembleur__P__VDF.html#af8eca29a2e48d27e8e1f77e0945dc38d">Assembleur_P_VDF::les_coeff_pression</a></div><div class="ttdeci">ArrOfDouble les_coeff_pression</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__P__VDF_8h_source.html#l00063">Assembleur_P_VDF.h:63</a></div></div>
<div class="ttc" id="aclassAssembleur__base_html"><div class="ttname"><a href="classAssembleur__base.html">Assembleur_base</a></div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__base_8h_source.html#l00029">Assembleur_base.h:30</a></div></div>
<div class="ttc" id="aclassAssembleur__base_html_a46ffaff9861b8d91ff14dc83a3644774"><div class="ttname"><a href="classAssembleur__base.html#a46ffaff9861b8d91ff14dc83a3644774">Assembleur_base::get_resoudre_en_u</a></div><div class="ttdeci">int get_resoudre_en_u() const</div><div class="ttdoc">Renvoie la valeur du drapeau resoudre_en_u_ (0 ou 1) Renvoie -1 si le drapeau n'a pas ete initialise.</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__base_8cpp_source.html#l00080">Assembleur_base.cpp:80</a></div></div>
<div class="ttc" id="aclassAssembleur__base_html_a4ca831196512e41293b71d701c64a8e4"><div class="ttname"><a href="classAssembleur__base.html#a4ca831196512e41293b71d701c64a8e4">Assembleur_base::readOn</a></div><div class="ttdeci">Entree &amp; readOn(Entree &amp;) override</div><div class="ttdoc">Lecture d'un Objet_U sur un flot d'entree Methode a surcharger.</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__base_8cpp_source.html#l00036">Assembleur_base.cpp:36</a></div></div>
<div class="ttc" id="aclassAssembleur__base_html_a9cdaa49e5340da74de179c2f22f08605"><div class="ttname"><a href="classAssembleur__base.html#a9cdaa49e5340da74de179c2f22f08605">Assembleur_base::set_resoudre_en_u</a></div><div class="ttdeci">int set_resoudre_en_u(int flag)</div><div class="ttdoc">Definit la valeur du drapeau resoudre_en_u__. Ce drapeau determine si le solveur en pression resou en...</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__base_8cpp_source.html#l00070">Assembleur_base.cpp:70</a></div></div>
<div class="ttc" id="aclassAssembleur__base_html_aa2d92d66a1aac35c84a0e8cebe3050cb"><div class="ttname"><a href="classAssembleur__base.html#aa2d92d66a1aac35c84a0e8cebe3050cb">Assembleur_base::get_resoudre_increment_pression</a></div><div class="ttdeci">int get_resoudre_increment_pression() const</div><div class="ttdoc">Renvoie la valeur du drapeau resoudre_increment_pression_ (0 ou 1) Renvoie -1 si le drapeau n'a pas e...</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__base_8cpp_source.html#l00058">Assembleur_base.cpp:58</a></div></div>
<div class="ttc" id="aclassAssembleur__base_html_ad134c3371f3ced3768a1704be52e0fe8"><div class="ttname"><a href="classAssembleur__base.html#ad134c3371f3ced3768a1704be52e0fe8">Assembleur_base::set_resoudre_increment_pression</a></div><div class="ttdeci">int set_resoudre_increment_pression(int flag)</div><div class="ttdoc">Definit la valeur du drapeau resoudre_increment_pression_. Ce drapeau determine si le solveur en pres...</div><div class="ttdef"><b>Definition:</b> <a href="Assembleur__base_8cpp_source.html#l00048">Assembleur_base.cpp:48</a></div></div>
<div class="ttc" id="aclassChamp__Don__base_html"><div class="ttname"><a href="classChamp__Don__base.html">Champ_Don_base</a></div><div class="ttdef"><b>Definition:</b> <a href="Champ__Don__base_8h_source.html#l00036">Champ_Don_base.h:37</a></div></div>
<div class="ttc" id="aclassChamp__Don__base_html_abb194455f5439d74ce449f1bd937486a"><div class="ttname"><a href="classChamp__Don__base.html#abb194455f5439d74ce449f1bd937486a">Champ_Don_base::valeurs</a></div><div class="ttdeci">DoubleTab &amp; valeurs() override</div><div class="ttdoc">Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Don__base_8cpp_source.html#l00092">Champ_Don_base.cpp:92</a></div></div>
<div class="ttc" id="aclassChamp__Fonc__Face_html"><div class="ttname"><a href="classChamp__Fonc__Face.html">Champ_Fonc_Face</a></div><div class="ttdoc">classe Champ_Fonc_Face</div><div class="ttdef"><b>Definition:</b> <a href="Champ__Fonc__Face_8h_source.html#l00030">Champ_Fonc_Face.h:31</a></div></div>
<div class="ttc" id="aclassChamp__front__base_html"><div class="ttname"><a href="classChamp__front__base.html">Champ_front_base</a></div><div class="ttdoc">classe Champ_front_base Classe de base pour la hierarchie des champs aux frontieres....</div><div class="ttdef"><b>Definition:</b> <a href="Champ__front__base_8h_source.html#l00081">Champ_front_base.h:82</a></div></div>
<div class="ttc" id="aclassChamp__front__instationnaire__base_html"><div class="ttname"><a href="classChamp__front__instationnaire__base.html">Champ_front_instationnaire_base</a></div><div class="ttdoc">classe Champ_front_base Classe de base pour les Champs aux frontieres instationnaires,...</div><div class="ttdef"><b>Definition:</b> <a href="Champ__front__instationnaire__base_8h_source.html#l00037">Champ_front_instationnaire_base.h:38</a></div></div>
<div class="ttc" id="aclassChamp__front__var__instationnaire_html"><div class="ttname"><a href="classChamp__front__var__instationnaire.html">Champ_front_var_instationnaire</a></div><div class="ttdoc">classe Champ_front_var_instationnaire Classe derivee de Champ_front_var qui represente les champs aux...</div><div class="ttdef"><b>Definition:</b> <a href="Champ__front__var__instationnaire_8h_source.html#l00042">Champ_front_var_instationnaire.h:43</a></div></div>
<div class="ttc" id="aclassCond__lim__base_html"><div class="ttname"><a href="classCond__lim__base.html">Cond_lim_base</a></div><div class="ttdoc">classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...</div><div class="ttdef"><b>Definition:</b> <a href="Cond__lim__base_8h_source.html#l00047">Cond_lim_base.h:48</a></div></div>
<div class="ttc" id="aclassCond__lim__base_html_a8cddc02f544ee44bebd5bae0e6a9581c"><div class="ttname"><a href="classCond__lim__base.html#a8cddc02f544ee44bebd5bae0e6a9581c">Cond_lim_base::champ_front</a></div><div class="ttdeci">Champ_front &amp; champ_front()</div><div class="ttdef"><b>Definition:</b> <a href="Cond__lim__base_8h_source.html#l00189">Cond_lim_base.h:189</a></div></div>
<div class="ttc" id="aclassCond__lim__base_html_ad88b3b516351146c85e8fce1df0f691a"><div class="ttname"><a href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a">Cond_lim_base::frontiere_dis</a></div><div class="ttdeci">virtual Frontiere_dis_base &amp; frontiere_dis()</div><div class="ttdoc">Renvoie la frontiere discretisee a laquelle les conditions aux limites s'appliquent.</div><div class="ttdef"><b>Definition:</b> <a href="Cond__lim__base_8h_source.html#l00116">Cond_lim_base.h:116</a></div></div>
<div class="ttc" id="aclassConds__lim_html"><div class="ttname"><a href="classConds__lim.html">Conds_lim</a></div><div class="ttdef"><b>Definition:</b> <a href="Conds__lim_8h_source.html#l00038">Conds_lim.h:39</a></div></div>
<div class="ttc" id="aclassDeriv__Champ__front__base_html_afc0e0ae66b235e4468f2439fa15006d8"><div class="ttname"><a href="classDeriv__Champ__front__base.html#afc0e0ae66b235e4468f2439fa15006d8">Deriv_Champ_front_base::valeur</a></div><div class="ttdeci">const Champ_front_base &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Champ__front_8h_source.html#l00023">Champ_front.h:23</a></div></div>
<div class="ttc" id="aclassDeriv__Cond__lim__base_html_afd7af50ad75a2cde929df2cedb684d58"><div class="ttname"><a href="classDeriv__Cond__lim__base.html#afd7af50ad75a2cde929df2cedb684d58">Deriv_Cond_lim_base::valeur</a></div><div class="ttdeci">const Cond_lim_base &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Cond__lim_8h_source.html#l00024">Cond_lim.h:24</a></div></div>
<div class="ttc" id="aclassDeriv__Matrice__Base_html_a6d78a97ea87044a4b8c0cc2c6609f3e0"><div class="ttname"><a href="classDeriv__Matrice__Base.html#a6d78a97ea87044a4b8c0cc2c6609f3e0">Deriv_Matrice_Base::valeur</a></div><div class="ttdeci">const Matrice_Base &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Deriv__Matrice__Base_8h_source.html#l00021">Deriv_Matrice_Base.h:21</a></div></div>
<div class="ttc" id="aclassDeriv___html_ad1d33400ed15b6ff96579ed82d9e2719"><div class="ttname"><a href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719">Deriv_::typer</a></div><div class="ttdeci">Objet_U * typer(const char *nom_type)</div><div class="ttdoc">Essaie de creer une instance du type &quot;type&quot;. si type n'est pas un type ou type n'est pas instanciable...</div><div class="ttdef"><b>Definition:</b> <a href="Deriv___8cpp_source.html#l00084">Deriv_.cpp:84</a></div></div>
<div class="ttc" id="aclassDirichlet__paroi__defilante_html"><div class="ttname"><a href="classDirichlet__paroi__defilante.html">Dirichlet_paroi_defilante</a></div><div class="ttdoc">classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes.</div><div class="ttdef"><b>Definition:</b> <a href="Dirichlet__paroi__defilante_8h_source.html#l00034">Dirichlet_paroi_defilante.h:35</a></div></div>
<div class="ttc" id="aclassDirichlet__paroi__fixe_html"><div class="ttname"><a href="classDirichlet__paroi__fixe.html">Dirichlet_paroi_fixe</a></div><div class="ttdoc">classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes.</div><div class="ttdef"><b>Definition:</b> <a href="Dirichlet__paroi__fixe_8h_source.html#l00036">Dirichlet_paroi_fixe.h:37</a></div></div>
<div class="ttc" id="aclassEntree__fluide__vitesse__imposee_html"><div class="ttname"><a href="classEntree__fluide__vitesse__imposee.html">Entree_fluide_vitesse_imposee</a></div><div class="ttdoc">classe Entree_fluide_vitesse_imposee Cas particulier de la classe Dirichlet_entree_fluide pour la vit...</div><div class="ttdef"><b>Definition:</b> <a href="Entree__fluide__vitesse__imposee_8h_source.html#l00033">Entree_fluide_vitesse_imposee.h:34</a></div></div>
<div class="ttc" id="aclassEntree_html"><div class="ttname"><a href="classEntree.html">Entree</a></div><div class="ttdoc">Classe de definition des operateurs et methodes pour toute lecture dans un flot d'entree&lt;br&gt;(fichier,...</div><div class="ttdef"><b>Definition:</b> <a href="Entree_8h_source.html#l00041">Entree.h:42</a></div></div>
<div class="ttc" id="aclassEquation__base_html"><div class="ttname"><a href="classEquation__base.html">Equation_base</a></div><div class="ttdef"><b>Definition:</b> <a href="Equation__base_8h_source.html#l00086">Equation_base.h:87</a></div></div>
<div class="ttc" id="aclassFront__VF_html"><div class="ttname"><a href="classFront__VF.html">Front_VF</a></div><div class="ttdoc">class Front_VF</div><div class="ttdef"><b>Definition:</b> <a href="Front__VF_8h_source.html#l00036">Front_VF.h:37</a></div></div>
<div class="ttc" id="aclassFront__VF_html_a48eadf1b57ddc0d16e4953d19f259a9e"><div class="ttname"><a href="classFront__VF.html#a48eadf1b57ddc0d16e4953d19f259a9e">Front_VF::nb_faces</a></div><div class="ttdeci">int nb_faces() const</div><div class="ttdoc">Nombre de faces reelles du bord.</div><div class="ttdef"><b>Definition:</b> <a href="Front__VF_8h_source.html#l00054">Front_VF.h:54</a></div></div>
<div class="ttc" id="aclassFront__VF_html_a930e90fb5e8e79adaad93b5c405d00d1"><div class="ttname"><a href="classFront__VF.html#a930e90fb5e8e79adaad93b5c405d00d1">Front_VF::num_premiere_face</a></div><div class="ttdeci">int num_premiere_face() const</div><div class="ttdoc">Numero de la premiere face du bord dans la liste des faces.</div><div class="ttdef"><b>Definition:</b> <a href="Front__VF_8h_source.html#l00064">Front_VF.h:64</a></div></div>
<div class="ttc" id="aclassFrontiere__dis__base_html_ae02125bae550cff30ccd5140e272e04f"><div class="ttname"><a href="classFrontiere__dis__base.html#ae02125bae550cff30ccd5140e272e04f">Frontiere_dis_base::le_nom</a></div><div class="ttdeci">const Nom &amp; le_nom() const override</div><div class="ttdoc">Renvoie le nom de la frontiere geometrique.</div><div class="ttdef"><b>Definition:</b> <a href="Frontiere__dis__base_8cpp_source.html#l00139">Frontiere_dis_base.cpp:139</a></div></div>
<div class="ttc" id="aclassMatrice__Bloc_html"><div class="ttname"><a href="classMatrice__Bloc.html">Matrice_Bloc</a></div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Bloc_8h_source.html#l00048">Matrice_Bloc.h:49</a></div></div>
<div class="ttc" id="aclassMatrice__Bloc_html_a1db7c549cc1be958d5f00c29cd0f3a8c"><div class="ttname"><a href="classMatrice__Bloc.html#a1db7c549cc1be958d5f00c29cd0f3a8c">Matrice_Bloc::dimensionner</a></div><div class="ttdeci">virtual void dimensionner(int N, int M)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Bloc_8cpp_source.html#l00551">Matrice_Bloc.cpp:551</a></div></div>
<div class="ttc" id="aclassMatrice__Bloc_html_a76a5691fecfea8b4dd877d2c449a7f21"><div class="ttname"><a href="classMatrice__Bloc.html#a76a5691fecfea8b4dd877d2c449a7f21">Matrice_Bloc::get_bloc</a></div><div class="ttdeci">virtual const Matrice &amp; get_bloc(int i, int j) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Bloc_8cpp_source.html#l00559">Matrice_Bloc.cpp:559</a></div></div>
<div class="ttc" id="aclassMatrice__Morse__Sym_html"><div class="ttname"><a href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a></div><div class="ttdoc">Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse__Sym_8h_source.html#l00036">Matrice_Morse_Sym.h:37</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html"><div class="ttname"><a href="classMatrice__Morse.html">Matrice_Morse</a></div><div class="ttdoc">Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00050">Matrice_Morse.h:51</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a6ef2f55690a596db1ef29742a2e580de"><div class="ttname"><a href="classMatrice__Morse.html#a6ef2f55690a596db1ef29742a2e580de">Matrice_Morse::get_set_tab1</a></div><div class="ttdeci">IntVect &amp; get_set_tab1(void)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00098">Matrice_Morse.h:98</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a7654bbef11775a783790d3e9ad0b1501"><div class="ttname"><a href="classMatrice__Morse.html#a7654bbef11775a783790d3e9ad0b1501">Matrice_Morse::get_set_coeff</a></div><div class="ttdeci">DoubleVect &amp; get_set_coeff(void)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00108">Matrice_Morse.h:108</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_a807cf85a1b509639edb84d7276b3edb3"><div class="ttname"><a href="classMatrice__Morse.html#a807cf85a1b509639edb84d7276b3edb3">Matrice_Morse::get_tab2</a></div><div class="ttdeci">const IntVect &amp; get_tab2(void) const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00111">Matrice_Morse.h:111</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ad69929b5100f2785d737dd77e2c82196"><div class="ttname"><a href="classMatrice__Morse.html#ad69929b5100f2785d737dd77e2c82196">Matrice_Morse::nb_colonnes</a></div><div class="ttdeci">int nb_colonnes() const override</div><div class="ttdoc">nb_colonnes retourne m</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00091">Matrice_Morse.h:91</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_ae95f9ed88a8a3fc637cd2a705cead9c8"><div class="ttname"><a href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8">Matrice_Morse::dimensionner</a></div><div class="ttdeci">void dimensionner(int n, int nnz)</div><div class="ttdoc">Size the matrix with n lines and n columns and nnz zero-values coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00338">Matrice_Morse.cpp:338</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_af161208ab81be2aeeda07435876bdc32"><div class="ttname"><a href="classMatrice__Morse.html#af161208ab81be2aeeda07435876bdc32">Matrice_Morse::nb_lignes</a></div><div class="ttdeci">int nb_lignes() const override</div><div class="ttdoc">nb_lignes retourne n</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00090">Matrice_Morse.h:90</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_af20143b6c3f18319cc28c326a64f031c"><div class="ttname"><a href="classMatrice__Morse.html#af20143b6c3f18319cc28c326a64f031c">Matrice_Morse::compacte</a></div><div class="ttdeci">void compacte(int elim_coeff_nul=0)</div><div class="ttdoc">Method to check/clean the Matrice_Morse matrix: -Suppress coefficient defined several times -elim_coe...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8cpp_source.html#l00565">Matrice_Morse.cpp:565</a></div></div>
<div class="ttc" id="aclassMatrice__Morse_html_af9addd0cf0fc821150da06b1f2e242ea"><div class="ttname"><a href="classMatrice__Morse.html#af9addd0cf0fc821150da06b1f2e242ea">Matrice_Morse::get_set_tab2</a></div><div class="ttdeci">IntVect &amp; get_set_tab2(void)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Morse_8h_source.html#l00103">Matrice_Morse.h:103</a></div></div>
<div class="ttc" id="aclassMatrice__Sym_html_a532cf830aed3865010c9977b545927c0"><div class="ttname"><a href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">Matrice_Sym::set_est_definie</a></div><div class="ttdeci">void set_est_definie(int)</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Sym_8cpp_source.html#l00025">Matrice_Sym.cpp:25</a></div></div>
<div class="ttc" id="aclassMatrice__Sym_html_a8d800deeea9f4aea802d15cd1c3c83f2"><div class="ttname"><a href="classMatrice__Sym.html#a8d800deeea9f4aea802d15cd1c3c83f2">Matrice_Sym::get_est_definie</a></div><div class="ttdeci">int get_est_definie() const</div><div class="ttdef"><b>Definition:</b> <a href="Matrice__Sym_8cpp_source.html#l00020">Matrice_Sym.cpp:20</a></div></div>
<div class="ttc" id="aclassMatrice_html"><div class="ttname"><a href="classMatrice.html">Matrice</a></div><div class="ttdoc">Classe Matrice Classe generique de la hierarchie des matrices. Un objet de type Matrice peut referenc...</div><div class="ttdef"><b>Definition:</b> <a href="Matrice_8h_source.html#l00037">Matrice.h:38</a></div></div>
<div class="ttc" id="aclassNeumann__sortie__libre_html"><div class="ttname"><a href="classNeumann__sortie__libre.html">Neumann_sortie_libre</a></div><div class="ttdoc">classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...</div><div class="ttdef"><b>Definition:</b> <a href="Neumann__sortie__libre_8h_source.html#l00043">Neumann_sortie_libre.h:44</a></div></div>
<div class="ttc" id="aclassNeumann_html_a0b6ed33cc5c3ef854d46705c47e90c2a"><div class="ttname"><a href="classNeumann.html#a0b6ed33cc5c3ef854d46705c47e90c2a">Neumann::flux_impose</a></div><div class="ttdeci">virtual double flux_impose(int i) const</div><div class="ttdoc">Renvoie la valeur du flux impose sur la i-eme composante du champ representant le flux a la frontiere...</div><div class="ttdef"><b>Definition:</b> <a href="Neumann_8cpp_source.html#l00074">Neumann.cpp:74</a></div></div>
<div class="ttc" id="aclassO__U__Ptr_html_a8d368932ee397da5ae25a9916fd88a59"><div class="ttname"><a href="classO__U__Ptr.html#a8d368932ee397da5ae25a9916fd88a59">O_U_Ptr::non_nul</a></div><div class="ttdeci">int non_nul() const</div><div class="ttdoc">Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.</div><div class="ttdef"><b>Definition:</b> <a href="O__U__Ptr_8cpp_source.html#l00090">O_U_Ptr.cpp:90</a></div></div>
<div class="ttc" id="aclassObjet__U_html_a58289bb63283588d31dc69b87b3f1d55"><div class="ttname"><a href="classObjet__U.html#a58289bb63283588d31dc69b87b3f1d55">Objet_U::que_suis_je</a></div><div class="ttdeci">const Nom &amp; que_suis_je() const</div><div class="ttdoc">renvoie la chaine identifiant la classe.</div><div class="ttdef"><b>Definition:</b> <a href="Objet__U_8cpp_source.html#l00126">Objet_U.cpp:126</a></div></div>
<div class="ttc" id="aclassObjet__U_html_a7447e25c68cc8d3a1c06cf99f0565cff"><div class="ttname"><a href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a></div><div class="ttdeci">static double precision_geom</div><div class="ttdef"><b>Definition:</b> <a href="Objet__U_8h_source.html#l00074">Objet_U.h:74</a></div></div>
<div class="ttc" id="aclassObjet__U_html_a93dacab7253df3f9df63d1aca21b1dd5"><div class="ttname"><a href="classObjet__U.html#a93dacab7253df3f9df63d1aca21b1dd5">Objet_U::le_nom</a></div><div class="ttdeci">virtual const Nom &amp; le_nom() const</div><div class="ttdoc">Donne le nom de l'Objet_U Methode a surcharger : renvoie &quot;neant&quot; dans cette implementation.</div><div class="ttdef"><b>Definition:</b> <a href="Objet__U_8cpp_source.html#l00254">Objet_U.cpp:254</a></div></div>
<div class="ttc" id="aclassObjet__U_html_a9a47c1add9760324894500792c17a178"><div class="ttname"><a href="classObjet__U.html#a9a47c1add9760324894500792c17a178">Objet_U::bidim_axi</a></div><div class="ttdeci">static int bidim_axi</div><div class="ttdef"><b>Definition:</b> <a href="Objet__U_8h_source.html#l00077">Objet_U.h:77</a></div></div>
<div class="ttc" id="aclassOption__VDF_html_abc56a584319b990ca8259b5219d28270"><div class="ttname"><a href="classOption__VDF.html#abc56a584319b990ca8259b5219d28270">Option_VDF::coeff_P_neumann</a></div><div class="ttdeci">static double coeff_P_neumann</div><div class="ttdef"><b>Definition:</b> <a href="Option__VDF_8h_source.html#l00033">Option_VDF.h:33</a></div></div>
<div class="ttc" id="aclassPeriodique_html"><div class="ttname"><a href="classPeriodique.html">Periodique</a></div><div class="ttdoc">classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...</div><div class="ttdef"><b>Definition:</b> <a href="Periodique_8h_source.html#l00038">Periodique.h:39</a></div></div>
<div class="ttc" id="aclassPeriodique_html_a58591bbd91005803c7ea2a714197282b"><div class="ttname"><a href="classPeriodique.html#a58591bbd91005803c7ea2a714197282b">Periodique::face_associee</a></div><div class="ttdeci">int face_associee(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="Periodique_8h_source.html#l00046">Periodique.h:46</a></div></div>
<div class="ttc" id="aclassProcess_html_a05de57db7288d95f9e67046af585d5ff"><div class="ttname"><a href="classProcess.html#a05de57db7288d95f9e67046af585d5ff">Process::mp_min</a></div><div class="ttdeci">static double mp_min(double)</div><div class="ttdoc">Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00157">Process.cpp:157</a></div></div>
<div class="ttc" id="aclassProcess_html_a1e9d9f9899b71927cfafae14c7bd048d"><div class="ttname"><a href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d">Process::mp_max</a></div><div class="ttdeci">static double mp_max(double)</div><div class="ttdoc">Calcule le max de x sur tous les processeurs du groupe courant. Remarques : Cette methode doit etre a...</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00146">Process.cpp:146</a></div></div>
<div class="ttc" id="aclassProcess_html_acc2fbbe761e08e5870ae605c0705491c"><div class="ttname"><a href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">Process::exit</a></div><div class="ttdeci">static void exit(int exit_code=-1)</div><div class="ttdoc">Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00213">Process.cpp:213</a></div></div>
<div class="ttc" id="aclassProcess_html_acd052b99706c577f8a5b6656217cf4c2"><div class="ttname"><a href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2">Process::je_suis_maitre</a></div><div class="ttdeci">static int je_suis_maitre()</div><div class="ttdoc">renvoie 1 si on est sur le processeur maitre du groupe courant (c'est a dire me() == 0),...</div><div class="ttdef"><b>Definition:</b> <a href="Process_8cpp_source.html#l00085">Process.cpp:85</a></div></div>
<div class="ttc" id="aclassRef__Zone__Cl__VDF_html_a1c097927828f629a20594dfd86ce8b9f"><div class="ttname"><a href="classRef__Zone__Cl__VDF.html#a1c097927828f629a20594dfd86ce8b9f">Ref_Zone_Cl_VDF::valeur</a></div><div class="ttdeci">const Zone_Cl_VDF &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Ref__Zone__Cl__VDF_8h_source.html#l00021">Ref_Zone_Cl_VDF.h:21</a></div></div>
<div class="ttc" id="aclassRef__Zone__VDF_html_af219e77d38517b134cf8175207d1cc11"><div class="ttname"><a href="classRef__Zone__VDF.html#af219e77d38517b134cf8175207d1cc11">Ref_Zone_VDF::valeur</a></div><div class="ttdeci">const Zone_VDF &amp; valeur() const</div><div class="ttdef"><b>Definition:</b> <a href="Ref__Zone__VDF_8h_source.html#l00021">Ref_Zone_VDF.h:21</a></div></div>
<div class="ttc" id="aclassSortie_html"><div class="ttname"><a href="classSortie.html">Sortie</a></div><div class="ttdoc">Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers,...</div><div class="ttdef"><b>Definition:</b> <a href="Sortie_8h_source.html#l00050">Sortie.h:51</a></div></div>
<div class="ttc" id="aclassSymetrie_html"><div class="ttname"><a href="classSymetrie.html">Symetrie</a></div><div class="ttdoc">classe Symetrie Sur les faces de symetrie on a les proprietes suivantes: - composante normale de la v...</div><div class="ttdef"><b>Definition:</b> <a href="Symetrie_8h_source.html#l00039">Symetrie.h:40</a></div></div>
<div class="ttc" id="aclassTRUSTArray_html"><div class="ttname"><a href="classTRUSTArray.html">TRUSTArray&lt; int &gt;</a></div></div>
<div class="ttc" id="aclassTRUSTArray_html_a7fdab39e76f6cb0f5a5691eaaee32d8c"><div class="ttname"><a href="classTRUSTArray.html#a7fdab39e76f6cb0f5a5691eaaee32d8c">TRUSTArray::resize_array</a></div><div class="ttdeci">void resize_array(int new_size, Array_base::Resize_Options opt=COPY_INIT)</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTArray_8tpp_source.html#l00038">TRUSTArray.tpp:38</a></div></div>
<div class="ttc" id="aclassTRUSTTab_html"><div class="ttname"><a href="classTRUSTTab.html">TRUSTTab&lt; int &gt;</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html"><div class="ttname"><a href="classTRUSTVect.html">TRUSTVect&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassTRUSTVect_html_a7df489e59381e175b1df9cef48355fe5"><div class="ttname"><a href="classTRUSTVect.html#a7df489e59381e175b1df9cef48355fe5">TRUSTVect::echange_espace_virtuel</a></div><div class="ttdeci">virtual void echange_espace_virtuel()</div><div class="ttdef"><b>Definition:</b> <a href="TRUSTVect_8tpp_source.html#l00267">TRUSTVect.tpp:267</a></div></div>
<div class="ttc" id="aclassZone__Cl__VDF_html"><div class="ttname"><a href="classZone__Cl__VDF.html">Zone_Cl_VDF</a></div><div class="ttdoc">&lt; namespace TypeAreteCoinVDF</div><div class="ttdef"><b>Definition:</b> <a href="Zone__Cl__VDF_8h_source.html#l00073">Zone_Cl_VDF.h:74</a></div></div>
<div class="ttc" id="aclassZone__Cl__dis__base_html"><div class="ttname"><a href="classZone__Cl__dis__base.html">Zone_Cl_dis_base</a></div><div class="ttdoc">classe Zone_Cl_dis_base Les objets Zone_Cl_dis_base representent les conditions aux limites discretis...</div><div class="ttdef"><b>Definition:</b> <a href="Zone__Cl__dis__base_8h_source.html#l00045">Zone_Cl_dis_base.h:46</a></div></div>
<div class="ttc" id="aclassZone__Cl__dis__base_html_a9b068b594ffc0a2cb2eb08841efcd1f5"><div class="ttname"><a href="classZone__Cl__dis__base.html#a9b068b594ffc0a2cb2eb08841efcd1f5">Zone_Cl_dis_base::les_conditions_limites</a></div><div class="ttdeci">const Cond_lim &amp; les_conditions_limites(int) const</div><div class="ttdoc">Renvoie la i-ieme condition aux limites. (version const)</div><div class="ttdef"><b>Definition:</b> <a href="Zone__Cl__dis__base_8cpp_source.html#l00515">Zone_Cl_dis_base.cpp:515</a></div></div>
<div class="ttc" id="aclassZone__Cl__dis__base_html_ad9232707ebf3b339ecaf028072f268a4"><div class="ttname"><a href="classZone__Cl__dis__base.html#ad9232707ebf3b339ecaf028072f268a4">Zone_Cl_dis_base::nb_cond_lim</a></div><div class="ttdeci">int nb_cond_lim() const</div><div class="ttdoc">Renvoie le nombre de conditions aux limites.</div><div class="ttdef"><b>Definition:</b> <a href="Zone__Cl__dis__base_8cpp_source.html#l00596">Zone_Cl_dis_base.cpp:596</a></div></div>
<div class="ttc" id="aclassZone__VDF_html"><div class="ttname"><a href="classZone__VDF.html">Zone_VDF</a></div><div class="ttdoc">class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00063">Zone_VDF.h:64</a></div></div>
<div class="ttc" id="aclassZone__VDF_html_a71671288eceb9fe858d5554b6ad2f039"><div class="ttname"><a href="classZone__VDF.html#a71671288eceb9fe858d5554b6ad2f039">Zone_VDF::orientation</a></div><div class="ttdeci">int orientation(int) const override</div><div class="ttdoc">inline DoubleVect&amp; Zone_VDF::porosite_face() { return porosite_face_; }</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VDF_8h_source.html#l00259">Zone_VDF.h:259</a></div></div>
<div class="ttc" id="aclassZone__VF_html_a1935d5babef3e13a64d7b997ce94cdd0"><div class="ttname"><a href="classZone__VF.html#a1935d5babef3e13a64d7b997ce94cdd0">Zone_VF::face_voisins</a></div><div class="ttdeci">int face_voisins(int num_face, int i) const</div><div class="ttdoc">renvoie l'element voisin de numface dans la direction i. i=0 : dans le sens oppose de l'axe orthogona...</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VF_8h_source.html#l00442">Zone_VF.h:442</a></div></div>
<div class="ttc" id="aclassZone__VF_html_a39f0c943ef5ed78280ed8e117ab9047e"><div class="ttname"><a href="classZone__VF.html#a39f0c943ef5ed78280ed8e117ab9047e">Zone_VF::nb_faces_bord</a></div><div class="ttdeci">int nb_faces_bord() const</div><div class="ttdoc">renvoie le nombre de faces sur lesquelles sont appliquees les conditions limites : bords,...</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VF_8h_source.html#l00531">Zone_VF.h:531</a></div></div>
<div class="ttc" id="aclassZone__VF_html_a3fbd9844ce625f7dd87e38337c75c025"><div class="ttname"><a href="classZone__VF.html#a3fbd9844ce625f7dd87e38337c75c025">Zone_VF::nb_faces_internes</a></div><div class="ttdeci">int nb_faces_internes() const</div><div class="ttdoc">une face est interne ssi elle separe deux elements. renvoie le nombre de faces internes.</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VF_8h_source.html#l00549">Zone_VF.h:549</a></div></div>
<div class="ttc" id="aclassZone__VF_html_a64f0b549e5aea1656855113e3510f418"><div class="ttname"><a href="classZone__VF.html#a64f0b549e5aea1656855113e3510f418">Zone_VF::volumes_entrelaces</a></div><div class="ttdeci">DoubleVect &amp; volumes_entrelaces()</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VF_8h_source.html#l00720">Zone_VF.h:720</a></div></div>
<div class="ttc" id="aclassZone__VF_html_a81a853efbcf5659d78f6a788b379841e"><div class="ttname"><a href="classZone__VF.html#a81a853efbcf5659d78f6a788b379841e">Zone_VF::face_surfaces</a></div><div class="ttdeci">virtual const DoubleVect &amp; face_surfaces() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VF_8h_source.html#l00047">Zone_VF.h:47</a></div></div>
<div class="ttc" id="aclassZone__VF_html_ae1e579e3d4a6a29e27a0e82410ae5e49"><div class="ttname"><a href="classZone__VF.html#ae1e579e3d4a6a29e27a0e82410ae5e49">Zone_VF::premiere_face_int</a></div><div class="ttdeci">int premiere_face_int() const</div><div class="ttdoc">une face est interne ssi elle separe deux elements. renvoie le numero de la premiere face interne.</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VF_8h_source.html#l00496">Zone_VF.h:496</a></div></div>
<div class="ttc" id="aclassZone__VF_html_ae6bef9af0a9ef1188cb2291f1e241cb2"><div class="ttname"><a href="classZone__VF.html#ae6bef9af0a9ef1188cb2291f1e241cb2">Zone_VF::porosite_face</a></div><div class="ttdeci">double porosite_face(int) const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__VF_8h_source.html#l00269">Zone_VF.h:269</a></div></div>
<div class="ttc" id="aclassZone__dis__base_html"><div class="ttname"><a href="classZone__dis__base.html">Zone_dis_base</a></div><div class="ttdoc">classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees....</div><div class="ttdef"><b>Definition:</b> <a href="Zone__dis__base_8h_source.html#l00042">Zone_dis_base.h:43</a></div></div>
<div class="ttc" id="aclassZone__dis__base_html_a66f0610b6936eba8d959b63b15255b4f"><div class="ttname"><a href="classZone__dis__base.html#a66f0610b6936eba8d959b63b15255b4f">Zone_dis_base::nb_elem</a></div><div class="ttdeci">int nb_elem() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__dis__base_8h_source.html#l00143">Zone_dis_base.h:143</a></div></div>
<div class="ttc" id="aclassZone__dis__base_html_a6e97d34e3642a259924718796298e09e"><div class="ttname"><a href="classZone__dis__base.html#a6e97d34e3642a259924718796298e09e">Zone_dis_base::nb_elem_tot</a></div><div class="ttdeci">int nb_elem_tot() const</div><div class="ttdef"><b>Definition:</b> <a href="Zone__dis__base_8h_source.html#l00147">Zone_dis_base.h:147</a></div></div>
<div class="ttc" id="aclassZone__dis__base_html_aae671a49c7b02a69054a38bddb486cf8"><div class="ttname"><a href="classZone__dis__base.html#aae671a49c7b02a69054a38bddb486cf8">Zone_dis_base::zone</a></div><div class="ttdeci">const Zone &amp; zone() const</div><div class="ttdoc">Renvoie la Zone associee a l'objet. (version const)</div><div class="ttdef"><b>Definition:</b> <a href="Zone__dis__base_8h_source.html#l00109">Zone_dis_base.h:109</a></div></div>
<div class="ttc" id="aclassZone_html_a8bdea22b5802d97c07acd9e97de5eb88"><div class="ttname"><a href="classZone.html#a8bdea22b5802d97c07acd9e97de5eb88">Zone::nb_elem</a></div><div class="ttdeci">int nb_elem() const</div><div class="ttdoc">Renvoie le nombre d'elements de la zone.</div><div class="ttdef"><b>Definition:</b> <a href="Zone_8h_source.html#l00293">Zone.h:293</a></div></div>
<div class="ttc" id="aclassvect__impl_html_aa4ead68b9a3b2cba74be2766cbafcad4"><div class="ttname"><a href="classvect__impl.html#aa4ead68b9a3b2cba74be2766cbafcad4">vect_impl::size</a></div><div class="ttdeci">int size() const</div><div class="ttdef"><b>Definition:</b> <a href="vect__impl_8h_source.html#l00050">vect_impl.h:50</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 29 2022 11:11:33 for TRUST by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
