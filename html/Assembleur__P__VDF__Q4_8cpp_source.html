<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VDF/Solveurs/Assembleur_P_VDF_Q4.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VDF/Solveurs/Assembleur_P_VDF_Q4.cpp</div>  </div>
</div>
<div class="contents">
<a href="Assembleur__P__VDF__Q4_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Assembleur_P_VDF_Q4.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VDF/Solveurs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/12</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Assembleur__P__VDF__Q4_8h.html">Assembleur_P_VDF_Q4.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VDF_8h.html">Zone_VDF.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__VDF_8h.html">Zone_Cl_VDF.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Bloc_8h.html">Matrice_Bloc.h</a>&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="Assembleur__P__VDF__Q4_8cpp.html#aa80ff47933a8b8c731204f8103edb564">00028</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classAssembleur__P__VDF__Q4.html">Assembleur_P_VDF_Q4</a>,<span class="stringliteral">&quot;Assembleur_P_VDF_Q4&quot;</span>,<a class="code" href="classAssembleur__base.html">Assembleur_base</a>);
<a name="l00029"></a>00029 
<a name="l00030"></a><a class="code" href="classAssembleur__P__VDF__Q4.html#a857f5836031e738258f0323b547b1a55">00030</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classAssembleur__P__VDF__Q4.html#a857f5836031e738258f0323b547b1a55" title="Ecriture de l&#39;objet sur un flot de sortie Methode a surcharger.">Assembleur_P_VDF_Q4::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00031"></a>00031 <span class="keyword"></span>{
<a name="l00032"></a>00032   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classObjet__U.html#a70413a8785d36bf5105fced1c89d0d2b" title="Donne le nom de l&#39;Objet_U Methode a surcharger : renvoie &quot;neant&quot; dans cette implementation.">le_nom</a>() ;
<a name="l00033"></a>00033 }
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="classAssembleur__P__VDF__Q4.html#afb2afb3c439c964b17208289064078fe">00035</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classAssembleur__P__VDF__Q4.html#afb2afb3c439c964b17208289064078fe" title="Lecture d&#39;un Objet_U sur un flot d&#39;entree Methode a surcharger.">Assembleur_P_VDF_Q4::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s )
<a name="l00036"></a>00036 {
<a name="l00037"></a>00037   <span class="keywordflow">return</span> <a class="code" href="classAssembleur__P__VDF__Q4.html#afb2afb3c439c964b17208289064078fe" title="Lecture d&#39;un Objet_U sur un flot d&#39;entree Methode a surcharger.">Assembleur_base::readOn</a>(s);
<a name="l00038"></a>00038 }
<a name="l00039"></a>00039 
<a name="l00040"></a><a class="code" href="classAssembleur__P__VDF__Q4.html#a752d6ee5b9df66cd7f69ea48caf1f022">00040</a> <span class="keywordtype">int</span> <a class="code" href="classAssembleur__P__VDF__Q4.html#a752d6ee5b9df66cd7f69ea48caf1f022">Assembleur_P_VDF_Q4::assembler</a>(<a class="code" href="classMatrice.html">Matrice</a>&amp; la_matrice)
<a name="l00041"></a>00041 {
<a name="l00042"></a>00042   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Assembleur_P_VDF_Q4::assembler &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00043"></a>00043   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Assemblage de la matrice Q4 en cours...&quot;</span> &lt;&lt; finl;
<a name="l00044"></a>00044   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; FaceSoms = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;face_sommets();
<a name="l00045"></a>00045   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; FaceVois = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;face_voisins();
<a name="l00046"></a>00046   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; Orientation = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;orientation();
<a name="l00047"></a>00047   <span class="keywordtype">int</span> face, som0,som1;
<a name="l00048"></a>00048   <span class="keywordtype">int</span> nbfaces = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;nb_faces(),  nbsom = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;nb_som();
<a name="l00049"></a>00049   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_entrelaces = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;volumes_entrelaces();
<a name="l00050"></a>00050   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_face = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;porosite_face();
<a name="l00051"></a>00051   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; CoordSom = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;zone().domaine().coord_sommets();
<a name="l00052"></a>00052   <span class="keywordtype">double</span> surf,vol,por,val, r;
<a name="l00053"></a>00053   <span class="keywordtype">int</span> ori, elem0,elem1;
<a name="l00054"></a>00054 <span class="comment">// construction matrice</span>
<a name="l00055"></a>00055   la_matrice.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Matrice_Morse&quot;</span>);
<a name="l00056"></a>00056   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; mat = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>,la_matrice.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l00057"></a>00057   mat.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nbsom,0);
<a name="l00058"></a>00058   <a class="code" href="classIntVect.html">IntVect</a> rang_voisins(nbsom);
<a name="l00059"></a>00059   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = mat.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l00060"></a>00060   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2 = mat.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l00061"></a>00061   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = mat.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l00062"></a>00062 
<a name="l00063"></a>00063   tab1 = 0;
<a name="l00064"></a>00064   tab2 = 0;
<a name="l00065"></a>00065   coeff = 0;
<a name="l00066"></a>00066   rang_voisins = 1;
<a name="l00067"></a>00067   <span class="keywordflow">for</span> (face=0 ; face&lt;nbfaces ; face++)
<a name="l00068"></a>00068     {
<a name="l00069"></a>00069       som0 = FaceSoms(face,0);
<a name="l00070"></a>00070       som1 = FaceSoms(face,1);
<a name="l00071"></a>00071       rang_voisins(som0)++;
<a name="l00072"></a>00072       rang_voisins(som1)++;
<a name="l00073"></a>00073     }
<a name="l00074"></a>00074   tab1(0) = 1;
<a name="l00075"></a>00075   <span class="keywordflow">for</span> (som0=0 ; som0&lt;nbsom ; som0++)
<a name="l00076"></a>00076     {
<a name="l00077"></a>00077       tab1(som0+1) = rang_voisins(som0) + tab1(som0);
<a name="l00078"></a>00078     }
<a name="l00079"></a>00079   rang_voisins = 1;
<a name="l00080"></a>00080   mat.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nbsom,tab1(nbsom)-1);
<a name="l00081"></a>00081 <span class="comment">// calcul coefficient matrice</span>
<a name="l00082"></a>00082   <span class="keywordflow">for</span> (face=0 ; face&lt;nbfaces ; face++)
<a name="l00083"></a>00083     {
<a name="l00084"></a>00084       ori = Orientation(face);
<a name="l00085"></a>00085       som0 = FaceSoms(face,0);
<a name="l00086"></a>00086       som1 = FaceSoms(face,1);
<a name="l00087"></a>00087       elem0 = FaceVois(face,0);
<a name="l00088"></a>00088       elem1 = FaceVois(face,1);
<a name="l00089"></a>00089       <span class="keywordflow">if</span> (elem0&gt;-1 &amp;&amp; elem1&gt;-1)
<a name="l00090"></a>00090         {
<a name="l00091"></a>00091           surf = 0.5* (<a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;dim_elem(elem0,ori) + <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;dim_elem(elem1,ori));
<a name="l00092"></a>00092         }
<a name="l00093"></a>00093       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem0&gt;-1)
<a name="l00094"></a>00094         {
<a name="l00095"></a>00095           surf = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;dim_elem(elem0,ori);
<a name="l00096"></a>00096         }
<a name="l00097"></a>00097       <span class="keywordflow">else</span>
<a name="l00098"></a>00098         {
<a name="l00099"></a>00099           surf = 0.;
<a name="l00100"></a>00100           surf = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;dim_elem(elem1,ori);
<a name="l00101"></a>00101         }
<a name="l00102"></a>00102       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a9a47c1add9760324894500792c17a178">bidim_axi</a><span class="comment">/* &amp;&amp; ori==1*/</span>)
<a name="l00103"></a>00103         {
<a name="l00104"></a>00104           r = 0.5*(CoordSom(som0,0)+CoordSom(som1,0));
<a name="l00105"></a>00105           surf = r * surf * 2 * <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;
<a name="l00106"></a>00106         }
<a name="l00107"></a>00107       vol = volumes_entrelaces(face);
<a name="l00108"></a>00108       por = porosite_face(face);
<a name="l00109"></a>00109       val = surf*surf /vol * por;
<a name="l00110"></a>00110 <span class="preprocessor">#ifdef _AFFDEBUG</span>
<a name="l00111"></a>00111 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (<a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;nb_som()&lt;400)
<a name="l00112"></a>00112         {
<a name="l00113"></a>00113           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;face=&quot;</span>&lt;&lt;face&lt;&lt;<span class="stringliteral">&quot;  ori=&quot;</span>&lt;&lt;ori&lt;&lt;<span class="stringliteral">&quot;  soms=&quot;</span>&lt;&lt;som0&lt;&lt;<span class="stringliteral">&quot;/&quot;</span>&lt;&lt;som1&lt;&lt;<span class="stringliteral">&quot; coordsom=&quot;</span>&lt;&lt;CoordSom(som0,0)&lt;&lt;<span class="stringliteral">&quot;/&quot;</span>&lt;&lt;CoordSom(som0,1);
<a name="l00114"></a>00114           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;CoordSom(som1,0)&lt;&lt;<span class="stringliteral">&quot;/&quot;</span>&lt;&lt;CoordSom(som1,1)&lt;&lt;<span class="stringliteral">&quot;  elems=&quot;</span>&lt;&lt;FaceVois(face,0)&lt;&lt;<span class="stringliteral">&quot;/&quot;</span>&lt;&lt;FaceVois(face,1)&lt;&lt;<span class="stringliteral">&quot;  dim_elems/2=&quot;</span>;
<a name="l00115"></a>00115           <span class="keywordflow">if</span> (FaceVois(face,0)&gt;-1)
<a name="l00116"></a>00116             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;dim_elem(FaceVois(face,0),ori)/2.&lt;&lt;<span class="stringliteral">&quot; / &quot;</span>;
<a name="l00117"></a>00117           <span class="keywordflow">else</span>
<a name="l00118"></a>00118             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;--- / &quot;</span>;
<a name="l00119"></a>00119           <span class="keywordflow">if</span> (FaceVois(face,1)&gt;-1)
<a name="l00120"></a>00120             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;dim_elem(FaceVois(face,1),ori)/2.&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>;
<a name="l00121"></a>00121           <span class="keywordflow">else</span>
<a name="l00122"></a>00122             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;---  &quot;</span>;
<a name="l00123"></a>00123           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  surf=&quot;</span>&lt;&lt;surf&lt;&lt;<span class="stringliteral">&quot;  vol=&quot;</span>&lt;&lt;vol&lt;&lt;<span class="stringliteral">&quot;  val=&quot;</span>&lt;&lt;val&lt;&lt;finl;
<a name="l00124"></a>00124         }
<a name="l00125"></a>00125 <span class="preprocessor">#endif</span>
<a name="l00126"></a>00126 <span class="preprocessor"></span>
<a name="l00127"></a>00127       tab2(tab1(som0)-1) = som0+1;
<a name="l00128"></a>00128       tab2(tab1(som1)-1) = som1+1;
<a name="l00129"></a>00129       mat(som0,som0) += val;
<a name="l00130"></a>00130       mat(som1,som1) += val;
<a name="l00131"></a>00131 <span class="comment">// if (coeff(tab1(som0)+rang_voisins(som0)-1)!=-1) {</span>
<a name="l00132"></a>00132       tab2(tab1(som0)+rang_voisins(som0)-1) = som1+1;
<a name="l00133"></a>00133       mat(som0,som1) -= val;
<a name="l00134"></a>00134       rang_voisins(som0)++;
<a name="l00135"></a>00135       tab2(tab1(som1)+rang_voisins(som1)-1) = som0+1;
<a name="l00136"></a>00136       mat(som1,som0) -= val;
<a name="l00137"></a>00137       rang_voisins(som1)++;
<a name="l00138"></a>00138 <span class="comment">// }</span>
<a name="l00139"></a>00139     }
<a name="l00140"></a>00140   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Fin de l&#39;assemblage de la matrice Q4&quot;</span> &lt;&lt; finl;
<a name="l00141"></a>00141   <span class="keywordflow">return</span> 1;
<a name="l00142"></a>00142 }
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="classAssembleur__P__VDF__Q4.html#a8427340fc93b80ef6051cdf3af7392e3">00144</a> <span class="keywordtype">int</span> <a class="code" href="classAssembleur__P__VDF__Q4.html#a8427340fc93b80ef6051cdf3af7392e3">Assembleur_P_VDF_Q4::modifier_secmem</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; secmem)
<a name="l00145"></a>00145 {
<a name="l00146"></a>00146   <span class="keywordflow">return</span> 1;
<a name="l00147"></a>00147 }
<a name="l00148"></a>00148 
<a name="l00149"></a><a class="code" href="classAssembleur__P__VDF__Q4.html#ad2df0398db6ad573c18a8d450370b607">00149</a> <span class="keywordtype">int</span> <a class="code" href="classAssembleur__P__VDF__Q4.html#a8427340fc93b80ef6051cdf3af7392e3">Assembleur_P_VDF_Q4::modifier_secmem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_secmem_, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; secmem)
<a name="l00150"></a>00150 {
<a name="l00151"></a>00151   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; CoordSommets = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;zone().domaine().coord_sommets();
<a name="l00152"></a>00152   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; FaceSoms = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;face_sommets();
<a name="l00153"></a>00153   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; FaceVois = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;face_voisins();
<a name="l00154"></a>00154   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; Orientation = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;orientation();
<a name="l00155"></a>00155   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; CoordSom = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;zone().domaine().coord_sommets();
<a name="l00156"></a>00156   <span class="keywordtype">int</span> face, som0,som1, ori, invori, elem0,elem1;
<a name="l00157"></a>00157   <span class="keywordtype">int</span> nbfaces = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;nb_faces(),  nbsom = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;nb_som();
<a name="l00158"></a>00158   <span class="keywordtype">double</span> surf, r;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160   secmem.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nbsom);
<a name="l00161"></a>00161   secmem = 0.;
<a name="l00162"></a>00162 
<a name="l00163"></a>00163   <span class="keywordflow">for</span> (face=0 ; face&lt;nbfaces ; face++)
<a name="l00164"></a>00164     {
<a name="l00165"></a>00165       surf = 0.;
<a name="l00166"></a>00166       ori = Orientation(face);
<a name="l00167"></a>00167       som0 = FaceSoms(face,0);
<a name="l00168"></a>00168       som1 = FaceSoms(face,1);
<a name="l00169"></a>00169       elem0 = FaceVois(face,0);
<a name="l00170"></a>00170       elem1 = FaceVois(face,1);
<a name="l00171"></a>00171       <span class="keywordflow">if</span> (elem0&gt;-1 &amp;&amp; elem1&gt;-1)
<a name="l00172"></a>00172         {
<a name="l00173"></a>00173           surf = 0.5* (<a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;dim_elem(elem0,ori) + <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;dim_elem(elem1,ori));
<a name="l00174"></a>00174         }
<a name="l00175"></a>00175       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem0&gt;-1)
<a name="l00176"></a>00176         {
<a name="l00177"></a>00177           surf = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;dim_elem(elem0,ori);
<a name="l00178"></a>00178         }
<a name="l00179"></a>00179       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem1&gt;-1)
<a name="l00180"></a>00180         {
<a name="l00181"></a>00181           surf = <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>-&gt;dim_elem(elem1,ori);
<a name="l00182"></a>00182         }
<a name="l00183"></a>00183       <span class="keywordflow">else</span>
<a name="l00184"></a>00184         {
<a name="l00185"></a>00185           assert(0==1);
<a name="l00186"></a>00186         }
<a name="l00187"></a>00187       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a9a47c1add9760324894500792c17a178">bidim_axi</a><span class="comment">/* &amp;&amp; ori==1*/</span>)
<a name="l00188"></a>00188         {
<a name="l00189"></a>00189           r = 0.5*(CoordSom(som0,0)+CoordSom(som1,0));
<a name="l00190"></a>00190           surf = r * surf * 2 * <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;
<a name="l00191"></a>00191         }
<a name="l00192"></a>00192       <span class="keywordflow">if</span> (ori==0)
<a name="l00193"></a>00193         invori = 1;
<a name="l00194"></a>00194       <span class="keywordflow">else</span>
<a name="l00195"></a>00195         invori = 0;
<a name="l00196"></a>00196       <span class="keywordflow">if</span> (CoordSommets(som1,invori)&gt;CoordSommets(som0,invori))
<a name="l00197"></a>00197         {
<a name="l00198"></a>00198           secmem(som0) += tab_secmem_(face) * surf;
<a name="l00199"></a>00199           secmem(som1) -= tab_secmem_(face) * surf;
<a name="l00200"></a>00200         }
<a name="l00201"></a>00201       <span class="keywordflow">else</span>
<a name="l00202"></a>00202         {
<a name="l00203"></a>00203           secmem(som0) -= tab_secmem_(face) * surf;
<a name="l00204"></a>00204           secmem(som1) += tab_secmem_(face) * surf;
<a name="l00205"></a>00205         }
<a name="l00206"></a>00206       secmem.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00207"></a>00207     }
<a name="l00208"></a>00208 
<a name="l00209"></a>00209   <span class="keywordflow">return</span> 1;
<a name="l00210"></a>00210 }
<a name="l00211"></a>00211 
<a name="l00212"></a><a class="code" href="classAssembleur__P__VDF__Q4.html#ac801dafe1a53857f97eef53901f78373">00212</a> <span class="keywordtype">int</span> <a class="code" href="classAssembleur__P__VDF__Q4.html#ac801dafe1a53857f97eef53901f78373">Assembleur_P_VDF_Q4::modifier_solution</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pression)
<a name="l00213"></a>00213 {
<a name="l00214"></a>00214   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Assembleur_P_VDF_Q4::modifier_solution&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00215"></a>00215   <span class="keywordflow">return</span> 1;
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="classAssembleur__P__VDF__Q4.html#acc3348a31678cf094dac53bb8cee2422">00218</a> <span class="keyword">const</span> <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; <a class="code" href="classAssembleur__P__VDF__Q4.html#acc3348a31678cf094dac53bb8cee2422">Assembleur_P_VDF_Q4::zone_dis_base</a>()<span class="keyword"> const</span>
<a name="l00219"></a>00219 <span class="keyword"></span>{
<a name="l00220"></a>00220   <span class="keywordflow">return</span> <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="classAssembleur__P__VDF__Q4.html#abd8555bb977b358c0fb10ccc15611358">00223</a> <span class="keyword">const</span> <a class="code" href="classZone__Cl__dis__base.html" title="classe Zone_Cl_dis_base Les objets Zone_Cl_dis_base representent les conditions aux limites discretis...">Zone_Cl_dis_base</a>&amp; <a class="code" href="classAssembleur__P__VDF__Q4.html#abd8555bb977b358c0fb10ccc15611358">Assembleur_P_VDF_Q4::zone_Cl_dis_base</a>()<span class="keyword"> const</span>
<a name="l00224"></a>00224 <span class="keyword"></span>{
<a name="l00225"></a>00225   <span class="keywordflow">return</span> <a class="code" href="classAssembleur__P__VDF__Q4.html#af827365813f9dc8e6d1177ac657380b8">la_zone_Cl_VDF</a>.<a class="code" href="classRef__Zone__Cl__VDF.html#a1e655604e840cda5b393e45f975b73ff">valeur</a>();
<a name="l00226"></a>00226 }
<a name="l00227"></a>00227 
<a name="l00228"></a><a class="code" href="classAssembleur__P__VDF__Q4.html#af2037b083afc7c24b80b08a2985cd327">00228</a> <span class="keywordtype">void</span> <a class="code" href="classAssembleur__P__VDF__Q4.html#af2037b083afc7c24b80b08a2985cd327">Assembleur_P_VDF_Q4::associer_zone_dis_base</a>(<span class="keyword">const</span> <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; la_zone_dis)
<a name="l00229"></a>00229 {
<a name="l00230"></a>00230   <a class="code" href="classAssembleur__P__VDF__Q4.html#ab8060e149e09366e510d312482a1ae2d">la_zone_VDF</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>, la_zone_dis);
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 
<a name="l00233"></a><a class="code" href="classAssembleur__P__VDF__Q4.html#a4a09c93b0238486f6f5ae926211a7134">00233</a> <span class="keywordtype">void</span> <a class="code" href="classAssembleur__P__VDF__Q4.html#a4a09c93b0238486f6f5ae926211a7134">Assembleur_P_VDF_Q4::associer_zone_cl_dis_base</a>(<span class="keyword">const</span> <a class="code" href="classZone__Cl__dis__base.html" title="classe Zone_Cl_dis_base Les objets Zone_Cl_dis_base representent les conditions aux limites discretis...">Zone_Cl_dis_base</a>&amp; la_zone_Cl_dis)
<a name="l00234"></a>00234 {
<a name="l00235"></a>00235   <a class="code" href="classAssembleur__P__VDF__Q4.html#af827365813f9dc8e6d1177ac657380b8">la_zone_Cl_VDF</a> =<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>, la_zone_Cl_dis);
<a name="l00236"></a>00236 }
<a name="l00237"></a>00237 
<a name="l00238"></a><a class="code" href="classAssembleur__P__VDF__Q4.html#ab2e7e75e9ac80f59705317838f2991fa">00238</a> <span class="keywordtype">void</span> <a class="code" href="classAssembleur__P__VDF__Q4.html#ab2e7e75e9ac80f59705317838f2991fa">Assembleur_P_VDF_Q4::completer</a>(<span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp; Eqn)
<a name="l00239"></a>00239 {
<a name="l00240"></a>00240   <a class="code" href="classAssembleur__P__VDF__Q4.html#adf99ef0dd263f9419c6d8308655da137">eqn_</a> = Eqn;
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:40 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
