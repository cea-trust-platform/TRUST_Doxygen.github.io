<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/ThHyd/Incompressible/Traitement_particulier/Traitement_particulier_NS_EC.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/ThHyd/Incompressible/Traitement_particulier/Traitement_particulier_NS_EC.cpp</div>  </div>
</div>
<div class="contents">
<a href="Traitement__particulier__NS__EC_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Traitement_particulier_NS_EC.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/ThHyd/Incompressible/Traitement_particulier</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/23</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Traitement__particulier__NS__EC_8h.html">Traitement_particulier_NS_EC.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Navier__Stokes__std_8h.html">Navier_Stokes_std.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VF_8h.html">Zone_VF.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Terme__Source__Acceleration_8h.html">Terme_Source_Acceleration.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Milieu__base_8h.html">Milieu_base.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Ref__ArrOfDouble_8h.html">Ref_ArrOfDouble.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Ref__DoubleTab_8h.html">Ref_DoubleTab.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps__base_8h.html">Schema_Temps_base.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;sys/stat.h&gt;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="Traitement__particulier__NS__EC_8cpp.html#a4d5236666420424f80f79daa2feb8c13">00034</a> <a class="code" href="Declare__Base_8h.html#a4860a967d304a80bd1e155f90e2362b7">Implemente_base_sans_constructeur_ni_destructeur</a>(<a class="code" href="classTraitement__particulier__NS__EC.html" title="classe Traitement_particulier_EC Cette classe permet de faire les traitements particuliers pour les c...">Traitement_particulier_NS_EC</a>,<span class="stringliteral">&quot;Traitement_particulier_NS_EC&quot;</span>,<a class="code" href="classTraitement__particulier__NS__base.html" title="classe Traitement_particulier_NS_base Derive de Support_Champ_Masse_Volumique: utilisation de rho pou...">Traitement_particulier_NS_base</a>);
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="comment">// Precondition:</span>
<a name="l00038"></a>00038 <span class="comment">// Parametre: Sortie&amp; is</span>
<a name="l00039"></a>00039 <span class="comment">// Signification: un flot de sortie</span>
<a name="l00040"></a>00040 <span class="comment">// Valeurs par defaut:</span>
<a name="l00041"></a>00041 <span class="comment">// Contraintes:</span>
<a name="l00042"></a>00042 <span class="comment">// Acces: entree/sortie</span>
<a name="l00043"></a>00043 <span class="comment">// Exception:</span>
<a name="l00044"></a>00044 <span class="comment">// Effets de bord:</span>
<a name="l00045"></a>00045 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00046"></a>00046 <span class="comment">//</span>
<a name="l00047"></a>00047 <span class="comment">//</span><span class="comment"></span>
<a name="l00048"></a>00048 <span class="comment">/** \return Sortie\&amp;&lt;br&gt;</span>
<a name="l00049"></a>00049 <span class="comment">Signification: le flot de sortie modifie&lt;br&gt;</span>
<a name="l00050"></a>00050 <span class="comment">Contraintes: */</span>
<a name="l00051"></a><a class="code" href="classTraitement__particulier__NS__EC.html#a90621d4305fc7a539d3a016f17343c39">00051</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classTraitement__particulier__NS__EC.html#a90621d4305fc7a539d3a016f17343c39">Traitement_particulier_NS_EC::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; is)<span class="keyword"> const</span>
<a name="l00052"></a>00052 <span class="keyword"></span>{
<a name="l00053"></a>00053   <span class="keywordflow">return</span> is;
<a name="l00054"></a>00054 }
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">// Precondition:</span>
<a name="l00058"></a>00058 <span class="comment">// Parametre: Entree&amp; is</span>
<a name="l00059"></a>00059 <span class="comment">// Signification: un flot d&#39;entree</span>
<a name="l00060"></a>00060 <span class="comment">// Valeurs par defaut:</span>
<a name="l00061"></a>00061 <span class="comment">// Contraintes:</span>
<a name="l00062"></a>00062 <span class="comment">// Acces: entree/sortie</span>
<a name="l00063"></a>00063 <span class="comment">// Exception:</span>
<a name="l00064"></a>00064 <span class="comment">// Effets de bord:</span>
<a name="l00065"></a>00065 <span class="comment">// Postcondition:</span>
<a name="l00066"></a>00066 <span class="comment">//</span>
<a name="l00067"></a>00067 <span class="comment">//</span><span class="comment"></span>
<a name="l00068"></a>00068 <span class="comment">/** \return Entree\&amp;&lt;br&gt;</span>
<a name="l00069"></a>00069 <span class="comment">Signification: le flot d&#39;entree modifie&lt;br&gt;</span>
<a name="l00070"></a>00070 <span class="comment">Contraintes: */</span>
<a name="l00071"></a><a class="code" href="classTraitement__particulier__NS__EC.html#af2411a536c6a13ff98a8bd0996297d36">00071</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classTraitement__particulier__NS__EC.html#af2411a536c6a13ff98a8bd0996297d36">Traitement_particulier_NS_EC::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00072"></a>00072 {
<a name="l00073"></a>00073   <span class="keywordflow">return</span> is;
<a name="l00074"></a>00074 }
<a name="l00075"></a>00075 
<a name="l00076"></a><a class="code" href="classTraitement__particulier__NS__EC.html#a608bc7bf6758b7fa35991a51c7c9671e">00076</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classTraitement__particulier__NS__EC.html#a608bc7bf6758b7fa35991a51c7c9671e">Traitement_particulier_NS_EC::lire</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00077"></a>00077 {
<a name="l00078"></a>00078   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> accouverte = <span class="stringliteral">&quot;{&quot;</span> , accfermee = <span class="stringliteral">&quot;}&quot;</span> ;
<a name="l00079"></a>00079   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> valec=<span class="stringliteral">&quot;Ec&quot;</span>;
<a name="l00080"></a>00080   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> motbidon, motlu;
<a name="l00081"></a>00081   <a class="code" href="classTraitement__particulier__NS__EC.html#aeb05249fc9de86464731e10d7805a927">nb_bip</a>=0;
<a name="l00082"></a>00082   <a class="code" href="classTraitement__particulier__NS__EC.html#a4590c1db60b127150210b843a7e2afb7">periode</a> = <a class="code" href="classTraitement__particulier__NS__base.html#a82ae9a6fa79c277da3c8d7fd5c6d41e7">mon_equation</a>-&gt;probleme().schema_temps().pas_temps_min();
<a name="l00083"></a>00083   is &gt;&gt; motbidon ;
<a name="l00084"></a>00084   <span class="keywordflow">if</span> (motbidon == accouverte)
<a name="l00085"></a>00085     {
<a name="l00086"></a>00086       <a class="code" href="classMotcles.html" title="Un tableau d&#39;objets de la classe Motcle.">Motcles</a> les_mots(2);
<a name="l00087"></a>00087       les_mots[0] = <span class="stringliteral">&quot;Ec&quot;</span>;
<a name="l00088"></a>00088       les_mots[1] = <span class="stringliteral">&quot;Ec_dans_repere_fixe&quot;</span>;
<a name="l00089"></a>00089       {
<a name="l00090"></a>00090         is &gt;&gt; motlu;
<a name="l00091"></a>00091         <span class="keywordflow">while</span>(motlu != accfermee)
<a name="l00092"></a>00092           {
<a name="l00093"></a>00093             <span class="keywordtype">int</span> rang=les_mots.<a class="code" href="classMotcles.html#afecd68f73e904bc129022a236ff6ab15">search</a>(motlu);
<a name="l00094"></a>00094             <span class="keywordflow">switch</span>(rang)
<a name="l00095"></a>00095               {
<a name="l00096"></a>00096               <span class="keywordflow">case</span> 0 :
<a name="l00097"></a>00097               <span class="keywordflow">case</span> 1 :
<a name="l00098"></a>00098                 {
<a name="l00099"></a>00099                   <span class="keywordflow">if</span> (rang==1)
<a name="l00100"></a>00100                     <a class="code" href="classTraitement__particulier__NS__EC.html#a202f0d40f6f163634a22408658719c93">repere_mobile_</a>=1;
<a name="l00101"></a>00101                   is &gt;&gt; motlu;
<a name="l00102"></a>00102                   <span class="keywordflow">if</span> (motlu!=<span class="stringliteral">&quot;periode&quot;</span>)
<a name="l00103"></a>00103                     {
<a name="l00104"></a>00104                       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;On attendait le mot cle periode apres &quot;</span> &lt;&lt; les_mots[rang] &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00105"></a>00105                       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00106"></a>00106                     }
<a name="l00107"></a>00107                   is &gt;&gt; <a class="code" href="classTraitement__particulier__NS__EC.html#a4590c1db60b127150210b843a7e2afb7">periode</a>;
<a name="l00108"></a>00108                   <span class="keywordflow">break</span>;
<a name="l00109"></a>00109                 }
<a name="l00110"></a>00110               <span class="keywordflow">default</span> :
<a name="l00111"></a>00111                 {
<a name="l00112"></a>00112                   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans la lecture de Traitement_particulier_NS_EC&quot;</span>;
<a name="l00113"></a>00113                   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Les mots cles possibles sont &quot;</span>&lt;&lt; les_mots &lt;&lt;<span class="stringliteral">&quot; { et }&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00114"></a>00114                   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Vous avez lu :&quot;</span> &lt;&lt; motlu &lt;&lt; finl;
<a name="l00115"></a>00115                   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00116"></a>00116                   <span class="keywordflow">break</span>;
<a name="l00117"></a>00117                 }
<a name="l00118"></a>00118               }
<a name="l00119"></a>00119             is &gt;&gt; motlu;
<a name="l00120"></a>00120           }
<a name="l00121"></a>00121         is &gt;&gt; motlu;
<a name="l00122"></a>00122         <span class="keywordflow">if</span> (motlu != accfermee)
<a name="l00123"></a>00123           {
<a name="l00124"></a>00124             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans la lecture de Traitement_particulier_NS_EC&quot;</span>;
<a name="l00125"></a>00125             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On attendait une }&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00126"></a>00126             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00127"></a>00127           }
<a name="l00128"></a>00128       }
<a name="l00129"></a>00129     }
<a name="l00130"></a>00130   <span class="keywordflow">else</span>
<a name="l00131"></a>00131     {
<a name="l00132"></a>00132       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans la lecture de Traitement_particulier_NS_EC&quot;</span>;
<a name="l00133"></a>00133       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On attendait une {&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00134"></a>00134       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00135"></a>00135     }
<a name="l00136"></a>00136   <span class="keywordflow">return</span> is;
<a name="l00137"></a>00137 }
<a name="l00138"></a>00138 
<a name="l00139"></a><a class="code" href="classTraitement__particulier__NS__EC.html#abbf6950eeca7774ce6415c4a1941272e">00139</a> <span class="keywordtype">void</span> <a class="code" href="classTraitement__particulier__NS__EC.html#abbf6950eeca7774ce6415c4a1941272e">Traitement_particulier_NS_EC::ouvrir_fichier</a>(<a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a>&amp; s)<span class="keyword"> const</span>
<a name="l00140"></a>00140 <span class="keyword"></span>{
<a name="l00141"></a>00141 <span class="comment">// Ouverture du fichier Nom_du_cas_EC.son</span>
<a name="l00142"></a>00142   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_fich(<a class="code" href="classObjet__U.html#a7c27c4f80259eeef76ff8fe2d3bc61f7" title="Renvoie une reference constante vers le nom du cas. Cette methode est statique.">nom_du_cas</a>());
<a name="l00143"></a>00143   nom_fich += <span class="stringliteral">&quot;_EC&quot;</span>;
<a name="l00144"></a>00144   <span class="keywordflow">if</span> (<a class="code" href="classTraitement__particulier__NS__EC.html#a202f0d40f6f163634a22408658719c93">repere_mobile_</a>)
<a name="l00145"></a>00145     nom_fich+=<span class="stringliteral">&quot;_dans_repere_fixe&quot;</span>;
<a name="l00146"></a>00146   nom_fich+=<span class="stringliteral">&quot;.son&quot;</span>;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148   <span class="keyword">const</span> <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb=<a class="code" href="classTraitement__particulier__NS__base.html#a82ae9a6fa79c277da3c8d7fd5c6d41e7">mon_equation</a>-&gt;probleme();
<a name="l00149"></a>00149   <span class="keyword">struct </span>stat f;
<a name="l00150"></a>00150   <span class="keywordflow">if</span> (stat(nom_fich,&amp;f) || (<a class="code" href="classTraitement__particulier__NS__EC.html#aeb05249fc9de86464731e10d7805a927">nb_bip</a>==0 &amp;&amp; !pb.<a class="code" href="classProbleme__base.html#acafc48b3c050d6c292bb8395a7904a33">reprise_effectuee</a>()))
<a name="l00151"></a>00151     s.<a class="code" href="classSortie__Fichier__base.html#a7e75e18ed580cd4d45912ec202caa2b2">ouvrir</a>(nom_fich);
<a name="l00152"></a>00152   <span class="keywordflow">else</span>
<a name="l00153"></a>00153     s.<a class="code" href="classSortie__Fichier__base.html#a7e75e18ed580cd4d45912ec202caa2b2">ouvrir</a>(nom_fich,ios::app);
<a name="l00154"></a>00154   s.<a class="code" href="classSortie__Fichier__base.html#a5ddd834ca9c766c24cc608cd03ef0e96">setf</a>(ios::scientific);
<a name="l00155"></a>00155   s.<a class="code" href="classSortie__Fichier__base.html#a489ca01946f4e2a7a9aa8f3a3d949b08">precision</a>(8);
<a name="l00156"></a>00156 }
<a name="l00157"></a>00157 
<a name="l00158"></a><a class="code" href="classTraitement__particulier__NS__EC.html#a0fe94a35587b083864725c650104406b">00158</a> <span class="keywordtype">void</span> <a class="code" href="classTraitement__particulier__NS__EC.html#a0fe94a35587b083864725c650104406b">Traitement_particulier_NS_EC::preparer_calcul_particulier</a>()
<a name="l00159"></a>00159 {
<a name="l00160"></a>00160   <a class="code" href="classTraitement__particulier__NS__EC.html#a1d4c74c6b40943938c5b0614b2d294d8">tinit</a> = <a class="code" href="classTraitement__particulier__NS__base.html#a82ae9a6fa79c277da3c8d7fd5c6d41e7">mon_equation</a>-&gt;inconnue().temps();
<a name="l00161"></a>00161   <a class="code" href="classTraitement__particulier__NS__EC.html#aeb05249fc9de86464731e10d7805a927">nb_bip</a>=0;
<a name="l00162"></a>00162   <span class="keywordtype">double</span> Ec;
<a name="l00163"></a>00163   <a class="code" href="classTraitement__particulier__NS__EC.html#aee33512da933e1d2a2b28bd25a03bae4" title="Meme methode de calcul en VDF et en VEF. Si aucun champ de masse volumique n&#39;a ete associe...">calculer_Ec</a>(Ec);
<a name="l00164"></a>00164   <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00165"></a>00165     {
<a name="l00166"></a>00166       <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> le_fichier;
<a name="l00167"></a>00167       <a class="code" href="classTraitement__particulier__NS__EC.html#abbf6950eeca7774ce6415c4a1941272e">ouvrir_fichier</a>(le_fichier);
<a name="l00168"></a>00168 <span class="comment">// Ecriture premiere ligne</span>
<a name="l00169"></a>00169       le_fichier&lt;&lt;<span class="stringliteral">&quot;# Temps        Energie_cinetique_totale&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00170"></a>00170       le_fichier&lt;&lt;<a class="code" href="classTraitement__particulier__NS__EC.html#a1d4c74c6b40943938c5b0614b2d294d8">tinit</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;Ec&lt;&lt;finl;
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172 }
<a name="l00173"></a><a class="code" href="classTraitement__particulier__NS__EC.html#abdeb6e9e576a88e1e4e46df355d11080">00173</a> <span class="keywordtype">void</span> <a class="code" href="classTraitement__particulier__NS__EC.html#abdeb6e9e576a88e1e4e46df355d11080">Traitement_particulier_NS_EC::post_traitement_particulier</a>()
<a name="l00174"></a>00174 {
<a name="l00175"></a>00175   <span class="keywordtype">double</span> temps = <a class="code" href="classTraitement__particulier__NS__base.html#a82ae9a6fa79c277da3c8d7fd5c6d41e7">mon_equation</a>-&gt;inconnue().temps();
<a name="l00176"></a>00176   <span class="keywordtype">double</span> nb = floor((temps - <a class="code" href="classTraitement__particulier__NS__EC.html#a1d4c74c6b40943938c5b0614b2d294d8">tinit</a>) / <a class="code" href="classTraitement__particulier__NS__EC.html#a4590c1db60b127150210b843a7e2afb7">periode</a>);
<a name="l00177"></a>00177   <span class="keywordflow">if</span> (nb &gt; <a class="code" href="classTraitement__particulier__NS__EC.html#aeb05249fc9de86464731e10d7805a927">nb_bip</a> + 0.5)
<a name="l00178"></a>00178     {
<a name="l00179"></a>00179       <a class="code" href="classTraitement__particulier__NS__EC.html#aeb05249fc9de86464731e10d7805a927">nb_bip</a>=nb;
<a name="l00180"></a>00180       <span class="keywordtype">double</span> Ec;
<a name="l00181"></a>00181       <a class="code" href="classTraitement__particulier__NS__EC.html#aee33512da933e1d2a2b28bd25a03bae4" title="Meme methode de calcul en VDF et en VEF. Si aucun champ de masse volumique n&#39;a ete associe...">calculer_Ec</a>(Ec);
<a name="l00182"></a>00182       <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00183"></a>00183         {
<a name="l00184"></a>00184           <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> le_fichier;
<a name="l00185"></a>00185           <a class="code" href="classTraitement__particulier__NS__EC.html#abbf6950eeca7774ce6415c4a1941272e">ouvrir_fichier</a>(le_fichier);
<a name="l00186"></a>00186           le_fichier&lt;&lt;temps&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;Ec&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00187"></a>00187         }
<a name="l00188"></a>00188     }
<a name="l00189"></a>00189 }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191 <span class="comment">//</span>
<a name="l00192"></a>00192 <span class="comment">//</span><span class="comment"></span>
<a name="l00193"></a>00193 <span class="comment">//! Fonction outil utilisee dans calculer_Ec. Calcule la somme&lt;br&gt;de 0.5*v^2*rho*volumes_entrelaces.</span>
<a name="l00194"></a><a class="code" href="Traitement__particulier__NS__EC_8cpp.html#a34602ed036e6c7ca30498ef6eb328aa3">00194</a> <span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="Traitement__particulier__NS__EC_8cpp.html#a34602ed036e6c7ca30498ef6eb328aa3" title="Fonction outil utilisee dans calculer_Ec. Calcule la somme de 0.5*v^2*rho*volumes_entrelaces.">trait_part_calculer_ec_faces</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>         face_debut,
<a name="l00195"></a>00195                                            <span class="keyword">const</span> <span class="keywordtype">int</span>         nb_faces,
<a name="l00196"></a>00196                                            <span class="keyword">const</span> <span class="keywordtype">int</span>                frontiere,
<a name="l00197"></a>00197                                            <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;         vitesse,
<a name="l00198"></a>00198                                            <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp;         volumes_entrelaces,
<a name="l00199"></a>00199                                            <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;         xv,
<a name="l00200"></a>00200                                            <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;         masse_volumique,
<a name="l00201"></a>00201                                            <span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp;         translation,
<a name="l00202"></a>00202                                            <span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp;         rotation,
<a name="l00203"></a>00203                                            <span class="keyword">const</span> <span class="keywordtype">int</span>         repere_mobile_,
<a name="l00204"></a>00204                                            <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp;        faces_doubles
<a name="l00205"></a>00205                                           )
<a name="l00206"></a>00206 {
<a name="l00207"></a>00207   <span class="keyword">const</span> <span class="keywordtype">int</span> face_fin = face_debut + nb_faces;
<a name="l00208"></a>00208   <span class="keywordtype">double</span> ec = 0.;
<a name="l00209"></a>00209   <span class="keywordtype">double</span> rho = 0.;
<a name="l00210"></a>00210   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dim_1 = (vitesse.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>() == 1);
<a name="l00211"></a>00211   <span class="keyword">const</span> <span class="keywordtype">int</span> dim      = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00212"></a>00212   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> ve(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>);
<a name="l00213"></a>00213   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face = face_debut; face &lt; face_fin; face++)
<a name="l00214"></a>00214     {
<a name="l00215"></a>00215 <span class="comment">// Calcul de la vitesse d&#39;entrainement</span>
<a name="l00216"></a>00216       <span class="keywordflow">if</span> (repere_mobile_)
<a name="l00217"></a>00217         {
<a name="l00218"></a>00218           ve(0)=translation(0);
<a name="l00219"></a>00219           ve(1)=translation(1);
<a name="l00220"></a>00220           <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
<a name="l00221"></a>00221             {
<a name="l00222"></a>00222               ve(2)=translation(2);
<a name="l00223"></a>00223               ve(0)+=rotation(1)*xv(face,2)-rotation(2)*xv(face,1);
<a name="l00224"></a>00224               ve(1)+=rotation(2)*xv(face,0)-rotation(0)*xv(face,2);
<a name="l00225"></a>00225               ve(2)+=rotation(0)*xv(face,1)-rotation(1)*xv(face,0);
<a name="l00226"></a>00226             }
<a name="l00227"></a>00227         }
<a name="l00228"></a>00228       <span class="keywordflow">else</span>
<a name="l00229"></a>00229         ve=0;
<a name="l00230"></a>00230 
<a name="l00231"></a>00231       <span class="keywordtype">double</span> v2;
<a name="l00232"></a>00232       <span class="keywordtype">double</span> volume;
<a name="l00233"></a>00233       <span class="keywordflow">if</span> (nb_dim_1)
<a name="l00234"></a>00234         {
<a name="l00235"></a>00235 <span class="comment">// Une composante de vitesse a la face (VDF)</span>
<a name="l00236"></a>00236           <span class="keyword">const</span> <span class="keywordtype">double</span> v = vitesse(face);
<a name="l00237"></a>00237           <span class="keywordflow">if</span> (repere_mobile_)
<a name="l00238"></a>00238             {
<a name="l00239"></a>00239               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Le codage de l&#39;energie cinetique calculee dans un repere fixe&quot;</span> &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00240"></a>00240               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;n&#39;est pas fait en VDF.&quot;</span> &lt;&lt; finl;
<a name="l00241"></a>00241               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>(); <span class="comment">//!&lt; En effet probleme de conception, il faudrait avoir l&#39;orientation des faces VDF</span>
<a name="l00242"></a>00242 <span class="comment"></span>            }
<a name="l00243"></a>00243           v2 = v * v;
<a name="l00244"></a>00244 <span class="comment">// En VDF, sur les frontieres, on ne prend que le 1/2 volume entrelace</span>
<a name="l00245"></a>00245           volume = (frontiere ? 0.5 : 1) * volumes_entrelaces(face);
<a name="l00246"></a>00246         }
<a name="l00247"></a>00247       <span class="keywordflow">else</span>
<a name="l00248"></a>00248         {
<a name="l00249"></a>00249 <span class="comment">// Deux ou trois composantes (VEFP1B)</span>
<a name="l00250"></a>00250           v2 = 0.;
<a name="l00251"></a>00251           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dim; i++)
<a name="l00252"></a>00252             {
<a name="l00253"></a>00253               <span class="keyword">const</span> <span class="keywordtype">double</span> v_i = vitesse(face, i);
<a name="l00254"></a>00254               v2 += (v_i + ve(i)) * (v_i + ve(i));
<a name="l00255"></a>00255             }
<a name="l00256"></a>00256 <span class="comment">// En VEF, cela est incorrect, il faudrait les volumes etendus:</span>
<a name="l00257"></a>00257           volume = volumes_entrelaces(face);
<a name="l00258"></a>00258         }
<a name="l00259"></a>00259       <span class="keyword">const</span> <span class="keywordtype">int</span> k = (masse_volumique.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)==1) ? 0 : face;
<a name="l00260"></a>00260       rho = masse_volumique(k, 0);
<a name="l00261"></a>00261       <span class="keywordtype">double</span> contribution = (faces_doubles(face)==1) ? 0.5 : 1 ;
<a name="l00262"></a>00262       ec += contribution * 0.5 * v2 * volume * rho;
<a name="l00263"></a>00263     }
<a name="l00264"></a>00264   <span class="keywordflow">return</span> ec;
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="comment">//</span>
<a name="l00268"></a>00268 <span class="comment">//</span>
<a name="l00269"></a>00269 <span class="comment">//</span>
<a name="l00270"></a>00270 <span class="comment">//</span>
<a name="l00271"></a>00271 <span class="comment">//</span>
<a name="l00272"></a>00272 <span class="comment">//</span>
<a name="l00273"></a>00273 <span class="comment">//</span>
<a name="l00274"></a>00274 <span class="comment">//</span>
<a name="l00275"></a>00275 <span class="comment">//</span><span class="comment"></span>
<a name="l00276"></a>00276 <span class="comment">//! Meme methode de calcul en VDF et en VEF.&lt;br&gt;Si aucun champ de masse volumique n&#39;a ete associe, on calcule&lt;br&gt;INTEGRALE de 1/2 * u^2 sur le domaine.&lt;br&gt;Si un champ de masse volumique a ete associe, il doit etre&lt;br&gt;de type &quot;champ aux faces&quot;. On calcule INTEGRALE de 1/2 * rho * u^2.&lt;br&gt;rho est un champ P0 aux elements, u est P0 sur les volumes entrelaces&lt;br&gt;Valeur de retour:&lt;br&gt;La somme sur tous les processeurs de l&#39;integrale de 1/2*rho*u*u.</span>
<a name="l00277"></a><a class="code" href="classTraitement__particulier__NS__EC.html#aee33512da933e1d2a2b28bd25a03bae4">00277</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classTraitement__particulier__NS__EC.html#aee33512da933e1d2a2b28bd25a03bae4" title="Meme methode de calcul en VDF et en VEF. Si aucun champ de masse volumique n&#39;a ete associe...">Traitement_particulier_NS_EC::calculer_Ec</a>(<span class="keywordtype">double</span>&amp; energie_cinetique)
<a name="l00278"></a>00278 {
<a name="l00279"></a>00279 
<a name="l00280"></a>00280   <span class="keyword">const</span> <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; zdisbase        = <a class="code" href="classTraitement__particulier__NS__base.html#a82ae9a6fa79c277da3c8d7fd5c6d41e7">mon_equation</a>-&gt;inconnue().zone_dis_base();
<a name="l00281"></a>00281   <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp;    zone_VF            = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, zdisbase);
<a name="l00282"></a>00282   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_entrelaces = zone_VF.<a class="code" href="classZone__VF.html#a64f0b549e5aea1656855113e3510f418">volumes_entrelaces</a>();
<a name="l00283"></a>00283   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;  xv                 = zone_VF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00284"></a>00284   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;  vitesse            = <a class="code" href="classTraitement__particulier__NS__base.html#a82ae9a6fa79c277da3c8d7fd5c6d41e7">mon_equation</a>-&gt;inconnue().valeurs();
<a name="l00285"></a>00285   <a class="code" href="Ref_8h.html#aab5720a5c34da14028d0745e386aaa01">REF</a>(<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>) translation(xv);
<a name="l00286"></a>00286   <a class="code" href="Ref_8h.html#aab5720a5c34da14028d0745e386aaa01">REF</a>(<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>) rotation(xv);
<a name="l00287"></a>00287   <a class="code" href="Ref_8h.html#aab5720a5c34da14028d0745e386aaa01">REF</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>) rho(xv);
<a name="l00288"></a>00288   <a class="code" href="classDoubleVect.html">DoubleVect</a> rotation_nulle(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00289"></a>00289   rotation_nulle=0;
<a name="l00290"></a>00290   <span class="keywordflow">if</span> (<a class="code" href="classTraitement__particulier__NS__EC.html#a202f0d40f6f163634a22408658719c93">repere_mobile_</a>)
<a name="l00291"></a>00291     {
<a name="l00292"></a>00292       <span class="keywordtype">int</span> ok=0;
<a name="l00293"></a>00293 <span class="comment">// Verification de l&#39;existence d&#39;un terme source Acceleration dans Navier Stokes</span>
<a name="l00294"></a>00294       <span class="keyword">const</span> <a class="code" href="classSources.html" title="class Sources Sources represente une liste de Source. Une equation contient un membres Equation_base:...">Sources</a>&amp; les_sources=<a class="code" href="classTraitement__particulier__NS__base.html#a82ae9a6fa79c277da3c8d7fd5c6d41e7">mon_equation</a>-&gt;sources();
<a name="l00295"></a>00295       <a class="code" href="List_8h.html#add189d7375e577842ac891b09afc6d4b">CONST_LIST_CURSEUR</a>(<a class="code" href="classSource.html" title="classe Source Classe generique de la hierarchie des sources, un objet Source peut referencer n&#39;import...">Source</a>) curseur(les_sources);
<a name="l00296"></a>00296       <span class="keywordflow">while</span>(curseur)
<a name="l00297"></a>00297         {
<a name="l00298"></a>00298           <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classTerme__Source__Acceleration.html">Terme_Source_Acceleration</a>,curseur-&gt;valeur()))
<a name="l00299"></a>00299             {
<a name="l00300"></a>00300               <span class="keyword">const</span> <a class="code" href="classTerme__Source__Acceleration.html">Terme_Source_Acceleration</a>&amp; terme_source_acceleration=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classTerme__Source__Acceleration.html">Terme_Source_Acceleration</a>,curseur-&gt;valeur());
<a name="l00301"></a>00301 <span class="comment">// Verification que les vitesses de translation du repere</span>
<a name="l00302"></a>00302 <span class="comment">// mobiles sont bien definies et association des tableaux translation et</span>
<a name="l00303"></a>00303 <span class="comment">// eventuellement rotation</span>
<a name="l00304"></a>00304               <span class="keywordflow">if</span> (terme_source_acceleration.<a class="code" href="classTerme__Source__Acceleration.html#a820d5ada32450f7009b385682b3a3b8f">champ_vitesse</a>().<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l00305"></a>00305                 {
<a name="l00306"></a>00306                   translation=terme_source_acceleration.<a class="code" href="classTerme__Source__Acceleration.html#a820d5ada32450f7009b385682b3a3b8f">champ_vitesse</a>().<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00307"></a>00307                   <span class="keywordflow">if</span> (terme_source_acceleration.<a class="code" href="classTerme__Source__Acceleration.html#ae9562e15ae64032d2e813ca3684b51ef">omega</a>().<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l00308"></a>00308                     rotation=terme_source_acceleration.<a class="code" href="classTerme__Source__Acceleration.html#ae9562e15ae64032d2e813ca3684b51ef">omega</a>().<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00309"></a>00309                   <span class="keywordflow">else</span>
<a name="l00310"></a>00310                     rotation=rotation_nulle;
<a name="l00311"></a>00311                   ok=1;
<a name="l00312"></a>00312                 }
<a name="l00313"></a>00313             }
<a name="l00314"></a>00314           ++curseur;
<a name="l00315"></a>00315         }
<a name="l00316"></a>00316       <span class="keywordflow">if</span> (!ok)
<a name="l00317"></a>00317         {
<a name="l00318"></a>00318           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Vous ne pouvez calculer l&#39;energie cinetique dans un repere fixe&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00319"></a>00319           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;que si le repere de calcul est mobile, c&#39;est a dire que vous avez&quot;</span> &lt;&lt; finl;
<a name="l00320"></a>00320           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;defini un terme source d&#39;acceleration dans l&#39;equation Navier Stokes.&quot;</span> &lt;&lt; finl;
<a name="l00321"></a>00321           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Ou bien il manque dans ce terme source la definition de la vitesse&quot;</span> &lt;&lt; finl;
<a name="l00322"></a>00322           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;du repere mobile dans le repere fixe. Modifier votre jeu de donnees.&quot;</span> &lt;&lt; finl;
<a name="l00323"></a>00323           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00324"></a>00324         }
<a name="l00325"></a>00325     }
<a name="l00326"></a>00326   <span class="keywordtype">double</span> ec = 0.;
<a name="l00327"></a>00327 
<a name="l00328"></a>00328   <span class="keywordflow">if</span> (<a class="code" href="classSupport__Champ__Masse__Volumique.html#a3414c179c1ab131b692a8e745954d1ec" title="Renvoie 1 si la masse volumique a ete associee, 0 sinon.">has_champ_masse_volumique</a>())
<a name="l00329"></a>00329     {
<a name="l00330"></a>00330       <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; champ_rho = <a class="code" href="classSupport__Champ__Masse__Volumique.html#a643eb281beba7a15d1b4e06ef8eff60e" title="Renvoie le champ de masse volumique.">get_champ_masse_volumique</a>();
<a name="l00331"></a>00331       rho = champ_rho.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l00332"></a>00332       <span class="keywordflow">if</span> (rho-&gt;dimension(0) != zone_VF.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>() || rho-&gt;line_size() != 1)
<a name="l00333"></a>00333         {
<a name="l00334"></a>00334           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans Traitement_particulier_NS_EC::calculer_Ec&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00335"></a>00335           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;le champ de masse volumique n&#39;est pas un champ scalaire aux faces&quot;</span> &lt;&lt; finl;
<a name="l00336"></a>00336           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00337"></a>00337         }
<a name="l00338"></a>00338     }
<a name="l00339"></a>00339   <span class="keywordflow">else</span>
<a name="l00340"></a>00340     {
<a name="l00341"></a>00341       rho = <a class="code" href="classTraitement__particulier__NS__base.html#a82ae9a6fa79c277da3c8d7fd5c6d41e7">mon_equation</a>-&gt;milieu().masse_volumique().valeurs();
<a name="l00342"></a>00342     }
<a name="l00343"></a>00343   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_front = zone_VF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>();
<a name="l00344"></a>00344   <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; faces_doubles = zone_VF.<a class="code" href="classZone__VF.html#ac79fcf1de2e30bd88cf216de9fa56281" title="renvoie 1 pour les faces appartenant a un bord perio ou un item commun, 0 par defaut">faces_doubles</a>();
<a name="l00345"></a>00345 <span class="comment">// Faces de bord</span>
<a name="l00346"></a>00346   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_front; i++)
<a name="l00347"></a>00347     {
<a name="l00348"></a>00348       <span class="keyword">const</span> <a class="code" href="classFrontiere.html" title="Classe Frontiere. Une Frontiere decrit une partie de la frontiere d&#39;une Zone, elle possede un Nom...">Frontiere</a>&amp; fr = zone_VF.<a class="code" href="classZone__VF.html#a45e54622328fcf035535edf96172c1e4" title="renvoie la ieme frontiere_discrete.">front_VF</a>(i).<a class="code" href="classFrontiere__dis__base.html#a95f81b046cd23c8c8083ae03eebe93cd" title="Renvoie la frontiere geometrique associee. (version const)">frontiere</a>();
<a name="l00349"></a>00349       <span class="keyword">const</span> <span class="keywordtype">int</span> debut    = fr.<a class="code" href="classFrontiere.html#a2a41c319a1530c984c356121e5ca2383">num_premiere_face</a>();
<a name="l00350"></a>00350       <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces = fr.<a class="code" href="classFrontiere.html#aa073fe9dbdddde59471ee7032b256aa2" title="Renvoie le nombre de faces de la frontiere.">nb_faces</a>();
<a name="l00351"></a>00351       ec += <a class="code" href="Traitement__particulier__NS__EC_8cpp.html#a34602ed036e6c7ca30498ef6eb328aa3" title="Fonction outil utilisee dans calculer_Ec. Calcule la somme de 0.5*v^2*rho*volumes_entrelaces.">trait_part_calculer_ec_faces</a>(debut, nb_faces, 1,
<a name="l00352"></a>00352                                          vitesse, volumes_entrelaces, xv, rho, translation, rotation, <a class="code" href="classTraitement__particulier__NS__EC.html#a202f0d40f6f163634a22408658719c93">repere_mobile_</a>, faces_doubles);
<a name="l00353"></a>00353     }
<a name="l00354"></a>00354 <span class="comment">// Faces a l&#39;interieur du domaine (y compris les faces de joint)</span>
<a name="l00355"></a>00355   {
<a name="l00356"></a>00356     <span class="keyword">const</span> <span class="keywordtype">int</span> debut    = zone_VF.<a class="code" href="classZone__VF.html#a12869806fa4834aca8f2964e16509dfd" title="une face est interne ssi elle separe deux elements. renvoie le numero de la premiere face interne...">premiere_face_int</a>();
<a name="l00357"></a>00357     <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces = zone_VF.<a class="code" href="classZone__VF.html#a1210c3de419eab8ce27debddd632218e" title="une face est interne ssi elle separe deux elements. renvoie le nombre de faces internes.">nb_faces_internes</a>();
<a name="l00358"></a>00358     ec += <a class="code" href="Traitement__particulier__NS__EC_8cpp.html#a34602ed036e6c7ca30498ef6eb328aa3" title="Fonction outil utilisee dans calculer_Ec. Calcule la somme de 0.5*v^2*rho*volumes_entrelaces.">trait_part_calculer_ec_faces</a>(debut, nb_faces, 0,
<a name="l00359"></a>00359                                        vitesse, volumes_entrelaces, xv, rho, translation, rotation, <a class="code" href="classTraitement__particulier__NS__EC.html#a202f0d40f6f163634a22408658719c93">repere_mobile_</a>, faces_doubles);
<a name="l00360"></a>00360   }
<a name="l00361"></a>00361   ec = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(ec);
<a name="l00362"></a>00362   energie_cinetique = ec;
<a name="l00363"></a>00363 }
<a name="l00364"></a>00364 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:35 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
