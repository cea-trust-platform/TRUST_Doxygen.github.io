<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Utilitaires/Process.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Utilitaires/Process.cpp</div>  </div>
</div>
<div class="contents">
<a href="Process_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Process.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Utilitaires</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/59</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Process_8h.html">Process.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Statistiques_8h.html">Statistiques.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="verif__cast_8h.html">verif_cast.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Comm__Group_8h.html">Comm_Group.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="PE__Groups_8h.html">PE_Groups.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="communications_8h.html">communications.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Sortie__Nulle_8h.html">Sortie_Nulle.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Journal_8h.html">Journal.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="SFichier_8h.html">SFichier.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Synonyme__info_8h.html">Synonyme_info.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;petsc_for_kernel.h&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="comm__incl_8h.html">comm_incl.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="TriouError_8h.html">TriouError.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="Comm__Group__MPI_8h.html">Comm_Group_MPI.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;unistd.h&gt;</span> <span class="comment">//!&lt; sleep() pour certaines machines</span>
<a name="l00038"></a>00038 <span class="comment"></span><span class="preprocessor">#include &lt;<a class="code" href="stat__counters_8h.html">stat_counters.h</a>&gt;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="SChaine_8h.html">SChaine.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="FichierHDFPar_8h.html">FichierHDFPar.h</a>&gt;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">// Chacun des fichiers Cerr, Cout et Journal(i)</span>
<a name="l00044"></a>00044 <span class="comment">// peut etre redirige vers l&#39;un des quatre fichiers suivants:</span>
<a name="l00045"></a>00045 <span class="comment">// Instance de la Sortie nulle (equivalent de /dev/null)</span>
<a name="l00046"></a><a class="code" href="Process_8cpp.html#a8f080dc02f389a243b1036012df12388">00046</a> <span class="keyword">static</span> <a class="code" href="classSortie__Nulle.html" title="Classe derivee de Sortie qui ne sort les donnees nulle part (c&#39;est une poubelle) Classe utilisee dans...">Sortie_Nulle</a>  <a class="code" href="Process_8cpp.html#a8f080dc02f389a243b1036012df12388" title="&lt; sleep() pour certaines machines">journal_zero_</a>;
<a name="l00047"></a>00047 <span class="comment">// Instance de la Sortie pointant vers cerr</span>
<a name="l00048"></a>00048 <span class="keyword">static</span> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>        <a class="code" href="Process_8cpp.html#a10d7fdf481006c44e06157e815b69634">std_err_</a>(cerr);
<a name="l00049"></a>00049 <span class="comment">// Instance de la Sortie pointant vers cout</span>
<a name="l00050"></a>00050 <span class="keyword">static</span> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>        <a class="code" href="Process_8cpp.html#a5ee981378b843ae291266a51ee2e1720">std_out_</a>(cout);
<a name="l00051"></a>00051 <span class="comment">// Instances du fichier Journal</span>
<a name="l00052"></a>00052 <span class="comment">// (if the journal is shared between all the procs, journal_file_ is not used</span>
<a name="l00053"></a>00053 <span class="comment">// and the processors&#39; output is redirected to journal_shared_stream_ before being written in a HDF5 file)</span>
<a name="l00054"></a><a class="code" href="Process_8cpp.html#aad28fe2402c6e76ebd6067160e90fc93">00054</a> <span class="keyword">static</span> <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a>     <a class="code" href="Process_8cpp.html#aad28fe2402c6e76ebd6067160e90fc93">journal_file_</a>;
<a name="l00055"></a><a class="code" href="Process_8cpp.html#a18f17f993d2188492d04f8f2621414fe">00055</a> <span class="keyword">static</span> <a class="code" href="classSChaine.html" title="Cette classe derivee de Sortie empile ce qu&#39;on lui envoie dans une chaine de caracteres. On recupere le contenu de la chaine avec get_str().">SChaine</a>      <a class="code" href="Process_8cpp.html#a18f17f993d2188492d04f8f2621414fe">journal_shared_stream_</a>;
<a name="l00056"></a><a class="code" href="Process_8cpp.html#a932c9832b6221a3ba8c6f84e9bf6df84">00056</a> <span class="keyword">static</span> <span class="keywordtype">int</span>                      <a class="code" href="Process_8cpp.html#a932c9832b6221a3ba8c6f84e9bf6df84">journal_shared_</a>;
<a name="l00057"></a>00057 
<a name="l00058"></a><a class="code" href="Process_8cpp.html#a0bedd9fc7de0543ad8ee1850dd13bc0e">00058</a> <span class="keyword">static</span> <span class="keywordtype">int</span>        <a class="code" href="Process_8cpp.html#a0bedd9fc7de0543ad8ee1850dd13bc0e">journal_file_open_</a>;
<a name="l00059"></a><a class="code" href="Process_8cpp.html#af8f0a3d68c7eccb5aa8d2670bf42f2f8">00059</a> <span class="keyword">static</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>           <a class="code" href="Process_8cpp.html#af8f0a3d68c7eccb5aa8d2670bf42f2f8">journal_file_name_</a>;
<a name="l00060"></a>00060 <span class="comment">// Niveau maximal des messages ecrits. La valeur initiale determine</span>
<a name="l00061"></a>00061 <span class="comment">// si les messages ecrits avant l&#39;initialisation du journal sont ecrits</span>
<a name="l00062"></a>00062 <span class="comment">// ou pas.</span>
<a name="l00063"></a><a class="code" href="Process_8cpp.html#a52cb2dd29055bdabf9ad37fc8b100ca0">00063</a> <span class="keyword">static</span> <span class="keywordtype">int</span>        <a class="code" href="Process_8cpp.html#a52cb2dd29055bdabf9ad37fc8b100ca0">verbose_level_</a> = 0;
<a name="l00064"></a><a class="code" href="Process_8cpp.html#aaaeccf659eaca329c9aac89f4c8b69cf">00064</a> <span class="keyword">static</span> <span class="keywordtype">int</span>        <a class="code" href="Process_8cpp.html#aaaeccf659eaca329c9aac89f4c8b69cf">disable_stop_</a> = 0;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="comment">// Drapeau indiquant si les sorties cerr et cout doivent</span>
<a name="l00067"></a>00067 <span class="comment">// etre redirigees vers le fichier journal</span>
<a name="l00068"></a><a class="code" href="Process_8cpp.html#af7a1448e90ec03103467107c5b6a28b2">00068</a> <span class="keyword">static</span> <span class="keywordtype">int</span>        <a class="code" href="Process_8cpp.html#af7a1448e90ec03103467107c5b6a28b2">cerr_to_journal_</a> = 0;
<a name="l00069"></a>00069 <span class="keyword">extern</span> <a class="code" href="classStat__Counter__Id.html">Stat_Counter_Id</a> <a class="code" href="Process_8cpp.html#ab4ed3f958d3302daec2a2e7e52d51348">mpi_allreduce_counter_</a>;
<a name="l00070"></a>00070 <span class="keywordtype">int</span> <a class="code" href="classProcess.html#ab0d2cbf9cdb22a0bd75a7e45026f6fc1">Process::exception_sur_exit</a>=0;
<a name="l00071"></a>00071 <span class="keywordtype">int</span> <a class="code" href="classProcess.html#a1d8a5252b02c0db08e1bea86c7442205" title="Valeur modifiable dans le jeu de donnees ou variable d&#39;environnement:">Process::multiple_files</a>=5120; <span class="comment">//!&lt; Valeur modifiable dans le jeu de donnees ou variable d&#39;environnement:</span>
<a name="l00072"></a><a class="code" href="classProcess.html#a0028ba29b8998170a85d2e0c00293b78">00072</a> <span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="classProcess.html#a0028ba29b8998170a85d2e0c00293b78">Process::force_single_file</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; ranks, <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; filename)
<a name="l00073"></a>00073 {
<a name="l00074"></a>00074   <span class="keywordtype">char</span>* theValue = getenv(<span class="stringliteral">&quot;TRUST_MultipleFiles&quot;</span>);
<a name="l00075"></a>00075   <span class="keywordflow">if</span> (theValue != NULL) <a class="code" href="classProcess.html#a1d8a5252b02c0db08e1bea86c7442205" title="Valeur modifiable dans le jeu de donnees ou variable d&#39;environnement:">multiple_files</a>=atoi(theValue);
<a name="l00076"></a>00076   <span class="keywordflow">if</span> (ranks&gt;<a class="code" href="classProcess.html#a1d8a5252b02c0db08e1bea86c7442205" title="Valeur modifiable dans le jeu de donnees ou variable d&#39;environnement:">multiple_files</a>)
<a name="l00077"></a>00077     {
<a name="l00078"></a>00078       <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())   <span class="comment">//!&lt; Attention, necessaire, car appel possible tres tot dans main.cpp alors que Cerr par defini completement sur les processes</span>
<a name="l00079"></a>00079 <span class="comment"></span>        {
<a name="l00080"></a>00080           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;======================================================================================================&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00081"></a>00081           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Warning! Single file option is forced for &quot;</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">&quot; above &quot;</span> &lt;&lt; <a class="code" href="classProcess.html#a1d8a5252b02c0db08e1bea86c7442205" title="Valeur modifiable dans le jeu de donnees ou variable d&#39;environnement:">multiple_files</a> &lt;&lt; <span class="stringliteral">&quot; MPI ranks.&quot;</span> &lt;&lt; finl;
<a name="l00082"></a>00082           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;for I/O performance reasons on cluster and inodes number limitation.&quot;</span> &lt;&lt; finl;
<a name="l00083"></a>00083           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;If you want to keep multiple files, add at the beginning of your data file to outpass the limitation:&quot;</span> &lt;&lt; finl;
<a name="l00084"></a>00084           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;MultipleFiles &quot;</span> &lt;&lt; ranks &lt;&lt; finl;
<a name="l00085"></a>00085           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;=====================================================================================================&quot;</span> &lt;&lt; finl;
<a name="l00086"></a>00086         }
<a name="l00087"></a>00087       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00088"></a>00088     }
<a name="l00089"></a>00089   <span class="keywordflow">else</span>
<a name="l00090"></a>00090     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <span class="comment">//</span><span class="comment"></span>
<a name="l00094"></a>00094 <span class="comment">//! renvoie 1 si on est sur le processeur maitre du groupe courant&lt;br&gt;(c&#39;est a dire me() == 0), 0 sinon. Voir Comm_Group::rank()</span>
<a name="l00095"></a><a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2">00095</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>()
<a name="l00096"></a>00096 {
<a name="l00097"></a>00097   <span class="keyword">const</span> <span class="keywordtype">int</span> r = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>().<a class="code" href="classComm__Group.html#a4ce6b03e1167d23c5e0e1e3447012c51" title="Renvoie le rang du processeur local dans le groupe *this. ou -1 si je ne suis pas dans le groupe...">rank</a>();
<a name="l00098"></a>00098   <span class="keywordflow">return</span> r == 0;
<a name="l00099"></a>00099 }
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 <span class="comment">//</span><span class="comment"></span>
<a name="l00102"></a>00102 <span class="comment">//! Constructeur par defaut</span>
<a name="l00103"></a><a class="code" href="classProcess.html#a9f4553eac74c657bb451f390c17d6bea">00103</a> <span class="comment"></span><a class="code" href="classProcess.html#a9f4553eac74c657bb451f390c17d6bea" title="Constructeur par defaut.">Process::Process</a>()
<a name="l00104"></a>00104 {
<a name="l00105"></a>00105 }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 <span class="comment">//</span><span class="comment"></span>
<a name="l00108"></a>00108 <span class="comment">//! renvoie le nombre de processeurs dans le groupe courant&lt;br&gt;Voir Comm_Group::nproc() et PE_Groups::current_group()</span>
<a name="l00109"></a><a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1">00109</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>()
<a name="l00110"></a>00110 {
<a name="l00111"></a>00111   <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>().<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>();
<a name="l00112"></a>00112   <span class="keywordflow">return</span> n;
<a name="l00113"></a>00113 }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 <span class="comment">//</span><span class="comment"></span>
<a name="l00116"></a>00116 <span class="comment">//! renvoie mon rang dans le groupe de communication courant.&lt;br&gt;Voir Comm_Group::rank() et PE_Groups::current_group()</span>
<a name="l00117"></a><a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4">00117</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>()
<a name="l00118"></a>00118 {
<a name="l00119"></a>00119   <span class="keyword">const</span> <span class="keywordtype">int</span> r = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>().<a class="code" href="classComm__Group.html#a4ce6b03e1167d23c5e0e1e3447012c51" title="Renvoie le rang du processeur local dans le groupe *this. ou -1 si je ne suis pas dans le groupe...">rank</a>();
<a name="l00120"></a>00120   <span class="keywordflow">return</span> r;
<a name="l00121"></a>00121 }
<a name="l00122"></a>00122 
<a name="l00123"></a>00123 <span class="comment">//</span>
<a name="l00124"></a>00124 <span class="comment">//</span>
<a name="l00125"></a>00125 <span class="comment">//</span><span class="comment"></span>
<a name="l00126"></a>00126 <span class="comment">//! Synchronise tous les processeurs du groupe courant&lt;br&gt;(attend que tous les processeurs soient arrives a la barriere)&lt;br&gt;Instruction a executer sur tous les processeurs du groupe.</span>
<a name="l00127"></a><a class="code" href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1">00127</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1" title="Synchronise tous les processeurs du groupe courant&lt;br&gt;(attend que tous les processeurs soient arrives...">Process::barrier</a>()
<a name="l00128"></a>00128 {
<a name="l00129"></a>00129   <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>().<a class="code" href="classComm__Group.html#ac20236e71fc50066d225761ba1349c69">barrier</a>(0);
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 <span class="comment">// Precondition:</span>
<a name="l00133"></a>00133 <span class="comment">// Parametre:</span>
<a name="l00134"></a>00134 <span class="comment">// Signification:</span>
<a name="l00135"></a>00135 <span class="comment">// Valeurs par defaut:</span>
<a name="l00136"></a>00136 <span class="comment">// Contraintes:</span>
<a name="l00137"></a>00137 <span class="comment">// Acces:</span>
<a name="l00138"></a>00138 <span class="comment">// </span>
<a name="l00139"></a>00139 <span class="comment">// Signification:</span>
<a name="l00140"></a>00140 <span class="comment">// Contraintes:</span>
<a name="l00141"></a>00141 <span class="comment">// Exception:</span>
<a name="l00142"></a>00142 <span class="comment">// Effets de bord:</span>
<a name="l00143"></a>00143 <span class="comment">// Postcondition:</span>
<a name="l00144"></a>00144 <span class="comment">//</span>
<a name="l00145"></a>00145 <span class="comment">//</span><span class="comment"></span>
<a name="l00146"></a>00146 <span class="comment">//! Destructeur&lt;br&gt;Ne fait rien</span>
<a name="l00147"></a><a class="code" href="classProcess.html#a990776d181dbbde7ff8ac12713d814b3">00147</a> <span class="comment"></span><a class="code" href="classProcess.html#a990776d181dbbde7ff8ac12713d814b3" title="Destructeur Ne fait rien.">Process::~Process</a>()
<a name="l00148"></a>00148 {
<a name="l00149"></a>00149 }
<a name="l00150"></a>00150 
<a name="l00151"></a>00151 <span class="comment">//</span>
<a name="l00152"></a>00152 <span class="comment">//</span>
<a name="l00153"></a>00153 <span class="comment">//</span>
<a name="l00154"></a>00154 <span class="comment">//</span><span class="comment"></span>
<a name="l00155"></a>00155 <span class="comment">//! Calcule le max de x sur tous les processeurs du groupe courant.&lt;br&gt;Remarques :&lt;br&gt;Cette methode doit etre appelee sur tous les processeurs du groupe.&lt;br&gt;La valeur renvoyee est identique sur tous les processeurs.</span>
<a name="l00156"></a><a class="code" href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d">00156</a> <span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d" title="Calcule le max de x sur tous les processeurs du groupe courant. Remarques : Cette methode doit etre a...">Process::mp_max</a>(<span class="keywordtype">double</span> x)
<a name="l00157"></a>00157 {
<a name="l00158"></a>00158   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00159"></a>00159   <span class="keywordtype">double</span> y;
<a name="l00160"></a>00160   grp.<a class="code" href="classComm__Group.html#abe4ac5fc38da03874333ddf9f4af5fa7">mp_collective_op</a>(&amp;x, &amp;y, 1, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302ca97e266ea06542559109eef5e5d642b86">Comm_Group::COLL_MAX</a>);
<a name="l00161"></a>00161   <span class="keywordflow">return</span> y;
<a name="l00162"></a>00162 }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164 <span class="comment">//</span>
<a name="l00165"></a>00165 <span class="comment">//</span><span class="comment"></span>
<a name="l00166"></a>00166 <span class="comment">//! Calcule le min de x sur tous les processeurs du groupe courant.&lt;br&gt;Voir aussi mp_max()</span>
<a name="l00167"></a><a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff">00167</a> <span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_min</a>(<span class="keywordtype">double</span> x)
<a name="l00168"></a>00168 {
<a name="l00169"></a>00169   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00170"></a>00170   <span class="keywordtype">double</span> y;
<a name="l00171"></a>00171   grp.<a class="code" href="classComm__Group.html#abe4ac5fc38da03874333ddf9f4af5fa7">mp_collective_op</a>(&amp;x, &amp;y, 1, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302cac56938ec8d65390f71357f084c9be49f">Comm_Group::COLL_MIN</a>);
<a name="l00172"></a>00172   <span class="keywordflow">return</span> y;
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">//</span>
<a name="l00176"></a>00176 <span class="comment">//</span><span class="comment"></span>
<a name="l00177"></a>00177 <span class="comment">//! Calcule la somme de x sur tous les processeurs du groupe courant.&lt;br&gt;Voir aussi mp_max()</span>
<a name="l00178"></a><a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd">00178</a> <span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(<span class="keywordtype">double</span> x)
<a name="l00179"></a>00179 {
<a name="l00180"></a>00180   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00181"></a>00181   <span class="keywordtype">double</span> y;
<a name="l00182"></a>00182   grp.<a class="code" href="classComm__Group.html#abe4ac5fc38da03874333ddf9f4af5fa7">mp_collective_op</a>(&amp;x, &amp;y, 1, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302ca55879cc8c9d3898570abc1279177d330">Comm_Group::COLL_SUM</a>);
<a name="l00183"></a>00183   <span class="keywordflow">return</span> y;
<a name="l00184"></a>00184 }
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 <span class="comment">//</span>
<a name="l00187"></a>00187 <span class="comment">//</span><span class="comment"></span>
<a name="l00188"></a>00188 <span class="comment">//! Calcule la somme de x sur tous les processeurs du groupe courant.&lt;br&gt;Voir aussi mp_max()</span>
<a name="l00189"></a><a class="code" href="classProcess.html#aa483f0f910caf591f46d04a226d2083b">00189</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(<span class="keywordtype">int</span> x)
<a name="l00190"></a>00190 {
<a name="l00191"></a>00191   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00192"></a>00192   <span class="keywordtype">int</span> y;
<a name="l00193"></a>00193   grp.<a class="code" href="classComm__Group.html#abe4ac5fc38da03874333ddf9f4af5fa7">mp_collective_op</a>(&amp;x, &amp;y, 1, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302ca55879cc8c9d3898570abc1279177d330">Comm_Group::COLL_SUM</a>);
<a name="l00194"></a>00194   <span class="keywordflow">return</span> y;
<a name="l00195"></a>00195 }
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 <span class="comment">//</span><span class="comment"></span>
<a name="l00198"></a>00198 <span class="comment">//! Calcule le &#39;et&#39; logique de b sur tous les processeurs du groupe courant.</span>
<a name="l00199"></a><a class="code" href="classProcess.html#aeaa5f9b4e42dc41414bebc7df14e16f6">00199</a> <span class="comment"></span><span class="keywordtype">bool</span> <a class="code" href="classProcess.html#aeaa5f9b4e42dc41414bebc7df14e16f6" title="Calcule le &#39;et&#39; logique de b sur tous les processeurs du groupe courant.">Process::mp_and</a>(<span class="keywordtype">bool</span> b)
<a name="l00200"></a>00200 {
<a name="l00201"></a>00201   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00202"></a>00202   <span class="keywordtype">int</span> x = b ? 1 : 0;
<a name="l00203"></a>00203   <span class="keywordtype">int</span> y;
<a name="l00204"></a>00204   grp.<a class="code" href="classComm__Group.html#abe4ac5fc38da03874333ddf9f4af5fa7">mp_collective_op</a>(&amp;x, &amp;y, 1, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302cac56938ec8d65390f71357f084c9be49f">Comm_Group::COLL_MIN</a>);
<a name="l00205"></a>00205   <span class="keywordflow">return</span> y == 1;
<a name="l00206"></a>00206 }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <span class="comment">// Precondition:</span>
<a name="l00209"></a>00209 <span class="comment">// Parametre:</span>
<a name="l00210"></a>00210 <span class="comment">// Signification:</span>
<a name="l00211"></a>00211 <span class="comment">// Valeurs par defaut:</span>
<a name="l00212"></a>00212 <span class="comment">// Contraintes:</span>
<a name="l00213"></a>00213 <span class="comment">// Acces:</span>
<a name="l00214"></a>00214 <span class="comment">// </span>
<a name="l00215"></a>00215 <span class="comment">// Signification:</span>
<a name="l00216"></a>00216 <span class="comment">// Contraintes:</span>
<a name="l00217"></a>00217 <span class="comment">// Exception:</span>
<a name="l00218"></a>00218 <span class="comment">// Effets de bord:</span>
<a name="l00219"></a>00219 <span class="comment">// Postcondition:</span>
<a name="l00220"></a>00220 <span class="comment">//</span>
<a name="l00221"></a>00221 <span class="comment">//</span><span class="comment"></span>
<a name="l00222"></a>00222 <span class="comment">//! Routine de sortie de Trio-U sur une erreur&lt;br&gt;Sauvegarde la memoire et le hierarchie dans les fichiers &quot;memoire.dump&quot; et &quot;hierarchie.dump&quot;</span>
<a name="l00223"></a><a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c">00223</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>(<span class="keywordtype">int</span> i)
<a name="l00224"></a>00224 {
<a name="l00225"></a>00225   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> <a class="code" href="Reordonner__faces__periodiques_8cpp.html#a137d78a01e63d3b66d1b2ed0de0f4c4c">message</a>=<span class="stringliteral">&quot;=========================================\nTRUST has caused an error and will stop.\nUnexpected error during TRUST calculation.&quot;</span>;
<a name="l00226"></a>00226   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>(message,i);
<a name="l00227"></a>00227 }
<a name="l00228"></a><a class="code" href="classProcess.html#aaa53d327405713fe4c44ee70fdcd7d69">00228</a> <span class="keywordtype">void</span> <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; <a class="code" href="Reordonner__faces__periodiques_8cpp.html#a137d78a01e63d3b66d1b2ed0de0f4c4c">message</a> ,<span class="keywordtype">int</span> i)
<a name="l00229"></a>00229 {
<a name="l00230"></a>00230   <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00231"></a>00231     {
<a name="l00232"></a>00232       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; message &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00233"></a>00233       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>.flush();
<a name="l00234"></a>00234       <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> hier(<span class="stringliteral">&quot;hierarchie.dump&quot;</span>);
<a name="l00235"></a>00235       hier &lt;&lt; <span class="stringliteral">&quot;\n             KEYWORDS\n&quot;</span>;
<a name="l00236"></a>00236       <a class="code" href="classType__info.html#aad48b1f59d3d7b01ce0cfe4592282fda" title="Ecriture de toute la hierarchie du type considere sur un flix de sortie.">Type_info::hierarchie</a>(hier);
<a name="l00237"></a>00237       hier &lt;&lt; <span class="stringliteral">&quot;\n             SYNONYMS\n&quot;</span>;
<a name="l00238"></a>00238       <a class="code" href="classSynonyme__info.html#ad816ebead22b577c8eb65dd60ba9d4f7" title="Ecriture de toute la hierarchie du synonyme considere sur un flux de sortie.">Synonyme_info::hierarchie</a>(hier);
<a name="l00239"></a>00239       <span class="keywordflow">if</span> (!<a class="code" href="Process_8cpp.html#a793f0cea0b470888001917e7bc49d680" title="Returns the disable_stop_ flag (Disable or not the writing of the .stop file)">get_disable_stop</a>() &amp;&amp; <a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
<a name="l00240"></a>00240         {
<a name="l00241"></a>00241           <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nomfic( <a class="code" href="classObjet__U.html#a7c27c4f80259eeef76ff8fe2d3bc61f7" title="Renvoie une reference constante vers le nom du cas. Cette methode est statique.">Objet_U::nom_du_cas</a>() );
<a name="l00242"></a>00242           nomfic += <span class="stringliteral">&quot;.stop&quot;</span>;
<a name="l00243"></a>00243           {
<a name="l00244"></a>00244             <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> ficstop( nomfic );
<a name="l00245"></a>00245             ficstop &lt;&lt;message&lt;&lt;finl;
<a name="l00246"></a>00246           }
<a name="l00247"></a>00247         }
<a name="l00248"></a>00248     }
<a name="l00249"></a>00249   <a class="code" href="classProcess.html#a57e0f54b11e6eaadbea224fa904b18dd" title="Renvoie un objet statique de type Sortie qui sert de journal d&#39;evenements. Si message_level &lt;= verbose...">Journal</a>() &lt;&lt; message &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00250"></a>00250   <span class="keywordflow">if</span>( <a class="code" href="Process_8cpp.html#a932c9832b6221a3ba8c6f84e9bf6df84">journal_shared_</a> &amp;&amp; <a class="code" href="Process_8cpp.html#a0bedd9fc7de0543ad8ee1850dd13bc0e">journal_file_open_</a>)
<a name="l00251"></a>00251     <a class="code" href="Journal_8h.html#a4c8cf6e825a1a83f36e5f67741ebe342">end_journal</a>(<a class="code" href="Process_8cpp.html#a52cb2dd29055bdabf9ad37fc8b100ca0">verbose_level_</a>);
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 
<a name="l00254"></a>00254   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#ab0d2cbf9cdb22a0bd75a7e45026f6fc1">exception_sur_exit</a>)
<a name="l00255"></a>00255     {
<a name="l00256"></a>00256 <span class="comment">// Lancement d&#39;une exception (utilise par Execute_parallel)</span>
<a name="l00257"></a>00257       <span class="keywordflow">throw</span> <a class="code" href="classTriouError.html" title="classe d erreur declenche par process::exit">TriouError</a>(<span class="stringliteral">&quot;Error in trust &quot;</span>,<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>());
<a name="l00258"></a>00258     }
<a name="l00259"></a>00259   <span class="keywordflow">else</span>
<a name="l00260"></a>00260     {
<a name="l00261"></a>00261       <span class="keywordtype">int</span> <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">abort</a>=0;
<a name="l00262"></a>00262 <span class="preprocessor">#ifdef MPI_</span>
<a name="l00263"></a>00263 <span class="preprocessor"></span><span class="preprocessor">#ifdef INT_is_64_</span>
<a name="l00264"></a>00264 <span class="preprocessor"></span><span class="preprocessor">#define MPI_ENTIER MPI_LONG</span>
<a name="l00265"></a>00265 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00266"></a>00266 <span class="preprocessor"></span><span class="preprocessor">#define MPI_ENTIER MPI_INT</span>
<a name="l00267"></a>00267 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00268"></a>00268 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>()&gt;1)
<a name="l00269"></a>00269         {
<a name="l00270"></a>00270           <span class="keyword">const</span> MPI_Comm&amp; mpi_comm=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classComm__Group__MPI.html" title=": Classe Comm_Group_MPI, derivee de la classe abstraite Comm_Group. Cette classe represente un groupe...">Comm_Group_MPI</a>,<a class="code" href="classPE__Groups.html#af38ed6631e572dc5117361b3f26a47a3" title="Renvoie une reference au groupe de tous les processeurs TRUST.">PE_Groups::groupe_TRUST</a>()).get_mpi_comm();
<a name="l00271"></a>00271           <span class="keywordtype">int</span> tag = 666;
<a name="l00272"></a>00272           <span class="keywordtype">int</span> buffer[1]= {1};
<a name="l00273"></a>00273           MPI_Request request;
<a name="l00274"></a>00274 
<a name="l00275"></a>00275 <span class="comment">// Envoi non bloquant vers me()+1</span>
<a name="l00276"></a>00276           <span class="keywordtype">int</span> to_pe = (<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">me</a>()==<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">nproc</a>()-1?0:<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">me</a>()+1);
<a name="l00277"></a>00277           MPI_Isend(buffer, 1, <a class="code" href="Comm__Group__MPI_8cpp.html#a9b683f6cb98289e218b17558829d3e80">MPI_ENTIER</a>, to_pe, tag, mpi_comm, &amp;request);
<a name="l00278"></a>00278 
<a name="l00279"></a>00279 <span class="comment">// Reception non bloquante depuis me()-1</span>
<a name="l00280"></a>00280           <span class="keywordtype">int</span> from_pe = (<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">me</a>()==0?<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">nproc</a>()-1:<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">me</a>()-1);
<a name="l00281"></a>00281           MPI_Irecv(buffer, 1, <a class="code" href="Comm__Group__MPI_8cpp.html#a9b683f6cb98289e218b17558829d3e80">MPI_ENTIER</a>, from_pe, tag, mpi_comm, &amp;request);
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 <span class="comment">// Attente</span>
<a name="l00284"></a>00284           sleep(1);
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 <span class="comment">// Test si me() a recu de me()-1</span>
<a name="l00287"></a>00287           <a class="code" href="arch_8h.html#a1caaf369d9c5f0817dbaa76b43b8d87b">True_int</a> ok;
<a name="l00288"></a>00288           MPI_Status status;
<a name="l00289"></a>00289           MPI_Test(&amp;request,&amp;ok,&amp;status);
<a name="l00290"></a>00290           <span class="keywordflow">if</span> (!ok)
<a name="l00291"></a>00291             abort=1;
<a name="l00292"></a>00292         }
<a name="l00293"></a>00293 <span class="preprocessor">#endif</span>
<a name="l00294"></a>00294 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (abort)
<a name="l00295"></a>00295         {
<a name="l00296"></a>00296           <span class="keywordflow">if</span> (!<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00297"></a>00297             {
<a name="l00298"></a>00298               <a class="code" href="Process_8cpp.html#a10d7fdf481006c44e06157e815b69634">std_err_</a> &lt;&lt; <span class="stringliteral">&quot;!!! TRUST process number &quot;</span> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot; exited unexpectedly ! See error message at the end of the file &quot;</span> &lt;&lt; journal_file_name_ &lt;&lt; <span class="stringliteral">&quot; -&gt; Aborting calculation...&quot;</span> &lt;&lt; finl;
<a name="l00299"></a>00299             }
<a name="l00300"></a>00300           <a class="code" href="classPE__Groups.html#af38ed6631e572dc5117361b3f26a47a3" title="Renvoie une reference au groupe de tous les processeurs TRUST.">PE_Groups::groupe_TRUST</a>().<a class="code" href="classComm__Group.html#a9eaa1dfaa2f51ddd7d72da0e7bc4f3d2">abort</a>();
<a name="l00301"></a>00301         }
<a name="l00302"></a>00302       <span class="keywordflow">else</span>
<a name="l00303"></a>00303         {
<a name="l00304"></a>00304 <span class="preprocessor">#ifdef MPI_</span>
<a name="l00305"></a>00305 <span class="preprocessor"></span>          MPI_Finalize();
<a name="l00306"></a>00306 <span class="preprocessor">#endif</span>
<a name="l00307"></a>00307 <span class="preprocessor"></span>          <a class="code" href="classPE__Groups.html#a711ec244f2a93cc54863f63053a5bdd8" title="Methode a appeler en fin d&#39;execution, une fois qu&#39;on est revenu dans le groupe_TRUST() et juste avant...">PE_Groups::finalize</a>();
<a name="l00308"></a>00308         }
<a name="l00309"></a>00309     }
<a name="l00310"></a>00310 <span class="comment">// On force exit();</span>
<a name="l00311"></a>00311   <span class="keywordflow">if</span> (i==0) i=-1;<a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;..."></a>
<a name="l00312"></a>00312 <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">  ::exit</a>(i); <span class="comment">//Seul ::exit utilise dans le code</span>
<a name="l00313"></a>00313 }
<a name="l00314"></a>00314 
<a name="l00315"></a>00315 <span class="comment">// Precondition:</span>
<a name="l00316"></a>00316 <span class="comment">// Parametre:</span>
<a name="l00317"></a>00317 <span class="comment">// Signification:</span>
<a name="l00318"></a>00318 <span class="comment">// Valeurs par defaut:</span>
<a name="l00319"></a>00319 <span class="comment">// Contraintes:</span>
<a name="l00320"></a>00320 <span class="comment">// Acces:</span>
<a name="l00321"></a>00321 <span class="comment">// </span>
<a name="l00322"></a>00322 <span class="comment">// Signification:</span>
<a name="l00323"></a>00323 <span class="comment">// Contraintes:</span>
<a name="l00324"></a>00324 <span class="comment">// Exception:</span>
<a name="l00325"></a>00325 <span class="comment">// Effets de bord:</span>
<a name="l00326"></a>00326 <span class="comment">// Postcondition:</span>
<a name="l00327"></a>00327 <span class="comment">//</span><span class="comment"></span>
<a name="l00328"></a>00328 <span class="comment">//! Routine de sortie de Trio-U sur une erreur abort()</span>
<a name="l00329"></a><a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881">00329</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">Process::abort</a>()
<a name="l00330"></a>00330 {
<a name="l00331"></a>00331 <span class="preprocessor">#ifdef NDEBUG</span>
<a name="l00332"></a>00332 <span class="preprocessor"></span><span class="comment">// En optimise on sort proprement.</span>
<a name="l00333"></a>00333   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00334"></a>00334 <span class="preprocessor">#else</span>
<a name="l00335"></a>00335 <span class="preprocessor"></span><span class="comment">// En debug, on sort brutal pour avoir des infos avec le debugger ?</span><a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()"></a>
<a name="l00336"></a>00336 <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">  ::abort</a>(); <span class="comment">//Seul ::abort() utilise dans le code</span>
<a name="l00337"></a>00337 <span class="preprocessor">#endif</span>
<a name="l00338"></a>00338 <span class="preprocessor"></span>}
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 <span class="comment">//</span>
<a name="l00341"></a>00341 <span class="comment">//</span>
<a name="l00342"></a>00342 <span class="comment">//</span>
<a name="l00343"></a>00343 <span class="comment">//</span><span class="comment"></span>
<a name="l00344"></a>00344 <span class="comment">//! Renvoie un objet statique de type Sortie qui sert de journal d&#39;evenements.&lt;br&gt;Si message_level &lt;= verbose_level_, on ecrit le message, sinon&lt;br&gt;on l&#39;envoie sur une Sortie_Nulle.&lt;br&gt;Si le fichier journal est ouvert, on ecrit dans le fichier, sinon dans stderr.</span>
<a name="l00345"></a><a class="code" href="classProcess.html#a57e0f54b11e6eaadbea224fa904b18dd">00345</a> <span class="comment"></span><a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classProcess.html#a57e0f54b11e6eaadbea224fa904b18dd" title="Renvoie un objet statique de type Sortie qui sert de journal d&#39;evenements. Si message_level &lt;= verbose...">Process::Journal</a>(<span class="keywordtype">int</span> message_level)
<a name="l00346"></a>00346 {
<a name="l00347"></a>00347   <span class="keywordflow">if</span> (message_level &lt;= verbose_level_ &amp;&amp; verbose_level_ &gt; 0)
<a name="l00348"></a>00348     {
<a name="l00349"></a>00349       <span class="keywordflow">if</span> (<a class="code" href="Process_8cpp.html#a0bedd9fc7de0543ad8ee1850dd13bc0e">journal_file_open_</a>)
<a name="l00350"></a>00350         {
<a name="l00351"></a>00351           <span class="keywordflow">if</span>(<a class="code" href="Process_8cpp.html#a932c9832b6221a3ba8c6f84e9bf6df84">journal_shared_</a>)
<a name="l00352"></a>00352             <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#a18f17f993d2188492d04f8f2621414fe">journal_shared_stream_</a>;
<a name="l00353"></a>00353           <span class="keywordflow">else</span>
<a name="l00354"></a>00354             <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#aad28fe2402c6e76ebd6067160e90fc93">journal_file_</a>;
<a name="l00355"></a>00355         }
<a name="l00356"></a>00356       <span class="keywordflow">else</span>
<a name="l00357"></a>00357         <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#a10d7fdf481006c44e06157e815b69634">std_err_</a>;
<a name="l00358"></a>00358     }
<a name="l00359"></a>00359   <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#a8f080dc02f389a243b1036012df12388" title="&lt; sleep() pour certaines machines">journal_zero_</a>;
<a name="l00360"></a>00360 }
<a name="l00361"></a>00361 
<a name="l00362"></a>00362 <span class="comment">// Renvoie la ram occupee par un processeur</span>
<a name="l00363"></a><a class="code" href="classProcess.html#a1828203162e59b0d29ffda4d04575098">00363</a> <span class="keywordtype">double</span> <a class="code" href="classProcess.html#a1828203162e59b0d29ffda4d04575098">Process::ram_processeur</a>()
<a name="l00364"></a>00364 {
<a name="l00365"></a>00365 <span class="preprocessor">#ifdef PETSCKSP_H</span>
<a name="l00366"></a>00366 <span class="preprocessor"></span>  PetscLogDouble memoire;
<a name="l00367"></a>00367   PetscMemoryGetCurrentUsage(&amp;memoire);
<a name="l00368"></a>00368   <span class="keywordflow">return</span> memoire;
<a name="l00369"></a>00369 <span class="preprocessor">#else</span>
<a name="l00370"></a>00370 <span class="preprocessor"></span>  <span class="keywordflow">return</span> 0;
<a name="l00371"></a>00371 <span class="preprocessor">#endif</span>
<a name="l00372"></a>00372 <span class="preprocessor"></span>}
<a name="l00373"></a>00373 
<a name="l00374"></a><a class="code" href="classProcess.html#aa1142e848c81a78c28a061a6f45b4042">00374</a> <span class="keywordtype">void</span> <a class="code" href="classProcess.html#aa1142e848c81a78c28a061a6f45b4042">Process::imprimer_ram_totale</a>(<span class="keywordtype">int</span> all_process)
<a name="l00375"></a>00375 {
<a name="l00376"></a>00376   <span class="keywordtype">double</span> memoire=<a class="code" href="classProcess.html#a1828203162e59b0d29ffda4d04575098">ram_processeur</a>();
<a name="l00377"></a>00377   <span class="keywordflow">if</span> (memoire)
<a name="l00378"></a>00378     {
<a name="l00379"></a>00379       <span class="keywordtype">int</span> Mo=1024*1024;
<a name="l00380"></a>00380       <span class="keywordflow">if</span> (all_process) <a class="code" href="classProcess.html#a57e0f54b11e6eaadbea224fa904b18dd" title="Renvoie un objet statique de type Sortie qui sert de journal d&#39;evenements. Si message_level &lt;= verbose...">Journal</a>() &lt;&lt; (int)(memoire/Mo) &lt;&lt; <span class="stringliteral">&quot; MBytes of RAM taken by the processor &quot;</span> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00381"></a>00381       <span class="comment">/*      if (Process::nproc()&gt;100)</span>
<a name="l00382"></a>00382 <span class="comment">              {</span>
<a name="l00383"></a>00383 <span class="comment">                memoire=Process::nproc()*memoire;</span>
<a name="l00384"></a>00384 <span class="comment">                Cout &lt;&lt; (int)(memoire/Mo) &lt;&lt; &quot; MBytes of RAM taken by the calculation (estimation).&quot; &lt;&lt; finl;</span>
<a name="l00385"></a>00385 <span class="comment">              }</span>
<a name="l00386"></a>00386 <span class="comment">            else */</span>
<a name="l00387"></a>00387       {
<a name="l00388"></a>00388 <span class="comment">// int max_memoire=Process::mp_max(memoire); // int au lieu de double provoque un segfault comment detecter ?</span>
<a name="l00389"></a>00389         <span class="keywordtype">double</span> max_memoire=<a class="code" href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d" title="Calcule le max de x sur tous les processeurs du groupe courant. Remarques : Cette methode doit etre a...">Process::mp_max</a>(memoire);
<a name="l00390"></a>00390         <span class="keywordtype">double</span> total_memoire=<a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(memoire);
<a name="l00391"></a>00391         <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; (int)(total_memoire/Mo) &lt;&lt; <span class="stringliteral">&quot; MBytes of RAM taken by the calculation (max on a rank: &quot;</span>&lt;&lt;(int)(max_memoire/Mo)&lt;&lt;<span class="stringliteral">&quot; MB).&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00392"></a>00392       }
<a name="l00393"></a>00393     }
<a name="l00394"></a>00394 }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396 <span class="comment">//</span>
<a name="l00397"></a>00397 <span class="comment">//</span>
<a name="l00398"></a>00398 <span class="comment">//</span>
<a name="l00399"></a>00399 <span class="comment">//</span>
<a name="l00400"></a>00400 <span class="comment">//</span>
<a name="l00401"></a>00401 <span class="comment">//</span>
<a name="l00402"></a>00402 <span class="comment">//</span>
<a name="l00403"></a>00403 <span class="comment">//</span><span class="comment"></span>
<a name="l00404"></a>00404 <span class="comment">//! Initialisation du journal&lt;br&gt;Parametre: verbose_level&lt;br&gt;Signification: les messages de niveau &lt;= verbose_level seront affiches,&lt;br&gt;les autres seront mis a la poubelle.&lt;br&gt;Parametre: file_name&lt;br&gt;Signification: si pointeur nul, tout le monde ecrit dans cerr, sinon&lt;br&gt;c&#39;est le nom du fichier (doit etre different sur chaque processeur)&lt;br&gt;Parametre: append&lt;br&gt;Signification: indique si on ouvre le fichier en mode append ou pas.</span>
<a name="l00405"></a><a class="code" href="Process_8cpp.html#a92ae70a1459b4426c9f3681da9267595">00405</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="Journal_8h.html#aafb399e72f0705ffe23becf8da63ed69" title="Initialisation du journal Parametre: verbose_level Signification: les messages de niveau &lt;= verbose_le...">init_journal_file</a>(<span class="keywordtype">int</span> verbose_level, <span class="keywordtype">int</span> journal_shared, <span class="keyword">const</span> <span class="keywordtype">char</span> * file_name, <span class="keywordtype">int</span> append)
<a name="l00406"></a>00406 {
<a name="l00407"></a>00407   <a class="code" href="Process_8cpp.html#a932c9832b6221a3ba8c6f84e9bf6df84">journal_shared_</a> = journal_shared;
<a name="l00408"></a>00408   <span class="keywordflow">if</span>( <a class="code" href="Process_8cpp.html#a932c9832b6221a3ba8c6f84e9bf6df84">journal_shared_</a> )
<a name="l00409"></a>00409     {
<a name="l00410"></a>00410       <span class="keywordflow">if</span>(<a class="code" href="Process_8cpp.html#a0bedd9fc7de0543ad8ee1850dd13bc0e">journal_file_open_</a>)
<a name="l00411"></a>00411         <a class="code" href="Journal_8h.html#a4c8cf6e825a1a83f36e5f67741ebe342">end_journal</a>(verbose_level);
<a name="l00412"></a>00412     }
<a name="l00413"></a>00413   <span class="keywordflow">else</span>
<a name="l00414"></a>00414     <a class="code" href="Journal_8h.html#a4c8cf6e825a1a83f36e5f67741ebe342">end_journal</a>(verbose_level);
<a name="l00415"></a>00415 
<a name="l00416"></a>00416   <span class="keywordflow">if</span> (verbose_level &gt; 0)
<a name="l00417"></a>00417     {
<a name="l00418"></a>00418       <span class="keywordflow">if</span> (file_name)
<a name="l00419"></a>00419         {
<a name="l00420"></a>00420           <span class="keywordflow">if</span>(!<a class="code" href="Process_8cpp.html#a932c9832b6221a3ba8c6f84e9bf6df84">journal_shared_</a>)
<a name="l00421"></a>00421             {
<a name="l00422"></a>00422               <a class="code" href="arch_8h.html#a58aa6cef3a754a92479a2fb744a5f538" title="Gestion des dependances machines pour l&#39;appel a FORTRAN La macro F77DECLARE(TOTO) permet de declarer ...">IOS_OPEN_MODE</a> mode = ios::out;
<a name="l00423"></a>00423               <span class="keywordflow">if</span> (append)
<a name="l00424"></a>00424                 mode = ios::app;
<a name="l00425"></a>00425               <span class="keywordflow">if</span> (!journal_file_.<a class="code" href="classSortie__Fichier__base.html#a7e75e18ed580cd4d45912ec202caa2b2">ouvrir</a>(file_name, mode))
<a name="l00426"></a>00426                 {
<a name="l00427"></a>00427                   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Fatal error in init_journal_file: cannot open journal file&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00428"></a>00428                   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00429"></a>00429                 }
<a name="l00430"></a>00430             }
<a name="l00431"></a>00431           <span class="keywordflow">else</span>
<a name="l00432"></a>00432             {
<a name="l00433"></a>00433               <span class="keywordflow">if</span>(append)
<a name="l00434"></a>00434                 <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Process.cpp::init_journal_file : append mode is not possible with HDF5!\n&quot;</span>
<a name="l00435"></a>00435                      &lt;&lt; <span class="stringliteral">&quot;If &quot;</span> &lt;&lt; file_name &lt;&lt; <span class="stringliteral">&quot; already exists, it will be overwritten&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00436"></a>00436             }
<a name="l00437"></a>00437           <a class="code" href="Process_8cpp.html#a0bedd9fc7de0543ad8ee1850dd13bc0e">journal_file_open_</a> = 1;
<a name="l00438"></a>00438           journal_file_name_ = file_name;
<a name="l00439"></a>00439         }
<a name="l00440"></a>00440     }
<a name="l00441"></a>00441   <a class="code" href="Process_8cpp.html#a52cb2dd29055bdabf9ad37fc8b100ca0">verbose_level_</a> = verbose_level;
<a name="l00442"></a>00442 }
<a name="l00443"></a>00443 
<a name="l00444"></a><a class="code" href="Process_8cpp.html#a4c8cf6e825a1a83f36e5f67741ebe342">00444</a> <span class="keywordtype">void</span> <a class="code" href="Journal_8h.html#a4c8cf6e825a1a83f36e5f67741ebe342">end_journal</a>(<span class="keywordtype">int</span> verbose_level)
<a name="l00445"></a>00445 {
<a name="l00446"></a>00446 <span class="comment">// Attention: acrobatie pour que ca &quot;plante proprement&quot; si le destructeur</span>
<a name="l00447"></a>00447 <span class="comment">// ecrit dans le journal !</span>
<a name="l00448"></a>00448   <span class="keywordflow">if</span>(<a class="code" href="Process_8cpp.html#a932c9832b6221a3ba8c6f84e9bf6df84">journal_shared_</a>)
<a name="l00449"></a>00449     {
<a name="l00450"></a>00450       <a class="code" href="classFichierHDFPar.html" title="Parallel collective version of FichierHDF, to be used for all concurrent reading/writing on HDF files...">FichierHDFPar</a> fic_hdf;
<a name="l00451"></a>00451       fic_hdf.<a class="code" href="classFichierHDF.html#ae8d1c1444d9d7ac5d0bef32feaa050df">create</a>(journal_file_name_);
<a name="l00452"></a>00452       fic_hdf.<a class="code" href="classFichierHDF.html#a25d4709e6498f901d7624c01306f3def">create_and_fill_dataset_MW</a>(<span class="stringliteral">&quot;/log&quot;</span>, journal_shared_stream_);
<a name="l00453"></a>00453       fic_hdf.<a class="code" href="classFichierHDF.html#ac5d8eb389ee60109c2d60029f442487f">close</a>();
<a name="l00454"></a>00454     }
<a name="l00455"></a>00455   <span class="keywordflow">else</span>
<a name="l00456"></a>00456     journal_file_.<a class="code" href="classSortie__Fichier__base.html#ac246a47c4438e3183322c20db2a3323c">close</a>();
<a name="l00457"></a>00457   <a class="code" href="Process_8cpp.html#a0bedd9fc7de0543ad8ee1850dd13bc0e">journal_file_open_</a> = 0;
<a name="l00458"></a>00458 }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 <span class="comment">//</span><span class="comment"></span>
<a name="l00461"></a>00461 <span class="comment">//! Renvoie l&#39;objet Sortie sur lequel seront redirigees les&lt;br&gt;objets ecrits dans Cerr. Cela peut etre std_err_ ou journal_file_</span>
<a name="l00462"></a><a class="code" href="Process_8cpp.html#a1882b8b2d15c412c0e6ad4995e188c67">00462</a> <span class="comment"></span><a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="EntreeSortie_8h.html#a1882b8b2d15c412c0e6ad4995e188c67" title="Renvoie l&#39;objet Sortie sur lequel seront redirigees les objets ecrits dans Cerr. Cela peut etre std_e...">get_Cerr</a>()
<a name="l00463"></a>00463 {
<a name="l00464"></a>00464   <span class="keywordflow">if</span> (<a class="code" href="Process_8cpp.html#a0bedd9fc7de0543ad8ee1850dd13bc0e">journal_file_open_</a> &amp;&amp; <a class="code" href="Process_8cpp.html#af7a1448e90ec03103467107c5b6a28b2">cerr_to_journal_</a>)
<a name="l00465"></a>00465     {
<a name="l00466"></a>00466       <span class="keywordflow">if</span>(<a class="code" href="Process_8cpp.html#a932c9832b6221a3ba8c6f84e9bf6df84">journal_shared_</a>)
<a name="l00467"></a>00467         <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#a18f17f993d2188492d04f8f2621414fe">journal_shared_stream_</a>;
<a name="l00468"></a>00468       <span class="keywordflow">else</span>
<a name="l00469"></a>00469         <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#aad28fe2402c6e76ebd6067160e90fc93">journal_file_</a>;
<a name="l00470"></a>00470     }
<a name="l00471"></a>00471   <span class="keywordflow">else</span>
<a name="l00472"></a>00472     {
<a name="l00473"></a>00473 <span class="comment">// dans le cas ou on a pas initialise les groupes</span>
<a name="l00474"></a>00474 <span class="comment">// on ne peut pas tester si on est maitre</span>
<a name="l00475"></a>00475       <span class="keywordflow">if</span> (<a class="code" href="classPE__Groups.html#a6fe714bb78ca65d4731c8b95db492172">PE_Groups::get_nb_groups</a>()==0)
<a name="l00476"></a>00476         <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#a10d7fdf481006c44e06157e815b69634">std_err_</a>;
<a name="l00477"></a>00477 <span class="comment">// Seul le processeur maitre ecrit sur std_err_, les autres ecrivent sur journal_file_</span>
<a name="l00478"></a>00478       <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
<a name="l00479"></a>00479         <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#a10d7fdf481006c44e06157e815b69634">std_err_</a>;
<a name="l00480"></a>00480       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Process_8cpp.html#a52cb2dd29055bdabf9ad37fc8b100ca0">verbose_level_</a>)
<a name="l00481"></a>00481         {
<a name="l00482"></a>00482           <span class="keywordflow">if</span>(<a class="code" href="Process_8cpp.html#a932c9832b6221a3ba8c6f84e9bf6df84">journal_shared_</a>)
<a name="l00483"></a>00483             <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#a18f17f993d2188492d04f8f2621414fe">journal_shared_stream_</a>;
<a name="l00484"></a>00484           <span class="keywordflow">else</span>
<a name="l00485"></a>00485             <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#aad28fe2402c6e76ebd6067160e90fc93">journal_file_</a>;
<a name="l00486"></a>00486         }
<a name="l00487"></a>00487       <span class="keywordflow">else</span>
<a name="l00488"></a>00488         <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#a8f080dc02f389a243b1036012df12388" title="&lt; sleep() pour certaines machines">journal_zero_</a>;
<a name="l00489"></a>00489     }
<a name="l00490"></a>00490 }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 <span class="comment">//</span>
<a name="l00493"></a>00493 <span class="comment">//</span><span class="comment"></span>
<a name="l00494"></a>00494 <span class="comment">//! Si on est sur le maitre, on renvoie cout ou le fichier journal&lt;br&gt;sinon journal_zero_.&lt;br&gt;Voir aussi cerr_to_journal_</span>
<a name="l00495"></a><a class="code" href="Process_8cpp.html#aa47014da8cd748a7646bd469ece9f82e">00495</a> <span class="comment"></span><a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="EntreeSortie_8h.html#aa47014da8cd748a7646bd469ece9f82e" title="Si on est sur le maitre, on renvoie cout ou le fichier journal sinon journal_zero_. Voir aussi cerr_to_journal_.">get_Cout</a>()
<a name="l00496"></a>00496 {
<a name="l00497"></a>00497   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
<a name="l00498"></a>00498     {
<a name="l00499"></a>00499       <span class="keywordflow">if</span> (<a class="code" href="Process_8cpp.html#a0bedd9fc7de0543ad8ee1850dd13bc0e">journal_file_open_</a> &amp;&amp; <a class="code" href="Process_8cpp.html#af7a1448e90ec03103467107c5b6a28b2">cerr_to_journal_</a>)
<a name="l00500"></a>00500         {
<a name="l00501"></a>00501           <span class="keywordflow">if</span>(<a class="code" href="Process_8cpp.html#a932c9832b6221a3ba8c6f84e9bf6df84">journal_shared_</a>)
<a name="l00502"></a>00502             <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#a18f17f993d2188492d04f8f2621414fe">journal_shared_stream_</a>;
<a name="l00503"></a>00503           <span class="keywordflow">else</span>
<a name="l00504"></a>00504             <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#aad28fe2402c6e76ebd6067160e90fc93">journal_file_</a>;
<a name="l00505"></a>00505         }
<a name="l00506"></a>00506       <span class="keywordflow">else</span>
<a name="l00507"></a>00507         <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#a5ee981378b843ae291266a51ee2e1720">std_out_</a>;
<a name="l00508"></a>00508     }
<a name="l00509"></a>00509   <span class="keywordflow">else</span>
<a name="l00510"></a>00510     {
<a name="l00511"></a>00511       <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#a8f080dc02f389a243b1036012df12388" title="&lt; sleep() pour certaines machines">journal_zero_</a>;
<a name="l00512"></a>00512     }
<a name="l00513"></a>00513 }
<a name="l00514"></a>00514 
<a name="l00515"></a>00515 <span class="comment">//</span>
<a name="l00516"></a>00516 <span class="comment">//</span>
<a name="l00517"></a>00517 <span class="comment">//</span><span class="comment"></span>
<a name="l00518"></a>00518 <span class="comment">//! change la destination de Cerr et Cout&lt;br&gt;Si flag=0, c&#39;est stderr et stdout, sinon, si le fichier&lt;br&gt;journal est ouvert, c&#39;est le journal, sinon c&#39;est&lt;br&gt;Sortie_Nulle</span>
<a name="l00519"></a><a class="code" href="Process_8cpp.html#a2244ba5308ba2093e63effc4dd4a5fa6">00519</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="Journal_8h.html#a2244ba5308ba2093e63effc4dd4a5fa6" title="change la destination de Cerr et Cout Si flag=0, c&#39;est stderr et stdout, sinon, si le fichier journal...">set_Cerr_to_journal</a>(<span class="keywordtype">int</span> flag)
<a name="l00520"></a>00520 {
<a name="l00521"></a>00521   <a class="code" href="Process_8cpp.html#af7a1448e90ec03103467107c5b6a28b2">cerr_to_journal_</a> = flag;
<a name="l00522"></a>00522 }
<a name="l00523"></a>00523 
<a name="l00524"></a><a class="code" href="Process_8cpp.html#a315d4fe9ccfb79fb3430ed88a6c68cef">00524</a> <span class="keywordtype">int</span> <a class="code" href="Journal_8h.html#a315d4fe9ccfb79fb3430ed88a6c68cef">get_journal_level</a>()
<a name="l00525"></a>00525 {
<a name="l00526"></a>00526   <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#a52cb2dd29055bdabf9ad37fc8b100ca0">verbose_level_</a>;
<a name="l00527"></a>00527 }
<a name="l00528"></a>00528 
<a name="l00529"></a><a class="code" href="Process_8cpp.html#a656c506f0984a9a9d73441671b7ec93a">00529</a> <span class="keywordtype">void</span> <a class="code" href="Journal_8h.html#a04aa120c0a1f37e61ca931a724b33ca6">change_journal_level</a>(<span class="keywordtype">int</span> level)
<a name="l00530"></a>00530 {
<a name="l00531"></a>00531   <a class="code" href="Process_8cpp.html#a52cb2dd29055bdabf9ad37fc8b100ca0">verbose_level_</a> = level;
<a name="l00532"></a>00532 }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534 <span class="comment">//</span><span class="comment"></span>
<a name="l00535"></a>00535 <span class="comment">//! Returns the disable_stop_ flag (Disable or not the writing of the .stop file)</span>
<a name="l00536"></a><a class="code" href="Process_8h.html#a793f0cea0b470888001917e7bc49d680">00536</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="Process_8cpp.html#a793f0cea0b470888001917e7bc49d680" title="Returns the disable_stop_ flag (Disable or not the writing of the .stop file)">get_disable_stop</a>()
<a name="l00537"></a>00537 {
<a name="l00538"></a>00538   <span class="keywordflow">return</span> <a class="code" href="Process_8cpp.html#aaaeccf659eaca329c9aac89f4c8b69cf">disable_stop_</a>;
<a name="l00539"></a>00539 }
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 <span class="comment">//</span><span class="comment"></span>
<a name="l00542"></a>00542 <span class="comment">//! Affects a new value to disable_stop_ flag (Disable or not the writing of the .stop file)</span>
<a name="l00543"></a><a class="code" href="Process_8h.html#aa796bea8b7b2907564c6e84ab2720a56">00543</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="Process_8cpp.html#aa796bea8b7b2907564c6e84ab2720a56" title="Affects a new value to disable_stop_ flag (Disable or not the writing of the .stop file)...">change_disable_stop</a>(<span class="keywordtype">int</span> new_stop)
<a name="l00544"></a>00544 {
<a name="l00545"></a>00545   <a class="code" href="Process_8cpp.html#aaaeccf659eaca329c9aac89f4c8b69cf">disable_stop_</a> = new_stop;
<a name="l00546"></a>00546 }
<a name="l00547"></a>00547 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:27 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
