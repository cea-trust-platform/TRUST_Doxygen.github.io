<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VDF/Operateurs/Evaluateurs_Diff/Eval_Diff_VDF_Elem.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VDF/Operateurs/Evaluateurs_Diff/Eval_Diff_VDF_Elem.h</div>  </div>
</div>
<div class="contents">
<a href="Eval__Diff__VDF__Elem_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Eval_Diff_VDF_Elem.h</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VDF/Operateurs/Evaluateurs_Diff</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     1</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="preprocessor">#ifndef Eval_Diff_VDF_Elem_included</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span><span class="preprocessor">#define Eval_Diff_VDF_Elem_included</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Evaluateur__VDF_8h.html">Evaluateur_VDF.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Eval__VDF__Elem2_8h.html">Eval_VDF_Elem2.h</a>&gt;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00031"></a><a class="code" href="classEval__Diff__VDF__Elem.html">00031</a> <span class="keyword">class </span><a class="code" href="classEval__Diff__VDF__Elem.html">Eval_Diff_VDF_Elem</a> : <span class="keyword">public</span> <a class="code" href="classEval__VDF__Elem2.html" title="class Eval_VDF_Elem Cette classe represente le prototype fonctionnel des evaluateurs de flux associes...">Eval_VDF_Elem2</a>, <span class="keyword">public</span> <a class="code" href="classEvaluateur__VDF.html" title="class Evaluateur_VDF Classe de base des evaluateurs VDF. Cette classe n&#39;appartient pas a la hierarchi...">Evaluateur_VDF</a>
<a name="l00032"></a>00032 {
<a name="l00033"></a>00033 <span class="keyword">public</span>:
<a name="l00034"></a>00034 
<a name="l00035"></a>00035   <span class="comment">/*</span>
<a name="l00036"></a>00036 <span class="comment">   * Notes about that MACRO&#39;s predefined in the previous version of TRUST</span>
<a name="l00037"></a>00037 <span class="comment">   * (just to understand when,where and why (not sure of why :) )</span>
<a name="l00038"></a>00038 <span class="comment">   *</span>
<a name="l00039"></a>00039 <span class="comment">   * - MULTD :</span>
<a name="l00040"></a>00040 <span class="comment">   *    TRUST : predefined for Diff/Dift const_Elem / var_Elem / var_Elem_aniso (not Multi-Inco)</span>
<a name="l00041"></a>00041 <span class="comment">   *    TrioCFD : predefined for Diff/Dift K_Eps_var_VDF_Elem &amp; K_Eps_Bas_Re_VDF_var_Elem</span>
<a name="l00042"></a>00042 <span class="comment">   *</span>
<a name="l00043"></a>00043 <span class="comment">   * - D_AXI :</span>
<a name="l00044"></a>00044 <span class="comment">   *    TRUST : predefined for Diff/Dift Axi operators</span>
<a name="l00045"></a>00045 <span class="comment">   *    TrioCFD : predefined for Diff/Dift Axi operators K_Eps</span>
<a name="l00046"></a>00046 <span class="comment">   *</span>
<a name="l00047"></a>00047 <span class="comment">   * - DEQUIV</span>
<a name="l00048"></a>00048 <span class="comment">   *    TRUST : predefined for Dift (not Diff) Multi_inco_const_Elem / Multi_inco_var_Elem &amp;&amp;</span>
<a name="l00049"></a>00049 <span class="comment">   *        Axi operators const_Elem_Axi / var_Elem_Axi / Multi_inco_var_Elem_Axi / Multi_inco_const_Elem_Axi</span>
<a name="l00050"></a>00050 <span class="comment">   *</span>
<a name="l00051"></a>00051 <span class="comment">   * - MODIF_DEQ</span>
<a name="l00052"></a>00052 <span class="comment">   *    TRUST : predefined for Dift (not Diff) const_Elem / var_Elem (no Axi, no Multi_Inco)</span>
<a name="l00053"></a>00053 <span class="comment">   *</span>
<a name="l00054"></a>00054 <span class="comment">   * - ISQUASI</span>
<a name="l00055"></a>00055 <span class="comment">   *    TrioCFD : predefined Diff_K_Eps_QC_VDF_Elem &amp;&amp; Diff_K_Eps_QC_var_VDF_Elem</span>
<a name="l00056"></a>00056 <span class="comment">   *</span>
<a name="l00057"></a>00057 <span class="comment">   * =======================================================================================</span>
<a name="l00058"></a>00058 <span class="comment">   *</span>
<a name="l00059"></a>00059 <span class="comment">   * These static constexpr bools &amp; Methods that will generalize the implementation</span>
<a name="l00060"></a>00060 <span class="comment">   * almost for all operator classes</span>
<a name="l00061"></a>00061 <span class="comment">   * The previous MACRO methodology do not exist anymore</span>
<a name="l00062"></a>00062 <span class="comment">   * See their generic declaration later &amp; override them in the derived class if</span>
<a name="l00063"></a>00063 <span class="comment">   * needed to stay coherent with the previous macros</span>
<a name="l00064"></a>00064 <span class="comment">   */</span>
<a name="l00065"></a>00065 
<a name="l00066"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ab8c0a67affaff424a6f737e22449edae">00066</a>   <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ab8c0a67affaff424a6f737e22449edae">IS_MULTD</a> = <span class="keyword">true</span>;
<a name="l00067"></a><a class="code" href="classEval__Diff__VDF__Elem.html#acff46db94bdea1193af1a3c190cfdd4a">00067</a>   <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="classEval__Diff__VDF__Elem.html#acff46db94bdea1193af1a3c190cfdd4a">IS_AXI</a> = <span class="keyword">false</span>;
<a name="l00068"></a><a class="code" href="classEval__Diff__VDF__Elem.html#af9453581eed9ec698c1bb164cb701054">00068</a>   <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="classEval__Diff__VDF__Elem.html#af9453581eed9ec698c1bb164cb701054">IS_DEQUIV</a> = <span class="keyword">false</span>;
<a name="l00069"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a2c550e97eff3668789882f28a398916b">00069</a>   <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a2c550e97eff3668789882f28a398916b">IS_MODIF_DEQ</a> = <span class="keyword">false</span>;
<a name="l00070"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ae57426a79e78bc94f885240431f798bf">00070</a>   <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ae57426a79e78bc94f885240431f798bf">IS_QUASI</a> = <span class="keyword">false</span>;
<a name="l00071"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a61d18eb2ba5da0de8195f216374579fc">00071</a>   <span class="keyword">static</span> constexpr <span class="keywordtype">bool</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a61d18eb2ba5da0de8195f216374579fc">IS_ANISO</a>= <span class="keyword">false</span>;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a8cb305361241045393d79c428485881a">Dist_norm_bord</a> (<span class="keywordtype">int</span> face) <span class="keyword">const</span>;
<a name="l00074"></a>00074   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#aa51705d57aae5aabad4b437bbf436a61">Dist_face_elem0</a>(<span class="keywordtype">int</span> face, <span class="keywordtype">int</span> n0) <span class="keyword">const</span>;
<a name="l00075"></a>00075   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#adc6915390f73920d525efce0e20f2228">Dist_face_elem1</a>(<span class="keywordtype">int</span> face, <span class="keywordtype">int</span> n1) <span class="keyword">const</span>;
<a name="l00076"></a>00076   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a2dbc5bb744178f9e72898ba5092438d1">Dist_norm_bord_externe_VEC</a>(<span class="keywordtype">int</span> boundary_index, <span class="keywordtype">int</span> global_face, <span class="keywordtype">int</span> local_face) <span class="keyword">const</span>;
<a name="l00077"></a>00077   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ae403435aa676473f3b76ca8b42a51ef8">Dist_norm_bord_externe_</a>(<span class="keywordtype">int</span> global_face) <span class="keyword">const</span>;
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="comment">// CRTP pattern to static_cast the appropriate class and get the implementation</span>
<a name="l00080"></a>00080 <span class="comment">// This is magic !</span>
<a name="l00081"></a>00081   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ad5896fae371aaca378a83acb026acead">nu_1</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> compo=0) <span class="keyword">const</span>;
<a name="l00082"></a>00082   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ad618248ea0d82972bb8ae1459a22e604">nu_2</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> compo=0) <span class="keyword">const</span>;
<a name="l00083"></a>00083   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a57331225bc61c17492c88d1ce5ac7934">compute_heq</a>(<span class="keywordtype">double</span>, <span class="keywordtype">int</span>, <span class="keywordtype">double</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span> compo=0) <span class="keyword">const</span>;
<a name="l00084"></a>00084   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a7514122184e638e6593cb76357c47778">ind_Fluctu_Term</a>() <span class="keyword">const</span>;
<a name="l00085"></a>00085   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ae30b93220154d48cfe0936b85bc30038">equivalent_distance</a> (<span class="keywordtype">int</span> boundary_index, <span class="keywordtype">int</span> local_face) <span class="keyword">const</span>;
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="comment">// TODO : all these should have the same name with different attributes</span>
<a name="l00088"></a>00088 <span class="comment">// so that they become a function template</span>
<a name="l00089"></a><a class="code" href="classEval__Diff__VDF__Elem.html#af1004890c0fcad9315e2dea08d78a5fb">00089</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#af1004890c0fcad9315e2dea08d78a5fb">calculer_flux_faces_echange_externe_impose</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1; }
<a name="l00090"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a723308c2a8824a0985f0c692e303133c">00090</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a723308c2a8824a0985f0c692e303133c">calculer_flux_faces_echange_global_impose</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1; }
<a name="l00091"></a><a class="code" href="classEval__Diff__VDF__Elem.html#abaf39be12ed15c862161bdafc2f084d5">00091</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#abaf39be12ed15c862161bdafc2f084d5">calculer_flux_faces_entree_fluide</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1; }
<a name="l00092"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a4f814102e464bf12bc91e89281f6d52b">00092</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a4f814102e464bf12bc91e89281f6d52b">calculer_flux_faces_paroi</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1; }
<a name="l00093"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a967e6d8844cdff11f589488fe351a001">00093</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a967e6d8844cdff11f589488fe351a001">calculer_flux_faces_paroi_adiabatique</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00094"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a562db49ddd7c2b5fdd56e905c341e903">00094</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a562db49ddd7c2b5fdd56e905c341e903">calculer_flux_faces_paroi_defilante</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00095"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a975bfda92da451820e9c7930a0016251">00095</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a975bfda92da451820e9c7930a0016251">calculer_flux_faces_paroi_fixe</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1; }
<a name="l00096"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a6d5ce9c2b5b6133194f1e6d99178fa33">00096</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a6d5ce9c2b5b6133194f1e6d99178fa33">calculer_flux_faces_sortie_libre</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00097"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a6adc8c9b5ec73d99b1598e5a0f02e885">00097</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a6adc8c9b5ec73d99b1598e5a0f02e885">calculer_flux_faces_symetrie</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00098"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a861e8ad1a76a013993b602b9ea731871">00098</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a861e8ad1a76a013993b602b9ea731871">calculer_flux_faces_periodique</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1; }
<a name="l00099"></a><a class="code" href="classEval__Diff__VDF__Elem.html#aa3cc608fe5cd9fddcb2254d6ba45e2d2">00099</a>   <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#aa3cc608fe5cd9fddcb2254d6ba45e2d2">calculer_flux_faces_NSCBC</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00100"></a>00100 
<a name="l00101"></a>00101   <span class="comment">//************************</span>
<a name="l00102"></a>00102   <span class="comment">// CAS SCALAIRE</span>
<a name="l00103"></a>00103   <span class="comment">//************************</span>
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <span class="comment">/*</span>
<a name="l00106"></a>00106 <span class="comment">   * XXX XXX XXX : VERY IMPORTANT</span>
<a name="l00107"></a>00107 <span class="comment">   * Partial specialization is not supported in C++ (otherwise I miss some information)</span>
<a name="l00108"></a>00108 <span class="comment">   * For example template&lt;typename DERIVED_T&gt;template&lt;&gt; will not compile due to</span>
<a name="l00109"></a>00109 <span class="comment">   * invalid explicit specialization before &#39;&gt;&#39; token</span>
<a name="l00110"></a>00110 <span class="comment">   * Complete specialization works ie: template&lt;&gt;template&lt;&gt;</span>
<a name="l00111"></a>00111 <span class="comment">   *</span>
<a name="l00112"></a>00112 <span class="comment">   * So, we need to overload some functions for specific BC&#39;s outside the function template</span>
<a name="l00113"></a>00113 <span class="comment">   */</span>
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="comment">// Fonctions qui servent a calculer le flux de grandeurs scalaires</span>
<a name="l00116"></a>00116   <span class="comment">// Elles sont de type double et renvoient le flux</span>
<a name="l00117"></a>00117 
<a name="l00118"></a>00118   <span class="comment">// Generic return</span>
<a name="l00119"></a>00119   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> BC&gt;
<a name="l00120"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">00120</a>   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> BC&amp;, <span class="keywordtype">int</span> )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122   <span class="comment">// To overload</span>
<a name="l00123"></a>00123   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp;, <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00124"></a>00124   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp;, <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00125"></a>00125   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp;, <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00126"></a>00126   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> <a class="code" href="classNSCBC.html" title="classe">NSCBC</a>&amp;, <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00127"></a>00127   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp;, <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00128"></a>00128   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classEchange__externe__impose.html" title="Classe Echange_externe_impose: Cette classe represente le cas particulier de la classe Echange_impose...">Echange_externe_impose</a>&amp;, <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00129"></a>00129   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ac8c3b12b3ee5e0a51b665198557216e6">flux_faces_interne</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00130"></a>00130 
<a name="l00131"></a>00131   <span class="comment">// Fonctions qui servent a calculer les coefficients de la matrice pour des grandeurs scalaires.</span>
<a name="l00132"></a>00132 
<a name="l00133"></a>00133   <span class="comment">// Generic return</span>
<a name="l00134"></a>00134   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> BC&gt;
<a name="l00135"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">00135</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> BC&amp;, <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj )<span class="keyword"> const </span>{ <span class="comment">/* Do nothing */</span> }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137   <span class="comment">// To overload</span>
<a name="l00138"></a>00138   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp;, <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00139"></a>00139   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp;, <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00140"></a>00140   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp;, <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00141"></a>00141   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classNSCBC.html" title="classe">NSCBC</a>&amp;, <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00142"></a>00142   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp;, <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00143"></a>00143   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classEchange__externe__impose.html" title="Classe Echange_externe_impose: Cette classe represente le cas particulier de la classe Echange_impose...">Echange_externe_impose</a>&amp;, <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00144"></a>00144   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a5278e8a178e3b11b1f94f92f04b23ee7">coeffs_faces_interne</a>(<span class="keywordtype">int</span>, <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00145"></a>00145 
<a name="l00146"></a>00146   <span class="comment">// Fonctions qui servent a calculer la contribution des conditions limites</span>
<a name="l00147"></a>00147   <span class="comment">// au second membre pour l&quot;implicite pour les grandeurs scalaires.</span>
<a name="l00148"></a>00148 
<a name="l00149"></a>00149   <span class="comment">// Generic return</span>
<a name="l00150"></a>00150   <span class="keyword">template</span>&lt;<span class="keyword">typename</span> BC&gt;
<a name="l00151"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">00151</a>   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">secmem_face</a>(<span class="keywordtype">int</span>, <span class="keyword">const</span> BC&amp;, <span class="keywordtype">int</span> )<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00152"></a>00152 
<a name="l00153"></a>00153   <span class="comment">// To overload</span>
<a name="l00154"></a>00154   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">secmem_face</a>(<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp;, <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00155"></a>00155   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">secmem_face</a>(<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp;, <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00156"></a>00156   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">secmem_face</a>(<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp;, <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00157"></a>00157   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">secmem_face</a>(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classEchange__externe__impose.html" title="Classe Echange_externe_impose: Cette classe represente le cas particulier de la classe Echange_impose...">Echange_externe_impose</a>&amp;, <span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00158"></a>00158   <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ac36170f82f963777f60abc011d4752d9">secmem_faces_interne</a>(<span class="keywordtype">int</span> ) <span class="keyword">const</span>;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160   <span class="comment">//************************</span>
<a name="l00161"></a>00161   <span class="comment">// CAS VECTORIEL</span>
<a name="l00162"></a>00162   <span class="comment">//************************</span>
<a name="l00163"></a>00163 
<a name="l00164"></a>00164   <span class="comment">/*</span>
<a name="l00165"></a>00165 <span class="comment">   * XXX XXX XXX : VERY IMPORTANT</span>
<a name="l00166"></a>00166 <span class="comment">   * Partial specialization is not supported in C++ (otherwise I miss some information)</span>
<a name="l00167"></a>00167 <span class="comment">   * For example template&lt;typename DERIVED_T&gt;template&lt;&gt; will not compile due to</span>
<a name="l00168"></a>00168 <span class="comment">   * invalid explicit specialization before &#39;&gt;&#39; token</span>
<a name="l00169"></a>00169 <span class="comment">   * Complete specialization works ie: template&lt;&gt;template&lt;&gt;</span>
<a name="l00170"></a>00170 <span class="comment">   *</span>
<a name="l00171"></a>00171 <span class="comment">   * So, we need to overload some functions for specific BC&#39;s outside the function template</span>
<a name="l00172"></a>00172 <span class="comment">   */</span>
<a name="l00173"></a>00173 
<a name="l00174"></a>00174   <span class="comment">// Fonctions qui servent a calculer le flux de grandeurs vectorielles</span>
<a name="l00175"></a>00175   <span class="comment">// Elles sont de type void et remplissent le tableau flux</span>
<a name="l00176"></a>00176 
<a name="l00177"></a>00177   <span class="comment">// Generic return</span>
<a name="l00178"></a>00178   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> BC&gt;
<a name="l00179"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a2abbc92deeb8feda2b9156ecdeb1640a">00179</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a2abbc92deeb8feda2b9156ecdeb1640a">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;,<span class="keywordtype">int</span> , <span class="keyword">const</span> BC&amp;,<span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux)<span class="keyword"> const </span>{ <span class="comment">/* Do nothing */</span> }
<a name="l00180"></a>00180   <span class="comment">// To overload</span>
<a name="l00181"></a>00181 
<a name="l00182"></a>00182   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp;,   <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux) <span class="keyword">const</span>;
<a name="l00183"></a>00183   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__defilante.html" title="classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes...">Dirichlet_paroi_defilante</a>&amp;, <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux) <span class="keyword">const</span>;
<a name="l00184"></a>00184   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__fixe.html" title="classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes...">Dirichlet_paroi_fixe</a>&amp;,      <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux) <span class="keyword">const</span>;
<a name="l00185"></a>00185   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp;,     <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux) <span class="keyword">const</span>;
<a name="l00186"></a>00186   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp;,             <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux) <span class="keyword">const</span>;
<a name="l00187"></a>00187   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp;,  <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux) <span class="keyword">const</span>;
<a name="l00188"></a>00188   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp;,            <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux) <span class="keyword">const</span>;
<a name="l00189"></a>00189   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classEchange__externe__impose.html" title="Classe Echange_externe_impose: Cette classe represente le cas particulier de la classe Echange_impose...">Echange_externe_impose</a>&amp;,   <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux) <span class="keyword">const</span>;
<a name="l00190"></a>00190   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ac8c3b12b3ee5e0a51b665198557216e6">flux_faces_interne</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> , <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux) <span class="keyword">const</span>;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192   <span class="comment">// Fonctions qui servent a calculer les coefficients de la matrice pour des grandeurs</span>
<a name="l00193"></a>00193   <span class="comment">// vectorielles.</span>
<a name="l00194"></a>00194 
<a name="l00195"></a>00195   <span class="comment">// Generic return</span>
<a name="l00196"></a>00196   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> BC&gt;
<a name="l00197"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a130a2d6f7d8761627c0c835f52db9968">00197</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a130a2d6f7d8761627c0c835f52db9968">coeffs_face</a>(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>,<span class="keyword">const</span> BC&amp;, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj )<span class="keyword"> const </span>{ <span class="comment">/* Do nothing */</span> }
<a name="l00198"></a>00198 
<a name="l00199"></a>00199   <span class="comment">// To overload</span>
<a name="l00200"></a>00200   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp;, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00201"></a>00201   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp;, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00202"></a>00202   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__defilante.html" title="classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes...">Dirichlet_paroi_defilante</a>&amp;, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00203"></a>00203   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>,<span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__fixe.html" title="classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes...">Dirichlet_paroi_fixe</a>&amp;, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00204"></a>00204   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp;, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00205"></a>00205   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp;, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00206"></a>00206   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">coeffs_face</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classEchange__externe__impose.html" title="Classe Echange_externe_impose: Cette classe represente le cas particulier de la classe Echange_impose...">Echange_externe_impose</a>&amp;, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00207"></a>00207   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a5278e8a178e3b11b1f94f92f04b23ee7">coeffs_faces_interne</a>(<span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj ) <span class="keyword">const</span>;
<a name="l00208"></a>00208 
<a name="l00209"></a>00209   <span class="comment">// Fonctions qui servent a calculer la contribution des conditions limites</span>
<a name="l00210"></a>00210   <span class="comment">// au second membre pour l&quot;implicite pour les grandeurs vectorielles.</span>
<a name="l00211"></a>00211 
<a name="l00212"></a>00212   <span class="comment">// Generic return</span>
<a name="l00213"></a>00213   <span class="keyword">template</span> &lt;<span class="keyword">typename</span> BC&gt;
<a name="l00214"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ac7a5cfa80da83cc96808781a42e3a003">00214</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ac7a5cfa80da83cc96808781a42e3a003">secmem_face</a>(<span class="keywordtype">int</span>, <span class="keyword">const</span> BC&amp;, <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; )<span class="keyword"> const </span>{ <span class="comment">/* Do nothing */</span> }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216   <span class="comment">// To overload</span>
<a name="l00217"></a>00217   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">secmem_face</a>(<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp;, <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ) <span class="keyword">const</span>;
<a name="l00218"></a>00218   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">secmem_face</a>(<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__defilante.html" title="classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes...">Dirichlet_paroi_defilante</a>&amp;, <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ) <span class="keyword">const</span>;
<a name="l00219"></a>00219   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">secmem_face</a>(<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__fixe.html" title="classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes...">Dirichlet_paroi_fixe</a>&amp;, <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ) <span class="keyword">const</span>;
<a name="l00220"></a>00220   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">secmem_face</a>(<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp;, <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ) <span class="keyword">const</span>;
<a name="l00221"></a>00221   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">secmem_face</a>(<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp;, <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ) <span class="keyword">const</span>;
<a name="l00222"></a>00222   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">secmem_face</a>(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classEchange__externe__impose.html" title="Classe Echange_externe_impose: Cette classe represente le cas particulier de la classe Echange_impose...">Echange_externe_impose</a>&amp;, <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ) <span class="keyword">const</span>;
<a name="l00223"></a>00223   <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ac36170f82f963777f60abc011d4752d9">secmem_faces_interne</a>(<span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ) <span class="keyword">const</span>;
<a name="l00224"></a>00224 };
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 <span class="comment">//************************</span>
<a name="l00227"></a>00227 <span class="comment">// CRTP pattern</span>
<a name="l00228"></a>00228 <span class="comment">//************************</span>
<a name="l00229"></a>00229 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00230"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ad5896fae371aaca378a83acb026acead">00230</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ad5896fae371aaca378a83acb026acead">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::nu_1</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> compo)<span class="keyword"> const</span>
<a name="l00231"></a>00231 <span class="keyword"></span>{
<a name="l00232"></a>00232   <span class="keywordtype">double</span> nu = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>DERIVED_T *<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;nu_1_impl(i, compo);
<a name="l00233"></a>00233   <span class="keywordflow">return</span> nu;
<a name="l00234"></a>00234 }
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00237"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ad618248ea0d82972bb8ae1459a22e604">00237</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ad618248ea0d82972bb8ae1459a22e604">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::nu_2</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> compo)<span class="keyword"> const</span>
<a name="l00238"></a>00238 <span class="keyword"></span>{
<a name="l00239"></a>00239   <span class="keywordtype">double</span> nu = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>DERIVED_T *<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;nu_2_impl(i, compo);
<a name="l00240"></a>00240   <span class="keywordflow">return</span> nu;
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00244"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a57331225bc61c17492c88d1ce5ac7934">00244</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a57331225bc61c17492c88d1ce5ac7934">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::compute_heq</a>(<span class="keywordtype">double</span> d0, <span class="keywordtype">int</span> i0, <span class="keywordtype">double</span> d1, <span class="keywordtype">int</span> i1, <span class="keywordtype">int</span> compo)<span class="keyword"> const</span>
<a name="l00245"></a>00245 <span class="keyword"></span>{
<a name="l00246"></a>00246   <span class="keywordtype">double</span> heq = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>DERIVED_T *<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;compute_heq_impl(d0, i0, d1, i1, compo);
<a name="l00247"></a>00247   <span class="keywordflow">return</span> heq;
<a name="l00248"></a>00248 }
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 <span class="comment">// See generic impl in the class Eval_Diff_VDF. They will be overloaded for Dift ops</span>
<a name="l00251"></a>00251 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00252"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a7514122184e638e6593cb76357c47778">00252</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a7514122184e638e6593cb76357c47778">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::ind_Fluctu_Term</a>()<span class="keyword"> const</span>
<a name="l00253"></a>00253 <span class="keyword"></span>{
<a name="l00254"></a>00254   <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>DERIVED_T *<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;get_ind_Fluctu_Term();
<a name="l00255"></a>00255 }
<a name="l00256"></a>00256 
<a name="l00257"></a>00257 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00258"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ae30b93220154d48cfe0936b85bc30038">00258</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ae30b93220154d48cfe0936b85bc30038">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::equivalent_distance</a> (<span class="keywordtype">int</span> boundary_index, <span class="keywordtype">int</span> local_face)<span class="keyword"> const</span>
<a name="l00259"></a>00259 <span class="keyword"></span>{
<a name="l00260"></a>00260   <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>DERIVED_T *<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;get_equivalent_distance(boundary_index,local_face);
<a name="l00261"></a>00261 }
<a name="l00262"></a>00262 
<a name="l00263"></a>00263 <span class="comment">//************************</span>
<a name="l00264"></a>00264 <span class="comment">// Replaced the MACROS</span>
<a name="l00265"></a>00265 <span class="comment">//************************</span>
<a name="l00266"></a>00266 
<a name="l00267"></a>00267 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00268"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a8cb305361241045393d79c428485881a">00268</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a8cb305361241045393d79c428485881a">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::Dist_norm_bord</a> (<span class="keywordtype">int</span> face)<span class="keyword"> const</span>
<a name="l00269"></a>00269 <span class="keyword"></span>{
<a name="l00270"></a>00270   <span class="keywordtype">double</span> val = DERIVED_T::IS_AXI ? la_zone-&gt;dist_norm_bord_axi(face) : la_zone-&gt;dist_norm_bord(face);
<a name="l00271"></a>00271   <span class="keywordflow">if</span> (DERIVED_T::IS_MULTD)
<a name="l00272"></a>00272     <span class="keywordflow">return</span> val;
<a name="l00273"></a>00273   <span class="keywordflow">else</span>
<a name="l00274"></a>00274     <span class="keywordflow">return</span> 2*val;
<a name="l00275"></a>00275 }
<a name="l00276"></a>00276 
<a name="l00277"></a>00277 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00278"></a><a class="code" href="classEval__Diff__VDF__Elem.html#aa51705d57aae5aabad4b437bbf436a61">00278</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#aa51705d57aae5aabad4b437bbf436a61">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::Dist_face_elem0</a>(<span class="keywordtype">int</span> face, <span class="keywordtype">int</span> n0)<span class="keyword"> const</span>
<a name="l00279"></a>00279 <span class="keyword"></span>{
<a name="l00280"></a>00280   <span class="keywordtype">double</span> val = DERIVED_T::IS_AXI ? la_zone-&gt;dist_face_elem0_axi(face,n0): la_zone-&gt;dist_face_elem0(face,n0);
<a name="l00281"></a>00281   <span class="keywordflow">return</span> val;
<a name="l00282"></a>00282 }
<a name="l00283"></a>00283 
<a name="l00284"></a>00284 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00285"></a><a class="code" href="classEval__Diff__VDF__Elem.html#adc6915390f73920d525efce0e20f2228">00285</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#adc6915390f73920d525efce0e20f2228">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::Dist_face_elem1</a>(<span class="keywordtype">int</span> face, <span class="keywordtype">int</span> n1)<span class="keyword"> const</span>
<a name="l00286"></a>00286 <span class="keyword"></span>{
<a name="l00287"></a>00287   <span class="keywordtype">double</span> val = DERIVED_T::IS_AXI ? la_zone-&gt;dist_face_elem1_axi(face,n1): la_zone-&gt;dist_face_elem1(face,n1);
<a name="l00288"></a>00288   <span class="keywordflow">return</span> val;
<a name="l00289"></a>00289 }
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00292"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a2dbc5bb744178f9e72898ba5092438d1">00292</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a2dbc5bb744178f9e72898ba5092438d1">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::Dist_norm_bord_externe_VEC</a>(<span class="keywordtype">int</span> boundary_index, <span class="keywordtype">int</span> global_face, <span class="keywordtype">int</span> local_face)<span class="keyword"> const</span>
<a name="l00293"></a>00293 <span class="keyword"></span>{
<a name="l00294"></a>00294   <span class="keywordflow">if</span> (DERIVED_T::IS_DEQUIV)
<a name="l00295"></a>00295     <span class="keywordflow">return</span> equivalent_distance(boundary_index,local_face);
<a name="l00296"></a>00296   <span class="keywordflow">else</span>
<a name="l00297"></a>00297     <span class="keywordflow">return</span> DERIVED_T::IS_AXI ? la_zone-&gt;dist_norm_bord_axi(global_face) : la_zone-&gt;dist_norm_bord(global_face);
<a name="l00298"></a>00298 }
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00301"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ae403435aa676473f3b76ca8b42a51ef8">00301</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ae403435aa676473f3b76ca8b42a51ef8">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::Dist_norm_bord_externe_</a>(<span class="keywordtype">int</span> global_face)<span class="keyword"> const</span>
<a name="l00302"></a>00302 <span class="keyword"></span>{
<a name="l00303"></a>00303   assert (!DERIVED_T::IS_DEQUIV);
<a name="l00304"></a>00304   <span class="keywordflow">return</span> DERIVED_T::IS_AXI ? la_zone-&gt;dist_norm_bord_axi(global_face) : la_zone-&gt;dist_norm_bord(global_face);
<a name="l00305"></a>00305 }
<a name="l00306"></a>00306 
<a name="l00307"></a>00307 <span class="comment">//************************</span>
<a name="l00308"></a>00308 <span class="comment">// CAS SCALAIRE</span>
<a name="l00309"></a>00309 <span class="comment">//************************</span>
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="comment">/* Function templates specialization for BC Dirichlet_entree_fluide */</span>
<a name="l00312"></a>00312 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00313"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a6b2b49c6a4eade5fce5d1cc2b5e2abd4">00313</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <span class="keywordtype">int</span> face,
<a name="l00314"></a>00314                                                        <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp; la_cl,
<a name="l00315"></a>00315                                                        <span class="keywordtype">int</span> num1)<span class="keyword"> const</span>
<a name="l00316"></a>00316 <span class="keyword"></span>{
<a name="l00317"></a>00317   <span class="keywordtype">double</span> T_imp = la_cl.<a class="code" href="classDirichlet.html#ab59a2214e3208ac45048a2232c132803" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps par defaut du cham...">val_imp</a>(face-num1);
<a name="l00318"></a>00318   <span class="keywordtype">int</span> n0 = elem_(face,0);
<a name="l00319"></a>00319   <span class="keywordtype">int</span> n1 = elem_(face,1);
<a name="l00320"></a>00320   <span class="comment">// Olga avait mis :</span>
<a name="l00321"></a>00321   <span class="comment">// double dist = 2*Dist_norm_bord(face);</span>
<a name="l00322"></a>00322   <span class="comment">// Pierre dit que :</span>
<a name="l00323"></a>00323   <span class="keywordtype">double</span> dist = Dist_norm_bord(face);
<a name="l00324"></a>00324   <span class="keywordtype">double</span> flux;
<a name="l00325"></a>00325   <span class="keywordtype">int</span> ori = DERIVED_T::IS_ANISO ? orientation(face) : 0;
<a name="l00326"></a>00326 
<a name="l00327"></a>00327   <span class="keywordflow">if</span> (n0 != -1)
<a name="l00328"></a>00328     {
<a name="l00329"></a>00329       flux = (T_imp-inco[n0])*surface(face)/dist;
<a name="l00330"></a>00330       flux *= (porosite(face)*nu_1(n0,ori));
<a name="l00331"></a>00331     }
<a name="l00332"></a>00332   <span class="keywordflow">else</span>   <span class="comment">// n1 != -1</span>
<a name="l00333"></a>00333     {
<a name="l00334"></a>00334       flux = (inco[n1]-T_imp)*surface(face)/dist;
<a name="l00335"></a>00335       flux*= (porosite(face)*nu_1(n1,ori));
<a name="l00336"></a>00336     }
<a name="l00337"></a>00337   <span class="keywordflow">return</span> flux;
<a name="l00338"></a>00338 }
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 <span class="comment">/* Function templates specialization for BC Dirichlet_entree_fluide */</span>
<a name="l00341"></a>00341 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00342"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ae0c87ed3be7a1785a82611ef61255782">00342</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> face, <span class="keywordtype">int</span>,
<a name="l00343"></a>00343                                                        <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp; la_cl,
<a name="l00344"></a>00344                                                        <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj)<span class="keyword"> const</span>
<a name="l00345"></a>00345 <span class="keyword"></span>{
<a name="l00346"></a>00346   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l00347"></a>00347   <span class="comment">//  int j = elem(face,1);</span>
<a name="l00348"></a>00348   <span class="keywordtype">double</span> dist = Dist_norm_bord(face);
<a name="l00349"></a>00349   <span class="keywordtype">int</span> ori = DERIVED_T::IS_ANISO ? orientation(face) : 0;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351   <span class="keywordflow">if</span> (i != -1)
<a name="l00352"></a>00352     {
<a name="l00353"></a>00353       aii =  porosite(face)*nu_1(i,ori)*surface(face)/dist;
<a name="l00354"></a>00354       ajj = 0;
<a name="l00355"></a>00355     }
<a name="l00356"></a>00356   <span class="keywordflow">else</span>   <span class="comment">// j != -1</span>
<a name="l00357"></a>00357     {
<a name="l00358"></a>00358       ajj =  porosite(face)*nu_1(elem_(face,1),ori)*surface(face)/dist;
<a name="l00359"></a>00359       aii = 0;
<a name="l00360"></a>00360     }
<a name="l00361"></a>00361 }
<a name="l00362"></a>00362 
<a name="l00363"></a>00363 <span class="comment">/* Function templates specialization for BC Dirichlet_entree_fluide */</span>
<a name="l00364"></a>00364 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00365"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a5d718dba17ca7075ad28e94b30770d76">00365</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::secmem_face</a>(<span class="keywordtype">int</span> face, <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp; la_cl,
<a name="l00366"></a>00366                                                          <span class="keywordtype">int</span> num1)<span class="keyword"> const</span>
<a name="l00367"></a>00367 <span class="keyword"></span>{
<a name="l00368"></a>00368   <span class="keywordtype">double</span> T_imp = la_cl.<a class="code" href="classDirichlet.html#ab59a2214e3208ac45048a2232c132803" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps par defaut du cham...">val_imp</a>(face-num1);
<a name="l00369"></a>00369   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l00370"></a>00370   <span class="comment">//  int j = elem(face,1);</span>
<a name="l00371"></a>00371   <span class="keywordtype">double</span> dist = Dist_norm_bord(face);
<a name="l00372"></a>00372   <span class="keywordtype">double</span> flux;
<a name="l00373"></a>00373   <span class="keywordtype">int</span> ori = DERIVED_T::IS_ANISO ? orientation(face) : 0;
<a name="l00374"></a>00374 
<a name="l00375"></a>00375   <span class="keywordflow">if</span> (i != -1)
<a name="l00376"></a>00376     {
<a name="l00377"></a>00377       flux = T_imp*surface(face)/dist;
<a name="l00378"></a>00378       flux *= porosite(face)*nu_1(i,ori);
<a name="l00379"></a>00379     }
<a name="l00380"></a>00380   <span class="keywordflow">else</span>   <span class="comment">// j != -1</span>
<a name="l00381"></a>00381     {
<a name="l00382"></a>00382       flux = -T_imp*surface(face)/dist;
<a name="l00383"></a>00383       flux *= (porosite(face)*nu_1(elem_(face,1),ori));
<a name="l00384"></a>00384     }
<a name="l00385"></a>00385 
<a name="l00386"></a>00386   <span class="keywordflow">return</span> flux;
<a name="l00387"></a>00387 }
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00390"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ad6e5c02025f26e8da5c664090def8ebe">00390</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <span class="keywordtype">int</span> boundary_index, <span class="keywordtype">int</span> face, <span class="keywordtype">int</span> local_face,
<a name="l00391"></a>00391                                                        <span class="keyword">const</span> <a class="code" href="classEchange__externe__impose.html" title="Classe Echange_externe_impose: Cette classe represente le cas particulier de la classe Echange_impose...">Echange_externe_impose</a>&amp; la_cl,
<a name="l00392"></a>00392                                                        <span class="keywordtype">int</span> num1)<span class="keyword"> const</span>
<a name="l00393"></a>00393 <span class="keyword"></span>{
<a name="l00394"></a>00394   <span class="comment">// C.L de type Echange_externe_impose : 1/h_total = (1/h_imp) + (e/diffusivite)</span>
<a name="l00395"></a>00395   <span class="comment">// La C.L fournit h_imp ; il faut calculer e/diffusivite</span>
<a name="l00396"></a>00396 
<a name="l00397"></a>00397   <span class="keywordtype">double</span> h_total_inv;
<a name="l00398"></a>00398   <span class="keywordtype">double</span> h_imp = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1);
<a name="l00399"></a>00399   <span class="keywordtype">double</span> T_ext = la_cl.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-num1);
<a name="l00400"></a>00400   <span class="keywordtype">double</span> e;
<a name="l00401"></a>00401   <span class="keywordtype">int</span> n0 = elem_(face,0);
<a name="l00402"></a>00402   <span class="keywordtype">int</span> n1 = elem_(face,1);
<a name="l00403"></a>00403 <span class="comment">//  Dist_norm_bord_externe(boundary_index,face,local_face);</span>
<a name="l00404"></a>00404   <span class="keywordflow">if</span> (DERIVED_T::IS_MODIF_DEQ)
<a name="l00405"></a>00405     {
<a name="l00406"></a>00406       e = ind_Fluctu_Term()==1 ? Dist_norm_bord_externe_(face) :
<a name="l00407"></a>00407           equivalent_distance(boundary_index,local_face);
<a name="l00408"></a>00408     }
<a name="l00409"></a>00409   <span class="keywordflow">else</span>
<a name="l00410"></a>00410     {
<a name="l00411"></a>00411       e = DERIVED_T::IS_DEQUIV ? equivalent_distance(boundary_index,local_face) :
<a name="l00412"></a>00412           Dist_norm_bord_externe_(face);
<a name="l00413"></a>00413     }
<a name="l00414"></a>00414 
<a name="l00415"></a>00415   <span class="keywordtype">double</span> flux, heq;
<a name="l00416"></a>00416   <span class="keywordtype">int</span> ori = DERIVED_T::IS_ANISO ? orientation(face) : 0;
<a name="l00417"></a>00417 
<a name="l00418"></a>00418   <span class="comment">// XXX : E. Saikali 08/03/2021</span>
<a name="l00419"></a>00419   <span class="comment">// The test of a zero diffusion was not done before. I think it should be like that</span>
<a name="l00420"></a>00420   <span class="comment">// See always when we use int ori = DERIVED_T::IS_ANISO....</span>
<a name="l00421"></a>00421   <span class="keywordflow">if</span> (n0 != -1)
<a name="l00422"></a>00422     {
<a name="l00423"></a>00423       <span class="comment">// XXX : Attention for DIFT OPERATORS : nu_2 and not nu_1 (only laminar part)</span>
<a name="l00424"></a>00424       <span class="keywordflow">if</span> (nu_2(n0,ori) == 0.0)
<a name="l00425"></a>00425         {
<a name="l00426"></a>00426           heq = h_imp; <span class="comment">// Should be 0 ??</span>
<a name="l00427"></a>00427         }
<a name="l00428"></a>00428       <span class="keywordflow">else</span>
<a name="l00429"></a>00429         {
<a name="l00430"></a>00430           h_total_inv = 1.0/h_imp + e/nu_2(n0,ori);
<a name="l00431"></a>00431           heq = 1.0 / h_total_inv;
<a name="l00432"></a>00432         }
<a name="l00433"></a>00433       flux = heq*(T_ext - inco[n0])*surface(face);
<a name="l00434"></a>00434     }
<a name="l00435"></a>00435   <span class="keywordflow">else</span>
<a name="l00436"></a>00436     {
<a name="l00437"></a>00437       <span class="keywordflow">if</span> (nu_2(n1,ori) == 0.0)
<a name="l00438"></a>00438         {
<a name="l00439"></a>00439           heq = h_imp; <span class="comment">// Should be 0 ??</span>
<a name="l00440"></a>00440         }
<a name="l00441"></a>00441       <span class="keywordflow">else</span>
<a name="l00442"></a>00442         {
<a name="l00443"></a>00443           h_total_inv = 1.0/h_imp + e/nu_2(n1,ori);
<a name="l00444"></a>00444           heq = 1.0 / h_total_inv;
<a name="l00445"></a>00445         }
<a name="l00446"></a>00446       flux = heq*(inco[n1] - T_ext)*surface(face);
<a name="l00447"></a>00447     }
<a name="l00448"></a>00448   <span class="keywordflow">return</span> flux;
<a name="l00449"></a>00449 }
<a name="l00450"></a>00450 
<a name="l00451"></a>00451 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00452"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a32cab900f0d3b48b41fe368e6fdcc3b9">00452</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> boundary_index, <span class="keywordtype">int</span> face, <span class="keywordtype">int</span> local_face, <span class="keywordtype">int</span> num1,
<a name="l00453"></a>00453                                                        <span class="keyword">const</span> <a class="code" href="classEchange__externe__impose.html" title="Classe Echange_externe_impose: Cette classe represente le cas particulier de la classe Echange_impose...">Echange_externe_impose</a>&amp; la_cl,
<a name="l00454"></a>00454                                                        <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj)<span class="keyword"> const</span>
<a name="l00455"></a>00455 <span class="keyword"></span>{
<a name="l00456"></a>00456   <span class="comment">// C.L de type Echange_externe_impose : 1/h_total = (1/h_imp) + (e/diffusivite)</span>
<a name="l00457"></a>00457   <span class="comment">// La C.L fournit h_imp ; il faut calculer e/diffusivite</span>
<a name="l00458"></a>00458 
<a name="l00459"></a>00459   <span class="keywordtype">double</span> h_total_inv;
<a name="l00460"></a>00460   <span class="keywordtype">double</span> h_imp = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1);
<a name="l00461"></a>00461   <span class="keywordtype">double</span> e;
<a name="l00462"></a>00462   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l00463"></a>00463   <span class="comment">//  int j = elem(face,1);</span>
<a name="l00464"></a>00464 
<a name="l00465"></a>00465   <span class="keywordflow">if</span> (DERIVED_T::IS_MODIF_DEQ)
<a name="l00466"></a>00466     {
<a name="l00467"></a>00467       e = ind_Fluctu_Term()==1 ? Dist_norm_bord_externe_(face) :
<a name="l00468"></a>00468           equivalent_distance(boundary_index,local_face);
<a name="l00469"></a>00469     }
<a name="l00470"></a>00470   <span class="keywordflow">else</span>
<a name="l00471"></a>00471     {
<a name="l00472"></a>00472       e = DERIVED_T::IS_DEQUIV ? equivalent_distance(boundary_index,local_face) :
<a name="l00473"></a>00473           Dist_norm_bord_externe_(face);
<a name="l00474"></a>00474     }
<a name="l00475"></a>00475 
<a name="l00476"></a>00476   <span class="keywordtype">int</span> ori = DERIVED_T::IS_ANISO ? orientation(face) : 0;
<a name="l00477"></a>00477   <span class="keywordtype">double</span> heq;
<a name="l00478"></a>00478 
<a name="l00479"></a>00479   <span class="keywordflow">if</span> (i != -1)
<a name="l00480"></a>00480     {
<a name="l00481"></a>00481       <span class="keywordflow">if</span> (nu_2(i,ori) == 0.0)
<a name="l00482"></a>00482         {
<a name="l00483"></a>00483           heq = h_imp; <span class="comment">// Should be 0 ??</span>
<a name="l00484"></a>00484         }
<a name="l00485"></a>00485       <span class="keywordflow">else</span>
<a name="l00486"></a>00486         {
<a name="l00487"></a>00487           h_total_inv =  1.0/h_imp + e/nu_2(i,ori);
<a name="l00488"></a>00488           heq = 1.0 / h_total_inv;
<a name="l00489"></a>00489         }
<a name="l00490"></a>00490 
<a name="l00491"></a>00491       aii = heq*surface(face);
<a name="l00492"></a>00492       ajj = 0;
<a name="l00493"></a>00493     }
<a name="l00494"></a>00494   <span class="keywordflow">else</span>
<a name="l00495"></a>00495     {
<a name="l00496"></a>00496       <span class="keywordflow">if</span> (nu_2(elem_(face,1),ori) == 0.0)
<a name="l00497"></a>00497         {
<a name="l00498"></a>00498           heq = h_imp; <span class="comment">// Should be 0 ??</span>
<a name="l00499"></a>00499         }
<a name="l00500"></a>00500       <span class="keywordflow">else</span>
<a name="l00501"></a>00501         {
<a name="l00502"></a>00502           h_total_inv =  1.0/h_imp + e/nu_2(elem_(face,1),ori);
<a name="l00503"></a>00503           heq = 1.0 / h_total_inv;
<a name="l00504"></a>00504         }
<a name="l00505"></a>00505 
<a name="l00506"></a>00506       ajj = heq*surface(face);
<a name="l00507"></a>00507       aii = 0;
<a name="l00508"></a>00508     }
<a name="l00509"></a>00509 }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00512"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a8b8cf6d4ca3261974a4dd39bad154370">00512</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::secmem_face</a>(<span class="keywordtype">int</span> boundary_index,<span class="keywordtype">int</span> face,<span class="keywordtype">int</span> local_face,
<a name="l00513"></a>00513                                                          <span class="keyword">const</span> <a class="code" href="classEchange__externe__impose.html" title="Classe Echange_externe_impose: Cette classe represente le cas particulier de la classe Echange_impose...">Echange_externe_impose</a>&amp; la_cl,
<a name="l00514"></a>00514                                                          <span class="keywordtype">int</span> num1)<span class="keyword"> const</span>
<a name="l00515"></a>00515 <span class="keyword"></span>{
<a name="l00516"></a>00516   <span class="comment">// C.L de type Echange_externe_impose : 1/h_total = (1/h_imp) + (e/diffusivite)</span>
<a name="l00517"></a>00517   <span class="comment">// La C.L fournit h_imp ; il faut calculer e/diffusivite</span>
<a name="l00518"></a>00518 
<a name="l00519"></a>00519   <span class="keywordtype">double</span> h_total_inv;
<a name="l00520"></a>00520   <span class="keywordtype">double</span> h_imp = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1);
<a name="l00521"></a>00521   <span class="keywordtype">double</span> T_ext = la_cl.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-num1);
<a name="l00522"></a>00522   <span class="keywordtype">double</span> e;
<a name="l00523"></a>00523   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l00524"></a>00524   <span class="comment">//  int j = elem(face,1);</span>
<a name="l00525"></a>00525 
<a name="l00526"></a>00526   <span class="keywordflow">if</span> (DERIVED_T::IS_MODIF_DEQ)
<a name="l00527"></a>00527     {
<a name="l00528"></a>00528       e = ind_Fluctu_Term()==1 ? Dist_norm_bord_externe_(face) :
<a name="l00529"></a>00529           equivalent_distance(boundary_index,local_face);
<a name="l00530"></a>00530     }
<a name="l00531"></a>00531   <span class="keywordflow">else</span>
<a name="l00532"></a>00532     {
<a name="l00533"></a>00533       e = DERIVED_T::IS_DEQUIV ? equivalent_distance(boundary_index,local_face) :
<a name="l00534"></a>00534           Dist_norm_bord_externe_(face);
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536 
<a name="l00537"></a>00537   <span class="keywordtype">double</span> flux, heq;
<a name="l00538"></a>00538   <span class="keywordtype">int</span> ori = DERIVED_T::IS_ANISO ? orientation(face) : 0;
<a name="l00539"></a>00539 
<a name="l00540"></a>00540   <span class="keywordflow">if</span> (i != -1)
<a name="l00541"></a>00541     {
<a name="l00542"></a>00542       <span class="keywordflow">if</span> (nu_2(i,ori) == 0.0)
<a name="l00543"></a>00543         {
<a name="l00544"></a>00544           heq = h_imp; <span class="comment">// Should be 0 ??</span>
<a name="l00545"></a>00545         }
<a name="l00546"></a>00546       <span class="keywordflow">else</span>
<a name="l00547"></a>00547         {
<a name="l00548"></a>00548           h_total_inv = 1.0/h_imp + e/nu_2(i,ori);
<a name="l00549"></a>00549           heq = 1.0 / h_total_inv;
<a name="l00550"></a>00550         }
<a name="l00551"></a>00551 
<a name="l00552"></a>00552       flux = heq*T_ext*surface(face);
<a name="l00553"></a>00553     }
<a name="l00554"></a>00554   <span class="keywordflow">else</span>
<a name="l00555"></a>00555     {
<a name="l00556"></a>00556       <span class="keywordflow">if</span> (nu_2(elem_(face,1),ori) == 0.0)
<a name="l00557"></a>00557         {
<a name="l00558"></a>00558           heq = h_imp; <span class="comment">// Should be 0 ??</span>
<a name="l00559"></a>00559         }
<a name="l00560"></a>00560       <span class="keywordflow">else</span>
<a name="l00561"></a>00561         {
<a name="l00562"></a>00562           h_total_inv = 1.0/h_imp + e/nu_2(elem_(face,1),ori);
<a name="l00563"></a>00563           heq = 1.0 / h_total_inv;
<a name="l00564"></a>00564         }
<a name="l00565"></a>00565 
<a name="l00566"></a>00566       flux = - heq*T_ext*surface(face);
<a name="l00567"></a>00567     }
<a name="l00568"></a>00568   <span class="keywordflow">return</span> flux;
<a name="l00569"></a>00569 }
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 <span class="comment">/* Function templates specialization for BC Echange_global_impose */</span>
<a name="l00572"></a>00572 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00573"></a><a class="code" href="classEval__Diff__VDF__Elem.html#aeea0c971c366bfcce5f4271c581c3bb7">00573</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <span class="keywordtype">int</span> face ,
<a name="l00574"></a>00574                                                        <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp; la_cl, <span class="keywordtype">int</span> num1)<span class="keyword"> const</span>
<a name="l00575"></a>00575 <span class="keyword"></span>{
<a name="l00576"></a>00576   <span class="keywordtype">double</span> h = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1);
<a name="l00577"></a>00577   <span class="keywordtype">double</span> T_ext = la_cl.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-num1);
<a name="l00578"></a>00578   <span class="keywordtype">int</span> n0 = elem_(face,0);
<a name="l00579"></a>00579   <span class="keywordtype">int</span> n1 = elem_(face,1);
<a name="l00580"></a>00580   <span class="keywordtype">double</span> flux;
<a name="l00581"></a>00581   <span class="keywordflow">if</span> (n0 != -1)
<a name="l00582"></a>00582     flux = h*(T_ext - inco[n0])*surface(face);
<a name="l00583"></a>00583   <span class="keywordflow">else</span>
<a name="l00584"></a>00584     flux = h*(inco[n1] - T_ext)*surface(face);
<a name="l00585"></a>00585   <span class="keywordflow">return</span> flux;
<a name="l00586"></a>00586 }
<a name="l00587"></a>00587 
<a name="l00588"></a>00588 <span class="comment">/* Function templates specialization for BC Echange_global_impose */</span>
<a name="l00589"></a>00589 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00590"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a2b3cfeb039de029e06575a095f701602">00590</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> face, <span class="keywordtype">int</span> num1,
<a name="l00591"></a>00591                                                        <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp; la_cl,
<a name="l00592"></a>00592                                                        <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj)<span class="keyword"> const</span>
<a name="l00593"></a>00593 <span class="keyword"></span>{
<a name="l00594"></a>00594   <span class="keywordtype">double</span> h = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1);
<a name="l00595"></a>00595   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l00596"></a>00596   <span class="comment">//  int j = elem(face,1);</span>
<a name="l00597"></a>00597   <span class="keywordflow">if</span> (i!= -1)
<a name="l00598"></a>00598     {
<a name="l00599"></a>00599       aii = h*surface(face);
<a name="l00600"></a>00600       ajj = 0;
<a name="l00601"></a>00601     }
<a name="l00602"></a>00602   <span class="keywordflow">else</span>
<a name="l00603"></a>00603     {
<a name="l00604"></a>00604       ajj = h*surface(face);
<a name="l00605"></a>00605       aii = 0;
<a name="l00606"></a>00606     }
<a name="l00607"></a>00607 }
<a name="l00608"></a>00608 
<a name="l00609"></a>00609 <span class="comment">/* Function templates specialization for BC Echange_global_impose */</span>
<a name="l00610"></a>00610 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00611"></a><a class="code" href="classEval__Diff__VDF__Elem.html#abb46861569fe49457bf8ccb741f1c8f5">00611</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::secmem_face</a>(<span class="keywordtype">int</span> face, <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp; la_cl,
<a name="l00612"></a>00612                                                          <span class="keywordtype">int</span> num1)<span class="keyword"> const</span>
<a name="l00613"></a>00613 <span class="keyword"></span>{
<a name="l00614"></a>00614   <span class="keywordtype">double</span> h = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1);
<a name="l00615"></a>00615   <span class="keywordtype">double</span> T_ext = la_cl.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-num1);
<a name="l00616"></a>00616   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l00617"></a>00617   <span class="comment">//  int j = elem(face,1);</span>
<a name="l00618"></a>00618   <span class="keywordtype">double</span> flux;
<a name="l00619"></a>00619   <span class="keywordflow">if</span> (i != -1)
<a name="l00620"></a>00620     flux = h*T_ext*surface(face);
<a name="l00621"></a>00621   <span class="keywordflow">else</span>
<a name="l00622"></a>00622     flux = -h*T_ext*surface(face);
<a name="l00623"></a>00623   <span class="keywordflow">return</span> flux;
<a name="l00624"></a>00624 }
<a name="l00625"></a>00625 
<a name="l00626"></a>00626 <span class="comment">/* Function templates specialization for BC Neumann_paroi */</span>
<a name="l00627"></a>00627 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00628"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a30fad0b00ba259e5bfd002360591c6d7">00628</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> face,
<a name="l00629"></a>00629                                                        <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp; la_cl,
<a name="l00630"></a>00630                                                        <span class="keywordtype">int</span> num1)<span class="keyword"> const</span>
<a name="l00631"></a>00631 <span class="keyword"></span>{
<a name="l00632"></a>00632   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l00633"></a>00633   <span class="comment">//  int j = elem(face,1);</span>
<a name="l00634"></a>00634   <span class="keywordtype">double</span> flux;
<a name="l00635"></a>00635   <span class="keywordflow">if</span> (i != -1)
<a name="l00636"></a>00636     flux = la_cl.<a class="code" href="classNeumann__paroi.html#a76b977c608b621e7dd7106401ab44936" title="Renvoie la valeur du flux impose sur la i-eme composante du champ representant le flux a la frontiere...">flux_impose</a>(face-num1)*surface(face);
<a name="l00637"></a>00637   <span class="keywordflow">else</span>
<a name="l00638"></a>00638     flux = -la_cl.<a class="code" href="classNeumann__paroi.html#a76b977c608b621e7dd7106401ab44936" title="Renvoie la valeur du flux impose sur la i-eme composante du champ representant le flux a la frontiere...">flux_impose</a>(face-num1)*surface(face);
<a name="l00639"></a>00639 
<a name="l00640"></a>00640   <span class="keywordflow">return</span> flux;
<a name="l00641"></a>00641 }
<a name="l00642"></a>00642 
<a name="l00643"></a>00643 <span class="comment">/* Function templates specialization for BC Neumann_paroi */</span>
<a name="l00644"></a>00644 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00645"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a4460b892580558b2ba207894590359a5">00645</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> , <span class="keywordtype">int</span>,
<a name="l00646"></a>00646                                                        <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp; ,
<a name="l00647"></a>00647                                                        <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj)<span class="keyword"> const</span>
<a name="l00648"></a>00648 <span class="keyword"></span>{
<a name="l00649"></a>00649   aii = ajj = 0;
<a name="l00650"></a>00650 }
<a name="l00651"></a>00651 
<a name="l00652"></a>00652 <span class="comment">/* Function templates specialization for BC Neumann_paroi */</span>
<a name="l00653"></a>00653 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00654"></a><a class="code" href="classEval__Diff__VDF__Elem.html#aa69c80f7f8313e4cc29098f915db1b40">00654</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::secmem_face</a>(<span class="keywordtype">int</span> face, <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp; la_cl,
<a name="l00655"></a>00655                                                          <span class="keywordtype">int</span> num1)<span class="keyword"> const</span>
<a name="l00656"></a>00656 <span class="keyword"></span>{
<a name="l00657"></a>00657   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l00658"></a>00658   <span class="comment">//  int j = elem(face,1);</span>
<a name="l00659"></a>00659   <span class="keywordtype">double</span> flux;
<a name="l00660"></a>00660   <span class="keywordflow">if</span> (i != -1)
<a name="l00661"></a>00661     flux = la_cl.<a class="code" href="classNeumann__paroi.html#a76b977c608b621e7dd7106401ab44936" title="Renvoie la valeur du flux impose sur la i-eme composante du champ representant le flux a la frontiere...">flux_impose</a>(face-num1)*surface(face);
<a name="l00662"></a>00662   <span class="keywordflow">else</span>
<a name="l00663"></a>00663     flux = -la_cl.<a class="code" href="classNeumann__paroi.html#a76b977c608b621e7dd7106401ab44936" title="Renvoie la valeur du flux impose sur la i-eme composante du champ representant le flux a la frontiere...">flux_impose</a>(face-num1)*surface(face);
<a name="l00664"></a>00664 
<a name="l00665"></a>00665   <span class="keywordflow">return</span> flux;
<a name="l00666"></a>00666 }
<a name="l00667"></a>00667 
<a name="l00668"></a>00668 <span class="comment">/* Function templates specialization for BC Periodique */</span>
<a name="l00669"></a>00669 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00670"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a6c22a9fc93d1b72e3df7b2e08b71b507">00670</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <span class="keywordtype">int</span> face,
<a name="l00671"></a>00671                                                        <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl, <span class="keywordtype">int</span> )<span class="keyword"> const</span>
<a name="l00672"></a>00672 <span class="keyword"></span>{
<a name="l00673"></a>00673   <span class="keywordtype">double</span> flux;
<a name="l00674"></a>00674   <span class="keywordtype">int</span> n0 = elem_(face,0);
<a name="l00675"></a>00675   <span class="keywordtype">int</span> n1 = elem_(face,1);
<a name="l00676"></a>00676   <span class="keywordtype">double</span> d0 = la_zone-&gt;dist_face_elem0_period(face,n0,la_cl.<a class="code" href="classPeriodique.html#afb2788bd749c66ae0df1235042115e57">distance</a>());
<a name="l00677"></a>00677   <span class="keywordtype">double</span> d1 = la_zone-&gt;dist_face_elem1_period(face,n1,la_cl.<a class="code" href="classPeriodique.html#afb2788bd749c66ae0df1235042115e57">distance</a>());
<a name="l00678"></a>00678   <span class="keywordtype">double</span> heq;
<a name="l00679"></a>00679 
<a name="l00680"></a>00680   <span class="keywordtype">int</span> ori = DERIVED_T::IS_ANISO ? orientation(face) : 0;
<a name="l00681"></a>00681   heq = compute_heq(d0,n0,d1,n1,ori);
<a name="l00682"></a>00682   flux = heq*(inco[n1] - inco[n0])*surface(face)*porosite(face);
<a name="l00683"></a>00683   <span class="keywordflow">return</span> flux;
<a name="l00684"></a>00684 }
<a name="l00685"></a>00685 
<a name="l00686"></a>00686 <span class="comment">/* Function templates specialization for BC Periodique */</span>
<a name="l00687"></a>00687 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00688"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a8c64764ff8ac6bbd88e92f59da32150d">00688</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> face,<span class="keywordtype">int</span>,
<a name="l00689"></a>00689                                                        <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl,
<a name="l00690"></a>00690                                                        <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj)<span class="keyword"> const</span>
<a name="l00691"></a>00691 <span class="keyword"></span>{
<a name="l00692"></a>00692   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l00693"></a>00693   <span class="keywordtype">int</span> j = elem_(face,1);
<a name="l00694"></a>00694   <span class="keywordtype">double</span> d0 = la_zone-&gt;dist_face_elem0_period(face,i,la_cl.<a class="code" href="classPeriodique.html#afb2788bd749c66ae0df1235042115e57">distance</a>());
<a name="l00695"></a>00695   <span class="keywordtype">double</span> d1 = la_zone-&gt;dist_face_elem1_period(face,j,la_cl.<a class="code" href="classPeriodique.html#afb2788bd749c66ae0df1235042115e57">distance</a>());
<a name="l00696"></a>00696   <span class="keywordtype">double</span> heq;
<a name="l00697"></a>00697 
<a name="l00698"></a>00698   <span class="keywordtype">int</span> ori = DERIVED_T::IS_ANISO ? orientation(face) : 0;
<a name="l00699"></a>00699   heq=  compute_heq(d0,i,d1,j,ori);
<a name="l00700"></a>00700   aii = ajj = heq*surface(face)*porosite(face);
<a name="l00701"></a>00701 }
<a name="l00702"></a>00702 
<a name="l00703"></a>00703 <span class="comment">/* Function templates specialization for BC NSCBC */</span>
<a name="l00704"></a>00704 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00705"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a21b9447f7dfbd134eae836754c1468de">00705</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco , <span class="keywordtype">int</span> faceD ,
<a name="l00706"></a>00706                                                        <span class="keyword">const</span> <a class="code" href="classNSCBC.html" title="classe">NSCBC</a>&amp; la_cl , <span class="keywordtype">int</span> ndeb )<span class="keyword"> const</span>
<a name="l00707"></a>00707 <span class="keyword"></span>{
<a name="l00708"></a>00708   <span class="comment">// On evalue le flux au bord a partir des premieres mailles internes</span>
<a name="l00709"></a>00709   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf = la_zone;
<a name="l00710"></a>00710   <span class="keywordtype">int</span> oriD = zvdf.<a class="code" href="classZone__VDF.html#a9a9bd747218e463b3408a3590c12814c" title="inline DoubleVect&amp; Zone_VDF::porosite_face() { return porosite_face_; }">orientation</a>(faceD);
<a name="l00711"></a>00711   <span class="keywordtype">int</span> faceC;
<a name="l00712"></a>00712   <span class="keywordtype">int</span> elem3;
<a name="l00713"></a>00713 
<a name="l00714"></a>00714   <span class="keywordtype">int</span> elem0 = zvdf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(faceD,0);
<a name="l00715"></a>00715   <span class="comment">//double signe = -1.;</span>
<a name="l00716"></a>00716   <span class="keywordflow">if</span> (elem0 == -1)
<a name="l00717"></a>00717     {
<a name="l00718"></a>00718       elem0 = zvdf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(faceD,1);
<a name="l00719"></a>00719       faceC = zvdf.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>(elem0,oriD+dimension);
<a name="l00720"></a>00720       elem3 = zvdf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(faceC,1);
<a name="l00721"></a>00721       <span class="comment">//  signe = 1.;</span>
<a name="l00722"></a>00722     }
<a name="l00723"></a>00723   <span class="keywordflow">else</span>
<a name="l00724"></a>00724     {
<a name="l00725"></a>00725       faceC = zvdf.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>(elem0,oriD);
<a name="l00726"></a>00726       elem3 = zvdf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(faceC,0);
<a name="l00727"></a>00727     }
<a name="l00728"></a>00728 
<a name="l00729"></a>00729   assert(faceC != faceD);
<a name="l00730"></a>00730   assert(elem3 != elem0);
<a name="l00731"></a>00731 
<a name="l00732"></a>00732   <span class="keywordtype">double</span> d0 = zvdf.<a class="code" href="classZone__VF.html#a87a29f0223c71256a25ee343c9277599">xp</a>(elem0,orientation(faceD)) - zvdf.<a class="code" href="classZone__VF.html#a87a29f0223c71256a25ee343c9277599">xp</a>(elem3,orientation(faceD));
<a name="l00733"></a>00733   <span class="keywordtype">double</span> heq;
<a name="l00734"></a>00734 
<a name="l00735"></a>00735   <span class="keywordtype">int</span> ori = DERIVED_T::IS_ANISO ? oriD : 0;
<a name="l00736"></a>00736   heq = (nu_1(elem0,ori)/d0);
<a name="l00737"></a>00737   <span class="keywordtype">double</span> flux = heq*(inco(elem0) - inco(elem3))*surface(faceD)*porosite(faceD);
<a name="l00738"></a>00738   <span class="keywordflow">return</span> flux;
<a name="l00739"></a>00739 }
<a name="l00740"></a>00740 
<a name="l00741"></a>00741 <span class="comment">/* Function templates specialization for BC NSCBC */</span>
<a name="l00742"></a>00742 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00743"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ad7f37005479c73dfb88c844b2daedb10">00743</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> face, <span class="keywordtype">int</span> num1,<span class="keyword">const</span> <a class="code" href="classNSCBC.html" title="classe">NSCBC</a>&amp; la_cl,
<a name="l00744"></a>00744                                                        <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj)<span class="keyword"> const</span>
<a name="l00745"></a>00745 <span class="keyword"></span>{
<a name="l00746"></a>00746   <span class="comment">/*  Cerr&lt;&lt;&quot;Eval_Diff_VDF_var_Elem::coeffs_face n&#39;est pas codee&quot;&lt;&lt;finl;</span>
<a name="l00747"></a>00747 <span class="comment">      Cerr&lt;&lt;&quot;pour la condition NSCBC&quot;&lt;&lt;finl;</span>
<a name="l00748"></a>00748 <span class="comment">      exit();*/</span>
<a name="l00749"></a>00749   aii = ajj = 0.;
<a name="l00750"></a>00750 }
<a name="l00751"></a>00751 
<a name="l00752"></a>00752 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00753"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ac8c3b12b3ee5e0a51b665198557216e6">00753</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ac8c3b12b3ee5e0a51b665198557216e6">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_faces_interne</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <span class="keywordtype">int</span> face)<span class="keyword"> const</span>
<a name="l00754"></a>00754 <span class="keyword"></span>{
<a name="l00755"></a>00755   <span class="keywordtype">double</span> flux,heq;
<a name="l00756"></a>00756   <span class="keywordtype">int</span> n0 = elem_(face,0);
<a name="l00757"></a>00757   <span class="keywordtype">int</span> n1 = elem_(face,1);
<a name="l00758"></a>00758   <span class="keywordtype">double</span> d0 = Dist_face_elem0(face,n0);
<a name="l00759"></a>00759   <span class="keywordtype">double</span> d1 = Dist_face_elem1(face,n1);
<a name="l00760"></a>00760   <span class="keywordtype">int</span> ori = DERIVED_T::IS_ANISO ? orientation(face) : 0;
<a name="l00761"></a>00761 
<a name="l00762"></a>00762   <span class="keywordflow">if</span> (nu_1(n0,ori)==0.0 &amp;&amp; nu_1(n1,ori)==0.0)
<a name="l00763"></a>00763     {
<a name="l00764"></a>00764       heq = 0.;
<a name="l00765"></a>00765     }
<a name="l00766"></a>00766   <span class="keywordflow">else</span>
<a name="l00767"></a>00767     {
<a name="l00768"></a>00768       assert(nu_1(n0,ori)!=0.0);
<a name="l00769"></a>00769       assert(nu_1(n1,ori)!=0.0);
<a name="l00770"></a>00770       heq = compute_heq(d0,n0,d1,n1,ori);
<a name="l00771"></a>00771     }
<a name="l00772"></a>00772   flux = heq*(inco[n1] - inco[n0])*surface(face)*porosite(face);
<a name="l00773"></a>00773   <span class="keywordflow">return</span> flux;
<a name="l00774"></a>00774 }
<a name="l00775"></a>00775 
<a name="l00776"></a>00776 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00777"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a5278e8a178e3b11b1f94f92f04b23ee7">00777</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a5278e8a178e3b11b1f94f92f04b23ee7">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_faces_interne</a>(<span class="keywordtype">int</span> face, <span class="keywordtype">double</span>&amp; aii, <span class="keywordtype">double</span>&amp; ajj)<span class="keyword"> const</span>
<a name="l00778"></a>00778 <span class="keyword"></span>{
<a name="l00779"></a>00779   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l00780"></a>00780   <span class="keywordtype">int</span> j = elem_(face,1);
<a name="l00781"></a>00781   <span class="keywordtype">double</span> d0 = Dist_face_elem0(face,i);
<a name="l00782"></a>00782   <span class="keywordtype">double</span> d1 = Dist_face_elem1(face,j);
<a name="l00783"></a>00783   <span class="keywordtype">double</span> heq;
<a name="l00784"></a>00784   <span class="keywordtype">int</span> ori = DERIVED_T::IS_ANISO ? orientation(face) : 0;
<a name="l00785"></a>00785 
<a name="l00786"></a>00786   <span class="keywordflow">if</span> (nu_1(i,ori)==0.0 &amp;&amp; nu_2(j,ori)==0.0)
<a name="l00787"></a>00787     {
<a name="l00788"></a>00788       heq = 0.;
<a name="l00789"></a>00789     }
<a name="l00790"></a>00790   <span class="keywordflow">else</span>
<a name="l00791"></a>00791     {
<a name="l00792"></a>00792       assert(nu_1(i,ori)!=0.0);
<a name="l00793"></a>00793       assert(nu_2(j,ori)!=0.0);
<a name="l00794"></a>00794       heq = compute_heq(d0,i,d1,j,ori);
<a name="l00795"></a>00795     }
<a name="l00796"></a>00796   aii = ajj = heq*surface(face)*porosite(face);
<a name="l00797"></a>00797 }
<a name="l00798"></a>00798 
<a name="l00799"></a>00799 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00800"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ac36170f82f963777f60abc011d4752d9">00800</a> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ac36170f82f963777f60abc011d4752d9">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::secmem_faces_interne</a>( <span class="keywordtype">int</span> )<span class="keyword"> const</span>
<a name="l00801"></a>00801 <span class="keyword"></span>{
<a name="l00802"></a>00802   <span class="keywordflow">return</span> 0;
<a name="l00803"></a>00803 }
<a name="l00804"></a>00804 
<a name="l00805"></a>00805 <span class="comment">//************************</span>
<a name="l00806"></a>00806 <span class="comment">// CAS VECTORIEL</span>
<a name="l00807"></a>00807 <span class="comment">//************************</span>
<a name="l00808"></a>00808 
<a name="l00809"></a>00809 <span class="comment">// Fonctions de calcul des flux pour une grandeur vectorielle</span>
<a name="l00810"></a>00810 <span class="comment"></span>
<a name="l00811"></a>00811 <span class="comment">//// flux_face avec Dirichlet_entree_fluide</span>
<a name="l00812"></a>00812 <span class="comment"></span><span class="comment">//</span>
<a name="l00813"></a>00813 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00814"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a286f233c9cc83eb5b700b9279f6fb5e9">00814</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <span class="keywordtype">int</span> face,
<a name="l00815"></a>00815                                                      <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp; la_cl,
<a name="l00816"></a>00816                                                      <span class="keywordtype">int</span> num1,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux)<span class="keyword"> const</span>
<a name="l00817"></a>00817 <span class="keyword"></span>{
<a name="l00818"></a>00818   <span class="keywordtype">int</span> n0 = elem_(face,0);
<a name="l00819"></a>00819   <span class="keywordtype">int</span> n1 = elem_(face,1);
<a name="l00820"></a>00820   <span class="keywordtype">int</span> k;
<a name="l00821"></a>00821   <span class="keywordtype">double</span> dist = Dist_norm_bord(face);
<a name="l00822"></a>00822   <span class="keywordflow">if</span> (n0 != -1)
<a name="l00823"></a>00823     {
<a name="l00824"></a>00824       <span class="keywordflow">if</span> (DERIVED_T::IS_QUASI)
<a name="l00825"></a>00825         {
<a name="l00826"></a>00826           <span class="comment">//TODO : implement when Diff_K_Eps_QC is templatized</span>
<a name="l00827"></a>00827           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Diff_K_Eps_QC are not templatized yet !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00828"></a>00828           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00829"></a>00829           <span class="comment">//        for (k=0; k&lt;flux.size(); k++)</span>
<a name="l00830"></a>00830           <span class="comment">//          flux(k) = (la_cl.val_imp(face-num1,k)-inco(n0,k))/dv_mvol(n0)</span>
<a name="l00831"></a>00831           <span class="comment">//                    *surface(face)*porosite(face)*nu_1(n0,k)/dist;</span>
<a name="l00832"></a>00832         }
<a name="l00833"></a>00833       <span class="keywordflow">else</span>
<a name="l00834"></a>00834         {
<a name="l00835"></a>00835           <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l00836"></a>00836             flux(k) = (la_cl.<a class="code" href="classDirichlet.html#ab59a2214e3208ac45048a2232c132803" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps par defaut du cham...">val_imp</a>(face-num1,k)-inco(n0,k))
<a name="l00837"></a>00837                       *surface(face)*porosite(face)*nu_1(n0,k)/dist;
<a name="l00838"></a>00838         }
<a name="l00839"></a>00839     }
<a name="l00840"></a>00840   <span class="keywordflow">else</span>  <span class="comment">// n1 != -1</span>
<a name="l00841"></a>00841     {
<a name="l00842"></a>00842       <span class="keywordflow">if</span> (DERIVED_T::IS_QUASI)
<a name="l00843"></a>00843         {
<a name="l00844"></a>00844           <span class="comment">//TODO : implement when Diff_K_Eps_QC is templatized</span>
<a name="l00845"></a>00845           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Diff_K_Eps_QC are not templatized yet !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00846"></a>00846           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00847"></a>00847           <span class="comment">//        for (k=0; k&lt;flux.size(); k++)</span>
<a name="l00848"></a>00848           <span class="comment">//          flux(k) = (inco(n1,k)-la_cl.val_imp(face-num1,k))/dv_mvol(n1)</span>
<a name="l00849"></a>00849           <span class="comment">//                    *surface(face)*porosite(face)*nu_1(n1,k)/dist;</span>
<a name="l00850"></a>00850         }
<a name="l00851"></a>00851       <span class="keywordflow">else</span>
<a name="l00852"></a>00852         {
<a name="l00853"></a>00853           <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l00854"></a>00854             flux(k) = (inco(n1,k)-la_cl.<a class="code" href="classDirichlet.html#ab59a2214e3208ac45048a2232c132803" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps par defaut du cham...">val_imp</a>(face-num1,k))
<a name="l00855"></a>00855                       *surface(face)*porosite(face)*nu_1(n1,k)/dist;
<a name="l00856"></a>00856         }
<a name="l00857"></a>00857     }
<a name="l00858"></a>00858 }
<a name="l00859"></a>00859 <span class="comment"></span>
<a name="l00860"></a>00860 <span class="comment">//// coeffs_face avec Dirichlet_entree_fluide</span>
<a name="l00861"></a>00861 <span class="comment"></span><span class="comment">//</span>
<a name="l00862"></a>00862 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00863"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a8f8f7d851cb8e702108c80d30072b23d">00863</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> face,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp; la_cl,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj)<span class="keyword"> const</span>
<a name="l00864"></a>00864 <span class="keyword"></span>{
<a name="l00865"></a>00865   <span class="keywordtype">int</span> k;
<a name="l00866"></a>00866   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l00867"></a>00867   <span class="comment">// int j = elem(face,1);</span>
<a name="l00868"></a>00868   <span class="keywordtype">double</span> dist = Dist_norm_bord(face);
<a name="l00869"></a>00869 
<a name="l00870"></a>00870   <span class="keywordflow">if</span> (i != -1)
<a name="l00871"></a>00871     {
<a name="l00872"></a>00872       <span class="keywordflow">for</span> (k=0; k&lt;aii.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l00873"></a>00873         aii(k) = surface(face)*porosite(face)*nu_1(i,k)/dist;
<a name="l00874"></a>00874       <span class="keywordflow">for</span> (k=0; k&lt;ajj.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l00875"></a>00875         ajj(k) = 0;
<a name="l00876"></a>00876     }
<a name="l00877"></a>00877   <span class="keywordflow">else</span>  <span class="comment">// j != -1</span>
<a name="l00878"></a>00878     {
<a name="l00879"></a>00879       <span class="keywordflow">for</span> (k=0; k&lt;ajj.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l00880"></a>00880         ajj(k) = surface(face)*(porosite(face)*nu_1(elem_(face,1),k))/dist;
<a name="l00881"></a>00881       <span class="keywordflow">for</span> (k=0; k&lt;aii.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l00882"></a>00882         aii(k) = 0;
<a name="l00883"></a>00883     }
<a name="l00884"></a>00884 }
<a name="l00885"></a>00885 <span class="comment"></span>
<a name="l00886"></a>00886 <span class="comment">//// secmem_face avec Dirichlet_entree_fluide</span>
<a name="l00887"></a>00887 <span class="comment"></span><span class="comment">//</span>
<a name="l00888"></a>00888 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00889"></a><a class="code" href="classEval__Diff__VDF__Elem.html#aea018fac8ef8f12be17ac5e7573c9ebf">00889</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::secmem_face</a>(<span class="keywordtype">int</span> face, <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp; la_cl,  <span class="keywordtype">int</span> num1,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux)<span class="keyword"> const</span>
<a name="l00890"></a>00890 <span class="keyword"></span>{
<a name="l00891"></a>00891   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l00892"></a>00892   <span class="comment">//  int j = elem(face,1);</span>
<a name="l00893"></a>00893   <span class="keywordtype">int</span> k;
<a name="l00894"></a>00894   <span class="keywordtype">double</span> dist = Dist_norm_bord(face);
<a name="l00895"></a>00895 
<a name="l00896"></a>00896   <span class="keywordflow">if</span> (i != -1)
<a name="l00897"></a>00897     <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l00898"></a>00898       flux(k) = la_cl.<a class="code" href="classDirichlet.html#ab59a2214e3208ac45048a2232c132803" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps par defaut du cham...">val_imp</a>(face-num1,k)
<a name="l00899"></a>00899                 *surface(face)*porosite(face)*nu_1(i,k)/dist;
<a name="l00900"></a>00900 
<a name="l00901"></a>00901   <span class="keywordflow">else</span> <span class="comment">// j != -1</span>
<a name="l00902"></a>00902     <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l00903"></a>00903       flux(k) = -la_cl.<a class="code" href="classDirichlet.html#ab59a2214e3208ac45048a2232c132803" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps par defaut du cham...">val_imp</a>(face-num1,k)
<a name="l00904"></a>00904                 *surface(face)*(porosite(face)*nu_1(elem_(face,1),k))/dist;
<a name="l00905"></a>00905 }
<a name="l00906"></a>00906 <span class="comment"></span>
<a name="l00907"></a>00907 <span class="comment">//// flux_face avec Dirichlet_paroi_defilante</span>
<a name="l00908"></a>00908 <span class="comment"></span><span class="comment">//</span>
<a name="l00909"></a>00909 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00910"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a9c6ac22a9b10e7cacbe7f2ad921c8dfd">00910</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;, <span class="keywordtype">int</span> ,
<a name="l00911"></a>00911                                                      <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__defilante.html" title="classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes...">Dirichlet_paroi_defilante</a>&amp;,
<a name="l00912"></a>00912                                                      <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp;  )<span class="keyword"> const</span>
<a name="l00913"></a>00913 <span class="keyword"></span>{
<a name="l00914"></a>00914   <span class="comment">// coder dans evbasreyconst comme entree_fluide ????</span>
<a name="l00915"></a>00915   assert(0);
<a name="l00916"></a>00916   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00917"></a>00917 }
<a name="l00918"></a>00918 <span class="comment"></span>
<a name="l00919"></a>00919 <span class="comment">//// coeffs_face avec Dirichlet_paroi_defilante</span>
<a name="l00920"></a>00920 <span class="comment"></span><span class="comment">//</span>
<a name="l00921"></a>00921 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00922"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ab4a71d1e92412eb6faa4e0546c19585c">00922</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> , <span class="keywordtype">int</span>,
<a name="l00923"></a>00923                                                        <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__defilante.html" title="classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes...">Dirichlet_paroi_defilante</a>&amp;,
<a name="l00924"></a>00924                                                        <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp;, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; )<span class="keyword"> const</span>
<a name="l00925"></a>00925 <span class="keyword"></span>{
<a name="l00926"></a>00926   <span class="comment">// coder dans evbasreyconst comme entree_fluide ????</span>
<a name="l00927"></a>00927   assert(0);
<a name="l00928"></a>00928   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00929"></a>00929 }
<a name="l00930"></a>00930 <span class="comment"></span>
<a name="l00931"></a>00931 <span class="comment">//// secmem_face avec Dirichlet_paroi_defilante</span>
<a name="l00932"></a>00932 <span class="comment"></span><span class="comment">//</span>
<a name="l00933"></a>00933 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00934"></a><a class="code" href="classEval__Diff__VDF__Elem.html#aaaf0de5b52548b86aacaaf7c9cc89b78">00934</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::secmem_face</a>(<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__defilante.html" title="classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes...">Dirichlet_paroi_defilante</a>&amp;,
<a name="l00935"></a>00935                                                        <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; )<span class="keyword"> const</span>
<a name="l00936"></a>00936 <span class="keyword"></span>{
<a name="l00937"></a>00937   <span class="comment">// coder dans evbasreyconst comme entree_fluide ????</span>
<a name="l00938"></a>00938   assert(0);
<a name="l00939"></a>00939   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00940"></a>00940 }
<a name="l00941"></a>00941 
<a name="l00942"></a>00942 <span class="comment"></span>
<a name="l00943"></a>00943 <span class="comment">//// flux_face avec Dirichlet_paroi_fixe</span>
<a name="l00944"></a>00944 <span class="comment"></span><span class="comment">//</span>
<a name="l00945"></a>00945 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00946"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a2885653e677bacd25ef69baab51374a4">00946</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <span class="keywordtype">int</span> face,
<a name="l00947"></a>00947                                                      <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__fixe.html" title="classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes...">Dirichlet_paroi_fixe</a>&amp;,
<a name="l00948"></a>00948                                                      <span class="keywordtype">int</span> num1, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux )<span class="keyword"> const</span>
<a name="l00949"></a>00949 <span class="keyword"></span>{
<a name="l00950"></a>00950   <span class="comment">// coder dans evbasreyconst comme entree_fluide ????</span>
<a name="l00951"></a>00951   <span class="comment">//</span>
<a name="l00952"></a>00952   flux=0;;
<a name="l00953"></a>00953   <span class="keywordtype">int</span> n0 = elem_(face,0);
<a name="l00954"></a>00954   <span class="keywordtype">int</span> n1 = elem_(face,1);
<a name="l00955"></a>00955   <span class="keywordtype">int</span> k;
<a name="l00956"></a>00956   <span class="keywordtype">double</span> dist = Dist_norm_bord(face);
<a name="l00957"></a>00957   <span class="keywordflow">if</span> (n0 != -1)
<a name="l00958"></a>00958     {
<a name="l00959"></a>00959       <span class="keywordflow">if</span> (DERIVED_T::IS_QUASI)
<a name="l00960"></a>00960         {
<a name="l00961"></a>00961           <span class="comment">//TODO : implement when Diff_K_Eps_QC is templatized</span>
<a name="l00962"></a>00962           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Diff_K_Eps_QC are not templatized yet !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00963"></a>00963           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00964"></a>00964           <span class="comment">//                for (k=0; k&lt;flux.size(); k++)</span>
<a name="l00965"></a>00965           <span class="comment">//                  flux(k) = (-inco(n0,k))</span>
<a name="l00966"></a>00966           <span class="comment">//                            *surface(face)*porosite(face)*nu_1(n0,k)/dv_mvol(n0)/dist;</span>
<a name="l00967"></a>00967         }
<a name="l00968"></a>00968       <span class="keywordflow">else</span>
<a name="l00969"></a>00969         {
<a name="l00970"></a>00970           <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l00971"></a>00971             flux(k) = (-inco(n0,k))
<a name="l00972"></a>00972                       *surface(face)*porosite(face)*nu_1(n0,k)/dist;
<a name="l00973"></a>00973         }
<a name="l00974"></a>00974     }
<a name="l00975"></a>00975   <span class="keywordflow">else</span>  <span class="comment">// n1 != -1</span>
<a name="l00976"></a>00976     {
<a name="l00977"></a>00977       <span class="keywordflow">if</span> (DERIVED_T::IS_QUASI)
<a name="l00978"></a>00978         {
<a name="l00979"></a>00979           <span class="comment">//TODO : implement when Diff_K_Eps_QC is templatized</span>
<a name="l00980"></a>00980           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Diff_K_Eps_QC are not templatized yet !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00981"></a>00981           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00982"></a>00982           <span class="comment">//                for (k=0; k&lt;flux.size(); k++)</span>
<a name="l00983"></a>00983           <span class="comment">//                  flux(k) = (inco(n1,k))</span>
<a name="l00984"></a>00984           <span class="comment">//                            *surface(face)*porosite(face)*nu_1(n1,k)/dv_mvol(n1)/dist;</span>
<a name="l00985"></a>00985         }
<a name="l00986"></a>00986       <span class="keywordflow">else</span>
<a name="l00987"></a>00987         {
<a name="l00988"></a>00988           <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l00989"></a>00989             flux(k) = (inco(n1,k))
<a name="l00990"></a>00990                       *surface(face)*porosite(face)*nu_1(n1,k)/dist;
<a name="l00991"></a>00991         }
<a name="l00992"></a>00992 
<a name="l00993"></a>00993     }
<a name="l00994"></a>00994 }<span class="comment"></span>
<a name="l00995"></a>00995 <span class="comment">//// coeffs_face avec Dirichlet_paroi_fixe</span>
<a name="l00996"></a>00996 <span class="comment"></span><span class="comment">//</span>
<a name="l00997"></a>00997 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l00998"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a1f60884d7a29e62b3953cbd3f22820d9">00998</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> face,<span class="keywordtype">int</span> num1, <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__fixe.html" title="classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes...">Dirichlet_paroi_fixe</a>&amp;,
<a name="l00999"></a>00999                                                        <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii , <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj)<span class="keyword"> const</span>
<a name="l01000"></a>01000 <span class="keyword"></span>{
<a name="l01001"></a>01001   <span class="keywordtype">int</span> n0 = elem_(face,0);
<a name="l01002"></a>01002   <span class="keywordtype">int</span> n1 = elem_(face,1);
<a name="l01003"></a>01003   <span class="keywordtype">int</span> k;
<a name="l01004"></a>01004   <span class="keywordtype">double</span> dist = Dist_norm_bord(face);
<a name="l01005"></a>01005   <span class="keywordflow">if</span> (n0 != -1)
<a name="l01006"></a>01006     {
<a name="l01007"></a>01007 
<a name="l01008"></a>01008       <span class="keywordflow">if</span> (DERIVED_T::IS_QUASI)
<a name="l01009"></a>01009         {
<a name="l01010"></a>01010           <span class="comment">//TODO : implement when Diff_K_Eps_QC is templatized</span>
<a name="l01011"></a>01011           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Diff_K_Eps_QC are not templatized yet !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01012"></a>01012           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01013"></a>01013           <span class="comment">//          for (k=0; k&lt;aii.size(); k++)</span>
<a name="l01014"></a>01014           <span class="comment">//            aii(k) =</span>
<a name="l01015"></a>01015           <span class="comment">//              surface(face)*porosite(face)*nu_1(n0,k)/dv_mvol(n0)/dist;</span>
<a name="l01016"></a>01016         }
<a name="l01017"></a>01017       <span class="keywordflow">else</span>
<a name="l01018"></a>01018         {
<a name="l01019"></a>01019           <span class="keywordflow">for</span> (k=0; k&lt;aii.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01020"></a>01020             aii(k) =
<a name="l01021"></a>01021               surface(face)*porosite(face)*nu_1(n0,k)/dist;
<a name="l01022"></a>01022         }
<a name="l01023"></a>01023 
<a name="l01024"></a>01024 
<a name="l01025"></a>01025       <span class="keywordflow">for</span> (k=0; k&lt;aii.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01026"></a>01026         ajj(k) =0;
<a name="l01027"></a>01027     }
<a name="l01028"></a>01028 
<a name="l01029"></a>01029   <span class="keywordflow">else</span>  <span class="comment">// n1 != -1</span>
<a name="l01030"></a>01030     {
<a name="l01031"></a>01031       <span class="keywordflow">if</span> (n1==-1) <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01032"></a>01032 
<a name="l01033"></a>01033       <span class="keywordflow">if</span> (DERIVED_T::IS_QUASI)
<a name="l01034"></a>01034         {
<a name="l01035"></a>01035           <span class="comment">//TODO : implement when Diff_K_Eps_QC is templatized</span>
<a name="l01036"></a>01036           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Diff_K_Eps_QC are not templatized yet !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01037"></a>01037           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01038"></a>01038           <span class="comment">//          for (k=0; k&lt;ajj.size(); k++)</span>
<a name="l01039"></a>01039           <span class="comment">//            ajj(k) =</span>
<a name="l01040"></a>01040           <span class="comment">//              surface(face)*porosite(face)*nu_1(n1,k)/dv_mvol(n1)/dist;</span>
<a name="l01041"></a>01041         }
<a name="l01042"></a>01042       <span class="keywordflow">else</span>
<a name="l01043"></a>01043         {
<a name="l01044"></a>01044           <span class="keywordflow">for</span> (k=0; k&lt;ajj.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01045"></a>01045             ajj(k) =
<a name="l01046"></a>01046               surface(face)*porosite(face)*nu_1(n1,k)/dist;
<a name="l01047"></a>01047         }
<a name="l01048"></a>01048 
<a name="l01049"></a>01049       <span class="keywordflow">for</span> (k=0; k&lt;ajj.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01050"></a>01050         aii(k) =0.;
<a name="l01051"></a>01051 
<a name="l01052"></a>01052     }
<a name="l01053"></a>01053 }
<a name="l01054"></a>01054 <span class="comment"></span>
<a name="l01055"></a>01055 <span class="comment">//// secmem_face avec Dirichlet_paroi_fixe</span>
<a name="l01056"></a>01056 <span class="comment"></span><span class="comment">//</span>
<a name="l01057"></a>01057 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01058"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a86aa2e3cf4491d7b33928df46f443077">01058</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::secmem_face</a>(<span class="keywordtype">int</span> face, <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__fixe.html" title="classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes...">Dirichlet_paroi_fixe</a>&amp;,
<a name="l01059"></a>01059                                                        <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux)<span class="keyword"> const</span>
<a name="l01060"></a>01060 <span class="keyword"></span>{
<a name="l01061"></a>01061   <span class="comment">// coder dans evbasreyconst comme entree_fluide ????</span>
<a name="l01062"></a>01062   flux=0  ;
<a name="l01063"></a>01063 }
<a name="l01064"></a>01064 
<a name="l01065"></a>01065 <span class="comment"></span>
<a name="l01066"></a>01066 <span class="comment">//// flux_face avec Echange_externe_impose</span>
<a name="l01067"></a>01067 <span class="comment"></span><span class="comment">//</span>
<a name="l01068"></a>01068 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01069"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ae189bc783fb5cf1fb91cf8707ad158ae">01069</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <span class="keywordtype">int</span> boundary_index, <span class="keywordtype">int</span> face, <span class="keywordtype">int</span> local_face,
<a name="l01070"></a>01070                                                      <span class="keyword">const</span> <a class="code" href="classEchange__externe__impose.html" title="Classe Echange_externe_impose: Cette classe represente le cas particulier de la classe Echange_impose...">Echange_externe_impose</a>&amp; la_cl,
<a name="l01071"></a>01071                                                      <span class="keywordtype">int</span> num1,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux)<span class="keyword"> const</span>
<a name="l01072"></a>01072 <span class="keyword"></span>{
<a name="l01073"></a>01073   <span class="comment">// C.L de type Echange_externe_impose : 1/h_total = (1/h_imp) + (e/diffusivite)</span>
<a name="l01074"></a>01074   <span class="comment">// La C.L fournit h_imp ; il faut calculer e/diffusivite</span>
<a name="l01075"></a>01075 
<a name="l01076"></a>01076   <span class="keywordflow">if</span> (DERIVED_T::IS_QUASI)
<a name="l01077"></a>01077     {
<a name="l01078"></a>01078       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;__FILE__&lt;&lt; <span class="stringliteral">&quot; QC BORD non code ligne &quot;</span>&lt;&lt;(int)__LINE__&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01079"></a>01079       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01080"></a>01080     }
<a name="l01081"></a>01081 
<a name="l01082"></a>01082   <span class="keywordtype">double</span> h_total_inv,e;
<a name="l01083"></a>01083   <span class="keywordtype">int</span> k;
<a name="l01084"></a>01084   <span class="comment">//  int ori = orientation(face);</span>
<a name="l01085"></a>01085   <span class="keywordtype">int</span> n0 = elem_(face,0);
<a name="l01086"></a>01086   <span class="keywordtype">int</span> n1 = elem_(face,1);
<a name="l01087"></a>01087   <span class="keywordflow">if</span> (DERIVED_T::IS_MODIF_DEQ)
<a name="l01088"></a>01088     {
<a name="l01089"></a>01089       e = ind_Fluctu_Term()==1 ? Dist_norm_bord_externe_(face) :
<a name="l01090"></a>01090           equivalent_distance(boundary_index,local_face);
<a name="l01091"></a>01091     }
<a name="l01092"></a>01092   <span class="keywordflow">else</span>
<a name="l01093"></a>01093     {
<a name="l01094"></a>01094       e = DERIVED_T::IS_DEQUIV ? equivalent_distance(boundary_index,local_face) :
<a name="l01095"></a>01095           Dist_norm_bord_externe_(face);
<a name="l01096"></a>01096     }
<a name="l01097"></a>01097   <span class="keywordflow">if</span> (n0 != -1)
<a name="l01098"></a>01098     {
<a name="l01099"></a>01099       <span class="comment">//e = la_zone-&gt;xv(face,ori) - la_zone-&gt;xp(n0,ori);</span>
<a name="l01100"></a>01100       <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01101"></a>01101         {
<a name="l01102"></a>01102           <span class="keyword">const</span> <span class="keywordtype">int</span> l = DERIVED_T::IS_ANISO ? orientation(face) : k;
<a name="l01103"></a>01103           h_total_inv = 1/la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1,k) + e/nu_2(n0,l);
<a name="l01104"></a>01104           flux(k) = (la_cl.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-num1,k) - inco(n0,k))*surface(face)/h_total_inv;
<a name="l01105"></a>01105         }
<a name="l01106"></a>01106     }
<a name="l01107"></a>01107   <span class="keywordflow">else</span>
<a name="l01108"></a>01108     {
<a name="l01109"></a>01109       <span class="comment">//    e = la_zone-&gt;xp(n1,ori) - la_zone-&gt;xv(face,ori);</span>
<a name="l01110"></a>01110       <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01111"></a>01111         {
<a name="l01112"></a>01112           <span class="keyword">const</span> <span class="keywordtype">int</span> l = DERIVED_T::IS_ANISO ? orientation(face) : k;
<a name="l01113"></a>01113           h_total_inv = 1/la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1,k) + e/nu_2(n1,l);
<a name="l01114"></a>01114           flux(k) = (inco(n1,k) - la_cl.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-num1,k))*surface(face)/h_total_inv;
<a name="l01115"></a>01115         }
<a name="l01116"></a>01116     }
<a name="l01117"></a>01117 }
<a name="l01118"></a>01118 <span class="comment"></span>
<a name="l01119"></a>01119 <span class="comment">//// coeffs_face avec Echange_externe_impose</span>
<a name="l01120"></a>01120 <span class="comment"></span><span class="comment">//</span>
<a name="l01121"></a>01121 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01122"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ab71dc937a268c69b21941d0e876bbaf6">01122</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> boundary_index, <span class="keywordtype">int</span> face, <span class="keywordtype">int</span> local_face, <span class="keywordtype">int</span> num1,
<a name="l01123"></a>01123                                                        <span class="keyword">const</span> <a class="code" href="classEchange__externe__impose.html" title="Classe Echange_externe_impose: Cette classe represente le cas particulier de la classe Echange_impose...">Echange_externe_impose</a>&amp; la_cl,
<a name="l01124"></a>01124                                                        <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj)<span class="keyword"> const</span>
<a name="l01125"></a>01125 <span class="keyword"></span>{
<a name="l01126"></a>01126   <span class="comment">// C.L de type Echange_externe_impose : 1/h_total = (1/h_imp) + (e/diffusivite)</span>
<a name="l01127"></a>01127   <span class="comment">// La C.L fournit h_imp ; il faut calculer e/diffusivite</span>
<a name="l01128"></a>01128 
<a name="l01129"></a>01129   <span class="keywordtype">double</span> e,h_total_inv;
<a name="l01130"></a>01130   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l01131"></a>01131   <span class="comment">//  int j = elem(face,1);</span>
<a name="l01132"></a>01132   <span class="comment">//  int ori = orientation(face);</span>
<a name="l01133"></a>01133   <span class="keywordtype">int</span> k;
<a name="l01134"></a>01134   <span class="keywordflow">if</span> (DERIVED_T::IS_MODIF_DEQ)
<a name="l01135"></a>01135     {
<a name="l01136"></a>01136       e = ind_Fluctu_Term()==1 ? Dist_norm_bord_externe_(face) :
<a name="l01137"></a>01137           equivalent_distance(boundary_index,local_face);
<a name="l01138"></a>01138     }
<a name="l01139"></a>01139   <span class="keywordflow">else</span>
<a name="l01140"></a>01140     {
<a name="l01141"></a>01141       e = DERIVED_T::IS_DEQUIV ? equivalent_distance(boundary_index,local_face) :
<a name="l01142"></a>01142           Dist_norm_bord_externe_(face);
<a name="l01143"></a>01143     }
<a name="l01144"></a>01144   <span class="keywordflow">if</span> (i != -1)
<a name="l01145"></a>01145     {
<a name="l01146"></a>01146       <span class="comment">//      e = la_zone-&gt;xv(face,ori) - la_zone-&gt;xp(i,ori);</span>
<a name="l01147"></a>01147       <span class="keywordflow">for</span> (k=0; k&lt;aii.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01148"></a>01148         {
<a name="l01149"></a>01149           <span class="keyword">const</span> <span class="keywordtype">int</span> l = DERIVED_T::IS_ANISO ? orientation(face) : k;
<a name="l01150"></a>01150           h_total_inv =  1/la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1,k) + e/nu_2(i,l);
<a name="l01151"></a>01151           aii(k) = surface(face)/h_total_inv;
<a name="l01152"></a>01152         }
<a name="l01153"></a>01153       <span class="keywordflow">for</span> (k=0; k&lt;ajj.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01154"></a>01154         ajj(k) = 0;
<a name="l01155"></a>01155     }
<a name="l01156"></a>01156   <span class="keywordflow">else</span>
<a name="l01157"></a>01157     {
<a name="l01158"></a>01158       <span class="comment">//e = la_zone-&gt;xp(j,ori) - la_zone-&gt;xv(face,ori);</span>
<a name="l01159"></a>01159       <span class="keywordflow">for</span> (k=0; k&lt;ajj.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01160"></a>01160         {
<a name="l01161"></a>01161           <span class="keyword">const</span> <span class="keywordtype">int</span> l = DERIVED_T::IS_ANISO ? orientation(face) : k;
<a name="l01162"></a>01162           h_total_inv = 1/la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1,k) + e/nu_2(elem_(face,1),l);
<a name="l01163"></a>01163           ajj(k) = surface(face)/h_total_inv;
<a name="l01164"></a>01164         }
<a name="l01165"></a>01165       <span class="keywordflow">for</span> (k=0; k&lt;aii.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01166"></a>01166         aii(k) = 0;
<a name="l01167"></a>01167     }
<a name="l01168"></a>01168 }
<a name="l01169"></a>01169 <span class="comment"></span>
<a name="l01170"></a>01170 <span class="comment">//// secmem</span>
<a name="l01171"></a>01171 <span class="comment"></span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01172"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ac8c676c139e0937f4d52aaec362ff470">01172</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::secmem_face</a>(<span class="keywordtype">int</span> boundary_index, <span class="keywordtype">int</span> face, <span class="keywordtype">int</span> local_face, <span class="keyword">const</span> <a class="code" href="classEchange__externe__impose.html" title="Classe Echange_externe_impose: Cette classe represente le cas particulier de la classe Echange_impose...">Echange_externe_impose</a>&amp; la_cl,
<a name="l01173"></a>01173                                                        <span class="keywordtype">int</span> num1,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux)<span class="keyword"> const</span>
<a name="l01174"></a>01174 <span class="keyword"></span>{
<a name="l01175"></a>01175   <span class="comment">// C.L de type Echange_externe_impose : 1/h_total = (1/h_imp) + (e/diffusivite)</span>
<a name="l01176"></a>01176   <span class="comment">// La C.L fournit h_imp ; il faut calculer e/diffusivite</span>
<a name="l01177"></a>01177 
<a name="l01178"></a>01178   <span class="keywordtype">double</span> e,h_total_inv;
<a name="l01179"></a>01179   <span class="keywordtype">int</span> k;
<a name="l01180"></a>01180   <span class="keywordtype">double</span> h_imp;
<a name="l01181"></a>01181   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l01182"></a>01182   <span class="comment">//  int j = elem(face,1);</span>
<a name="l01183"></a>01183   <span class="comment">//  int ori = orientation(face);</span>
<a name="l01184"></a>01184   <span class="keywordflow">if</span> (DERIVED_T::IS_MODIF_DEQ)
<a name="l01185"></a>01185     {
<a name="l01186"></a>01186       e = ind_Fluctu_Term()==1 ? Dist_norm_bord_externe_(face) :
<a name="l01187"></a>01187           equivalent_distance(boundary_index,local_face);
<a name="l01188"></a>01188     }
<a name="l01189"></a>01189   <span class="keywordflow">else</span>
<a name="l01190"></a>01190     {
<a name="l01191"></a>01191       e = DERIVED_T::IS_DEQUIV ? equivalent_distance(boundary_index,local_face) :
<a name="l01192"></a>01192           Dist_norm_bord_externe_(face);
<a name="l01193"></a>01193     }
<a name="l01194"></a>01194   <span class="keywordflow">if</span> (i != -1)
<a name="l01195"></a>01195     {
<a name="l01196"></a>01196       <span class="comment">//e = la_zone-&gt;xv(face,ori) - la_zone-&gt;xp(i,ori);</span>
<a name="l01197"></a>01197       <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01198"></a>01198         {
<a name="l01199"></a>01199           h_imp = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1,k);
<a name="l01200"></a>01200           h_total_inv = 1/h_imp + e/nu_2(i,k);
<a name="l01201"></a>01201           flux(k) = la_cl.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-num1,k) *surface(face)/h_total_inv;
<a name="l01202"></a>01202         }
<a name="l01203"></a>01203     }
<a name="l01204"></a>01204   <span class="keywordflow">else</span>
<a name="l01205"></a>01205     {
<a name="l01206"></a>01206       <span class="comment">//e = la_zone-&gt;xp(j,ori) - la_zone-&gt;xv(face,ori);</span>
<a name="l01207"></a>01207       <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01208"></a>01208         {
<a name="l01209"></a>01209           h_imp = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1,k);
<a name="l01210"></a>01210           h_total_inv = 1/h_imp + e/nu_2(elem_(face,1),k);
<a name="l01211"></a>01211           flux(k) =  - la_cl.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-num1,k)*surface(face)/h_total_inv;
<a name="l01212"></a>01212         }
<a name="l01213"></a>01213     }
<a name="l01214"></a>01214 }
<a name="l01215"></a>01215 <span class="comment"></span>
<a name="l01216"></a>01216 <span class="comment">//// flux_face avec Echange_global_impose</span>
<a name="l01217"></a>01217 <span class="comment"></span><span class="comment">//</span>
<a name="l01218"></a>01218 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01219"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a50bf546dbc4c015961dc2a313d737d85">01219</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <span class="keywordtype">int</span> face ,
<a name="l01220"></a>01220                                                      <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp; la_cl,
<a name="l01221"></a>01221                                                      <span class="keywordtype">int</span> num1,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux)<span class="keyword"> const</span>
<a name="l01222"></a>01222 <span class="keyword"></span>{
<a name="l01223"></a>01223 
<a name="l01224"></a>01224   <span class="keywordflow">if</span> (DERIVED_T::IS_QUASI)
<a name="l01225"></a>01225     {
<a name="l01226"></a>01226       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;__FILE__&lt;&lt; <span class="stringliteral">&quot; QC BORD non code ligne &quot;</span>&lt;&lt;(int)__LINE__&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01227"></a>01227       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01228"></a>01228     }
<a name="l01229"></a>01229 
<a name="l01230"></a>01230   <span class="keywordtype">int</span> n0 = elem_(face,0);
<a name="l01231"></a>01231   <span class="keywordtype">int</span> n1 = elem_(face,1);
<a name="l01232"></a>01232   <span class="keywordtype">int</span> k;
<a name="l01233"></a>01233   <span class="keywordflow">if</span> (n0 != -1)
<a name="l01234"></a>01234     <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01235"></a>01235       flux(k) = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1,k)*(la_cl.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-num1,k) - inco(n0,k))
<a name="l01236"></a>01236                 *surface(face);
<a name="l01237"></a>01237   <span class="keywordflow">else</span>
<a name="l01238"></a>01238     <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01239"></a>01239       flux(k) = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1,k)*(inco(n1,k) - la_cl.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-num1,k))
<a name="l01240"></a>01240                 *surface(face);
<a name="l01241"></a>01241 }
<a name="l01242"></a>01242 <span class="comment"></span>
<a name="l01243"></a>01243 <span class="comment">//// coeffs_face avec Echange_global_impose</span>
<a name="l01244"></a>01244 <span class="comment"></span><span class="comment">//</span>
<a name="l01245"></a>01245 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01246"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a6fc6899d8a098dedf10a53f4c369da42">01246</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> face,<span class="keywordtype">int</span> num1,  <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp; la_cl, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj )<span class="keyword"> const</span>
<a name="l01247"></a>01247 <span class="keyword"></span>{
<a name="l01248"></a>01248   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l01249"></a>01249   <span class="comment">//  int j = elem(face,1);</span>
<a name="l01250"></a>01250   <span class="keywordtype">int</span> k;
<a name="l01251"></a>01251   <span class="keywordflow">if</span> (i != -1)
<a name="l01252"></a>01252     {
<a name="l01253"></a>01253       <span class="keywordflow">for</span> (k=0; k&lt;aii.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01254"></a>01254         aii(k) = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1,k)*surface(face);
<a name="l01255"></a>01255       <span class="keywordflow">for</span> (k=0; k&lt;ajj.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01256"></a>01256         ajj(k) = 0;
<a name="l01257"></a>01257     }
<a name="l01258"></a>01258   <span class="keywordflow">else</span>
<a name="l01259"></a>01259     {
<a name="l01260"></a>01260       <span class="keywordflow">for</span> (k=0; k&lt;ajj.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01261"></a>01261         ajj(k) = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1,k)*surface(face);
<a name="l01262"></a>01262       <span class="keywordflow">for</span> (k=0; k&lt;aii.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01263"></a>01263         aii(k) = 0;
<a name="l01264"></a>01264     }
<a name="l01265"></a>01265 }
<a name="l01266"></a>01266 <span class="comment"></span>
<a name="l01267"></a>01267 <span class="comment">//// secmem_face avec Echange_global_impose</span>
<a name="l01268"></a>01268 <span class="comment"></span><span class="comment">//</span>
<a name="l01269"></a>01269 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01270"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a1f70e1cf529180d3f2e42b2c6b2e78fc">01270</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::secmem_face</a>(<span class="keywordtype">int</span> face, <span class="keyword">const</span> <a class="code" href="classEchange__global__impose.html" title="Classe Echange_global_impose Cette classe represente le cas particulier de la classe Echange_impose_b...">Echange_global_impose</a>&amp; la_cl,
<a name="l01271"></a>01271                                                        <span class="keywordtype">int</span> num1,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux)<span class="keyword"> const</span>
<a name="l01272"></a>01272 <span class="keyword"></span>{
<a name="l01273"></a>01273   <span class="keywordtype">int</span> k;
<a name="l01274"></a>01274   <span class="keywordtype">double</span> h;
<a name="l01275"></a>01275   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l01276"></a>01276   <span class="comment">//int j = elem(face,1);</span>
<a name="l01277"></a>01277   <span class="keywordflow">if</span> (i != -1)
<a name="l01278"></a>01278     <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01279"></a>01279       {
<a name="l01280"></a>01280         h = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1,k);
<a name="l01281"></a>01281         flux(k) = h*la_cl.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-num1,k)*surface(face);
<a name="l01282"></a>01282       }
<a name="l01283"></a>01283   <span class="keywordflow">else</span>
<a name="l01284"></a>01284     <span class="keywordflow">for</span> (k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01285"></a>01285       {
<a name="l01286"></a>01286         h = la_cl.<a class="code" href="classEchange__impose__base.html#a1e75de051a3afbd228374eabc5be9485" title="Renvoie la valeur du coefficient d&#39;echange de chaleur impose sur la i-eme composante du champ de fron...">h_imp</a>(face-num1,k);
<a name="l01287"></a>01287         flux(k) = -h*la_cl.<a class="code" href="classEchange__impose__base.html#ad2ef464a05e25ba48a5c75af56352440" title="Renvoie la valeur de la temperature imposee sur la i-eme composante du champ de frontiere.">T_ext</a>(face-num1,k)*surface(face);
<a name="l01288"></a>01288       }
<a name="l01289"></a>01289 }
<a name="l01290"></a>01290 <span class="comment"></span>
<a name="l01291"></a>01291 <span class="comment">//// flux_face avec Neumann_paroi</span>
<a name="l01292"></a>01292 <span class="comment"></span><span class="comment">//</span>
<a name="l01293"></a>01293 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01294"></a><a class="code" href="classEval__Diff__VDF__Elem.html#aa5764b2698ed61a96238f242a2d66554">01294</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> face,
<a name="l01295"></a>01295                                                      <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp; la_cl,
<a name="l01296"></a>01296                                                      <span class="keywordtype">int</span> num1,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux)<span class="keyword"> const</span>
<a name="l01297"></a>01297 <span class="keyword"></span>{
<a name="l01298"></a>01298   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l01299"></a>01299   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01300"></a>01300     flux(k) = ((i != -1) ? 1 : -1) * la_cl.<a class="code" href="classNeumann__paroi.html#a76b977c608b621e7dd7106401ab44936" title="Renvoie la valeur du flux impose sur la i-eme composante du champ representant le flux a la frontiere...">flux_impose</a>(face-num1,k)*surface(face);
<a name="l01301"></a>01301 }
<a name="l01302"></a>01302 <span class="comment"></span>
<a name="l01303"></a>01303 <span class="comment">//// coeffs_face avec Neumann_paroi</span>
<a name="l01304"></a>01304 <span class="comment"></span><span class="comment">//</span>
<a name="l01305"></a>01305 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01306"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a294128fb5b3a22fe8efa73db0e399552">01306</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> face,<span class="keywordtype">int</span> num1, <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp;,
<a name="l01307"></a>01307                                                        <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj )<span class="keyword"> const</span>
<a name="l01308"></a>01308 <span class="keyword"></span>{
<a name="l01309"></a>01309   aii=0.;
<a name="l01310"></a>01310   ajj=0.;
<a name="l01311"></a>01311 }
<a name="l01312"></a>01312 <span class="comment"></span>
<a name="l01313"></a>01313 <span class="comment">//// secmem_face avec Neumann_paroi</span>
<a name="l01314"></a>01314 <span class="comment"></span><span class="comment">//</span>
<a name="l01315"></a>01315 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01316"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a8d64b8acfb7f3d1ef3ff4878a8c4922b">01316</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a93becc45b8f91cfbb10a27f6eefcfe1b">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::secmem_face</a>(<span class="keywordtype">int</span> face, <span class="keyword">const</span> <a class="code" href="classNeumann__paroi.html" title="Classe Neumann_paroi Cette condition limite correspond a un flux impose pour l&#39;equation de transport ...">Neumann_paroi</a>&amp; la_cl,
<a name="l01317"></a>01317                                                        <span class="keywordtype">int</span> num1, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux)<span class="keyword"> const</span>
<a name="l01318"></a>01318 <span class="keyword"></span>{
<a name="l01319"></a>01319   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l01320"></a>01320   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01321"></a>01321     flux(k) = ((i != -1) ? 1 : -1) * la_cl.<a class="code" href="classNeumann__paroi.html#a76b977c608b621e7dd7106401ab44936" title="Renvoie la valeur du flux impose sur la i-eme composante du champ representant le flux a la frontiere...">flux_impose</a>(face-num1,k)*surface(face);
<a name="l01322"></a>01322 }
<a name="l01323"></a>01323 <span class="comment"></span>
<a name="l01324"></a>01324 <span class="comment">//// flux_face avec Neumann_sortie_libre</span>
<a name="l01325"></a>01325 <span class="comment"></span><span class="comment">//</span>
<a name="l01326"></a>01326 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01327"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a5a535e5e8183406e89451901a07fb26c">01327</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; , <span class="keywordtype">int</span> ,
<a name="l01328"></a>01328                                                      <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; ,
<a name="l01329"></a>01329                                                      <span class="keywordtype">int</span> ,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux )<span class="keyword"> const</span>
<a name="l01330"></a>01330 <span class="keyword"></span>{
<a name="l01331"></a>01331   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01332"></a>01332     {
<a name="l01333"></a>01333       <span class="keywordflow">if</span> (flux(k)!=0)
<a name="l01334"></a>01334         {
<a name="l01335"></a>01335           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; et OUI&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01336"></a>01336           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01337"></a>01337         }
<a name="l01338"></a>01338     }
<a name="l01339"></a>01339 
<a name="l01340"></a>01340 }
<a name="l01341"></a>01341 <span class="comment"></span>
<a name="l01342"></a>01342 <span class="comment">//// flux_face avec Periodique</span>
<a name="l01343"></a>01343 <span class="comment"></span><span class="comment">//</span>
<a name="l01344"></a>01344 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01345"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a4b4552afae9584ca958be7896eb7c614">01345</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a502e4b529c84caf6844cc7cf3467d7fa">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_face</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco, <span class="keywordtype">int</span> face,
<a name="l01346"></a>01346                                                      <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl,
<a name="l01347"></a>01347                                                      <span class="keywordtype">int</span> , <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux)<span class="keyword"> const</span>
<a name="l01348"></a>01348 <span class="keyword"></span>{
<a name="l01349"></a>01349   <span class="keywordtype">int</span> n0 = elem_(face,0);
<a name="l01350"></a>01350   <span class="keywordtype">int</span> n1 = elem_(face,1);
<a name="l01351"></a>01351   <span class="keywordtype">double</span> d0 = la_zone-&gt;dist_face_elem0_period(face,n0,la_cl.<a class="code" href="classPeriodique.html#afb2788bd749c66ae0df1235042115e57">distance</a>());
<a name="l01352"></a>01352   <span class="keywordtype">double</span> d1 = la_zone-&gt;dist_face_elem1_period(face,n1,la_cl.<a class="code" href="classPeriodique.html#afb2788bd749c66ae0df1235042115e57">distance</a>());
<a name="l01353"></a>01353   <span class="keywordtype">double</span> heq;
<a name="l01354"></a>01354 
<a name="l01355"></a>01355   <span class="keywordflow">if</span> (DERIVED_T::IS_QUASI)
<a name="l01356"></a>01356     {
<a name="l01357"></a>01357       <span class="comment">//TODO : implement when Diff_K_Eps_QC is templatized</span>
<a name="l01358"></a>01358       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Diff_K_Eps_QC are not templatized yet !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01359"></a>01359       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01360"></a>01360       <span class="comment">//            for (int k=0; k&lt;flux.size(); k++)</span>
<a name="l01361"></a>01361       <span class="comment">//              {</span>
<a name="l01362"></a>01362       <span class="comment">//                heq = compute_heq(d0,n0,d1,n1,k);</span>
<a name="l01363"></a>01363       <span class="comment">//                flux(k) = heq*(inco(n1,k)/dv_mvol(n1) - inco(n0,k)/dv_mvol(n0))*surface(face)*porosite(face);</span>
<a name="l01364"></a>01364       <span class="comment">//              }</span>
<a name="l01365"></a>01365     }
<a name="l01366"></a>01366   <span class="keywordflow">else</span>
<a name="l01367"></a>01367     {
<a name="l01368"></a>01368       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01369"></a>01369         {
<a name="l01370"></a>01370           heq = compute_heq(d0,n0,d1,n1,k);
<a name="l01371"></a>01371           flux(k) = heq*(inco(n1,k) - inco(n0,k))*surface(face)*porosite(face);
<a name="l01372"></a>01372         }
<a name="l01373"></a>01373     }
<a name="l01374"></a>01374 
<a name="l01375"></a>01375 
<a name="l01376"></a>01376 }
<a name="l01377"></a>01377 <span class="comment"></span>
<a name="l01378"></a>01378 <span class="comment">//// coeffs_face avec Periodique</span>
<a name="l01379"></a>01379 <span class="comment"></span><span class="comment">//</span>
<a name="l01380"></a>01380 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01381"></a><a class="code" href="classEval__Diff__VDF__Elem.html#ae8fcf465d41119a6e6359d538599ac9f">01381</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a544c181fb0c93ab4ae3cc1f084244786">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_face</a>(<span class="keywordtype">int</span> face,<span class="keywordtype">int</span>, <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl,
<a name="l01382"></a>01382                                                        <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj )<span class="keyword"> const</span>
<a name="l01383"></a>01383 <span class="keyword"></span>{
<a name="l01384"></a>01384   <span class="keywordtype">int</span> k;
<a name="l01385"></a>01385   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l01386"></a>01386   <span class="keywordtype">int</span> j = elem_(face,1);
<a name="l01387"></a>01387   <span class="keywordtype">double</span> d0 = la_zone-&gt;dist_face_elem0_period(face,i,la_cl.<a class="code" href="classPeriodique.html#afb2788bd749c66ae0df1235042115e57">distance</a>());
<a name="l01388"></a>01388   <span class="keywordtype">double</span> d1 = la_zone-&gt;dist_face_elem1_period(face,j,la_cl.<a class="code" href="classPeriodique.html#afb2788bd749c66ae0df1235042115e57">distance</a>());
<a name="l01389"></a>01389   <span class="keywordtype">double</span> heq;
<a name="l01390"></a>01390 
<a name="l01391"></a>01391   <span class="keywordflow">for</span> (k=0; k&lt;aii.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01392"></a>01392     {
<a name="l01393"></a>01393       heq = compute_heq(d0,i,d1,j,k);
<a name="l01394"></a>01394       aii(k) =  heq*surface(face)*porosite(face);
<a name="l01395"></a>01395     }
<a name="l01396"></a>01396   <span class="keywordflow">for</span> (k=0; k&lt;ajj.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01397"></a>01397     {
<a name="l01398"></a>01398       heq = compute_heq(d0,i,d1,j,k);
<a name="l01399"></a>01399       ajj(k)=  heq*surface(face)*porosite(face);
<a name="l01400"></a>01400     }
<a name="l01401"></a>01401 }
<a name="l01402"></a>01402 <span class="comment"></span>
<a name="l01403"></a>01403 <span class="comment">//// flux_faces_interne</span>
<a name="l01404"></a>01404 <span class="comment"></span><span class="comment">//</span>
<a name="l01405"></a>01405 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01406"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a891d4e627c14b3cff92bcf426aa92594">01406</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ac8c3b12b3ee5e0a51b665198557216e6">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::flux_faces_interne</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,
<a name="l01407"></a>01407                                                               <span class="keywordtype">int</span> face,<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux)<span class="keyword"> const</span>
<a name="l01408"></a>01408 <span class="keyword"></span>{
<a name="l01409"></a>01409   <span class="keywordflow">if</span> (DERIVED_T::IS_QUASI)
<a name="l01410"></a>01410     {
<a name="l01411"></a>01411       <span class="comment">//TODO : implement when Diff_K_Eps_QC is templatized</span>
<a name="l01412"></a>01412       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Diff_K_Eps_QC are not templatized yet !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01413"></a>01413       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01414"></a>01414     }
<a name="l01415"></a>01415   <span class="keywordtype">int</span> n0 = elem_(face,0);
<a name="l01416"></a>01416   <span class="keywordtype">int</span> n1 = elem_(face,1);
<a name="l01417"></a>01417   <span class="keywordtype">double</span> d0 = Dist_face_elem0(face,n0);
<a name="l01418"></a>01418   <span class="keywordtype">double</span> d1 = Dist_face_elem1(face,n1);
<a name="l01419"></a>01419   <span class="keywordtype">double</span> heq;
<a name="l01420"></a>01420   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01421"></a>01421     {
<a name="l01422"></a>01422       <span class="keyword">const</span> <span class="keywordtype">int</span> l = DERIVED_T::IS_ANISO ? orientation(face) : k;
<a name="l01423"></a>01423 
<a name="l01424"></a>01424       <span class="keywordflow">if</span> (nu_1(n0, l) == 0.0 &amp;&amp; nu_1(n1, l) == 0.0)
<a name="l01425"></a>01425         heq = 0.;
<a name="l01426"></a>01426       <span class="keywordflow">else</span>
<a name="l01427"></a>01427         {
<a name="l01428"></a>01428           assert(nu_1(n0, l)!=0.0);
<a name="l01429"></a>01429           assert(nu_1(n1, l)!=0.0);
<a name="l01430"></a>01430           heq = compute_heq(d0, n0, d1, n1, l);
<a name="l01431"></a>01431         }
<a name="l01432"></a>01432       flux(k) = heq*(inco(n1,k) - inco(n0,k))*surface(face)*porosite(face);
<a name="l01433"></a>01433     }
<a name="l01434"></a>01434 }
<a name="l01435"></a>01435 <span class="comment"></span>
<a name="l01436"></a>01436 <span class="comment">//// coeffs_faces_interne</span>
<a name="l01437"></a>01437 <span class="comment"></span><span class="comment">//</span>
<a name="l01438"></a>01438 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01439"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a76178bc5aa0373930c44bea55fb4682e">01439</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#a5278e8a178e3b11b1f94f92f04b23ee7">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::coeffs_faces_interne</a>(<span class="keywordtype">int</span> face, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; aii, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ajj )<span class="keyword"> const</span>
<a name="l01440"></a>01440 <span class="keyword"></span>{
<a name="l01441"></a>01441   <span class="keywordtype">int</span> k;
<a name="l01442"></a>01442   <span class="keywordtype">int</span> i = elem_(face,0);
<a name="l01443"></a>01443   <span class="keywordtype">int</span> j = elem_(face,1);
<a name="l01444"></a>01444   <span class="keywordtype">double</span> d0 = Dist_face_elem0(face,i);
<a name="l01445"></a>01445   <span class="keywordtype">double</span> d1 = Dist_face_elem1(face,j);
<a name="l01446"></a>01446   <span class="keywordtype">double</span> heq;
<a name="l01447"></a>01447   <span class="keywordflow">for</span> ( k=0; k&lt;aii.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01448"></a>01448     {
<a name="l01449"></a>01449       <span class="keywordtype">int</span> l = DERIVED_T::IS_ANISO ? orientation(face) : k;
<a name="l01450"></a>01450 
<a name="l01451"></a>01451       <span class="keywordflow">if</span> (nu_1(i,l)==0.0 &amp;&amp; nu_2(j,l)==0.0)
<a name="l01452"></a>01452         {
<a name="l01453"></a>01453           heq = 0.;
<a name="l01454"></a>01454         }
<a name="l01455"></a>01455       <span class="keywordflow">else</span>
<a name="l01456"></a>01456         {
<a name="l01457"></a>01457           assert(nu_1(i,l)!=0.0);
<a name="l01458"></a>01458           assert(nu_2(j,l)!=0.0);
<a name="l01459"></a>01459           heq = compute_heq(d0,i,d1,j,l);
<a name="l01460"></a>01460         }
<a name="l01461"></a>01461       aii(k) = heq*surface(face)*porosite(face);
<a name="l01462"></a>01462       ajj(k) = heq*surface(face)*porosite(face);
<a name="l01463"></a>01463     }
<a name="l01464"></a>01464 }
<a name="l01465"></a>01465 
<a name="l01466"></a>01466 <span class="comment"></span>
<a name="l01467"></a>01467 <span class="comment">//// secmem_faces_interne</span>
<a name="l01468"></a>01468 <span class="comment"></span><span class="comment">//</span>
<a name="l01469"></a>01469 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> DERIVED_T&gt;
<a name="l01470"></a><a class="code" href="classEval__Diff__VDF__Elem.html#a3bf3336e18fb583e8900ecf0594ef1ef">01470</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classEval__Diff__VDF__Elem.html#ac36170f82f963777f60abc011d4752d9">Eval_Diff_VDF_Elem&lt;DERIVED_T&gt;::secmem_faces_interne</a>( <span class="keywordtype">int</span>, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; flux )<span class="keyword"> const</span>
<a name="l01471"></a>01471 <span class="keyword"></span>{
<a name="l01472"></a>01472   <span class="keywordtype">int</span> k;
<a name="l01473"></a>01473   <span class="keywordflow">for</span> ( k=0; k&lt;flux.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); k++)
<a name="l01474"></a>01474     {
<a name="l01475"></a>01475       flux(k)=0.;
<a name="l01476"></a>01476     }
<a name="l01477"></a>01477 }
<a name="l01478"></a>01478 
<a name="l01479"></a>01479 <span class="preprocessor">#endif </span><span class="comment">/* Eval_Diff_VDF_Elem_included */</span>
<a name="l01480"></a>01480 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:38 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
