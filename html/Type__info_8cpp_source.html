<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Utilitaires/Type_info.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Utilitaires/Type_info.cpp</div>  </div>
</div>
<div class="contents">
<a href="Type__info_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Type_info.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Utilitaires</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/23</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Type__info_8h.html">Type_info.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Noms_8h.html">Noms.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Synonyme__info_8h.html">Synonyme_info.h</a>&gt;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="comment">// B.Mathieu, 08/2004</span>
<a name="l00028"></a>00028 <span class="comment">// Le processus d&#39;initialisation de ces membres statiques est tres</span>
<a name="l00029"></a>00029 <span class="comment">// important : il faut absolument qu&#39;ils soient initialises AVANT</span>
<a name="l00030"></a>00030 <span class="comment">// le premier appel au constructeur Type_info::Type_info(...).</span>
<a name="l00031"></a>00031 <span class="comment">// Or ce constructeur est appele pour initialiser le membre statique info_obj</span>
<a name="l00032"></a>00032 <span class="comment">// de tous les Objet_U.</span>
<a name="l00033"></a>00033 <span class="comment">// Risque de &quot;static initialization ordre fiasco&quot;</span>
<a name="l00034"></a>00034 <span class="comment">// (voir http://www.parashift.com/c++-faq-lite/ctors.html   [10.11])</span>
<a name="l00035"></a>00035 <span class="comment">// Pour l&#39;instant c&#39;est ok parce qu&#39;on initialise avec une constante...</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="comment">// Tableau de pointeurs sur les types enregistres lors de la construction</span>
<a name="l00038"></a>00038 <span class="comment">// des Type_info. Si plusieurs types on le meme nom (Type_info::n), alors</span>
<a name="l00039"></a>00039 <span class="comment">// on n&#39;en enregistre qu&#39;un seul dans Type_info::les_types.</span>
<a name="l00040"></a>00040 <span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a>** <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">Type_info::les_types</a>=0;
<a name="l00041"></a>00041 <span class="comment">// Pour chaque elements du tableau &quot;les_types&quot;, ce nombre vaut 1 si le</span>
<a name="l00042"></a>00042 <span class="comment">// nom du type est commun a plusieurs types, 0 sinon.</span>
<a name="l00043"></a>00043 <span class="comment">// Voir &quot;ajouter_type&quot;</span>
<a name="l00044"></a>00044 <span class="keywordtype">int</span> * <a class="code" href="classType__info.html#aefa2e065733773d08b1d0fb853d66136">Type_info::types_homonymes</a>=0;
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="keywordtype">int</span> <a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">Type_info::nb_classes</a>=0;
<a name="l00047"></a>00047 <span class="keywordtype">int</span> <a class="code" href="classType__info.html#a6a41434bc3f14d2771eb8eaa2090c5ca">Type_info::les_types_memsize</a>=0;
<a name="l00048"></a>00048 
<a name="l00049"></a><a class="code" href="Type__info_8cpp.html#acf4ac76ffbcfe6dcd623ff8fc756e5f3">00049</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">char</span> <a class="code" href="Type__info_8cpp.html#acf4ac76ffbcfe6dcd623ff8fc756e5f3">char_uppercase</a>(<span class="keywordtype">char</span> c)
<a name="l00050"></a>00050 {
<a name="l00051"></a>00051   <span class="keywordflow">if</span> (c &gt;= <span class="charliteral">&#39;a&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;z&#39;</span>)
<a name="l00052"></a>00052     c += <span class="charliteral">&#39;A&#39;</span> - <span class="charliteral">&#39;a&#39;</span>;
<a name="l00053"></a>00053   <span class="keywordflow">return</span> c;
<a name="l00054"></a>00054 }
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="Type__info_8cpp.html#aa17622716dc89f97b11c93215fdbb311">00056</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="Type__info_8cpp.html#aa17622716dc89f97b11c93215fdbb311">strcmp_uppercase</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *n1, <span class="keyword">const</span> <span class="keywordtype">char</span> *n2)
<a name="l00057"></a>00057 {
<a name="l00058"></a>00058   <span class="keywordtype">int</span> i = 0;
<a name="l00059"></a>00059   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c1, c2;
<a name="l00060"></a>00060   <span class="keywordtype">int</span> delta;
<a name="l00061"></a>00061   <span class="keywordflow">do</span>
<a name="l00062"></a>00062     {
<a name="l00063"></a>00063       c1 = (<span class="keywordtype">unsigned</span> char) <a class="code" href="Type__info_8cpp.html#acf4ac76ffbcfe6dcd623ff8fc756e5f3">char_uppercase</a>(n1[i]);
<a name="l00064"></a>00064       c2 = (<span class="keywordtype">unsigned</span> char) <a class="code" href="Type__info_8cpp.html#acf4ac76ffbcfe6dcd623ff8fc756e5f3">char_uppercase</a>(n2[i]);
<a name="l00065"></a>00065       delta = c1 - c2;
<a name="l00066"></a>00066       i++;
<a name="l00067"></a>00067     }
<a name="l00068"></a>00068   <span class="keywordflow">while</span> ((delta == 0) &amp;&amp; (c1 != 0) &amp;&amp; (c2 != 0));
<a name="l00069"></a>00069   <span class="keywordflow">return</span> delta;
<a name="l00070"></a>00070 }
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 <span class="comment">// GF pour liberer correctement la memoire il faut au moins detruire</span>
<a name="l00073"></a>00073 <span class="comment">// le Nom</span>
<a name="l00074"></a><a class="code" href="classType__info.html#a5e41818729985641c48e21c1c7d8caf5">00074</a> <a class="code" href="classType__info.html#a5e41818729985641c48e21c1c7d8caf5">Type_info::~Type_info</a>()
<a name="l00075"></a>00075 {
<a name="l00076"></a>00076 <span class="comment">// On cherche ou retirer le type dans le tableau :</span>
<a name="l00077"></a>00077   <span class="keywordtype">int</span> index;
<a name="l00078"></a>00078   <span class="keywordtype">int</span> existe_deja = <a class="code" href="classType__info.html#a34add11ef2b9a1e0dc9c87c56eb69ae9" title="Recherche le type de nom &quot;nom&quot; dans la liste de types enregistres par une recherche binaire...">search_type_info_name</a>(<a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>(), index);
<a name="l00079"></a>00079   <span class="keywordflow">if</span> (existe_deja)
<a name="l00080"></a>00080     {
<a name="l00081"></a>00081       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = index; i&lt;<a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a>-1; i++)
<a name="l00082"></a>00082         {
<a name="l00083"></a>00083           <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[i] = <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[i+1];
<a name="l00084"></a>00084           <a class="code" href="classType__info.html#aefa2e065733773d08b1d0fb853d66136">types_homonymes</a>[i] = <a class="code" href="classType__info.html#aefa2e065733773d08b1d0fb853d66136">types_homonymes</a>[i+1];
<a name="l00085"></a>00085         }
<a name="l00086"></a>00086       nb_classes--;
<a name="l00087"></a>00087     }
<a name="l00088"></a>00088   <span class="keywordflow">if</span> (<a class="code" href="classType__info.html#abf2205f043a8185bea074c55dee97d08" title="(eg: A)">name_</a>)
<a name="l00089"></a>00089     {
<a name="l00090"></a>00090       <span class="keyword">delete</span> <a class="code" href="classType__info.html#abf2205f043a8185bea074c55dee97d08" title="(eg: A)">name_</a>;
<a name="l00091"></a>00091       <a class="code" href="classType__info.html#abf2205f043a8185bea074c55dee97d08" title="(eg: A)">name_</a>=0;
<a name="l00092"></a>00092       <span class="keyword">delete</span> <a class="code" href="classType__info.html#ac1dda6db4d271c66f894e3b264093dbb" title="Synonym.">synonym_</a>;
<a name="l00093"></a>00093       <a class="code" href="classType__info.html#ac1dda6db4d271c66f894e3b264093dbb" title="Synonym.">synonym_</a>=0;
<a name="l00094"></a>00094       <span class="keyword">delete</span> <a class="code" href="classType__info.html#a5e2534805f58ee3e3ef5912a8827d33f" title="(eg: B) Object synonym:">synonym_name_</a>;
<a name="l00095"></a>00095       <a class="code" href="classType__info.html#a5e2534805f58ee3e3ef5912a8827d33f" title="(eg: B) Object synonym:">synonym_name_</a>=0;
<a name="l00096"></a>00096     }
<a name="l00097"></a>00097   <span class="keywordflow">if</span> ((<a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a>==0)&amp;&amp; (<a class="code" href="classType__info.html#a6a41434bc3f14d2771eb8eaa2090c5ca">les_types_memsize</a>!=0))
<a name="l00098"></a>00098     {
<a name="l00099"></a>00099       <span class="keyword">delete</span> [] <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>;
<a name="l00100"></a>00100       <span class="keyword">delete</span> [] <a class="code" href="classType__info.html#aefa2e065733773d08b1d0fb853d66136">types_homonymes</a>;
<a name="l00101"></a>00101       <a class="code" href="classType__info.html#a6a41434bc3f14d2771eb8eaa2090c5ca">les_types_memsize</a>=0;
<a name="l00102"></a>00102     }
<a name="l00103"></a>00103 }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="comment">//</span>
<a name="l00106"></a>00106 <span class="comment">//</span>
<a name="l00107"></a>00107 <span class="comment">//</span>
<a name="l00108"></a>00108 <span class="comment">//</span>
<a name="l00109"></a>00109 <span class="comment">//</span>
<a name="l00110"></a>00110 <span class="comment">//</span>
<a name="l00111"></a>00111 <span class="comment">//</span><span class="comment"></span>
<a name="l00112"></a>00112 <span class="comment">//! Recherche le type de nom &quot;nom&quot; dans la liste de types enregistres&lt;br&gt;par une recherche binaire.&lt;br&gt;On compare les chaines converties en majuscules.&lt;br&gt;On range dans &quot;index&quot; l&#39;indice du type, s&#39;il a ete trouve&lt;br&gt;et sinon l&#39;indice du type juste apres (dans ce cas, on a&lt;br&gt;les_types[index-1]-&gt;n &lt; nom &lt; les_types[index]-&gt;n )&lt;br&gt;Si le type a ete trouve on renvoie 1, sinon 0.</span>
<a name="l00113"></a><a class="code" href="classType__info.html#a34add11ef2b9a1e0dc9c87c56eb69ae9">00113</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classType__info.html#a34add11ef2b9a1e0dc9c87c56eb69ae9" title="Recherche le type de nom &quot;nom&quot; dans la liste de types enregistres par une recherche binaire...">Type_info::search_type_info_name</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *nom, <span class="keywordtype">int</span>&amp; index)
<a name="l00114"></a>00114 {
<a name="l00115"></a>00115   assert(nom != 0);
<a name="l00116"></a>00116 <span class="comment">// [imin..imax] est l&#39;intervalle ou se trouve l&#39;index recherche</span>
<a name="l00117"></a>00117   <span class="keywordtype">int</span> imin = 0;
<a name="l00118"></a>00118   <span class="keywordtype">int</span> imax = <a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a>;
<a name="l00119"></a>00119   <span class="keywordflow">while</span> (imax &gt; imin)
<a name="l00120"></a>00120     {
<a name="l00121"></a>00121 <span class="comment">// On a toujours milieu &lt; imax</span>
<a name="l00122"></a>00122       <span class="keywordtype">int</span> milieu = (imin + imax) / 2;
<a name="l00123"></a>00123       <span class="keywordtype">int</span> comparaison = <a class="code" href="Type__info_8cpp.html#aa17622716dc89f97b11c93215fdbb311">strcmp_uppercase</a>(nom, <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[milieu]-&gt;<a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>());
<a name="l00124"></a>00124       <span class="keywordflow">if</span> (comparaison == 0)
<a name="l00125"></a>00125         {
<a name="l00126"></a>00126           index = milieu;
<a name="l00127"></a>00127           <span class="keywordflow">return</span> 1;
<a name="l00128"></a>00128         }
<a name="l00129"></a>00129       <span class="keywordflow">if</span> (comparaison &lt; 0)
<a name="l00130"></a>00130         {
<a name="l00131"></a>00131 <span class="comment">// nom &lt; les_types[milieu]</span>
<a name="l00132"></a>00132 <span class="comment">// l&#39;index recherche est donc inferieur ou egal a &quot;milieu&quot;</span>
<a name="l00133"></a>00133           imax = milieu;
<a name="l00134"></a>00134         }
<a name="l00135"></a>00135       <span class="keywordflow">else</span>
<a name="l00136"></a>00136         {
<a name="l00137"></a>00137 <span class="comment">// nom &gt; les_types[milieu]</span>
<a name="l00138"></a>00138 <span class="comment">// l&#39;index recherche est donc strictement superieur a &quot;milieu&quot;</span>
<a name="l00139"></a>00139           imin = milieu + 1;
<a name="l00140"></a>00140         }
<a name="l00141"></a>00141     }
<a name="l00142"></a>00142   index = imax;
<a name="l00143"></a>00143   <span class="keywordflow">return</span> 0;
<a name="l00144"></a>00144 }
<a name="l00145"></a>00145 <span class="comment">// Precondition:</span>
<a name="l00146"></a>00146 <span class="comment">// Parametre: const char* nom</span>
<a name="l00147"></a>00147 <span class="comment">// Signification: le nom du type a creer</span>
<a name="l00148"></a>00148 <span class="comment">// Valeurs par defaut:</span>
<a name="l00149"></a>00149 <span class="comment">// Contraintes: nom != null</span>
<a name="l00150"></a>00150 <span class="comment">// Acces: entree</span>
<a name="l00151"></a>00151 <span class="comment">// Parametre: int nb_base</span>
<a name="l00152"></a>00152 <span class="comment">// Signification: le nombre de meres dans le tableau bases</span>
<a name="l00153"></a>00153 <span class="comment">// Valeurs par defaut:</span>
<a name="l00154"></a>00154 <span class="comment">// Contraintes:</span>
<a name="l00155"></a>00155 <span class="comment">// Acces: entree</span>
<a name="l00156"></a>00156 <span class="comment">// Parametre: const Type_info* bases[]</span>
<a name="l00157"></a>00157 <span class="comment">// Signification: le tableau specifiant les types de bases (meres) du type a creer</span>
<a name="l00158"></a>00158 <span class="comment">// Valeurs par defaut:</span>
<a name="l00159"></a>00159 <span class="comment">// Contraintes:</span>
<a name="l00160"></a>00160 <span class="comment">// Acces: entree</span>
<a name="l00161"></a>00161 <span class="comment">// </span>
<a name="l00162"></a>00162 <span class="comment">// Signification:</span>
<a name="l00163"></a>00163 <span class="comment">// Contraintes:</span>
<a name="l00164"></a>00164 <span class="comment">// Exception:</span>
<a name="l00165"></a>00165 <span class="comment">// Sort en erreur si le nom n&#39;est pas defini (null)</span>
<a name="l00166"></a>00166 <span class="comment">// Effets de bord:</span>
<a name="l00167"></a>00167 <span class="comment">// Postcondition:</span>
<a name="l00168"></a>00168 <span class="comment">//</span><span class="comment"></span>
<a name="l00169"></a>00169 <span class="comment">//! Constructeur par un nom, un tableau de meres.</span>
<a name="l00170"></a><a class="code" href="classType__info.html#ab843c96b5f8fa45d3fae40e6623fe5f0">00170</a> <span class="comment"></span><a class="code" href="classType__info.html#a292e3a6795679e130c6a91b961fc38d1" title="Constructeur par un nom, une fonction et un tableau de meres. La fonction permet de creer une instanc...">Type_info::Type_info</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* un_nom, <span class="keywordtype">int</span> nb_base, <span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a>** the_bases) :
<a name="l00171"></a>00171   names_(un_nom),
<a name="l00172"></a>00172   name_((<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>*)0),
<a name="l00173"></a>00173   synonym_name_((<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>*) 0),
<a name="l00174"></a>00174   nb_bases_(nb_base),
<a name="l00175"></a>00175   b(the_bases),
<a name="l00176"></a>00176   cree_instance(0)
<a name="l00177"></a>00177 {
<a name="l00178"></a>00178   <span class="keywordflow">if</span>(un_nom == 0)
<a name="l00179"></a>00179     {
<a name="l00180"></a>00180       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Type_info::Type_info(const char* nom,Objet_U* (*f)()...)\n&quot;</span>;
<a name="l00181"></a>00181       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Error : name == 0&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00182"></a>00182       assert(0);
<a name="l00183"></a>00183       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00184"></a>00184     }
<a name="l00185"></a>00185   <a class="code" href="classType__info.html#aed129a24841aaac52a0da3b18d3a8a58" title="Methode statique appelee par les constructeurs de Type_info pour ajouter un nouveau type a la liste d...">ajouter_type</a>(*<span class="keyword">this</span>);
<a name="l00186"></a>00186 }
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 <span class="comment">// Precondition:</span>
<a name="l00189"></a>00189 <span class="comment">// Parametre: const char* nom</span>
<a name="l00190"></a>00190 <span class="comment">// Signification: le nom du type a creer</span>
<a name="l00191"></a>00191 <span class="comment">// Valeurs par defaut:</span>
<a name="l00192"></a>00192 <span class="comment">// Contraintes: nom != null</span>
<a name="l00193"></a>00193 <span class="comment">// Acces: entree</span>
<a name="l00194"></a>00194 <span class="comment">// Parametre: Objet_U* (*f)()</span>
<a name="l00195"></a>00195 <span class="comment">// Signification: fonction pour creer une instance du type considere</span>
<a name="l00196"></a>00196 <span class="comment">// Valeurs par defaut:</span>
<a name="l00197"></a>00197 <span class="comment">// Contraintes:</span>
<a name="l00198"></a>00198 <span class="comment">// Acces:</span>
<a name="l00199"></a>00199 <span class="comment">// Parametre: int nb_base</span>
<a name="l00200"></a>00200 <span class="comment">// Signification: le nombre de meres dans le tableau bases[]</span>
<a name="l00201"></a>00201 <span class="comment">// Valeurs par defaut:</span>
<a name="l00202"></a>00202 <span class="comment">// Contraintes:</span>
<a name="l00203"></a>00203 <span class="comment">// Acces: entree</span>
<a name="l00204"></a>00204 <span class="comment">// Parametre: const Type_info* bases[]</span>
<a name="l00205"></a>00205 <span class="comment">// Signification: le tableau specifiant les types de bases (meres) du type a creer</span>
<a name="l00206"></a>00206 <span class="comment">// Valeurs par defaut:</span>
<a name="l00207"></a>00207 <span class="comment">// Contraintes:</span>
<a name="l00208"></a>00208 <span class="comment">// Acces: entree</span>
<a name="l00209"></a>00209 <span class="comment">// </span>
<a name="l00210"></a>00210 <span class="comment">// Signification:</span>
<a name="l00211"></a>00211 <span class="comment">// Contraintes:</span>
<a name="l00212"></a>00212 <span class="comment">// Exception:</span>
<a name="l00213"></a>00213 <span class="comment">// Sort en erreur si le nom donne n&#39;est pas defini (null)</span>
<a name="l00214"></a>00214 <span class="comment">// Effets de bord:</span>
<a name="l00215"></a>00215 <span class="comment">// Postcondition:</span>
<a name="l00216"></a>00216 <span class="comment">//</span>
<a name="l00217"></a>00217 <span class="comment">//</span><span class="comment"></span>
<a name="l00218"></a>00218 <span class="comment">//! Constructeur par un nom, une fonction et un tableau de meres.&lt;br&gt;La fonction permet de creer une instance du bon type.</span>
<a name="l00219"></a><a class="code" href="classType__info.html#a292e3a6795679e130c6a91b961fc38d1">00219</a> <span class="comment"></span><a class="code" href="classType__info.html#a292e3a6795679e130c6a91b961fc38d1" title="Constructeur par un nom, une fonction et un tableau de meres. La fonction permet de creer une instanc...">Type_info::Type_info</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* un_nom,
<a name="l00220"></a>00220                      <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>* (*f)(),
<a name="l00221"></a>00221                      <span class="keywordtype">int</span> nb_base,
<a name="l00222"></a>00222                      <span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a>** the_bases) :
<a name="l00223"></a>00223   names_(un_nom),
<a name="l00224"></a>00224   name_((<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>*) 0),
<a name="l00225"></a>00225   synonym_name_((<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>*) 0),
<a name="l00226"></a>00226   nb_bases_(nb_base),
<a name="l00227"></a>00227   b(the_bases),
<a name="l00228"></a>00228   cree_instance(f)
<a name="l00229"></a>00229 {
<a name="l00230"></a>00230   <span class="keywordflow">if</span>(un_nom == 0)
<a name="l00231"></a>00231     {
<a name="l00232"></a>00232       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Type_info::Type_info(const char* nom,Objet_U* (*f)()...)\n&quot;</span>;
<a name="l00233"></a>00233       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Error : name == 0&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00234"></a>00234       assert(0);
<a name="l00235"></a>00235       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237   <a class="code" href="classType__info.html#aed129a24841aaac52a0da3b18d3a8a58" title="Methode statique appelee par les constructeurs de Type_info pour ajouter un nouveau type a la liste d...">ajouter_type</a>(*<span class="keyword">this</span>);
<a name="l00238"></a>00238 }
<a name="l00239"></a>00239 
<a name="l00240"></a>00240 <span class="comment">//</span>
<a name="l00241"></a>00241 <span class="comment">//</span>
<a name="l00242"></a>00242 <span class="comment">//</span><span class="comment"></span>
<a name="l00243"></a>00243 <span class="comment">//! Methode statique appelee par les constructeurs de Type_info pour&lt;br&gt;ajouter un nouveau type a la liste des types enregistres.&lt;br&gt;Verifie que le nom du type n&#39;existe pas encore.</span>
<a name="l00244"></a><a class="code" href="classType__info.html#aed129a24841aaac52a0da3b18d3a8a58">00244</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classType__info.html#aed129a24841aaac52a0da3b18d3a8a58" title="Methode statique appelee par les constructeurs de Type_info pour ajouter un nouveau type a la liste d...">Type_info::ajouter_type</a>(<span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a>&amp; type_info)
<a name="l00245"></a>00245 {
<a name="l00246"></a>00246 <span class="comment">// Split type_info.names_ into A if | is found (eg: n=A|B)</span>
<a name="l00247"></a>00247 <span class="comment">// and add a synonym B</span>
<a name="l00248"></a>00248   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> A(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00249"></a>00249   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> B(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00250"></a>00250   <span class="keywordtype">int</span> synonym_found=0;
<a name="l00251"></a>00251   <span class="keywordtype">int</span> i = 0;
<a name="l00252"></a>00252   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c;
<a name="l00253"></a>00253   <span class="keywordflow">do</span> <span class="comment">//!&lt; Start loop</span>
<a name="l00254"></a>00254 <span class="comment"></span>    {
<a name="l00255"></a>00255       c = type_info.<a class="code" href="classType__info.html#a162e9046f5d74583e6bd7c1746fca5c3">names_</a>[i];
<a name="l00256"></a>00256 <span class="comment">// Find a |</span>
<a name="l00257"></a>00257       <span class="keywordflow">if</span> (c==124)
<a name="l00258"></a>00258         {
<a name="l00259"></a>00259           <span class="keywordflow">if</span> (synonym_found==1)
<a name="l00260"></a>00260             {
<a name="l00261"></a>00261               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;More than 1 synonym found in &quot;</span> &lt;&lt; type_info.<a class="code" href="classType__info.html#a162e9046f5d74583e6bd7c1746fca5c3">names_</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00262"></a>00262               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Not supported yet !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00263"></a>00263               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00264"></a>00264             }
<a name="l00265"></a>00265           <span class="keywordflow">else</span>
<a name="l00266"></a>00266             {
<a name="l00267"></a>00267               synonym_found=1;
<a name="l00268"></a>00268               i++;
<a name="l00269"></a>00269               c = type_info.<a class="code" href="classType__info.html#a162e9046f5d74583e6bd7c1746fca5c3">names_</a>[i];
<a name="l00270"></a>00270               <span class="keywordflow">if</span> (c==0)
<a name="l00271"></a>00271                 {
<a name="l00272"></a>00272                   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in a classname which can&#39;t finished by | : &quot;</span> &lt;&lt; type_info.<a class="code" href="classType__info.html#a162e9046f5d74583e6bd7c1746fca5c3">names_</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00273"></a>00273                   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00274"></a>00274                 }
<a name="l00275"></a>00275             }
<a name="l00276"></a>00276         }
<a name="l00277"></a>00277 <span class="comment">// Build the synonym name:</span>
<a name="l00278"></a>00278       <span class="keywordflow">if</span> (synonym_found)
<a name="l00279"></a>00279         B+=c;
<a name="l00280"></a>00280       <span class="keywordflow">else</span>
<a name="l00281"></a>00281         A+=c;
<a name="l00282"></a>00282       i++;
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284   <span class="keywordflow">while</span> (c!=0); <span class="comment">//!&lt; End loop</span>
<a name="l00285"></a>00285 <span class="comment"></span>
<a name="l00286"></a>00286   <a class="code" href="classType__info.html#abf2205f043a8185bea074c55dee97d08" title="(eg: A)">name_</a> = <span class="keyword">new</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(A);
<a name="l00287"></a>00287   <span class="keywordflow">if</span> (synonym_found)
<a name="l00288"></a>00288     {
<a name="l00289"></a>00289 <span class="comment">// Commented cause too verbose:</span>
<a name="l00290"></a>00290 <span class="comment">// Cerr &lt;&lt; &quot;Keyword &quot; &lt;&lt; A &lt;&lt; &quot; has a synonym: &quot; &lt;&lt; B &lt;&lt; finl;</span>
<a name="l00291"></a>00291       <a class="code" href="classType__info.html#a5e2534805f58ee3e3ef5912a8827d33f" title="(eg: B) Object synonym:">synonym_name_</a> = <span class="keyword">new</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(B);
<a name="l00292"></a>00292       <a class="code" href="classType__info.html#ac1dda6db4d271c66f894e3b264093dbb" title="Synonym.">synonym_</a> = <span class="keyword">new</span> <a class="code" href="classSynonyme__info.html" title="modelise une information de synonyme pour les Objet_U">Synonyme_info</a>(<a class="code" href="classType__info.html#a5e2534805f58ee3e3ef5912a8827d33f" title="(eg: B) Object synonym:">synonym_name_</a>-&gt;<a class="code" href="classNom.html#aa9f24bd3370b5f1c66666e65252eea05">getChar</a>(),<a class="code" href="classType__info.html#abf2205f043a8185bea074c55dee97d08" title="(eg: A)">name_</a>-&gt;<a class="code" href="classNom.html#aa9f24bd3370b5f1c66666e65252eea05">getChar</a>());
<a name="l00293"></a>00293     }
<a name="l00294"></a>00294 <span class="comment">// Verifie qu&#39;il y a assez de place dans le tableau :</span>
<a name="l00295"></a>00295   <span class="keywordflow">if</span> (<a class="code" href="classType__info.html#a6a41434bc3f14d2771eb8eaa2090c5ca">les_types_memsize</a> &lt;= <a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a> + 1)
<a name="l00296"></a>00296     {
<a name="l00297"></a>00297       <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> INCREMENT = 512;
<a name="l00298"></a>00298 <span class="comment">// Plus assez de place dans le tableau: on redimensionne.</span>
<a name="l00299"></a>00299       <a class="code" href="classType__info.html#a6a41434bc3f14d2771eb8eaa2090c5ca">les_types_memsize</a> += INCREMENT;
<a name="l00300"></a>00300       <span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a>** nouveau = <span class="keyword">new</span> <span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a>*[<a class="code" href="classType__info.html#a6a41434bc3f14d2771eb8eaa2090c5ca">les_types_memsize</a>];
<a name="l00301"></a>00301       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a>; j++)
<a name="l00302"></a>00302         nouveau[j] = <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[j];
<a name="l00303"></a>00303       <span class="keyword">delete</span>[] <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>;
<a name="l00304"></a>00304       <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a> = nouveau;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306       <span class="keywordtype">int</span> * temp = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classType__info.html#a6a41434bc3f14d2771eb8eaa2090c5ca">les_types_memsize</a>];
<a name="l00307"></a>00307       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a>; j++)
<a name="l00308"></a>00308         temp[j] = <a class="code" href="classType__info.html#aefa2e065733773d08b1d0fb853d66136">types_homonymes</a>[j];
<a name="l00309"></a>00309       <span class="keyword">delete</span>[] <a class="code" href="classType__info.html#aefa2e065733773d08b1d0fb853d66136">types_homonymes</a>;
<a name="l00310"></a>00310       <a class="code" href="classType__info.html#aefa2e065733773d08b1d0fb853d66136">types_homonymes</a> = temp;
<a name="l00311"></a>00311     }
<a name="l00312"></a>00312 
<a name="l00313"></a>00313 <span class="comment">// On cherche ou mettre le type dans le tableau :</span>
<a name="l00314"></a>00314   <span class="keywordtype">int</span> existe_deja=<a class="code" href="classSynonyme__info.html#a5cca36b7acd77f0a792fabc92f17ee87" title="Test d&#39;existence d&#39;une classe du synonyme indique si il existe une classe T dont le Synonyme_info a l...">Synonyme_info::est_un_synonyme</a>(type_info.<a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>());
<a name="l00315"></a>00315   <span class="keywordflow">if</span> (existe_deja)
<a name="l00316"></a>00316     {
<a name="l00317"></a>00317       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; class &quot;</span>&lt;&lt;type_info.<a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>()&lt;&lt;<span class="stringliteral">&quot; already exists as a synonym which is forbidden!!!!&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00318"></a>00318       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00319"></a>00319     }
<a name="l00320"></a>00320   <span class="keywordtype">int</span> index;
<a name="l00321"></a>00321   existe_deja = <a class="code" href="classType__info.html#a34add11ef2b9a1e0dc9c87c56eb69ae9" title="Recherche le type de nom &quot;nom&quot; dans la liste de types enregistres par une recherche binaire...">search_type_info_name</a>(type_info.<a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>(), index);
<a name="l00322"></a>00322   <span class="keywordflow">if</span> (existe_deja)
<a name="l00323"></a>00323     {
<a name="l00324"></a>00324       <a class="code" href="classType__info.html#aefa2e065733773d08b1d0fb853d66136">types_homonymes</a>[index] = 1;
<a name="l00325"></a>00325 <span class="comment">// GF: si on a un homonyme que la macro string_macro_trio fonctionne</span>
<a name="l00326"></a>00326 <span class="comment">// on a un pb sauf pour les iterateurs</span>
<a name="l00327"></a>00327       <span class="keywordflow">if</span> (strcmp(<a class="code" href="generique_8h.html#a2d139adfdc75efdde7ba4415f7b3c3d9">string_macro_trio</a>(<span class="stringliteral">&quot;VECT&quot;</span>,titi),<span class="stringliteral">&quot;VECT&quot;</span>))
<a name="l00328"></a>00328         {
<a name="l00329"></a>00329           <span class="keywordflow">if</span> (strncmp(type_info.<a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>(),<span class="stringliteral">&quot;Iterateur_&quot;</span>,10))
<a name="l00330"></a>00330             {
<a name="l00331"></a>00331               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; type &quot;</span>&lt;&lt;type_info.<a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>()&lt;&lt;<span class="stringliteral">&quot; is in double and it is not allowed!!!!&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00332"></a>00332               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00333"></a>00333             }
<a name="l00334"></a>00334         }
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336   <span class="keywordflow">else</span>
<a name="l00337"></a>00337     {
<a name="l00338"></a>00338 <span class="comment">// Ajout du type dans le tableau a l&#39;indice &quot;index&quot;:</span>
<a name="l00339"></a>00339       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = <a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a>; j &gt; index; j--)
<a name="l00340"></a>00340         {
<a name="l00341"></a>00341           <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[j] = <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[j-1];
<a name="l00342"></a>00342           <a class="code" href="classType__info.html#aefa2e065733773d08b1d0fb853d66136">types_homonymes</a>[j] = <a class="code" href="classType__info.html#aefa2e065733773d08b1d0fb853d66136">types_homonymes</a>[j-1];
<a name="l00343"></a>00343         }
<a name="l00344"></a>00344       <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[index] = &amp;type_info;
<a name="l00345"></a>00345       <a class="code" href="classType__info.html#aefa2e065733773d08b1d0fb853d66136">types_homonymes</a>[index] = 0;
<a name="l00346"></a>00346       <a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a>++;
<a name="l00347"></a>00347     }
<a name="l00348"></a>00348 }
<a name="l00349"></a>00349 
<a name="l00350"></a>00350 <span class="comment">// Precondition:</span>
<a name="l00351"></a>00351 <span class="comment">// Parametre: Sortie&amp; os</span>
<a name="l00352"></a>00352 <span class="comment">// Signification: flot de sortie</span>
<a name="l00353"></a>00353 <span class="comment">// Valeurs par defaut:</span>
<a name="l00354"></a>00354 <span class="comment">// Contraintes:</span>
<a name="l00355"></a>00355 <span class="comment">// Acces: entree/sortie</span>
<a name="l00356"></a>00356 <span class="comment">// Exception:</span>
<a name="l00357"></a>00357 <span class="comment">// Effets de bord:</span>
<a name="l00358"></a>00358 <span class="comment">// Postcondition:</span>
<a name="l00359"></a>00359 <span class="comment">//</span><span class="comment"></span>
<a name="l00360"></a>00360 <span class="comment">//! Ecriture des bases du type considere sur un flot de sortie</span>
<a name="l00361"></a>00361 <span class="comment"></span><span class="comment">/** \return Sortie\&amp;&lt;br&gt;</span>
<a name="l00362"></a>00362 <span class="comment">Signification: le flot de sortie modifie&lt;br&gt;</span>
<a name="l00363"></a>00363 <span class="comment">Contraintes: */</span>
<a name="l00364"></a><a class="code" href="classType__info.html#ac3159ec7adabda56a382e7d25d404f24">00364</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classType__info.html#ac3159ec7adabda56a382e7d25d404f24" title="Ecriture des bases du type considere sur un flot de sortie.">Type_info::bases</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00365"></a>00365 <span class="keyword"></span>{
<a name="l00366"></a>00366   <span class="keywordtype">int</span> i= <a class="code" href="classType__info.html#a166fc5732d940399584c38f6fda3e203">nb_bases_</a>;
<a name="l00367"></a>00367   <span class="keywordflow">while</span>(i--)
<a name="l00368"></a>00368     os &lt;&lt; <a class="code" href="classType__info.html#af658ff13a996a871f3640ec2e87cf49e">b</a>[i]-&gt;<a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00369"></a>00369   <span class="keywordflow">return</span> os &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00370"></a>00370 }
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 <span class="comment">// Precondition:</span>
<a name="l00373"></a>00373 <span class="comment">// Parametre: Sortie&amp; os</span>
<a name="l00374"></a>00374 <span class="comment">// Signification: flot de sortie</span>
<a name="l00375"></a>00375 <span class="comment">// Valeurs par defaut:</span>
<a name="l00376"></a>00376 <span class="comment">// Contraintes:</span>
<a name="l00377"></a>00377 <span class="comment">// Acces: entree/sortie</span>
<a name="l00378"></a>00378 <span class="comment">// Exception:</span>
<a name="l00379"></a>00379 <span class="comment">// Effets de bord:</span>
<a name="l00380"></a>00380 <span class="comment">// Postcondition:</span>
<a name="l00381"></a>00381 <span class="comment">//</span><span class="comment"></span>
<a name="l00382"></a>00382 <span class="comment">//! Ecriture de toute la hierarchie du type considere sur un flix de sortie</span>
<a name="l00383"></a>00383 <span class="comment"></span><span class="comment">/** \return Sortie\&amp;&lt;br&gt;</span>
<a name="l00384"></a>00384 <span class="comment">Signification: le flot de sortie modifie&lt;br&gt;</span>
<a name="l00385"></a>00385 <span class="comment">Contraintes: */</span>
<a name="l00386"></a><a class="code" href="classType__info.html#aad48b1f59d3d7b01ce0cfe4592282fda">00386</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classType__info.html#aad48b1f59d3d7b01ce0cfe4592282fda" title="Ecriture de toute la hierarchie du type considere sur un flix de sortie.">Type_info::hierarchie</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)
<a name="l00387"></a>00387 {
<a name="l00388"></a>00388   os &lt;&lt; <span class="stringliteral">&quot;There is &quot;</span> &lt;&lt; <a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a> &lt;&lt; <span class="stringliteral">&quot; classes:&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00389"></a>00389   <span class="keywordtype">int</span> i= <a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a>;
<a name="l00390"></a>00390   <span class="keywordflow">while</span>(i--)
<a name="l00391"></a>00391     {
<a name="l00392"></a>00392       os &lt;&lt; <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[i]-&gt;<a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>() &lt;&lt; <span class="stringliteral">&quot; inherits from &quot;</span>;
<a name="l00393"></a>00393       <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[i]-&gt;<a class="code" href="classType__info.html#ac3159ec7adabda56a382e7d25d404f24" title="Ecriture des bases du type considere sur un flot de sortie.">bases</a>(os);
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395   <span class="keywordflow">return</span> os &lt;&lt; flush;
<a name="l00396"></a>00396 }
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 <span class="comment">// Precondition:</span>
<a name="l00399"></a>00399 <span class="comment">// Parametre: const char* typ</span>
<a name="l00400"></a>00400 <span class="comment">// Signification: chaine de caractere associee a un type</span>
<a name="l00401"></a>00401 <span class="comment">// Valeurs par defaut:</span>
<a name="l00402"></a>00402 <span class="comment">// Contraintes:</span>
<a name="l00403"></a>00403 <span class="comment">// Acces: entree</span>
<a name="l00404"></a>00404 <span class="comment">// Exception:</span>
<a name="l00405"></a>00405 <span class="comment">// Effets de bord:</span>
<a name="l00406"></a>00406 <span class="comment">// Creation d&#39;un nouvel Objet_U s&#39;il existe une classe de type typ</span>
<a name="l00407"></a>00407 <span class="comment">// Postcondition:</span>
<a name="l00408"></a>00408 <span class="comment">//</span>
<a name="l00409"></a>00409 <span class="comment">//</span>
<a name="l00410"></a>00410 <span class="comment">//</span>
<a name="l00411"></a>00411 <span class="comment">//</span>
<a name="l00412"></a>00412 <span class="comment">//</span><span class="comment"></span>
<a name="l00413"></a>00413 <span class="comment">//! Instanciation d&#39;un Objet_U du type indique&lt;br&gt;S&#39;il existe une classe T dont le Type_info a&lt;br&gt;le nom typ, alors instance renvoie un pointeur&lt;br&gt;sur une nouvelle instance de T.&lt;br&gt;renvoie le pointeur nul sinon.</span>
<a name="l00414"></a>00414 <span class="comment"></span><span class="comment">/** \return Objet_U*&lt;br&gt;</span>
<a name="l00415"></a>00415 <span class="comment">Signification: pointeur sur un nouvel Objet_U du type typ&lt;br&gt;</span>
<a name="l00416"></a>00416 <span class="comment">Contraintes: */</span>
<a name="l00417"></a><a class="code" href="classType__info.html#ad1fa92e3f428801201d374f18875db5f">00417</a> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>* <a class="code" href="classType__info.html#afa4b59a996405af3dbe9aa0167e43b61" title="Cree une instance de la classe associee au type_info.">Type_info::instance</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* typ)
<a name="l00418"></a>00418 {
<a name="l00419"></a>00419   <span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a> * le_type = <a class="code" href="classType__info.html#ab37d59e931ab9761812e24ed99842a43" title="Methode statique qui renvoie un pointeur vers le Type_info dont le nom est &quot;type_name&quot;. Si type_name n&#39;est pas un type, renvoie un pointeur nul.">type_info_from_name</a>(typ);
<a name="l00420"></a>00420   <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a> * <a class="code" href="classType__info.html#afa4b59a996405af3dbe9aa0167e43b61" title="Cree une instance de la classe associee au type_info.">instance</a>;
<a name="l00421"></a>00421   <span class="keywordflow">if</span> (le_type)
<a name="l00422"></a>00422     instance = le_type-&gt;<a class="code" href="classType__info.html#afa4b59a996405af3dbe9aa0167e43b61" title="Cree une instance de la classe associee au type_info.">instance</a>();
<a name="l00423"></a>00423   <span class="keywordflow">else</span>
<a name="l00424"></a>00424     instance = 0;
<a name="l00425"></a>00425   <span class="keywordflow">return</span> <a class="code" href="classType__info.html#afa4b59a996405af3dbe9aa0167e43b61" title="Cree une instance de la classe associee au type_info.">instance</a>;
<a name="l00426"></a>00426 }
<a name="l00427"></a>00427 
<a name="l00428"></a>00428 <span class="comment">// Precondition:</span>
<a name="l00429"></a>00429 <span class="comment">// La classe doit etre instanciable (sinon arret du programme).</span>
<a name="l00430"></a>00430 <span class="comment">// Effets de bord:</span>
<a name="l00431"></a>00431 <span class="comment">// Creation d&#39;un nouvel Objet_U</span>
<a name="l00432"></a>00432 <span class="comment">//</span><span class="comment"></span>
<a name="l00433"></a>00433 <span class="comment">//! Cree une instance de la classe associee au type_info.</span>
<a name="l00434"></a><a class="code" href="classType__info.html#afa4b59a996405af3dbe9aa0167e43b61">00434</a> <span class="comment"></span><a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>* <a class="code" href="classType__info.html#afa4b59a996405af3dbe9aa0167e43b61" title="Cree une instance de la classe associee au type_info.">Type_info::instance</a>()<span class="keyword"> const</span>
<a name="l00435"></a>00435 <span class="keyword"></span>{
<a name="l00436"></a>00436   <span class="keywordflow">if</span> (<a class="code" href="classType__info.html#af6e19128e6c8e3ffa1d28923b8053a46">cree_instance</a> == 0)
<a name="l00437"></a>00437     {
<a name="l00438"></a>00438       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Type_info::instance()\n&quot;</span>;
<a name="l00439"></a>00439       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; The type &quot;</span> &lt;&lt; <a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>() &lt;&lt; <span class="stringliteral">&quot; is not instantiable&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00440"></a>00440       assert(0);
<a name="l00441"></a>00441       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00442"></a>00442     }
<a name="l00443"></a>00443   <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a> * ainstance = (*cree_instance)();
<a name="l00444"></a>00444   <span class="keywordflow">return</span> ainstance;
<a name="l00445"></a>00445 }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 <span class="comment">// Precondition:</span>
<a name="l00448"></a>00448 <span class="comment">// Parametre: const char* nom</span>
<a name="l00449"></a>00449 <span class="comment">// Signification: chaine de caractere associee a un type</span>
<a name="l00450"></a>00450 <span class="comment">// Valeurs par defaut:</span>
<a name="l00451"></a>00451 <span class="comment">// Contraintes:</span>
<a name="l00452"></a>00452 <span class="comment">// Acces:</span>
<a name="l00453"></a>00453 <span class="comment">// Exception:</span>
<a name="l00454"></a>00454 <span class="comment">// Effets de bord:</span>
<a name="l00455"></a>00455 <span class="comment">// Postcondition:</span>
<a name="l00456"></a>00456 <span class="comment">//</span>
<a name="l00457"></a>00457 <span class="comment">//</span>
<a name="l00458"></a>00458 <span class="comment">//</span>
<a name="l00459"></a>00459 <span class="comment">//</span><span class="comment"></span>
<a name="l00460"></a>00460 <span class="comment">//! Test d&#39;existence d&#39;une classe du type indique&lt;br&gt;si il existe une classe T dont le Type_info a&lt;br&gt;le nom nom, alors est_un_type renvoie 1&lt;br&gt;renvoie le pointeur nul sinon.</span>
<a name="l00461"></a>00461 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00462"></a>00462 <span class="comment">Signification: code de retour (0 ou  1)&lt;br&gt;</span>
<a name="l00463"></a>00463 <span class="comment">Contraintes: */</span>
<a name="l00464"></a><a class="code" href="classType__info.html#a88e7068fd06bbded90b11681f8efb384">00464</a> <span class="keywordtype">int</span> <a class="code" href="classType__info.html#a88e7068fd06bbded90b11681f8efb384" title="Test d&#39;existence d&#39;une classe du type indique si il existe une classe T dont le Type_info a le nom no...">Type_info::est_un_type</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* nom)
<a name="l00465"></a>00465 {
<a name="l00466"></a>00466   <span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a> * type = <a class="code" href="classType__info.html#ab37d59e931ab9761812e24ed99842a43" title="Methode statique qui renvoie un pointeur vers le Type_info dont le nom est &quot;type_name&quot;. Si type_name n&#39;est pas un type, renvoie un pointeur nul.">type_info_from_name</a>(nom);
<a name="l00467"></a>00467   <span class="keywordflow">return</span> (type != 0);
<a name="l00468"></a>00468 }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 <span class="comment">// Precondition:</span>
<a name="l00471"></a>00471 <span class="comment">// Parametre: const Type_info* p</span>
<a name="l00472"></a>00472 <span class="comment">// Signification: le pointeur sur le type a rechercher</span>
<a name="l00473"></a>00473 <span class="comment">// Valeurs par defaut:</span>
<a name="l00474"></a>00474 <span class="comment">// Contraintes:</span>
<a name="l00475"></a>00475 <span class="comment">// Acces: entree</span>
<a name="l00476"></a>00476 <span class="comment">// Parametre: int direct</span>
<a name="l00477"></a>00477 <span class="comment">// Signification: 0 pour une recherche dans toute la hierarchie des bases, non nul pour une recherche directe</span>
<a name="l00478"></a>00478 <span class="comment">// Valeurs par defaut:</span>
<a name="l00479"></a>00479 <span class="comment">// Contraintes:</span>
<a name="l00480"></a>00480 <span class="comment">// Acces: entree</span>
<a name="l00481"></a>00481 <span class="comment">// Exception:</span>
<a name="l00482"></a>00482 <span class="comment">// Effets de bord:</span>
<a name="l00483"></a>00483 <span class="comment">// Postcondition:</span>
<a name="l00484"></a>00484 <span class="comment">//</span>
<a name="l00485"></a>00485 <span class="comment">//</span>
<a name="l00486"></a>00486 <span class="comment">//</span>
<a name="l00487"></a>00487 <span class="comment">//</span>
<a name="l00488"></a>00488 <span class="comment">//</span>
<a name="l00489"></a>00489 <span class="comment">//</span>
<a name="l00490"></a>00490 <span class="comment">//</span>
<a name="l00491"></a>00491 <span class="comment">//</span><span class="comment"></span>
<a name="l00492"></a>00492 <span class="comment">//! Test d&#39;appartenance d&#39;un type dans les types de bases du type considere&lt;br&gt;si direct == 0&lt;br&gt;renvoie 1 si (*p) fait partie des bases de (*this)&lt;br&gt;renvoie 0 sinon.&lt;br&gt;si direct != 0&lt;br&gt;renvoie 1 si (*p) fait partie des bases de (*this)&lt;br&gt;ou des meres directes ou non de (*this)&lt;br&gt;renvoie 0 sinon.</span>
<a name="l00493"></a>00493 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00494"></a>00494 <span class="comment">Signification: code de retour (0 ou 1)&lt;br&gt;</span>
<a name="l00495"></a>00495 <span class="comment">Contraintes: */</span>
<a name="l00496"></a><a class="code" href="classType__info.html#ac61d373559ee51190d5caddaf26882e1">00496</a> <span class="keywordtype">int</span> <a class="code" href="classType__info.html#ac61d373559ee51190d5caddaf26882e1" title="Test d&#39;appartenance d&#39;un type dans les types de bases du type considere si direct == 0 renvoie 1 si (...">Type_info::has_base</a>(<span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a>* p, <span class="keywordtype">int</span> direct)<span class="keyword"> const</span>
<a name="l00497"></a>00497 <span class="keyword"></span>{
<a name="l00498"></a>00498 <span class="comment">// recherche de p-&gt;name() dans b</span>
<a name="l00499"></a>00499 <span class="comment">// si trouve return 1</span>
<a name="l00500"></a>00500 <span class="comment">// sinon si pas direct return 0;</span>
<a name="l00501"></a>00501 <span class="comment">// sinon recherche dans les bases de b</span>
<a name="l00502"></a>00502 <span class="comment">// Modif de B. Mathieu: test uniquement sur l&#39;adresse du type_info,</span>
<a name="l00503"></a>00503 <span class="comment">// pas sur le nom du type...</span>
<a name="l00504"></a>00504   <span class="keywordflow">if</span> (p == 0)
<a name="l00505"></a>00505     {
<a name="l00506"></a>00506       <span class="keywordflow">return</span> 0;
<a name="l00507"></a>00507     }
<a name="l00508"></a>00508   <span class="keywordflow">else</span>
<a name="l00509"></a>00509     {
<a name="l00510"></a>00510       <span class="keywordflow">if</span> (p == <span class="keyword">this</span>)
<a name="l00511"></a>00511         {
<a name="l00512"></a>00512           <span class="keywordflow">return</span> 1;
<a name="l00513"></a>00513         }
<a name="l00514"></a>00514       <span class="keywordflow">else</span>
<a name="l00515"></a>00515         {
<a name="l00516"></a>00516           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classType__info.html#a166fc5732d940399584c38f6fda3e203">nb_bases_</a>; i++)
<a name="l00517"></a>00517             <span class="keywordflow">if</span> (<a class="code" href="classType__info.html#af658ff13a996a871f3640ec2e87cf49e">b</a>[i] == p)
<a name="l00518"></a>00518               <span class="keywordflow">return</span> 1;
<a name="l00519"></a>00519           <span class="keywordflow">if</span> (!direct)
<a name="l00520"></a>00520             {
<a name="l00521"></a>00521 <span class="comment">// Verifier les ancetres de niveau superieur</span>
<a name="l00522"></a>00522               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classType__info.html#a166fc5732d940399584c38f6fda3e203">nb_bases_</a>; i++)
<a name="l00523"></a>00523                 <span class="keywordflow">if</span> (<a class="code" href="classType__info.html#af658ff13a996a871f3640ec2e87cf49e">b</a>[i]-&gt;<a class="code" href="classType__info.html#ac61d373559ee51190d5caddaf26882e1" title="Test d&#39;appartenance d&#39;un type dans les types de bases du type considere si direct == 0 renvoie 1 si (...">has_base</a>(p, direct)) <span class="keywordflow">return</span> 1;
<a name="l00524"></a>00524             }
<a name="l00525"></a>00525         }
<a name="l00526"></a>00526     }
<a name="l00527"></a>00527   <span class="keywordflow">return</span> 0;
<a name="l00528"></a>00528 }
<a name="l00529"></a>00529 
<a name="l00530"></a>00530 <span class="comment">// Precondition:</span>
<a name="l00531"></a>00531 <span class="comment">// Parametre: const Nom&amp; name</span>
<a name="l00532"></a>00532 <span class="comment">// Signification: le nom du type a rechercher</span>
<a name="l00533"></a>00533 <span class="comment">// Valeurs par defaut:</span>
<a name="l00534"></a>00534 <span class="comment">// Contraintes:</span>
<a name="l00535"></a>00535 <span class="comment">// Acces: entree</span>
<a name="l00536"></a>00536 <span class="comment">// Parametre: int direct</span>
<a name="l00537"></a>00537 <span class="comment">// Signification: 0 pour une recherche dans toute la hierarchie des bases, non nul pour une recherche directe</span>
<a name="l00538"></a>00538 <span class="comment">// Valeurs par defaut:</span>
<a name="l00539"></a>00539 <span class="comment">// Contraintes:</span>
<a name="l00540"></a>00540 <span class="comment">// Acces: entree</span>
<a name="l00541"></a>00541 <span class="comment">// Exception:</span>
<a name="l00542"></a>00542 <span class="comment">// Effets de bord:</span>
<a name="l00543"></a>00543 <span class="comment">// Postcondition:</span>
<a name="l00544"></a>00544 <span class="comment">//</span>
<a name="l00545"></a>00545 <span class="comment">//</span>
<a name="l00546"></a>00546 <span class="comment">//</span>
<a name="l00547"></a>00547 <span class="comment">//</span>
<a name="l00548"></a>00548 <span class="comment">//</span>
<a name="l00549"></a>00549 <span class="comment">//</span>
<a name="l00550"></a>00550 <span class="comment">//</span>
<a name="l00551"></a>00551 <span class="comment">//</span>
<a name="l00552"></a>00552 <span class="comment">//</span><span class="comment"></span>
<a name="l00553"></a>00553 <span class="comment">//! Test d&#39;appartenance d&#39;un type dans les types de bases du type considere&lt;br&gt;Le type a rechercher est identifie par son nom&lt;br&gt;si direct == 0&lt;br&gt;renvoie 1 si le type de nom name fait partie des bases de (*this)&lt;br&gt;renvoie 0 sinon.&lt;br&gt;si direct != 0&lt;br&gt;renvoie 1 si le type de nom name fait partie des bases de (*this)&lt;br&gt;ou des meres directes ou non de (*this)&lt;br&gt;renvoie 0 sinon.</span>
<a name="l00554"></a>00554 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00555"></a>00555 <span class="comment">Signification: code de retour (0 ou 1)&lt;br&gt;</span>
<a name="l00556"></a>00556 <span class="comment">Contraintes: */</span>
<a name="l00557"></a><a class="code" href="classType__info.html#add877771ae46e2e6e4b8982a1c2af7d5">00557</a> <span class="keywordtype">int</span> <a class="code" href="classType__info.html#ac61d373559ee51190d5caddaf26882e1" title="Test d&#39;appartenance d&#39;un type dans les types de bases du type considere si direct == 0 renvoie 1 si (...">Type_info::has_base</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; aname, <span class="keywordtype">int</span> direct)<span class="keyword"> const</span>
<a name="l00558"></a>00558 <span class="keyword"></span>{
<a name="l00559"></a>00559 <span class="comment">// recherche de aname dans b</span>
<a name="l00560"></a>00560 <span class="comment">// si trouve return 1</span>
<a name="l00561"></a>00561 <span class="comment">// sinon si pas direct return 0;</span>
<a name="l00562"></a>00562 <span class="comment">// sinon recherche dans les bases de b</span>
<a name="l00563"></a>00563 <span class="comment">// Modif B. Mathieu: comparaison des adresses du Type_info uniquement,</span>
<a name="l00564"></a>00564 <span class="comment">// pas du nom du type.</span>
<a name="l00565"></a>00565 
<a name="l00566"></a>00566   <span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a> * type = <a class="code" href="classType__info.html#ab37d59e931ab9761812e24ed99842a43" title="Methode statique qui renvoie un pointeur vers le Type_info dont le nom est &quot;type_name&quot;. Si type_name n&#39;est pas un type, renvoie un pointeur nul.">type_info_from_name</a>(aname);
<a name="l00567"></a>00567   <span class="keywordtype">int</span> resultat = <a class="code" href="classType__info.html#ac61d373559ee51190d5caddaf26882e1" title="Test d&#39;appartenance d&#39;un type dans les types de bases du type considere si direct == 0 renvoie 1 si (...">has_base</a>(type, direct);
<a name="l00568"></a>00568   <span class="keywordflow">return</span> resultat;
<a name="l00569"></a>00569 }
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 <span class="comment">//</span>
<a name="l00572"></a>00572 <span class="comment">//</span>
<a name="l00573"></a>00573 <span class="comment">//</span><span class="comment"></span>
<a name="l00574"></a>00574 <span class="comment">//! Comparaison sur le nom d&#39;un type&lt;br&gt;Retourne 1 si les chaines de caracteres des noms du type considere et du nom indique sont identiques&lt;br&gt;Retour 0 sinon</span>
<a name="l00575"></a><a class="code" href="classType__info.html#a9c1b7c54c3bdbaf5dcea4492be021e6f">00575</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classType__info.html#a1320edd811b44634a323248048f63a7e" title="Renvoie 1 si this==p, 0 sinon.">Type_info::same</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; other_name)<span class="keyword"> const</span>
<a name="l00576"></a>00576 <span class="keyword"></span>{
<a name="l00577"></a>00577   <span class="keywordflow">return</span> strcmp(<a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>(),other_name)==0;
<a name="l00578"></a>00578 }
<a name="l00579"></a>00579 
<a name="l00580"></a>00580 <span class="comment">//</span><span class="comment"></span>
<a name="l00581"></a>00581 <span class="comment">//! Renvoie 1 si this==p, 0 sinon.</span>
<a name="l00582"></a><a class="code" href="classType__info.html#a1320edd811b44634a323248048f63a7e">00582</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classType__info.html#a1320edd811b44634a323248048f63a7e" title="Renvoie 1 si this==p, 0 sinon.">Type_info::same</a>(<span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a>* p)<span class="keyword"> const</span>
<a name="l00583"></a>00583 <span class="keyword"></span>{
<a name="l00584"></a>00584   <span class="keywordflow">return</span> (<span class="keyword">this</span> == p);
<a name="l00585"></a>00585 }
<a name="l00586"></a>00586 
<a name="l00587"></a>00587 <span class="comment">// Precondition:</span>
<a name="l00588"></a>00588 <span class="comment">// Parametre: const Type_info&amp; mere</span>
<a name="l00589"></a>00589 <span class="comment">// Signification: le type sur lequel rechercher les sous-types</span>
<a name="l00590"></a>00590 <span class="comment">// Valeurs par defaut:</span>
<a name="l00591"></a>00591 <span class="comment">// Contraintes:</span>
<a name="l00592"></a>00592 <span class="comment">// Acces: entree</span>
<a name="l00593"></a>00593 <span class="comment">// Parametre: Noms&amp; les_sous_types</span>
<a name="l00594"></a>00594 <span class="comment">// Signification: les noms des sous-types</span>
<a name="l00595"></a>00595 <span class="comment">// Valeurs par defaut:</span>
<a name="l00596"></a>00596 <span class="comment">// Contraintes:</span>
<a name="l00597"></a>00597 <span class="comment">// Acces: sortie</span>
<a name="l00598"></a>00598 <span class="comment">// Exception:</span>
<a name="l00599"></a>00599 <span class="comment">// Effets de bord:</span>
<a name="l00600"></a>00600 <span class="comment">// Postcondition:</span>
<a name="l00601"></a>00601 <span class="comment">//</span><span class="comment"></span>
<a name="l00602"></a>00602 <span class="comment">//! Donne les noms des sous-types, un type mere etant donne</span>
<a name="l00603"></a>00603 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00604"></a>00604 <span class="comment">Signification: nombre de sous-types retournes&lt;br&gt;</span>
<a name="l00605"></a>00605 <span class="comment">Contraintes: */</span>
<a name="l00606"></a><a class="code" href="classType__info.html#a3ffac2b5d055fbc32d63fe370ccb3c78">00606</a> <span class="keywordtype">int</span> <a class="code" href="classType__info.html#a28bcfaa023a518d5c4bc940dead669a4" title="Donne les noms des sous-types, un type mere etant donne par son nom.">Type_info::les_sous_types</a>(<span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a>&amp; mere, <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; les_sous_types)
<a name="l00607"></a>00607 {
<a name="l00608"></a>00608   <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>=0;
<a name="l00609"></a>00609   <span class="keywordtype">int</span> i= <a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a>;
<a name="l00610"></a>00610 <span class="comment">// Modif B. Mathieu: name() ne renvoie plus un static.</span>
<a name="l00611"></a>00611   <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_mere = mere.<a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>();
<a name="l00612"></a>00612   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;---------&quot;</span> &lt;&lt; (<span class="keyword">const</span> <span class="keywordtype">char</span>*) nom_mere &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00613"></a>00613   <span class="keywordflow">while</span>(i--)
<a name="l00614"></a>00614     {
<a name="l00615"></a>00615       <span class="keywordflow">if</span>( <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[i]-&gt;<a class="code" href="classType__info.html#ac61d373559ee51190d5caddaf26882e1" title="Test d&#39;appartenance d&#39;un type dans les types de bases du type considere si direct == 0 renvoie 1 si (...">has_base</a>(nom_mere, 0) )
<a name="l00616"></a>00616         <span class="keywordflow">if</span> (!<a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[i]-&gt;<a class="code" href="classType__info.html#a1320edd811b44634a323248048f63a7e" title="Renvoie 1 si this==p, 0 sinon.">same</a>(nom_mere))
<a name="l00617"></a>00617           {
<a name="l00618"></a>00618             compteur++;
<a name="l00619"></a>00619           }
<a name="l00620"></a>00620     }
<a name="l00621"></a>00621   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; compteur &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a> ;
<a name="l00622"></a>00622   <span class="keywordflow">if</span>(compteur==0) <span class="keywordflow">return</span> 0;
<a name="l00623"></a>00623   les_sous_types.<a class="code" href="classvect__impl.html#ad841d6b676a796bae26ed2566b7b3b41">dimensionner</a>(compteur);
<a name="l00624"></a>00624   compteur=0;
<a name="l00625"></a>00625   i= <a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a>;
<a name="l00626"></a>00626   <span class="keywordflow">while</span>(i--)
<a name="l00627"></a>00627     {
<a name="l00628"></a>00628       <span class="keywordflow">if</span>( <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[i]-&gt;<a class="code" href="classType__info.html#ac61d373559ee51190d5caddaf26882e1" title="Test d&#39;appartenance d&#39;un type dans les types de bases du type considere si direct == 0 renvoie 1 si (...">has_base</a>(nom_mere, 0) )
<a name="l00629"></a>00629         <span class="keywordflow">if</span> (!<a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[i]-&gt;<a class="code" href="classType__info.html#a1320edd811b44634a323248048f63a7e" title="Renvoie 1 si this==p, 0 sinon.">same</a>(nom_mere))
<a name="l00630"></a>00630           {
<a name="l00631"></a>00631             les_sous_types[compteur++]=<a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[i]-&gt;<a class="code" href="classType__info.html#a1aa9c21734c5750238f5502727866302">name</a>();
<a name="l00632"></a>00632           }
<a name="l00633"></a>00633     }
<a name="l00634"></a>00634   <span class="keywordflow">return</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>;
<a name="l00635"></a>00635 }
<a name="l00636"></a>00636 
<a name="l00637"></a>00637 <span class="comment">// Precondition:</span>
<a name="l00638"></a>00638 <span class="comment">// Parametre: const Nom&amp; type</span>
<a name="l00639"></a>00639 <span class="comment">// Signification: le nom du type sur lequel rechercher les sous-types</span>
<a name="l00640"></a>00640 <span class="comment">// Valeurs par defaut:</span>
<a name="l00641"></a>00641 <span class="comment">// Contraintes: le nom doit correspondre a un type existant</span>
<a name="l00642"></a>00642 <span class="comment">// Acces: entree</span>
<a name="l00643"></a>00643 <span class="comment">// Parametre: Noms&amp; les_sous_types</span>
<a name="l00644"></a>00644 <span class="comment">// Signification: les noms des sous-types</span>
<a name="l00645"></a>00645 <span class="comment">// Valeurs par defaut:</span>
<a name="l00646"></a>00646 <span class="comment">// Contraintes:</span>
<a name="l00647"></a>00647 <span class="comment">// Acces: sortie</span>
<a name="l00648"></a>00648 <span class="comment">// Exception:</span>
<a name="l00649"></a>00649 <span class="comment">// Sort en erreur si le nom indique ne correspond pas a un type existant dans TRUST</span>
<a name="l00650"></a>00650 <span class="comment">// Effets de bord:</span>
<a name="l00651"></a>00651 <span class="comment">// Postcondition:</span>
<a name="l00652"></a>00652 <span class="comment">//</span><span class="comment"></span>
<a name="l00653"></a>00653 <span class="comment">//! Donne les noms des sous-types, un type mere etant donne par son nom</span>
<a name="l00654"></a>00654 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00655"></a>00655 <span class="comment">Signification: nombre de sous-types retournes&lt;br&gt;</span>
<a name="l00656"></a>00656 <span class="comment">Contraintes: */</span>
<a name="l00657"></a><a class="code" href="classType__info.html#a28bcfaa023a518d5c4bc940dead669a4">00657</a> <span class="keywordtype">int</span> <a class="code" href="classType__info.html#a28bcfaa023a518d5c4bc940dead669a4" title="Donne les noms des sous-types, un type mere etant donne par son nom.">Type_info::les_sous_types</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type, <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; sous_types)
<a name="l00658"></a>00658 {
<a name="l00659"></a>00659   <span class="keywordflow">if</span> (!<a class="code" href="classType__info.html#a88e7068fd06bbded90b11681f8efb384" title="Test d&#39;existence d&#39;une classe du type indique si il existe une classe T dont le Type_info a le nom no...">est_un_type</a>(type))
<a name="l00660"></a>00660     {
<a name="l00661"></a>00661       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; type &lt;&lt; <span class="stringliteral">&quot;is not a type recognized by TRUST Unitaire &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00662"></a>00662       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00663"></a>00663     }
<a name="l00664"></a>00664   <span class="keywordtype">int</span> i= <a class="code" href="classType__info.html#a1183245116dba3d760860eb376d7020e">nb_classes</a>;
<a name="l00665"></a>00665   <span class="keywordflow">while</span>(i--)
<a name="l00666"></a>00666     {
<a name="l00667"></a>00667       <span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a>&amp; mere = *<a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[i];
<a name="l00668"></a>00668       <span class="keywordflow">if</span>( <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[i]-&gt;<a class="code" href="classType__info.html#a1320edd811b44634a323248048f63a7e" title="Renvoie 1 si this==p, 0 sinon.">same</a>(type) )
<a name="l00669"></a>00669         {
<a name="l00670"></a>00670           <span class="keywordflow">return</span> <a class="code" href="classType__info.html#a28bcfaa023a518d5c4bc940dead669a4" title="Donne les noms des sous-types, un type mere etant donne par son nom.">les_sous_types</a>(mere, sous_types);
<a name="l00671"></a>00671         }
<a name="l00672"></a>00672     }
<a name="l00673"></a>00673   <span class="keywordflow">return</span> 0;
<a name="l00674"></a>00674 }
<a name="l00675"></a>00675 
<a name="l00676"></a>00676 <span class="comment">//</span>
<a name="l00677"></a>00677 <span class="comment">//</span>
<a name="l00678"></a>00678 <span class="comment">//</span><span class="comment"></span>
<a name="l00679"></a>00679 <span class="comment">//! Methode statique qui renvoie un pointeur vers le Type_info&lt;br&gt;dont le nom est &quot;type_name&quot;. Si type_name n&#39;est pas un type,&lt;br&gt;renvoie un pointeur nul.</span>
<a name="l00680"></a>00680 <span class="comment"></span>
<a name="l00681"></a><a class="code" href="classType__info.html#ab37d59e931ab9761812e24ed99842a43">00681</a> <span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a> * <a class="code" href="classType__info.html#ab37d59e931ab9761812e24ed99842a43" title="Methode statique qui renvoie un pointeur vers le Type_info dont le nom est &quot;type_name&quot;. Si type_name n&#39;est pas un type, renvoie un pointeur nul.">Type_info::type_info_from_name</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * type_name)
<a name="l00682"></a>00682 {
<a name="l00683"></a>00683   <span class="keyword">const</span> <a class="code" href="classType__info.html" title="modelise une information de type pour les Objet_U">Type_info</a> * type_info = 0;
<a name="l00684"></a>00684   <span class="keywordflow">if</span> (type_name != 0)
<a name="l00685"></a>00685     {
<a name="l00686"></a>00686       <span class="keywordtype">int</span> index;
<a name="l00687"></a>00687       <span class="keywordflow">if</span> (<a class="code" href="classType__info.html#a34add11ef2b9a1e0dc9c87c56eb69ae9" title="Recherche le type de nom &quot;nom&quot; dans la liste de types enregistres par une recherche binaire...">search_type_info_name</a>(type_name, index))
<a name="l00688"></a>00688         {
<a name="l00689"></a>00689           <span class="keywordflow">if</span> (<a class="code" href="classType__info.html#aefa2e065733773d08b1d0fb853d66136">types_homonymes</a>[index] == 0)
<a name="l00690"></a>00690             {
<a name="l00691"></a>00691               type_info = <a class="code" href="classType__info.html#aa9bb33cd8086c236747314d048730a06">les_types</a>[index];
<a name="l00692"></a>00692             }
<a name="l00693"></a>00693           <span class="keywordflow">else</span>
<a name="l00694"></a>00694             {
<a name="l00695"></a>00695 <span class="comment">// Le type est enregistre mais le nom correspond</span>
<a name="l00696"></a>00696 <span class="comment">// a plusieurs types...</span>
<a name="l00697"></a>00697               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;const Type_info * Type_info::type_info_from_name(const char * type_name)\n&quot;</span>;
<a name="l00698"></a>00698               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; The type &quot;</span> &lt;&lt; type_name &lt;&lt; <span class="stringliteral">&quot; has several homonymous\n&quot;</span>;
<a name="l00699"></a>00699               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; We doing as if the type is unknown...&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00700"></a>00700             }
<a name="l00701"></a>00701         }
<a name="l00702"></a>00702     }
<a name="l00703"></a>00703   <span class="keywordflow">return</span> type_info;
<a name="l00704"></a>00704 }
<a name="l00705"></a>00705 
<a name="l00706"></a>00706 <span class="comment">//</span>
<a name="l00707"></a>00707 <span class="comment">//</span><span class="comment"></span>
<a name="l00708"></a>00708 <span class="comment">//! Renvoie 1 si le type associe est instanciable (cree_instance non nul)&lt;br&gt;renvoie 0 sinon.</span>
<a name="l00709"></a><a class="code" href="classType__info.html#ab62eec9a5f8d28944ec91317b9e89bbd">00709</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classType__info.html#ab62eec9a5f8d28944ec91317b9e89bbd" title="Renvoie 1 si le type associe est instanciable (cree_instance non nul) renvoie 0 sinon.">Type_info::instanciable</a>()<span class="keyword"> const</span>
<a name="l00710"></a>00710 <span class="keyword"></span>{
<a name="l00711"></a>00711   <span class="keywordflow">return</span> (<a class="code" href="classType__info.html#af6e19128e6c8e3ffa1d28923b8053a46">cree_instance</a> != 0);
<a name="l00712"></a>00712 }
<a name="l00713"></a>00713 
<a name="l00714"></a>00714 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:28 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
