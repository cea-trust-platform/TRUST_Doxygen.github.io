<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VEF/Zones/Zone_Cl_VEF.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VEF/Zones/Zone_Cl_VEF.cpp</div>  </div>
</div>
<div class="contents">
<a href="Zone__Cl__VEF_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Zone_Cl_VEF.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VEF/Zones</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/34</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__VEF_8h.html">Zone_Cl_VEF.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VEF_8h.html">Zone_VEF.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet_8h.html">Dirichlet.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__homogene_8h.html">Dirichlet_homogene.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Periodique_8h.html">Periodique.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Symetrie_8h.html">Symetrie.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__paroi__fixe_8h.html">Dirichlet_paroi_fixe.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__paroi__defilante_8h.html">Dirichlet_paroi_defilante.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__entree__fluide_8h.html">Dirichlet_entree_fluide.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Scalaire__impose__paroi_8h.html">Scalaire_impose_paroi.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Neumann__sortie__libre_8h.html">Neumann_sortie_libre.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Champ__P0__VEF_8h.html">Champ_P0_VEF.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="Champ__P1NC_8h.html">Champ_P1NC.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="Tri__VEF_8h.html">Tri_VEF.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="Tetra__VEF_8h.html">Tetra_VEF.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="Quadri__VEF_8h.html">Quadri_VEF.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="Hexa__VEF_8h.html">Hexa_VEF.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="Hexaedre__VEF_8h.html">Hexaedre_VEF.h</a>&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="MD__Vector__tools_8h.html">MD_Vector_tools.h</a>&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;<a class="code" href="Check__espace__virtuel_8h.html">Check_espace_virtuel.h</a>&gt;</span>
<a name="l00045"></a>00045 
<a name="l00046"></a><a class="code" href="Zone__Cl__VEF_8cpp.html#a799e914f029ac02256f7f7cde4c077a0">00046</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>,<span class="stringliteral">&quot;Zone_Cl_VEF&quot;</span>,<a class="code" href="classZone__Cl__dis__base.html" title="classe Zone_Cl_dis_base Les objets Zone_Cl_dis_base representent les conditions aux limites discretis...">Zone_Cl_dis_base</a>);
<a name="l00047"></a>00047 
<a name="l00048"></a><a class="code" href="Zone__Cl__VEF_8cpp.html#ab0fff6942997d373ebe6f1eb170457af">00048</a> <span class="keywordtype">int</span> <a class="code" href="Zone__Cl__EF_8cpp.html#ab0fff6942997d373ebe6f1eb170457af">Deux_Puissance</a>(<span class="keywordtype">int</span> n)
<a name="l00049"></a>00049 {
<a name="l00050"></a>00050   <span class="keywordflow">switch</span>(n)
<a name="l00051"></a>00051     {
<a name="l00052"></a>00052     <span class="keywordflow">case</span> 0 :
<a name="l00053"></a>00053       <span class="keywordflow">return</span> 1;
<a name="l00054"></a>00054     <span class="keywordflow">case</span> 1 :
<a name="l00055"></a>00055       <span class="keywordflow">return</span> 2;
<a name="l00056"></a>00056     <span class="keywordflow">case</span> 2 :
<a name="l00057"></a>00057       <span class="keywordflow">return</span> 4;
<a name="l00058"></a>00058     <span class="keywordflow">case</span> 3 :
<a name="l00059"></a>00059       <span class="keywordflow">return</span> 8;
<a name="l00060"></a>00060     <span class="keywordflow">default</span>:
<a name="l00061"></a>00061       <span class="keywordflow">return</span> 8*<a class="code" href="Zone__Cl__EF_8cpp.html#ab0fff6942997d373ebe6f1eb170457af">Deux_Puissance</a>((<span class="keywordtype">int</span>)(n-3));
<a name="l00062"></a>00062     }
<a name="l00063"></a>00063 }
<a name="l00064"></a>00064 <span class="comment"></span>
<a name="l00065"></a>00065 <span class="comment">////!&lt; printOn </span>
<a name="l00066"></a>00066 <span class="comment"></span><span class="comment">//</span>
<a name="l00067"></a>00067 
<a name="l00068"></a><a class="code" href="classZone__Cl__VEF.html#a5b27e3652d3c1bb25a9c0630d51ba172">00068</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classZone__Cl__VEF.html#a5b27e3652d3c1bb25a9c0630d51ba172" title="Surcharge Objet_U::printOn(Sortie&amp;) NE FAIT RIEN A surcharger dans les classes derivees. Imprime les conditions aux limites discretisees sur un flot de sortie.">Zone_Cl_VEF::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os )<span class="keyword"> const</span>
<a name="l00069"></a>00069 <span class="keyword"></span>{
<a name="l00070"></a>00070   os &lt;&lt; <a class="code" href="classZone__Cl__VEF.html#a9c93ba379365a580ed078d5f3eae2518">volumes_entrelaces_Cl_</a>;
<a name="l00071"></a>00071   os &lt;&lt; <a class="code" href="classZone__Cl__VEF.html#a3a742efad20d958d3d6a4e04405256ff">normales_facettes_Cl_</a>;
<a name="l00072"></a>00072   os &lt;&lt; <a class="code" href="classZone__Cl__VEF.html#a7aa8503276bc182821e7c55043a19128">type_elem_Cl_</a>;
<a name="l00073"></a>00073   <span class="keywordflow">return</span> os;
<a name="l00074"></a>00074 }
<a name="l00075"></a>00075 <span class="comment"></span>
<a name="l00076"></a>00076 <span class="comment">////!&lt; readOn </span>
<a name="l00077"></a>00077 <span class="comment"></span><span class="comment">//</span>
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="classZone__Cl__VEF.html#a0cbd1094cb6188cffb4c2d54b060781b">00079</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classZone__Cl__VEF.html#a0cbd1094cb6188cffb4c2d54b060781b" title="Surcharge Objet_U::readOn(Sortie&amp;) Lit les conditions aux limites discretisees a partir d&#39;un flot d&#39;e...">Zone_Cl_VEF::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is )
<a name="l00080"></a>00080 {
<a name="l00081"></a>00081   <span class="keywordflow">return</span> <a class="code" href="classZone__Cl__VEF.html#a0cbd1094cb6188cffb4c2d54b060781b" title="Surcharge Objet_U::readOn(Sortie&amp;) Lit les conditions aux limites discretisees a partir d&#39;un flot d&#39;e...">Zone_Cl_dis_base::readOn</a>(is) ;
<a name="l00082"></a>00082 }
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="comment">//</span>
<a name="l00086"></a>00086 <span class="comment">// </span>
<a name="l00087"></a>00087 <span class="comment">// Implementation des fonctions de la classe Zone_Cl_VEF</span>
<a name="l00088"></a>00088 <span class="comment">// </span>
<a name="l00089"></a>00089 <span class="comment">//</span>
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="comment">//</span><span class="comment"></span>
<a name="l00092"></a>00092 <span class="comment">//! etape de discretisation : dimensionnement des tableaux</span>
<a name="l00093"></a><a class="code" href="classZone__Cl__VEF.html#af046ed0f24f61cf45d16126ed30c7b2c">00093</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classZone__Cl__VEF.html#af046ed0f24f61cf45d16126ed30c7b2c" title="etape de discretisation : dimensionnement des tableaux">Zone_Cl_VEF::associer</a>(<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; la_zone_VEF)
<a name="l00094"></a>00094 {
<a name="l00095"></a>00095   <span class="keywordtype">int</span> nb_faces_non_std = la_zone_VEF.<a class="code" href="classZone__VEF.html#a0ac71492d527961068dab905f3bd9533">nb_faces_non_std</a>();
<a name="l00096"></a>00096   <span class="keyword">const</span> <a class="code" href="classElem__VEF.html">Elem_VEF</a>&amp; <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>= la_zone_VEF.<a class="code" href="classZone__VEF.html#a46693c060b8096fb2595ca72192eea2a">type_elem</a>();
<a name="l00097"></a>00097   <span class="keywordtype">int</span> nb_fa7_elem = type_elem.<a class="code" href="classElem__VEF.html#a4a34777c0083b38dd34c8a400d5b4e90">nb_facette</a>();
<a name="l00098"></a>00098 
<a name="l00099"></a>00099   {
<a name="l00100"></a>00100     <a class="code" href="classIntVect.html">IntVect</a> renum;
<a name="l00101"></a>00101     la_zone_VEF.<a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(renum, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">ArrOfInt::NOCOPY_NOINIT</a>);
<a name="l00102"></a>00102     renum = -1;
<a name="l00103"></a>00103 <span class="comment">// Marquer les faces non standard reelles (premieres faces dans la zone)</span>
<a name="l00104"></a>00104     <span class="keywordtype">int</span> i;
<a name="l00105"></a>00105     <span class="keywordflow">for</span> (i = 0; i &lt; nb_faces_non_std; i++)
<a name="l00106"></a>00106       renum[i] = 0;
<a name="l00107"></a>00107 <span class="comment">// Echange espace virtuel =&gt; marquer les faces virtuelles non standard</span>
<a name="l00108"></a>00108     renum.<a class="code" href="classIntVect.html#ad12bea67621d1a0ee82b27c9a37ca4ef">echange_espace_virtuel</a>();
<a name="l00109"></a>00109     <a class="code" href="classMD__Vector.html" title=": Cette classe est un DERIV mais l&#39;objet pointe est partage entre plusieurs instances de cette classe...">MD_Vector</a> md_vect;
<a name="l00110"></a>00110     <a class="code" href="classMD__Vector__tools.html#a773ef21e5af6331de459189d19cc340b" title="Idem que creer_md_vect_renum() mais cree une numerotation par defaut. Le tableau flags_renum doit con...">MD_Vector_tools::creer_md_vect_renum_auto</a>(renum, md_vect);
<a name="l00111"></a>00111     <a class="code" href="MD__Vector__tools_8cpp.html#aff1ed2791dba1a76fdb300920147cfdf">MD_Vector_tools::creer_tableau_distribue</a>(md_vect, <a class="code" href="classZone__Cl__VEF.html#a9c93ba379365a580ed078d5f3eae2518">volumes_entrelaces_Cl_</a>, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>);
<a name="l00112"></a>00112   }
<a name="l00113"></a>00113   {
<a name="l00114"></a>00114 <span class="comment">// Construction du descripteur pour le tableau des elements &quot;Cl&quot;:</span>
<a name="l00115"></a>00115     <a class="code" href="classMD__Vector.html" title=": Cette classe est un DERIV mais l&#39;objet pointe est partage entre plusieurs instances de cette classe...">MD_Vector</a> md_vect;
<a name="l00116"></a>00116     <a class="code" href="MD__Vector__tools_8cpp.html#af3f8a5e3b935d4060680f5a66791d0e2">MD_Vector_tools::creer_md_vect_renum</a>(la_zone_VEF.<a class="code" href="classZone__VEF.html#a4b2171a85e5fc33663a3366acb713584">rang_elem_non_std</a>(), md_vect);
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="comment">// Creation de tableaux aux elements &quot;Cl&quot;:</span>
<a name="l00119"></a>00119     <a class="code" href="classZone__Cl__VEF.html#a3a742efad20d958d3d6a4e04405256ff">normales_facettes_Cl_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, nb_fa7_elem, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00120"></a>00120     <a class="code" href="MD__Vector__tools_8cpp.html#aff1ed2791dba1a76fdb300920147cfdf">MD_Vector_tools::creer_tableau_distribue</a>(md_vect, <a class="code" href="classZone__Cl__VEF.html#a3a742efad20d958d3d6a4e04405256ff">normales_facettes_Cl_</a>, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     <a class="code" href="classZone__Cl__VEF.html#aad4da485d517cc0b0e99f819bb00796f">vecteur_face_facette_Cl_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, nb_fa7_elem, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>, 2);
<a name="l00123"></a>00123     <a class="code" href="MD__Vector__tools_8cpp.html#aff1ed2791dba1a76fdb300920147cfdf">MD_Vector_tools::creer_tableau_distribue</a>(md_vect, <a class="code" href="classZone__Cl__VEF.html#aad4da485d517cc0b0e99f819bb00796f">vecteur_face_facette_Cl_</a>, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>);
<a name="l00124"></a>00124 
<a name="l00125"></a>00125     <a class="code" href="MD__Vector__tools_8cpp.html#aff1ed2791dba1a76fdb300920147cfdf">MD_Vector_tools::creer_tableau_distribue</a>(md_vect, <a class="code" href="classZone__Cl__VEF.html#a7aa8503276bc182821e7c55043a19128">type_elem_Cl_</a>, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>);
<a name="l00126"></a>00126   }
<a name="l00127"></a>00127 }
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 <span class="comment">//</span><span class="comment"></span>
<a name="l00130"></a>00130 <span class="comment">//! remplissage des tableaux</span>
<a name="l00131"></a><a class="code" href="classZone__Cl__VEF.html#adafec59f7edbed59c58fcc1c1d6e1f8a">00131</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classZone__Cl__dis__base.html#a8bfb3fea47744d520e6e774d554f9484" title="Appel Cond_lim_base::completer() sur chaque condition aux limites.">Zone_Cl_VEF::completer</a>(<span class="keyword">const</span> <a class="code" href="classZone__dis.html" title="classe Zone_dis Classe generique de la hierarchie des zones discretisees. Un objet de type Zone_dis p...">Zone_dis</a>&amp; une_zone_dis)
<a name="l00132"></a>00132 {
<a name="l00133"></a>00133   <a class="code" href="classZone__Cl__VEF.html#a2f9f68ad788765f1623642f25c4295da">modif_perio_fait_</a> =0;
<a name="l00134"></a>00134   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>,une_zone_dis.<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>()))
<a name="l00135"></a>00135     {
<a name="l00136"></a>00136       <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; la_zone_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>, une_zone_dis.<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>());
<a name="l00137"></a>00137       <a class="code" href="classZone__Cl__VEF.html#a5e8bd743344a5d215657000adbecfdde" title="appele par remplir_volumes_entrelaces_Cl() : remplissage de type_elem_Cl_">remplir_type_elem_Cl</a>(la_zone_VEF);
<a name="l00138"></a>00138       <a class="code" href="classZone__Cl__VEF.html#ae9f8f1bc6df16e55d4fb0f5b8067a0ad" title="appele par completer() : remplissage de type_elem_Cl_ et volumes_entrelaces_Cl_">remplir_volumes_entrelaces_Cl</a>(la_zone_VEF);
<a name="l00139"></a>00139       <a class="code" href="classZone__Cl__VEF.html#ab6fe49c1fbf1482c89c376e4e24ce8c3" title="appele par completer() : remplissage de normales_facettes_Cl_ et vecteur_face_caette_Cl_ CHANGER LE N...">remplir_normales_facettes_Cl</a>(la_zone_VEF);
<a name="l00140"></a>00140     }
<a name="l00141"></a>00141   <span class="keywordflow">else</span>
<a name="l00142"></a>00142     {
<a name="l00143"></a>00143       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Zone_Cl_VEF::completer() prend comme argument une Zone_VEF &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00144"></a>00144       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00145"></a>00145     }
<a name="l00146"></a>00146 }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 <span class="comment">//</span>
<a name="l00149"></a>00149 <span class="comment">//</span><span class="comment"></span>
<a name="l00150"></a>00150 <span class="comment">//! appele par completer() : remplissage de type_elem_Cl_ et&lt;br&gt;volumes_entrelaces_Cl_</span>
<a name="l00151"></a><a class="code" href="classZone__Cl__VEF.html#ae9f8f1bc6df16e55d4fb0f5b8067a0ad">00151</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classZone__Cl__VEF.html#ae9f8f1bc6df16e55d4fb0f5b8067a0ad" title="appele par completer() : remplissage de type_elem_Cl_ et volumes_entrelaces_Cl_">Zone_Cl_VEF::remplir_volumes_entrelaces_Cl</a>(<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; la_zone_VEF)
<a name="l00152"></a>00152 {
<a name="l00153"></a>00153   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes = la_zone_VEF.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00154"></a>00154   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_entrelaces = la_zone_VEF.<a class="code" href="classZone__VF.html#a64f0b549e5aea1656855113e3510f418">volumes_entrelaces</a>();
<a name="l00155"></a>00155   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; rang_elem = la_zone_VEF.<a class="code" href="classZone__VEF.html#a4b2171a85e5fc33663a3366acb713584">rang_elem_non_std</a>();
<a name="l00156"></a>00156 
<a name="l00157"></a>00157 <span class="comment">// Initialisation du tableau volumes_entrelaces_Cl</span>
<a name="l00158"></a>00158 <span class="comment">// a priori les faces non standard ne sont pas touchees par les C.L</span>
<a name="l00159"></a>00159 
<a name="l00160"></a>00160   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;la_zone_VEF.<a class="code" href="classZone__VEF.html#a0ac71492d527961068dab905f3bd9533">nb_faces_non_std</a>(); i++)
<a name="l00161"></a>00161     <a class="code" href="classZone__Cl__VEF.html#a9c93ba379365a580ed078d5f3eae2518">volumes_entrelaces_Cl_</a>[i] = volumes_entrelaces(i);
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="comment">// Calcul des valeurs des volumes entrelaces modifiees par les C.L:</span>
<a name="l00164"></a>00164 
<a name="l00165"></a>00165   <span class="keywordtype">int</span> nb_poly_tot = la_zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00166"></a>00166   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> poly_fait(nb_poly_tot);
<a name="l00167"></a>00167   poly_fait = 0;
<a name="l00168"></a>00168   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classZone__Cl__dis__base.html#ad1f96c8b7d81264ad5b3e2af8ca762de">les_conditions_limites_</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); i++)
<a name="l00169"></a>00169     {
<a name="l00170"></a>00170       <span class="keyword">const</span> <a class="code" href="classCond__lim__base.html" title="classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...">Cond_lim_base</a>&amp; la_cl=<a class="code" href="classZone__Cl__dis__base.html#ad1f96c8b7d81264ad5b3e2af8ca762de">les_conditions_limites_</a>[i].valeur();
<a name="l00171"></a>00171       <span class="keywordflow">if</span> ( (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl))
<a name="l00172"></a>00172            ||
<a name="l00173"></a>00173            (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl))
<a name="l00174"></a>00174          )
<a name="l00175"></a>00175         {
<a name="l00176"></a>00176           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord= la_zone_VEF.<a class="code" href="classZone__VF.html#a45e54622328fcf035535edf96172c1e4" title="renvoie la ieme frontiere_discrete.">front_VF</a>(i);
<a name="l00177"></a>00177           <span class="keyword">const</span> <a class="code" href="classFrontiere.html" title="Classe Frontiere. Une Frontiere decrit une partie de la frontiere d&#39;une Zone, elle possede un Nom...">Frontiere</a>&amp; front=le_bord.<a class="code" href="classFrontiere__dis__base.html#a95f81b046cd23c8c8083ae03eebe93cd" title="Renvoie la frontiere geometrique associee. (version const)">frontiere</a>();
<a name="l00178"></a>00178           <span class="keywordtype">int</span> premiere=le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00179"></a>00179           <span class="keywordtype">int</span> derniere=premiere+le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00180"></a>00180           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=premiere; j&lt;derniere; j++)
<a name="l00181"></a>00181             {
<a name="l00182"></a>00182               <a class="code" href="classZone__Cl__VEF.html#a9c93ba379365a580ed078d5f3eae2518">volumes_entrelaces_Cl_</a>[j] =0;
<a name="l00183"></a>00183               <span class="keywordtype">int</span> elem=la_zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(j,0);
<a name="l00184"></a>00184               <span class="keywordtype">int</span> n_poly=rang_elem(elem);
<a name="l00185"></a>00185               <span class="keywordflow">if</span>(!poly_fait[n_poly])
<a name="l00186"></a>00186                 {
<a name="l00187"></a>00187                   poly_fait[n_poly]=1;
<a name="l00188"></a>00188                   <span class="keyword">const</span> <a class="code" href="classElem__VEF.html">Elem_VEF</a>&amp; <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>= la_zone_VEF.<a class="code" href="classZone__VEF.html#a46693c060b8096fb2595ca72192eea2a">type_elem</a>();
<a name="l00189"></a>00189                   type_elem.<a class="code" href="classElem__VEF.html#a024f47f6c9f4ab37c9b10276b8fba95d">modif_volumes_entrelaces</a>(j,elem,la_zone_VEF,
<a name="l00190"></a>00190                                                      <a class="code" href="classZone__Cl__VEF.html#a90472bd1eab30a131535571a567508e4">volumes_entrelaces_Cl</a>(),
<a name="l00191"></a>00191                                                      <a class="code" href="classZone__Cl__VEF.html#a483bdab7690f844ed04e3defe04ec70a">type_elem_Cl</a>(n_poly)) ;
<a name="l00192"></a>00192                 }
<a name="l00193"></a>00193             }
<a name="l00194"></a>00194 <span class="comment">// faces virtuelles de bord :</span>
<a name="l00195"></a>00195           <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; faces_virt = front.<a class="code" href="classFrontiere.html#af1785ae558446734ad201d6ff9fece32">get_faces_virt</a>();
<a name="l00196"></a>00196           <span class="keywordtype">int</span> nb_faces_virt = faces_virt.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00197"></a>00197           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face&lt;nb_faces_virt; ind_face++)
<a name="l00198"></a>00198             {
<a name="l00199"></a>00199               <span class="keywordtype">int</span> num_face = faces_virt[ind_face];
<a name="l00200"></a>00200               <span class="keywordtype">int</span> elem=la_zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(num_face,0);
<a name="l00201"></a>00201               <span class="keywordtype">int</span> n_poly=rang_elem(elem);
<a name="l00202"></a>00202               <span class="keywordflow">if</span>(n_poly!=-1)
<a name="l00203"></a>00203                 {
<a name="l00204"></a>00204                   <span class="keywordflow">if</span>(!poly_fait[n_poly])
<a name="l00205"></a>00205                     {
<a name="l00206"></a>00206                       poly_fait[n_poly]=1;
<a name="l00207"></a>00207                       <span class="keyword">const</span> <a class="code" href="classElem__VEF.html">Elem_VEF</a>&amp; <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>= la_zone_VEF.<a class="code" href="classZone__VEF.html#a46693c060b8096fb2595ca72192eea2a">type_elem</a>();
<a name="l00208"></a>00208                       type_elem.<a class="code" href="classElem__VEF.html#a0f0a08f01677454934b5786dac12432c">modif_volumes_entrelaces_faces_joints</a>(num_face,elem,la_zone_VEF,
<a name="l00209"></a>00209                                                                       <a class="code" href="classZone__Cl__VEF.html#a90472bd1eab30a131535571a567508e4">volumes_entrelaces_Cl</a>(),
<a name="l00210"></a>00210                                                                       <a class="code" href="classZone__Cl__VEF.html#a483bdab7690f844ed04e3defe04ec70a">type_elem_Cl</a>(n_poly)) ;
<a name="l00211"></a>00211                     }
<a name="l00212"></a>00212                 }
<a name="l00213"></a>00213             }
<a name="l00214"></a>00214         }
<a name="l00215"></a>00215     }
<a name="l00216"></a>00216   {
<a name="l00217"></a>00217     <span class="keywordtype">double</span> sum_std=0, sum_cl=0, sum_tetra=0;
<a name="l00218"></a>00218     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;volumes_entrelaces.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>(); i++)
<a name="l00219"></a>00219       sum_std +=volumes_entrelaces(i);
<a name="l00220"></a>00220     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classZone__Cl__VEF.html#a9c93ba379365a580ed078d5f3eae2518">volumes_entrelaces_Cl_</a>.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>(); i++)
<a name="l00221"></a>00221       sum_cl +=<a class="code" href="classZone__Cl__VEF.html#a9c93ba379365a580ed078d5f3eae2518">volumes_entrelaces_Cl_</a>[i];
<a name="l00222"></a>00222     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;la_zone_VEF.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); i++)
<a name="l00223"></a>00223       sum_tetra +=volumes(i);
<a name="l00224"></a>00224   }
<a name="l00225"></a>00225 }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 <span class="comment">//</span>
<a name="l00228"></a>00228 <span class="comment">//</span>
<a name="l00229"></a>00229 <span class="comment">//</span><span class="comment"></span>
<a name="l00230"></a>00230 <span class="comment">//! appele par completer() : remplissage de normales_facettes_Cl_&lt;br&gt;et vecteur_face_caette_Cl_&lt;br&gt;CHANGER LE NOM</span>
<a name="l00231"></a><a class="code" href="classZone__Cl__VEF.html#ab6fe49c1fbf1482c89c376e4e24ce8c3">00231</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classZone__Cl__VEF.html#ab6fe49c1fbf1482c89c376e4e24ce8c3" title="appele par completer() : remplissage de normales_facettes_Cl_ et vecteur_face_caette_Cl_ CHANGER LE N...">Zone_Cl_VEF::remplir_normales_facettes_Cl</a>(<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; la_zone_VEF)
<a name="l00232"></a>00232 {
<a name="l00233"></a>00233   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; z = la_zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00234"></a>00234   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom = z.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00235"></a>00235   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; les_coords =dom.<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00236"></a>00236   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; les_Polys = z.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>() ;
<a name="l00237"></a>00237   <span class="keyword">const</span> <a class="code" href="classElem__VEF.html">Elem_VEF</a>&amp; elemvef = la_zone_VEF.<a class="code" href="classZone__VEF.html#a46693c060b8096fb2595ca72192eea2a">type_elem</a>();
<a name="l00238"></a>00238   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; rang_elem=la_zone_VEF.<a class="code" href="classZone__VEF.html#a4b2171a85e5fc33663a3366acb713584">rang_elem_non_std</a>();
<a name="l00239"></a>00239   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = la_zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00240"></a>00240   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xv=la_zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00241"></a>00241   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; KEL=elemvef.<a class="code" href="classDeriv__Elem__VEF__base.html#a2886905d5071be902c77248b69ca0b7b">valeur</a>().<a class="code" href="classElem__VEF__base.html#ab129610ef702aa8c9c98dcb4c7551172">KEL</a>();
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 
<a name="l00244"></a>00244   <span class="keywordtype">int</span> num_elem, fa7;
<a name="l00245"></a>00245   <span class="keywordtype">int</span> isom,ncomp;
<a name="l00246"></a>00246   <span class="keywordtype">int</span> idirichlet=-1,n1=-1,n2=-1,n3=-1;
<a name="l00247"></a>00247   <span class="keywordtype">int</span> nb_elem = z.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>();
<a name="l00248"></a>00248   <span class="keywordtype">int</span> nsom = z.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00249"></a>00249   <span class="keywordtype">int</span> nfa7 = elemvef.<a class="code" href="classElem__VEF.html#a4a34777c0083b38dd34c8a400d5b4e90">nb_facette</a>();
<a name="l00250"></a>00250 <span class="comment">// int nb_som_facette = zone().type_elem().nb_som_face();</span>
<a name="l00251"></a>00251 <span class="comment">// if ( sub_type(Hexaedre_VEF,zone().type_elem().valeur())) { nb_som_facette--; }</span>
<a name="l00252"></a>00252   <span class="keywordtype">int</span> nb_som_facette=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00253"></a>00253 
<a name="l00254"></a>00254   <a class="code" href="classIntVect.html">IntVect</a> num_som(nsom);
<a name="l00255"></a>00255   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> x(nsom,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00256"></a>00256   <a class="code" href="classDoubleVect.html">DoubleVect</a> xg(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00257"></a>00257   <a class="code" href="classDoubleVect.html">DoubleVect</a> xj0(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00258"></a>00258   <a class="code" href="classDoubleVect.html">DoubleVect</a> u(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00259"></a>00259   <a class="code" href="classDoubleVect.html">DoubleVect</a> v(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00260"></a>00260 
<a name="l00261"></a>00261 <span class="comment">// Calcul des valeurs des normales aux facettes modifiees par les C.L:</span>
<a name="l00262"></a>00262 
<a name="l00263"></a>00263   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem; elem++)
<a name="l00264"></a>00264     {
<a name="l00265"></a>00265 
<a name="l00266"></a>00266       <span class="keywordflow">if</span> (rang_elem(elem)!= -1)
<a name="l00267"></a>00267         {
<a name="l00268"></a>00268           num_elem = rang_elem(elem);
<a name="l00269"></a>00269 
<a name="l00270"></a>00270 <span class="comment">// numero des sommets du polyedre:</span>
<a name="l00271"></a>00271           <span class="keywordflow">for</span> (isom = 0; isom&lt;nsom; isom++)
<a name="l00272"></a>00272             num_som[isom] = les_Polys(elem,isom);
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 
<a name="l00275"></a>00275 <span class="comment">// Calcul des coordonnees des sommets du polyedre:</span>
<a name="l00276"></a>00276           <span class="keywordflow">for</span> (isom = 0; isom&lt;nsom; isom++)
<a name="l00277"></a>00277             <span class="keywordflow">for</span> (ncomp =0; ncomp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; ncomp++)
<a name="l00278"></a>00278               x(isom,ncomp) = les_coords(num_som[isom],ncomp);
<a name="l00279"></a>00279 
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="comment">// Calcul des coordonnees du point G en fonction du type du polyedre</span>
<a name="l00282"></a>00282 <span class="comment">// idirichlet= nb de faces de dirichlet de l&#39;elem</span>
<a name="l00283"></a>00283 <span class="comment">// pour triangle si idirichlet=2, n1=sommet confondu avec G</span>
<a name="l00284"></a>00284 <span class="comment">// pour quadrangle se reporter a Quadri_VEF.cpp</span>
<a name="l00285"></a>00285 
<a name="l00286"></a>00286           elemvef.<a class="code" href="classElem__VEF.html#a98ca7fe0e13a2d9584ca06f2504179d6">calcul_xg</a>(xg,x,<a class="code" href="classZone__Cl__VEF.html#a7aa8503276bc182821e7c55043a19128">type_elem_Cl_</a>[num_elem],
<a name="l00287"></a>00287                             idirichlet,n1,n2,n3);
<a name="l00288"></a>00288 <span class="comment">// Calcul des valeurs du tableau normales_facettes_Cl:</span>
<a name="l00289"></a>00289 
<a name="l00290"></a>00290 
<a name="l00291"></a>00291           <span class="keywordflow">for</span> (fa7=0; fa7&lt;nfa7; fa7++)
<a name="l00292"></a>00292             {
<a name="l00293"></a>00293               elemvef.<a class="code" href="classElem__VEF.html#a8c58da9f0820d40fcce0da2fbe336616">creer_normales_facettes_Cl</a>(<a class="code" href="classZone__Cl__VEF.html#a83c05e82370553470ed05f10932e0f3f">normales_facettes_Cl</a>(),fa7, num_elem,x,xg,z);
<a name="l00294"></a>00294 <span class="comment">// Correction des valeurs du tableau normales_facettes_Cl:</span>
<a name="l00295"></a>00295               elemvef.<a class="code" href="classElem__VEF.html#a2e2c7dc0a911f743161faed24dd96b4d">modif_normales_facettes_Cl</a>(<a class="code" href="classZone__Cl__VEF.html#a83c05e82370553470ed05f10932e0f3f">normales_facettes_Cl</a>(),fa7,num_elem,idirichlet,n1,n2,n3);
<a name="l00296"></a>00296               <span class="keywordtype">int</span> num1= elem_faces(elem,KEL(0,fa7));
<a name="l00297"></a>00297               <span class="keywordtype">int</span> num2= elem_faces(elem,KEL(1,fa7));
<a name="l00298"></a>00298               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir=0; dir&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; dir++)
<a name="l00299"></a>00299                 {
<a name="l00300"></a>00300                   <span class="keywordtype">double</span> coord_centre_fa7= xg(dir);
<a name="l00301"></a>00301 
<a name="l00302"></a>00302 
<a name="l00303"></a>00303                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_som_fa7=0; num_som_fa7&lt;nb_som_facette-1; num_som_fa7++)
<a name="l00304"></a>00304                     {
<a name="l00305"></a>00305                       <span class="keywordtype">int</span> isom_loc = KEL(num_som_fa7+2,fa7);
<a name="l00306"></a>00306                       <span class="keywordtype">int</span> isom_glob = les_Polys(elem,isom_loc);
<a name="l00307"></a>00307                       coord_centre_fa7 += les_coords(isom_glob,dir);
<a name="l00308"></a>00308                     }
<a name="l00309"></a>00309                   coord_centre_fa7 /= nb_som_facette;
<a name="l00310"></a>00310 
<a name="l00311"></a>00311                   <a class="code" href="classZone__Cl__VEF.html#aad4da485d517cc0b0e99f819bb00796f">vecteur_face_facette_Cl_</a>(num_elem,fa7,dir,0)=coord_centre_fa7-xv(num1,dir);
<a name="l00312"></a>00312                   <a class="code" href="classZone__Cl__VEF.html#aad4da485d517cc0b0e99f819bb00796f">vecteur_face_facette_Cl_</a>(num_elem,fa7,dir,1)=coord_centre_fa7-xv(num2,dir);
<a name="l00313"></a>00313                 }
<a name="l00314"></a>00314 
<a name="l00315"></a>00315             }
<a name="l00316"></a>00316         }
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318   <a class="code" href="classZone__Cl__VEF.html#a3a742efad20d958d3d6a4e04405256ff">normales_facettes_Cl_</a>.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00319"></a>00319   <a class="code" href="classZone__Cl__VEF.html#aad4da485d517cc0b0e99f819bb00796f">vecteur_face_facette_Cl_</a>.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00320"></a>00320 }
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="Zone__Cl__VEF_8cpp.html#acf3e8a912b21cfe16956ebf85f21a349">00322</a> <span class="keywordtype">int</span> <a class="code" href="Zone__Cl__EF_8cpp.html#acf3e8a912b21cfe16956ebf85f21a349">trois_puissance</a>(<span class="keywordtype">int</span> n)
<a name="l00323"></a>00323 {
<a name="l00324"></a>00324   <span class="keywordflow">switch</span>(n)
<a name="l00325"></a>00325     {
<a name="l00326"></a>00326     <span class="keywordflow">case</span> 0:
<a name="l00327"></a>00327       <span class="keywordflow">return</span> 1;
<a name="l00328"></a>00328     <span class="keywordflow">case</span> 1:
<a name="l00329"></a>00329       <span class="keywordflow">return</span> 3;
<a name="l00330"></a>00330     <span class="keywordflow">case</span> 2:
<a name="l00331"></a>00331       <span class="keywordflow">return</span> 9;
<a name="l00332"></a>00332     <span class="keywordflow">case</span> 3:
<a name="l00333"></a>00333       <span class="keywordflow">return</span> 27;
<a name="l00334"></a>00334     <span class="keywordflow">default</span> :
<a name="l00335"></a>00335       <span class="keywordflow">return</span> 27*<a class="code" href="Zone__Cl__EF_8cpp.html#acf3e8a912b21cfe16956ebf85f21a349">trois_puissance</a>(n-3);
<a name="l00336"></a>00336     }
<a name="l00337"></a>00337 }
<a name="l00338"></a>00338 
<a name="l00339"></a>00339 <span class="comment">//</span><span class="comment"></span>
<a name="l00340"></a>00340 <span class="comment">//! appele par remplir_volumes_entrelaces_Cl() : remplissage de type_elem_Cl_</span>
<a name="l00341"></a><a class="code" href="classZone__Cl__VEF.html#a5e8bd743344a5d215657000adbecfdde">00341</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classZone__Cl__VEF.html#a5e8bd743344a5d215657000adbecfdde" title="appele par remplir_volumes_entrelaces_Cl() : remplissage de type_elem_Cl_">Zone_Cl_VEF::remplir_type_elem_Cl</a>(<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; la_zone_VEF)
<a name="l00342"></a>00342 {
<a name="l00343"></a>00343   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; z = la_zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00344"></a>00344   <span class="keywordtype">int</span> nfac= z.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classElem__geom.html#a959e9ac3ecc31b0f20a9a9be51e18b0a" title="Appel a l&#39;objet sous-jacent Renvoie le nombre de faces du type specifie que possede l&#39;element geometr...">nb_faces</a>();   <span class="comment">//!&lt; dans Elem_geom</span>
<a name="l00345"></a>00345 <span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = la_zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00346"></a>00346   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = la_zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00347"></a>00347   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; rang_elem = la_zone_VEF.<a class="code" href="classZone__VEF.html#a4b2171a85e5fc33663a3366acb713584">rang_elem_non_std</a>();
<a name="l00348"></a>00348   <a class="code" href="classZone__Cl__VEF.html#a7aa8503276bc182821e7c55043a19128">type_elem_Cl_</a> = 0;
<a name="l00349"></a>00349   <span class="keywordtype">int</span> elem, num_elem;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classZone__Cl__dis__base.html#ad1f96c8b7d81264ad5b3e2af8ca762de">les_conditions_limites_</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); i++)
<a name="l00352"></a>00352     {
<a name="l00353"></a>00353       <a class="code" href="classCond__lim__base.html" title="classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...">Cond_lim_base</a>&amp; la_cl=<a class="code" href="classZone__Cl__dis__base.html#ad1f96c8b7d81264ad5b3e2af8ca762de">les_conditions_limites_</a>[i].valeur();
<a name="l00354"></a>00354       <span class="keywordflow">if</span> ( (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl))
<a name="l00355"></a>00355            ||
<a name="l00356"></a>00356            (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl))
<a name="l00357"></a>00357          )
<a name="l00358"></a>00358         {
<a name="l00359"></a>00359           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord= la_zone_VEF.<a class="code" href="classZone__VF.html#a45e54622328fcf035535edf96172c1e4" title="renvoie la ieme frontiere_discrete.">front_VF</a>(i);
<a name="l00360"></a>00360           <span class="keywordtype">int</span> premiere = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00361"></a>00361           <span class="keywordtype">int</span> derniere = premiere+le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00362"></a>00362           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=premiere; j&lt;derniere; j++)
<a name="l00363"></a>00363             {
<a name="l00364"></a>00364               elem=face_voisins(j,0);
<a name="l00365"></a>00365               <span class="keywordtype">int</span> numero1,numero2 =-1;
<a name="l00366"></a>00366               <span class="keywordflow">for</span>(numero1=0; numero1&lt;nfac; numero1++)
<a name="l00367"></a>00367                 <span class="keywordflow">if</span>(elem_faces(elem,numero1) == j)
<a name="l00368"></a>00368                   numero2 = numero1;
<a name="l00369"></a>00369               <span class="keywordflow">if</span>(numero2 == -1)
<a name="l00370"></a>00370                 <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Zone_Cl_VEF::creer_type_elem_Cl() PAS POSSIBLE!! &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00371"></a>00371               num_elem = rang_elem(elem);
<a name="l00372"></a>00372               assert(num_elem!=-1);
<a name="l00373"></a>00373               <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classTri__VEF.html">Tri_VEF</a>,la_zone_VEF.<a class="code" href="classZone__VEF.html#a46693c060b8096fb2595ca72192eea2a">type_elem</a>().<a class="code" href="classDeriv__Elem__VEF__base.html#a2886905d5071be902c77248b69ca0b7b">valeur</a>()) || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classTetra__VEF.html">Tetra_VEF</a>,la_zone_VEF.<a class="code" href="classZone__VEF.html#a46693c060b8096fb2595ca72192eea2a">type_elem</a>().<a class="code" href="classDeriv__Elem__VEF__base.html#a2886905d5071be902c77248b69ca0b7b">valeur</a>()))
<a name="l00374"></a>00374                 <a class="code" href="classZone__Cl__VEF.html#a7aa8503276bc182821e7c55043a19128">type_elem_Cl_</a>[num_elem]+= <a class="code" href="Zone__Cl__EF_8cpp.html#ab0fff6942997d373ebe6f1eb170457af">Deux_Puissance</a>((<span class="keywordtype">int</span>)(nfac-1-numero2));
<a name="l00375"></a>00375               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classQuadri__VEF.html">Quadri_VEF</a>,la_zone_VEF.<a class="code" href="classZone__VEF.html#a46693c060b8096fb2595ca72192eea2a">type_elem</a>().<a class="code" href="classDeriv__Elem__VEF__base.html#a2886905d5071be902c77248b69ca0b7b">valeur</a>()) || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classHexa__VEF.html">Hexa_VEF</a>,la_zone_VEF.<a class="code" href="classZone__VEF.html#a46693c060b8096fb2595ca72192eea2a">type_elem</a>().<a class="code" href="classDeriv__Elem__VEF__base.html#a2886905d5071be902c77248b69ca0b7b">valeur</a>()) )
<a name="l00376"></a>00376                 <a class="code" href="classZone__Cl__VEF.html#a7aa8503276bc182821e7c55043a19128">type_elem_Cl_</a>[num_elem]+= <a class="code" href="Zone__Cl__EF_8cpp.html#acf3e8a912b21cfe16956ebf85f21a349">trois_puissance</a>((<span class="keywordtype">int</span>)(nfac-1-numero2));
<a name="l00377"></a>00377               <span class="keywordflow">else</span>
<a name="l00378"></a>00378                 {
<a name="l00379"></a>00379                   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;erreur dans Zone_Cl_VEF::remplir_type_elem_Cl mauvais typage d&#39;element &quot;</span> &lt;&lt; finl;
<a name="l00380"></a>00380                   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00381"></a>00381                 }
<a name="l00382"></a>00382 
<a name="l00383"></a>00383             }
<a name="l00384"></a>00384         }
<a name="l00385"></a>00385     }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387   <a class="code" href="classZone__Cl__VEF.html#a7aa8503276bc182821e7c55043a19128">type_elem_Cl_</a>.<a class="code" href="classIntVect.html#ad12bea67621d1a0ee82b27c9a37ca4ef">echange_espace_virtuel</a>();
<a name="l00388"></a>00388 }
<a name="l00389"></a>00389 
<a name="l00390"></a>00390 
<a name="l00391"></a>00391 <span class="comment">//</span>
<a name="l00392"></a>00392 <span class="comment">//</span><span class="comment"></span>
<a name="l00393"></a>00393 <span class="comment">//! Impose les conditions aux limites a la valeur temporelle &quot;temps&quot; du&lt;br&gt;Champ_Inc</span>
<a name="l00394"></a><a class="code" href="classZone__Cl__VEF.html#a52127dc0942214d2759315a7f037f854">00394</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classZone__Cl__VEF.html#a52127dc0942214d2759315a7f037f854" title="Impose les conditions aux limites a la valeur temporelle &quot;temps&quot; du Champ_Inc.">Zone_Cl_VEF::imposer_cond_lim</a>(<a class="code" href="classChamp__Inc.html">Champ_Inc</a>&amp; ch, <span class="keywordtype">double</span> temps)
<a name="l00395"></a>00395 {
<a name="l00396"></a>00396   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; ch_tab = ch-&gt;<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(temps);
<a name="l00397"></a>00397   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P0__VEF.html" title="classe Champ_P0_VEF Classe qui represente un champ discret P0 par element associe a une zone discreti...">Champ_P0_VEF</a>,ch.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>()))
<a name="l00398"></a>00398     {
<a name="l00399"></a>00399       ;
<a name="l00400"></a>00400     }
<a name="l00401"></a>00401   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,ch.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>()) || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Q1NC.html">Champ_Q1NC</a>,ch.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>()))
<a name="l00402"></a>00402     {
<a name="l00403"></a>00403       <span class="keywordtype">int</span> nb_comp;
<a name="l00404"></a>00404 
<a name="l00405"></a>00405       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,ch.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>()))
<a name="l00406"></a>00406         {
<a name="l00407"></a>00407           <span class="keyword">const</span> <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; chnc = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>,ch.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>());
<a name="l00408"></a>00408           nb_comp = chnc.<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>();
<a name="l00409"></a>00409           <span class="keywordtype">int</span> ndeb,nfin,num_face,ncomp;
<a name="l00410"></a>00410           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>(); i++)
<a name="l00411"></a>00411             {
<a name="l00412"></a>00412               <span class="keyword">const</span> <a class="code" href="classCond__lim__base.html" title="classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...">Cond_lim_base</a>&amp; la_cl = <a class="code" href="classZone__Cl__dis__base.html#aed515ad23bdfca2368ffe08f2746a653" title="Renvoie le tableaux des conditions aux limites.">les_conditions_limites</a>(i).valeur();
<a name="l00413"></a>00413               <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl))
<a name="l00414"></a>00414                 {
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 <span class="comment">// On fait en sorte que le champ ait la meme valeur</span>
<a name="l00417"></a>00417 <span class="comment">// sur deux faces de periodicite qui sont en face l&#39;une de l&#39;autre</span>
<a name="l00418"></a>00418                   <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl);
<a name="l00419"></a>00419                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00420"></a>00420                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00421"></a>00421                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00422"></a>00422                   <span class="keywordtype">int</span> voisine;
<a name="l00423"></a>00423                   <span class="keywordtype">double</span> moy;
<a name="l00424"></a>00424                   <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00425"></a>00425                     {
<a name="l00426"></a>00426                       voisine = la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(num_face-ndeb) + ndeb;
<a name="l00427"></a>00427                       <span class="keywordflow">if</span> (nb_comp == 1)
<a name="l00428"></a>00428                         {
<a name="l00429"></a>00429                           <span class="keywordflow">if</span> ( ch_tab[num_face] != ch_tab[voisine] )
<a name="l00430"></a>00430                             {
<a name="l00431"></a>00431                               moy = 0.5*(ch_tab[num_face] + ch_tab[voisine]);
<a name="l00432"></a>00432                               ch_tab[num_face] = moy;
<a name="l00433"></a>00433                               ch_tab[voisine] = moy;
<a name="l00434"></a>00434                             }
<a name="l00435"></a>00435                         }
<a name="l00436"></a>00436                       <span class="keywordflow">else</span>
<a name="l00437"></a>00437                         {
<a name="l00438"></a>00438                           <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00439"></a>00439                             <span class="keywordflow">if</span> ( ch_tab(num_face,ncomp) != ch_tab(voisine,ncomp) )
<a name="l00440"></a>00440                               {
<a name="l00441"></a>00441                                 moy = 0.5*(ch_tab(num_face,ncomp) + ch_tab(voisine,ncomp));
<a name="l00442"></a>00442                                 ch_tab(num_face,ncomp) = moy;
<a name="l00443"></a>00443                                 ch_tab(voisine,ncomp) = moy;
<a name="l00444"></a>00444                               }
<a name="l00445"></a>00445                         }
<a name="l00446"></a>00446                     }
<a name="l00447"></a>00447                 }
<a name="l00448"></a>00448               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classSymetrie.html" title="classe Symetrie Sur les faces de symetrie on a les proprietes suivantes: - composante normale de la v...">Symetrie</a>,la_cl) ) &amp;&amp;
<a name="l00449"></a>00449                         (ch-&gt;nature_du_champ()==<a class="code" href="Field__base_8h.html#a1b86c8f670a9b34da7f628a821fb646ba66d795f4e2fbb5636a3966c73964c5e7">vectoriel</a>) )
<a name="l00450"></a>00450                 {
<a name="l00451"></a>00451                   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zvef = chnc.<a class="code" href="classChamp__P1NC.html#a122a5f097bee0c82357ab77ab23e0068">zone_vef</a>();
<a name="l00452"></a>00452                   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales = zvef.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00453"></a>00453                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00454"></a>00454                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00455"></a>00455                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00456"></a>00456                   <span class="keywordflow">if</span> (nb_comp == <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>)
<a name="l00457"></a>00457                     {
<a name="l00458"></a>00458                       <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00459"></a>00459                         {
<a name="l00460"></a>00460                           <span class="keywordtype">double</span> face_n, surf=0, flux=0;
<a name="l00461"></a>00461                           <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00462"></a>00462                             {
<a name="l00463"></a>00463                               face_n = face_normales(num_face,ncomp);
<a name="l00464"></a>00464                               flux += ch_tab(num_face,ncomp)*face_n;
<a name="l00465"></a>00465                               surf += face_n*face_n;
<a name="l00466"></a>00466                             }
<a name="l00467"></a>00467 <span class="comment">// flux /= surf; // Fixed bug: Arithmetic exception</span>
<a name="l00468"></a>00468                           <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(surf)&gt;=<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>) flux /= surf;
<a name="l00469"></a>00469                           <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00470"></a>00470                             ch_tab(num_face,ncomp) -= flux*face_normales(num_face,ncomp);
<a name="l00471"></a>00471                         }
<a name="l00472"></a>00472                     }
<a name="l00473"></a>00473                 }
<a name="l00474"></a>00474               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>,la_cl) )
<a name="l00475"></a>00475                 {
<a name="l00476"></a>00476                   <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp; la_cl_diri = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>,la_cl);
<a name="l00477"></a>00477                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00478"></a>00478                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00479"></a>00479                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00480"></a>00480                   <span class="keywordflow">if</span> (nb_comp == 1)
<a name="l00481"></a>00481                     <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00482"></a>00482                       ch_tab[num_face] = la_cl_diri.<a class="code" href="classDirichlet.html#af932fe16fd186ef4463a5d912570742d" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps precise...">val_imp_au_temps</a>(temps,num_face-ndeb);
<a name="l00483"></a>00483                   <span class="keywordflow">else</span>
<a name="l00484"></a>00484                     {
<a name="l00485"></a>00485                       <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00486"></a>00486                         <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00487"></a>00487                           ch_tab(num_face,ncomp) =la_cl_diri.<a class="code" href="classDirichlet.html#af932fe16fd186ef4463a5d912570742d" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps precise...">val_imp_au_temps</a>(temps,num_face-ndeb,ncomp);
<a name="l00488"></a>00488                     }
<a name="l00489"></a>00489                 }
<a name="l00490"></a>00490               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classScalaire__impose__paroi.html" title="classe Scalaire_impose_paroi Impose un scalaire a la paroi dans une equation de type Convection-Difus...">Scalaire_impose_paroi</a>,la_cl) )
<a name="l00491"></a>00491                 {
<a name="l00492"></a>00492                   <span class="keyword">const</span> <a class="code" href="classScalaire__impose__paroi.html" title="classe Scalaire_impose_paroi Impose un scalaire a la paroi dans une equation de type Convection-Difus...">Scalaire_impose_paroi</a>&amp; la_cl_diri = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classScalaire__impose__paroi.html" title="classe Scalaire_impose_paroi Impose un scalaire a la paroi dans une equation de type Convection-Difus...">Scalaire_impose_paroi</a>,la_cl);
<a name="l00493"></a>00493                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00494"></a>00494                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00495"></a>00495                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00496"></a>00496                   <span class="keywordflow">if</span> (nb_comp == 1)
<a name="l00497"></a>00497                     <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00498"></a>00498                       {
<a name="l00499"></a>00499                         ch_tab[num_face] = la_cl_diri.<a class="code" href="classDirichlet.html#af932fe16fd186ef4463a5d912570742d" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps precise...">val_imp_au_temps</a>(temps,num_face-ndeb);
<a name="l00500"></a>00500                       }
<a name="l00501"></a>00501                   <span class="keywordflow">else</span>
<a name="l00502"></a>00502                     {
<a name="l00503"></a>00503                       <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00504"></a>00504                         <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00505"></a>00505                           ch_tab(num_face,ncomp) =la_cl_diri.<a class="code" href="classDirichlet.html#af932fe16fd186ef4463a5d912570742d" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps precise...">val_imp_au_temps</a>(temps,num_face-ndeb,ncomp);
<a name="l00506"></a>00506                     }
<a name="l00507"></a>00507                 }
<a name="l00508"></a>00508               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__paroi__fixe.html" title="classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes...">Dirichlet_paroi_fixe</a>,la_cl) ) &amp;&amp;
<a name="l00509"></a>00509                         (ch-&gt;nature_du_champ()==<a class="code" href="Field__base_8h.html#a1b86c8f670a9b34da7f628a821fb646ba5c7919c9af898542b94861e963ade862">multi_scalaire</a>) )
<a name="l00510"></a>00510                 {
<a name="l00511"></a>00511                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00512"></a>00512                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00513"></a>00513                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00514"></a>00514                   <span class="keywordflow">if</span> (nb_comp == 1)
<a name="l00515"></a>00515                     <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00516"></a>00516                       ch_tab[num_face] = 0;
<a name="l00517"></a>00517                   <span class="keywordflow">else</span>
<a name="l00518"></a>00518                     {
<a name="l00519"></a>00519                       <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00520"></a>00520                         <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00521"></a>00521                           {
<a name="l00522"></a>00522                             ch_tab(num_face,0) = 0;
<a name="l00523"></a>00523                             ch_tab(num_face,1) = 0;
<a name="l00524"></a>00524                           }
<a name="l00525"></a>00525                     }
<a name="l00526"></a>00526                 }
<a name="l00527"></a>00527               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__paroi__fixe.html" title="classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes...">Dirichlet_paroi_fixe</a>,la_cl) )
<a name="l00528"></a>00528                 {
<a name="l00529"></a>00529                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00530"></a>00530                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00531"></a>00531                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00532"></a>00532                   <span class="keywordflow">if</span> (nb_comp == 1)
<a name="l00533"></a>00533                     <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00534"></a>00534                       ch_tab[num_face] = 0;
<a name="l00535"></a>00535                   <span class="keywordflow">else</span>
<a name="l00536"></a>00536                     {
<a name="l00537"></a>00537                       <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00538"></a>00538                         <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00539"></a>00539                           ch_tab(num_face,ncomp) = 0;
<a name="l00540"></a>00540                     }
<a name="l00541"></a>00541                 }
<a name="l00542"></a>00542               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__paroi__defilante.html" title="classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes...">Dirichlet_paroi_defilante</a>,la_cl) )
<a name="l00543"></a>00543                 {
<a name="l00544"></a>00544                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00545"></a>00545                   <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__defilante.html" title="classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes...">Dirichlet_paroi_defilante</a>&amp; la_cl_diri=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDirichlet__paroi__defilante.html" title="classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes...">Dirichlet_paroi_defilante</a>,la_cl);
<a name="l00546"></a>00546                   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales = chnc.<a class="code" href="classChamp__P1NC.html#a122a5f097bee0c82357ab77ab23e0068">zone_vef</a>().<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00547"></a>00547                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00548"></a>00548                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00549"></a>00549                   <span class="keywordflow">if</span> (nb_comp != <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>)
<a name="l00550"></a>00550                     {
<a name="l00551"></a>00551                       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Cas non prevu dans Zone_Cl_VEF::imposer_cond_lim.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00552"></a>00552                       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00553"></a>00553                     }
<a name="l00554"></a>00554                   <span class="keywordflow">else</span>
<a name="l00555"></a>00555                     {
<a name="l00556"></a>00556                       <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00557"></a>00557                         {
<a name="l00558"></a>00558                           <span class="keywordtype">double</span> surf=0, flux=0;
<a name="l00559"></a>00559                           <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00560"></a>00560                             {
<a name="l00561"></a>00561                               <span class="keywordtype">double</span> face_n = face_normales(num_face,ncomp);
<a name="l00562"></a>00562                               flux += la_cl_diri.val_imp_au_temps(temps,num_face-ndeb, ncomp)*face_n;
<a name="l00563"></a>00563                               surf += face_n*face_n;
<a name="l00564"></a>00564                             }
<a name="l00565"></a>00565 <span class="comment">// flux /= surf; // Fixed bug: Arithmetic exception</span>
<a name="l00566"></a>00566                           <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(surf)&gt;=<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>) flux /= surf;
<a name="l00567"></a>00567                           <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00568"></a>00568                             ch_tab(num_face,ncomp) = la_cl_diri.val_imp_au_temps(temps,num_face-ndeb, ncomp) - flux * face_normales(num_face,ncomp);
<a name="l00569"></a>00569                         }
<a name="l00570"></a>00570                     }
<a name="l00571"></a>00571                 }
<a name="l00572"></a>00572             }
<a name="l00573"></a>00573         }
<a name="l00574"></a>00574       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Q1NC.html">Champ_Q1NC</a>,ch.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>()))
<a name="l00575"></a>00575         {
<a name="l00576"></a>00576           <span class="keyword">const</span> <a class="code" href="classChamp__Q1NC.html">Champ_Q1NC</a>&amp; chnc = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Q1NC.html">Champ_Q1NC</a>,ch.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>());
<a name="l00577"></a>00577           nb_comp = chnc.<a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>();
<a name="l00578"></a>00578           <span class="keywordtype">int</span> ndeb,nfin,num_face,ncomp;
<a name="l00579"></a>00579           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>(); i++)
<a name="l00580"></a>00580             {
<a name="l00581"></a>00581               <span class="keyword">const</span> <a class="code" href="classCond__lim__base.html" title="classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...">Cond_lim_base</a>&amp; la_cl = <a class="code" href="classZone__Cl__dis__base.html#aed515ad23bdfca2368ffe08f2746a653" title="Renvoie le tableaux des conditions aux limites.">les_conditions_limites</a>(i).valeur();
<a name="l00582"></a>00582               <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl))
<a name="l00583"></a>00583                 {
<a name="l00584"></a>00584 <span class="comment">// On fait en sorte que le champ ait la meme valeur</span>
<a name="l00585"></a>00585 <span class="comment">// sur deux faces de periodicite qui sont en face l&#39;une de l&#39;autre</span>
<a name="l00586"></a>00586                   <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl);
<a name="l00587"></a>00587                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00588"></a>00588                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00589"></a>00589                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00590"></a>00590                   <span class="keywordtype">int</span> voisine;
<a name="l00591"></a>00591                   <span class="keywordtype">double</span> moy;
<a name="l00592"></a>00592                   <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00593"></a>00593                     {
<a name="l00594"></a>00594                       voisine = la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(num_face-ndeb) + ndeb;
<a name="l00595"></a>00595                       <span class="keywordflow">if</span> (nb_comp == 1)
<a name="l00596"></a>00596                         {
<a name="l00597"></a>00597                           <span class="keywordflow">if</span> ( ch_tab[num_face] != ch_tab[voisine] )
<a name="l00598"></a>00598                             {
<a name="l00599"></a>00599                               moy = 0.5*(ch_tab[num_face] + ch_tab[voisine]);
<a name="l00600"></a>00600                               ch_tab[num_face] = moy;
<a name="l00601"></a>00601                               ch_tab[voisine] = moy;
<a name="l00602"></a>00602                             }
<a name="l00603"></a>00603                         }
<a name="l00604"></a>00604                       <span class="keywordflow">else</span>
<a name="l00605"></a>00605                         {
<a name="l00606"></a>00606                           <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00607"></a>00607                             <span class="keywordflow">if</span> ( ch_tab(num_face,ncomp) != ch_tab(voisine,ncomp) )
<a name="l00608"></a>00608                               {
<a name="l00609"></a>00609                                 moy = 0.5*(ch_tab(num_face,ncomp) + ch_tab(voisine,ncomp));
<a name="l00610"></a>00610                                 ch_tab(num_face,ncomp) = moy;
<a name="l00611"></a>00611                                 ch_tab(voisine,ncomp) = moy;
<a name="l00612"></a>00612                               }
<a name="l00613"></a>00613                         }
<a name="l00614"></a>00614                     }
<a name="l00615"></a>00615                 }
<a name="l00616"></a>00616               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classSymetrie.html" title="classe Symetrie Sur les faces de symetrie on a les proprietes suivantes: - composante normale de la v...">Symetrie</a>,la_cl) ) &amp;&amp;
<a name="l00617"></a>00617                         (ch-&gt;nature_du_champ()==<a class="code" href="Field__base_8h.html#a1b86c8f670a9b34da7f628a821fb646ba66d795f4e2fbb5636a3966c73964c5e7">vectoriel</a>) )
<a name="l00618"></a>00618                 {
<a name="l00619"></a>00619                   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zvef = chnc.<a class="code" href="classChamp__Q1NC.html#a4b2047531f0d0bb5bae5fa502014550c">zone_vef</a>();
<a name="l00620"></a>00620                   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales = zvef.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00621"></a>00621                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00622"></a>00622                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00623"></a>00623                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00624"></a>00624                   <span class="keywordflow">if</span> (nb_comp == <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>)
<a name="l00625"></a>00625                     {
<a name="l00626"></a>00626                       <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00627"></a>00627                         {
<a name="l00628"></a>00628                           <span class="keywordtype">double</span> face_n, surf=0, flux=0;
<a name="l00629"></a>00629                           <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00630"></a>00630                             {
<a name="l00631"></a>00631                               face_n = face_normales(num_face,ncomp);
<a name="l00632"></a>00632                               flux += ch_tab(num_face,ncomp)*face_n;
<a name="l00633"></a>00633                               surf += face_n*face_n;
<a name="l00634"></a>00634                             }
<a name="l00635"></a>00635 <span class="comment">// flux /= surf; // Fixed bug: Arithmetic exception</span>
<a name="l00636"></a>00636                           <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(surf)&gt;=<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>) flux /= surf;
<a name="l00637"></a>00637                           <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00638"></a>00638                             ch_tab(num_face,ncomp) -= flux*face_normales(num_face,ncomp);
<a name="l00639"></a>00639                         }
<a name="l00640"></a>00640                     }
<a name="l00641"></a>00641                 }
<a name="l00642"></a>00642               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>,la_cl) )
<a name="l00643"></a>00643                 {
<a name="l00644"></a>00644                   <span class="keyword">const</span> <a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>&amp; la_cl_diri = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>,la_cl);
<a name="l00645"></a>00645                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00646"></a>00646                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00647"></a>00647                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00648"></a>00648                   <span class="keywordflow">if</span> (nb_comp == 1)
<a name="l00649"></a>00649                     <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00650"></a>00650                       ch_tab[num_face] = la_cl_diri.<a class="code" href="classDirichlet.html#af932fe16fd186ef4463a5d912570742d" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps precise...">val_imp_au_temps</a>(temps,num_face-ndeb);
<a name="l00651"></a>00651                   <span class="keywordflow">else</span>
<a name="l00652"></a>00652                     {
<a name="l00653"></a>00653                       <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00654"></a>00654                         <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00655"></a>00655                           ch_tab(num_face,ncomp) =la_cl_diri.<a class="code" href="classDirichlet.html#af932fe16fd186ef4463a5d912570742d" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps precise...">val_imp_au_temps</a>(temps,num_face-ndeb,ncomp);
<a name="l00656"></a>00656                     }
<a name="l00657"></a>00657                 }
<a name="l00658"></a>00658               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classScalaire__impose__paroi.html" title="classe Scalaire_impose_paroi Impose un scalaire a la paroi dans une equation de type Convection-Difus...">Scalaire_impose_paroi</a>,la_cl) )
<a name="l00659"></a>00659                 {
<a name="l00660"></a>00660                   <span class="keyword">const</span> <a class="code" href="classScalaire__impose__paroi.html" title="classe Scalaire_impose_paroi Impose un scalaire a la paroi dans une equation de type Convection-Difus...">Scalaire_impose_paroi</a>&amp; la_cl_diri = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classScalaire__impose__paroi.html" title="classe Scalaire_impose_paroi Impose un scalaire a la paroi dans une equation de type Convection-Difus...">Scalaire_impose_paroi</a>,la_cl);
<a name="l00661"></a>00661                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00662"></a>00662                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00663"></a>00663                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00664"></a>00664                   <span class="keywordflow">if</span> (nb_comp == 1)
<a name="l00665"></a>00665                     <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00666"></a>00666                       {
<a name="l00667"></a>00667                         ch_tab[num_face] = la_cl_diri.<a class="code" href="classDirichlet.html#af932fe16fd186ef4463a5d912570742d" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps precise...">val_imp_au_temps</a>(temps,num_face-ndeb);
<a name="l00668"></a>00668                       }
<a name="l00669"></a>00669                   <span class="keywordflow">else</span>
<a name="l00670"></a>00670                     {
<a name="l00671"></a>00671                       <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00672"></a>00672                         <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00673"></a>00673                           ch_tab(num_face,ncomp) =la_cl_diri.<a class="code" href="classDirichlet.html#af932fe16fd186ef4463a5d912570742d" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps precise...">val_imp_au_temps</a>(temps,num_face-ndeb,ncomp);
<a name="l00674"></a>00674                     }
<a name="l00675"></a>00675                 }
<a name="l00676"></a>00676               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__paroi__fixe.html" title="classe Dirichlet_paroi_fixe Represente une paroi immobile dans une equation de type Navier_Stokes...">Dirichlet_paroi_fixe</a>,la_cl) )
<a name="l00677"></a>00677                 {
<a name="l00678"></a>00678                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00679"></a>00679                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00680"></a>00680                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00681"></a>00681                   <span class="keywordflow">if</span> (nb_comp == 1)
<a name="l00682"></a>00682                     <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00683"></a>00683                       ch_tab[num_face] = 0;
<a name="l00684"></a>00684                   <span class="keywordflow">else</span>
<a name="l00685"></a>00685                     {
<a name="l00686"></a>00686                       <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00687"></a>00687                         <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00688"></a>00688                           ch_tab(num_face,ncomp) = 0;
<a name="l00689"></a>00689                     }
<a name="l00690"></a>00690                 }
<a name="l00691"></a>00691               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__paroi__defilante.html" title="classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes...">Dirichlet_paroi_defilante</a>,la_cl) )
<a name="l00692"></a>00692                 {
<a name="l00693"></a>00693                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00694"></a>00694                   <span class="keyword">const</span> <a class="code" href="classDirichlet__paroi__defilante.html" title="classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes...">Dirichlet_paroi_defilante</a>&amp; la_cl_diri=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDirichlet__paroi__defilante.html" title="classe Dirichlet_paroi_defilante Impose la vitesse de paroi dnas une equation de type Navier_Stokes...">Dirichlet_paroi_defilante</a>,la_cl);
<a name="l00695"></a>00695                   ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00696"></a>00696                   nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00697"></a>00697                   <span class="keywordflow">if</span> (nb_comp == 1)
<a name="l00698"></a>00698                     <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00699"></a>00699                       ch_tab[num_face] = la_cl_diri.val_imp_au_temps(temps,num_face-ndeb);
<a name="l00700"></a>00700                   <span class="keywordflow">else</span>
<a name="l00701"></a>00701                     {
<a name="l00702"></a>00702                       <span class="keywordflow">for</span> (ncomp=0; ncomp&lt;nb_comp; ncomp++)
<a name="l00703"></a>00703                         <span class="keywordflow">for</span> (num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00704"></a>00704                           ch_tab(num_face,ncomp) =la_cl_diri.val_imp_au_temps(temps,num_face-ndeb, ncomp);
<a name="l00705"></a>00705                     }
<a name="l00706"></a>00706                 }
<a name="l00707"></a>00707             }
<a name="l00708"></a>00708         }
<a name="l00709"></a>00709     }
<a name="l00710"></a>00710   <span class="keywordflow">else</span>
<a name="l00711"></a>00711     {
<a name="l00712"></a>00712       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Le type de Champ_Inc &quot;</span> &lt;&lt; ch-&gt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; n&#39;est pas prevu en VEF\n&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00713"></a>00713 
<a name="l00714"></a>00714       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00715"></a>00715     }
<a name="l00716"></a>00716   ch_tab.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00717"></a>00717 <span class="comment">// Debog::verifier(&quot;Zone_Cl_VEF::imposer_cond_lim ch_tab&quot;,ch_tab);</span>
<a name="l00718"></a>00718 }
<a name="l00719"></a>00719 
<a name="l00720"></a><a class="code" href="classZone__Cl__VEF.html#a9cbe6584d01c2bfccff179ae7f03fb96">00720</a> <span class="keywordtype">int</span> <a class="code" href="classZone__Cl__VEF.html#a9cbe6584d01c2bfccff179ae7f03fb96">Zone_Cl_VEF::nb_faces_sortie_libre</a>()<span class="keyword"> const</span>
<a name="l00721"></a>00721 <span class="keyword"></span>{
<a name="l00722"></a>00722   <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>=0;
<a name="l00723"></a>00723   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cl=0; cl&lt;<a class="code" href="classZone__Cl__dis__base.html#ad1f96c8b7d81264ad5b3e2af8ca762de">les_conditions_limites_</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); cl++)
<a name="l00724"></a>00724     {
<a name="l00725"></a>00725       <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>, <a class="code" href="classZone__Cl__dis__base.html#ad1f96c8b7d81264ad5b3e2af8ca762de">les_conditions_limites_</a>[cl].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>()))
<a name="l00726"></a>00726         {
<a name="l00727"></a>00727           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,<a class="code" href="classZone__Cl__dis__base.html#ad1f96c8b7d81264ad5b3e2af8ca762de">les_conditions_limites_</a>[cl]-&gt;frontiere_dis());
<a name="l00728"></a>00728           compteur+=le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00729"></a>00729         }
<a name="l00730"></a>00730     }
<a name="l00731"></a>00731   <span class="keywordflow">return</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>;
<a name="l00732"></a>00732 }
<a name="l00733"></a>00733 
<a name="l00734"></a><a class="code" href="classZone__Cl__VEF.html#a221d7609a616df8d58f34edc72c9b007">00734</a> <span class="keywordtype">int</span> <a class="code" href="classZone__Cl__VEF.html#a221d7609a616df8d58f34edc72c9b007">Zone_Cl_VEF::nb_bord_periodicite</a>()<span class="keyword"> const</span>
<a name="l00735"></a>00735 <span class="keyword"></span>{
<a name="l00736"></a>00736   <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>=0;
<a name="l00737"></a>00737   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cl=0; cl&lt;<a class="code" href="classZone__Cl__dis__base.html#ad1f96c8b7d81264ad5b3e2af8ca762de">les_conditions_limites_</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); cl++)
<a name="l00738"></a>00738     {
<a name="l00739"></a>00739       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,<a class="code" href="classZone__Cl__dis__base.html#ad1f96c8b7d81264ad5b3e2af8ca762de">les_conditions_limites_</a>[cl].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>()))
<a name="l00740"></a>00740         compteur++;
<a name="l00741"></a>00741     }
<a name="l00742"></a>00742   <span class="keywordflow">return</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>;
<a name="l00743"></a>00743 }
<a name="l00744"></a>00744 
<a name="l00745"></a><a class="code" href="classZone__Cl__VEF.html#a8d6c4f1865bf0fcb08bf7ce755723efa">00745</a> <span class="keywordtype">int</span> <a class="code" href="classZone__Cl__VEF.html#a8d6c4f1865bf0fcb08bf7ce755723efa" title="Initialise les CLs Contrairement aux methodes mettre_a_jour, les methodes initialiser des CLs ne peuv...">Zone_Cl_VEF::initialiser</a>(<span class="keywordtype">double</span> temps)
<a name="l00746"></a>00746 {
<a name="l00747"></a>00747   <a class="code" href="classZone__Cl__VEF.html#a8d6c4f1865bf0fcb08bf7ce755723efa" title="Initialise les CLs Contrairement aux methodes mettre_a_jour, les methodes initialiser des CLs ne peuv...">Zone_Cl_dis_base::initialiser</a>(temps);
<a name="l00748"></a>00748 
<a name="l00749"></a>00749   <span class="keywordflow">if</span> (<a class="code" href="classZone__Cl__VEF.html#a221d7609a616df8d58f34edc72c9b007">nb_bord_periodicite</a>()&gt;0)
<a name="l00750"></a>00750     {
<a name="l00751"></a>00751       <span class="keywordflow">if</span> (<a class="code" href="classZone__Cl__VEF.html#a2f9f68ad788765f1623642f25c4295da">modif_perio_fait_</a> == 0)
<a name="l00752"></a>00752         {
<a name="l00753"></a>00753           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt;<span class="stringliteral">&quot;modification de la Zone_Cl_VEF pour periodicite&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00754"></a>00754           <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; la_zone_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>,<a class="code" href="classZone__Cl__dis__base.html#a20ea8fc29bc5a157ee957925db285972" title="Renvoie une reference sur la zone discretisee associee aux conditions aux limites. Cette Zone_dis est associee au travers de l&#39;equation associee et pas directement a l&#39;objet Zone_Cl_dis_base.">zone_dis</a>().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00755"></a>00755           <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_entrelaces = la_zone_VEF.<a class="code" href="classZone__VF.html#a64f0b549e5aea1656855113e3510f418">volumes_entrelaces</a>();
<a name="l00756"></a>00756           <a class="code" href="classZone__Cl__VEF.html#ae9f8f1bc6df16e55d4fb0f5b8067a0ad" title="appele par completer() : remplissage de type_elem_Cl_ et volumes_entrelaces_Cl_">remplir_volumes_entrelaces_Cl</a>(la_zone_VEF);
<a name="l00757"></a>00757           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classZone__Cl__dis__base.html#ad1f96c8b7d81264ad5b3e2af8ca762de">les_conditions_limites_</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); i++)
<a name="l00758"></a>00758             {
<a name="l00759"></a>00759               <span class="keyword">const</span> <a class="code" href="classCond__lim__base.html" title="classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...">Cond_lim_base</a>&amp; la_cl=<a class="code" href="classZone__Cl__dis__base.html#ad1f96c8b7d81264ad5b3e2af8ca762de">les_conditions_limites_</a>[i].valeur();
<a name="l00760"></a>00760 
<a name="l00761"></a>00761               <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl) )
<a name="l00762"></a>00762                 {
<a name="l00763"></a>00763 
<a name="l00764"></a>00764                   <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl);
<a name="l00765"></a>00765                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord= la_zone_VEF.<a class="code" href="classZone__VF.html#a45e54622328fcf035535edf96172c1e4" title="renvoie la ieme frontiere_discrete.">front_VF</a>(i);
<a name="l00766"></a>00766                   <span class="keywordtype">int</span> premiere=le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00767"></a>00767                   <span class="keywordtype">int</span> derniere=premiere+le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00768"></a>00768                   <a class="code" href="classIntVect.html">IntVect</a> fait(le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>());
<a name="l00769"></a>00769                   fait = 0;
<a name="l00770"></a>00770                   <span class="keywordtype">int</span> ind_fac_loc;
<a name="l00771"></a>00771 
<a name="l00772"></a>00772                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=premiere; j&lt;derniere; j++)
<a name="l00773"></a>00773                     {
<a name="l00774"></a>00774                       ind_fac_loc = j-premiere;
<a name="l00775"></a>00775 
<a name="l00776"></a>00776                       <span class="keywordflow">if</span> (fait[ind_fac_loc]== 0)
<a name="l00777"></a>00777                         {
<a name="l00778"></a>00778                           <span class="keywordtype">int</span> fac_associee = la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(j-premiere)+premiere;
<a name="l00779"></a>00779                           <span class="keywordflow">if</span> (<a class="code" href="classZone__Cl__VEF.html#a9c93ba379365a580ed078d5f3eae2518">volumes_entrelaces_Cl_</a>[j] != volumes_entrelaces[j])
<a name="l00780"></a>00780                             <a class="code" href="classZone__Cl__VEF.html#a9c93ba379365a580ed078d5f3eae2518">volumes_entrelaces_Cl_</a>[fac_associee] = <a class="code" href="classZone__Cl__VEF.html#a9c93ba379365a580ed078d5f3eae2518">volumes_entrelaces_Cl_</a>[j];
<a name="l00781"></a>00781                           <span class="keywordflow">else</span>
<a name="l00782"></a>00782                             <a class="code" href="classZone__Cl__VEF.html#a9c93ba379365a580ed078d5f3eae2518">volumes_entrelaces_Cl_</a>[j] = <a class="code" href="classZone__Cl__VEF.html#a9c93ba379365a580ed078d5f3eae2518">volumes_entrelaces_Cl_</a>[fac_associee];
<a name="l00783"></a>00783 
<a name="l00784"></a>00784                           fait[ind_fac_loc] = 1;
<a name="l00785"></a>00785                           fait[fac_associee-premiere] = 1;
<a name="l00786"></a>00786                         }
<a name="l00787"></a>00787                     }
<a name="l00788"></a>00788                 }
<a name="l00789"></a>00789             }
<a name="l00790"></a>00790 
<a name="l00791"></a>00791           <a class="code" href="classZone__Cl__VEF.html#a2f9f68ad788765f1623642f25c4295da">modif_perio_fait_</a> = 1;
<a name="l00792"></a>00792         }
<a name="l00793"></a>00793     }
<a name="l00794"></a>00794   <span class="keywordflow">return</span> 1;
<a name="l00795"></a>00795 }
<a name="l00796"></a>00796 
<a name="l00797"></a><a class="code" href="classZone__Cl__VEF.html#a2a0238232a67ae5ffeef896c045df56d">00797</a> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; <a class="code" href="classZone__Cl__VEF.html#a2a0238232a67ae5ffeef896c045df56d">Zone_Cl_VEF::zone_VEF</a>()
<a name="l00798"></a>00798 {
<a name="l00799"></a>00799   <span class="keywordflow">return</span> <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>, <a class="code" href="classZone__Cl__dis__base.html#a20ea8fc29bc5a157ee957925db285972" title="Renvoie une reference sur la zone discretisee associee aux conditions aux limites. Cette Zone_dis est associee au travers de l&#39;equation associee et pas directement a l&#39;objet Zone_Cl_dis_base.">zone_dis</a>().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00800"></a>00800 }
<a name="l00801"></a>00801 
<a name="l00802"></a><a class="code" href="classZone__Cl__VEF.html#a116c5e113b57652129a171fc73135111">00802</a> <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; <a class="code" href="classZone__Cl__VEF.html#a2a0238232a67ae5ffeef896c045df56d">Zone_Cl_VEF::zone_VEF</a>()<span class="keyword"> const</span>
<a name="l00803"></a>00803 <span class="keyword"></span>{
<a name="l00804"></a>00804   <span class="keywordflow">return</span> <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>, <a class="code" href="classZone__Cl__dis__base.html#a20ea8fc29bc5a157ee957925db285972" title="Renvoie une reference sur la zone discretisee associee aux conditions aux limites. Cette Zone_dis est associee au travers de l&#39;equation associee et pas directement a l&#39;objet Zone_Cl_dis_base.">zone_dis</a>().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00805"></a>00805 }
<a name="l00806"></a>00806 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:45 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
