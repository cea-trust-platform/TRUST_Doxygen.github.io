<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Champs/Boundary_field_inward.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Champs/Boundary_field_inward.cpp</div>  </div>
</div>
<div class="contents">
<a href="Boundary__field__inward_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Boundary_field_inward.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Champs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/8</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Boundary__field__inward_8h.html">Boundary_field_inward.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Motcle_8h.html">Motcle.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VF_8h.html">Zone_VF.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Linear__algebra__tools_8h.html">Linear_algebra_tools.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Parser__U_8h.html">Parser_U.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="EChaine_8h.html">EChaine.h</a>&gt;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a><a class="code" href="Boundary__field__inward_8cpp.html#afc712d5d74930156a9e2f1abdcf48022">00030</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classBoundary__field__inward.html" title="class Boundary_field_inward">Boundary_field_inward</a>,<span class="stringliteral">&quot;Boundary_field_inward&quot;</span>,<a class="code" href="classChamp__front__normal.html" title="class Champ_front_normal">Champ_front_normal</a>);
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="classBoundary__field__inward.html#ad947deab5d4fc08ce53f4292f17d30f2">00033</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classBoundary__field__inward.html#ad947deab5d4fc08ce53f4292f17d30f2" title="Imprime le nom du champ sur un flot de sortie.">Boundary_field_inward::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00034"></a>00034 <span class="keyword"></span>{
<a name="l00035"></a>00035   <span class="keywordflow">return</span> <a class="code" href="classBoundary__field__inward.html#ad947deab5d4fc08ce53f4292f17d30f2" title="Imprime le nom du champ sur un flot de sortie.">Champ_front_normal::printOn</a>(os);
<a name="l00036"></a>00036 }
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 
<a name="l00039"></a><a class="code" href="classBoundary__field__inward.html#a2772851a110889fc42f77ad17b621423">00039</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classBoundary__field__inward.html#a2772851a110889fc42f77ad17b621423" title="NE FAIT RIEN A surcharger dans les classes derivees.">Boundary_field_inward::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00040"></a>00040 {
<a name="l00041"></a>00041   <span class="keywordflow">return</span> <a class="code" href="classBoundary__field__inward.html#a2772851a110889fc42f77ad17b621423" title="NE FAIT RIEN A surcharger dans les classes derivees.">Champ_front_normal::readOn</a>(is);
<a name="l00042"></a>00042 }
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="comment">//</span><span class="comment"></span>
<a name="l00046"></a>00046 <span class="comment">//! Initialize normal inward field given on boundaries</span>
<a name="l00047"></a>00047 <span class="comment"></span>
<a name="l00048"></a>00048 <span class="comment">// Remark :</span>
<a name="l00049"></a>00049 <span class="comment">// This code is not in &quot;Champ_front_normal::initialiser&quot; function because in the case of using</span>
<a name="l00050"></a>00050 <span class="comment">// Champ_front_debit, the readOn function of Champ_front_normal is not called</span>
<a name="l00051"></a>00051 <span class="comment">// so vit_norm is not initialized and it can leads to critical values detected</span>
<a name="l00052"></a>00052 <span class="comment">// in debug mode.</span>
<a name="l00053"></a>00053 <span class="comment">// Moreover, when using Champ_front_debit we don&#39;t need to do all these calculations</span>
<a name="l00054"></a>00054 <span class="comment">// That is why Boundary_field_inward was created</span>
<a name="l00055"></a><a class="code" href="classBoundary__field__inward.html#a6a7090312a6983f825f2d61c592c6121">00055</a> <span class="keywordtype">int</span> <a class="code" href="classBoundary__field__inward.html#a6a7090312a6983f825f2d61c592c6121" title="Initialize normal inward field given on boundaries.">Boundary_field_inward::initialiser</a>(<span class="keywordtype">double</span> tps, <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; inco)
<a name="l00056"></a>00056 {
<a name="l00057"></a>00057   <span class="keywordflow">if</span>( !<a class="code" href="classCh__front__var__instationnaire__dep.html#a5e18c33d21cdbee5214cd7e93de34bc3" title="Initialise le temps courant et Gpoint.">Champ_front_normal::initialiser</a>(tps,inco) )
<a name="l00058"></a>00058     <span class="keywordflow">return</span> 0;
<a name="l00059"></a>00059   <a class="code" href="classBoundary__field__inward.html#a3afb39b4eecc5082c947e43b8e986137" title="NE FAIT RIEN, a surcharger. Cette methode est appelee au debut de chaque pas de temps ou sous-pas-de-...">mettre_a_jour</a>(tps);
<a name="l00060"></a>00060   <span class="keywordflow">return</span> 1;
<a name="l00061"></a>00061 }
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="classBoundary__field__inward.html#a3afb39b4eecc5082c947e43b8e986137">00063</a> <span class="keywordtype">void</span> <a class="code" href="classBoundary__field__inward.html#a3afb39b4eecc5082c947e43b8e986137" title="NE FAIT RIEN, a surcharger. Cette methode est appelee au debut de chaque pas de temps ou sous-pas-de-...">Boundary_field_inward::mettre_a_jour</a>(<span class="keywordtype">double</span> tps)
<a name="l00064"></a>00064 {
<a name="l00065"></a>00065   <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zone_VF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>,<a class="code" href="classChamp__front__base.html#a4cef320acc233b308e5241fc7c271145">zone_dis</a>());
<a name="l00066"></a>00066   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord= <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,<a class="code" href="classChamp__front__base.html#af5b3aaf468fe33492ed777c2e5772651" title="Renvoie la frontiere discretisee associee au champ. (version const)">frontiere_dis</a>());
<a name="l00067"></a>00067   <span class="keywordtype">int</span> first=le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00068"></a>00068 
<a name="l00069"></a>00069   <span class="keywordtype">int</span> nb_cases=<a class="code" href="classChamp__front__base.html#a52f671ae3217c69ec9e2175916d367ca" title="Les valeurs du champ.">les_valeurs</a>-&gt;nb_cases();
<a name="l00070"></a>00070 
<a name="l00071"></a>00071   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> tab_normal_vector(le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>(),<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="comment">// Evaluation de vit_norm:</span>
<a name="l00074"></a>00074   <a class="code" href="classChamp__front__normal.html#a338bd452005a2fd3d57e1a8a2a5521ee">vit_norm</a>.<a class="code" href="classParser__U.html#a13c377b32b6c3ced39a14f83f94a8828">setVar</a>(<span class="stringliteral">&quot;t&quot;</span>,tps);
<a name="l00075"></a>00075   <span class="keywordtype">double</span> value = <a class="code" href="classChamp__front__normal.html#a338bd452005a2fd3d57e1a8a2a5521ee">vit_norm</a>.<a class="code" href="classParser__U.html#a61605bc1b85e466f884f1739e811b6b4">eval</a>();
<a name="l00076"></a>00076 
<a name="l00077"></a>00077   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>(); i++)
<a name="l00078"></a>00078     {
<a name="l00079"></a>00079 
<a name="l00080"></a>00080       <span class="keywordtype">int</span> signe = -1;<span class="comment">//we want the opposite of the normal vector</span>
<a name="l00081"></a>00081       <span class="keywordtype">int</span> global_boundary_face_number=i+first;
<a name="l00082"></a>00082 <span class="comment">// outward vector associated to the fac global_boundary_face_number</span>
<a name="l00083"></a>00083       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> normal_vector = zone_VF.<a class="code" href="classZone__VF.html#aa0627e8b0ab8fffbc81829278a2cda77" title="Compute the normalized boundary outward vector associated to the face global_face_number and eventual...">normalized_boundaries_outward_vector</a>(global_boundary_face_number,signe);
<a name="l00084"></a>00084 
<a name="l00085"></a>00085       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; k++)
<a name="l00086"></a>00086         {
<a name="l00087"></a>00087           tab_normal_vector(i,k) = normal_vector(k);
<a name="l00088"></a>00088         }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="comment">// Fill all moments</span>
<a name="l00091"></a>00091       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=0; t&lt;nb_cases; t++)
<a name="l00092"></a>00092         {
<a name="l00093"></a>00093           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab=<a class="code" href="classChamp__front__base.html#a52f671ae3217c69ec9e2175916d367ca" title="Les valeurs du champ.">les_valeurs</a>[t].valeurs();
<a name="l00094"></a>00094           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; j++)
<a name="l00095"></a>00095             {
<a name="l00096"></a>00096               tab(i,j)=tab_normal_vector(i,j);
<a name="l00097"></a>00097               tab(i,j)*=value;
<a name="l00098"></a>00098             }
<a name="l00099"></a>00099         }
<a name="l00100"></a>00100     }
<a name="l00101"></a>00101 }
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 <span class="comment">// Obsolete soon:</span>
<a name="l00104"></a><a class="code" href="Boundary__field__inward_8cpp.html#a3c2ade1af2c5cc6c5b472ecc8d8a91d8">00104</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classChamp__front__normal__VEF.html">Champ_front_normal_VEF</a>,<span class="stringliteral">&quot;Champ_front_normal_VEF&quot;</span>,<a class="code" href="classBoundary__field__inward.html" title="class Boundary_field_inward">Boundary_field_inward</a>);
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="classChamp__front__normal__VEF.html#a1e9f47b6eaae6da7e3b0e75a8195bcfa">00106</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classChamp__front__normal__VEF.html#a1e9f47b6eaae6da7e3b0e75a8195bcfa" title="Imprime le nom du champ sur un flot de sortie.">Champ_front_normal_VEF::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00107"></a>00107 <span class="keyword"></span>{
<a name="l00108"></a>00108   <span class="keywordflow">return</span> <a class="code" href="classChamp__front__normal__VEF.html#a1e9f47b6eaae6da7e3b0e75a8195bcfa" title="Imprime le nom du champ sur un flot de sortie.">Boundary_field_inward::printOn</a>(os);
<a name="l00109"></a>00109 }
<a name="l00110"></a>00110 
<a name="l00111"></a><a class="code" href="classChamp__front__normal__VEF.html#a0b26f3ad2f9b59c0c40d9a110bc491de">00111</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classChamp__front__normal__VEF.html#a0b26f3ad2f9b59c0c40d9a110bc491de" title="NE FAIT RIEN A surcharger dans les classes derivees.">Champ_front_normal_VEF::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00112"></a>00112 {
<a name="l00113"></a>00113   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> motlu;
<a name="l00114"></a>00114   <a class="code" href="classMotcles.html" title="Un tableau d&#39;objets de la classe Motcle.">Motcles</a> les_mots(1);
<a name="l00115"></a>00115   les_mots[0]=<span class="stringliteral">&quot;valeur_normale&quot;</span>;
<a name="l00116"></a>00116   is&gt;&gt;motlu;
<a name="l00117"></a>00117   <span class="keywordflow">if</span> (motlu != les_mots[0])
<a name="l00118"></a>00118     {
<a name="l00119"></a>00119       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error while reading a Champ_front_normal&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00120"></a>00120       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;We expected &quot;</span> &lt;&lt; les_mots[0] &lt;&lt; <span class="stringliteral">&quot; instead of &quot;</span> &lt;&lt; motlu &lt;&lt; finl;
<a name="l00121"></a>00121       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00122"></a>00122     }
<a name="l00123"></a>00123   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> debit;
<a name="l00124"></a>00124   is &gt;&gt; debit;
<a name="l00125"></a>00125   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> exp(<span class="stringliteral">&quot;{ normal_value &quot;</span>);
<a name="l00126"></a>00126   exp+=debit;
<a name="l00127"></a>00127   exp+=<span class="stringliteral">&quot; } &quot;</span>;
<a name="l00128"></a>00128   <a class="code" href="classEChaine.html" title="Une entree dont la source est une chaine de caracteres. Le constructeur cree sa propre copie de la ch...">EChaine</a> E(exp);
<a name="l00129"></a>00129   <span class="keywordflow">return</span> <a class="code" href="classChamp__front__normal__VEF.html#a0b26f3ad2f9b59c0c40d9a110bc491de" title="NE FAIT RIEN A surcharger dans les classes derivees.">Boundary_field_inward::readOn</a>(E);
<a name="l00130"></a>00130   <span class="keywordflow">return</span> is;
<a name="l00131"></a>00131 }
<a name="l00132"></a>00132 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:12 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
