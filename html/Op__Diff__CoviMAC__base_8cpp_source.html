<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/CoviMAC/Operateurs/Op_Diff_CoviMAC_base.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/CoviMAC/Operateurs/Op_Diff_CoviMAC_base.cpp</div>  </div>
</div>
<div class="contents">
<a href="Op__Diff__CoviMAC__base_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Op_Diff_CoviMAC_base.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/CoviMAC/Operateurs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/25</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Op__Diff__CoviMAC__base_8h.html">Op_Diff_CoviMAC_base.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Motcle_8h.html">Motcle.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Don_8h.html">Champ_Don.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Uniforme_8h.html">Champ_Uniforme.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Don__Fonc__xyz_8h.html">Champ_Don_Fonc_xyz.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Vecteur3_8h.html">Vecteur3.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Matrice33_8h.html">Matrice33.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Linear__algebra__tools__impl_8h.html">Linear_algebra_tools_impl.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="DoubleTrav_8h.html">DoubleTrav.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Check__espace__virtuel_8h.html">Check_espace_virtuel.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Zone__CoviMAC_8h.html">Zone_CoviMAC.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__CoviMAC_8h.html">Zone_Cl_CoviMAC.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps__base_8h.html">Schema_Temps_base.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="Milieu__base_8h.html">Milieu_base.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="SFichier_8h.html">SFichier.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="communications_8h.html">communications.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="EcrFicPartage_8h.html">EcrFicPartage.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="Modele__turbulence__scal__base_8h.html">Modele_turbulence_scal_base.h</a>&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;cfloat&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="Champ__P0__CoviMAC_8h.html">Champ_P0_CoviMAC.h</a>&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Face__CoviMAC_8h.html">Champ_Face_CoviMAC.h</a>&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;<a class="code" href="Op__Diff__CoviMAC__Face_8h.html">Op_Diff_CoviMAC_Face.h</a>&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;<a class="code" href="Pb__Multiphase_8h.html">Pb_Multiphase.h</a>&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;<a class="code" href="Echange__contact__CoviMAC_8h.html">Echange_contact_CoviMAC.h</a>&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;<a class="code" href="Flux__parietal__base_8h.html">Flux_parietal_base.h</a>&gt;</span>
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="Op__Diff__CoviMAC__base_8cpp.html#a9c6167dbc6e388e724dff15c0686e754">00050</a> <a class="code" href="Declare__Base_8h.html#ad0be56e3a9cdd8f6dafc3864627fea86">Implemente_base</a>(<a class="code" href="classOp__Diff__CoviMAC__base.html" title="class Op_Diff_CoviMAC_base Classe de base des operateurs de diffusion CoviMAC">Op_Diff_CoviMAC_base</a>,<span class="stringliteral">&quot;Op_Diff_CoviMAC_base&quot;</span>,<a class="code" href="classOperateur__Diff__base.html" title="classe Operateur_Diff_base Cette classe est la base de la hierarchie des operateurs representant un t...">Operateur_Diff_base</a>);
<a name="l00051"></a><a class="code" href="Op__Diff__CoviMAC__base_8cpp.html#aa4cc96f955b8ba2041d56c2ceaa0cb73">00051</a> <a class="code" href="MacRef_8h.html#a67b571ae2caa2f388a7d532cf57553fe">Implemente_ref</a>(<a class="code" href="classOp__Diff__CoviMAC__base.html" title="class Op_Diff_CoviMAC_base Classe de base des operateurs de diffusion CoviMAC">Op_Diff_CoviMAC_base</a>);
<a name="l00052"></a>00052 <span class="comment"></span>
<a name="l00053"></a>00053 <span class="comment">////!&lt; printOn </span>
<a name="l00054"></a>00054 <span class="comment"></span><span class="comment">//</span>
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#afae3e161c65ea475461282292f94a6e9">00056</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classOp__Diff__CoviMAC__base.html#afae3e161c65ea475461282292f94a6e9" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Diff_CoviMAC_base::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00057"></a>00057 <span class="keyword"></span>{
<a name="l00058"></a>00058   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() ;
<a name="l00059"></a>00059 }
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="comment"></span>
<a name="l00062"></a>00062 <span class="comment">////!&lt; readOn </span>
<a name="l00063"></a>00063 <span class="comment"></span><span class="comment">//</span>
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#aa89a1d8d1b98b9c6690b9c06aa974eb8">00065</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classOp__Diff__CoviMAC__base.html#aa89a1d8d1b98b9c6690b9c06aa974eb8" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Diff_CoviMAC_base::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s )
<a name="l00066"></a>00066 {
<a name="l00067"></a>00067   <span class="keywordflow">return</span> s ;
<a name="l00068"></a>00068 }
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#acb2b91eedaccd131fa7b089a9c2f8899">00070</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__CoviMAC__base.html#acb2b91eedaccd131fa7b089a9c2f8899" title="NE FAIT RIEN A surcharger dans les classes derivees. Mise a jour de l&#39;operateur.">Op_Diff_CoviMAC_base::mettre_a_jour</a>(<span class="keywordtype">double</span> t)
<a name="l00071"></a>00071 {
<a name="l00072"></a>00072   <a class="code" href="classOp__Diff__CoviMAC__base.html#acb2b91eedaccd131fa7b089a9c2f8899" title="NE FAIT RIEN A surcharger dans les classes derivees. Mise a jour de l&#39;operateur.">Operateur_base::mettre_a_jour</a>(t);
<a name="l00073"></a>00073 <span class="comment">// si le champ est constant en temps, alors pas besoin de recalculer nu_ et les interpolations</span>
<a name="l00074"></a>00074   <span class="keywordflow">if</span> (t &lt;= <a class="code" href="classOp__Diff__CoviMAC__base.html#a8ab4e6c71a25298bd809169d40d7c19d">t_last_maj_</a>) <span class="keywordflow">return</span>;
<a name="l00075"></a>00075   <span class="keywordflow">if</span> (!<a class="code" href="classOp__Diff__CoviMAC__base.html#a57d773e8e977da755f68c8a8e1432b02">nu_constant_</a>) <a class="code" href="classOp__Diff__CoviMAC__base.html#ab2e31908d2d969f4f72e42b6c9c0c8f8">nu_a_jour_</a> = 0, <a class="code" href="classOp__Diff__CoviMAC__base.html#a62beb0993436c7b619802e623753ddc3">xwh_a_jour_</a> = 0, <a class="code" href="classOp__Diff__CoviMAC__base.html#ae88be1d65b95dd6500259545bb6e7ebb">phif_a_jour_</a> = 0;
<a name="l00076"></a>00076   <a class="code" href="classOp__Diff__CoviMAC__base.html#a8ab4e6c71a25298bd809169d40d7c19d">t_last_maj_</a> = t;
<a name="l00077"></a>00077 }
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 
<a name="l00080"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#af4d08f67b31eefdd3b5e7a9805c3e4cc">00080</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__CoviMAC__base.html#af4d08f67b31eefdd3b5e7a9805c3e4cc" title="Associe l&#39;operateur a la zone_dis, la zone_Cl_dis, et a l&#39;inconnue de son equation.">Op_Diff_CoviMAC_base::completer</a>()
<a name="l00081"></a>00081 {
<a name="l00082"></a>00082   <a class="code" href="classOp__Diff__CoviMAC__base.html#af4d08f67b31eefdd3b5e7a9805c3e4cc" title="Associe l&#39;operateur a la zone_dis, la zone_Cl_dis, et a l&#39;inconnue de son equation.">Operateur_base::completer</a>();
<a name="l00083"></a>00083   <span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eq = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>();
<a name="l00084"></a>00084   <span class="keywordtype">int</span> N = eq.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>().<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>(), D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>, N_nu = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(N * <a class="code" href="classOp__Diff__CoviMAC__base.html#ab586bcf9c082a8d116914cd346fff0c7">dimension_min_nu</a>(), <a class="code" href="classOp__Diff__CoviMAC__base.html#a1c4d24904a017685511b0bdca207d47c">diffusivite</a>().valeurs().line_size());
<a name="l00085"></a>00085   <span class="keywordflow">if</span> (N_nu == N) <a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, N); <span class="comment">//isotrope</span>
<a name="l00086"></a>00086   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N_nu == N * D) <a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, N, D); <span class="comment">//diagonal</span>
<a name="l00087"></a>00087   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N_nu == N * D * D) <a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, N, D, D); <span class="comment">//complet</span>
<a name="l00088"></a>00088   <span class="keywordflow">else</span> <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>(<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(<span class="stringliteral">&quot;Op_Diff_CoviMAC_base : diffusivity component count &quot;</span>) + <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(N_nu) + <span class="stringliteral">&quot;not among (&quot;</span> + <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(N) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(N * D) + <span class="stringliteral">&quot;, &quot;</span> + <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(N * D * D)  + <span class="stringliteral">&quot;)!&quot;</span>);
<a name="l00089"></a>00089   <span class="keyword">const</span> <a class="code" href="classZone__CoviMAC.html" title="class Zone_CoviMAC Classe instanciable qui derive de Zone_VF. Cette classe contient les informations ...">Zone_CoviMAC</a>&amp; zone = <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>.<a class="code" href="classRef__Zone__CoviMAC.html#afdc5338ee3120ae40d6363ef023659f7">valeur</a>();
<a name="l00090"></a>00090   zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(<a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>);
<a name="l00091"></a>00091   <a class="code" href="classOp__Diff__CoviMAC__base.html#a1d8c66e0393aada8e364b239c13823a4">invh_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, N), zone.<a class="code" href="classZone__VF.html#a2e795192234e9c5e1eb4d5f919632db7">creer_tableau_faces_bord</a>(<a class="code" href="classOp__Diff__CoviMAC__base.html#a1d8c66e0393aada8e364b239c13823a4">invh_</a>);
<a name="l00092"></a>00092   <a class="code" href="classOp__Diff__CoviMAC__base.html#a79292e2f48a46c7edeb3d1987693725d">xh_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(zone.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>(), N, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>); <span class="comment">//position des points harmoniques, poids de l&#39;amont</span>
<a name="l00093"></a>00093   <a class="code" href="classOp__Diff__CoviMAC__base.html#a46cad808dce26686f3917499c0c3e469">wh_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(zone.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>(), N);
<a name="l00094"></a>00094 
<a name="l00095"></a>00095   <span class="keywordtype">int</span> f_max = <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classOp__Diff__CoviMAC__Face.html" title=": class Op_Diff_CoviMAC_Face &lt;Description of class Op_Diff_CoviMAC_Face&gt;">Op_Diff_CoviMAC_Face</a>, *<span class="keyword">this</span>) ? zone.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>() : zone.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>(); <span class="comment">//en Op_.._Face, on doit aussi faire les faces virtuelles</span>
<a name="l00096"></a>00096   <a class="code" href="classOp__Diff__CoviMAC__base.html#a6345c35b21fc3e890659e229818a2c60">phif_w</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(f_max, N); <span class="comment">//tableaux phif_* statiques</span>
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <a class="code" href="classOp__Diff__CoviMAC__base.html#a57d773e8e977da755f68c8a8e1432b02">nu_constant_</a> = (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Uniforme.html" title="classe Champ_Uniforme Represente un champ constant dans l&#39;espace et dans le temps.">Champ_Uniforme</a>, <a class="code" href="classOp__Diff__CoviMAC__base.html#a1c4d24904a017685511b0bdca207d47c">diffusivite</a>()) || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Don__Fonc__xyz.html" title="class Champ_Don_Fonc_xyz Cette classe represente un champ de donnees fonction des variables d&#39;espaces...">Champ_Don_Fonc_xyz</a>, <a class="code" href="classOp__Diff__CoviMAC__base.html#a1c4d24904a017685511b0bdca207d47c">diffusivite</a>())) &amp;&amp; !<a class="code" href="classOp__Diff__Turbulent__base.html#aeed9decc805e603a4d24ffa06c640419">has_diffusivite_turbulente</a>();
<a name="l00099"></a>00099 }
<a name="l00100"></a>00100 
<a name="l00101"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#ae8c518441515b3fe39c7ba2db069cc91">00101</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__CoviMAC__base.html#ae8c518441515b3fe39c7ba2db069cc91">Op_Diff_CoviMAC_base::init_op_ext</a>()<span class="keyword"> const</span>
<a name="l00102"></a>00102 <span class="keyword"></span>{
<a name="l00103"></a>00103   <span class="keyword">const</span> <a class="code" href="classZone__CoviMAC.html" title="class Zone_CoviMAC Classe instanciable qui derive de Zone_VF. Cette classe contient les informations ...">Zone_CoviMAC</a>&amp; zone = <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>.<a class="code" href="classRef__Zone__CoviMAC.html#afdc5338ee3120ae40d6363ef023659f7">valeur</a>();
<a name="l00104"></a>00104   <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; cls = <a class="code" href="classOp__Diff__CoviMAC__base.html#a1d0fa27b46f0833e024ce482ed24cb5f">la_zcl_poly_</a>-&gt;les_conditions_limites();
<a name="l00105"></a>00105   <span class="keywordtype">int</span> i, j, fb, M, N = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>().<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>(), n_mono, idx;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <a class="code" href="classOperateur__Diff__base.html#a55bd9b2fad5e6ef816f89ea07371ddfc">op_ext</a> = { <span class="keyword">this</span> };<span class="comment">//le premier op_ext est l&#39;operateur local</span>
<a name="l00108"></a>00108   <a class="code" href="classOp__Diff__CoviMAC__base.html#abf8b054bff07e80b5d66aa8571c7d3ad" title="tableau aux faces de bord : (indice dans op_ext, indice d&#39;element) pour les faces de type Echange_con...">pe_ext</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, 3), zone.<a class="code" href="classZone__VF.html#a2e795192234e9c5e1eb4d5f919632db7">creer_tableau_faces_bord</a>(<a class="code" href="classOp__Diff__CoviMAC__base.html#abf8b054bff07e80b5d66aa8571c7d3ad" title="tableau aux faces de bord : (indice dans op_ext, indice d&#39;element) pour les faces de type Echange_con...">pe_ext</a>);
<a name="l00109"></a>00109   <span class="keywordflow">for</span> (<a class="code" href="classOp__Diff__CoviMAC__base.html#abf8b054bff07e80b5d66aa8571c7d3ad" title="tableau aux faces de bord : (indice dans op_ext, indice d&#39;element) pour les faces de type Echange_con...">pe_ext</a> = -1, i = 0, n_mono = 0, M = N; i &lt; cls.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); i++) <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classEchange__contact__CoviMAC.html">Echange_contact_CoviMAC</a>, cls[i].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>())) <span class="comment">//on ajoute ceux des Echange_contact</span>
<a name="l00110"></a>00110       {
<a name="l00111"></a>00111         <span class="keyword">const</span> <a class="code" href="classEchange__contact__CoviMAC.html">Echange_contact_CoviMAC</a>&amp; cl = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classEchange__contact__CoviMAC.html">Echange_contact_CoviMAC</a>, cls[i].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00112"></a>00112         <span class="keyword">const</span> <a class="code" href="classOp__Diff__CoviMAC__base.html" title="class Op_Diff_CoviMAC_base Classe de base des operateurs de diffusion CoviMAC">Op_Diff_CoviMAC_base</a> *o_diff = &amp;cl.<a class="code" href="classEchange__contact__CoviMAC.html#ac6cffd6d774ad632eb304822904fff60">o_diff</a>.<a class="code" href="classRef__Op__Diff__CoviMAC__base.html#af5f7898401c37435cd01192f9a7f6a3e">valeur</a>();
<a name="l00113"></a>00113         <span class="keywordflow">if</span> (std::find(<a class="code" href="classOperateur__Diff__base.html#a55bd9b2fad5e6ef816f89ea07371ddfc">op_ext</a>.begin(), <a class="code" href="classOperateur__Diff__base.html#a55bd9b2fad5e6ef816f89ea07371ddfc">op_ext</a>.end(), o_diff) == <a class="code" href="classOperateur__Diff__base.html#a55bd9b2fad5e6ef816f89ea07371ddfc">op_ext</a>.end()) <a class="code" href="classOperateur__Diff__base.html#a55bd9b2fad5e6ef816f89ea07371ddfc">op_ext</a>.push_back(o_diff);
<a name="l00114"></a>00114         M = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(M, o_diff-&gt;<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>().<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>()); <span class="comment">//M -&gt; nb de composantes maximal</span>
<a name="l00115"></a>00115         <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; fvf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>, cls[i].frontiere_dis());
<a name="l00116"></a>00116         <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; fe_dist = cl.<a class="code" href="classEchange__contact__CoviMAC.html#acab7d3c8b7a70833e57a53bfb0d30e2a">fe_dist</a>();
<a name="l00117"></a>00117         <span class="keywordflow">for</span> (j = 0, idx = std::find(<a class="code" href="classOperateur__Diff__base.html#a55bd9b2fad5e6ef816f89ea07371ddfc">op_ext</a>.begin(), <a class="code" href="classOperateur__Diff__base.html#a55bd9b2fad5e6ef816f89ea07371ddfc">op_ext</a>.end(), o_diff) - <a class="code" href="classOperateur__Diff__base.html#a55bd9b2fad5e6ef816f89ea07371ddfc">op_ext</a>.begin(); j &lt; fvf.nb_faces_tot(); j++, n_mono++)
<a name="l00118"></a>00118           fb = zone.<a class="code" href="classZone__VF.html#a9cfb439ce3b58852ba3beec40b2b8c4e">fbord</a>(fvf.num_face(j)), <a class="code" href="classOp__Diff__CoviMAC__base.html#abf8b054bff07e80b5d66aa8571c7d3ad" title="tableau aux faces de bord : (indice dans op_ext, indice d&#39;element) pour les faces de type Echange_con...">pe_ext</a>(fb, 0) = idx, <a class="code" href="classOp__Diff__CoviMAC__base.html#abf8b054bff07e80b5d66aa8571c7d3ad" title="tableau aux faces de bord : (indice dans op_ext, indice d&#39;element) pour les faces de type Echange_con...">pe_ext</a>(fb, 1) = fe_dist(j, 1), <a class="code" href="classOp__Diff__CoviMAC__base.html#abf8b054bff07e80b5d66aa8571c7d3ad" title="tableau aux faces de bord : (indice dans op_ext, indice d&#39;element) pour les faces de type Echange_con...">pe_ext</a>(fb, 2) = n_mono;
<a name="l00119"></a>00119       }
<a name="l00120"></a>00120   <a class="code" href="classOp__Diff__CoviMAC__base.html#a20299635b90ef882ed329cbfec81d2d2">whm_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n_mono, N, M, 2);
<a name="l00121"></a>00121 }
<a name="l00122"></a>00122 
<a name="l00123"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#a977bd2abcc6154f3290134f0a283329f">00123</a> <span class="keywordtype">int</span> <a class="code" href="classOp__Diff__CoviMAC__base.html#a977bd2abcc6154f3290134f0a283329f" title="NE FAIT RIEN A surcharger dans les classes derivees. Imprime l&#39;operateur sur un flot de sortie...">Op_Diff_CoviMAC_base::impr</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00124"></a>00124 <span class="keyword"></span>{
<a name="l00125"></a>00125   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; ma_zone=<a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>-&gt;zone();
<a name="l00126"></a>00126   <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; impr_mom=ma_zone.<a class="code" href="classZone.html#a1147c5a9ff1ba84a899979712734cb28">Moments_a_imprimer</a>();
<a name="l00127"></a>00127   <span class="keyword">const</span> <span class="keywordtype">int</span> impr_sum=(ma_zone.<a class="code" href="classZone.html#aa5780fa644b13f8172c4805336846dec">Bords_a_imprimer_sum</a>().<a class="code" href="classliste.html#a68a1377a9c67f05e76638da8d93e2d5a" title="Teste si la liste est vide.">est_vide</a>() ? 0:1);
<a name="l00128"></a>00128   <span class="keyword">const</span> <span class="keywordtype">int</span> impr_bord=(ma_zone.<a class="code" href="classZone.html#a2e4f80965f20d39334b470af7aec494a">Bords_a_imprimer</a>().<a class="code" href="classliste.html#a68a1377a9c67f05e76638da8d93e2d5a" title="Teste si la liste est vide.">est_vide</a>() ? 0:1);
<a name="l00129"></a>00129   <span class="keyword">const</span> <a class="code" href="classSchema__Temps__base.html" title="classe Schema_Temps_base">Schema_Temps_base</a>&amp; sch = <a class="code" href="classOp__Diff__CoviMAC__base.html#a1d0fa27b46f0833e024ce482ed24cb5f">la_zcl_poly_</a>-&gt;equation().probleme().schema_temps();
<a name="l00130"></a>00130   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_flux_bords= <a class="code" href="classOperateur__base.html#ab547b37ace0f04931f6f09fcfa8fae0c">flux_bords</a>();
<a name="l00131"></a>00131   <span class="keywordtype">int</span> nb_comp = tab_flux_bords.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() &gt; 1 ? tab_flux_bords.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) : 0;
<a name="l00132"></a>00132   <a class="code" href="classDoubleVect.html">DoubleVect</a> bilan(nb_comp);
<a name="l00133"></a>00133   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces = <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>-&gt;nb_faces_tot();
<a name="l00134"></a>00134   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> xgr(nb_faces,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00135"></a>00135   xgr=0.;
<a name="l00136"></a>00136   <span class="keywordflow">if</span> (impr_mom)
<a name="l00137"></a>00137     {
<a name="l00138"></a>00138       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xgrav = <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>-&gt;xv();
<a name="l00139"></a>00139       <span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; c_grav=ma_zone.<a class="code" href="classZone.html#ab6b13609a679b31cc3a6931362490e2a">cg_moments</a>();
<a name="l00140"></a>00140       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=0; num_face &lt;nb_faces; num_face++)
<a name="l00141"></a>00141         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)
<a name="l00142"></a>00142           xgr(num_face,i)=xgrav(num_face,i)-c_grav(i);
<a name="l00143"></a>00143     }
<a name="l00144"></a>00144   <span class="keywordtype">int</span> k,face;
<a name="l00145"></a>00145   <span class="keywordtype">int</span> nb_front_Cl=<a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>-&gt;nb_front_Cl();
<a name="l00146"></a>00146   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> flux_bords2( 5, nb_front_Cl , nb_comp) ;
<a name="l00147"></a>00147   flux_bords2=0;
<a name="l00148"></a>00148   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l00149"></a>00149     {
<a name="l00150"></a>00150       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = <a class="code" href="classOp__Diff__CoviMAC__base.html#a1d0fa27b46f0833e024ce482ed24cb5f">la_zcl_poly_</a>-&gt;les_conditions_limites(num_cl);
<a name="l00151"></a>00151       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00152"></a>00152       <span class="keywordtype">int</span> ndeb = frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00153"></a>00153       <span class="keywordtype">int</span> nfin = ndeb + frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00154"></a>00154       <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l00155"></a>00155         {
<a name="l00156"></a>00156           <span class="keywordflow">for</span>(k=0; k&lt;nb_comp; k++)
<a name="l00157"></a>00157             {
<a name="l00158"></a>00158               flux_bords2(0,num_cl,k)+=tab_flux_bords(face, k);
<a name="l00159"></a>00159               <span class="keywordflow">if</span> (ma_zone.<a class="code" href="classZone.html#aa5780fa644b13f8172c4805336846dec">Bords_a_imprimer_sum</a>().<a class="code" href="classList__Nom.html#aafe66fe06c0dd82cb2641fcaf774db07">contient</a>(frontiere_dis.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>()))
<a name="l00160"></a>00160                 flux_bords2(3,num_cl,k)+=tab_flux_bords(face, k);
<a name="l00161"></a>00161             }  <span class="comment">/* fin for k */</span>
<a name="l00162"></a>00162           <span class="keywordflow">if</span> (impr_mom)
<a name="l00163"></a>00163             {
<a name="l00164"></a>00164               <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==2)
<a name="l00165"></a>00165                 {
<a name="l00166"></a>00166                   flux_bords2(4,num_cl,0)+=tab_flux_bords(face,1)*xgr(face,0)-tab_flux_bords(face,0)*xgr(face,1);
<a name="l00167"></a>00167                 }
<a name="l00168"></a>00168               <span class="keywordflow">else</span>
<a name="l00169"></a>00169                 {
<a name="l00170"></a>00170                   flux_bords2(4,num_cl,0)+=tab_flux_bords(face,2)*xgr(face,1)-tab_flux_bords(face,1)*xgr(face,2);
<a name="l00171"></a>00171                   flux_bords2(4,num_cl,1)+=tab_flux_bords(face,0)*xgr(face,2)-tab_flux_bords(face,2)*xgr(face,0);
<a name="l00172"></a>00172                   flux_bords2(4,num_cl,2)+=tab_flux_bords(face,1)*xgr(face,0)-tab_flux_bords(face,0)*xgr(face,1);
<a name="l00173"></a>00173                 }
<a name="l00174"></a>00174             }
<a name="l00175"></a>00175         } <span class="comment">/* fin for face */</span>
<a name="l00176"></a>00176     }
<a name="l00177"></a>00177   <a class="code" href="communications_8cpp.html#a5f15b8a5c15449d3277ff3cde06fa68a">mp_sum_for_each_item</a>(flux_bords2);
<a name="l00178"></a>00178 
<a name="l00179"></a>00179   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>() &amp;&amp; nb_comp &gt; 0)
<a name="l00180"></a>00180     {
<a name="l00181"></a>00181 <span class="comment">// SFichier Flux;</span>
<a name="l00182"></a>00182       <span class="keywordflow">if</span> (!<a class="code" href="classOp__Diff__CoviMAC__base.html#a5f74e223799d8721c0c35006bffe4011">Flux</a>.<a class="code" href="classSortie__Fichier__base.html#acc0244cc2feedba886b643e9b3c295db">is_open</a>()) <a class="code" href="classOperateur__base.html#a163b8e77d9ad86d8c0cdd28d29903538" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier</a>(<a class="code" href="classOp__Diff__CoviMAC__base.html#a5f74e223799d8721c0c35006bffe4011">Flux</a>,<span class="stringliteral">&quot;&quot;</span>,1);
<a name="l00183"></a>00183 <span class="comment">// SFichier Flux_moment;</span>
<a name="l00184"></a>00184       <span class="keywordflow">if</span> (!<a class="code" href="classOp__Diff__CoviMAC__base.html#af6ea7cc9c3e91df375cef6d86af5a64c">Flux_moment</a>.<a class="code" href="classSortie__Fichier__base.html#acc0244cc2feedba886b643e9b3c295db">is_open</a>()) <a class="code" href="classOperateur__base.html#a163b8e77d9ad86d8c0cdd28d29903538" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier</a>(<a class="code" href="classOp__Diff__CoviMAC__base.html#af6ea7cc9c3e91df375cef6d86af5a64c">Flux_moment</a>,<span class="stringliteral">&quot;moment&quot;</span>,impr_mom);
<a name="l00185"></a>00185 <span class="comment">// SFichier Flux_sum;</span>
<a name="l00186"></a>00186       <span class="keywordflow">if</span> (!<a class="code" href="classOp__Diff__CoviMAC__base.html#abee752b8cea5734c345213df998e5ff7">Flux_sum</a>.<a class="code" href="classSortie__Fichier__base.html#acc0244cc2feedba886b643e9b3c295db">is_open</a>()) <a class="code" href="classOperateur__base.html#a163b8e77d9ad86d8c0cdd28d29903538" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier</a>(<a class="code" href="classOp__Diff__CoviMAC__base.html#abee752b8cea5734c345213df998e5ff7">Flux_sum</a>,<span class="stringliteral">&quot;sum&quot;</span>,impr_sum);
<a name="l00187"></a>00187       <a class="code" href="classOp__Diff__CoviMAC__base.html#a5f74e223799d8721c0c35006bffe4011">Flux</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(sch.<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>());
<a name="l00188"></a>00188       <span class="keywordflow">if</span> (impr_mom) <a class="code" href="classOp__Diff__CoviMAC__base.html#af6ea7cc9c3e91df375cef6d86af5a64c">Flux_moment</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(sch.<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>());
<a name="l00189"></a>00189       <span class="keywordflow">if</span> (impr_sum) <a class="code" href="classOp__Diff__CoviMAC__base.html#abee752b8cea5734c345213df998e5ff7">Flux_sum</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(sch.<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>());
<a name="l00190"></a>00190       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l00191"></a>00191         {
<a name="l00192"></a>00192           <span class="keywordflow">for</span>(k=0; k&lt;nb_comp; k++)
<a name="l00193"></a>00193             {
<a name="l00194"></a>00194               <a class="code" href="classOp__Diff__CoviMAC__base.html#a5f74e223799d8721c0c35006bffe4011">Flux</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(flux_bords2(0,num_cl,k));
<a name="l00195"></a>00195               <span class="keywordflow">if</span> (impr_sum) <a class="code" href="classOp__Diff__CoviMAC__base.html#abee752b8cea5734c345213df998e5ff7">Flux_sum</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(flux_bords2(3,num_cl,k));
<a name="l00196"></a>00196               bilan(k)+=flux_bords2(0,num_cl,k);
<a name="l00197"></a>00197             }
<a name="l00198"></a>00198           <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)
<a name="l00199"></a>00199             {
<a name="l00200"></a>00200               <span class="keywordflow">for</span> (k=0; k&lt;nb_comp; k++)
<a name="l00201"></a>00201                 <span class="keywordflow">if</span> (impr_mom) <a class="code" href="classOp__Diff__CoviMAC__base.html#af6ea7cc9c3e91df375cef6d86af5a64c">Flux_moment</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(flux_bords2(4,num_cl,k));
<a name="l00202"></a>00202             }
<a name="l00203"></a>00203           <span class="keywordflow">else</span>
<a name="l00204"></a>00204             {
<a name="l00205"></a>00205               <span class="keywordflow">if</span> (impr_mom) <a class="code" href="classOp__Diff__CoviMAC__base.html#af6ea7cc9c3e91df375cef6d86af5a64c">Flux_moment</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(flux_bords2(4,num_cl,0));
<a name="l00206"></a>00206             }
<a name="l00207"></a>00207         } <span class="comment">/* fin for num_cl */</span>
<a name="l00208"></a>00208       <span class="keywordflow">for</span>(k=0; k&lt;nb_comp; k++)
<a name="l00209"></a>00209         <a class="code" href="classOp__Diff__CoviMAC__base.html#a5f74e223799d8721c0c35006bffe4011">Flux</a>.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(bilan(k));
<a name="l00210"></a>00210       <a class="code" href="classOp__Diff__CoviMAC__base.html#a5f74e223799d8721c0c35006bffe4011">Flux</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00211"></a>00211       <span class="keywordflow">if</span> (impr_sum) <a class="code" href="classOp__Diff__CoviMAC__base.html#abee752b8cea5734c345213df998e5ff7">Flux_sum</a> &lt;&lt; finl;
<a name="l00212"></a>00212       <span class="keywordflow">if</span> (impr_mom) <a class="code" href="classOp__Diff__CoviMAC__base.html#af6ea7cc9c3e91df375cef6d86af5a64c">Flux_moment</a> &lt;&lt; finl;
<a name="l00213"></a>00213     }
<a name="l00214"></a>00214   <span class="keyword">const</span> <a class="code" href="List_8h.html#a3149526fb499ddb08728c87daa32c5ad">LIST</a>(<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>)&amp; Liste_Bords_a_imprimer = <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>-&gt;zone().Bords_a_imprimer();
<a name="l00215"></a>00215   <span class="keywordflow">if</span> (!Liste_Bords_a_imprimer.est_vide() &amp;&amp; nb_comp &gt; 0)
<a name="l00216"></a>00216     {
<a name="l00217"></a>00217       <a class="code" href="classEcrFicPartage.html">EcrFicPartage</a> Flux_face;
<a name="l00218"></a>00218       <a class="code" href="classOperateur__base.html#a75f3b320ba6d2b58ab1a43a10f317de4" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier_partage</a>(Flux_face,<span class="stringliteral">&quot;&quot;</span>,impr_bord);
<a name="l00219"></a>00219       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cl=0; num_cl&lt;nb_front_Cl; num_cl++)
<a name="l00220"></a>00220         {
<a name="l00221"></a>00221           <span class="keyword">const</span> <a class="code" href="classFrontiere__dis__base.html" title="classe Frontiere_dis_base Classe representant une frontiere discretisee. Les objets Frontiere_dis_bas...">Frontiere_dis_base</a>&amp; la_fr = <a class="code" href="classOp__Diff__CoviMAC__base.html#a1d0fa27b46f0833e024ce482ed24cb5f">la_zcl_poly_</a>-&gt;les_conditions_limites(num_cl).frontiere_dis();
<a name="l00222"></a>00222           <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = <a class="code" href="classOp__Diff__CoviMAC__base.html#a1d0fa27b46f0833e024ce482ed24cb5f">la_zcl_poly_</a>-&gt;les_conditions_limites(num_cl);
<a name="l00223"></a>00223           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00224"></a>00224           <span class="keywordtype">int</span> ndeb = frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00225"></a>00225           <span class="keywordtype">int</span> nfin = ndeb + frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00226"></a>00226           <span class="keywordflow">if</span> (ma_zone.<a class="code" href="classZone.html#a2e4f80965f20d39334b470af7aec494a">Bords_a_imprimer</a>().<a class="code" href="classList__Nom.html#aafe66fe06c0dd82cb2641fcaf774db07">contient</a>(la_fr.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>()))
<a name="l00227"></a>00227             {
<a name="l00228"></a>00228               <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00229"></a>00229                 {
<a name="l00230"></a>00230                   Flux_face &lt;&lt; <span class="stringliteral">&quot;# Flux par face sur &quot;</span> &lt;&lt; la_fr.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; au temps &quot;</span>;
<a name="l00231"></a>00231                   sch.<a class="code" href="classSchema__Temps__base.html#afb4a13da2e8149defb5339ef005ef231">imprimer_temps_courant</a>(Flux_face);
<a name="l00232"></a>00232                   Flux_face &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00233"></a>00233                 }
<a name="l00234"></a>00234               <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l00235"></a>00235                 {
<a name="l00236"></a>00236                   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2)
<a name="l00237"></a>00237                     Flux_face &lt;&lt; <span class="stringliteral">&quot;# Face a x= &quot;</span> &lt;&lt; <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>-&gt;xv(face,0) &lt;&lt; <span class="stringliteral">&quot; y= &quot;</span> &lt;&lt; <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>-&gt;xv(face,1) &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;
<a name="l00238"></a>00238                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00239"></a>00239                     Flux_face &lt;&lt; <span class="stringliteral">&quot;# Face a x= &quot;</span> &lt;&lt; <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>-&gt;xv(face,0) &lt;&lt; <span class="stringliteral">&quot; y= &quot;</span> &lt;&lt; <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>-&gt;xv(face,1) &lt;&lt; <span class="stringliteral">&quot; z= &quot;</span> &lt;&lt; <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>-&gt;xv(face,2) &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;
<a name="l00240"></a>00240                   <span class="keywordflow">for</span>(k=0; k&lt;nb_comp; k++)
<a name="l00241"></a>00241                     Flux_face &lt;&lt; tab_flux_bords(face, k) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00242"></a>00242                   Flux_face &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00243"></a>00243                 }
<a name="l00244"></a>00244               Flux_face.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00245"></a>00245             }
<a name="l00246"></a>00246         }
<a name="l00247"></a>00247     }
<a name="l00248"></a>00248   <span class="keywordflow">return</span> 1;
<a name="l00249"></a>00249 }
<a name="l00250"></a>00250 <span class="comment">/*</span>
<a name="l00251"></a>00251 <span class="comment">void Op_Diff_CoviMAC_base::associer_zone_cl_dis(const Zone_Cl_dis_base&amp; zcl)</span>
<a name="l00252"></a>00252 <span class="comment">{</span>
<a name="l00253"></a>00253 <span class="comment">  la_zcl_poly_ = ref_cast(Zone_Cl_CoviMAC,zcl);</span>
<a name="l00254"></a>00254 <span class="comment">}</span>
<a name="l00255"></a>00255 <span class="comment">*/</span>
<a name="l00256"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#a83ce58562d87f9a957254c73b23ef65c">00256</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__CoviMAC__base.html#a83ce58562d87f9a957254c73b23ef65c">Op_Diff_CoviMAC_base::associer</a>(<span class="keyword">const</span> <a class="code" href="classZone__dis.html" title="classe Zone_dis Classe generique de la hierarchie des zones discretisees. Un objet de type Zone_dis p...">Zone_dis</a>&amp; zone_dis, <span class="keyword">const</span> <a class="code" href="classZone__Cl__dis.html" title="classe Zone_Cl_dis Classe generique de la hierarchie des conditions aux limites discretisees. Un objet Zone_Cl_dis peut referencer n&#39;importe quel derivant de Zone_Cl_dis_base. La plupart des methodes appellent les methodes de l&#39;objet Probleme sous-jacent via la methode valeur() declaree grace a la macro Declare_deriv().;">Zone_Cl_dis</a>&amp; zcl,<span class="keyword">const</span> <a class="code" href="classChamp__Inc.html">Champ_Inc</a>&amp; )
<a name="l00257"></a>00257 {
<a name="l00258"></a>00258   <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__CoviMAC.html" title="class Zone_CoviMAC Classe instanciable qui derive de Zone_VF. Cette classe contient les informations ...">Zone_CoviMAC</a>,zone_dis.<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>());
<a name="l00259"></a>00259   <a class="code" href="classOp__Diff__CoviMAC__base.html#a1d0fa27b46f0833e024ce482ed24cb5f">la_zcl_poly_</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__CoviMAC.html">Zone_Cl_CoviMAC</a>,zcl.<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00260"></a>00260 }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="comment">//</span>
<a name="l00263"></a>00263 <span class="comment">//</span><span class="comment"></span>
<a name="l00264"></a>00264 <span class="comment">//! calcule la contribution de la diffusion, la range dans resu&lt;br&gt;renvoie resu</span>
<a name="l00265"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#acaa813bb016693afcb5f1ec38b3ff622">00265</a> <span class="comment"></span><a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Diff__CoviMAC__base.html#acaa813bb016693afcb5f1ec38b3ff622" title="calcule la contribution de la diffusion, la range dans resu renvoie resu">Op_Diff_CoviMAC_base::calculer</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inco,  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu)<span class="keyword"> const</span>
<a name="l00266"></a>00266 <span class="keyword"></span>{
<a name="l00267"></a>00267   resu =0;
<a name="l00268"></a>00268   <span class="keywordflow">return</span> <a class="code" href="classOperateur__base.html#a883475470b7446b8b2093859494abef4">ajouter</a>(inco, resu);
<a name="l00269"></a>00269 }
<a name="l00270"></a>00270 
<a name="l00271"></a>00271 
<a name="l00272"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#a706b18aa77625b27842e2a613337a190">00272</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__CoviMAC__base.html#a706b18aa77625b27842e2a613337a190">Op_Diff_CoviMAC_base::associer_diffusivite</a>(<span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; diffu)
<a name="l00273"></a>00273 {
<a name="l00274"></a>00274   <a class="code" href="classOp__Diff__CoviMAC__base.html#a74d68ea04406091a28fa9bd80ba1e038">diffusivite_</a> = diffu;
<a name="l00275"></a>00275 }
<a name="l00276"></a>00276 
<a name="l00277"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#a1c4d24904a017685511b0bdca207d47c">00277</a> <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; <a class="code" href="classOp__Diff__CoviMAC__base.html#a1c4d24904a017685511b0bdca207d47c">Op_Diff_CoviMAC_base::diffusivite</a>()<span class="keyword"> const</span>
<a name="l00278"></a>00278 <span class="keyword"></span>{
<a name="l00279"></a>00279   <span class="keywordflow">return</span> <a class="code" href="classOp__Diff__CoviMAC__base.html#a74d68ea04406091a28fa9bd80ba1e038">diffusivite_</a>.<a class="code" href="classRef__Champ__base.html#a0cda53fe61d4f24bc8861720d525b32a">valeur</a>();
<a name="l00280"></a>00280 }
<a name="l00281"></a>00281 
<a name="l00282"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#a7f16cfaca2f2defa27f0aa715cde3003">00282</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__CoviMAC__base.html#a7f16cfaca2f2defa27f0aa715cde3003">Op_Diff_CoviMAC_base::update_nu_invh</a>()<span class="keyword"> const</span>
<a name="l00283"></a>00283 <span class="keyword"></span>{
<a name="l00284"></a>00284   <span class="keyword">const</span> <a class="code" href="classZone__CoviMAC.html" title="class Zone_CoviMAC Classe instanciable qui derive de Zone_VF. Cette classe contient les informations ...">Zone_CoviMAC</a>&amp; zone = <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>.<a class="code" href="classRef__Zone__CoviMAC.html#afdc5338ee3120ae40d6363ef023659f7">valeur</a>();
<a name="l00285"></a>00285   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; f_e = zone.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00286"></a>00286   <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; cls = <a class="code" href="classOp__Diff__CoviMAC__base.html#a1d0fa27b46f0833e024ce482ed24cb5f">la_zcl_poly_</a>-&gt;les_conditions_limites();
<a name="l00287"></a>00287   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; nu_src = <a class="code" href="classOp__Diff__CoviMAC__base.html#a1c4d24904a017685511b0bdca207d47c">diffusivite</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>(), &amp;nf = zone.<a class="code" href="classZone__CoviMAC.html#a079b965aaef7bfcbb3dcd49981ba2c8d">face_normales</a>();
<a name="l00288"></a>00288   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; fs = zone.<a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>();
<a name="l00289"></a>00289   <span class="keywordtype">int</span> e, i, j, k, f, fb, m, n, N = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>().<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>(), N_nu = <a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>(), N_nu_src = nu_src.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>(), mult = N_nu / N,
<a name="l00290"></a>00290                                c_nu = nu_src.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0) == 1, d, db, D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>, nf_tot = zone.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
<a name="l00291"></a>00291   assert(N_nu % N == 0);
<a name="l00292"></a>00292 
<a name="l00293"></a>00293   <span class="comment">/* nu_ : si necessaire, on doit etendre la champ source */</span>
<a name="l00294"></a>00294   <span class="keywordflow">if</span> (N_nu == N_nu_src) <span class="keywordflow">for</span> (e = 0; e &lt; zone.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++) <span class="keywordflow">for</span> (n = 0; n &lt; N_nu; n++) <a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>()[N_nu * e +  n] = nu_src(!c_nu * e, n); <span class="comment">//facile</span>
<a name="l00295"></a>00295   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N_nu == N * D &amp;&amp; N_nu_src == N) <span class="keywordflow">for</span> (e = 0; e &lt; zone.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++) <span class="keywordflow">for</span> (n = 0; n &lt; N; n++) <span class="keywordflow">for</span> (d = 0; d &lt; D; d++) <span class="comment">//diagonal</span>
<a name="l00296"></a>00296           <a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>(e, n, d) = nu_src(!c_nu * e, n);
<a name="l00297"></a>00297   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N_nu == N * D * D &amp;&amp; (N_nu_src == N || N_nu_src == N * D)) <span class="keywordflow">for</span> (e = 0; e &lt; zone.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++) <span class="keywordflow">for</span> (n = 0; n &lt; N; n++) <span class="comment">//complet</span>
<a name="l00298"></a>00298         <span class="keywordflow">for</span> (d = 0; d &lt; D; d++) <span class="keywordflow">for</span> (db = 0; db &lt; D; db++) <a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>(e, n, d, db) = (d == db) * nu_src(!c_nu * e, N_nu_src == N ? n : D * n + d);
<a name="l00299"></a>00299   <span class="keywordflow">else</span> <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">abort</a>();
<a name="l00300"></a>00300 
<a name="l00301"></a>00301   <span class="keywordflow">if</span> (<a class="code" href="classOp__Diff__Turbulent__base.html#aeed9decc805e603a4d24ffa06c640419">has_diffusivite_turbulente</a>()) <span class="comment">/* prise en compte de la turbulence */</span>
<a name="l00302"></a>00302     {
<a name="l00303"></a>00303       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; nut_src = <a class="code" href="classOp__Diff__Turbulent__base.html#af674533b0786ba32fa6a408b6c8bba04">diffusivite_turbulente</a>().<a class="code" href="classChamp__Fonc.html#a60b75eadb0987d488884e24fcb72d1e5" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs du champ.">valeurs</a>();
<a name="l00304"></a>00304       <span class="keywordtype">int</span> c_nut = (nut_src.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0) == 1), N_nut_src = nut_src.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00305"></a>00305       <span class="keywordflow">if</span> (N_nu == N_nut_src) <span class="keywordflow">for</span> (e = 0; e &lt; zone.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++) <span class="keywordflow">for</span> (n = 0; n &lt; N_nu; n++) <a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>()[N_nu * e + n] += nut_src(!c_nut * e, n); <span class="comment">//facile</span>
<a name="l00306"></a>00306       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N_nu == N * D &amp;&amp; N_nut_src == N) <span class="keywordflow">for</span> (e = 0; e &lt; zone.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++) <span class="keywordflow">for</span> (n = 0; n &lt; N; n++) <span class="keywordflow">for</span> (d = 0; d &lt; D; d++) <span class="comment">//diagonal</span>
<a name="l00307"></a>00307               <a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>(e, n, d) += nut_src(!c_nut * e, n);
<a name="l00308"></a>00308       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (N_nu == N * D * D &amp;&amp; (N_nut_src == N || N_nut_src == N * D)) <span class="keywordflow">for</span> (e = 0; e &lt; zone.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++) <span class="keywordflow">for</span> (n = 0; n &lt; N; n++) <span class="comment">//complet</span>
<a name="l00309"></a>00309             <span class="keywordflow">for</span> (d = 0; d &lt; D; d++) <span class="keywordflow">for</span> (db = 0; db &lt; D; db++) <a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>(e, n, d, db) += (d == db) * nut_src(!c_nut * e, N_nut_src == N ? n : D * n + d);
<a name="l00310"></a>00310       <span class="keywordflow">else</span> <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">abort</a>();
<a name="l00311"></a>00311     }
<a name="l00312"></a>00312 
<a name="l00313"></a>00313   <span class="comment">/* ponderation de nu par la porosite et par alpha (si pb_Multiphase) */</span>
<a name="l00314"></a>00314   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> *alp = <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPb__Multiphase.html" title="classe Pb_Multiphase Cette classe represente un probleme de thermohydraulique multiphase de type &quot;3*...">Pb_Multiphase</a>, <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().probleme()) ? &amp;<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPb__Multiphase.html" title="classe Pb_Multiphase Cette classe represente un probleme de thermohydraulique multiphase de type &quot;3*...">Pb_Multiphase</a>, <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().probleme()).eq_masse.inconnue().passe() : NULL;
<a name="l00315"></a>00315   <span class="keywordflow">for</span> (e = 0; e &lt; zone.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++) <span class="keywordflow">for</span> (n = 0, i = 0; n &lt; N; n++) <span class="keywordflow">for</span> (m = 0; m &lt; mult; m++, i++)
<a name="l00316"></a>00316         <a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>()[N_nu * e + i] *= zone.<a class="code" href="classZone__VF.html#afd135a1b227731193b1a97b7ed525435">porosite_elem</a>()(e) * (alp ? <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>((*alp)(e, n), 1e-8) : 1);
<a name="l00317"></a>00317 
<a name="l00318"></a>00318   <span class="comment">/* modification par une classe fille */</span>
<a name="l00319"></a>00319   <a class="code" href="classOp__Diff__CoviMAC__base.html#ae7ae245c38e12be14cf714fedbcf7290">modifier_nu</a>(<a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>);
<a name="l00320"></a>00320 
<a name="l00321"></a>00321   <span class="comment">/* resistivite (1 / h) aux faces de bord */</span>
<a name="l00322"></a>00322   <span class="keyword">const</span> <a class="code" href="classRef__Objet__U.html">RefObjU</a>* modele_turbulence = <a class="code" href="classOp__Diff__Turbulent__base.html#aeed9decc805e603a4d24ffa06c640419">has_diffusivite_turbulente</a>() ? &amp;<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#ab0bb5d06bdc91e131dc9d5f9d7b57095">get_modele</a>(<a class="code" href="Equation__base_8h.html#a2c9d34b2cc47e5b2b18347de20a77db5a0fecbd75e0b8b4c37ffd696e173a14c7">TURBULENCE</a>) : NULL;
<a name="l00323"></a>00323   <span class="keyword">const</span> <a class="code" href="classTurbulence__paroi__scal__base.html" title="Classe Turbulence_paroi_scal_base Classe de base pour la hierarchie des classes representant les mode...">Turbulence_paroi_scal_base</a> *loi_par = modele_turbulence &amp;&amp; modele_turbulence-&gt;<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>() &amp;&amp; <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classModele__turbulence__scal__base.html" title="Classe Modele_turbulence_scal_base Cette classe represente un modele de turbulence pour une equation ...">Modele_turbulence_scal_base</a>,modele_turbulence-&gt;<a class="code" href="classRef__Objet__U.html#ad875112c0fd275aa0c0aa710481ab11e">valeur</a>()) ?
<a name="l00324"></a>00324                                               &amp;<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classModele__turbulence__scal__base.html" title="Classe Modele_turbulence_scal_base Cette classe represente un modele de turbulence pour une equation ...">Modele_turbulence_scal_base</a>,modele_turbulence-&gt;<a class="code" href="classRef__Objet__U.html#ad875112c0fd275aa0c0aa710481ab11e">valeur</a>()).loi_paroi().valeur() : NULL;
<a name="l00325"></a>00325 
<a name="l00326"></a>00326   <span class="comment">/* si Pb_Multiphase et correlation de flux parietal -&gt; invh par la correlation */</span>
<a name="l00327"></a>00327   <span class="keyword">const</span> <a class="code" href="classPb__Multiphase.html" title="classe Pb_Multiphase Cette classe represente un probleme de thermohydraulique multiphase de type &quot;3*...">Pb_Multiphase</a> *pbm = <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPb__Multiphase.html" title="classe Pb_Multiphase Cette classe represente un probleme de thermohydraulique multiphase de type &quot;3*...">Pb_Multiphase</a>, <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().probleme()) ? &amp;<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPb__Multiphase.html" title="classe Pb_Multiphase Cette classe represente un probleme de thermohydraulique multiphase de type &quot;3*...">Pb_Multiphase</a>, <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().probleme()) : NULL;
<a name="l00328"></a>00328   <span class="keywordflow">if</span> (pbm &amp;&amp; <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classEnergie__Multiphase.html" title="classe Energie_Multiphase Cas particulier de Convection_Diffusion_std pour un fluide quasi conpressib...">Energie_Multiphase</a>, <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>()) &amp;&amp; <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPb__Multiphase.html" title="classe Pb_Multiphase Cette classe represente un probleme de thermohydraulique multiphase de type &quot;3*...">Pb_Multiphase</a>, <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().probleme()).has_correlation(<span class="stringliteral">&quot;flux_parietal&quot;</span>))
<a name="l00329"></a>00329     {
<a name="l00330"></a>00330       <span class="keyword">const</span> <a class="code" href="classFlux__parietal__base.html" title="classe Flux_parietal_base correlations de flux parietal de la forme flux de chaleur : q_{pk} = F(alph...">Flux_parietal_base</a>&amp; flux = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFlux__parietal__base.html" title="classe Flux_parietal_base correlations de flux parietal de la forme flux de chaleur : q_{pk} = F(alph...">Flux_parietal_base</a>, <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPb__Multiphase.html" title="classe Pb_Multiphase Cette classe represente un probleme de thermohydraulique multiphase de type &quot;3*...">Pb_Multiphase</a>, <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().probleme()).get_correlation(<span class="stringliteral">&quot;flux_parietal&quot;</span>).<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00331"></a>00331       <span class="keyword">const</span> <a class="code" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>&amp; mil = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>, <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().milieu());
<a name="l00332"></a>00332       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; temp = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(), &amp;press = pbm-&gt;<a class="code" href="classPb__Multiphase.html#adf2872b95eb3bdb1a22e6d3c55bda061">eq_qdm</a>.<a class="code" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a" title="Renvoie le champ de pression.">pression</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(), &amp;alpha = pbm-&gt;<a class="code" href="classPb__Multiphase.html#affb5ae03eb9e469afd34b084cda27d95">eq_masse</a>.<a class="code" href="classMasse__Multiphase.html#a1d77eeafadabbeac5bebb84bfafaac29" title="Renvoie le champ inconnue representant l&#39;inconnue (T ou H) (version const)">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(),
<a name="l00333"></a>00333                        &amp;vit = pbm-&gt;<a class="code" href="classPb__Multiphase.html#adf2872b95eb3bdb1a22e6d3c55bda061">eq_qdm</a>.<a class="code" href="classNavier__Stokes__std.html#a743b777e6185faee7837326844c8fca1" title="Renvoie la vitesse (champ inconnue de l&#39;equation) (version const)">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(), &amp;lambda = mil.<a class="code" href="classMilieu__base.html#a99251c07d04e1f13ec4c300bfe8757db" title="Renvoie la conductivite du milieu. (version const)">conductivite</a>().<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>(),
<a name="l00334"></a>00334                         &amp;mu = mil.<a class="code" href="classFluide__base.html#ae9d2bcde48c733b8b7652a32c6a80e49" title="Renvoie la viscosite dynamique, mu. (version const)">viscosite_dynamique</a>().<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>(), &amp;rho = mil.<a class="code" href="classMilieu__base.html#a46a9a4bfb046ed22d0f267b6c052889f" title="Renvoie la masse volumique du milieu. (version const)">masse_volumique</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>(), &amp;Cp = mil.<a class="code" href="classMilieu__base.html#a174d49eab1db7dfce83578b227f4e702" title="Renvoie la capacite calorifique du milieu. (version const)">capacite_calorifique</a>().<a class="code" href="classChamp__Don.html#a7e848a3a3cbe82cb50ab70c0c96505bd" title="Appel a l&#39;objet sous-jacent. Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l00335"></a>00335       <span class="keywordtype">int</span> c_lambda = lambda.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0) == 1, c_mu = mu.dimension(0) == 1, c_rho = rho.dimension(0) == 1, c_Cp = Cp.dimension(0) == 1;
<a name="l00336"></a>00336       <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> nv(N); <span class="comment">//normes des vitesses</span>
<a name="l00337"></a>00337       <span class="keywordflow">for</span> (i = 0; i &lt; cls.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); i++)
<a name="l00338"></a>00338         {
<a name="l00339"></a>00339           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; fvf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>, cls[i].frontiere_dis());
<a name="l00340"></a>00340           <span class="keywordflow">for</span> (j = 0; j &lt; fvf.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>(); j++)
<a name="l00341"></a>00341             {
<a name="l00342"></a>00342               <span class="comment">/* FIXME: ne marche que pour les flux lineaires */</span>
<a name="l00343"></a>00343               f = fvf.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(j), e = f_e(f, 0), fb = zone.<a class="code" href="classZone__VF.html#a9cfb439ce3b58852ba3beec40b2b8c4e">fbord</a>(f);
<a name="l00344"></a>00344               <span class="keywordflow">for</span> (nv = 0, d = 0, k = nf_tot + D * e; d &lt; D; d++, k++) <span class="keywordflow">for</span> (n = 0; n &lt; N; n++) nv(n) += std::pow(vit(k, n), 2);
<a name="l00345"></a>00345               <span class="keywordflow">for</span> (n = 0; n &lt; N; n++) nv(n) = sqrt(nv(n));
<a name="l00346"></a>00346               flux.<a class="code" href="classFlux__parietal__base.html#a8c18ffac11b87fd0e9fe45d3b84f106d">flux_chaleur</a>(N, zone.<a class="code" href="classZone__CoviMAC.html#af95d2084d566bad62b845d8e0fe76eef">dist_norm_bord</a>(f), zone.<a class="code" href="classZone__CoviMAC.html#af95d2084d566bad62b845d8e0fe76eef">dist_norm_bord</a>(f), &amp;alpha(e, 0), &amp;temp(e, 0), press(e, 0), nv.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), 0,
<a name="l00347"></a>00347                                 &amp;lambda(!c_lambda * e, 0), &amp;mu(!c_mu * e, 0), &amp;rho(!c_rho * e, 0), &amp;Cp(!c_Cp * e, 0),
<a name="l00348"></a>00348                                 NULL, NULL, NULL, NULL, NULL, &amp;<a class="code" href="classOp__Diff__CoviMAC__base.html#a1d8c66e0393aada8e364b239c13823a4">invh_</a>(fb, 0)); <span class="comment">//stocke le coefficient d&#39;echange dans invh_</span>
<a name="l00349"></a>00349               <span class="keywordflow">for</span> (n = 0; n &lt; N; n++) <a class="code" href="classOp__Diff__CoviMAC__base.html#a1d8c66e0393aada8e364b239c13823a4">invh_</a>(fb, n) = 1. / <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(<a class="code" href="classOp__Diff__CoviMAC__base.html#a1d8c66e0393aada8e364b239c13823a4">invh_</a>(fb, n), 1e-10); <span class="comment">//pour eviter invh_ = +inf</span>
<a name="l00350"></a>00350             }
<a name="l00351"></a>00351         }
<a name="l00352"></a>00352     }
<a name="l00353"></a>00353   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loi_par &amp;&amp; loi_par-&gt;<a class="code" href="classTurbulence__paroi__scal__base.html#a8d862e042634c38c2cc2dfabc4671b17" title="Give a boolean indicating if we need to use equivant distance by default we consider that we use the ...">use_equivalent_distance</a>()) <span class="keywordflow">for</span> (i = 0; i &lt; cls.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); i++) <span class="comment">/* si loi de paroi : invh par equivalent_distance */</span>
<a name="l00354"></a>00354       {
<a name="l00355"></a>00355         <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; fvf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>, cls[i].frontiere_dis());
<a name="l00356"></a>00356         <span class="keywordflow">for</span> (j = 0; j &lt; fvf.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>(); j++) <span class="keywordflow">for</span> (f = fvf.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(j), fb = zone.<a class="code" href="classZone__VF.html#a9cfb439ce3b58852ba3beec40b2b8c4e">fbord</a>(f), n = 0; n &lt; N; n++)
<a name="l00357"></a>00357             <a class="code" href="classOp__Diff__CoviMAC__base.html#a1d8c66e0393aada8e364b239c13823a4">invh_</a>(fb, n) = (loi_par-&gt;<a class="code" href="classTurbulence__paroi__scal__base.html#af70d24c25a5d09299f25081e6c697da7">equivalent_distance</a>(i, j) - zone.<a class="code" href="classZone__CoviMAC.html#af95d2084d566bad62b845d8e0fe76eef">dist_norm_bord</a>(f)) * fs(f) * fs(f) / zone.<a class="code" href="classZone__CoviMAC.html#adb355629a4e62710130ee231b2e5866f">nu_dot</a>(&amp;<a class="code" href="classOp__Diff__CoviMAC__base.html#afb68667e0c3c2ef74f1894029af46606">nu_</a>, f_e(f, 0), n, &amp;nf(f, 0), &amp;nf(f, 0));
<a name="l00358"></a>00358       }
<a name="l00359"></a>00359   <span class="keywordflow">else</span> <a class="code" href="classOp__Diff__CoviMAC__base.html#a1d8c66e0393aada8e364b239c13823a4">invh_</a> = 0;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361   <a class="code" href="classOp__Diff__CoviMAC__base.html#ab2e31908d2d969f4f72e42b6c9c0c8f8">nu_a_jour_</a> = 1;
<a name="l00362"></a>00362 }
<a name="l00363"></a>00363 
<a name="l00364"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#a19705774150ab166d921e7c7a338e7de">00364</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__CoviMAC__base.html#a19705774150ab166d921e7c7a338e7de">Op_Diff_CoviMAC_base::update_xwh</a>()<span class="keyword"> const</span>
<a name="l00365"></a>00365 <span class="keyword"></span>{
<a name="l00366"></a>00366   <span class="keywordflow">if</span> (!<a class="code" href="classOp__Diff__CoviMAC__base.html#a4dab7832399015baa349681f1b6ff285">op_ext_init_</a>) <a class="code" href="classOp__Diff__CoviMAC__base.html#ae8c518441515b3fe39c7ba2db069cc91">init_op_ext</a>(), <a class="code" href="classOp__Diff__CoviMAC__base.html#a4dab7832399015baa349681f1b6ff285">op_ext_init_</a> = 1;
<a name="l00367"></a>00367   <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>-&gt;harmonic_points(<a class="code" href="classOp__Diff__CoviMAC__base.html#a1d0fa27b46f0833e024ce482ed24cb5f">la_zcl_poly_</a>-&gt;les_conditions_limites(), 0, 1, &amp;<a class="code" href="classOp__Diff__CoviMAC__base.html#a9de0eb438061f4e68043b8eafc567992">nu</a>(), &amp;<a class="code" href="classOp__Diff__CoviMAC__base.html#a0b59d2655e87abfe718336359da1d946">invh</a>(), <a class="code" href="classOp__Diff__CoviMAC__base.html#a79292e2f48a46c7edeb3d1987693725d">xh_</a>, <a class="code" href="classOp__Diff__CoviMAC__base.html#a46cad808dce26686f3917499c0c3e469">wh_</a>, &amp;<a class="code" href="classOp__Diff__CoviMAC__base.html#a20299635b90ef882ed329cbfec81d2d2">whm_</a>);
<a name="l00368"></a>00368   <a class="code" href="classOp__Diff__CoviMAC__base.html#a62beb0993436c7b619802e623753ddc3">xwh_a_jour_</a> = 1;
<a name="l00369"></a>00369 }
<a name="l00370"></a>00370 
<a name="l00371"></a><a class="code" href="classOp__Diff__CoviMAC__base.html#a7d955f430407582c38bf46da4cede96b">00371</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Diff__CoviMAC__base.html#a7d955f430407582c38bf46da4cede96b">Op_Diff_CoviMAC_base::update_phif</a>(<span class="keywordtype">int</span> full_stencil)<span class="keyword"> const</span>
<a name="l00372"></a>00372 <span class="keyword"></span>{
<a name="l00373"></a>00373   <span class="keywordflow">if</span> (!full_stencil &amp;&amp; <a class="code" href="classOp__Diff__CoviMAC__base.html#ae88be1d65b95dd6500259545bb6e7ebb">phif_a_jour_</a>) <span class="keywordflow">return</span>; <span class="comment">//deja fait, sauf si on demande tout le stencil</span>
<a name="l00374"></a>00374   <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; ch = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>();
<a name="l00375"></a>00375   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; fcl = <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Face__CoviMAC.html" title=": class Champ_Face_CoviMAC Champ correspondant a une inconnue decrite par ses tangentes aux faces dua...">Champ_Face_CoviMAC</a>, ch) ? <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__Face__CoviMAC.html" title=": class Champ_Face_CoviMAC Champ correspondant a une inconnue decrite par ses tangentes aux faces dua...">Champ_Face_CoviMAC</a>, ch).fcl() : <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P0__CoviMAC.html" title=": class Champ_P0_CoviMAC Champ correspondant a une inconnue scalaire (type temperature ou pression) D...">Champ_P0_CoviMAC</a>, ch).fcl();
<a name="l00376"></a>00376   <a class="code" href="classOp__Diff__CoviMAC__base.html#ad247c0b926ce241e0489ef81eb06da90">la_zone_poly_</a>-&gt;fgrad(<a class="code" href="classOp__Diff__CoviMAC__base.html#a1d0fa27b46f0833e024ce482ed24cb5f">la_zcl_poly_</a>-&gt;les_conditions_limites(), fcl, &amp;<a class="code" href="classOp__Diff__CoviMAC__base.html#a9de0eb438061f4e68043b8eafc567992">nu</a>(), &amp;<a class="code" href="classOp__Diff__CoviMAC__base.html#a0b59d2655e87abfe718336359da1d946">invh</a>(), <a class="code" href="classOp__Diff__CoviMAC__base.html#a1af673755f26fa4425f57606ea1de9b7">xh</a>(), <a class="code" href="classOp__Diff__CoviMAC__base.html#a458bd76b955a79832d2d3e574b8be3da">wh</a>(), &amp;<a class="code" href="classOp__Diff__CoviMAC__base.html#a676a60707bbe956ec8042699b5204aa6">whm</a>(),
<a name="l00377"></a>00377                        &amp;<a class="code" href="classOp__Diff__CoviMAC__base.html#abf8b054bff07e80b5d66aa8571c7d3ad" title="tableau aux faces de bord : (indice dans op_ext, indice d&#39;element) pour les faces de type Echange_con...">pe_ext</a>, 1, full_stencil, <a class="code" href="classOp__Diff__CoviMAC__base.html#a6345c35b21fc3e890659e229818a2c60">phif_w</a>, <a class="code" href="classOp__Diff__CoviMAC__base.html#a990619ca97652abb5a2175d98c2fd57d">phif_d</a>, <a class="code" href="classOp__Diff__CoviMAC__base.html#a06aa25bfb4629f98e86e1e76bbb23cfb">phif_e</a>, <a class="code" href="classOp__Diff__CoviMAC__base.html#a0f942d534798025f3d16e2914c7fe940">phif_c</a>, &amp;<a class="code" href="classOp__Diff__CoviMAC__base.html#afdd20cb08e97f4b9e54118864ab41b07">phif_pe</a>, &amp;<a class="code" href="classOp__Diff__CoviMAC__base.html#a2ad7a61ee18ccbc546df074ca7dc05d3">phif_pc</a>);
<a name="l00378"></a>00378   <a class="code" href="classOp__Diff__CoviMAC__base.html#ae88be1d65b95dd6500259545bb6e7ebb">phif_a_jour_</a> = 1;
<a name="l00379"></a>00379 }
<a name="l00380"></a>00380 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:09 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
