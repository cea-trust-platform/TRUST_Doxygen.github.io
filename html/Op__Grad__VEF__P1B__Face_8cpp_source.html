<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/P1NCP1B/Operateurs/Op_Grad_VEF_P1B_Face.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/P1NCP1B/Operateurs/Op_Grad_VEF_P1B_Face.cpp</div>  </div>
</div>
<div class="contents">
<a href="Op__Grad__VEF__P1B__Face_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2019, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Op_Grad_VEF_P1B_Face.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/P1NCP1B/Operateurs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/49</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Op__Grad__VEF__P1B__Face_8h.html">Op_Grad_VEF_P1B_Face.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Periodique_8h.html">Periodique.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Symetrie_8h.html">Symetrie.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet_8h.html">Dirichlet.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__homogene_8h.html">Dirichlet_homogene.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Neumann__sortie__libre_8h.html">Neumann_sortie_libre.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Navier__Stokes__std_8h.html">Navier_Stokes_std.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps_8h.html">Schema_Temps.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Check__espace__virtuel_8h.html">Check_espace_virtuel.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="DoubleTrav_8h.html">DoubleTrav.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps__base_8h.html">Schema_Temps_base.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="EcrFicPartage_8h.html">EcrFicPartage.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="communications_8h.html">communications.h</a>&gt;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a><a class="code" href="Op__Grad__VEF__P1B__Face_8cpp.html#a8fd57f7ddb2aa13353121645e607769f">00040</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classOp__Grad__VEF__P1B__Face.html">Op_Grad_VEF_P1B_Face</a>,<span class="stringliteral">&quot;Op_Grad_VEFPreP1B_P1NC&quot;</span>,<a class="code" href="classOp__Grad__VEF__Face.html" title="class Op_Grad_VEF_Face Cette classe represente l&#39;operateur de gradient La discretisation est VEF On c...">Op_Grad_VEF_Face</a>);
<a name="l00041"></a>00041 <span class="comment"></span>
<a name="l00042"></a>00042 <span class="comment">////!&lt; printOn </span>
<a name="l00043"></a>00043 <span class="comment"></span><span class="comment">//</span>
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="classOp__Grad__VEF__P1B__Face.html#ac04f111fd1108db515933da3c1a5ef9b">00045</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classOp__Grad__VEF__P1B__Face.html#ac04f111fd1108db515933da3c1a5ef9b" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Grad_VEF_P1B_Face::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00046"></a>00046 <span class="keyword"></span>{
<a name="l00047"></a>00047   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() ;
<a name="l00048"></a>00048 }
<a name="l00049"></a>00049 <span class="comment"></span>
<a name="l00050"></a>00050 <span class="comment">////!&lt; readOn </span>
<a name="l00051"></a>00051 <span class="comment"></span><span class="comment">//</span>
<a name="l00052"></a>00052 
<a name="l00053"></a><a class="code" href="classOp__Grad__VEF__P1B__Face.html#a3eda4450179a00b5fbccdfc9e059a6fa">00053</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a3eda4450179a00b5fbccdfc9e059a6fa" title="NE FAIT RIEN A surcharger dans les classes derivees.">Op_Grad_VEF_P1B_Face::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s)
<a name="l00054"></a>00054 {
<a name="l00055"></a>00055   <span class="keywordflow">return</span> s ;
<a name="l00056"></a>00056 }
<a name="l00057"></a>00057 
<a name="l00058"></a><a class="code" href="classOp__Grad__VEF__P1B__Face.html#a119193ee318666864303ef213caeae4c">00058</a> <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a119193ee318666864303ef213caeae4c">Op_Grad_VEF_P1B_Face::zone_Vef</a>()<span class="keyword"> const</span>
<a name="l00059"></a>00059 <span class="keyword"></span>{
<a name="l00060"></a>00060   <span class="keywordflow">return</span> <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>, <a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>());
<a name="l00061"></a>00061 }
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="Op__Grad__VEF__P1B__Face_8cpp.html#a43ddbecfeb5d72a0ccf918858acb528c">00063</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="Op__Grad__VEF__P1B__Face_8cpp.html#a43ddbecfeb5d72a0ccf918858acb528c">chercher_arete</a>(<span class="keywordtype">int</span> elem, <span class="keywordtype">int</span> somi, <span class="keywordtype">int</span> somj,
<a name="l00064"></a>00064                           <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_aretes,
<a name="l00065"></a>00065                           <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; aretes_som)
<a name="l00066"></a>00066 {
<a name="l00067"></a>00067   <span class="keywordflow">if</span>(somi&gt;somj)
<a name="l00068"></a>00068     {
<a name="l00069"></a>00069       <span class="keywordtype">int</span> k=somi;
<a name="l00070"></a>00070       somi=somj;
<a name="l00071"></a>00071       somj=k;
<a name="l00072"></a>00072     }
<a name="l00073"></a>00073   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i_arete=0; i_arete&lt;6; i_arete++)
<a name="l00074"></a>00074     {
<a name="l00075"></a>00075       <span class="keywordtype">int</span> arete=elem_aretes(elem, i_arete);
<a name="l00076"></a>00076       <span class="keywordtype">int</span> som1=aretes_som(arete,0);
<a name="l00077"></a>00077       <span class="keywordflow">if</span>(somi==som1)
<a name="l00078"></a>00078         {
<a name="l00079"></a>00079           <span class="keywordtype">int</span> som2=aretes_som(arete,1);
<a name="l00080"></a>00080           <span class="keywordflow">if</span>(somj==som2)
<a name="l00081"></a>00081             <span class="keywordflow">return</span> arete;
<a name="l00082"></a>00082         }
<a name="l00083"></a>00083     }
<a name="l00084"></a>00084   <span class="keywordflow">return</span> -1;
<a name="l00085"></a>00085 }
<a name="l00086"></a><a class="code" href="Op__Grad__VEF__P1B__Face_8cpp.html#a1d94ed8110c6c4744485a08d56129342">00086</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">verifier</a>(<span class="keyword">const</span> <a class="code" href="classOp__Grad__VEF__P1B__Face.html">Op_Grad_VEF_P1B_Face</a>&amp; op,
<a name="l00087"></a>00087                      <span class="keywordtype">int</span>&amp; init,
<a name="l00088"></a>00088                      <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_VEF,
<a name="l00089"></a>00089                      <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pre,
<a name="l00090"></a>00090                      <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; grad)
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 {
<a name="l00093"></a>00093 <span class="comment">// Methode verifier ne marche que pour P0+P1 en 2D et P0+P1+Pa en 3D</span>
<a name="l00094"></a>00094   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2 &amp;&amp; zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#aee2def53aa92584d7945e7c3d0d98963">get_alphaE</a>()+zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#ad7fbcb5567dcc2e6f0a0ed85ce90a4fa">get_alphaS</a>()!=2)
<a name="l00095"></a>00095     {
<a name="l00096"></a>00096       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Methode verifier de Op_Grad_VEF_P1B_Face non valable pour cette discretisation.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00097"></a>00097       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00098"></a>00098     }
<a name="l00099"></a>00099   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3 &amp;&amp; zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#aee2def53aa92584d7945e7c3d0d98963">get_alphaE</a>()+zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#ad7fbcb5567dcc2e6f0a0ed85ce90a4fa">get_alphaS</a>()+zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a9d02e2431efb6e75c3d733ff06f89549">get_alphaA</a>()!=3)
<a name="l00100"></a>00100     {
<a name="l00101"></a>00101       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Methode verifier de Op_Grad_VEF_P1B_Face non valable pour cette discretisation.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00102"></a>00102       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00105"></a>00105   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00106"></a>00106   <span class="keywordtype">int</span> nb_elem_tot=zone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00107"></a>00107   <span class="keywordtype">int</span> nb_som_tot=dom.<a class="code" href="classDomaine.html#a394e61cf1993665886de0fbbd0c0178e" title="Renvoie le nombre total de sommets.">nb_som_tot</a>();
<a name="l00108"></a>00108   <span class="keywordtype">int</span> nb_elem=zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>();
<a name="l00109"></a>00109   init=1;
<a name="l00110"></a>00110   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes_entrelaces = zone_VEF.<a class="code" href="classZone__VF.html#a64f0b549e5aea1656855113e3510f418">volumes_entrelaces</a>();
<a name="l00111"></a>00111   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xp = zone_VEF.<a class="code" href="classZone__VF.html#a87a29f0223c71256a25ee343c9277599">xp</a>();
<a name="l00112"></a>00112   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord_sommets=dom.<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="comment">// Verification de la pression arete</span>
<a name="l00115"></a>00115   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> tab(pre);
<a name="l00116"></a>00116   <a class="code" href="Zone__VEF__PreP1b_8cpp.html#ad8ba71244ad9a61cd78b6f388d7e503a">exemple_champ_non_homogene</a>(zone_VEF, tab);
<a name="l00117"></a>00117 
<a name="l00118"></a>00118   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> r(grad);
<a name="l00119"></a>00119   r=0;
<a name="l00120"></a>00120   op.<a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa6a129d8e40cc848b551414f64d1f0ab">ajouter</a>(tab, r);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="comment">// Pression mise a 1 sur tous les noeuds</span>
<a name="l00123"></a>00123   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> p(pre);
<a name="l00124"></a>00124   p=1;
<a name="l00125"></a>00125   r=0;
<a name="l00126"></a>00126   op.<a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa6a129d8e40cc848b551414f64d1f0ab">ajouter</a>(p, r);
<a name="l00127"></a>00127   <span class="keywordflow">if</span> (nb_elem&lt;30)
<a name="l00128"></a>00128     {
<a name="l00129"></a>00129       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot; grad(1) som = &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00130"></a>00130       r.<a class="code" href="classDoubleTab.html#ab7588e94792cc0be3a3288573c44ca18" title="ecriture des valeurs du tableau &quot;raw&quot; sans structure parallele">ecrit</a>(<a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>);
<a name="l00131"></a>00131     }
<a name="l00132"></a>00132 <span class="comment">// Pression mise a 1 sur les elements seulement</span>
<a name="l00133"></a>00133   p=0;
<a name="l00134"></a>00134   <span class="keywordtype">int</span> i=0;
<a name="l00135"></a>00135   <span class="keywordflow">for</span>(; i&lt;nb_elem_tot; i++)
<a name="l00136"></a>00136     p(i)=0;
<a name="l00137"></a>00137   r=0;
<a name="l00138"></a>00138   op.<a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa6a129d8e40cc848b551414f64d1f0ab">ajouter</a>(p, r);
<a name="l00139"></a>00139   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>&lt;&lt;<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot;] p(1) elem = &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00140"></a>00140   p.<a class="code" href="classDoubleTab.html#ab7588e94792cc0be3a3288573c44ca18" title="ecriture des valeurs du tableau &quot;raw&quot; sans structure parallele">ecrit</a>(<a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>);
<a name="l00141"></a>00141   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>&lt;&lt;<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot;] grad(1) elem = &quot;</span> &lt;&lt; finl;
<a name="l00142"></a>00142   r.<a class="code" href="classDoubleTab.html#ab7588e94792cc0be3a3288573c44ca18" title="ecriture des valeurs du tableau &quot;raw&quot; sans structure parallele">ecrit</a>(<a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>);
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 <span class="comment">// Pression mise a 1 sur les sommets seulement</span>
<a name="l00145"></a>00145   p=0;
<a name="l00146"></a>00146   <span class="keywordflow">for</span>(; i&lt;nb_elem_tot+nb_som_tot; i++)
<a name="l00147"></a>00147     p(i)=1;
<a name="l00148"></a>00148   r=0;
<a name="l00149"></a>00149   op.<a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa6a129d8e40cc848b551414f64d1f0ab">ajouter</a>(p, r);
<a name="l00150"></a>00150   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot; grad(1) som = &quot;</span> &lt;&lt; finl;
<a name="l00151"></a>00151   r.<a class="code" href="classDoubleTab.html#ab7588e94792cc0be3a3288573c44ca18" title="ecriture des valeurs du tableau &quot;raw&quot; sans structure parallele">ecrit</a>(<a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="comment">// Pression mise a 1 sur les aretes seulement</span>
<a name="l00154"></a>00154   p=0;
<a name="l00155"></a>00155   <span class="keywordtype">int</span> <a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a>=p.<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>();
<a name="l00156"></a>00156   <span class="keywordflow">for</span>(; i&lt;<a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a>; i++)
<a name="l00157"></a>00157     p(i)=1;
<a name="l00158"></a>00158   r=0;
<a name="l00159"></a>00159   op.<a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa6a129d8e40cc848b551414f64d1f0ab">ajouter</a>(p, r);
<a name="l00160"></a>00160   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot; grad(1) aretes = &quot;</span> &lt;&lt; finl;
<a name="l00161"></a>00161   r.<a class="code" href="classDoubleTab.html#ab7588e94792cc0be3a3288573c44ca18" title="ecriture des valeurs du tableau &quot;raw&quot; sans structure parallele">ecrit</a>(<a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>);
<a name="l00162"></a>00162 <span class="comment">// Pression variable sur les elements seulement</span>
<a name="l00163"></a>00163   p=0;
<a name="l00164"></a>00164   <span class="keywordflow">for</span>(i=0; i&lt;nb_elem_tot; i++)
<a name="l00165"></a>00165     p(i)=xp(i,0)-1;
<a name="l00166"></a>00166   r=0;
<a name="l00167"></a>00167   op.<a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa6a129d8e40cc848b551414f64d1f0ab">ajouter</a>(p, r);
<a name="l00168"></a>00168   <span class="keywordtype">int</span> nbf=volumes_entrelaces.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l00169"></a>00169   <span class="keywordflow">for</span>(i=0; i&lt;nbf; i++)
<a name="l00170"></a>00170     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; comp++)
<a name="l00171"></a>00171       r(i,comp)/=volumes_entrelaces(i);
<a name="l00172"></a>00172   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot; grad(x-1) elem = &quot;</span> &lt;&lt; finl;
<a name="l00173"></a>00173   r.<a class="code" href="classDoubleTab.html#ab7588e94792cc0be3a3288573c44ca18" title="ecriture des valeurs du tableau &quot;raw&quot; sans structure parallele">ecrit</a>(<a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>);
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">// Pression variable sur les sommets seulement</span>
<a name="l00176"></a>00176   p=0;
<a name="l00177"></a>00177   <span class="keywordflow">for</span>(i=nb_elem_tot; i&lt;nb_elem_tot+nb_som_tot; i++)
<a name="l00178"></a>00178     {
<a name="l00179"></a>00179       p(i)=coord_sommets(i-nb_elem_tot,0)-1;
<a name="l00180"></a>00180     }
<a name="l00181"></a>00181   r=0;
<a name="l00182"></a>00182   op.<a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa6a129d8e40cc848b551414f64d1f0ab">ajouter</a>(p, r);
<a name="l00183"></a>00183   <span class="keywordflow">for</span>(i=0; i&lt;nbf; i++)
<a name="l00184"></a>00184     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; comp++)
<a name="l00185"></a>00185       r(i,comp)/=volumes_entrelaces(i);
<a name="l00186"></a>00186   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; <span class="stringliteral">&quot; grad(x-1) som = &quot;</span> &lt;&lt; finl;
<a name="l00187"></a>00187   r.<a class="code" href="classDoubleTab.html#ab7588e94792cc0be3a3288573c44ca18" title="ecriture des valeurs du tableau &quot;raw&quot; sans structure parallele">ecrit</a>(<a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>);
<a name="l00188"></a>00188 
<a name="l00189"></a>00189   <span class="comment">/*</span>
<a name="l00190"></a>00190 <span class="comment">    const IntTab&amp; som_elem=zone.les_elems();</span>
<a name="l00191"></a>00191 <span class="comment">    int nfe=zone.nb_faces_elem();</span>
<a name="l00192"></a>00192 <span class="comment">    p=0;</span>
<a name="l00193"></a>00193 <span class="comment">    int ii=nb_elem_tot+nb_som_tot/2;</span>
<a name="l00194"></a>00194 <span class="comment">    p(ii)=1;</span>
<a name="l00195"></a>00195 <span class="comment">    r=0;</span>
<a name="l00196"></a>00196 <span class="comment">    op.ajouter(p, r);</span>
<a name="l00197"></a>00197 <span class="comment">    Debog::verifier(&quot;toto&quot;,r);</span>
<a name="l00198"></a>00198 <span class="comment">    for(i=0; i&lt;nbf; i++)</span>
<a name="l00199"></a>00199 <span class="comment">    for(int comp=0; comp&lt;Objet_U::dimension; comp++)</span>
<a name="l00200"></a>00200 <span class="comment">    r(i,comp)/=volumes_entrelaces(i);</span>
<a name="l00201"></a>00201 <span class="comment">    Cerr &lt;&lt; &quot;grad(1K) = &quot; &lt;&lt; r &lt;&lt; finl;</span>
<a name="l00202"></a>00202 <span class="comment">    for(i=0; i&lt;nb_elem_tot; i++)</span>
<a name="l00203"></a>00203 <span class="comment">    for(int indice=0; indice&lt;nfe; indice++)</span>
<a name="l00204"></a>00204 <span class="comment">    {</span>
<a name="l00205"></a>00205 <span class="comment">    int som = nb_elem_tot+dom.get_renum_som_perio(som_elem(i,indice));</span>
<a name="l00206"></a>00206 <span class="comment">    if(som==ii) p(i)+=1./12.;</span>
<a name="l00207"></a>00207 <span class="comment">    }</span>
<a name="l00208"></a>00208 <span class="comment">    r=0;</span>
<a name="l00209"></a>00209 <span class="comment">    op.ajouter(p, r);</span>
<a name="l00210"></a>00210 <span class="comment">    for(i=0; i&lt;nbf; i++)</span>
<a name="l00211"></a>00211 <span class="comment">    for(int comp=0; comp&lt;Objet_U::dimension; comp++)</span>
<a name="l00212"></a>00212 <span class="comment">    r(i,comp)/=volumes_entrelaces(i);</span>
<a name="l00213"></a>00213 <span class="comment">    Cerr &lt;&lt; &quot;grad(eta) = &quot; &lt;&lt; r &lt;&lt; finl;</span>
<a name="l00214"></a>00214 <span class="comment">    }</span>
<a name="l00215"></a>00215 <span class="comment">  */</span>
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 
<a name="l00219"></a>00219 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a59ab2b8d5e4df8a5d867d3791a049e64">Op_Grad_VEF_P1B_Face::</a>
<a name="l00220"></a><a class="code" href="classOp__Grad__VEF__P1B__Face.html#a59ab2b8d5e4df8a5d867d3791a049e64">00220</a> <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a59ab2b8d5e4df8a5d867d3791a049e64">modifier_grad_pour_Cl</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; grad )<span class="keyword"> const</span>
<a name="l00221"></a>00221 <span class="keyword"></span>{
<a name="l00222"></a>00222   <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>,
<a name="l00223"></a>00223                                              <a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>());
<a name="l00224"></a>00224   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales = zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00225"></a>00225   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF=<a class="code" href="classOp__Grad__VEF__Face.html#a634da5951c2373a26d8eb4346d18373e">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
<a name="l00226"></a>00226   <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; les_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>();
<a name="l00227"></a>00227   <span class="keywordtype">int</span> nb_bords =les_cl.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>();
<a name="l00228"></a>00228   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bords; n_bord++)
<a name="l00229"></a>00229     {
<a name="l00230"></a>00230       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00231"></a>00231       {
<a name="l00232"></a>00232         <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00233"></a>00233         <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00234"></a>00234         <span class="keywordtype">int</span> num2 = num1 + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00235"></a>00235         <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00236"></a>00236           {
<a name="l00237"></a>00237 <span class="comment">// periodicite</span>
<a name="l00238"></a>00238             <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,
<a name="l00239"></a>00239                                                      la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00240"></a>00240             <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> fait(le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>());
<a name="l00241"></a>00241             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=num1; face&lt;num2; face++)
<a name="l00242"></a>00242               {
<a name="l00243"></a>00243                 <span class="keywordflow">if</span>(!fait(face-num1))
<a name="l00244"></a>00244                   {
<a name="l00245"></a>00245                     <span class="keywordtype">int</span> <a class="code" href="AssembleurPP1BUtil_8cpp.html#a3e374d53ebc7860e1c2f0b7906f2936d">face_associee</a>=num1+la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(face-num1);
<a name="l00246"></a>00246                     fait(face-num1)=(fait(face_associee-num1)=1);
<a name="l00247"></a>00247                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00248"></a>00248                       grad(face_associee,comp) =
<a name="l00249"></a>00249                         (grad(face,comp)+= grad(face_associee,comp));
<a name="l00250"></a>00250                   }
<a name="l00251"></a>00251               }
<a name="l00252"></a>00252           }
<a name="l00253"></a>00253         <span class="keywordflow">else</span>
<a name="l00254"></a>00254           {
<a name="l00255"></a>00255             <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classSymetrie.html" title="classe Symetrie Sur les faces de symetrie on a les proprietes suivantes: - composante normale de la v...">Symetrie</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00256"></a>00256               {
<a name="l00257"></a>00257                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=num1; face&lt;num2; face++)
<a name="l00258"></a>00258                   {
<a name="l00259"></a>00259                     <span class="keywordtype">double</span> psc=0;
<a name="l00260"></a>00260                     <span class="keywordtype">double</span> norm=0;
<a name="l00261"></a>00261                     <span class="keywordtype">int</span> comp;
<a name="l00262"></a>00262                     <span class="keywordflow">for</span> (comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00263"></a>00263                       {
<a name="l00264"></a>00264                         psc += grad(face,comp)*face_normales(face,comp);
<a name="l00265"></a>00265                         norm += face_normales(face,comp)*face_normales(face,comp);
<a name="l00266"></a>00266                       }
<a name="l00267"></a>00267 <span class="comment">// psc/=norm; // Fixed bug: Arithmetic exception</span>
<a name="l00268"></a>00268                     <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(norm)&gt;=<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>) psc/=norm;
<a name="l00269"></a>00269                     <span class="keywordflow">for</span> (comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00270"></a>00270                       grad(face,comp)-=psc*face_normales(face,comp);
<a name="l00271"></a>00271                   }
<a name="l00272"></a>00272               }
<a name="l00273"></a>00273             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())||<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00274"></a>00274               {
<a name="l00275"></a>00275                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=num1; face&lt;num2; face++)
<a name="l00276"></a>00276                   {
<a name="l00277"></a>00277                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00278"></a>00278                       grad(face,comp)=0;
<a name="l00279"></a>00279                   }
<a name="l00280"></a>00280               }
<a name="l00281"></a>00281           }
<a name="l00282"></a>00282       }
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284   <span class="keywordflow">return</span> grad;
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a8dfdcce53ac9ae56cdb6b889070247b5">Op_Grad_VEF_P1B_Face::</a>
<a name="l00287"></a><a class="code" href="classOp__Grad__VEF__P1B__Face.html#a8dfdcce53ac9ae56cdb6b889070247b5">00287</a> <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a8dfdcce53ac9ae56cdb6b889070247b5">ajouter_elem</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pre,
<a name="l00288"></a>00288              <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; grad)<span class="keyword"> const</span>
<a name="l00289"></a>00289 <span class="keyword"></span>{
<a name="l00290"></a>00290   <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>,
<a name="l00291"></a>00291                                              <a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>());
<a name="l00292"></a>00292   assert(zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#aee2def53aa92584d7945e7c3d0d98963">get_alphaE</a>());
<a name="l00293"></a>00293   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00294"></a>00294   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales = zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00295"></a>00295   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_face=zone_VEF.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>();
<a name="l00296"></a>00296   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00297"></a>00297   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins=zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00298"></a>00298   <span class="keywordtype">int</span> nfe=zone.nb_faces_elem();
<a name="l00299"></a>00299   <span class="keywordtype">int</span> nb_elem_tot=zone.nb_elem_tot();
<a name="l00300"></a>00300 <span class="comment">// Si pas de support P1, on impose Neumann sur P0</span>
<a name="l00301"></a>00301   <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#ad7fbcb5567dcc2e6f0a0ed85ce90a4fa">get_alphaS</a>()==0)
<a name="l00302"></a>00302     {
<a name="l00303"></a>00303       <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Grad__VEF__Face.html#a634da5951c2373a26d8eb4346d18373e">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
<a name="l00304"></a>00304       <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; les_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>();
<a name="l00305"></a>00305       <span class="keywordtype">int</span> nb_bords =les_cl.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>();
<a name="l00306"></a>00306       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bords; n_bord++)
<a name="l00307"></a>00307         {
<a name="l00308"></a>00308           <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00309"></a>00309           <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00310"></a>00310             {
<a name="l00311"></a>00311               <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; la_sortie_libre = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00312"></a>00312               <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00313"></a>00313               <span class="keywordtype">int</span> num1 = le_bord.num_premiere_face();
<a name="l00314"></a>00314               <span class="keywordtype">int</span> num2 = num1 + le_bord.nb_faces();
<a name="l00315"></a>00315               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=num1; face&lt;num2; face++)
<a name="l00316"></a>00316                 {
<a name="l00317"></a>00317                   <span class="keywordtype">double</span> P_imp = la_sortie_libre.<a class="code" href="classNeumann.html#a4f6ee6cc54ca6471254c2a530c5b70b5" title="Renvoie la valeur du flux impose sur la i-eme composante du champ representant le flux a la frontiere...">flux_impose</a>(face-num1);
<a name="l00318"></a>00318                   <span class="keywordtype">double</span> diff = P_imp;
<a name="l00319"></a>00319                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00320"></a>00320                     grad(face,comp) += diff*face_normales(face,comp)*porosite_face(face);
<a name="l00321"></a>00321                 }
<a name="l00322"></a>00322             }
<a name="l00323"></a>00323         }
<a name="l00324"></a>00324     }
<a name="l00325"></a>00325   <span class="keywordtype">int</span> elem,indice,face,comp;
<a name="l00326"></a>00326   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> sigma(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00327"></a>00327   <span class="keywordflow">for</span>(elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00328"></a>00328     {
<a name="l00329"></a>00329       <span class="keywordflow">for</span>(indice=0; indice&lt;nfe; indice++)
<a name="l00330"></a>00330         {
<a name="l00331"></a>00331           <span class="keywordtype">double</span> pe=pre(elem);
<a name="l00332"></a>00332           face = elem_faces(elem,indice);
<a name="l00333"></a>00333           <span class="keywordtype">double</span> signe=1;
<a name="l00334"></a>00334           <span class="keywordflow">if</span>(elem!=face_voisins(face,0)) signe=-1;
<a name="l00335"></a>00335           <span class="keywordflow">for</span>(comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00336"></a>00336             grad(face, comp) -= pe*signe*face_normales(face,comp)*porosite_face(face);
<a name="l00337"></a>00337         }
<a name="l00338"></a>00338     }
<a name="l00339"></a>00339   <span class="keywordflow">return</span> grad;
<a name="l00340"></a>00340 }
<a name="l00341"></a>00341 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a3d4ef1f5fa561ccf9f4c3454e96ebe64">Op_Grad_VEF_P1B_Face::</a>
<a name="l00342"></a><a class="code" href="classOp__Grad__VEF__P1B__Face.html#a3d4ef1f5fa561ccf9f4c3454e96ebe64">00342</a> <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a3d4ef1f5fa561ccf9f4c3454e96ebe64">ajouter_som</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pre,
<a name="l00343"></a>00343             <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; grad)<span class="keyword"> const</span>
<a name="l00344"></a>00344 <span class="keyword"></span>{
<a name="l00345"></a>00345   <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>,
<a name="l00346"></a>00346                                              <a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>());
<a name="l00347"></a>00347   assert(zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#ad7fbcb5567dcc2e6f0a0ed85ce90a4fa">get_alphaS</a>());
<a name="l00348"></a>00348   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00349"></a>00349   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone.domaine();
<a name="l00350"></a>00350   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales = zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00351"></a>00351   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_face=zone_VEF.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>();
<a name="l00352"></a>00352   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; som_elem=zone.les_elems();
<a name="l00353"></a>00353   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00354"></a>00354   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins=zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00355"></a>00355   <span class="keywordtype">int</span> nfe=zone.nb_faces_elem();
<a name="l00356"></a>00356   <span class="keywordtype">int</span> nps=zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#ab469e7b0d67ddcc27e5cf16c3c85e8f4">numero_premier_sommet</a>();
<a name="l00357"></a>00357   <span class="keywordtype">int</span> nb_elem_tot=zone.nb_elem_tot();
<a name="l00358"></a>00358   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Grad__VEF__Face.html#a634da5951c2373a26d8eb4346d18373e">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
<a name="l00359"></a>00359 
<a name="l00360"></a>00360   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> sigma(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00361"></a>00361   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00362"></a>00362     {
<a name="l00363"></a>00363       <span class="keywordtype">double</span> coeff_som=<a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa1b669139e643d29cff74806e14d3e3e">calculer_coef_som</a>(elem, zone_Cl_VEF, zone_VEF);
<a name="l00364"></a>00364       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> indice=0; indice&lt;nfe; indice++)
<a name="l00365"></a>00365         {
<a name="l00366"></a>00366           <span class="keywordtype">int</span> som = nps+dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som_elem(elem,indice));
<a name="l00367"></a>00367           <span class="keywordtype">double</span> ps=pre(som);
<a name="l00368"></a>00368           <span class="keywordtype">int</span> face = elem_faces(elem,indice);
<a name="l00369"></a>00369           <span class="keywordtype">double</span> signe=1;
<a name="l00370"></a>00370           <span class="keywordflow">if</span>(elem!=face_voisins(face,0))
<a name="l00371"></a>00371             signe=-1;
<a name="l00372"></a>00372           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00373"></a>00373             sigma[comp]=signe*face_normales(face,comp);
<a name="l00374"></a>00374 
<a name="l00375"></a>00375           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> indice2=0; indice2&lt;nfe; indice2++)
<a name="l00376"></a>00376             {
<a name="l00377"></a>00377               <span class="keywordtype">int</span> face2 = elem_faces(elem,indice2);
<a name="l00378"></a>00378               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00379"></a>00379                 grad(face2,comp)-=coeff_som*ps*sigma[comp]*porosite_face(face2);
<a name="l00380"></a>00380             }
<a name="l00381"></a>00381         }
<a name="l00382"></a>00382     }
<a name="l00383"></a>00383 
<a name="l00384"></a>00384   <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; les_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>();
<a name="l00385"></a>00385   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets = zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l00386"></a>00386   <span class="keywordtype">int</span> nb_bords = les_cl.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>();
<a name="l00387"></a>00387   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bords; n_bord++)
<a name="l00388"></a>00388     {
<a name="l00389"></a>00389       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00390"></a>00390       <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00391"></a>00391         {
<a name="l00392"></a>00392           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00393"></a>00393           <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; <a class="code" href="Iterateur__PolyMAC__base_8h.html#adda1d69a86f9e3be7366c5f4c6ace649ac4317ef27513bbab3cd0ccfd0d9ed199" title="Neumann_sortie_libre ou derivees.">sortie_libre</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00394"></a>00394           <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00395"></a>00395           <span class="keywordtype">int</span> num2 = num1 + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00396"></a>00396           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=num1; face&lt;num2; face++)
<a name="l00397"></a>00397             {
<a name="l00398"></a>00398               <span class="keyword">const</span> <span class="keywordtype">double</span> P_imp = sortie_libre.flux_impose(face-num1);
<a name="l00399"></a>00399               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> indice=0; indice&lt;(nfe-1); indice++)
<a name="l00400"></a>00400                 {
<a name="l00401"></a>00401                   <span class="keywordtype">int</span> som=nps+dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(face_sommets(face,indice));
<a name="l00402"></a>00402                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00403"></a>00403                     grad(face,comp)-=
<a name="l00404"></a>00404                       1./dimension*face_normales(face,comp)*(pre(som)-P_imp)
<a name="l00405"></a>00405                       *porosite_face(face);
<a name="l00406"></a>00406                 }
<a name="l00407"></a>00407             } <span class="comment">//fin du if sur &quot;Neumann_sortie_libre&quot;</span>
<a name="l00408"></a>00408         }
<a name="l00409"></a>00409     }
<a name="l00410"></a>00410   <span class="keywordflow">return</span> grad;
<a name="l00411"></a>00411 }
<a name="l00412"></a>00412 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa5c7f21146881f6222f20cf7eed06f9f">Op_Grad_VEF_P1B_Face::</a>
<a name="l00413"></a><a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa5c7f21146881f6222f20cf7eed06f9f">00413</a> <a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa5c7f21146881f6222f20cf7eed06f9f">ajouter_aretes</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pre,
<a name="l00414"></a>00414                <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; grad)<span class="keyword"> const</span>
<a name="l00415"></a>00415 <span class="keyword"></span>{
<a name="l00416"></a>00416   <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_VEF =
<a name="l00417"></a>00417     <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>, <a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>());
<a name="l00418"></a>00418   assert(zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a9d02e2431efb6e75c3d733ff06f89549">get_alphaA</a>());
<a name="l00419"></a>00419   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00420"></a>00420 <span class="comment">// const Domaine&amp; dom=zone.domaine();</span>
<a name="l00421"></a>00421   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales = zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00422"></a>00422   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_face=zone_VEF.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>();
<a name="l00423"></a>00423   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; som_elem=zone.les_elems();
<a name="l00424"></a>00424   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00425"></a>00425   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins=zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00426"></a>00426   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; aretes_som=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#affa60690e1b372fa4c01d6088267dbe4" title="renvoie le tableau de connectivite aretes/sommets.">aretes_som</a>();
<a name="l00427"></a>00427   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_aretes=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a1e1e86ef5b088c4d33d42cd38a967b4a" title="renvoie le numero de la jeme arete du ieme element.">elem_aretes</a>();
<a name="l00428"></a>00428   <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; renum_arete_perio=zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a43767f8684512d1ee950dc07eea76c5b">get_renum_arete_perio</a>();
<a name="l00429"></a>00429   <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; ok_arete=zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a83771f784d487e346b2ef22a389472a2">get_ok_arete</a>();
<a name="l00430"></a>00430   <span class="keywordtype">int</span> nfe=zone.nb_faces_elem();
<a name="l00431"></a>00431   <span class="keywordtype">int</span> nb_elem_tot=zone.nb_elem_tot();
<a name="l00432"></a>00432 <span class="comment">// int nps=zone_VEF.numero_premier_sommet();</span>
<a name="l00433"></a>00433   <span class="keywordtype">int</span> npa=zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#aa0033e533851a80e958050a0b892e9a8">numero_premiere_arete</a>();
<a name="l00434"></a>00434   <span class="keywordtype">int</span> indice;
<a name="l00435"></a>00435   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> sigma(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00436"></a>00436   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
<a name="l00437"></a>00437     {
<a name="l00438"></a>00438       <span class="keywordflow">for</span>(indice=0; indice&lt;nfe; indice++)
<a name="l00439"></a>00439         {
<a name="l00440"></a>00440 <span class="comment">// som = nps+dom.get_renum_som_perio(som_elem(elem,indice));</span>
<a name="l00441"></a>00441           <span class="keywordtype">int</span> face = elem_faces(elem,indice);
<a name="l00442"></a>00442           <span class="keywordtype">double</span> signe=1;
<a name="l00443"></a>00443           <span class="keywordflow">if</span>(elem!=face_voisins(face,0))
<a name="l00444"></a>00444             signe=-1;
<a name="l00445"></a>00445           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00446"></a>00446             sigma[comp]=signe*face_normales(face,comp);
<a name="l00447"></a>00447         }
<a name="l00448"></a>00448       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> isom=0; isom&lt;3; isom++)
<a name="l00449"></a>00449         {
<a name="l00450"></a>00450           <span class="keywordtype">int</span> somi = som_elem(elem,isom);
<a name="l00451"></a>00451           <span class="keywordtype">int</span> facei = elem_faces(elem,isom);
<a name="l00452"></a>00452           <span class="keywordtype">double</span> signei=1.;
<a name="l00453"></a>00453           <span class="keywordflow">if</span> (face_voisins(facei,0) != elem)
<a name="l00454"></a>00454             signei=-1.;
<a name="l00455"></a>00455           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jsom=isom+1; jsom&lt;4; jsom++)
<a name="l00456"></a>00456             {
<a name="l00457"></a>00457               <span class="keywordtype">int</span> somj = som_elem(elem,jsom);
<a name="l00458"></a>00458               <span class="keywordtype">int</span> facej = elem_faces(elem,jsom);
<a name="l00459"></a>00459               <span class="keywordtype">double</span> signej=1.;
<a name="l00460"></a>00460               <span class="keywordflow">if</span> (face_voisins(facej,0) != elem)
<a name="l00461"></a>00461                 signej=-1.;
<a name="l00462"></a>00462               <span class="keywordtype">int</span> arete = <a class="code" href="Op__Grad__VEF__P1B__Face_8cpp.html#a43ddbecfeb5d72a0ccf918858acb528c">chercher_arete</a>(elem, somi, somj,
<a name="l00463"></a>00463                                          elem_aretes, aretes_som);
<a name="l00464"></a>00464               arete=renum_arete_perio(arete);
<a name="l00465"></a>00465               <span class="keywordflow">if</span>(ok_arete(arete))
<a name="l00466"></a>00466                 {
<a name="l00467"></a>00467                   <span class="keywordtype">double</span> pa=pre(npa+arete);
<a name="l00468"></a>00468                   <span class="keywordtype">int</span> niinij=0;
<a name="l00469"></a>00469                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ksom=0; ksom&lt;4; ksom++)
<a name="l00470"></a>00470                     {
<a name="l00471"></a>00471                       <span class="keywordtype">int</span> face2=elem_faces(elem,ksom);
<a name="l00472"></a>00472                       <span class="keywordflow">if</span>((ksom==isom)||(ksom==jsom))
<a name="l00473"></a>00473                         {
<a name="l00474"></a>00474                           <span class="keywordflow">if</span>(niinij==ksom)
<a name="l00475"></a>00475                             niinij++;
<a name="l00476"></a>00476                           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;3; comp++)
<a name="l00477"></a>00477                             grad(face2,comp)+=porosite_face(face2)*1./15.*
<a name="l00478"></a>00478                                               (signei*face_normales(facei,comp)+
<a name="l00479"></a>00479                                                signej*face_normales(facej,comp))*pa;
<a name="l00480"></a>00480                         }
<a name="l00481"></a>00481                       <span class="keywordflow">else</span>
<a name="l00482"></a>00482                         {
<a name="l00483"></a>00483                           <span class="keywordflow">if</span>(niinij==ksom)
<a name="l00484"></a>00484                             niinij++;
<a name="l00485"></a>00485                           <span class="keywordflow">while</span>((niinij==jsom)||(niinij==isom))
<a name="l00486"></a>00486                             niinij++;
<a name="l00487"></a>00487                           assert(niinij&lt;4);
<a name="l00488"></a>00488                           <span class="keywordtype">int</span> facek = elem_faces(elem,niinij);
<a name="l00489"></a>00489                           <span class="keywordtype">double</span> signek=1.;
<a name="l00490"></a>00490                           <span class="keywordflow">if</span> (face_voisins(facek,0) != elem)
<a name="l00491"></a>00491                             signek=-1.;
<a name="l00492"></a>00492                           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;3; comp++)
<a name="l00493"></a>00493                             grad(face2,comp)+=porosite_face(face2)*2./15.*
<a name="l00494"></a>00494                                               signek*face_normales(facek,comp)*pa;
<a name="l00495"></a>00495                           niinij=ksom;
<a name="l00496"></a>00496                         }
<a name="l00497"></a>00497                     }
<a name="l00498"></a>00498                 }
<a name="l00499"></a>00499             }
<a name="l00500"></a>00500         }
<a name="l00501"></a>00501     }
<a name="l00502"></a>00502   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Grad__VEF__Face.html#a634da5951c2373a26d8eb4346d18373e">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
<a name="l00503"></a>00503   <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; les_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>();
<a name="l00504"></a>00504   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets = zone_VEF.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l00505"></a>00505   <span class="keywordtype">int</span> nb_bords =les_cl.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>();
<a name="l00506"></a>00506   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bords; n_bord++)
<a name="l00507"></a>00507     {
<a name="l00508"></a>00508       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00509"></a>00509       {
<a name="l00510"></a>00510         <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00511"></a>00511         <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00512"></a>00512         <span class="keywordtype">int</span> num2 = num1 + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00513"></a>00513         <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00514"></a>00514           {
<a name="l00515"></a>00515             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=num1; face&lt;num2; face++)
<a name="l00516"></a>00516               {
<a name="l00517"></a>00517                 <span class="keywordtype">int</span> elem=face_voisins(face,0);
<a name="l00518"></a>00518                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;2; i++)
<a name="l00519"></a>00519                   {
<a name="l00520"></a>00520                     <span class="keywordtype">int</span> somi=face_sommets(face,i);
<a name="l00521"></a>00521                     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=i+1; j&lt;3; j++)
<a name="l00522"></a>00522                       {
<a name="l00523"></a>00523                         <span class="keywordtype">int</span> somj=face_sommets(face,j);
<a name="l00524"></a>00524                         <span class="keywordtype">int</span> arete=<a class="code" href="Op__Grad__VEF__P1B__Face_8cpp.html#a43ddbecfeb5d72a0ccf918858acb528c">chercher_arete</a>(elem, somi, somj,
<a name="l00525"></a>00525                                                  elem_aretes, aretes_som);
<a name="l00526"></a>00526                         arete=renum_arete_perio(arete);
<a name="l00527"></a>00527                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
<a name="l00528"></a>00528                           grad(face,comp)-= porosite_face(face)*0*
<a name="l00529"></a>00529                                             face_normales(face,comp)*pre(npa+arete);
<a name="l00530"></a>00530                       }
<a name="l00531"></a>00531                   }
<a name="l00532"></a>00532               }
<a name="l00533"></a>00533           }
<a name="l00534"></a>00534       }
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536   <span class="keywordflow">return</span> grad;
<a name="l00537"></a>00537 }
<a name="l00538"></a>00538 
<a name="l00539"></a><a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa1b669139e643d29cff74806e14d3e3e">00539</a> <span class="keywordtype">double</span> <a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa1b669139e643d29cff74806e14d3e3e">Op_Grad_VEF_P1B_Face::calculer_coef_som</a>(<span class="keywordtype">int</span> elem,  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zcl,
<a name="l00540"></a>00540                                                <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_VEF)
<a name="l00541"></a>00541 {
<a name="l00542"></a>00542   <span class="keywordtype">double</span> coef_std=1./(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>*(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>+1));
<a name="l00543"></a>00543   <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#aa2b3f7b3fcebdd13aa386170a840780b">get_modif_div_face_dirichlet</a>()==0)
<a name="l00544"></a>00544     <span class="keywordflow">return</span> coef_std;
<a name="l00545"></a>00545   <span class="keywordtype">int</span> <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>=0;
<a name="l00546"></a>00546   <span class="keywordtype">int</span> rang_elem=zone_VEF.<a class="code" href="classZone__VEF.html#a4b2171a85e5fc33663a3366acb713584">rang_elem_non_std</a>()(elem);
<a name="l00547"></a>00547   <span class="keywordflow">if</span> (rang_elem!=-1)
<a name="l00548"></a>00548     type_elem=zcl.<a class="code" href="classZone__Cl__VEF.html#a483bdab7690f844ed04e3defe04ec70a">type_elem_Cl</a>(rang_elem);
<a name="l00549"></a>00549   <span class="keywordtype">double</span> coef;
<a name="l00550"></a>00550   <span class="keywordflow">if</span> (type_elem==0)
<a name="l00551"></a>00551     <span class="keywordflow">return</span> coef_std;
<a name="l00552"></a>00552   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
<a name="l00553"></a>00553     {
<a name="l00554"></a>00554       <span class="keywordflow">switch</span>(type_elem)
<a name="l00555"></a>00555         {
<a name="l00556"></a>00556         <span class="keywordflow">case</span> 0:
<a name="l00557"></a>00557           coef=3;
<a name="l00558"></a>00558           <span class="keywordflow">break</span>;
<a name="l00559"></a>00559         <span class="keywordflow">case</span> 1:
<a name="l00560"></a>00560         <span class="keywordflow">case</span> 2:
<a name="l00561"></a>00561         <span class="keywordflow">case</span> 4:
<a name="l00562"></a>00562           coef=2;
<a name="l00563"></a>00563           <span class="keywordflow">break</span>;
<a name="l00564"></a>00564         <span class="keywordflow">case</span> 3:
<a name="l00565"></a>00565         <span class="keywordflow">case</span> 5:
<a name="l00566"></a>00566         <span class="keywordflow">case</span> 6:
<a name="l00567"></a>00567           coef=1;
<a name="l00568"></a>00568           <span class="keywordflow">break</span>;
<a name="l00569"></a>00569         <span class="keywordflow">default</span>:
<a name="l00570"></a>00570           coef=-1;
<a name="l00571"></a>00571           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00572"></a>00572           <span class="keywordflow">break</span>;
<a name="l00573"></a>00573         }
<a name="l00574"></a>00574     }
<a name="l00575"></a>00575   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3)
<a name="l00576"></a>00576     {
<a name="l00577"></a>00577       <span class="keywordflow">switch</span>(type_elem)
<a name="l00578"></a>00578         {
<a name="l00579"></a>00579         <span class="keywordflow">case</span> 0:
<a name="l00580"></a>00580           coef=4;
<a name="l00581"></a>00581           <span class="keywordflow">break</span>;
<a name="l00582"></a>00582         <span class="keywordflow">case</span> 1:
<a name="l00583"></a>00583         <span class="keywordflow">case</span> 2:
<a name="l00584"></a>00584         <span class="keywordflow">case</span> 4:
<a name="l00585"></a>00585         <span class="keywordflow">case</span> 8:
<a name="l00586"></a>00586           coef=3;
<a name="l00587"></a>00587           <span class="keywordflow">break</span>;
<a name="l00588"></a>00588         <span class="keywordflow">case</span> 3:
<a name="l00589"></a>00589         <span class="keywordflow">case</span> 5:
<a name="l00590"></a>00590         <span class="keywordflow">case</span> 6:
<a name="l00591"></a>00591         <span class="keywordflow">case</span> 9:
<a name="l00592"></a>00592         <span class="keywordflow">case</span> 10:
<a name="l00593"></a>00593         <span class="keywordflow">case</span> 12:
<a name="l00594"></a>00594           coef=2;
<a name="l00595"></a>00595           <span class="keywordflow">break</span>;
<a name="l00596"></a>00596         <span class="keywordflow">case</span> 7:
<a name="l00597"></a>00597         <span class="keywordflow">case</span> 11:
<a name="l00598"></a>00598         <span class="keywordflow">case</span> 13:
<a name="l00599"></a>00599         <span class="keywordflow">case</span> 14:
<a name="l00600"></a>00600           coef=1;
<a name="l00601"></a>00601           <span class="keywordflow">break</span>;
<a name="l00602"></a>00602         <span class="keywordflow">default</span>:
<a name="l00603"></a>00603           coef=-1;
<a name="l00604"></a>00604           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00605"></a>00605           <span class="keywordflow">break</span>;
<a name="l00606"></a>00606         }
<a name="l00607"></a>00607     }
<a name="l00608"></a>00608   <span class="keywordflow">else</span>
<a name="l00609"></a>00609     {
<a name="l00610"></a>00610       coef=-1;
<a name="l00611"></a>00611       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00612"></a>00612     }
<a name="l00613"></a>00613   <span class="keywordflow">return</span> 1./(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>*coef);
<a name="l00614"></a>00614 }
<a name="l00615"></a>00615 
<a name="l00616"></a><a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa6a129d8e40cc848b551414f64d1f0ab">00616</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa6a129d8e40cc848b551414f64d1f0ab">Op_Grad_VEF_P1B_Face::ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; pre,
<a name="l00617"></a>00617                                          <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; grad)<span class="keyword"> const</span>
<a name="l00618"></a>00618 <span class="keyword"></span>{
<a name="l00619"></a>00619 <span class="comment">// pre doit avoir son espace virtuel a jour</span>
<a name="l00620"></a>00620   <a class="code" href="Check__espace__virtuel_8cpp.html#a2ea8fcf12c28d0454bdc4126f8c4b186" title="en mode comm_check_enabled(), verifie si l&#39;espace virtuel du vecteur est a jour, si ce n&#39;est pas le c...">assert_espace_virtuel_vect</a>(pre);
<a name="l00621"></a>00621 <span class="comment">// on va faire += sur l&#39;espace virtuel, mais sans utiliser les valeurs</span>
<a name="l00622"></a>00622   <a class="code" href="Check__espace__virtuel_8cpp.html#adee035ac60c0a14f58d5473969b5a976" title="Appelle remplir_items_non_calcules() si on est en mode comm_check_enabled() ou en mode debug (NDEBUG ...">assert_invalide_items_non_calcules</a>(grad);
<a name="l00623"></a>00623 <span class="comment">// Debog::verifier(&quot;Op_Grad_VEF_P1B_Face::ajouter pre&quot;, pre);</span>
<a name="l00624"></a>00624   <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_VEF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>,
<a name="l00625"></a>00625                                              <a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>());
<a name="l00626"></a>00626   <span class="keyword">static</span> <span class="keywordtype">int</span> init=1;
<a name="l00627"></a>00627   <span class="keywordflow">if</span>(!init)
<a name="l00628"></a>00628     <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">verifier</a>(*<span class="keyword">this</span>, init, zone_VEF, pre, grad);
<a name="l00629"></a>00629   <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#aee2def53aa92584d7945e7c3d0d98963">get_alphaE</a>()) <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a8dfdcce53ac9ae56cdb6b889070247b5">ajouter_elem</a>(pre, grad);
<a name="l00630"></a>00630   <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#ad7fbcb5567dcc2e6f0a0ed85ce90a4fa">get_alphaS</a>()) <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a3d4ef1f5fa561ccf9f4c3454e96ebe64">ajouter_som</a>(pre, grad);
<a name="l00631"></a>00631   <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a9d02e2431efb6e75c3d733ff06f89549">get_alphaA</a>()) <a class="code" href="classOp__Grad__VEF__P1B__Face.html#aa5c7f21146881f6222f20cf7eed06f9f">ajouter_aretes</a>(pre, grad);
<a name="l00632"></a>00632   <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a59ab2b8d5e4df8a5d867d3791a049e64">modifier_grad_pour_Cl</a>(grad);
<a name="l00633"></a>00633 <span class="comment">// Optimisation car pas necessaire:</span>
<a name="l00634"></a>00634 <span class="comment">// grad.echange_espace_virtuel();</span>
<a name="l00635"></a>00635 <span class="comment">// Debog::verifier(&quot;Op_Grad_VEF_P1B_Face::ajouter grad en sortie:&quot;, grad);</span>
<a name="l00636"></a>00636   <span class="keywordflow">return</span> grad;
<a name="l00637"></a>00637 }
<a name="l00638"></a>00638 
<a name="l00639"></a>00639 
<a name="l00640"></a><a class="code" href="classOp__Grad__VEF__P1B__Face.html#a20c9b78398f10de21800ded58d2f5614">00640</a> <span class="keywordtype">int</span> <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a20c9b78398f10de21800ded58d2f5614" title="NE FAIT RIEN A surcharger dans les classes derivees. Imprime l&#39;operateur sur un flot de sortie...">Op_Grad_VEF_P1B_Face::impr</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00641"></a>00641 <span class="keyword"></span>{
<a name="l00642"></a>00642   <span class="keyword">const</span> <span class="keywordtype">int</span> impr_mom=<a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>-&gt;zone().Moments_a_imprimer();
<a name="l00643"></a>00643   <span class="keyword">const</span> <span class="keywordtype">int</span> impr_sum=(<a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>-&gt;zone().Bords_a_imprimer_sum().est_vide() ? 0:1);
<a name="l00644"></a>00644   <span class="keyword">const</span> <span class="keywordtype">int</span> impr_bord=(<a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>-&gt;zone().Bords_a_imprimer().est_vide() ? 0:1);
<a name="l00645"></a>00645   <span class="keyword">const</span> <a class="code" href="classSchema__Temps__base.html" title="classe Schema_Temps_base">Schema_Temps_base</a>&amp; sch = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>();
<a name="l00646"></a>00646   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Grad__VEF__Face.html#a634da5951c2373a26d8eb4346d18373e">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
<a name="l00647"></a>00647   <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; zone_VEF = <a class="code" href="classOp__Grad__VEF__P1B__Face.html#a119193ee318666864303ef213caeae4c">zone_Vef</a>();
<a name="l00648"></a>00648   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00649"></a>00649   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales = zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00650"></a>00650   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; som_elem=<a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>-&gt;zone().les_elems();
<a name="l00651"></a>00651   <span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn = <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>();
<a name="l00652"></a>00652   <span class="keyword">const</span> <a class="code" href="classNavier__Stokes__std.html" title="classe Navier_Stokes_std Cette classe porte les termes de l&#39;equation de la dynamique pour un fluide s...">Navier_Stokes_std</a>&amp; eqn_hydr = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classNavier__Stokes__std.html" title="classe Navier_Stokes_std Cette classe porte les termes de l&#39;equation de la dynamique pour un fluide s...">Navier_Stokes_std</a>,eqn);
<a name="l00653"></a>00653   <span class="keyword">const</span> <a class="code" href="classChamp__P1__isoP1Bulle.html">Champ_P1_isoP1Bulle</a>&amp; la_pression_P1B = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classChamp__P1__isoP1Bulle.html">Champ_P1_isoP1Bulle</a>,eqn_hydr.<a class="code" href="classNavier__Stokes__std.html#a2233a18979d8e301c9d376d8639877ee">pression_pa</a>().<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>());
<a name="l00654"></a>00654 <span class="comment">// Si on filtre:</span>
<a name="l00655"></a>00655   la_pression_P1B.<a class="code" href="classChamp__P1iP1B__implementation.html#a0a7bce96d7fb122bf0da44aa824c0ee5" title="Methode pour filtrer le champ.">filtrage</a>(zone_VEF,la_pression_P1B);
<a name="l00656"></a>00656   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; pression_P1B = la_pression_P1B.<a class="code" href="classChamp__P1iP1B__implementation.html#a3e94735ad686abcc95e0c0833f5ace23">champ_filtre</a>();
<a name="l00657"></a>00657   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;la pression filtree dans Op_Grad_VEF_P1B_Face::impr=&quot;</span>,pression_P1B);
<a name="l00658"></a>00658   <span class="keywordtype">double</span> pres_som, pres_arete, pres_tot ;
<a name="l00659"></a>00659   <span class="keywordtype">double</span> n0, n1, n2 ;
<a name="l00660"></a>00660   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces =  zone_VEF.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
<a name="l00661"></a>00661   <span class="keywordtype">int</span> nse=zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00662"></a>00662   <span class="keywordtype">int</span> nps=zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#ab469e7b0d67ddcc27e5cf16c3c85e8f4">numero_premier_sommet</a>();
<a name="l00663"></a>00663   <span class="keywordtype">int</span> npa=zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#aa0033e533851a80e958050a0b892e9a8">numero_premiere_arete</a>();
<a name="l00664"></a>00664   <span class="keywordtype">int</span> elem ;
<a name="l00665"></a>00665   <span class="keywordtype">int</span> face;
<a name="l00666"></a>00666   <span class="keywordtype">int</span> som_opp, som, som_glob;
<a name="l00667"></a>00667   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> xgr(nb_faces,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00668"></a>00668   xgr=0.;
<a name="l00669"></a>00669 <span class="comment">// DoubleVect moment(dimension);</span>
<a name="l00670"></a>00670   <span class="keywordflow">if</span> (impr_mom)
<a name="l00671"></a>00671     {
<a name="l00672"></a>00672       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xgrav = zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00673"></a>00673       <span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; c_grav=<a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>-&gt;zone().cg_moments();
<a name="l00674"></a>00674       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=0; num_face &lt;nb_faces; num_face++)
<a name="l00675"></a>00675         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)
<a name="l00676"></a>00676           xgr(num_face,i)=xgrav(num_face,i)-c_grav(i);
<a name="l00677"></a>00677     }
<a name="l00678"></a>00678   <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(zone_VEF.<a class="code" href="classZone__VF.html#a8815e2276637c0db23868f043dc43e58" title="renvoie le nombre de faces sur lesquelles sont appliquees les conditions limites : bords...">nb_faces_bord</a>(),<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00679"></a>00679   <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a> = 0.;
<a name="l00680"></a>00680 
<a name="l00681"></a>00681   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> tab_flux_bords(3,zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(),<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00682"></a>00682   tab_flux_bords=0.;
<a name="l00683"></a>00683   <span class="comment">/*</span>
<a name="l00684"></a>00684 <span class="comment">    fluxx_s       -&gt;   flux_bords2(0,num_cl,0)</span>
<a name="l00685"></a>00685 <span class="comment">    fluxy_s       -&gt;   flux_bords2(0,num_cl,1)</span>
<a name="l00686"></a>00686 <span class="comment">    fluxz_s       -&gt;   flux_bords2(0,num_cl,2)</span>
<a name="l00687"></a>00687 <span class="comment">    fluxx_sum_s   -&gt;   flux_bords2(1,num_cl,0)</span>
<a name="l00688"></a>00688 <span class="comment">    fluxy_sum_s   -&gt;   flux_bords2(1,num_cl,1)</span>
<a name="l00689"></a>00689 <span class="comment">    fluxz_sum_s   -&gt;   flux_bords2(1,num_cl,2)</span>
<a name="l00690"></a>00690 <span class="comment">    moment(0)     -&gt;   flux_bords2(2,num_cl,0)</span>
<a name="l00691"></a>00691 <span class="comment">    moment(1)     -&gt;   flux_bords2(2,num_cl,1)</span>
<a name="l00692"></a>00692 <span class="comment">    moment(2)     -&gt;   flux_bords2(2,num_cl,2)</span>
<a name="l00693"></a>00693 <span class="comment">  */</span>
<a name="l00694"></a>00694   <span class="keywordtype">double</span> coeff_P1 = 1./<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00695"></a>00695   <span class="keywordtype">double</span> coeff_Pa = 1./<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00696"></a>00696   <span class="keywordtype">int</span> nb_bord = zone_VEF.<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>();
<a name="l00697"></a>00697   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
<a name="l00698"></a>00698     {
<a name="l00699"></a>00699       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00700"></a>00700       <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00701"></a>00701       <span class="keywordtype">int</span> impr_boundary = (zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aa5780fa644b13f8172c4805336846dec">Bords_a_imprimer_sum</a>().<a class="code" href="classList__Nom.html#aafe66fe06c0dd82cb2641fcaf774db07">contient</a>(le_bord.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>()) ? 1 : 0);
<a name="l00702"></a>00702       <span class="keywordtype">int</span> ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00703"></a>00703       <span class="keywordtype">int</span> nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00704"></a>00704       <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l00705"></a>00705         {
<a name="l00706"></a>00706           <span class="keywordtype">int</span> voisin = 0;
<a name="l00707"></a>00707           elem = face_voisins(face,voisin);
<a name="l00708"></a>00708           <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__VF.html#a95113b10f16f37600ba81d3fb41102b2">get_num_fac_loc</a>(face, voisin)==-1)
<a name="l00709"></a>00709             {
<a name="l00710"></a>00710               voisin = 1;
<a name="l00711"></a>00711               elem = face_voisins(face,voisin);
<a name="l00712"></a>00712             }
<a name="l00713"></a>00713           <span class="keywordtype">int</span> signe=zone_VEF.<a class="code" href="classZone__VEF.html#a5c3e9d7f89d87989e338f5d725853e48">oriente_normale</a>(face,elem);
<a name="l00714"></a>00714           som_opp = <a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>-&gt;get_num_fac_loc(face, voisin);
<a name="l00715"></a>00715           som_opp = som_elem(elem, som_opp);
<a name="l00716"></a>00716           pres_tot = 0. ;
<a name="l00717"></a>00717 
<a name="l00718"></a>00718 <span class="comment">// Contribution de la pression P0</span>
<a name="l00719"></a>00719           <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#aee2def53aa92584d7945e7c3d0d98963">get_alphaE</a>())
<a name="l00720"></a>00720             pres_tot += pression_P1B(elem);
<a name="l00721"></a>00721 
<a name="l00722"></a>00722 <span class="comment">// Contribution de la pression P1</span>
<a name="l00723"></a>00723           <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#ad7fbcb5567dcc2e6f0a0ed85ce90a4fa">get_alphaS</a>())
<a name="l00724"></a>00724             {
<a name="l00725"></a>00725               pres_som = 0.;
<a name="l00726"></a>00726               <span class="keywordflow">for</span>(som=0; som&lt;nse; som++)
<a name="l00727"></a>00727                 {
<a name="l00728"></a>00728                   som_glob = som_elem(elem, som);
<a name="l00729"></a>00729                   <span class="keywordflow">if</span> (som_glob != som_opp)
<a name="l00730"></a>00730                     pres_som += pression_P1B(nps+som_glob);
<a name="l00731"></a>00731                 }
<a name="l00732"></a>00732               pres_tot += coeff_P1 * pres_som;
<a name="l00733"></a>00733             }
<a name="l00734"></a>00734 
<a name="l00735"></a>00735 <span class="comment">// Contribution de la pression Pa</span>
<a name="l00736"></a>00736 <span class="comment">// GF descativation car bilan incorret</span>
<a name="l00737"></a>00737           <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__VEF__PreP1b.html#a9d02e2431efb6e75c3d733ff06f89549">get_alphaA</a>()*0!=0)
<a name="l00738"></a>00738             {
<a name="l00739"></a>00739               pres_arete = 0.;
<a name="l00740"></a>00740               <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_aretes=<a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>-&gt;zone().elem_aretes();
<a name="l00741"></a>00741               <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; aretes_som=<a class="code" href="classOp__Grad__VEF__Face.html#a52168af6bdaa105bf5af4a619ba6f749">la_zone_vef</a>-&gt;zone().aretes_som();
<a name="l00742"></a>00742               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> arete=0; arete&lt;6; arete++)
<a name="l00743"></a>00743                 {
<a name="l00744"></a>00744                   <span class="keywordtype">int</span> arete_glob = elem_aretes(elem, arete);
<a name="l00745"></a>00745                   <span class="keywordflow">if</span> (aretes_som(arete_glob,0)!=som_opp &amp;&amp; aretes_som(arete_glob,1)!=som_opp)
<a name="l00746"></a>00746                     pres_arete += pression_P1B(npa+arete_glob);
<a name="l00747"></a>00747                 }
<a name="l00748"></a>00748               pres_tot += coeff_Pa * pres_arete;
<a name="l00749"></a>00749             }
<a name="l00750"></a>00750 
<a name="l00751"></a>00751 <span class="comment">// Calcul de la resultante et du couple de pression</span>
<a name="l00752"></a>00752           <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2)
<a name="l00753"></a>00753             {
<a name="l00754"></a>00754               n0 = signe*face_normales(face,0) ;
<a name="l00755"></a>00755               n1 = signe*face_normales(face,1) ;
<a name="l00756"></a>00756 
<a name="l00757"></a>00757               <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) = pres_tot*n0  ;
<a name="l00758"></a>00758               <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) = pres_tot*n1  ;
<a name="l00759"></a>00759 
<a name="l00760"></a>00760               tab_flux_bords(0,n_bord,0) += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) ;
<a name="l00761"></a>00761               tab_flux_bords(0,n_bord,1) += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) ;
<a name="l00762"></a>00762 
<a name="l00763"></a>00763 <span class="comment">// Calcul du moment exerce par le fluide sur le bord (OM/\F)</span>
<a name="l00764"></a>00764               <span class="keywordflow">if</span> (impr_mom)
<a name="l00765"></a>00765                 tab_flux_bords(2,n_bord,0)+=<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1)*xgr(face,0)-<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0)*xgr(face,1);
<a name="l00766"></a>00766               <span class="keywordflow">if</span> (impr_boundary)
<a name="l00767"></a>00767                 {
<a name="l00768"></a>00768                   tab_flux_bords(1,n_bord,0) += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) ;
<a name="l00769"></a>00769                   tab_flux_bords(1,n_bord,1) += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) ;
<a name="l00770"></a>00770                 }
<a name="l00771"></a>00771             }
<a name="l00772"></a>00772           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00773"></a>00773             {
<a name="l00774"></a>00774               n0   = signe*face_normales(face,0) ;
<a name="l00775"></a>00775               n1   = signe*face_normales(face,1) ;
<a name="l00776"></a>00776               n2   = signe*face_normales(face,2) ;
<a name="l00777"></a>00777 
<a name="l00778"></a>00778               <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) = pres_tot*n0 ;
<a name="l00779"></a>00779               <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) = pres_tot*n1 ;
<a name="l00780"></a>00780               <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,2) = pres_tot*n2 ;
<a name="l00781"></a>00781 
<a name="l00782"></a>00782               tab_flux_bords(0,n_bord,0) += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) ;
<a name="l00783"></a>00783               tab_flux_bords(0,n_bord,1) += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) ;
<a name="l00784"></a>00784               tab_flux_bords(0,n_bord,2) += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,2) ;
<a name="l00785"></a>00785 
<a name="l00786"></a>00786               <span class="keywordflow">if</span> (impr_mom)
<a name="l00787"></a>00787                 {
<a name="l00788"></a>00788 <span class="comment">// Calcul du moment exerce par le fluide sur le bord (OM/\F)</span>
<a name="l00789"></a>00789                   tab_flux_bords(2,n_bord,0)+=<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,2)*xgr(face,1)-<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1)*xgr(face,2);
<a name="l00790"></a>00790                   tab_flux_bords(2,n_bord,1)+=<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0)*xgr(face,2)-<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,2)*xgr(face,0);
<a name="l00791"></a>00791                   tab_flux_bords(2,n_bord,2)+=<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1)*xgr(face,0)-<a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0)*xgr(face,1);
<a name="l00792"></a>00792                 }
<a name="l00793"></a>00793               <span class="keywordflow">if</span> (impr_boundary)
<a name="l00794"></a>00794                 {
<a name="l00795"></a>00795                   tab_flux_bords(1,n_bord,0) += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) ;
<a name="l00796"></a>00796                   tab_flux_bords(1,n_bord,1) += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1) ;
<a name="l00797"></a>00797                   tab_flux_bords(1,n_bord,2) += <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,2) ;
<a name="l00798"></a>00798                 }
<a name="l00799"></a>00799             }
<a name="l00800"></a>00800         }
<a name="l00801"></a>00801     } <span class="comment">//!&lt; fin for n_bord</span>
<a name="l00802"></a>00802 <span class="comment"></span>
<a name="l00803"></a>00803 <span class="comment">// On somme les contributions de chaque processeur</span>
<a name="l00804"></a>00804   <a class="code" href="communications_8cpp.html#a5f15b8a5c15449d3277ff3cde06fa68a">mp_sum_for_each_item</a>(tab_flux_bords);
<a name="l00805"></a>00805 
<a name="l00806"></a>00806   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00807"></a>00807     {
<a name="l00808"></a>00808 <span class="comment">// Open files if needed</span>
<a name="l00809"></a>00809       <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> Flux_grad;
<a name="l00810"></a>00810       <a class="code" href="classOperateur__base.html#a163b8e77d9ad86d8c0cdd28d29903538" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier</a>(Flux_grad,<span class="stringliteral">&quot;&quot;</span>,1);
<a name="l00811"></a>00811       <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> Flux_grad_moment;
<a name="l00812"></a>00812       <a class="code" href="classOperateur__base.html#a163b8e77d9ad86d8c0cdd28d29903538" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier</a>(Flux_grad_moment,<span class="stringliteral">&quot;moment&quot;</span>,impr_mom);
<a name="l00813"></a>00813       <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> Flux_grad_sum;
<a name="l00814"></a>00814       <a class="code" href="classOperateur__base.html#a163b8e77d9ad86d8c0cdd28d29903538" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier</a>(Flux_grad_sum,<span class="stringliteral">&quot;sum&quot;</span>,impr_sum);
<a name="l00815"></a>00815 
<a name="l00816"></a>00816 <span class="comment">// Write time</span>
<a name="l00817"></a>00817       Flux_grad.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(sch.<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>());
<a name="l00818"></a>00818       <span class="keywordflow">if</span> (impr_sum) Flux_grad_sum.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(sch.<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>());
<a name="l00819"></a>00819       <span class="keywordflow">if</span> (impr_mom) Flux_grad_moment.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(sch.<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>());
<a name="l00820"></a>00820 
<a name="l00821"></a>00821 <span class="comment">// Write flux on boundaries</span>
<a name="l00822"></a>00822       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
<a name="l00823"></a>00823         {
<a name="l00824"></a>00824           <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2)
<a name="l00825"></a>00825             {
<a name="l00826"></a>00826               Flux_grad.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(0,n_bord,0));
<a name="l00827"></a>00827               Flux_grad.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(0,n_bord,1));
<a name="l00828"></a>00828               <span class="keywordflow">if</span> (impr_sum)
<a name="l00829"></a>00829                 {
<a name="l00830"></a>00830                   Flux_grad_sum.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(1,n_bord,0));
<a name="l00831"></a>00831                   Flux_grad_sum.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(1,n_bord,1));
<a name="l00832"></a>00832                 }
<a name="l00833"></a>00833               <span class="keywordflow">if</span> (impr_mom) Flux_grad_moment.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(2,n_bord,0));
<a name="l00834"></a>00834             }
<a name="l00835"></a>00835           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00836"></a>00836             {
<a name="l00837"></a>00837               Flux_grad.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(0,n_bord,0));
<a name="l00838"></a>00838               Flux_grad.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(0,n_bord,1));
<a name="l00839"></a>00839               Flux_grad.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(0,n_bord,2));
<a name="l00840"></a>00840               <span class="keywordflow">if</span> (impr_sum)
<a name="l00841"></a>00841                 {
<a name="l00842"></a>00842                   Flux_grad_sum.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(1,n_bord,0));
<a name="l00843"></a>00843                   Flux_grad_sum.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(1,n_bord,1));
<a name="l00844"></a>00844                   Flux_grad_sum.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(1,n_bord,2));
<a name="l00845"></a>00845                 }
<a name="l00846"></a>00846               <span class="keywordflow">if</span> (impr_mom)
<a name="l00847"></a>00847                 {
<a name="l00848"></a>00848                   Flux_grad_moment.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(2,n_bord,0));
<a name="l00849"></a>00849                   Flux_grad_moment.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(2,n_bord,1));
<a name="l00850"></a>00850                   Flux_grad_moment.<a class="code" href="classSortie.html#aed397f2acfa499f2c34be9657a724de0">add_col</a>(tab_flux_bords(2,n_bord,2));
<a name="l00851"></a>00851                 }
<a name="l00852"></a>00852             }
<a name="l00853"></a>00853         }
<a name="l00854"></a>00854       Flux_grad &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00855"></a>00855       <span class="keywordflow">if</span> (impr_sum) Flux_grad_sum &lt;&lt; finl;
<a name="l00856"></a>00856       <span class="keywordflow">if</span> (impr_mom) Flux_grad_moment &lt;&lt; finl;
<a name="l00857"></a>00857     }
<a name="l00858"></a>00858 
<a name="l00859"></a>00859   <span class="keyword">const</span> <a class="code" href="List_8h.html#a3149526fb499ddb08728c87daa32c5ad">LIST</a>(<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>)&amp; Liste_Bords_a_imprimer = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a2e4f80965f20d39334b470af7aec494a">Bords_a_imprimer</a>();
<a name="l00860"></a>00860   <span class="keywordflow">if</span> (!Liste_Bords_a_imprimer.est_vide())
<a name="l00861"></a>00861     {
<a name="l00862"></a>00862       <a class="code" href="classEcrFicPartage.html">EcrFicPartage</a> Flux_grad_face;
<a name="l00863"></a>00863       <a class="code" href="classOperateur__base.html#a75f3b320ba6d2b58ab1a43a10f317de4" title="Ouverture/creation d&#39;un fichier d&#39;impression d&#39;un operateur A surcharger dans les classes derivees...">ouvrir_fichier_partage</a>(Flux_grad_face,<span class="stringliteral">&quot;&quot;</span>,impr_bord);
<a name="l00864"></a>00864       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
<a name="l00865"></a>00865         {
<a name="l00866"></a>00866           <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l00867"></a>00867           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00868"></a>00868           <span class="keywordtype">int</span> ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00869"></a>00869           <span class="keywordtype">int</span> nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00870"></a>00870           <span class="keywordflow">if</span> (zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a2e4f80965f20d39334b470af7aec494a">Bords_a_imprimer</a>().<a class="code" href="classList__Nom.html#aafe66fe06c0dd82cb2641fcaf774db07">contient</a>(le_bord.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>()))
<a name="l00871"></a>00871             {
<a name="l00872"></a>00872               <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00873"></a>00873                 {
<a name="l00874"></a>00874                   Flux_grad_face &lt;&lt; <span class="stringliteral">&quot;# Force par face sur &quot;</span> &lt;&lt; le_bord.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; au temps &quot;</span>;
<a name="l00875"></a>00875                   sch.<a class="code" href="classSchema__Temps__base.html#afb4a13da2e8149defb5339ef005ef231">imprimer_temps_courant</a>(Flux_grad_face);
<a name="l00876"></a>00876                   Flux_grad_face &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00877"></a>00877                 }
<a name="l00878"></a>00878               <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l00879"></a>00879                 {
<a name="l00880"></a>00880                   Flux_grad_face &lt;&lt; <span class="stringliteral">&quot;# Face a x= &quot;</span> &lt;&lt; zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>(face,0) &lt;&lt; <span class="stringliteral">&quot; y= &quot;</span> &lt;&lt; zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>(face,1);
<a name="l00881"></a>00881                   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3) Flux_grad_face &lt;&lt; <span class="stringliteral">&quot; z= &quot;</span> &lt;&lt; zone_VEF.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>(face,2);
<a name="l00882"></a>00882                   Flux_grad_face &lt;&lt; <span class="stringliteral">&quot; : Fx= &quot;</span> &lt;&lt; <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,0) &lt;&lt; <span class="stringliteral">&quot; Fy= &quot;</span> &lt;&lt; <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,1);
<a name="l00883"></a>00883                   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3) Flux_grad_face &lt;&lt; <span class="stringliteral">&quot; Fz= &quot;</span> &lt;&lt; <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(face,2);
<a name="l00884"></a>00884                   Flux_grad_face &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00885"></a>00885                 }
<a name="l00886"></a>00886               Flux_grad_face.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00887"></a>00887             }
<a name="l00888"></a>00888         }
<a name="l00889"></a>00889     }
<a name="l00890"></a>00890   <span class="keywordflow">return</span> 1;
<a name="l00891"></a>00891 }
<a name="l00892"></a>00892 
<a name="l00893"></a>00893 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:29 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
