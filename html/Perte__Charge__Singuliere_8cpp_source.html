<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/ThHyd/Incompressible/Sources/Perte_Charge_Singuliere.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/ThHyd/Incompressible/Sources/Perte_Charge_Singuliere.cpp</div>  </div>
</div>
<div class="contents">
<a href="Perte__Charge__Singuliere_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Perte_Charge_Singuliere.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/ThHyd/Incompressible/Sources</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/14</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Perte__Charge__Singuliere_8h.html">Perte_Charge_Singuliere.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Motcle_8h.html">Motcle.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VF_8h.html">Zone_VF.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Sous__Zone_8h.html">Sous_Zone.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Octree_8h.html">Octree.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Source__base_8h.html">Source_base.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="DoubleVect_8h.html">DoubleVect.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="DoubleTrav_8h.html">DoubleTrav.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Param_8h.html">Param.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Equation__base_8h.html">Equation_base.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="Milieu__base_8h.html">Milieu_base.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps__base_8h.html">Schema_Temps_base.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="Discretisation__base_8h.html">Discretisation_base.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="EChaine_8h.html">EChaine.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="Pb__Multiphase_8h.html">Pb_Multiphase.h</a>&gt;</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="Avanc_8cpp.html#a98c8f11a2783c4bdf1a9484db0dc3c3b">convert_to</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keywordtype">double</span>&amp; ob);
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="comment">// Precondition:</span>
<a name="l00045"></a>00045 <span class="comment">// Parametre: Entree&amp; is</span>
<a name="l00046"></a>00046 <span class="comment">// Signification: un flot d&#39;entree</span>
<a name="l00047"></a>00047 <span class="comment">// Valeurs par defaut:</span>
<a name="l00048"></a>00048 <span class="comment">// Contraintes:</span>
<a name="l00049"></a>00049 <span class="comment">// Acces: entree/sortie</span>
<a name="l00050"></a>00050 <span class="comment">// Exception: mot cle inattendu, on attendait &quot;KX&quot;,&quot;KY&quot;, &quot;KZ&quot; ou &quot;K&quot;</span>
<a name="l00051"></a>00051 <span class="comment">// Effets de bord:</span>
<a name="l00052"></a>00052 <span class="comment">// Postcondition:</span>
<a name="l00053"></a>00053 <span class="comment">//</span>
<a name="l00054"></a>00054 <span class="comment">//</span><span class="comment"></span>
<a name="l00055"></a>00055 <span class="comment">//! Lit les specifications d&#39;une perte de charge singuliere&lt;br&gt;a partir d&#39;un flot d&#39;entree.</span>
<a name="l00056"></a>00056 <span class="comment"></span><span class="comment">/** \return Entree\&amp;&lt;br&gt;</span>
<a name="l00057"></a>00057 <span class="comment">Signification: le flot d&#39;entree modifie&lt;br&gt;</span>
<a name="l00058"></a>00058 <span class="comment">Contraintes: */</span>
<a name="l00059"></a><a class="code" href="classPerte__Charge__Singuliere.html#ae921dbe17585e57646c74ad8e470ee25">00059</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classPerte__Charge__Singuliere.html#ae921dbe17585e57646c74ad8e470ee25" title="Lit les specifications d&#39;une perte de charge singuliere a partir d&#39;un flot d&#39;entree.">Perte_Charge_Singuliere::lire_donnees</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00060"></a>00060 {
<a name="l00061"></a>00061   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> motlu;
<a name="l00062"></a>00062   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> acc_ouverte(<span class="stringliteral">&quot;{&quot;</span>);
<a name="l00063"></a>00063   <a class="code" href="classMotcles.html" title="Un tableau d&#39;objets de la classe Motcle.">Motcles</a> les_motcles(4);
<a name="l00064"></a>00064   les_motcles[0] = <span class="stringliteral">&quot;KX&quot;</span>;
<a name="l00065"></a>00065   les_motcles[1] = <span class="stringliteral">&quot;KY&quot;</span>;
<a name="l00066"></a>00066   les_motcles[2] = <span class="stringliteral">&quot;KZ&quot;</span>;
<a name="l00067"></a>00067   les_motcles[3] = <span class="stringliteral">&quot;K&quot;</span>;
<a name="l00068"></a>00068   <a class="code" href="classPerte__Charge__Singuliere.html#a036910a1edb3b5e13a16071cc7c4211e">regul_</a> = 0;
<a name="l00069"></a>00069   is &gt;&gt; motlu;
<a name="l00070"></a>00070   <span class="keywordflow">if</span> (motlu != acc_ouverte)
<a name="l00071"></a>00071     {
<a name="l00072"></a>00072       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On attendait le mot cle&quot;</span> &lt;&lt; acc_ouverte &lt;&lt; <span class="stringliteral">&quot; a la place de &quot;</span> &lt;&lt; motlu &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00073"></a>00073       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00074"></a>00074     }
<a name="l00075"></a>00075   is &gt;&gt; motlu;
<a name="l00076"></a>00076   <span class="keywordflow">if</span> (motlu != <span class="stringliteral">&quot;dir&quot;</span>)
<a name="l00077"></a>00077     {
<a name="l00078"></a>00078       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On attendait le mot cle dir a la place de &quot;</span> &lt;&lt; motlu &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00079"></a>00079       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00080"></a>00080     }
<a name="l00081"></a>00081   <span class="keywordflow">else</span>
<a name="l00082"></a>00082     {
<a name="l00083"></a>00083       is &gt;&gt; motlu;
<a name="l00084"></a>00084       <span class="keywordtype">int</span> rang = les_motcles.<a class="code" href="classMotcles.html#afecd68f73e904bc129022a236ff6ab15">search</a>(motlu);
<a name="l00085"></a>00085       <span class="keywordflow">if</span> (rang == -1)
<a name="l00086"></a>00086         {
<a name="l00087"></a>00087           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur a la lecture des donnees de Perte_Charge_Singuliere&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00088"></a>00088           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On attendait l&#39;un des mots cles &quot;</span> &lt;&lt; les_motcles &lt;&lt; finl;
<a name="l00089"></a>00089           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;a la place de &quot;</span> &lt;&lt; motlu &lt;&lt; finl;
<a name="l00090"></a>00090           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00091"></a>00091         }
<a name="l00092"></a>00092       <a class="code" href="classPerte__Charge.html#a5ad009a63cf1d99d839fadce076f1ccf">direction_perte_charge_</a> = rang == 3 ? -1 : rang;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094     }
<a name="l00095"></a>00095   is &gt;&gt; motlu;
<a name="l00096"></a>00096   <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;regul&quot;</span>)
<a name="l00097"></a>00097     {
<a name="l00098"></a>00098       <a class="code" href="classPerte__Charge__Singuliere.html#a036910a1edb3b5e13a16071cc7c4211e">regul_</a> = 1;
<a name="l00099"></a>00099       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> eps_str, deb_str;
<a name="l00100"></a>00100       <a class="code" href="classParam.html" title="Defined below in this file.">Param</a> param(<span class="stringliteral">&quot;regul&quot;</span>);
<a name="l00101"></a>00101       param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;K0&quot;</span>, &amp;<a class="code" href="classPerte__Charge__Singuliere.html#aed3c4c0e855ea65d7f5afd0fcdbeabc2">K_</a>, <a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384aaf5b6dfac1c5970478525407cc6ac572">Param::REQUIRED</a>);
<a name="l00102"></a>00102       param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;deb&quot;</span>, &amp;deb_str, <a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384aaf5b6dfac1c5970478525407cc6ac572">Param::REQUIRED</a>);
<a name="l00103"></a>00103       param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;eps&quot;</span>, &amp;eps_str, <a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384aaf5b6dfac1c5970478525407cc6ac572">Param::REQUIRED</a>);
<a name="l00104"></a>00104       param.<a class="code" href="classParam.html#aea52f16d3b74c59c48cb5708ff48f14a">lire_avec_accolades</a>(is);
<a name="l00105"></a>00105       <a class="code" href="classPerte__Charge__Singuliere.html#acb6602b31e6bdb514583b5f50e770d21">deb_cible_</a>.<a class="code" href="classParser__U.html#a3ff44eabf641cbcea9ca59f84167e2c1">setNbVar</a>(1), <a class="code" href="classPerte__Charge__Singuliere.html#a28f54fe2cfaad225aa3216315ed40d25">eps_</a>.<a class="code" href="classParser__U.html#a3ff44eabf641cbcea9ca59f84167e2c1">setNbVar</a>(1);
<a name="l00106"></a>00106       <a class="code" href="classPerte__Charge__Singuliere.html#acb6602b31e6bdb514583b5f50e770d21">deb_cible_</a>.<a class="code" href="classParser__U.html#a25d581b85688da391aa64117abf0a073">setString</a>(deb_str), <a class="code" href="classPerte__Charge__Singuliere.html#a28f54fe2cfaad225aa3216315ed40d25">eps_</a>.<a class="code" href="classParser__U.html#a25d581b85688da391aa64117abf0a073">setString</a>(eps_str);
<a name="l00107"></a>00107       <a class="code" href="classPerte__Charge__Singuliere.html#acb6602b31e6bdb514583b5f50e770d21">deb_cible_</a>.<a class="code" href="classParser__U.html#ae216b7daee6c4bb756423ffed5674293">addVar</a>(<span class="stringliteral">&quot;t&quot;</span>), <a class="code" href="classPerte__Charge__Singuliere.html#a28f54fe2cfaad225aa3216315ed40d25">eps_</a>.<a class="code" href="classParser__U.html#ae216b7daee6c4bb756423ffed5674293">addVar</a>(<span class="stringliteral">&quot;t&quot;</span>);
<a name="l00108"></a>00108       <a class="code" href="classPerte__Charge__Singuliere.html#acb6602b31e6bdb514583b5f50e770d21">deb_cible_</a>.<a class="code" href="classParser__U.html#a441c2fd29f5d4370c0c7b6a1cdfe56d5">parseString</a>(), <a class="code" href="classPerte__Charge__Singuliere.html#a28f54fe2cfaad225aa3216315ed40d25">eps_</a>.<a class="code" href="classParser__U.html#a441c2fd29f5d4370c0c7b6a1cdfe56d5">parseString</a>();
<a name="l00109"></a>00109     }
<a name="l00110"></a>00110   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;coeff&quot;</span>)
<a name="l00111"></a>00111     {
<a name="l00112"></a>00112       is &gt;&gt; motlu;
<a name="l00113"></a>00113       <a class="code" href="Avanc_8cpp.html#a98c8f11a2783c4bdf1a9484db0dc3c3b">convert_to</a>(motlu.getChar(), <a class="code" href="classPerte__Charge__Singuliere.html#aed3c4c0e855ea65d7f5afd0fcdbeabc2">K_</a>);
<a name="l00114"></a>00114     }
<a name="l00115"></a>00115   <span class="keywordflow">else</span>
<a name="l00116"></a>00116     {
<a name="l00117"></a>00117       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On attendait le mot cle coeff ou regul a la place de &quot;</span> &lt;&lt; motlu &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00118"></a>00118       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; direction_perte_charge_ &quot;</span> &lt;&lt; <a class="code" href="classPerte__Charge.html#a5ad009a63cf1d99d839fadce076f1ccf">direction_perte_charge_</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00122"></a>00122   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; perte de charge K_ &quot;</span> &lt;&lt; <a class="code" href="classPerte__Charge__Singuliere.html#aed3c4c0e855ea65d7f5afd0fcdbeabc2">K_</a> &lt;&lt; finl;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124   <span class="keywordflow">return</span> is;
<a name="l00125"></a>00125 }
<a name="l00126"></a>00126 
<a name="l00127"></a><a class="code" href="classPerte__Charge__Singuliere.html#a275c6676236eb5795b6bdbb7df96ead1">00127</a> <span class="keywordtype">void</span> <a class="code" href="classPerte__Charge__Singuliere.html#a275c6676236eb5795b6bdbb7df96ead1">Perte_Charge_Singuliere::lire_surfaces</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is, <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; le_domaine,
<a name="l00128"></a>00128                                             <span class="keyword">const</span> <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; zone_dis, <a class="code" href="classIntVect.html">IntVect</a>&amp; les_faces, <a class="code" href="classIntVect.html">IntVect</a>&amp; <a class="code" href="Op__Conv__Muscl__old__VEF__Face_8cpp.html#ae1b5a554c1d4d97654c06032a92f800a">sgn</a>)
<a name="l00129"></a>00129 {
<a name="l00130"></a>00130   <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zvf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>,zone_dis);
<a name="l00131"></a>00131   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zvf.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00132"></a>00132   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xv = zvf.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00133"></a>00133   <span class="keywordtype">int</span> nfe = zvf.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00134"></a>00134   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> face_tab; <span class="comment">//1 for faces in the surface</span>
<a name="l00135"></a>00135   zvf.<a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(face_tab);
<a name="l00136"></a>00136   <a class="code" href="classChamp__Don.html" title="classe Champ_Don Classe generique de la hierarchie des champs donnes, un objet Champ_Don peut referen...">Champ_Don</a> orientation;
<a name="l00137"></a>00137 
<a name="l00138"></a>00138   <span class="keywordtype">int</span> algo=-1;
<a name="l00139"></a>00139   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> method;
<a name="l00140"></a>00140 
<a name="l00141"></a>00141   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> motlu;
<a name="l00142"></a>00142   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> acc_ouverte(<span class="stringliteral">&quot;{&quot;</span>);
<a name="l00143"></a>00143   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> acc_fermee(<span class="stringliteral">&quot;}&quot;</span>);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_ss_zone, nom_surface;
<a name="l00146"></a>00146   <span class="keywordtype">double</span> position;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148   <span class="comment">/* Read plan */</span>
<a name="l00149"></a>00149   is &gt;&gt; motlu;
<a name="l00150"></a>00150   <span class="keywordflow">if</span> (motlu != <span class="stringliteral">&quot;surface&quot;</span>)
<a name="l00151"></a>00151     {
<a name="l00152"></a>00152       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On attendait le mot cle surface a la place de &quot;</span> &lt;&lt; motlu &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00153"></a>00153       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00154"></a>00154     }
<a name="l00155"></a>00155   is &gt;&gt; motlu;
<a name="l00156"></a>00156   <span class="keywordflow">if</span> (motlu != acc_ouverte)
<a name="l00157"></a>00157     {
<a name="l00158"></a>00158       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On attendait le mot cle&quot;</span> &lt;&lt; acc_ouverte &lt;&lt; <span class="stringliteral">&quot; a la place de &quot;</span> &lt;&lt; motlu &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00159"></a>00159       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00160"></a>00160     }
<a name="l00161"></a>00161   is &gt;&gt; method;
<a name="l00162"></a>00162   <span class="keywordflow">if</span> (method==<span class="stringliteral">&quot;X&quot;</span> || method==<span class="stringliteral">&quot;Y&quot;</span> || method==<span class="stringliteral">&quot;Z&quot;</span>)
<a name="l00163"></a>00163     {
<a name="l00164"></a>00164       <span class="comment">/* Subzone algorithm */</span>
<a name="l00165"></a>00165       algo=0;
<a name="l00166"></a>00166       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> direction=method, egal;
<a name="l00167"></a>00167       <span class="keywordflow">if</span> (  ((direction==<span class="stringliteral">&quot;X&quot;</span>) &amp;&amp; (<a class="code" href="classPerte__Charge.html#ac3b3e387597c27257ef1ec8f3dce5779" title="Renvoie la direction de perte de charge. (X,Y ou Z), ou -1 si toutes les directions.">direction_perte_charge</a>()!=0))
<a name="l00168"></a>00168             || ((direction==<span class="stringliteral">&quot;Y&quot;</span>) &amp;&amp; (<a class="code" href="classPerte__Charge.html#ac3b3e387597c27257ef1ec8f3dce5779" title="Renvoie la direction de perte de charge. (X,Y ou Z), ou -1 si toutes les directions.">direction_perte_charge</a>()!=1))
<a name="l00169"></a>00169             || ((direction==<span class="stringliteral">&quot;Z&quot;</span>) &amp;&amp; (<a class="code" href="classPerte__Charge.html#ac3b3e387597c27257ef1ec8f3dce5779" title="Renvoie la direction de perte de charge. (X,Y ou Z), ou -1 si toutes les directions.">direction_perte_charge</a>()!=2)))
<a name="l00170"></a>00170         {
<a name="l00171"></a>00171           <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> dir,sect;
<a name="l00172"></a>00172           <span class="keywordflow">if</span> (<a class="code" href="classPerte__Charge.html#ac3b3e387597c27257ef1ec8f3dce5779" title="Renvoie la direction de perte de charge. (X,Y ou Z), ou -1 si toutes les directions.">direction_perte_charge</a>() == 0)
<a name="l00173"></a>00173             {
<a name="l00174"></a>00174               dir=<span class="stringliteral">&quot;KX&quot;</span>;
<a name="l00175"></a>00175               sect=<span class="stringliteral">&quot;X&quot;</span>;
<a name="l00176"></a>00176             }
<a name="l00177"></a>00177           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classPerte__Charge.html#ac3b3e387597c27257ef1ec8f3dce5779" title="Renvoie la direction de perte de charge. (X,Y ou Z), ou -1 si toutes les directions.">direction_perte_charge</a>() == 1)
<a name="l00178"></a>00178             {
<a name="l00179"></a>00179               dir=<span class="stringliteral">&quot;KY&quot;</span>;
<a name="l00180"></a>00180               sect=<span class="stringliteral">&quot;Y&quot;</span>;
<a name="l00181"></a>00181             }
<a name="l00182"></a>00182           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classPerte__Charge.html#ac3b3e387597c27257ef1ec8f3dce5779" title="Renvoie la direction de perte de charge. (X,Y ou Z), ou -1 si toutes les directions.">direction_perte_charge</a>() == 2)
<a name="l00183"></a>00183             {
<a name="l00184"></a>00184               dir=<span class="stringliteral">&quot;KZ&quot;</span>;
<a name="l00185"></a>00185               sect=<span class="stringliteral">&quot;Z&quot;</span>;
<a name="l00186"></a>00186             }
<a name="l00187"></a>00187           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The section specified &quot;</span> &lt;&lt; direction &lt;&lt; <span class="stringliteral">&quot; is not coherent with the coefficient pressure loss direction indicated by &quot;</span> &lt;&lt; dir &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00188"></a>00188           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Here the section to specify is &quot;</span> &lt;&lt; sect &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; finl;
<a name="l00189"></a>00189           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00190"></a>00190 
<a name="l00191"></a>00191         }
<a name="l00192"></a>00192       is &gt;&gt; egal &gt;&gt; position;
<a name="l00193"></a>00193       is &gt;&gt; nom_ss_zone;
<a name="l00194"></a>00194       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; position &quot;</span> &lt;&lt; direction &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; position &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00195"></a>00195       <a class="code" href="classPerte__Charge__Singuliere.html#a822dfa85ad27c35b884854e9c4e3f244">identifiant_</a> = nom_ss_zone + <span class="stringliteral">&quot;_&quot;</span> + direction + <span class="stringliteral">&quot;=&quot;</span> + <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(position);
<a name="l00196"></a>00196     }
<a name="l00197"></a>00197   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (method==<span class="stringliteral">&quot;Surface&quot;</span>)
<a name="l00198"></a>00198     {
<a name="l00199"></a>00199       <span class="comment">/* Surface algorithm */</span>
<a name="l00200"></a>00200       algo=1;
<a name="l00201"></a>00201       <span class="comment">/*</span>
<a name="l00202"></a>00202 <span class="comment">            if (zvf.dimension!=3)</span>
<a name="l00203"></a>00203 <span class="comment">              {</span>
<a name="l00204"></a>00204 <span class="comment">                Cerr &lt;&lt; &quot;Error in Perte_Charge_Singuliere::lire_surfaces&quot; &lt;&lt; finl;</span>
<a name="l00205"></a>00205 <span class="comment">                Cerr &lt;&lt; &quot;The keyword &quot; &lt;&lt; method &lt;&lt; &quot; specified for plan definition is only possible in 3D !&quot; &lt;&lt; finl;</span>
<a name="l00206"></a>00206 <span class="comment">                Cerr &lt;&lt; &quot;You must used the method of intersection between subzone and location of plane.&quot; &lt;&lt; finl;</span>
<a name="l00207"></a>00207 <span class="comment">                Process::exit();</span>
<a name="l00208"></a>00208 <span class="comment">              }</span>
<a name="l00209"></a>00209 <span class="comment">      */</span>
<a name="l00210"></a>00210       <span class="keywordflow">if</span> (zone_dis.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>().<a class="code" href="classNom.html#a41b0ba18fb90d481c0828ed4372de8ee">debute_par</a>(<span class="stringliteral">&quot;Zone_VDF&quot;</span>))
<a name="l00211"></a>00211         {
<a name="l00212"></a>00212           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Perte_Charge_Singuliere::lire_surfaces&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00213"></a>00213           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The keyword &quot;</span> &lt;&lt; method &lt;&lt; <span class="stringliteral">&quot; specified for plan definition is only possible in VEF discretization !&quot;</span> &lt;&lt; finl;
<a name="l00214"></a>00214           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;You must used the method of intersection between subzone and location of plane.&quot;</span> &lt;&lt; finl;
<a name="l00215"></a>00215           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00216"></a>00216         }
<a name="l00217"></a>00217       is &gt;&gt; nom_surface;
<a name="l00218"></a>00218       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; surface &quot;</span> &lt;&lt; nom_surface &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00219"></a>00219       <a class="code" href="classPerte__Charge__Singuliere.html#a822dfa85ad27c35b884854e9c4e3f244">identifiant_</a> = nom_surface;
<a name="l00220"></a>00220     }
<a name="l00221"></a>00221   <span class="keywordflow">else</span>
<a name="l00222"></a>00222     {
<a name="l00223"></a>00223       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Perte_Charge_Singuliere::lire_surfaces&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00224"></a>00224       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The keyword &quot;</span> &lt;&lt; method &lt;&lt; <span class="stringliteral">&quot; specified for plan definition is not coherent !&quot;</span> &lt;&lt; finl;
<a name="l00225"></a>00225       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00226"></a>00226     }
<a name="l00227"></a>00227   is &gt;&gt; motlu;
<a name="l00228"></a>00228   <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;orientation&quot;</span>) is &gt;&gt; orientation, is &gt;&gt; motlu; <span class="comment">//on lit un champ pour orienter la surface</span>
<a name="l00229"></a>00229 
<a name="l00230"></a>00230   <span class="keywordflow">if</span> (motlu != acc_fermee)
<a name="l00231"></a>00231     {
<a name="l00232"></a>00232       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On attendait le mot cle&quot;</span> &lt;&lt; acc_fermee &lt;&lt; <span class="stringliteral">&quot; a la place de &quot;</span> &lt;&lt; motlu &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00233"></a>00233       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00234"></a>00234     }
<a name="l00235"></a>00235   is &gt;&gt; motlu;
<a name="l00236"></a>00236   <span class="keywordflow">if</span> (motlu != acc_fermee)
<a name="l00237"></a>00237     {
<a name="l00238"></a>00238       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On attendait le mot cle&quot;</span> &lt;&lt; acc_fermee &lt;&lt; <span class="stringliteral">&quot; a la place de &quot;</span> &lt;&lt; motlu &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00239"></a>00239       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00240"></a>00240     }
<a name="l00241"></a>00241   <span class="comment">/* Found faces */</span>
<a name="l00242"></a>00242   <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>=0;
<a name="l00243"></a>00243 
<a name="l00244"></a>00244   <span class="keywordflow">if</span> (algo==0)
<a name="l00245"></a>00245     {
<a name="l00246"></a>00246       <span class="comment">/* Subzone algorithm */</span>
<a name="l00247"></a>00247       <span class="keyword">const</span> <a class="code" href="classSous__Zone.html" title="Classe Sous_Zone Represente une sous zone volumique i.e un sous ensemble de polyedres d&#39;un objet de t...">Sous_Zone</a>&amp; ssz = le_domaine.<a class="code" href="classDomaine.html#ad38f4fc3c0e1b44dc9fdc947985178a5" title="Renvoie la i-ieme sous-zone. (version const)">ss_zone</a>(nom_ss_zone);
<a name="l00248"></a>00248       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> poly=0; poly&lt;ssz.<a class="code" href="classSous__Zone.html#a4266863124b1b4ce971ac57a6ec746e9" title="Returns the subzone number of elements (real+virtual elements in parallel)">nb_elem_tot</a>(); poly++)
<a name="l00249"></a>00249         {
<a name="l00250"></a>00250           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nfe; j++)
<a name="l00251"></a>00251             {
<a name="l00252"></a>00252               <span class="keywordtype">int</span> numfa = elem_faces(ssz(poly),j);
<a name="l00253"></a>00253 <span class="comment">// numfa might be negative in case of polyhedron where number of faces for an elem varies (padding)</span>
<a name="l00254"></a>00254               <span class="keywordflow">if</span> (numfa &gt;= 0 &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(xv(numfa,<a class="code" href="classPerte__Charge.html#ac3b3e387597c27257ef1ec8f3dce5779" title="Renvoie la direction de perte de charge. (X,Y ou Z), ou -1 si toutes les directions.">direction_perte_charge</a>()),position) )
<a name="l00255"></a>00255                 {
<a name="l00256"></a>00256                   <span class="keywordtype">bool</span> trouve=0;
<a name="l00257"></a>00257                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>; i++)
<a name="l00258"></a>00258                     <span class="keywordflow">if</span> (les_faces[i]==numfa)
<a name="l00259"></a>00259                       {
<a name="l00260"></a>00260                         trouve=1;
<a name="l00261"></a>00261                         <span class="keywordflow">break</span>;
<a name="l00262"></a>00262                       }
<a name="l00263"></a>00263                   <span class="keywordflow">if</span> (trouve==0) les_faces[compteur++] = numfa, face_tab(numfa) = 1;
<a name="l00264"></a>00264                 }
<a name="l00265"></a>00265             }
<a name="l00266"></a>00266         }
<a name="l00267"></a>00267     }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (algo==1)
<a name="l00270"></a>00270     {
<a name="l00271"></a>00271       <span class="comment">/* Surface algorithm */</span>
<a name="l00272"></a>00272       <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; le_domaine2D = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>,le_domaine.<a class="code" href="classObjet__U.html#a9b5c13352a6601b5cec65941575f2e9a">interprete</a>().<a class="code" href="classInterprete.html#a3ca248609f0b72eac68baca14621b4ee" title="Voir Interprete_bloc::objet_global() BM: la classe Interprete n&#39;est pas le meilleur endroit pour cett...">objet</a>(nom_surface));
<a name="l00273"></a>00273       <span class="keywordflow">if</span> (le_domaine2D.<a class="code" href="classDomaine.html#a9f3fc389a1310d1fc8b4b27976855376" title="Renvoie le nombre de zone du domaine.">nb_zones</a>() == 0)
<a name="l00274"></a>00274         {
<a name="l00275"></a>00275           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Perte_Charge_Singuliere::lire_surfaces&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00276"></a>00276           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;You must correct your data file because the &quot;</span> &lt;&lt; nom_surface &lt;&lt; <span class="stringliteral">&quot; surface is not well defined in parallel !&quot;</span> &lt;&lt; finl;
<a name="l00277"></a>00277           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00278"></a>00278         }
<a name="l00279"></a>00279       <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_2D = le_domaine2D.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);
<a name="l00280"></a>00280       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord_sommets_2D=le_domaine2D.<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00281"></a>00281 
<a name="l00282"></a>00282       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> xv2D;
<a name="l00283"></a>00283       zone_2D.<a class="code" href="classZone.html#ad8104f9be27f9c357e345b281a79064e" title="Calcule les centres de gravites des elements de la zone.">calculer_centres_gravite</a>(xv2D);
<a name="l00284"></a>00284       <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_2D = zone_2D.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00285"></a>00285       <span class="keywordtype">int</span> nse2D = zone_2D.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00286"></a>00286 
<a name="l00287"></a>00287       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord_sommets=le_domaine.<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00288"></a>00288       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_sommets = zvf.<a class="code" href="classZone__VF.html#a298e73b18e17da55f421b1fb0879bd46" title="renvoie le numero du ieme sommet de la face num_face.">face_sommets</a>();
<a name="l00289"></a>00289       <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_vol = le_domaine.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);
<a name="l00290"></a>00290       <span class="keyword">const</span> <a class="code" href="classOctreeRoot.html" title="Classe OctreeRoot.">OctreeRoot</a>&amp; octree_vol = zone_vol.<a class="code" href="classZone.html#a492c53ea54616079fb65c18f7726ebc9">construit_octree</a>();
<a name="l00291"></a>00291 
<a name="l00292"></a>00292 <span class="comment">// Loop on faces on the surface domain</span>
<a name="l00293"></a>00293       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Surface &quot;</span> &lt;&lt; nom_surface &lt;&lt; <span class="stringliteral">&quot; with &quot;</span> &lt;&lt; nb_elem_2D &lt;&lt; <span class="stringliteral">&quot; faces&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00294"></a>00294       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face&lt;nb_elem_2D; ind_face++)
<a name="l00295"></a>00295         {
<a name="l00296"></a>00296 <span class="comment">// Fill elem_list_vol by elements surrounding the center of gravity</span>
<a name="l00297"></a>00297           <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> elem_list_vol;
<a name="l00298"></a>00298           <span class="keywordtype">double</span> zv2d=0;
<a name="l00299"></a>00299           <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>&gt;2)
<a name="l00300"></a>00300             zv2d=xv2D(ind_face,2);
<a name="l00301"></a>00301           octree_vol.<a class="code" href="classOctreeRoot.html#aadb775575739c59baabc8bb13e48335c">rang_elems_sommet</a>(elem_list_vol,xv2D(ind_face,0),xv2D(ind_face,1),zv2d);
<a name="l00302"></a>00302           <span class="keywordtype">int</span> nb_elem_vol = elem_list_vol.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00303"></a>00303 <span class="comment">// Loop on elements on the volume domain</span>
<a name="l00304"></a>00304           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_elem=0; ind_elem&lt;nb_elem_vol; ind_elem++)
<a name="l00305"></a>00305             {
<a name="l00306"></a>00306               <span class="keywordtype">int</span> elem = elem_list_vol(ind_elem);
<a name="l00307"></a>00307 <span class="comment">// Loop on faces of each element on the volume domain</span>
<a name="l00308"></a>00308               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0, numfa; j &lt; nfe &amp;&amp; (numfa = elem_faces(elem,j)) &gt;= 0; j++)
<a name="l00309"></a>00309                 {
<a name="l00310"></a>00310 <span class="comment">// Test if the same face between surface domain and volum domain</span>
<a name="l00311"></a>00311                   <span class="keywordtype">int</span> coincide=0;
<a name="l00312"></a>00312 <span class="comment">// Loop on vertex of each face of each element on the volume domain</span>
<a name="l00313"></a>00313                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nse2D; k++)
<a name="l00314"></a>00314                     {
<a name="l00315"></a>00315                       <span class="keywordtype">int</span> numso = face_sommets(numfa,k);
<a name="l00316"></a>00316                       <span class="keywordtype">double</span> xcoord_vol=coord_sommets(numso,0);
<a name="l00317"></a>00317                       <span class="keywordtype">double</span> ycoord_vol=coord_sommets(numso,1);
<a name="l00318"></a>00318 <span class="comment">// double zcoord_vol=coord_sommets(numso,2);</span>
<a name="l00319"></a>00319                       <span class="keywordtype">double</span>  zcoord_vol=0;
<a name="l00320"></a>00320                       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>&gt;2)
<a name="l00321"></a>00321                         zcoord_vol=coord_sommets(numso,2);
<a name="l00322"></a>00322 
<a name="l00323"></a>00323                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nse2D ; i++)
<a name="l00324"></a>00324                         {
<a name="l00325"></a>00325                           <span class="keywordtype">int</span> numso2D = zone_2D.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(ind_face,i);
<a name="l00326"></a>00326                           <span class="keywordtype">double</span> xcoord_2D=coord_sommets_2D(numso2D,0);
<a name="l00327"></a>00327                           <span class="keywordtype">double</span> ycoord_2D=coord_sommets_2D(numso2D,1);
<a name="l00328"></a>00328                           <span class="keywordtype">double</span> zcoord_2D=0;
<a name="l00329"></a>00329                           <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>&gt;2)
<a name="l00330"></a>00330                             zcoord_2D=coord_sommets_2D(numso2D,2);
<a name="l00331"></a>00331                           <span class="keywordflow">if</span> ( <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(xcoord_vol,xcoord_2D)
<a name="l00332"></a>00332                                &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(ycoord_vol,ycoord_2D)
<a name="l00333"></a>00333                                &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(zcoord_vol,zcoord_2D))
<a name="l00334"></a>00334                             {
<a name="l00335"></a>00335                               coincide=coincide+1;
<a name="l00336"></a>00336                               <span class="keywordflow">break</span>;
<a name="l00337"></a>00337                             }
<a name="l00338"></a>00338                         }
<a name="l00339"></a>00339                     }
<a name="l00340"></a>00340                   <span class="keywordflow">if</span> (coincide==nse2D)
<a name="l00341"></a>00341                     {
<a name="l00342"></a>00342                       <span class="keywordtype">bool</span> trouve=0;
<a name="l00343"></a>00343                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> ; i++)
<a name="l00344"></a>00344                         <span class="keywordflow">if</span> (les_faces[i]==numfa)
<a name="l00345"></a>00345                           {
<a name="l00346"></a>00346                             trouve=1;
<a name="l00347"></a>00347                             <span class="keywordflow">break</span>;
<a name="l00348"></a>00348                           }
<a name="l00349"></a>00349                       <span class="keywordflow">if</span> (trouve==0) les_faces[compteur++] = numfa, face_tab(numfa) = 1;
<a name="l00350"></a>00350                     }
<a name="l00351"></a>00351                 }
<a name="l00352"></a>00352             }
<a name="l00353"></a>00353         }
<a name="l00354"></a>00354     }
<a name="l00355"></a>00355 
<a name="l00356"></a>00356   <span class="keywordtype">int</span> faces_found=<a class="code" href="DoubleVect_8cpp.html#a07dd5e25d47ad3892ae0fa4e997ed011">mp_somme_vect</a>(face_tab);
<a name="l00357"></a>00357   <span class="keywordflow">if</span> (faces_found==0)
<a name="l00358"></a>00358     {
<a name="l00359"></a>00359       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Perte_Charge_Singuliere::lire_surfaces&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00360"></a>00360       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;No faces has been found !&quot;</span> &lt;&lt; finl;
<a name="l00361"></a>00361       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00362"></a>00362     }
<a name="l00363"></a>00363   <span class="keywordflow">else</span>
<a name="l00364"></a>00364     <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; faces_found &lt;&lt; <span class="stringliteral">&quot; faces have been found for the section.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00365"></a>00365 
<a name="l00366"></a>00366   les_faces.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(compteur);
<a name="l00367"></a>00367   <span class="keywordflow">if</span> (orientation.non_nul())
<a name="l00368"></a>00368     {
<a name="l00369"></a>00369       sgn.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(compteur);
<a name="l00370"></a>00370       <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> xvf(compteur, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>), ori(compteur, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>);
<a name="l00371"></a>00371       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>; i++) <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; j++) xvf(i, j) = xv(les_faces(i), j);
<a name="l00372"></a>00372       orientation.valeur().valeur_aux(xvf, ori);
<a name="l00373"></a>00373       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>; i++)
<a name="l00374"></a>00374         {
<a name="l00375"></a>00375           <span class="keywordtype">double</span> scal = 0;
<a name="l00376"></a>00376           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; Objet_U::dimension; j++) scal += ori(i, j) * zvf.<a class="code" href="classZone__VF.html#a547ab50904dc51bee39fed54a20934b2">face_normales</a>(les_faces(i), j);
<a name="l00377"></a>00377           <a class="code" href="Op__Conv__Muscl__old__VEF__Face_8cpp.html#ae1b5a554c1d4d97654c06032a92f800a">sgn</a>(i) = (scal &gt; 0 ? 1 : -1);
<a name="l00378"></a>00378         }
<a name="l00379"></a>00379     }
<a name="l00380"></a>00380 }
<a name="l00381"></a>00381 
<a name="l00382"></a><a class="code" href="classPerte__Charge__Singuliere.html#a6b86b1caad93e60bb9143e70148b5f80">00382</a> <span class="keywordtype">double</span> <a class="code" href="classPerte__Charge__Singuliere.html#a6b86b1caad93e60bb9143e70148b5f80">Perte_Charge_Singuliere::calculate_Q</a>(<span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn, <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; num_faces, <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; <a class="code" href="Op__Conv__Muscl__old__VEF__Face_8cpp.html#ae1b5a554c1d4d97654c06032a92f800a">sgn</a>)<span class="keyword"> const</span>
<a name="l00383"></a>00383 <span class="keyword"></span>{
<a name="l00384"></a>00384   <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zvf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, eqn.<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>());
<a name="l00385"></a>00385   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit = eqn.<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(),
<a name="l00386"></a>00386                    &amp;fac = <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPb__Multiphase.html" title="classe Pb_Multiphase Cette classe represente un probleme de thermohydraulique multiphase de type &quot;3*...">Pb_Multiphase</a>, eqn.<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>()) ? <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPb__Multiphase.html" title="classe Pb_Multiphase Cette classe represente un probleme de thermohydraulique multiphase de type &quot;3*...">Pb_Multiphase</a>, eqn.<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>()).eq_masse.champ_conserve().passe()
<a name="l00387"></a>00387                           : eqn.<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acc8deeeb73b31eaa3d0ecd4f9644ba77">get_champ</a>(<span class="stringliteral">&quot;masse_volumique&quot;</span>).<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>(); <span class="comment">//!&lt; get_champ pour flica5 car la masse volumique n&#39;est pas dans le milieu...</span>
<a name="l00388"></a>00388 <span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; pf = zvf.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>(), &amp;fs = zvf.<a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>();
<a name="l00389"></a>00389   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; f_e = zvf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00390"></a>00390   <span class="keywordtype">int</span> cF = fac.dimension_tot(0) == 1, i, n, N = fac.line_size(), d, D = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> deb_vect;
<a name="l00393"></a>00393   zvf.<a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(deb_vect); <span class="comment">//pour bien sommer les debits en parallele</span>
<a name="l00394"></a>00394   <span class="keywordflow">for</span> (i = 0; i &lt; num_faces.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>(); i++)
<a name="l00395"></a>00395     {
<a name="l00396"></a>00396       <span class="keywordtype">int</span> f = num_faces(i), e = f_e(f, f_e(f, 0) &lt; 0); <span class="comment">//todo : evaluer fac du bon cote</span>
<a name="l00397"></a>00397       <span class="keywordflow">if</span> (vit.line_size() &gt; N) <span class="keywordflow">for</span> (d = 0; d &lt; D; d++) <span class="keywordflow">for</span> (n = 0; n &lt; N; n++) deb_vect(f) += zvf.<a class="code" href="classZone__VF.html#a547ab50904dc51bee39fed54a20934b2">face_normales</a>(f, d) * vit(f, N * d + n) * fac(!cF * e, n); <span class="comment">//vecteur complet : v . nf</span>
<a name="l00398"></a>00398       <span class="keywordflow">else</span> <span class="keywordflow">for</span> (n = 0; n &lt; N; n++) deb_vect(f) += fs(f) * vit(f, n) * fac(!cF * e, n); <span class="comment">//normale aux faces seule</span>
<a name="l00399"></a>00399       deb_vect(f) *= pf(f) * (sgn.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>() ? <a class="code" href="Op__Conv__Muscl__old__VEF__Face_8cpp.html#ae1b5a554c1d4d97654c06032a92f800a">sgn</a>(i) : deb_vect(f) &gt; 0 ? 1 : -1) ; <span class="comment">//produit par la porosite + orientation (si elle n&#39;est pas definie, on compte tout en positif)</span>
<a name="l00400"></a>00400     }
<a name="l00401"></a>00401   <span class="keywordflow">return</span> <a class="code" href="DoubleVect_8cpp.html#a07dd5e25d47ad3892ae0fa4e997ed011">mp_somme_vect</a>(deb_vect);
<a name="l00402"></a>00402 }
<a name="l00403"></a>00403 
<a name="l00404"></a><a class="code" href="classPerte__Charge__Singuliere.html#a1bef4417d1f467e8377b54d57ecb01ac">00404</a> <span class="keywordtype">void</span> <a class="code" href="classPerte__Charge__Singuliere.html#a1bef4417d1f467e8377b54d57ecb01ac">Perte_Charge_Singuliere::update_K</a>(<span class="keyword">const</span> <a class="code" href="classEquation__base.html">Equation_base</a>&amp; eqn, <span class="keywordtype">double</span> deb, <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; bilan)
<a name="l00405"></a>00405 {
<a name="l00406"></a>00406   <span class="keywordflow">if</span> (!<a class="code" href="classPerte__Charge__Singuliere.html#a036910a1edb3b5e13a16071cc7c4211e">regul_</a>) <span class="keywordflow">return</span>;
<a name="l00407"></a>00407   <span class="keywordtype">double</span> t = eqn.<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>(), dt = eqn.<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l00408"></a>00408   <a class="code" href="classPerte__Charge__Singuliere.html#acb6602b31e6bdb514583b5f50e770d21">deb_cible_</a>.<a class="code" href="classParser__U.html#a13c377b32b6c3ced39a14f83f94a8828">setVar</a>(0, t), <a class="code" href="classPerte__Charge__Singuliere.html#a28f54fe2cfaad225aa3216315ed40d25">eps_</a>.<a class="code" href="classParser__U.html#a13c377b32b6c3ced39a14f83f94a8828">setVar</a>(0, t);
<a name="l00409"></a>00409   <span class="keywordtype">double</span> deb_cible = <a class="code" href="classPerte__Charge__Singuliere.html#acb6602b31e6bdb514583b5f50e770d21">deb_cible_</a>.<a class="code" href="classParser__U.html#a61605bc1b85e466f884f1739e811b6b4">eval</a>(), eps = <a class="code" href="classPerte__Charge__Singuliere.html#a28f54fe2cfaad225aa3216315ed40d25">eps_</a>.<a class="code" href="classParser__U.html#a61605bc1b85e466f884f1739e811b6b4">eval</a>(), f_min = std::pow(1 - eps, dt), f_max = std::pow(1 + eps, dt); <span class="comment">//bande de variation de K</span>
<a name="l00410"></a>00410   <a class="code" href="classPerte__Charge__Singuliere.html#aed3c4c0e855ea65d7f5afd0fcdbeabc2">K_</a> *= <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(<a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(std::pow(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(deb) / deb_cible, 2), f_min), f_max);
<a name="l00411"></a>00411 
<a name="l00412"></a>00412 <span class="comment">// pour le fichier de suivi : seulement sur le maitre, car Source_base::imprimer() fait une somme sur les procs</span>
<a name="l00413"></a>00413   <span class="keywordflow">if</span> (!<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>()) bilan(0) = <a class="code" href="classPerte__Charge__Singuliere.html#aed3c4c0e855ea65d7f5afd0fcdbeabc2">K_</a>, bilan(1) = deb, bilan(2) = deb_cible;
<a name="l00414"></a>00414 }
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:35 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
