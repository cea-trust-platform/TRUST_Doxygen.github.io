<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: Navier_Stokes_Fluide_Dilatable_Proto Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">Navier_Stokes_Fluide_Dilatable_Proto Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Navier_Stokes_Fluide_Dilatable_Proto" -->
<p>classe <a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html" title="classe Navier_Stokes_Fluide_Dilatable_Proto">Navier_Stokes_Fluide_Dilatable_Proto</a>  
 <a href="classNavier__Stokes__Fluide__Dilatable__Proto.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html">Navier_Stokes_Fluide_Dilatable_Proto.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Navier_Stokes_Fluide_Dilatable_Proto:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classNavier__Stokes__Fluide__Dilatable__Proto.png" usemap="#Navier_Stokes_Fluide_Dilatable_Proto_map" alt=""/>
  <map id="Navier_Stokes_Fluide_Dilatable_Proto_map" name="Navier_Stokes_Fluide_Dilatable_Proto_map">
<area href="classNavier__Stokes__Fluide__Dilatable__base.html" title="classe Navier_Stokes_Fluide_Dilatable_base Cette classe basse porte les termes de l&#39;equation de la dy..." alt="Navier_Stokes_Fluide_Dilatable_base" shape="rect" coords="119,56,348,80"/>
<area href="classNavier__Stokes__QC.html" title="classe Navier_Stokes_QC Cette classe porte les termes de l&#39;equation de la dynamique pour un fluide sa..." alt="Navier_Stokes_QC" shape="rect" coords="0,112,229,136"/>
<area href="classNavier__Stokes__WC.html" title="classe Navier_Stokes_WC Cette classe porte les termes de l&#39;equation de la dynamique pour un fluide sa..." alt="Navier_Stokes_WC" shape="rect" coords="239,112,468,136"/>
</map>
 </div></div>

<p><a href="classNavier__Stokes__Fluide__Dilatable__Proto-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#a81f29a2ce2cf16fe45786c5ba146f5d5">Navier_Stokes_Fluide_Dilatable_Proto</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#af931eee109bd785a2bf96957532fe2f3">impr_impl</a> (const <a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;eqn, <a class="el" href="classSortie.html">Sortie</a> &amp;os) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ae965269c96ba2459cdff24ea699ee641">assembler_impl</a> (<a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;mat_morse, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;present, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;secmem)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#a11534759c877a66e685dfa93eec9643e">assembler_avec_inertie_impl</a> (const <a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;eqn, <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;mat_morse, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;present, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;secmem)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#a9ce8625c558441d2f7221dd7eb8e6062">derivee_en_temps_inco_impl</a> (<a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;res)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calcule la derivee en temps de l'inconnue vitesse,<br/>
i.e. l'acceleration dU/dt et la renvoie.<br/>
Appelle <a class="el" href="classEquation__base.html#a97aa87b0cf6205ef437a6774adf1bd47" title="Returns the time derivative of the unknown I of the equation: dI/dt = M-1*(sum(operators(I) + sources...">Equation_base::derivee_en_temps_inco</a>(<a class="el" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; )<br/>
Calcule egalement la pression.  <a href="#a9ce8625c558441d2f7221dd7eb8e6062"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ad7b9506e7bda4dbde7ce4e4edca71298">rho_vitesse_impl</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;tab_rho, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;vit, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;rhovitesse) const </td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classChamp__Inc.html">Champ_Inc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#a81a0cab61b51f45b90ad6006ea2fdc53">rho_la_vitesse_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntVect.html">IntVect</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#acca173f86d33011d9eb6be9017c09b56">orientation_VDF_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ab224b13eb4a2fa008b3ba02e314db03c">tab_W</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">RHS of div(rho.U)  <a href="#ab224b13eb4a2fa008b3ba02e314db03c"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#aa5039c9c3c958b1fc4cb8facddf543a4">prepare_and_solve_u_star</a> (<a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;eqn, const <a class="el" href="classFluide__Dilatable__base.html">Fluide_Dilatable_base</a> &amp;fluide_dil, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;rhoU, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;vpoint)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ae6ca864f68a9e973a487ab3ec5396374">update_vpoint_on_boundaries</a> (const <a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;eqn, const <a class="el" href="classFluide__Dilatable__base.html">Fluide_Dilatable_base</a> &amp;fluide_dil, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;vpoint)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#a80fc279cfb275b0fce12a8110906a14b">solve_pressure_increment</a> (<a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;eqn, const <a class="el" href="classFluide__Dilatable__base.html">Fluide_Dilatable_base</a> &amp;fluide_dil, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;rhoU, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;secmem, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;inc_pre, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;vpoint)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#a9ba1bb0772471d97f38b08efceea4aa8">correct_and_compute_u_np1</a> (<a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;eqn, const <a class="el" href="classFluide__Dilatable__base.html">Fluide_Dilatable_base</a> &amp;fluide_dil, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;rhoU, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;Mmoins1grad, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;inc_pre, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;gradP, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;vpoint)</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ac294b3e6fc88a751ac14ac3547d5668b">cumulative_</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>classe <a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html" title="classe Navier_Stokes_Fluide_Dilatable_Proto">Navier_Stokes_Fluide_Dilatable_Proto</a> </p>

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html#l00042">42</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html">Navier_Stokes_Fluide_Dilatable_Proto.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a81f29a2ce2cf16fe45786c5ba146f5d5"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::Navier_Stokes_Fluide_Dilatable_Proto" ref="a81f29a2ce2cf16fe45786c5ba146f5d5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Navier_Stokes_Fluide_Dilatable_Proto::Navier_Stokes_Fluide_Dilatable_Proto </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00035">35</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html">Navier_Stokes_Fluide_Dilatable_Proto.cpp</a>.</p>
<div class="fragment"><pre class="fragment">: <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ac294b3e6fc88a751ac14ac3547d5668b">cumulative_</a>(0) { }
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a11534759c877a66e685dfa93eec9643e"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::assembler_avec_inertie_impl" ref="a11534759c877a66e685dfa93eec9643e" args="(const Navier_Stokes_std &amp;eqn, Matrice_Morse &amp;mat_morse, const DoubleTab &amp;present, DoubleTab &amp;secmem)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Navier_Stokes_Fluide_Dilatable_Proto::assembler_avec_inertie_impl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;&#160;</td>
          <td class="paramname"><em>eqn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>mat_morse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>present</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>secmem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; rho*U </p>
</p>

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00169">169</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html">Navier_Stokes_Fluide_Dilatable_Proto.cpp</a>.</p>

<p>References <a class="el" href="Sources_8cpp_source.html#l00132">Sources::ajouter()</a>, <a class="el" href="classOperateur.html#accdf61cf1e33fb42e9eb06f1c501422b">Operateur::ajouter()</a>, <a class="el" href="Solveur__Masse_8h_source.html#l00153">Solveur_Masse::ajouter_masse()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00230">Matrice_Base::ajouter_multvect()</a>, <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Sources_8cpp_source.html#l00307">Sources::contribuer_a_avec()</a>, <a class="el" href="Operateur__base_8cpp_source.html#l00336">Operateur_base::contribuer_a_avec()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Cond__lim__base_8h_source.html#l00123">Cond_lim_base::frontiere_dis()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00129">Matrice_Morse::get_set_coeff()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00134">Matrice_Morse::get_tab1()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00138">Matrice_Morse::get_tab2()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l00748">Navier_Stokes_std::inconnue()</a>, <a class="el" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">Operateur::l_op_base()</a>, <a class="el" href="Zone__Cl__dis_8h_source.html#l00130">Zone_Cl_dis::les_conditions_limites()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l01695">Navier_Stokes_std::milieu()</a>, <a class="el" href="Operateur__base_8cpp_source.html#l00291">Operateur_base::modifier_pour_Cl()</a>, <a class="el" href="Front__VF_8h_source.html#l00061">Front_VF::nb_faces()</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00099">Matrice_Morse::nb_lignes()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l00532">Navier_Stokes_std::nombre_d_operateurs()</a>, <a class="el" href="Front__VF_8h_source.html#l00071">Front_VF::num_premiere_face()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l00560">Navier_Stokes_std::operateur()</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00576">Schema_Temps_base::pas_de_temps()</a>, <a class="el" href="Champ__Inc_8cpp_source.html#l00370">Champ_Inc::passe()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00062">ref_cast_non_const</a>, <a class="el" href="Fluide__Dilatable__base_8h_source.html#l00121">Fluide_Dilatable_base::rho_face_n()</a>, <a class="el" href="Fluide__Dilatable__base_8h_source.html#l00122">Fluide_Dilatable_base::rho_face_np1()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00038">rho_vitesse_impl()</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="vect__impl_8h_source.html#l00057">vect_impl::size()</a>, <a class="el" href="Equation__base_8h_source.html#l00432">Equation_base::solv_masse()</a>, <a class="el" href="Equation__base_8cpp_source.html#l00578">Equation_base::sources()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, and <a class="el" href="Equation__base_8h_source.html#l00391">Equation_base::zone_Cl_dis()</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__base_8cpp_source.html#l00164">Navier_Stokes_Fluide_Dilatable_base::assembler_avec_inertie()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// ******   avant inertie   ******</span>
<span class="comment">// diffusion en div(mu grad u ) or on veut impliciter en rho * u =&gt; on divise les contributions par le rho_face associe</span>
<span class="comment">// GF on ajoute apres avoir contribuer pour avoir les bons flux bords</span>
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> rhovitesse(present);

<span class="comment">// Op diff</span>
  eqn.<a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df" title="Renvoie le i-eme operateur de l&#39;equation: - le terme_diffusif si i = 0 - le terme_convectif si i = 1 ...">operateur</a>(0).<a class="code" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">l_op_base</a>().<a class="code" href="classOperateur__base.html#a903e728aad8e2d490580bf264319d65f" title="NE FAIT RIEN A surcharger dans les classes derivees.">contribuer_a_avec</a>(present,mat_morse);
  eqn.<a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df" title="Renvoie le i-eme operateur de l&#39;equation: - le terme_diffusif si i = 0 - le terme_convectif si i = 1 ...">operateur</a>(0).<a class="code" href="classOperateur.html#accdf61cf1e33fb42e9eb06f1c501422b">ajouter</a>(secmem);

  <span class="keyword">const</span> <a class="code" href="classFluide__Dilatable__base.html" title="classe Fluide_Dilatable_base Cette classe represente un d&#39;un fluide dilatable, heritant de fluide bas...">Fluide_Dilatable_base</a>&amp; fluide_dil=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFluide__Dilatable__base.html" title="classe Fluide_Dilatable_base Cette classe represente un d&#39;un fluide dilatable, heritant de fluide bas...">Fluide_Dilatable_base</a>,eqn.<a class="code" href="classNavier__Stokes__std.html#a442d8f1138c18da07aa895728b3e41f2" title="Renvoie le milieu physique de l&#39;equation (le Fluide_base upcaste en Milieu_base)">milieu</a>());
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_rho_face_np1 = fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#a29eacbad70e5894523fd7709d762dcf2">rho_face_np1</a>(), tab_rho_face_n=fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#ae1cc5ec1ca08dc3269b171143ad3df39">rho_face_n</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_compo = present.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
  <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1 = mat_morse.<a class="code" href="classMatrice__Morse.html#a79b4e334152850bd36e53478debf3061">get_tab1</a>(), tab2 = mat_morse.<a class="code" href="classMatrice__Morse.html#a787b5a63f27063f9c891243d8f188cda">get_tab2</a>();

  <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = mat_morse.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;mat_morse.<a class="code" href="classMatrice__Morse.html#a1f9bd6aedb226c86b7299689fa5b821a">nb_lignes</a>(); i++)
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=tab1(i)-1; k&lt;tab1(i+1)-1; k++)
      {
        <span class="keywordtype">int</span> j = tab2(k)-1;
        <span class="keywordtype">double</span> rapport = tab_rho_face_np1(j/nb_compo);
        <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(k) /= rapport;
      }

  <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ad7b9506e7bda4dbde7ce4e4edca71298">rho_vitesse_impl</a>(tab_rho_face_np1,present,rhovitesse); <span class="comment">//!&lt; rho*U</span>
<span class="comment"></span>
<span class="comment">// Op conv</span>
  eqn.<a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df" title="Renvoie le i-eme operateur de l&#39;equation: - le terme_diffusif si i = 0 - le terme_convectif si i = 1 ...">operateur</a>(1).<a class="code" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">l_op_base</a>().<a class="code" href="classOperateur__base.html#a903e728aad8e2d490580bf264319d65f" title="NE FAIT RIEN A surcharger dans les classes derivees.">contribuer_a_avec</a>(rhovitesse,mat_morse);
  eqn.<a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df" title="Renvoie le i-eme operateur de l&#39;equation: - le terme_diffusif si i = 0 - le terme_convectif si i = 1 ...">operateur</a>(1).<a class="code" href="classOperateur.html#accdf61cf1e33fb42e9eb06f1c501422b">ajouter</a>(rhovitesse,secmem);

<span class="comment">// sources</span>
  eqn.<a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>().<a class="code" href="classSources.html#a6fc277f1920a71841cb041dc1b6ed771" title="Ajoute la contribution de toutes les sources de la liste au tableau passe en parametre, et renvoie ce tableau.">ajouter</a>(secmem);
  eqn.<a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>().<a class="code" href="classSources.html#aa91bceeb92650bc8b60a94f193a9d689" title="contribution a la matrice implicite des termes sources par defaut pas de contribution">contribuer_a_avec</a>(present,mat_morse);

<span class="comment">// on resout en rho u on stocke donc rho u dans present</span>
  <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ad7b9506e7bda4dbde7ce4e4edca71298">rho_vitesse_impl</a>(tab_rho_face_np1,present,<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>,present));
  mat_morse.<a class="code" href="classMatrice__Base.html#a6ccb4d20d3877cf09f5178ff72af5406" title="Operation de multiplication-accumulation (saxpy) matrice vecteur. Operation: r = r + A*x...">ajouter_multvect</a>(present,secmem);

  <span class="comment">/*</span>
<span class="comment">   * contribution a la matrice de l&#39;inertie :</span>
<span class="comment">   * on divisie la diagonale par rhon+1 face</span>
<span class="comment">   * on ajoute l&#39;inertie de facon standard</span>
<span class="comment">   * on remultiplie la diagonale par rhon+1</span>
<span class="comment">   */</span>

<span class="comment">// ajout de l&#39;inertie</span>
  <span class="keyword">const</span> <span class="keywordtype">double</span> dt=eqn.<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
  eqn.<a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#adc554d2f7efe81e71ff8995d4f2df8c7">ajouter_masse</a>(dt,mat_morse,0);

  <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ad7b9506e7bda4dbde7ce4e4edca71298">rho_vitesse_impl</a>(tab_rho_face_n,eqn.<a class="code" href="classNavier__Stokes__std.html#a743b777e6185faee7837326844c8fca1" title="Renvoie la vitesse (champ inconnue de l&#39;equation) (version const)">inconnue</a>().<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>(),rhovitesse);
  eqn.<a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#adc554d2f7efe81e71ff8995d4f2df8c7">ajouter_masse</a>(dt,secmem,rhovitesse,0);

<span class="comment">// blocage_cl faux si dirichlet u!=0 !!!!!! manque multiplication par rho</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> op=0; op&lt; eqn.<a class="code" href="classNavier__Stokes__std.html#ac7db452db8cfdb5f15bf971a47df82f1" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: Pour Navier Stokes Standard c&#39;est 2.">nombre_d_operateurs</a>(); op++) eqn.<a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df" title="Renvoie le i-eme operateur de l&#39;equation: - le terme_diffusif si i = 0 - le terme_convectif si i = 1 ...">operateur</a>(op).<a class="code" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">l_op_base</a>().<a class="code" href="classOperateur__base.html#a119798b1efa7c62fb28a53c20ccd105c" title="NE FAIT RIEN A surcharger dans les classes derivees.">modifier_pour_Cl</a>(mat_morse,secmem);

  <span class="comment">/*</span>
<span class="comment">   * correction finale pour les dirichlets</span>
<span class="comment">   * on ne doit pas imposer un+1 mais rho_un+1 =&gt; on multiplie dons le resu par rho_face_np1</span>
<span class="comment">   */</span>
  <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; lescl=eqn.<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classZone__Cl__dis.html#aafbd0525703e23200e31796bcd4fcac6" title="Appel a l&#39;objet sous-jacent Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>();
  <span class="keywordtype">int</span> nbcondlim=lescl.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>();

  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl=0; icl&lt;nbcondlim; icl++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim__base.html" title="classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...">Cond_lim_base</a>&amp; la_cl_base = lescl[icl].valeur();
      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl_base))
        {

          <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; la_front_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl_base.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
          <span class="keywordtype">int</span> ndeb = la_front_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
          <span class="keywordtype">int</span> nfin = ndeb + la_front_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=ndeb; num_face&lt;nfin; num_face++)
            {
              <span class="keywordflow">if</span> (present.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>()==1) secmem(num_face)*=tab_rho_face_np1(num_face);
              <span class="keywordflow">else</span>
                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir=0; dir&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; dir++) secmem(num_face,dir)*=tab_rho_face_np1(num_face);
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae965269c96ba2459cdff24ea699ee641"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::assembler_impl" ref="ae965269c96ba2459cdff24ea699ee641" args="(Matrice_Morse &amp;mat_morse, const DoubleTab &amp;present, DoubleTab &amp;secmem)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Navier_Stokes_Fluide_Dilatable_Proto::assembler_impl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>mat_morse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>present</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>secmem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00252">252</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html">Navier_Stokes_Fluide_Dilatable_Proto.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, and <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__base_8cpp_source.html#l00159">Navier_Stokes_Fluide_Dilatable_base::assembler()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Navier_Stokes_Fluide_Dilatable_Proto::assembler is not coded ! You should use assembler_avec_inertie !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9ba1bb0772471d97f38b08efceea4aa8"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::correct_and_compute_u_np1" ref="a9ba1bb0772471d97f38b08efceea4aa8" args="(Navier_Stokes_std &amp;eqn, const Fluide_Dilatable_base &amp;fluide_dil, DoubleTab &amp;rhoU, DoubleTab &amp;Mmoins1grad, DoubleTab &amp;inc_pre, DoubleTab &amp;gradP, DoubleTab &amp;vpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Navier_Stokes_Fluide_Dilatable_Proto::correct_and_compute_u_np1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;&#160;</td>
          <td class="paramname"><em>eqn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classFluide__Dilatable__base.html">Fluide_Dilatable_base</a> &amp;&#160;</td>
          <td class="paramname"><em>fluide_dil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>rhoU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Mmoins1grad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>inc_pre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>gradP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; M-1 F</p>
<p>&lt; rhoU(n+1) </p>
</p>

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00445">445</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html">Navier_Stokes_Fluide_Dilatable_Proto.cpp</a>.</p>

<p>References <a class="el" href="Solveur__Masse_8h_source.html#l00087">Solveur_Masse::appliquer()</a>, <a class="el" href="Navier__Stokes__std_8h_source.html#l00344">Navier_Stokes_std::assembleur_pression()</a>, <a class="el" href="Operateur__Grad_8cpp_source.html#l00157">Operateur_Grad::calculer()</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Assembleur_8cpp_source.html#l00248">Assembleur::modifier_solution()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l00706">Navier_Stokes_std::operateur_gradient()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00999">operator_add()</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00576">Schema_Temps_base::pas_de_temps()</a>, <a class="el" href="Navier__Stokes__std_8h_source.html#l00268">Navier_Stokes_std::pression()</a>, <a class="el" href="Fluide__Dilatable__base_8h_source.html#l00122">Fluide_Dilatable_base::rho_face_np1()</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="Equation__base_8h_source.html#l00432">Equation_base::solv_masse()</a>, <a class="el" href="Champ__Inc_8cpp_source.html#l00245">Champ_Inc::valeurs()</a>, <a class="el" href="MD__Vector_8h_source.html#l00033">VECT_ALL_ITEMS</a>, <a class="el" href="Op__Div__VEFP1B__Elem_8cpp_source.html#l00081">verifier()</a>, and <a class="el" href="Navier__Stokes__std_8h_source.html#l00329">Navier_Stokes_std::vitesse()</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00121">derivee_en_temps_inco_impl()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_rho_face_np1=fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#a29eacbad70e5894523fd7709d762dcf2">rho_face_np1</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit = eqn.<a class="code" href="classNavier__Stokes__std.html#ab831017616b67792f562fea81f1e5dce">vitesse</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; press = eqn.<a class="code" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a" title="Renvoie le champ de pression.">pression</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
  <span class="keyword">const</span> <span class="keywordtype">double</span> dt_ = eqn.<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();

<span class="comment">// On a besoin de l&#39;espace virtuel de la pression pour calculer le gradient plus bas</span>
<span class="comment">// et modifier_solution ne fait pas toujours l&#39;echange_espace_virtuel.</span>
<span class="comment">// On suppose que pression et inc_pre ont leur espace virtuel a jour</span>
<span class="comment">// On fait pression += inc_pre:</span>
  <a class="code" href="DoubleVect_8cpp.html#a9dd7edead35e9d46fc6c8960f33e668a">operator_add</a>(press, inc_pre, <a class="code" href="MD__Vector_8h.html#a3616a15fe105ad6150819554ee8b11caad18680091a9f62247573cb3caa6450b9">VECT_ALL_ITEMS</a>);
  eqn.<a class="code" href="classNavier__Stokes__std.html#af9f5e0396945755597f147bd424a4a08">assembleur_pression</a>().<a class="code" href="classAssembleur.html#ac7b804a7151f761f15395e67aa8fd024" title="Appel a l&#39;objet sous-jacent. Permet de modifier la pression.">modifier_solution</a>(press);

<span class="comment">// Correction de la vitesse en pression : M-1 Bt P</span>
  eqn.<a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(gradP);
  vpoint += gradP; <span class="comment">//!&lt; M-1 F</span>
<span class="comment"></span>
  press.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
  eqn.<a class="code" href="classNavier__Stokes__std.html#a840295836fce939b7861f1353da595ff" title="Renvoie l&#39;operateur de calcul du gradient associe a l&#39;equation.">operateur_gradient</a>().<a class="code" href="classOperateur__Grad.html#a179b2f08f6907e9b69fa715cfb98fa81" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(press, gradP);

<span class="comment">// On conserve Bt P pour la prochaine fois.</span>
  Mmoins1grad = gradP;
  eqn.<a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(Mmoins1grad);

<span class="comment">// Correction en pression</span>
  vpoint -= Mmoins1grad;

<span class="comment">// vpoint = (rhoU(n+1)-rhoU(n))/dt</span>
  vpoint *= dt_;
  vpoint += rhoU; <span class="comment">//!&lt; rhoU(n+1)</span>
<span class="comment"></span>
<span class="comment">// Compute U(n+1):</span>
  <span class="keyword">const</span> <span class="keywordtype">int</span> n = vpoint.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0), ncomp = vpoint.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;n ; i++)
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0 ; j&lt; ncomp; j++) vpoint(i,j) /= tab_rho_face_np1(i);

<span class="comment">// Compute (U(n+1)-U(n))/dt :</span>
  vpoint -= vit;
  vpoint /= dt_;

  vpoint.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
  <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;Navier_Stokes_Fluide_Dilatable_base::derivee_en_temps_inco, vpoint : &quot;</span>, vpoint);

} <span class="comment">/* END correct_and_compute_u_np1 */</span>
</pre></div>
</div>
</div>
<a class="anchor" id="a9ce8625c558441d2f7221dd7eb8e6062"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::derivee_en_temps_inco_impl" ref="a9ce8625c558441d2f7221dd7eb8e6062" args="(Navier_Stokes_std &amp;, DoubleTab &amp;res)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Navier_Stokes_Fluide_Dilatable_Proto::derivee_en_temps_inco_impl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;&#160;</td>
          <td class="paramname"><em>eqn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calcule la derivee en temps de l'inconnue vitesse,<br/>
i.e. l'acceleration dU/dt et la renvoie.<br/>
Appelle <a class="el" href="classEquation__base.html#a97aa87b0cf6205ef437a6774adf1bd47" title="Returns the time derivative of the unknown I of the equation: dI/dt = M-1*(sum(operators(I) + sources...">Equation_base::derivee_en_temps_inco</a>(<a class="el" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; )<br/>
Calcule egalement la pression. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp;<br/>
 Signification: le tableau des valeurs de l'acceleration (derivee de la vitesse)<br/>
 Contraintes: </dd></dl>

<p><p>&lt; copie la structure initialisation sinon plantage assert lors du remplissage dans EDO_Pression_th_VEF::secmembre_divU_Z_VEFP1B</p>
<p>&lt; copie la structure </p>
</p>

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00121">121</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html">Navier_Stokes_Fluide_Dilatable_Proto.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00466">DoubleTab::copy()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00445">correct_and_compute_u_np1()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l01854">Navier_Stokes_std::get_champ()</a>, <a class="el" href="DoubleVect_8h_source.html#l00101">DoubleVect::get_md_vector()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l01695">Navier_Stokes_std::milieu()</a>, <a class="el" href="Array__base_8h_source.html#l00038">Array_base::NOCOPY_NOINIT</a>, <a class="el" href="MD__Vector_8h_source.html#l00063">MD_Vector::non_nul()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00263">prepare_and_solve_u_star()</a>, <a class="el" href="Navier__Stokes__std_8h_source.html#l00268">Navier_Stokes_std::pression()</a>, <a class="el" href="Ref_8h_source.html#l00026">REF</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00397">solve_pressure_increment()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html#l00055">tab_W</a>, <a class="el" href="Champ__Inc_8cpp_source.html#l00245">Champ_Inc::valeurs()</a>, and <a class="el" href="Navier__Stokes__std_8h_source.html#l00329">Navier_Stokes_std::vitesse()</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__base_8cpp_source.html#l00154">Navier_Stokes_Fluide_Dilatable_base::derivee_en_temps_inco()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classFluide__Dilatable__base.html" title="classe Fluide_Dilatable_base Cette classe represente un d&#39;un fluide dilatable, heritant de fluide bas...">Fluide_Dilatable_base</a>&amp; fluide_dil=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFluide__Dilatable__base.html" title="classe Fluide_Dilatable_base Cette classe represente un d&#39;un fluide dilatable, heritant de fluide bas...">Fluide_Dilatable_base</a>,eqn.<a class="code" href="classNavier__Stokes__std.html#a442d8f1138c18da07aa895728b3e41f2" title="Renvoie le milieu physique de l&#39;equation (le Fluide_base upcaste en Milieu_base)">milieu</a>());
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; press = eqn.<a class="code" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a" title="Renvoie le champ de pression.">pression</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(), vit = eqn.<a class="code" href="classNavier__Stokes__std.html#ab831017616b67792f562fea81f1e5dce">vitesse</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> secmem(press);
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> inc_pre(press);

  <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ab224b13eb4a2fa008b3ba02e314db03c" title="RHS of div(rho.U)">tab_W</a>.<a class="code" href="classDoubleVect.html#a0d16d30580c90526e4895388fb44be5d">get_md_vector</a>().<a class="code" href="classMD__Vector.html#a4165c00904b7096274e38fdc7ca340f4">non_nul</a>())
    {
      <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ab224b13eb4a2fa008b3ba02e314db03c" title="RHS of div(rho.U)">tab_W</a>.<a class="code" href="classDoubleTab.html#aa4dd124734ab5d6cb7aa93a104c0868e">copy</a>(secmem, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>); <span class="comment">//!&lt; copie la structure initialisation sinon plantage assert lors du remplissage dans EDO_Pression_th_VEF::secmembre_divU_Z_VEFP1B</span>
<span class="comment"></span><span class="comment">//</span>
      <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ab224b13eb4a2fa008b3ba02e314db03c" title="RHS of div(rho.U)">tab_W</a> = 0.;
    }

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> rhoU;
  rhoU.<a class="code" href="classDoubleTab.html#aa4dd124734ab5d6cb7aa93a104c0868e">copy</a>(vit, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>); <span class="comment">//!&lt; copie la structure</span>
<span class="comment"></span>
<span class="comment">// Get champ gradP</span>
  <a class="code" href="Ref_8h.html#aab5720a5c34da14028d0745e386aaa01">REF</a>(<a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>) gradient_pression;

  try
    {
      gradient_pression = eqn.<a class="code" href="classNavier__Stokes__std.html#a18eccb9461a019135740a00f5e3dbec1">get_champ</a>(<span class="stringliteral">&quot;gradient_pression&quot;</span>);
    }
  <span class="keywordflow">catch</span> (<a class="code" href="classChamps__compris__erreur.html">Champs_compris_erreur</a>)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; l&#39;equation ne comprend pas gradient_pression &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; gradP=gradient_pression.valeur().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> Mmoins1grad(gradP);

<span class="comment">// We use the incremental pressure-projection algorithm (Chorin)</span>

<span class="comment">// Step 1 : prepare operators and solve for a provisional velocity u*</span>
  <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#aa5039c9c3c958b1fc4cb8facddf543a4">prepare_and_solve_u_star</a>(eqn,fluide_dil,rhoU, vpoint);

<span class="comment">// Step 2 : solve the poisson equation for the pressure increment (Pi = P^n+1 - P^n)</span>
<span class="comment">// Attention the matrix has a constant coefficient as the variable of NS is rhoU and not U !!!</span>
  <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#a80fc279cfb275b0fce12a8110906a14b">solve_pressure_increment</a>(eqn,fluide_dil,rhoU,secmem,inc_pre,vpoint);

<span class="comment">// Step 3 : compute P^n+1 &amp; compute the correct velocity u^n+1</span>
  <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#a9ba1bb0772471d97f38b08efceea4aa8">correct_and_compute_u_np1</a>(eqn,fluide_dil,rhoU,Mmoins1grad,inc_pre,gradP,vpoint);

  <span class="keywordflow">return</span> vpoint;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af931eee109bd785a2bf96957532fe2f3"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::impr_impl" ref="af931eee109bd785a2bf96957532fe2f3" args="(const Navier_Stokes_std &amp;eqn, Sortie &amp;os) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Navier_Stokes_Fluide_Dilatable_Proto::impr_impl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;&#160;</td>
          <td class="paramname"><em>eqn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>os</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; init structure uniquement</p>
<p>&lt; max|sum(rho*u*ndS)|</p>
<p>&lt; =max|LocalMassFlowRateError/(rho_moyen*Vol(i)/dt)| </p>
</p>

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00050">50</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html">Navier_Stokes_Fluide_Dilatable_Proto.cpp</a>.</p>

<p>References <a class="el" href="Operateur__Div_8cpp_source.html#l00119">Operateur_Div::ajouter()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00466">DoubleTab::copy()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html#l00058">cumulative_</a>, <a class="el" href="Navier__Stokes__std_8h_source.html#l00348">Navier_Stokes_std::div()</a>, <a class="el" href="Probleme__base_8cpp_source.html#l01393">Probleme_base::domaine()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l00808">Navier_Stokes_std::fluide()</a>, <a class="el" href="DoubleVect_8h_source.html#l00101">DoubleVect::get_md_vector()</a>, <a class="el" href="Probleme__base_8h_source.html#l00295">Probleme_base::le_nom()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l02277">mp_max_abs_vect()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l02327">mp_moyenne_vect()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00597">mp_somme_vect()</a>, <a class="el" href="Array__base_8h_source.html#l00038">Array_base::NOCOPY_NOINIT</a>, <a class="el" href="MD__Vector_8h_source.html#l00063">MD_Vector::non_nul()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l00665">Navier_Stokes_std::operateur_divergence()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l01412">operator_egal()</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00576">Schema_Temps_base::pas_de_temps()</a>, <a class="el" href="Equation__base_8cpp_source.html#l00964">Equation_base::probleme()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Fluide__Dilatable__base_8h_source.html#l00122">Fluide_Dilatable_base::rho_face_np1()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00038">rho_vitesse_impl()</a>, <a class="el" href="Probleme__base_8cpp_source.html#l01342">Probleme_base::schema_temps()</a>, <a class="el" href="classFluide__Dilatable__base.html#a881172acb09944046107e7c87e8fdcaf">Fluide_Dilatable_base::secmembre_divU_Z()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html#l00055">tab_W</a>, <a class="el" href="Champ__Inc_8cpp_source.html#l00245">Champ_Inc::valeurs()</a>, <a class="el" href="Navier__Stokes__std_8h_source.html#l00329">Navier_Stokes_std::vitesse()</a>, <a class="el" href="Zone_8cpp_source.html#l01623">Zone::volume_total()</a>, <a class="el" href="Operateur__Div_8h_source.html#l00111">Operateur_Div::volumique()</a>, and <a class="el" href="Domaine_8h_source.html#l00272">Domaine::zone()</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__base_8cpp_source.html#l00042">Navier_Stokes_Fluide_Dilatable_base::impr()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classFluide__Dilatable__base.html" title="classe Fluide_Dilatable_base Cette classe represente un d&#39;un fluide dilatable, heritant de fluide bas...">Fluide_Dilatable_base</a>&amp; fluide_dil = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFluide__Dilatable__base.html" title="classe Fluide_Dilatable_base Cette classe represente un d&#39;un fluide dilatable, heritant de fluide bas...">Fluide_Dilatable_base</a>,eqn.<a class="code" href="classNavier__Stokes__std.html#a6b341590bc39e1395c14560f10d67fdb" title="Renvoie le fluide incompressible (milieu physique de l&#39;equation) associe a l&#39;equation. (version const)">fluide</a>());
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit = eqn.<a class="code" href="classNavier__Stokes__std.html#ab831017616b67792f562fea81f1e5dce">vitesse</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(), rho = fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#a29eacbad70e5894523fd7709d762dcf2">rho_face_np1</a>();
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> mass_flux(vit);
  <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ad7b9506e7bda4dbde7ce4e4edca71298">rho_vitesse_impl</a>(rho,vit,mass_flux);

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> array;
  array.<a class="code" href="classDoubleTab.html#aa4dd124734ab5d6cb7aa93a104c0868e">copy</a>(eqn.<a class="code" href="classNavier__Stokes__std.html#ad5001f4d8f41615c2963d36f703bb954">div</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(), <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>); <span class="comment">//!&lt; init structure uniquement</span>
<span class="comment"></span>  <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ab224b13eb4a2fa008b3ba02e314db03c" title="RHS of div(rho.U)">tab_W</a>.<a class="code" href="classDoubleVect.html#a0d16d30580c90526e4895388fb44be5d">get_md_vector</a>().<a class="code" href="classMD__Vector.html#a4165c00904b7096274e38fdc7ca340f4">non_nul</a>())
    {
      <a class="code" href="DoubleVect_8cpp.html#ad0e13908fed9f476adc797982dce010a">operator_egal</a>(array, <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ab224b13eb4a2fa008b3ba02e314db03c" title="RHS of div(rho.U)">tab_W</a> ); <span class="comment">//, VECT_REAL_ITEMS); //!&lt; initialise</span>
      array*=-1;
    }
  <span class="keywordflow">else</span>
    {
<span class="comment">// remarque B.M.: certaines implementations de cette methode ne font pas echange espace virtuel:</span>
      fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#a881172acb09944046107e7c87e8fdcaf">secmembre_divU_Z</a>(array);
      array*=-1;
    }

  array.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
  eqn.<a class="code" href="classNavier__Stokes__std.html#a614d41350181667ee295b87a72779c1a" title="Renvoie l&#39;operateur de calcul de la divergence associe a l&#39;equation.">operateur_divergence</a>().<a class="code" href="classOperateur__Div.html#aeb7f9d269b7d93314ce9583f0fa1f57d" title="Ajoute la contribution de l&#39;operateur au tableau passe en parametre.">ajouter</a>(mass_flux, array);
  <span class="keywordtype">double</span> LocalMassFlowRateError = <a class="code" href="DoubleVect_8cpp.html#acb21ec8c0b3909c26b20e3f3455e0289">mp_max_abs_vect</a>(array); <span class="comment">//!&lt; max|sum(rho*u*ndS)|</span>
<span class="comment"></span>
  os &lt;&lt; <span class="stringliteral">&quot;-------------------------------------------------------------------&quot;</span>&lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  os &lt;&lt; <span class="stringliteral">&quot;Cell balance mass flow rate control for the problem &quot;</span> &lt;&lt; eqn.<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a58bc0b101f3f3f1d8522a9f41f1fad7b" title="surcharge Objet_U::le_nom() Renvoie le nom du probleme">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; finl;
  os &lt;&lt; <span class="stringliteral">&quot;Absolute value : &quot;</span> &lt;&lt; LocalMassFlowRateError &lt;&lt; <span class="stringliteral">&quot; kg/s&quot;</span> &lt;&lt; finl; ;

<span class="comment">// On divise array par vol(i)</span>
  eqn.<a class="code" href="classNavier__Stokes__std.html#a614d41350181667ee295b87a72779c1a" title="Renvoie l&#39;operateur de calcul de la divergence associe a l&#39;equation.">operateur_divergence</a>().<a class="code" href="classOperateur__Div.html#ad960676e405c7d46000efccf9fa062b4" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">volumique</a>(array);

<span class="comment">// On divise par un rho moyen</span>
  <span class="keywordtype">double</span> rho_moyen = <a class="code" href="DoubleVect_8cpp.html#a71135d1749309bf589342004b76df614">mp_moyenne_vect</a>(rho), dt = eqn.<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
  <span class="keywordtype">double</span> bilan_massique_relatif = <a class="code" href="DoubleVect_8cpp.html#acb21ec8c0b3909c26b20e3f3455e0289">mp_max_abs_vect</a>(array) * dt / rho_moyen;
  os &lt;&lt; <span class="stringliteral">&quot;Relative value : &quot;</span> &lt;&lt; bilan_massique_relatif &lt;&lt; finl; <span class="comment">//!&lt; =max|LocalMassFlowRateError/(rho_moyen*Vol(i)/dt)|</span>
<span class="comment"></span>
<span class="comment">// Calculation as OpenFOAM: http://foam.sourceforge.net/docs/cpp/a04190_source.html</span>
<span class="comment">// It is relative errors (normalized by the volume/dt)</span>
  <span class="keywordtype">double</span> TotalMass = rho_moyen * eqn.<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#afa73c54a5b6b111e0f08cd1ab3608178" title="Renvoie le domaine associe au probleme. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#ab642027f7a7c19e98f906f0ae007c2b7">volume_total</a>();
  <span class="keywordtype">double</span> local = LocalMassFlowRateError / ( TotalMass / dt ), global = <a class="code" href="DoubleVect_8cpp.html#a07dd5e25d47ad3892ae0fa4e997ed011">mp_somme_vect</a>(array) / ( TotalMass / dt );
  <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ac294b3e6fc88a751ac14ac3547d5668b">cumulative_</a> += global;

  os &lt;&lt; <span class="stringliteral">&quot;time step continuity errors : sum local = &quot;</span> &lt;&lt; local &lt;&lt; <span class="stringliteral">&quot;, global = &quot;</span> &lt;&lt; global &lt;&lt; <span class="stringliteral">&quot;, cumulative = &quot;</span> &lt;&lt; <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ac294b3e6fc88a751ac14ac3547d5668b">cumulative_</a> &lt;&lt; finl;

  <span class="keywordflow">if</span> (local &gt; 0.01)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The mass balance is too bad (relative value &gt; 1%).&quot;</span> &lt;&lt; finl;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Please check and lower the convergence value of the pressure solver.&quot;</span> &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }
  <span class="keywordflow">return</span> 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa5039c9c3c958b1fc4cb8facddf543a4"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::prepare_and_solve_u_star" ref="aa5039c9c3c958b1fc4cb8facddf543a4" args="(Navier_Stokes_std &amp;eqn, const Fluide_Dilatable_base &amp;fluide_dil, DoubleTab &amp;rhoU, DoubleTab &amp;vpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Navier_Stokes_Fluide_Dilatable_Proto::prepare_and_solve_u_star </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;&#160;</td>
          <td class="paramname"><em>eqn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classFluide__Dilatable__base.html">Fluide_Dilatable_base</a> &amp;&#160;</td>
          <td class="paramname"><em>fluide_dil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>rhoU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; rho avec la meme discretisation que la vitesse </p>
</p>

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00263">263</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html">Navier_Stokes_Fluide_Dilatable_Proto.cpp</a>.</p>

<p>References <a class="el" href="Sources_8cpp_source.html#l00132">Sources::ajouter()</a>, <a class="el" href="classOperateur.html#accdf61cf1e33fb42e9eb06f1c501422b">Operateur::ajouter()</a>, <a class="el" href="Solveur__Masse_8h_source.html#l00087">Solveur_Masse::appliquer()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l00884">Navier_Stokes_std::corriger_derivee_expl()</a>, <a class="el" href="Equation__base_8cpp_source.html#l01775">Equation_base::derivee_en_temps_conv()</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00904">Schema_Temps_base::diffusion_implicite()</a>, <a class="el" href="Champ__Inc_8cpp_source.html#l00329">Champ_Inc::futur()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l01854">Navier_Stokes_std::get_champ()</a>, <a class="el" href="Equation__base_8h_source.html#l00244">Equation_base::Gradient_conjugue_diff_impl()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l00748">Navier_Stokes_std::inconnue()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l00560">Navier_Stokes_std::operateur()</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00576">Schema_Temps_base::pas_de_temps()</a>, <a class="el" href="Cast_8h_source.html#l00062">ref_cast_non_const</a>, <a class="el" href="Fluide__Dilatable__base_8h_source.html#l00120">Fluide_Dilatable_base::rho_discvit()</a>, <a class="el" href="Fluide__Dilatable__base_8h_source.html#l00121">Fluide_Dilatable_base::rho_face_n()</a>, <a class="el" href="Fluide__Dilatable__base_8h_source.html#l00122">Fluide_Dilatable_base::rho_face_np1()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l02290">Navier_Stokes_std::rho_la_vitesse()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00038">rho_vitesse_impl()</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="classFluide__Dilatable__base.html#a881172acb09944046107e7c87e8fdcaf">Fluide_Dilatable_base::secmembre_divU_Z()</a>, <a class="el" href="DoubleVect_8h_source.html#l00159">DoubleVect::size_totale()</a>, <a class="el" href="Equation__base_8h_source.html#l00432">Equation_base::solv_masse()</a>, <a class="el" href="Equation__base_8cpp_source.html#l00578">Equation_base::sources()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html#l00055">tab_W</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00344">update_vpoint_on_boundaries()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Champ__Inc_8cpp_source.html#l00245">Champ_Inc::valeurs()</a>, and <a class="el" href="Navier__Stokes__std_8h_source.html#l00329">Navier_Stokes_std::vitesse()</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00121">derivee_en_temps_inco_impl()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_rho_face_n =fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#ae1cc5ec1ca08dc3269b171143ad3df39">rho_face_n</a>(), tab_rho_face_np1=fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#a29eacbad70e5894523fd7709d762dcf2">rho_face_np1</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_rho = fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#a24fce1665e4890c748db49973c0f7fee">rho_discvit</a>(); <span class="comment">//!&lt; rho avec la meme discretisation que la vitesse</span>
<span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit = eqn.<a class="code" href="classNavier__Stokes__std.html#ab831017616b67792f562fea81f1e5dce">vitesse</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();

  fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#a881172acb09944046107e7c87e8fdcaf">secmembre_divU_Z</a>(<a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ab224b13eb4a2fa008b3ba02e314db03c" title="RHS of div(rho.U)">tab_W</a>); <span class="comment">//Calcule W=-dZ/dt, 2nd membre de l&#39;equation div(rhoU) = W</span>
  vpoint=0;

<span class="comment">// ajout diffusion (avec la viscosite dynamique)</span>
  <span class="keywordflow">if</span> (!eqn.<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#af19143270478f1a870292550da641a94" title="Renvoie 1 si le schema en temps a ete lu diffusion_implicite.">diffusion_implicite</a>()) eqn.<a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df" title="Renvoie le i-eme operateur de l&#39;equation: - le terme_diffusif si i = 0 - le terme_convectif si i = 1 ...">operateur</a>(0).<a class="code" href="classOperateur.html#accdf61cf1e33fb42e9eb06f1c501422b">ajouter</a>(vpoint);

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; rhovitesse = <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>,eqn.<a class="code" href="classNavier__Stokes__std.html#a1de05cd8d0ca7595e1c1c0e80ca7f8ab">rho_la_vitesse</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
  <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ad7b9506e7bda4dbde7ce4e4edca71298">rho_vitesse_impl</a>(tab_rho,vit,rhovitesse);

<span class="comment">// ajout convection utilise rhovitesse</span>
  <span class="keywordflow">if</span> (!eqn.<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#af19143270478f1a870292550da641a94" title="Renvoie 1 si le schema en temps a ete lu diffusion_implicite.">diffusion_implicite</a>()) eqn.<a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df" title="Renvoie le i-eme operateur de l&#39;equation: - le terme_diffusif si i = 0 - le terme_convectif si i = 1 ...">operateur</a>(1).<a class="code" href="classOperateur.html#accdf61cf1e33fb42e9eb06f1c501422b">ajouter</a>(rhovitesse,vpoint);
  <span class="keywordflow">else</span>
    {
      <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> trav(vpoint);
      eqn.<a class="code" href="classEquation__base.html#a20d04d53bd0c4b48aa923c2b328bb1e3" title="Add convection term In: solution is the unknown I Out: secmem is increased by convection(I)">derivee_en_temps_conv</a>(trav,rhovitesse);
      vpoint = trav;
    }

<span class="comment">// ajout source</span>
  eqn.<a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>().<a class="code" href="classSources.html#a6fc277f1920a71841cb041dc1b6ed771" title="Ajoute la contribution de toutes les sources de la liste au tableau passe en parametre, et renvoie ce tableau.">ajouter</a>(vpoint);

<span class="comment">// ajout de gradP</span>
  eqn.<a class="code" href="classNavier__Stokes__std.html#a8fc2b544594acef9cc31ff48e5184c47" title="Add a specific term for Navier Stokes (-gradP(n)) if necessary.">corriger_derivee_expl</a>(vpoint);

  <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; rho_vit=eqn.<a class="code" href="classNavier__Stokes__std.html#a18eccb9461a019135740a00f5e3dbec1">get_champ</a>(<span class="stringliteral">&quot;rho_comme_v&quot;</span>);
  <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>,rho_vit.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>())=tab_rho_face_np1;

  <span class="keywordflow">if</span> (eqn.<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#af19143270478f1a870292550da641a94" title="Renvoie 1 si le schema en temps a ete lu diffusion_implicite.">diffusion_implicite</a>())
    {
      <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> secmemV(vpoint);
      secmemV = vpoint;
      <span class="keywordtype">double</span> dt = eqn.<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
      <span class="comment">/*</span>
<span class="comment">       * secmemV contient M(rhonp1 unp1 -rhon un)/dt</span>
<span class="comment">       * M-1 secmemv*dt+rhon un -rhonp1un= rhonp1 (unp1 -unp )</span>
<span class="comment">       * dt/rhnhonp1 =(unp1-un)/dt</span>
<span class="comment">       * M-1 secmemV/rhonp1 + (rhon  -rhonp1)/rhonp1/dt  un</span>
<span class="comment">       *</span>
<span class="comment">       * on modifie le solveur masse pour diviser par rhonp1</span>
<span class="comment">       * (pratique aussi pour la diffusion implicite)</span>
<span class="comment">       */</span>

      eqn.<a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>()-&gt;set_name_of_coefficient_temporel(<span class="stringliteral">&quot;rho_comme_v&quot;</span>);
      eqn.<a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(secmemV);
      <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> dr(tab_rho_face_n);
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;dr.size_totale(); i++) dr(i)=(tab_rho_face_n(i)/tab_rho_face_np1(i)-1.)/dt;

<span class="comment">// on sert de vpoint pour calculer</span>
      <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ad7b9506e7bda4dbde7ce4e4edca71298">rho_vitesse_impl</a>(dr,vit,vpoint);
      secmemV += vpoint;

      <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> delta_u(eqn.<a class="code" href="classNavier__Stokes__std.html#a743b777e6185faee7837326844c8fca1" title="Renvoie la vitesse (champ inconnue de l&#39;equation) (version const)">inconnue</a>().<a class="code" href="classChamp__Inc.html#a518c3eb1e7a249ae0fc4d1a4e0d072d0" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t+i.">futur</a>());
      eqn.<a class="code" href="classEquation__base.html#abd67532530f67b3305703a130a5d823a">Gradient_conjugue_diff_impl</a>(secmemV, delta_u ) ;

      <span class="comment">/*</span>
<span class="comment">       * delta_u=unp1 -un =&gt; delta_u + un=unp1</span>
<span class="comment">       * (delat_u + un)*rhonp1 = rhonp1 * unp1</span>
<span class="comment">       * (delat_u + un)*rhonp1  - rhon * un= rhonp1 * unp1 - rhon * un</span>
<span class="comment">       */</span>

      delta_u *= dt;
      delta_u += vit;
      <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ad7b9506e7bda4dbde7ce4e4edca71298">rho_vitesse_impl</a>(tab_rho_face_np1,delta_u,vpoint);
      vpoint -= rhovitesse;
      vpoint /= dt;
      eqn.<a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>()-&gt;set_name_of_coefficient_temporel(<span class="stringliteral">&quot;no_coeff&quot;</span>);
    }
  <span class="keywordflow">else</span> eqn.<a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(vpoint);

  <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ae6ca864f68a9e973a487ab3ec5396374">update_vpoint_on_boundaries</a>(eqn,fluide_dil,vpoint);

} <span class="comment">/* END prepare_and_solve_u_star */</span>
</pre></div>
</div>
</div>
<a class="anchor" id="ad7b9506e7bda4dbde7ce4e4edca71298"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::rho_vitesse_impl" ref="ad7b9506e7bda4dbde7ce4e4edca71298" args="(const DoubleTab &amp;tab_rho, const DoubleTab &amp;vit, DoubleTab &amp;rhovitesse) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Navier_Stokes_Fluide_Dilatable_Proto::rho_vitesse_impl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>tab_rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>rhovitesse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00038">38</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html">Navier_Stokes_Fluide_Dilatable_Proto.cpp</a>.</p>

<p>References <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, and <a class="el" href="Op__Div__VEFP1B__Elem_8cpp_source.html#l00081">verifier()</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00169">assembler_avec_inertie_impl()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00050">impr_impl()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__base_8cpp_source.html#l00134">Navier_Stokes_Fluide_Dilatable_base::initTimeStep()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00263">prepare_and_solve_u_star()</a>, and <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00397">solve_pressure_increment()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keywordtype">int</span> n = vit.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0), ncomp = vit.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i&lt;n ; i++)
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0 ; j&lt;ncomp ; j++) rhovitesse(i,j) = tab_rho(i,0)*vit(i,j);

  rhovitesse.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
  <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;Navier_Stokes_Fluide_Dilatable_Proto::rho_vitesse : &quot;</span>, rhovitesse);
  <span class="keywordflow">return</span> rhovitesse;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a80fc279cfb275b0fce12a8110906a14b"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::solve_pressure_increment" ref="a80fc279cfb275b0fce12a8110906a14b" args="(Navier_Stokes_std &amp;eqn, const Fluide_Dilatable_base &amp;fluide_dil, DoubleTab &amp;rhoU, DoubleTab &amp;secmem, DoubleTab &amp;inc_pre, DoubleTab &amp;vpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Navier_Stokes_Fluide_Dilatable_Proto::solve_pressure_increment </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;&#160;</td>
          <td class="paramname"><em>eqn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classFluide__Dilatable__base.html">Fluide_Dilatable_base</a> &amp;&#160;</td>
          <td class="paramname"><em>fluide_dil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>rhoU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>secmem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>inc_pre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; (-tabW + Div(rhoU))/dt </p>
</p>

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00397">397</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html">Navier_Stokes_Fluide_Dilatable_Proto.cpp</a>.</p>

<p>References <a class="el" href="Operateur__Div_8cpp_source.html#l00119">Operateur_Div::ajouter()</a>, <a class="el" href="Navier__Stokes__std_8h_source.html#l00344">Navier_Stokes_std::assembleur_pression()</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">Probleme_base::equation()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Navier__Stokes__std_8h_source.html#l00339">Navier_Stokes_std::matrice_pression()</a>, <a class="el" href="Assembleur_8cpp_source.html#l00229">Assembleur::modifier_secmem()</a>, <a class="el" href="classTransport__Interfaces__base.html#a822ee006a29e2a1046af359f6e19aee3">Transport_Interfaces_base::modifier_vpoint_pour_imposer_vit()</a>, <a class="el" href="classProbleme__base.html#abefceb0ac0d0b35d42a4daaa82a95f59">Probleme_base::nombre_d_equations()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l00665">Navier_Stokes_std::operateur_divergence()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l01356">operator_negate()</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00576">Schema_Temps_base::pas_de_temps()</a>, <a class="el" href="Equation__base_8cpp_source.html#l00964">Equation_base::probleme()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="SolveurSys_8cpp_source.html#l00052">SolveurSys::resoudre_systeme()</a>, <a class="el" href="Fluide__Dilatable__base_8h_source.html#l00121">Fluide_Dilatable_base::rho_face_n()</a>, <a class="el" href="Fluide__Dilatable__base_8h_source.html#l00122">Fluide_Dilatable_base::rho_face_np1()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00038">rho_vitesse_impl()</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="Navier__Stokes__std_8cpp_source.html#l00787">Navier_Stokes_std::solveur_pression()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html#l00055">tab_W</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00676">Schema_Temps_base::temps_courant()</a>, <a class="el" href="Deriv__Matrice__Base_8h_source.html#l00028">Deriv_Matrice_Base::valeur()</a>, <a class="el" href="Champ__Inc_8cpp_source.html#l00245">Champ_Inc::valeurs()</a>, <a class="el" href="Op__Div__VEFP1B__Elem_8cpp_source.html#l00081">verifier()</a>, and <a class="el" href="Navier__Stokes__std_8h_source.html#l00329">Navier_Stokes_std::vitesse()</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00121">derivee_en_temps_inco_impl()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_rho_face_n =fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#ae1cc5ec1ca08dc3269b171143ad3df39">rho_face_n</a>(), tab_rho_face_np1=fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#a29eacbad70e5894523fd7709d762dcf2">rho_face_np1</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit = eqn.<a class="code" href="classNavier__Stokes__std.html#ab831017616b67792f562fea81f1e5dce">vitesse</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
  <span class="keyword">const</span> <span class="keywordtype">double</span> dt_ = eqn.<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>(),t = eqn.<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>();

<span class="comment">// Resolution pression</span>
  vpoint.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();

<span class="comment">// Compute rhoU(n) :</span>
  <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ad7b9506e7bda4dbde7ce4e4edca71298">rho_vitesse_impl</a>(tab_rho_face_n,vit,rhoU);

<span class="comment">// Add source term to vpoint if interfaces</span>
  <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; prob=eqn.<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>();
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> vpoint0(vpoint) ;
  vpoint0 = vpoint ;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;prob.<a class="code" href="classProbleme__base.html#abefceb0ac0d0b35d42a4daaa82a95f59">nombre_d_equations</a>(); i++)
    <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>,prob.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i)))
      {
        <a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>&amp; eq_transport = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>,prob.<a class="code" href="classProbleme__base.html#ae97586575b7e510d7945ce3a894b806a">equation</a>(i));
        <span class="keyword">const</span> <span class="keywordtype">int</span> nb = vpoint.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0), m = vpoint.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
        <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> source_ibc(nb,m);

<span class="comment">// On ajoute un terme source a vpoint pour imposer au fluide la vitesse de l interface</span>
<span class="comment">// source_ibc est local pas postraitable (different cas FT ou le terme source est defini et peut etre postraite)</span>
        eq_transport.<a class="code" href="classTransport__Interfaces__base.html#a822ee006a29e2a1046af359f6e19aee3">modifier_vpoint_pour_imposer_vit</a>(rhoU,vpoint0,vpoint,tab_rho_face_np1,source_ibc,t,dt_);
      }

  secmem = <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ab224b13eb4a2fa008b3ba02e314db03c" title="RHS of div(rho.U)">tab_W</a>;
  <a class="code" href="DoubleVect_8cpp.html#a037eedbd9167441dbd379675d4b2fe55">operator_negate</a>(secmem);
  eqn.<a class="code" href="classNavier__Stokes__std.html#a614d41350181667ee295b87a72779c1a" title="Renvoie l&#39;operateur de calcul de la divergence associe a l&#39;equation.">operateur_divergence</a>().<a class="code" href="classOperateur__Div.html#aeb7f9d269b7d93314ce9583f0fa1f57d" title="Ajoute la contribution de l&#39;operateur au tableau passe en parametre.">ajouter</a>(rhoU,secmem);
  secmem /= dt_; <span class="comment">//!&lt; (-tabW + Div(rhoU))/dt</span>
<span class="comment"></span>
  eqn.<a class="code" href="classNavier__Stokes__std.html#a614d41350181667ee295b87a72779c1a" title="Renvoie l&#39;operateur de calcul de la divergence associe a l&#39;equation.">operateur_divergence</a>().<a class="code" href="classOperateur__Div.html#aeb7f9d269b7d93314ce9583f0fa1f57d" title="Ajoute la contribution de l&#39;operateur au tableau passe en parametre.">ajouter</a>(vpoint, secmem);
  secmem *= -1;
  secmem.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
  <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;Navier_Stokes_Fluide_Dilatable_base::derivee_en_temps_inco, secmem : &quot;</span>, secmem);

<span class="comment">// On ne fait appel qu une seule fois a assembler dans preparer calcul (au lieu de assembler_QC)</span>
<span class="comment">// Correction du second membre d&#39;apres les conditions aux limites :</span>
  eqn.<a class="code" href="classNavier__Stokes__std.html#af9f5e0396945755597f147bd424a4a08">assembleur_pression</a>().<a class="code" href="classAssembleur.html#abac307565fa214099f111a015e1cda3f" title="Appel a l&#39;objet sous-jacent. Permet de modifier le second membre du systeme Modifie egalement la solu...">modifier_secmem</a>(secmem);
  eqn.<a class="code" href="classNavier__Stokes__std.html#ae83d9f7a42531293583f32be1efd3d5f" title="Renvoie le solveur en pression&lt;br&gt;(version const)">solveur_pression</a>().<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(eqn.<a class="code" href="classNavier__Stokes__std.html#ade0331e225bfe2c312d4917eb127e3cd">matrice_pression</a>().<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(),secmem,inc_pre);

} <span class="comment">/* END  solve_pressure_increment */</span>
</pre></div>
</div>
</div>
<a class="anchor" id="ae6ca864f68a9e973a487ab3ec5396374"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::update_vpoint_on_boundaries" ref="ae6ca864f68a9e973a487ab3ec5396374" args="(const Navier_Stokes_std &amp;eqn, const Fluide_Dilatable_base &amp;fluide_dil, DoubleTab &amp;vpoint)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Navier_Stokes_Fluide_Dilatable_Proto::update_vpoint_on_boundaries </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classNavier__Stokes__std.html">Navier_Stokes_std</a> &amp;&#160;</td>
          <td class="paramname"><em>eqn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classFluide__Dilatable__base.html">Fluide_Dilatable_base</a> &amp;&#160;</td>
          <td class="paramname"><em>fluide_dil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vpoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; VDF //</p>
<p>&lt; VEF // </p>
</p>

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00344">344</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html">Navier_Stokes_Fluide_Dilatable_Proto.cpp</a>.</p>

<p>References <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone__dis__base_8cpp_source.html#l00218">Zone_dis_base::face_voisins()</a>, <a class="el" href="Cond__lim__base_8h_source.html#l00123">Cond_lim_base::frontiere_dis()</a>, <a class="el" href="Zone__Cl__dis_8h_source.html#l00130">Zone_Cl_dis::les_conditions_limites()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Front__VF_8h_source.html#l00061">Front_VF::nb_faces()</a>, <a class="el" href="Front__VF_8h_source.html#l00071">Front_VF::num_premiere_face()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html#l00054">orientation_VDF_</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00576">Schema_Temps_base::pas_de_temps()</a>, <a class="el" href="IntVect_8cpp_source.html#l00132">IntVect::ref()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Fluide__Dilatable__base_8h_source.html#l00121">Fluide_Dilatable_base::rho_face_n()</a>, <a class="el" href="Fluide__Dilatable__base_8h_source.html#l00122">Fluide_Dilatable_base::rho_face_np1()</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="vect__impl_8h_source.html#l00057">vect_impl::size()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Zone__dis_8h_source.html#l00029">Deriv_Zone_dis_base::valeur()</a>, <a class="el" href="Champ__Inc_8cpp_source.html#l00245">Champ_Inc::valeurs()</a>, <a class="el" href="Navier__Stokes__std_8h_source.html#l00329">Navier_Stokes_std::vitesse()</a>, <a class="el" href="Equation__base_8h_source.html#l00391">Equation_base::zone_Cl_dis()</a>, and <a class="el" href="Equation__base_8cpp_source.html#l00091">Equation_base::zone_dis()</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00263">prepare_and_solve_u_star()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// on ajoute durho/dt au bord Dirichlet car les solveur masse a mis a zero</span>
<span class="comment">// NOTE : en incompressible le terme est rajoute par modifier_secmem</span>
  <span class="keyword">const</span> <span class="keywordtype">double</span> dt_ = eqn.<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_rho_face_n =fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#ae1cc5ec1ca08dc3269b171143ad3df39">rho_face_n</a>(), tab_rho_face_np1=fluide_dil.<a class="code" href="classFluide__Dilatable__base.html#a29eacbad70e5894523fd7709d762dcf2">rho_face_np1</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit = eqn.<a class="code" href="classNavier__Stokes__std.html#ab831017616b67792f562fea81f1e5dce">vitesse</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
  <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; lescl=eqn.<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="classZone__Cl__dis.html#aafbd0525703e23200e31796bcd4fcac6" title="Appel a l&#39;objet sous-jacent Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = eqn.<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>().<a class="code" href="classZone__dis__base.html#a5ae23109f0dbc1b9d4dd99e76ec3297f">face_voisins</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nbcondlim = lescl.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(), taille = vpoint.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

  <span class="keywordflow">if</span> (taille==1)
    <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#acca173f86d33011d9eb6be9017c09b56">orientation_VDF_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>() == 0)
      <a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#acca173f86d33011d9eb6be9017c09b56">orientation_VDF_</a>.<a class="code" href="classIntVect.html#a165455689c6d27ac93c9cf8823e47a0f" title="detache le tableau et l&#39;attache a v (sauf si v==*this, ne fait rien) Fait pointer le tableau sur la m...">ref</a>(<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>,eqn.<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>()).orientation());

  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icl=0; icl&lt;nbcondlim; icl++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim__base.html" title="classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...">Cond_lim_base</a>&amp; la_cl_base = lescl[icl].valeur();
      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl_base))
        {
          <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; la_front_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl_base.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
          <span class="keyword">const</span> <a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>&amp; diri=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl_base);
          <span class="keyword">const</span> <span class="keywordtype">int</span> ndeb = la_front_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>(), nfin = ndeb + la_front_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();

          <span class="keywordflow">if</span> (taille==1) <span class="comment">//!&lt; VDF //</span>
<span class="comment"></span>            {
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=ndeb; num_face&lt;nfin; num_face++)
                {
                  <span class="keywordtype">int</span> n0 = face_voisins(num_face, 0);
                  <span class="keywordflow">if</span> (n0 == -1) n0 = face_voisins(num_face, 1);

<span class="comment">// GF en cas de diffsion implicite vpoint!=0 on ignrore l&#39;ancienne valeur</span>
                  vpoint(num_face)=(diri.val_imp(num_face-ndeb,<a class="code" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#acca173f86d33011d9eb6be9017c09b56">orientation_VDF_</a>(num_face))*tab_rho_face_np1(num_face)-
                                    vit(num_face)*tab_rho_face_n(num_face))/dt_;
                }
            }
          <span class="keywordflow">else</span> <span class="comment">//!&lt; VEF //</span>
<span class="comment"></span>            {
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=ndeb; num_face&lt;nfin; num_face++)
                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj=0; jj&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; jj++)
                  {
<span class="comment">// GF en cas de diffsion implicite vpoint!=0 on ignrore l&#39;ancienne valeur</span>
                    vpoint(num_face,jj)=(tab_rho_face_np1(num_face)*diri.val_imp(num_face-ndeb,jj)
                                         -tab_rho_face_n(num_face)*vit(num_face,jj))/dt_;
                  }
            }
        }
    }

} <span class="comment">/* END update_vpoint_on_boundaries */</span>
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ac294b3e6fc88a751ac14ac3547d5668b"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::cumulative_" ref="ac294b3e6fc88a751ac14ac3547d5668b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ac294b3e6fc88a751ac14ac3547d5668b">Navier_Stokes_Fluide_Dilatable_Proto::cumulative_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html#l00058">58</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html">Navier_Stokes_Fluide_Dilatable_Proto.h</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00050">impr_impl()</a>.</p>

</div>
</div>
<a class="anchor" id="acca173f86d33011d9eb6be9017c09b56"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::orientation_VDF_" ref="acca173f86d33011d9eb6be9017c09b56" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntVect.html">IntVect</a> <a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#acca173f86d33011d9eb6be9017c09b56">Navier_Stokes_Fluide_Dilatable_Proto::orientation_VDF_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html#l00054">54</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html">Navier_Stokes_Fluide_Dilatable_Proto.h</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00344">update_vpoint_on_boundaries()</a>.</p>

</div>
</div>
<a class="anchor" id="a81a0cab61b51f45b90ad6006ea2fdc53"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::rho_la_vitesse_" ref="a81a0cab61b51f45b90ad6006ea2fdc53" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classChamp__Inc.html">Champ_Inc</a> <a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#a81a0cab61b51f45b90ad6006ea2fdc53">Navier_Stokes_Fluide_Dilatable_Proto::rho_la_vitesse_</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html#l00053">53</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html">Navier_Stokes_Fluide_Dilatable_Proto.h</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__base_8cpp_source.html#l00145">Navier_Stokes_Fluide_Dilatable_base::discretiser()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__base_8cpp_source.html#l00134">Navier_Stokes_Fluide_Dilatable_base::initTimeStep()</a>, and <a class="el" href="Navier__Stokes__Fluide__Dilatable__base_8h_source.html#l00077">Navier_Stokes_Fluide_Dilatable_base::rho_la_vitesse()</a>.</p>

</div>
</div>
<a class="anchor" id="ab224b13eb4a2fa008b3ba02e314db03c"></a><!-- doxytag: member="Navier_Stokes_Fluide_Dilatable_Proto::tab_W" ref="ab224b13eb4a2fa008b3ba02e314db03c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> <a class="el" href="classNavier__Stokes__Fluide__Dilatable__Proto.html#ab224b13eb4a2fa008b3ba02e314db03c">Navier_Stokes_Fluide_Dilatable_Proto::tab_W</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>RHS of div(rho.U) </p>

<p>Definition at line <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html#l00055">55</a> of file <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html">Navier_Stokes_Fluide_Dilatable_Proto.h</a>.</p>

<p>Referenced by <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00121">derivee_en_temps_inco_impl()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00050">impr_impl()</a>, <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00263">prepare_and_solve_u_star()</a>, and <a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html#l00397">solve_pressure_increment()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/ThHyd/Dilatable/Common/Equations/<a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8h_source.html">Navier_Stokes_Fluide_Dilatable_Proto.h</a></li>
<li>src/ThHyd/Dilatable/Common/Equations/<a class="el" href="Navier__Stokes__Fluide__Dilatable__Proto_8cpp_source.html">Navier_Stokes_Fluide_Dilatable_Proto.cpp</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:37:06 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
