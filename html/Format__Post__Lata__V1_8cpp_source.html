<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Framework/Format_Post_Lata_V1.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Framework/Format_Post_Lata_V1.cpp</div>  </div>
</div>
<div class="contents">
<a href="Format__Post__Lata__V1_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Format_Post_Lata_V1.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Framework</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/24</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;<a class="code" href="Format__Post__Lata__V1_8h.html">Format_Post_Lata_V1.h</a>&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Fichier__Lata_8h.html">Fichier_Lata.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="communications_8h.html">communications.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="SFichier_8h.html">SFichier.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;LataV1_field_definitions.h&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="Format__Post__Lata__V1_8cpp.html#af6f4a57229c449bd5dd4889080cb4d2c">00028</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classFormat__Post__Lata__V1.html" title=": classe d&#39;ecriture des postraitement au format lata V1 (Trio_U version 1.4.9 et anterieures). Fournie pour compatibilite">Format_Post_Lata_V1</a>,<span class="stringliteral">&quot;Format_Post_Lata_V1&quot;</span>,<a class="code" href="classFormat__Post__Lata.html" title=": Classe de postraitement des champs euleriens au format lata.">Format_Post_Lata</a>);
<a name="l00029"></a>00029 
<a name="l00030"></a><a class="code" href="classFormat__Post__Lata__V1.html#a07855806308eb7ed7c375845182a8e43">00030</a> <a class="code" href="classFormat__Post__Lata__V1.html#a07855806308eb7ed7c375845182a8e43">Format_Post_Lata_V1::Format_Post_Lata_V1</a>()
<a name="l00031"></a>00031 {
<a name="l00032"></a>00032   <a class="code" href="classFormat__Post__Lata__V1.html#ae1306ea8e2e0f033b8f9348e43d1cb89">ref_faces_sommets</a> = 0;
<a name="l00033"></a>00033 }
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="classFormat__Post__Lata__V1.html#a725cc83ccec2fe931f073598938404fe">00035</a> <span class="keywordtype">void</span> <a class="code" href="classFormat__Post__Lata__V1.html#a725cc83ccec2fe931f073598938404fe" title="Remet l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut.">Format_Post_Lata_V1::reset</a>()
<a name="l00036"></a>00036 {
<a name="l00037"></a>00037   <a class="code" href="classFormat__Post__Lata__V1.html#ae1306ea8e2e0f033b8f9348e43d1cb89">ref_faces_sommets</a> = 0;
<a name="l00038"></a>00038 }
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="comment">//</span><span class="comment"></span>
<a name="l00041"></a>00041 <span class="comment">//! les options sont identiques a celles du format V2&lt;br&gt;Voir Format_Post_Lata::readOn()</span>
<a name="l00042"></a><a class="code" href="classFormat__Post__Lata__V1.html#a2679e5d591de1993ee949cee62c48081">00042</a> <span class="comment"></span><a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classFormat__Post__Lata__V1.html#a2679e5d591de1993ee949cee62c48081" title="les options sont identiques a celles du format V2 Voir Format_Post_Lata::readOn()">Format_Post_Lata_V1::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00043"></a>00043 {
<a name="l00044"></a>00044   <span class="keywordflow">return</span> <a class="code" href="classFormat__Post__Lata__V1.html#a2679e5d591de1993ee949cee62c48081" title="les options sont identiques a celles du format V2 Voir Format_Post_Lata::readOn()">Format_Post_Lata::readOn</a>(is);
<a name="l00045"></a>00045 }
<a name="l00046"></a>00046 
<a name="l00047"></a><a class="code" href="classFormat__Post__Lata__V1.html#aa0241e53643643a86a5af5738ba2dc3b">00047</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classFormat__Post__Lata__V1.html#aa0241e53643643a86a5af5738ba2dc3b" title="erreur =&gt; exit">Format_Post_Lata_V1::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00048"></a>00048 <span class="keyword"></span>{
<a name="l00049"></a>00049   <span class="keywordflow">return</span> <a class="code" href="classFormat__Post__Lata__V1.html#aa0241e53643643a86a5af5738ba2dc3b" title="erreur =&gt; exit">Format_Post_Lata::printOn</a>(os);
<a name="l00050"></a>00050 }
<a name="l00051"></a>00051 <span class="comment"></span>
<a name="l00052"></a>00052 <span class="comment">//! ecriture de l&#39;entete format LataV1</span>
<a name="l00053"></a><a class="code" href="classFormat__Post__Lata__V1.html#a399b3cce672ce7e241551737b57070da">00053</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lata__V1.html#a399b3cce672ce7e241551737b57070da" title="ecriture de l&#39;entete format LataV1">Format_Post_Lata_V1::ecrire_entete</a>(<span class="keywordtype">double</span> temps_courant,<span class="keywordtype">int</span> reprise,<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; est_le_premier_post)
<a name="l00054"></a>00054 {
<a name="l00055"></a>00055   <a class="code" href="classFormat__Post__Lata__V1.html#a5475ccf227ff2a3a475efab37e078820">ecrire_entete_lata_V1</a>(<a class="code" href="classFormat__Post__Lata.html#a8d55373127916e23ee800ef312f78cdd">lata_basename_</a>,<a class="code" href="classFormat__Post__Lata.html#a37cf02c0fe82cc9f1ee5acf01bca9c34">options_para_</a>,est_le_premier_post);
<a name="l00056"></a>00056 
<a name="l00057"></a>00057   <span class="keywordflow">return</span> 1;
<a name="l00058"></a>00058 }
<a name="l00059"></a>00059 
<a name="l00060"></a><a class="code" href="classFormat__Post__Lata__V1.html#ab32d53165eb0327d086899f8b4b54938">00060</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lata__V1.html#ab32d53165eb0327d086899f8b4b54938">Format_Post_Lata_V1::finir</a>(<span class="keywordtype">int</span>&amp; est_le_dernier_post)
<a name="l00061"></a>00061 {
<a name="l00062"></a>00062   <a class="code" href="classFormat__Post__Lata__V1.html#a55bc04cca75ec56390034e84a0e885e7">finir_lata_V1</a>(<a class="code" href="classFormat__Post__Lata.html#a8d55373127916e23ee800ef312f78cdd">lata_basename_</a>,<a class="code" href="classFormat__Post__Lata.html#a37cf02c0fe82cc9f1ee5acf01bca9c34">options_para_</a>,est_le_dernier_post);
<a name="l00063"></a>00063   <span class="keywordflow">return</span> 1;
<a name="l00064"></a>00064 }
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="comment">//</span>
<a name="l00067"></a>00067 <span class="comment">//</span>
<a name="l00068"></a>00068 <span class="comment">//</span>
<a name="l00069"></a>00069 <span class="comment">//</span>
<a name="l00070"></a>00070 <span class="comment">//</span>
<a name="l00071"></a>00071 <span class="comment">//</span>
<a name="l00072"></a>00072 <span class="comment">//</span>
<a name="l00073"></a>00073 <span class="comment">//</span>
<a name="l00074"></a>00074 <span class="comment">//</span><span class="comment"></span>
<a name="l00075"></a>00075 <span class="comment">//! 1) Voir documentation de Format_Post_base::ecrire_domaine()&lt;br&gt;2) Specificites: format LATA ancienne version:&lt;br&gt;Ecriture du maillage compatible avec le postraitement Data-Visualizer (DV).&lt;br&gt;DV est un post 3D uniquement. Si le cas traite est 2D on&lt;br&gt;le rend 3D de la maniere suivante :&lt;br&gt;- On dedouble tous les noeuds du plan 2D&lt;br&gt;- On transforme les triangles en prismes&lt;br&gt;- On transforme les quadrangles en hexaedres&lt;br&gt;Rq :la numerotation des elements dans DV commence a 1.</span>
<a name="l00076"></a>00076 <span class="comment"></span>
<a name="l00077"></a>00077 
<a name="l00078"></a><a class="code" href="classFormat__Post__Lata__V1.html#a3f8c00ca0bdfc1f49be7b9accd1170a7">00078</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lata__V1.html#a3f8c00ca0bdfc1f49be7b9accd1170a7" title="1) Voir documentation de Format_Post_base::ecrire_domaine() 2) Specificites: format LATA ancienne ver...">Format_Post_Lata_V1::ecrire_domaine</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; domaine,<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; est_le_premier_post)
<a name="l00079"></a>00079 {
<a name="l00080"></a>00080   <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; id_domaine = domaine.<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>();
<a name="l00081"></a>00081   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a> = domaine.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>()-&gt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
<a name="l00082"></a>00082   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)
<a name="l00083"></a>00083     {
<a name="l00084"></a>00084       <span class="keywordflow">if</span> ((type_elem==<span class="stringliteral">&quot;TRIANGLE&quot;</span>) || (type_elem==<span class="stringliteral">&quot;QUADRANGLE&quot;</span>))
<a name="l00085"></a>00085         type_elem+=<span class="stringliteral">&quot;_3D&quot;</span>;
<a name="l00086"></a>00086     }
<a name="l00087"></a>00087   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; sommets = domaine.<a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>();
<a name="l00088"></a>00088   <span class="keyword">const</span> <span class="keywordtype">int</span> dim = domaine.<a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>().<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00089"></a>00089   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elements = domaine.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00090"></a>00090 
<a name="l00091"></a>00091   <a class="code" href="classFormat__Post__Lata__V1.html#a85d51776e115f5367776ea8acf42f123">ecrire_domaine_lata_V1</a>(id_domaine,type_elem,dim,sommets,elements,<a class="code" href="classFormat__Post__Lata.html#ab0b792d3f25872b859dc9c2170a9ac2d">status</a>,<a class="code" href="classFormat__Post__Lata.html#a8d55373127916e23ee800ef312f78cdd">lata_basename_</a>,<a class="code" href="classFormat__Post__Lata.html#a6f47f1f2016cce3ab8bb1b976ed0d921">format_</a>,<a class="code" href="classFormat__Post__Lata.html#a37cf02c0fe82cc9f1ee5acf01bca9c34">options_para_</a>);
<a name="l00092"></a>00092 
<a name="l00093"></a>00093   <span class="keywordflow">return</span> 1; <span class="comment">//!&lt; ok tout va bien</span>
<a name="l00094"></a>00094 <span class="comment"></span>}
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="classFormat__Post__Lata__V1.html#a97fbbd5e1a6241d77a745af14e5110e3">00096</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lata__V1.html#a97fbbd5e1a6241d77a745af14e5110e3" title="voir Format_Post_base::ecrire_champ">Format_Post_Lata_V1::ecrire_champ</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; domaine, <span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; unite_, <span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; noms_compo,
<a name="l00097"></a>00097                                       <span class="keywordtype">int</span> ncomp,<span class="keywordtype">double</span> temps_,<span class="keywordtype">double</span> temps_courant,
<a name="l00098"></a>00098                                       <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   id_du_champ,
<a name="l00099"></a>00099                                       <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   id_du_domaine,
<a name="l00100"></a>00100                                       <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   localisation,
<a name="l00101"></a>00101                                       <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   nature,
<a name="l00102"></a>00102                                       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; data)
<a name="l00103"></a>00103 {
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <a class="code" href="classFormat__Post__Lata__V1.html#a199128d963486e4af84af6c6ed6f9e02">ecrire_champ_lata_V1</a>(id_du_champ,id_du_domaine,localisation,data,temps_,<a class="code" href="classFormat__Post__Lata.html#a8d55373127916e23ee800ef312f78cdd">lata_basename_</a>,<a class="code" href="classFormat__Post__Lata.html#a6f47f1f2016cce3ab8bb1b976ed0d921">format_</a>,<a class="code" href="classFormat__Post__Lata.html#a37cf02c0fe82cc9f1ee5acf01bca9c34">options_para_</a>);
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <span class="keywordflow">return</span> 1;
<a name="l00108"></a>00108 }
<a name="l00109"></a>00109 <span class="comment"></span>
<a name="l00110"></a>00110 <span class="comment">//! l&#39;ecriture des bords n&#39;est pas supportee par ce format: return 0</span>
<a name="l00111"></a><a class="code" href="classFormat__Post__Lata__V1.html#abcad1e1c2a7f85e3ae501434f8f55b07">00111</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lata__V1.html#abcad1e1c2a7f85e3ae501434f8f55b07" title="l&#39;ecriture des bords n&#39;est pas supportee par ce format: return 0">Format_Post_Lata_V1::ecrire_bords</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;     id_du_domaine,
<a name="l00112"></a>00112                                       <span class="keyword">const</span> <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>&amp; type_faces,
<a name="l00113"></a>00113                                       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; sommets,
<a name="l00114"></a>00114                                       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_sommets,
<a name="l00115"></a>00115                                       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_num_bord,
<a name="l00116"></a>00116                                       <span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp;    bords_nom)
<a name="l00117"></a>00117 {
<a name="l00118"></a>00118   <span class="keywordflow">return</span> 0;
<a name="l00119"></a>00119 }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 <span class="comment">// On intercepte uniquement les tableaux FACES et ELEM_FACES</span>
<a name="l00122"></a>00122 <span class="comment">// qui sont ecrits dans le meme fichier que le domaine.</span>
<a name="l00123"></a><a class="code" href="classFormat__Post__Lata__V1.html#a952def3cfbec58a5f65f8d6e04d7192d">00123</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lata__V1.html#a952def3cfbec58a5f65f8d6e04d7192d" title="voir Format_Post_base::ecrire_champ ATTENTION: si &quot;reference&quot; est non vide on ajoute 1 a toutes les v...">Format_Post_Lata_V1::ecrire_item_int</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   id_item,
<a name="l00124"></a>00124                                          <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   id_du_domaine,
<a name="l00125"></a>00125                                          <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   id_zone,
<a name="l00126"></a>00126                                          <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   localisation,
<a name="l00127"></a>00127                                          <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   reference,
<a name="l00128"></a>00128                                          <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; val,
<a name="l00129"></a>00129                                          <span class="keyword">const</span> <span class="keywordtype">int</span> reference_size)
<a name="l00130"></a>00130 {
<a name="l00131"></a>00131   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; data = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>,val);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133   <span class="keywordflow">if</span> (id_item == <span class="stringliteral">&quot;FACES&quot;</span>)
<a name="l00134"></a>00134     {
<a name="l00135"></a>00135       <a class="code" href="classFormat__Post__Lata__V1.html#ae1306ea8e2e0f033b8f9348e43d1cb89">ref_faces_sommets</a> = &amp;data;
<a name="l00136"></a>00136       <a class="code" href="classFormat__Post__Lata__V1.html#aff3af7be1635e12f4bf96ea9b6f2c20d">ref_nb_som</a> = reference_size;
<a name="l00137"></a>00137       <span class="keywordflow">return</span> 1;
<a name="l00138"></a>00138     }
<a name="l00139"></a>00139   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (id_item == <span class="stringliteral">&quot;ELEM_FACES&quot;</span>)
<a name="l00140"></a>00140     {
<a name="l00141"></a>00141 <span class="comment">// continue</span>
<a name="l00142"></a>00142     }
<a name="l00143"></a>00143   <span class="keywordflow">else</span>
<a name="l00144"></a>00144     {
<a name="l00145"></a>00145       <a class="code" href="classFormat__Post__Lata__V1.html#ae1306ea8e2e0f033b8f9348e43d1cb89">ref_faces_sommets</a> = 0;
<a name="l00146"></a>00146 <span class="comment">// not supported</span>
<a name="l00147"></a>00147       <span class="keywordflow">return</span> 0;
<a name="l00148"></a>00148     }
<a name="l00149"></a>00149 
<a name="l00150"></a>00150   <a class="code" href="classFormat__Post__Lata__V1.html#ae62255dad977fcb423cd2e74dfd7ff64">ecrire_faces_lata_V1</a>(<a class="code" href="classFormat__Post__Lata.html#a8d55373127916e23ee800ef312f78cdd">lata_basename_</a>,
<a name="l00151"></a>00151                        <a class="code" href="classFormat__Post__Lata.html#a6f47f1f2016cce3ab8bb1b976ed0d921">format_</a>,
<a name="l00152"></a>00152                        <a class="code" href="classFormat__Post__Lata.html#a37cf02c0fe82cc9f1ee5acf01bca9c34">options_para_</a>,
<a name="l00153"></a>00153                        id_du_domaine,
<a name="l00154"></a>00154                        <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>,*<a class="code" href="classFormat__Post__Lata__V1.html#ae1306ea8e2e0f033b8f9348e43d1cb89">ref_faces_sommets</a>),
<a name="l00155"></a>00155                        <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>,val),
<a name="l00156"></a>00156                        <a class="code" href="classFormat__Post__Lata__V1.html#aff3af7be1635e12f4bf96ea9b6f2c20d">ref_nb_som</a>);
<a name="l00157"></a>00157 
<a name="l00158"></a>00158   <span class="keywordflow">return</span> 0;
<a name="l00159"></a>00159 }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 <span class="comment">// On intercepte uniquement les tableaux FACES et ELEM_FACES</span>
<a name="l00162"></a>00162 <span class="comment">// qui sont ecrits dans le meme fichier que le domaine.</span>
<a name="l00163"></a><a class="code" href="classFormat__Post__Lata__V1.html#ae62255dad977fcb423cd2e74dfd7ff64">00163</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lata__V1.html#ae62255dad977fcb423cd2e74dfd7ff64">Format_Post_Lata_V1::ecrire_faces_lata_V1</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; basename,
<a name="l00164"></a>00164                                               <span class="keyword">const</span> <a class="code" href="classFormat__Post__Lata.html#a8698c5e7e825c54749a7365f7ffff53c">Format</a>&amp; format,
<a name="l00165"></a>00165                                               <span class="keyword">const</span> <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94">Options_Para</a>&amp; <a class="code" href="classoption.html">option</a>,
<a name="l00166"></a>00166                                               <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   id_du_domaine,
<a name="l00167"></a>00167                                               <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces,
<a name="l00168"></a>00168                                               <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces,
<a name="l00169"></a>00169                                               <span class="keyword">const</span> <span class="keywordtype">int</span> nb_sommets)
<a name="l00170"></a>00170 {
<a name="l00171"></a>00171   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_fichier_geom;
<a name="l00172"></a>00172   <span class="keywordtype">int</span> nb_faces_tot = -1;
<a name="l00173"></a>00173   <span class="keywordtype">int</span> decalage_faces = 1;
<a name="l00174"></a>00174   {
<a name="l00175"></a>00175     <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> basename_geom(basename);
<a name="l00176"></a>00176     <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> extension_geom(<a class="code" href="classFormat__Post__Lata.html#aee3312d2f199be29261229ab7f874a40" title="Renvoie l&#39;extension conventionnelle des fichiers lata : &quot;.lata&quot;.">extension_lata</a>());
<a name="l00177"></a>00177     extension_geom += <span class="stringliteral">&quot;.&quot;</span>;
<a name="l00178"></a>00178     extension_geom += id_du_domaine;
<a name="l00179"></a>00179     <a class="code" href="classFichier__Lata.html">Fichier_Lata</a> fichier_geom(basename_geom, extension_geom,
<a name="l00180"></a>00180                               <a class="code" href="classFichier__Lata.html#afadf4963467b3123d9e9ec312644cb48ad9db95f97d41cea9e4338af8876bd408">Fichier_Lata::APPEND</a>, format, option);
<a name="l00181"></a>00181     nom_fichier_geom = fichier_geom.<a class="code" href="classFichier__Lata.html#a8bcf7ecaa7806a6ae44979ff921370ca" title="Renvoie le nom du fichier avec le path.">get_filename</a>();
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="comment">// Faces</span>
<a name="l00184"></a>00184 <span class="comment">// Les indices de sommets, elements et autres dans le fichier lata commencent a 1 :</span>
<a name="l00185"></a>00185     <span class="keywordtype">int</span> nb_col;
<a name="l00186"></a>00186     <span class="keywordtype">int</span> decal;
<a name="l00187"></a>00187     <span class="keywordflow">if</span> (option == <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94a448f17201fc397a7da69a62ae0637043">SINGLE_FILE</a> &amp;&amp; <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
<a name="l00188"></a>00188       {
<a name="l00189"></a>00189 <span class="comment">// Decalage a ajouter aux indices pour avoir une numerotation globale.</span>
<a name="l00190"></a>00190         decal = <a class="code" href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071" title="Calul de la somme partielle de i sur les processeurs 0 a me()-1 (renvoie 0 sur le processeur 0)...">mppartial_sum</a>(nb_sommets) + 1;
<a name="l00191"></a>00191         decalage_faces = <a class="code" href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071" title="Calul de la somme partielle de i sur les processeurs 0 a me()-1 (renvoie 0 sur le processeur 0)...">mppartial_sum</a>(faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)) + 1;
<a name="l00192"></a>00192       }
<a name="l00193"></a>00193     <span class="keywordflow">else</span>
<a name="l00194"></a>00194       {
<a name="l00195"></a>00195         decal = 1;
<a name="l00196"></a>00196         decalage_faces = 1;
<a name="l00197"></a>00197       }
<a name="l00198"></a>00198     nb_faces_tot = <a class="code" href="classFormat__Post__Lata.html#ab01cd71e3e0e1220bbeb8e144b3f9731" title="Ecriture d&#39;un tableau d&#39;entiers dans le fichier fourni. Les valeurs ecrites sont les valeurs du table...">Format_Post_Lata::write_inttab</a>(fichier_geom,
<a name="l00199"></a>00199                                                   1, decal,
<a name="l00200"></a>00200                                                   faces,
<a name="l00201"></a>00201                                                   nb_col,
<a name="l00202"></a>00202                                                   option);
<a name="l00203"></a>00203 
<a name="l00204"></a>00204     <a class="code" href="classFormat__Post__Lata.html#ab01cd71e3e0e1220bbeb8e144b3f9731" title="Ecriture d&#39;un tableau d&#39;entiers dans le fichier fourni. Les valeurs ecrites sont les valeurs du table...">Format_Post_Lata::write_inttab</a>(fichier_geom,
<a name="l00205"></a>00205                                    1, decalage_faces,
<a name="l00206"></a>00206                                    elem_faces,
<a name="l00207"></a>00207                                    nb_col,
<a name="l00208"></a>00208                                    option);
<a name="l00209"></a>00209   }
<a name="l00210"></a>00210 
<a name="l00211"></a>00211   <a class="code" href="classFichier__Lata__maitre.html" title=": Specialisation du Fichier_Lata pour le fichier maitre: toujours en ASCII. On peut utiliser une prec...">Fichier_Lata_maitre</a> fichier_lata(basename, <a class="code" href="classFormat__Post__Lata.html#aee3312d2f199be29261229ab7f874a40" title="Renvoie l&#39;extension conventionnelle des fichiers lata : &quot;.lata&quot;.">extension_lata</a>(),
<a name="l00212"></a>00212                                    <a class="code" href="classFichier__Lata.html#afadf4963467b3123d9e9ec312644cb48ad9db95f97d41cea9e4338af8876bd408">Fichier_Lata::APPEND</a>, option);
<a name="l00213"></a>00213   <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a>&amp; sfichier = fichier_lata.<a class="code" href="classFichier__Lata.html#a18a15a1d2d7f0edccbb258f9da1526b3">get_SFichier</a>();
<a name="l00214"></a>00214 
<a name="l00215"></a>00215   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> filename_joint_faces;
<a name="l00216"></a>00216   <span class="keywordflow">if</span> (option == <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94a448f17201fc397a7da69a62ae0637043">SINGLE_FILE</a> &amp;&amp; <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
<a name="l00217"></a>00217     {
<a name="l00218"></a>00218       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> extension;
<a name="l00219"></a>00219       extension = <a class="code" href="classFormat__Post__Lata.html#aee3312d2f199be29261229ab7f874a40" title="Renvoie l&#39;extension conventionnelle des fichiers lata : &quot;.lata&quot;.">extension_lata</a>();
<a name="l00220"></a>00220       extension += <span class="stringliteral">&quot;.&quot;</span>;
<a name="l00221"></a>00221       extension += <span class="stringliteral">&quot;decal_faces_proc&quot;</span>;
<a name="l00222"></a>00222       extension += <span class="stringliteral">&quot;.&quot;</span>;
<a name="l00223"></a>00223       extension += id_du_domaine;
<a name="l00224"></a>00224       {
<a name="l00225"></a>00225         <a class="code" href="classFichier__Lata.html">Fichier_Lata</a> fichier_champ(basename, extension,
<a name="l00226"></a>00226                                    <a class="code" href="classFichier__Lata.html#afadf4963467b3123d9e9ec312644cb48aafea5adb55ed5ecc0b957884c5e754c1">Fichier_Lata::ERASE</a>, format, option);
<a name="l00227"></a>00227         filename_joint_faces = fichier_champ.<a class="code" href="classFichier__Lata.html#a8bcf7ecaa7806a6ae44979ff921370ca" title="Renvoie le nom du fichier avec le path.">get_filename</a>();
<a name="l00228"></a>00228         <span class="keywordtype">int</span> nb_col = -1; <span class="comment">//!&lt; non utilise</span>
<a name="l00229"></a>00229 <span class="comment"></span>        <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> data(1,2);
<a name="l00230"></a>00230         data(0, 0) = decalage_faces;
<a name="l00231"></a>00231         data(0, 1) = faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00232"></a>00232         <a class="code" href="classFormat__Post__Lata.html#ab01cd71e3e0e1220bbeb8e144b3f9731" title="Ecriture d&#39;un tableau d&#39;entiers dans le fichier fourni. Les valeurs ecrites sont les valeurs du table...">Format_Post_Lata::write_inttab</a>(fichier_champ,0,  0 <span class="comment">/* ne pas ajouter de decalage */</span>,
<a name="l00233"></a>00233                                        data, nb_col, option);
<a name="l00234"></a>00234       }
<a name="l00235"></a>00235     }
<a name="l00236"></a>00236 
<a name="l00237"></a>00237   <span class="keywordflow">if</span> (fichier_lata.<a class="code" href="classFichier__Lata.html#a1a0c3473194894e5f5f79530abc45564" title="Si le fichier est de type partage, renvoie 1 si me() est egal au master du groupe et 0 sinon...">is_master</a>())
<a name="l00238"></a>00238     {
<a name="l00239"></a>00239       sfichier &lt;&lt; <span class="stringliteral">&quot;nb_faces_tot=&quot;</span> &lt;&lt; nb_faces_tot &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00240"></a>00240       <span class="keywordflow">if</span> (option == <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94a448f17201fc397a7da69a62ae0637043">SINGLE_FILE</a> &amp;&amp; <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
<a name="l00241"></a>00241         {
<a name="l00242"></a>00242           <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">nproc</a> = <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>();
<a name="l00243"></a>00243           sfichier &lt;&lt; <span class="stringliteral">&quot;joints_faces nproc=&quot;</span> &lt;&lt; nproc &lt;&lt; <span class="stringliteral">&quot; decalage=&quot;</span> &lt;&lt; <a class="code" href="classFormat__Post__Lata.html#a033716caeef1f9b96458757fa911e2d8" title="Renvoie le nom d&#39;un fichier sans le path : on enleve les caracteres avant le dernier /...">remove_path</a>(filename_joint_faces) &lt;&lt; finl;
<a name="l00244"></a>00244         }
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246   fichier_lata.<a class="code" href="classFichier__Lata.html#af042e59f9c02f4d9c4087e126d711426" title="Si le fichier est de type partage, appelle la methode syncfile(), sinon ne fait rien.">syncfile</a>();
<a name="l00247"></a>00247 
<a name="l00248"></a>00248   <span class="keywordflow">return</span> 1; <span class="comment">//!&lt; ok tout va bien</span>
<a name="l00249"></a>00249 <span class="comment"></span>}
<a name="l00250"></a>00250 
<a name="l00251"></a>00251 
<a name="l00252"></a><a class="code" href="classFormat__Post__Lata__V1.html#a85d51776e115f5367776ea8acf42f123">00252</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lata__V1.html#a85d51776e115f5367776ea8acf42f123">Format_Post_Lata_V1::ecrire_domaine_lata_V1</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; id_domaine,
<a name="l00253"></a>00253                                                 <span class="keyword">const</span> <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>&amp; <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>,
<a name="l00254"></a>00254                                                 <span class="keyword">const</span> <span class="keywordtype">int</span> dim,
<a name="l00255"></a>00255                                                 <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; sommets,
<a name="l00256"></a>00256                                                 <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elements,
<a name="l00257"></a>00257                                                 <span class="keyword">const</span> <a class="code" href="classFormat__Post__Lata.html#a94fde71d0a9cc3249bff7f66cc4aeacc">Status</a>&amp; stat, <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; basename, <span class="keyword">const</span> <a class="code" href="classFormat__Post__Lata.html#a8698c5e7e825c54749a7365f7ffff53c">Format</a>&amp;
<a name="l00258"></a>00258                                                 format, <span class="keyword">const</span> <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94">Options_Para</a>&amp; <a class="code" href="classoption.html">option</a>)
<a name="l00259"></a>00259 {
<a name="l00260"></a>00260 
<a name="l00261"></a>00261   <span class="keywordflow">if</span> (stat &gt; <a class="code" href="classFormat__Post__Lata.html#a94fde71d0a9cc3249bff7f66cc4aeaccae95363a94fad9ca940d985500b7f561f">INITIALIZED</a>)
<a name="l00262"></a>00262     {
<a name="l00263"></a>00263       <span class="keywordflow">return</span> 0; <span class="comment">//!&lt; Ecriture tardive des domaines dynamiques non supportee</span>
<a name="l00264"></a>00264 <span class="comment"></span>    }
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 <span class="comment">// Construction du nom du fichier de geometrie</span>
<a name="l00267"></a>00267   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> basename_geom(basename);
<a name="l00268"></a>00268   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> extension_geom(<a class="code" href="classFormat__Post__Lata.html#aee3312d2f199be29261229ab7f874a40" title="Renvoie l&#39;extension conventionnelle des fichiers lata : &quot;.lata&quot;.">extension_lata</a>());
<a name="l00269"></a>00269   extension_geom += <span class="stringliteral">&quot;.&quot;</span>;
<a name="l00270"></a>00270   extension_geom += id_domaine;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_fichier_geom;
<a name="l00273"></a>00273 <span class="comment">// Indice global attribue au premier sommet de ce processeur:</span>
<a name="l00274"></a>00274   <span class="keywordtype">int</span> decalage_sommets = -1;
<a name="l00275"></a>00275   <span class="keywordtype">int</span> decalage_elements = -1;
<a name="l00276"></a>00276   {
<a name="l00277"></a>00277     <a class="code" href="classFichier__Lata.html">Fichier_Lata</a> fichier_geom(basename_geom, extension_geom,
<a name="l00278"></a>00278                               <a class="code" href="classFichier__Lata.html#afadf4963467b3123d9e9ec312644cb48aafea5adb55ed5ecc0b957884c5e754c1">Fichier_Lata::ERASE</a>, format,option);
<a name="l00279"></a>00279 
<a name="l00280"></a>00280     nom_fichier_geom = fichier_geom.<a class="code" href="classFichier__Lata.html#a8bcf7ecaa7806a6ae44979ff921370ca" title="Renvoie le nom du fichier avec le path.">get_filename</a>();
<a name="l00281"></a>00281     <span class="keywordtype">int</span> nb_col;
<a name="l00282"></a>00282 <span class="comment">// Coordonnees des sommets</span>
<a name="l00283"></a>00283     <span class="keyword">const</span> <span class="keywordtype">int</span> nb_sommets = sommets.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00284"></a>00284 
<a name="l00285"></a>00285     <span class="keywordflow">if</span> (dim==2)
<a name="l00286"></a>00286       {
<a name="l00287"></a>00287 <span class="comment">// Ecriture en deux fois : tous les processeurs ecrivent une premiere rangee</span>
<a name="l00288"></a>00288 <span class="comment">// de sommets, puis tous les processeurs ecrivent une deuxieme rangee.</span>
<a name="l00289"></a>00289         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bloc_number = 0; bloc_number &lt; 2; bloc_number++)
<a name="l00290"></a>00290           {
<a name="l00291"></a>00291             <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> sommets2(nb_sommets, 3);
<a name="l00292"></a>00292             <span class="keyword">const</span> <span class="keywordtype">double</span> z = (bloc_number == 0) ? 0. : 1.;
<a name="l00293"></a>00293             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_sommets; i++)
<a name="l00294"></a>00294               {
<a name="l00295"></a>00295                 <span class="keywordtype">double</span> x = sommets(i,0);
<a name="l00296"></a>00296                 <span class="keywordtype">double</span> y = sommets(i,1);
<a name="l00297"></a>00297                 <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#ad9b82ace9d4c7902ec704b6a78f76991">axi</a>)
<a name="l00298"></a>00298                   {
<a name="l00299"></a>00299                     <span class="keywordtype">double</span> r = x;
<a name="l00300"></a>00300                     <span class="keywordtype">double</span> theta = y;
<a name="l00301"></a>00301                     x = r * cos(theta);
<a name="l00302"></a>00302                     y = r * sin(theta);
<a name="l00303"></a>00303                   }
<a name="l00304"></a>00304                 sommets2(i,0) = x;
<a name="l00305"></a>00305                 sommets2(i,1) = y;
<a name="l00306"></a>00306                 sommets2(i,2) = z;
<a name="l00307"></a>00307               }
<a name="l00308"></a>00308             <a class="code" href="classFormat__Post__Lata.html#a943396fe8d7fbcf408da73a1f59cdebe" title="fichier est un fichier lata de donnees (pas le fichier maitre) on y ecrit le tableau tab tel quel (en...">Format_Post_Lata::write_doubletab</a>(fichier_geom, sommets2, nb_col, option,
<a name="l00309"></a>00309                                               bloc_number, 2);
<a name="l00310"></a>00310           }
<a name="l00311"></a>00311 
<a name="l00312"></a>00312       }
<a name="l00313"></a>00313     <span class="keywordflow">else</span>
<a name="l00314"></a>00314       {
<a name="l00315"></a>00315 
<a name="l00316"></a>00316         <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#ad9b82ace9d4c7902ec704b6a78f76991">axi</a>)
<a name="l00317"></a>00317           {
<a name="l00318"></a>00318             <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> sommets2(sommets);
<a name="l00319"></a>00319             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_sommets; i++)
<a name="l00320"></a>00320               {
<a name="l00321"></a>00321                 <span class="keywordtype">double</span> r = sommets(i,0);
<a name="l00322"></a>00322                 <span class="keywordtype">double</span> theta = sommets(i,1);
<a name="l00323"></a>00323                 <span class="keywordtype">double</span> z = sommets(i,2);
<a name="l00324"></a>00324                 sommets2(i,0) = r*cos(theta);
<a name="l00325"></a>00325                 sommets2(i,1) = r*sin(theta);
<a name="l00326"></a>00326                 sommets2(i,2) = z;
<a name="l00327"></a>00327               }
<a name="l00328"></a>00328             <a class="code" href="classFormat__Post__Lata.html#a943396fe8d7fbcf408da73a1f59cdebe" title="fichier est un fichier lata de donnees (pas le fichier maitre) on y ecrit le tableau tab tel quel (en...">Format_Post_Lata::write_doubletab</a>(fichier_geom, sommets2, nb_col,option);
<a name="l00329"></a>00329           }
<a name="l00330"></a>00330         <span class="keywordflow">else</span>
<a name="l00331"></a>00331           {
<a name="l00332"></a>00332             <a class="code" href="classFormat__Post__Lata.html#a943396fe8d7fbcf408da73a1f59cdebe" title="fichier est un fichier lata de donnees (pas le fichier maitre) on y ecrit le tableau tab tel quel (en...">Format_Post_Lata::write_doubletab</a>(fichier_geom, sommets, nb_col,option);
<a name="l00333"></a>00333           }
<a name="l00334"></a>00334       }
<a name="l00335"></a>00335 <span class="comment">// Elements</span>
<a name="l00336"></a>00336 <span class="comment">// Les indices de sommets, elements et autres dans le fichier lata commencent a 1 :</span>
<a name="l00337"></a>00337     <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem = elements.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00338"></a>00338     <span class="keywordflow">if</span> (option == <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94a448f17201fc397a7da69a62ae0637043">SINGLE_FILE</a> &amp;&amp; <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
<a name="l00339"></a>00339       {
<a name="l00340"></a>00340 <span class="comment">// Tous les processeurs ecrivent dans le meme fichier. Il faut renumeroter les</span>
<a name="l00341"></a>00341 <span class="comment">// sommets des elements pour avoir une numerotation globale.</span>
<a name="l00342"></a>00342 <span class="comment">// On ajoute un pour numerotation fortran</span>
<a name="l00343"></a>00343         decalage_sommets = 1 + <a class="code" href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071" title="Calul de la somme partielle de i sur les processeurs 0 a me()-1 (renvoie 0 sur le processeur 0)...">mppartial_sum</a>(nb_sommets);
<a name="l00344"></a>00344         decalage_elements = 1 + <a class="code" href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071" title="Calul de la somme partielle de i sur les processeurs 0 a me()-1 (renvoie 0 sur le processeur 0)...">mppartial_sum</a>(nb_elem);
<a name="l00345"></a>00345       }
<a name="l00346"></a>00346     <span class="keywordflow">else</span>
<a name="l00347"></a>00347       {
<a name="l00348"></a>00348 <span class="comment">// Chaque processeur ecrit dans un fichier separe avec des indices locaux.</span>
<a name="l00349"></a>00349 <span class="comment">// On ajoute un pour numerotation fortran</span>
<a name="l00350"></a>00350         decalage_sommets = 1;
<a name="l00351"></a>00351         decalage_elements = 1;
<a name="l00352"></a>00352       }
<a name="l00353"></a>00353     <span class="keywordflow">if</span> (dim==2)
<a name="l00354"></a>00354       {
<a name="l00355"></a>00355 <span class="comment">// Decalage a ajouter a un indice de sommet pour passer de la rangee z=0</span>
<a name="l00356"></a>00356 <span class="comment">// a la rangee z=1</span>
<a name="l00357"></a>00357         <span class="keywordtype">int</span> decalage_z1 = nb_sommets;
<a name="l00358"></a>00358         <span class="keywordflow">if</span> (option == <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94a448f17201fc397a7da69a62ae0637043">SINGLE_FILE</a> &amp;&amp; <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
<a name="l00359"></a>00359           decalage_z1 = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_sum</a>(nb_sommets);
<a name="l00360"></a>00360         <span class="keyword">const</span> <span class="keywordtype">int</span> nsomelem = (elements.<a class="code" href="classIntTab.html#ae307ece7edbe1d5facfbb81953b3e2b1" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() &gt; 1) ? elements.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) : 1;
<a name="l00361"></a>00361         <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> elem2(nb_elem, nsomelem*2);
<a name="l00362"></a>00362         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_elem; i++)
<a name="l00363"></a>00363           {
<a name="l00364"></a>00364             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nsomelem; j++)
<a name="l00365"></a>00365               {
<a name="l00366"></a>00366                 <span class="keyword">const</span> <span class="keywordtype">int</span> s = elements(i,j);
<a name="l00367"></a>00367                 elem2(i,j) = s;
<a name="l00368"></a>00368                 elem2(i,j + nsomelem) = s + decalage_z1;
<a name="l00369"></a>00369               }
<a name="l00370"></a>00370           }
<a name="l00371"></a>00371         <a class="code" href="classFormat__Post__Lata.html#ab01cd71e3e0e1220bbeb8e144b3f9731" title="Ecriture d&#39;un tableau d&#39;entiers dans le fichier fourni. Les valeurs ecrites sont les valeurs du table...">Format_Post_Lata::write_inttab</a>(fichier_geom, 1,decalage_sommets, elem2, nb_col, option);
<a name="l00372"></a>00372       }
<a name="l00373"></a>00373     <span class="keywordflow">else</span>
<a name="l00374"></a>00374       {
<a name="l00375"></a>00375         <a class="code" href="classFormat__Post__Lata.html#ab01cd71e3e0e1220bbeb8e144b3f9731" title="Ecriture d&#39;un tableau d&#39;entiers dans le fichier fourni. Les valeurs ecrites sont les valeurs du table...">Format_Post_Lata::write_inttab</a>(fichier_geom, 1,decalage_sommets, elements, nb_col, option);
<a name="l00376"></a>00376       }
<a name="l00377"></a>00377   }
<a name="l00378"></a>00378 <span class="comment">// En mode parallele, on ecrit en plus des fichiers contenant les donnees paralleles</span>
<a name="l00379"></a>00379 <span class="comment">// sur les sommets, les elements et les faces...</span>
<a name="l00380"></a>00380 <span class="comment">// On ecrit dans le fichier maitre ceci :</span>
<a name="l00381"></a>00381 <span class="comment">// joints_sommets NPROC FICHIER_NB_SOMMETS FICHIER_NB_SOMMETS_JOINTS FICHIER_JOINTS</span>
<a name="l00382"></a>00382 <span class="comment">// NPROC est le nombre de parties</span>
<a name="l00383"></a>00383 <span class="comment">// FICHIER_NB_SOMMETS est le nom du fichier contenant, pour chaque proc, le nombre de</span>
<a name="l00384"></a>00384 <span class="comment">// sommets sur ce processeur</span>
<a name="l00385"></a>00385 <span class="comment">// FICHIER_JOINTS est le nom du fichier contenant les joints</span>
<a name="l00386"></a>00386 <span class="comment">// Dans FICHIER_NB_SOMMETS, on a un tableau contenant NPROC entiers, le nombre de sommets</span>
<a name="l00387"></a>00387 <span class="comment">// ecrits par chaque processeur</span>
<a name="l00388"></a>00388 <span class="comment">// Dans FICHIER_NB_SOMMETS_JOINTS, on a un tableau de NPROC entiers contenant pour chaque</span>
<a name="l00389"></a>00389 <span class="comment">// proc le nombre de sommets de joint</span>
<a name="l00390"></a>00390 <span class="comment">// Dans FICHIER_JOINTS on a un tableau contenant les sommets de joint de chaque processeur,</span>
<a name="l00391"></a>00391 <span class="comment">// en numerotation globale : pour chaque sommet, indice du sommet local, indice du sommet</span>
<a name="l00392"></a>00392 <span class="comment">// equivalent sur une autre sous-partie, numero de la sous-partie</span>
<a name="l00393"></a>00393   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> filename_decal_som;
<a name="l00394"></a>00394   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> filename_decal_elem;
<a name="l00395"></a>00395   <span class="keywordflow">if</span> (option == <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94a448f17201fc397a7da69a62ae0637043">SINGLE_FILE</a> &amp;&amp; <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
<a name="l00396"></a>00396     {
<a name="l00397"></a>00397       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> extension;
<a name="l00398"></a>00398       extension = <a class="code" href="classFormat__Post__Lata.html#aee3312d2f199be29261229ab7f874a40" title="Renvoie l&#39;extension conventionnelle des fichiers lata : &quot;.lata&quot;.">extension_lata</a>();
<a name="l00399"></a>00399       extension += <span class="stringliteral">&quot;.&quot;</span>;
<a name="l00400"></a>00400       extension += <span class="stringliteral">&quot;decal_som_proc&quot;</span>;
<a name="l00401"></a>00401       extension += <span class="stringliteral">&quot;.&quot;</span>;
<a name="l00402"></a>00402       extension += id_domaine;
<a name="l00403"></a>00403 
<a name="l00404"></a>00404       {
<a name="l00405"></a>00405         <a class="code" href="classFichier__Lata.html">Fichier_Lata</a> fichier_champ(basename, extension,
<a name="l00406"></a>00406                                    <a class="code" href="classFichier__Lata.html#afadf4963467b3123d9e9ec312644cb48aafea5adb55ed5ecc0b957884c5e754c1">Fichier_Lata::ERASE</a>, format, option);
<a name="l00407"></a>00407         filename_decal_som = fichier_champ.<a class="code" href="classFichier__Lata.html#a8bcf7ecaa7806a6ae44979ff921370ca" title="Renvoie le nom du fichier avec le path.">get_filename</a>();
<a name="l00408"></a>00408         <span class="keywordtype">int</span> nb_col = -1; <span class="comment">//!&lt; non utilise</span>
<a name="l00409"></a>00409 <span class="comment"></span>        <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> data(1,2);
<a name="l00410"></a>00410         data(0, 0) = decalage_sommets;
<a name="l00411"></a>00411         data(0, 1) = sommets.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00412"></a>00412         <a class="code" href="classFormat__Post__Lata.html#ab01cd71e3e0e1220bbeb8e144b3f9731" title="Ecriture d&#39;un tableau d&#39;entiers dans le fichier fourni. Les valeurs ecrites sont les valeurs du table...">Format_Post_Lata::write_inttab</a>(fichier_champ,0, 0 <span class="comment">/* ne pas ajouter de decalage */</span>,
<a name="l00413"></a>00413                                        data, nb_col, option);
<a name="l00414"></a>00414       }
<a name="l00415"></a>00415 
<a name="l00416"></a>00416       extension = <a class="code" href="classFormat__Post__Lata.html#aee3312d2f199be29261229ab7f874a40" title="Renvoie l&#39;extension conventionnelle des fichiers lata : &quot;.lata&quot;.">extension_lata</a>();
<a name="l00417"></a>00417       extension += <span class="stringliteral">&quot;.&quot;</span>;
<a name="l00418"></a>00418       extension += <span class="stringliteral">&quot;decal_elem_proc&quot;</span>;
<a name="l00419"></a>00419       extension += <span class="stringliteral">&quot;.&quot;</span>;
<a name="l00420"></a>00420       extension += id_domaine;
<a name="l00421"></a>00421 
<a name="l00422"></a>00422       {
<a name="l00423"></a>00423         <a class="code" href="classFichier__Lata.html">Fichier_Lata</a> fichier_champ(basename, extension,
<a name="l00424"></a>00424                                    <a class="code" href="classFichier__Lata.html#afadf4963467b3123d9e9ec312644cb48aafea5adb55ed5ecc0b957884c5e754c1">Fichier_Lata::ERASE</a>, format, option);
<a name="l00425"></a>00425         filename_decal_elem = fichier_champ.<a class="code" href="classFichier__Lata.html#a8bcf7ecaa7806a6ae44979ff921370ca" title="Renvoie le nom du fichier avec le path.">get_filename</a>();
<a name="l00426"></a>00426         <span class="keywordtype">int</span> nb_col = -1; <span class="comment">//!&lt; non utilise</span>
<a name="l00427"></a>00427 <span class="comment"></span>        <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> data(1,2);
<a name="l00428"></a>00428         data(0, 0) = decalage_elements;
<a name="l00429"></a>00429         data(0, 1) = elements.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00430"></a>00430         <a class="code" href="classFormat__Post__Lata.html#ab01cd71e3e0e1220bbeb8e144b3f9731" title="Ecriture d&#39;un tableau d&#39;entiers dans le fichier fourni. Les valeurs ecrites sont les valeurs du table...">Format_Post_Lata::write_inttab</a>(fichier_champ,0, 0 <span class="comment">/* ne pas ajouter de decalage */</span>,
<a name="l00431"></a>00431                                        data, nb_col, option);
<a name="l00432"></a>00432       }
<a name="l00433"></a>00433     }
<a name="l00434"></a>00434 
<a name="l00435"></a>00435   <a class="code" href="classFichier__Lata__maitre.html" title=": Specialisation du Fichier_Lata pour le fichier maitre: toujours en ASCII. On peut utiliser une prec...">Fichier_Lata_maitre</a> fichier_lata(basename, <a class="code" href="classFormat__Post__Lata.html#aee3312d2f199be29261229ab7f874a40" title="Renvoie l&#39;extension conventionnelle des fichiers lata : &quot;.lata&quot;.">extension_lata</a>(),
<a name="l00436"></a>00436                                    <a class="code" href="classFichier__Lata.html#afadf4963467b3123d9e9ec312644cb48ad9db95f97d41cea9e4338af8876bd408">Fichier_Lata::APPEND</a>,option);
<a name="l00437"></a>00437   <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a>&amp; sfichier = fichier_lata.<a class="code" href="classFichier__Lata.html#a18a15a1d2d7f0edccbb258f9da1526b3">get_SFichier</a>();
<a name="l00438"></a>00438 
<a name="l00439"></a>00439   <span class="keywordtype">int</span> nb_som_tot = sommets.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00440"></a>00440   <span class="keywordtype">int</span> nb_elem_tot = elements.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00441"></a>00441   <span class="keywordflow">if</span> (option == <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94a448f17201fc397a7da69a62ae0637043">SINGLE_FILE</a> &amp;&amp; <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
<a name="l00442"></a>00442     {
<a name="l00443"></a>00443       nb_som_tot = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_sum</a>(nb_som_tot);
<a name="l00444"></a>00444       nb_elem_tot = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_sum</a>(nb_elem_tot);
<a name="l00445"></a>00445     }
<a name="l00446"></a>00446   <span class="keywordflow">if</span> (fichier_lata.<a class="code" href="classFichier__Lata.html#a1a0c3473194894e5f5f79530abc45564" title="Si le fichier est de type partage, renvoie 1 si me() est egal au master du groupe et 0 sinon...">is_master</a>())
<a name="l00447"></a>00447     {
<a name="l00448"></a>00448       sfichier &lt;&lt; <span class="stringliteral">&quot;Geometrie &quot;</span> &lt;&lt; id_domaine;
<a name="l00449"></a>00449       sfichier &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classFormat__Post__Lata.html#a033716caeef1f9b96458757fa911e2d8" title="Renvoie le nom d&#39;un fichier sans le path : on enleve les caracteres avant le dernier /...">remove_path</a>(nom_fichier_geom) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00450"></a>00450       <span class="keywordflow">switch</span>(format)
<a name="l00451"></a>00451         {
<a name="l00452"></a>00452         <span class="keywordflow">case</span> <a class="code" href="classFormat__Post__Lata.html#a8698c5e7e825c54749a7365f7ffff53ca64e753afccaf02de631ef2ad18733aab">ASCII</a>:
<a name="l00453"></a>00453           sfichier &lt;&lt; <span class="stringliteral">&quot;Format=ascii&quot;</span> &lt;&lt; finl;
<a name="l00454"></a>00454           <span class="keywordflow">break</span>;
<a name="l00455"></a>00455         <span class="keywordflow">case</span> <a class="code" href="classFormat__Post__Lata.html#a8698c5e7e825c54749a7365f7ffff53ca2d3fa963128b6785fca8a03841962e16">BINAIRE</a>:
<a name="l00456"></a>00456           sfichier &lt;&lt; <span class="stringliteral">&quot;Format=binary&quot;</span> &lt;&lt; finl;
<a name="l00457"></a>00457           <span class="keywordflow">break</span>;
<a name="l00458"></a>00458         <span class="keywordflow">default</span>:
<a name="l00459"></a>00459           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Format_Post_Lata_V1::ecrire_entete\n&quot;</span>
<a name="l00460"></a>00460                &lt;&lt; <span class="stringliteral">&quot; format not supported&quot;</span> &lt;&lt; finl;
<a name="l00461"></a>00461           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00462"></a>00462         }
<a name="l00463"></a>00463       sfichier &lt;&lt; <span class="stringliteral">&quot;nb_som_tot=&quot;</span> &lt;&lt; nb_som_tot &lt;&lt; finl;
<a name="l00464"></a>00464       sfichier &lt;&lt; <span class="stringliteral">&quot;type_elem=&quot;</span> &lt;&lt; type_elem &lt;&lt; finl;
<a name="l00465"></a>00465       sfichier &lt;&lt; <span class="stringliteral">&quot;nb_elem_tot=&quot;</span> &lt;&lt; nb_elem_tot &lt;&lt; finl;
<a name="l00466"></a>00466       <span class="keywordflow">if</span> (option == <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94a448f17201fc397a7da69a62ae0637043">SINGLE_FILE</a> &amp;&amp; <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>() &gt; 1)
<a name="l00467"></a>00467         {
<a name="l00468"></a>00468           <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">nproc</a> = <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>();
<a name="l00469"></a>00469           sfichier &lt;&lt; <span class="stringliteral">&quot;joints_sommets nproc=&quot;</span> &lt;&lt; nproc &lt;&lt; <span class="stringliteral">&quot; decalage=&quot;</span> &lt;&lt; <a class="code" href="classFormat__Post__Lata.html#a033716caeef1f9b96458757fa911e2d8" title="Renvoie le nom d&#39;un fichier sans le path : on enleve les caracteres avant le dernier /...">remove_path</a>(filename_decal_som) &lt;&lt; finl;
<a name="l00470"></a>00470           sfichier &lt;&lt; <span class="stringliteral">&quot;joints_elements nproc=&quot;</span> &lt;&lt; nproc &lt;&lt; <span class="stringliteral">&quot; decalage=&quot;</span> &lt;&lt; <a class="code" href="classFormat__Post__Lata.html#a033716caeef1f9b96458757fa911e2d8" title="Renvoie le nom d&#39;un fichier sans le path : on enleve les caracteres avant le dernier /...">remove_path</a>(filename_decal_elem) &lt;&lt; finl;
<a name="l00471"></a>00471         }
<a name="l00472"></a>00472     }
<a name="l00473"></a>00473   fichier_lata.<a class="code" href="classFichier__Lata.html#af042e59f9c02f4d9c4087e126d711426" title="Si le fichier est de type partage, appelle la methode syncfile(), sinon ne fait rien.">syncfile</a>();
<a name="l00474"></a>00474   <span class="keywordflow">return</span> 1;
<a name="l00475"></a>00475 }
<a name="l00476"></a>00476 
<a name="l00477"></a><a class="code" href="classFormat__Post__Lata__V1.html#a5475ccf227ff2a3a475efab37e078820">00477</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lata__V1.html#a5475ccf227ff2a3a475efab37e078820">Format_Post_Lata_V1::ecrire_entete_lata_V1</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; basename,<span class="keyword">const</span> <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94">Options_Para</a>&amp; <a class="code" href="classoption.html">option</a>,<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; est_le_premier_post)
<a name="l00478"></a>00478 {
<a name="l00479"></a>00479 
<a name="l00480"></a>00480   <span class="keywordflow">if</span> (est_le_premier_post)
<a name="l00481"></a>00481     {
<a name="l00482"></a>00482 
<a name="l00483"></a>00483 <span class="comment">// Effacement du fichier .lata et ecriture de l&#39;entete</span>
<a name="l00484"></a>00484       <a class="code" href="classFichier__Lata__maitre.html" title=": Specialisation du Fichier_Lata pour le fichier maitre: toujours en ASCII. On peut utiliser une prec...">Fichier_Lata_maitre</a> fichier(basename, <a class="code" href="classFormat__Post__Lata.html#aee3312d2f199be29261229ab7f874a40" title="Renvoie l&#39;extension conventionnelle des fichiers lata : &quot;.lata&quot;.">extension_lata</a>(),
<a name="l00485"></a>00485                                   <a class="code" href="classFichier__Lata.html#afadf4963467b3123d9e9ec312644cb48aafea5adb55ed5ecc0b957884c5e754c1">Fichier_Lata::ERASE</a>,
<a name="l00486"></a>00486                                   option);
<a name="l00487"></a>00487 
<a name="l00488"></a>00488       <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a>&amp; sfichier = fichier.<a class="code" href="classFichier__Lata.html#a18a15a1d2d7f0edccbb258f9da1526b3">get_SFichier</a>();
<a name="l00489"></a>00489       <span class="keywordflow">if</span> (fichier.<a class="code" href="classFichier__Lata.html#a1a0c3473194894e5f5f79530abc45564" title="Si le fichier est de type partage, renvoie 1 si me() est egal au master du groupe et 0 sinon...">is_master</a>())
<a name="l00490"></a>00490         {
<a name="l00491"></a>00491           sfichier &lt;&lt; <span class="stringliteral">&quot;Trio_U Version1.4.9 06/2005&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00492"></a>00492           sfichier &lt;&lt; <a class="code" href="classObjet__U.html#a7c27c4f80259eeef76ff8fe2d3bc61f7" title="Renvoie une reference constante vers le nom du cas. Cette methode est statique.">Objet_U::nom_du_cas</a>() &lt;&lt; finl;
<a name="l00493"></a>00493           sfichier &lt;&lt; <span class="stringliteral">&quot;Trio_U&quot;</span> &lt;&lt; finl;
<a name="l00494"></a>00494         }
<a name="l00495"></a>00495       fichier.<a class="code" href="classFichier__Lata.html#af042e59f9c02f4d9c4087e126d711426" title="Si le fichier est de type partage, appelle la methode syncfile(), sinon ne fait rien.">syncfile</a>();
<a name="l00496"></a>00496 
<a name="l00497"></a>00497     }
<a name="l00498"></a>00498 
<a name="l00499"></a>00499   <span class="keywordflow">return</span> 1;
<a name="l00500"></a>00500 }
<a name="l00501"></a>00501 
<a name="l00502"></a><a class="code" href="classFormat__Post__Lata__V1.html#a55bc04cca75ec56390034e84a0e885e7">00502</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lata__V1.html#a55bc04cca75ec56390034e84a0e885e7">Format_Post_Lata_V1::finir_lata_V1</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; basename,<span class="keyword">const</span> <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94">Options_Para</a>&amp; <a class="code" href="classoption.html">option</a>,<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; est_le_dernier_post)
<a name="l00503"></a>00503 {
<a name="l00504"></a>00504 
<a name="l00505"></a>00505   <span class="keywordflow">if</span> (est_le_dernier_post)
<a name="l00506"></a>00506     {
<a name="l00507"></a>00507       <a class="code" href="classFichier__Lata__maitre.html" title=": Specialisation du Fichier_Lata pour le fichier maitre: toujours en ASCII. On peut utiliser une prec...">Fichier_Lata_maitre</a> fichier(basename, <a class="code" href="classFormat__Post__Lata.html#aee3312d2f199be29261229ab7f874a40" title="Renvoie l&#39;extension conventionnelle des fichiers lata : &quot;.lata&quot;.">extension_lata</a>(),
<a name="l00508"></a>00508                                   <a class="code" href="classFichier__Lata.html#afadf4963467b3123d9e9ec312644cb48ad9db95f97d41cea9e4338af8876bd408">Fichier_Lata::APPEND</a>,
<a name="l00509"></a>00509                                   option);
<a name="l00510"></a>00510       <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a>&amp; sfichier = fichier.<a class="code" href="classFichier__Lata.html#a18a15a1d2d7f0edccbb258f9da1526b3">get_SFichier</a>();
<a name="l00511"></a>00511       <span class="keywordflow">if</span> (fichier.<a class="code" href="classFichier__Lata.html#a1a0c3473194894e5f5f79530abc45564" title="Si le fichier est de type partage, renvoie 1 si me() est egal au master du groupe et 0 sinon...">is_master</a>())
<a name="l00512"></a>00512         {
<a name="l00513"></a>00513           sfichier &lt;&lt; <span class="stringliteral">&quot;FIN&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00514"></a>00514 
<a name="l00515"></a>00515         }
<a name="l00516"></a>00516       fichier.<a class="code" href="classFichier__Lata.html#af042e59f9c02f4d9c4087e126d711426" title="Si le fichier est de type partage, appelle la methode syncfile(), sinon ne fait rien.">syncfile</a>();
<a name="l00517"></a>00517     }
<a name="l00518"></a>00518   <span class="keywordflow">return</span> 1;
<a name="l00519"></a>00519 }
<a name="l00520"></a>00520 
<a name="l00521"></a><a class="code" href="classFormat__Post__Lata__V1.html#a199128d963486e4af84af6c6ed6f9e02">00521</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lata__V1.html#a199128d963486e4af84af6c6ed6f9e02">Format_Post_Lata_V1::ecrire_champ_lata_V1</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   id_du_champ,
<a name="l00522"></a>00522                                               <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   id_du_domaine,
<a name="l00523"></a>00523                                               <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   localisation,
<a name="l00524"></a>00524                                               <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; data,<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; temps,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; basename,
<a name="l00525"></a>00525                                               <span class="keyword">const</span> <a class="code" href="classFormat__Post__Lata.html#a8698c5e7e825c54749a7365f7ffff53c">Format</a>&amp; format, <span class="keyword">const</span> <a class="code" href="classFormat__Post__Lata.html#a8de32871f6c5c4602655246c85410a94">Options_Para</a>&amp; <a class="code" href="classoption.html">option</a>)
<a name="l00526"></a>00526 {
<a name="l00527"></a>00527 <span class="comment">// Verification que le nom du champ correspond bien au</span>
<a name="l00528"></a>00528 <span class="comment">// nombre de coposante du champ grace a latav1_component_shape()</span>
<a name="l00529"></a>00529 <span class="comment">// Cette partie de codage pourra etre supprime quand le plugin</span>
<a name="l00530"></a>00530 <span class="comment">// LATA sera en mesure de gerer cela lui-meme (V2 ?)</span>
<a name="l00531"></a>00531   <span class="keywordtype">int</span> nb_comp,nb_comp_du_champ;
<a name="l00532"></a>00532   {
<a name="l00533"></a>00533     <span class="keywordtype">int</span> shape=1;
<a name="l00534"></a>00534     shape=latav1_component_shape(id_du_champ);
<a name="l00535"></a>00535 
<a name="l00536"></a>00536     <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> avec_s;
<a name="l00537"></a>00537     avec_s=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00538"></a>00538     nb_comp=1;
<a name="l00539"></a>00539     <span class="keywordflow">if</span> (shape&lt;0)
<a name="l00540"></a>00540       {
<a name="l00541"></a>00541         avec_s=<span class="stringliteral">&quot;s&quot;</span>;
<a name="l00542"></a>00542         <span class="keywordflow">if</span> (shape==-1)
<a name="l00543"></a>00543           nb_comp=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00544"></a>00544         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)
<a name="l00545"></a>00545           nb_comp=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00546"></a>00546       }
<a name="l00547"></a>00547     <span class="keywordflow">else</span>
<a name="l00548"></a>00548       nb_comp=shape;
<a name="l00549"></a>00549 
<a name="l00550"></a>00550     nb_comp_du_champ=data.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>();
<a name="l00551"></a>00551     <span class="keywordflow">if</span> (nb_comp_du_champ&gt;1)
<a name="l00552"></a>00552       nb_comp_du_champ=data.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00553"></a>00553 
<a name="l00554"></a>00554 <span class="comment">// On exclus tous les cas ou le champ qui est postraite aux faces, est scalaire mais interprete comme vectoriel</span>
<a name="l00555"></a>00555 <span class="comment">// Typiquement le cas de la vitesse aux faces en VDF : nb_comp = 2 ou 3 et nb_comp_du_champ = 1 car 1 seul vitesse normal par face.</span>
<a name="l00556"></a>00556     <span class="keywordflow">if</span> ((<a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>)localisation==<span class="stringliteral">&quot;FACES&quot;</span> &amp;&amp; nb_comp_du_champ&lt;nb_comp)
<a name="l00557"></a>00557       nb_comp_du_champ=nb_comp;
<a name="l00558"></a>00558 
<a name="l00559"></a>00559     <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> avec_ss;
<a name="l00560"></a>00560     avec_ss=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00561"></a>00561     <span class="keywordflow">if</span> (nb_comp_du_champ&gt;1)
<a name="l00562"></a>00562       avec_ss=<span class="stringliteral">&quot;s&quot;</span>;
<a name="l00563"></a>00563   }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 <span class="comment">// Modification de id_du_champ car l interpolation modifie le nom (ajout de elem_nom_du_domaine</span>
<a name="l00566"></a>00566 <span class="comment">// ou som_nom_du_domaine, on supprime cette extension)</span>
<a name="l00567"></a>00567   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> id_du_champ_modifie(id_du_champ);
<a name="l00568"></a>00568   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> iddomaine(id_du_domaine);
<a name="l00569"></a>00569 
<a name="l00570"></a>00570   <span class="keywordflow">if</span> (nb_comp!=nb_comp_du_champ)
<a name="l00571"></a>00571     {
<a name="l00572"></a>00572       id_du_champ_modifie=<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(nb_comp_du_champ);
<a name="l00573"></a>00573       id_du_champ_modifie+=<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00574"></a>00574       id_du_champ_modifie+=id_du_champ;
<a name="l00575"></a>00575     }
<a name="l00576"></a>00576 <span class="comment">// On utilise prefix avec un argument en majuscule</span>
<a name="l00577"></a>00577   <span class="keywordflow">if</span> ((<a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>)localisation==<span class="stringliteral">&quot;SOM&quot;</span>)
<a name="l00578"></a>00578     {
<a name="l00579"></a>00579       id_du_champ_modifie.<a class="code" href="classNom.html#aa296fc70f7abcf978968e09582d8fb06">prefix</a>(id_du_domaine);
<a name="l00580"></a>00580       id_du_champ_modifie.<a class="code" href="classNom.html#aa296fc70f7abcf978968e09582d8fb06">prefix</a>(iddomaine);
<a name="l00581"></a>00581 <span class="comment">//</span>
<a name="l00582"></a>00582       id_du_champ_modifie.<a class="code" href="classNom.html#aa296fc70f7abcf978968e09582d8fb06">prefix</a>(<span class="stringliteral">&quot;_SOM_&quot;</span>);
<a name="l00583"></a>00583     }
<a name="l00584"></a>00584   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>)localisation==<span class="stringliteral">&quot;ELEM&quot;</span>)
<a name="l00585"></a>00585     {
<a name="l00586"></a>00586       id_du_champ_modifie.<a class="code" href="classNom.html#aa296fc70f7abcf978968e09582d8fb06">prefix</a>(id_du_domaine);
<a name="l00587"></a>00587       id_du_champ_modifie.<a class="code" href="classNom.html#aa296fc70f7abcf978968e09582d8fb06">prefix</a>(iddomaine);
<a name="l00588"></a>00588 <span class="comment">//</span>
<a name="l00589"></a>00589       id_du_champ_modifie.<a class="code" href="classNom.html#aa296fc70f7abcf978968e09582d8fb06">prefix</a>(<span class="stringliteral">&quot;_ELEM_&quot;</span>);
<a name="l00590"></a>00590     }
<a name="l00591"></a>00591   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>)localisation==<span class="stringliteral">&quot;FACES&quot;</span>)
<a name="l00592"></a>00592     {
<a name="l00593"></a>00593       id_du_champ_modifie.<a class="code" href="classNom.html#aa296fc70f7abcf978968e09582d8fb06">prefix</a>(id_du_domaine);
<a name="l00594"></a>00594       id_du_champ_modifie.<a class="code" href="classNom.html#aa296fc70f7abcf978968e09582d8fb06">prefix</a>(iddomaine);
<a name="l00595"></a>00595       id_du_champ_modifie.<a class="code" href="classNom.html#aa296fc70f7abcf978968e09582d8fb06">prefix</a>(<span class="stringliteral">&quot;_FACES_&quot;</span>);
<a name="l00596"></a>00596     }
<a name="l00597"></a>00597 
<a name="l00598"></a>00598   <span class="keywordflow">if</span> ((<a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>)id_du_champ_modifie==<span class="stringliteral">&quot;VITESSEX&quot;</span>)
<a name="l00599"></a>00599     id_du_champ_modifie=<span class="stringliteral">&quot;VITESSEX&quot;</span>;
<a name="l00600"></a>00600   <span class="keywordflow">if</span> ((<a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>)id_du_champ_modifie==<span class="stringliteral">&quot;VITESSEY&quot;</span>)
<a name="l00601"></a>00601     id_du_champ_modifie=<span class="stringliteral">&quot;VITESSEY&quot;</span>;
<a name="l00602"></a>00602 
<a name="l00603"></a>00603   <span class="keywordflow">if</span> ((<a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>)id_du_champ_modifie==<span class="stringliteral">&quot;EPS&quot;</span>)
<a name="l00604"></a>00604     id_du_champ_modifie=<span class="stringliteral">&quot;EPS&quot;</span>;
<a name="l00605"></a>00605 
<a name="l00606"></a>00606   <span class="keyword">const</span> <span class="keywordtype">char</span> * point = <span class="stringliteral">&quot;.&quot;</span>;
<a name="l00607"></a>00607 <span class="comment">// Construction du nom du fichier</span>
<a name="l00608"></a>00608   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> basename_champ(basename);
<a name="l00609"></a>00609   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> extension_champ(<a class="code" href="classFormat__Post__Lata.html#aee3312d2f199be29261229ab7f874a40" title="Renvoie l&#39;extension conventionnelle des fichiers lata : &quot;.lata&quot;.">extension_lata</a>());
<a name="l00610"></a>00610   extension_champ += point;
<a name="l00611"></a>00611   extension_champ += id_du_champ_modifie;
<a name="l00612"></a>00612   extension_champ += point;
<a name="l00613"></a>00613   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> loc = localisation;
<a name="l00614"></a>00614 
<a name="l00615"></a>00615   <span class="keywordflow">if</span> (loc.<a class="code" href="classMotcle.html#a21aec57e000ddde2c472179e1ad4efb7">debute_par</a>(<span class="stringliteral">&quot;SOM&quot;</span>))
<a name="l00616"></a>00616     {
<a name="l00617"></a>00617       extension_champ += <span class="stringliteral">&quot;SOM&quot;</span>;
<a name="l00618"></a>00618     }
<a name="l00619"></a>00619   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc.<a class="code" href="classMotcle.html#a21aec57e000ddde2c472179e1ad4efb7">debute_par</a>(<span class="stringliteral">&quot;ELEM&quot;</span>))
<a name="l00620"></a>00620     {
<a name="l00621"></a>00621       extension_champ += <span class="stringliteral">&quot;ELEM&quot;</span>;
<a name="l00622"></a>00622     }
<a name="l00623"></a>00623   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc.<a class="code" href="classMotcle.html#a21aec57e000ddde2c472179e1ad4efb7">debute_par</a>(<span class="stringliteral">&quot;FACES&quot;</span>))
<a name="l00624"></a>00624     {
<a name="l00625"></a>00625       extension_champ += <span class="stringliteral">&quot;FACES&quot;</span>;
<a name="l00626"></a>00626     }
<a name="l00627"></a>00627   <span class="keywordflow">else</span>
<a name="l00628"></a>00628     {
<a name="l00629"></a>00629       <span class="keywordflow">return</span> 0;
<a name="l00630"></a>00630     }
<a name="l00631"></a>00631   extension_champ += point;
<a name="l00632"></a>00632   extension_champ += id_du_domaine;
<a name="l00633"></a>00633   extension_champ += point;
<a name="l00634"></a>00634   extension_champ += <span class="stringliteral">&quot;pb&quot;</span>;
<a name="l00635"></a>00635   extension_champ += point;
<a name="l00636"></a>00636   <span class="keywordtype">char</span> str_temps[100] = <span class="stringliteral">&quot;0.0&quot;</span>;
<a name="l00637"></a>00637   <span class="keywordflow">if</span> (temps &gt;= 0.)
<a name="l00638"></a>00638     sprintf(str_temps, <span class="stringliteral">&quot;%.10f&quot;</span>, temps);
<a name="l00639"></a>00639   extension_champ += str_temps;
<a name="l00640"></a>00640 
<a name="l00641"></a>00641   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> filename_champ;
<a name="l00642"></a>00642   {
<a name="l00643"></a>00643     <a class="code" href="classFichier__Lata.html">Fichier_Lata</a> fichier_champ(basename_champ, extension_champ,
<a name="l00644"></a>00644                                <a class="code" href="classFichier__Lata.html#afadf4963467b3123d9e9ec312644cb48aafea5adb55ed5ecc0b957884c5e754c1">Fichier_Lata::ERASE</a>, format,option);
<a name="l00645"></a>00645     filename_champ = fichier_champ.<a class="code" href="classFichier__Lata.html#a8bcf7ecaa7806a6ae44979ff921370ca" title="Renvoie le nom du fichier avec le path.">get_filename</a>();
<a name="l00646"></a>00646 
<a name="l00647"></a>00647     <span class="keywordflow">if</span> (data.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 1)
<a name="l00648"></a>00648       {
<a name="l00649"></a>00649         <span class="keywordtype">int</span> nb_colonnes;
<a name="l00650"></a>00650         <a class="code" href="classFormat__Post__Lata.html#a943396fe8d7fbcf408da73a1f59cdebe" title="fichier est un fichier lata de donnees (pas le fichier maitre) on y ecrit le tableau tab tel quel (en...">Format_Post_Lata::write_doubletab</a>(fichier_champ,
<a name="l00651"></a>00651                                           data,
<a name="l00652"></a>00652                                           nb_colonnes,
<a name="l00653"></a>00653                                           option);
<a name="l00654"></a>00654       }
<a name="l00655"></a>00655     <span class="keywordflow">else</span>
<a name="l00656"></a>00656       {
<a name="l00657"></a>00657 <span class="comment">// Pour compatibilite avec la version precedente du module lata :</span>
<a name="l00658"></a>00658 <span class="comment">// si le champ a plusieurs composantes,</span>
<a name="l00659"></a>00659 <span class="comment">// on ecrit :</span>
<a name="l00660"></a>00660 <span class="comment">// valeurs(0,0) valeurs(1,0) valeurs(2,0) ...</span>
<a name="l00661"></a>00661 <span class="comment">// valeurs(0,1) valeurs(1,1) valeurs(2,1) ...</span>
<a name="l00662"></a>00662         <span class="keyword">const</span> <span class="keywordtype">int</span> nb_lignes = data.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00663"></a>00663         <span class="keyword">const</span> <span class="keywordtype">int</span> nb_colonnes = data.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00664"></a>00664         <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> data_slice(nb_lignes);
<a name="l00665"></a>00665 <span class="comment">// Pour voir data comme un tableau unidimensionnel :</span>
<a name="l00666"></a>00666         <span class="keywordflow">if</span> (data.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() != 2)
<a name="l00667"></a>00667           {
<a name="l00668"></a>00668             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error : Format_Post_Lata_V1::ecrire_champ_lata_V1 not coded for dimensions &gt; 2&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00669"></a>00669             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00670"></a>00670           }
<a name="l00671"></a>00671         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> colonne = 0; colonne &lt; nb_colonnes; colonne++)
<a name="l00672"></a>00672           {
<a name="l00673"></a>00673             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_lignes; i++)
<a name="l00674"></a>00674               data_slice[i] = data(i, colonne);
<a name="l00675"></a>00675             <span class="keywordtype">int</span> dummy;
<a name="l00676"></a>00676             <a class="code" href="classFormat__Post__Lata.html#a943396fe8d7fbcf408da73a1f59cdebe" title="fichier est un fichier lata de donnees (pas le fichier maitre) on y ecrit le tableau tab tel quel (en...">Format_Post_Lata::write_doubletab</a>(fichier_champ,
<a name="l00677"></a>00677                                               data_slice,
<a name="l00678"></a>00678                                               dummy,
<a name="l00679"></a>00679                                               option,
<a name="l00680"></a>00680                                               colonne, nb_colonnes);
<a name="l00681"></a>00681           }
<a name="l00682"></a>00682       }
<a name="l00683"></a>00683   }
<a name="l00684"></a>00684 <span class="comment">// Ouverture du fichier .lata en mode append.</span>
<a name="l00685"></a>00685 <span class="comment">// Ajout de la reference au champ</span>
<a name="l00686"></a>00686 
<a name="l00687"></a>00687   <a class="code" href="classFichier__Lata__maitre.html" title=": Specialisation du Fichier_Lata pour le fichier maitre: toujours en ASCII. On peut utiliser une prec...">Fichier_Lata_maitre</a> fichier(basename, <a class="code" href="classFormat__Post__Lata.html#aee3312d2f199be29261229ab7f874a40" title="Renvoie l&#39;extension conventionnelle des fichiers lata : &quot;.lata&quot;.">extension_lata</a>(),
<a name="l00688"></a>00688                               <a class="code" href="classFichier__Lata.html#afadf4963467b3123d9e9ec312644cb48ad9db95f97d41cea9e4338af8876bd408">Fichier_Lata::APPEND</a>, option);
<a name="l00689"></a>00689   <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a>&amp; sfichier = fichier.<a class="code" href="classFichier__Lata.html#a18a15a1d2d7f0edccbb258f9da1526b3">get_SFichier</a>();
<a name="l00690"></a>00690   <span class="keywordflow">if</span> (fichier.<a class="code" href="classFichier__Lata.html#a1a0c3473194894e5f5f79530abc45564" title="Si le fichier est de type partage, renvoie 1 si me() est egal au master du groupe et 0 sinon...">is_master</a>())
<a name="l00691"></a>00691     {
<a name="l00692"></a>00692       sfichier &lt;&lt; <span class="stringliteral">&quot;Champ &quot;</span>;
<a name="l00693"></a>00693       sfichier &lt;&lt; id_du_champ_modifie &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00694"></a>00694       sfichier &lt;&lt; <a class="code" href="classFormat__Post__Lata.html#a033716caeef1f9b96458757fa911e2d8" title="Renvoie le nom d&#39;un fichier sans le path : on enleve les caracteres avant le dernier /...">remove_path</a>(filename_champ) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00695"></a>00695     }
<a name="l00696"></a>00696   fichier.<a class="code" href="classFichier__Lata.html#af042e59f9c02f4d9c4087e126d711426" title="Si le fichier est de type partage, appelle la methode syncfile(), sinon ne fait rien.">syncfile</a>();
<a name="l00697"></a>00697   <span class="keywordflow">return</span> 1;
<a name="l00698"></a>00698 }
<a name="l00699"></a>00699 
<a name="l00700"></a>00700 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:15 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
