<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VDF/Zones/Zone_VDF.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VDF/Zones/Zone_VDF.cpp</div>  </div>
</div>
<div class="contents">
<a href="Zone__VDF_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Zone_VDF.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VDF/Zones</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/37</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VDF_8h.html">Zone_VDF.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__VDF_8h.html">Zone_Cl_VDF.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Rectangle_8h.html">Rectangle.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Hexaedre_8h.html">Hexaedre.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Faces__VDF_8h.html">Faces_VDF.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Aretes_8h.html">Aretes.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Periodique_8h.html">Periodique.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__entree__fluide_8h.html">Dirichlet_entree_fluide.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Neumann__sortie__libre_8h.html">Neumann_sortie_libre.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="EcrFicCollecte_8h.html">EcrFicCollecte.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="IntTrav_8h.html">IntTrav.h</a>&gt;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="Zone__VDF_8cpp.html#a140ac7e4cf7353aa2e861afa9609224e">00036</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>,<span class="stringliteral">&quot;Zone_VDF&quot;</span>,<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>);
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="comment">// #define SORT_POUR_DEBOG</span><span class="comment"></span>
<a name="l00039"></a>00039 <span class="comment">////!&lt; printOn </span>
<a name="l00040"></a>00040 <span class="comment"></span><span class="comment">//</span>
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="classZone__VDF.html#a8f46c83f8b1f4e43d14882d1809880c5">00042</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classZone__VDF.html#a8f46c83f8b1f4e43d14882d1809880c5" title="Surcharge Objet_U::printOn(Sortie&amp;) NE FAIT RIEN A surcharger dans les classes derivees. Imprime la zone discretisee sur un flot de sortie.">Zone_VDF::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00043"></a>00043 <span class="keyword"></span>{
<a name="l00044"></a>00044   <a class="code" href="classZone__VDF.html#a8f46c83f8b1f4e43d14882d1809880c5" title="Surcharge Objet_U::printOn(Sortie&amp;) NE FAIT RIEN A surcharger dans les classes derivees. Imprime la zone discretisee sur un flot de sortie.">Zone_VF::printOn</a>(os);
<a name="l00045"></a>00045   os &lt;&lt; <span class="stringliteral">&quot;orientation_&quot;</span>&lt;&lt;<a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>&lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00046"></a>00046   os &lt;&lt; <span class="stringliteral">&quot;nb_faces_X_&quot;</span>&lt;&lt;<a class="code" href="classZone__VDF.html#a49ff3b54262d19fc2a9e90bd46108f11" title="nombre de faces perpendiculaires a l&#39;axe des X">nb_faces_X_</a>&lt;&lt; finl;
<a name="l00047"></a>00047   os &lt;&lt; <span class="stringliteral">&quot;nb_faces_Y_&quot;</span>&lt;&lt;<a class="code" href="classZone__VDF.html#a10d1947ca9ea0c5e22518974ce7ae312" title="nombre de faces perpendiculaires a l&#39;axe des Y">nb_faces_Y_</a>&lt;&lt; finl;
<a name="l00048"></a>00048   os &lt;&lt; <span class="stringliteral">&quot;nb_faces_Z_&quot;</span>&lt;&lt;<a class="code" href="classZone__VDF.html#a70dfbbc23ccf4ab97dd9fcf516d33cd1" title="nombre de faces perpendiculaires a l&#39;axe des Z">nb_faces_Z_</a>&lt;&lt; finl;
<a name="l00049"></a>00049   os &lt;&lt; <span class="stringliteral">&quot;nb_aretes_&quot;</span>&lt;&lt;<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>&lt;&lt; finl;
<a name="l00050"></a>00050   os &lt;&lt; <span class="stringliteral">&quot;nb_aretes_joint_&quot;</span>&lt;&lt;<a class="code" href="classZone__VDF.html#a5eebf62ab4a89324aea305b863f08d36" title="nombre d&#39;aretes joint">nb_aretes_joint_</a>&lt;&lt; finl;
<a name="l00051"></a>00051   os &lt;&lt; <span class="stringliteral">&quot;nb_aretes_coin_&quot;</span>&lt;&lt;<a class="code" href="classZone__VDF.html#a78c4ee36e7bb545484f21a5549b60ce2" title="nombre d&#39;aretes coin">nb_aretes_coin_</a>&lt;&lt; finl;
<a name="l00052"></a>00052   os &lt;&lt; <span class="stringliteral">&quot;nb_aretes_bord_&quot;</span>&lt;&lt;<a class="code" href="classZone__VDF.html#a8c61d79fb6f52ce41a7fad33c958cc45" title="nombre d&#39;aretes bord">nb_aretes_bord_</a>&lt;&lt; finl;
<a name="l00053"></a>00053   os &lt;&lt; <span class="stringliteral">&quot;nb_aretes_mixtes_&quot;</span>&lt;&lt;<a class="code" href="classZone__VDF.html#ae35527905ccb65e640920da59ea30fb2" title="nombre d&#39;aretes mixtes">nb_aretes_mixtes_</a>&lt;&lt; finl;
<a name="l00054"></a>00054   os &lt;&lt; <span class="stringliteral">&quot;nb_aretes_internes_&quot;</span>&lt;&lt;<a class="code" href="classZone__VDF.html#a3de215c502d2bb46f6eae8ed22c7857c" title="nombre d&#39;aretes internes">nb_aretes_internes_</a>&lt;&lt; finl;
<a name="l00055"></a>00055   <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>.<a class="code" href="classIntTab.html#a8f3db153c10005d44b92c7e3c1fdd62b" title="ecriture des valeurs du tableau &quot;raw&quot; sans structure parallele">ecrit</a>(os&lt;&lt; <span class="stringliteral">&quot;Qdm : &quot;</span>);
<a name="l00056"></a>00056   os &lt;&lt; <a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classZone__VDF.html#a99e3d2bf621ebb4fe0f91710d0fc433d" title="pas du maillage dans les trois directions d&#39;espace;h_x_ (resp h_y_) est la plus petite distance entre...">h_z_</a>&lt;&lt; finl;
<a name="l00057"></a>00057   <span class="keywordflow">return</span> os ;
<a name="l00058"></a>00058 }
<a name="l00059"></a>00059 <span class="comment"></span>
<a name="l00060"></a>00060 <span class="comment">////!&lt; readOn </span>
<a name="l00061"></a>00061 <span class="comment"></span><span class="comment">//</span>
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="classZone__VDF.html#a22de27536dee24a8229252a8fcded8b4">00063</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classZone__VDF.html#a22de27536dee24a8229252a8fcded8b4" title="Surcharge Objet_U::readOn(Sortie&amp;) NE FAIT RIEN A surcharger dans les classes derivees. Lit une zone discretisee a partir d&#39;un flot d&#39;entree.">Zone_VDF::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00064"></a>00064 {
<a name="l00065"></a>00065   <a class="code" href="classZone__VDF.html#a22de27536dee24a8229252a8fcded8b4" title="Surcharge Objet_U::readOn(Sortie&amp;) NE FAIT RIEN A surcharger dans les classes derivees. Lit une zone discretisee a partir d&#39;un flot d&#39;entree.">Zone_VF::readOn</a>(is);
<a name="l00066"></a>00066   is &gt;&gt;  <a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>;
<a name="l00067"></a>00067   is &gt;&gt;  <a class="code" href="classZone__VDF.html#a49ff3b54262d19fc2a9e90bd46108f11" title="nombre de faces perpendiculaires a l&#39;axe des X">nb_faces_X_</a>;
<a name="l00068"></a>00068   is &gt;&gt;  <a class="code" href="classZone__VDF.html#a10d1947ca9ea0c5e22518974ce7ae312" title="nombre de faces perpendiculaires a l&#39;axe des Y">nb_faces_Y_</a>;
<a name="l00069"></a>00069   is &gt;&gt;  <a class="code" href="classZone__VDF.html#a70dfbbc23ccf4ab97dd9fcf516d33cd1" title="nombre de faces perpendiculaires a l&#39;axe des Z">nb_faces_Z_</a>;
<a name="l00070"></a>00070   is &gt;&gt;  <a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>;
<a name="l00071"></a>00071   is &gt;&gt;  <a class="code" href="classZone__VDF.html#a5eebf62ab4a89324aea305b863f08d36" title="nombre d&#39;aretes joint">nb_aretes_joint_</a>;
<a name="l00072"></a>00072   is &gt;&gt;  <a class="code" href="classZone__VDF.html#a78c4ee36e7bb545484f21a5549b60ce2" title="nombre d&#39;aretes coin">nb_aretes_coin_</a>;
<a name="l00073"></a>00073   is &gt;&gt;  <a class="code" href="classZone__VDF.html#a8c61d79fb6f52ce41a7fad33c958cc45" title="nombre d&#39;aretes bord">nb_aretes_bord_</a>;
<a name="l00074"></a>00074   is &gt;&gt;  <a class="code" href="classZone__VDF.html#ae35527905ccb65e640920da59ea30fb2" title="nombre d&#39;aretes mixtes">nb_aretes_mixtes_</a>;
<a name="l00075"></a>00075   is &gt;&gt;  <a class="code" href="classZone__VDF.html#a3de215c502d2bb46f6eae8ed22c7857c" title="nombre d&#39;aretes internes">nb_aretes_internes_</a>;
<a name="l00076"></a>00076   <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>.<a class="code" href="classIntTab.html#a49f17e879dc8defd3061fe05307fa2dc" title="lecture d&#39;un tableau pour reprise de calcul. On lit les valeurs &quot;raw&quot;. Attention, si le tableau n&#39;est pas vide, il doit deja avoir la bonne taille et la bonne structure, sinon erreur ! Parameter resize_and_read if the array is sized AND read (by default, yes)">lit</a>(is);
<a name="l00077"></a>00077   is &gt;&gt;  <a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a>&gt;&gt;<a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a>&gt;&gt;<a class="code" href="classZone__VDF.html#a99e3d2bf621ebb4fe0f91710d0fc433d" title="pas du maillage dans les trois directions d&#39;espace;h_x_ (resp h_y_) est la plus petite distance entre...">h_z_</a>;
<a name="l00078"></a>00078   <span class="keywordflow">return</span> is ;
<a name="l00079"></a>00079 }
<a name="l00080"></a>00080 <span class="comment">//</span><span class="comment"></span>
<a name="l00081"></a>00081 <span class="comment">//! renvoie un Faces_VDF* !</span>
<a name="l00082"></a><a class="code" href="classZone__VDF.html#ac579fc6f9d6f1679a7d390940581c84f">00082</a> <span class="comment"></span><a class="code" href="classFaces.html" title="enum Type_Face Les differents types geometriques de faces.">Faces</a>* <a class="code" href="classZone__VDF.html#ac579fc6f9d6f1679a7d390940581c84f" title="renvoie un Faces_VDF* !">Zone_VDF::creer_faces</a>()
<a name="l00083"></a>00083 {
<a name="l00084"></a>00084   <a class="code" href="classFaces__VDF.html" title="class Faces_VDF">Faces_VDF</a>* les_faces_vdf=<span class="keyword">new</span>(<a class="code" href="classFaces__VDF.html" title="class Faces_VDF">Faces_VDF</a>);
<a name="l00085"></a>00085   <span class="keywordflow">return</span> les_faces_vdf;
<a name="l00086"></a>00086 }
<a name="l00087"></a>00087 
<a name="l00088"></a>00088 <span class="comment">// Precondition:</span>
<a name="l00089"></a>00089 <span class="comment">// - les faces reelles sont construites,</span>
<a name="l00090"></a>00090 <span class="comment">// - pas d&#39;espace virtuel pour les tableaux ci-dessus</span>
<a name="l00091"></a>00091 <span class="comment">// - items_communs(FACE) contient les indices des faces de joint</span>
<a name="l00092"></a>00092 <span class="comment">// Postcondition:</span>
<a name="l00093"></a>00093 <span class="comment">// - items_communs(FACE) est renumerote</span>
<a name="l00094"></a>00094 <span class="comment">//</span>
<a name="l00095"></a>00095 <span class="comment">//</span>
<a name="l00096"></a>00096 <span class="comment">//</span>
<a name="l00097"></a>00097 <span class="comment">//</span>
<a name="l00098"></a>00098 <span class="comment">//</span>
<a name="l00099"></a>00099 <span class="comment">//</span>
<a name="l00100"></a>00100 <span class="comment">//</span><span class="comment"></span>
<a name="l00101"></a>00101 <span class="comment">//! Reordonne les faces internes par orientation, on doit mettre a jour&lt;br&gt;tous les tableaux qui dependent des indices de faces internes, soit:&lt;br&gt;- faces_sommets&lt;br&gt;- faces_voisins&lt;br&gt;- elem_faces&lt;br&gt;- orientation&lt;br&gt;- Zone.faces_joint().items_communs(FACE)</span>
<a name="l00102"></a><a class="code" href="Zone__VDF_8cpp.html#ae43013d59abdaf93ff76a4e58393960c">00102</a> <span class="comment"></span><span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Zone__VDF_8cpp.html#ae43013d59abdaf93ff76a4e58393960c" title="Reordonne les faces internes par orientation, on doit mettre a jour tous les tableaux qui dependent d...">reordonner_vdf</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_front,
<a name="l00103"></a>00103                            <a class="code" href="classFaces__VDF.html" title="class Faces_VDF">Faces_VDF</a>&amp; faces, <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces,
<a name="l00104"></a>00104                            <a class="code" href="classIntVect.html">IntVect</a>&amp; orientation, <a class="code" href="classJoints.html" title="Classe Joints Cette classe represente une liste d&#39;objet de type Joint.">Joints</a>&amp; joints)
<a name="l00105"></a>00105 {
<a name="l00106"></a>00106 <span class="comment">// Construction d&#39;un int selon lequel on va trier les faces:</span>
<a name="l00107"></a>00107 <span class="comment">// orientation * nb_faces + indice_face</span>
<a name="l00108"></a>00108 <span class="comment">// Quand on trie par ordre croissant de cet int, on trie selon l&#39;orientation</span>
<a name="l00109"></a>00109 <span class="comment">// en preservant l&#39;ordre initial des faces de meme orientation</span>
<a name="l00110"></a>00110   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces = faces.<a class="code" href="classFaces.html#a64d898edb20c3687d357018f1821c50a" title="Renvoie le nombre de Faces.">nb_faces</a>();
<a name="l00111"></a>00111   <span class="keywordtype">int</span> i, j;
<a name="l00112"></a>00112 
<a name="l00113"></a>00113   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> sort_key(nb_faces);
<a name="l00114"></a>00114 <span class="comment">// On ne trie pas les faces de bord, qui restent au debut:</span>
<a name="l00115"></a>00115   <span class="keywordflow">for</span> (i = 0; i &lt; nb_faces_front; i++)
<a name="l00116"></a>00116     sort_key[i] = i;
<a name="l00117"></a>00117   <span class="keywordflow">for</span> (; i &lt; nb_faces; i++)
<a name="l00118"></a>00118     {
<a name="l00119"></a>00119       <span class="keyword">const</span> <span class="keywordtype">int</span> ori = orientation(i);
<a name="l00120"></a>00120       sort_key[i] = ori * nb_faces + i;
<a name="l00121"></a>00121     }
<a name="l00122"></a>00122 
<a name="l00123"></a>00123   sort_key.<a class="code" href="classArrOfInt.html#abb0f48cf5a4be4b70edcc90baaebd521" title="Tri des valeurs du tableau dans l&#39;ordre croissant. La fonction utilisee est qsort de stdlib (elle est...">ordonne_array</a>();
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 <span class="comment">// Il suffit de revenir a l&#39;index initial pour avoir les indices des</span>
<a name="l00126"></a>00126 <span class="comment">// faces triees par orientation : sort_key[nouveau numero] = ancien numero</span>
<a name="l00127"></a>00127   <span class="keywordflow">for</span> (i = nb_faces_front; i &lt; nb_faces; i++)
<a name="l00128"></a>00128     {
<a name="l00129"></a>00129       <span class="keyword">const</span> <span class="keywordtype">int</span> key = sort_key[i];
<a name="l00130"></a>00130       orientation[i] = key / nb_faces;
<a name="l00131"></a>00131       sort_key[i]    = key % nb_faces;
<a name="l00132"></a>00132     }
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 <span class="comment">// On reordonne les faces:</span>
<a name="l00135"></a>00135   {
<a name="l00136"></a>00136     <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_sommets = faces.<a class="code" href="classFaces.html#a07b8d8db9e3d656b93a21a49c063430c">les_sommets</a>();
<a name="l00137"></a>00137     <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> old_tab(faces_sommets);
<a name="l00138"></a>00138     <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_faces = faces_sommets.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00139"></a>00139     <span class="keywordflow">for</span> (i = 0; i &lt; nb_faces; i++)
<a name="l00140"></a>00140       {
<a name="l00141"></a>00141         <span class="keyword">const</span> <span class="keywordtype">int</span> old_i = sort_key[i];
<a name="l00142"></a>00142         <span class="keywordflow">for</span> (j = 0; j &lt; nb_som_faces; j++)
<a name="l00143"></a>00143           faces_sommets(i, j) = old_tab(old_i, j);
<a name="l00144"></a>00144       }
<a name="l00145"></a>00145   }
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   {
<a name="l00148"></a>00148     <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_voisins = faces.<a class="code" href="classFaces.html#af49c4448e67aa7c732c2cc1dc237b442" title="Renvoie le tableau des voisins (des faces).">voisins</a>();
<a name="l00149"></a>00149     <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> old_tab(faces_voisins);
<a name="l00150"></a>00150     <span class="keywordflow">for</span> (i = 0; i &lt; nb_faces; i++)
<a name="l00151"></a>00151       {
<a name="l00152"></a>00152         <span class="keyword">const</span> <span class="keywordtype">int</span> old_i = sort_key[i];
<a name="l00153"></a>00153         faces_voisins(i, 0) = old_tab(old_i, 0);
<a name="l00154"></a>00154         faces_voisins(i, 1) = old_tab(old_i, 1);
<a name="l00155"></a>00155       }
<a name="l00156"></a>00156   }
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 <span class="comment">// Calcul de la table inversee: reverse_index[ancien_numero] = nouveau numero</span>
<a name="l00159"></a>00159   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> reverse_index(nb_faces);
<a name="l00160"></a>00160   {
<a name="l00161"></a>00161     <span class="keywordflow">for</span> (i = 0; i &lt; nb_faces; i++)
<a name="l00162"></a>00162       {
<a name="l00163"></a>00163         <span class="keyword">const</span> <span class="keywordtype">int</span> jj = sort_key[i];
<a name="l00164"></a>00164         reverse_index[jj] = i;
<a name="l00165"></a>00165       }
<a name="l00166"></a>00166   }
<a name="l00167"></a>00167 <span class="comment">// Renumerotation de elem_faces:</span>
<a name="l00168"></a>00168   {
<a name="l00169"></a>00169 <span class="comment">// Nombre d&#39;indices de faces dans le tableau</span>
<a name="l00170"></a>00170     <span class="keyword">const</span> <span class="keywordtype">int</span> nb_items = elem_faces.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>();
<a name="l00171"></a>00171     <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; array = elem_faces;
<a name="l00172"></a>00172     <span class="keywordflow">for</span> (i = 0; i &lt; nb_items; i++)
<a name="l00173"></a>00173       {
<a name="l00174"></a>00174         <span class="keyword">const</span> <span class="keywordtype">int</span> old = array[i];
<a name="l00175"></a>00175         array[i] = reverse_index[old];
<a name="l00176"></a>00176       }
<a name="l00177"></a>00177   }
<a name="l00178"></a>00178 <span class="comment">// Mise a jour des indices des faces de joint:</span>
<a name="l00179"></a>00179   {
<a name="l00180"></a>00180     <span class="keyword">const</span> <span class="keywordtype">int</span> nb_joints = joints.<a class="code" href="classliste.html#ab47f280662ff68f9aa2e00e50431c5dc" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>();
<a name="l00181"></a>00181     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_joint = 0; i_joint &lt; nb_joints; i_joint++)
<a name="l00182"></a>00182       {
<a name="l00183"></a>00183         <a class="code" href="classJoint.html" title="La classe Joint est une Frontiere qui contient les faces et les sommets de joint avec la zone PEvoisi...">Joint</a>&amp;     joint         = joints[i_joint];
<a name="l00184"></a>00184         <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; indices_faces = joint.<a class="code" href="classJoint.html#aa1c4d729a3017082d26907d82ad1d7de" title="Renvoie les informations de joint pour un type d&#39;item geometrique donne, pour remplissage des structu...">set_joint_item</a>(<a class="code" href="classJoint.html#a1e2d15d088c27c9b7b11c02bf4d2c926ab255b88987fc7f64c215c958cbe2af6b">Joint::FACE</a>).<a class="code" href="classJoint__Items.html#aa01c4601d506c658f4f1d45e66951ce0" title="Renvoie le tableau items_communs_ pour le remplir. (BM: ce tableau n&#39;est pas encore rempli)...">set_items_communs</a>();
<a name="l00185"></a>00185         <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_bis    = indices_faces.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00186"></a>00186         assert(nb_faces_bis == joint.<a class="code" href="classFrontiere.html#aa073fe9dbdddde59471ee7032b256aa2" title="Renvoie le nombre de faces de la frontiere.">nb_faces</a>()); <span class="comment">//!&lt; items_communs rempli ?</span>
<a name="l00187"></a>00187 <span class="comment"></span>        <span class="keywordflow">for</span> (i = 0; i &lt; nb_faces_bis; i++)
<a name="l00188"></a>00188           {
<a name="l00189"></a>00189             <span class="keyword">const</span> <span class="keywordtype">int</span> old = indices_faces[i]; <span class="comment">//!&lt; ancien indice local</span>
<a name="l00190"></a>00190 <span class="comment"></span>            indices_faces[i] = reverse_index[old];
<a name="l00191"></a>00191           }
<a name="l00192"></a>00192 <span class="comment">// Les faces de joint ne sont plus consecutives dans le</span>
<a name="l00193"></a>00193 <span class="comment">// tableau: num_premiere_face n&#39;a plus ne sens</span>
<a name="l00194"></a>00194         joint.<a class="code" href="classFrontiere.html#a66cbd407fb5a1611b9aca04bddd0f6e0">fixer_num_premiere_face</a>(-1);
<a name="l00195"></a>00195       }
<a name="l00196"></a>00196   }
<a name="l00197"></a>00197 }
<a name="l00198"></a>00198 
<a name="l00199"></a>00199 <span class="comment">//</span>
<a name="l00200"></a>00200 <span class="comment">//</span>
<a name="l00201"></a>00201 <span class="comment">//</span><span class="comment"></span>
<a name="l00202"></a>00202 <span class="comment">//! reordonne les faces en fonction de l&#39;orientation&lt;br&gt;calcule les centres de gravite des faces&lt;br&gt;calcule les surfaces</span>
<a name="l00203"></a><a class="code" href="classZone__VDF.html#a5c85731742b37cb506cbde68439e831d">00203</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classZone__VDF.html#a5c85731742b37cb506cbde68439e831d" title="reordonne les faces en fonction de l&#39;orientation calcule les centres de gravite des faces calcule les...">Zone_VDF::reordonner</a>(<a class="code" href="classFaces.html" title="enum Type_Face Les differents types geometriques de faces.">Faces</a>&amp; les_faces)
<a name="l00204"></a>00204 {
<a name="l00205"></a>00205 <span class="comment">// Cerr &lt;&lt; &quot;Faces : &quot; &lt;&lt; les_faces &lt;&lt; finl;</span>
<a name="l00206"></a>00206 <span class="comment">// Cerr &lt;&lt; &quot;On reordonne les faces &quot; &lt;&lt; finl;</span>
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <span class="comment">// Calcul de l&#39;orientation des faces reeles</span>
<a name="l00209"></a>00209   <a class="code" href="classFaces__VDF.html" title="class Faces_VDF">Faces_VDF</a>&amp; les_faces_vdf=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFaces__VDF.html" title="class Faces_VDF">Faces_VDF</a>, les_faces);
<a name="l00210"></a>00210   les_faces_vdf.<a class="code" href="classFaces__VDF.html#af9bc03a1d1b67d639f8e6b179d66bd4b">calculer_orientation</a>(<a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>, <a class="code" href="classZone__VDF.html#a49ff3b54262d19fc2a9e90bd46108f11" title="nombre de faces perpendiculaires a l&#39;axe des X">nb_faces_X_</a>,
<a name="l00211"></a>00211                                      <a class="code" href="classZone__VDF.html#a10d1947ca9ea0c5e22518974ce7ae312" title="nombre de faces perpendiculaires a l&#39;axe des Y">nb_faces_Y_</a>, <a class="code" href="classZone__VDF.html#a70dfbbc23ccf4ab97dd9fcf516d33cd1" title="nombre de faces perpendiculaires a l&#39;axe des Z">nb_faces_Z_</a>);
<a name="l00212"></a>00212 
<a name="l00213"></a>00213   <a class="code" href="classJoints.html" title="Classe Joints Cette classe represente une liste d&#39;objet de type Joint.">Joints</a>&amp;      joints     = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a16f273a76321d31435995cdad664285a" title="Renvoie la liste des joints de la zone. (version const)">faces_joint</a>();
<a name="l00214"></a>00214   <a class="code" href="Zone__VDF_8cpp.html#ae43013d59abdaf93ff76a4e58393960c" title="Reordonne les faces internes par orientation, on doit mettre a jour tous les tableaux qui dependent d...">reordonner_vdf</a>(<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().nb_faces_frontiere(),
<a name="l00215"></a>00215                  les_faces_vdf, <a class="code" href="classZone__VF.html#acd9376481d4268df6a0c394c5a1a0e61" title="connectivite element/faces">elem_faces_</a>, <a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>, joints);
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="comment">//</span>
<a name="l00219"></a>00219 <span class="comment">//</span>
<a name="l00220"></a>00220 <span class="comment">//</span>
<a name="l00221"></a>00221 <span class="comment">//</span>
<a name="l00222"></a>00222 <span class="comment">//</span>
<a name="l00223"></a>00223 <span class="comment">//</span>
<a name="l00224"></a>00224 <span class="comment">//</span>
<a name="l00225"></a>00225 <span class="comment">//</span><span class="comment"></span>
<a name="l00226"></a>00226 <span class="comment">//! appel a  Zone_VF::discretiser()&lt;br&gt;calcul des centres de gravite des elements&lt;br&gt;remplissage des connectivites elements/faces&lt;br&gt;on reordonne les connectivites faces/elements&lt;br&gt;de sorte que el1 est a gauche et el2 a droite.&lt;br&gt;calcul des porosites volumiques et surfaciques&lt;br&gt;generation des aretes&lt;br&gt;calcul des pas du maillage</span>
<a name="l00227"></a><a class="code" href="classZone__VDF.html#a4b4a84830c929c1ade47f7a9f6e18de3">00227</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classZone__VDF.html#a4b4a84830c929c1ade47f7a9f6e18de3" title="appel a Zone_VF::discretiser() calcul des centres de gravite des elements remplissage des connectivit...">Zone_VDF::discretiser</a>()
<a name="l00228"></a>00228 {
<a name="l00229"></a>00229   <a class="code" href="classZone__VDF.html#a4b4a84830c929c1ade47f7a9f6e18de3" title="appel a Zone_VF::discretiser() calcul des centres de gravite des elements remplissage des connectivit...">Zone_VF::discretiser</a>();
<a name="l00230"></a>00230 
<a name="l00231"></a>00231   <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 <span class="comment">// Verification de la coherence entre l&#39;element geometrique et la discretisation</span>
<a name="l00234"></a>00234 
<a name="l00235"></a>00235   <span class="keyword">const</span> <a class="code" href="classElem__geom__base.html" title="Classe Elem_geom_base Cette classe est la classe de base pour la definition d&#39;elements geometriques c...">Elem_geom_base</a>&amp; elem_geom = zone_geom.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classDeriv__Elem__geom__base.html#a384b487459a33f9f521fb16539ec81de">valeur</a>();
<a name="l00236"></a>00236 
<a name="l00237"></a>00237   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2)
<a name="l00238"></a>00238     {
<a name="l00239"></a>00239       <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classRectangle.html" title="Classe Rectangle Cette classe represente l&#39;element geometrique Rectangle. Un rectangle a 4 faces...">Rectangle</a>,elem_geom))
<a name="l00240"></a>00240         {
<a name="l00241"></a>00241           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Le type de l&#39;element geometrique &quot;</span> &lt;&lt; elem_geom.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; est incorrect&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00242"></a>00242           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Seul le type Rectangle et Rectangle_Axi sont compatibles avec la discretisation VDF en dimension 2&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00243"></a>00243           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00244"></a>00244         }
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00247"></a>00247     {
<a name="l00248"></a>00248       <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classHexaedre.html" title="Classe Hexaedre Cette represente un element geometrique a 6 faces, 8 sommets et un seul type de face ...">Hexaedre</a>,elem_geom))
<a name="l00249"></a>00249         {
<a name="l00250"></a>00250           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Le type de l&#39;element geometrique &quot;</span> &lt;&lt; elem_geom.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; est incorrect&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00251"></a>00251           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Seul le type Hexaedre ou Hexadre_Axi sont compatibles avec la discretisation VDF en dimension 3&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00252"></a>00252           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00253"></a>00253         }
<a name="l00254"></a>00254     }
<a name="l00255"></a>00255 <span class="comment">// Calcul de l&#39;orientation des faces virtuelles</span>
<a name="l00256"></a>00256 <span class="comment">// Note BM: pour compatibilite avec la version 1.5, orientation_</span>
<a name="l00257"></a>00257 <span class="comment">// n&#39;a pas d&#39;espace virtuel.</span>
<a name="l00258"></a>00258   <a class="code" href="classMD__Vector.html" title=": Cette classe est un DERIV mais l&#39;objet pointe est partage entre plusieurs instances de cette classe...">MD_Vector</a> md_nul;
<a name="l00259"></a>00259   <a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(<a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>);
<a name="l00260"></a>00260   <a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>.<a class="code" href="classIntVect.html#ad12bea67621d1a0ee82b27c9a37ca4ef">echange_espace_virtuel</a>();
<a name="l00261"></a>00261   <a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>.<a class="code" href="classIntVect.html#aefca15627f9f7852150f4a769f00e3e2" title="associe le md_vector au vecteur et initialise l&#39;attribut size_reelle_ (voir methode size_reelle()) Si...">set_md_vector</a>(md_nul); <span class="comment">//!&lt; Detache la structure parallele</span>
<a name="l00262"></a>00262 <span class="comment"></span>
<a name="l00263"></a>00263 <span class="comment">// Application de la convention VDF sur face_voisin:</span>
<a name="l00264"></a>00264 <span class="comment">// L&#39;element face_voisin(i,0) doit avoir une coordonnee &quot;ori&quot; plus petite que la face</span>
<a name="l00265"></a>00265 <span class="comment">// et l&#39;element face_voisin(i,1) doit avoir une coordonnee plus grande.</span>
<a name="l00266"></a>00266   {
<a name="l00267"></a>00267     <span class="keyword">const</span> <span class="keywordtype">int</span> nbr_faces_tot = <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>.<a class="code" href="classIntTab.html#a71e9b9ddc1793094b1b3f109377952b1" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
<a name="l00268"></a>00268     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_face = 0; i_face &lt; nbr_faces_tot; i_face++)
<a name="l00269"></a>00269       {
<a name="l00270"></a>00270         <span class="keyword">const</span> <span class="keywordtype">int</span> elem0 = <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(i_face, 0);
<a name="l00271"></a>00271         <span class="keyword">const</span> <span class="keywordtype">int</span> elem1 = <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(i_face, 1);
<a name="l00272"></a>00272         <span class="keyword">const</span> <span class="keywordtype">int</span> ori = <a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>[i_face];
<a name="l00273"></a>00273         <span class="keyword">const</span> <span class="keywordtype">double</span> x_face = <a class="code" href="classZone__VF.html#a6c108eadb292f20b662cff6e3ecf6115">xv</a>(i_face, ori);
<a name="l00274"></a>00274         <span class="keywordtype">double</span> delta = 0.;
<a name="l00275"></a>00275 <span class="comment">// L&#39;element 0 doit avoir une coordonnee &quot;ori&quot; plus petite que la face</span>
<a name="l00276"></a>00276 <span class="comment">// et l&#39;element 1 doit avoir une coordonnee plus grande.</span>
<a name="l00277"></a>00277         <span class="keywordflow">if</span> (elem0 &gt;= 0)
<a name="l00278"></a>00278           {
<a name="l00279"></a>00279             delta = x_face - <a class="code" href="classZone__VF.html#ad9f40bf649129fcc43578cbf057954ef">xp</a>(elem0, ori);
<a name="l00280"></a>00280           }
<a name="l00281"></a>00281         <span class="keywordflow">else</span>
<a name="l00282"></a>00282           {
<a name="l00283"></a>00283             assert(elem1 &gt;= 0); <span class="comment">//!&lt; Sinon, grosse erreur: elements voisins non renseignes</span>
<a name="l00284"></a>00284 <span class="comment"></span>            delta = <a class="code" href="classZone__VF.html#ad9f40bf649129fcc43578cbf057954ef">xp</a>(elem1, ori) - x_face;
<a name="l00285"></a>00285           }
<a name="l00286"></a>00286         <span class="keywordflow">if</span> (delta &lt; 0)
<a name="l00287"></a>00287           {
<a name="l00288"></a>00288 <span class="comment">// On inverse les deux elements</span>
<a name="l00289"></a>00289             <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(i_face, 0) = elem1;
<a name="l00290"></a>00290             <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(i_face, 1) = elem0;
<a name="l00291"></a>00291           }
<a name="l00292"></a>00292       }
<a name="l00293"></a>00293   }
<a name="l00294"></a>00294 
<a name="l00295"></a>00295   <a class="code" href="classZone__VDF.html#a2362ef0f0ca77b61b9540ea8c7bd0f7a" title="remplissage des volumes entrelaces">calculer_volumes_entrelaces</a>();
<a name="l00296"></a>00296   <a class="code" href="classZone__VF.html#aff50cd7737b84daca35f56ebf78aee47">Zone_VF::calculer_porosites</a>();
<a name="l00297"></a>00297   <a class="code" href="classZone__VF.html#a96ffa418fd3594b770d03c22c2ef47b6">Zone_VF::calculer_diametres_hydrauliques</a>();
<a name="l00298"></a>00298   <a class="code" href="classZone__VF.html#a583b04880f7ff3f30ae93b0eaa3307b7">Zone_VF::calculer_coefficient_echange_thermique</a>();
<a name="l00299"></a>00299   <a class="code" href="classZone__VF.html#a532d6ca3fad475c679b3feabbb67ee74">Zone_VF::calculer_coefficient_frottement</a>();
<a name="l00300"></a>00300   <a class="code" href="classZone__VDF.html#a6915997e61c52e56a7942f997d51cf2d" title="generation des aretes">genere_aretes</a>();
<a name="l00301"></a>00301   <a class="code" href="classZone__VDF.html#a9f95cbb3e0cb335c685afc9ec38f93b2" title="calcul des pas du maillage">calcul_h</a>();
<a name="l00302"></a>00302   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;L&#39;objet de type Zone_VDF a ete rempli avec succes &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00303"></a>00303 
<a name="l00304"></a>00304 }
<a name="l00305"></a>00305 
<a name="l00306"></a><a class="code" href="classZone__VDF.html#a4745d8a7c91842dc05fc8b9bdd6856e2">00306</a> <span class="keywordtype">void</span>  <a class="code" href="classZone__VDF.html#a4745d8a7c91842dc05fc8b9bdd6856e2">Zone_VDF::remplir_elem_faces</a>()
<a name="l00307"></a>00307 {
<a name="l00308"></a>00308 <span class="comment">// Deja fait dans la nouvelle version</span>
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="comment">//</span><span class="comment"></span>
<a name="l00312"></a>00312 <span class="comment">//! remplissage des volumes entrelaces</span>
<a name="l00313"></a><a class="code" href="classZone__VDF.html#a2362ef0f0ca77b61b9540ea8c7bd0f7a">00313</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classZone__VDF.html#a2362ef0f0ca77b61b9540ea8c7bd0f7a" title="remplissage des volumes entrelaces">Zone_VDF::calculer_volumes_entrelaces</a>()
<a name="l00314"></a>00314 {
<a name="l00315"></a>00315   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On calcule les volumes entrelaces&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00316"></a>00316   <a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(<a class="code" href="classZone__VF.html#a4d84eafd75968d81d72275f240390ee8" title="volumes entrelaces pour l&#39;integration des Qdm">volumes_entrelaces_</a>);
<a name="l00317"></a>00317   <a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>(), 2);
<a name="l00318"></a>00318   <a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(<a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>);
<a name="l00319"></a>00319 
<a name="l00320"></a>00320   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_front = <a class="code" href="classZone__VF.html#a12869806fa4834aca8f2964e16509dfd" title="une face est interne ssi elle separe deux elements. renvoie le numero de la premiere face interne...">premiere_face_int</a>();
<a name="l00321"></a>00321   <span class="keyword">const</span> <span class="keywordtype">int</span> nbf = <a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
<a name="l00322"></a>00322   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face = 0; num_face&lt;nbf; num_face++)
<a name="l00323"></a>00323     {
<a name="l00324"></a>00324       <span class="keyword">const</span> <span class="keywordtype">double</span> f = (num_face &lt; nb_faces_front) ? 2. : 1.;
<a name="l00325"></a>00325       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir = 0; dir &lt; 2; dir ++)
<a name="l00326"></a>00326         {
<a name="l00327"></a>00327           <span class="keywordtype">int</span> elem = <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(num_face, dir);
<a name="l00328"></a>00328           <span class="keywordflow">if</span> (elem != -1)
<a name="l00329"></a>00329             {
<a name="l00330"></a>00330               <span class="keywordflow">if</span> ((<a class="code" href="classObjet__U.html#ad9b82ace9d4c7902ec704b6a78f76991">axi</a>) &amp;&amp; (<a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>[num_face]==0))
<a name="l00331"></a>00331                 <a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>(num_face, dir) = f * 0.5 * <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(num_face, 0) * <a class="code" href="classZone__VF.html#a9598b08cb9126f88cfafe72fc0eeca70" title="renvoie le tableaux des volumes des mailles.">volumes</a>(elem) / <a class="code" href="classZone__VF.html#ad9f40bf649129fcc43578cbf057954ef">xp</a>(elem, 0);
<a name="l00332"></a>00332               <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="classObjet__U.html#a9a47c1add9760324894500792c17a178">bidim_axi</a>) &amp;&amp; (<a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>[num_face]==0))
<a name="l00333"></a>00333                 {
<a name="l00334"></a>00334                   <span class="keyword">const</span> <span class="keywordtype">double</span> r1 = <a class="code" href="classZone__VF.html#a6c108eadb292f20b662cff6e3ecf6115">xv</a>(num_face, 0);
<a name="l00335"></a>00335                   <span class="keyword">const</span> <span class="keywordtype">double</span> r2 = <a class="code" href="classZone__VF.html#ad9f40bf649129fcc43578cbf057954ef">xp</a>(elem, 0);
<a name="l00336"></a>00336                   <span class="keyword">const</span> <span class="keywordtype">double</span> dz = <a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(elem, 1);
<a name="l00337"></a>00337                   <span class="keyword">const</span> <span class="keywordtype">double</span> dr = <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(r1 - r2);
<a name="l00338"></a>00338                   <span class="keyword">const</span> <span class="keywordtype">double</span> r = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(r1, r2);
<a name="l00339"></a>00339                   <a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>(num_face, dir) = 2. * <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> * (r * dr + 0.5 * dr * dr) * dz;
<a name="l00340"></a>00340                 }
<a name="l00341"></a>00341               <span class="keywordflow">else</span>
<a name="l00342"></a>00342                 <a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>(num_face, dir) = f * 0.5 * <a class="code" href="classZone__VF.html#a9598b08cb9126f88cfafe72fc0eeca70" title="renvoie le tableaux des volumes des mailles.">volumes</a>(elem);
<a name="l00343"></a>00343 
<a name="l00344"></a>00344               <a class="code" href="classZone__VF.html#a4d84eafd75968d81d72275f240390ee8" title="volumes entrelaces pour l&#39;integration des Qdm">volumes_entrelaces_</a>[num_face] += <a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>(num_face, dir);
<a name="l00345"></a>00345             }
<a name="l00346"></a>00346         }
<a name="l00347"></a>00347     }
<a name="l00348"></a>00348   <a class="code" href="classZone__VF.html#a4d84eafd75968d81d72275f240390ee8" title="volumes entrelaces pour l&#39;integration des Qdm">volumes_entrelaces_</a>.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00349"></a>00349   <a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00350"></a>00350 }
<a name="l00351"></a>00351 
<a name="l00352"></a><a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">00352</a> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(<span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf, <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone, <span class="keywordtype">int</span> face, <span class="keywordtype">int</span> i)
<a name="l00353"></a>00353 {
<a name="l00354"></a>00354   <span class="keywordtype">int</span> elem=zvdf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(face,i);
<a name="l00355"></a>00355   <span class="keywordflow">if</span>(elem==-1)
<a name="l00356"></a>00356     {
<a name="l00357"></a>00357       face=zone.<a class="code" href="classZone.html#a6b8ee93251d19c144c03d7cab0e5fdec" title="Renvoie -1 si face n&#39;est pas une face interne Renvoie le numero de la face dupliquee sinon...">face_interne_conjuguee</a>(face);
<a name="l00358"></a>00358       <span class="keywordflow">if</span>(face!=-1)
<a name="l00359"></a>00359         {
<a name="l00360"></a>00360           elem=zvdf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(face,i);
<a name="l00361"></a>00361           assert(elem!=-1);
<a name="l00362"></a>00362         }
<a name="l00363"></a>00363     }
<a name="l00364"></a>00364   <span class="keywordflow">return</span> elem;
<a name="l00365"></a>00365 }
<a name="l00366"></a>00366 
<a name="l00367"></a>00367 <span class="comment">//</span><span class="comment"></span>
<a name="l00368"></a>00368 <span class="comment">//! generation des aretes</span>
<a name="l00369"></a><a class="code" href="classZone__VDF.html#a6915997e61c52e56a7942f997d51cf2d">00369</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classZone__VDF.html#a6915997e61c52e56a7942f997d51cf2d" title="generation des aretes">Zone_VDF::genere_aretes</a>()
<a name="l00370"></a>00370 {
<a name="l00371"></a>00371   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On genere les aretes&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00372"></a>00372 
<a name="l00373"></a>00373   <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; ma_zone=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00374"></a>00374 <span class="comment">// int nb_poly = la_zone.nb_elem();</span>
<a name="l00375"></a>00375   <span class="keywordtype">int</span> nb_poly_tot = ma_zone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00376"></a>00376 <span class="comment">// Estimation avec majoration du nombre d&#39;aretes : nb_aretes_plus</span>
<a name="l00377"></a>00377   <a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>=-1; <span class="comment">//!&lt; cf Aretes::affecter</span>
<a name="l00378"></a>00378 <span class="comment"></span>  <span class="keywordtype">int</span> nb_aretes_plus=-1;
<a name="l00379"></a>00379   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2)
<a name="l00380"></a>00380     nb_aretes_plus = ma_zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>();
<a name="l00381"></a>00381   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00382"></a>00382     nb_aretes_plus = ma_zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>()*3;
<a name="l00383"></a>00383   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Creation des aretes &quot;</span> &lt;&lt; finl;
<a name="l00384"></a>00384   <a class="code" href="classAretes.html">Aretes</a> les_aretes(nb_aretes_plus);
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 <span class="comment">// On balaie les elements :</span>
<a name="l00387"></a>00387   <span class="keywordtype">int</span> el1, el2, el3, el4;
<a name="l00388"></a>00388   <span class="keywordtype">int</span> face12, face13, face34, face24;
<a name="l00389"></a>00389 
<a name="l00390"></a>00390   <span class="keywordtype">int</span> nb_dir;
<a name="l00391"></a>00391   <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==2) nb_dir=1;
<a name="l00392"></a>00392   <span class="keywordflow">else</span> nb_dir=3;
<a name="l00393"></a>00393   <a class="code" href="classIntVect.html">IntVect</a> gauche(nb_dir);
<a name="l00394"></a>00394   gauche(0)=0;
<a name="l00395"></a>00395   <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)
<a name="l00396"></a>00396     {
<a name="l00397"></a>00397       gauche(1)=0;
<a name="l00398"></a>00398       gauche(2)=1;
<a name="l00399"></a>00399     }
<a name="l00400"></a>00400   <a class="code" href="classIntVect.html">IntVect</a> droite(nb_dir);
<a name="l00401"></a>00401   droite(0)=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00402"></a>00402   <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)
<a name="l00403"></a>00403     {
<a name="l00404"></a>00404       droite(1)=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
<a name="l00405"></a>00405       droite(2)=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+1;
<a name="l00406"></a>00406     }
<a name="l00407"></a>00407   <a class="code" href="classIntVect.html">IntVect</a> haut(nb_dir);
<a name="l00408"></a>00408   haut(0)=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+1;
<a name="l00409"></a>00409   <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)
<a name="l00410"></a>00410     {
<a name="l00411"></a>00411       haut(1)=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+2;
<a name="l00412"></a>00412       haut(2)=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+2;
<a name="l00413"></a>00413     }
<a name="l00414"></a>00414   <a class="code" href="classIntVect.html">IntVect</a> bas(nb_dir);
<a name="l00415"></a>00415   bas(0)=1;
<a name="l00416"></a>00416   <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)
<a name="l00417"></a>00417     {
<a name="l00418"></a>00418       bas(1)=2;
<a name="l00419"></a>00419       bas(2)=2;
<a name="l00420"></a>00420     }
<a name="l00421"></a>00421 
<a name="l00422"></a>00422   <span class="keywordtype">int</span> coin=-1;
<a name="l00423"></a>00423   <span class="keywordtype">int</span> bord=0;
<a name="l00424"></a>00424   <span class="keywordtype">int</span> mixte=1;
<a name="l00425"></a>00425   <span class="keywordtype">int</span> interne=2;
<a name="l00426"></a>00426 <span class="comment">// Detection des plaques (2 faces frontieres se superposent):</span>
<a name="l00427"></a>00427   <a class="code" href="classIntVect.html">IntVect</a> est_une_plaque(<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>());
<a name="l00428"></a>00428   <a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(est_une_plaque);
<a name="l00429"></a>00429   est_une_plaque=0;
<a name="l00430"></a>00430 <span class="comment">// Boucles sur les faces frontieres</span>
<a name="l00431"></a>00431   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> P1(3), P2(3);
<a name="l00432"></a>00432   P1=0;
<a name="l00433"></a>00433   P2=0;
<a name="l00434"></a>00434   <span class="keywordtype">double</span> eps = 10.0*<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>;
<a name="l00435"></a>00435   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=0; face&lt;<a class="code" href="classZone__VF.html#a12869806fa4834aca8f2964e16509dfd" title="une face est interne ssi elle separe deux elements. renvoie le numero de la premiere face interne...">premiere_face_int</a>(); face++)
<a name="l00436"></a>00436     {
<a name="l00437"></a>00437       <span class="keywordtype">int</span> ori = <a class="code" href="classZone__VDF.html#ad25358c316621cc9f60d51ac425be10f" title="inline double Zone_VDF::porosite_face(int i) const { return porosite_face_[i]; }">orientation</a>(face);
<a name="l00438"></a>00438       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)
<a name="l00439"></a>00439         {
<a name="l00440"></a>00440           P1[i] = <a class="code" href="classZone__VF.html#a6c108eadb292f20b662cff6e3ecf6115">xv</a>(face, i) + (ori == i ? eps : 0);
<a name="l00441"></a>00441           P2[i] = <a class="code" href="classZone__VF.html#a6c108eadb292f20b662cff6e3ecf6115">xv</a>(face, i) - (ori == i ? eps : 0);
<a name="l00442"></a>00442         }
<a name="l00443"></a>00443       <span class="keywordtype">int</span> elem1 = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aec585e7983082c3df305d75fd13a6b9e">chercher_elements</a>(P1[0], P1[1], P1[2]);
<a name="l00444"></a>00444       <span class="keywordtype">int</span> elem2 = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#aec585e7983082c3df305d75fd13a6b9e">chercher_elements</a>(P2[0], P2[1], P2[2]);
<a name="l00445"></a>00445       <span class="keywordflow">if</span> (elem1 &gt;= 0 &amp;&amp; elem2 &gt;= 0 &amp;&amp; elem1 != elem2)
<a name="l00446"></a>00446         {
<a name="l00447"></a>00447 <span class="comment">// Find 2 points P1 and P2 in cells so:</span>
<a name="l00448"></a>00448           est_une_plaque(face) = 1;
<a name="l00449"></a>00449           <a class="code" href="classProcess.html#a57e0f54b11e6eaadbea224fa904b18dd" title="Renvoie un objet statique de type Sortie qui sert de journal d&#39;evenements. Si message_level &lt;= verbose...">Journal</a>() &lt;&lt; <span class="stringliteral">&quot;We detect an internal boundary on face &quot;</span> &lt;&lt; face &lt;&lt; <span class="stringliteral">&quot; between elements &quot;</span> &lt;&lt; elem1 &lt;&lt; <span class="stringliteral">&quot; and &quot;</span>
<a name="l00450"></a>00450                     &lt;&lt; elem2 &lt;&lt; finl;
<a name="l00451"></a>00451         }
<a name="l00452"></a>00452     }
<a name="l00453"></a>00453   est_une_plaque.<a class="code" href="classIntVect.html#ad12bea67621d1a0ee82b27c9a37ca4ef">echange_espace_virtuel</a>();
<a name="l00454"></a>00454 
<a name="l00455"></a>00455   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dir=0; dir&lt;nb_dir; dir++)
<a name="l00456"></a>00456     <span class="keywordflow">for</span> (el1=0; el1&lt;nb_poly_tot; el1++)
<a name="l00457"></a>00457       {
<a name="l00458"></a>00458 <span class="comment">// On doit generer l&#39;arete en haut a droite de el1</span>
<a name="l00459"></a>00459         face12=<a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el1,droite(dir));
<a name="l00460"></a>00460         face13=<a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el1,haut(dir));
<a name="l00461"></a>00461 
<a name="l00462"></a>00462         el2=<a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face12, 1);
<a name="l00463"></a>00463 
<a name="l00464"></a>00464         <span class="keywordflow">if</span>(el2&gt;-1)
<a name="l00465"></a>00465           face24=<a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el2,haut(dir));
<a name="l00466"></a>00466         <span class="keywordflow">else</span>
<a name="l00467"></a>00467           face24=-1;
<a name="l00468"></a>00468 
<a name="l00469"></a>00469         el3=<a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face13, 1);
<a name="l00470"></a>00470 
<a name="l00471"></a>00471         <span class="keywordflow">if</span>(el3&gt;-1)
<a name="l00472"></a>00472           face34=<a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el3,droite(dir));
<a name="l00473"></a>00473         <span class="keywordflow">else</span>
<a name="l00474"></a>00474           face34=-1;
<a name="l00475"></a>00475 
<a name="l00476"></a>00476         <span class="keywordflow">if</span>( (el2&gt;-1) &amp;&amp; (el3&gt;-1))
<a name="l00477"></a>00477           el4=<a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face24, 1);
<a name="l00478"></a>00478         <span class="keywordflow">else</span> <span class="keywordflow">if</span>((el2&gt;-1))
<a name="l00479"></a>00479           el4=<a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face24, 1);
<a name="l00480"></a>00480         <span class="keywordflow">else</span> <span class="keywordflow">if</span>((el3&gt;-1))
<a name="l00481"></a>00481           el4=<a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face34, 1);
<a name="l00482"></a>00482         <span class="keywordflow">else</span>
<a name="l00483"></a>00483           el4=-1;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485         <span class="keywordflow">if</span> ( (el2==-1) &amp;&amp; (el4&gt;=0) )
<a name="l00486"></a>00486           face24=<a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el4,bas(dir));
<a name="l00487"></a>00487         <span class="keywordflow">if</span> ( (el3==-1) &amp;&amp; (el4&gt;=0) )
<a name="l00488"></a>00488           face34=<a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el4,gauche(dir));
<a name="l00489"></a>00489 
<a name="l00490"></a>00490         <span class="keyword">const</span> <span class="keywordtype">int</span> nb_f = <a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
<a name="l00491"></a>00491         <span class="keywordflow">if</span> (el2 &gt; -1 &amp;&amp; el3 &gt; -1 &amp;&amp; el4 &gt; -1) <span class="comment">//!&lt; arete interne</span>
<a name="l00492"></a>00492 <span class="comment"></span>          les_aretes.<a class="code" href="classAretes.html#a83c7b51dcc7af140c6e5917402ad1c67">affecter</a>(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>, dir, interne, nb_f, face13, face24, face12, face34, est_une_plaque);
<a name="l00493"></a>00493         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (el3 &gt; -1 &amp;&amp; el4 &gt; -1) ||
<a name="l00494"></a>00494                   (el2 &gt; -1 &amp;&amp; el4 &gt; -1) ||
<a name="l00495"></a>00495                   (el2 &gt; -1 &amp;&amp; el3 &gt; -1) ) <span class="comment">//!&lt; arete mixte</span>
<a name="l00496"></a>00496 <span class="comment"></span>          les_aretes.<a class="code" href="classAretes.html#a83c7b51dcc7af140c6e5917402ad1c67">affecter</a>(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>, dir, mixte, nb_f, face13, face24, face12, face34, est_une_plaque);
<a name="l00497"></a>00497         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el2 &gt; -1) <span class="comment">//!&lt; arete bord</span>
<a name="l00498"></a>00498 <span class="comment"></span>          les_aretes.<a class="code" href="classAretes.html#a83c7b51dcc7af140c6e5917402ad1c67">affecter</a>(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>, dir, bord, nb_f, face13, face24, face12, 1, est_une_plaque);
<a name="l00499"></a>00499         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el3 &gt; -1) <span class="comment">//!&lt; arete bord</span>
<a name="l00500"></a>00500 <span class="comment"></span>          les_aretes.<a class="code" href="classAretes.html#a83c7b51dcc7af140c6e5917402ad1c67">affecter</a>(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>, dir, bord, nb_f, face12, face34, face13, 1, est_une_plaque);
<a name="l00501"></a>00501         <span class="keywordflow">else</span> <span class="comment">//!&lt; arete coin</span>
<a name="l00502"></a>00502 <span class="comment"></span>          les_aretes.<a class="code" href="classAretes.html#a83c7b51dcc7af140c6e5917402ad1c67">affecter</a>(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>, dir, coin, nb_f, face13, face24, face12, face34, est_une_plaque);
<a name="l00503"></a>00503 <span class="comment">// Cerr &lt;&lt; &quot;elements_haut_droit &quot; &lt;&lt; el1 &lt;&lt; &quot; &quot; &lt;&lt; el2 &lt;&lt; &quot; &quot; &lt;&lt; el3 &lt;&lt; &quot; &quot; &lt;&lt; el4 &lt;&lt; finl;</span>
<a name="l00504"></a>00504 <span class="comment">// Journal() &lt;&lt; &quot;Provisoire faces arete: &quot; &lt;&lt; face12 &lt;&lt; &quot; &quot; &lt;&lt; face13 &lt;&lt; &quot; &quot; &lt;&lt; face24 &lt;&lt; &quot; &quot; &lt;&lt; face34 &lt;&lt; finl;</span>
<a name="l00505"></a>00505 
<a name="l00506"></a>00506 <span class="comment">// Pour les coins ou bords :</span>
<a name="l00507"></a>00507         face13 = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el1, bas(dir));
<a name="l00508"></a>00508         el3 = <a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face13, 0);
<a name="l00509"></a>00509         <span class="keywordflow">if</span> (el3 &lt; 0) <span class="comment">//!&lt; On doit generer l&#39;arete en bas a droite de el1 si la maille en bas de el1 n&#39;existe pas</span>
<a name="l00510"></a>00510 <span class="comment"></span><span class="comment">//</span>
<a name="l00511"></a>00511           {
<a name="l00512"></a>00512             <span class="keywordflow">if</span> (el2 &gt;= 0)
<a name="l00513"></a>00513               {
<a name="l00514"></a>00514                 face24 = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el2, bas(dir));
<a name="l00515"></a>00515                 el4 = <a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face24, 0);
<a name="l00516"></a>00516                 <span class="keywordflow">if</span> (el4 &lt; 0) <span class="comment">//!&lt; arete bord</span>
<a name="l00517"></a>00517 <span class="comment"></span>                  les_aretes.<a class="code" href="classAretes.html#a83c7b51dcc7af140c6e5917402ad1c67">affecter</a>(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>, dir, bord, nb_f, face13, face24, face12, -1, est_une_plaque);
<a name="l00518"></a>00518                 <span class="keywordflow">else</span> <span class="comment">//!&lt; arete mixte</span>
<a name="l00519"></a>00519 <span class="comment"></span>                  {
<a name="l00520"></a>00520                     face34 = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el4, gauche(dir));
<a name="l00521"></a>00521                     <span class="keywordflow">if</span> (<a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face34, 0) == -1)
<a name="l00522"></a>00522                       les_aretes.<a class="code" href="classAretes.html#a83c7b51dcc7af140c6e5917402ad1c67">affecter</a>(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>, dir, mixte, nb_f, face13, face24, face34, face12, est_une_plaque);
<a name="l00523"></a>00523                   }
<a name="l00524"></a>00524               }
<a name="l00525"></a>00525             <span class="keywordflow">else</span>   <span class="comment">//!&lt; arete coin</span>
<a name="l00526"></a>00526 <span class="comment"></span>              les_aretes.<a class="code" href="classAretes.html#a83c7b51dcc7af140c6e5917402ad1c67">affecter</a>(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>, dir, coin, nb_f, face13, -1, -1, face12, est_une_plaque);
<a name="l00527"></a>00527 <span class="comment">// Cerr &lt;&lt; &quot;elements_bas_droit &quot; &lt;&lt; el1 &lt;&lt; &quot; &quot; &lt;&lt; el2 &lt;&lt; &quot; &quot; &lt;&lt; el3 &lt;&lt; &quot; &quot; &lt;&lt; el4 &lt;&lt; finl;</span>
<a name="l00528"></a>00528           }
<a name="l00529"></a>00529 
<a name="l00530"></a>00530 
<a name="l00531"></a>00531         face13 = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el1, gauche(dir));
<a name="l00532"></a>00532         el3 = <a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face13, 0);
<a name="l00533"></a>00533         <span class="keywordflow">if</span> (el3 &lt; 0) <span class="comment">//!&lt; On doit generer l&#39;arete en haut a gauche de el1 si la maille en haut a gauche n&#39;existe pas</span>
<a name="l00534"></a>00534 <span class="comment"></span><span class="comment">//</span>
<a name="l00535"></a>00535           {
<a name="l00536"></a>00536             face12 = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el1, haut(dir));
<a name="l00537"></a>00537             el2 = <a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face12, 1);
<a name="l00538"></a>00538             <span class="keywordflow">if</span> (el2 &gt;= 0)
<a name="l00539"></a>00539               {
<a name="l00540"></a>00540                 face24 = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el2, gauche(dir));
<a name="l00541"></a>00541                 el4 = <a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face24, 0);
<a name="l00542"></a>00542                 <span class="keywordflow">if</span> (el4 &lt; 0) <span class="comment">//!&lt; arete bord</span>
<a name="l00543"></a>00543 <span class="comment"></span>                  les_aretes.<a class="code" href="classAretes.html#a83c7b51dcc7af140c6e5917402ad1c67">affecter</a>(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>, dir, bord, nb_f, face13, face24, face12, -1, est_une_plaque);
<a name="l00544"></a>00544               }
<a name="l00545"></a>00545             <span class="keywordflow">else</span>   <span class="comment">//!&lt; arete coin</span>
<a name="l00546"></a>00546 <span class="comment"></span>              les_aretes.<a class="code" href="classAretes.html#a83c7b51dcc7af140c6e5917402ad1c67">affecter</a>(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>, dir, coin, nb_f, -1, face12, -1, face13, est_une_plaque);
<a name="l00547"></a>00547 <span class="comment">// Cerr &lt;&lt; &quot;elements_haut_gauche &quot; &lt;&lt; el1 &lt;&lt; &quot; &quot; &lt;&lt; el2 &lt;&lt; &quot; &quot; &lt;&lt; el3 &lt;&lt; &quot; &quot; &lt;&lt; el4 &lt;&lt; finl;</span>
<a name="l00548"></a>00548           }
<a name="l00549"></a>00549 
<a name="l00550"></a>00550 <span class="comment">// On doit generer l&#39;arete en bas a gauche de el1</span>
<a name="l00551"></a>00551         face12 = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el1, gauche(dir));
<a name="l00552"></a>00552         el2 = <a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face12, 0);
<a name="l00553"></a>00553         face13 = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(el1, bas(dir));
<a name="l00554"></a>00554         el3 = <a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(*<span class="keyword">this</span>, ma_zone, face13, 0);
<a name="l00555"></a>00555         <span class="keywordflow">if</span> ((el2 &lt; 0) &amp;&amp; (el3 &lt; 0)) <span class="comment">//!&lt; arete coin</span>
<a name="l00556"></a>00556 <span class="comment"></span>          {
<a name="l00557"></a>00557             les_aretes.<a class="code" href="classAretes.html#a83c7b51dcc7af140c6e5917402ad1c67">affecter</a>(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>, dir, coin, nb_f, face13, -1, face12, -1, est_une_plaque);
<a name="l00558"></a>00558 <span class="comment">// Cerr &lt;&lt; &quot;elements_bas_gauche &quot; &lt;&lt; el1 &lt;&lt; &quot; &quot; &lt;&lt; el2 &lt;&lt; &quot; &quot; &lt;&lt; el3 &lt;&lt; &quot; &quot; &lt;&lt; el4 &lt;&lt; finl;</span>
<a name="l00559"></a>00559           }
<a name="l00560"></a>00560       }
<a name="l00561"></a>00561   <a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>++;
<a name="l00562"></a>00562   les_aretes.<a class="code" href="classAretes.html#ad2232262eed37513dc5d9f559c2d1fdf">dimensionner</a>(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>);
<a name="l00563"></a>00563 <span class="comment">// Cerr &lt;&lt; &quot;Tri des aretes &quot; &lt;&lt; finl;</span>
<a name="l00564"></a>00564   les_aretes.<a class="code" href="classAretes.html#aea3ca6de3a5a72a607b6d66168ad4e67">trier</a>(<a class="code" href="classZone__VDF.html#a78c4ee36e7bb545484f21a5549b60ce2" title="nombre d&#39;aretes coin">nb_aretes_coin_</a>,
<a name="l00565"></a>00565                    <a class="code" href="classZone__VDF.html#a8c61d79fb6f52ce41a7fad33c958cc45" title="nombre d&#39;aretes bord">nb_aretes_bord_</a>,
<a name="l00566"></a>00566                    <a class="code" href="classZone__VDF.html#ae35527905ccb65e640920da59ea30fb2" title="nombre d&#39;aretes mixtes">nb_aretes_mixtes_</a>,
<a name="l00567"></a>00567                    <a class="code" href="classZone__VDF.html#a3de215c502d2bb46f6eae8ed22c7857c" title="nombre d&#39;aretes internes">nb_aretes_internes_</a>);
<a name="l00568"></a>00568 <span class="preprocessor">#ifdef SORT_POUR_DEBOG</span>
<a name="l00569"></a>00569 <span class="preprocessor"></span>
<a name="l00570"></a>00570   les_aretes.<a class="code" href="classAretes.html#a498e7215925e6232610589d54cb6ced4">trier_pour_debog</a>(<a class="code" href="classZone__VDF.html#a78c4ee36e7bb545484f21a5549b60ce2" title="nombre d&#39;aretes coin">nb_aretes_coin_</a>,
<a name="l00571"></a>00571                               <a class="code" href="classZone__VDF.html#a8c61d79fb6f52ce41a7fad33c958cc45" title="nombre d&#39;aretes bord">nb_aretes_bord_</a>,
<a name="l00572"></a>00572                               <a class="code" href="classZone__VDF.html#ae35527905ccb65e640920da59ea30fb2" title="nombre d&#39;aretes mixtes">nb_aretes_mixtes_</a>,
<a name="l00573"></a>00573                               <a class="code" href="classZone__VDF.html#a3de215c502d2bb46f6eae8ed22c7857c" title="nombre d&#39;aretes internes">nb_aretes_internes_</a>,<a class="code" href="classZone__VF.html#a6c108eadb292f20b662cff6e3ecf6115">xv</a>());
<a name="l00574"></a>00574 <span class="preprocessor">#endif</span>
<a name="l00575"></a>00575 <span class="preprocessor"></span>  <a class="code" href="classZone__VDF.html#a5eebf62ab4a89324aea305b863f08d36" title="nombre d&#39;aretes joint">nb_aretes_joint_</a>=0;
<a name="l00576"></a>00576   assert(<a class="code" href="classZone__VDF.html#a0d50d1ab3d41acc5ca46bb7501ac0631" title="nombre d&#39;aretes tous types confondus">nb_aretes_</a>==<a class="code" href="classZone__VDF.html#a78c4ee36e7bb545484f21a5549b60ce2" title="nombre d&#39;aretes coin">nb_aretes_coin_</a>+<a class="code" href="classZone__VDF.html#a8c61d79fb6f52ce41a7fad33c958cc45" title="nombre d&#39;aretes bord">nb_aretes_bord_</a>+<a class="code" href="classZone__VDF.html#ae35527905ccb65e640920da59ea30fb2" title="nombre d&#39;aretes mixtes">nb_aretes_mixtes_</a>
<a name="l00577"></a>00577          +<a class="code" href="classZone__VDF.html#a3de215c502d2bb46f6eae8ed22c7857c" title="nombre d&#39;aretes internes">nb_aretes_internes_</a>+<a class="code" href="classZone__VDF.html#a5eebf62ab4a89324aea305b863f08d36" title="nombre d&#39;aretes joint">nb_aretes_joint_</a>);
<a name="l00578"></a>00578   <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>.<a class="code" href="classIntTab.html#ae9ae8fefb1fda4a5c035229ab420a96d" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(les_aretes.<a class="code" href="classAretes.html#a54a72b250132c2b9a499fd80c0c6b825" title="Aretes_H.">faces</a>());
<a name="l00579"></a>00579   <span class="comment">/*</span>
<a name="l00580"></a>00580 <span class="comment">  // Boucle pour verifier ou sont les parois internes</span>
<a name="l00581"></a>00581 <span class="comment">  for (int i=0; i&lt;Qdm_.dimension(0); i++)</span>
<a name="l00582"></a>00582 <span class="comment">    {</span>
<a name="l00583"></a>00583 <span class="comment">      int nb_plaques = 0;</span>
<a name="l00584"></a>00584 <span class="comment">      for (int j = 0; j &lt; Qdm_.dimension(1); j++)</span>
<a name="l00585"></a>00585 <span class="comment">        nb_plaques += Qdm_(i, j) &gt;= 0 ? est_une_plaque(Qdm_(i, j)) : 0;</span>
<a name="l00586"></a>00586 <span class="comment">      if (nb_plaques &gt; 0)</span>
<a name="l00587"></a>00587 <span class="comment">      Journal() &lt;&lt; &quot;Provisoire arete &quot; &lt;&lt; i &lt;&lt; &quot; a &quot; &lt;&lt; nb_plaques &lt;&lt; &quot; paroi internes.&quot; &lt;&lt; finl;</span>
<a name="l00588"></a>00588 <span class="comment">    }</span>
<a name="l00589"></a>00589 <span class="comment">  Journal() &lt;&lt; &quot;Aretes coin   = &quot; &lt;&lt; nb_aretes_coin_ &lt;&lt; finl;</span>
<a name="l00590"></a>00590 <span class="comment">    Journal() &lt;&lt; &quot;Aretes bord   = &quot; &lt;&lt; nb_aretes_bord_ &lt;&lt; finl;</span>
<a name="l00591"></a>00591 <span class="comment">    Journal() &lt;&lt; &quot;Aretes mixte  = &quot; &lt;&lt; nb_aretes_mixtes_ &lt;&lt; finl;</span>
<a name="l00592"></a>00592 <span class="comment">    Journal() &lt;&lt; &quot;Aretes interne= &quot; &lt;&lt; nb_aretes_internes_ &lt;&lt; finl;</span>
<a name="l00593"></a>00593 <span class="comment">    Journal() &lt;&lt; &quot;Aretes joint  = &quot; &lt;&lt; nb_aretes_joint_ &lt;&lt; finl;</span>
<a name="l00594"></a>00594 <span class="comment">     */</span>
<a name="l00595"></a>00595 <span class="comment">// Cerr &lt;&lt; &quot;Qdm : &quot; &lt;&lt; Qdm_ &lt;&lt; finl;</span>
<a name="l00596"></a>00596 }
<a name="l00597"></a>00597 
<a name="l00598"></a>00598 <span class="comment">//</span><span class="comment"></span>
<a name="l00599"></a>00599 <span class="comment">//! calcul des pas du maillage</span>
<a name="l00600"></a><a class="code" href="classZone__VDF.html#a9f95cbb3e0cb335c685afc9ec38f93b2">00600</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classZone__VDF.html#a9f95cbb3e0cb335c685afc9ec38f93b2" title="calcul des pas du maillage">Zone_VDF::calcul_h</a>()
<a name="l00601"></a>00601 {
<a name="l00602"></a>00602 <span class="comment">// Calcul de h_x_ , h_y_ et h_z_:</span>
<a name="l00603"></a>00603 
<a name="l00604"></a>00604   <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00605"></a>00605   <span class="keywordtype">int</span> nb_poly = zone_geom.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>();
<a name="l00606"></a>00606 
<a name="l00607"></a>00607   <a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a> = 1.e30;
<a name="l00608"></a>00608   <a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a> = 1.e30;
<a name="l00609"></a>00609   <a class="code" href="classZone__VDF.html#a99e3d2bf621ebb4fe0f91710d0fc433d" title="pas du maillage dans les trois directions d&#39;espace;h_x_ (resp h_y_) est la plus petite distance entre...">h_z_</a> = 1.e30;
<a name="l00610"></a>00610   <span class="keywordtype">double</span> deux_pi = <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>*2.0;
<a name="l00611"></a>00611   <a class="code" href="classIntVect.html">IntVect</a> numfa(zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>());
<a name="l00612"></a>00612 
<a name="l00613"></a>00613   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#ad9b82ace9d4c7902ec704b6a78f76991">axi</a>)
<a name="l00614"></a>00614     <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2)
<a name="l00615"></a>00615       {
<a name="l00616"></a>00616         <span class="keywordtype">double</span> d_teta;
<a name="l00617"></a>00617         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_poly=0; num_poly&lt;nb_poly; num_poly++)
<a name="l00618"></a>00618           {
<a name="l00619"></a>00619             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>(); j++)
<a name="l00620"></a>00620               numfa[j] = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(num_poly,j);
<a name="l00621"></a>00621             <a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a> = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(<a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a>,<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[2],0) - <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[0],0));
<a name="l00622"></a>00622             d_teta = <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[3],1) - <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[1],1);
<a name="l00623"></a>00623             <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00624"></a>00624               d_teta += deux_pi;
<a name="l00625"></a>00625             <a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a> = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(<a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a>,d_teta*<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[1],0));
<a name="l00626"></a>00626           }
<a name="l00627"></a>00627       }
<a name="l00628"></a>00628     <span class="keywordflow">else</span>
<a name="l00629"></a>00629       {
<a name="l00630"></a>00630         <span class="keywordtype">double</span> d_teta;
<a name="l00631"></a>00631         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_poly=0; num_poly&lt;nb_poly; num_poly++)
<a name="l00632"></a>00632           {
<a name="l00633"></a>00633             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>(); j++)
<a name="l00634"></a>00634               numfa[j] = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(num_poly,j);
<a name="l00635"></a>00635             <a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a> = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(<a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a>,<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[3],0) - <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[0],0));
<a name="l00636"></a>00636             d_teta = <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[4],1) - <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[1],1);
<a name="l00637"></a>00637             <span class="keywordflow">if</span> (d_teta &lt; 0)
<a name="l00638"></a>00638               d_teta += deux_pi;
<a name="l00639"></a>00639             <a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a> = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(<a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a>,d_teta*<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[1],0));
<a name="l00640"></a>00640             <a class="code" href="classZone__VDF.html#a99e3d2bf621ebb4fe0f91710d0fc433d" title="pas du maillage dans les trois directions d&#39;espace;h_x_ (resp h_y_) est la plus petite distance entre...">h_z_</a> = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(<a class="code" href="classZone__VDF.html#a99e3d2bf621ebb4fe0f91710d0fc433d" title="pas du maillage dans les trois directions d&#39;espace;h_x_ (resp h_y_) est la plus petite distance entre...">h_z_</a>,<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[5],2) - <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[2],2));
<a name="l00641"></a>00641           }
<a name="l00642"></a>00642       }
<a name="l00643"></a>00643   <span class="keywordflow">else</span>
<a name="l00644"></a>00644     {
<a name="l00645"></a>00645       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2)
<a name="l00646"></a>00646         {
<a name="l00647"></a>00647           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_poly=0; num_poly&lt;nb_poly; num_poly++)
<a name="l00648"></a>00648             {
<a name="l00649"></a>00649               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>(); j++)
<a name="l00650"></a>00650                 numfa[j] = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(num_poly,j);
<a name="l00651"></a>00651               <a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a> = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(<a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a>,<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[2],0) - <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[0],0));
<a name="l00652"></a>00652               <a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a> = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(<a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a>,<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[3],1) - <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[1],1));
<a name="l00653"></a>00653             }
<a name="l00654"></a>00654         }
<a name="l00655"></a>00655       <span class="keywordflow">else</span>
<a name="l00656"></a>00656         {
<a name="l00657"></a>00657           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_poly=0; num_poly&lt;nb_poly; num_poly++)
<a name="l00658"></a>00658             {
<a name="l00659"></a>00659               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>(); j++)
<a name="l00660"></a>00660                 numfa[j] = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(num_poly,j);
<a name="l00661"></a>00661               <a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a> = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(<a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a>,<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[3],0) - <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[0],0));
<a name="l00662"></a>00662               <a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a> = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(<a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a>,<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[4],1) - <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[1],1));
<a name="l00663"></a>00663               <a class="code" href="classZone__VDF.html#a99e3d2bf621ebb4fe0f91710d0fc433d" title="pas du maillage dans les trois directions d&#39;espace;h_x_ (resp h_y_) est la plus petite distance entre...">h_z_</a> = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(<a class="code" href="classZone__VDF.html#a99e3d2bf621ebb4fe0f91710d0fc433d" title="pas du maillage dans les trois directions d&#39;espace;h_x_ (resp h_y_) est la plus petite distance entre...">h_z_</a>,<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[5],2) - <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(numfa[2],2));
<a name="l00664"></a>00664             }
<a name="l00665"></a>00665         }
<a name="l00666"></a>00666     }
<a name="l00667"></a>00667 <span class="comment">// On prend le minimum de chaque processeur</span>
<a name="l00668"></a>00668   <a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a> = <a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_min</a>(<a class="code" href="classZone__VDF.html#a6c5352dbf6e99b5c47067e8a33f4ac95">h_x_</a>);
<a name="l00669"></a>00669   <a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a> = <a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_min</a>(<a class="code" href="classZone__VDF.html#a3727404b0da8ff55bbe1894c91c2fdbe">h_y_</a>);
<a name="l00670"></a>00670   <a class="code" href="classZone__VDF.html#a99e3d2bf621ebb4fe0f91710d0fc433d" title="pas du maillage dans les trois directions d&#39;espace;h_x_ (resp h_y_) est la plus petite distance entre...">h_z_</a> = <a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_min</a>(<a class="code" href="classZone__VDF.html#a99e3d2bf621ebb4fe0f91710d0fc433d" title="pas du maillage dans les trois directions d&#39;espace;h_x_ (resp h_y_) est la plus petite distance entre...">h_z_</a>);
<a name="l00671"></a>00671 }
<a name="l00672"></a>00672 
<a name="l00673"></a><a class="code" href="classZone__VDF.html#acad759aa4926adc29b5d19ca95c621d2">00673</a> <span class="keywordtype">void</span> <a class="code" href="classZone__VDF.html#acad759aa4926adc29b5d19ca95c621d2">Zone_VDF::modifier_pour_Cl</a>(<span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; conds_lim)
<a name="l00674"></a>00674 {
<a name="l00675"></a>00675 <span class="comment">// Cerr &lt;&lt; &quot;Zone_VDF::Modifier_pour_Cl&quot; &lt;&lt; finl;</span>
<a name="l00676"></a>00676   <a class="code" href="classZone__VDF.html#acad759aa4926adc29b5d19ca95c621d2">Zone_VF::modifier_pour_Cl</a>(conds_lim);
<a name="l00677"></a>00677 
<a name="l00678"></a>00678   <span class="keywordtype">int</span> fac3;
<a name="l00679"></a>00679   <span class="keywordtype">int</span> nb_cond_lim=conds_lim.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>();
<a name="l00680"></a>00680   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> aretes_coin_traitees(<a class="code" href="classZone__VDF.html#ac48a087d52007e148a26babe1d3af36f">nb_aretes_coin</a>());
<a name="l00681"></a>00681   aretes_coin_traitees = -1;
<a name="l00682"></a>00682 
<a name="l00683"></a>00683   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_cond_lim=0; num_cond_lim&lt;nb_cond_lim; num_cond_lim++)
<a name="l00684"></a>00684     {
<a name="l00685"></a>00685 <span class="comment">// for cl ...</span>
<a name="l00686"></a>00686 <span class="comment">// Journal() &lt;&lt; &quot;On traite la cl num : &quot; &lt;&lt; num_cond_lim &lt;&lt; finl;</span>
<a name="l00687"></a>00687       <span class="keyword">const</span> <a class="code" href="classCond__lim__base.html" title="classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...">Cond_lim_base</a>&amp; cl = conds_lim[num_cond_lim].valeur();
<a name="l00688"></a>00688       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>, cl))
<a name="l00689"></a>00689         {
<a name="l00690"></a>00690 <span class="comment">// if cl perio</span>
<a name="l00691"></a>00691 
<a name="l00692"></a>00692 <span class="comment">// Modification du tableau Qdm_ pour les aretes de type periodicite</span>
<a name="l00693"></a>00693 
<a name="l00694"></a>00694           <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; zone_Cl_VDF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>,cl.<a class="code" href="classCond__lim__base.html#a1d3b434c49499d6e7c69311f86119c92" title="Renvoie la zone des conditions aux limites discretisee dont l&#39;objet fait partie.">zone_Cl_dis</a>());
<a name="l00695"></a>00695 
<a name="l00696"></a>00696           <span class="keywordtype">int</span> ndeb_arete = <a class="code" href="classZone__VDF.html#aa272d66cc2d519b88c3d5e8f0f70d700">premiere_arete_bord</a>();
<a name="l00697"></a>00697           <span class="keywordtype">int</span> fac1,fac2,sign,num_face,elem1,n_type;
<a name="l00698"></a>00698           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_arete=ndeb_arete; n_arete&lt;ndeb_arete+<a class="code" href="classZone__VDF.html#a88b3380a8314d855c0f30a138efd834c">nb_aretes_bord</a>(); n_arete++)
<a name="l00699"></a>00699             {
<a name="l00700"></a>00700 <span class="comment">// for n_arete</span>
<a name="l00701"></a>00701               n_type=zone_Cl_VDF.<a class="code" href="classZone__Cl__VDF.html#ae99f1fd7eda112296855c945b44aa85c">type_arete_bord</a>(n_arete-ndeb_arete);
<a name="l00702"></a>00702 
<a name="l00703"></a>00703               <span class="keywordflow">if</span> (n_type == <a class="code" href="namespaceTypeAreteBordVDF.html#a7b1d67e793ce350d614ac4eb9966c515a37713c7b918ab812a24573ce30b2a322">TypeAreteBordVDF::PERIO_PERIO</a>) <span class="comment">//!&lt; arete de type periodicite</span>
<a name="l00704"></a>00704 <span class="comment"></span>                {
<a name="l00705"></a>00705 <span class="comment">// if arete perio</span>
<a name="l00706"></a>00706                   fac1 = <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,0);
<a name="l00707"></a>00707                   fac2 = <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,1);
<a name="l00708"></a>00708                   fac3 = <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,2);
<a name="l00709"></a>00709                   sign = <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,3);
<a name="l00710"></a>00710 
<a name="l00711"></a>00711                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; la_frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00712"></a>00712                   <span class="keywordtype">int</span> ndeb = la_frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00713"></a>00713                   <span class="keywordtype">int</span> nfin = ndeb + la_frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00714"></a>00714                   <span class="keywordflow">if</span> ( ( ( ndeb &lt;= fac1) &amp;&amp; (fac1 &lt; nfin) ) ||
<a name="l00715"></a>00715                        ( ( ndeb &lt;= fac2) &amp;&amp; (fac2 &lt; nfin) )
<a name="l00716"></a>00716                      )
<a name="l00717"></a>00717                     {
<a name="l00718"></a>00718                       <span class="keywordflow">if</span> (sign == 1)
<a name="l00719"></a>00719                         elem1 = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(fac1,1);
<a name="l00720"></a>00720                       <span class="keywordflow">else</span>
<a name="l00721"></a>00721                         elem1 = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(fac1,0);
<a name="l00722"></a>00722                       num_face = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+<a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>[fac3];
<a name="l00723"></a>00723 
<a name="l00724"></a>00724                       <span class="keywordflow">if</span> (sign == -1)
<a name="l00725"></a>00725                         {
<a name="l00726"></a>00726                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,3) = fac3;
<a name="l00727"></a>00727                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,2) = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(elem1,num_face);
<a name="l00728"></a>00728                         }
<a name="l00729"></a>00729                       <span class="keywordflow">else</span>
<a name="l00730"></a>00730                         <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,3) = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(elem1,num_face);
<a name="l00731"></a>00731                     }
<a name="l00732"></a>00732                 }
<a name="l00733"></a>00733             }
<a name="l00734"></a>00734 <span class="comment">// prise  en compte des aretes coin</span>
<a name="l00735"></a>00735           <span class="keywordtype">int</span> ndeb_arete_coin = <a class="code" href="classZone__VDF.html#a3862dd214f65d87cbfc005faefc55089">premiere_arete_coin</a>();
<a name="l00736"></a>00736           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Modifications de Qdm pour les aretes coins  num_cond_lim=&quot;</span> &lt;&lt; num_cond_lim &lt;&lt;  <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00737"></a>00737           <span class="keywordtype">int</span> fac4;
<a name="l00738"></a>00738 
<a name="l00739"></a>00739           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_arete=ndeb_arete_coin; n_arete&lt;ndeb_arete_coin+<a class="code" href="classZone__VDF.html#ac48a087d52007e148a26babe1d3af36f">nb_aretes_coin</a>(); n_arete++)
<a name="l00740"></a>00740             {
<a name="l00741"></a>00741               <span class="keywordflow">if</span> (aretes_coin_traitees[n_arete] != 1)
<a name="l00742"></a>00742                 {
<a name="l00743"></a>00743                   fac1 = <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,0);
<a name="l00744"></a>00744                   fac2 = <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,1);
<a name="l00745"></a>00745                   fac3 = <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,2);
<a name="l00746"></a>00746                   fac4 = <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,3);
<a name="l00747"></a>00747 
<a name="l00748"></a>00748 <span class="comment">// On recupere le numero des faces qui ne sont pas egales a -1</span>
<a name="l00749"></a>00749                   <a class="code" href="classIntVect.html">IntVect</a> f(2);
<a name="l00750"></a>00750                   f = -2;
<a name="l00751"></a>00751                   <span class="keywordtype">int</span> i=0;
<a name="l00752"></a>00752                   <span class="keywordflow">if</span> (fac1 != -1)
<a name="l00753"></a>00753                     {
<a name="l00754"></a>00754                       f(i) = fac1;
<a name="l00755"></a>00755                       i++;
<a name="l00756"></a>00756                     }
<a name="l00757"></a>00757                   <span class="keywordflow">if</span> (fac2 != -1)
<a name="l00758"></a>00758                     {
<a name="l00759"></a>00759                       f(i) = fac2;
<a name="l00760"></a>00760                       i++;
<a name="l00761"></a>00761                     }
<a name="l00762"></a>00762                   <span class="keywordflow">if</span> (fac3 != -1)
<a name="l00763"></a>00763                     {
<a name="l00764"></a>00764                       f(i) = fac3;
<a name="l00765"></a>00765                       i++;
<a name="l00766"></a>00766                     }
<a name="l00767"></a>00767                   <span class="keywordflow">if</span> (fac4 != -1)
<a name="l00768"></a>00768                     {
<a name="l00769"></a>00769                       f(i) = fac4;
<a name="l00770"></a>00770                       i++;
<a name="l00771"></a>00771                     }
<a name="l00772"></a>00772 
<a name="l00773"></a>00773 <span class="comment">// On regarde si la face est une face de periodicite</span>
<a name="l00774"></a>00774 
<a name="l00775"></a>00775                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; la_frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00776"></a>00776                   <span class="keywordtype">int</span> ndeb = la_frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00777"></a>00777                   <span class="keywordtype">int</span> nfin = ndeb + la_frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00778"></a>00778                   <span class="keywordtype">int</span>  elem, fac,dim0,dim1,indic_f0=-100,indic_f1=-100;
<a name="l00779"></a>00779 
<a name="l00780"></a>00780                   n_type=zone_Cl_VDF.<a class="code" href="classZone__Cl__VDF.html#ae0bee7198d75e43dbc46a5b4e181b736">type_arete_coin</a>(n_arete-ndeb_arete_coin);
<a name="l00781"></a>00781                   dim1 = <a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>[f(1)];
<a name="l00782"></a>00782                   dim0 = <a class="code" href="classZone__VDF.html#a77e788dd0f6e6c7a556b8a2f38b81c5a" title="orientation des faces 0 si face perpendiculaire a l&#39;axe des X 1 si face perpendiculaire a l&#39;axe des Y...">orientation_</a>[f(0)];
<a name="l00783"></a>00783 
<a name="l00784"></a>00784                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;2; j++)
<a name="l00785"></a>00785                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;2; k++)
<a name="l00786"></a>00786                       <span class="keywordflow">if</span> ((<a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f(0),j) == <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f(1),k))  &amp;&amp; (<a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f(0),j)!=-1) )
<a name="l00787"></a>00787                         {
<a name="l00788"></a>00788                           indic_f0 = j;
<a name="l00789"></a>00789                           indic_f1 = k;
<a name="l00790"></a>00790                         }
<a name="l00791"></a>00791 
<a name="l00792"></a>00792                   <span class="keywordflow">if</span> ((n_type == <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa5203ea39fbbb2afbe1cac55f4919f144">TypeAreteCoinVDF::PERIO_PAROI</a>) || (n_type == <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa0ae272a81e85a2a09eab8b1875f2bde7">TypeAreteCoinVDF::PERIO_NSCBC</a>) || (n_type == <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa0a1ed96d7ad5bcd7d0ffaf6a4a6f9f95">TypeAreteCoinVDF::PERIO_FLUIDE</a>))<span class="comment">//!&lt; arete coin perio-paroi</span>
<a name="l00793"></a>00793 <span class="comment"></span>                    {
<a name="l00794"></a>00794                       <span class="keywordflow">if</span> ((f(0) &gt;= ndeb)&amp;&amp;(f(0) &lt; nfin))
<a name="l00795"></a>00795                         {
<a name="l00796"></a>00796                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,2)=f(0);
<a name="l00797"></a>00797                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,indic_f0)=f(1);
<a name="l00798"></a>00798 
<a name="l00799"></a>00799                           elem = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f(0),1-indic_f0);
<a name="l00800"></a>00800                           fac = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(elem,dim1+(1-indic_f1)*<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00801"></a>00801                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,1-indic_f0)=fac;
<a name="l00802"></a>00802 
<a name="l00803"></a>00803                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,3)=1-2*indic_f1;
<a name="l00804"></a>00804 
<a name="l00805"></a>00805 <span class="comment">// Cerr &lt;&lt; &quot;n_arete=&quot; &lt;&lt; n_arete &lt;&lt; &quot;  OK!!&quot; &lt;&lt; finl;</span>
<a name="l00806"></a>00806                           aretes_coin_traitees[n_arete] = 1;
<a name="l00807"></a>00807                         }
<a name="l00808"></a>00808                       <span class="keywordflow">else</span>
<a name="l00809"></a>00809                         {
<a name="l00810"></a>00810                           <span class="keywordflow">if</span> ((f(1) &gt;= ndeb)&amp;&amp;(f(1) &lt; nfin))
<a name="l00811"></a>00811                             {
<a name="l00812"></a>00812                               <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,2)=f(1);
<a name="l00813"></a>00813                               <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,indic_f1)=f(0);
<a name="l00814"></a>00814 
<a name="l00815"></a>00815                               elem = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f(1),1-indic_f1);
<a name="l00816"></a>00816                               fac = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(elem,dim0+(1-indic_f0)*<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00817"></a>00817                               <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,1-indic_f1)=fac;
<a name="l00818"></a>00818 
<a name="l00819"></a>00819                               <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,3)=1-2*indic_f0;
<a name="l00820"></a>00820 
<a name="l00821"></a>00821 <span class="comment">// Cerr &lt;&lt; &quot;n_arete=&quot; &lt;&lt; n_arete &lt;&lt; &quot;  OK!!&quot; &lt;&lt; finl;</span>
<a name="l00822"></a>00822                               aretes_coin_traitees[n_arete] = 1;
<a name="l00823"></a>00823                             }
<a name="l00824"></a>00824                           <span class="keywordflow">else</span>
<a name="l00825"></a>00825                             {
<a name="l00826"></a>00826 <span class="comment">// Cerr&lt;&lt;&quot;Attention cas non traite lors du remplissage du tableau Qdm&quot;&lt;&lt;finl;</span>
<a name="l00827"></a>00827 <span class="comment">// exit();</span>
<a name="l00828"></a>00828                               ;
<a name="l00829"></a>00829                             }
<a name="l00830"></a>00830                         }
<a name="l00831"></a>00831                     }
<a name="l00832"></a>00832                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n_type == <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aad369ed721afc9b287b160c7a91a284a4">TypeAreteCoinVDF::PERIO_PERIO</a>) <span class="comment">//!&lt; arete coin perio-perio</span>
<a name="l00833"></a>00833 <span class="comment"></span>                    {
<a name="l00834"></a>00834                       <span class="keywordflow">if</span> ((f(0) &gt;= ndeb)&amp;&amp;(f(0) &lt; nfin))
<a name="l00835"></a>00835                         {
<a name="l00836"></a>00836                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,2+indic_f1)=f(0);
<a name="l00837"></a>00837                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,indic_f0)=f(1);
<a name="l00838"></a>00838 
<a name="l00839"></a>00839                           elem = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f(0),1-indic_f0);
<a name="l00840"></a>00840                           fac = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(elem,dim1+(1-indic_f1)*<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00841"></a>00841                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,1-indic_f0)=fac;
<a name="l00842"></a>00842 
<a name="l00843"></a>00843                           elem = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f(1),1-indic_f1);
<a name="l00844"></a>00844                           fac = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(elem,dim0+(1-indic_f0)*dimension);
<a name="l00845"></a>00845                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,3-indic_f1)=fac;
<a name="l00846"></a>00846 
<a name="l00847"></a>00847 <span class="comment">// Cerr &lt;&lt; &quot;n_arete=&quot; &lt;&lt; n_arete &lt;&lt; &quot;  OK!!&quot; &lt;&lt; finl;</span>
<a name="l00848"></a>00848                           aretes_coin_traitees[n_arete] = 1;
<a name="l00849"></a>00849                         }
<a name="l00850"></a>00850                       <span class="keywordflow">else</span>
<a name="l00851"></a>00851                         {
<a name="l00852"></a>00852                           <span class="keywordflow">if</span> ((f(1) &gt;= ndeb)&amp;&amp;(f(1) &lt; nfin))
<a name="l00853"></a>00853                             {
<a name="l00854"></a>00854                               <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,2+indic_f0)=f(1);
<a name="l00855"></a>00855                               <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,indic_f1)=f(0);
<a name="l00856"></a>00856 
<a name="l00857"></a>00857                               elem = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f(1),1-indic_f1);
<a name="l00858"></a>00858                               fac = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(elem,dim0+(1-indic_f0)*<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00859"></a>00859                               <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,1-indic_f1)=fac;
<a name="l00860"></a>00860 
<a name="l00861"></a>00861                               elem = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f(0),1-indic_f0);
<a name="l00862"></a>00862                               fac = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(elem,dim1+(1-indic_f1)*dimension);
<a name="l00863"></a>00863                               <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,3-indic_f0)=fac;
<a name="l00864"></a>00864 
<a name="l00865"></a>00865 <span class="comment">// Cerr &lt;&lt; &quot;n_arete=&quot; &lt;&lt; n_arete &lt;&lt; &quot;  OK!!&quot; &lt;&lt; finl;</span>
<a name="l00866"></a>00866                               aretes_coin_traitees[n_arete] = 1;
<a name="l00867"></a>00867                             }
<a name="l00868"></a>00868                         }
<a name="l00869"></a>00869                     }
<a name="l00870"></a>00870 
<a name="l00871"></a>00871                   <span class="keywordflow">else</span>
<a name="l00872"></a>00872                     {
<a name="l00873"></a>00873                       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Attention : les cas concernant d autres types d aretes coin &quot;</span>  &lt;&lt; finl;
<a name="l00874"></a>00874                       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;que perio-perio ou perio-paroi ne sont pas traites!!&quot;</span> &lt;&lt; finl;
<a name="l00875"></a>00875                     }
<a name="l00876"></a>00876                 }
<a name="l00877"></a>00877             }
<a name="l00878"></a>00878         }
<a name="l00879"></a>00879 
<a name="l00880"></a>00880 <span class="comment">// Modif OC 01/2005 pour traiter les coins de type paroi/fluide</span>
<a name="l00881"></a>00881       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>, cl) || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>, cl) )
<a name="l00882"></a>00882         {
<a name="l00883"></a>00883 <span class="comment">// if cl de type paroi</span>
<a name="l00884"></a>00884 
<a name="l00885"></a>00885           <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; zone_Cl_VDF = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>,cl.<a class="code" href="classCond__lim__base.html#a1d3b434c49499d6e7c69311f86119c92" title="Renvoie la zone des conditions aux limites discretisee dont l&#39;objet fait partie.">zone_Cl_dis</a>());
<a name="l00886"></a>00886 
<a name="l00887"></a>00887           <span class="keywordtype">int</span> fac1,fac2,n_type;
<a name="l00888"></a>00888           <span class="keywordtype">int</span> ndeb_arete_coin = <a class="code" href="classZone__VDF.html#a3862dd214f65d87cbfc005faefc55089">premiere_arete_coin</a>();
<a name="l00889"></a>00889           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Modifications de Qdm pour les aretes coins touchant une paroi num_cond_lim=&quot;</span> &lt;&lt; num_cond_lim &lt;&lt;  <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00890"></a>00890           <span class="keywordtype">int</span> fac4;
<a name="l00891"></a>00891 
<a name="l00892"></a>00892           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_arete=ndeb_arete_coin; n_arete&lt;ndeb_arete_coin+<a class="code" href="classZone__VDF.html#ac48a087d52007e148a26babe1d3af36f">nb_aretes_coin</a>(); n_arete++)
<a name="l00893"></a>00893             {
<a name="l00894"></a>00894               <span class="keywordflow">if</span> (aretes_coin_traitees[n_arete] != 1)
<a name="l00895"></a>00895                 {
<a name="l00896"></a>00896                   fac1 = <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,0);
<a name="l00897"></a>00897                   fac2 = <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,1);
<a name="l00898"></a>00898                   fac3 = <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,2);
<a name="l00899"></a>00899                   fac4 = <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,3);
<a name="l00900"></a>00900 
<a name="l00901"></a>00901 <span class="comment">// On recupere le numero des faces qui ne sont pas egales a -1</span>
<a name="l00902"></a>00902                   <a class="code" href="classIntVect.html">IntVect</a> f(2);
<a name="l00903"></a>00903                   f = -2;
<a name="l00904"></a>00904                   <span class="keywordtype">int</span> i=0;
<a name="l00905"></a>00905                   <span class="keywordflow">if</span> (fac1 != -1)
<a name="l00906"></a>00906                     {
<a name="l00907"></a>00907                       f(i) = fac1;
<a name="l00908"></a>00908                       i++;
<a name="l00909"></a>00909                     }
<a name="l00910"></a>00910                   <span class="keywordflow">if</span> (fac2 != -1)
<a name="l00911"></a>00911                     {
<a name="l00912"></a>00912                       f(i) = fac2;
<a name="l00913"></a>00913                       i++;
<a name="l00914"></a>00914                     }
<a name="l00915"></a>00915                   <span class="keywordflow">if</span> (fac3 != -1)
<a name="l00916"></a>00916                     {
<a name="l00917"></a>00917                       f(i) = fac3;
<a name="l00918"></a>00918                       i++;
<a name="l00919"></a>00919                     }
<a name="l00920"></a>00920                   <span class="keywordflow">if</span> (fac4 != -1)
<a name="l00921"></a>00921                     {
<a name="l00922"></a>00922                       f(i) = fac4;
<a name="l00923"></a>00923                       i++;
<a name="l00924"></a>00924                     }
<a name="l00925"></a>00925 
<a name="l00926"></a>00926 <span class="comment">// On regarde si la face est une face de type paroi</span>
<a name="l00927"></a>00927 
<a name="l00928"></a>00928                   <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; la_frontiere_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
<a name="l00929"></a>00929                   <span class="keywordtype">int</span> ndeb = la_frontiere_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00930"></a>00930                   <span class="keywordtype">int</span> nfin = ndeb + la_frontiere_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00931"></a>00931                   <span class="keywordtype">int</span> indic_f0=-100,indic_f1=-100;
<a name="l00932"></a>00932 
<a name="l00933"></a>00933                   n_type=zone_Cl_VDF.<a class="code" href="classZone__Cl__VDF.html#ae0bee7198d75e43dbc46a5b4e181b736">type_arete_coin</a>(n_arete-ndeb_arete_coin);
<a name="l00934"></a>00934 
<a name="l00935"></a>00935                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;2; j++)
<a name="l00936"></a>00936                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;2; k++)
<a name="l00937"></a>00937                       <span class="keywordflow">if</span> ((<a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f(0),j) == <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f(1),k)) &amp;&amp; (<a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f(0),j)!=-1) )
<a name="l00938"></a>00938                         {
<a name="l00939"></a>00939                           indic_f0 = j;
<a name="l00940"></a>00940                           indic_f1 = k;
<a name="l00941"></a>00941                         }
<a name="l00942"></a>00942 
<a name="l00943"></a>00943                   <span class="keywordflow">if</span> ((n_type == <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa8d6cb48990b19d4ad52f6414b83d72d9">TypeAreteCoinVDF::PAROI_FLUIDE</a>) || (n_type == <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa0f79a01fe58c2a6a8ffde290a2ebc660">TypeAreteCoinVDF::FLUIDE_PAROI</a>) || (n_type == <a class="code" href="namespaceTypeAreteCoinVDF.html#aea5f704cd97000934af6129255aa429aa42458df5735cf406f85838495b654982">TypeAreteCoinVDF::FLUIDE_FLUIDE</a>))<span class="comment">//!&lt; arete coin paroi-fluide</span>
<a name="l00944"></a>00944 <span class="comment"></span>                    {
<a name="l00945"></a>00945                       <span class="keywordflow">if</span> ((f(0) &gt;= ndeb)&amp;&amp;(f(0) &lt; nfin))
<a name="l00946"></a>00946                         {
<a name="l00947"></a>00947                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,0)=f(1);
<a name="l00948"></a>00948                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,1)=f(1);
<a name="l00949"></a>00949                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,2)=f(0);
<a name="l00950"></a>00950                           <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,3)=1-2*indic_f1;
<a name="l00951"></a>00951                           aretes_coin_traitees[n_arete] = 1;
<a name="l00952"></a>00952                         }
<a name="l00953"></a>00953                       <span class="keywordflow">else</span>
<a name="l00954"></a>00954                         {
<a name="l00955"></a>00955                           <span class="keywordflow">if</span> ((f(1) &gt;= ndeb)&amp;&amp;(f(1) &lt; nfin))
<a name="l00956"></a>00956                             {
<a name="l00957"></a>00957                               <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,0)=f(0);
<a name="l00958"></a>00958                               <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,1)=f(0);
<a name="l00959"></a>00959                               <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,2)=f(1);
<a name="l00960"></a>00960                               <a class="code" href="classZone__VDF.html#a014353001e6177a23b99690c6a3579e8" title="connectivites aretes/faces DoubleVect porosite_elem_; // Porosites volumiques pour les volumes de con...">Qdm_</a>(n_arete,3)=1-2*indic_f0;
<a name="l00961"></a>00961                               aretes_coin_traitees[n_arete] = 1;
<a name="l00962"></a>00962                             }
<a name="l00963"></a>00963                           <span class="keywordflow">else</span>
<a name="l00964"></a>00964                             {
<a name="l00965"></a>00965 <span class="comment">// Cerr&lt;&lt;&quot;Attention cas non traite lors du remplissage du tableau Qdm&quot;&lt;&lt;finl;</span>
<a name="l00966"></a>00966 <span class="comment">// exit();</span>
<a name="l00967"></a>00967                               ;
<a name="l00968"></a>00968                             }
<a name="l00969"></a>00969                         }
<a name="l00970"></a>00970                     }
<a name="l00971"></a>00971                 }
<a name="l00972"></a>00972             }
<a name="l00973"></a>00973         }
<a name="l00974"></a>00974 
<a name="l00975"></a>00975 <span class="comment">// Cerr &lt;&lt; &quot;Qdm : &quot; &lt;&lt; Qdm_ &lt;&lt; finl;</span>
<a name="l00976"></a>00976 <span class="comment">// Cerr &lt;&lt; &quot;aretes_coin_traitees : &quot; &lt;&lt; aretes_coin_traitees &lt;&lt; finl;</span>
<a name="l00977"></a>00977     }
<a name="l00978"></a>00978 <span class="comment">// Journal() &lt;&lt; &quot;la_zone apres modif pour Cl : &quot; &lt;&lt; *this &lt;&lt; finl;</span>
<a name="l00979"></a>00979 
<a name="l00980"></a>00980 
<a name="l00981"></a>00981 <span class="comment">// PQ : 10/10/05 : les faces periodiques etant a double contribution</span>
<a name="l00982"></a>00982 <span class="comment">// l&#39;appel a marquer_faces_double_contrib s&#39;effectue dans cette methode</span>
<a name="l00983"></a>00983 <span class="comment">// afin de pouvoir beneficier de conds_lim.</span>
<a name="l00984"></a>00984 
<a name="l00985"></a>00985 
<a name="l00986"></a>00986   <a class="code" href="classZone__VF.html#a70e4e330a3466cc3c26293e3642a77b1">Zone_VF::marquer_faces_double_contrib</a>(conds_lim);
<a name="l00987"></a>00987 }
<a name="l00988"></a>00988 
<a name="l00989"></a>00989 <span class="comment">//</span>
<a name="l00990"></a>00990 <span class="comment">//</span><span class="comment"></span>
<a name="l00991"></a>00991 <span class="comment">//! remplit le tableau face_voisins_fictifs_&lt;br&gt;ne CREE PAS d elts fictifs!!!</span>
<a name="l00992"></a>00992 <span class="comment"></span>
<a name="l00993"></a><a class="code" href="classZone__VDF.html#a7ef11ba8117a7c545327a93afcaf3794">00993</a> <span class="keywordtype">void</span> <a class="code" href="classZone__VDF.html#a7ef11ba8117a7c545327a93afcaf3794" title="remplit le tableau face_voisins_fictifs_ ne CREE PAS d elts fictifs!!!">Zone_VDF::creer_elements_fictifs</a>(<span class="keyword">const</span> <a class="code" href="classZone__Cl__dis__base.html" title="classe Zone_Cl_dis_base Les objets Zone_Cl_dis_base representent les conditions aux limites discretis...">Zone_Cl_dis_base</a>&amp; zcldisbase)
<a name="l00994"></a>00994 {
<a name="l00995"></a>00995   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Zone_VDF::creer_elements_fictifs()&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00996"></a>00996   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; zclvdf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>,zcldisbase);
<a name="l00997"></a>00997   <span class="keywordflow">if</span> (<a class="code" href="classZone__VF.html#a8fadf8fb7699c9f77345ea583192ece8" title="connectivite face/elements fictifs">face_voisins_fictifs_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>() == 0)
<a name="l00998"></a>00998     {
<a name="l00999"></a>00999       <a class="code" href="classZone__VF.html#a8fadf8fb7699c9f77345ea583192ece8" title="connectivite face/elements fictifs">face_voisins_fictifs_</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classZone__VF.html#a8815e2276637c0db23868f043dc43e58" title="renvoie le nombre de faces sur lesquelles sont appliquees les conditions limites : bords...">nb_faces_bord</a>(),2);
<a name="l01000"></a>01000       <a class="code" href="classZone__VF.html#a8fadf8fb7699c9f77345ea583192ece8" title="connectivite face/elements fictifs">face_voisins_fictifs_</a> = -1;
<a name="l01001"></a>01001       <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a> = <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
<a name="l01002"></a>01002       <span class="keywordtype">int</span> face,ndeb,nfin;
<a name="l01003"></a>01003 
<a name="l01004"></a>01004       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;<a class="code" href="classZone__dis__base.html#af22167d614644f55591a29c77eb1c009">nb_front_Cl</a>(); n_bord++)
<a name="l01005"></a>01005         {
<a name="l01006"></a>01006           <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zclvdf.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
<a name="l01007"></a>01007           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l01008"></a>01008           <span class="keywordflow">if</span> ( (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__entree__fluide.html" title="classe Dirichlet_entree_fluide Cette classe represente une condition aux limite imposant une grandeur...">Dirichlet_entree_fluide</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())) ||
<a name="l01009"></a>01009                (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())) )
<a name="l01010"></a>01010             {
<a name="l01011"></a>01011               ndeb = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l01012"></a>01012               nfin = ndeb + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l01013"></a>01013               <span class="keywordflow">for</span> (face=ndeb; face&lt;nfin; face++)
<a name="l01014"></a>01014                 <span class="keywordflow">if</span> (<a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(face,0) != -1)
<a name="l01015"></a>01015                   <a class="code" href="classZone__VF.html#a8fadf8fb7699c9f77345ea583192ece8" title="connectivite face/elements fictifs">face_voisins_fictifs_</a>(face,1) = compteur++;
<a name="l01016"></a>01016                 <span class="keywordflow">else</span>
<a name="l01017"></a>01017                   <a class="code" href="classZone__VF.html#a8fadf8fb7699c9f77345ea583192ece8" title="connectivite face/elements fictifs">face_voisins_fictifs_</a>(face,0) = compteur++ ;
<a name="l01018"></a>01018             }
<a name="l01019"></a>01019         }
<a name="l01020"></a>01020     }
<a name="l01021"></a>01021   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;taille &quot;</span>&lt;&lt;<a class="code" href="classZone__VF.html#a8fadf8fb7699c9f77345ea583192ece8" title="connectivite face/elements fictifs">face_voisins_fictifs_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>()-<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>()&lt;&lt;finl;
<a name="l01022"></a>01022 }
<a name="l01023"></a>01023 
<a name="l01024"></a>01024 <span class="comment">// Remplit le tableau dist avec les valeurs des distances normales</span>
<a name="l01025"></a>01025 <span class="comment">// au bord des faces du bord de nom nom_bord</span>
<a name="l01026"></a>01026 <span class="comment">// Le tableau dist est dimensionne par la methode</span>
<a name="l01027"></a><a class="code" href="classZone__VDF.html#a33a6b131cad4984cebed2d1a07099ac7">01027</a> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="classZone__VDF.html#a369e50f57ce994a9afe43ff2e3ff813b">Zone_VDF::dist_norm_bord</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; dist, <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_bord)<span class="keyword"> const</span>
<a name="l01028"></a>01028 <span class="keyword"></span>{
<a name="l01029"></a>01029   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#ad9b82ace9d4c7902ec704b6a78f76991">axi</a>)
<a name="l01030"></a>01030     {
<a name="l01031"></a>01031       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;<a class="code" href="classZone__VF.html#ab582b1b65b2a3740318b6725cddac726">les_bords_</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); n_bord++)
<a name="l01032"></a>01032         {
<a name="l01033"></a>01033           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; fr_vf = <a class="code" href="classZone__VF.html#a45e54622328fcf035535edf96172c1e4" title="renvoie la ieme frontiere_discrete.">front_VF</a>(n_bord);
<a name="l01034"></a>01034           <span class="keywordflow">if</span> (fr_vf.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>() == nom_bord)
<a name="l01035"></a>01035             {
<a name="l01036"></a>01036               dist.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(fr_vf.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>());
<a name="l01037"></a>01037               <span class="keywordtype">int</span> ndeb = fr_vf.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l01038"></a>01038               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=ndeb; face&lt;ndeb+fr_vf.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>(); face++)
<a name="l01039"></a>01039                 dist(face-ndeb) = <a class="code" href="classZone__VDF.html#ad0dad29b88fed624a33187ba9aad15c2">dist_norm_bord_axi</a>(face);
<a name="l01040"></a>01040             }
<a name="l01041"></a>01041         }
<a name="l01042"></a>01042     }
<a name="l01043"></a>01043   <span class="keywordflow">else</span>
<a name="l01044"></a>01044     {
<a name="l01045"></a>01045       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;<a class="code" href="classZone__VF.html#ab582b1b65b2a3740318b6725cddac726">les_bords_</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); n_bord++)
<a name="l01046"></a>01046         {
<a name="l01047"></a>01047           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; fr_vf = <a class="code" href="classZone__VF.html#a45e54622328fcf035535edf96172c1e4" title="renvoie la ieme frontiere_discrete.">front_VF</a>(n_bord);
<a name="l01048"></a>01048           <span class="keywordflow">if</span> (fr_vf.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>() == nom_bord)
<a name="l01049"></a>01049             {
<a name="l01050"></a>01050               dist.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(fr_vf.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>());
<a name="l01051"></a>01051               <span class="keywordtype">int</span> ndeb = fr_vf.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l01052"></a>01052               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=ndeb; face&lt;ndeb+fr_vf.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>(); face++)
<a name="l01053"></a>01053                 dist(face-ndeb) = <a class="code" href="classZone__VDF.html#a369e50f57ce994a9afe43ff2e3ff813b">dist_norm_bord</a>(face);
<a name="l01054"></a>01054             }
<a name="l01055"></a>01055         }
<a name="l01056"></a>01056     }
<a name="l01057"></a>01057   <span class="keywordflow">return</span> dist;
<a name="l01058"></a>01058 }
<a name="l01059"></a>01059 
<a name="l01060"></a><a class="code" href="classZone__VDF.html#a51bda751f874f58499fa522777446065">01060</a> <span class="keywordtype">void</span> <a class="code" href="classZone__VDF.html#a51bda751f874f58499fa522777446065">Zone_VDF::init_virt_e_map</a>()<span class="keyword"> const</span>
<a name="l01061"></a>01061 <span class="keyword"></span>{
<a name="l01062"></a>01062   <a class="code" href="classIntTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un IntTab avec allocation dans un pool de memoire gere...">IntTrav</a> p_e(0, 2);
<a name="l01063"></a>01063   <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(p_e);
<a name="l01064"></a>01064   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; <a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>() ; e++) p_e(e, 0) = <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), p_e(e, 1) = e;
<a name="l01065"></a>01065   p_e.<a class="code" href="classIntVect.html#ad12bea67621d1a0ee82b27c9a37ca4ef">echange_espace_virtuel</a>();
<a name="l01066"></a>01066   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = <a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>() ; e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>() ; e++) <a class="code" href="classZone__VDF.html#a8e8e9f4936b91c52356c669abf51cba8">virt_e_map</a>[ {{ p_e(e, 0), p_e(e, 1) }}] = e;
<a name="l01067"></a>01067 }
<a name="l01068"></a>01068 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:41 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
