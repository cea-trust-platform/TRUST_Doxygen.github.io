<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VEF/Zones/distances_VEF.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VEF/Zones/distances_VEF.cpp</div>  </div>
</div>
<div class="contents">
<a href="distances__VEF_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2020, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        distances_VEF.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VEF/Zones</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/22</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;<a class="code" href="distances__VEF_8h.html">distances_VEF.h</a>&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Motcle_8h.html">Motcle.h</a>&gt;</span>
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="distances__VEF_8cpp.html#afef3c9077fa444dae08819c4b5f95bcc">00026</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#afef3c9077fa444dae08819c4b5f95bcc">norm_2D_vit1</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> fac,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,<span class="keywordtype">double</span>&amp; u)
<a name="l00027"></a>00027 {
<a name="l00028"></a>00028   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00029"></a>00029   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00030"></a>00030   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="comment">// fac numero de la face a paroi fixe</span>
<a name="l00033"></a>00033   <span class="keywordtype">double</span> r0,r1;
<a name="l00034"></a>00034   <a class="code" href="distances__VEF_8h.html#ad9a0b7617683118622992e84575d084a">calcule_r0r1</a>(face_normale,fac,r0,r1);
<a name="l00035"></a>00035 
<a name="l00036"></a>00036   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0))/nfac;
<a name="l00037"></a>00037   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1))/nfac;
<a name="l00038"></a>00038   <span class="keywordtype">double</span> v = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,r0,r1);
<a name="l00039"></a>00039   <span class="keywordflow">if</span> (v==0)
<a name="l00040"></a>00040     u = 0;
<a name="l00041"></a>00041   <span class="keywordflow">else</span>
<a name="l00042"></a>00042     u = 1;
<a name="l00043"></a>00043   <span class="keywordflow">return</span> v;
<a name="l00044"></a>00044 }
<a name="l00045"></a>00045 
<a name="l00046"></a><a class="code" href="distances__VEF_8h.html#ab16d4c16da07290f1746bdfae8860a03">00046</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#afef3c9077fa444dae08819c4b5f95bcc">norm_2D_vit1</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> fac,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,<span class="keywordtype">double</span>&amp; val1, <span class="keywordtype">double</span>&amp; val2)
<a name="l00047"></a>00047 {
<a name="l00048"></a>00048   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00049"></a>00049   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00050"></a>00050   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="comment">// fac numero de la face a paroi fixe</span>
<a name="l00053"></a>00053   <span class="keywordtype">double</span> r0,r1;
<a name="l00054"></a>00054   <a class="code" href="distances__VEF_8h.html#ad9a0b7617683118622992e84575d084a">calcule_r0r1</a>(face_normale,fac,r0,r1);
<a name="l00055"></a>00055 
<a name="l00056"></a>00056   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0))/nfac;
<a name="l00057"></a>00057   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1))/nfac;
<a name="l00058"></a>00058   <span class="keywordtype">double</span> v = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,r0,r1);
<a name="l00059"></a>00059   <span class="keywordtype">double</span> psc = r0*v1+r1*v2;
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="comment">// val1 et val2 sont les vitesses tangentielles</span>
<a name="l00062"></a>00062   val1=(v1-psc*r0)/(v+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00063"></a>00063   val2=(v2-psc*r1)/(v+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00064"></a>00064 
<a name="l00065"></a>00065   <span class="keywordflow">return</span> v;
<a name="l00066"></a>00066 }
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 
<a name="l00069"></a><a class="code" href="distances__VEF_8h.html#aa51458f98327b3ce8b2b9400e566bae1">00069</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#af1e08baeb1ff03d87fa7b45802b317cf">norm_2D_vit1_lp</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,<span class="keywordtype">double</span>&amp; val1, <span class="keywordtype">double</span>&amp; val2)
<a name="l00070"></a>00070 {
<a name="l00071"></a>00071 <span class="comment">// PQ : 03/03 : Definition de la vitesse tangentielle a une paroi</span>
<a name="l00072"></a>00072 <span class="comment">// obtenue par &quot;moyennage&quot; des vitesses aux faces associees a des elements standards</span>
<a name="l00073"></a>00073 <span class="comment">// (dont on suppose le bon comportement suivant la loi log)</span>
<a name="l00074"></a>00074 
<a name="l00075"></a>00075   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00076"></a>00076   <span class="keywordtype">double</span> c1,c2;
<a name="l00077"></a>00077   c1=0.;
<a name="l00078"></a>00078   c2=0.;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 <span class="comment">// int rang1 = rang_elem_non_std(num1);</span>
<a name="l00081"></a>00081 <span class="comment">// if (rang1&lt;0) c1=1.;</span>
<a name="l00082"></a>00082 <span class="comment">// int rang2 = rang_elem_non_std(num2);</span>
<a name="l00083"></a>00083 <span class="comment">// if (rang2&lt;0) c2=1.;</span>
<a name="l00084"></a>00084 
<a name="l00085"></a>00085   c1=1.;
<a name="l00086"></a>00086   c2=1.;
<a name="l00087"></a>00087 
<a name="l00088"></a>00088   <span class="keywordtype">double</span> r0,r1;
<a name="l00089"></a>00089   <a class="code" href="distances__VEF_8h.html#ad9a0b7617683118622992e84575d084a">calcule_r0r1</a>(face_normale,fac,r0,r1);
<a name="l00090"></a>00090 
<a name="l00091"></a>00091   <span class="keywordtype">double</span> v0=(c1*vit(num1,0)+c2*vit(num2,0))/(c1+c2);
<a name="l00092"></a>00092   <span class="keywordtype">double</span> v1=(c1*vit(num1,1)+c2*vit(num2,1))/(c1+c2);
<a name="l00093"></a>00093 
<a name="l00094"></a>00094   <span class="keywordtype">double</span> psc = r0 * v0 + r1 * v1;
<a name="l00095"></a>00095   <span class="keywordtype">double</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a> = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v0,v1,r0,r1);
<a name="l00096"></a>00096 <span class="comment">// composantes du vecteur tangent normalise</span>
<a name="l00097"></a>00097   val1 = (v0-psc*r0)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00098"></a>00098   val2 = (v1-psc*r1)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00099"></a>00099 
<a name="l00100"></a>00100   <span class="keywordflow">return</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a>;
<a name="l00101"></a>00101 }
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="distances__VEF_8h.html#ad631d743d92f960791212faf87c7bb2f">00103</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#afef3c9077fa444dae08819c4b5f95bcc">norm_2D_vit1</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> num3,<span class="keywordtype">int</span> fac,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,<span class="keywordtype">double</span>&amp; u)
<a name="l00104"></a>00104 {
<a name="l00105"></a>00105   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00106"></a>00106   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00107"></a>00107   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="comment">// fac numero de la face a paroi fixe</span>
<a name="l00110"></a>00110   <span class="keywordtype">double</span> r0,r1;
<a name="l00111"></a>00111   <a class="code" href="distances__VEF_8h.html#ad9a0b7617683118622992e84575d084a">calcule_r0r1</a>(face_normale,fac,r0,r1);
<a name="l00112"></a>00112   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0)+vit(num3,0))/nfac;
<a name="l00113"></a>00113   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1)+vit(num3,1))/nfac;
<a name="l00114"></a>00114   <span class="keywordtype">double</span> v = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,r0,r1);
<a name="l00115"></a>00115   <span class="keywordflow">if</span> (v==0)
<a name="l00116"></a>00116     u = 0;
<a name="l00117"></a>00117   <span class="keywordflow">else</span>
<a name="l00118"></a>00118     u = 1;
<a name="l00119"></a>00119   <span class="keywordflow">return</span> v;
<a name="l00120"></a>00120 }
<a name="l00121"></a>00121 
<a name="l00122"></a><a class="code" href="distances__VEF_8h.html#a919d60fae93685d3321eff4697d993b8">00122</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#afef3c9077fa444dae08819c4b5f95bcc">norm_2D_vit1</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> num3,<span class="keywordtype">int</span> num4,<span class="keywordtype">int</span> fac,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,<span class="keywordtype">double</span>&amp; u)
<a name="l00123"></a>00123 {
<a name="l00124"></a>00124   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00125"></a>00125   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00126"></a>00126   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="comment">// fac numero de la face a paroi fixe</span>
<a name="l00129"></a>00129   <span class="keywordtype">double</span> r0,r1;
<a name="l00130"></a>00130   <a class="code" href="distances__VEF_8h.html#ad9a0b7617683118622992e84575d084a">calcule_r0r1</a>(face_normale,fac,r0,r1);
<a name="l00131"></a>00131   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0)+vit(num3,0)+vit(num4,0))/nfac;
<a name="l00132"></a>00132   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1)+vit(num3,1)+vit(num4,1))/nfac;
<a name="l00133"></a>00133   <span class="keywordtype">double</span> v = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,r0,r1);
<a name="l00134"></a>00134   <span class="keywordflow">if</span> (v==0)
<a name="l00135"></a>00135     u = 0;
<a name="l00136"></a>00136   <span class="keywordflow">else</span>
<a name="l00137"></a>00137     u = 1;
<a name="l00138"></a>00138   <span class="keywordflow">return</span> v;
<a name="l00139"></a>00139 }
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 
<a name="l00142"></a><a class="code" href="distances__VEF_8h.html#aa3a485d549675d129e60ad784b4dfab1">00142</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#a254ed0ca88a2403de3457f6e09a6c5ff">norm_2D_vit2</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> fac,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone, <span class="keywordtype">double</span>&amp; u)
<a name="l00143"></a>00143 {
<a name="l00144"></a>00144   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00145"></a>00145   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00146"></a>00146   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00147"></a>00147 <span class="comment">// fac numero de la face a paroi defilante</span>
<a name="l00148"></a>00148   <span class="keywordtype">double</span> r0,r1;
<a name="l00149"></a>00149   <a class="code" href="distances__VEF_8h.html#ad9a0b7617683118622992e84575d084a">calcule_r0r1</a>(face_normale,fac,r0,r1);
<a name="l00150"></a>00150   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0)-2.*vit(fac,0))/nfac;
<a name="l00151"></a>00151   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1)-2.*vit(fac,1))/nfac;
<a name="l00152"></a>00152   <span class="keywordtype">double</span> v = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,r0,r1);
<a name="l00153"></a>00153   <span class="keywordflow">if</span> (v==0)
<a name="l00154"></a>00154     u = 0;
<a name="l00155"></a>00155   <span class="keywordflow">else</span>
<a name="l00156"></a>00156     u = 1;
<a name="l00157"></a>00157   <span class="keywordflow">return</span> v;
<a name="l00158"></a>00158 }
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="distances__VEF_8h.html#ae9806e48af14e228c23aeac860573ffd">00160</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#a254ed0ca88a2403de3457f6e09a6c5ff">norm_2D_vit2</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> num3,<span class="keywordtype">int</span> fac,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone, <span class="keywordtype">double</span>&amp; u)
<a name="l00161"></a>00161 {
<a name="l00162"></a>00162   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00163"></a>00163   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00164"></a>00164   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00165"></a>00165 <span class="comment">// fac numero de la face a paroi defilante</span>
<a name="l00166"></a>00166   <span class="keywordtype">double</span> r0,r1;
<a name="l00167"></a>00167   <a class="code" href="distances__VEF_8h.html#ad9a0b7617683118622992e84575d084a">calcule_r0r1</a>(face_normale,fac,r0,r1);
<a name="l00168"></a>00168   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0)+vit(num3,0)-3.*vit(fac,0))/nfac;
<a name="l00169"></a>00169   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1)+vit(num3,1)-3.*vit(fac,1))/nfac;
<a name="l00170"></a>00170   <span class="keywordtype">double</span> v = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,r0,r1);
<a name="l00171"></a>00171   <span class="keywordflow">if</span> (v==0)
<a name="l00172"></a>00172     u = 0;
<a name="l00173"></a>00173   <span class="keywordflow">else</span>
<a name="l00174"></a>00174     u = 1;
<a name="l00175"></a>00175   <span class="keywordflow">return</span> v;
<a name="l00176"></a>00176 }
<a name="l00177"></a>00177 
<a name="l00178"></a><a class="code" href="distances__VEF_8h.html#a477d7e7e46c9d4c065f6ed411d1b7a5d">00178</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#a254ed0ca88a2403de3457f6e09a6c5ff">norm_2D_vit2</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> num3,<span class="keywordtype">int</span> num4,<span class="keywordtype">int</span> fac,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,<span class="keywordtype">double</span>&amp; u)
<a name="l00179"></a>00179 {
<a name="l00180"></a>00180   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00181"></a>00181   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00182"></a>00182   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="comment">// fac numero de la face a paroi fixe</span>
<a name="l00185"></a>00185   <span class="keywordtype">double</span> r0,r1;
<a name="l00186"></a>00186   <a class="code" href="distances__VEF_8h.html#ad9a0b7617683118622992e84575d084a">calcule_r0r1</a>(face_normale,fac,r0,r1);
<a name="l00187"></a>00187   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0)+vit(num3,0)+vit(num4,0)-4.*vit(fac,0))/nfac;
<a name="l00188"></a>00188   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1)+vit(num3,1)+vit(num4,1)-4.*vit(fac,1))/nfac;
<a name="l00189"></a>00189   <span class="keywordtype">double</span> v = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,r0,r1);
<a name="l00190"></a>00190   <span class="keywordflow">if</span> (v==0)
<a name="l00191"></a>00191     u = 0;
<a name="l00192"></a>00192   <span class="keywordflow">else</span>
<a name="l00193"></a>00193     u = 1;
<a name="l00194"></a>00194   <span class="keywordflow">return</span> v;
<a name="l00195"></a>00195 }
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 
<a name="l00198"></a><a class="code" href="distances__VEF_8h.html#ab2783144acec34a0b426e3b6745696cd">00198</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#ab2783144acec34a0b426e3b6745696cd">distance_2D</a>(<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> elem,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone)
<a name="l00199"></a>00199 {
<a name="l00200"></a>00200   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xp = zone.<a class="code" href="classZone__VF.html#a87a29f0223c71256a25ee343c9277599">xp</a>();    <span class="comment">//!&lt; centre de gravite des elements</span>
<a name="l00201"></a>00201 <span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xv = zone.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();    <span class="comment">//!&lt; centre de gravite des faces</span>
<a name="l00202"></a>00202 <span class="comment"></span>
<a name="l00203"></a>00203   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00204"></a>00204   <span class="keywordtype">double</span> r0,r1;
<a name="l00205"></a>00205   <a class="code" href="distances__VEF_8h.html#ad9a0b7617683118622992e84575d084a">calcule_r0r1</a>(face_normale,fac,r0,r1);
<a name="l00206"></a>00206 
<a name="l00207"></a>00207   <span class="keywordtype">double</span> x0=xv(fac,0);
<a name="l00208"></a>00208   <span class="keywordtype">double</span> y0=xv(fac,1);
<a name="l00209"></a>00209   <span class="keywordtype">double</span> x1=xp(elem,0);
<a name="l00210"></a>00210   <span class="keywordtype">double</span> y1=xp(elem,1);
<a name="l00211"></a>00211 
<a name="l00212"></a>00212   <span class="keywordflow">return</span> <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(r0*(x1-x0)+r1*(y1-y0));
<a name="l00213"></a>00213 }
<a name="l00214"></a>00214 
<a name="l00215"></a><a class="code" href="distances__VEF_8cpp.html#a6d750800bff9a68e1d998f743dc812e5">00215</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#a6d750800bff9a68e1d998f743dc812e5">norm_2D_vit1_k</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> num1,
<a name="l00216"></a>00216                       <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,
<a name="l00217"></a>00217                       <span class="keywordtype">double</span>&amp; val1,<span class="keywordtype">double</span>&amp; val2)
<a name="l00218"></a>00218 {
<a name="l00219"></a>00219   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00220"></a>00220 <span class="comment">// fac numero de la face a paroi fixe</span>
<a name="l00221"></a>00221   <span class="keywordtype">double</span> r0,r1;
<a name="l00222"></a>00222   <a class="code" href="distances__VEF_8h.html#ad9a0b7617683118622992e84575d084a">calcule_r0r1</a>(face_normale,fac,r0,r1);
<a name="l00223"></a>00223   <span class="keywordtype">double</span> v1=vit(num1,0);
<a name="l00224"></a>00224   <span class="keywordtype">double</span> v2=vit(num1,1);
<a name="l00225"></a>00225   <span class="keywordtype">double</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a> = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,r0,r1);
<a name="l00226"></a>00226 
<a name="l00227"></a>00227   <span class="keywordtype">double</span> psc = r0*v1+r1*v2;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 <span class="comment">// val1 et val2 sont les vitesses tangetentielles</span>
<a name="l00230"></a>00230   val1=(v1-psc*r0)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00231"></a>00231   val2=(v2-psc*r1)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 
<a name="l00234"></a>00234   <span class="keywordflow">return</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a>;
<a name="l00235"></a>00235 }
<a name="l00236"></a><a class="code" href="distances__VEF_8h.html#a68d3aa063fd94b01e2e4094a883f90d2">00236</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#aa6a9b6fbe6b894a2550dadc9ed04d3af">norm_3D_vit1</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> num1,
<a name="l00237"></a>00237                     <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,
<a name="l00238"></a>00238                     <span class="keywordtype">double</span>&amp; val1,<span class="keywordtype">double</span>&amp; val2,<span class="keywordtype">double</span>&amp; val3)
<a name="l00239"></a>00239 {
<a name="l00240"></a>00240   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00241"></a>00241 <span class="comment">// fac numero de la face a paroi fixe</span>
<a name="l00242"></a>00242   <span class="keywordtype">double</span> r0,r1,r2;
<a name="l00243"></a>00243   <a class="code" href="distances__VEF_8h.html#abc9d93e5d3f226f4e0b6ca4a929f3c77">calcule_r0r1r2</a>(face_normale,fac,r0,r1,r2);
<a name="l00244"></a>00244   <span class="keywordtype">double</span> v1=vit(num1,0);
<a name="l00245"></a>00245   <span class="keywordtype">double</span> v2=vit(num1,1);
<a name="l00246"></a>00246   <span class="keywordtype">double</span> v3=vit(num1,2);
<a name="l00247"></a>00247   <span class="keywordtype">double</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a> = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,v3,r0,r1,r2);
<a name="l00248"></a>00248 
<a name="l00249"></a>00249   <span class="keywordtype">double</span> psc = r0*v1+r1*v2+r2*v3;
<a name="l00250"></a>00250 <span class="comment">// val1,val2 val3 sont les vitesses tangentielles</span>
<a name="l00251"></a>00251   val1=(v1-psc*r0)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00252"></a>00252   val2=(v2-psc*r1)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00253"></a>00253   val3=(v3-psc*r2)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00254"></a>00254 
<a name="l00255"></a>00255   <span class="keywordflow">return</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a>;
<a name="l00256"></a>00256 }
<a name="l00257"></a>00257 
<a name="l00258"></a><a class="code" href="distances__VEF_8h.html#ad62da76d772be8d8c87856311bd4dc6a">00258</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#aa6a9b6fbe6b894a2550dadc9ed04d3af">norm_3D_vit1</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> num3,
<a name="l00259"></a>00259                     <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,
<a name="l00260"></a>00260                     <span class="keywordtype">double</span>&amp; val1,<span class="keywordtype">double</span>&amp; val2,<span class="keywordtype">double</span>&amp; val3)
<a name="l00261"></a>00261 {
<a name="l00262"></a>00262   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00263"></a>00263   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00264"></a>00264   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00265"></a>00265 <span class="comment">// fac numero de la face a paroi fixe</span>
<a name="l00266"></a>00266   <span class="keywordtype">double</span> r0,r1,r2;
<a name="l00267"></a>00267   <a class="code" href="distances__VEF_8h.html#abc9d93e5d3f226f4e0b6ca4a929f3c77">calcule_r0r1r2</a>(face_normale,fac,r0,r1,r2);
<a name="l00268"></a>00268   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0)+vit(num3,0))/nfac;
<a name="l00269"></a>00269   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1)+vit(num3,1))/nfac;
<a name="l00270"></a>00270   <span class="keywordtype">double</span> v3=(vit(num1,2)+vit(num2,2)+vit(num3,2))/nfac;
<a name="l00271"></a>00271   <span class="keywordtype">double</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a> = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,v3,r0,r1,r2);
<a name="l00272"></a>00272 <span class="comment">// val1,val2 val3 sont les vitesses tangentielles</span>
<a name="l00273"></a>00273   <span class="keywordtype">double</span> psc = r0*v1+r1*v2+r2*v3;
<a name="l00274"></a>00274   val1=(v1-psc*r0)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00275"></a>00275   val2=(v2-psc*r1)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00276"></a>00276   val3=(v3-psc*r2)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00277"></a>00277 
<a name="l00278"></a>00278   <span class="keywordflow">return</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a>;
<a name="l00279"></a>00279 }
<a name="l00280"></a>00280 
<a name="l00281"></a><a class="code" href="distances__VEF_8h.html#ab094e0e9309eed38bdc162877547d66c">00281</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#aa6a9b6fbe6b894a2550dadc9ed04d3af">norm_3D_vit1</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> num3,<span class="keywordtype">int</span> num4,
<a name="l00282"></a>00282                     <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,
<a name="l00283"></a>00283                     <span class="keywordtype">double</span>&amp; val1,<span class="keywordtype">double</span>&amp; val2,<span class="keywordtype">double</span>&amp; val3)
<a name="l00284"></a>00284 {
<a name="l00285"></a>00285   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00286"></a>00286   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00287"></a>00287   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00288"></a>00288 <span class="comment">// fac numero de la face a paroi fixe</span>
<a name="l00289"></a>00289   <span class="keywordtype">double</span> r0,r1,r2;
<a name="l00290"></a>00290   <a class="code" href="distances__VEF_8h.html#abc9d93e5d3f226f4e0b6ca4a929f3c77">calcule_r0r1r2</a>(face_normale,fac,r0,r1,r2);
<a name="l00291"></a>00291   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0)+vit(num3,0)+vit(num4,0))/nfac;
<a name="l00292"></a>00292   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1)+vit(num3,1)+vit(num4,1))/nfac;
<a name="l00293"></a>00293   <span class="keywordtype">double</span> v3=(vit(num1,2)+vit(num2,2)+vit(num3,2)+vit(num4,2))/nfac;
<a name="l00294"></a>00294   <span class="keywordtype">double</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a> = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,v3,r0,r1,r2);
<a name="l00295"></a>00295 <span class="comment">// val1,val2 val3 sont les vitesses tangentielles</span>
<a name="l00296"></a>00296   <span class="keywordtype">double</span> psc = r0*v1+r1*v2+r2*v3;
<a name="l00297"></a>00297   val1=(v1-psc*r0)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00298"></a>00298   val2=(v2-psc*r1)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00299"></a>00299   val3=(v3-psc*r2)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00300"></a>00300   <span class="keywordflow">return</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a>;
<a name="l00301"></a>00301 }
<a name="l00302"></a><a class="code" href="distances__VEF_8h.html#a2abdc2a2a9da18b27717df3ee212697e">00302</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#aa6a9b6fbe6b894a2550dadc9ed04d3af">norm_3D_vit1</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> num3,<span class="keywordtype">int</span> num4,
<a name="l00303"></a>00303                     <span class="keywordtype">int</span> num5,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,
<a name="l00304"></a>00304                     <span class="keywordtype">double</span>&amp; val1,<span class="keywordtype">double</span>&amp; val2,<span class="keywordtype">double</span>&amp; val3)
<a name="l00305"></a>00305 {
<a name="l00306"></a>00306   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00307"></a>00307   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00308"></a>00308   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00309"></a>00309 <span class="comment">// fac numero de la face a paroi fixe</span>
<a name="l00310"></a>00310   <span class="keywordtype">double</span> r0,r1,r2;
<a name="l00311"></a>00311   <a class="code" href="distances__VEF_8h.html#abc9d93e5d3f226f4e0b6ca4a929f3c77">calcule_r0r1r2</a>(face_normale,fac,r0,r1,r2);
<a name="l00312"></a>00312   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0)+vit(num3,0)+vit(num4,0)+vit(num5,0))/nfac;
<a name="l00313"></a>00313   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1)+vit(num3,1)+vit(num4,1)+vit(num5,1))/nfac;
<a name="l00314"></a>00314   <span class="keywordtype">double</span> v3=(vit(num1,2)+vit(num2,2)+vit(num3,2)+vit(num4,2)+vit(num5,2))/nfac;
<a name="l00315"></a>00315   <span class="keywordtype">double</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a> = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,v3,r0,r1,r2);
<a name="l00316"></a>00316 <span class="comment">// val1,val2 val3 sont les vitesses tangentielles</span>
<a name="l00317"></a>00317   <span class="keywordtype">double</span> psc = r0*v1+r1*v2+r2*v3;
<a name="l00318"></a>00318   val1=(v1-psc*r0)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00319"></a>00319   val2=(v2-psc*r1)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00320"></a>00320   val3=(v3-psc*r2)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00321"></a>00321 
<a name="l00322"></a>00322   <span class="keywordflow">return</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a>;
<a name="l00323"></a>00323 }
<a name="l00324"></a>00324 
<a name="l00325"></a><a class="code" href="distances__VEF_8cpp.html#aef7e882140b3bdc0458af97214e38a33">00325</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#aef7e882140b3bdc0458af97214e38a33">norm_2D_vit2_k</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> num1,
<a name="l00326"></a>00326                       <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,
<a name="l00327"></a>00327                       <span class="keywordtype">double</span>&amp; val1,<span class="keywordtype">double</span>&amp; val2)
<a name="l00328"></a>00328 {
<a name="l00329"></a>00329   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00330"></a>00330 <span class="comment">// fac numero de la face a paroi defilante</span>
<a name="l00331"></a>00331   <span class="keywordtype">double</span> r0,r1;
<a name="l00332"></a>00332   <a class="code" href="distances__VEF_8h.html#ad9a0b7617683118622992e84575d084a">calcule_r0r1</a>(face_normale,fac,r0,r1);
<a name="l00333"></a>00333 
<a name="l00334"></a>00334   <span class="keywordtype">double</span> v1=vit(num1,0)-vit(fac,0);
<a name="l00335"></a>00335   <span class="keywordtype">double</span> v2=vit(num1,1)-vit(fac,1);
<a name="l00336"></a>00336   <span class="keywordtype">double</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a> = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,r0,r1);
<a name="l00337"></a>00337 <span class="comment">// val1 et val2 sont les vitesses tangetentielles</span>
<a name="l00338"></a>00338   <span class="keywordtype">double</span> psc = r0*v1+r1*v2;
<a name="l00339"></a>00339   val1=(v1-psc*r0)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00340"></a>00340   val2=(v2-psc*r1)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00341"></a>00341 
<a name="l00342"></a>00342   <span class="keywordflow">return</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a>;
<a name="l00343"></a>00343 }
<a name="l00344"></a><a class="code" href="distances__VEF_8h.html#adf291880df306f3149a2e58400ba83eb">00344</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#a17f9116c26c71938a0d388002f397ba5">norm_3D_vit2</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> num1,
<a name="l00345"></a>00345                     <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,
<a name="l00346"></a>00346                     <span class="keywordtype">double</span>&amp; val1,<span class="keywordtype">double</span>&amp; val2,<span class="keywordtype">double</span>&amp; val3)
<a name="l00347"></a>00347 {
<a name="l00348"></a>00348   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00349"></a>00349 <span class="comment">// fac numero de la face a paroi defilante</span>
<a name="l00350"></a>00350   <span class="keywordtype">double</span> r0,r1,r2;
<a name="l00351"></a>00351   <a class="code" href="distances__VEF_8h.html#abc9d93e5d3f226f4e0b6ca4a929f3c77">calcule_r0r1r2</a>(face_normale,fac,r0,r1,r2);
<a name="l00352"></a>00352   <span class="keywordtype">double</span> v1=vit(num1,0)-vit(fac,0);
<a name="l00353"></a>00353   <span class="keywordtype">double</span> v2=vit(num1,1)-vit(fac,1);
<a name="l00354"></a>00354   <span class="keywordtype">double</span> v3=vit(num1,2)-vit(fac,2);
<a name="l00355"></a>00355   <span class="keywordtype">double</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a> = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,v3,r0,r1,r2);
<a name="l00356"></a>00356 <span class="comment">// val1,val2 val3 sont les vitesses tangentielles</span>
<a name="l00357"></a>00357   <span class="keywordtype">double</span> psc = r0*v1+r1*v2+r2*v3;
<a name="l00358"></a>00358   val1=(v1-psc*r0)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00359"></a>00359   val2=(v2-psc*r1)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00360"></a>00360   val3=(v3-psc*r2)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00361"></a>00361 
<a name="l00362"></a>00362   <span class="keywordflow">return</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a>;
<a name="l00363"></a>00363 }
<a name="l00364"></a>00364 
<a name="l00365"></a><a class="code" href="distances__VEF_8h.html#a6fef36376d263c264211b9a751eaf97b">00365</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#a17f9116c26c71938a0d388002f397ba5">norm_3D_vit2</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> num3,
<a name="l00366"></a>00366                     <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,
<a name="l00367"></a>00367                     <span class="keywordtype">double</span>&amp; val1,<span class="keywordtype">double</span>&amp; val2,<span class="keywordtype">double</span>&amp; val3)
<a name="l00368"></a>00368 {
<a name="l00369"></a>00369   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00370"></a>00370   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00371"></a>00371   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00372"></a>00372 <span class="comment">// fac numero de la face a paroi defilante</span>
<a name="l00373"></a>00373   <span class="keywordtype">double</span> r0,r1,r2;
<a name="l00374"></a>00374   <a class="code" href="distances__VEF_8h.html#abc9d93e5d3f226f4e0b6ca4a929f3c77">calcule_r0r1r2</a>(face_normale,fac,r0,r1,r2);
<a name="l00375"></a>00375   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0)+vit(num3,0)-(nfac-1)*vit(fac,0))/nfac;
<a name="l00376"></a>00376   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1)+vit(num3,1)-(nfac-1)*vit(fac,1))/nfac;
<a name="l00377"></a>00377   <span class="keywordtype">double</span> v3=(vit(num1,2)+vit(num2,2)+vit(num3,2)-(nfac-1)*vit(fac,2))/nfac;
<a name="l00378"></a>00378   <span class="keywordtype">double</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a> = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,v3,r0,r1,r2);
<a name="l00379"></a>00379 <span class="comment">// val1,val2 val3 sont les vitesses tangentielles</span>
<a name="l00380"></a>00380   <span class="keywordtype">double</span> psc = r0*v1+r1*v2+r2*v3;
<a name="l00381"></a>00381   val1=(v1-psc*r0)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00382"></a>00382   val2=(v2-psc*r1)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00383"></a>00383   val3=(v3-psc*r2)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00384"></a>00384   <span class="keywordflow">return</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a>;
<a name="l00385"></a>00385 }
<a name="l00386"></a>00386 
<a name="l00387"></a><a class="code" href="distances__VEF_8h.html#a7d686c02177b357a1a747815061710ba">00387</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#a8c6b41988d298e5bf17c7132f752e8e6">norm_3D_vit1_lp</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> num3,
<a name="l00388"></a>00388                        <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,
<a name="l00389"></a>00389                        <span class="keywordtype">double</span>&amp; val1,<span class="keywordtype">double</span>&amp; val2,<span class="keywordtype">double</span>&amp; val3)
<a name="l00390"></a>00390 {
<a name="l00391"></a>00391 <span class="comment">// PQ : 03/03 : Definition de la vitesse tangentielle a une paroi</span>
<a name="l00392"></a>00392 <span class="comment">// obtenue par &quot;moyennage&quot; des vitesses aux faces associees a des elements standards</span>
<a name="l00393"></a>00393 <span class="comment">// (dont on suppose le bon comportement suivant la loi log)</span>
<a name="l00394"></a>00394 
<a name="l00395"></a>00395   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00396"></a>00396 <span class="comment">// const IntVect&amp; rang_elem_non_std = zone.rang_elem_non_std();</span>
<a name="l00397"></a>00397   <span class="keywordtype">double</span> c1,c2,c3;
<a name="l00398"></a>00398   c1=0.;
<a name="l00399"></a>00399   c2=0.;
<a name="l00400"></a>00400   c3=0.;
<a name="l00401"></a>00401 
<a name="l00402"></a>00402 <span class="comment">// int rang1 = rang_elem_non_std(num1);</span>
<a name="l00403"></a>00403 <span class="comment">// if (rang1&lt;0) c1=1.;</span>
<a name="l00404"></a>00404 <span class="comment">// int rang2 = rang_elem_non_std(num2);</span>
<a name="l00405"></a>00405 <span class="comment">// if (rang2&lt;0) c2=1.;</span>
<a name="l00406"></a>00406 <span class="comment">// int rang3 = rang_elem_non_std(num3);</span>
<a name="l00407"></a>00407 <span class="comment">// if (rang3&lt;0) c3=1.;</span>
<a name="l00408"></a>00408 
<a name="l00409"></a>00409   c1=1.;
<a name="l00410"></a>00410   c2=1.;
<a name="l00411"></a>00411   c3=1.;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413   <span class="keywordtype">double</span> r0,r1,r2;
<a name="l00414"></a>00414   <a class="code" href="distances__VEF_8h.html#abc9d93e5d3f226f4e0b6ca4a929f3c77">calcule_r0r1r2</a>(face_normale,fac,r0,r1,r2);
<a name="l00415"></a>00415   <span class="keywordtype">double</span> v0=(c1*vit(num1,0)+c2*vit(num2,0)+c3*vit(num3,0))/(c1+c2+c3);
<a name="l00416"></a>00416   <span class="keywordtype">double</span> v1=(c1*vit(num1,1)+c2*vit(num2,1)+c3*vit(num3,1))/(c1+c2+c3);
<a name="l00417"></a>00417   <span class="keywordtype">double</span> v2=(c1*vit(num1,2)+c2*vit(num2,2)+c3*vit(num3,2))/(c1+c2+c3);
<a name="l00418"></a>00418 
<a name="l00419"></a>00419   <span class="keywordtype">double</span> psc = r0 * v0 + r1 * v1 + r2 * v2;
<a name="l00420"></a>00420   <span class="keywordtype">double</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a> = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v0,v1,v2,r0,r1,r2);
<a name="l00421"></a>00421 <span class="comment">// composantes du vecteur tangent normalise</span>
<a name="l00422"></a>00422   val1 = (v0-psc*r0)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00423"></a>00423   val2 = (v1-psc*r1)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00424"></a>00424   val3 = (v2-psc*r2)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00425"></a>00425 
<a name="l00426"></a>00426   <span class="keywordflow">return</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a>;
<a name="l00427"></a>00427 }
<a name="l00428"></a>00428 
<a name="l00429"></a><a class="code" href="distances__VEF_8h.html#a5e541f13ba444df8983e7a7f5afc1e4d">00429</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#a17f9116c26c71938a0d388002f397ba5">norm_3D_vit2</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> num3,<span class="keywordtype">int</span> num4,
<a name="l00430"></a>00430                     <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,
<a name="l00431"></a>00431                     <span class="keywordtype">double</span>&amp; val1,<span class="keywordtype">double</span>&amp; val2,<span class="keywordtype">double</span>&amp; val3)
<a name="l00432"></a>00432 {
<a name="l00433"></a>00433   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00434"></a>00434   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00435"></a>00435   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00436"></a>00436 <span class="comment">// fac numero de la face a paroi defilante</span>
<a name="l00437"></a>00437   <span class="keywordtype">double</span> r0,r1,r2;
<a name="l00438"></a>00438   <a class="code" href="distances__VEF_8h.html#abc9d93e5d3f226f4e0b6ca4a929f3c77">calcule_r0r1r2</a>(face_normale,fac,r0,r1,r2);
<a name="l00439"></a>00439 
<a name="l00440"></a>00440   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0)+vit(num3,0)+vit(num4,0)-nfac*vit(fac,0))/nfac;
<a name="l00441"></a>00441   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1)+vit(num3,1)+vit(num4,1)-nfac*vit(fac,1))/nfac;
<a name="l00442"></a>00442   <span class="keywordtype">double</span> v3=(vit(num1,2)+vit(num2,2)+vit(num3,2)+vit(num4,2)-nfac*vit(fac,2))/nfac;
<a name="l00443"></a>00443   <span class="keywordtype">double</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a> = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,v3,r0,r1,r2);
<a name="l00444"></a>00444 <span class="comment">// val1,val2 val3 sont les vitesses tangentielles</span>
<a name="l00445"></a>00445   <span class="keywordtype">double</span> psc = r0*v1+r1*v2+r2*v3;
<a name="l00446"></a>00446   val1=(v1-psc*r0)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00447"></a>00447   val2=(v2-psc*r1)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00448"></a>00448   val3=(v3-psc*r2)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00449"></a>00449 
<a name="l00450"></a>00450   <span class="keywordflow">return</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a>;
<a name="l00451"></a>00451 }
<a name="l00452"></a><a class="code" href="distances__VEF_8h.html#ae230241c0a22348226401049adfdf39d">00452</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#a17f9116c26c71938a0d388002f397ba5">norm_3D_vit2</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> num1,<span class="keywordtype">int</span> num2,<span class="keywordtype">int</span> num3,<span class="keywordtype">int</span> num4,
<a name="l00453"></a>00453                     <span class="keywordtype">int</span> num5, <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,
<a name="l00454"></a>00454                     <span class="keywordtype">double</span>&amp; val1,<span class="keywordtype">double</span>&amp; val2,<span class="keywordtype">double</span>&amp; val3)
<a name="l00455"></a>00455 {
<a name="l00456"></a>00456   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00457"></a>00457   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00458"></a>00458   <span class="keywordtype">int</span> nfac = zone_geom.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00459"></a>00459 <span class="comment">// fac numero de la face a paroi defilante</span>
<a name="l00460"></a>00460   <span class="keywordtype">double</span> r0,r1,r2;
<a name="l00461"></a>00461   <a class="code" href="distances__VEF_8h.html#abc9d93e5d3f226f4e0b6ca4a929f3c77">calcule_r0r1r2</a>(face_normale,fac,r0,r1,r2);
<a name="l00462"></a>00462 
<a name="l00463"></a>00463   <span class="keywordtype">double</span> v1=(vit(num1,0)+vit(num2,0)+vit(num3,0)+vit(num4,0)+vit(num5,0)-nfac*vit(fac,0))/nfac;
<a name="l00464"></a>00464   <span class="keywordtype">double</span> v2=(vit(num1,1)+vit(num2,1)+vit(num3,1)+vit(num4,1)+vit(num5,1)-nfac*vit(fac,1))/nfac;
<a name="l00465"></a>00465   <span class="keywordtype">double</span> v3=(vit(num1,2)+vit(num2,2)+vit(num3,2)+vit(num4,2)+vit(num5,2)-nfac*vit(fac,2))/nfac;
<a name="l00466"></a>00466   <span class="keywordtype">double</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a> = <a class="code" href="distances__VEF_8h.html#ab794f23fd416cbc57393d5ee0e6c2d64">vitesse_tangentielle</a>(v1,v2,v3,r0,r1,r2);
<a name="l00467"></a>00467 <span class="comment">// val1,val2 val3 sont les vitesses tangentielles</span>
<a name="l00468"></a>00468   <span class="keywordtype">double</span> psc = r0*v1+r1*v2+r2*v3;
<a name="l00469"></a>00469   val1=(v1-psc*r0)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00470"></a>00470   val2=(v2-psc*r1)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00471"></a>00471   val3=(v3-psc*r2)/(norm_vit+<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>);
<a name="l00472"></a>00472 
<a name="l00473"></a>00473   <span class="keywordflow">return</span> <a class="code" href="distances__VDF_8cpp.html#a52db854ad21544e60e07c67ca1d1ff0a">norm_vit</a>;
<a name="l00474"></a>00474 }
<a name="l00475"></a>00475 
<a name="l00476"></a><a class="code" href="distances__VEF_8h.html#aec2af8d7d36c326744c660af71eab979">00476</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#aec2af8d7d36c326744c660af71eab979">distance_3D</a>(<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> elem,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone)
<a name="l00477"></a>00477 {
<a name="l00478"></a>00478   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xp = zone.<a class="code" href="classZone__VF.html#a87a29f0223c71256a25ee343c9277599">xp</a>();    <span class="comment">//!&lt; centre de gravite des elements</span>
<a name="l00479"></a>00479 <span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xv = zone.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();    <span class="comment">//!&lt; centre de gravite des faces</span>
<a name="l00480"></a>00480 <span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normale = zone.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
<a name="l00481"></a>00481   <span class="keywordtype">double</span> r0,r1,r2;
<a name="l00482"></a>00482   <a class="code" href="distances__VEF_8h.html#abc9d93e5d3f226f4e0b6ca4a929f3c77">calcule_r0r1r2</a>(face_normale,fac,r0,r1,r2);
<a name="l00483"></a>00483   <span class="keywordtype">double</span> x0=xv(fac,0);
<a name="l00484"></a>00484   <span class="keywordtype">double</span> y0=xv(fac,1);
<a name="l00485"></a>00485   <span class="keywordtype">double</span> z0=xv(fac,2);
<a name="l00486"></a>00486   <span class="keywordtype">double</span> x1=xp(elem,0);
<a name="l00487"></a>00487   <span class="keywordtype">double</span> y1=xp(elem,1);
<a name="l00488"></a>00488   <span class="keywordtype">double</span> z1=xp(elem,2);
<a name="l00489"></a>00489 
<a name="l00490"></a>00490   <span class="keywordflow">return</span> <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(r0*(x1-x0)+r1*(y1-y0)+r2*(z1-z0));
<a name="l00491"></a>00491 }
<a name="l00492"></a>00492 
<a name="l00493"></a><a class="code" href="distances__VEF_8h.html#a548b6610c721ed87eab13bb760e32883">00493</a> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="distances__VEF_8cpp.html#a548b6610c721ed87eab13bb760e32883">calcul_longueur_filtre</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; longueur_filtre, <span class="keyword">const</span> <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>&amp; methode, <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone)
<a name="l00494"></a>00494 {
<a name="l00495"></a>00495   <span class="keywordtype">int</span> nbr_element=zone.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
<a name="l00496"></a>00496   <span class="keywordtype">int</span> element;
<a name="l00497"></a>00497   <span class="keywordtype">int</span> dim=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00498"></a>00498   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00499"></a>00499 
<a name="l00500"></a>00500   <span class="keywordflow">if</span> (longueur_filtre.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() != nbr_element)
<a name="l00501"></a>00501     {
<a name="l00502"></a>00502       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;erreur dans la taille du DoubleVect valeurs de la longueur du filtre&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00503"></a>00503       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00504"></a>00504     }
<a name="l00505"></a>00505 
<a name="l00506"></a>00506   <span class="keywordflow">if</span> (methode == <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>(<span class="stringliteral">&quot;volume&quot;</span>) || methode == <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>(<span class="stringliteral">&quot;volume_sans_lissage&quot;</span>))  <span class="comment">//!&lt; racine cubique du volume</span>
<a name="l00507"></a>00507 <span class="comment"></span>    {
<a name="l00508"></a>00508       longueur_filtre=-1.;
<a name="l00509"></a>00509 
<a name="l00510"></a>00510       <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volume = zone.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00511"></a>00511       <span class="keywordflow">for</span> (element=0; element&lt;nbr_element; element ++)
<a name="l00512"></a>00512         {
<a name="l00513"></a>00513           longueur_filtre(element) = exp(log(volume[element])/<span class="keywordtype">double</span>(dim));
<a name="l00514"></a>00514         }
<a name="l00515"></a>00515     }
<a name="l00516"></a>00516   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (methode == <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>(<span class="stringliteral">&quot;arete&quot;</span>))  <span class="comment">//!&lt; recherche de la plus longue arete d&#39;un element</span>
<a name="l00517"></a>00517 <span class="comment"></span>    {
<a name="l00518"></a>00518       longueur_filtre=-1.;
<a name="l00519"></a>00519 
<a name="l00520"></a>00520       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; les_sommets = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00521"></a>00521       <span class="keywordtype">int</span> som1,som2,som_1,som_2;
<a name="l00522"></a>00522       <span class="keywordtype">double</span> distance;
<a name="l00523"></a>00523 
<a name="l00524"></a>00524       <span class="keywordflow">for</span> (element=0; element&lt;nbr_element; element ++)
<a name="l00525"></a>00525         <span class="keywordflow">for</span> (som1=0; som1&lt;dim; som1++)
<a name="l00526"></a>00526           <span class="keywordflow">for</span> (som2=som1; som2&lt;dim+1; som2++)
<a name="l00527"></a>00527             {
<a name="l00528"></a>00528               som_1 = les_sommets(element, som1);
<a name="l00529"></a>00529               som_2 = les_sommets(element, som2);
<a name="l00530"></a>00530 
<a name="l00531"></a>00531               distance = <a class="code" href="distances__VEF_8cpp.html#ae0f3e368d20b3c75b4f6a5c0b5ca9a35">distance_sommets</a>(som_1, som_2, zone);
<a name="l00532"></a>00532               distance/=sqrt(2.);
<a name="l00533"></a>00533               longueur_filtre(element) = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(longueur_filtre(element), distance);
<a name="l00534"></a>00534             }
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (methode ==  <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>(<span class="stringliteral">&quot;Scotti&quot;</span>))  <span class="comment">//!&lt; application de Scotti a un pseudo-cube</span>
<a name="l00537"></a>00537 <span class="comment"></span>    {
<a name="l00538"></a>00538       longueur_filtre=-1.;
<a name="l00539"></a>00539 
<a name="l00540"></a>00540       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; les_sommets = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00541"></a>00541       <span class="keywordtype">int</span> som0,som1,som2,som3;
<a name="l00542"></a>00542       <span class="keywordtype">int</span> som_0,som_1,som_2,som_3;
<a name="l00543"></a>00543 
<a name="l00544"></a>00544       <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)  <span class="comment">//!&lt; On revient a la racine carre du volume</span>
<a name="l00545"></a>00545 <span class="comment"></span>        {
<a name="l00546"></a>00546           <span class="keywordtype">int</span> nbr_elementb=zone.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
<a name="l00547"></a>00547           <span class="keywordtype">int</span> elementb;
<a name="l00548"></a>00548 <span class="comment">// int dim=Objet_U::dimension;</span>
<a name="l00549"></a>00549           <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volume = zone.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00550"></a>00550 
<a name="l00551"></a>00551           <span class="keywordflow">for</span> (elementb=0; elementb&lt;nbr_elementb; elementb ++)
<a name="l00552"></a>00552             {
<a name="l00553"></a>00553               longueur_filtre(elementb) = exp(log(volume[elementb])/<span class="keywordtype">double</span>(dim));
<a name="l00554"></a>00554             }
<a name="l00555"></a>00555         }
<a name="l00556"></a>00556       <span class="keywordflow">else</span>
<a name="l00557"></a>00557         {
<a name="l00558"></a>00558           <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> psc(4);
<a name="l00559"></a>00559           <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> dist(3);
<a name="l00560"></a>00560           <span class="keywordtype">double</span> dist_tot,dist_min,dist_max,dist_moy;
<a name="l00561"></a>00561           <span class="keywordtype">double</span> a1,a2,f_scotti;
<a name="l00562"></a>00562 
<a name="l00563"></a>00563           som_0=0;
<a name="l00564"></a>00564           som_1=0;
<a name="l00565"></a>00565           som_2=0;
<a name="l00566"></a>00566           som_3=0;
<a name="l00567"></a>00567 
<a name="l00568"></a>00568           <span class="keywordflow">for</span> (element=0; element&lt;nbr_element; element ++)
<a name="l00569"></a>00569             {
<a name="l00570"></a>00570               som0 = les_sommets(element, 0);
<a name="l00571"></a>00571               som1 = les_sommets(element, 1);
<a name="l00572"></a>00572               som2 = les_sommets(element, 2);
<a name="l00573"></a>00573               som3 = les_sommets(element, 3);
<a name="l00574"></a>00574 
<a name="l00575"></a>00575               psc(0) = <a class="code" href="distances__VEF_8cpp.html#a9e634de669c8bf2119f6481d897d3d73">som_pscal</a>(som0,som1,som2,som3,zone);
<a name="l00576"></a>00576               psc(1) = <a class="code" href="distances__VEF_8cpp.html#a9e634de669c8bf2119f6481d897d3d73">som_pscal</a>(som1,som0,som2,som3,zone);
<a name="l00577"></a>00577               psc(2) = <a class="code" href="distances__VEF_8cpp.html#a9e634de669c8bf2119f6481d897d3d73">som_pscal</a>(som2,som0,som1,som3,zone);
<a name="l00578"></a>00578               psc(3) = <a class="code" href="distances__VEF_8cpp.html#a9e634de669c8bf2119f6481d897d3d73">som_pscal</a>(som3,som0,som1,som2,zone);
<a name="l00579"></a>00579 
<a name="l00580"></a>00580               <span class="keyword">const</span> <span class="keywordtype">int</span> indice_min = <a class="code" href="ArrOfDouble_8cpp.html#afe9f20f22a4feecff7412bbcd71cafea" title="Retourne l&#39;indice du min ou -1 si le tableau est vide.">imin_array</a>(psc);
<a name="l00581"></a>00581               <span class="keywordflow">if</span>(indice_min==0)
<a name="l00582"></a>00582                 {
<a name="l00583"></a>00583                   som_0=som0;
<a name="l00584"></a>00584                   som_1=som1;
<a name="l00585"></a>00585                   som_2=som2;
<a name="l00586"></a>00586                   som_3=som3;
<a name="l00587"></a>00587                 }
<a name="l00588"></a>00588               <span class="keywordflow">if</span>(indice_min==1)
<a name="l00589"></a>00589                 {
<a name="l00590"></a>00590                   som_0=som1;
<a name="l00591"></a>00591                   som_1=som0;
<a name="l00592"></a>00592                   som_2=som2;
<a name="l00593"></a>00593                   som_3=som3;
<a name="l00594"></a>00594                 }
<a name="l00595"></a>00595               <span class="keywordflow">if</span>(indice_min==2)
<a name="l00596"></a>00596                 {
<a name="l00597"></a>00597                   som_0=som2;
<a name="l00598"></a>00598                   som_1=som0;
<a name="l00599"></a>00599                   som_2=som1;
<a name="l00600"></a>00600                   som_3=som3;
<a name="l00601"></a>00601                 }
<a name="l00602"></a>00602               <span class="keywordflow">if</span>(indice_min==3)
<a name="l00603"></a>00603                 {
<a name="l00604"></a>00604                   som_0=som3;
<a name="l00605"></a>00605                   som_1=som0;
<a name="l00606"></a>00606                   som_2=som1;
<a name="l00607"></a>00607                   som_3=som2;
<a name="l00608"></a>00608                 }
<a name="l00609"></a>00609 
<a name="l00610"></a>00610               dist(0)=<a class="code" href="distances__VEF_8cpp.html#ae0f3e368d20b3c75b4f6a5c0b5ca9a35">distance_sommets</a>(som_0,som_1,zone);
<a name="l00611"></a>00611               dist(1)=<a class="code" href="distances__VEF_8cpp.html#ae0f3e368d20b3c75b4f6a5c0b5ca9a35">distance_sommets</a>(som_0,som_2,zone);
<a name="l00612"></a>00612               dist(2)=<a class="code" href="distances__VEF_8cpp.html#ae0f3e368d20b3c75b4f6a5c0b5ca9a35">distance_sommets</a>(som_0,som_3,zone);
<a name="l00613"></a>00613 
<a name="l00614"></a>00614               dist_tot=dist(0)+dist(1)+dist(2);
<a name="l00615"></a>00615 
<a name="l00616"></a>00616               dist_min=<a class="code" href="ArrOfDouble_8cpp.html#abd3998749a1a8dab00dd6ac1798327fb" title="Retourne la valeur minimale.">min_array</a>(dist);
<a name="l00617"></a>00617               dist_max=<a class="code" href="ArrOfDouble_8cpp.html#a95241fccf4bed7fb7a4e2340b7735f14" title="Retourne la valeur maximale.">max_array</a>(dist);
<a name="l00618"></a>00618               dist_moy=dist_tot-dist_min-dist_max;
<a name="l00619"></a>00619 
<a name="l00620"></a>00620               a1=dist_min/dist_max;
<a name="l00621"></a>00621               a2=dist_moy/dist_max;
<a name="l00622"></a>00622 
<a name="l00623"></a>00623               f_scotti=cosh(sqrt((4./27.)*( log(a1)*log(a1) - log(a1)*log(a2) + log(a2)*log(a2) )));
<a name="l00624"></a>00624 
<a name="l00625"></a>00625               longueur_filtre(element) = f_scotti * exp(log(dist_min*dist_max*dist_moy)/3.);
<a name="l00626"></a>00626             }
<a name="l00627"></a>00627         }<span class="comment">//3D</span>
<a name="l00628"></a>00628     }
<a name="l00629"></a>00629   <span class="keywordflow">else</span>
<a name="l00630"></a>00630     {
<a name="l00631"></a>00631       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;calcul_longueur_filtre.cpp n&#39;a pas reconnu l&#39;argument : &quot;</span> &lt;&lt; methode &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00632"></a>00632       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;les arguments possibles sont : \&quot;volume\&quot;, \&quot;volume_sans_lissage\&quot;, \&quot;Scotti\&quot;, \&quot;arete\&quot;.&quot;</span> &lt;&lt; finl;
<a name="l00633"></a>00633       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00634"></a>00634 
<a name="l00635"></a>00635     }
<a name="l00636"></a>00636 
<a name="l00637"></a>00637 
<a name="l00638"></a>00638   <span class="keywordflow">if</span> ( ! (methode == <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>(<span class="stringliteral">&quot;volume_sans_lissage&quot;</span>)) )  <span class="comment">//!&lt; processus de &quot;regularisation&quot;</span>
<a name="l00639"></a>00639 <span class="comment"></span>    {
<a name="l00640"></a>00640       <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00641"></a>00641       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; les_sommets = zone_geom.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00642"></a>00642       <span class="keywordtype">int</span> nb_sommet = zone.<a class="code" href="classZone__dis__base.html#a8f793341b7a41d67561ba563ae0f69a0">nb_som_tot</a>();
<a name="l00643"></a>00643       <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> longueur_filtre_sommet(nb_sommet);
<a name="l00644"></a>00644       <span class="keywordtype">int</span> som1;
<a name="l00645"></a>00645       <span class="keywordtype">int</span> som_0,som_1;
<a name="l00646"></a>00646 
<a name="l00647"></a>00647       longueur_filtre_sommet=-1.;
<a name="l00648"></a>00648 
<a name="l00649"></a>00649       <span class="keywordflow">for</span> (element=0; element&lt;nbr_element; element ++)
<a name="l00650"></a>00650         <span class="keywordflow">for</span> (som1=0; som1&lt;dim+1; som1++)
<a name="l00651"></a>00651           {
<a name="l00652"></a>00652             som_0 = les_sommets(element, som1);
<a name="l00653"></a>00653             som_1 = dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som_0);
<a name="l00654"></a>00654             longueur_filtre_sommet(som_1) = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(longueur_filtre(element), longueur_filtre_sommet(som_1));
<a name="l00655"></a>00655           }
<a name="l00656"></a>00656 
<a name="l00657"></a>00657       longueur_filtre=-1.;
<a name="l00658"></a>00658 
<a name="l00659"></a>00659       <span class="keywordflow">for</span> (element=0; element&lt;nbr_element; element ++)
<a name="l00660"></a>00660         <span class="keywordflow">for</span> (som1=0; som1&lt;dim+1; som1++)
<a name="l00661"></a>00661           {
<a name="l00662"></a>00662             som_0 = les_sommets(element, som1);
<a name="l00663"></a>00663             som_1 = dom.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(som_0);
<a name="l00664"></a>00664             longueur_filtre(element) = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a> (longueur_filtre(element), longueur_filtre_sommet(som_1));
<a name="l00665"></a>00665           }
<a name="l00666"></a>00666     }
<a name="l00667"></a>00667 
<a name="l00668"></a>00668   assert(nbr_element == 0 || <a class="code" href="ArrOfDouble_8cpp.html#abd3998749a1a8dab00dd6ac1798327fb" title="Retourne la valeur minimale.">min_array</a>(longueur_filtre)&gt;0.);
<a name="l00669"></a>00669 
<a name="l00670"></a>00670   <span class="keywordflow">return</span> longueur_filtre;
<a name="l00671"></a>00671 }
<a name="l00672"></a>00672 
<a name="l00673"></a><a class="code" href="distances__VEF_8h.html#a6893f87eb4a2e3830ece608cf2681e90">00673</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#ae0f3e368d20b3c75b4f6a5c0b5ca9a35">distance_sommets</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> sommet1, <span class="keyword">const</span> <span class="keywordtype">int</span> sommet2, <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone)
<a name="l00674"></a>00674 {
<a name="l00675"></a>00675   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00676"></a>00676   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xs = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00677"></a>00677   <span class="keywordtype">double</span> x1 = xs(sommet1,0);
<a name="l00678"></a>00678   <span class="keywordtype">double</span> y1 = xs(sommet1,1);
<a name="l00679"></a>00679   <span class="keywordtype">double</span> x2 = xs(sommet2,0);
<a name="l00680"></a>00680   <span class="keywordtype">double</span> y2 = xs(sommet2,1);
<a name="l00681"></a>00681 
<a name="l00682"></a>00682   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a> == 3)
<a name="l00683"></a>00683     {
<a name="l00684"></a>00684       <span class="keywordtype">double</span> z1 = xs(sommet1,2);
<a name="l00685"></a>00685       <span class="keywordtype">double</span> z2 = xs(sommet2,2);
<a name="l00686"></a>00686       <span class="keywordflow">return</span> sqrt( <a class="code" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a" title="fonctions utiles sur les double">carre</a>(x2-x1) + <a class="code" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a" title="fonctions utiles sur les double">carre</a>(y2-y1) + <a class="code" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a" title="fonctions utiles sur les double">carre</a>(z2-z1) );
<a name="l00687"></a>00687     }
<a name="l00688"></a>00688   <span class="keywordflow">else</span> <span class="comment">//!&lt; en dimension 2</span>
<a name="l00689"></a>00689 <span class="comment"></span>    {
<a name="l00690"></a>00690       <span class="keywordflow">return</span> sqrt( <a class="code" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a" title="fonctions utiles sur les double">carre</a>(x2-x1) + <a class="code" href="Double_8h.html#aa4be1ab61f49e9ebb241ed3f4957fd4a" title="fonctions utiles sur les double">carre</a>(y2-y1) );
<a name="l00691"></a>00691     }
<a name="l00692"></a>00692 }
<a name="l00693"></a>00693 
<a name="l00694"></a><a class="code" href="distances__VEF_8h.html#a2d3a9e8c8267d66f01160889e0447be1">00694</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#a9e634de669c8bf2119f6481d897d3d73">som_pscal</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> som0, <span class="keyword">const</span> <span class="keywordtype">int</span> som1, <span class="keyword">const</span> <span class="keywordtype">int</span> som2, <span class="keyword">const</span> <span class="keywordtype">int</span> som3, <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone)
<a name="l00695"></a>00695 {
<a name="l00696"></a>00696   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom = zone.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00697"></a>00697   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xs = zone_geom.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00698"></a>00698 
<a name="l00699"></a>00699   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> v1(3),v2(3),v3(3);
<a name="l00700"></a>00700   <span class="keywordtype">double</span> n1,n2,n3;
<a name="l00701"></a>00701 
<a name="l00702"></a>00702   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0 ; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a> ; i++)
<a name="l00703"></a>00703     {
<a name="l00704"></a>00704       v1(i)=xs(som1,i)-xs(som0,i);
<a name="l00705"></a>00705       v2(i)=xs(som2,i)-xs(som0,i);
<a name="l00706"></a>00706       v3(i)=xs(som3,i)-xs(som0,i);
<a name="l00707"></a>00707     }
<a name="l00708"></a>00708 
<a name="l00709"></a>00709   n1=<a class="code" href="ArrOfDouble_8cpp.html#af3b2ac08cde80e3eadd7a83f5fd06ab7" title="Calcul de la norme du vecteur dx (fonction blas DNRM2, soit racine carree(somme des dx[i]*dx[i])...">norme_array</a>(v1);
<a name="l00710"></a>00710   n2=<a class="code" href="ArrOfDouble_8cpp.html#af3b2ac08cde80e3eadd7a83f5fd06ab7" title="Calcul de la norme du vecteur dx (fonction blas DNRM2, soit racine carree(somme des dx[i]*dx[i])...">norme_array</a>(v2);
<a name="l00711"></a>00711   n3=<a class="code" href="ArrOfDouble_8cpp.html#af3b2ac08cde80e3eadd7a83f5fd06ab7" title="Calcul de la norme du vecteur dx (fonction blas DNRM2, soit racine carree(somme des dx[i]*dx[i])...">norme_array</a>(v3);
<a name="l00712"></a>00712 
<a name="l00713"></a>00713   v1/=n1;
<a name="l00714"></a>00714   v2/=n2;
<a name="l00715"></a>00715   v3/=n3;
<a name="l00716"></a>00716 
<a name="l00717"></a>00717   <span class="keywordtype">double</span> som_psc=<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="ArrOfDouble_8cpp.html#af541bfdadae7483016c96f13760598ac" title="Produit scalaire de deux &quot;array&quot;. (dotproduct_array remplace operator* car le nom indique clairemen...">dotproduct_array</a>(v1,v2))+<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="ArrOfDouble_8cpp.html#af541bfdadae7483016c96f13760598ac" title="Produit scalaire de deux &quot;array&quot;. (dotproduct_array remplace operator* car le nom indique clairemen...">dotproduct_array</a>(v2,v3))+<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="ArrOfDouble_8cpp.html#af541bfdadae7483016c96f13760598ac" title="Produit scalaire de deux &quot;array&quot;. (dotproduct_array remplace operator* car le nom indique clairemen...">dotproduct_array</a>(v3,v1));
<a name="l00718"></a>00718   <span class="keywordflow">return</span> som_psc;
<a name="l00719"></a>00719 }
<a name="l00720"></a>00720 
<a name="l00721"></a><a class="code" href="distances__VEF_8h.html#aea12779e2ec13eb00ef90ff3ea09eaa2">00721</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#aea12779e2ec13eb00ef90ff3ea09eaa2">norm_vit_lp_k</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vit,<span class="keywordtype">int</span> face,<span class="keywordtype">int</span> face_b,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone,<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; val,<span class="keywordtype">int</span> is_defilante)
<a name="l00722"></a>00722 {
<a name="l00723"></a>00723   <span class="keywordtype">int</span> dimension=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00724"></a>00724 <span class="comment">// assert(face_b&lt;zone.premiere_face_int()); assert a ameliorer ou faces_virt...</span>
<a name="l00725"></a>00725   <span class="keywordflow">if</span> (is_defilante==0)
<a name="l00726"></a>00726     <span class="keywordflow">if</span> (dimension==3)
<a name="l00727"></a>00727       <span class="keywordflow">return</span> <a class="code" href="distances__VEF_8cpp.html#aa6a9b6fbe6b894a2550dadc9ed04d3af">norm_3D_vit1</a>(vit,face_b,face,zone,val[0],val[1],val[2]);
<a name="l00728"></a>00728     <span class="keywordflow">else</span>
<a name="l00729"></a>00729       <span class="keywordflow">return</span> <a class="code" href="distances__VEF_8cpp.html#a6d750800bff9a68e1d998f743dc812e5">norm_2D_vit1_k</a>(vit,face_b,face,zone,val[0],val[1]);
<a name="l00730"></a>00730 
<a name="l00731"></a>00731   <span class="keywordflow">else</span>
<a name="l00732"></a>00732     {
<a name="l00733"></a>00733       <span class="keywordflow">if</span> (dimension==3)
<a name="l00734"></a>00734         <span class="keywordflow">return</span> <a class="code" href="distances__VEF_8cpp.html#a17f9116c26c71938a0d388002f397ba5">norm_3D_vit2</a>(vit,face_b,face,zone,val[0],val[1],val[2]);
<a name="l00735"></a>00735       <span class="keywordflow">else</span>
<a name="l00736"></a>00736         <span class="keywordflow">return</span> <a class="code" href="distances__VEF_8cpp.html#aef7e882140b3bdc0458af97214e38a33">norm_2D_vit2_k</a>(vit,face_b,face,zone,val[0],val[1]);
<a name="l00737"></a>00737     }
<a name="l00738"></a>00738 }
<a name="l00739"></a>00739 
<a name="l00740"></a><a class="code" href="distances__VEF_8h.html#a325394b850e8b653067c32077f5eee0b">00740</a> <span class="keywordtype">double</span> <a class="code" href="distances__VEF_8cpp.html#a325394b850e8b653067c32077f5eee0b">distance_face_elem</a>(<span class="keywordtype">int</span> fac,<span class="keywordtype">int</span> elem,<span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone)
<a name="l00741"></a>00741 {
<a name="l00742"></a>00742   <span class="keywordtype">int</span> dimension=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00743"></a>00743   <span class="keywordflow">if</span> (dimension==3)
<a name="l00744"></a>00744     <span class="keywordflow">return</span> <a class="code" href="distances__VEF_8cpp.html#aec2af8d7d36c326744c660af71eab979">distance_3D</a>(fac,elem,zone);
<a name="l00745"></a>00745   <span class="keywordflow">else</span>
<a name="l00746"></a>00746     <span class="keywordflow">return</span> <a class="code" href="distances__VEF_8cpp.html#ab2783144acec34a0b426e3b6745696cd">distance_2D</a>(fac,elem,zone);
<a name="l00747"></a>00747 }
<a name="l00748"></a>00748 
<a name="l00749"></a>00749 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:44 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
