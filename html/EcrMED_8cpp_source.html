<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/MEDimpl/EcrMED.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/MEDimpl/EcrMED.cpp</div>  </div>
</div>
<div class="contents">
<a href="EcrMED_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        EcrMED.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/MEDimpl</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/38</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="EcrMED_8h.html">EcrMED.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="med_09_09_8h.html">med++.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VF_8h.html">Zone_VF.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Inc__base_8h.html">Champ_Inc_base.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Vect__IntTab_8h.html">Vect_IntTab.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="LireMED_8h.html">LireMED.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Polyedre_8h.html">Polyedre.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Polygone_8h.html">Polygone.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Char__ptr_8h.html">Char_ptr.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;medcoupling++.h&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#ifdef MEDCOUPLING_</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">#include &lt;MEDLoader.hxx&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;MEDFileMesh.hxx&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;MEDCouplingFieldDouble.hxx&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#pragma GCC diagnostic ignored &quot;-Wreorder&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="preprocessor">#include &lt;MEDFileField.hxx&gt;</span>
<a name="l00040"></a>00040 <span class="keyword">using</span> MEDCoupling::MCAuto;
<a name="l00041"></a>00041 <span class="keyword">using</span> MEDCoupling::MEDCouplingUMesh;
<a name="l00042"></a>00042 <span class="keyword">using</span> MEDCoupling::DataArrayDouble;
<a name="l00043"></a>00043 <span class="keyword">using</span> MEDCoupling::DataArrayInt;
<a name="l00044"></a>00044 <span class="keyword">using</span> MEDCoupling::MEDFileField1TS;
<a name="l00045"></a>00045 <span class="keyword">using</span> MEDCoupling::MEDFileUMesh;
<a name="l00046"></a>00046 <span class="keyword">using</span> MEDCoupling::MEDCouplingFieldDouble;
<a name="l00047"></a>00047 <span class="keyword">using</span> MEDCoupling::GetAllFieldNames;
<a name="l00048"></a>00048 <span class="keyword">using</span> MEDCoupling::GetAllFieldIterations;
<a name="l00049"></a>00049 <span class="keyword">using</span> MEDCoupling::MEDFileMesh;
<a name="l00050"></a>00050 <span class="preprocessor">#endif</span>
<a name="l00051"></a>00051 <span class="preprocessor"></span>
<a name="l00052"></a><a class="code" href="EcrMED_8cpp.html#a7f8c8c2f545a7f163dbb5d255ca15fa3">00052</a> <span class="preprocessor">#define POURSATURNE</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>
<a name="l00054"></a><a class="code" href="EcrMED_8cpp.html#aed3bb711d8a1e5046c6d4235bceacf86">00054</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classEcrMED.html">EcrMED</a>,<span class="stringliteral">&quot;Ecrire_MED&quot;</span>,<a class="code" href="classInterprete.html" title="Classe de base des objets &quot;interprete&quot;. Ces objets definissent des actions a realiser lorsqu&#39;on les...">Interprete</a>);
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="classEcrMED.html#a5cd4d0441acab8df5c42d0aa606a424c">00056</a> <a class="code" href="classEcrMED.html#a5cd4d0441acab8df5c42d0aa606a424c">EcrMED::EcrMED</a>() : major_mode(false)
<a name="l00057"></a>00057 {
<a name="l00058"></a>00058 <span class="preprocessor">#ifdef MEDCOUPLING_</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>  <a class="code" href="classEcrMED.html#ab0b2ba995b9f765e3196ff6727b30a3c">use_medcoupling_</a> = <span class="keyword">true</span>;
<a name="l00060"></a>00060 <span class="preprocessor">#else</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>  <a class="code" href="classEcrMED.html#ab0b2ba995b9f765e3196ff6727b30a3c">use_medcoupling_</a> = <span class="keyword">false</span>;
<a name="l00062"></a>00062 <span class="preprocessor">#endif</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span>}
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="comment">// Precondition:</span>
<a name="l00066"></a>00066 <span class="comment">// Parametre: Sortie&amp; os</span>
<a name="l00067"></a>00067 <span class="comment">// Signification: un flot de sortie</span>
<a name="l00068"></a>00068 <span class="comment">// Valeurs par defaut:</span>
<a name="l00069"></a>00069 <span class="comment">// Contraintes:</span>
<a name="l00070"></a>00070 <span class="comment">// Acces: entree/sortie</span>
<a name="l00071"></a>00071 <span class="comment">// Exception:</span>
<a name="l00072"></a>00072 <span class="comment">// Effets de bord:</span>
<a name="l00073"></a>00073 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00074"></a>00074 <span class="comment">//</span><span class="comment"></span>
<a name="l00075"></a>00075 <span class="comment">//! Simple appel a: Interprete::printOn(Sortie\&amp;)</span>
<a name="l00076"></a>00076 <span class="comment"></span><span class="comment">/** \return Sortie\&amp;&lt;br&gt;</span>
<a name="l00077"></a>00077 <span class="comment">Signification: le flot de sortie modifie&lt;br&gt;</span>
<a name="l00078"></a>00078 <span class="comment">Contraintes: */</span>
<a name="l00079"></a><a class="code" href="classEcrMED.html#a35b57ed41f21b4b7c7c4c806b3f23872">00079</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classEcrMED.html#a35b57ed41f21b4b7c7c4c806b3f23872" title="Simple appel a: Interprete::printOn(Sortie&amp;)">EcrMED::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00080"></a>00080 <span class="keyword"></span>{
<a name="l00081"></a>00081   <span class="keywordflow">return</span> <a class="code" href="classEcrMED.html#a35b57ed41f21b4b7c7c4c806b3f23872" title="Simple appel a: Interprete::printOn(Sortie&amp;)">Interprete::printOn</a>(os);
<a name="l00082"></a>00082 }
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="comment">// Precondition:</span>
<a name="l00086"></a>00086 <span class="comment">// Parametre: Entree&amp; is</span>
<a name="l00087"></a>00087 <span class="comment">// Signification: un flot d&#39;entree</span>
<a name="l00088"></a>00088 <span class="comment">// Valeurs par defaut:</span>
<a name="l00089"></a>00089 <span class="comment">// Contraintes:</span>
<a name="l00090"></a>00090 <span class="comment">// Acces: entree/sortie</span>
<a name="l00091"></a>00091 <span class="comment">// Exception:</span>
<a name="l00092"></a>00092 <span class="comment">// Effets de bord:</span>
<a name="l00093"></a>00093 <span class="comment">// Postcondition:</span>
<a name="l00094"></a>00094 <span class="comment">//</span><span class="comment"></span>
<a name="l00095"></a>00095 <span class="comment">//! Simple appel a: Interprete::readOn(Entree\&amp;)</span>
<a name="l00096"></a>00096 <span class="comment"></span><span class="comment">/** \return Entree\&amp;&lt;br&gt;</span>
<a name="l00097"></a>00097 <span class="comment">Signification: le flot d&#39;entree modifie&lt;br&gt;</span>
<a name="l00098"></a>00098 <span class="comment">Contraintes: */</span>
<a name="l00099"></a><a class="code" href="classEcrMED.html#ac1ddd74f2bbc94883a8e07214cea1209">00099</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classEcrMED.html#ac1ddd74f2bbc94883a8e07214cea1209" title="Simple appel a: Interprete::readOn(Entree&amp;)">EcrMED::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00100"></a>00100 {
<a name="l00101"></a>00101   <span class="keywordflow">return</span> <a class="code" href="classEcrMED.html#ac1ddd74f2bbc94883a8e07214cea1209" title="Simple appel a: Interprete::readOn(Entree&amp;)">Interprete::readOn</a>(is);
<a name="l00102"></a>00102 }
<a name="l00103"></a>00103 <span class="comment">// XD writemed interprete ecrire_med -1 Write a domain to MED format into a file.</span>
<a name="l00104"></a>00104 <span class="comment">// XD attr nom_dom ref_domaine nom_dom 0 Name of domain.</span>
<a name="l00105"></a>00105 <span class="comment">// XD attr file chaine file 0 Name of file.</span>
<a name="l00106"></a><a class="code" href="classEcrMED.html#a77b94a9726ff03f281fc16d3441619b0">00106</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classEcrMED.html#a77b94a9726ff03f281fc16d3441619b0">EcrMED::interpreter</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00107"></a>00107 {
<a name="l00108"></a>00108   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;syntax : EcrMED [ append ] nom_dom nom_fic &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00109"></a>00109   <span class="keywordtype">int</span> mode=-1;
<a name="l00110"></a>00110   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_dom, nom_fic;
<a name="l00111"></a>00111   is &gt;&gt; nom_dom ;
<a name="l00112"></a>00112   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> app(<span class="stringliteral">&quot;append&quot;</span>);
<a name="l00113"></a>00113   <span class="keywordflow">if</span> (app==nom_dom)
<a name="l00114"></a>00114     {
<a name="l00115"></a>00115       mode=0;
<a name="l00116"></a>00116       is &gt;&gt; nom_dom;
<a name="l00117"></a>00117       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; Adding &quot;</span>&lt;&lt;nom_dom&lt;&lt;finl;
<a name="l00118"></a>00118     }
<a name="l00119"></a>00119   is &gt;&gt; nom_fic;
<a name="l00120"></a>00120   <span class="keywordflow">if</span>(! <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>, <a class="code" href="classInterprete.html#a3ca248609f0b72eac68baca14621b4ee" title="Voir Interprete_bloc::objet_global() BM: la classe Interprete n&#39;est pas le meilleur endroit pour cett...">objet</a>(nom_dom)))
<a name="l00121"></a>00121     {
<a name="l00122"></a>00122       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; nom_dom &lt;&lt; <span class="stringliteral">&quot; type is &quot;</span> &lt;&lt; <a class="code" href="classInterprete.html#a3ca248609f0b72eac68baca14621b4ee" title="Voir Interprete_bloc::objet_global() BM: la classe Interprete n&#39;est pas le meilleur endroit pour cett...">objet</a>(nom_dom).<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; finl;
<a name="l00123"></a>00123       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Only Domaine type objects can be meshed&quot;</span> &lt;&lt; finl;
<a name="l00124"></a>00124       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00125"></a>00125     }
<a name="l00126"></a>00126   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>, <a class="code" href="classInterprete.html#a3ca248609f0b72eac68baca14621b4ee" title="Voir Interprete_bloc::objet_global() BM: la classe Interprete n&#39;est pas le meilleur endroit pour cett...">objet</a>(nom_dom));
<a name="l00127"></a>00127   <a class="code" href="classEcrMED.html#a262b6ac744c50c16f9770d9cec771940">ecrire_domaine</a>(nom_fic,dom,nom_dom,mode);
<a name="l00128"></a>00128   <span class="keywordflow">return</span> is;
<a name="l00129"></a>00129 }
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 <span class="preprocessor">#ifndef MED_</span>
<a name="l00132"></a><a class="code" href="classEcrMED.html#a5b6ac4eaa96b854f8e47d85395607616">00132</a> <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="classEcrMED.html#a5b6ac4eaa96b854f8e47d85395607616">EcrMED::ecrire_champ</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fic,<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_cha1,<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val,<span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; unite, <span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; noms_compo, <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>,<span class="keywordtype">double</span> time,<span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>)
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134   <a class="code" href="LireMED_8h.html#a4321f757cc3cf10b49c4045de68adaed">med_non_installe</a>();
<a name="l00135"></a>00135 }
<a name="l00136"></a><a class="code" href="classEcrMED.html#a262b6ac744c50c16f9770d9cec771940">00136</a> <span class="keywordtype">void</span> <a class="code" href="classEcrMED.html#a262b6ac744c50c16f9770d9cec771940">EcrMED::ecrire_domaine</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fic,<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_dom,<span class="keywordtype">int</span> mode)
<a name="l00137"></a>00137 {
<a name="l00138"></a>00138   <a class="code" href="LireMED_8h.html#a4321f757cc3cf10b49c4045de68adaed">med_non_installe</a>();
<a name="l00139"></a>00139 }
<a name="l00140"></a>00140 <span class="preprocessor">#else</span>
<a name="l00141"></a>00141 <span class="preprocessor"></span>
<a name="l00142"></a>00142 <a class="code" href="med__nul_8h.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> trustMEDfileOpen(<span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> filename, <span class="keyword">const</span> med_access_mode accessmode, <span class="keywordtype">bool</span> major_mode)
<a name="l00143"></a>00143 {
<a name="l00144"></a>00144   <span class="keywordflow">if</span> (major_mode)
<a name="l00145"></a>00145     <span class="keywordflow">return</span> MEDfileVersionOpen(filename, accessmode, MED_NUM_MAJEUR,0,0);
<a name="l00146"></a>00146   <span class="keywordflow">return</span> MEDfileOpen(filename, accessmode );
<a name="l00147"></a>00147 }
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>* convert_int_med_int(<span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; tab)
<a name="l00150"></a>00150 {
<a name="l00151"></a>00151   <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>* tabmed;
<a name="l00152"></a>00152   <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)==<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>))
<a name="l00153"></a>00153     tabmed=(<a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *)tab.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00154"></a>00154   <span class="keywordflow">else</span>
<a name="l00155"></a>00155     {
<a name="l00156"></a>00156 
<a name="l00157"></a>00157       <span class="keywordtype">int</span> taille=tab.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00158"></a>00158 <span class="comment">// Cerr&lt;&lt;sizeof(tab)&lt;&lt;&quot; &quot;&lt;&lt;sizeof(int)&lt;&lt;&quot; &quot;&lt;&lt;sizeof(tab)/sizeof(int)&lt;&lt;&quot; &quot;&lt;&lt;taille&lt;&lt;finl;</span>
<a name="l00159"></a>00159       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;creation of medint*&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00160"></a>00160       tabmed=<span class="keyword">new</span> <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>[taille];
<a name="l00161"></a>00161       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;taille; i++)
<a name="l00162"></a>00162         tabmed[i]=tab[i];
<a name="l00163"></a>00163 <span class="comment">// exit();</span>
<a name="l00164"></a>00164     }
<a name="l00165"></a>00165   <span class="keywordflow">return</span> tabmed;
<a name="l00166"></a>00166 }
<a name="l00167"></a>00167 <span class="preprocessor">#ifdef MEDCOUPLING_</span>
<a name="l00168"></a>00168 <span class="preprocessor"></span><span class="comment">// renvoie le type medcoupling a partir du type trio : http://docs.salome-platform.org/6/gui/MED/MEDLoader_8cxx.html</span>
<a name="l00169"></a>00169 INTERP_KERNEL::NormalizedCellType type_geo_trio_to_type_medcoupling(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type_elem_, <span class="keywordtype">int</span>&amp; mesh_dimension)
<a name="l00170"></a>00170 {
<a name="l00171"></a>00171   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>;
<a name="l00172"></a>00172   type_elem=type_elem_;
<a name="l00173"></a>00173   type_elem.<a class="code" href="classNom.html#aa296fc70f7abcf978968e09582d8fb06">prefix</a>(<span class="stringliteral">&quot;_AXI&quot;</span>);
<a name="l00174"></a>00174   <span class="keywordflow">if</span> (type_elem!=<a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>(type_elem_))
<a name="l00175"></a>00175     {
<a name="l00176"></a>00176       <span class="keywordflow">if</span> (type_elem == <span class="stringliteral">&quot;QUADRILATERE_2D&quot;</span>)
<a name="l00177"></a>00177         type_elem = <span class="stringliteral">&quot;SEGMENT_2D&quot;</span>;
<a name="l00178"></a>00178       <span class="keywordflow">if</span> (type_elem == <span class="stringliteral">&quot;RECTANGLE_2D&quot;</span>)
<a name="l00179"></a>00179         {
<a name="l00180"></a>00180           type_elem = <span class="stringliteral">&quot;RECTANGLE&quot;</span>;
<a name="l00181"></a>00181         }
<a name="l00182"></a>00182     }
<a name="l00183"></a>00183   mesh_dimension = -1;
<a name="l00184"></a>00184   INTERP_KERNEL::NormalizedCellType type_cell;
<a name="l00185"></a>00185   <span class="keywordflow">if</span> ((type_elem==<span class="stringliteral">&quot;RECTANGLE&quot;</span>) || (type_elem==<span class="stringliteral">&quot;QUADRANGLE&quot;</span>) || (type_elem==<span class="stringliteral">&quot;QUADRANGLE_3D&quot;</span>))
<a name="l00186"></a>00186     {
<a name="l00187"></a>00187       type_cell = INTERP_KERNEL::NORM_QUAD4;
<a name="l00188"></a>00188       mesh_dimension = 2;
<a name="l00189"></a>00189     }
<a name="l00190"></a>00190   <span class="keywordflow">else</span> <span class="keywordflow">if</span>  ((type_elem==<span class="stringliteral">&quot;HEXAEDRE&quot;</span>) || (type_elem==<span class="stringliteral">&quot;HEXAEDRE_VEF&quot;</span>))
<a name="l00191"></a>00191     {
<a name="l00192"></a>00192       type_cell = INTERP_KERNEL::NORM_HEXA8;
<a name="l00193"></a>00193       mesh_dimension = 3;
<a name="l00194"></a>00194     }
<a name="l00195"></a>00195   <span class="keywordflow">else</span> <span class="keywordflow">if</span>  ((type_elem==<span class="stringliteral">&quot;TRIANGLE&quot;</span>) || (type_elem==<span class="stringliteral">&quot;TRIANGLE_3D&quot;</span>))
<a name="l00196"></a>00196     {
<a name="l00197"></a>00197       type_cell = INTERP_KERNEL::NORM_TRI3;
<a name="l00198"></a>00198       mesh_dimension = 2;
<a name="l00199"></a>00199     }
<a name="l00200"></a>00200   <span class="keywordflow">else</span> <span class="keywordflow">if</span>  (type_elem==<span class="stringliteral">&quot;TETRAEDRE&quot;</span>)
<a name="l00201"></a>00201     {
<a name="l00202"></a>00202       type_cell = INTERP_KERNEL::NORM_TETRA4;
<a name="l00203"></a>00203       mesh_dimension = 3;
<a name="l00204"></a>00204     }
<a name="l00205"></a>00205   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((type_elem==<span class="stringliteral">&quot;SEGMENT&quot;</span>) || (type_elem==<span class="stringliteral">&quot;SEGMENT_2D&quot;</span>))
<a name="l00206"></a>00206     {
<a name="l00207"></a>00207       type_cell = INTERP_KERNEL::NORM_SEG2;
<a name="l00208"></a>00208       mesh_dimension = 1;
<a name="l00209"></a>00209     }
<a name="l00210"></a>00210   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type_elem==<span class="stringliteral">&quot;PRISME&quot;</span>)
<a name="l00211"></a>00211     {
<a name="l00212"></a>00212       type_cell = INTERP_KERNEL::NORM_PENTA6;
<a name="l00213"></a>00213       mesh_dimension = 3;
<a name="l00214"></a>00214     }
<a name="l00215"></a>00215   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type_elem==<span class="stringliteral">&quot;POLYEDRE&quot;</span>)
<a name="l00216"></a>00216     {
<a name="l00217"></a>00217       type_cell = INTERP_KERNEL::NORM_POLYHED;
<a name="l00218"></a>00218       mesh_dimension = 3;
<a name="l00219"></a>00219     }
<a name="l00220"></a>00220   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((type_elem==<span class="stringliteral">&quot;POLYGONE&quot;</span>) || (type_elem==<span class="stringliteral">&quot;POLYGONE_3D&quot;</span>))
<a name="l00221"></a>00221     {
<a name="l00222"></a>00222       type_cell = INTERP_KERNEL::NORM_POLYGON;
<a name="l00223"></a>00223       mesh_dimension = 2;
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(type_elem==<span class="stringliteral">&quot;PRISME_HEXAG&quot;</span>)
<a name="l00226"></a>00226     {
<a name="l00227"></a>00227       type_cell = INTERP_KERNEL::NORM_HEXGP12;
<a name="l00228"></a>00228       mesh_dimension = 3;
<a name="l00229"></a>00229     }
<a name="l00230"></a>00230   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((type_elem==<span class="stringliteral">&quot;POINT&quot;</span>) || (type_elem==<span class="stringliteral">&quot;POINT_1D&quot;</span>))
<a name="l00231"></a>00231     {
<a name="l00232"></a>00232       type_cell = INTERP_KERNEL::NORM_POINT1;
<a name="l00233"></a>00233       mesh_dimension = 0;
<a name="l00234"></a>00234     }
<a name="l00235"></a>00235   <span class="keywordflow">else</span>
<a name="l00236"></a>00236     {
<a name="l00237"></a>00237       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;type_elem&lt;&lt; <span class="stringliteral">&quot; no available cell.&quot;</span> &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00238"></a>00238       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00239"></a>00239       <span class="keywordflow">return</span> INTERP_KERNEL::NORM_POINT1;
<a name="l00240"></a>00240     }
<a name="l00241"></a>00241   assert(mesh_dimension&gt;=0);
<a name="l00242"></a>00242   <span class="keywordflow">return</span> type_cell;
<a name="l00243"></a>00243 }
<a name="l00244"></a>00244 <span class="preprocessor">#endif</span>
<a name="l00245"></a>00245 <span class="preprocessor"></span>
<a name="l00246"></a>00246 <span class="comment">// renvoit le type med a partir du type trio</span>
<a name="l00247"></a>00247 med_geometry_type type_geo_trio_to_type_med(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type_elem_,med_axis_type&amp; rep)
<a name="l00248"></a>00248 {
<a name="l00249"></a>00249   rep=MED_CARTESIAN;
<a name="l00250"></a>00250   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>;
<a name="l00251"></a>00251   type_elem=type_elem_;
<a name="l00252"></a>00252   type_elem.<a class="code" href="classNom.html#aa296fc70f7abcf978968e09582d8fb06">prefix</a>(<span class="stringliteral">&quot;_AXI&quot;</span>);
<a name="l00253"></a>00253   <span class="keywordflow">if</span> (type_elem!=<a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>(type_elem_))
<a name="l00254"></a>00254     {
<a name="l00255"></a>00255       rep=MED_SPHERICAL;
<a name="l00256"></a>00256       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;#&quot;</span>&lt;&lt;type_elem&lt;&lt;<span class="stringliteral">&quot;#&quot;</span>&lt;&lt;<a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>(type_elem_)&lt;&lt;<span class="stringliteral">&quot;#&quot;</span>&lt;&lt;(type_elem!=<a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>(type_elem_))&lt;&lt;finl;
<a name="l00257"></a>00257       <span class="keywordflow">if</span> (type_elem==<span class="stringliteral">&quot;QUADRILATERE_2D&quot;</span>)
<a name="l00258"></a>00258         type_elem=<span class="stringliteral">&quot;SEGMENT_2D&quot;</span>;
<a name="l00259"></a>00259       <span class="keywordflow">if</span> (type_elem==<span class="stringliteral">&quot;RECTANGLE_2D&quot;</span>)
<a name="l00260"></a>00260         {
<a name="l00261"></a>00261           type_elem=<span class="stringliteral">&quot;RECTANGLE&quot;</span>;
<a name="l00262"></a>00262           rep=MED_CYLINDRICAL;
<a name="l00263"></a>00263         }
<a name="l00264"></a>00264     }
<a name="l00265"></a>00265   med_geometry_type type_elem_med;
<a name="l00266"></a>00266   <span class="keywordflow">if</span> ((type_elem==<span class="stringliteral">&quot;RECTANGLE&quot;</span>) || (type_elem==<span class="stringliteral">&quot;QUADRANGLE&quot;</span>))
<a name="l00267"></a>00267     type_elem_med=<a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9af3665c92b5329563931c10730fcfa654">MED_QUAD4</a>;
<a name="l00268"></a>00268   <span class="keywordflow">else</span> <span class="keywordflow">if</span>  ((type_elem==<span class="stringliteral">&quot;HEXAEDRE&quot;</span>)|| (type_elem==<span class="stringliteral">&quot;HEXAEDRE_VEF&quot;</span>))
<a name="l00269"></a>00269     type_elem_med=<a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9af413ef36dde25d6d4f0d526f1f7aeedf">MED_HEXA8</a>;
<a name="l00270"></a>00270   <span class="keywordflow">else</span> <span class="keywordflow">if</span>  (type_elem==<span class="stringliteral">&quot;TRIANGLE&quot;</span>)
<a name="l00271"></a>00271     type_elem_med=<a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9afe2d4f36086bb36c549eafad57271d07">MED_TRIA3</a>;
<a name="l00272"></a>00272   <span class="keywordflow">else</span> <span class="keywordflow">if</span>  (type_elem==<span class="stringliteral">&quot;TETRAEDRE&quot;</span>)
<a name="l00273"></a>00273     type_elem_med=<a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9a46d58f840282228234fdd85137278a8b">MED_TETRA4</a>;
<a name="l00274"></a>00274   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((type_elem==<span class="stringliteral">&quot;SEGMENT_2D&quot;</span>) || (type_elem==<span class="stringliteral">&quot;SEGMENT&quot;</span>))
<a name="l00275"></a>00275     type_elem_med=<a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9aaaa2ffd110978e6d24ecd0fe03219006">MED_SEG2</a>;
<a name="l00276"></a>00276   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type_elem==<span class="stringliteral">&quot;TRIANGLE_3D&quot;</span>)
<a name="l00277"></a>00277     type_elem_med=<a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9afe2d4f36086bb36c549eafad57271d07">MED_TRIA3</a>;
<a name="l00278"></a>00278   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type_elem==<span class="stringliteral">&quot;QUADRANGLE_3D&quot;</span>)
<a name="l00279"></a>00279     type_elem_med=<a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9af3665c92b5329563931c10730fcfa654">MED_QUAD4</a>;
<a name="l00280"></a>00280   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type_elem==<span class="stringliteral">&quot;PRISME&quot;</span>)
<a name="l00281"></a>00281     type_elem_med=<a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9a25664b83378018af9b5e018ec090d15d">MED_PENTA6</a>;
<a name="l00282"></a>00282   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type_elem==<span class="stringliteral">&quot;POLYEDRE&quot;</span>)
<a name="l00283"></a>00283     type_elem_med=MED_POLYHEDRON;
<a name="l00284"></a>00284   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type_elem==<span class="stringliteral">&quot;POLYGONE&quot;</span>)
<a name="l00285"></a>00285     type_elem_med=MED_POLYGON;
<a name="l00286"></a>00286   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type_elem==<span class="stringliteral">&quot;POLYGONE_3D&quot;</span>)
<a name="l00287"></a>00287     type_elem_med=MED_POLYGON;
<a name="l00288"></a>00288   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(type_elem==<span class="stringliteral">&quot;SEGMENT&quot;</span>)
<a name="l00289"></a>00289     type_elem_med=<a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9aaaa2ffd110978e6d24ecd0fe03219006">MED_SEG2</a>;
<a name="l00290"></a>00290   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(type_elem==<span class="stringliteral">&quot;PRISME_HEXAG&quot;</span>)
<a name="l00291"></a>00291     type_elem_med=MED_OCTA12;
<a name="l00292"></a>00292   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(type_elem==<span class="stringliteral">&quot;POINT_1D&quot;</span>)
<a name="l00293"></a>00293     type_elem_med=<a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9a4432abce1ca88e2d4258dc04b249ca9c">MED_POINT1</a>;
<a name="l00294"></a>00294   <span class="keywordflow">else</span>
<a name="l00295"></a>00295     {
<a name="l00296"></a>00296       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;type_elem&lt;&lt; <span class="stringliteral">&quot; no available code&quot;</span> &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00297"></a>00297       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00298"></a>00298       type_elem_med=<a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9af3665c92b5329563931c10730fcfa654">MED_QUAD4</a>;
<a name="l00299"></a>00299     }
<a name="l00300"></a>00300   <span class="keywordflow">return</span> type_elem_med;
<a name="l00301"></a>00301 }
<a name="l00302"></a>00302 med_geometry_type type_geo_trio_to_type_med(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type_elem)
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304   med_axis_type rep;
<a name="l00305"></a>00305   <span class="keywordflow">return</span> type_geo_trio_to_type_med(type_elem,rep);
<a name="l00306"></a>00306 }
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 <span class="comment">// ecriture des faces</span>
<a name="l00309"></a>00309 <span class="keywordtype">int</span> medecrirefaces(<a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; all_faces_bord,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type_face,<a class="code" href="med__nul_8h.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_dom,<span class="keywordtype">int</span> dimension,<span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; familles,med_access_mode mode=MED_ACC_RDEXT)
<a name="l00310"></a>00310 {
<a name="l00311"></a>00311   <span class="keywordtype">int</span> ret=0;
<a name="l00312"></a>00312   <span class="keywordtype">int</span> nface=familles.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00313"></a>00313   <span class="keywordflow">if</span> (nface)
<a name="l00314"></a>00314     {
<a name="l00315"></a>00315       med_geometry_type type_elem_med;
<a name="l00316"></a>00316 
<a name="l00317"></a>00317       type_elem_med=type_geo_trio_to_type_med(type_face);
<a name="l00318"></a>00318       med_entity_type type_ent;
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 <span class="preprocessor">#ifdef POURSATURNE</span>
<a name="l00321"></a>00321 <span class="preprocessor"></span>      type_ent=MED_CELL;
<a name="l00322"></a>00322 <span class="preprocessor">#else</span>
<a name="l00323"></a>00323 <span class="preprocessor"></span>      type_ent=<a class="code" href="med__nul_8h.html#ab8d5af112dbaeca64aa1d1965030ff08ab0641799ff99918e8e95edca23114f83">MED_FACE</a>;
<a name="l00324"></a>00324       <span class="keywordflow">if</span> (dimension==2) type_ent=<a class="code" href="med__nul_8h.html#ab8d5af112dbaeca64aa1d1965030ff08ace31cb42b6f0ecacdafc847f04f89cce">MED_ARETE</a>;
<a name="l00325"></a>00325 <span class="preprocessor">#endif</span>
<a name="l00326"></a>00326 <span class="preprocessor"></span><span class="comment">// on passe par des tableaux med quand int != med_int</span>
<a name="l00327"></a>00327       <span class="keywordflow">if</span> (type_elem_med!=MED_POLYGON)
<a name="l00328"></a>00328         {
<a name="l00329"></a>00329           <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *med_all_faces_bord=convert_int_med_int(all_faces_bord);
<a name="l00330"></a>00330           <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *med_familles=convert_int_med_int(familles);
<a name="l00331"></a>00331           <span class="keywordtype">double</span> dtb=0;
<a name="l00332"></a>00332           ret=MEDmeshElementWr(fid,nom_dom,MED_NO_DT,MED_NO_IT,dtb,type_ent,type_elem_med,MED_NODAL,<a class="code" href="med__nul_8h.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,nface,med_all_faces_bord,MED_FALSE,NULL,MED_FALSE,NULL,MED_TRUE,med_familles);
<a name="l00333"></a>00333           <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)!=<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>))
<a name="l00334"></a>00334             {
<a name="l00335"></a>00335               <span class="keyword">delete</span> []  med_all_faces_bord;
<a name="l00336"></a>00336               <span class="keyword">delete</span> [] med_familles;
<a name="l00337"></a>00337             }
<a name="l00338"></a>00338 
<a name="l00339"></a>00339 <span class="comment">// ATTENTION MED_ACC_CREAT au lieu de MED_ACC_RDEXT</span>
<a name="l00340"></a>00340           <span class="keywordflow">if</span> (ret&lt;0)
<a name="l00341"></a>00341             {
<a name="l00342"></a>00342               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Problem when writing faces in &quot;</span>&lt;&lt;nom_dom&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00343"></a>00343               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00344"></a>00344             }
<a name="l00345"></a>00345         }
<a name="l00346"></a>00346       <span class="keywordflow">else</span>
<a name="l00347"></a>00347         {
<a name="l00348"></a>00348           <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> index(nface+1);
<a name="l00349"></a>00349           index(0)=1;
<a name="l00350"></a>00350           <span class="keywordtype">int</span> nb_som_max=all_faces_bord.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00351"></a>00351           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f=0; f&lt;nface; f++)
<a name="l00352"></a>00352             {
<a name="l00353"></a>00353               <span class="keywordtype">int</span> nb_som=nb_som_max-1;
<a name="l00354"></a>00354               <span class="keywordflow">while</span> (all_faces_bord(f,nb_som)==0) nb_som--;
<a name="l00355"></a>00355               index(f+1)=index(f)+nb_som+1;
<a name="l00356"></a>00356             }
<a name="l00357"></a>00357 
<a name="l00358"></a>00358           <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> conn(index(nface)-1);
<a name="l00359"></a>00359           <span class="keywordtype">int</span> c=0;
<a name="l00360"></a>00360           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f=0; f&lt;nface; f++)
<a name="l00361"></a>00361             {
<a name="l00362"></a>00362               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=0; s&lt;nb_som_max; s++)
<a name="l00363"></a>00363                 {
<a name="l00364"></a>00364                   <span class="keywordtype">int</span> s2=all_faces_bord(f,s);
<a name="l00365"></a>00365                   <span class="keywordflow">if</span> (s2==0) <span class="keywordflow">break</span>;
<a name="l00366"></a>00366                   conn(c++)=s2;
<a name="l00367"></a>00367                 }
<a name="l00368"></a>00368             }
<a name="l00369"></a>00369           assert(c==(index(nface)-1));
<a name="l00370"></a>00370           <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *med_index=convert_int_med_int(index);
<a name="l00371"></a>00371           <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *med_conn=convert_int_med_int(conn);
<a name="l00372"></a>00372           <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *med_familles=convert_int_med_int(familles);
<a name="l00373"></a>00373           <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> med_size_index=index.size_array();
<a name="l00374"></a>00374 <span class="comment">// ret=MEDelementsEcr(fid,nom_dom,dimension,med_all_faces_bord,MED_FULL_INTERLACE,NULL,MED_FAUX,NULL,MED_FAUX,med_familles,nface,type_ent,type_elem_med,MED_NODAL,mode);</span>
<a name="l00375"></a>00375 <span class="comment">// Cerr&lt;&lt;&quot; ecriture &quot;&lt;&lt;index&lt;&lt;&quot; conn &quot;&lt;&lt;conn&lt;&lt;&quot; &quot;&lt;&lt;all_faces_bord&lt;&lt;finl;</span>
<a name="l00376"></a>00376           ret=MEDmeshPolygonWr(fid,nom_dom,MED_NO_DT,MED_NO_IT,0.,MED_CELL,MED_NODAL,med_size_index,med_index,med_conn);
<a name="l00377"></a>00377 <span class="comment">// ATTENTION MED_ACC_CREAT au lieu de MED_ACC_RDEXT</span>
<a name="l00378"></a>00378           <span class="keywordflow">if</span> (ret&lt;0)
<a name="l00379"></a>00379             {
<a name="l00380"></a>00380               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Problem when writing faces in &quot;</span>&lt;&lt;nom_dom&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00381"></a>00381               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00382"></a>00382 <span class="comment">// on ecrit les familles avant d&#39;oublier....</span>
<a name="l00383"></a>00383             }
<a name="l00384"></a>00384           <span class="keywordflow">if</span> ((ret = MEDmeshEntityFamilyNumberWr(fid,nom_dom,MED_NO_DT,MED_NO_IT,type_ent,type_elem_med,nface,med_familles)) &lt; 0)
<a name="l00385"></a>00385             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00386"></a>00386           <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)!=<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>))
<a name="l00387"></a>00387             {
<a name="l00388"></a>00388               <span class="keyword">delete</span> [] med_index;
<a name="l00389"></a>00389               <span class="keyword">delete</span> [] med_conn;
<a name="l00390"></a>00390               <span class="keyword">delete</span> [] med_familles;
<a name="l00391"></a>00391             }
<a name="l00392"></a>00392         }
<a name="l00393"></a>00393     }
<a name="l00394"></a>00394   <span class="keywordflow">return</span> ret;
<a name="l00395"></a>00395 }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="keywordtype">void</span> affecte_nom_med(<a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a>&amp; nom_med,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; mot);
<a name="l00398"></a>00398 <span class="comment">// ecrit la geom appele par EcrMED::ecrire_domaine</span>
<a name="l00399"></a>00399 <span class="keywordtype">int</span> medecrgeom(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fic,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_dom,<span class="keywordtype">int</span> dimension,<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; sommets,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type_elem,<span class="keyword">const</span> <a class="code" href="classElem__geom.html">Elem_geom</a>&amp; ele,<span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; les_elems,<span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; type_face,<a class="code" href="Vect_8h.html#adc7c7b04809c9aec2cb897cd2ef06378">VECT</a>(<a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>)&amp; all_faces_bord,<span class="keyword">const</span> <a class="code" href="Vect_8h.html#adc7c7b04809c9aec2cb897cd2ef06378">VECT</a>(<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>)&amp; familles,<a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; noms_bords,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_zone,<span class="keywordtype">int</span> mode, <span class="keywordtype">bool</span> major_mode)
<a name="l00400"></a>00400 {
<a name="l00401"></a>00401 <span class="comment">// creation d&#39;un mot de longueur MED_NAME_SIZE</span>
<a name="l00402"></a>00402   <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> med_taille_nom;
<a name="l00403"></a>00403   <a class="code" href="LireMED_8cpp.html#a5fb8877635c9569522f3e6fac236559c">dimensionne_char_ptr_taille</a>(med_taille_nom,MED_NAME_SIZE);
<a name="l00404"></a>00404 <span class="comment">// Cerr&lt;&lt;&quot;HERE medecrgeom &quot;&lt;&lt;nom_fic&lt;&lt;&quot; &quot;&lt;&lt;nom_dom&lt;&lt;&quot; &quot;&lt;&lt;mode&lt;&lt;finl;</span>
<a name="l00405"></a>00405   <span class="keywordtype">int</span> ret=0;
<a name="l00406"></a>00406   <a class="code" href="med__nul_8h.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid ;
<a name="l00407"></a>00407 <span class="comment">// alors ca ou l&#39;autre ????</span>
<a name="l00408"></a>00408 <span class="comment">// mode =0 on ajoute. mode=-1 on reecrit</span>
<a name="l00409"></a>00409   <span class="keywordflow">if</span> (mode==0)
<a name="l00410"></a>00410     {
<a name="l00411"></a>00411       fid= trustMEDfileOpen(nom_fic,MED_ACC_RDEXT, major_mode);
<a name="l00412"></a>00412       <span class="keywordflow">if</span> (fid&lt;0)
<a name="l00413"></a>00413         fid= trustMEDfileOpen(nom_fic,MED_ACC_CREAT, major_mode);
<a name="l00414"></a>00414     }
<a name="l00415"></a>00415   <span class="keywordflow">else</span>
<a name="l00416"></a>00416     fid= trustMEDfileOpen(nom_fic,MED_ACC_CREAT, major_mode);
<a name="l00417"></a>00417 
<a name="l00418"></a>00418   <span class="keywordflow">if</span> (fid &lt; 0)
<a name="l00419"></a>00419     {
<a name="l00420"></a>00420       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Problem when opening &quot;</span>&lt;&lt;nom_fic&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00421"></a>00421       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00422"></a>00422     }
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 
<a name="l00425"></a>00425   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nomcoo=<span class="stringliteral">&quot;x               y               &quot;</span>;
<a name="l00426"></a>00426   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> unicco=<span class="stringliteral">&quot;m               m               &quot;</span>;
<a name="l00427"></a>00427   <span class="keywordflow">if</span> (dimension&gt;2)
<a name="l00428"></a>00428     {
<a name="l00429"></a>00429       nomcoo+=<span class="stringliteral">&quot;z               &quot;</span>;
<a name="l00430"></a>00430       unicco+=<span class="stringliteral">&quot;m               &quot;</span>;
<a name="l00431"></a>00431     }
<a name="l00432"></a>00432   med_geometry_type type_elem_med;
<a name="l00433"></a>00433   med_axis_type rep;
<a name="l00434"></a>00434   type_elem_med=type_geo_trio_to_type_med(type_elem,rep);
<a name="l00435"></a>00435   <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> desc;
<a name="l00436"></a>00436   desc.<a class="code" href="classChar__ptr.html#a99698885f5a6fa6d4b6281649c905b3f">allocate</a>(MED_COMMENT_SIZE);
<a name="l00437"></a>00437   strcpy(desc,<span class="stringliteral">&quot;no description&quot;</span>);
<a name="l00438"></a>00438   <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> dtunit;
<a name="l00439"></a>00439   dtunit.<a class="code" href="classChar__ptr.html#a99698885f5a6fa6d4b6281649c905b3f">allocate</a>(MED_SNAME_SIZE);
<a name="l00440"></a>00440   strcpy(dtunit,<span class="stringliteral">&quot;s&quot;</span>);
<a name="l00441"></a>00441   ret=MEDmeshCr(fid,nom_dom,dimension,dimension,MED_UNSTRUCTURED_MESH,desc,dtunit,MED_SORT_DTIT,rep,nomcoo,unicco );
<a name="l00442"></a>00442   <span class="keywordtype">double</span>* sommets2=(<span class="keywordtype">double</span> *)sommets.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00443"></a>00443 
<a name="l00444"></a>00444   <span class="keywordtype">int</span> nsommet=sommets.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00445"></a>00445   <span class="keywordflow">if</span> (nsommet==0) <span class="keywordflow">return</span> 1;
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 <span class="comment">// Ecriture des sommets</span>
<a name="l00448"></a>00448 
<a name="l00449"></a>00449   {
<a name="l00450"></a>00450 <span class="comment">// ArrOfInt nufano(nsommet);</span>
<a name="l00451"></a>00451     <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>* nufano;
<a name="l00452"></a>00452     nufano=<span class="keyword">new</span> <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>[nsommet];
<a name="l00453"></a>00453     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nsommet; i++)
<a name="l00454"></a>00454       nufano[i]=0;
<a name="l00455"></a>00455     <span class="keywordtype">double</span> dtb=0;
<a name="l00456"></a>00456     ret=MEDmeshNodeWr(fid,nom_dom,MED_NO_DT,MED_NO_IT,dtb,<a class="code" href="med__nul_8h.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,nsommet,sommets2,MED_FALSE,NULL,MED_FALSE,NULL,MED_TRUE,nufano);
<a name="l00457"></a>00457     <span class="keywordflow">if</span> (ret&lt;0)
<a name="l00458"></a>00458       {
<a name="l00459"></a>00459         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Problem when writing vertex in &quot;</span>&lt;&lt;nom_fic&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00460"></a>00460         <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00461"></a>00461       }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463     <span class="keyword">delete</span> []  nufano;
<a name="l00464"></a>00464   }
<a name="l00465"></a>00465   <span class="keywordtype">int</span> famglob=-1000; <span class="comment">//!&lt; ou -1000 ? ecriture des elements internes...</span>
<a name="l00466"></a>00466 <span class="comment"></span><span class="comment">//</span>
<a name="l00467"></a>00467   {
<a name="l00468"></a>00468     <span class="keywordtype">int</span> nelem=les_elems.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00469"></a>00469 <span class="comment">// ArrOfInt nufano(nelem);</span>
<a name="l00470"></a>00470     <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>* nufano;
<a name="l00471"></a>00471     nufano=<span class="keyword">new</span> <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>[nelem];
<a name="l00472"></a>00472     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nelem; i++)
<a name="l00473"></a>00473       nufano[i]=famglob;
<a name="l00474"></a>00474 
<a name="l00475"></a>00475 <span class="comment">// on passe par des tableaux med quand int != med_int</span>
<a name="l00476"></a>00476 
<a name="l00477"></a>00477     <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>* med_les_elems=convert_int_med_int(les_elems);
<a name="l00478"></a>00478 
<a name="l00479"></a>00479     <span class="keywordtype">int</span> is_poly=0;
<a name="l00480"></a>00480     <span class="keywordflow">if</span> ((type_elem_med==MED_POLYHEDRON)||(type_elem_med==MED_POLYGON))
<a name="l00481"></a>00481       is_poly=1;
<a name="l00482"></a>00482     <span class="keywordflow">if</span> (is_poly==0)
<a name="l00483"></a>00483       {
<a name="l00484"></a>00484         <span class="keywordtype">double</span> dtb=0;
<a name="l00485"></a>00485         ret=MEDmeshElementWr(fid,nom_dom,MED_NO_DT,MED_NO_IT,dtb,MED_CELL,type_elem_med,MED_NODAL,<a class="code" href="med__nul_8h.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,nelem,med_les_elems,MED_FALSE,NULL,MED_FALSE,NULL,MED_TRUE,nufano);
<a name="l00486"></a>00486       }
<a name="l00487"></a>00487     <span class="keywordflow">else</span>
<a name="l00488"></a>00488       {
<a name="l00489"></a>00489         <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> Nodes_glob;
<a name="l00490"></a>00490         <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> FacesIndex;
<a name="l00491"></a>00491         <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> PolyhedronIndex;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493         <span class="keywordflow">if</span> (type_elem_med==MED_POLYHEDRON)
<a name="l00494"></a>00494           {
<a name="l00495"></a>00495             <span class="keyword">const</span> <a class="code" href="classPolyedre.html" title="Classe Polyedre Cette represente l&#39;element geometrique Polyedre. Un polyedre est un element defini pa...">Polyedre</a>&amp; Poly=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPolyedre.html" title="Classe Polyedre Cette represente l&#39;element geometrique Polyedre. Un polyedre est un element defini pa...">Polyedre</a>,ele.<a class="code" href="classDeriv__Elem__geom__base.html#a384b487459a33f9f521fb16539ec81de">valeur</a>());
<a name="l00496"></a>00496             Poly.<a class="code" href="classPolyedre.html#a90df3cdc5903e33421d30c2cc84dc697">remplir_Nodes_glob</a>(Nodes_glob,les_elems);
<a name="l00497"></a>00497             FacesIndex=(Poly.<a class="code" href="classPolyedre.html#a809fefaee55526be8b587f7e3ed8337f">getFacesIndex</a>());
<a name="l00498"></a>00498             PolyhedronIndex=(Poly.<a class="code" href="classPolyedre.html#a19091e5d5d19621f9f0f6d1aacb5e4b7">getPolyhedronIndex</a>());
<a name="l00499"></a>00499           }
<a name="l00500"></a>00500         <span class="keywordflow">else</span>
<a name="l00501"></a>00501           {
<a name="l00502"></a>00502             <span class="keyword">const</span> <a class="code" href="classPolygone.html" title="Classe Polygone Cette represente l&#39;element geometrique Polygone. Un polyedre est un element defini pa...">Polygone</a>&amp; Poly=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPolygone.html" title="Classe Polygone Cette represente l&#39;element geometrique Polygone. Un polyedre est un element defini pa...">Polygone</a>,ele.<a class="code" href="classDeriv__Elem__geom__base.html#a384b487459a33f9f521fb16539ec81de">valeur</a>());
<a name="l00503"></a>00503 <span class="comment">// Poly.remplir_Nodes_glob(Nodes_glob,les_elems);</span>
<a name="l00504"></a>00504             FacesIndex=(Poly.<a class="code" href="classPolygone.html#ae2e6d8cabe5491365c447e80eb1068ad">getFacesIndex</a>());
<a name="l00505"></a>00505             PolyhedronIndex=(Poly.<a class="code" href="classPolygone.html#a014f99a010a6e083caf8d27bf6bb05c9">getPolygonIndex</a>());
<a name="l00506"></a>00506           }
<a name="l00507"></a>00507 
<a name="l00508"></a>00508 <span class="comment">// pas necessaire on a rempli avec elem qui a le +1 Nodes_glob+=1;</span>
<a name="l00509"></a>00509         FacesIndex+=1;
<a name="l00510"></a>00510         PolyhedronIndex+=1;
<a name="l00511"></a>00511         <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>* med_Nodes=convert_int_med_int(Nodes_glob);
<a name="l00512"></a>00512         <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>* med_FacesIndex=convert_int_med_int(FacesIndex);
<a name="l00513"></a>00513         <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>* med_PolyhedronIndex=convert_int_med_int(PolyhedronIndex);
<a name="l00514"></a>00514         <span class="keywordtype">int</span> size_index=PolyhedronIndex.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00515"></a>00515         <span class="keywordtype">int</span> size_f=FacesIndex.size_array();
<a name="l00516"></a>00516         <span class="keywordflow">if</span> (type_elem_med==MED_POLYHEDRON)
<a name="l00517"></a>00517           {
<a name="l00518"></a>00518             ret=MEDmeshPolyhedronWr(fid,nom_dom,MED_NO_DT,MED_NO_IT,0.,MED_CELL,MED_NODAL,size_index,med_PolyhedronIndex,size_f,med_FacesIndex,med_Nodes);
<a name="l00519"></a>00519           }
<a name="l00520"></a>00520         <span class="keywordflow">else</span>
<a name="l00521"></a>00521           {
<a name="l00522"></a>00522             ret=MEDmeshPolygonWr(fid,nom_dom,MED_NO_DT,MED_NO_IT,MED_UNDEF_DT,MED_CELL,MED_NODAL,size_index,med_PolyhedronIndex,med_FacesIndex);
<a name="l00523"></a>00523           }
<a name="l00524"></a>00524         <span class="keywordflow">if</span> (ret&lt;0)
<a name="l00525"></a>00525           {
<a name="l00526"></a>00526             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; Problem MEDpolyedreConnEcr&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00527"></a>00527             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00528"></a>00528           }
<a name="l00529"></a>00529         <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)!=<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>))
<a name="l00530"></a>00530           {
<a name="l00531"></a>00531             <span class="keyword">delete</span> [] med_Nodes;
<a name="l00532"></a>00532             <span class="keyword">delete</span> [] med_FacesIndex;
<a name="l00533"></a>00533             <span class="keyword">delete</span> [] med_PolyhedronIndex;
<a name="l00534"></a>00534           }
<a name="l00535"></a>00535 <span class="comment">// on ecrit les familles avant d&#39;oublier....</span>
<a name="l00536"></a>00536         <span class="keywordflow">if</span> ((ret = MEDmeshEntityFamilyNumberWr(fid,nom_dom,MED_NO_DT,MED_NO_IT,MED_CELL,type_elem_med,nelem,nufano)) &lt; 0)
<a name="l00537"></a>00537           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00538"></a>00538 
<a name="l00539"></a>00539       }
<a name="l00540"></a>00540     <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)!=<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>))
<a name="l00541"></a>00541       <span class="keyword">delete</span> [] med_les_elems;
<a name="l00542"></a>00542 
<a name="l00543"></a>00543     <span class="keywordflow">if</span> (ret&lt;0)
<a name="l00544"></a>00544       {
<a name="l00545"></a>00545         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Problem when writing elements in &quot;</span>&lt;&lt;nom_fic&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00546"></a>00546         <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00547"></a>00547       }
<a name="l00548"></a>00548     <span class="keyword">delete</span> []  nufano;
<a name="l00549"></a>00549   }
<a name="l00550"></a>00550 <span class="comment">// ecriture des faces...</span>
<a name="l00551"></a>00551   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;type_face.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); j++)
<a name="l00552"></a>00552     medecrirefaces( all_faces_bord[j],type_face[j], fid, nom_dom, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>, familles[j]);
<a name="l00553"></a>00553 <span class="comment">// ecriture des familles c.a.d leur nom = les cl</span>
<a name="l00554"></a>00554   {
<a name="l00555"></a>00555     <span class="keywordtype">int</span> natt=1;
<a name="l00556"></a>00556     <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *attval,*attide;
<a name="l00557"></a>00557     attide = <span class="keyword">new</span> <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>[natt];
<a name="l00558"></a>00558     attval = <span class="keyword">new</span> <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>[natt];
<a name="l00559"></a>00559     attide[0]=1;
<a name="l00560"></a>00560 <span class="comment">// ajout de la famille 0</span>
<a name="l00561"></a>00561     <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nomfz(med_taille_nom);
<a name="l00562"></a>00562     <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_zone_bis;
<a name="l00563"></a>00563     nom_zone_bis=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00564"></a>00564     <span class="keywordflow">if</span> (noms_bords.<a class="code" href="classNoms.html#abfb5d6c835f10f136fffb8c30c4fc2b5">search</a>(nom_zone)!=-1)
<a name="l00565"></a>00565       {
<a name="l00566"></a>00566         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;The zone name is also a boundary name&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00567"></a>00567         nom_zone_bis=<span class="stringliteral">&quot;cpy_&quot;</span>;
<a name="l00568"></a>00568       }
<a name="l00569"></a>00569     nom_zone_bis+=nom_zone;
<a name="l00570"></a>00570 <span class="comment">// strcpy(nomfz,nom_zone_bis);</span>
<a name="l00571"></a>00571     nomfz=<span class="stringliteral">&quot;elems&quot;</span>;
<a name="l00572"></a>00572     ret=MEDfamilyCr(fid,nom_dom,nomfz,0,0,NULL);
<a name="l00573"></a>00573     <span class="keywordflow">if</span> (ret&lt;0)
<a name="l00574"></a>00574       {
<a name="l00575"></a>00575         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Problem when writing nom_zone family in &quot;</span>&lt;&lt;nom_fic&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00576"></a>00576         <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00577"></a>00577       }
<a name="l00578"></a>00578     <span class="keywordflow">if</span> (nom_zone_bis==<span class="stringliteral">&quot;elems&quot;</span>) nom_zone_bis+=<span class="stringliteral">&quot;_cpy&quot;</span>;
<a name="l00579"></a>00579     nomfz=nom_zone_bis;
<a name="l00580"></a>00580 <span class="comment">// strcpy(nomfz,&quot;elems&quot;);</span>
<a name="l00581"></a>00581     ret=MEDfamilyCr(fid,nom_dom,nomfz,famglob,0,NULL);
<a name="l00582"></a>00582     <span class="keywordflow">if</span> (ret&lt;0)
<a name="l00583"></a>00583       {
<a name="l00584"></a>00584         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Problem when writing the elements family in &quot;</span>&lt;&lt;nom_fic&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00585"></a>00585         <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00586"></a>00586       }
<a name="l00587"></a>00587     <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> attdes;
<a name="l00588"></a>00588     <a class="code" href="LireMED_8cpp.html#a5fb8877635c9569522f3e6fac236559c">dimensionne_char_ptr_taille</a>(attdes,MED_COMMENT_SIZE,natt);
<a name="l00589"></a>00589     <span class="keywordtype">int</span> ii;
<a name="l00590"></a>00590     <span class="keywordflow">for</span> (ii=0; ii&lt;MED_COMMENT_SIZE*natt; ii++) attdes[ii]=<span class="charliteral">&#39; &#39;</span>;
<a name="l00591"></a>00591     attdes[ii]=<span class="charliteral">&#39;\0&#39;</span>;
<a name="l00592"></a>00592 
<a name="l00593"></a>00593     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;noms_bords.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); i++)
<a name="l00594"></a>00594       {
<a name="l00595"></a>00595         attval[0]=i+1;
<a name="l00596"></a>00596         <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> groupname;
<a name="l00597"></a>00597         <a class="code" href="LireMED_8cpp.html#a5fb8877635c9569522f3e6fac236559c">dimensionne_char_ptr_taille</a>(groupname,MED_LNAME_SIZE);
<a name="l00598"></a>00598         affecte_nom_med(groupname,noms_bords[i]);
<a name="l00599"></a>00599         ret=MEDfamilyCr(fid,nom_dom,noms_bords[i],-(i+1),1,groupname);
<a name="l00600"></a>00600         <span class="keywordflow">if</span> (ret&lt;0)
<a name="l00601"></a>00601           {
<a name="l00602"></a>00602             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Problem when writing the family &quot;</span> &lt;&lt;i+1&lt;&lt;<span class="stringliteral">&quot; in &quot;</span>&lt;&lt;nom_fic&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00603"></a>00603             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;nom_dom&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;noms_bords[i]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;(int)attide[0]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;(<span class="keywordtype">int</span>)attval[0]&lt;&lt;&quot; &quot;&lt;&lt;attdes&lt;&lt;&quot; natt &quot;&lt;&lt;natt&lt;&lt;finl;
<a name="l00604"></a>00604             <a class="code" href="classProcess.html" title="Classe de base de TRUST (notamment Objet_U). Elle fournit quelques services de base accessibles de pa...">Process</a>::exit();
<a name="l00605"></a>00605           }
<a name="l00606"></a>00606       }
<a name="l00607"></a>00607     delete [] attide;
<a name="l00608"></a>00608     delete [] attval;
<a name="l00609"></a>00609   }
<a name="l00610"></a>00610 <span class="preprocessor">#ifdef MED_ESSAI</span>
<a name="l00611"></a>00611 <span class="preprocessor"></span><span class="comment">// un petit essai pour rire</span>
<a name="l00612"></a>00612 <span class="comment">// provoque memory_fault!!!</span>
<a name="l00613"></a>00613 <span class="comment">// peut etre pb MEDTAILLE non utilise partout... a reprendre partout</span>
<a name="l00614"></a>00614 <span class="comment">// a chaque appel MED  .... courage</span>
<a name="l00615"></a>00615   <span class="keywordflow">if</span> (0)
<a name="l00616"></a>00616     {
<a name="l00617"></a>00617 <span class="comment">// _MEDmodeErreurVerrouiller();</span>
<a name="l00618"></a>00618       <a class="code" href="med__nul_8h.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> root;
<a name="l00619"></a>00619       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> chemin=<span class="stringliteral">&quot;/TRUST&quot;</span>;
<a name="l00620"></a>00620 <span class="comment">// creation du repertoire TRUST</span>
<a name="l00621"></a>00621       <span class="keywordflow">if</span> ((root = _MEDdatagroupOuvrir(fid,chemin)) &lt; 0)
<a name="l00622"></a>00622         <span class="keywordflow">if</span> ((root = _MEDdatagroupCreer(fid,chemin)) &lt; 0)
<a name="l00623"></a>00623           exit();
<a name="l00624"></a>00624       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> data(<a class="code" href="classObjet__U.html#a7c27c4f80259eeef76ff8fe2d3bc61f7" title="Renvoie une reference constante vers le nom du cas. Cette methode est statique.">Objet_U::nom_du_cas</a>());
<a name="l00625"></a>00625       <span class="keywordflow">if</span> ((ret = _MEDattrStringEcrire(root,<span class="stringliteral">&quot;CAS&quot;</span>,strlen(data),data,MED_ACC_CREAT)) &lt; 0)
<a name="l00626"></a>00626         exit();
<a name="l00627"></a>00627 <span class="comment">// if ((ret = _MEDattFloatEcrire(root,&quot;DOUBLE&quot;,strlen(data),data,MED_ACC_CREAT)) &lt; 0)</span>
<a name="l00628"></a>00628 <span class="comment">// exit();</span>
<a name="l00629"></a>00629     }
<a name="l00630"></a>00630 <span class="preprocessor">#endif</span>
<a name="l00631"></a>00631 <span class="preprocessor"></span>  ret = MEDfileClose(fid);
<a name="l00632"></a>00632   <span class="keywordflow">if</span> (ret&lt;0)
<a name="l00633"></a>00633     {
<a name="l00634"></a>00634       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Problem when closing  &quot;</span>&lt;&lt;nom_fic&lt;&lt;finl;
<a name="l00635"></a>00635       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00636"></a>00636     }
<a name="l00637"></a>00637   <span class="keywordflow">return</span> ret;
<a name="l00638"></a>00638 }
<a name="l00639"></a>00639 
<a name="l00640"></a>00640 
<a name="l00641"></a>00641 <span class="comment">// passage de la connectivite trio a MED si sens=1</span>
<a name="l00642"></a>00642 <span class="comment">// de MED a trio si sens=-1</span>
<a name="l00643"></a>00643 <span class="keywordtype">void</span> renum_conn(<a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; les_elems2,<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type_elem,<span class="keywordtype">int</span> sens)
<a name="l00644"></a>00644 {
<a name="l00645"></a>00645   <span class="keywordtype">int</span> nele=les_elems2.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00646"></a>00646 <span class="comment">// cas face_bord vide</span>
<a name="l00647"></a>00647   <span class="keywordflow">if</span> (nele==0) <span class="keywordflow">return</span>;
<a name="l00648"></a>00648   med_geometry_type type_elem_med;
<a name="l00649"></a>00649   type_elem_med=type_geo_trio_to_type_med(type_elem);
<a name="l00650"></a>00650   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> les_elemsn(les_elems2);
<a name="l00651"></a>00651   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> filter;
<a name="l00652"></a>00652   <span class="keywordflow">switch</span> (type_elem_med)
<a name="l00653"></a>00653     {
<a name="l00654"></a>00654     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9a4432abce1ca88e2d4258dc04b249ca9c">MED_POINT1</a>  :
<a name="l00655"></a>00655       {
<a name="l00656"></a>00656         filter.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(1) ;
<a name="l00657"></a>00657         filter[0] = 0 ;
<a name="l00658"></a>00658         break ;
<a name="l00659"></a>00659       }
<a name="l00660"></a>00660     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9aaaa2ffd110978e6d24ecd0fe03219006">MED_SEG2</a>    :
<a name="l00661"></a>00661       {
<a name="l00662"></a>00662         filter.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(2) ;
<a name="l00663"></a>00663         filter[0] = 0 ;
<a name="l00664"></a>00664         filter[1] = 1 ;
<a name="l00665"></a>00665 
<a name="l00666"></a>00666         break ;
<a name="l00667"></a>00667       }
<a name="l00668"></a>00668     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9a88faa5e735d5cf02455eb9a9f12dd66a">MED_SEG3</a>    :
<a name="l00669"></a>00669       {
<a name="l00670"></a>00670         break ;
<a name="l00671"></a>00671       }
<a name="l00672"></a>00672     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9afe2d4f36086bb36c549eafad57271d07">MED_TRIA3</a>   :
<a name="l00673"></a>00673       {
<a name="l00674"></a>00674         filter.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(3) ;
<a name="l00675"></a>00675         filter[0] = 0 ;
<a name="l00676"></a>00676         filter[1] = 1 ;
<a name="l00677"></a>00677         filter[2] = 2 ;
<a name="l00678"></a>00678         break ;
<a name="l00679"></a>00679       }
<a name="l00680"></a>00680     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9af3665c92b5329563931c10730fcfa654">MED_QUAD4</a>   :
<a name="l00681"></a>00681       {
<a name="l00682"></a>00682         filter.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(4) ;
<a name="l00683"></a>00683 <span class="comment">// filter[0] = 0 ;</span>
<a name="l00684"></a>00684 <span class="comment">// filter[1] = 1 ;</span>
<a name="l00685"></a>00685 <span class="comment">// filter[2] = 3 ;</span>
<a name="l00686"></a>00686 <span class="comment">// filter[3] = 2 ;</span>
<a name="l00687"></a>00687 
<a name="l00688"></a>00688 
<a name="l00689"></a>00689         filter[0] = 0 ;
<a name="l00690"></a>00690         filter[1] = 2 ;
<a name="l00691"></a>00691         filter[2] = 3 ;
<a name="l00692"></a>00692         filter[3] = 1 ;
<a name="l00693"></a>00693 
<a name="l00694"></a>00694         break ;
<a name="l00695"></a>00695       }
<a name="l00696"></a>00696     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9a5d9daf72c6170e49ec67c85e5ec67da6">MED_TRIA6</a>   :
<a name="l00697"></a>00697       {
<a name="l00698"></a>00698         break ;
<a name="l00699"></a>00699       }
<a name="l00700"></a>00700     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9a78e31066a195dedfcb5732eee7e57419">MED_QUAD8</a>   :
<a name="l00701"></a>00701       {
<a name="l00702"></a>00702         break ;
<a name="l00703"></a>00703       }
<a name="l00704"></a>00704     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9a46d58f840282228234fdd85137278a8b">MED_TETRA4</a>  :
<a name="l00705"></a>00705       {
<a name="l00706"></a>00706         filter.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(4) ;
<a name="l00707"></a>00707 <span class="comment">// exit();</span>
<a name="l00708"></a>00708         filter[0] = 0 ;
<a name="l00709"></a>00709         filter[1] = 1 ;
<a name="l00710"></a>00710         filter[2] = 2 ;  <span class="comment">//!&lt; 3td element in med are 4th in vtk (array begin at 0 !)</span>
<a name="l00711"></a>00711 <span class="comment"></span>        filter[3] = 3 ;  <span class="comment">//!&lt; 4th element in med are 3rd in vtk (array begin at 0 !)</span>
<a name="l00712"></a>00712 <span class="comment"></span>        break ;
<a name="l00713"></a>00713       }
<a name="l00714"></a>00714     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9ac65b34626cd264d9fa656cbd3c5b1810">MED_PYRA5</a>   :
<a name="l00715"></a>00715       {
<a name="l00716"></a>00716         filter.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(5) ;
<a name="l00717"></a>00717         filter[0] = 0 ;
<a name="l00718"></a>00718         filter[1] = 3 ;  <span class="comment">//!&lt; 2nd element in med are 4th in vtk (array begin at 0 !)</span>
<a name="l00719"></a>00719 <span class="comment"></span>        filter[2] = 2 ;
<a name="l00720"></a>00720         filter[3] = 1 ;  <span class="comment">//!&lt; 4th element in med are 2nd in vtk (array begin at 0 !)</span>
<a name="l00721"></a>00721 <span class="comment"></span>        filter[4] = 4 ;
<a name="l00722"></a>00722         break ;
<a name="l00723"></a>00723       }
<a name="l00724"></a>00724     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9a25664b83378018af9b5e018ec090d15d">MED_PENTA6</a>  :
<a name="l00725"></a>00725       {
<a name="l00726"></a>00726         filter.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(6) ;
<a name="l00727"></a>00727         filter[0] = 0 ;
<a name="l00728"></a>00728         filter[1] = 1 ;
<a name="l00729"></a>00729         filter[2] = 2 ;
<a name="l00730"></a>00730         filter[3] = 3 ;
<a name="l00731"></a>00731         filter[4] = 4 ;
<a name="l00732"></a>00732         filter[5] = 5 ;
<a name="l00733"></a>00733         break ;
<a name="l00734"></a>00734       }
<a name="l00735"></a>00735     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9af413ef36dde25d6d4f0d526f1f7aeedf">MED_HEXA8</a>   :
<a name="l00736"></a>00736       {
<a name="l00737"></a>00737         filter.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(8) ;
<a name="l00738"></a>00738 
<a name="l00739"></a>00739 
<a name="l00740"></a>00740         filter[0] = 0 ;
<a name="l00741"></a>00741         filter[1] = 2 ;
<a name="l00742"></a>00742         filter[2] = 3 ;
<a name="l00743"></a>00743         filter[3] = 1 ;
<a name="l00744"></a>00744         filter[4] = 4 ;
<a name="l00745"></a>00745         filter[5] = 6 ;
<a name="l00746"></a>00746         filter[6] = 7 ;
<a name="l00747"></a>00747         filter[7] = 5 ;
<a name="l00748"></a>00748         break ;
<a name="l00749"></a>00749       }
<a name="l00750"></a>00750     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9adf05f2f5b18a142f387d62d0d3fb31f9">MED_TETRA10</a> :
<a name="l00751"></a>00751       {
<a name="l00752"></a>00752         break ;
<a name="l00753"></a>00753       }
<a name="l00754"></a>00754     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9ad50ac2f8860339656cd3b22e81a9aa81">MED_PYRA13</a>  :
<a name="l00755"></a>00755       {
<a name="l00756"></a>00756         break ;
<a name="l00757"></a>00757       }
<a name="l00758"></a>00758     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9aebeb346e9666dc1f60c46155675115bc">MED_PENTA15</a> :
<a name="l00759"></a>00759       {
<a name="l00760"></a>00760         break ;
<a name="l00761"></a>00761       }
<a name="l00762"></a>00762     <span class="keywordflow">case</span> <a class="code" href="med__nul_8h.html#ab93ab4475f81e2db98705aca718115a9a1ffbaa0b69cc56bffbb14c2bb102cc64">MED_HEXA20</a>  :
<a name="l00763"></a>00763       {
<a name="l00764"></a>00764         break ;
<a name="l00765"></a>00765       }
<a name="l00766"></a>00766     <span class="keywordflow">case</span> MED_OCTA12 :
<a name="l00767"></a>00767     <span class="keywordflow">case</span> MED_POLYGON:
<a name="l00768"></a>00768     <span class="keywordflow">case</span> MED_POLYHEDRON:
<a name="l00769"></a>00769       {
<a name="l00770"></a>00770         <span class="keywordtype">int</span> nb_som_max=les_elems2.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00771"></a>00771         filter.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(nb_som_max);
<a name="l00772"></a>00772         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_som_max; i++) filter[i]=i;
<a name="l00773"></a>00773         break ;
<a name="l00774"></a>00774       }
<a name="l00775"></a>00775     <span class="keywordflow">default</span>:
<a name="l00776"></a>00776       {
<a name="l00777"></a>00777         <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;case not scheduled&quot;</span>&lt;&lt;finl;
<a name="l00778"></a>00778         <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00779"></a>00779       }
<a name="l00780"></a>00780     }
<a name="l00781"></a>00781 
<a name="l00782"></a>00782   <span class="keywordtype">int</span> ns=filter.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00783"></a>00783   <span class="keywordflow">if</span> (ns==0)
<a name="l00784"></a>00784     {
<a name="l00785"></a>00785       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Problem for filtering operation &quot;</span>&lt;&lt;finl;
<a name="l00786"></a>00786       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00787"></a>00787     }
<a name="l00788"></a>00788   <span class="keywordflow">if</span> (filter.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()!=les_elems2.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1))
<a name="l00789"></a>00789     {
<a name="l00790"></a>00790 <span class="preprocessor">#ifndef POURSATURNE</span>
<a name="l00791"></a>00791 <span class="preprocessor"></span>      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Problem for filtering operation &quot;</span>&lt;&lt;finl;
<a name="l00792"></a>00792       exit();
<a name="l00793"></a>00793 <span class="preprocessor">#endif</span>
<a name="l00794"></a>00794 <span class="preprocessor"></span>    }
<a name="l00795"></a>00795   <span class="keywordflow">if</span> (sens==1)
<a name="l00796"></a>00796     {
<a name="l00797"></a>00797       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> el=0; el&lt;nele; el++)
<a name="l00798"></a>00798         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n=0; n&lt;ns; n++)
<a name="l00799"></a>00799           les_elems2(el,n)=les_elemsn(el,filter[n])+1;
<a name="l00800"></a>00800 
<a name="l00801"></a>00801     }
<a name="l00802"></a>00802   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sens==-1)
<a name="l00803"></a>00803     {
<a name="l00804"></a>00804       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> el=0; el&lt;nele; el++)
<a name="l00805"></a>00805         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n=0; n&lt;ns; n++)
<a name="l00806"></a>00806           les_elems2(el,filter[n])=les_elemsn(el,n)-1;
<a name="l00807"></a>00807     }
<a name="l00808"></a>00808   <span class="keywordflow">else</span>
<a name="l00809"></a>00809     {
<a name="l00810"></a>00810       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;error in renum_conn : meaning &quot;</span>&lt;&lt;sens&lt;&lt;<span class="stringliteral">&quot;not valid&quot;</span>&lt;&lt;finl;
<a name="l00811"></a>00811       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00812"></a>00812     }
<a name="l00813"></a>00813 }
<a name="l00814"></a>00814 
<a name="l00815"></a>00815 
<a name="l00816"></a>00816 
<a name="l00817"></a>00817 
<a name="l00818"></a>00818 
<a name="l00819"></a>00819 <span class="comment">// permet de boucler sur les bords,raccords,joints</span>
<a name="l00820"></a>00820 <span class="keyword">const</span> <a class="code" href="classFrontiere.html" title="Classe Frontiere. Une Frontiere decrit une partie de la frontiere d&#39;une Zone, elle possede un Nom...">Frontiere</a>&amp; mes_faces_fr(<span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone,<span class="keywordtype">int</span> i)
<a name="l00821"></a>00821 {
<a name="l00822"></a>00822 <span class="comment">// int nb_faces_joint=zone.nb_faces_joint();</span>
<a name="l00823"></a>00823   <span class="keywordtype">int</span> nb_std=zone.<a class="code" href="classZone.html#a9bf185c52ad1809d954bba670d9aed8a" title="Renvoie le nombre de bords + le nombre de raccords + le nombre de faces frontieres internes...">nb_front_Cl</a>();
<a name="l00824"></a>00824   <span class="keywordflow">if</span> (i&lt;nb_std)
<a name="l00825"></a>00825     <span class="keywordflow">return</span> zone.<a class="code" href="classZone.html#ac338b119d4b0bc4f510a223b9086fe5e">frontiere</a>(i);
<a name="l00826"></a>00826   <span class="keywordflow">else</span> <span class="keywordflow">return</span> zone.<a class="code" href="classZone.html#acec4c61032df8b55a95f9e7197ef6e3c" title="Renvoie le i-ieme joint de la zone&lt;br&gt;(version const)">joint</a>(i-nb_std);
<a name="l00827"></a>00827 }
<a name="l00828"></a>00828 
<a name="l00829"></a>00829 
<a name="l00830"></a>00830 <span class="comment">// a partir d&#39;un domaine extrait le type de face, la connectivite des faces de bords, le nom des bords et cree les familles</span>
<a name="l00831"></a>00831 <span class="keywordtype">void</span> creer_all_faces_bord(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,<a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; type_face,<a class="code" href="Vect_8h.html#adc7c7b04809c9aec2cb897cd2ef06378">VECT</a>(<a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>)&amp; all_faces_bord, <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; noms_bords,<a class="code" href="Vect_8h.html#adc7c7b04809c9aec2cb897cd2ef06378">VECT</a>(<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>)&amp; familles)
<a name="l00832"></a>00832 {
<a name="l00833"></a>00833   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone=dom.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);
<a name="l00834"></a>00834   <span class="keywordtype">int</span> nb_type_face=zone.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classElem__geom.html#abeb90778b3197b373bc7b35015dd3de4" title="Appel a l&#39;objet sous-jacent Renvoie le nombre de type de face de l&#39;element geometrique.">nb_type_face</a>();
<a name="l00835"></a>00835   type_face.<a class="code" href="classvect__impl.html#ad841d6b676a796bae26ed2566b7b3b41">dimensionner</a>(nb_type_face);
<a name="l00836"></a>00836   all_faces_bord.dimensionner(nb_type_face);
<a name="l00837"></a>00837   familles.dimensionner(nb_type_face);
<a name="l00838"></a>00838 
<a name="l00839"></a>00839 
<a name="l00840"></a>00840   <span class="keywordtype">int</span> nb_faces_bord=zone.<a class="code" href="classZone.html#a30db06b6e445fedc9b3772dd24247f2d" title="Renvoie le nombre de faces qui sont des bords.">nb_faces_bord</a>()+zone.<a class="code" href="classZone.html#a1ce479915234e24225f81b866ca13ea8" title="Renvoie le nombre de raccords de la zone.">nb_faces_raccord</a>()+zone.<a class="code" href="classZone.html#a9e95b9db7a588dee827091663b52ba5b" title="Renvoie le nombre de face internes de la zone.">nb_faces_int</a>()+zone.<a class="code" href="classZone.html#aff77b437f8c58064cc80a3221a0b6130" title="Renvoie le nombre de joints de la zone.">nb_faces_joint</a>();
<a name="l00841"></a>00841   <span class="keywordtype">int</span> nb_bords=zone.<a class="code" href="classZone.html#a9bf185c52ad1809d954bba670d9aed8a" title="Renvoie le nombre de bords + le nombre de raccords + le nombre de faces frontieres internes...">nb_front_Cl</a>()+zone.<a class="code" href="classZone.html#ab096afb61e89705709a4ae6d3576a644" title="Renvoie le nombre de joints de la zone.">nb_joints</a>();
<a name="l00842"></a>00842   <span class="keywordflow">if</span> (nb_bords==0)
<a name="l00843"></a>00843     {
<a name="l00844"></a>00844 <span class="comment">// on n&#39;a pas les bords</span>
<a name="l00845"></a>00845       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nb_type_face; j++)
<a name="l00846"></a>00846         all_faces_bord[j].resize(0,0);
<a name="l00847"></a>00847       <span class="keywordflow">return</span>;
<a name="l00848"></a>00848     }
<a name="l00849"></a>00849 <span class="comment">// on cherche un bord non vide pour recuperer le type de faces</span>
<a name="l00850"></a>00850   <span class="keywordtype">int</span> nb_type_trouve=0;
<a name="l00851"></a>00851   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;nb_bords; ii++)
<a name="l00852"></a>00852     {
<a name="l00853"></a>00853       <span class="keywordflow">if</span> (mes_faces_fr(zone,ii).faces().nb_faces()!=0)
<a name="l00854"></a>00854         {
<a name="l00855"></a>00855           <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> type_face_b;
<a name="l00856"></a>00856           type_face_b=mes_faces_fr(zone,ii).faces().type(mes_faces_fr(zone,ii).faces().type_face());
<a name="l00857"></a>00857           <span class="keywordtype">int</span> existe=0;
<a name="l00858"></a>00858           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nb_type_trouve; j++)
<a name="l00859"></a>00859             <span class="keywordflow">if</span> (type_face_b==type_face[j])
<a name="l00860"></a>00860               existe=1;
<a name="l00861"></a>00861           <span class="keywordflow">if</span> (!existe)
<a name="l00862"></a>00862             {
<a name="l00863"></a>00863               type_face[nb_type_trouve]=type_face_b;
<a name="l00864"></a>00864               nb_type_trouve++;
<a name="l00865"></a>00865             }
<a name="l00866"></a>00866         }
<a name="l00867"></a>00867     }
<a name="l00868"></a>00868   <span class="keywordflow">if</span> (nb_type_trouve!=nb_type_face)
<a name="l00869"></a>00869     {
<a name="l00870"></a>00870       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;all boundaries type have not been found&quot;</span> &lt;&lt;finl;
<a name="l00871"></a>00871     }
<a name="l00872"></a>00872 <span class="comment">// Cerr&lt;&lt;&quot;type_face &quot;&lt;&lt;type_face&lt;&lt;finl;</span>
<a name="l00873"></a>00873 
<a name="l00874"></a>00874   <span class="keywordtype">int</span> nb_som_face_max=zone.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classElem__geom.html#ab55aa8b4ec6aa60cfde5d5fc134c5333" title="Appel a l&#39;objet sous-jacent Renvoie le nombre de sommets des faces du type specifie.">nb_som_face</a>(0);
<a name="l00875"></a>00875   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nb_type_face; j++)
<a name="l00876"></a>00876     {
<a name="l00877"></a>00877       all_faces_bord[j].<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_faces_bord, nb_som_face_max);
<a name="l00878"></a>00878 <span class="preprocessor">#ifdef POURSATURNE</span>
<a name="l00879"></a>00879 <span class="preprocessor"></span>      all_faces_bord[j]=0;
<a name="l00880"></a>00880 <span class="preprocessor">#endif</span>
<a name="l00881"></a>00881 <span class="preprocessor"></span>      familles[j].<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(nb_faces_bord);
<a name="l00882"></a>00882     }
<a name="l00883"></a>00883   noms_bords.<a class="code" href="classvect__impl.html#ad841d6b676a796bae26ed2566b7b3b41">dimensionner</a>(nb_bords);
<a name="l00884"></a>00884 
<a name="l00885"></a>00885 <span class="comment">// enfin on recupere le nom des faces de bord et leur connectivite</span>
<a name="l00886"></a>00886   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> cpt(nb_type_face);
<a name="l00887"></a>00887   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> nb_som(nb_type_face);
<a name="l00888"></a>00888   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nb_bords; i++)
<a name="l00889"></a>00889     {
<a name="l00890"></a>00890       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classRaccord__base.html" title="Classe Raccord_base Cette classe est simplement une frontiere, c&#39;est la classe de base de la hierarch...">Raccord_base</a>,mes_faces_fr(zone,i)))
<a name="l00891"></a>00891         {
<a name="l00892"></a>00892           noms_bords[i]=<span class="stringliteral">&quot;type_raccord_&quot;</span>;
<a name="l00893"></a>00893           noms_bords[i]+=mes_faces_fr(zone,i).<a class="code" href="classObjet__U.html#a70413a8785d36bf5105fced1c89d0d2b" title="Donne le nom de l&#39;Objet_U Methode a surcharger : renvoie &quot;neant&quot; dans cette implementation.">le_nom</a>();
<a name="l00894"></a>00894         }
<a name="l00895"></a>00895       <span class="keywordflow">else</span>
<a name="l00896"></a>00896         noms_bords[i]=mes_faces_fr(zone,i).<a class="code" href="classObjet__U.html#a70413a8785d36bf5105fced1c89d0d2b" title="Donne le nom de l&#39;Objet_U Methode a surcharger : renvoie &quot;neant&quot; dans cette implementation.">le_nom</a>();
<a name="l00897"></a>00897       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; les_sommets_des_faces=mes_faces_fr(zone,i).les_sommets_des_faces();
<a name="l00898"></a>00898       <span class="keywordtype">int</span> nb_fac=les_sommets_des_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00899"></a>00899 <span class="comment">// on cherche de quel type est le bord</span>
<a name="l00900"></a>00900       <span class="keywordtype">int</span> ref=0;
<a name="l00901"></a>00901       <span class="keywordflow">if</span> (nb_fac&gt;0)
<a name="l00902"></a>00902         {
<a name="l00903"></a>00903           <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> type_face_b=mes_faces_fr(zone,i).faces().type(mes_faces_fr(zone,i).faces().type_face());
<a name="l00904"></a>00904           ref=type_face.<a class="code" href="classNoms.html#abfb5d6c835f10f136fffb8c30c4fc2b5">search</a>(type_face_b);
<a name="l00905"></a>00905         }
<a name="l00906"></a>00906       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nb_fac; j++)
<a name="l00907"></a>00907         {
<a name="l00908"></a>00908           <span class="keywordtype">int</span> nb_som_face=les_sommets_des_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00909"></a>00909           familles[ref](cpt[ref])=-(i+1);
<a name="l00910"></a>00910           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;nb_som_face; k++)
<a name="l00911"></a>00911             all_faces_bord[ref](cpt[ref], k)=les_sommets_des_faces(j, k);
<a name="l00912"></a>00912           cpt[ref]++;
<a name="l00913"></a>00913           nb_som[ref]=nb_som_face;
<a name="l00914"></a>00914         }
<a name="l00915"></a>00915     }
<a name="l00916"></a>00916   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nb_type_face; j++)
<a name="l00917"></a>00917     {
<a name="l00918"></a>00918       familles[j].<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(cpt[j]);
<a name="l00919"></a>00919       <span class="keywordflow">if</span> (nb_type_face&gt;1)
<a name="l00920"></a>00920         {
<a name="l00921"></a>00921           <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> prov=all_faces_bord[j];
<a name="l00922"></a>00922           <span class="keywordtype">int</span> nb_som_face=nb_som[j];
<a name="l00923"></a>00923           <span class="keywordtype">int</span> nb_faces=cpt[j];
<a name="l00924"></a>00924           <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; all_faces_bord_=all_faces_bord[j];
<a name="l00925"></a>00925           all_faces_bord_.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_faces,nb_som_face);
<a name="l00926"></a>00926           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f=0; f&lt;nb_faces; f++)
<a name="l00927"></a>00927             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;nb_som_face; c++)
<a name="l00928"></a>00928               all_faces_bord_(f,c)=prov(f,c);
<a name="l00929"></a>00929         }
<a name="l00930"></a>00930     }
<a name="l00931"></a>00931 }
<a name="l00932"></a>00932 
<a name="l00933"></a>00933 <span class="keywordtype">void</span> <a class="code" href="classEcrMED.html#a262b6ac744c50c16f9770d9cec771940">EcrMED::ecrire_domaine</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fic,<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_dom,<span class="keywordtype">int</span> mode)
<a name="l00934"></a>00934 {
<a name="l00935"></a>00935   <a class="code" href="Ref_8h.html#aab5720a5c34da14028d0745e386aaa01">REF</a>(<a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>) zone_dis_base; <span class="comment">//!&lt; Pas de zone discretisee</span>
<a name="l00936"></a>00936 <span class="comment"></span>  <a class="code" href="classEcrMED.html#a20f4a903057f47b7b572ee038f3bb137">ecrire_domaine_dis</a>(nom_fic, dom, zone_dis_base, nom_dom, mode);
<a name="l00937"></a>00937 }
<a name="l00938"></a>00938 
<a name="l00939"></a>00939 <span class="comment">// ecrit le domaine dom dans le fichier nom_fic</span>
<a name="l00940"></a>00940 <span class="comment">// mode = -1 nouveau fichier</span>
<a name="l00941"></a>00941 <span class="comment">// mode = 0 ajout du domaine dans le fichier</span>
<a name="l00942"></a>00942 <span class="keywordtype">void</span> <a class="code" href="classEcrMED.html">EcrMED</a>::<a class="code" href="classEcrMED.html#a20f4a903057f47b7b572ee038f3bb137">ecrire_domaine_dis</a>(const <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fic,const <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,const <a class="code" href="Ref_8h.html#aab5720a5c34da14028d0745e386aaa01">REF</a>(<a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>)&amp; zone_dis_base,const <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_dom,<span class="keywordtype">int</span> mode)
<a name="l00943"></a>00943 {
<a name="l00944"></a>00944 <span class="comment">// Cerr&lt;&lt;&quot;Here writing of the domain &quot;&lt;&lt;nom_dom&lt;&lt;&quot; in &quot;&lt;&lt;nom_fic&lt;&lt;&quot; mode &quot;&lt;&lt;mode&lt;&lt;finl;</span>
<a name="l00945"></a>00945   <span class="keyword">const</span>  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; sommets=dom.les_sommets();
<a name="l00946"></a>00946   <span class="keyword">const</span>  <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone=dom.zone(0);
<a name="l00947"></a>00947   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> type_elem=zone.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>()-&gt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
<a name="l00948"></a>00948 
<a name="l00949"></a>00949   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; les_elems=zone.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00950"></a>00950 
<a name="l00951"></a>00951   <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a> type_face;
<a name="l00952"></a>00952   <a class="code" href="Vect_8h.html#adc7c7b04809c9aec2cb897cd2ef06378">VECT</a>(<a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>) all_faces_bord;
<a name="l00953"></a>00953   <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a> noms_bords;
<a name="l00954"></a>00954   <a class="code" href="Vect_8h.html#adc7c7b04809c9aec2cb897cd2ef06378">VECT</a>(<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>) familles;
<a name="l00955"></a>00955 <span class="comment">// remplit le tableau all_faces_bords ainsi que noms_bords et familles</span>
<a name="l00956"></a>00956   creer_all_faces_bord( dom, type_face, all_faces_bord,  noms_bords,familles);
<a name="l00957"></a>00957 <span class="comment">// connectivite Trio a MED</span>
<a name="l00958"></a>00958   for (<span class="keywordtype">int</span> j=0; j&lt;type_face.size(); j++)
<a name="l00959"></a>00959     renum_conn(all_faces_bord[j],type_face[j],1);
<a name="l00960"></a>00960   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> les_elems2(les_elems);
<a name="l00961"></a>00961 
<a name="l00962"></a>00962 <span class="comment">// connectivite Trio a MED</span>
<a name="l00963"></a>00963   renum_conn(les_elems2,type_elem,1);
<a name="l00964"></a>00964 
<a name="l00965"></a>00965   if (dimension==0)
<a name="l00966"></a>00966     {
<a name="l00967"></a>00967       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Dimension is not defined. Check your data file.&quot;</span> &lt;&lt; finl;
<a name="l00968"></a>00968       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00969"></a>00969     }
<a name="l00970"></a>00970   <span class="keywordflow">if</span> (0)
<a name="l00971"></a>00971     {
<a name="l00972"></a>00972       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Writing of the domain at the med format&quot;</span>&lt;&lt;finl
<a name="l00973"></a>00973            &lt;&lt;<span class="stringliteral">&quot;nom_fic = &quot;</span> &lt;&lt; nom_fic&lt;&lt; finl
<a name="l00974"></a>00974            &lt;&lt; <span class="stringliteral">&quot;nom_dom =&quot;</span>&lt;&lt;nom_dom&lt;&lt;finl;
<a name="l00975"></a>00975       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;dimension = &quot;</span> &lt;&lt; dimension&lt;&lt; finl
<a name="l00976"></a>00976            &lt;&lt; <span class="stringliteral">&quot;noms_bords= &quot;</span> &lt;&lt; noms_bords&lt;&lt; finl;
<a name="l00977"></a>00977     }
<a name="l00978"></a>00978 <span class="preprocessor">#ifdef MEDCOUPLING_</span>
<a name="l00979"></a>00979 <span class="preprocessor"></span>  <span class="keywordflow">if</span> (<a class="code" href="classEcrMED.html#ab0b2ba995b9f765e3196ff6727b30a3c">use_medcoupling_</a>)
<a name="l00980"></a>00980     {
<a name="l00981"></a>00981       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Trying to write MED file with MEDCoupling API. To use the MEDFile API, use EcrMEDfile or MEDFile keyword.&quot;</span> &lt;&lt; finl;
<a name="l00982"></a>00982       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Creating a MEDCouplingUMesh object for the domain &quot;</span> &lt;&lt; nom_dom &lt;&lt; finl;
<a name="l00983"></a>00983 <span class="comment">// Get MEDCoupling cell type and mesh dimension:</span>
<a name="l00984"></a>00984       <span class="keywordtype">int</span> mesh_dimension = -1;
<a name="l00985"></a>00985       INTERP_KERNEL::NormalizedCellType cell_type = type_geo_trio_to_type_medcoupling(type_elem, mesh_dimension);
<a name="l00986"></a>00986       <span class="keywordtype">int</span> ncells = les_elems2.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00987"></a>00987       <span class="keywordtype">int</span> nverts = les_elems2.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00988"></a>00988       MCAuto&lt;MEDCouplingUMesh&gt; mesh(MEDCouplingUMesh::New(nom_dom.getChar(), mesh_dimension));
<a name="l00989"></a>00989 <span class="comment">// Nodes:</span>
<a name="l00990"></a>00990       <span class="keywordtype">int</span> nnodes = sommets.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00991"></a>00991       MCAuto&lt;DataArrayDouble&gt; points(DataArrayDouble::New());
<a name="l00992"></a>00992       <span class="keywordflow">if</span> (nnodes==0)
<a name="l00993"></a>00993         points-&gt;alloc(0, dimension);
<a name="l00994"></a>00994       <span class="keywordflow">else</span>
<a name="l00995"></a>00995         points-&gt;useArray(sommets.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <span class="keyword">false</span>, MEDCoupling::DeallocType::CPP_DEALLOC, nnodes, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00996"></a>00996       points-&gt;setInfoOnComponent(0, <span class="stringliteral">&quot;x&quot;</span>);
<a name="l00997"></a>00997       points-&gt;setInfoOnComponent(1, <span class="stringliteral">&quot;y&quot;</span>);
<a name="l00998"></a>00998       <span class="keywordflow">if</span> (dimension == 3) points-&gt;setInfoOnComponent(2, <span class="stringliteral">&quot;z&quot;</span>);
<a name="l00999"></a>00999       mesh-&gt;setCoords(points);
<a name="l01000"></a>01000       mesh-&gt;allocateCells(ncells);
<a name="l01001"></a>01001 <span class="comment">// Cells</span>
<a name="l01002"></a>01002       <span class="keywordflow">if</span> (cell_type == INTERP_KERNEL::NORM_POLYHED)
<a name="l01003"></a>01003         {
<a name="l01004"></a>01004 <span class="comment">// Polyedron is special, seepage 10:</span>
<a name="l01005"></a>01005 <span class="comment">// http://trac.lecad.si/vaje/chrome/site/doc8.3.0/extra/Normalisation_pour_le_couplage_de_codes.pdf</span>
<a name="l01006"></a>01006           <span class="keyword">const</span> <a class="code" href="classPolyedre.html" title="Classe Polyedre Cette represente l&#39;element geometrique Polyedre. Un polyedre est un element defini pa...">Polyedre</a>&amp; Poly = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPolyedre.html" title="Classe Polyedre Cette represente l&#39;element geometrique Polyedre. Un polyedre est un element defini pa...">Polyedre</a>, zone.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classDeriv__Elem__geom__base.html#a384b487459a33f9f521fb16539ec81de">valeur</a>());
<a name="l01007"></a>01007           <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> Nodes_glob;
<a name="l01008"></a>01008           Poly.<a class="code" href="classPolyedre.html#a90df3cdc5903e33421d30c2cc84dc697">remplir_Nodes_glob</a>(Nodes_glob, les_elems2);
<a name="l01009"></a>01009           <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; FacesIndex = Poly.<a class="code" href="classPolyedre.html#a809fefaee55526be8b587f7e3ed8337f">getFacesIndex</a>();
<a name="l01010"></a>01010           <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; PolyhedronIndex = Poly.<a class="code" href="classPolyedre.html#a19091e5d5d19621f9f0f6d1aacb5e4b7">getPolyhedronIndex</a>();
<a name="l01011"></a>01011           assert(ncells == PolyhedronIndex.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() - 1);
<a name="l01012"></a>01012           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ncells; i++)
<a name="l01013"></a>01013             {
<a name="l01014"></a>01014               <span class="keywordtype">int</span> size = 0;
<a name="l01015"></a>01015               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face = PolyhedronIndex(i); face &lt; PolyhedronIndex(i + 1); face++)
<a name="l01016"></a>01016                 size += FacesIndex(face + 1) - FacesIndex(face) + 1;
<a name="l01017"></a>01017               size--; <span class="comment">//!&lt; No -1 at the end of the cell</span>
<a name="l01018"></a>01018 <span class="comment"></span>              <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> cell_def(size);
<a name="l01019"></a>01019               size = 0;
<a name="l01020"></a>01020               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face = PolyhedronIndex(i); face &lt; PolyhedronIndex(i + 1); face++)
<a name="l01021"></a>01021                 {
<a name="l01022"></a>01022                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> node = FacesIndex(face); node &lt; FacesIndex(face + 1); node++)
<a name="l01023"></a>01023                     {
<a name="l01024"></a>01024                       cell_def[size] = Nodes_glob(node) - 1; <span class="comment">//!&lt; Numerotation Fortran -&gt; C++</span>
<a name="l01025"></a>01025 <span class="comment"></span>                      size++;
<a name="l01026"></a>01026                     }
<a name="l01027"></a>01027                   <span class="keywordflow">if</span> (size &lt; cell_def.size_array())
<a name="l01028"></a>01028                     {
<a name="l01029"></a>01029 <span class="comment">// Add -1 to mark the end of a face:</span>
<a name="l01030"></a>01030                       cell_def[size] = -1;
<a name="l01031"></a>01031                       size++;
<a name="l01032"></a>01032                     }
<a name="l01033"></a>01033                 }
<a name="l01034"></a>01034               mesh-&gt;insertNextCell(cell_type, cell_def.size_array(), cell_def.addr());
<a name="l01035"></a>01035             }
<a name="l01036"></a>01036         }
<a name="l01037"></a>01037       <span class="keywordflow">else</span>
<a name="l01038"></a>01038         {
<a name="l01039"></a>01039 <span class="comment">// Other cells:</span>
<a name="l01040"></a>01040           les_elems2 -= 1; <span class="comment">//!&lt; Numerotation Fortran -&gt; C++</span>
<a name="l01041"></a>01041 <span class="comment"></span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ncells; i++)
<a name="l01042"></a>01042             {
<a name="l01043"></a>01043               <span class="keywordtype">int</span> nvertices = nverts;
<a name="l01044"></a>01044               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nverts; j++)
<a name="l01045"></a>01045                 <span class="keywordflow">if</span> (les_elems2(i, j) &lt; 0)
<a name="l01046"></a>01046                   nvertices--; <span class="comment">//!&lt; Some cell type has not a constant number of vertices (eg: Polyhedron)</span>
<a name="l01047"></a>01047 <span class="comment"></span>              mesh-&gt;insertNextCell(cell_type, nvertices, les_elems2.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() + i * nverts);
<a name="l01048"></a>01048             }
<a name="l01049"></a>01049         }
<a name="l01050"></a>01050       MCAuto&lt;MEDFileUMesh&gt; file(MEDFileUMesh::New());
<a name="l01051"></a>01051       file-&gt;setName(mesh-&gt;getName()); <span class="comment">//name needed to be non empty</span>
<a name="l01052"></a>01052       file-&gt;setCoords(mesh-&gt;getCoords());
<a name="l01053"></a>01053       file-&gt;setMeshAtLevel(0, mesh, <span class="keyword">false</span>);
<a name="l01054"></a>01054 <span class="comment">// Check and store the mesh</span>
<a name="l01055"></a>01055 <span class="preprocessor">#ifndef NDEBUG</span>
<a name="l01056"></a>01056 <span class="preprocessor"></span>      mesh-&gt;checkConsistency();
<a name="l01057"></a>01057 <span class="preprocessor">#endif</span>
<a name="l01058"></a>01058 <span class="preprocessor"></span>      dom.setUMesh(mesh);
<a name="l01059"></a>01059 
<a name="l01060"></a>01060 <span class="comment">// Family for the cells:</span>
<a name="l01061"></a>01061       <span class="keywordtype">int</span> global_family_id = -1000;
<a name="l01062"></a>01062       MCAuto&lt;DataArrayInt&gt; famArr(DataArrayInt::New());
<a name="l01063"></a>01063       famArr-&gt;alloc(ncells);
<a name="l01064"></a>01064       famArr-&gt;fillWithValue(global_family_id);
<a name="l01065"></a>01065       file-&gt;setFamilyFieldArr(0, famArr);
<a name="l01066"></a>01066 <span class="comment">// Name the family and check unicity:</span>
<a name="l01067"></a>01067       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> family_name = noms_bords.<a class="code" href="classNoms.html#abfb5d6c835f10f136fffb8c30c4fc2b5">search</a>(zone.<a class="code" href="classZone.html#aad29ea7a38564404cc0417383233aaf0" title="Renvoie le nom de la zone.">le_nom</a>()) != -1 ? <span class="stringliteral">&quot;cpy_&quot;</span> : <span class="stringliteral">&quot;&quot;</span>;
<a name="l01068"></a>01068       family_name += zone.<a class="code" href="classZone.html#aad29ea7a38564404cc0417383233aaf0" title="Renvoie le nom de la zone.">le_nom</a>();
<a name="l01069"></a>01069       file-&gt;addFamily(family_name.<a class="code" href="classNom.html#a855d8cd96b5c73c2aa55cb7c0a870640">getString</a>(), global_family_id);
<a name="l01070"></a>01070 
<a name="l01071"></a>01071 <span class="comment">// Faces:</span>
<a name="l01072"></a>01072       <span class="keywordtype">int</span> nfaces;
<a name="l01073"></a>01073       MCAuto&lt;DataArrayInt&gt; renum_boundary_cell(DataArrayInt::New());
<a name="l01074"></a>01074 <span class="comment">// If the domain is discretized, we can create a faces mesh, else only a boundary mesh</span>
<a name="l01075"></a>01075       <span class="keywordflow">if</span> (zone_dis_base.non_nul())
<a name="l01076"></a>01076         {
<a name="l01077"></a>01077 <span class="comment">// Faces mesh:</span>
<a name="l01078"></a>01078           dom.buildUFacesMesh(zone_dis_base);
<a name="l01079"></a>01079           MCAuto&lt;MEDCouplingUMesh&gt;&amp; faces_mesh = dom.getUFacesMesh();
<a name="l01080"></a>01080           faces_mesh-&gt;setCoords(mesh-&gt;getCoords());
<a name="l01081"></a>01081           faces_mesh-&gt;setName(mesh-&gt;getName());
<a name="l01082"></a>01082           renum_boundary_cell = faces_mesh-&gt;sortCellsInMEDFileFrmt();
<a name="l01083"></a>01083           file-&gt;setMeshAtLevel(-1, faces_mesh, <span class="keyword">false</span>);
<a name="l01084"></a>01084           nfaces = faces_mesh-&gt;getNumberOfCells();
<a name="l01085"></a>01085         }
<a name="l01086"></a>01086       <span class="keywordflow">else</span>
<a name="l01087"></a>01087         {
<a name="l01088"></a>01088 <span class="comment">// Boundary mesh:</span>
<a name="l01089"></a>01089           MCAuto&lt;MEDCouplingUMesh&gt; boundary_mesh(MEDCouplingUMesh::New(mesh-&gt;getName(), mesh_dimension - 1));
<a name="l01090"></a>01090           boundary_mesh-&gt;setCoords(mesh-&gt;getCoords());
<a name="l01091"></a>01091           nfaces = 0;
<a name="l01092"></a>01092           <span class="keywordtype">int</span> nb_type_face = familles.size();
<a name="l01093"></a>01093           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_type_face; j++)
<a name="l01094"></a>01094             nfaces += familles(j).<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l01095"></a>01095           boundary_mesh-&gt;allocateCells(nfaces);
<a name="l01096"></a>01096           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_type_face; j++)
<a name="l01097"></a>01097             {
<a name="l01098"></a>01098               <span class="keywordtype">int</span> size = familles(j).<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l01099"></a>01099               <span class="keywordflow">if</span> (size)
<a name="l01100"></a>01100                 {
<a name="l01101"></a>01101 <span class="comment">// Converting trio to medcoupling boundary cell:</span>
<a name="l01102"></a>01102                   <span class="keywordtype">int</span> boundary_mesh_dimension = -1;
<a name="l01103"></a>01103                   INTERP_KERNEL::NormalizedCellType type_boundary_cell = type_geo_trio_to_type_medcoupling(type_face[j],
<a name="l01104"></a>01104                                                                                                            boundary_mesh_dimension);
<a name="l01105"></a>01105                   assert(boundary_mesh_dimension == mesh_dimension - 1);
<a name="l01106"></a>01106                   nverts = all_faces_bord[j].<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l01107"></a>01107                   all_faces_bord[j] -= 1; <span class="comment">//!&lt; Numerotation Fortran -&gt; C++</span>
<a name="l01108"></a>01108 <span class="comment"></span>                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++)
<a name="l01109"></a>01109                     {
<a name="l01110"></a>01110                       <span class="keywordtype">int</span> nvertices = nverts;
<a name="l01111"></a>01111                       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nverts; k++)
<a name="l01112"></a>01112                         <span class="keywordflow">if</span> (all_faces_bord[j].addr()[i * nverts + k] &lt; 0)
<a name="l01113"></a>01113                           nvertices--; <span class="comment">//!&lt; Some face type has not a constant number of vertices (eg: Polygon)</span>
<a name="l01114"></a>01114 <span class="comment"></span>                      boundary_mesh-&gt;insertNextCell(type_boundary_cell, nvertices, all_faces_bord[j].addr() + i * nverts);
<a name="l01115"></a>01115                     }
<a name="l01116"></a>01116                 }
<a name="l01117"></a>01117             }
<a name="l01118"></a>01118           renum_boundary_cell = boundary_mesh-&gt;sortCellsInMEDFileFrmt();
<a name="l01119"></a>01119           file-&gt;setMeshAtLevel(-1, boundary_mesh, <span class="keyword">false</span>);
<a name="l01120"></a>01120         }
<a name="l01121"></a>01121 
<a name="l01122"></a>01122       <span class="keywordtype">bool</span> use_group_instead_of_family = <span class="keyword">false</span>;
<a name="l01123"></a>01123       <span class="keywordflow">if</span> (use_group_instead_of_family)
<a name="l01124"></a>01124         {
<a name="l01125"></a>01125 <span class="comment">// (ToDo try to hide family notion for MEDCoupling and use group instead)</span>
<a name="l01126"></a>01126         }
<a name="l01127"></a>01127       <span class="keywordflow">else</span>
<a name="l01128"></a>01128         {
<a name="l01129"></a>01129 <span class="comment">// Family (with possible renum of the boundary cells)</span>
<a name="l01130"></a>01130           MCAuto&lt;DataArrayInt&gt; family_array(DataArrayInt::New());
<a name="l01131"></a>01131           family_array-&gt;alloc(nfaces);
<a name="l01132"></a>01132           <span class="keywordtype">int</span> nb_type_face = familles.size();
<a name="l01133"></a>01133           <span class="keywordtype">int</span> face = 0;
<a name="l01134"></a>01134           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_type_face; j++)
<a name="l01135"></a>01135             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; familles[j].<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>(); i++)
<a name="l01136"></a>01136               {
<a name="l01137"></a>01137                 <span class="keywordtype">int</span> family_id = familles[j](i);
<a name="l01138"></a>01138                 family_array-&gt;setIJ(renum_boundary_cell-&gt;getIJ(face, 0), 0, family_id);
<a name="l01139"></a>01139                 face++;
<a name="l01140"></a>01140               }
<a name="l01141"></a>01141 <span class="comment">// Faces internes (faimily_id=0):</span>
<a name="l01142"></a>01142           <span class="keywordflow">for</span> (; face&lt;nfaces; face++)
<a name="l01143"></a>01143             family_array-&gt;setIJ(renum_boundary_cell-&gt;getIJ(face, 0), 0, 0);
<a name="l01144"></a>01144           file-&gt;setFamilyFieldArr(-1, family_array);
<a name="l01145"></a>01145 <span class="comment">// Naming family on boundaries:</span>
<a name="l01146"></a>01146           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; noms_bords.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); i++)
<a name="l01147"></a>01147             {
<a name="l01148"></a>01148               <span class="keywordtype">int</span> family_id = -(i + 1);
<a name="l01149"></a>01149               file-&gt;addFamily(noms_bords[i].getString(), family_id);
<a name="l01150"></a>01150               std::vector&lt;std::string&gt; grps(1);
<a name="l01151"></a>01151               grps[0] = noms_bords[i].getString();
<a name="l01152"></a>01152               file-&gt;setGroupsOnFamily(noms_bords[i].getString(), grps);
<a name="l01153"></a>01153             }
<a name="l01154"></a>01154 <span class="comment">// Faces internes:</span>
<a name="l01155"></a>01155           std::string name = <span class="stringliteral">&quot;faces_internes&quot;</span>;
<a name="l01156"></a>01156           file-&gt;addFamily(name, 0);
<a name="l01157"></a>01157           std::vector&lt;std::string&gt; grps(1);
<a name="l01158"></a>01158           grps[0] = name;
<a name="l01159"></a>01159           file-&gt;setGroupsOnFamily(name, grps);
<a name="l01160"></a>01160         }
<a name="l01161"></a>01161 <span class="comment">// Write:</span>
<a name="l01162"></a>01162       <span class="keywordtype">int</span> <a class="code" href="classoption.html">option</a> = (mode == -1 ? 2 : 1); <span class="comment">/* 2: reset file. 1: append, 0: overwrite objects */</span>
<a name="l01163"></a>01163       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Writing file &quot;</span> &lt;&lt; nom_fic&lt;&lt;<span class="stringliteral">&quot; (mode=&quot;</span> &lt;&lt; mode &lt;&lt; <span class="stringliteral">&quot;) ...&quot;</span>&lt;&lt;finl;
<a name="l01164"></a>01164       file-&gt;write(nom_fic.getString(), option);
<a name="l01165"></a>01165     }
<a name="l01166"></a>01166   <span class="keywordflow">else</span>
<a name="l01167"></a>01167 <span class="preprocessor">#endif</span>
<a name="l01168"></a>01168 <span class="preprocessor"></span>    medecrgeom(nom_fic,nom_dom,dimension,sommets,type_elem,zone.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>(),les_elems2,type_face,all_faces_bord,familles,noms_bords,zone.<a class="code" href="classZone.html#aad29ea7a38564404cc0417383233aaf0" title="Renvoie le nom de la zone.">le_nom</a>(),mode, <a class="code" href="classEcrMED.html#aec076cd3b7bcd8ce8f1b1d4b6d9b9ba8">major_mode</a>);
<a name="l01169"></a>01169 <span class="comment">// Cerr&lt;&lt;&quot;Writing of the domain is ended&quot;&lt;&lt;finl;</span>
<a name="l01170"></a>01170 
<a name="l01171"></a>01171 }
<a name="l01172"></a>01172 
<a name="l01173"></a>01173 <span class="comment">// POUR LES CHAMPS</span>
<a name="l01174"></a>01174 <span class="keywordtype">void</span> affecte_nom_med(<a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a>&amp; nom_med,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; mot)
<a name="l01175"></a>01175 {
<a name="l01176"></a>01176   <span class="keywordtype">int</span> cut=0;
<a name="l01177"></a>01177   <span class="keywordtype">int</span> mm=mot.<a class="code" href="classNom.html#ae63e1d728a7586acac3935b15759eadc" title="Renvoie le nombre de caracteres de la chaine du Nom y compris le caractere zero de fin de chaine...">longueur</a>();
<a name="l01178"></a>01178   <span class="keywordflow">if</span> (nom_med.<a class="code" href="classChar__ptr.html#a932592cdd93eaefa2e121e67f1190bcc" title="Renvoie le nombre de caracteres de la chaine du Char_ptr y compris le caractere zero de fin de chaine...">longueur</a>()&lt;mm)
<a name="l01179"></a>01179     {
<a name="l01180"></a>01180       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Following name is cut &quot;</span>&lt;&lt; mot;
<a name="l01181"></a>01181       mm=nom_med.<a class="code" href="classChar__ptr.html#a932592cdd93eaefa2e121e67f1190bcc" title="Renvoie le nombre de caracteres de la chaine du Char_ptr y compris le caractere zero de fin de chaine...">longueur</a>()-1;
<a name="l01182"></a>01182       cut=1;
<a name="l01183"></a>01183     }
<a name="l01184"></a>01184   strncpy(nom_med,mot,mm);
<a name="l01185"></a>01185   nom_med[mm-1]=<span class="charliteral">&#39;\0&#39;</span>;
<a name="l01186"></a>01186   <span class="keywordflow">if</span> (cut) <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; to &quot;</span>&lt;&lt;nom_med&lt;&lt;finl;
<a name="l01187"></a>01187 
<a name="l01188"></a>01188 }
<a name="l01189"></a>01189 <span class="comment">// regarde si le champ de nom cha1 existe dans nom_fic</span>
<a name="l01190"></a>01190 <span class="comment">// sinon le cree</span>
<a name="l01191"></a>01191 <span class="keywordtype">int</span> medcreerchamp(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fic,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nomcha1_org,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_dom, <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; comp2,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; unit2,<span class="keywordtype">int</span> nbcomp,<a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>&amp; nbofcstp, <span class="keywordtype">bool</span> major_mode)
<a name="l01192"></a>01192 {
<a name="l01193"></a>01193   <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> med_taille_nom;
<a name="l01194"></a>01194   <a class="code" href="LireMED_8cpp.html#a5fb8877635c9569522f3e6fac236559c">dimensionne_char_ptr_taille</a>(med_taille_nom,MED_NAME_SIZE);
<a name="l01195"></a>01195   <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> nomcha1(med_taille_nom);
<a name="l01196"></a>01196   affecte_nom_med(nomcha1,nomcha1_org);
<a name="l01197"></a>01197   <a class="code" href="med__nul_8h.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid = trustMEDfileOpen(nom_fic,MED_ACC_RDEXT, major_mode);
<a name="l01198"></a>01198 
<a name="l01199"></a>01199   <span class="keywordtype">int</span> ret=0;
<a name="l01200"></a>01200 <span class="comment">// on regarde si le champ existe</span>
<a name="l01201"></a>01201   <span class="keywordtype">int</span> nbch=MEDnField(fid);
<a name="l01202"></a>01202   <span class="keywordflow">if</span> (nbch&lt;0)
<a name="l01203"></a>01203     {
<a name="l01204"></a>01204       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Error when reading the number of fields&quot;</span>&lt;&lt;finl;
<a name="l01205"></a>01205       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01206"></a>01206     }
<a name="l01207"></a>01207   <span class="keywordtype">int</span> trouve=0;
<a name="l01208"></a>01208   <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> nomcha(med_taille_nom);
<a name="l01209"></a>01209 
<a name="l01210"></a>01210   <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> comp, unit;
<a name="l01211"></a>01211   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch=0; ch&lt;nbch; ch++)
<a name="l01212"></a>01212     {
<a name="l01213"></a>01213 <span class="comment">// printf(&quot;\nChamp numero : %d \n&quot;,i+1);</span>
<a name="l01214"></a>01214       <span class="keywordtype">int</span> ncomp=0;
<a name="l01215"></a>01215       <span class="comment">/* combien de composantes */</span>
<a name="l01216"></a>01216       <span class="keywordflow">if</span> (ret == 0)
<a name="l01217"></a>01217         <span class="keywordflow">if</span> ((ncomp = MEDfieldnComponent(fid,ch+1)) &lt; 0)
<a name="l01218"></a>01218           ret = -1;
<a name="l01219"></a>01219 <span class="comment">// printf(&quot;%d\n&quot;,ret);</span>
<a name="l01220"></a>01220 
<a name="l01221"></a>01221 
<a name="l01222"></a>01222       <span class="comment">/* allocation memoire de comp et unit*/</span>
<a name="l01223"></a>01223       <span class="keywordflow">if</span> (ret == 0)
<a name="l01224"></a>01224         {
<a name="l01225"></a>01225 
<a name="l01226"></a>01226           <a class="code" href="LireMED_8cpp.html#a5fb8877635c9569522f3e6fac236559c">dimensionne_char_ptr_taille</a>(comp,MED_SNAME_SIZE,ncomp);
<a name="l01227"></a>01227           <a class="code" href="LireMED_8cpp.html#a5fb8877635c9569522f3e6fac236559c">dimensionne_char_ptr_taille</a>(unit,MED_SNAME_SIZE,ncomp);
<a name="l01228"></a>01228 
<a name="l01229"></a>01229           <span class="comment">/* infos sur les champs */</span>
<a name="l01230"></a>01230           <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> meshname;
<a name="l01231"></a>01231           <a class="code" href="LireMED_8cpp.html#a5fb8877635c9569522f3e6fac236559c">dimensionne_char_ptr_taille</a>(meshname,MED_NAME_SIZE);
<a name="l01232"></a>01232           <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> dtunit;
<a name="l01233"></a>01233           <a class="code" href="LireMED_8cpp.html#a5fb8877635c9569522f3e6fac236559c">dimensionne_char_ptr_taille</a>(dtunit,MED_SNAME_SIZE);
<a name="l01234"></a>01234           med_bool localmesh;
<a name="l01235"></a>01235           med_field_type fieldtype;
<a name="l01236"></a>01236 <span class="comment">// med_int nbofcstp;</span>
<a name="l01237"></a>01237           ret=MEDfieldInfo(fid,ch+1,nomcha,meshname,&amp;localmesh,&amp;fieldtype,comp,unit,dtunit,&amp;nbofcstp);
<a name="l01238"></a>01238 <span class="comment">// printf(&quot;Nom du champ : %s de type %d\n&quot;,nomcha,typcha);</span>
<a name="l01239"></a>01239 <span class="comment">// printf(&quot;Nom des composantes : %s\n&quot;,comp);</span>
<a name="l01240"></a>01240 <span class="comment">// printf(&quot;Unites des composantes : %s \n&quot;,unit);</span>
<a name="l01241"></a>01241           <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> Nnomcha(nomcha);
<a name="l01242"></a>01242           <span class="keywordflow">if</span> ((trouve==0)&amp;&amp;(nomcha1==Nnomcha))
<a name="l01243"></a>01243             {
<a name="l01244"></a>01244               trouve=1;
<a name="l01245"></a>01245               assert(ncomp==nbcomp);
<a name="l01246"></a>01246               <span class="keywordflow">if</span> ((meshname!=nom_dom))
<a name="l01247"></a>01247 
<a name="l01248"></a>01248                 {
<a name="l01249"></a>01249                   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt; nomcha1&lt;&lt;<span class="stringliteral">&quot; is alrady on &quot;</span>&lt;&lt;meshname&lt;&lt;<span class="stringliteral">&quot;. You can&#39;t add this field on &quot;</span>&lt;&lt;nom_dom&lt;&lt;finl;
<a name="l01250"></a>01250                   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01251"></a>01251                 }
<a name="l01252"></a>01252 <span class="comment">// Cerr&lt;&lt;&quot;This field is already in hand&quot;&lt;&lt;finl;</span>
<a name="l01253"></a>01253               <span class="keywordflow">break</span>;
<a name="l01254"></a>01254             }
<a name="l01255"></a>01255         }
<a name="l01256"></a>01256     }
<a name="l01257"></a>01257   <span class="keywordflow">if</span> (trouve==0)
<a name="l01258"></a>01258     {
<a name="l01259"></a>01259 <span class="comment">// il n existe pas on le cree</span>
<a name="l01260"></a>01260 <span class="comment">// Cerr&lt;&lt;&quot;creation of the field &quot;&lt;&lt;nomcha1&lt;&lt;finl;</span>
<a name="l01261"></a>01261       <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> dtunit;
<a name="l01262"></a>01262       <a class="code" href="LireMED_8cpp.html#a5fb8877635c9569522f3e6fac236559c">dimensionne_char_ptr_taille</a>(dtunit,MED_SNAME_SIZE);
<a name="l01263"></a>01263       strcpy(dtunit,<span class="stringliteral">&quot;s&quot;</span>);
<a name="l01264"></a>01264       ret=MEDfieldCr(fid,nomcha1,MED_FLOAT64,nbcomp,comp2,unit2,dtunit,nom_dom);
<a name="l01265"></a>01265       nbofcstp=0;
<a name="l01266"></a>01266     }
<a name="l01267"></a>01267   MEDfileClose(fid);
<a name="l01268"></a>01268   <span class="keywordflow">return</span> ret;
<a name="l01269"></a>01269 }
<a name="l01270"></a>01270 
<a name="l01271"></a>01271 <span class="comment">// ecrit les valeurs dans le champ precedemment declare</span>
<a name="l01272"></a>01272 <span class="keywordtype">int</span> medecrchamp(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fic,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_dom,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nomcha1,<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type_elem,<span class="keywordtype">double</span> dt,<span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>,<a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>&amp; nboft, <span class="keywordtype">bool</span> major_mode)
<a name="l01273"></a>01273 {
<a name="l01274"></a>01274   <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> med_taille_nom;
<a name="l01275"></a>01275   <a class="code" href="LireMED_8cpp.html#a5fb8877635c9569522f3e6fac236559c">dimensionne_char_ptr_taille</a>(med_taille_nom,MED_NAME_SIZE);
<a name="l01276"></a>01276   <span class="keywordtype">int</span> ret=0;
<a name="l01277"></a>01277   <span class="keywordtype">int</span> nbele=val.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l01278"></a>01278   <span class="keywordflow">if</span> (nbele==0) <span class="keywordflow">return</span> 0;
<a name="l01279"></a>01279   <a class="code" href="med__nul_8h.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid = trustMEDfileOpen(nom_fic,MED_ACC_RDEXT, major_mode);
<a name="l01280"></a>01280 
<a name="l01281"></a>01281 <span class="comment">// MED_CELL si CHAMPMAILLE</span>
<a name="l01282"></a>01282 <span class="comment">// MED_NODE si CHAMPNOEUD</span>
<a name="l01283"></a>01283 <span class="comment">// comme les bords si CHAMPFACE</span>
<a name="l01284"></a>01284   med_entity_type type_ent;
<a name="l01285"></a>01285   type_ent=MED_CELL;
<a name="l01286"></a>01286   <span class="keywordflow">if</span> (type==<span class="stringliteral">&quot;CHAMPPOINT&quot;</span>)
<a name="l01287"></a>01287     {
<a name="l01288"></a>01288       type_ent=MED_NODE;
<a name="l01289"></a>01289     }
<a name="l01290"></a>01290   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type==<span class="stringliteral">&quot;CHAMPFACE&quot;</span>)
<a name="l01291"></a>01291     {
<a name="l01292"></a>01292 
<a name="l01293"></a>01293 <span class="preprocessor">#ifdef POURSATURNE</span>
<a name="l01294"></a>01294 <span class="preprocessor"></span>      type_ent=MED_CELL;
<a name="l01295"></a>01295 <span class="preprocessor">#else</span>
<a name="l01296"></a>01296 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2)
<a name="l01297"></a>01297         type_ent=<a class="code" href="med__nul_8h.html#ab8d5af112dbaeca64aa1d1965030ff08ace31cb42b6f0ecacdafc847f04f89cce">MED_ARETE</a>;
<a name="l01298"></a>01298       <span class="keywordflow">else</span>
<a name="l01299"></a>01299         type_ent=<a class="code" href="med__nul_8h.html#ab8d5af112dbaeca64aa1d1965030ff08ab0641799ff99918e8e95edca23114f83">MED_FACE</a>;
<a name="l01300"></a>01300 <span class="preprocessor">#endif</span>
<a name="l01301"></a>01301 <span class="preprocessor"></span>    }
<a name="l01302"></a>01302   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type!=<span class="stringliteral">&quot;CHAMPMAILLE&quot;</span>)
<a name="l01303"></a>01303     {
<a name="l01304"></a>01304       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;type&lt;&lt;<span class="stringliteral">&quot;to check&quot;</span>&lt;&lt;finl;
<a name="l01305"></a>01305       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01306"></a>01306     }
<a name="l01307"></a>01307 
<a name="l01308"></a>01308 <span class="comment">// </span>
<a name="l01309"></a>01309   <span class="keywordtype">int</span> nn=nboft;
<a name="l01310"></a>01310 <span class="comment">// Cerr&lt;&lt;nn &lt;&lt;&quot; Pas de temps Champ&quot;&lt;&lt;nomcha1&lt;&lt;finl;</span>
<a name="l01311"></a>01311   <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> nom_dom_med(med_taille_nom);
<a name="l01312"></a>01312   strcpy(nom_dom_med,nom_dom);
<a name="l01313"></a>01313 
<a name="l01314"></a>01314   <a class="code" href="classChar__ptr.html" title="class Char_ptr Une chaine de caractere pour nommer les objets de TRUST NOM_H">Char_ptr</a> nom_chp_med(med_taille_nom);
<a name="l01315"></a>01315   affecte_nom_med(nom_chp_med,nomcha1);
<a name="l01316"></a>01316   ret+=MEDfieldValueWr(fid,nom_chp_med,nn,MED_NO_IT,dt,type_ent,type_geo_trio_to_type_med(type_elem),<a class="code" href="med__nul_8h.html#a0ac861d71fe5e0be056a86f9212f1c6aa9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, MED_ALL_CONSTITUENT,nbele,(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) val.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>());
<a name="l01317"></a>01317 
<a name="l01318"></a>01318   MEDfileClose(fid);
<a name="l01319"></a>01319   <span class="keywordflow">return</span> ret;
<a name="l01320"></a>01320 }
<a name="l01321"></a>01321 
<a name="l01322"></a>01322 
<a name="l01323"></a>01323 
<a name="l01324"></a>01324 <span class="comment">// permet d&#39;ecrire le tableau de valeurs val comme un champ dans le</span>
<a name="l01325"></a>01325 <span class="comment">// fichier med de nom nom_fic, avec pour support le domaine de nom nom_dom.</span>
<a name="l01326"></a>01326 <span class="comment">// type: CHAMPPOINT,CHAMPMAILLE,CHAMPFACES</span>
<a name="l01327"></a>01327 <span class="comment">// nom_cha1 le nom du champ</span>
<a name="l01328"></a>01328 <span class="comment">// unite : les unites</span>
<a name="l01329"></a>01329 <span class="comment">// type_elem le type des elems du domaine</span>
<a name="l01330"></a>01330 <span class="comment">// time le temps</span>
<a name="l01331"></a>01331 <span class="comment">// compteur le numero du pas de temps (ne sert pas pour l&#39;instant)</span>
<a name="l01332"></a>01332 <span class="comment">// ToDo: suppress compteur variable (set to 1 and NEVER used !)</span>
<a name="l01333"></a>01333 <span class="keywordtype">void</span> <a class="code" href="classEcrMED.html#a5b6ac4eaa96b854f8e47d85395607616">EcrMED::ecrire_champ</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type, <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fic, <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom, <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_cha1, <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val, <span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; unite,
<a name="l01334"></a>01334                           <span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; noms_compo, <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type_elem, <span class="keywordtype">double</span> time, <span class="keywordtype">int</span> compteur)
<a name="l01335"></a>01335 {
<a name="l01336"></a>01336   <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_dom = dom.<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>();
<a name="l01337"></a>01337 <span class="preprocessor">#ifdef MEDCOUPLING_</span>
<a name="l01338"></a>01338 <span class="preprocessor"></span><span class="comment">// MED Coupling</span>
<a name="l01339"></a>01339   <span class="keywordflow">if</span> (<a class="code" href="classEcrMED.html#ab0b2ba995b9f765e3196ff6727b30a3c">use_medcoupling_</a>)
<a name="l01340"></a>01340     {
<a name="l01341"></a>01341 <span class="comment">// Create MEDCouplingField</span>
<a name="l01342"></a>01342       MEDCoupling::TypeOfField field_type;
<a name="l01343"></a>01343       <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;CHAMPMAILLE&quot;</span>)
<a name="l01344"></a>01344         field_type = MEDCoupling::ON_CELLS;
<a name="l01345"></a>01345       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;CHAMPPOINT&quot;</span>)
<a name="l01346"></a>01346         field_type = MEDCoupling::ON_NODES;
<a name="l01347"></a>01347       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;CHAMPFACES&quot;</span>)
<a name="l01348"></a>01348         field_type = MEDCoupling::ON_CELLS;
<a name="l01349"></a>01349       <span class="keywordflow">else</span>
<a name="l01350"></a>01350         {
<a name="l01351"></a>01351           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Field type &quot;</span> &lt;&lt; type &lt;&lt; <span class="stringliteral">&quot; is not supported yet.&quot;</span> &lt;&lt; finl;
<a name="l01352"></a>01352           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01353"></a>01353           <span class="keywordflow">return</span>;
<a name="l01354"></a>01354         }
<a name="l01355"></a>01355       std::string file_name = nom_fic.<a class="code" href="classNom.html#a855d8cd96b5c73c2aa55cb7c0a870640">getString</a>();
<a name="l01356"></a>01356       std::string field_name = nom_cha1.<a class="code" href="classNom.html#a855d8cd96b5c73c2aa55cb7c0a870640">getString</a>();
<a name="l01357"></a>01357 <span class="comment">// Get the previous timestep:</span>
<a name="l01358"></a>01358       <span class="keywordtype">int</span> timestep = 0;
<a name="l01359"></a>01359       std::vector&lt; std::string &gt; field_names = GetAllFieldNames(file_name);
<a name="l01360"></a>01360       <span class="keywordflow">if</span> ( std::find(field_names.begin(), field_names.end(), field_name) != field_names.end() )
<a name="l01361"></a>01361         {
<a name="l01362"></a>01362           std::vector&lt; std::pair&lt; std::pair&lt; int, int &gt;, <span class="keywordtype">double</span> &gt; &gt; ts = GetAllFieldIterations(file_name, field_name);
<a name="l01363"></a>01363           timestep = ts[ts.size()-1].first.first + 1;
<a name="l01364"></a>01364         }
<a name="l01365"></a>01365       MCAuto&lt;MEDCouplingFieldDouble&gt; field(MEDCouplingFieldDouble::New(field_type, MEDCoupling::ONE_TIME));
<a name="l01366"></a>01366       field-&gt;setName(field_name);
<a name="l01367"></a>01367       field-&gt;setTime(time, timestep, -1);
<a name="l01368"></a>01368       field-&gt;setTimeUnit(<span class="stringliteral">&quot;s&quot;</span>);
<a name="l01369"></a>01369 
<a name="l01370"></a>01370 <span class="comment">// Try to get directly the mesh from the domain:</span>
<a name="l01371"></a>01371       <span class="keywordflow">if</span> (dom.getUMesh() != NULL)
<a name="l01372"></a>01372         {
<a name="l01373"></a>01373           <span class="keywordflow">if</span> (type == <span class="stringliteral">&quot;CHAMPFACES&quot;</span>)
<a name="l01374"></a>01374             field-&gt;setMesh(dom.getUFacesMesh());
<a name="l01375"></a>01375           <span class="keywordflow">else</span>
<a name="l01376"></a>01376             field-&gt;setMesh(dom.getUMesh());
<a name="l01377"></a>01377         }
<a name="l01378"></a>01378       <span class="keywordflow">else</span>
<a name="l01379"></a>01379         {
<a name="l01380"></a>01380 <span class="comment">// Get mesh from the file (less optimal but sometime necessary: eg: call from latatoother::interpreter())</span>
<a name="l01381"></a>01381 <span class="comment">// const MCAuto&lt;MEDFileUMesh&gt; file_mesh(MEDFileUMesh::New(file_name));</span>
<a name="l01382"></a>01382 <span class="comment">// const MCAuto&lt;MEDCouplingUMesh&gt; umesh = file_mesh-&gt;getMeshAtLevel(0);</span>
<a name="l01383"></a>01383           std::string mesh_name = nom_dom.<a class="code" href="classNom.html#a855d8cd96b5c73c2aa55cb7c0a870640">getString</a>();
<a name="l01384"></a>01384           <span class="keywordflow">if</span> (nom_dom!=<span class="stringliteral">&quot;PARTICULES&quot;</span>)
<a name="l01385"></a>01385             {
<a name="l01386"></a>01386               <span class="keyword">const</span> MCAuto&lt;MEDCouplingUMesh&gt; umesh = MEDCoupling::ReadUMeshFromFile(file_name, mesh_name, 0);
<a name="l01387"></a>01387               field-&gt;setMesh(umesh);
<a name="l01388"></a>01388             }
<a name="l01389"></a>01389           <span class="keywordflow">else</span>
<a name="l01390"></a>01390             {
<a name="l01391"></a>01391               MEDCoupling::CheckFileForRead(file_name);
<a name="l01392"></a>01392               MCAuto&lt;MEDFileMesh&gt; mm(MEDFileMesh::New(file_name,mesh_name));
<a name="l01393"></a>01393               MEDFileMesh *mmPtr(mm);
<a name="l01394"></a>01394               MEDFileUMesh *mmuPtr=<span class="keyword">dynamic_cast&lt;</span>MEDFileUMesh *<span class="keyword">&gt;</span>(mmPtr);
<a name="l01395"></a>01395               <span class="keywordflow">if</span>(!mmuPtr)
<a name="l01396"></a>01396                 {
<a name="l01397"></a>01397                   std::ostringstream oss;
<a name="l01398"></a>01398                   oss &lt;&lt; <span class="stringliteral">&quot;ReadUMeshFromFile : With fileName=\&quot;&quot;</span>&lt;&lt; file_name &lt;&lt; <span class="stringliteral">&quot;\&quot;, meshName=\&quot;&quot;</span>&lt;&lt; mesh_name &lt;&lt; <span class="stringliteral">&quot;\&quot; exists but it is not an unstructured mesh !&quot;</span>;
<a name="l01399"></a>01399                   <span class="keywordflow">throw</span> INTERP_KERNEL::Exception(oss.str().c_str());
<a name="l01400"></a>01400                 }
<a name="l01401"></a>01401 
<a name="l01402"></a>01402 <span class="comment">// const MCAuto&lt;MEDCouplingUMesh&gt; umesh_particles = file_mesh-&gt;getMeshAtLevel(1);</span>
<a name="l01403"></a>01403               <span class="keyword">const</span> MCAuto&lt;MEDCouplingUMesh&gt; umesh_particles = mmuPtr-&gt;getMeshAtLevel(1);
<a name="l01404"></a>01404               field-&gt;setMesh(umesh_particles);
<a name="l01405"></a>01405             }
<a name="l01406"></a>01406         }
<a name="l01407"></a>01407 <span class="comment">// Fill array:</span>
<a name="l01408"></a>01408       <span class="keywordtype">int</span> size = val.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l01409"></a>01409       <span class="keywordflow">if</span> (size&gt;0)
<a name="l01410"></a>01410         {
<a name="l01411"></a>01411           <span class="keywordtype">int</span> nb_comp = val.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() == 1 ? 1 : val.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l01412"></a>01412           MCAuto&lt;DataArrayDouble&gt; array(DataArrayDouble::New());
<a name="l01413"></a>01413           array-&gt;useArray(val.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <span class="keyword">false</span>, MEDCoupling::DeallocType::CPP_DEALLOC, size, nb_comp);
<a name="l01414"></a>01414 <span class="comment">// Units:</span>
<a name="l01415"></a>01415           <span class="keywordflow">if</span> (nb_comp &gt; 1) <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_comp; i++)
<a name="l01416"></a>01416               array-&gt;setInfoOnComponent(i, noms_compo[i].getString() + <span class="stringliteral">&quot;[&quot;</span> + unite[i].getString() + <span class="stringliteral">&quot;]&quot;</span>);
<a name="l01417"></a>01417           field-&gt;setArray(array);
<a name="l01418"></a>01418 <span class="comment">// Write</span>
<a name="l01419"></a>01419           MCAuto&lt;MEDFileField1TS&gt; file(MEDFileField1TS::New());
<a name="l01420"></a>01420           file-&gt;setFieldNoProfileSBT(field);
<a name="l01421"></a>01421           file-&gt;write(file_name, 0);
<a name="l01422"></a>01422         }
<a name="l01423"></a>01423     }
<a name="l01424"></a>01424   <span class="keywordflow">else</span>
<a name="l01425"></a>01425 <span class="preprocessor">#endif</span>
<a name="l01426"></a>01426 <span class="preprocessor"></span>    {
<a name="l01427"></a>01427 <span class="comment">// Deprecated:</span>
<a name="l01428"></a>01428 <span class="comment">// MED file</span>
<a name="l01429"></a>01429       <span class="keywordtype">int</span> ret = 0;
<a name="l01430"></a>01430       <span class="keywordtype">int</span> nbcomp = 1;
<a name="l01431"></a>01431       <span class="keywordflow">if</span> (val.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>() &gt; 1)
<a name="l01432"></a>01432         nbcomp = val.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l01433"></a>01433 
<a name="l01434"></a>01434 <span class="comment">// conversion de la liste de noms unite en un mot</span>
<a name="l01435"></a>01435       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> unite1 = <span class="stringliteral">&quot;&quot;</span>;
<a name="l01436"></a>01436       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn &lt; nbcomp; nn++)
<a name="l01437"></a>01437         {
<a name="l01438"></a>01438           <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> uni = unite[nn];
<a name="l01439"></a>01439           <span class="keywordtype">int</span> lutil = uni.<a class="code" href="classNom.html#ae63e1d728a7586acac3935b15759eadc" title="Renvoie le nombre de caracteres de la chaine du Nom y compris le caractere zero de fin de chaine...">longueur</a>() - 1;
<a name="l01440"></a>01440           <span class="keywordflow">if</span> (lutil &gt; MED_SNAME_SIZE)
<a name="l01441"></a>01441             {
<a name="l01442"></a>01442               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; uni &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; uni.<a class="code" href="classNom.html#ae63e1d728a7586acac3935b15759eadc" title="Renvoie le nombre de caracteres de la chaine du Nom y compris le caractere zero de fin de chaine...">longueur</a>() &lt;&lt; <span class="stringliteral">&quot; names copy has to be revised&quot;</span> &lt;&lt; finl;
<a name="l01443"></a>01443 <span class="comment">// exit();</span>
<a name="l01444"></a>01444               uni = <span class="stringliteral">&quot;???&quot;</span>;
<a name="l01445"></a>01445               lutil = uni.<a class="code" href="classNom.html#ae63e1d728a7586acac3935b15759eadc" title="Renvoie le nombre de caracteres de la chaine du Nom y compris le caractere zero de fin de chaine...">longueur</a>() - 1;
<a name="l01446"></a>01446 
<a name="l01447"></a>01447 
<a name="l01448"></a>01448             }
<a name="l01449"></a>01449           unite1 += uni;
<a name="l01450"></a>01450           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; (MED_SNAME_SIZE - lutil); c++) unite1 += <span class="stringliteral">&quot; &quot;</span>;
<a name="l01451"></a>01451         }
<a name="l01452"></a>01452       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nomcoo = <span class="stringliteral">&quot;x               &quot;</span>;
<a name="l01453"></a>01453       <span class="keywordflow">if</span> (nbcomp &gt; 1)
<a name="l01454"></a>01454         nomcoo += <span class="stringliteral">&quot;y               &quot;</span>;
<a name="l01455"></a>01455       <span class="keywordflow">if</span> (nbcomp &gt; 2)
<a name="l01456"></a>01456         nomcoo += <span class="stringliteral">&quot;z               &quot;</span>;
<a name="l01457"></a>01457 
<a name="l01458"></a>01458 <span class="comment">// cree le champ si il n&#39;existe pas</span>
<a name="l01459"></a>01459       <a class="code" href="med__nul_8h.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nbofcstp;
<a name="l01460"></a>01460       ret = medcreerchamp(nom_fic, nom_cha1, nom_dom, nomcoo, unite1, nbcomp, nbofcstp, major_mode);
<a name="l01461"></a>01461       <span class="keywordflow">if</span> (ret &lt; 0)
<a name="l01462"></a>01462         {
<a name="l01463"></a>01463           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;error field creation&quot;</span> &lt;&lt; finl;
<a name="l01464"></a>01464           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01465"></a>01465         }
<a name="l01466"></a>01466 
<a name="l01467"></a>01467 
<a name="l01468"></a>01468 <span class="comment">// ecrit le champ</span>
<a name="l01469"></a>01469       ret += medecrchamp(nom_fic, nom_dom, nom_cha1, val, type, type_elem, time, compteur, nbofcstp, major_mode);
<a name="l01470"></a>01470       <span class="keywordflow">if</span> (ret &lt; 0)
<a name="l01471"></a>01471         {
<a name="l01472"></a>01472           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error writing field&quot;</span> &lt;&lt; finl;
<a name="l01473"></a>01473           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01474"></a>01474         }
<a name="l01475"></a>01475     }
<a name="l01476"></a>01476 }
<a name="l01477"></a>01477 
<a name="l01478"></a>01478 <span class="preprocessor">#endif</span>
<a name="l01479"></a>01479 <span class="preprocessor"></span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:24 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
