<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VDF/Champs/Champ_Face4.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VDF/Champs/Champ_Face4.cpp</div>  </div>
</div>
<div class="contents">
<a href="Champ__Face4_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Champ_Face4.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VDF/Champs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/6</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Face_8h.html">Champ_Face.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VDF_8h.html">Zone_VDF.h</a>&gt;</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="comment">// Calcul du produit scalaire du tenseur des vitesses de deformation</span>
<a name="l00027"></a>00027 <span class="comment">// en coordonnees cartesiennes : calcul 2D puis 3D.</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="comment">// Traitement des elements internes</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="comment">// Cas 2D</span>
<a name="l00033"></a><a class="code" href="Champ__Face4_8cpp.html#a4adf94a7ed3aec91ebf403474c9018c8">00033</a> <span class="keywordtype">void</span> <a class="code" href="Champ__Face4_8cpp.html#a4adf94a7ed3aec91ebf403474c9018c8">calcul_dscald_interne2D</a>(<span class="keywordtype">int</span> num_elem,
<a name="l00034"></a>00034                              <span class="keywordtype">int</span> elx0,<span class="keywordtype">int</span> elx1,
<a name="l00035"></a>00035                              <span class="keywordtype">int</span> ely0,<span class="keywordtype">int</span> ely1,
<a name="l00036"></a>00036                              <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF,
<a name="l00037"></a>00037                              <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val,<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; dscald)
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00040"></a>00040   <span class="keywordtype">double</span> delta_x_0,delta_x_1,delta_y_0,delta_y_1;
<a name="l00041"></a>00041   <span class="keywordtype">double</span> delta_x,delta_y;
<a name="l00042"></a>00042   <span class="keywordtype">double</span> delta_xbis,delta_ybis;
<a name="l00043"></a>00043   <span class="keywordtype">double</span> deriv_ux,deriv_uy,deriv_vx,deriv_vy;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045   deriv_ux = 0;
<a name="l00046"></a>00046   deriv_uy = 0;
<a name="l00047"></a>00047   deriv_vx = 0;
<a name="l00048"></a>00048   deriv_vy = 0;
<a name="l00049"></a>00049 
<a name="l00050"></a>00050   delta_x_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elx0,0);
<a name="l00051"></a>00051   delta_x_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elx1,num_elem,0);
<a name="l00052"></a>00052   delta_y_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,ely0,1);
<a name="l00053"></a>00053   delta_y_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(ely1,num_elem,1);
<a name="l00054"></a>00054 
<a name="l00055"></a>00055   delta_x = (delta_x_1-delta_x_0)*(delta_x_1+delta_x_0)/(delta_x_1*delta_x_0);
<a name="l00056"></a>00056   delta_y = (delta_y_1-delta_y_0)*(delta_y_1+delta_y_0)/(delta_y_1*delta_y_0);
<a name="l00057"></a>00057 
<a name="l00058"></a>00058   delta_xbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,0);
<a name="l00059"></a>00059   delta_ybis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,1);
<a name="l00060"></a>00060 
<a name="l00061"></a>00061   deriv_vx = (delta_x_0/delta_x_1*val(elem_faces(elx1,1))
<a name="l00062"></a>00062               + delta_x*val(elem_faces(num_elem,1))
<a name="l00063"></a>00063               - delta_x_1/delta_x_0*val(elem_faces(elx0,1)));
<a name="l00064"></a>00064   deriv_vx += (delta_x_0/delta_x_1*val(elem_faces(elx1,3))
<a name="l00065"></a>00065                + delta_x*val(elem_faces(num_elem,3))
<a name="l00066"></a>00066                - delta_x_1/delta_x_0*val(elem_faces(elx0,3)));
<a name="l00067"></a>00067   deriv_vx *= 0.5/(delta_x_0 + delta_x_1);
<a name="l00068"></a>00068 
<a name="l00069"></a>00069   deriv_uy = (delta_y_0/delta_y_1*val(elem_faces(ely1,0))
<a name="l00070"></a>00070               + delta_y*val(elem_faces(num_elem,0))
<a name="l00071"></a>00071               - delta_y_1/delta_y_0*val(elem_faces(ely0,0)));
<a name="l00072"></a>00072   deriv_uy += (delta_y_0/delta_y_1*val(elem_faces(ely1,2))
<a name="l00073"></a>00073                + delta_y*val(elem_faces(num_elem,2))
<a name="l00074"></a>00074                - delta_y_1/delta_y_0*val(elem_faces(ely0,2)));
<a name="l00075"></a>00075   deriv_uy *= 0.5/(delta_y_0 + delta_y_1);
<a name="l00076"></a>00076 
<a name="l00077"></a>00077   deriv_ux = (1./delta_xbis)*(val(elem_faces(num_elem,0))-val(elem_faces(num_elem,2)));
<a name="l00078"></a>00078   deriv_vy = (1./delta_ybis)*(val(elem_faces(num_elem,1))-val(elem_faces(num_elem,3)));
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   dscald[num_elem] = 4.* (deriv_ux*deriv_ux + deriv_vy*deriv_vy)
<a name="l00081"></a>00081                      + 2.*((deriv_uy+deriv_vx)*(deriv_uy+deriv_vx));
<a name="l00082"></a>00082 }
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 <span class="comment">// Cas 3D</span>
<a name="l00085"></a><a class="code" href="Champ__Face4_8cpp.html#aa610f1b6ce940595527221dfdc6c4c39">00085</a> <span class="keywordtype">void</span> <a class="code" href="Champ__Face4_8cpp.html#aa610f1b6ce940595527221dfdc6c4c39">calcul_dscald_interne3D</a>(<span class="keywordtype">int</span> num_elem,
<a name="l00086"></a>00086                              <span class="keywordtype">int</span> elx0,<span class="keywordtype">int</span> elx1,
<a name="l00087"></a>00087                              <span class="keywordtype">int</span> ely0,<span class="keywordtype">int</span> ely1,
<a name="l00088"></a>00088                              <span class="keywordtype">int</span> elz0,<span class="keywordtype">int</span> elz1,
<a name="l00089"></a>00089                              <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF,
<a name="l00090"></a>00090                              <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val,<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; dscald)
<a name="l00091"></a>00091 {
<a name="l00092"></a>00092   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00093"></a>00093   <span class="keywordtype">double</span> delta_x_0,delta_x_1,delta_y_0,delta_y_1,delta_z_0,delta_z_1;
<a name="l00094"></a>00094   <span class="keywordtype">double</span> delta_x,delta_y,delta_z;
<a name="l00095"></a>00095   <span class="keywordtype">double</span> delta_xbis,delta_ybis,delta_zbis;
<a name="l00096"></a>00096   <span class="keywordtype">double</span> deriv_ux,deriv_uy,deriv_uz,deriv_vx,deriv_vy,deriv_vz;
<a name="l00097"></a>00097   <span class="keywordtype">double</span> deriv_wx,deriv_wy,deriv_wz;
<a name="l00098"></a>00098 
<a name="l00099"></a>00099   deriv_ux = 0;
<a name="l00100"></a>00100   deriv_uy = 0;
<a name="l00101"></a>00101   deriv_uz = 0;
<a name="l00102"></a>00102   deriv_vx = 0;
<a name="l00103"></a>00103   deriv_vy = 0;
<a name="l00104"></a>00104   deriv_vz = 0;
<a name="l00105"></a>00105   deriv_wx = 0;
<a name="l00106"></a>00106   deriv_wy = 0;
<a name="l00107"></a>00107   deriv_wz = 0;
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 
<a name="l00110"></a>00110   delta_x_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elx0,0);
<a name="l00111"></a>00111   delta_x_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elx1,num_elem,0);
<a name="l00112"></a>00112   delta_y_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,ely0,1);
<a name="l00113"></a>00113   delta_y_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(ely1,num_elem,1);
<a name="l00114"></a>00114   delta_z_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elz0,2);
<a name="l00115"></a>00115   delta_z_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elz1,num_elem,2);
<a name="l00116"></a>00116 
<a name="l00117"></a>00117   delta_x = (delta_x_1-delta_x_0)*(delta_x_1+delta_x_0)/(delta_x_1*delta_x_0);
<a name="l00118"></a>00118   delta_y = (delta_y_1-delta_y_0)*(delta_y_1+delta_y_0)/(delta_y_1*delta_y_0);
<a name="l00119"></a>00119   delta_z = (delta_z_1-delta_z_0)*(delta_z_1+delta_z_0)/(delta_z_1*delta_z_0);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 
<a name="l00122"></a>00122   delta_xbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,0);
<a name="l00123"></a>00123   delta_ybis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,1);
<a name="l00124"></a>00124   delta_zbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,2);
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 
<a name="l00127"></a>00127   deriv_vz = (delta_z_0/delta_z_1*val(elem_faces(elz1,1))
<a name="l00128"></a>00128               + delta_z*val(elem_faces(num_elem,1))
<a name="l00129"></a>00129               - delta_z_1/delta_z_0*val(elem_faces(elz0,1)));
<a name="l00130"></a>00130   deriv_vz += (delta_z_0/delta_z_1*val(elem_faces(elz1,4))
<a name="l00131"></a>00131                + delta_z*val(elem_faces(num_elem,4))
<a name="l00132"></a>00132                - delta_z_1/delta_z_0*val(elem_faces(elz0,4)));
<a name="l00133"></a>00133   deriv_vz *= 0.5/(delta_z_0 + delta_z_1);
<a name="l00134"></a>00134 
<a name="l00135"></a>00135   deriv_wy = (delta_y_0/delta_y_1*val(elem_faces(ely1,2))
<a name="l00136"></a>00136               + delta_y*val(elem_faces(num_elem,2))
<a name="l00137"></a>00137               - delta_y_1/delta_y_0*val(elem_faces(ely0,2)));
<a name="l00138"></a>00138   deriv_wy += (delta_y_0/delta_y_1*val(elem_faces(ely1,5))
<a name="l00139"></a>00139                + delta_y*val(elem_faces(num_elem,5))
<a name="l00140"></a>00140                - delta_y_1/delta_y_0*val(elem_faces(ely0,5)));
<a name="l00141"></a>00141   deriv_wy *= 0.5/(delta_y_0 + delta_y_1);
<a name="l00142"></a>00142 
<a name="l00143"></a>00143 
<a name="l00144"></a>00144   deriv_uz = (delta_z_0/delta_z_1*val(elem_faces(elz1,0))
<a name="l00145"></a>00145               + delta_z*val(elem_faces(num_elem,0))
<a name="l00146"></a>00146               - delta_z_1/delta_z_0*val(elem_faces(elz0,0)));
<a name="l00147"></a>00147   deriv_uz += (delta_z_0/delta_z_1*val(elem_faces(elz1,3))
<a name="l00148"></a>00148                + delta_z*val(elem_faces(num_elem,3))
<a name="l00149"></a>00149                - delta_z_1/delta_z_0*val(elem_faces(elz0,3)));
<a name="l00150"></a>00150   deriv_uz *= 0.5/(delta_z_0 + delta_z_1);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   deriv_wx = (delta_x_0/delta_x_1*val(elem_faces(elx1,2))
<a name="l00153"></a>00153               + delta_x*val(elem_faces(num_elem,2))
<a name="l00154"></a>00154               - delta_x_1/delta_x_0*val(elem_faces(elx0,2)));
<a name="l00155"></a>00155   deriv_wx += (delta_x_0/delta_x_1*val(elem_faces(elx1,5))
<a name="l00156"></a>00156                + delta_x*val(elem_faces(num_elem,5))
<a name="l00157"></a>00157                - delta_x_1/delta_x_0*val(elem_faces(elx0,5)));
<a name="l00158"></a>00158   deriv_wx *= 0.5/(delta_x_0 + delta_x_1);
<a name="l00159"></a>00159 
<a name="l00160"></a>00160   deriv_vx = (delta_x_0/delta_x_1*val(elem_faces(elx1,1))
<a name="l00161"></a>00161               + delta_x*val(elem_faces(num_elem,1))
<a name="l00162"></a>00162               - delta_x_1/delta_x_0*val(elem_faces(elx0,1)));
<a name="l00163"></a>00163   deriv_vx += (delta_x_0/delta_x_1*val(elem_faces(elx1,4))
<a name="l00164"></a>00164                + delta_x*val(elem_faces(num_elem,4))
<a name="l00165"></a>00165                - delta_x_1/delta_x_0*val(elem_faces(elx0,4)));
<a name="l00166"></a>00166   deriv_vx *= 0.5/(delta_x_0 + delta_x_1);
<a name="l00167"></a>00167 
<a name="l00168"></a>00168   deriv_uy = (delta_y_0/delta_y_1*val(elem_faces(ely1,0))
<a name="l00169"></a>00169               + delta_y*val(elem_faces(num_elem,0))
<a name="l00170"></a>00170               - delta_y_1/delta_y_0*val(elem_faces(ely0,0)));
<a name="l00171"></a>00171   deriv_uy += (delta_y_0/delta_y_1*val(elem_faces(ely1,3))
<a name="l00172"></a>00172                + delta_y*val(elem_faces(num_elem,3))
<a name="l00173"></a>00173                - delta_y_1/delta_y_0*val(elem_faces(ely0,3)));
<a name="l00174"></a>00174   deriv_uy *= 0.5/(delta_y_0 + delta_y_1);
<a name="l00175"></a>00175 
<a name="l00176"></a>00176   deriv_ux = (1./delta_xbis)*val(elem_faces(num_elem,3))-val(elem_faces(num_elem,0));
<a name="l00177"></a>00177   deriv_vy = (1./delta_ybis)*val(elem_faces(num_elem,4))-val(elem_faces(num_elem,1));
<a name="l00178"></a>00178   deriv_wz = (1./delta_zbis)*val(elem_faces(num_elem,5))-val(elem_faces(num_elem,2));
<a name="l00179"></a>00179 
<a name="l00180"></a>00180   dscald[num_elem] = 4.* (deriv_ux*deriv_ux + deriv_vy*deriv_vy + deriv_wz*deriv_wz)
<a name="l00181"></a>00181                      + 2.*((deriv_uy+deriv_vx)*(deriv_uy+deriv_vx)
<a name="l00182"></a>00182                            +(deriv_wx+deriv_uz)*(deriv_wx+deriv_uz)
<a name="l00183"></a>00183                            +(deriv_wy+deriv_vz)*(deriv_wy+deriv_vz));
<a name="l00184"></a>00184 }
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 <span class="comment">// Traitement des elements bord</span>
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 <span class="comment">// Cas 2D</span>
<a name="l00189"></a><a class="code" href="Champ__Face4_8cpp.html#a73e43a4313d1a82b788a6cbb52f01e30">00189</a> <span class="keywordtype">void</span> <a class="code" href="Champ__Face4_8cpp.html#a73e43a4313d1a82b788a6cbb52f01e30">calcul_dscald_bord2D</a>(<span class="keywordtype">int</span> num_elem,
<a name="l00190"></a>00190                           <span class="keywordtype">int</span> elx0,<span class="keywordtype">int</span> elx1,
<a name="l00191"></a>00191                           <span class="keywordtype">int</span> ely0,<span class="keywordtype">int</span> ely1,
<a name="l00192"></a>00192                           <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF,
<a name="l00193"></a>00193                           <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val,<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; dscald)
<a name="l00194"></a>00194 {
<a name="l00195"></a>00195   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00196"></a>00196   <span class="keywordtype">double</span> delta_x_0,delta_x_1,delta_y_0,delta_y_1;
<a name="l00197"></a>00197   <span class="keywordtype">double</span> delta_x,delta_y;
<a name="l00198"></a>00198   <span class="keywordtype">double</span> delta_xbis,delta_ybis;
<a name="l00199"></a>00199   <span class="keywordtype">double</span> deriv_ux,deriv_vx,deriv_uy,deriv_vy;
<a name="l00200"></a>00200 
<a name="l00201"></a>00201   deriv_ux = 0;
<a name="l00202"></a>00202   deriv_vx = 0;
<a name="l00203"></a>00203   deriv_uy = 0;
<a name="l00204"></a>00204   deriv_vy = 0;
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 <span class="comment">// Traitement des elements bord</span>
<a name="l00207"></a>00207   <span class="keywordflow">if</span> ( (elx0 == -1) || (elx1 == -1) )
<a name="l00208"></a>00208     {
<a name="l00209"></a>00209       <span class="keywordflow">if</span> (elx0 == -1)
<a name="l00210"></a>00210         {
<a name="l00211"></a>00211           <span class="keywordflow">if</span> (elx1 != -1)
<a name="l00212"></a>00212             {
<a name="l00213"></a>00213               delta_x_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elx1,num_elem,0);
<a name="l00214"></a>00214               delta_xbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,0);
<a name="l00215"></a>00215 
<a name="l00216"></a>00216               deriv_vx = (val(elem_faces(elx1,1))-val(elem_faces(num_elem,1))
<a name="l00217"></a>00217                           + val(elem_faces(elx1,3))-val(elem_faces(num_elem,3)));
<a name="l00218"></a>00218               deriv_vx *= 0.5/delta_x_1;
<a name="l00219"></a>00219               deriv_ux = (val(elem_faces(num_elem,2))-val(elem_faces(num_elem,0)));
<a name="l00220"></a>00220               deriv_ux *= (1./delta_xbis);
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 
<a name="l00223"></a>00223             }
<a name="l00224"></a>00224           <span class="keywordflow">else</span>
<a name="l00225"></a>00225             {
<a name="l00226"></a>00226               deriv_ux = 0;
<a name="l00227"></a>00227               deriv_vx = 0;
<a name="l00228"></a>00228             }
<a name="l00229"></a>00229         }
<a name="l00230"></a>00230       <span class="keywordflow">else</span> <span class="comment">//!&lt; elx1 = -1 et elx0 != -1</span>
<a name="l00231"></a>00231 <span class="comment"></span>        {
<a name="l00232"></a>00232           delta_x_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elx0,0);
<a name="l00233"></a>00233           delta_xbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,0);
<a name="l00234"></a>00234 
<a name="l00235"></a>00235           deriv_vx = (val(elem_faces(num_elem,1))-val(elem_faces(elx0,1))
<a name="l00236"></a>00236                       + val(elem_faces(num_elem,3))-val(elem_faces(elx0,3)));
<a name="l00237"></a>00237           deriv_vx *= 0.5/delta_x_0;
<a name="l00238"></a>00238           deriv_ux = (val(elem_faces(num_elem,2))-val(elem_faces(num_elem,0)));
<a name="l00239"></a>00239           deriv_ux *= (1./delta_xbis);
<a name="l00240"></a>00240         }
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242   <span class="keywordflow">else</span> <span class="comment">//!&lt; elx0 != -1 et elx1 != -1</span>
<a name="l00243"></a>00243 <span class="comment"></span>    {
<a name="l00244"></a>00244       delta_x_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elx0,0);
<a name="l00245"></a>00245       delta_x_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elx1,num_elem,0);
<a name="l00246"></a>00246       delta_x = (delta_x_1-delta_x_0)*(delta_x_1+delta_x_0)/(delta_x_1*delta_x_0);
<a name="l00247"></a>00247       delta_xbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,0);
<a name="l00248"></a>00248 
<a name="l00249"></a>00249       deriv_vx = (delta_x_0/delta_x_1*val(elem_faces(elx1,1))
<a name="l00250"></a>00250                   + delta_x*val(elem_faces(num_elem,1))
<a name="l00251"></a>00251                   - delta_x_1/delta_x_0*val(elem_faces(elx0,1)));
<a name="l00252"></a>00252       deriv_vx += (delta_x_0/delta_x_1*val(elem_faces(elx1,3))
<a name="l00253"></a>00253                    + delta_x*val(elem_faces(num_elem,3))
<a name="l00254"></a>00254                    - delta_x_1/delta_x_0*val(elem_faces(elx0,3)));
<a name="l00255"></a>00255       deriv_vx *= 0.5/(delta_x_0 + delta_x_1);
<a name="l00256"></a>00256       deriv_ux = (val(elem_faces(num_elem,2))-val(elem_faces(num_elem,0)));
<a name="l00257"></a>00257       deriv_ux *= (1./delta_xbis);
<a name="l00258"></a>00258 
<a name="l00259"></a>00259     }
<a name="l00260"></a>00260 
<a name="l00261"></a>00261   <span class="keywordflow">if</span> ( (ely0 == -1) || (ely1 == -1) )
<a name="l00262"></a>00262     {
<a name="l00263"></a>00263       <span class="keywordflow">if</span> (ely0 == -1)
<a name="l00264"></a>00264         {
<a name="l00265"></a>00265           <span class="keywordflow">if</span> (ely1 != -1)
<a name="l00266"></a>00266             {
<a name="l00267"></a>00267               delta_y_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(ely1,num_elem,1);
<a name="l00268"></a>00268               delta_ybis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,1);
<a name="l00269"></a>00269 
<a name="l00270"></a>00270               deriv_uy = (val(elem_faces(ely1,0))-val(elem_faces(num_elem,0))
<a name="l00271"></a>00271                           + val(elem_faces(ely1,2))-val(elem_faces(num_elem,2)));
<a name="l00272"></a>00272               deriv_uy *= 0.5/delta_y_1;
<a name="l00273"></a>00273               deriv_vy = (val(elem_faces(num_elem,3))-val(elem_faces(num_elem,1)));
<a name="l00274"></a>00274               deriv_vy *= (1./delta_ybis);
<a name="l00275"></a>00275 
<a name="l00276"></a>00276             }
<a name="l00277"></a>00277           <span class="keywordflow">else</span>
<a name="l00278"></a>00278             {
<a name="l00279"></a>00279               deriv_uy = 0;
<a name="l00280"></a>00280               deriv_vy = 0;
<a name="l00281"></a>00281             }
<a name="l00282"></a>00282         }
<a name="l00283"></a>00283       <span class="keywordflow">else</span> <span class="comment">//!&lt; ely1 = -1 et ely0 != -1</span>
<a name="l00284"></a>00284 <span class="comment"></span>        {
<a name="l00285"></a>00285           delta_y_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,ely0,1);
<a name="l00286"></a>00286           delta_ybis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,1);
<a name="l00287"></a>00287 
<a name="l00288"></a>00288           deriv_uy = (val(elem_faces(num_elem,0))-val(elem_faces(ely0,0))
<a name="l00289"></a>00289                       + val(elem_faces(num_elem,2))-val(elem_faces(ely0,2)));
<a name="l00290"></a>00290           deriv_uy *= 0.5/delta_y_0;
<a name="l00291"></a>00291           deriv_vy = (val(elem_faces(num_elem,3))-val(elem_faces(num_elem,1)));
<a name="l00292"></a>00292           deriv_vy *= (1./delta_ybis);
<a name="l00293"></a>00293         }
<a name="l00294"></a>00294     }
<a name="l00295"></a>00295   <span class="keywordflow">else</span>  <span class="comment">//!&lt; ely0 != -1 et ely1 != -1</span>
<a name="l00296"></a>00296 <span class="comment"></span>    {
<a name="l00297"></a>00297       delta_y_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,ely0,1);
<a name="l00298"></a>00298       delta_y_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(ely1,num_elem,1);
<a name="l00299"></a>00299       delta_y = (delta_y_1-delta_y_0)*(delta_y_1+delta_y_0)/(delta_y_1*delta_y_0);
<a name="l00300"></a>00300       delta_ybis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,1);
<a name="l00301"></a>00301 
<a name="l00302"></a>00302       deriv_uy = (delta_y_0/delta_y_1*val(elem_faces(ely1,0))
<a name="l00303"></a>00303                   + delta_y*val(elem_faces(num_elem,0))
<a name="l00304"></a>00304                   - delta_y_1/delta_y_0*val(elem_faces(ely0,0)));
<a name="l00305"></a>00305       deriv_uy += (delta_y_0/delta_y_1*val(elem_faces(ely1,2))
<a name="l00306"></a>00306                    + delta_y*val(elem_faces(num_elem,2))
<a name="l00307"></a>00307                    - delta_y_1/delta_y_0*val(elem_faces(ely0,2)));
<a name="l00308"></a>00308       deriv_uy *= 0.5/(delta_y_0 + delta_y_1);
<a name="l00309"></a>00309       deriv_vy = (val(elem_faces(num_elem,3))-val(elem_faces(num_elem,1)));
<a name="l00310"></a>00310       deriv_vy *= (1./delta_ybis);
<a name="l00311"></a>00311 
<a name="l00312"></a>00312     }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314   dscald[num_elem] = 4.* (deriv_ux*deriv_ux + deriv_vy*deriv_vy)
<a name="l00315"></a>00315                      + 2.*((deriv_uy+deriv_vx)*(deriv_uy+deriv_vx));
<a name="l00316"></a>00316 }
<a name="l00317"></a>00317 
<a name="l00318"></a>00318 <span class="comment">// Cas 3D</span>
<a name="l00319"></a><a class="code" href="Champ__Face4_8cpp.html#a47c11f8181038b9ddb573b6a45672a1a">00319</a> <span class="keywordtype">void</span> <a class="code" href="Champ__Face4_8cpp.html#a47c11f8181038b9ddb573b6a45672a1a">calcul_dscald_bord3D</a>(<span class="keywordtype">int</span> num_elem,
<a name="l00320"></a>00320                           <span class="keywordtype">int</span> elx0,<span class="keywordtype">int</span> elx1,
<a name="l00321"></a>00321                           <span class="keywordtype">int</span> ely0,<span class="keywordtype">int</span> ely1,
<a name="l00322"></a>00322                           <span class="keywordtype">int</span> elz0,<span class="keywordtype">int</span> elz1,
<a name="l00323"></a>00323                           <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF,
<a name="l00324"></a>00324                           <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val,<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; dscald)
<a name="l00325"></a>00325 {
<a name="l00326"></a>00326   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00327"></a>00327   <span class="keywordtype">double</span> delta_x_0,delta_x_1,delta_y_0,delta_y_1,delta_z_0,delta_z_1;
<a name="l00328"></a>00328   <span class="keywordtype">double</span> delta_x,delta_y,delta_z;
<a name="l00329"></a>00329   <span class="keywordtype">double</span> delta_xbis,delta_ybis,delta_zbis;
<a name="l00330"></a>00330   <span class="keywordtype">double</span> deriv_ux,deriv_uy,deriv_uz,deriv_vx,deriv_vy,deriv_vz;
<a name="l00331"></a>00331   <span class="keywordtype">double</span> deriv_wx,deriv_wy,deriv_wz;
<a name="l00332"></a>00332 
<a name="l00333"></a>00333   deriv_ux = 0;
<a name="l00334"></a>00334   deriv_uy = 0;
<a name="l00335"></a>00335   deriv_uz = 0;
<a name="l00336"></a>00336   deriv_vx = 0;
<a name="l00337"></a>00337   deriv_vy = 0;
<a name="l00338"></a>00338   deriv_vz = 0;
<a name="l00339"></a>00339   deriv_wx = 0;
<a name="l00340"></a>00340   deriv_wy = 0;
<a name="l00341"></a>00341   deriv_wz = 0;
<a name="l00342"></a>00342 
<a name="l00343"></a>00343 <span class="comment">// Traitement des elements bord</span>
<a name="l00344"></a>00344 
<a name="l00345"></a>00345   <span class="keywordflow">if</span> ( (elx0 == -1) || (elx1 == -1) )
<a name="l00346"></a>00346     {
<a name="l00347"></a>00347       <span class="keywordflow">if</span> (elx0 == -1)
<a name="l00348"></a>00348         {
<a name="l00349"></a>00349           <span class="keywordflow">if</span> (elx1 != -1)
<a name="l00350"></a>00350             {
<a name="l00351"></a>00351               delta_x_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elx1,num_elem,0);
<a name="l00352"></a>00352               delta_xbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,0);
<a name="l00353"></a>00353 <span class="comment">// A ecrire et a voir sur papier : calcul de deriv_ux pres de la paroi</span>
<a name="l00354"></a>00354               deriv_vx = (val(elem_faces(elx1,1))-val(elem_faces(num_elem,1))
<a name="l00355"></a>00355                           + val(elem_faces(elx1,4))-val(elem_faces(num_elem,4)));
<a name="l00356"></a>00356               deriv_vx *= 0.5/delta_x_1;
<a name="l00357"></a>00357               deriv_wx = (val(elem_faces(elx1,2))-val(elem_faces(num_elem,2))
<a name="l00358"></a>00358                           + val(elem_faces(elx1,5))-val(elem_faces(num_elem,5)));
<a name="l00359"></a>00359               deriv_wx *= 0.5/delta_x_1;
<a name="l00360"></a>00360               deriv_ux = (val(elem_faces(num_elem,3))-val(elem_faces(num_elem,0)));
<a name="l00361"></a>00361               deriv_ux *= (1./delta_xbis);
<a name="l00362"></a>00362             }
<a name="l00363"></a>00363           <span class="keywordflow">else</span>
<a name="l00364"></a>00364             {
<a name="l00365"></a>00365               deriv_ux = 0;
<a name="l00366"></a>00366               deriv_vx = 0;
<a name="l00367"></a>00367               deriv_wx = 0;
<a name="l00368"></a>00368             }
<a name="l00369"></a>00369         }
<a name="l00370"></a>00370       <span class="keywordflow">else</span> <span class="comment">//!&lt; elx1 = -1 et elx0 != -1</span>
<a name="l00371"></a>00371 <span class="comment"></span>        {
<a name="l00372"></a>00372           delta_x_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elx0,0);
<a name="l00373"></a>00373           delta_xbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,0);
<a name="l00374"></a>00374 
<a name="l00375"></a>00375           deriv_vx = (val(elem_faces(num_elem,1))-val(elem_faces(elx0,1))
<a name="l00376"></a>00376                       + val(elem_faces(num_elem,4))-val(elem_faces(elx0,4)));
<a name="l00377"></a>00377           deriv_vx *= 0.5/delta_x_0;
<a name="l00378"></a>00378           deriv_wx = (val(elem_faces(num_elem,2))-val(elem_faces(elx0,2))
<a name="l00379"></a>00379                       + val(elem_faces(num_elem,5))-val(elem_faces(elx0,5)));
<a name="l00380"></a>00380           deriv_wx *= 0.5/delta_x_0;
<a name="l00381"></a>00381           deriv_ux = (val(elem_faces(num_elem,3))-val(elem_faces(num_elem,0)));
<a name="l00382"></a>00382           deriv_ux *= (1./delta_xbis);
<a name="l00383"></a>00383         }
<a name="l00384"></a>00384 
<a name="l00385"></a>00385       <span class="keywordflow">if</span> ( (ely0 == -1) || (ely1 == -1) )
<a name="l00386"></a>00386         {
<a name="l00387"></a>00387           <span class="keywordflow">if</span> (ely0 == -1)
<a name="l00388"></a>00388             {
<a name="l00389"></a>00389               <span class="keywordflow">if</span> (ely1 != -1)
<a name="l00390"></a>00390                 {
<a name="l00391"></a>00391                   delta_y_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(ely1,num_elem,1);
<a name="l00392"></a>00392                   delta_ybis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,1);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394                   deriv_uy = (val(elem_faces(ely1,0))-val(elem_faces(num_elem,0))
<a name="l00395"></a>00395                               + val(elem_faces(ely1,3))-val(elem_faces(num_elem,3)));
<a name="l00396"></a>00396                   deriv_uy *= 0.5/delta_y_1;
<a name="l00397"></a>00397                   deriv_wy = (val(elem_faces(ely1,2))-val(elem_faces(num_elem,2))
<a name="l00398"></a>00398                               + val(elem_faces(ely1,5))-val(elem_faces(num_elem,5)));
<a name="l00399"></a>00399                   deriv_wy *= 0.5/delta_y_1;
<a name="l00400"></a>00400                   deriv_vy = (val(elem_faces(num_elem,4))-val(elem_faces(num_elem,1)));
<a name="l00401"></a>00401                   deriv_vy *= (1./delta_ybis);
<a name="l00402"></a>00402                 }
<a name="l00403"></a>00403               <span class="keywordflow">else</span>
<a name="l00404"></a>00404                 {
<a name="l00405"></a>00405                   deriv_uy = 0;
<a name="l00406"></a>00406                   deriv_vy = 0;
<a name="l00407"></a>00407                   deriv_wy = 0;
<a name="l00408"></a>00408                 }
<a name="l00409"></a>00409             }
<a name="l00410"></a>00410           <span class="keywordflow">else</span> <span class="comment">//!&lt; ely1 = -1 et ely0 != -1</span>
<a name="l00411"></a>00411 <span class="comment"></span>            {
<a name="l00412"></a>00412               delta_y_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,ely0,1);
<a name="l00413"></a>00413               delta_ybis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,1);
<a name="l00414"></a>00414 
<a name="l00415"></a>00415               deriv_uy = (val(elem_faces(num_elem,0))-val(elem_faces(ely0,0))
<a name="l00416"></a>00416                           + val(elem_faces(num_elem,3))-val(elem_faces(ely0,3)));
<a name="l00417"></a>00417               deriv_uy *= 0.5/delta_y_0;
<a name="l00418"></a>00418               deriv_wy = (val(elem_faces(num_elem,2))-val(elem_faces(ely0,2))
<a name="l00419"></a>00419                           + val(elem_faces(num_elem,5))-val(elem_faces(ely0,5)));
<a name="l00420"></a>00420               deriv_wy *= 0.5/delta_y_0;
<a name="l00421"></a>00421               deriv_vy = (val(elem_faces(num_elem,4))-val(elem_faces(num_elem,1)));
<a name="l00422"></a>00422               deriv_vy *= (1./delta_ybis);
<a name="l00423"></a>00423             }
<a name="l00424"></a>00424         }
<a name="l00425"></a>00425       <span class="keywordflow">else</span>
<a name="l00426"></a>00426         {
<a name="l00427"></a>00427           delta_y_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,ely0,1);
<a name="l00428"></a>00428           delta_y_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(ely1,num_elem,1);
<a name="l00429"></a>00429           delta_y = (delta_y_1-delta_y_0)*(delta_y_1+delta_y_0)/(delta_y_1*delta_y_0);
<a name="l00430"></a>00430           delta_ybis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,1);
<a name="l00431"></a>00431 
<a name="l00432"></a>00432           deriv_uy = (delta_y_0/delta_y_1*val(elem_faces(ely1,0))
<a name="l00433"></a>00433                       + delta_y*val(elem_faces(num_elem,0))
<a name="l00434"></a>00434                       - delta_y_1/delta_y_0*val(elem_faces(ely0,0)));
<a name="l00435"></a>00435           deriv_uy += (delta_y_0/delta_y_1*val(elem_faces(ely1,3))
<a name="l00436"></a>00436                        + delta_y*val(elem_faces(num_elem,3))
<a name="l00437"></a>00437                        - delta_y_1/delta_y_0*val(elem_faces(ely0,3)));
<a name="l00438"></a>00438           deriv_uy *= 0.5/(delta_y_0 + delta_y_1);
<a name="l00439"></a>00439 
<a name="l00440"></a>00440           deriv_wy = (delta_y_0/delta_y_1*val(elem_faces(ely1,2))
<a name="l00441"></a>00441                       + delta_y*val(elem_faces(num_elem,2))
<a name="l00442"></a>00442                       - delta_y_1/delta_y_0*val(elem_faces(ely0,2)));
<a name="l00443"></a>00443           deriv_wy += (delta_y_0/delta_y_1*val(elem_faces(ely1,5))
<a name="l00444"></a>00444                        + delta_y*val(elem_faces(num_elem,5))
<a name="l00445"></a>00445                        - delta_y_1/delta_y_0*val(elem_faces(ely0,5)));
<a name="l00446"></a>00446           deriv_wy *= 0.5/(delta_y_0 + delta_y_1);
<a name="l00447"></a>00447           deriv_vy = (val(elem_faces(num_elem,4))-val(elem_faces(num_elem,1)));
<a name="l00448"></a>00448           deriv_vy *= (1./delta_ybis);
<a name="l00449"></a>00449         }
<a name="l00450"></a>00450 
<a name="l00451"></a>00451       <span class="keywordflow">if</span> ( (elz0 == -1) || (elz1 == -1) )
<a name="l00452"></a>00452         {
<a name="l00453"></a>00453           <span class="keywordflow">if</span> (elz0 == -1)
<a name="l00454"></a>00454             {
<a name="l00455"></a>00455               <span class="keywordflow">if</span> (elz1 != -1)
<a name="l00456"></a>00456                 {
<a name="l00457"></a>00457                   delta_z_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elz1,num_elem,2);
<a name="l00458"></a>00458                   delta_zbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,2);
<a name="l00459"></a>00459 
<a name="l00460"></a>00460                   deriv_uz = (val(elem_faces(elz1,0))-val(elem_faces(num_elem,0))
<a name="l00461"></a>00461                               + val(elem_faces(elz1,3))-val(elem_faces(num_elem,3)));
<a name="l00462"></a>00462                   deriv_uz *= 0.5/delta_z_1;
<a name="l00463"></a>00463                   deriv_vz = (val(elem_faces(elz1,1))-val(elem_faces(num_elem,1))
<a name="l00464"></a>00464                               + val(elem_faces(elz1,4))-val(elem_faces(num_elem,4)));
<a name="l00465"></a>00465                   deriv_vz *= 0.5/delta_z_1;
<a name="l00466"></a>00466                   deriv_wz = (val(elem_faces(num_elem,5))-val(elem_faces(num_elem,2)));
<a name="l00467"></a>00467                   deriv_wz *= (1./delta_zbis);
<a name="l00468"></a>00468                 }
<a name="l00469"></a>00469               <span class="keywordflow">else</span>
<a name="l00470"></a>00470                 {
<a name="l00471"></a>00471                   deriv_uz = 0;
<a name="l00472"></a>00472                   deriv_vz = 0;
<a name="l00473"></a>00473                   deriv_wz = 0;
<a name="l00474"></a>00474                 }
<a name="l00475"></a>00475             }
<a name="l00476"></a>00476           <span class="keywordflow">else</span> <span class="comment">//!&lt; elz1 = -1 et elz0 != -1</span>
<a name="l00477"></a>00477 <span class="comment"></span>            {
<a name="l00478"></a>00478               delta_z_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elz0,2);
<a name="l00479"></a>00479               delta_zbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,2);
<a name="l00480"></a>00480 
<a name="l00481"></a>00481               deriv_uz = (val(elem_faces(num_elem,0))-val(elem_faces(elz0,0))
<a name="l00482"></a>00482                           + val(elem_faces(num_elem,3))-val(elem_faces(elz0,3)));
<a name="l00483"></a>00483               deriv_uz *= 0.5/delta_z_0;
<a name="l00484"></a>00484               deriv_vz =(val(elem_faces(num_elem,1))-val(elem_faces(elz0,1))
<a name="l00485"></a>00485                          + val(elem_faces(num_elem,4))-val(elem_faces(elz0,4)));
<a name="l00486"></a>00486               deriv_vz *= 0.5/delta_z_0;
<a name="l00487"></a>00487               deriv_wz = (val(elem_faces(num_elem,5))-val(elem_faces(num_elem,2)));
<a name="l00488"></a>00488               deriv_wz *= (1./delta_zbis);
<a name="l00489"></a>00489             }
<a name="l00490"></a>00490         }
<a name="l00491"></a>00491       <span class="keywordflow">else</span>
<a name="l00492"></a>00492         {
<a name="l00493"></a>00493           delta_z_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elz0,2);
<a name="l00494"></a>00494           delta_z_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elz1,num_elem,2);
<a name="l00495"></a>00495           delta_z = (delta_z_1-delta_z_0)*(delta_z_1+delta_z_0)/(delta_z_1*delta_z_0);
<a name="l00496"></a>00496           delta_zbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,2);
<a name="l00497"></a>00497 
<a name="l00498"></a>00498           deriv_uz = (delta_z_0/delta_z_1*val(elem_faces(elz1,0))
<a name="l00499"></a>00499                       + delta_z*val(elem_faces(num_elem,0))
<a name="l00500"></a>00500                       - delta_z_1/delta_z_0*val(elem_faces(elz0,0)));
<a name="l00501"></a>00501           deriv_uz += (delta_z_0/delta_z_1*val(elem_faces(elz1,3))
<a name="l00502"></a>00502                        + delta_z*val(elem_faces(num_elem,3))
<a name="l00503"></a>00503                        - delta_z_1/delta_z_0*val(elem_faces(elz0,3)));
<a name="l00504"></a>00504           deriv_uz *= 0.5/(delta_z_0 + delta_z_1);
<a name="l00505"></a>00505 
<a name="l00506"></a>00506           deriv_vz = (delta_z_0/delta_z_1*val(elem_faces(elz1,1))
<a name="l00507"></a>00507                       + delta_z*val(elem_faces(num_elem,1))
<a name="l00508"></a>00508                       - delta_z_1/delta_z_0*val(elem_faces(elz0,1)));
<a name="l00509"></a>00509           deriv_vz += (delta_z_0/delta_z_1*val(elem_faces(elz1,4))
<a name="l00510"></a>00510                        + delta_z*val(elem_faces(num_elem,4))
<a name="l00511"></a>00511                        - delta_z_1/delta_z_0*val(elem_faces(elz0,4)));
<a name="l00512"></a>00512           deriv_vz *= 0.5/(delta_z_0 + delta_z_1);
<a name="l00513"></a>00513           deriv_wz = (val(elem_faces(num_elem,5))-val(elem_faces(num_elem,2)));
<a name="l00514"></a>00514           deriv_wz *= (1./delta_zbis);
<a name="l00515"></a>00515         }
<a name="l00516"></a>00516 
<a name="l00517"></a>00517     }
<a name="l00518"></a>00518   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (ely0 == -1) || (ely1 == -1) )
<a name="l00519"></a>00519     {
<a name="l00520"></a>00520 
<a name="l00521"></a>00521       <span class="keywordflow">if</span> (ely0 == -1)
<a name="l00522"></a>00522         {
<a name="l00523"></a>00523           <span class="keywordflow">if</span> (ely1 != -1)
<a name="l00524"></a>00524             {
<a name="l00525"></a>00525               delta_y_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(ely1,num_elem,1);
<a name="l00526"></a>00526               delta_ybis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,1);
<a name="l00527"></a>00527 
<a name="l00528"></a>00528               deriv_uy = (val(elem_faces(ely1,0))-val(elem_faces(num_elem,0))
<a name="l00529"></a>00529                           + val(elem_faces(ely1,3))-val(elem_faces(num_elem,3)));
<a name="l00530"></a>00530               deriv_uy *= 0.5/delta_y_1;
<a name="l00531"></a>00531               deriv_wy = (val(elem_faces(ely1,2))-val(elem_faces(num_elem,2))
<a name="l00532"></a>00532                           + val(elem_faces(ely1,5))-val(elem_faces(num_elem,5)));
<a name="l00533"></a>00533               deriv_wy *= 0.5/delta_y_1;
<a name="l00534"></a>00534               deriv_vy  = (val(elem_faces(num_elem,3))-val(elem_faces(num_elem,1)));
<a name="l00535"></a>00535               deriv_vy *= (1./delta_ybis);
<a name="l00536"></a>00536             }
<a name="l00537"></a>00537           <span class="keywordflow">else</span>
<a name="l00538"></a>00538             {
<a name="l00539"></a>00539               deriv_uy = 0;
<a name="l00540"></a>00540               deriv_vy = 0;
<a name="l00541"></a>00541               deriv_wy = 0;
<a name="l00542"></a>00542             }
<a name="l00543"></a>00543         }
<a name="l00544"></a>00544       <span class="keywordflow">else</span>  <span class="comment">//!&lt; ely1 = -1 et ely0 != -1</span>
<a name="l00545"></a>00545 <span class="comment"></span>        {
<a name="l00546"></a>00546           delta_y_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,ely0,1);
<a name="l00547"></a>00547           delta_ybis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,1);
<a name="l00548"></a>00548 
<a name="l00549"></a>00549           deriv_uy = (val(elem_faces(num_elem,0))-val(elem_faces(ely0,0))
<a name="l00550"></a>00550                       + val(elem_faces(num_elem,3))-val(elem_faces(ely0,3)));
<a name="l00551"></a>00551           deriv_uy *= 0.5/delta_y_0;
<a name="l00552"></a>00552           deriv_wy = (val(elem_faces(num_elem,2))-val(elem_faces(ely0,2))
<a name="l00553"></a>00553                       + val(elem_faces(num_elem,5))-val(elem_faces(ely0,5)));
<a name="l00554"></a>00554           deriv_wy *= 0.5/delta_y_0;
<a name="l00555"></a>00555           deriv_vy  = (val(elem_faces(num_elem,3))-val(elem_faces(num_elem,1)));
<a name="l00556"></a>00556           deriv_vy *= (1./delta_ybis);
<a name="l00557"></a>00557         }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559       delta_x_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elx0,0);
<a name="l00560"></a>00560       delta_x_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elx1,num_elem,0);
<a name="l00561"></a>00561       delta_x = (delta_x_1-delta_x_0)*(delta_x_1+delta_x_0)/(delta_x_1*delta_x_0);
<a name="l00562"></a>00562       delta_xbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,0);
<a name="l00563"></a>00563 
<a name="l00564"></a>00564       deriv_wx = (delta_x_0/delta_x_1*val(elem_faces(elx1,2))
<a name="l00565"></a>00565                   + delta_x*val(elem_faces(num_elem,2))
<a name="l00566"></a>00566                   - delta_x_1/delta_x_0*val(elem_faces(elx0,2)));
<a name="l00567"></a>00567       deriv_wx += (delta_x_0/delta_x_1*val(elem_faces(elx1,5))
<a name="l00568"></a>00568                    + delta_x*val(elem_faces(num_elem,5))
<a name="l00569"></a>00569                    - delta_x_1/delta_x_0*val(elem_faces(elx0,5)));
<a name="l00570"></a>00570       deriv_wx *= 0.5/(delta_x_0 + delta_x_1);
<a name="l00571"></a>00571 
<a name="l00572"></a>00572       deriv_vx = (delta_x_0/delta_x_1*val(elem_faces(elx1,1))
<a name="l00573"></a>00573                   + delta_x*val(elem_faces(num_elem,1))
<a name="l00574"></a>00574                   - delta_x_1/delta_x_0*val(elem_faces(elx0,1)));
<a name="l00575"></a>00575       deriv_vx += (delta_x_0/delta_x_1*val(elem_faces(elx1,4))
<a name="l00576"></a>00576                    + delta_x*val(elem_faces(num_elem,4))
<a name="l00577"></a>00577                    - delta_x_1/delta_x_0*val(elem_faces(elx0,4)));
<a name="l00578"></a>00578       deriv_vx *= 0.5/(delta_x_0 + delta_x_1);
<a name="l00579"></a>00579       deriv_ux  = (val(elem_faces(num_elem,3))-val(elem_faces(num_elem,0)));
<a name="l00580"></a>00580       deriv_ux *= (1./delta_xbis);
<a name="l00581"></a>00581 
<a name="l00582"></a>00582 
<a name="l00583"></a>00583       <span class="keywordflow">if</span> ( (elz0 == -1) || (elz1 == -1) )
<a name="l00584"></a>00584         {
<a name="l00585"></a>00585           <span class="keywordflow">if</span> (elz0 == -1)
<a name="l00586"></a>00586             {
<a name="l00587"></a>00587               <span class="keywordflow">if</span> (elz1 != -1)
<a name="l00588"></a>00588                 {
<a name="l00589"></a>00589                   delta_z_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elz1,num_elem,2);
<a name="l00590"></a>00590                   delta_zbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,2);
<a name="l00591"></a>00591 
<a name="l00592"></a>00592                   deriv_uz = (val(elem_faces(elz1,0))-val(elem_faces(num_elem,0))
<a name="l00593"></a>00593                               + val(elem_faces(elz1,3))-val(elem_faces(num_elem,3)));
<a name="l00594"></a>00594                   deriv_uz *= 0.5/delta_z_1;
<a name="l00595"></a>00595                   deriv_vz = (val(elem_faces(elz1,1))-val(elem_faces(num_elem,1))
<a name="l00596"></a>00596                               + val(elem_faces(elz1,4))-val(elem_faces(num_elem,4)));
<a name="l00597"></a>00597                   deriv_vz *= 0.5/delta_z_1;
<a name="l00598"></a>00598                   deriv_wz  = (val(elem_faces(num_elem,5))-val(elem_faces(num_elem,2)));
<a name="l00599"></a>00599                   deriv_wz *= (1./delta_zbis);
<a name="l00600"></a>00600                 }
<a name="l00601"></a>00601               <span class="keywordflow">else</span>
<a name="l00602"></a>00602                 {
<a name="l00603"></a>00603                   deriv_uz = 0;
<a name="l00604"></a>00604                   deriv_vz = 0;
<a name="l00605"></a>00605                   deriv_wz = 0;
<a name="l00606"></a>00606                 }
<a name="l00607"></a>00607             }
<a name="l00608"></a>00608           <span class="keywordflow">else</span>
<a name="l00609"></a>00609             {
<a name="l00610"></a>00610               delta_z_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elz0,2);
<a name="l00611"></a>00611               delta_zbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,2);
<a name="l00612"></a>00612 
<a name="l00613"></a>00613               deriv_uz = (val(elem_faces(num_elem,0))-val(elem_faces(elz0,0))
<a name="l00614"></a>00614                           + val(elem_faces(num_elem,3))-val(elem_faces(elz0,3)));
<a name="l00615"></a>00615               deriv_uz *= 0.5/delta_z_0;
<a name="l00616"></a>00616               deriv_vz =(val(elem_faces(num_elem,1))-val(elem_faces(elz0,1))
<a name="l00617"></a>00617                          + val(elem_faces(num_elem,4))-val(elem_faces(elz0,4)));
<a name="l00618"></a>00618               deriv_vz *= 0.5/delta_z_0;
<a name="l00619"></a>00619               deriv_wz  = (val(elem_faces(num_elem,5))-val(elem_faces(num_elem,2)));
<a name="l00620"></a>00620               deriv_wz *= (1./delta_zbis);
<a name="l00621"></a>00621             }
<a name="l00622"></a>00622         }
<a name="l00623"></a>00623       <span class="keywordflow">else</span>
<a name="l00624"></a>00624         {
<a name="l00625"></a>00625           delta_z_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elz0,2);
<a name="l00626"></a>00626           delta_z_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elz1,num_elem,2);
<a name="l00627"></a>00627           delta_z = (delta_z_1-delta_z_0)*(delta_z_1+delta_z_0)/(delta_z_1*delta_z_0);
<a name="l00628"></a>00628           delta_zbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,2);
<a name="l00629"></a>00629 
<a name="l00630"></a>00630           deriv_uz = (delta_z_0/delta_z_1*val(elem_faces(elz1,0))
<a name="l00631"></a>00631                       + delta_z*val(elem_faces(num_elem,0))
<a name="l00632"></a>00632                       - delta_z_1/delta_z_0*val(elem_faces(elz0,0)));
<a name="l00633"></a>00633           deriv_uz += (delta_z_0/delta_z_1*val(elem_faces(elz1,3))
<a name="l00634"></a>00634                        + delta_z*val(elem_faces(num_elem,3))
<a name="l00635"></a>00635                        - delta_z_1/delta_z_0*val(elem_faces(elz0,3)));
<a name="l00636"></a>00636           deriv_uz *= 0.5/(delta_z_0 + delta_z_1);
<a name="l00637"></a>00637 
<a name="l00638"></a>00638           deriv_vz = (delta_z_0/delta_z_1*val(elem_faces(elz1,1))
<a name="l00639"></a>00639                       + delta_z*val(elem_faces(num_elem,1))
<a name="l00640"></a>00640                       - delta_z_1/delta_z_0*val(elem_faces(elz0,1)));
<a name="l00641"></a>00641           deriv_vz += (delta_z_0/delta_z_1*val(elem_faces(elz1,4))
<a name="l00642"></a>00642                        + delta_z*val(elem_faces(num_elem,4))
<a name="l00643"></a>00643                        - delta_z_1/delta_z_0*val(elem_faces(elz0,4)));
<a name="l00644"></a>00644           deriv_vz *= 0.5/(delta_z_0 + delta_z_1);
<a name="l00645"></a>00645           deriv_wz  = (val(elem_faces(num_elem,5))-val(elem_faces(num_elem,2)));
<a name="l00646"></a>00646           deriv_wz *= (1./delta_zbis);
<a name="l00647"></a>00647         }
<a name="l00648"></a>00648     }
<a name="l00649"></a>00649   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (elz0 == -1) || (elz1 == -1) )
<a name="l00650"></a>00650     {
<a name="l00651"></a>00651       <span class="keywordflow">if</span> (elz0 == -1)
<a name="l00652"></a>00652         {
<a name="l00653"></a>00653           <span class="keywordflow">if</span> (elz1 != -1)
<a name="l00654"></a>00654             {
<a name="l00655"></a>00655               delta_z_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elz1,num_elem,2);
<a name="l00656"></a>00656               delta_zbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,2);
<a name="l00657"></a>00657 
<a name="l00658"></a>00658               deriv_uz = (val(elem_faces(elz1,0))-val(elem_faces(num_elem,0))
<a name="l00659"></a>00659                           + val(elem_faces(elz1,3))-val(elem_faces(num_elem,3)));
<a name="l00660"></a>00660               deriv_uz *= 0.5/delta_z_1;
<a name="l00661"></a>00661               deriv_vz = (val(elem_faces(elz1,1))-val(elem_faces(num_elem,1))
<a name="l00662"></a>00662                           + val(elem_faces(elz1,4))-val(elem_faces(num_elem,4)));
<a name="l00663"></a>00663               deriv_vz *= 0.5/delta_z_1;
<a name="l00664"></a>00664               deriv_wz  = (val(elem_faces(num_elem,5))-val(elem_faces(num_elem,2)));
<a name="l00665"></a>00665               deriv_wz *= (1./delta_zbis);
<a name="l00666"></a>00666             }
<a name="l00667"></a>00667           <span class="keywordflow">else</span>
<a name="l00668"></a>00668             {
<a name="l00669"></a>00669               deriv_uz = 0;
<a name="l00670"></a>00670               deriv_vz = 0;
<a name="l00671"></a>00671               deriv_wz = 0;
<a name="l00672"></a>00672             }
<a name="l00673"></a>00673         }
<a name="l00674"></a>00674       <span class="keywordflow">else</span> <span class="comment">//!&lt; elz1 = -1 et elz0 != -1</span>
<a name="l00675"></a>00675 <span class="comment"></span>        {
<a name="l00676"></a>00676           delta_z_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elz0,2);
<a name="l00677"></a>00677           delta_zbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,2);
<a name="l00678"></a>00678 
<a name="l00679"></a>00679           deriv_uz = (val(elem_faces(num_elem,0))-val(elem_faces(elz0,0))
<a name="l00680"></a>00680                       + val(elem_faces(num_elem,3))-val(elem_faces(elz0,3)));
<a name="l00681"></a>00681           deriv_uz *= 0.5/delta_z_0;
<a name="l00682"></a>00682           deriv_vz =(val(elem_faces(num_elem,1))-val(elem_faces(elz0,1))
<a name="l00683"></a>00683                      + val(elem_faces(num_elem,4))-val(elem_faces(elz0,4)));
<a name="l00684"></a>00684           deriv_vz *= 0.5/delta_z_0;
<a name="l00685"></a>00685           deriv_wz  = (val(elem_faces(num_elem,5))-val(elem_faces(num_elem,2)));
<a name="l00686"></a>00686           deriv_wz *= (1./delta_zbis);
<a name="l00687"></a>00687         }
<a name="l00688"></a>00688 
<a name="l00689"></a>00689       delta_x_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,elx0,0);
<a name="l00690"></a>00690       delta_x_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(elx1,num_elem,0);
<a name="l00691"></a>00691       delta_x = (delta_x_1-delta_x_0)*(delta_x_1+delta_x_0)/(delta_x_1*delta_x_0);
<a name="l00692"></a>00692       delta_xbis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,0);
<a name="l00693"></a>00693 
<a name="l00694"></a>00694       deriv_wx = (delta_x_0/delta_x_1*val(elem_faces(elx1,2))
<a name="l00695"></a>00695                   + delta_x*val(elem_faces(num_elem,2))
<a name="l00696"></a>00696                   - delta_x_1/delta_x_0*val(elem_faces(elx0,2)));
<a name="l00697"></a>00697       deriv_wx += (delta_x_0/delta_x_1*val(elem_faces(elx1,5))
<a name="l00698"></a>00698                    + delta_x*val(elem_faces(num_elem,5))
<a name="l00699"></a>00699                    - delta_x_1/delta_x_0*val(elem_faces(elx0,5)));
<a name="l00700"></a>00700       deriv_wx *= 0.5/(delta_x_0 + delta_x_1);
<a name="l00701"></a>00701 
<a name="l00702"></a>00702       deriv_vx = (delta_x_0/delta_x_1*val(elem_faces(elx1,1))
<a name="l00703"></a>00703                   + delta_x*val(elem_faces(num_elem,1))
<a name="l00704"></a>00704                   - delta_x_1/delta_x_0*val(elem_faces(elx0,1)));
<a name="l00705"></a>00705       deriv_vx += (delta_x_0/delta_x_1*val(elem_faces(elx1,4))
<a name="l00706"></a>00706                    + delta_x*val(elem_faces(num_elem,4))
<a name="l00707"></a>00707                    - delta_x_1/delta_x_0*val(elem_faces(elx0,4)));
<a name="l00708"></a>00708       deriv_vx *= 0.5/(delta_x_0 + delta_x_1);
<a name="l00709"></a>00709       deriv_ux  = (val(elem_faces(num_elem,3))-val(elem_faces(num_elem,0)));
<a name="l00710"></a>00710       deriv_ux *= (1./delta_xbis);
<a name="l00711"></a>00711 
<a name="l00712"></a>00712       delta_y_0 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(num_elem,ely0,1);
<a name="l00713"></a>00713       delta_y_1 = zone_VDF.<a class="code" href="classZone__VDF.html#af5ca4d6bdeaae2db664c2e1840159d0d">dist_elem</a>(ely1,num_elem,1);
<a name="l00714"></a>00714       delta_y = (delta_y_1-delta_y_0)*(delta_y_1+delta_y_0)/(delta_y_1*delta_y_0);
<a name="l00715"></a>00715       delta_ybis = zone_VDF.<a class="code" href="classZone__VDF.html#a16d2b5b0bd1f52fa6aed11d2e59a10b0">dim_elem</a>(num_elem,1);
<a name="l00716"></a>00716 
<a name="l00717"></a>00717       deriv_wy = (delta_y_0/delta_y_1*val(elem_faces(ely1,2))
<a name="l00718"></a>00718                   + delta_y*val(elem_faces(num_elem,2))
<a name="l00719"></a>00719                   - delta_y_1/delta_y_0*val(elem_faces(ely0,2)));
<a name="l00720"></a>00720       deriv_wy += (delta_y_0/delta_y_1*val(elem_faces(ely1,5))
<a name="l00721"></a>00721                    + delta_y*val(elem_faces(num_elem,5))
<a name="l00722"></a>00722                    - delta_y_1/delta_y_0*val(elem_faces(ely0,5)));
<a name="l00723"></a>00723       deriv_wy *= 0.5/(delta_y_0 + delta_y_1);
<a name="l00724"></a>00724 
<a name="l00725"></a>00725       deriv_uy = (delta_y_0/delta_y_1*val(elem_faces(ely1,0))
<a name="l00726"></a>00726                   + delta_y*val(elem_faces(num_elem,0))
<a name="l00727"></a>00727                   - delta_y_1/delta_y_0*val(elem_faces(ely0,0)));
<a name="l00728"></a>00728       deriv_uy += (delta_y_0/delta_y_1*val(elem_faces(ely1,3))
<a name="l00729"></a>00729                    + delta_y*val(elem_faces(num_elem,3))
<a name="l00730"></a>00730                    - delta_y_1/delta_y_0*val(elem_faces(ely0,3)));
<a name="l00731"></a>00731       deriv_uy *= 0.5/(delta_y_0 + delta_y_1);
<a name="l00732"></a>00732       deriv_vy  = (val(elem_faces(num_elem,4))-val(elem_faces(num_elem,1)));
<a name="l00733"></a>00733       deriv_ux *= (1./delta_ybis);
<a name="l00734"></a>00734     }
<a name="l00735"></a>00735 
<a name="l00736"></a>00736   dscald[num_elem] = 4.* (deriv_ux*deriv_ux + deriv_vy*deriv_vy + deriv_wz*deriv_wz)
<a name="l00737"></a>00737                      + 2.*((deriv_uy+deriv_vx)*(deriv_uy+deriv_vx)
<a name="l00738"></a>00738                            +(deriv_wx+deriv_uz)*(deriv_wx+deriv_uz)
<a name="l00739"></a>00739                            +(deriv_wy+deriv_vz)*(deriv_wy+deriv_vz));
<a name="l00740"></a>00740 }
<a name="l00741"></a>00741 
<a name="l00742"></a>00742 <span class="comment">// Cas 2D</span>
<a name="l00743"></a><a class="code" href="Champ__Face4_8cpp.html#acdbf7783e03d00af97e972d84567f857">00743</a> <span class="keywordtype">void</span> <a class="code" href="Champ__Face4_8cpp.html#acdbf7783e03d00af97e972d84567f857">caldscaldcentelemdim2</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; dscald, <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val,
<a name="l00744"></a>00744                            <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF, <span class="keywordtype">int</span> nb_elem,
<a name="l00745"></a>00745                            <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins, <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces)
<a name="l00746"></a>00746 {
<a name="l00747"></a>00747   <span class="keywordflow">if</span>(dscald.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)!=nb_elem)
<a name="l00748"></a>00748     dscald.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_elem);
<a name="l00749"></a>00749   <span class="keywordtype">int</span> elx0,elx1,ely0,ely1;
<a name="l00750"></a>00750 
<a name="l00751"></a>00751   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elem; num_elem++)
<a name="l00752"></a>00752     {
<a name="l00753"></a>00753 
<a name="l00754"></a>00754       elx0 = face_voisins(elem_faces(num_elem,0),0);
<a name="l00755"></a>00755       elx1 = face_voisins(elem_faces(num_elem,2),1);
<a name="l00756"></a>00756       ely0 = face_voisins(elem_faces(num_elem,1),0);
<a name="l00757"></a>00757       ely1 = face_voisins(elem_faces(num_elem,3),1);
<a name="l00758"></a>00758 
<a name="l00759"></a>00759       <span class="keywordflow">if</span> ( (elx0 != -1) &amp;&amp; (elx1 != -1) &amp;&amp; (ely0 != -1)
<a name="l00760"></a>00760            &amp;&amp; (ely1 != -1))
<a name="l00761"></a>00761 <span class="comment">// Cas d&#39;un element interne</span>
<a name="l00762"></a>00762 
<a name="l00763"></a>00763         <a class="code" href="Champ__Face4_8cpp.html#a4adf94a7ed3aec91ebf403474c9018c8">calcul_dscald_interne2D</a>(num_elem,elx0,elx1,ely0,ely1,zone_VDF,val,dscald);
<a name="l00764"></a>00764       <span class="keywordflow">else</span>
<a name="l00765"></a>00765         <a class="code" href="Champ__Face4_8cpp.html#a73e43a4313d1a82b788a6cbb52f01e30">calcul_dscald_bord2D</a>(num_elem,elx0,elx1,ely0,ely1,zone_VDF,val,dscald);
<a name="l00766"></a>00766     }
<a name="l00767"></a>00767 }
<a name="l00768"></a>00768 
<a name="l00769"></a>00769 
<a name="l00770"></a>00770 <span class="comment">// Cas 3D</span>
<a name="l00771"></a><a class="code" href="Champ__Face4_8cpp.html#a46481e302798100e13f6a288ce49625a">00771</a> <span class="keywordtype">void</span> <a class="code" href="Champ__Face4_8cpp.html#a46481e302798100e13f6a288ce49625a">caldscaldcentelemdim3</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; dscald, <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val, <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF,
<a name="l00772"></a>00772                            <span class="keywordtype">int</span> nb_elem, <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins, <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces)
<a name="l00773"></a>00773 {
<a name="l00774"></a>00774   <span class="keywordflow">if</span>(dscald.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)!=nb_elem)
<a name="l00775"></a>00775     dscald.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_elem);
<a name="l00776"></a>00776   <span class="keywordtype">int</span> elx0,elx1,ely0,ely1,elz0,elz1;
<a name="l00777"></a>00777 
<a name="l00778"></a>00778   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nb_elem; num_elem++)
<a name="l00779"></a>00779     {
<a name="l00780"></a>00780 
<a name="l00781"></a>00781       elx0 = face_voisins(elem_faces(num_elem,0),0);
<a name="l00782"></a>00782       elx1 = face_voisins(elem_faces(num_elem,3),1);
<a name="l00783"></a>00783       ely0 = face_voisins(elem_faces(num_elem,1),0);
<a name="l00784"></a>00784       ely1 = face_voisins(elem_faces(num_elem,4),1);
<a name="l00785"></a>00785       elz0 = face_voisins(elem_faces(num_elem,2),0);
<a name="l00786"></a>00786       elz1 = face_voisins(elem_faces(num_elem,5),1);
<a name="l00787"></a>00787 
<a name="l00788"></a>00788       <span class="keywordflow">if</span> ( (elx0 != -1) &amp;&amp; (elx1 != -1) &amp;&amp; (ely0 != -1)
<a name="l00789"></a>00789            &amp;&amp; (ely1 != -1) &amp;&amp; (elz0 != -1) &amp;&amp; (elz1 != -1) )
<a name="l00790"></a>00790 <span class="comment">// Cas d&#39;un element interne</span>
<a name="l00791"></a>00791 
<a name="l00792"></a>00792         <a class="code" href="Champ__Face4_8cpp.html#aa610f1b6ce940595527221dfdc6c4c39">calcul_dscald_interne3D</a>(num_elem,elx0,elx1,ely0,ely1,elz0,elz1,zone_VDF,val,dscald);
<a name="l00793"></a>00793       <span class="keywordflow">else</span>
<a name="l00794"></a>00794         <a class="code" href="Champ__Face4_8cpp.html#a47c11f8181038b9ddb573b6a45672a1a">calcul_dscald_bord3D</a>(num_elem,elx0,elx1,ely0,ely1,elz0,elz1,zone_VDF,val,dscald);
<a name="l00795"></a>00795     }
<a name="l00796"></a>00796 }
<a name="l00797"></a>00797 
<a name="l00798"></a>00798 
<a name="l00799"></a>00799 
<a name="l00800"></a><a class="code" href="classChamp__Face.html#aacfc1c3c1cb21054b55f5d8da33b4367">00800</a> <span class="keywordtype">void</span> <a class="code" href="classChamp__Face.html#aacfc1c3c1cb21054b55f5d8da33b4367">Champ_Face::calculer_dscald_centre_element</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; dscald)<span class="keyword"> const</span>
<a name="l00801"></a>00801 <span class="keyword"></span>{
<a name="l00802"></a>00802   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val = <a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00803"></a>00803   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF = <a class="code" href="classChamp__Face.html#a84b6abcd128000e1d5759caaa7ae0dee">la_zone_VDF</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00804"></a>00804   <span class="keywordtype">int</span> nb_elem = zone_VDF.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>();
<a name="l00805"></a>00805   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VDF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00806"></a>00806   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VDF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00807"></a>00807 
<a name="l00808"></a>00808   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2 )
<a name="l00809"></a>00809     <a class="code" href="Champ__Face4_8cpp.html#acdbf7783e03d00af97e972d84567f857">caldscaldcentelemdim2</a>(dscald, val, zone_VDF, nb_elem, face_voisins, elem_faces);
<a name="l00810"></a>00810   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 3)
<a name="l00811"></a>00811     <a class="code" href="Champ__Face4_8cpp.html#a46481e302798100e13f6a288ce49625a">caldscaldcentelemdim3</a>(dscald, val, zone_VDF, nb_elem, face_voisins, elem_faces);
<a name="l00812"></a>00812 }
<a name="l00813"></a>00813 
<a name="l00814"></a>00814 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:37 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
