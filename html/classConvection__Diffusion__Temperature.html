<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: Convection_Diffusion_Temperature Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">Convection_Diffusion_Temperature Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Convection_Diffusion_Temperature" --><!-- doxytag: inherits="Convection_Diffusion_std" -->
<p>classe <a class="el" href="classConvection__Diffusion__Temperature.html" title="classe Convection_Diffusion_Temperature Cas particulier de Convection_Diffusion_std quand le scalaire...">Convection_Diffusion_Temperature</a><br/>
Cas particulier de <a class="el" href="classConvection__Diffusion__std.html" title="classe Convection_Diffusion_std Cette classe est la base des equations modelisant le transport d&#39;un s...">Convection_Diffusion_std</a><br/>
quand le scalaire subissant le transport est la temperature.  
 <a href="classConvection__Diffusion__Temperature.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Convection_Diffusion_Temperature:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classConvection__Diffusion__Temperature.png" usemap="#Convection_Diffusion_Temperature_map" alt=""/>
  <map id="Convection_Diffusion_Temperature_map" name="Convection_Diffusion_Temperature_map">
<area href="classConvection__Diffusion__std.html" title="classe Convection_Diffusion_std Cette classe est la base des equations modelisant le transport d&#39;un s..." alt="Convection_Diffusion_std" shape="rect" coords="110,168,321,192"/>
<area href="classEquation__base.html" alt="Equation_base" shape="rect" coords="110,112,321,136"/>
<area href="classChamps__compris__interface.html" title="classe Champs_compris_interface Cette classe contient une interface de methodes destinees a gerer les..." alt="Champs_compris_interface" shape="rect" coords="0,56,211,80"/>
<area href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob..." alt="Objet_U" shape="rect" coords="221,56,432,80"/>
<area href="classProcess.html" title="Classe de base de TRUST (notamment Objet_U). Elle fournit quelques services de base accessibles de pa..." alt="Process" shape="rect" coords="221,0,432,24"/>
</map>
 </div></div>

<p><a href="classConvection__Diffusion__Temperature-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#af0de5f9783ab6a53630208272172507a">~Convection_Diffusion_Temperature</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a67b6c6b23cdd2dac5da10bdd27bc5934">taille_memoire</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a0dd6e47db99b9ca533dbb8940bc1f9d2">duplique</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classType__info.html">Type_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#af37246da78d980d08d082a97a4d69f35">get_info</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Donne des informations sur le type de l'Objet_U.  <a href="#af37246da78d980d08d082a97a4d69f35"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#ab120e13159e4bf366b3a4616804aad42">Convection_Diffusion_Temperature</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a365fcd2db507c039d52cba160982f4a8">set_param</a> (<a class="el" href="classParam.html">Param</a> &amp;titi)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#ab353b1f81cc7fe5ed107e6c0fa254d1c">lire_motcle_non_standard</a> (const <a class="el" href="classMotcle.html">Motcle</a> &amp;, <a class="el" href="classEntree.html">Entree</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Lecture des parametres de type non simple d'un objet_U<br/>
a partir d'un flot d'entree.  <a href="#ab353b1f81cc7fe5ed107e6c0fa254d1c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a4631234386db71af1be20fb46dbfbecb">associer_fluide</a> (const <a class="el" href="classFluide__base.html">Fluide_base</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Associe un fluide incompressible a l'equation.  <a href="#a4631234386db71af1be20fb46dbfbecb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classChamp__Inc.html">Champ_Inc</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#aab6a891f15e7996eda73b1b6e67e7dbd">inconnue</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Renvoie le champ inconnue representant la temperatue.<br/>
(version const)  <a href="#aab6a891f15e7996eda73b1b6e67e7dbd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classChamp__Inc.html">Champ_Inc</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a8137afc33dd8086f664087ca23d2592a">inconnue</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Renvoie le champ inconnue representant la temperatue.  <a href="#a8137afc33dd8086f664087ca23d2592a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a21661332b6926372eb7fc52e6fdaa7bb">discretiser</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Discretise l'equation.  <a href="#a21661332b6926372eb7fc52e6fdaa7bb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classMilieu__base.html">Milieu_base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a4d944b784ab2d9d4845fd6eeca0cccc4">milieu</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Renvoie le milieu physique de l'equation.<br/>
(un <a class="el" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a> upcaste en <a class="el" href="classMilieu__base.html" title="classe Milieu_base Cette classe est la base de la hierarchie des milieux (physiques) Elle regroupe le...">Milieu_base</a>)<br/>
(version const)  <a href="#a4d944b784ab2d9d4845fd6eeca0cccc4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classFluide__base.html">Fluide_base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a2733226a5a26dc9360a2e448e03608aa">fluide</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Renvoie le fluide incompressible associe a l'equation.<br/>
(version const)  <a href="#a2733226a5a26dc9360a2e448e03608aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classFluide__base.html">Fluide_base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#aa9b6985791d67f8c3a4f87f61407ce54">fluide</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Renvoie le fluide incompressible associe a l'equation.  <a href="#aa9b6985791d67f8c3a4f87f61407ce54"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMilieu__base.html">Milieu_base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a06276d9be9a7ad227c261214a7b9f059">milieu</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Renvoie le milieu physique de l'equation.<br/>
(un <a class="el" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a> upcaste en <a class="el" href="classMilieu__base.html" title="classe Milieu_base Cette classe est la base de la hierarchie des milieux (physiques) Elle regroupe le...">Milieu_base</a>)  <a href="#a06276d9be9a7ad227c261214a7b9f059"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#aed44e94dd98d13bdbca8ef967f80a047">associer_milieu_base</a> (const <a class="el" href="classMilieu__base.html">Milieu_base</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Associe un milieu physique a l'equation,<br/>
le milieu est en fait caste en <a class="el" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a> ou en <a class="el" href="classFluide__Ostwald.html" title="class Fluide_Ostwald Possede les proprietes d&#39;un fluide incompressible plus: N : indice de structure ...">Fluide_Ostwald</a>.  <a href="#aed44e94dd98d13bdbca8ef967f80a047"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#aa87b5ab582fd4ecd37fce89eff3ccb6e">impr</a> (<a class="el" href="classSortie.html">Sortie</a> &amp;os) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Impression des flux sur les bords sur un flot de sortie.<br/>
Appelle <a class="el" href="classEquation__base.html#afe3e1fe1bcc08f1e22d24d823a403fc7" title="Imprime les operateurs de l&#39;equation sur un flot de sortie, de facon inconditionnelle. appelle Operateur_base::impr(os)">Equation_base::impr</a>(<a class="el" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp;)  <a href="#aa87b5ab582fd4ecd37fce89eff3ccb6e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="classChamp__Don.html">Champ_Don</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a78c4b7631d32e6519bfb319f6a092931">diffusivite_pour_transport</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="classChamp__base.html">Champ_base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#ab9459fce614d454490281858f631946e">diffusivite_pour_pas_de_temps</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a3bacf8f6add8a055cdabf1c7c8095400">creer_champ</a> (const <a class="el" href="classMotcle.html">Motcle</a> &amp;motlu)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="classChamp__base.html">Champ_base</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#af9bdd96da5f4693f0ed53a724668d1eb">get_champ</a> (const <a class="el" href="classMotcle.html">Motcle</a> &amp;nom) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="classMotcle.html">Motcle</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a53dae60f23bd5d3ec003bd285dd73c26">domaine_application</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Renvoie le nom du domaine d'application de l'equation.<br/>
Ici "Thermique".  <a href="#a53dae60f23bd5d3ec003bd285dd73c26"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a2e65653eeca0056bb6bb485ba0bbc64c">derivee_en_temps_inco</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the time derivative of the unknown I of the equation:<br/>
dI/dt = M-1*(sum(operators(I) + sources))<br/>
In : derivee contains I (but immediatly set to 0)<br/>
Out: derivee contains dI/dt.  <a href="#a2e65653eeca0056bb6bb485ba0bbc64c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a7fb7465179789422db192cb948c37b06">derivee_en_temps_inco_eq_base</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#afb5baf5187a88ec71af939b53385b0c7">assembler</a> (<a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;mat_morse, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;present, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;secmem)</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classObjet__U.html">Objet_U</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a43f36ade57358725c69ed4857fdfb7f7">cree_instance</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classType__info.html">Type_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#af6e770ba4eb736c84a65bd6fef98f6db">info</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Donne des informations sur le type de l'Objet_U.  <a href="#af6e770ba4eb736c84a65bd6fef98f6db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <br class="typebreak"/>
<a class="el" href="classConvection__Diffusion__Temperature.html">Convection_Diffusion_Temperature</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#af3b89bd8e4622db3baedfc3e3d664940">self_cast</a> (<a class="el" href="classObjet__U.html">Objet_U</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <br class="typebreak"/>
<a class="el" href="classConvection__Diffusion__Temperature.html">Convection_Diffusion_Temperature</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#ae6fd02098c8c2e18be9e2cab3b47c341">self_cast</a> (const <a class="el" href="classObjet__U.html">Objet_U</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">methode ajoutee pour caster en python  <a href="#ae6fd02098c8c2e18be9e2cab3b47c341"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classType__info.html">Type_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a5123a0034845969679e3e43e13069b21">info_obj</a></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a868757abff8b1296a2d80765f22bc622">printOn</a> (<a class="el" href="classSortie.html">Sortie</a> &amp;x) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSimple.html">Simple</a> appel a: <a class="el" href="classConvection__Diffusion__std.html#a1456f18650713408692e473203162bbe" title="Simple appel a Equation_base::printOn(Sortie&amp;)">Convection_Diffusion_std::printOn</a>(<a class="el" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp;)  <a href="#a868757abff8b1296a2d80765f22bc622"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classEntree.html">Entree</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#ad0740c9c79ae6e39edc019e53d67cfc1">readOn</a> (<a class="el" href="classEntree.html">Entree</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifie si l'equation a une temperature et un fluide associe<br/>
cf <a class="el" href="classConvection__Diffusion__std.html#ae478232ec9d42409037a60618012c3dc" title="cf Equation_base::readOn(Entree&amp;)">Convection_Diffusion_std::readOn</a>(<a class="el" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp;).  <a href="#ad0740c9c79ae6e39edc019e53d67cfc1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a9158886a17c4c95aaad8071763bc7ff1">filtrage_si_appart_ibc</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a22c0a145a3458c317b07d675b17517a4">penalisation_L2</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a5893252be9df68bd585d71351ce118e4">verifier_tag_indicatrice_pena_glob</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#aecf0e32fb40f34138650f1ced3b2aa71">mise_a_jour_tag_indicatrice_pena_glob</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a2166b2c55902ad79bd60c797f31d1355">set_indic_pena_globale</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a3689afde81dff034b576b7dab3b0da59">mise_en_place_zone_fantome</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a54112f5b487abbdfc59de04c562b1b26">calcul_indic_pena_global</a> (<a class="el" href="classIntTab.html">IntTab</a> &amp;, <a class="el" href="classIntTab.html">IntTab</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a82affa83cd11442b4b18d0e7114d4b08">transport_ibc</a> (<a class="el" href="classDoubleTrav.html">DoubleTrav</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a06c061aa19d88e3f1392c381247551e7">ecrire_fichier_pena_th</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classChamp__Inc.html">Champ_Inc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRef__Fluide__base.html">Ref_Fluide_base</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classChamp__Fonc.html">Champ_Fonc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a9791260817ac5155c177a3d98f5d9ba6">gradient_temperature</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classChamp__Fonc.html">Champ_Fonc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a0a86082c4a7dc0d65dc2b152a79c6d9a">h_echange</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a076e32b9ad994a4121452cb3829b9273">is_penalized</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#aedbe5cc441073edc75ff1b7e491aa620">eta</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a7038fcce2e880fcf5580f291a4a35ebe">choix_pena</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#aa281e6ca4e8b6de76091836eb6d62ae3">tag_indic_pena_global</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#ac11d5686f6bcdd802887cd66c01a54c7">indic_face_pena_global</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classVect__RefObjU.html">Vect_RefObjU</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classVect__DoubleTab.html">Vect_DoubleTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvection__Diffusion__Temperature.html#a9595595fb4b98825455db3dd680d3f64">tab_penalisation_L2_FTD</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>classe <a class="el" href="classConvection__Diffusion__Temperature.html" title="classe Convection_Diffusion_Temperature Cas particulier de Convection_Diffusion_std quand le scalaire...">Convection_Diffusion_Temperature</a><br/>
Cas particulier de <a class="el" href="classConvection__Diffusion__std.html" title="classe Convection_Diffusion_std Cette classe est la base des equations modelisant le transport d&#39;un s...">Convection_Diffusion_std</a><br/>
quand le scalaire subissant le transport est la temperature. </p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00041">41</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="af0de5f9783ab6a53630208272172507a"></a><!-- doxytag: member="Convection_Diffusion_Temperature::~Convection_Diffusion_Temperature" ref="af0de5f9783ab6a53630208272172507a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Convection_Diffusion_Temperature::~Convection_Diffusion_Temperature </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00044">44</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab120e13159e4bf366b3a4616804aad42"></a><!-- doxytag: member="Convection_Diffusion_Temperature::Convection_Diffusion_Temperature" ref="ab120e13159e4bf366b3a4616804aad42" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Convection_Diffusion_Temperature::Convection_Diffusion_Temperature </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00047">47</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Champs__compris_8cpp_source.html#l00227">Champs_compris::ajoute_nom_compris()</a>, <a class="el" href="Equation__base_8h_source.html#l00318">Equation_base::champs_compris_</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00090">choix_pena</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00089">eta</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00093">indic_face_pena_global</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00092">indic_pena_global</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00088">is_penalized</a>, and <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00091">tag_indic_pena_global</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// champs_compris_.ajoute_nom_compris(&quot;temperature_paroi&quot;);</span>
  <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;gradient_temperature&quot;</span>);
  <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;h_echange_&quot;</span>);
  <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;temperature_residu&quot;</span>);
  <a class="code" href="classConvection__Diffusion__Temperature.html#aedbe5cc441073edc75ff1b7e491aa620">eta</a> = 1.0;
  <a class="code" href="classConvection__Diffusion__Temperature.html#a076e32b9ad994a4121452cb3829b9273">is_penalized</a> = 0;
  <a class="code" href="classConvection__Diffusion__Temperature.html#aa281e6ca4e8b6de76091836eb6d62ae3">tag_indic_pena_global</a> = -1;
  <a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a> = 0;
  <a class="code" href="classConvection__Diffusion__Temperature.html#ac11d5686f6bcdd802887cd66c01a54c7">indic_face_pena_global</a> = 0;
  <a class="code" href="classConvection__Diffusion__Temperature.html#a7038fcce2e880fcf5580f291a4a35ebe">choix_pena</a> = 0;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="afb5baf5187a88ec71af939b53385b0c7"></a><!-- doxytag: member="Convection_Diffusion_Temperature::assembler" ref="afb5baf5187a88ec71af939b53385b0c7" args="(Matrice_Morse &amp;mat_morse, const DoubleTab &amp;present, DoubleTab &amp;secmem)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Convection_Diffusion_Temperature::assembler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>mat_morse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>present</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>secmem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; la derivee est multipliee par rhoCp pour la convection</p>
<p>&lt; Ajout de A*Inco(n) PL (11/04/2018): On aimerait bien calculer la contribution des sources en premier comme dans le cas VIA_CONTRIBUER_AU_SECOND_MEMBRE mais le cas Canal_perio_3D (keps periodique plante: il y'a une erreur de periodicite dans les termes sources du modele KEps... </p>
</p>

<p>Reimplemented from <a class="el" href="classEquation__base.html#a8dbd9212dcd3e8277d21a4b24b04bd65">Equation_base</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00705">705</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Sources_8cpp_source.html#l00132">Sources::ajouter()</a>, <a class="el" href="classOperateur.html#accdf61cf1e33fb42e9eb06f1c501422b">Operateur::ajouter()</a>, <a class="el" href="Matrice__Base_8h_source.html#l00230">Matrice_Base::ajouter_multvect()</a>, <a class="el" href="Statistiques_8h_source.html#l00219">Statistiques::begin_count()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Discretisation__base_8h_source.html#l00081">Discretisation_base::codage_du_calcul_du_residu()</a>, <a class="el" href="Sources_8cpp_source.html#l00307">Sources::contribuer_a_avec()</a>, <a class="el" href="Operateur__base_8cpp_source.html#l00336">Operateur_base::contribuer_a_avec()</a>, <a class="el" href="Probleme__base_8h_source.html#l00314">Probleme_base::discretisation()</a>, <a class="el" href="Statistiques_8h_source.html#l00237">Statistiques::end_count()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Matrice__Morse_8h_source.html#l00129">Matrice_Morse::get_set_coeff()</a>, <a class="el" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">Operateur::l_op_base()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00078">le_fluide</a>, <a class="el" href="Convection__Diffusion__std_8cpp_source.html#l00117">Convection_Diffusion_std::nombre_d_operateurs()</a>, <a class="el" href="Convection__Diffusion__std_8cpp_source.html#l00140">Convection_Diffusion_std::operateur()</a>, <a class="el" href="Equation__base_8cpp_source.html#l00964">Equation_base::probleme()</a>, <a class="el" href="Objet__U_8cpp_source.html#l00132">Objet_U::que_suis_je()</a>, <a class="el" href="Equation__base_8cpp_source.html#l00578">Equation_base::sources()</a>, <a class="el" href="Statistiques_8h_source.html#l00190">statistiques()</a>, <a class="el" href="Operateur__base_8cpp_source.html#l00666">Operateur_base::tester_contribuer_a_avec()</a>, <a class="el" href="Discretisation__base_8h_source.html#l00078">Discretisation_base::VIA_AJOUTER</a>, and <a class="el" href="Discretisation__base_8h_source.html#l00077">Discretisation_base::VIA_CONTRIBUER_AU_SECOND_MEMBRE</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <span class="keywordtype">double</span> rhoCp = <a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>-&gt;capacite_calorifique().valeurs()(0, 0) * <a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>-&gt;masse_volumique().valeurs()(0, 0);

<span class="comment">// Test de verification de la methode contribuer_a_avec</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> op=0; op&lt;<a class="code" href="classConvection__Diffusion__std.html#a1eccdf9e6aedfbf1914e9fa95962fbf9" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: 2 pour une equation de diffusion.">nombre_d_operateurs</a>(); op++)
    <a class="code" href="classConvection__Diffusion__std.html#a4bb82d17dd39ba9d8531764b2800a8bd" title="Renvoie l&#39;operateur specifie par son index: renvoie terme_diffusif si i = 0 renvoie terme_convectif s...">operateur</a>(op).<a class="code" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">l_op_base</a>().<a class="code" href="classOperateur__base.html#a3640f8feaeac1bf4d8ff3777c233753c">tester_contribuer_a_avec</a>(inco, matrice);

<span class="comment">// Contribution des operateurs et des sources:</span>
<span class="comment">// [Vol/dt+A]Inco(n+1)=somme(residu)+Vol/dt*Inco(n)</span>
<span class="comment">// Typiquement: si Op=flux(Inco) alors la matrice implicite A contient une contribution -dflux/dInco</span>
<span class="comment">// Exemple: Op flux convectif en VDF:</span>
<span class="comment">// Op=T*u*S et A=-d(T*u*S)/dT=-u*S</span>
  <span class="keyword">const</span> <a class="code" href="classDiscretisation__base.html#ad6b02af5532904375c2384825f2d4ea0">Discretisation_base::type_calcul_du_residu</a>&amp; type_codage=<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#ac2bc635ab5b121c1cab78b6f98c0b203" title="Renvoie la discretisation associee au probleme.">discretisation</a>().<a class="code" href="classDiscretisation__base.html#a9d643031e55125e1b99dcafa32a4c54c">codage_du_calcul_du_residu</a>();
  <span class="keywordflow">if</span> (type_codage==<a class="code" href="classDiscretisation__base.html#ad6b02af5532904375c2384825f2d4ea0a6da3daf19c0be297ebb5c28e3ad11b2d">Discretisation_base::VIA_CONTRIBUER_AU_SECOND_MEMBRE</a>)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;VIA_CONTRIBUER_AU_SECOND_MEMBRE pas code pour &quot;</span> &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot;:assembler&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<span class="comment">// // On calcule somme(residu) par contribuer_au_second_membre (typiquement CL non implicitees)</span>
<span class="comment">// // Cette approche necessite de coder 3 methodes (contribuer_a_avec, contribuer_au_second_membre et ajouter pour l&#39;explicite)</span>
<span class="comment">// sources().contribuer_a_avec(inco,matrice);</span>
<span class="comment">// statistiques().end_count(assemblage_sys_counter_,0,0);</span>
<span class="comment">// sources().ajouter(resu);</span>
<span class="comment">// statistiques().begin_count(assemblage_sys_counter_);</span>
<span class="comment">// matrice.ajouter_multvect(inco, resu); // Add source residual first</span>
<span class="comment">// for (int op = 0; op &lt; nombre_d_operateurs(); op++)</span>
<span class="comment">// {</span>
<span class="comment">// operateur(op).l_op_base().contribuer_a_avec(inco, matrice);</span>
<span class="comment">// operateur(op).l_op_base().contribuer_au_second_membre(resu);</span>
<span class="comment">// }</span>
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type_codage==<a class="code" href="classDiscretisation__base.html#ad6b02af5532904375c2384825f2d4ea0ab1b0885ce8af07e1563ae012e4822f6e">Discretisation_base::VIA_AJOUTER</a>)
    {
<span class="comment">// On calcule somme(residu) par somme(operateur)+sources+A*Inco(n)</span>
<span class="comment">// Cette approche necessite de coder seulement deux methodes (contribuer_a_avec et ajouter)</span>
<span class="comment">// Donc un peu plus couteux en temps de calcul mais moins de code a ecrire/maintenir</span>
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> op=0; op&lt;<a class="code" href="classConvection__Diffusion__std.html#a1eccdf9e6aedfbf1914e9fa95962fbf9" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: 2 pour une equation de diffusion.">nombre_d_operateurs</a>(); op++)
        {
          <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> mat(matrice);
          mat.get_set_coeff() = 0.0;
          <a class="code" href="classConvection__Diffusion__std.html#a4bb82d17dd39ba9d8531764b2800a8bd" title="Renvoie l&#39;operateur specifie par son index: renvoie terme_diffusif si i = 0 renvoie terme_convectif s...">operateur</a>(op).<a class="code" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">l_op_base</a>().<a class="code" href="classOperateur__base.html#a903e728aad8e2d490580bf264319d65f" title="NE FAIT RIEN A surcharger dans les classes derivees.">contribuer_a_avec</a>(inco, mat);
          <span class="keywordflow">if</span> (op == 1) mat *= rhoCp; <span class="comment">//!&lt; la derivee est multipliee par rhoCp pour la convection</span>
<span class="comment"></span>          matrice += mat;
          <a class="code" href="Statistiques_8h.html#a7bb2ce53a9ec088bba93ddcfce2b8cb1">statistiques</a>().<a class="code" href="classStatistiques.html#a0faf52d1b518f5b0b2177f22efcc222d" title="Arret du compteur counter_id. On ajoute quantity a la somme des &#39;quantity&#39; (par defaut 0) stockees po...">end_count</a>(<a class="code" href="Equation__base_8cpp.html#a918aa9eada292ff09f7d2959342d3c2c">assemblage_sys_counter_</a>, 0, 0);
          {
            <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> resu_tmp(resu);
            resu_tmp = 0.;
            <a class="code" href="classConvection__Diffusion__std.html#a4bb82d17dd39ba9d8531764b2800a8bd" title="Renvoie l&#39;operateur specifie par son index: renvoie terme_diffusif si i = 0 renvoie terme_convectif s...">operateur</a>(op).<a class="code" href="classOperateur.html#accdf61cf1e33fb42e9eb06f1c501422b">ajouter</a>(inco, resu_tmp);
            <span class="keywordflow">if</span> (op == 1) resu_tmp *= rhoCp;
            resu += resu_tmp;
          }
          <a class="code" href="Statistiques_8h.html#a7bb2ce53a9ec088bba93ddcfce2b8cb1">statistiques</a>().<a class="code" href="classStatistiques.html#affcd058809786918ed173aaf681d0843">begin_count</a>(<a class="code" href="Equation__base_8cpp.html#a918aa9eada292ff09f7d2959342d3c2c">assemblage_sys_counter_</a>);
        }
      <a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>().<a class="code" href="classSources.html#aa91bceeb92650bc8b60a94f193a9d689" title="contribution a la matrice implicite des termes sources par defaut pas de contribution">contribuer_a_avec</a>(inco,matrice);
      <a class="code" href="Statistiques_8h.html#a7bb2ce53a9ec088bba93ddcfce2b8cb1">statistiques</a>().<a class="code" href="classStatistiques.html#a0faf52d1b518f5b0b2177f22efcc222d" title="Arret du compteur counter_id. On ajoute quantity a la somme des &#39;quantity&#39; (par defaut 0) stockees po...">end_count</a>(<a class="code" href="Equation__base_8cpp.html#a918aa9eada292ff09f7d2959342d3c2c">assemblage_sys_counter_</a>,0,0);
      <a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>().<a class="code" href="classSources.html#a6fc277f1920a71841cb041dc1b6ed771" title="Ajoute la contribution de toutes les sources de la liste au tableau passe en parametre, et renvoie ce tableau.">ajouter</a>(resu);
      <a class="code" href="Statistiques_8h.html#a7bb2ce53a9ec088bba93ddcfce2b8cb1">statistiques</a>().<a class="code" href="classStatistiques.html#affcd058809786918ed173aaf681d0843">begin_count</a>(<a class="code" href="Equation__base_8cpp.html#a918aa9eada292ff09f7d2959342d3c2c">assemblage_sys_counter_</a>);
      matrice.ajouter_multvect(inco, resu); <span class="comment">//!&lt; Ajout de A*Inco(n) PL (11/04/2018): On aimerait bien calculer la contribution des sources en premier comme dans le cas VIA_CONTRIBUER_AU_SECOND_MEMBRE mais le cas Canal_perio_3D (keps periodique plante: il y&#39;a une erreur de periodicite dans les termes sources du modele KEps...</span>
<span class="comment"></span><span class="comment">//</span>
<span class="comment">//</span>
<span class="comment">//</span>
    }
  <span class="keywordflow">else</span>
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Unknown value in Equation_base::assembler for &quot;</span> &lt;&lt; (int)type_codage &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4631234386db71af1be20fb46dbfbecb"></a><!-- doxytag: member="Convection_Diffusion_Temperature::associer_fluide" ref="a4631234386db71af1be20fb46dbfbecb" args="(const Fluide_base &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Convection_Diffusion_Temperature::associer_fluide </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFluide__base.html">Fluide_base</a> &amp;&#160;</td>
          <td class="paramname"><em>un_fluide</em></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Associe un fluide incompressible a l'equation. </p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00126">126</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00191">associer_milieu_base()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a> = un_fluide;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aed44e94dd98d13bdbca8ef967f80a047"></a><!-- doxytag: member="Convection_Diffusion_Temperature::associer_milieu_base" ref="aed44e94dd98d13bdbca8ef967f80a047" args="(const Milieu_base &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Convection_Diffusion_Temperature::associer_milieu_base </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMilieu__base.html">Milieu_base</a> &amp;&#160;</td>
          <td class="paramname"><em>un_milieu</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Associe un milieu physique a l'equation,<br/>
le milieu est en fait caste en <a class="el" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a> ou en <a class="el" href="classFluide__Ostwald.html" title="class Fluide_Ostwald Possede les proprietes d&#39;un fluide incompressible plus: N : indice de structure ...">Fluide_Ostwald</a>. </p>

<p>Implements <a class="el" href="classEquation__base.html#a1886b59d39b7d60afb39aadfb56b971b">Equation_base</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00191">191</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00126">associer_fluide()</a>, <a class="el" href="Milieu__base_8cpp_source.html#l00716">Milieu_base::beta_t()</a>, <a class="el" href="Milieu__base_8cpp_source.html#l00677">Milieu_base::capacite_calorifique()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Milieu__base_8cpp_source.html#l00638">Milieu_base::conductivite()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Process_8cpp_source.html#l00095">Process::je_suis_maitre()</a>, <a class="el" href="O__U__Ptr_8cpp_source.html#l00098">O_U_Ptr::non_nul()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, and <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>.</p>

<p>Referenced by <a class="el" href="Pb__Thermohydraulique__Concentration_8cpp_source.html#l00186">Pb_Thermohydraulique_Concentration::associer_milieu_base()</a>, and <a class="el" href="Pb__Thermohydraulique_8cpp_source.html#l00169">Pb_Thermohydraulique::associer_milieu_base()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classFluide__Ostwald.html" title="class Fluide_Ostwald Possede les proprietes d&#39;un fluide incompressible plus: N : indice de structure ...">Fluide_Ostwald</a>, un_milieu))
    {
      <span class="keyword">const</span> <a class="code" href="classFluide__Ostwald.html" title="class Fluide_Ostwald Possede les proprietes d&#39;un fluide incompressible plus: N : indice de structure ...">Fluide_Ostwald</a>&amp; un_fluide = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFluide__Ostwald.html" title="class Fluide_Ostwald Possede les proprietes d&#39;un fluide incompressible plus: N : indice de structure ...">Fluide_Ostwald</a>,un_milieu);
      <span class="keywordflow">if</span>  ((un_fluide.<a class="code" href="classMilieu__base.html#a99251c07d04e1f13ec4c300bfe8757db" title="Renvoie la conductivite du milieu. (version const)">conductivite</a>().<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>()) &amp;&amp;
           ((un_fluide.<a class="code" href="classMilieu__base.html#a174d49eab1db7dfce83578b227f4e702" title="Renvoie la capacite calorifique du milieu. (version const)">capacite_calorifique</a>().<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>()) &amp;&amp; (un_fluide.<a class="code" href="classMilieu__base.html#ab28c342e189615a38b91b0fc831ca235" title="Renvoie beta_t du milieu. (version const)">beta_t</a>().<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())))
        <a class="code" href="classConvection__Diffusion__Temperature.html#a4631234386db71af1be20fb46dbfbecb" title="Associe un fluide incompressible a l&#39;equation.">associer_fluide</a>(un_fluide);
      <span class="keywordflow">else</span>
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Vous n&#39;avez pas defini toutes les proprietes physiques du fluide &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;necessaires pour resoudre l&#39;equation d&#39;energie &quot;</span> &lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Verifier que vous avez defini: la conductivite (lambda)&quot;</span>&lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;                                  la capacite calorifique (Cp)&quot;</span>&lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;                                  le coefficient de dilatation thermique (beta_th)&quot;</span>&lt;&lt; finl;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
        }
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>,un_milieu))
    {
      <span class="keyword">const</span> <a class="code" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>&amp; un_fluide = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>,un_milieu);
      <span class="keywordflow">if</span>  ((un_fluide.<a class="code" href="classMilieu__base.html#a99251c07d04e1f13ec4c300bfe8757db" title="Renvoie la conductivite du milieu. (version const)">conductivite</a>().<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>()) &amp;&amp;
           ((un_fluide.<a class="code" href="classMilieu__base.html#a174d49eab1db7dfce83578b227f4e702" title="Renvoie la capacite calorifique du milieu. (version const)">capacite_calorifique</a>().<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>()) &amp;&amp; (un_fluide.<a class="code" href="classMilieu__base.html#ab28c342e189615a38b91b0fc831ca235" title="Renvoie beta_t du milieu. (version const)">beta_t</a>().<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())))
        <a class="code" href="classConvection__Diffusion__Temperature.html#a4631234386db71af1be20fb46dbfbecb" title="Associe un fluide incompressible a l&#39;equation.">associer_fluide</a>(un_fluide);
      <span class="keywordflow">else</span>
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Vous n&#39;avez pas defini toutes les proprietes physiques du fluide &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;necessaires pour resoudre l&#39;equation d&#39;energie &quot;</span> &lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Verifier que vous avez defini: la conductivite (lambda)&quot;</span>&lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;                                  la capacite calorifique (Cp)&quot;</span>&lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;                                  le coefficient de dilatation thermique (beta_th)&quot;</span>&lt;&lt; finl;

          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
        }
    }
  <span class="keywordflow">else</span>
    {
      <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
        <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;le fluide considere n&#39;est un sous fluide de Fluide_base, \n&quot;</span>
             &lt;&lt; <span class="stringliteral">&quot;ni un sous fluide de Fluide_Ostwald. &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a54112f5b487abbdfc59de04c562b1b26"></a><!-- doxytag: member="Convection_Diffusion_Temperature::calcul_indic_pena_global" ref="a54112f5b487abbdfc59de04c562b1b26" args="(IntTab &amp;, IntTab &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Convection_Diffusion_Temperature::calcul_indic_pena_global </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td>
          <td class="paramname"><em>indicatrice_totale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td>
          <td class="paramname"><em>indicatrice_face_totale</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01073">1073</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="IntTab_8cpp_source.html#l00499">IntTab::copy()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00033">Cout</a>, <a class="el" href="IntTab_8h_source.html#l00244">IntTab::dimension_tot()</a>, <a class="el" href="IntVect_8cpp_source.html#l00276">IntVect::echange_espace_virtuel()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="classTransport__Interfaces__base.html#a78dd18b060f3370efbfb4fbb230ce626">Transport_Interfaces_base::get_update_indicatrice()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00093">indic_face_pena_global</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00092">indic_pena_global</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00094">ref_penalisation_L2_FTD</a>, <a class="el" href="vect__impl_8h_source.html#l00057">vect_impl::size()</a>, <a class="el" href="Source__Generique__Face__PolyMAC_8cpp_source.html#l00045">valeur()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, and <a class="el" href="Equation__base_8cpp_source.html#l00091">Equation_base::zone_dis()</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00900">mise_en_place_zone_fantome()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00806">set_indic_pena_globale()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// fonction characteristique globale ibc penalisees</span>
  indicatrice_totale.<a class="code" href="classIntTab.html#a3d200d04b7bf53a32c27867c42065a0e">copy</a>(<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>);
  indicatrice_face_totale.<a class="code" href="classIntTab.html#a3d200d04b7bf53a32c27867c42065a0e">copy</a>(<a class="code" href="classConvection__Diffusion__Temperature.html#ac11d5686f6bcdd802887cd66c01a54c7">indic_face_pena_global</a>);
  indicatrice_totale = 0;
  indicatrice_face_totale = 0;
  <span class="keywordtype">int</span> x=0;
  <span class="keywordtype">int</span> xf=0;
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem  = indicatrice_totale.<a class="code" href="classIntTab.html#a71e9b9ddc1793094b1b3f109377952b1" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
  <span class="keyword">const</span> <span class="keywordtype">int</span> nfaces = indicatrice_face_totale.<a class="code" href="classIntTab.html#a71e9b9ddc1793094b1b3f109377952b1" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
<span class="comment">// boucle sur les ibc</span>
  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> w = 0 ; w&lt;<a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>() ; ++w)
    {
      <a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>&amp; nom_eq = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>,<a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>[w].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
      <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; indicatrice = nom_eq.<a class="code" href="classTransport__Interfaces__base.html#a78dd18b060f3370efbfb4fbb230ce626">get_update_indicatrice</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<span class="comment">// fonction characteristique (0 ou 1) pour l&#39;ensemble des ibc</span>
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k_elem =0 ; k_elem &lt;nb_elem; ++k_elem)
        {
          <span class="keywordflow">if</span> (indicatrice(k_elem)&gt;0.)
            {
              <span class="keywordflow">if</span>(indicatrice_totale(k_elem) != 0)
                {
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;calcul_indic_pena_global : Attention: les elements des indicatrices se chevauchent &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
                  <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
                }
              indicatrice_totale(k_elem) = w+1;
              ++x;
            }
        }
<span class="comment">// fonction characteristique (numero ibc) pour l&#39;ensemble des ibc</span>
      <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zone_vf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
      <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_vf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nfaces ; i++)
        {
          <span class="keyword">const</span> <span class="keywordtype">int</span> elem0 = face_voisins(i, 0);
          <span class="keyword">const</span> <span class="keywordtype">int</span> elem1 = face_voisins(i, 1);
          <span class="keywordtype">double</span> indi = 0.;
          <span class="keywordflow">if</span> (elem0 &gt;= 0) indi = indicatrice(elem0);
          <span class="keywordflow">if</span> (elem1 &gt;= 0) indi += indicatrice(elem1);
          <span class="keywordflow">if</span>(indi &gt; 0.)
            {
              <span class="keywordflow">if</span>(indicatrice_face_totale(i) !=  0)
                {
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;calcul_indic_pena_global : Attention: les faces des indicatrices se chevauchent &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
                  <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
                }
              indicatrice_face_totale(i) = w+1;
              ++xf;
            }
        }
    }
  <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<span class="stringliteral">&quot;Calcul_indic_pena_global : Nb d elements de l indicatrice globale des IBCs: &quot;</span>&lt;&lt;x;
  <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<span class="stringliteral">&quot;  et nb de faces : &quot;</span>&lt;&lt;xf&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  indicatrice_totale.<a class="code" href="classIntVect.html#ad12bea67621d1a0ee82b27c9a37ca4ef">echange_espace_virtuel</a>();
  indicatrice_face_totale.<a class="code" href="classIntVect.html#ad12bea67621d1a0ee82b27c9a37ca4ef">echange_espace_virtuel</a>();
<span class="comment">// Debog::verifier(&quot;Convection_Diffusion_Temperature::calcul_indic_pena_global indicatrice_totale &quot;,indicatrice_totale);</span>
<span class="comment">// Debog::verifier(&quot;Convection_Diffusion_Temperature::calcul_indic_pena_global indicatrice_face_totale &quot;,indicatrice_face_totale);</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a43f36ade57358725c69ed4857fdfb7f7"></a><!-- doxytag: member="Convection_Diffusion_Temperature::cree_instance" ref="a43f36ade57358725c69ed4857fdfb7f7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classObjet__U.html">Objet_U</a> * Convection_Diffusion_Temperature::cree_instance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00044">44</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3bacf8f6add8a055cdabf1c7c8095400"></a><!-- doxytag: member="Convection_Diffusion_Temperature::creer_champ" ref="a3bacf8f6add8a055cdabf1c7c8095400" args="(const Motcle &amp;motlu)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Convection_Diffusion_Temperature::creer_champ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMotcle.html">Motcle</a> &amp;&#160;</td>
          <td class="paramname"><em>motlu</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classEquation__base.html#a1e62c4d38b25e577585c5e1d9a8942d9">Equation_base</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00400">400</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Champs__compris_8cpp_source.html#l00198">Champs_compris::ajoute_champ()</a>, <a class="el" href="Equation__base_8h_source.html#l00318">Equation_base::champs_compris_</a>, <a class="el" href="Equation__base_8cpp_source.html#l01389">Equation_base::discretisation()</a>, <a class="el" href="Discret__Thyd_8cpp_source.html#l00273">Discret_Thyd::grad_T()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00081">gradient_temperature</a>, <a class="el" href="Discret__Thyd_8cpp_source.html#l00280">Discret_Thyd::h_conv()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00085">h_echange</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00077">la_temperature</a>, <a class="el" href="O__U__Ptr_8cpp_source.html#l00098">O_U_Ptr::non_nul()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Convection__Diffusion__Concentration_8cpp_source.html#l00357">string2int()</a>, <a class="el" href="Nom_8cpp_source.html#l00428">Nom::suffix()</a>, <a class="el" href="Equation__base_8h_source.html#l00391">Equation_base::zone_Cl_dis()</a>, and <a class="el" href="Equation__base_8cpp_source.html#l00091">Equation_base::zone_dis()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classConvection__Diffusion__Temperature.html#a3bacf8f6add8a055cdabf1c7c8095400">Convection_Diffusion_std::creer_champ</a>(motlu);

  <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> nom_mot(motlu),temp_mot(nom_mot);
  <span class="comment">/*  if (motlu == &quot;temperature_paroi&quot;)</span>
<span class="comment">      {</span>
<span class="comment">        if (!temperature_paroi.non_nul())</span>
<span class="comment">          {</span>
<span class="comment">            const Discret_Thyd&amp; dis=ref_cast(Discret_Thyd, discretisation());</span>
<span class="comment">            dis.t_paroi(zone_dis(),zone_Cl_dis(),*this,temperature_paroi);</span>
<span class="comment">            champs_compris_.ajoute_champ(temperature_paroi);</span>
<span class="comment">          }</span>
<span class="comment">      } */</span>
  <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;gradient_temperature&quot;</span>)
    {
      <span class="keywordflow">if</span> (!<a class="code" href="classConvection__Diffusion__Temperature.html#a9791260817ac5155c177a3d98f5d9ba6">gradient_temperature</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
        {
          <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>, <a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
          dis.<a class="code" href="classDiscret__Thyd.html#a57082f56b0091bf87b5524733fd86167">grad_T</a>(<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(),<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>(),<a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>,<a class="code" href="classConvection__Diffusion__Temperature.html#a9791260817ac5155c177a3d98f5d9ba6">gradient_temperature</a>);
          <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classConvection__Diffusion__Temperature.html#a9791260817ac5155c177a3d98f5d9ba6">gradient_temperature</a>);
        }
    }
  <span class="keywordflow">if</span> (nom_mot.debute_par(<span class="stringliteral">&quot;H_ECHANGE&quot;</span>))
    {
      <span class="keywordflow">if</span> (!<a class="code" href="classConvection__Diffusion__Temperature.html#a0a86082c4a7dc0d65dc2b152a79c6d9a">h_echange</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
        {
          <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>, <a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
          temp_mot.suffix(<span class="stringliteral">&quot;H_ECHANGE_&quot;</span>);
          <span class="keywordtype">int</span> temperature;
          <a class="code" href="Convection__Diffusion__Concentration_8cpp.html#a43724dfda1f6defe25a6b6aa60365cfa" title="Renvoie 1 si le mot clef specifie designe un type de champ inconnue de l&#39;equation. Renvoie 1 si mot = &quot;concentration&quot; Renvoie 0 sinon Si la methode renvoie 1 ch_ref fait reference au champ, dont le type a ete specifie.">string2int</a>(temp_mot,temperature);
          dis.<a class="code" href="classDiscret__Thyd.html#afeb016b0c869f407fbb75f63860b8800">h_conv</a>(<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(),<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>(),<a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>,<a class="code" href="classConvection__Diffusion__Temperature.html#a0a86082c4a7dc0d65dc2b152a79c6d9a">h_echange</a>,nom_mot,temperature);
          <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classConvection__Diffusion__Temperature.html#a0a86082c4a7dc0d65dc2b152a79c6d9a">h_echange</a>);
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2e65653eeca0056bb6bb485ba0bbc64c"></a><!-- doxytag: member="Convection_Diffusion_Temperature::derivee_en_temps_inco" ref="a2e65653eeca0056bb6bb485ba0bbc64c" args="(DoubleTab &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Convection_Diffusion_Temperature::derivee_en_temps_inco </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>derivee</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the time derivative of the unknown I of the equation:<br/>
dI/dt = M-1*(sum(operators(I) + sources))<br/>
In : derivee contains I (but immediatly set to 0)<br/>
Out: derivee contains dI/dt. </p>

<p><p>&lt; Change secmem for some schemes (eg: Adams_Bashforth)</p>
<p>&lt; Change secmem for some schemes (eg: Adams_Bashforth)</p>
<p>&lt; Add specific term for an equation (eg: -gradP for Navier Stokes)</p>
<p>&lt; M-1 * secmem</p>
<p>&lt; Solve specific implicit term for an equation (eg: pressure for Navier Stokes) </p>
</p>

<p>Reimplemented from <a class="el" href="classEquation__base.html#a97aa87b0cf6205ef437a6774adf1bd47">Equation_base</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00505">505</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Sources_8cpp_source.html#l00132">Sources::ajouter()</a>, <a class="el" href="Solveur__Masse_8h_source.html#l00087">Solveur_Masse::appliquer()</a>, <a class="el" href="Equation__base_8h_source.html#l00276">Equation_base::calculate_time_derivative()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00466">DoubleTab::copy()</a>, <a class="el" href="Array__base_8h_source.html#l00038">Array_base::COPY_INIT</a>, <a class="el" href="Equation__base_8h_source.html#l00264">Equation_base::derivee_en_temps()</a>, <a class="el" href="Equation__base_8cpp_source.html#l01775">Equation_base::derivee_en_temps_conv()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00561">derivee_en_temps_inco_eq_base()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01059">filtrage_si_appart_ibc()</a>, <a class="el" href="Equation__base_8h_source.html#l00244">Equation_base::Gradient_conjugue_diff_impl()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00147">inconnue()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00088">is_penalized</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00078">le_fluide</a>, <a class="el" href="Equation__base_8h_source.html#l00292">Equation_base::les_sources</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00900">mise_en_place_zone_fantome()</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00343">Schema_Temps_base::modifier_second_membre()</a>, <a class="el" href="Convection__Diffusion__std_8cpp_source.html#l00117">Convection_Diffusion_std::nombre_d_operateurs()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01133">penalisation_L2()</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="Equation__base_8h_source.html#l00291">Equation_base::solveur_masse</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00818">transport_ibc()</a>, and <a class="el" href="Champ__Inc_8cpp_source.html#l00245">Champ_Inc::valeurs()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (!<a class="code" href="classConvection__Diffusion__Temperature.html#a076e32b9ad994a4121452cb3829b9273">is_penalized</a>)
    {
      <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#a7fb7465179789422db192cb948c37b06">derivee_en_temps_inco_eq_base</a>(derivee);
    }
  <span class="keywordflow">else</span>
    {
      <span class="keyword">const</span> <span class="keywordtype">double</span> rhoCp = <a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>-&gt;capacite_calorifique().valeurs()(0, 0) * <a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>-&gt;masse_volumique().valeurs()(0, 0);
<span class="comment">// Specific code if temperature equation is penalized</span>
      derivee=<a class="code" href="classConvection__Diffusion__Temperature.html#aab6a891f15e7996eda73b1b6e67e7dbd" title="Renvoie le champ inconnue representant la temperatue. (version const)">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<span class="comment">// Mise en place d&#39;une methode de mise en place d&#39;une zone fantome</span>
      <a class="code" href="classConvection__Diffusion__Temperature.html#a3689afde81dff034b576b7dab3b0da59">mise_en_place_zone_fantome</a>(derivee);
      <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inc=<a class="code" href="classConvection__Diffusion__Temperature.html#aab6a891f15e7996eda73b1b6e67e7dbd" title="Renvoie le champ inconnue representant la temperatue. (version const)">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
      inc = derivee;

      <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> secmem(derivee);

      <span class="keywordflow">if</span> (<a class="code" href="classConvection__Diffusion__std.html#a1eccdf9e6aedfbf1914e9fa95962fbf9" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: 2 pour une equation de diffusion.">nombre_d_operateurs</a>()&gt;1)
        {
          <a class="code" href="classEquation__base.html#a20d04d53bd0c4b48aa923c2b328bb1e3" title="Add convection term In: solution is the unknown I Out: secmem is increased by convection(I)">derivee_en_temps_conv</a>(secmem, derivee);
          secmem *= rhoCp;
        }

<span class="comment">// Transport des ibcs et de la couche limite</span>
      <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> secmem_conv_vr(derivee);
<span class="comment">// on advecte la variable avec la vitesse ibc</span>
      <a class="code" href="classConvection__Diffusion__Temperature.html#a82affa83cd11442b4b18d0e7114d4b08">transport_ibc</a>(secmem_conv_vr, derivee);
<span class="comment">// on retranche cette advection</span>
      secmem -= secmem_conv_vr;

      <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> derivee_conv;
      derivee_conv.<a class="code" href="classDoubleTab.html#aa4dd124734ab5d6cb7aa93a104c0868e">copy</a>(secmem, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffa9a675e25b5b7accff8d861e05060547b">Array_base::COPY_INIT</a>);

      <a class="code" href="classEquation__base.html#a6dae2cb8a228b0e3a6d90042fd75f360">les_sources</a>.<a class="code" href="classSources.html#a6fc277f1920a71841cb041dc1b6ed771" title="Ajoute la contribution de toutes les sources de la liste au tableau passe en parametre, et renvoie ce tableau.">ajouter</a>(secmem);

      <a class="code" href="classConvection__Diffusion__Temperature.html#a9158886a17c4c95aaad8071763bc7ff1">filtrage_si_appart_ibc</a>(derivee_conv,secmem);
      secmem.echange_espace_virtuel();

      <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#ade5df25cd0183395ae30a9865e23611c">calculate_time_derivative</a>())
        {
<span class="comment">// Store dI/dt(n) = M-1 secmem :</span>
          <a class="code" href="classEquation__base.html#a10fb27f5c41123bf4ff96e616549f6d7">derivee_en_temps</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>()=secmem;
          <a class="code" href="classEquation__base.html#aaaf61d60cca8205d2490a023633cc7d4">solveur_masse</a>.<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(<a class="code" href="classEquation__base.html#a10fb27f5c41123bf4ff96e616549f6d7">derivee_en_temps</a>().valeurs());
          <a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#aa363b76fa823b37bf9d1ae784f33bbfa">modifier_second_membre</a>((*<span class="keyword">this</span>),secmem); <span class="comment">//!&lt; Change secmem for some schemes (eg: Adams_Bashforth)</span>
<span class="comment"></span>        }

      <a class="code" href="classEquation__base.html#aaaf61d60cca8205d2490a023633cc7d4">solveur_masse</a>.<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(secmem);
      <a class="code" href="classEquation__base.html#abd67532530f67b3305703a130a5d823a">Equation_base::Gradient_conjugue_diff_impl</a>(secmem, derivee);

<span class="comment">// penalisation de la temperature</span>
      <a class="code" href="classConvection__Diffusion__Temperature.html#a22c0a145a3458c317b07d675b17517a4">penalisation_L2</a>(derivee);
      <span class="keywordflow">return</span> derivee;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7fb7465179789422db192cb948c37b06"></a><!-- doxytag: member="Convection_Diffusion_Temperature::derivee_en_temps_inco_eq_base" ref="a7fb7465179789422db192cb948c37b06" args="(DoubleTab &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Convection_Diffusion_Temperature::derivee_en_temps_inco_eq_base </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>derivee</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; Change secmem for some schemes (eg: Adams_Bashforth)</p>
<p>&lt; Add specific term for an equation (eg: -gradP for Navier Stokes)</p>
<p>&lt; M-1 * secmem</p>
<p>&lt; Solve specific implicit term for an equation (eg: pressure for Navier Stokes) </p>
</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00561">561</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Sources_8cpp_source.html#l00132">Sources::ajouter()</a>, <a class="el" href="classOperateur.html#accdf61cf1e33fb42e9eb06f1c501422b">Operateur::ajouter()</a>, <a class="el" href="Solveur__Masse_8h_source.html#l00153">Solveur_Masse::ajouter_masse()</a>, <a class="el" href="Solveur__Masse_8h_source.html#l00087">Solveur_Masse::appliquer()</a>, <a class="el" href="Equation__base_8h_source.html#l00276">Equation_base::calculate_time_derivative()</a>, <a class="el" href="classOperateur.html#a203dd066e5203d6e9a02298b8ec12e09">Operateur::calculer()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Operateur__base_8cpp_source.html#l00336">Operateur_base::contribuer_a_avec()</a>, <a class="el" href="Operateur__base_8cpp_source.html#l00369">Operateur_base::contribuer_au_second_membre()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02165">Equation_base::corriger_derivee_expl()</a>, <a class="el" href="Equation__base_8cpp_source.html#l02169">Equation_base::corriger_derivee_impl()</a>, <a class="el" href="Solveur__Masse_8h_source.html#l00180">Solveur_Masse::corriger_solution()</a>, <a class="el" href="Equation__base_8h_source.html#l00264">Equation_base::derivee_en_temps()</a>, <a class="el" href="Equation__base_8cpp_source.html#l01775">Equation_base::derivee_en_temps_conv()</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00904">Schema_Temps_base::diffusion_implicite()</a>, <a class="el" href="Operateur__base_8cpp_source.html#l00225">Operateur_base::dimensionner()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Operateur__base_8h_source.html#l00194">Operateur_base::get_decal_temps()</a>, <a class="el" href="Operateur__base_8h_source.html#l00206">Operateur_base::get_matrice()</a>, <a class="el" href="Operateur__base_8h_source.html#l00222">Operateur_base::get_solveur()</a>, <a class="el" href="Equation__base_8h_source.html#l00244">Equation_base::Gradient_conjugue_diff_impl()</a>, <a class="el" href="Equation__base_8h_source.html#l00313">Equation_base::implicite_</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00147">inconnue()</a>, <a class="el" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">Operateur::l_op_base()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00078">le_fluide</a>, <a class="el" href="Equation__base_8h_source.html#l00292">Equation_base::les_sources</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00343">Schema_Temps_base::modifier_second_membre()</a>, <a class="el" href="Convection__Diffusion__std_8cpp_source.html#l00117">Convection_Diffusion_std::nombre_d_operateurs()</a>, <a class="el" href="O__U__Ptr_8cpp_source.html#l00098">O_U_Ptr::non_nul()</a>, <a class="el" href="Convection__Diffusion__std_8cpp_source.html#l00140">Convection_Diffusion_std::operateur()</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00576">Schema_Temps_base::pas_de_temps()</a>, <a class="el" href="Objet__U_8cpp_source.html#l00132">Objet_U::que_suis_je()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00062">ref_cast_non_const</a>, <a class="el" href="SolveurSys_8cpp_source.html#l00052">SolveurSys::resoudre_systeme()</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="Matrice__Sym_8cpp_source.html#l00032">Matrice_Sym::set_est_definie()</a>, <a class="el" href="Operateur__base_8h_source.html#l00210">Operateur_base::set_matrice()</a>, <a class="el" href="Operateur__base_8h_source.html#l00226">Operateur_base::set_solveur()</a>, <a class="el" href="Equation__base_8h_source.html#l00432">Equation_base::solv_masse()</a>, <a class="el" href="Equation__base_8h_source.html#l00291">Equation_base::solveur_masse</a>, <a class="el" href="Equation__base_8h_source.html#l00310">Equation_base::sys_invariant_</a>, <a class="el" href="Deriv___8cpp_source.html#l00091">Deriv_::typer()</a>, <a class="el" href="Deriv__Matrice__Base_8h_source.html#l00028">Deriv_Matrice_Base::valeur()</a>, and <a class="el" href="Champ__Inc_8cpp_source.html#l00245">Champ_Inc::valeurs()</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00505">derivee_en_temps_inco()</a>.</p>
<div class="fragment"><pre class="fragment">{
  derivee=0;
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> secmem(derivee);

  <span class="keyword">const</span> <span class="keywordtype">double</span> rhoCp = <a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>-&gt;capacite_calorifique().valeurs()(0, 0) * <a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>-&gt;masse_volumique().valeurs()(0, 0);

<span class="comment">// secmem = sum(operators) + sources + equation specific terms</span>
  <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#af19143270478f1a870292550da641a94" title="Renvoie 1 si le schema en temps a ete lu diffusion_implicite.">diffusion_implicite</a>())
    {
<span class="comment">// Add convection operator only if equation has one</span>
      derivee = <a class="code" href="classConvection__Diffusion__Temperature.html#aab6a891f15e7996eda73b1b6e67e7dbd" title="Renvoie le champ inconnue representant la temperatue. (version const)">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
      <span class="keywordflow">if</span> (<a class="code" href="classConvection__Diffusion__std.html#a1eccdf9e6aedfbf1914e9fa95962fbf9" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: 2 pour une equation de diffusion.">nombre_d_operateurs</a>()&gt;1)
        {
          <a class="code" href="classEquation__base.html#a20d04d53bd0c4b48aa923c2b328bb1e3" title="Add convection term In: solution is the unknown I Out: secmem is increased by convection(I)">derivee_en_temps_conv</a>(secmem, derivee);
          secmem *= rhoCp;
        }
    }
  <span class="keywordflow">else</span>
    {
<span class="comment">// Add all explicit operators</span>
      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classConvection__Diffusion__std.html#a1eccdf9e6aedfbf1914e9fa95962fbf9" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: 2 pour une equation de diffusion.">nombre_d_operateurs</a>(); i++)
        <span class="keywordflow">if</span>(<a class="code" href="classConvection__Diffusion__std.html#a4bb82d17dd39ba9d8531764b2800a8bd" title="Renvoie l&#39;operateur specifie par son index: renvoie terme_diffusif si i = 0 renvoie terme_convectif s...">operateur</a>(i).<a class="code" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">l_op_base</a>().<a class="code" href="classOperateur__base.html#ae7dae6829b1287b470717b08a8ae761e">get_decal_temps</a>()!=1)
          {
            <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> secmem_tmp(secmem);
            <a class="code" href="classConvection__Diffusion__std.html#a4bb82d17dd39ba9d8531764b2800a8bd" title="Renvoie l&#39;operateur specifie par son index: renvoie terme_diffusif si i = 0 renvoie terme_convectif s...">operateur</a>(i).<a class="code" href="classOperateur.html#accdf61cf1e33fb42e9eb06f1c501422b">ajouter</a>(secmem_tmp);
            <span class="keywordflow">if</span> (i == 1) secmem_tmp *= rhoCp;
            secmem += secmem_tmp;
          }
    }
  <a class="code" href="classEquation__base.html#a6dae2cb8a228b0e3a6d90042fd75f360">les_sources</a>.<a class="code" href="classSources.html#a6fc277f1920a71841cb041dc1b6ed771" title="Ajoute la contribution de toutes les sources de la liste au tableau passe en parametre, et renvoie ce tableau.">ajouter</a>(secmem);

  <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#ade5df25cd0183395ae30a9865e23611c">calculate_time_derivative</a>())
    {
<span class="comment">// Store dI/dt(n) = M-1 secmem :</span>
      <a class="code" href="classEquation__base.html#a10fb27f5c41123bf4ff96e616549f6d7">derivee_en_temps</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>()=secmem;
      <a class="code" href="classEquation__base.html#aaaf61d60cca8205d2490a023633cc7d4">solveur_masse</a>.<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(<a class="code" href="classEquation__base.html#a10fb27f5c41123bf4ff96e616549f6d7">derivee_en_temps</a>().valeurs());
      <a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#aa363b76fa823b37bf9d1ae784f33bbfa">modifier_second_membre</a>((*<span class="keyword">this</span>),secmem); <span class="comment">//!&lt; Change secmem for some schemes (eg: Adams_Bashforth)</span>
<span class="comment"></span>    }

  <a class="code" href="classEquation__base.html#a5c06feed3927199a5ff70fb1c3a10f2a">corriger_derivee_expl</a>(secmem); <span class="comment">//!&lt; Add specific term for an equation (eg: -gradP for Navier Stokes)</span>
<span class="comment"></span>
  <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#aef791a4afd5964d1b4dfd3d2ac3f5e5e">implicite_</a>==0)
    {
      <a class="code" href="classEquation__base.html#aaaf61d60cca8205d2490a023633cc7d4">solveur_masse</a>.<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(secmem); <span class="comment">//!&lt; M-1 * secmem</span>
<span class="comment"></span>      <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().diffusion_implicite())
        {
<span class="comment">// Solve: (1/dt + M-1*A)*dI = M-1 * secmem</span>
<span class="comment">// where A is the diffusion</span>
          <a class="code" href="classEquation__base.html#abd67532530f67b3305703a130a5d823a">Equation_base::Gradient_conjugue_diff_impl</a>(secmem, derivee);
        }
      <span class="keywordflow">else</span>
        {
          derivee = secmem;
          derivee.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
        }
      <a class="code" href="classEquation__base.html#ab1a4dff7878cb1c47efb1ecb7b5b31ae">corriger_derivee_impl</a>(derivee);  <span class="comment">//!&lt; Solve specific implicit term for an equation (eg: pressure for Navier Stokes)</span>
<span class="comment"></span>    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#aef791a4afd5964d1b4dfd3d2ac3f5e5e">implicite_</a>&gt;0)
    {
<span class="comment">// TRUST support notices that this part has never been covered...</span>
<span class="comment">// implicite</span>
<span class="comment">// M dU/dt + AU* = f -BUn;</span>
<span class="comment">// U* = Un+dt dU/dt</span>
<span class="comment">// (M/dt + A) U* = f -BUn + M/dt Un</span>
<span class="comment">// </span>
      <span class="keywordtype">double</span> dt=<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classConvection__Diffusion__std.html#a1eccdf9e6aedfbf1914e9fa95962fbf9" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: 2 pour une equation de diffusion.">nombre_d_operateurs</a>(); i++)
        {
<span class="comment">// boucle sur les operateurs</span>
          <a class="code" href="classOperateur__base.html" title="classe Operateur_base Classe est la base de la hierarchie des objets representant un operateur utilis...">Operateur_base</a>&amp; op=<a class="code" href="classConvection__Diffusion__std.html#a4bb82d17dd39ba9d8531764b2800a8bd" title="Renvoie l&#39;operateur specifie par son index: renvoie terme_diffusif si i = 0 renvoie terme_convectif s...">operateur</a>(i).<a class="code" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">l_op_base</a>();
          <span class="keywordflow">if</span>(!op.<a class="code" href="classOperateur__base.html#a02e406fee1f2f32954a0fc6f1b86dca8">get_matrice</a>().<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
            op.<a class="code" href="classOperateur__base.html#a58bbc3d85feaa143ec0d87e68d8fe137">set_matrice</a>().<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Matrice_Morse&quot;</span>);
          <span class="keywordflow">if</span>(op.<a class="code" href="classOperateur__base.html#ae7dae6829b1287b470717b08a8ae761e">get_decal_temps</a>()==1)
            {
<span class="comment">// if (op.set_matrice().valeur().nb_lignes()&lt;2)</span>
              {
                <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>,op.<a class="code" href="classOperateur__base.html#a58bbc3d85feaa143ec0d87e68d8fe137">set_matrice</a>().<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
                op.<a class="code" href="classOperateur__base.html#a66ef3c42e72d13fce0852ba92e56be6a" title="NE FAIT RIEN A surcharger dans les classes derivees.">dimensionner</a>(matrice);
                <a class="code" href="classEquation__base.html#afd09d18db565d1acb431885b9c6d4a55">sys_invariant_</a>=0;
              }
              <span class="keywordflow">if</span>(!<a class="code" href="classEquation__base.html#afd09d18db565d1acb431885b9c6d4a55">sys_invariant_</a>)
                {
                  <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>, op.<a class="code" href="classOperateur__base.html#a58bbc3d85feaa143ec0d87e68d8fe137">set_matrice</a>().<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
                  op.<a class="code" href="classOperateur__base.html#a903e728aad8e2d490580bf264319d65f" title="NE FAIT RIEN A surcharger dans les classes derivees.">contribuer_a_avec</a>(<a class="code" href="classConvection__Diffusion__Temperature.html#aab6a891f15e7996eda73b1b6e67e7dbd" title="Renvoie le champ inconnue representant la temperatue. (version const)">inconnue</a>().valeurs(), matrice);
                  <a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#adc554d2f7efe81e71ff8995d4f2df8c7">ajouter_masse</a>(dt, op.<a class="code" href="classOperateur__base.html#a58bbc3d85feaa143ec0d87e68d8fe137">set_matrice</a>().<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());

                  <span class="keywordflow">if</span>(
                    (op.<a class="code" href="classOperateur__base.html#a2861e28bd5b9d3484c73271209b2e0b6">get_solveur</a>()-&gt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;Solv_Cholesky&quot;</span>)
                    ||
                    (op.<a class="code" href="classOperateur__base.html#a2861e28bd5b9d3484c73271209b2e0b6">get_solveur</a>()-&gt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()==<span class="stringliteral">&quot;Solv_GCP&quot;</span>)
                  )
                    {
                      <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a> new_mat(matrice);
                      new_mat.set_est_definie(1);
                      op.<a class="code" href="classOperateur__base.html#a58bbc3d85feaa143ec0d87e68d8fe137">set_matrice</a>()=new_mat;
                      <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classSolveurSys.html">SolveurSys</a>,op.<a class="code" href="classOperateur__base.html#a2861e28bd5b9d3484c73271209b2e0b6">get_solveur</a>())-&gt;reinit();
                    }
                }
            }
        }
      <span class="keywordflow">if</span>(<a class="code" href="classEquation__base.html#aef791a4afd5964d1b4dfd3d2ac3f5e5e">implicite_</a>==1)
        {
<span class="comment">// Un seul operateur implicite.</span>
<span class="comment">// On suppose que c&#39;est le premier (la diffusion !!)</span>
          <a class="code" href="classOperateur__base.html" title="classe Operateur_base Classe est la base de la hierarchie des objets representant un operateur utilis...">Operateur_base</a>&amp; op=<a class="code" href="classConvection__Diffusion__std.html#a4bb82d17dd39ba9d8531764b2800a8bd" title="Renvoie l&#39;operateur specifie par son index: renvoie terme_diffusif si i = 0 renvoie terme_convectif s...">operateur</a>(0).<a class="code" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">l_op_base</a>();
          <a class="code" href="classMatrice__Base.html">Matrice_Base</a>&amp; matrice=op.<a class="code" href="classOperateur__base.html#a58bbc3d85feaa143ec0d87e68d8fe137">set_matrice</a>().<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>();
<span class="comment">// DoubleTrav secmem(derivee);</span>
          secmem=derivee;
          <a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#adc554d2f7efe81e71ff8995d4f2df8c7">ajouter_masse</a>(dt, secmem, <a class="code" href="classConvection__Diffusion__Temperature.html#aab6a891f15e7996eda73b1b6e67e7dbd" title="Renvoie le champ inconnue representant la temperatue. (version const)">inconnue</a>().valeurs());
          op.<a class="code" href="classOperateur__base.html#a1b64f0211a360c124a218be15c80d9c7" title="NE FAIT RIEN A surcharger dans les classes derivees.">contribuer_au_second_membre</a>(secmem );
          op.<a class="code" href="classOperateur__base.html#a2fe69e40852fa946df7685516d3e5c66">set_solveur</a>().<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(matrice,
                                            secmem,
                                            derivee
                                           );
          <a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#a328dc53fbe227ba188eaf55cd98474b8">corriger_solution</a>(derivee,<a class="code" href="classConvection__Diffusion__Temperature.html#aab6a891f15e7996eda73b1b6e67e7dbd" title="Renvoie le champ inconnue representant la temperatue. (version const)">inconnue</a>().valeurs());

          derivee-=<a class="code" href="classConvection__Diffusion__Temperature.html#aab6a891f15e7996eda73b1b6e67e7dbd" title="Renvoie le champ inconnue representant la temperatue. (version const)">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
          derivee/=dt;

<span class="comment">// Sert uniquement a calculer les flux sur les bords quand la diffusion est implicitee !</span>
          <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> resu;
          resu=derivee;
          <a class="code" href="classConvection__Diffusion__std.html#a4bb82d17dd39ba9d8531764b2800a8bd" title="Renvoie l&#39;operateur specifie par son index: renvoie terme_diffusif si i = 0 renvoie terme_convectif s...">operateur</a>(0).<a class="code" href="classOperateur.html#a203dd066e5203d6e9a02298b8ec12e09">calculer</a>(<a class="code" href="classConvection__Diffusion__Temperature.html#aab6a891f15e7996eda73b1b6e67e7dbd" title="Renvoie le champ inconnue representant la temperatue. (version const)">inconnue</a>().valeurs(), resu);
        }
      <span class="keywordflow">else</span>
        {
<span class="comment">// plusieurs operateurs implicites ...</span>
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Must be coded ... &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
        }
    }
  <span class="keywordflow">else</span>
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Equation_base::derivee_en_temps_inco&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;implicite_ = &quot;</span> &lt;&lt; <a class="code" href="classEquation__base.html#aef791a4afd5964d1b4dfd3d2ac3f5e5e">implicite_</a> &lt;&lt; <span class="stringliteral">&quot; has not been initialized!&quot;</span> &lt;&lt; finl;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;May be &quot;</span> &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot;::completer() method doesn&#39;t call Equation_base::completer()&quot;</span> &lt;&lt; finl;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Contact TRUST support.&quot;</span> &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }
  <span class="keywordflow">return</span> derivee;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab9459fce614d454490281858f631946e"></a><!-- doxytag: member="Convection_Diffusion_Temperature::diffusivite_pour_pas_de_temps" ref="ab9459fce614d454490281858f631946e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classChamp__base.html">Champ_base</a> &amp; Convection_Diffusion_Temperature::diffusivite_pour_pas_de_temps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classConvection__Diffusion__std.html#a03a5dfdf78aa2848ef52ac882960dcdf">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01456">1456</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Milieu__base_8cpp_source.html#l00599">Milieu_base::diffusivite()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00279">milieu()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#a4d944b784ab2d9d4845fd6eeca0cccc4" title="Renvoie le milieu physique de l&#39;equation. (un Fluide_base upcaste en Milieu_base) (version const)...">milieu</a>().<a class="code" href="classMilieu__base.html#a4da7a57f2b9cafb4aaf9309360b6a29f" title="Renvoie la diffusivite du milieu. (version const)">diffusivite</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a78c4b7631d32e6519bfb319f6a092931"></a><!-- doxytag: member="Convection_Diffusion_Temperature::diffusivite_pour_transport" ref="a78c4b7631d32e6519bfb319f6a092931" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classChamp__Don.html">Champ_Don</a> &amp; Convection_Diffusion_Temperature::diffusivite_pour_transport </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classConvection__Diffusion__std.html#aad2b843c71be90788e594fead76dd4a2">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01451">1451</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Milieu__base_8cpp_source.html#l00638">Milieu_base::conductivite()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00279">milieu()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#a4d944b784ab2d9d4845fd6eeca0cccc4" title="Renvoie le milieu physique de l&#39;equation. (un Fluide_base upcaste en Milieu_base) (version const)...">milieu</a>().<a class="code" href="classMilieu__base.html#a99251c07d04e1f13ec4c300bfe8757db" title="Renvoie la conductivite du milieu. (version const)">conductivite</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a21661332b6926372eb7fc52e6fdaa7bb"></a><!-- doxytag: member="Convection_Diffusion_Temperature::discretiser" ref="a21661332b6926372eb7fc52e6fdaa7bb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Convection_Diffusion_Temperature::discretiser </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Discretise l'equation. </p>

<p>Reimplemented from <a class="el" href="classEquation__base.html#ac849b71b99dbe338b049a7728208c965">Equation_base</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00249">249</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Champs__compris_8cpp_source.html#l00198">Champs_compris::ajoute_champ()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Equation__base_8h_source.html#l00318">Equation_base::champs_compris_</a>, <a class="el" href="Equation__base_8cpp_source.html#l01389">Equation_base::discretisation()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Process_8cpp_source.html#l00095">Process::je_suis_maitre()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00077">la_temperature</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="Discret__Thermique_8cpp_source.html#l00074">Discret_Thermique::temperature()</a>, and <a class="el" href="Equation__base_8cpp_source.html#l00091">Equation_base::zone_dis()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>, <a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
  <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
    <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Energy equation discretization&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  dis.<a class="code" href="classDiscret__Thermique.html#a906524db2363d583643f646bc8f90417">temperature</a>(<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>(), <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(), <a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>);
  <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>);

  <a class="code" href="classConvection__Diffusion__Temperature.html#a21661332b6926372eb7fc52e6fdaa7bb" title="Discretise l&#39;equation.">Equation_base::discretiser</a>();
  <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
    <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Convection_Diffusion_Temperature::discretiser() ok&quot;</span> &lt;&lt; finl;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a53dae60f23bd5d3ec003bd285dd73c26"></a><!-- doxytag: member="Convection_Diffusion_Temperature::domaine_application" ref="a53dae60f23bd5d3ec003bd285dd73c26" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classMotcle.html">Motcle</a> &amp; Convection_Diffusion_Temperature::domaine_application </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renvoie le nom du domaine d'application de l'equation.<br/>
Ici "Thermique". </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>&amp;<br/>
 Signification: le nom du domaine d'application de l'equation<br/>
 Contraintes: toujours egal a "Thermique" </dd></dl>

<p>Reimplemented from <a class="el" href="classEquation__base.html#a3925cc36ecc3bb26f5016d225fd7b433">Equation_base</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00499">499</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">static</span> <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> domaine = <span class="stringliteral">&quot;Thermique&quot;</span>;
  <span class="keywordflow">return</span> domaine;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0dd6e47db99b9ca533dbb8940bc1f9d2"></a><!-- doxytag: member="Convection_Diffusion_Temperature::duplique" ref="a0dd6e47db99b9ca533dbb8940bc1f9d2" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Convection_Diffusion_Temperature::duplique </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classConvection__Diffusion__std.html#a036cff20d5fc54a18c07f31395c7ad48">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00044">44</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a06c061aa19d88e3f1392c381247551e7"></a><!-- doxytag: member="Convection_Diffusion_Temperature::ecrire_fichier_pena_th" ref="a06c061aa19d88e3f1392c381247551e7" args="(DoubleTab &amp;, DoubleTab &amp;, DoubleTab &amp;, DoubleTab &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Convection_Diffusion_Temperature::ecrire_fichier_pena_th </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>u_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>tref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>denom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01331">1331</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Milieu__base_8cpp_source.html#l00677">Milieu_base::capacite_calorifique()</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00089">eta</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="classTransport__Interfaces__base.html#a78dd18b060f3370efbfb4fbb230ce626">Transport_Interfaces_base::get_update_indicatrice()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00147">inconnue()</a>, <a class="el" href="Process_8cpp_source.html#l00095">Process::je_suis_maitre()</a>, <a class="el" href="Equation__base_8h_source.html#l00293">Equation_base::le_schema_en_temps</a>, <a class="el" href="Milieu__base_8cpp_source.html#l00560">Milieu_base::masse_volumique()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00279">milieu()</a>, <a class="el" href="Process_8cpp_source.html#l00178">Process::mp_sum()</a>, <a class="el" href="Objet__U_8cpp_source.html#l00310">Objet_U::nom_du_cas()</a>, <a class="el" href="Sortie__Fichier__base_8cpp_source.html#l00161">Sortie_Fichier_base::ouvrir()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01294">ouvrir_fichier_pena_th()</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00576">Schema_Temps_base::pas_de_temps()</a>, <a class="el" href="Equation__base_8cpp_source.html#l00964">Equation_base::probleme()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00094">ref_penalisation_L2_FTD</a>, <a class="el" href="Probleme__base_8h_source.html#l00185">Probleme_base::reprise_effectuee()</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="vect__impl_8h_source.html#l00057">vect_impl::size()</a>, <a class="el" href="Champ__Don_8h_source.html#l00030">Deriv_Champ_Don_base::valeur()</a>, <a class="el" href="Source__Generique__Face__PolyMAC_8cpp_source.html#l00045">valeur()</a>, <a class="el" href="Champ__Inc_8cpp_source.html#l00245">Champ_Inc::valeurs()</a>, <a class="el" href="Champ__Don__base_8cpp_source.html#l00271">Champ_Don_base::valeurs()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Zone__VF_8h_source.html#l00419">Zone_VF::volumes()</a>, and <a class="el" href="Equation__base_8cpp_source.html#l00091">Equation_base::zone_dis()</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01133">penalisation_L2()</a>.</p>
<div class="fragment"><pre class="fragment">{

  <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;limpr())
    {

      <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zone_vf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
      <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; vol_maille = zone_vf.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
      <span class="keyword">const</span> <a class="code" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>&amp; fluide_inc = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>, <a class="code" href="classConvection__Diffusion__Temperature.html#a4d944b784ab2d9d4845fd6eeca0cccc4" title="Renvoie le milieu physique de l&#39;equation. (un Fluide_base upcaste en Milieu_base) (version const)...">milieu</a>());
      <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_rho = fluide_inc.<a class="code" href="classMilieu__base.html#a46a9a4bfb046ed22d0f267b6c052889f" title="Renvoie la masse volumique du milieu. (version const)">masse_volumique</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
      <span class="keyword">const</span> <span class="keywordtype">double</span> rho = tab_rho(0,0);
      <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_cp = fluide_inc.<a class="code" href="classMilieu__base.html#a174d49eab1db7dfce83578b227f4e702" title="Renvoie la capacite calorifique du milieu. (version const)">capacite_calorifique</a>().<a class="code" href="classDeriv__Champ__Don__base.html#ae16e7e2a7a706352781c5ecc7764703d">valeur</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
      <span class="keyword">const</span> <span class="keywordtype">double</span> cp = tab_cp(0,0);

<span class="comment">// Methode pour calculer le flux total sur les ibc</span>

<span class="comment">// Calcul de T_n+1 apres penalisation</span>
      <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inc=<a class="code" href="classConvection__Diffusion__Temperature.html#aab6a891f15e7996eda73b1b6e67e7dbd" title="Renvoie le champ inconnue representant la temperatue. (version const)">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem  = u.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
      <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; dt = <a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
      <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> tkp1(inc);
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0 ; k&lt;nb_elem ; ++k) tkp1(k) += u(k)*dt;

<span class="comment">// Terme de penalisation:       Sigma_ibc Ksi_ibc * ( T_n+1 - Tref_ibc) / eta</span>
      <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> F(inc);
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j&lt;nb_elem; ++j)  F(j) = (tref(j)-denom(j)*tkp1(j))/<a class="code" href="classConvection__Diffusion__Temperature.html#aedbe5cc441073edc75ff1b7e491aa620">eta</a>;

<span class="comment">// boucle sur les IBC</span>

      <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> filtre(nb_elem);
      <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> filtre_glob(nb_elem);
      <span class="keyword">const</span> <span class="keywordtype">double</span> temps_flux = <a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;temps_courant();
      <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> espace=<span class="stringliteral">&quot; \t&quot;</span>;

      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>() ; ++i) <span class="comment">//boucle sur le nombre d&#39;ibc</span>
        {
          <a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>&amp; nom_eq = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>,<a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>[i].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
          <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; indicatrice = nom_eq.<a class="code" href="classTransport__Interfaces__base.html#a78dd18b060f3370efbfb4fbb230ce626">get_update_indicatrice</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
          <span class="keywordtype">double</span> Flux_pena= 0.;
          <span class="keywordtype">double</span> Flux_pena_old= 0.;
          <span class="keywordtype">double</span> Flux_temp_interne= 0.;
<span class="comment">// Filtre ibc (1) / non ibc (0)</span>
          filtre = 0.;
          <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j = 0 ; j&lt;nb_elem ; ++j)
            {
              <span class="keywordflow">if</span> (indicatrice(j) &gt; 0.)
                {
                  filtre(j) = 1.;
                  filtre_glob(j)=1.;
                }
<span class="comment">// bilans</span>
<span class="comment">// Attention rho et cp constants</span>
              Flux_pena_old += u_old(j) * filtre(j) *rho *cp *vol_maille(j);
              Flux_pena += F(j) * filtre(j) * vol_maille(j) *rho *cp;
              Flux_temp_interne += filtre(j)*rho*cp*vol_maille(j)*u(j);
            }

<span class="comment">// Ajout des differents processeurs en //</span>
          Flux_pena_old = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_sum</a>(Flux_pena_old);
          Flux_pena = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_sum</a>(Flux_pena);
          Flux_temp_interne = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_sum</a>(Flux_temp_interne);

<span class="comment">// ecriture</span>
          <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
            {
              <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> FTE;
              <a class="code" href="Convection__Diffusion__Temperature_8cpp.html#a6620db2a6194e54088b4c12791761303">ouvrir_fichier_pena_th</a>(FTE,<span class="stringliteral">&quot;Puissance_penalisation_thermique_ibc&quot;</span>,1,nom_eq);
              FTE &lt;&lt; temps_flux;
              FTE &lt;&lt; espace &lt;&lt; Flux_pena;
              FTE &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;

              <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> FTI;
              <a class="code" href="Convection__Diffusion__Temperature_8cpp.html#a6620db2a6194e54088b4c12791761303">ouvrir_fichier_pena_th</a>(FTI,<span class="stringliteral">&quot;Puissance_thermique_ibc&quot;</span>,1,nom_eq);
              FTI &lt;&lt; temps_flux;
              FTI &lt;&lt; espace &lt;&lt; Flux_pena_old;
              FTI &lt;&lt; finl;

              <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> FTTI;
              <a class="code" href="Convection__Diffusion__Temperature_8cpp.html#a6620db2a6194e54088b4c12791761303">ouvrir_fichier_pena_th</a>(FTTI,<span class="stringliteral">&quot;Derivee_temps_temperature_ibc&quot;</span>,1,nom_eq);
              FTTI &lt;&lt; temps_flux;
              FTTI &lt;&lt; espace &lt;&lt; Flux_temp_interne;
              FTTI &lt;&lt; finl;
            }
        }

<span class="comment">// bilan Derivee_temps_temperature_fluide</span>
<span class="comment">// Attention rho et cp constants</span>
      <span class="keywordtype">double</span> Flux_temp_externe= 0.;
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j&lt;nb_elem; ++j)
        {
          Flux_temp_externe += (1.-filtre_glob(j))  *rho *cp *vol_maille(j) * u(j); <span class="comment">//fluide</span>
        }

<span class="comment">// Ajout des differents processeurs en //</span>
      Flux_temp_externe = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_sum</a>(Flux_temp_externe); <span class="comment">//fluide</span>

<span class="comment">// ecriture</span>
      <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
        {
          <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> fichier;
          <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> fichier_nom=<a class="code" href="classObjet__U.html#a7c27c4f80259eeef76ff8fe2d3bc61f7" title="Renvoie une reference constante vers le nom du cas. Cette methode est statique.">Objet_U::nom_du_cas</a>();
          fichier_nom+=<span class="stringliteral">&quot;_&quot;</span>;
          fichier_nom+=<span class="stringliteral">&quot;Derivee_temps_temperature_fluide.out&quot;</span>;
          <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;nb_impr()==1 &amp;&amp; !<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acafc48b3c050d6c292bb8395a7904a33">reprise_effectuee</a>())
            {
              fichier.<a class="code" href="classSortie__Fichier__base.html#a7e75e18ed580cd4d45912ec202caa2b2">ouvrir</a>(fichier_nom);
            }
          <span class="keywordflow">else</span>
            {
              fichier.<a class="code" href="classSortie__Fichier__base.html#a7e75e18ed580cd4d45912ec202caa2b2">ouvrir</a>(fichier_nom,ios::app);
            }
<span class="comment">// if (fichier)</span>
          {
            (fichier) &lt;&lt;temps_flux&lt;&lt;<span class="stringliteral">&quot; \t&quot;</span>&lt;&lt;Flux_temp_externe&lt;&lt;finl;

          }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9158886a17c4c95aaad8071763bc7ff1"></a><!-- doxytag: member="Convection_Diffusion_Temperature::filtrage_si_appart_ibc" ref="a9158886a17c4c95aaad8071763bc7ff1" args="(DoubleTab &amp;, DoubleTab &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Convection_Diffusion_Temperature::filtrage_si_appart_ibc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>u_conv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01059">1059</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00092">indic_pena_global</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00806">set_indic_pena_globale()</a>, and <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00505">derivee_en_temps_inco()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// caclul de la fonction caracteristique globale des ibc pour le calcul de T_voisinage</span>
  <a class="code" href="classConvection__Diffusion__Temperature.html#a2166b2c55902ad79bd60c797f31d1355">set_indic_pena_globale</a>();

  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0 ; j&lt; <a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>() ; ++j)
    {
      <span class="keywordflow">if</span> ( <a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(j) != 0) u(j) = u_conv(j);
    }
  u.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<span class="comment">// Debog::verifier(&quot;Convection_Diffusion_Temperature::filtrage_si_appart_ibc u &quot;,u);</span>
  <span class="keywordflow">return</span> u;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa9b6985791d67f8c3a4f87f61407ce54"></a><!-- doxytag: member="Convection_Diffusion_Temperature::fluide" ref="aa9b6985791d67f8c3a4f87f61407ce54" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classFluide__base.html">Fluide_base</a> &amp; Convection_Diffusion_Temperature::fluide </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renvoie le fluide incompressible associe a l'equation. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>&amp;<br/>
 Signification: le fluide incompressible associe a l'equation<br/>
 Contraintes: </dd></dl>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00347">347</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00078">le_fluide</a>, <a class="el" href="O__U__Ptr_8cpp_source.html#l00098">O_U_Ptr::non_nul()</a>, and <a class="el" href="Ref__Fluide__base_8h_source.html#l00029">Ref_Fluide_base::valeur()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span>(!<a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;A fluid has not been associated to&quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;the Convection_Diffusion_Temperature equation&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
    }
  <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>.<a class="code" href="classRef__Fluide__base.html#a614fc18293b0b3da4f460a857a3b3cb8">valeur</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2733226a5a26dc9360a2e448e03608aa"></a><!-- doxytag: member="Convection_Diffusion_Temperature::fluide" ref="a2733226a5a26dc9360a2e448e03608aa" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classFluide__base.html">Fluide_base</a> &amp; Convection_Diffusion_Temperature::fluide </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renvoie le fluide incompressible associe a l'equation.<br/>
(version const) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>&amp;<br/>
 Signification: le fluide incompressible associe a l'equation<br/>
 Contraintes: reference constante </dd></dl>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00321">321</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00078">le_fluide</a>, <a class="el" href="O__U__Ptr_8cpp_source.html#l00098">O_U_Ptr::non_nul()</a>, and <a class="el" href="Ref__Fluide__base_8h_source.html#l00029">Ref_Fluide_base::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Terme__Source__inc__th__VDF__Face_8cpp_source.html#l00058">Terme_Source_inc_th_VDF_Face::associer_pb()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00279">milieu()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span>(!<a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;A fluid has not been associated to &quot;</span>
           &lt;&lt; <span class="stringliteral">&quot;the Convection_Diffusion_Temperature equation&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
    }
  <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>.<a class="code" href="classRef__Fluide__base.html#a614fc18293b0b3da4f460a857a3b3cb8">valeur</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="af9bdd96da5f4693f0ed53a724668d1eb"></a><!-- doxytag: member="Convection_Diffusion_Temperature::get_champ" ref="af9bdd96da5f4693f0ed53a724668d1eb" args="(const Motcle &amp;nom) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classChamp__base.html">Champ_base</a> &amp; Convection_Diffusion_Temperature::get_champ </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMotcle.html">Motcle</a> &amp;&#160;</td>
          <td class="paramname"><em>nom</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classEquation__base.html#ad6bcab0bb6d83b1b563a7aa30f0df721">Equation_base</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00437">437</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Equation__base_8h_source.html#l00318">Equation_base::champs_compris_</a>, <a class="el" href="Champs__compris_8cpp_source.html#l00068">Champs_compris::get_champ()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00081">gradient_temperature</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00085">h_echange</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00077">la_temperature</a>, <a class="el" href="Field__base_8cpp_source.html#l00056">Field_base::le_nom()</a>, <a class="el" href="Champ__Fonc__base_8cpp_source.html#l00088">Champ_Fonc_base::mettre_a_jour()</a>, <a class="el" href="O__U__Ptr_8cpp_source.html#l00098">O_U_Ptr::non_nul()</a>, <a class="el" href="Ref_8h_source.html#l00026">REF</a>, <a class="el" href="Cast_8h_source.html#l00062">ref_cast_non_const</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="Champ__Inc_8cpp_source.html#l00225">Champ_Inc::temps()</a>, <a class="el" href="Champ__base_8cpp_source.html#l01116">Champ_base::temps()</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00734">Schema_Temps_base::temps_init()</a>, and <a class="el" href="Champ__Fonc_8h_source.html#l00032">Deriv_Champ_Fonc_base::valeur()</a>.</p>
<div class="fragment"><pre class="fragment">{


  <span class="comment">/*  if (nom==&quot;temperature_paroi&quot;)</span>
<span class="comment">      {</span>
<span class="comment">        double temps_init = schema_temps().temps_init();</span>
<span class="comment">        Champ_Fonc_base&amp; ch_tp=ref_cast_non_const(Champ_Fonc_base,temperature_paroi.valeur());</span>
<span class="comment">        if (((ch_tp.temps()!=la_temperature-&gt;temps()) || (ch_tp.temps()==temps_init)) &amp;&amp; ((la_temperature-&gt;mon_equation_non_nul())))</span>
<span class="comment">          ch_tp.mettre_a_jour(la_temperature-&gt;temps());</span>
<span class="comment">        return champs_compris_.get_champ(nom);</span>
<span class="comment">      } */</span>
  <span class="keywordflow">if</span> (nom==<span class="stringliteral">&quot;gradient_temperature&quot;</span>)
    {
      <span class="keywordtype">double</span> temps_init = <a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a2389e67de1603768ab6b1bd396e0adba" title="Renvoie le temps initial.">temps_init</a>();
      <a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>&amp; ch_gt=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>,<a class="code" href="classConvection__Diffusion__Temperature.html#a9791260817ac5155c177a3d98f5d9ba6">gradient_temperature</a>.<a class="code" href="classDeriv__Champ__Fonc__base.html#a6c7253d2225e858b40c9251d97d57f72">valeur</a>());
      <span class="keywordflow">if</span> (((ch_gt.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()!=<a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>()) || (ch_gt.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()==temps_init)) &amp;&amp; (<a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>-&gt;mon_equation_non_nul()))
        ch_gt.<a class="code" href="classChamp__Fonc__base.html#ab7d6cd96245a8c9971313976c0f34ccc" title="Mise a jour en temps du champ.">mettre_a_jour</a>(<a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>());
      <span class="keywordflow">return</span> <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#af38aefe53d102cb5ea2d328df769f85f">get_champ</a>(nom);
    }
  <span class="keywordflow">if</span> (<a class="code" href="classConvection__Diffusion__Temperature.html#a0a86082c4a7dc0d65dc2b152a79c6d9a">h_echange</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
    <span class="keywordflow">if</span> (nom==<a class="code" href="classConvection__Diffusion__Temperature.html#a0a86082c4a7dc0d65dc2b152a79c6d9a">h_echange</a>.<a class="code" href="classDeriv__Champ__Fonc__base.html#a6c7253d2225e858b40c9251d97d57f72">valeur</a>().<a class="code" href="classField__base.html#ae1377124eabe8387aced762115b062bb" title="Renvoie le nom du champ.">le_nom</a>())
      {
        <span class="keywordtype">double</span> temps_init = <a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a2389e67de1603768ab6b1bd396e0adba" title="Renvoie le temps initial.">temps_init</a>();
        <a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>&amp; ch_hconv=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>,<a class="code" href="classConvection__Diffusion__Temperature.html#a0a86082c4a7dc0d65dc2b152a79c6d9a">h_echange</a>.<a class="code" href="classDeriv__Champ__Fonc__base.html#a6c7253d2225e858b40c9251d97d57f72">valeur</a>());
        <span class="keywordflow">if</span> (((ch_hconv.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()!=<a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>()) || (ch_hconv.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()==temps_init)) &amp;&amp; (<a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>-&gt;mon_equation_non_nul()))
          {
            ch_hconv.<a class="code" href="classChamp__Fonc__base.html#ab7d6cd96245a8c9971313976c0f34ccc" title="Mise a jour en temps du champ.">mettre_a_jour</a>(<a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>());

          }
        <span class="keywordflow">return</span> <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#af38aefe53d102cb5ea2d328df769f85f">get_champ</a>(nom);
      }

  <span class="keywordflow">try</span>
    {
      <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#af9bdd96da5f4693f0ed53a724668d1eb">Convection_Diffusion_std::get_champ</a>(nom);
    }
  <span class="keywordflow">catch</span> (<a class="code" href="classChamps__compris__erreur.html">Champs_compris_erreur</a>)
    {
    }

  <span class="keywordflow">throw</span> <a class="code" href="classChamps__compris__erreur.html">Champs_compris_erreur</a>();
  <a class="code" href="Ref_8h.html#aab5720a5c34da14028d0745e386aaa01">REF</a>(<a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>) ref_champ;

  return ref_champ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af37246da78d980d08d082a97a4d69f35"></a><!-- doxytag: member="Convection_Diffusion_Temperature::get_info" ref="af37246da78d980d08d082a97a4d69f35" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a> * Convection_Diffusion_Temperature::get_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Donne des informations sur le type de l'Objet_U. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>const Type_info*<br/>
 Signification: structure regroupant les informations sur le type de l'Objet_U<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classConvection__Diffusion__std.html#af7aefd27a6649beae843e0740bfe8a27">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00044">44</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa87b5ab582fd4ecd37fce89eff3ccb6e"></a><!-- doxytag: member="Convection_Diffusion_Temperature::impr" ref="aa87b5ab582fd4ecd37fce89eff3ccb6e" args="(Sortie &amp;os) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Convection_Diffusion_Temperature::impr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Impression des flux sur les bords sur un flot de sortie.<br/>
Appelle <a class="el" href="classEquation__base.html#afe3e1fe1bcc08f1e22d24d823a403fc7" title="Imprime les operateurs de l&#39;equation sur un flot de sortie, de facon inconditionnelle. appelle Operateur_base::impr(os)">Equation_base::impr</a>(<a class="el" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp;) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>int<br/>
 Signification: code de retour propage<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classEquation__base.html#afe3e1fe1bcc08f1e22d24d823a403fc7">Equation_base</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00373">373</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#aa87b5ab582fd4ecd37fce89eff3ccb6e" title="Impression des flux sur les bords sur un flot de sortie. Appelle Equation_base::impr(Sortie&amp;)">Equation_base::impr</a>(os);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aab6a891f15e7996eda73b1b6e67e7dbd"></a><!-- doxytag: member="Convection_Diffusion_Temperature::inconnue" ref="aab6a891f15e7996eda73b1b6e67e7dbd" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classChamp__Inc.html">Champ_Inc</a> &amp; Convection_Diffusion_Temperature::inconnue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renvoie le champ inconnue representant la temperatue.<br/>
(version const) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classChamp__Inc.html">Champ_Inc</a>&amp;<br/>
 Signification: le champ inconnue representant la temperatue<br/>
 Contraintes: reference constante </dd></dl>

<p>Implements <a class="el" href="classConvection__Diffusion__std.html#a4fb6e612ed9e8fd56e05b4cdb560ec77">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00147">147</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>References <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00077">la_temperature</a>.</p>

<p>Referenced by <a class="el" href="Terme__Source__inc__th__VDF__Face_8cpp_source.html#l00097">Terme_Source_inc_th_VDF_Face::ajouter()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00505">derivee_en_temps_inco()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00561">derivee_en_temps_inco_eq_base()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01331">ecrire_fichier_pena_th()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01133">penalisation_L2()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00095">readOn()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8137afc33dd8086f664087ca23d2592a"></a><!-- doxytag: member="Convection_Diffusion_Temperature::inconnue" ref="a8137afc33dd8086f664087ca23d2592a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classChamp__Inc.html">Champ_Inc</a> &amp; Convection_Diffusion_Temperature::inconnue </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renvoie le champ inconnue representant la temperatue. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classChamp__Inc.html">Champ_Inc</a>&amp;<br/>
 Signification: le champ inconnue representant la temperatue<br/>
 Contraintes: </dd></dl>

<p>Implements <a class="el" href="classConvection__Diffusion__std.html#a54671ac70e4af35db91a6d8c24544591">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00167">167</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>References <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00077">la_temperature</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af6e770ba4eb736c84a65bd6fef98f6db"></a><!-- doxytag: member="Convection_Diffusion_Temperature::info" ref="af6e770ba4eb736c84a65bd6fef98f6db" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a> * Convection_Diffusion_Temperature::info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Donne des informations sur le type de l'Objet_U. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>const Type_info*<br/>
 Signification: structure regroupant les informations sur le type de l'Objet_U<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classConvection__Diffusion__std.html#ad25fd9a55a9f1063835ac83164deffb2">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00044">44</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab353b1f81cc7fe5ed107e6c0fa254d1c"></a><!-- doxytag: member="Convection_Diffusion_Temperature::lire_motcle_non_standard" ref="ab353b1f81cc7fe5ed107e6c0fa254d1c" args="(const Motcle &amp;, Entree &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Convection_Diffusion_Temperature::lire_motcle_non_standard </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classMotcle.html">Motcle</a> &amp;&#160;</td>
          <td class="paramname"><em>motlu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classEntree.html">Entree</a> &amp;&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Lecture des parametres de type non simple d'un objet_U<br/>
a partir d'un flot d'entree. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>int </dd></dl>

<p>Reimplemented from <a class="el" href="classConvection__Diffusion__std.html#aa2e7f425929815ecd9d06f7b2c916994">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00125">125</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="DoubleTab_8cpp_source.html#l00035">Vect_DoubleTab::add()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00045">Vect_RefObjU::add()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00090">choix_pena</a>, <a class="el" href="Zone_8cpp_source.html#l01600">Zone::creer_tableau_elements()</a>, <a class="el" href="Zone__VF_8cpp_source.html#l00623">Zone_VF::creer_tableau_faces()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00089">eta</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00093">indic_face_pena_global</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00092">indic_pena_global</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00088">is_penalized</a>, <a class="el" href="Equation__base_8cpp_source.html#l00964">Equation_base::probleme()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00094">ref_penalisation_L2_FTD</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00095">tab_penalisation_L2_FTD</a>, <a class="el" href="Source__Generique__Face__PolyMAC_8cpp_source.html#l00045">valeur()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>, and <a class="el" href="Equation__base_8cpp_source.html#l00091">Equation_base::zone_dis()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (un_mot==<span class="stringliteral">&quot;penalisation_L2_FTD&quot;</span>)
    {
      <a class="code" href="classConvection__Diffusion__Temperature.html#a076e32b9ad994a4121452cb3829b9273">is_penalized</a> = 1;
      <a class="code" href="classConvection__Diffusion__Temperature.html#aedbe5cc441073edc75ff1b7e491aa620">eta</a> = 1.e-12;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Equation_base :: penalisation_L2_FTD&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Equation_base: modele penalisation ibc = &quot;</span>&lt;&lt; <a class="code" href="classConvection__Diffusion__Temperature.html#a7038fcce2e880fcf5580f291a4a35ebe">choix_pena</a> &lt;&lt; finl;
      <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> mot, nom_equation;
      <span class="keywordtype">int</span> dim;
      is &gt;&gt; mot;
      <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> motlu, accolade_fermee=<span class="stringliteral">&quot;}&quot;</span>, accolade_ouverte=<span class="stringliteral">&quot;{&quot;</span>;
      <span class="keywordflow">if</span> (mot == accolade_ouverte)
        {
          is &gt;&gt; mot;
          <span class="keywordflow">while</span> (mot != accolade_fermee)
            {
              nom_equation = mot;

              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;penalisation_L2_FTD equation: &quot;</span>&lt;&lt; nom_equation &lt;&lt; finl;
              <span class="keyword">const</span> <a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>&amp; eq = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>,<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().get_equation_by_name(nom_equation));
              <a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>.<a class="code" href="classVect__RefObjU.html#ae2d6c9693597fbe1a1ea5df5bf66f69d">add</a>(eq);

              is &gt;&gt; dim;
              <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> tab = <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>();
              tab.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(dim);
              <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0 ; i&lt;dim ; i++)
                {
                  is &gt;&gt; tab(i);
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Lecture de la valeur de la penalisation suivant la direction &quot;</span> &lt;&lt; i+1 &lt;&lt;<span class="stringliteral">&quot; :&quot;</span> &lt;&lt; tab(i) &lt;&lt; finl;
                }
              <a class="code" href="classConvection__Diffusion__Temperature.html#a9595595fb4b98825455db3dd680d3f64">tab_penalisation_L2_FTD</a>.<a class="code" href="classVect__DoubleTab.html#aed85078d242e65ab80a393aaaba8be1e">add</a>(tab);
              is &gt;&gt; mot ;
            }
        }
      <span class="keywordflow">else</span>
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur a la lecture des parametres de la penalisation L2 &quot;</span> &lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On attendait : &quot;</span> &lt;&lt; accolade_ouverte &lt;&lt; finl;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
        }
      <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zone_vf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
      zone_vf.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>);
      zone_vf.<a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(<a class="code" href="classConvection__Diffusion__Temperature.html#ac11d5686f6bcdd802887cd66c01a54c7">indic_face_pena_global</a>);
    }
  <span class="keywordflow">else</span>
    <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#ab353b1f81cc7fe5ed107e6c0fa254d1c" title="Lecture des parametres de type non simple d&#39;un objet_U a partir d&#39;un flot d&#39;entree.">Convection_Diffusion_std::lire_motcle_non_standard</a>(un_mot,is);
  <span class="keywordflow">return</span> 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4d944b784ab2d9d4845fd6eeca0cccc4"></a><!-- doxytag: member="Convection_Diffusion_Temperature::milieu" ref="a4d944b784ab2d9d4845fd6eeca0cccc4" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classMilieu__base.html">Milieu_base</a> &amp; Convection_Diffusion_Temperature::milieu </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renvoie le milieu physique de l'equation.<br/>
(un <a class="el" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a> upcaste en <a class="el" href="classMilieu__base.html" title="classe Milieu_base Cette classe est la base de la hierarchie des milieux (physiques) Elle regroupe le...">Milieu_base</a>)<br/>
(version const) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classMilieu__base.html" title="classe Milieu_base Cette classe est la base de la hierarchie des milieux (physiques) Elle regroupe le...">Milieu_base</a>&amp;<br/>
 Signification: le <a class="el" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a> upcaste en <a class="el" href="classMilieu__base.html" title="classe Milieu_base Cette classe est la base de la hierarchie des milieux (physiques) Elle regroupe le...">Milieu_base</a><br/>
 Contraintes: reference constante </dd></dl>

<p>Implements <a class="el" href="classEquation__base.html#a181e9899e2d927eb14c835d9d9334f46">Equation_base</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00279">279</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00321">fluide()</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01456">diffusivite_pour_pas_de_temps()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01451">diffusivite_pour_transport()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01331">ecrire_fichier_pena_th()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#a2733226a5a26dc9360a2e448e03608aa" title="Renvoie le fluide incompressible associe a l&#39;equation. (version const)">fluide</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a06276d9be9a7ad227c261214a7b9f059"></a><!-- doxytag: member="Convection_Diffusion_Temperature::milieu" ref="a06276d9be9a7ad227c261214a7b9f059" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMilieu__base.html">Milieu_base</a> &amp; Convection_Diffusion_Temperature::milieu </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Renvoie le milieu physique de l'equation.<br/>
(un <a class="el" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a> upcaste en <a class="el" href="classMilieu__base.html" title="classe Milieu_base Cette classe est la base de la hierarchie des milieux (physiques) Elle regroupe le...">Milieu_base</a>) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classMilieu__base.html" title="classe Milieu_base Cette classe est la base de la hierarchie des milieux (physiques) Elle regroupe le...">Milieu_base</a>&amp;<br/>
 Signification: le <a class="el" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a> upcaste en <a class="el" href="classMilieu__base.html" title="classe Milieu_base Cette classe est la base de la hierarchie des milieux (physiques) Elle regroupe le...">Milieu_base</a><br/>
 Contraintes: </dd></dl>

<p>Implements <a class="el" href="classEquation__base.html#a49a929e04d89f155b42d74d1ac4d8a93">Equation_base</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00300">300</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00321">fluide()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#a2733226a5a26dc9360a2e448e03608aa" title="Renvoie le fluide incompressible associe a l&#39;equation. (version const)">fluide</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="aecf0e32fb40f34138650f1ced3b2aa71"></a><!-- doxytag: member="Convection_Diffusion_Temperature::mise_a_jour_tag_indicatrice_pena_glob" ref="aecf0e32fb40f34138650f1ced3b2aa71" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Convection_Diffusion_Temperature::mise_a_jour_tag_indicatrice_pena_glob </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00788">788</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="classTransport__Interfaces__base.html#ac2016f75dfb4fb46bdbd2fd5adda1d89">Transport_Interfaces_base::get_mesh_tag()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00094">ref_penalisation_L2_FTD</a>, <a class="el" href="vect__impl_8h_source.html#l00057">vect_impl::size()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00091">tag_indic_pena_global</a>, and <a class="el" href="Source__Generique__Face__PolyMAC_8cpp_source.html#l00045">valeur()</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00900">mise_en_place_zone_fantome()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00806">set_indic_pena_globale()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Les ibcs ont elles ete modifiees ?</span>
  <span class="keywordtype">int</span> maj = 0;
  <span class="keywordtype">int</span> tag_all = 0;
  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> w = 0; w&lt;<a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>() ; ++w)
    {
      <a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>&amp; nom_eq = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>,<a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>[w].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
      tag_all += nom_eq.<a class="code" href="classTransport__Interfaces__base.html#ac2016f75dfb4fb46bdbd2fd5adda1d89">get_mesh_tag</a>();
    }
  <span class="keywordflow">if</span> (tag_all != <a class="code" href="classConvection__Diffusion__Temperature.html#aa281e6ca4e8b6de76091836eb6d62ae3">tag_indic_pena_global</a>)
    {
      <a class="code" href="classConvection__Diffusion__Temperature.html#aa281e6ca4e8b6de76091836eb6d62ae3">tag_indic_pena_global</a> = tag_all;
      maj = 1;
    }
  <span class="keywordflow">return</span> maj;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3689afde81dff034b576b7dab3b0da59"></a><!-- doxytag: member="Convection_Diffusion_Temperature::mise_en_place_zone_fantome" ref="a3689afde81dff034b576b7dab3b0da59" args="(DoubleTab &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Convection_Diffusion_Temperature::mise_en_place_zone_fantome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>solution</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; le voisin existe</p>
<p>&lt; strictement fluide aux deux pas de temps</p>
<p>&lt; On sauve le numero du voisin</p>
<p>&lt; le voisin existe et pas i_elem</p>
<p>&lt; strictement fluide aux deux pas de temps</p>
<p>&lt; le voisin existe</p>
<p>&lt; On sauve le numero du voisin</p>
<p>&lt; le voisin existe et pas i_elem</p>
<p>&lt; strictement ibc aux deux pas de temps (la meme) car solution a ete modifiee ci-dessus </p>
</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00900">900</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01073">calcul_indic_pena_global()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="EntreeSortie_8h_source.html#l00033">Cout</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00093">indic_face_pena_global</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00092">indic_pena_global</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00788">mise_a_jour_tag_indicatrice_pena_glob()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00095">tab_penalisation_L2_FTD</a>, <a class="el" href="Source__Generique__Face__PolyMAC_8cpp_source.html#l00045">valeur()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00774">verifier_tag_indicatrice_pena_glob()</a>, and <a class="el" href="Equation__base_8cpp_source.html#l00091">Equation_base::zone_dis()</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00505">derivee_en_temps_inco()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> maj = <a class="code" href="classConvection__Diffusion__Temperature.html#a5893252be9df68bd585d71351ce118e4">verifier_tag_indicatrice_pena_glob</a>();
  <span class="keywordflow">if</span> (maj == 1) <span class="keywordflow">return</span>;

<span class="comment">// garde-fou</span>
  <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().facteur_securite_pas() &gt; 1.0)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Convection_Diffusion_Temperature::mise_en_place_zone_fantome Facteur securite doit etre &lt;= 1&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
    }

<span class="comment">// fonction characteristique globale ibc penalisees actuelle</span>
  <a class="code" href="classIntTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un IntTab avec allocation dans un pool de memoire gere...">IntTrav</a> indicatrice_totale;
  <a class="code" href="classIntTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un IntTab avec allocation dans un pool de memoire gere...">IntTrav</a> indicatrice_face_totale ;
  <a class="code" href="classConvection__Diffusion__Temperature.html#a54112f5b487abbdfc59de04c562b1b26">calcul_indic_pena_global</a>(indicatrice_totale,indicatrice_face_totale);
<span class="comment">// etat des lieux actuel</span>
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem  = indicatrice_totale.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
  <span class="keywordtype">int</span> x=0;
  <span class="keywordtype">int</span> j=0;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k_elem =0 ; k_elem &lt;nb_elem; ++k_elem)  ((indicatrice_totale(k_elem)!=0) ? ++x : ++j);

<span class="comment">// traitement cellules fantomes (if any)</span>
  <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zone_vf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_vf.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_elem = zone_vf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem = elem_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
  <span class="keywordtype">int</span> k=0; <span class="comment">//nb cellules fantomes ibc -&gt; fluide</span>
  <span class="keywordtype">int</span> k_cor=0; <span class="comment">//nb cellules fantomes (ibc -&gt; fluide) corrigees</span>
  <span class="keywordtype">int</span> k_cor2=0; <span class="comment">//nb cellules fantomes (fluide -&gt; ibc) corrigees</span>
  <span class="keywordtype">int</span> u=0; <span class="comment">//nb cellules fluide -&gt; ibc</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_elem = 0; i_elem &lt; nb_elem; i_elem++)
    {
<span class="comment">// cellules fantomes (actuellement fluide et precedement ibc) =&gt; on modifie solution</span>
      <span class="keywordtype">double</span> somme_inc = 0.;
      <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = 0.;
      <span class="keywordflow">if</span> (<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(i_elem) != 0 &amp;&amp; indicatrice_totale(i_elem) == 0)
        {
          ++k;
<span class="comment">// boucle sur les faces pour determiner la valeur de la variable pour les cellules voisines strictement fluide</span>
          <a class="code" href="classIntTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un IntTab avec allocation dans un pool de memoire gere...">IntTrav</a> stok_vois(nb_faces_elem);
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_face = 0; i_face &lt; nb_faces_elem; i_face++)
            {
              <span class="keyword">const</span> <span class="keywordtype">int</span> face = elem_faces(i_elem, i_face);
              <span class="keyword">const</span> <span class="keywordtype">int</span> voisin = faces_elem(face, 0) + faces_elem(face, 1) - i_elem;
              <span class="keywordflow">if</span> (voisin &gt;= 0) <span class="comment">//!&lt; le voisin existe</span>
<span class="comment"></span>                {
                  <span class="keywordflow">if</span> ((<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(voisin) == indicatrice_totale(voisin)) &amp;&amp;  (<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(voisin) == indicatrice_totale(i_elem))) <span class="comment">//!&lt; strictement fluide aux deux pas de temps</span>
<span class="comment"></span>                    {
                      somme_inc += solution(voisin);
                      ++<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                    }
                  <span class="keywordflow">else</span>     <span class="comment">//!&lt; On sauve le numero du voisin</span>
<span class="comment"></span>                    {
                      stok_vois(i_face) = voisin;
                    }
                }
            }
<span class="comment">// Si on n a pas trouve de cellules fluide, on regarde les voisins des voisins</span>
          <span class="keywordflow">if</span> (coeff == 0.)
            {
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_vois = 0; i_vois &lt; nb_faces_elem; i_vois++)
                {
                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii_face = 0; ii_face &lt; nb_faces_elem; ii_face++)
                    {
                      <span class="keyword">const</span> <span class="keywordtype">int</span> face_v = elem_faces(stok_vois(i_vois), ii_face);
                      <span class="keyword">const</span> <span class="keywordtype">int</span> voisin_v = faces_elem(face_v, 0) + faces_elem(face_v, 1) - stok_vois(i_vois);
                      <span class="keywordflow">if</span> ((voisin_v &gt;= 0) &amp;&amp; (voisin_v != i_elem) )<span class="comment">//!&lt; le voisin existe et pas i_elem</span>
<span class="comment"></span>                        {
                          <span class="keywordflow">if</span> ((<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(voisin_v) == indicatrice_totale(voisin_v)) &amp;&amp;  (<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(voisin_v) == indicatrice_totale(i_elem))) <span class="comment">//!&lt; strictement fluide aux deux pas de temps</span>
<span class="comment"></span>                            {
                              somme_inc += solution(voisin_v);
                              ++<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                            }
                        }
                    }
                }
            }
<span class="comment">// definition d une nouvelle valleur de la variable pour la cellule fantome</span>
          <span class="keywordflow">if</span> (coeff &gt; 0.)
            {
              solution(i_elem) = somme_inc / <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
              k_cor += 1;
            }
        }
<span class="comment">// cellules actuellement ibc et precedement fluide</span>
      <span class="keywordflow">if</span> (<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(i_elem) == 0 &amp;&amp; indicatrice_totale(i_elem) != 0)
        {
          ++u;
<span class="comment">// boucle sur les faces pour determiner la valeur de la variable pour les cellules voisines strictement ibc</span>
          <a class="code" href="classIntTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un IntTab avec allocation dans un pool de memoire gere...">IntTrav</a> stok_vois(nb_faces_elem);
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_face = 0; i_face &lt; nb_faces_elem; i_face++)
            {
              <span class="keyword">const</span> <span class="keywordtype">int</span> face = elem_faces(i_elem, i_face);
              <span class="keyword">const</span> <span class="keywordtype">int</span> voisin = faces_elem(face, 0) + faces_elem(face, 1) - i_elem;
              <span class="keywordflow">if</span> (voisin &gt;= 0) <span class="comment">//!&lt; le voisin existe</span>
<span class="comment"></span>                {
<span class="comment">// strictement ibc aux deux pas de temps (la meme) car solution a ete modifiee ci-dessus</span>
                  <span class="keywordflow">if</span> ((<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(voisin) == indicatrice_totale(voisin)) &amp;&amp; (<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(voisin) == indicatrice_totale(i_elem)))
                    {
                      somme_inc += solution(voisin);
                      ++<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                    }
                  <span class="keywordflow">else</span>     <span class="comment">//!&lt; On sauve le numero du voisin</span>
<span class="comment"></span>                    {
                      stok_vois(i_face) = voisin;
                    }
                }
            }
<span class="comment">// Si on n a pas trouve de cellules ibc, on regarde les voisins des voisins</span>
          <span class="keywordflow">if</span> (coeff == 0.)
            {
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_vois = 0; i_vois &lt; nb_faces_elem; i_vois++)
                {
                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii_face = 0; ii_face &lt; nb_faces_elem; ii_face++)
                    {
                      <span class="keyword">const</span> <span class="keywordtype">int</span> face_v = elem_faces(stok_vois(i_vois), ii_face);
                      <span class="keyword">const</span> <span class="keywordtype">int</span> voisin_v = faces_elem(face_v, 0) + faces_elem(face_v, 1) - stok_vois(i_vois);
                      <span class="keywordflow">if</span> ((voisin_v &gt;= 0) &amp;&amp; (voisin_v != i_elem) )<span class="comment">//!&lt; le voisin existe et pas i_elem</span>
<span class="comment"></span>                        {
                          <span class="keywordflow">if</span> ((<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(voisin_v) == indicatrice_totale(voisin_v)) &amp;&amp; (<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(voisin_v) == indicatrice_totale(i_elem))) <span class="comment">//!&lt; strictement ibc aux deux pas de temps (la meme) car solution a ete modifiee ci-dessus</span>
<span class="comment"></span>                            {
                              somme_inc += solution(voisin_v);
                              ++<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                            }
                        }
                    }
                }
            }
<span class="comment">// definition d une nouvelle valleur de la variable pour la cellule fantome</span>
          <span class="keywordflow">if</span> (coeff &gt; 0.)
            {
              solution(i_elem) = somme_inc / <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
              k_cor2 += 1;
            }
          <span class="keywordflow">else</span>
            {
              solution(i_elem) = <a class="code" href="classConvection__Diffusion__Temperature.html#a9595595fb4b98825455db3dd680d3f64">tab_penalisation_L2_FTD</a>[indicatrice_totale(i_elem)-1](0);
              k_cor2 += 1;
            }
        }
    }
  solution.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<span class="comment">// Debog::verifier(&quot;Convection_Diffusion_Temperature::mise_en_place_zone_fantome solution &quot;,solution);</span>
  <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt;<span class="stringliteral">&quot;Mise_en_place_zone_fantome : fluide -&gt; ibc : &quot;</span>&lt;&lt;u&lt;&lt; <span class="stringliteral">&quot; elem. (dont &quot;</span>&lt;&lt;k_cor2&lt;&lt;<span class="stringliteral">&quot; corrigees) et ibc -&gt; fluide : &quot;</span>;
  <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;k&lt;&lt;<span class="stringliteral">&quot; elem.(dont &quot;</span>&lt;&lt;k_cor&lt;&lt;<span class="stringliteral">&quot; corrigees)&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt;<span class="stringliteral">&quot;             nb elem. ibc : &quot;</span>&lt;&lt;x&lt;&lt;<span class="stringliteral">&quot; et nb elem fluide : &quot;</span>&lt;&lt;j&lt;&lt;<span class="stringliteral">&quot; sur un total de : &quot;</span>&lt;&lt;nb_elem&lt;&lt;finl;
  <span class="keywordflow">if</span> ((u != k_cor2) || (k !=k_cor))
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt;<span class="stringliteral">&quot;Mise_en_place_zone_fantome : Les cellules fantomes ne sont pas toutes corrigees&quot;</span>&lt;&lt;finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
    }

  <a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a> = indicatrice_totale;
  <a class="code" href="classConvection__Diffusion__Temperature.html#ac11d5686f6bcdd802887cd66c01a54c7">indic_face_pena_global</a> = indicatrice_face_totale;
  maj = <a class="code" href="classConvection__Diffusion__Temperature.html#aecf0e32fb40f34138650f1ced3b2aa71">mise_a_jour_tag_indicatrice_pena_glob</a>();
  assert(maj == 1);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a22c0a145a3458c317b07d675b17517a4"></a><!-- doxytag: member="Convection_Diffusion_Temperature::penalisation_L2" ref="a22c0a145a3458c317b07d675b17517a4" args="(DoubleTab &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Convection_Diffusion_Temperature::penalisation_L2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>u</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01133">1133</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00090">choix_pena</a>, <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="DoubleTab_8h_source.html#l00254">DoubleTab::dimension_tot()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01331">ecrire_fichier_pena_th()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00089">eta</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="classTransport__Interfaces__base.html#a78dd18b060f3370efbfb4fbb230ce626">Transport_Interfaces_base::get_update_indicatrice()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00147">inconnue()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00092">indic_pena_global</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00576">Schema_Temps_base::pas_de_temps()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00094">ref_penalisation_L2_FTD</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00806">set_indic_pena_globale()</a>, <a class="el" href="DoubleVect_8h_source.html#l00153">DoubleVect::size()</a>, <a class="el" href="vect__impl_8h_source.html#l00057">vect_impl::size()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00095">tab_penalisation_L2_FTD</a>, <a class="el" href="Source__Generique__Face__PolyMAC_8cpp_source.html#l00045">valeur()</a>, <a class="el" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">Champ_Proto::valeurs()</a>, <a class="el" href="Champ__Inc_8cpp_source.html#l00245">Champ_Inc::valeurs()</a>, and <a class="el" href="Equation__base_8cpp_source.html#l00091">Equation_base::zone_dis()</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00505">derivee_en_temps_inco()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// garde-fou</span>
  assert(<a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>() != 0);
  assert(<a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>() == <a class="code" href="classConvection__Diffusion__Temperature.html#a9595595fb4b98825455db3dd680d3f64">tab_penalisation_L2_FTD</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>());

  <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; dt = <a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> u_old(u);

<span class="comment">// caclul de la fonction caracteristique globale des ibc pour le calcul de T_voisinage</span>
  <a class="code" href="classConvection__Diffusion__Temperature.html#a2166b2c55902ad79bd60c797f31d1355">set_indic_pena_globale</a>();

<span class="comment">// calcul de T_voisinage pour tous les elemnts</span>
  <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zone_vf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_vf.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_elem = zone_vf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem = elem_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; inc=<a class="code" href="classConvection__Diffusion__Temperature.html#aab6a891f15e7996eda73b1b6e67e7dbd" title="Renvoie le champ inconnue representant la temperatue. (version const)">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<span class="comment">// inconnue doit etre scalaire</span>
  assert(inc.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>() == 1);
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> t_voisinage(inc);
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> u_voisinage(u);
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem  = u.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_elem = 0; i_elem &lt; nb_elem; i_elem++)
    {
      <span class="keywordtype">double</span> somme = 0.;
      <span class="keywordtype">double</span> somme_deriv = 0.;
      <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = 0.;

      <span class="keywordflow">if</span>( <a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(i_elem) != 0)
        {
<span class="comment">// boucle sur les faces de l element</span>
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_face = 0; i_face &lt; nb_faces_elem; i_face++)
            {
              <span class="keyword">const</span> <span class="keywordtype">int</span> face = elem_faces(i_elem, i_face);
              <span class="keyword">const</span> <span class="keywordtype">int</span> voisin = faces_elem(face, 0) + faces_elem(face, 1) - i_elem;
              <span class="keywordflow">if</span> (voisin &gt;= 0)
                {
                  <span class="keywordflow">if</span> (<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>(voisin) == 0)
                    {
                      somme += inc(voisin);
                      somme_deriv += u(voisin);
                      coeff += 1.;
                    }
                }
            }
        }

      <span class="keywordflow">if</span> (coeff &gt; 0.)
        {
          t_voisinage(i_elem) = somme / <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
          u_voisinage(i_elem) = somme_deriv / <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
        }
      <span class="keywordflow">else</span>
        {
<span class="comment">// cas pas de voisin dans le fluide</span>
          t_voisinage(i_elem) = inc(i_elem);
          u_voisinage(i_elem) = u(i_elem);
        }
    }
  t_voisinage.echange_espace_virtuel();
  u_voisinage.echange_espace_virtuel();

<span class="comment">// determination du champ global de penalisation L2</span>
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> pena_glob(inc); <span class="comment">//initialise a zero</span>
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> tab_(inc); <span class="comment">//initialise a zero</span>
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> denom(inc); <span class="comment">//initialise a zero</span>

<span class="comment">// boucle ibc</span>
  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>() ; ++i)
    {
      <a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>&amp; nom_eq = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>,<a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>[i].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
      <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab = <a class="code" href="classConvection__Diffusion__Temperature.html#a9595595fb4b98825455db3dd680d3f64">tab_penalisation_L2_FTD</a>[i];
<span class="comment">// verification dimensions tab t obstacle = nb dim de l inconnu</span>
      <span class="keywordflow">if</span> ( tab.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0) != inc.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>() )
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; penalisation_L2: Les champs de temperature impose et calcule n&#39;ont pas les memes dimensions&quot;</span> &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Dimension du champ de temperature impose &quot;</span>&lt;&lt; tab.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0) &lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Dimension du champ de temperature calcule par TRUST &quot;</span>&lt;&lt;inc.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>() &lt;&lt;finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Nombre d&#39;elements stockes au dans l&#39;iconnue &quot;</span> &lt;&lt;inc.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() &lt;&lt;finl;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
        }
      <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; indicatrice = nom_eq.<a class="code" href="classTransport__Interfaces__base.html#a78dd18b060f3370efbfb4fbb230ce626">get_update_indicatrice</a>().<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();

      <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> pena_loc(indicatrice);
<span class="comment">// Determination du terme de penalisation pour l ibc courante</span>
<span class="comment">// boucle sur les elements</span>
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j&lt;nb_elem ; ++j)
        {
<span class="comment">// calcul de la fonction characteristique Ksi de l ibc courante -&gt; pena_loc</span>
          <span class="keywordflow">if</span> (indicatrice(j) &gt; 0.)
            {
              <span class="keywordtype">double</span> coeff_p=1.;
              pena_loc(j) = coeff_p;
<span class="comment">// calcul du denominateur du terme de penalisation ( Sigma_ibc Ksi_ibc(j) )</span>
              denom(j) += coeff_p;

<span class="comment">// determination valeur a imposer T_ref</span>
              <span class="keywordtype">double</span> tref_j = 0.;
              <span class="keywordflow">switch</span> (<a class="code" href="classConvection__Diffusion__Temperature.html#a7038fcce2e880fcf5580f291a4a35ebe">choix_pena</a>)
                {
                <span class="keywordflow">case</span> 0 :
<span class="comment">// approximation de T_ref par T_ref = T_imp</span>
                  tref_j = tab(0);
                  <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> 1 :
<span class="comment">// approximation de T_ref par T_ref = T+dt*derivee</span>
                  tref_j = inc(j) + dt*u_old(j);
                  <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> 2 :
<span class="comment">// approximation de T_imp par T_ref= tau*T_imp + (1-tau)*T_voisin</span>
<span class="comment">// approximation de T_voisin par T_voisin= 1/n * somme(1,n)(T_environnant+dt*derivee_environnant)</span>
                  tref_j = (indicatrice(j)*tab(0)+(1.-indicatrice(j))*(t_voisinage(j)+dt*u_voisinage(j)));
                  <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> 3 :
<span class="comment">// approximation de T_imp par T_ref= [(1-tau)*T_voisin + (1/2)*T_imp] / (3/2 -tau)</span>
<span class="comment">// approximation de T_voisin par T_voisin= 1/n * somme(1,n)(T_environnant+dt*derivee_environnant)</span>
                  tref_j = ((1.-indicatrice(j))*(t_voisinage(j)+dt*u_voisinage(j))+0.5*tab(0))/(1.5-indicatrice(j));
                  <span class="keywordflow">break</span>;
                <span class="keywordflow">case</span> 4 :
<span class="comment">// approximation de T_imp par T_ref= T_imp si tau=1 sinon T_ref=T_voisin</span>
                  <span class="keywordflow">if</span> (indicatrice(j) == 1.)
                    {
                      tref_j = tab(0);
                    }
                  <span class="keywordflow">else</span>
                    {
                      tref_j = (t_voisinage(j)+dt*u_voisinage(j));
                    }
                  <span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Penalisation_L2: choix_pena invalide &quot;</span>&lt;&lt; <a class="code" href="classConvection__Diffusion__Temperature.html#a7038fcce2e880fcf5580f291a4a35ebe">choix_pena</a> &lt;&lt;finl;
                  <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
                  <span class="keywordflow">break</span>;
                }
<span class="comment">// sauvegarde de Sigma_ibc Ksi_ibc(j) Tref_ibc pour post-traitement</span>
              tab_(j) += tref_j;
<span class="comment">// penalisation_global = Sigma_ibc Ksi_ibc(j)*(Tref_ibc - inc) /  eta;</span>
              pena_loc(j) *= (tref_j-inc(j));
              pena_loc(j) /= <a class="code" href="classConvection__Diffusion__Temperature.html#aedbe5cc441073edc75ff1b7e491aa620">eta</a>;
              pena_glob(j)  += pena_loc(j);
            }
        }
    }

<span class="comment">// Realisation de la penalisation L2 de la derivee en temps: (dT_t_* + pena_glob) / ( 1 + (dt*Sigma_ibc Ksi_ibc(j)) / eta )</span>
<span class="comment">// Tref est la moyenne arithmetique de Tref_j lorsque 0&lt;eta&lt;&lt;1</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0 ; j&lt;nb_elem ; ++j)
    {
      u(j) = u_old(j) + pena_glob(j);
      u(j) /= (1. + denom(j)*dt/<a class="code" href="classConvection__Diffusion__Temperature.html#aedbe5cc441073edc75ff1b7e491aa620">eta</a>);
    }
  u.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();

<span class="comment">// Sauvegarde des flux</span>
  <a class="code" href="classConvection__Diffusion__Temperature.html#a06c061aa19d88e3f1392c381247551e7">ecrire_fichier_pena_th</a>(u_old,u,tab_,denom);

<span class="comment">// Debog::verifier(&quot;Convection_Diffusion_Temperature::penalisation_L2 u &quot;,u);</span>
  <span class="keywordflow">return</span> u;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a868757abff8b1296a2d80765f22bc622"></a><!-- doxytag: member="Convection_Diffusion_Temperature::printOn" ref="a868757abff8b1296a2d80765f22bc622" args="(Sortie &amp;x) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSortie.html">Sortie</a> &amp; Convection_Diffusion_Temperature::printOn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td> const<code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classSimple.html">Simple</a> appel a: <a class="el" href="classConvection__Diffusion__std.html#a1456f18650713408692e473203162bbe" title="Simple appel a Equation_base::printOn(Sortie&amp;)">Convection_Diffusion_std::printOn</a>(<a class="el" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp;) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp;<br/>
 Signification: le flot de sortie modifie<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classConvection__Diffusion__std.html#a1456f18650713408692e473203162bbe">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00074">74</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classConvection__Diffusion__Temperature.html#a868757abff8b1296a2d80765f22bc622" title="Simple appel a: Convection_Diffusion_std::printOn(Sortie&amp;)">Convection_Diffusion_std::printOn</a>(is);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad0740c9c79ae6e39edc019e53d67cfc1"></a><!-- doxytag: member="Convection_Diffusion_Temperature::readOn" ref="ad0740c9c79ae6e39edc019e53d67cfc1" args="(Entree &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEntree.html">Entree</a> &amp; Convection_Diffusion_Temperature::readOn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEntree.html">Entree</a> &amp;&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verifie si l'equation a une temperature et un fluide associe<br/>
cf <a class="el" href="classConvection__Diffusion__std.html#ae478232ec9d42409037a60618012c3dc" title="cf Equation_base::readOn(Entree&amp;)">Convection_Diffusion_std::readOn</a>(<a class="el" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp;). </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is<br/>
 Signification: le flot d'entree modifie<br/>
 Contraintes: </dd></dl>

<p><p>&lt; On prevoir le cas d'equation de scalaires passifs </p>
</p>

<p>Reimplemented from <a class="el" href="classConvection__Diffusion__std.html#ae478232ec9d42409037a60618012c3dc">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00095">95</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00147">inconnue()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00077">la_temperature</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00078">le_fluide</a>, <a class="el" href="O__U__Ptr_8cpp_source.html#l00179">O_U_Ptr::le_nom()</a>, <a class="el" href="O__U__Ptr_8cpp_source.html#l00098">O_U_Ptr::non_nul()</a>, <a class="el" href="Operateur_8cpp_source.html#l00470">Operateur::set_description()</a>, <a class="el" href="Operateur_8cpp_source.html#l00465">Operateur::set_fichier()</a>, <a class="el" href="Equation__base_8h_source.html#l00291">Equation_base::solveur_masse</a>, <a class="el" href="Nom_8cpp_source.html#l00428">Nom::suffix()</a>, <a class="el" href="Convection__Diffusion__std_8h_source.html#l00082">Convection_Diffusion_std::terme_convectif</a>, and <a class="el" href="Convection__Diffusion__std_8h_source.html#l00083">Convection_Diffusion_std::terme_diffusif</a>.</p>
<div class="fragment"><pre class="fragment">{
  assert(<a class="code" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">la_temperature</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>());
  assert(<a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>());
  <a class="code" href="classConvection__Diffusion__Temperature.html#ad0740c9c79ae6e39edc019e53d67cfc1" title="Verifie si l&#39;equation a une temperature et un fluide associe cf Convection_Diffusion_std::readOn(Entr...">Convection_Diffusion_std::readOn</a>(is);
<span class="comment">// Nom unite;</span>
<span class="comment">// if (dimension+bidim_axi==2) unite=&quot;[W/m]&quot;;</span>
<span class="comment">// else unite=&quot;[W]&quot;;</span>
  <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> num=<a class="code" href="classConvection__Diffusion__Temperature.html#aab6a891f15e7996eda73b1b6e67e7dbd" title="Renvoie le champ inconnue representant la temperatue. (version const)">inconnue</a>().<a class="code" href="classO__U__Ptr.html#a5aae0c48048a40339f3847aa14109231" title="Renvoie ref_().le_nom() si le pointeur est non nul ou &quot;Pointeur Nul&quot;.">le_nom</a>(); <span class="comment">//!&lt; On prevoir le cas d&#39;equation de scalaires passifs</span>
<span class="comment"></span>  num.<a class="code" href="classNom.html#acdb0a56b1654b0c37050be0ca9435706" title="extraction de suffix : Nom x(&quot;azerty&quot;); x.suffix(&quot;aze&quot;) x contient &quot;rty&quot;.">suffix</a>(<span class="stringliteral">&quot;temperature&quot;</span>);
  <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom=<span class="stringliteral">&quot;Convection_chaleur&quot;</span>;
  nom+=num;
  <a class="code" href="classConvection__Diffusion__std.html#aff629b8054c74fb1244b37c79aa6a3bd">terme_convectif</a>.<a class="code" href="classOperateur.html#adf6c5f02d4e0bd15282a628c4814d61f">set_fichier</a>(nom);
<span class="comment">// terme_convectif.set_description((Nom)&quot;Convective heat transfer rate=Integral(-rho*cp*T*u*ndS) &quot;+unite);</span>
  <a class="code" href="classConvection__Diffusion__std.html#aff629b8054c74fb1244b37c79aa6a3bd">terme_convectif</a>.<a class="code" href="classOperateur.html#abe53b54eda0c886809a704bf79b60aa9">set_description</a>((<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>)<span class="stringliteral">&quot;Convective heat transfer rate=Integral(-rho*cp*T*u*ndS) [W] if SI units used&quot;</span>);
  nom=<span class="stringliteral">&quot;Diffusion_chaleur&quot;</span>;
  nom+=num;
  <a class="code" href="classConvection__Diffusion__std.html#a7507bbda8e79eb03a9099ccd35af2275">terme_diffusif</a>.<a class="code" href="classOperateur.html#adf6c5f02d4e0bd15282a628c4814d61f">set_fichier</a>(nom);
<span class="comment">// terme_diffusif.set_description((Nom)&quot;Conduction heat transfer rate=Integral(lambda*grad(T)*ndS) &quot;+unite);</span>
  <a class="code" href="classConvection__Diffusion__std.html#a7507bbda8e79eb03a9099ccd35af2275">terme_diffusif</a>.<a class="code" href="classOperateur.html#abe53b54eda0c886809a704bf79b60aa9">set_description</a>((<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>)<span class="stringliteral">&quot;Conduction heat transfer rate=Integral(lambda*grad(T)*ndS) [W] if SI units used&quot;</span>);
  <a class="code" href="classEquation__base.html#aaaf61d60cca8205d2490a023633cc7d4">solveur_masse</a>-&gt;set_name_of_coefficient_temporel(<span class="stringliteral">&quot;rho_cp_comme_T&quot;</span>);
  <span class="keywordflow">return</span> is;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af3b89bd8e4622db3baedfc3e3d664940"></a><!-- doxytag: member="Convection_Diffusion_Temperature::self_cast" ref="af3b89bd8e4622db3baedfc3e3d664940" args="(Objet_U &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classConvection__Diffusion__Temperature.html">Convection_Diffusion_Temperature</a> &amp; Convection_Diffusion_Temperature::self_cast </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classObjet__U.html">Objet_U</a> &amp;&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classConvection__Diffusion__std.html#a682caeb4d4e64d95c9705f17469f7116">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00044">44</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae6fd02098c8c2e18be9e2cab3b47c341"></a><!-- doxytag: member="Convection_Diffusion_Temperature::self_cast" ref="ae6fd02098c8c2e18be9e2cab3b47c341" args="(const Objet_U &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classConvection__Diffusion__Temperature.html">Convection_Diffusion_Temperature</a> &amp; Convection_Diffusion_Temperature::self_cast </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classObjet__U.html">Objet_U</a> &amp;&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>methode ajoutee pour caster en python </p>

<p>Reimplemented from <a class="el" href="classConvection__Diffusion__std.html#af34cad31cc6337efdaa315460073f446">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00044">44</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2166b2c55902ad79bd60c797f31d1355"></a><!-- doxytag: member="Convection_Diffusion_Temperature::set_indic_pena_globale" ref="a2166b2c55902ad79bd60c797f31d1355" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Convection_Diffusion_Temperature::set_indic_pena_globale </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00806">806</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01073">calcul_indic_pena_global()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00093">indic_face_pena_global</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00092">indic_pena_global</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00788">mise_a_jour_tag_indicatrice_pena_glob()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00774">verifier_tag_indicatrice_pena_glob()</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01059">filtrage_si_appart_ibc()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01133">penalisation_L2()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00818">transport_ibc()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Set de la fonction characteristique ibc globlale (element et faces)</span>
  <span class="keywordtype">int</span> maj = <a class="code" href="classConvection__Diffusion__Temperature.html#a5893252be9df68bd585d71351ce118e4">verifier_tag_indicatrice_pena_glob</a>();
  <span class="keywordflow">if</span> (maj == 0)
    {
      <a class="code" href="classConvection__Diffusion__Temperature.html#a54112f5b487abbdfc59de04c562b1b26">calcul_indic_pena_global</a>(<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>, <a class="code" href="classConvection__Diffusion__Temperature.html#ac11d5686f6bcdd802887cd66c01a54c7">indic_face_pena_global</a>);
      maj = <a class="code" href="classConvection__Diffusion__Temperature.html#aecf0e32fb40f34138650f1ced3b2aa71">mise_a_jour_tag_indicatrice_pena_glob</a>();
      assert(maj == 1);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a365fcd2db507c039d52cba160982f4a8"></a><!-- doxytag: member="Convection_Diffusion_Temperature::set_param" ref="a365fcd2db507c039d52cba160982f4a8" args="(Param &amp;titi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Convection_Diffusion_Temperature::set_param </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classParam.html">Param</a> &amp;&#160;</td>
          <td class="paramname"><em>titi</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classConvection__Diffusion__std.html#a9a5d1daa325748c15bb9d0751e34a25a">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00119">119</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Param_8cpp_source.html#l00442">Param::ajouter_non_std()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classConvection__Diffusion__Temperature.html#a365fcd2db507c039d52cba160982f4a8">Convection_Diffusion_std::set_param</a>(param);
  param.ajouter_non_std(<span class="stringliteral">&quot;penalisation_L2_FTD&quot;</span>,(<span class="keyword">this</span>));
}
</pre></div>
</div>
</div>
<a class="anchor" id="a67b6c6b23cdd2dac5da10bdd27bc5934"></a><!-- doxytag: member="Convection_Diffusion_Temperature::taille_memoire" ref="a67b6c6b23cdd2dac5da10bdd27bc5934" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned Convection_Diffusion_Temperature::taille_memoire </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classObjet__U.html#a0ee0946339f09a2c73c09fcda71c3be2">Objet_U</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00044">44</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a82affa83cd11442b4b18d0e7114d4b08"></a><!-- doxytag: member="Convection_Diffusion_Temperature::transport_ibc" ref="a82affa83cd11442b4b18d0e7114d4b08" args="(DoubleTrav &amp;, DoubleTab &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Convection_Diffusion_Temperature::transport_ibc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTrav.html">DoubleTrav</a> &amp;&#160;</td>
          <td class="paramname"><em>secmem_conv_vr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>inco_conv_vr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00818">818</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Equation__base_8cpp_source.html#l01775">Equation_base::derivee_en_temps_conv()</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00093">indic_face_pena_global</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00092">indic_pena_global</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00078">le_fluide</a>, <a class="el" href="Convection__Diffusion__std_8cpp_source.html#l00117">Convection_Diffusion_std::nombre_d_operateurs()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00806">set_indic_pena_globale()</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="Source__Generique__Face__PolyMAC_8cpp_source.html#l00045">valeur()</a>, and <a class="el" href="Equation__base_8cpp_source.html#l00091">Equation_base::zone_dis()</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00505">derivee_en_temps_inco()</a>.</p>
<div class="fragment"><pre class="fragment">{
  secmem_conv_vr = 0.;
  <span class="keyword">const</span> <span class="keywordtype">double</span> rhoCp = <a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>-&gt;capacite_calorifique().valeurs()(0, 0) * <a class="code" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">le_fluide</a>-&gt;masse_volumique().valeurs()(0, 0);

<span class="comment">// fonction characteristique globale ibc au temps courant</span>
  <a class="code" href="classConvection__Diffusion__Temperature.html#a2166b2c55902ad79bd60c797f31d1355">set_indic_pena_globale</a>();

<span class="comment">// on calcule l indicatrice epaisse</span>
  <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zone_vf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_elem = zone_vf.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <a class="code" href="classIntTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un IntTab avec allocation dans un pool de memoire gere...">IntTrav</a> indic_pena_global_fat(<a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_face = 0; i_face &lt; <a class="code" href="classConvection__Diffusion__Temperature.html#ac11d5686f6bcdd802887cd66c01a54c7">indic_face_pena_global</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>(); i_face++)
    {
      <span class="keywordflow">if</span> (<a class="code" href="classConvection__Diffusion__Temperature.html#ac11d5686f6bcdd802887cd66c01a54c7">indic_face_pena_global</a>(i_face) &gt; 0.)
        {
          <span class="keyword">const</span> <span class="keywordtype">int</span> voisin_0 = faces_elem(i_face, 0);
          <span class="keywordflow">if</span> (voisin_0 &gt;= 0) indic_pena_global_fat(voisin_0) = 1;
          <span class="keyword">const</span> <span class="keywordtype">int</span> voisin_1 = faces_elem(i_face, 1);
          <span class="keywordflow">if</span> (voisin_1 &gt;= 0) indic_pena_global_fat(voisin_1) = 1;
        }
    }
<span class="comment">// post-traitement particulier pour les coins</span>
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_vf.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem = elem_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem  = <a class="code" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">indic_pena_global</a>.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_elem = 0; i_elem &lt; nb_elem;  i_elem++)
    {
      <span class="keywordflow">if</span> (indic_pena_global_fat(i_elem) == 0)
        {
          <span class="keywordtype">int</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = 0;
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_face = 0; i_face &lt; nb_faces_elem; i_face++)
            {
              <span class="keyword">const</span> <span class="keywordtype">int</span> face = elem_faces(i_elem, i_face);
              <span class="keyword">const</span> <span class="keywordtype">int</span> voisin = faces_elem(face, 0) + faces_elem(face, 1) - i_elem;
              <span class="keywordflow">if</span> (voisin &gt;= 0)
                {
                  <span class="keywordflow">if</span> (indic_pena_global_fat(voisin) != 0)
                    {
                      ++<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                    } ;
                }
            }
          <span class="keywordflow">if</span> (coeff &gt; 1) indic_pena_global_fat(i_elem) = 1;
        }
    }

<span class="comment">// Si on veut un traitement local a chaque indicatrice (necessaire si on utilise vitesse imposee)</span>
<span class="comment">// IntTrav indic_pena_fat(indic_pena_global);</span>
<span class="comment">// for (int w = 0; w &lt; ref_penalisation_L2_FTD.size(); w++)</span>
<span class="comment">// {</span>
<span class="comment">// Transport_Interfaces_base &amp; nom_eq = ref_cast(Transport_Interfaces_base,ref_penalisation_L2_FTD[w].valeur());</span>
<span class="comment">// // on calcul le filtre local a l ibc</span>
<span class="comment">// const DoubleTab &amp; indicatrice_face = nom_eq.get_compute_indicatrice_faces().valeurs();</span>
<span class="comment">// indic_pena_fat = 0;</span>
<span class="comment">// for (int i_face = 0; i_face &lt; indicatrice_face.size(); i_face++)</span>
<span class="comment">// {</span>
<span class="comment">// if (indicatrice_face(i_face) &gt; 0.)</span>
<span class="comment">// {</span>
<span class="comment">// const int voisin_0 = faces_elem(i_face, 0);</span>
<span class="comment">// if (voisin_0 &gt;= 0) indic_pena_fat(voisin_0) = 1;</span>
<span class="comment">// const int voisin_1 = faces_elem(i_face, 1);</span>
<span class="comment">// if (voisin_1 &gt;= 0) indic_pena_fat(voisin_1) = 1;</span>
<span class="comment">// }</span>
<span class="comment">// }</span>
<span class="comment">// indic_pena_global_fat += indic_pena_fat;</span>
<span class="comment">// }</span>

<span class="comment">// on convecte le champ de variable avec la vitesse fluide pour les faces ibc</span>
  <span class="keywordflow">if</span> ( <a class="code" href="classConvection__Diffusion__std.html#a1eccdf9e6aedfbf1914e9fa95962fbf9" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: 2 pour une equation de diffusion.">nombre_d_operateurs</a>() &gt; 1 )
    {
      <a class="code" href="classEquation__base.html#a20d04d53bd0c4b48aa923c2b328bb1e3" title="Add convection term In: solution is the unknown I Out: secmem is increased by convection(I)">derivee_en_temps_conv</a>(secmem_conv_vr, inco_conv_vr);
      secmem_conv_vr *= rhoCp;
    }

<span class="comment">// on ne garde la contribution que pour les cellules dont indicatrice fat est &lt;&gt; 0</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_elem = 0; i_elem &lt; nb_elem;  i_elem++)
    {
      <span class="keywordflow">if</span> (indic_pena_global_fat(i_elem) == 0) secmem_conv_vr(i_elem) = 0.;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5893252be9df68bd585d71351ce118e4"></a><!-- doxytag: member="Convection_Diffusion_Temperature::verifier_tag_indicatrice_pena_glob" ref="a5893252be9df68bd585d71351ce118e4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Convection_Diffusion_Temperature::verifier_tag_indicatrice_pena_glob </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00774">774</a> of file <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a>.</p>

<p>References <a class="el" href="classTransport__Interfaces__base.html#ac2016f75dfb4fb46bdbd2fd5adda1d89">Transport_Interfaces_base::get_mesh_tag()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00094">ref_penalisation_L2_FTD</a>, <a class="el" href="vect__impl_8h_source.html#l00057">vect_impl::size()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00091">tag_indic_pena_global</a>, and <a class="el" href="Source__Generique__Face__PolyMAC_8cpp_source.html#l00045">valeur()</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00900">mise_en_place_zone_fantome()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00806">set_indic_pena_globale()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Les ibcs ont elles ete modifiees ?</span>
  <span class="keywordtype">int</span> maj = 0;
  <span class="keywordtype">int</span> tag_all = 0;
  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> w = 0; w&lt;<a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>() ; ++w)
    {
      <a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>&amp; nom_eq = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classTransport__Interfaces__base.html" title="classe Transport_Interfaces_base Cette classe constitue la classe de base des equations de transport ...">Transport_Interfaces_base</a>,<a class="code" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">ref_penalisation_L2_FTD</a>[w].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
      tag_all += nom_eq.<a class="code" href="classTransport__Interfaces__base.html#ac2016f75dfb4fb46bdbd2fd5adda1d89">get_mesh_tag</a>();
    }
  <span class="keywordflow">if</span> (tag_all == <a class="code" href="classConvection__Diffusion__Temperature.html#aa281e6ca4e8b6de76091836eb6d62ae3">tag_indic_pena_global</a>) maj = 1;
  <span class="keywordflow">return</span> maj;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a7038fcce2e880fcf5580f291a4a35ebe"></a><!-- doxytag: member="Convection_Diffusion_Temperature::choix_pena" ref="a7038fcce2e880fcf5580f291a4a35ebe" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classConvection__Diffusion__Temperature.html#a7038fcce2e880fcf5580f291a4a35ebe">Convection_Diffusion_Temperature::choix_pena</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00090">90</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00047">Convection_Diffusion_Temperature()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00125">lire_motcle_non_standard()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01133">penalisation_L2()</a>.</p>

</div>
</div>
<a class="anchor" id="aedbe5cc441073edc75ff1b7e491aa620"></a><!-- doxytag: member="Convection_Diffusion_Temperature::eta" ref="aedbe5cc441073edc75ff1b7e491aa620" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classConvection__Diffusion__Temperature.html#aedbe5cc441073edc75ff1b7e491aa620">Convection_Diffusion_Temperature::eta</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00089">89</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00047">Convection_Diffusion_Temperature()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01331">ecrire_fichier_pena_th()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00125">lire_motcle_non_standard()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01133">penalisation_L2()</a>.</p>

</div>
</div>
<a class="anchor" id="a9791260817ac5155c177a3d98f5d9ba6"></a><!-- doxytag: member="Convection_Diffusion_Temperature::gradient_temperature" ref="a9791260817ac5155c177a3d98f5d9ba6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classChamp__Fonc.html">Champ_Fonc</a> <a class="el" href="classConvection__Diffusion__Temperature.html#a9791260817ac5155c177a3d98f5d9ba6">Convection_Diffusion_Temperature::gradient_temperature</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00081">81</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00400">creer_champ()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00437">get_champ()</a>.</p>

</div>
</div>
<a class="anchor" id="a0a86082c4a7dc0d65dc2b152a79c6d9a"></a><!-- doxytag: member="Convection_Diffusion_Temperature::h_echange" ref="a0a86082c4a7dc0d65dc2b152a79c6d9a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classChamp__Fonc.html">Champ_Fonc</a> <a class="el" href="classConvection__Diffusion__Temperature.html#a0a86082c4a7dc0d65dc2b152a79c6d9a">Convection_Diffusion_Temperature::h_echange</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00085">85</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00400">creer_champ()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00437">get_champ()</a>.</p>

</div>
</div>
<a class="anchor" id="ac11d5686f6bcdd802887cd66c01a54c7"></a><!-- doxytag: member="Convection_Diffusion_Temperature::indic_face_pena_global" ref="ac11d5686f6bcdd802887cd66c01a54c7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classConvection__Diffusion__Temperature.html#ac11d5686f6bcdd802887cd66c01a54c7">Convection_Diffusion_Temperature::indic_face_pena_global</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00093">93</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01073">calcul_indic_pena_global()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00047">Convection_Diffusion_Temperature()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00125">lire_motcle_non_standard()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00900">mise_en_place_zone_fantome()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00806">set_indic_pena_globale()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00818">transport_ibc()</a>.</p>

</div>
</div>
<a class="anchor" id="a051d95d33a49c1860e4da0c5b62d9862"></a><!-- doxytag: member="Convection_Diffusion_Temperature::indic_pena_global" ref="a051d95d33a49c1860e4da0c5b62d9862" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classConvection__Diffusion__Temperature.html#a051d95d33a49c1860e4da0c5b62d9862">Convection_Diffusion_Temperature::indic_pena_global</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00092">92</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01073">calcul_indic_pena_global()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00047">Convection_Diffusion_Temperature()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01059">filtrage_si_appart_ibc()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00125">lire_motcle_non_standard()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00900">mise_en_place_zone_fantome()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01133">penalisation_L2()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00806">set_indic_pena_globale()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00818">transport_ibc()</a>.</p>

</div>
</div>
<a class="anchor" id="a5123a0034845969679e3e43e13069b21"></a><!-- doxytag: member="Convection_Diffusion_Temperature::info_obj" ref="a5123a0034845969679e3e43e13069b21" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a> <a class="el" href="classConvection__Diffusion__Temperature.html#a5123a0034845969679e3e43e13069b21">Convection_Diffusion_Temperature::info_obj</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classConvection__Diffusion__std.html#aeaeea1ba06ab42cae29d7276d60c37d4">Convection_Diffusion_std</a>.</p>

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00043">43</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

</div>
</div>
<a class="anchor" id="a076e32b9ad994a4121452cb3829b9273"></a><!-- doxytag: member="Convection_Diffusion_Temperature::is_penalized" ref="a076e32b9ad994a4121452cb3829b9273" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classConvection__Diffusion__Temperature.html#a076e32b9ad994a4121452cb3829b9273">Convection_Diffusion_Temperature::is_penalized</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00088">88</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00047">Convection_Diffusion_Temperature()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00505">derivee_en_temps_inco()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00125">lire_motcle_non_standard()</a>.</p>

</div>
</div>
<a class="anchor" id="a45b435430d41951ca2e984afb04e8b34"></a><!-- doxytag: member="Convection_Diffusion_Temperature::la_temperature" ref="a45b435430d41951ca2e984afb04e8b34" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classChamp__Inc.html">Champ_Inc</a> <a class="el" href="classConvection__Diffusion__Temperature.html#a45b435430d41951ca2e984afb04e8b34">Convection_Diffusion_Temperature::la_temperature</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00077">77</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00400">creer_champ()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00249">discretiser()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00437">get_champ()</a>, <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00147">inconnue()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00095">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="af5a9044ac039656dcde5c44fe081413e"></a><!-- doxytag: member="Convection_Diffusion_Temperature::le_fluide" ref="af5a9044ac039656dcde5c44fe081413e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRef__Fluide__base.html">Ref_Fluide_base</a> <a class="el" href="classConvection__Diffusion__Temperature.html#af5a9044ac039656dcde5c44fe081413e">Convection_Diffusion_Temperature::le_fluide</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00078">78</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00705">assembler()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00505">derivee_en_temps_inco()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00561">derivee_en_temps_inco_eq_base()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00321">fluide()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00095">readOn()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00818">transport_ibc()</a>.</p>

</div>
</div>
<a class="anchor" id="a025ff54c166b1a5ec73680548e82b913"></a><!-- doxytag: member="Convection_Diffusion_Temperature::ref_penalisation_L2_FTD" ref="a025ff54c166b1a5ec73680548e82b913" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVect__RefObjU.html">Vect_RefObjU</a> <a class="el" href="classConvection__Diffusion__Temperature.html#a025ff54c166b1a5ec73680548e82b913">Convection_Diffusion_Temperature::ref_penalisation_L2_FTD</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00094">94</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01073">calcul_indic_pena_global()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01331">ecrire_fichier_pena_th()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00125">lire_motcle_non_standard()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00788">mise_a_jour_tag_indicatrice_pena_glob()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01133">penalisation_L2()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00774">verifier_tag_indicatrice_pena_glob()</a>.</p>

</div>
</div>
<a class="anchor" id="a9595595fb4b98825455db3dd680d3f64"></a><!-- doxytag: member="Convection_Diffusion_Temperature::tab_penalisation_L2_FTD" ref="a9595595fb4b98825455db3dd680d3f64" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVect__DoubleTab.html">Vect_DoubleTab</a> <a class="el" href="classConvection__Diffusion__Temperature.html#a9595595fb4b98825455db3dd680d3f64">Convection_Diffusion_Temperature::tab_penalisation_L2_FTD</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00095">95</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00125">lire_motcle_non_standard()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00900">mise_en_place_zone_fantome()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l01133">penalisation_L2()</a>.</p>

</div>
</div>
<a class="anchor" id="aa281e6ca4e8b6de76091836eb6d62ae3"></a><!-- doxytag: member="Convection_Diffusion_Temperature::tag_indic_pena_global" ref="aa281e6ca4e8b6de76091836eb6d62ae3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classConvection__Diffusion__Temperature.html#aa281e6ca4e8b6de76091836eb6d62ae3">Convection_Diffusion_Temperature::tag_indic_pena_global</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Convection__Diffusion__Temperature_8h_source.html#l00091">91</a> of file <a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a>.</p>

<p>Referenced by <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00047">Convection_Diffusion_Temperature()</a>, <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00788">mise_a_jour_tag_indicatrice_pena_glob()</a>, and <a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html#l00774">verifier_tag_indicatrice_pena_glob()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/ThHyd/Incompressible/Equations/<a class="el" href="Convection__Diffusion__Temperature_8h_source.html">Convection_Diffusion_Temperature.h</a></li>
<li>src/ThHyd/Incompressible/Equations/<a class="el" href="Convection__Diffusion__Temperature_8cpp_source.html">Convection_Diffusion_Temperature.cpp</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:36:29 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
