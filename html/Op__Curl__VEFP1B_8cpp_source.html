<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/P1NCP1B/Operateurs/Op_Curl_VEFP1B.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/P1NCP1B/Operateurs/Op_Curl_VEFP1B.cpp</div>  </div>
</div>
<div class="contents">
<a href="Op__Curl__VEFP1B_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Op_Curl_VEFP1B.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/P1NCP1B/Operateurs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/8</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Op__Curl__VEFP1B_8h.html">Op_Curl_VEFP1B.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Nom_8h.html">Nom.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="DoubleTab_8h.html">DoubleTab.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Champ__P1NC_8h.html">Champ_P1NC.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__VEF_8h.html">Zone_Cl_VEF.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Front__VF_8h.html">Front_VF.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Zone__dis_8h.html">Zone_dis.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__dis_8h.html">Zone_Cl_dis.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VEF__PreP1b_8h.html">Zone_VEF_PreP1b.h</a>&gt;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="Op__Curl__VEFP1B_8cpp.html#abdf2a8e20ee5bb0d726f9fad8a26f92a">00033</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classOp__Curl__VEFP1B.html">Op_Curl_VEFP1B</a>,<span class="stringliteral">&quot;Op_Curl_VEFPreP1B_P1NC&quot;</span>,<a class="code" href="classOperateur__base.html" title="classe Operateur_base Classe est la base de la hierarchie des objets representant un operateur utilis...">Operateur_base</a>);
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">// printOn et readOn</span>
<a name="l00036"></a><a class="code" href="classOp__Curl__VEFP1B.html#a9b945e5d11ae8bba7a64b9b452287184">00036</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classOp__Curl__VEFP1B.html#a9b945e5d11ae8bba7a64b9b452287184" title="NE FAIT RIEN A surcharger dans les classes derivees. Imprime l&#39;operateur sur un flot de sortie...">Op_Curl_VEFP1B::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00037"></a>00037 <span class="keyword"></span>{
<a name="l00038"></a>00038   <span class="keywordflow">return</span> s;
<a name="l00039"></a>00039 }
<a name="l00040"></a><a class="code" href="classOp__Curl__VEFP1B.html#aea3eec1c64c6d41d32fe3e7ed8c7d752">00040</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classOp__Curl__VEFP1B.html#aea3eec1c64c6d41d32fe3e7ed8c7d752" title="NE FAIT RIEN A surcharger dans les classes derivees. Lit un operateur sur un flot d&#39;entree...">Op_Curl_VEFP1B::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00041"></a>00041 {
<a name="l00042"></a>00042   <span class="keywordflow">return</span> is;
<a name="l00043"></a>00043 }
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 
<a name="l00046"></a><a class="code" href="classOp__Curl__VEFP1B.html#a4eebca74690afb0bd8bf656c0f1864a2">00046</a> <span class="keyword">const</span> <a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>&amp; <a class="code" href="classOp__Curl__VEFP1B.html#a4eebca74690afb0bd8bf656c0f1864a2">Op_Curl_VEFP1B::zone_Vef</a>()<span class="keyword"> const</span>
<a name="l00047"></a>00047 <span class="keyword"></span>{
<a name="l00048"></a>00048   <span class="keywordflow">return</span> <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF__PreP1b.html">Zone_VEF_PreP1b</a>, <a class="code" href="classOp__Curl__VEFP1B.html#af6f1a737aecefa8cea9e37f151f20ba5">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>());
<a name="l00049"></a>00049 }
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="comment">//</span>
<a name="l00052"></a>00052 <span class="comment">// Fonctions locales a ce fichier</span>
<a name="l00053"></a>00053 <span class="comment">//</span>
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="Op__Curl__VEFP1B_8cpp.html#aa7dc07c820d4eb029b7c8945652478ab">00055</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="Op__Curl__VEFP1B_8cpp.html#aa7dc07c820d4eb029b7c8945652478ab">add_curl_som</a>(<span class="keywordtype">int</span> nps, <span class="keywordtype">int</span> sommet, <span class="keywordtype">int</span> face, <span class="keywordtype">double</span> flux,
<a name="l00056"></a>00056                          <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; curl, <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; domaine)
<a name="l00057"></a>00057 {
<a name="l00058"></a>00058   curl(nps+domaine.<a class="code" href="classDomaine.html#a37cc657f1907d53b0d5a573da862af80">get_renum_som_perio</a>(sommet)) += flux;
<a name="l00059"></a>00059 }
<a name="l00060"></a>00060 
<a name="l00061"></a><a class="code" href="Op__Curl__VEFP1B_8cpp.html#a026a4236dce2472481fb7b8d598d22f2">00061</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="Op__Curl__VEFP1B_8cpp.html#a026a4236dce2472481fb7b8d598d22f2">traiter_flux</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; curl, <span class="keywordtype">double</span> flux, <span class="keywordtype">int</span> element1,
<a name="l00062"></a>00062                          <span class="keywordtype">int</span> element2, <span class="keywordtype">int</span> npe)
<a name="l00063"></a>00063 {
<a name="l00064"></a>00064   curl(npe+element1)+=flux;
<a name="l00065"></a>00065   curl(npe+element2)-=flux;
<a name="l00066"></a>00066 }
<a name="l00067"></a>00067 <span class="comment">//</span>
<a name="l00068"></a>00068 <span class="comment">// </span>
<a name="l00069"></a>00069 <span class="comment">//</span>
<a name="l00070"></a>00070 
<a name="l00071"></a><a class="code" href="classOp__Curl__VEFP1B.html#aa2c346b443c2fde59a2a834776525158">00071</a> <span class="keywordtype">void</span> <a class="code" href="classOp__Curl__VEFP1B.html#aa2c346b443c2fde59a2a834776525158">Op_Curl_VEFP1B::associer</a>(<span class="keyword">const</span> <a class="code" href="classZone__dis.html" title="classe Zone_dis Classe generique de la hierarchie des zones discretisees. Un objet de type Zone_dis p...">Zone_dis</a>&amp; zone_dis,
<a name="l00072"></a>00072                               <span class="keyword">const</span> <a class="code" href="classZone__Cl__dis.html" title="classe Zone_Cl_dis Classe generique de la hierarchie des conditions aux limites discretisees. Un objet Zone_Cl_dis peut referencer n&#39;importe quel derivant de Zone_Cl_dis_base. La plupart des methodes appellent les methodes de l&#39;objet Probleme sous-jacent via la methode valeur() declaree grace a la macro Declare_deriv().;">Zone_Cl_dis</a>&amp; zone_Cl_dis,
<a name="l00073"></a>00073                               <span class="keyword">const</span> <a class="code" href="classChamp__Inc.html">Champ_Inc</a>&amp; inco)
<a name="l00074"></a>00074 {
<a name="l00075"></a>00075   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zvef = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>, zone_dis.<a class="code" href="classDeriv__Zone__dis__base.html#a30ff47fc0684fe134e8c74c35b268941">valeur</a>());
<a name="l00076"></a>00076   <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zclvef = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>, zone_Cl_dis.<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00077"></a>00077   <a class="code" href="classOp__Curl__VEFP1B.html#af6f1a737aecefa8cea9e37f151f20ba5">la_zone_vef</a> = zvef;
<a name="l00078"></a>00078   <a class="code" href="classOp__Curl__VEFP1B.html#a34be42b23b0eae15608417d1f9661936">la_zcl_vef</a> = zclvef;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   <a class="code" href="classOp__Curl__VEFP1B.html#a99eb2150a4f0e3c42db87544dc9ba86d">elements_pour_sommet</a>();
<a name="l00081"></a>00081 }
<a name="l00082"></a>00082 
<a name="l00083"></a><a class="code" href="classOp__Curl__VEFP1B.html#a7633908e56d05a5b56454702673eee75">00083</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Curl__VEFP1B.html#a7633908e56d05a5b56454702673eee75">Op_Curl_VEFP1B::calculer</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; curl)<span class="keyword"> const</span>
<a name="l00084"></a>00084 <span class="keyword"></span>{
<a name="l00085"></a>00085   curl = 0;
<a name="l00086"></a>00086   <span class="keywordflow">return</span> <a class="code" href="classOp__Curl__VEFP1B.html#a8bad4199eda5578314e0e87b3805a070">ajouter</a>(vitesse,curl);
<a name="l00087"></a>00087 }
<a name="l00088"></a>00088 
<a name="l00089"></a><a class="code" href="classOp__Curl__VEFP1B.html#a8bad4199eda5578314e0e87b3805a070">00089</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classOp__Curl__VEFP1B.html#a8bad4199eda5578314e0e87b3805a070">Op_Curl_VEFP1B::ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse,
<a name="l00090"></a>00090                                    <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; curl)<span class="keyword"> const</span>
<a name="l00091"></a>00091 <span class="keyword"></span>{
<a name="l00092"></a>00092   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Je suis dans operateur curl&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Curl__VEFP1B.html#af6f1a737aecefa8cea9e37f151f20ba5">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
<a name="l00095"></a>00095   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00096"></a>00096 <span class="comment">// int prems=zone_VEF.premiere_face_int();</span>
<a name="l00097"></a>00097   <span class="keywordflow">if</span> ( <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> != 2 )
<a name="l00098"></a>00098     {
<a name="l00099"></a>00099       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Pour l&#39;instant seule la 2D est etudiee. &quot;</span> &lt;&lt; finl;
<a name="l00100"></a>00100       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00101"></a>00101     }
<a name="l00102"></a>00102 
<a name="l00103"></a>00103   <span class="keywordtype">int</span> face0=0,face1=0,face2=0;
<a name="l00104"></a>00104   <span class="keywordtype">int</span> numero_triangle=0;
<a name="l00105"></a>00105   <span class="keywordtype">int</span> face_globale=0,face_opp=0;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vecteur_normal0(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00108"></a>00108   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vecteur_normal1(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00109"></a>00109   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vecteur_normal2(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 <span class="comment">// On traite les faces internes i.e. sans conditions aux limites</span>
<a name="l00112"></a>00112 <span class="comment">// ATTENTION: la base de la vorticite c&#39;est: l&#39;ensemble des</span>
<a name="l00113"></a>00113 <span class="comment">// fonctions indicatrices des elements + l&#39;ensemble des fonctions</span>
<a name="l00114"></a>00114 <span class="comment">// chapeaux du P1 moins la derniere de ces fonctions de forme</span>
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 <span class="comment">// Partie P0 de la vorticite</span>
<a name="l00117"></a>00117   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> numero_elem = 0; numero_elem &lt; zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>(); numero_elem++)
<a name="l00118"></a>00118     {
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="comment">// REM: on peut generaliser cette partie a la 3D en</span>
<a name="l00121"></a>00121 <span class="comment">// faisant une boucle avec zone.nb_faces_element()</span>
<a name="l00122"></a>00122 
<a name="l00123"></a>00123 <span class="comment">// Il nous faut d&#39;abord les numeros des 3 faces</span>
<a name="l00124"></a>00124 <span class="comment">// qui appartiennent a cet element K</span>
<a name="l00125"></a>00125       face0 = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>(numero_elem,0);
<a name="l00126"></a>00126       face1 = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>(numero_elem,1);
<a name="l00127"></a>00127       face2 = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>(numero_elem,2);
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 <span class="comment">// Ensuite, il nous faut les vecteurs tangents de</span>
<a name="l00130"></a>00130 <span class="comment">// ces trois faces.</span>
<a name="l00131"></a>00131       vecteur_normal0 = <a class="code" href="classOp__Curl__VEFP1B.html#a732ed94d9db4fe322beca3ae655cd320">vecteur_normal</a>(face0,numero_elem);
<a name="l00132"></a>00132       vecteur_normal1 = <a class="code" href="classOp__Curl__VEFP1B.html#a732ed94d9db4fe322beca3ae655cd320">vecteur_normal</a>(face1,numero_elem);
<a name="l00133"></a>00133       vecteur_normal2 = <a class="code" href="classOp__Curl__VEFP1B.html#a732ed94d9db4fe322beca3ae655cd320">vecteur_normal</a>(face2,numero_elem);
<a name="l00134"></a>00134 
<a name="l00135"></a>00135       <span class="keywordtype">int</span> modulo;
<a name="l00136"></a>00136       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>=0; <a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; <a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>++)
<a name="l00137"></a>00137         {
<a name="l00138"></a>00138 <span class="comment">// La partie P0 a ete teste avec les fonctions (1,0);</span>
<a name="l00139"></a>00139 <span class="comment">// (0,1);(x,0) et (0,x).</span>
<a name="l00140"></a>00140 <span class="comment">// Tous les resultats sont corrects</span>
<a name="l00141"></a>00141 
<a name="l00142"></a>00142           modulo = (<a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>+1)%2;
<a name="l00143"></a>00143           curl(numero_elem) +=  pow(-1.,modulo) * (
<a name="l00144"></a>00144                                   vitesse(face0,<a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>)*vecteur_normal0(modulo)+
<a name="l00145"></a>00145                                   vitesse(face1,<a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>)*vecteur_normal1(modulo)+
<a name="l00146"></a>00146                                   vitesse(face2,<a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>)*vecteur_normal2(modulo) );
<a name="l00147"></a>00147 
<a name="l00148"></a>00148         }
<a name="l00149"></a>00149 
<a name="l00150"></a>00150       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Element curl(&quot;</span> &lt;&lt; numero_elem &lt;&lt; <span class="stringliteral">&quot;) &quot;</span> &lt;&lt; curl(numero_elem) &lt;&lt; finl;
<a name="l00151"></a>00151     }
<a name="l00152"></a>00152 
<a name="l00153"></a>00153 <span class="comment">// Partie P1 de la vorticite</span>
<a name="l00154"></a>00154 
<a name="l00155"></a>00155   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> numero_som = 0; numero_som &lt; zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>()-1; numero_som++)
<a name="l00156"></a>00156     {
<a name="l00157"></a>00157       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_loc_elem = 0; num_loc_elem &lt; <a class="code" href="classOp__Curl__VEFP1B.html#a1e2cbb8d630bc56484ad08b7513473ec">elem_som_size</a>(numero_som);
<a name="l00158"></a>00158            num_loc_elem++)
<a name="l00159"></a>00159 
<a name="l00160"></a>00160         {
<a name="l00161"></a>00161 <span class="comment">// for num_loc_elem</span>
<a name="l00162"></a>00162 
<a name="l00163"></a>00163 <span class="comment">// On recupere le numero global du triangle</span>
<a name="l00164"></a>00164           numero_triangle = <a class="code" href="classOp__Curl__VEFP1B.html#a99eb2150a4f0e3c42db87544dc9ba86d">elements_pour_sommet</a>(numero_som,num_loc_elem);
<a name="l00165"></a>00165 
<a name="l00166"></a>00166 <span class="comment">// On recupere le numero global de la face opposee a &quot;numero_som&quot;</span>
<a name="l00167"></a>00167 <span class="comment">// dans le triangle &quot;numero_triangle&quot;</span>
<a name="l00168"></a>00168           face_opp=zone_VEF.<a class="code" href="classZone__VF.html#ab84d71afcd3e7fa780f9bcffe176defc">numero_sommet_local</a>(numero_som,numero_triangle);
<a name="l00169"></a>00169           face_opp=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>(numero_triangle,face_opp);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="comment">// On recupere le vecteur normal de cette face opposee.</span>
<a name="l00172"></a>00172           vecteur_normal1=<a class="code" href="classOp__Curl__VEFP1B.html#a732ed94d9db4fe322beca3ae655cd320">vecteur_normal</a>(face_opp,numero_triangle);
<a name="l00173"></a>00173 
<a name="l00174"></a>00174           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_loc_face = 0 ; num_loc_face &lt; zone.<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
<a name="l00175"></a>00175                num_loc_face++)
<a name="l00176"></a>00176 
<a name="l00177"></a>00177             {
<a name="l00178"></a>00178 <span class="comment">// for num_loc_face</span>
<a name="l00179"></a>00179 
<a name="l00180"></a>00180 <span class="comment">// On recupere le numero global de la face &quot;num_loc_face&quot;</span>
<a name="l00181"></a>00181               face_globale=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>(numero_triangle,num_loc_face);
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="comment">// //Si &quot;face_globale&quot; est une arete interne alors on effectue le bon</span>
<a name="l00184"></a>00184 <span class="comment">// //traitement</span>
<a name="l00185"></a>00185 <span class="comment">// if (face_globale &gt;= zone_VEF.premiere_face_int() )</span>
<a name="l00186"></a>00186               {
<a name="l00187"></a>00187 <span class="comment">// On calcule les vecteurs normaux associes a ces faces.</span>
<a name="l00188"></a>00188                 vecteur_normal0=<a class="code" href="classOp__Curl__VEFP1B.html#a732ed94d9db4fe322beca3ae655cd320">vecteur_normal</a>(face_globale,numero_triangle);
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 <span class="comment">// Enfin on calcule la contribution au curl de chacune de</span>
<a name="l00191"></a>00191 <span class="comment">// ces faces pour chacun des 2 triangles.</span>
<a name="l00192"></a>00192                 <span class="keywordtype">int</span> modulo;
<a name="l00193"></a>00193                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>=0; <a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; <a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>++)
<a name="l00194"></a>00194                   {
<a name="l00195"></a>00195 <span class="comment">// Partie P1 teste avec les fonctions (1,0);(0,1)</span>
<a name="l00196"></a>00196 <span class="comment">// (x,0) et (0,x).</span>
<a name="l00197"></a>00197 <span class="comment">// Tous les tests sont corrects</span>
<a name="l00198"></a>00198 
<a name="l00199"></a>00199                     modulo = (<a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>+1)%2;
<a name="l00200"></a>00200 
<a name="l00201"></a>00201 <span class="comment">// Partie (lambda_s,curl u)</span>
<a name="l00202"></a>00202                     curl(zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>()+numero_som) += -pow(-1.,modulo) *
<a name="l00203"></a>00203                                                        1./(dimension+1) *
<a name="l00204"></a>00204                                                        vitesse(face_globale,<a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>) *
<a name="l00205"></a>00205                                                        vecteur_normal0(modulo);
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 <span class="comment">// Partie (rot lambda_s, u)</span>
<a name="l00208"></a>00208                     curl(zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>()+numero_som) += pow(-1.,modulo)*
<a name="l00209"></a>00209                                                        1./(dimension*(dimension+1))*
<a name="l00210"></a>00210                                                        vitesse(face_globale,<a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>)*
<a name="l00211"></a>00211                                                        vecteur_normal1(modulo);
<a name="l00212"></a>00212                   }
<a name="l00213"></a>00213 
<a name="l00214"></a>00214               } <span class="comment">//!&lt; fin du if</span>
<a name="l00215"></a>00215 <span class="comment"></span>
<a name="l00216"></a>00216             }<span class="comment">//!&lt; fin du for num_loc_face</span>
<a name="l00217"></a>00217 <span class="comment"></span>
<a name="l00218"></a>00218           <span class="comment">/* Pour le moment, on ne travaille que sur des vitesse H10 */</span>
<a name="l00219"></a>00219           <span class="comment">/* C&#39;est le travail de these */</span>
<a name="l00220"></a>00220           <span class="comment">/* Par consequent, inutile de traiter les faces du bord */</span>
<a name="l00221"></a>00221 
<a name="l00222"></a>00222         }<span class="comment">//!&lt; fin du for num_loc_elem</span>
<a name="l00223"></a>00223 <span class="comment"></span>
<a name="l00224"></a>00224       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Sommet curl(&quot;</span> &lt;&lt; numero_som &lt;&lt; <span class="stringliteral">&quot;) &quot;</span> &lt;&lt; curl(zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>()+numero_som) &lt;&lt; finl;
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     }<span class="comment">//!&lt; fin du for sur les sommets</span>
<a name="l00227"></a>00227 <span class="comment"></span>
<a name="l00228"></a>00228   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;je sors de OpCurl&quot;</span> &lt;&lt; finl;
<a name="l00229"></a>00229 
<a name="l00230"></a>00230   <span class="keywordflow">return</span> curl;
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>
<a name="l00234"></a><a class="code" href="classOp__Curl__VEFP1B.html#a732ed94d9db4fe322beca3ae655cd320">00234</a> <a class="code" href="classOp__Curl__VEFP1B.html#a732ed94d9db4fe322beca3ae655cd320">Op_Curl_VEFP1B::vecteur_normal</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; face, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; elem)<span class="keyword"> const</span>
<a name="l00235"></a>00235 <span class="keyword"></span>{
<a name="l00236"></a>00236   assert(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> == 2);
<a name="l00237"></a>00237 
<a name="l00238"></a>00238   <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Curl__VEFP1B.html#af6f1a737aecefa8cea9e37f151f20ba5">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
<a name="l00239"></a>00239   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> le_vecteur_normal(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00240"></a>00240 
<a name="l00241"></a>00241   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a> = 0; <a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; <a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>++)
<a name="l00242"></a>00242 
<a name="l00243"></a>00243     le_vecteur_normal(<a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>) = zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>(face,<a class="code" href="Postraitement_8cpp.html#a80c976c7cd9c2ae6998569ef44a4b304">composante</a>)
<a name="l00244"></a>00244                                     * zone_VEF.<a class="code" href="classZone__VEF.html#a5c3e9d7f89d87989e338f5d725853e48">oriente_normale</a>(face,elem);
<a name="l00245"></a>00245 
<a name="l00246"></a>00246   <span class="keywordflow">return</span> le_vecteur_normal;
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 <span class="comment">// Tableau qui stocke a la place &quot;i&quot;, tous les elements</span>
<a name="l00251"></a>00251 <span class="comment">// du maillage qui contiennent le sommet de numero global &quot;i&quot;</span>
<a name="l00252"></a><a class="code" href="classOp__Curl__VEFP1B.html#a99eb2150a4f0e3c42db87544dc9ba86d">00252</a> <span class="keywordtype">int</span> <a class="code" href="classOp__Curl__VEFP1B.html#a99eb2150a4f0e3c42db87544dc9ba86d">Op_Curl_VEFP1B::elements_pour_sommet</a>()
<a name="l00253"></a>00253 {
<a name="l00254"></a>00254   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = <a class="code" href="classOp__Curl__VEFP1B.html#af6f1a737aecefa8cea9e37f151f20ba5">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>().<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00255"></a>00255   <span class="keywordtype">int</span> numero_global_som;
<a name="l00256"></a>00256   <a class="code" href="classOp__Curl__VEFP1B.html#ac0405142ea4a383d3f929f474c8faad6">elements_pour_sommet_</a>.<a class="code" href="classIntLists.html#afa2bb253d9d4764110ca8cc4b93649ed" title="Redimensionne un tableau de listes.">dimensionner</a>(zone.<a class="code" href="classZone.html#ad340f571f81fa5c2e028b88c00b5c2ca" title="Renvoie le nombre de sommets de la zone.">nb_som</a>());
<a name="l00257"></a>00257 
<a name="l00258"></a>00258   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> numero_elem = 0; numero_elem &lt; zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>(); numero_elem++)
<a name="l00259"></a>00259     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> numero_som_loc=0; numero_som_loc &lt; zone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>(); numero_som_loc++)
<a name="l00260"></a>00260       {
<a name="l00261"></a>00261         numero_global_som = zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(numero_elem,numero_som_loc);
<a name="l00262"></a>00262         <a class="code" href="classOp__Curl__VEFP1B.html#ac0405142ea4a383d3f929f474c8faad6">elements_pour_sommet_</a>[numero_global_som].add_if_not(numero_elem);
<a name="l00263"></a>00263       }
<a name="l00264"></a>00264 
<a name="l00265"></a>00265   <span class="keywordflow">return</span> 1;
<a name="l00266"></a>00266 }
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 <span class="comment">// Fonction qui renvoie le numero global de l&#39;element qui contient &quot;sommet&quot;</span>
<a name="l00269"></a>00269 <span class="comment">// et qui est situe a la place &quot;indice&quot; de la liste &quot;elements_pour_sommet_&quot;</span>
<a name="l00270"></a><a class="code" href="classOp__Curl__VEFP1B.html#ac5c4c2709e16e06e1eb9b1d7069f8710">00270</a> <span class="keywordtype">int</span> <a class="code" href="classOp__Curl__VEFP1B.html#a99eb2150a4f0e3c42db87544dc9ba86d">Op_Curl_VEFP1B::elements_pour_sommet</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; sommet,<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; indice)<span class="keyword"> const</span>
<a name="l00271"></a>00271 <span class="keyword"></span>{
<a name="l00272"></a>00272   <span class="keywordflow">return</span> <a class="code" href="classOp__Curl__VEFP1B.html#ac0405142ea4a383d3f929f474c8faad6">elements_pour_sommet_</a>[sommet][indice];
<a name="l00273"></a>00273 }
<a name="l00274"></a>00274 
<a name="l00275"></a>00275 <span class="comment">// Fonction qui renvoie la taille de la liste situe a l&#39;emplacement &quot;sommet&quot;</span>
<a name="l00276"></a>00276 <span class="comment">// du tableau &quot;elements_pour_sommet_&quot;</span>
<a name="l00277"></a><a class="code" href="classOp__Curl__VEFP1B.html#a1e2cbb8d630bc56484ad08b7513473ec">00277</a> <span class="keywordtype">int</span> <a class="code" href="classOp__Curl__VEFP1B.html#a1e2cbb8d630bc56484ad08b7513473ec">Op_Curl_VEFP1B::elem_som_size</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; sommet)<span class="keyword"> const</span>
<a name="l00278"></a>00278 <span class="keyword"></span>{
<a name="l00279"></a>00279   <span class="keywordflow">return</span> <a class="code" href="classOp__Curl__VEFP1B.html#ac0405142ea4a383d3f929f474c8faad6">elements_pour_sommet_</a>[sommet].<a class="code" href="classIntLists.html#a823946693bc491321765f0e6805204e2" title="retourne le nombre de listes dans le tableau">size</a>();
<a name="l00280"></a>00280 }
<a name="l00281"></a>00281 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:28 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
