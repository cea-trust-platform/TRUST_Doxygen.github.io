<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: Op_Conv_EF_VEF_P1NC_Stab Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">Op_Conv_EF_VEF_P1NC_Stab Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Op_Conv_EF_VEF_P1NC_Stab" --><!-- doxytag: inherits="Op_Conv_VEF_Face" -->
<p>class <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html" title="class Op_Conv_EF_VEF_P1NC_Stab Cette classe represente l&#39;operateur de convection associe a une equati...">Op_Conv_EF_VEF_P1NC_Stab</a><br/>
Cette classe represente l'operateur de convection associe a une equation de<br/>
transport d'un scalaire.<br/>
La discretisation est VEF<br/>
Le champ convecte est scalaire ou vecteur de type <a class="el" href="classChamp__P1NC.html">Champ_P1NC</a><br/>
Le schema de convection est isu du papier<br/>
"High-resolution FEM-TVD schemes based on a fully multidimensional flux limiter"<br/>
D.Kuzmin and S.Turek.<br/>
On herite de Op pour recuperer l'implicitation amont  
 <a href="classOp__Conv__EF__VEF__P1NC__Stab.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Op_Conv_EF_VEF_P1NC_Stab:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classOp__Conv__EF__VEF__P1NC__Stab.png" usemap="#Op_Conv_EF_VEF_P1NC_Stab_map" alt=""/>
  <map id="Op_Conv_EF_VEF_P1NC_Stab_map" name="Op_Conv_EF_VEF_P1NC_Stab_map">
<area href="classOp__Conv__VEF__Face.html" title="class Op_Conv_VEF_Face Cette classe represente l&#39;operateur de convection associe a une equation de tr..." alt="Op_Conv_VEF_Face" shape="rect" coords="304,280,497,304"/>
<area href="classOp__Conv__VEF__base.html" title="class Op_Conv_VEF_base Classe de base des operateurs de convection VEF" alt="Op_Conv_VEF_base" shape="rect" coords="304,224,497,248"/>
<area href="classOperateur__Conv__base.html" title="classe Operateur_Conv_base Cette classe est la base de la hierarchie des operateurs representant un t..." alt="Operateur_Conv_base" shape="rect" coords="203,168,396,192"/>
<area href="classOp__VEF__Face.html" alt="Op_VEF_Face" shape="rect" coords="406,168,599,192"/>
<area href="classOperateur__base.html" title="classe Operateur_base Classe est la base de la hierarchie des objets representant un operateur utilis..." alt="Operateur_base" shape="rect" coords="203,112,396,136"/>
<area href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob..." alt="Objet_U" shape="rect" coords="0,56,193,80"/>
<area href="classMorEqn.html" title="classe MorEqn Classe qui regroupe les fonctionnalites de liaison avec une Equation. Le membre MorEqn::mon_equation contient une reference vers un objet Equation_base. Les classes qui sont des &quot;Morceaux d&#39;equation&quot; sont associe par une liaison 1-1 a leur equation en heritant de MorEqn, par exemple: Operateur_base, Solveur_Masse, Source_base ..." alt="MorEqn" shape="rect" coords="203,56,396,80"/>
<area href="classChamps__compris__interface.html" title="classe Champs_compris_interface Cette classe contient une interface de methodes destinees a gerer les..." alt="Champs_compris_interface" shape="rect" coords="406,56,599,80"/>
<area href="classProcess.html" title="Classe de base de TRUST (notamment Objet_U). Elle fournit quelques services de base accessibles de pa..." alt="Process" shape="rect" coords="0,0,193,24"/>
</map>
 </div></div>

<p><a href="classOp__Conv__EF__VEF__P1NC__Stab-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a7a6dd27848e8c5a311647376644be392">Op_Conv_EF_VEF_P1NC_Stab</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a01afec1d84e34c6c3fea847fc1aa1237">~Op_Conv_EF_VEF_P1NC_Stab</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aa7fe145018f53089c26323d64b1cd808">taille_memoire</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a1b807c5a31fa60c909ebe69e81a2adc4">duplique</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classType__info.html">Type_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a1c79230221c8b7758076fa691e5b39c5">get_info</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Donne des informations sur le type de l'Objet_U.  <a href="#a1c79230221c8b7758076fa691e5b39c5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a1c6a846b83bbf93ffaddfe6b0f040fe1">remplir_fluent</a> (<a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a47038cfd3c5fd1d0bbc4e61bc0d58d9d">is_compressible</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ada87b91828b2a25c45b299cce3e8e26a">completer</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Associe l'operateur a la zone_dis, la zone_Cl_dis,<br/>
et a l'inconnue de son equation.  <a href="#ada87b91828b2a25c45b299cce3e8e26a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a2364297a05bedfff1cde523dfc9563b0">ajouter</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ae88c01c5bab6101cc73c18023db6f55b">contribuer_a_avec</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">on assemble la matrice des inconnues implicite.  <a href="#ae88c01c5bab6101cc73c18023db6f55b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a25b8ce54605b7783a8d7078a932e4187">ajouter_contribution</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af4230688a46b05442654639fb87b1a14">modifier_pour_Cl</a> (<a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">On modifie le second membre et la matrice dans le cas des<br/>
conditions de dirichlet.  <a href="#af4230688a46b05442654639fb87b1a14"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classObjet__U.html">Objet_U</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a0bc0e96870fa11143a92dcbeb2a36ec6">cree_instance</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classType__info.html">Type_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a3507906fb3da346af9d9b6d23fccefa0">info</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Donne des informations sur le type de l'Objet_U.  <a href="#a3507906fb3da346af9d9b6d23fccefa0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html">Op_Conv_EF_VEF_P1NC_Stab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a19f131f7e109c2715031324fa9c116f9">self_cast</a> (<a class="el" href="classObjet__U.html">Objet_U</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <br class="typebreak"/>
<a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html">Op_Conv_EF_VEF_P1NC_Stab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a72ce7a8fd1825b07a59f1eb8fddd656f">self_cast</a> (const <a class="el" href="classObjet__U.html">Objet_U</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">methode ajoutee pour caster en python  <a href="#a72ce7a8fd1825b07a59f1eb8fddd656f"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classType__info.html">Type_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a219062e7ce20f8e2d281c87823754ecf">info_obj</a></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a603ebee3d7bebc91e571c828355a13ff">printOn</a> (<a class="el" href="classSortie.html">Sortie</a> &amp;x) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">NE FAIT RIEN<br/>
A surcharger dans les classes derivees.  <a href="#a603ebee3d7bebc91e571c828355a13ff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classEntree.html">Entree</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a902293420aedb4314065a6855089ac7e">readOn</a> (<a class="el" href="classEntree.html">Entree</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">NE FAIT RIEN<br/>
A surcharger dans les classes derivees.  <a href="#a902293420aedb4314065a6855089ac7e"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a2a5d2defd737046ab7ee6397e476ec8b">calculer_flux_bords</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a23d5e4497b9f329921e370a3208ff9fc">reinit_conv_pour_Cl</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classIntList.html">IntList</a> &amp;, const <a class="el" href="classDoubleTabs.html">DoubleTabs</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a3c1c70e249ebd12239c7987a4e50d277">calculer_coefficients_operateur_centre</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const int &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;vitesse) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a81ab1069edcf31b0e416a557d9443f7f">ajouter_partie_compressible</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;vitesse) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a1cc3e4915dcd0e22759b0f290f9ffbf5">ajouter_operateur_centre</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a2afbe2fa6f98fe9539705ef2d0d392f7">ajouter_diffusion</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#afaf4f194109f5b37d07e7010278aafdc">ajouter_antidiffusion</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a49f11cc19b99f1b9ade819f868877381">calculer_senseur</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;, const int &amp;, const int &amp;, const <a class="el" href="classIntTab.html">IntTab</a> &amp;, const <a class="el" href="classIntTab.html">IntTab</a> &amp;, const <a class="el" href="classIntTab.html">IntTab</a> &amp;, <a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;, <a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;, <a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;, <a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ab106a70062c1831cca041196080bdeaf">mettre_a_jour_pour_periodicite</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a14bece1772d9e8a5ffa4105ea14ca06a">ajouter_old</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;vitesse) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a483b58e139830af331d1abcd63f2e834">calculer_data_pour_dirichlet</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ad7f5145ac5fa237d31363a2ef4037afa">ajouter_contribution_operateur_centre</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#afe634e48a923aa8f514e3addb1061b9e">ajouter_contribution_diffusion</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a205252afcc4f18ae771ce126e561ff57">ajouter_contribution_antidiffusion</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a12349ea012bfb6446b63f9133eb3da11">ajouter_contribution_partie_compressible</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a17c05c25fb60782de56829f75478f094">test</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;vitesse) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#acc4bfd43f8e442a185a5310a22b8176e">test_difference_Kij</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;vitesse) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af6c40b1ce58622e73b53f011fbb0f0e5">test_difference_resu</a> (const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;, const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;vitesse) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a2235e9d9ed398ec7c4b0fb6d91269e11">test_implicite</a> () const </td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aed3b960a81290a5110ae7ac8f9006fd8">elem_nb_faces_dirichlet_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">elem_faces_dirichlet_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac1b44ec3559d53eaf94d49b3e029ae4b">beta</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">vaut zero pour les faces ou l'on souhaite degenerer en Amont. mutable <a class="el" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> limiteurs_;//tableau stockant pour chaque face la moyenne algebrique du limiteur  <a href="#ac1b44ec3559d53eaf94d49b3e029ae4b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a515503fe50ac73fb7f86363fea4ee594">alpha_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a5ed7b641e615d0a8fea46aaf3eaaad3b">is_compressible_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af913e1b9445b37211f13e9bf5c01d92e">test_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#add33e5ac4396a277bfeca3638cf7a585">old_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a0fa21a81e6deda452a87699846cc1cd6">volumes_etendus_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a13400182e7ede0cc88d147e934b1cd1d">sous_zone</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Cas d'une sous-zone a definir pour que l'EF_Stab degenere en Amont.  <a href="#a13400182e7ede0cc88d147e934b1cd1d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a8b4181342631eedf901e574b5e9e4474">new_jacobienne_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classNom.html">Nom</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af0f2ade834ec7306b493e72c80f1aca1">nom_sous_zone</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRef__Sous__zone__VF.html">Ref_Sous_zone_VF</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a99b6274ae7744713950dbf600509b053">la_sous_zone_dis</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac6dad1bca9e67b647241a2c17b1d9998">nb_ssz_alpha</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleVect.html">DoubleVect</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aedd6723f68a86c7ff13cb281c5ecb03b">alpha_ssz</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classNoms.html">Noms</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a902ac33a37f9a30d97206c9d9a9acadf">noms_ssz_alpha</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aebf5d2735a227a53fd44c9df6042b10d">ssz_alpha</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>class <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html" title="class Op_Conv_EF_VEF_P1NC_Stab Cette classe represente l&#39;operateur de convection associe a une equati...">Op_Conv_EF_VEF_P1NC_Stab</a><br/>
Cette classe represente l'operateur de convection associe a une equation de<br/>
transport d'un scalaire.<br/>
La discretisation est VEF<br/>
Le champ convecte est scalaire ou vecteur de type <a class="el" href="classChamp__P1NC.html">Champ_P1NC</a><br/>
Le schema de convection est isu du papier<br/>
"High-resolution FEM-TVD schemes based on a fully multidimensional flux limiter"<br/>
D.Kuzmin and S.Turek.<br/>
On herite de Op pour recuperer l'implicitation amont </p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00050">50</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7a6dd27848e8c5a311647376644be392"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::Op_Conv_EF_VEF_P1NC_Stab" ref="a7a6dd27848e8c5a311647376644be392" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Op_Conv_EF_VEF_P1NC_Stab::Op_Conv_EF_VEF_P1NC_Stab </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00038">38</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a01afec1d84e34c6c3fea847fc1aa1237"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::~Op_Conv_EF_VEF_P1NC_Stab" ref="a01afec1d84e34c6c3fea847fc1aa1237" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Op_Conv_EF_VEF_P1NC_Stab::~Op_Conv_EF_VEF_P1NC_Stab </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00038">38</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a2364297a05bedfff1cde523dfc9563b0"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::ajouter" ref="a2364297a05bedfff1cde523dfc9563b0" args="(const DoubleTab &amp;, DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Op_Conv_EF_VEF_P1NC_Stab::ajouter </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#a88409d0b56b9e0db3d4f241a09930f82">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">551</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00845">ajouter_antidiffusion()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00800">ajouter_diffusion()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01606">ajouter_old()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00762">ajouter_operateur_centre()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00633">ajouter_partie_compressible()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00313">calculer_coefficients_operateur_centre()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00702">calculer_flux_bords()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="MorEqn_8h_source.html#l00082">MorEqn::equation()</a>, <a class="el" href="Operateur__base_8h_source.html#l00168">Operateur_base::flux_bords_</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00112">is_compressible_</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01562">mettre_a_jour_pour_periodicite()</a>, <a class="el" href="Porosites__champ_8cpp_source.html#l00035">modif_par_porosite_si_flag()</a>, <a class="el" href="Op__VEF__Face_8cpp_source.html#l00384">Op_VEF_Face::modifier_flux()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Zone__VF_8h_source.html#l00547">Zone_VF::nb_faces_bord()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00114">old_</a>, <a class="el" href="Op__Conv__VEF__base_8cpp_source.html#l00053">Op_Conv_VEF_base::phi_u_transportant()</a>, <a class="el" href="Zone__VF_8h_source.html#l00285">Zone_VF::porosite_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00271">reinit_conv_pour_Cl()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01004">test()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00113">test_</a>, <a class="el" href="Op__Conv__EF_8cpp.html#aec139ab06c54f3c620f1e9944627c994">transporte_</a>, <a class="el" href="Ref__Champ__Inc__base_8h_source.html#l00028">Ref_Champ_Inc_base::valeur()</a>, <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>, <a class="el" href="Champ__Inc__base_8cpp_source.html#l00221">Champ_Inc_base::valeurs()</a>, and <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00094">Op_Conv_VEF_base::vitesse_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> sauv(resu);
  resu=0;

  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; la_vitesse=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>( <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>, <a class="code" href="classOp__Conv__VEF__base.html#a5547875832fb45e09b1115372fb76ffd">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>());
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse_2=la_vitesse.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_face = zone_VEF.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>();

  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();

  <span class="keyword">const</span> <span class="keywordtype">int</span> marq=<a class="code" href="classOp__Conv__VEF__base.html#ad380b9b9ca1d70282b289838a604a4b0" title="definit si l&#39;on convecte psi avec phi*u ou avec u">phi_u_transportant</a>(<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>());
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
  assert(nb_faces_elem==(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+1));
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keywordtype">int</span> nb_comp=resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> <a class="code" href="Op__Conv__EF_8cpp.html#aec139ab06c54f3c620f1e9944627c994">transporte_</a>;
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vitesse_face_;
<span class="comment">// soit on a transporte=phi*transporte_ et vitesse=vitesse_</span>
<span class="comment">// soit transporte=transporte_ et vitesse=phi*vitesse_</span>
<span class="comment">// cela depend si on transporte avec phi u ou avec u.</span>
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_vitesse=<a class="code" href="Porosites__champ_8cpp.html#a2340e7d73d0f9d34926d012fe1b1d884" title="renvoit le tableau res, res=org si flag=0, res= porosite*org sinon attention ne pas modifier res car ...">modif_par_porosite_si_flag</a>(vitesse_2,vitesse_face_,marq,porosite_face);

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Kij(nb_elem_tot,nb_faces_elem,nb_faces_elem);

<span class="comment">// Pour tenir compte des conditions de Neumann sortie libre</span>
  <a class="code" href="classIntList.html" title="Classe qui sert a representer une liste de reels int precision. On ne peut pas utiliser la classe con...">IntList</a> NeumannFaces;
  <a class="code" href="classDoubleTabs.html" title="DoubleTabs est equivalent a VECT(DoubleTab)">DoubleTabs</a> ValeursNeumannFaces;

<span class="comment">// soit on a transporte=phi*transporte_ et vitesse=vitesse_</span>
<span class="comment">// soit transporte=transporte_ et vitesse=phi*vitesse_</span>
<span class="comment">// cela depend si on transporte avec phi u ou avec u.</span>
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte=<a class="code" href="Porosites__champ_8cpp.html#a2340e7d73d0f9d34926d012fe1b1d884" title="renvoit le tableau res, res=org si flag=0, res= porosite*org sinon attention ne pas modifier res car ...">modif_par_porosite_si_flag</a>(transporte_2,transporte_,!marq,porosite_face);

<span class="comment">// Initialisation du tableau flux_bords_ pour le calcul des pertes de charge</span>
  <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(zone_VEF.<a class="code" href="classZone__VF.html#a8815e2276637c0db23868f043dc43e58" title="renvoie le nombre de faces sur lesquelles sont appliquees les conditions limites : bords...">nb_faces_bord</a>(),nb_comp);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a2a5d2defd737046ab7ee6397e476ec8b">calculer_flux_bords</a>(Kij,tab_vitesse,transporte);

  <span class="keywordflow">if</span> (!<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#add33e5ac4396a277bfeca3638cf7a585">old_</a>)
    {
<span class="comment">// statistiques().begin_count(m1);</span>
      <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a3c1c70e249ebd12239c7987a4e50d277">calculer_coefficients_operateur_centre</a>(Kij,nb_comp,tab_vitesse);
<span class="comment">// statistiques().end_count(m1);</span>
<span class="comment">// statistiques().begin_count(m2);</span>
      <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a5ed7b641e615d0a8fea46aaf3eaaad3b">is_compressible_</a>) <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a81ab1069edcf31b0e416a557d9443f7f">ajouter_partie_compressible</a>(transporte,resu,tab_vitesse);

      <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a1cc3e4915dcd0e22759b0f290f9ffbf5">ajouter_operateur_centre</a>(Kij,transporte,resu);

      <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a2afbe2fa6f98fe9539705ef2d0d392f7">ajouter_diffusion</a>(Kij,transporte,resu);
<span class="comment">// statistiques().end_count(m2);</span>
<span class="comment">// statistiques().begin_count(m3);</span>
      <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#afaf4f194109f5b37d07e7010278aafdc">ajouter_antidiffusion</a>(Kij,transporte,resu);
<span class="comment">// statistiques().end_count(m3);</span>
      <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ab106a70062c1831cca041196080bdeaf">mettre_a_jour_pour_periodicite</a>(resu);

    }
  <span class="keywordflow">else</span>
    {
      assert(<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#add33e5ac4396a277bfeca3638cf7a585">old_</a>==1);
      <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a14bece1772d9e8a5ffa4105ea14ca06a">ajouter_old</a>(transporte,resu,tab_vitesse);
    }

  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a23d5e4497b9f329921e370a3208ff9fc">reinit_conv_pour_Cl</a>(transporte,NeumannFaces,ValeursNeumannFaces,tab_vitesse,resu);

  resu+=sauv;

  <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af913e1b9445b37211f13e9bf5c01d92e">test_</a>) <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a17c05c25fb60782de56829f75478f094">test</a>(transporte,resu,tab_vitesse);
  <a class="code" href="classOp__VEF__Face.html#a6c8ce571769b4f2e20b07cbb7a6944f2">modifier_flux</a>(*<span class="keyword">this</span>);

  <span class="keywordflow">return</span> resu;
}
</pre></div>
</div>
</div>
<a class="anchor" id="afaf4f194109f5b37d07e7010278aafdc"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::ajouter_antidiffusion" ref="afaf4f194109f5b37d07e7010278aafdc" args="(const DoubleTab &amp;, const DoubleTab &amp;, DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Op_Conv_EF_VEF_P1NC_Stab::ajouter_antidiffusion </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00845">845</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00106">alpha_tab</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00107">beta</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00941">calculer_senseur()</a>, <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00190">Dij()</a>, <a class="el" href="Double_8h_source.html#l00075">DMINFLOAT</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="Zone__VF_8h_source.html#l00176">Zone_VF::get_num_fac_loc()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00200">limiteur()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="IntVect_8h_source.html#l00150">IntVect::line_size()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00181">minimum()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, and <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01169">test_difference_resu()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">test_implicite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF=<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();

  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins=zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot=zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntVect.html#a5ba680066169c8e057bb3e3b876e4a8c">line_size</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
  <span class="keywordtype">int</span> elem=0, facei=0,facei_loc=0, facej=0,facej_loc=0, ligne=0,colonne=0, dim=0, face_amont=0,face_aval=0;
  <span class="keywordtype">double</span> kij=0.,kji=0.,dij=0.,lij=0.,lji=0., limit=0.,daij=0., delta=0.;
  <span class="keywordtype">double</span> coeffij=0.,coeffji=0., <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>=0., R=0.;

<span class="comment">// Pour le limiteur</span>
  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> P_plus(nb_comp),P_moins(nb_comp);
  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> Q_plus(nb_comp),Q_moins(nb_comp);
  P_plus=0., P_moins=0.;
  Q_plus=0., Q_moins=0.;

  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; transporteV=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,transporte);
  <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resuV=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,resu);
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; num_fac_loc = zone_VEF.<a class="code" href="classZone__VF.html#a95113b10f16f37600ba81d3fb41102b2">get_num_fac_loc</a>();
  <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
    <span class="keywordflow">for</span> (facei_loc=0; facei_loc&lt;nb_faces_elem; facei_loc++)
      {
        facei=elem_faces(elem,facei_loc);

        P_plus=0., P_moins=0.;
        Q_plus=0., Q_moins=0.;
        <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a49f11cc19b99f1b9ade819f868877381">calculer_senseur</a>(Kij,transporteV,nb_comp,facei,elem_faces,face_voisins,num_fac_loc,P_plus,P_moins,Q_plus,Q_moins);

        <span class="keywordflow">for</span> (facej_loc=0; facej_loc&lt;nb_faces_elem; facej_loc++)
          <span class="keywordflow">if</span> (facej_loc!=facei_loc)
            {
              facej=elem_faces(elem,facej_loc);

              kij = Kij(elem,facei_loc,facej_loc);
              kji = Kij(elem,facej_loc,facei_loc);
              dij = <a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ae5963d1de142bf425808b7401692bd90">Dij</a>(elem,facei_loc,facej_loc,Kij);
              lij = kij+dij;
              lji = kji+dij;
              assert(lij&gt;=0);
              assert(lji&gt;=0);

              <span class="keywordflow">if</span> (lij&lt;=lji) <span class="comment">//facei est amont</span>
                {
                  face_amont = facei;
                  face_aval = facej;

<span class="comment">// Si lij==lji, on passe deux foix dans la boucle</span>
<span class="comment">// d&#39;ou la presence du coefficient 1/2</span>
                  <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = 1.*(lij&lt;lji)+0.5*(lij==lji);
                  assert(<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>==1. || <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>==0.5);

                  <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
                    {
                      ligne=face_aval*nb_comp+dim;
                      colonne=face_amont*nb_comp+dim;

                      delta = transporteV[colonne]-transporteV[ligne];

<span class="comment">// Limiteur de pente</span>
<span class="comment">// if (delta&gt;=0.) R = (P_plus(dim)==0.) ? 0. : Q_plus(dim)/P_plus(dim);</span>
<span class="comment">// else R = (P_moins(dim)==0.) ? 0. : Q_moins(dim)/P_moins(dim);</span>

<span class="comment">// if (delta&gt;=0.) R = (P_plus(dim)==0.) ? 0. : Q_plus(dim)/(P_plus(dim)+DMINFLOAT);</span>
<span class="comment">// else R = (P_moins(dim)==0.) ? 0. : Q_moins(dim)/(P_moins(dim)+DMINFLOAT);</span>

                      <span class="keywordflow">if</span> (delta&gt;=0.) R = (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(P_plus(dim))&lt;<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>) ? 0. : Q_plus(dim)/P_plus(dim);
                      <span class="keywordflow">else</span> R = (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(P_moins(dim))&lt;<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>) ? 0. : Q_moins(dim)/P_moins(dim);


                      limit=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a36b674f178bc8694c4bc14686f6f17bb">limiteur</a>(R);
<span class="comment">// limiteurs_(facei,dim)+=limit;</span>
<span class="comment">// limiteurs_(facej,dim)+=limit;</span>

                      daij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ade923cb828015cfde5aff245ecd65936">minimum</a>(limit*dij,lji);
                      assert(daij&gt;=0);
                      assert(daij&lt;=lji);

                      coeffij=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(face_amont)*<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac1b44ec3559d53eaf94d49b3e029ae4b" title="vaut zero pour les faces ou l&#39;on souhaite degenerer en Amont. mutable DoubleTab limiteurs_;//tableau ...">beta</a>(face_amont)*daij;
                      coeffji=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(face_aval)*<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac1b44ec3559d53eaf94d49b3e029ae4b" title="vaut zero pour les faces ou l&#39;on souhaite degenerer en Amont. mutable DoubleTab limiteurs_;//tableau ...">beta</a>(face_aval)*daij;

<span class="comment">// Calcul de resu</span>
                      resuV[colonne]+=coeffij*<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>*delta;
                      resuV[ligne]-=coeffji*<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>*delta;
                    }
                }
            }
      }

  <span class="keywordflow">return</span> resu;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a25b8ce54605b7783a8d7078a932e4187"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::ajouter_contribution" ref="a25b8ce54605b7783a8d7078a932e4187" args="(const DoubleTab &amp;, Matrice_Morse &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::ajouter_contribution </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>matrice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#ad46bfa5e97653f57e64fb7f890d15e1b">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02191">2191</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02350">ajouter_contribution_diffusion()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02236">ajouter_contribution_operateur_centre()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02474">ajouter_contribution_partie_compressible()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00313">calculer_coefficients_operateur_centre()</a>, <a class="el" href="MorEqn_8h_source.html#l00082">MorEqn::equation()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00112">is_compressible_</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Porosites__champ_8cpp_source.html#l00035">modif_par_porosite_si_flag()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Zone_8h_source.html#l00469">Zone::nb_faces_elem()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00118">new_jacobienne_</a>, <a class="el" href="Op__Conv__VEF__base_8cpp_source.html#l00053">Op_Conv_VEF_base::phi_u_transportant()</a>, <a class="el" href="Zone__VF_8h_source.html#l00285">Zone_VF::porosite_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00113">test_</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">test_implicite()</a>, <a class="el" href="Op__Conv__EF_8cpp.html#aec139ab06c54f3c620f1e9944627c994">transporte_</a>, <a class="el" href="Ref__Champ__Inc__base_8h_source.html#l00028">Ref_Champ_Inc_base::valeur()</a>, <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>, <a class="el" href="Champ__Inc__base_8cpp_source.html#l00221">Champ_Inc_base::valeurs()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00094">Op_Conv_VEF_base::vitesse_</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00129">contribuer_a_avec()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a8b4181342631eedf901e574b5e9e4474">new_jacobienne_</a>==0)
    {
      <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a25b8ce54605b7783a8d7078a932e4187">Op_Conv_VEF_Face::ajouter_contribution</a>(transporte_2, matrice) ;
      <span class="keywordflow">return</span>;
    }
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();

  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=transporte_2.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Kij(nb_elem_tot,nb_faces_elem,nb_faces_elem);
  Kij=0.;

<span class="comment">// </span>
<span class="comment">// Pour tenir compte de la porosite</span>
<span class="comment">// </span>
  <span class="keyword">const</span> <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>&amp; la_vitesse=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>( <a class="code" href="classChamp__P1NC.html">Champ_P1NC</a>, <a class="code" href="classOp__Conv__VEF__base.html#a5547875832fb45e09b1115372fb76ffd">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>());
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; vitesse_2=la_vitesse.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_face = zone_VEF.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>();
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> <a class="code" href="Op__Conv__EF_8cpp.html#aec139ab06c54f3c620f1e9944627c994">transporte_</a>;
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> vitesse_face_;

<span class="comment">// soit on a transporte=phi*transporte_ et vitesse=vitesse_</span>
<span class="comment">// soit transporte=transporte_ et vitesse=phi*vitesse_</span>
<span class="comment">// cela depend si on transporte avec phi u ou avec u.</span>
  <span class="keyword">const</span> <span class="keywordtype">int</span> marq=<a class="code" href="classOp__Conv__VEF__base.html#ad380b9b9ca1d70282b289838a604a4b0" title="definit si l&#39;on convecte psi avec phi*u ou avec u">phi_u_transportant</a>(<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>());
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; transporte=<a class="code" href="Porosites__champ_8cpp.html#a2340e7d73d0f9d34926d012fe1b1d884" title="renvoit le tableau res, res=org si flag=0, res= porosite*org sinon attention ne pas modifier res car ...">modif_par_porosite_si_flag</a>(transporte_2,transporte_,!marq,porosite_face);
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_vitesse=<a class="code" href="Porosites__champ_8cpp.html#a2340e7d73d0f9d34926d012fe1b1d884" title="renvoit le tableau res, res=org si flag=0, res= porosite*org sinon attention ne pas modifier res car ...">modif_par_porosite_si_flag</a>(vitesse_2,vitesse_face_,marq,porosite_face);

  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a3c1c70e249ebd12239c7987a4e50d277">calculer_coefficients_operateur_centre</a>(Kij,nb_comp,tab_vitesse);
  <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a5ed7b641e615d0a8fea46aaf3eaaad3b">is_compressible_</a>) <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a12349ea012bfb6446b63f9133eb3da11">ajouter_contribution_partie_compressible</a>(transporte,tab_vitesse,matrice);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ad7f5145ac5fa237d31363a2ef4037afa">ajouter_contribution_operateur_centre</a>(Kij,transporte,matrice);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#afe634e48a923aa8f514e3addb1061b9e">ajouter_contribution_diffusion</a>(Kij,transporte,matrice);

  <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af913e1b9445b37211f13e9bf5c01d92e">test_</a>) <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a2235e9d9ed398ec7c4b0fb6d91269e11">test_implicite</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a205252afcc4f18ae771ce126e561ff57"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::ajouter_contribution_antidiffusion" ref="a205252afcc4f18ae771ce126e561ff57" args="(const DoubleTab &amp;, const DoubleTab &amp;, Matrice_Morse &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::ajouter_contribution_antidiffusion </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>matrice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02610">2610</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00106">alpha_tab</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00107">beta</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00941">calculer_senseur()</a>, <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00190">Dij()</a>, <a class="el" href="Double_8h_source.html#l00075">DMINFLOAT</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Periodique_8h_source.html#l00056">Periodique::face_associee()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Zone__VF_8h_source.html#l00176">Zone_VF::get_num_fac_loc()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00200">limiteur()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="IntVect_8h_source.html#l00150">IntVect::line_size()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00181">minimum()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00061">Front_VF::nb_faces()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>, and <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">test_implicite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF=<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot=zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntVect.html#a5ba680066169c8e057bb3e3b876e4a8c">line_size</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_bord=zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

  <span class="keywordtype">int</span> elem=0, elem_loc=0, facei=0,facei_loc=0, faceiAss=0, ind_face=0,ind_faceiAss=0;
  <span class="keywordtype">int</span> facej=0,facej_loc=0, ligne=0,colonne=0, dim=0, face_amont=0,face_aval=0;
  <span class="keywordtype">int</span> faceToComplete=0, num1=0,num2=0, n_bord=0;
  <span class="keywordtype">double</span> kij=0.,kji=0.,dij=0., lij=0.,lji=0., daij=0.;
  <span class="keywordtype">double</span> delta=0., coeffij=0.,coeffji=0., <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>=0., R=0.;

<span class="comment">// Pour le limiteur</span>
  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> P_plus(nb_comp),P_moins(nb_comp);
  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> Q_plus(nb_comp),Q_moins(nb_comp);
  P_plus=0., P_moins=0., Q_plus=0., Q_moins=0.;

  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; transporteV=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,transporte);
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; num_fac_loc = zone_VEF.<a class="code" href="classZone__VF.html#a95113b10f16f37600ba81d3fb41102b2">get_num_fac_loc</a>();
  <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
    <span class="keywordflow">for</span> (facei_loc=0; facei_loc&lt;nb_faces_elem; facei_loc++)
      {
        facei=elem_faces(elem,facei_loc);
        P_plus=0., P_moins=0., Q_plus=0., Q_moins=0.;
        <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a49f11cc19b99f1b9ade819f868877381">calculer_senseur</a>(Kij,transporteV,nb_comp,facei,elem_faces,face_voisins,num_fac_loc,P_plus,P_moins,Q_plus,Q_moins);
        <span class="keywordflow">for</span> (facej_loc=0; facej_loc&lt;nb_faces_elem; facej_loc++)
          <span class="keywordflow">if</span> (facej_loc!=facei_loc)
            {
              facej=elem_faces(elem,facej_loc);

              kij = Kij(elem,facei_loc,facej_loc);
              kji = Kij(elem,facej_loc,facei_loc);
              dij = <a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ae5963d1de142bf425808b7401692bd90">Dij</a>(elem,facei_loc,facej_loc,Kij);
              lij = kij+dij;
              lji = kji+dij;
              assert(lij&gt;=0);
              assert(lji&gt;=0);

              <span class="keywordflow">if</span> (lij&lt;=lji) <span class="comment">//facei est amont</span>
                {
                  face_amont = facei;
                  face_aval = facej;

<span class="comment">// Si lij==lji, on passe deux foix dans la boucle</span>
<span class="comment">// d&#39;ou la presence du coefficient 1/2</span>
                  <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = 1.*(lij&lt;lji)+0.5*(lij==lji);
                  assert(<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>==1. || <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>==0.5);

                  <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
                    {
                      ligne=face_amont*nb_comp+dim;
                      colonne=face_aval*nb_comp+dim;

                      delta=transporteV[ligne]-transporteV[colonne];

<span class="comment">// Limiteur de pente</span>
<span class="comment">// if (delta&gt;=0.) R=(P_plus(dim)==0.) ? 0. : Q_plus(dim)/P_plus(dim);</span>
<span class="comment">// else  R=(P_moins(dim)==0.) ? 0. : Q_moins(dim)/P_moins(dim);</span>

<span class="comment">// if (delta&gt;=0.) R=(P_plus(dim)==0.) ? 0. : Q_plus(dim)/(P_plus(dim)+DMINFLOAT);</span>
<span class="comment">// else  R=(P_moins(dim)==0.) ? 0. : Q_moins(dim)/(P_moins(dim)+DMINFLOAT);</span>

                      <span class="keywordflow">if</span> (delta&gt;=0.) R=(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(P_plus(dim))&lt;<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>) ? 0. : Q_plus(dim)/P_plus(dim);
                      <span class="keywordflow">else</span>  R=(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(P_moins(dim))&lt;<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>) ? 0. : Q_moins(dim)/P_moins(dim);


                      daij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ade923cb828015cfde5aff245ecd65936">minimum</a>(<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a36b674f178bc8694c4bc14686f6f17bb">limiteur</a>(R)*dij,lji);
                      assert(daij&gt;=0);
                      assert(daij&lt;=lji);
                      coeffij=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(face_amont)*<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac1b44ec3559d53eaf94d49b3e029ae4b" title="vaut zero pour les faces ou l&#39;on souhaite degenerer en Amont. mutable DoubleTab limiteurs_;//tableau ...">beta</a>(face_amont)*daij;
                      coeffji=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(face_aval)*<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac1b44ec3559d53eaf94d49b3e029ae4b" title="vaut zero pour les faces ou l&#39;on souhaite degenerer en Amont. mutable DoubleTab limiteurs_;//tableau ...">beta</a>(face_aval)*daij;

<span class="comment">// Calcul de la matrice</span>
                      matrice(ligne,ligne)-=coeffij*<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                      matrice(ligne,colonne)+=coeffij*<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                      matrice(colonne,colonne)-=coeffji*<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                      matrice(colonne,ligne)+=coeffji*<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                    }
                }
            }
      }

<span class="comment">// </span>
<span class="comment">// Pour la periodicite</span>
<span class="comment">// </span>
  <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;nb_bord; n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      num1 = 0;
      num2=le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();<span class="comment">//pour ne parcourir que les faces reelles</span>

      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());

<span class="comment">// Pour le limiteur</span>
          <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> Pj_plus(nb_comp),Pj_moins(nb_comp);
          <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> Qj_plus(nb_comp),Qj_moins(nb_comp);
          Pj_plus=0., Pj_moins=0.;
          Qj_plus=0., Qj_moins=0.;

          <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
            {
              facei=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              ind_faceiAss=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(ind_face);
              faceiAss=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_faceiAss);

<span class="comment">// Pour ne parcourir qu&#39;une seule fois les faces perio</span>
              <span class="keywordflow">if</span> (facei&lt;faceiAss)
                <span class="keywordflow">for</span> (elem_loc=0; elem_loc&lt;2; elem_loc++)
                  {
                    elem=face_voisins(facei,elem_loc);
                    assert(elem!=-1);

<span class="comment">// Calcul du numero local de la face dans &quot;elem&quot;</span>
                    facei_loc=num_fac_loc(facei,elem_loc);
                    <span class="keywordflow">if</span> (facei_loc!=-1)
                      faceToComplete=faceiAss;
                    <span class="keywordflow">else</span>
                      {
                        faceToComplete=facei;
                        facei_loc=num_fac_loc(faceiAss,elem_loc);
                        assert(facei_loc!=-1);
                      }

<span class="comment">// Calcul du coefficient a rajouter dans la matrice</span>
                    P_plus=0., P_moins=0.;
                    Q_plus=0., Q_moins=0.;
                    <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a49f11cc19b99f1b9ade819f868877381">calculer_senseur</a>(Kij,transporteV,nb_comp,faceToComplete,elem_faces,face_voisins,num_fac_loc,P_plus,P_moins,Q_plus,Q_moins);

                    <span class="keywordflow">for</span> (facej_loc=0; facej_loc&lt;nb_faces_elem; facej_loc++)
                      <span class="keywordflow">if</span> (facej_loc!=facei_loc)
                        {
                          facej=elem_faces(elem,facej_loc);

                          kij = Kij(elem,facei_loc,facej_loc);
                          kji = Kij(elem,facej_loc,facei_loc);
                          dij = <a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ae5963d1de142bf425808b7401692bd90">Dij</a>(elem,facei_loc,facej_loc,Kij);
                          lij = kij+dij;
                          lji = kji+dij;
                          assert(lij&gt;=0);
                          assert(lji&gt;=0);

                          <span class="keywordflow">if</span> (lij&lt;=lji) <span class="comment">//faceToComplete est amont</span>
                            {
                              face_amont=faceToComplete;
                              face_aval=facej;

<span class="comment">// Si lij==lji, on passe deux foix dans la boucle</span>
<span class="comment">// d&#39;ou la presence du coefficient 1/2</span>
                              <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = 1.*(lij&lt;lji)+0.5*(lij==lji);
                              assert(<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>==1. || <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>==0.5);

                              <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
                                {
                                  ligne=face_amont*nb_comp+dim;
                                  colonne=face_aval*nb_comp+dim;
                                  delta=transporteV[ligne]-transporteV[colonne];

<span class="comment">// Limiteur de pente</span>
<span class="comment">// if (delta&gt;=0.) R=(P_plus(dim)==0.) ? 0. : Q_plus(dim)/P_plus(dim);</span>
<span class="comment">// else  R=(P_moins(dim)==0.) ? 0. : Q_moins(dim)/P_moins(dim);</span>

<span class="comment">// if (delta&gt;=0.) R=(P_plus(dim)==0.) ? 0. : Q_plus(dim)/(P_plus(dim)+DMINFLOAT);</span>
<span class="comment">// else  R=(P_moins(dim)==0.) ? 0. : Q_moins(dim)/(P_moins(dim)+DMINFLOAT);</span>

                                  <span class="keywordflow">if</span> (delta&gt;=0.) R=(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(P_plus(dim))&lt;<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>) ? 0. : Q_plus(dim)/P_plus(dim);
                                  <span class="keywordflow">else</span>  R=(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(P_moins(dim))&lt;<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>) ? 0. : Q_moins(dim)/P_moins(dim);

                                  daij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ade923cb828015cfde5aff245ecd65936">minimum</a>(<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a36b674f178bc8694c4bc14686f6f17bb">limiteur</a>(R)*dij,lji);
                                  assert(daij&gt;=0);
                                  assert(daij&lt;=lji);
                                  coeffij=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(face_amont)*<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac1b44ec3559d53eaf94d49b3e029ae4b" title="vaut zero pour les faces ou l&#39;on souhaite degenerer en Amont. mutable DoubleTab limiteurs_;//tableau ...">beta</a>(face_amont)*daij;

<span class="comment">// Calcul de la matrice</span>
                                  matrice(ligne,ligne)-=coeffij*<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                                  matrice(ligne,colonne)+=coeffij*<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                                }
                            }
                          <span class="keywordflow">else</span>  <span class="comment">//faceToComplete est aval</span>
                            {
                              face_aval=faceToComplete;
                              face_amont=facej;
                              <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>=1.;
                              Pj_plus=0., Pj_moins=0., Qj_plus=0., Qj_moins=0.;
                              <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a49f11cc19b99f1b9ade819f868877381">calculer_senseur</a>(Kij,transporteV,nb_comp,facej,elem_faces,face_voisins,num_fac_loc,Pj_plus,Pj_moins,Qj_plus,Qj_moins);

                              <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
                                {
                                  ligne=face_amont*nb_comp+dim;
                                  colonne=face_aval*nb_comp+dim;

                                  delta=transporteV[ligne]-transporteV[colonne];

<span class="comment">// Limiteur de pente</span>
<span class="comment">// if (delta&gt;=0.) R=(Pj_plus(dim)==0.) ? 0. : Qj_plus(dim)/Pj_plus(dim);</span>
<span class="comment">// else  R=(Pj_moins(dim)==0.) ? 0. : Qj_moins(dim)/Pj_moins(dim);</span>

<span class="comment">// if (delta&gt;=0.) R=(Pj_plus(dim)==0.) ? 0. : Qj_plus(dim)/(Pj_plus(dim)+DMINFLOAT);</span>
<span class="comment">// else  R=(Pj_moins(dim)==0.) ? 0. : Qj_moins(dim)/(Pj_moins(dim)+DMINFLOAT);</span>

                                  <span class="keywordflow">if</span> (delta&gt;=0.) R=(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(Pj_plus(dim))&lt;<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>) ? 0. : Qj_plus(dim)/Pj_plus(dim);
                                  <span class="keywordflow">else</span>  R=(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(Pj_moins(dim))&lt;<a class="code" href="Double_8h.html#a0a3fffa6d17ad8f7de4bb337c6266561">DMINFLOAT</a>) ? 0. : Qj_moins(dim)/Pj_moins(dim);

                                  daij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ade923cb828015cfde5aff245ecd65936">minimum</a>(<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a36b674f178bc8694c4bc14686f6f17bb">limiteur</a>(R)*dij,lij);
                                  assert(daij&gt;=0);
                                  assert(daij&lt;=lij);
                                  coeffij=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(face_aval)*<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac1b44ec3559d53eaf94d49b3e029ae4b" title="vaut zero pour les faces ou l&#39;on souhaite degenerer en Amont. mutable DoubleTab limiteurs_;//tableau ...">beta</a>(face_aval)*daij;

<span class="comment">// Calcul de la matrice</span>
                                  matrice(colonne,colonne)-=coeffij*<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                                  matrice(colonne,ligne)+=coeffij*<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                                }
                            }
                        }
                  }
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="afe634e48a923aa8f514e3addb1061b9e"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::ajouter_contribution_diffusion" ref="afe634e48a923aa8f514e3addb1061b9e" args="(const DoubleTab &amp;, const DoubleTab &amp;, Matrice_Morse &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::ajouter_contribution_diffusion </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>matrice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02350">2350</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00106">alpha_tab</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00190">Dij()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Periodique_8h_source.html#l00056">Periodique::face_associee()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Zone__VF_8h_source.html#l00176">Zone_VF::get_num_fac_loc()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="IntVect_8h_source.html#l00150">IntVect::line_size()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00066">Front_VF::nb_faces_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>, and <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02191">ajouter_contribution()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">test_implicite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF=<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot=zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntVect.html#a5ba680066169c8e057bb3e3b876e4a8c">line_size</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_bord=zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

  <span class="keywordtype">int</span> elem=0, facei=0,facei_loc=0, facej=0,facej_loc=0;
  <span class="keywordtype">int</span> ligne=0,colonne=0, dim=0, ind_face=0, num1=0,num2=0;
  <span class="keywordtype">int</span> faceToComplete=0, elem_loc=0;
  <span class="keywordtype">double</span> dij=0., coeffij=0.,coeffji=0.;

  <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
    <span class="keywordflow">for</span> (facei_loc=0; facei_loc&lt;nb_faces_elem; facei_loc++)
      {
        facei=elem_faces(elem,facei_loc);

        <span class="keywordflow">for</span> (facej_loc=facei_loc+1; facej_loc&lt;nb_faces_elem; facej_loc++)
          {
            facej=elem_faces(elem,facej_loc);
            assert(facej!=facei);

            dij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ae5963d1de142bf425808b7401692bd90">Dij</a>(elem,facei_loc,facej_loc,Kij);
            assert(dij&gt;=0);

            coeffij=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(facei)*dij;
            coeffji=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(facej)*dij;

            <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
              {
                ligne=facei*nb_comp+dim;
                colonne=facej*nb_comp+dim;

<span class="comment">// ATTENTION AU SIGNE : ici on code +div(uT)</span>
<span class="comment">// REMARQUE : on utilise la symetrie de l&#39;operateur</span>
                matrice(ligne,ligne)+=coeffij;
                matrice(ligne,colonne)-=coeffij;
                matrice(colonne,colonne)+=coeffji;
                matrice(colonne,ligne)-=coeffji;
              }
          }
      }

<span class="comment">// </span>
<span class="comment">// Pour la periodicite</span>
<span class="comment">// </span>
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; num_fac_loc = zone_VEF.<a class="code" href="classZone__VF.html#a95113b10f16f37600ba81d3fb41102b2">get_num_fac_loc</a>();
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      num1 = 0;
      num2=le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();<span class="comment">//et surtout pas nb_faces() sinon on oublie certains coefficiens</span>

      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
          <span class="keywordtype">int</span> faceiAss=0,ind_faceiAss=0;

          <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
            {
              facei=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              ind_faceiAss=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(ind_face);
              faceiAss=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_faceiAss);

<span class="comment">// Pour ne parcourir qu&#39;une seule fois les faces perio</span>
              <span class="keywordflow">if</span> (facei&lt;faceiAss)
                <span class="keywordflow">for</span> (elem_loc=0; elem_loc&lt;2; elem_loc++)
                  {
                    elem=face_voisins(facei,elem_loc);
                    assert(elem!=-1);

<span class="comment">// Calcul du numero local de la face dans &quot;elem&quot;</span>
                    facei_loc=num_fac_loc(facei,elem_loc);
                    <span class="keywordflow">if</span> (facei_loc!=-1)
                      faceToComplete=faceiAss;
                    <span class="keywordflow">else</span>
                      {
                        faceToComplete=facei;
                        facei_loc=num_fac_loc(faceiAss,elem_loc);
                        assert(facei_loc!=-1);
                      }

<span class="comment">// Calcul des coefficients de la matrice dus a &quot;elem&quot;</span>
                    <span class="keywordflow">for</span> (facej_loc=0; facej_loc&lt;nb_faces_elem; facej_loc++)
                      {
                        facej=elem_faces(elem,facej_loc);

                        <span class="keywordflow">if</span> (facej_loc!=facei_loc)
                          {
                            dij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ae5963d1de142bf425808b7401692bd90">Dij</a>(elem,facei_loc,facej_loc,Kij);
                            assert(dij&gt;=0);

                            coeffij=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(faceToComplete)*dij;
                            coeffji=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(facej)*dij;

                            <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
                              {
                                ligne=faceToComplete*nb_comp+dim;
                                colonne=facej*nb_comp+dim;

<span class="comment">// ATTENTION AU SIGNE : ici on code +div(uT)</span>
                                matrice(ligne,ligne)+=coeffij;
                                matrice(ligne,colonne)-=coeffij;
                              }
                          }
                      }
                  }
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad7f5145ac5fa237d31363a2ef4037afa"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::ajouter_contribution_operateur_centre" ref="ad7f5145ac5fa237d31363a2ef4037afa" args="(const DoubleTab &amp;, const DoubleTab &amp;, Matrice_Morse &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::ajouter_contribution_operateur_centre </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>matrice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02236">2236</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Periodique_8h_source.html#l00056">Periodique::face_associee()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Zone__VF_8h_source.html#l00176">Zone_VF::get_num_fac_loc()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00066">Front_VF::nb_faces_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>, and <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02191">ajouter_contribution()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">test_implicite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF=<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();

  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();

  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot=zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_bord=zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();

  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

  <span class="keywordtype">int</span> elem=0, facei=0,facei_loc=0, facej=0,facej_loc=0;
  <span class="keywordtype">int</span> ligne=0,colonne=0, dim=0, ind_face=0, num1=0,num2=0;
  <span class="keywordtype">int</span> faceToComplete=0, elem_loc=0;
  <span class="keywordtype">double</span> kij=0.,kji=0.;

  <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
    <span class="keywordflow">for</span> (facei_loc=0; facei_loc&lt;nb_faces_elem; facei_loc++)
      {
        facei=elem_faces(elem,facei_loc);

        <span class="keywordflow">for</span> (facej_loc=facei_loc+1; facej_loc&lt;nb_faces_elem; facej_loc++)
          {
            facej=elem_faces(elem,facej_loc);
            assert(facej!=facei);

            kij=Kij(elem,facei_loc,facej_loc);
            kji=Kij(elem,facej_loc,facei_loc);

            <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
              {
                ligne=facei*nb_comp+dim;
                colonne=facej*nb_comp+dim;

<span class="comment">// ATTENTION AU SIGNE : ici on code +div(uT)</span>
                matrice(ligne,ligne)+=kij;
                matrice(ligne,colonne)-=kij;
                matrice(colonne,colonne)+=kji;
                matrice(colonne,ligne)-=kji;
              }
          }
      }

<span class="comment">// </span>
<span class="comment">// Pour la periodicite</span>
<span class="comment">// </span>
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; num_fac_loc = zone_VEF.<a class="code" href="classZone__VF.html#a95113b10f16f37600ba81d3fb41102b2">get_num_fac_loc</a>();
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      num1 = 0;
      num2=le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();<span class="comment">//et surtout pas nb_faces sinon on oublie certains coefficients</span>

      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
          <span class="keywordtype">int</span> faceiAss=0,ind_faceiAss=0;

          <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
            {
              ind_faceiAss=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(ind_face);

              facei=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              faceiAss=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_faceiAss);

<span class="comment">// Pour ne parcourir qu&#39;une seule fois les faces perio</span>
              <span class="keywordflow">if</span> (facei&lt;faceiAss)
                <span class="keywordflow">for</span> (elem_loc=0; elem_loc&lt;2; elem_loc++)
                  {
                    elem=face_voisins(facei,elem_loc);
                    assert(elem!=-1);

<span class="comment">// Calcul du numero local de la face dans &quot;elem&quot;</span>
                    facei_loc=num_fac_loc(facei,elem_loc);
                    <span class="keywordflow">if</span> (facei_loc!=-1)
                      faceToComplete=faceiAss;
                    <span class="keywordflow">else</span>
                      {
                        faceToComplete=facei;
                        facei_loc=num_fac_loc(faceiAss,elem_loc);
                        assert(facei_loc!=-1);
                      }

<span class="comment">// Calcul des coefficients de la matrice dus a &quot;elem&quot;</span>
                    <span class="keywordflow">for</span> (facej_loc=0; facej_loc&lt;nb_faces_elem; facej_loc++)
                      {
                        facej=elem_faces(elem,facej_loc);

                        <span class="keywordflow">if</span> (facej_loc!=facei_loc)
                          {
                            kij=Kij(elem,facei_loc,facej_loc);
                            kji=Kij(elem,facej_loc,facei_loc);

                            <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
                              {
                                ligne=faceToComplete*nb_comp+dim;
                                colonne=facej*nb_comp+dim;

<span class="comment">// ATTENTION AU SIGNE : ici on code +div(uT)</span>
                                matrice(ligne,ligne)+=kij;
                                matrice(ligne,colonne)-=kij;
                              }
                          }
                      }
                  }
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a12349ea012bfb6446b63f9133eb3da11"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::ajouter_contribution_partie_compressible" ref="a12349ea012bfb6446b63f9133eb3da11" args="(const DoubleTab &amp;, const DoubleTab &amp;, Matrice_Morse &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::ajouter_contribution_partie_compressible </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vitesse_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>matrice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02474">2474</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00103">elem_nb_faces_dirichlet_</a>, <a class="el" href="MorEqn_8h_source.html#l00082">MorEqn::equation()</a>, <a class="el" href="Periodique_8h_source.html#l00056">Periodique::face_associee()</a>, <a class="el" href="Zone__VEF_8h_source.html#l00145">Zone_VEF::face_normales()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00216">formule_2D()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00237">formule_3D()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00206">formule_Id_2D()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00211">formule_Id_3D()</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Zone__VF_8h_source.html#l00176">Zone_VF::get_num_fac_loc()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="IntVect_8h_source.html#l00150">IntVect::line_size()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00061">Front_VF::nb_faces()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Op__Conv__VEF__base_8cpp_source.html#l00053">Op_Conv_VEF_base::phi_u_transportant()</a>, <a class="el" href="Zone__VF_8h_source.html#l00315">Zone_VF::porosite_elem()</a>, <a class="el" href="Zone__VF_8h_source.html#l00285">Zone_VF::porosite_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Raffiner__Simplexes_8cpp_source.html#l00183">type_elem()</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Ref__Champ__Inc__base_8h_source.html#l00028">Ref_Champ_Inc_base::valeur()</a>, <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>, <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>, <a class="el" href="Champ__Inc__base_8cpp_source.html#l00221">Champ_Inc_base::valeurs()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00094">Op_Conv_VEF_base::vitesse_</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00115">volumes_etendus_</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02191">ajouter_contribution()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">test_implicite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF=<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales=zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot=zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntVect.html#a5ba680066169c8e057bb3e3b876e4a8c">line_size</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_bord=zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();

<span class="comment">// Pour tenir compte de la porosite</span>
  <span class="keyword">const</span> <span class="keywordtype">int</span> marq = <a class="code" href="classOp__Conv__VEF__base.html#ad380b9b9ca1d70282b289838a604a4b0" title="definit si l&#39;on convecte psi avec phi*u ou avec u">phi_u_transportant</a>(<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>());
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_elem = zone_VEF.<a class="code" href="classZone__VF.html#afd135a1b227731193b1a97b7ed525435">porosite_elem</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_face = zone_VEF.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>();

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> tab_vitesse(<a class="code" href="classOp__Conv__VEF__base.html#a5547875832fb45e09b1115372fb76ffd">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>().<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>());
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;tab_vitesse.dimension(0); i++)
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;tab_vitesse.line_size(); j++)
      tab_vitesse(i,j)*=porosite_face(i);

  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
  <span class="keywordtype">int</span> elem=0,<a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>=0, facei=0,facei_loc=0, faceiAss=0,ind_faceiAss=0;
  <span class="keywordtype">int</span> ligne=0, dim=0, ind_face=0, num1=0,num2=0, faceToComplete=0, elem_loc=0, n_bord=0;
  <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>=0., signe=0., div=0.;

  double (*formule)(int);

  <span class="keywordflow">if</span> (!<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a0fa21a81e6deda452a87699846cc1cd6">volumes_etendus_</a>)
    formule= (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==2) ? &amp;<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a7799aa1823cec7df9243ea24bcf2f493">formule_Id_2D</a> : &amp;<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a89170674bf686e027b6f6babdf658253">formule_Id_3D</a>;
  <span class="keywordflow">else</span>
    formule= (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==2) ? &amp;<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#aa1313236a6927475a5d773405ad84c0e">formule_2D</a> : &amp;<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a1b2dc898af7cd545a374f228d5eee000">formule_3D</a>;

  <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
    {
<span class="comment">// Type de l&#39;element : le nombre de faces de Dirichlet</span>
<span class="comment">// qu&#39;il contient</span>
      <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aed3b960a81290a5110ae7ac8f9006fd8">elem_nb_faces_dirichlet_</a>(elem);
      coeff=formule(<a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>);

<span class="comment">// Calcul de la divergence par element</span>
      div=0.;
      <span class="keywordflow">for</span> (facei_loc=0; facei_loc&lt;nb_faces_elem; facei_loc++)
        {
          facei=elem_faces(elem,facei_loc);
          signe=(face_voisins(facei,0)==elem)? 1.:-1.;

          <span class="keywordflow">for</span> (dim=0; dim&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; dim++)
            div+=signe*face_normales(facei,dim)*tab_vitesse(facei,dim);
        }
      div*=<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
      <span class="keywordflow">if</span> (!marq) div/=porosite_elem(elem);

<span class="comment">// Calcul de la partie compressible</span>
      <span class="keywordflow">for</span> (facei_loc=0; facei_loc&lt;nb_faces_elem; facei_loc++)
        {
          facei=elem_faces(elem,facei_loc);

          <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
            {
              ligne=facei*nb_comp+dim;
              matrice(ligne,ligne)+=div;
            }
        }
    }

<span class="comment">// </span>
<span class="comment">// Pour la periodicite</span>
<span class="comment">// </span>
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; num_fac_loc = zone_VEF.<a class="code" href="classZone__VF.html#a95113b10f16f37600ba81d3fb41102b2">get_num_fac_loc</a>();
  <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;nb_bord; n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      num1 = 0;
      num2=le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();<span class="comment">//pour ne parcourir que les faces reelles</span>

      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());

          <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
            {
              facei=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              ind_faceiAss=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(ind_face);
              faceiAss=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_faceiAss);

<span class="comment">// Pour ne parcourir qu&#39;une seule fois les faces perio</span>
              <span class="keywordflow">if</span> (facei&lt;faceiAss)
                <span class="keywordflow">for</span> (elem_loc=0; elem_loc&lt;2; elem_loc++)
                  {
                    elem=face_voisins(facei,elem_loc);
                    assert(elem!=-1);

<span class="comment">// Calcul du numero local de la face dans &quot;elem&quot;</span>
                    facei_loc=num_fac_loc(facei,elem_loc);
                    <span class="keywordflow">if</span> (facei_loc!=-1)
                      faceToComplete=faceiAss;
                    <span class="keywordflow">else</span>
                      {
                        faceToComplete=facei;
                        facei_loc=num_fac_loc(faceiAss,elem_loc);
                        assert(facei_loc!=-1);
                      }

<span class="comment">// Type de l&#39;element : le nombre de faces de Dirichlet</span>
<span class="comment">// qu&#39;il contient</span>
                    <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aed3b960a81290a5110ae7ac8f9006fd8">elem_nb_faces_dirichlet_</a>(elem);
                    coeff=formule(<a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>);

<span class="comment">// Calcul de la divergence par element</span>
                    div=0.;
                    <span class="keywordflow">for</span> (facei_loc=0; facei_loc&lt;nb_faces_elem; facei_loc++)
                      {
                        facei=elem_faces(elem,facei_loc);
                        signe=(face_voisins(facei,0)==elem)? 1.:-1.;

                        <span class="keywordflow">for</span> (dim=0; dim&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; dim++)
                          div+=signe*face_normales(facei,dim)*tab_vitesse(facei,dim);
                      }
                    div*=<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
                    <span class="keywordflow">if</span> (!marq) div/=porosite_elem(elem);

<span class="comment">// Calcul de la partie compressible</span>
                    <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
                      {
                        ligne=faceToComplete*nb_comp+dim;
                        matrice(ligne,ligne)+=div;
                      }
                  }
            }
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2afbe2fa6f98fe9539705ef2d0d392f7"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::ajouter_diffusion" ref="a2afbe2fa6f98fe9539705ef2d0d392f7" args="(const DoubleTab &amp;, const DoubleTab &amp;, DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Op_Conv_EF_VEF_P1NC_Stab::ajouter_diffusion </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00800">800</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00106">alpha_tab</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00190">Dij()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="IntVect_8h_source.html#l00150">IntVect::line_size()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, and <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01169">test_difference_resu()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">test_implicite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF=<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot=zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntVect.html#a5ba680066169c8e057bb3e3b876e4a8c">line_size</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
  <span class="keywordtype">int</span> elem=0, facei=0,facei_loc=0, facej=0,facej_loc=0, ligne=0,colonne=0, dim=0;
  <span class="keywordtype">double</span> dij=0., delta=0., coeffij=0.,coeffji=0.;

  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; transporteV=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,transporte);
  <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resuV=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,resu);

  <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
    <span class="keywordflow">for</span> (facei_loc=0; facei_loc&lt;nb_faces_elem; facei_loc++)
      {
        facei=elem_faces(elem,facei_loc);
        <span class="keywordflow">for</span> (facej_loc=facei_loc+1; facej_loc&lt;nb_faces_elem; facej_loc++)
          {
            facej=elem_faces(elem,facej_loc);
            assert(facej!=facei);

            dij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ae5963d1de142bf425808b7401692bd90">Dij</a>(elem,facei_loc,facej_loc,Kij);
            assert(dij&gt;=0);

            coeffij=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(facei)*dij;
            coeffji=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(facej)*dij;

            <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
              {
                ligne=facei*nb_comp+dim;
                colonne=facej*nb_comp+dim;
                delta=transporteV[colonne]-transporteV[ligne];

<span class="comment">// ATTENTION AU SIGNE : ici on code +div(uT)</span>
<span class="comment">// REMARQUE : on utilise la symetrie de l&#39;operateur</span>
                resuV[ligne]+=coeffij*delta;
                resuV[colonne]-=coeffji*delta;
              }
          }
      }
  <span class="keywordflow">return</span> resu;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a14bece1772d9e8a5ffa4105ea14ca06a"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::ajouter_old" ref="a14bece1772d9e8a5ffa4105ea14ca06a" args="(const DoubleTab &amp;, DoubleTab &amp;, const DoubleTab &amp;vitesse) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::ajouter_old </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vitesse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01606">1606</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00190">Dij()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Periodique_8h_source.html#l00056">Periodique::face_associee()</a>, <a class="el" href="AssembleurPP1BUtil_8cpp_source.html#l00046">face_associee</a>, <a class="el" href="Zone__VEF_8h_source.html#l00145">Zone_VEF::face_normales()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00096">Op_Conv_VEF_base::fluent</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00200">limiteur()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00181">minimum()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00061">Front_VF::nb_faces()</a>, <a class="el" href="Front__VF_8h_source.html#l00066">Front_VF::nb_faces_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Front__VF_8h_source.html#l00071">Front_VF::num_premiere_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Neumann__sortie__libre_8cpp_source.html#l00138">Neumann_sortie_libre::val_ext()</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>, <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00115">volumes_etendus_</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
<span class="comment">// const Champ_P1NC&amp; la_vitesse=ref_cast( Champ_P1NC, vitesse_.valeur());</span>
<span class="comment">// const DoubleTab&amp; vitesse=la_vitesse.valeurs();</span>

  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales=zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();

  assert(nb_faces_elem==(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+1));

  <span class="keywordtype">int</span> nb_comp=resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

  <span class="keywordtype">int</span> face_i0, face_j0, elem0, comp0;
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Kij(nb_elem_tot,nb_faces_elem, nb_faces_elem);
<span class="comment">// </span>
<span class="comment">// Calcul des Kij :</span>
<span class="comment">// </span>
  <span class="keywordflow">for</span>(elem0=0; elem0&lt;nb_elem_tot; elem0++)
    {
      <span class="keywordtype">int</span> face_loci=0;
      <span class="keywordtype">int</span> face_locj=0;
      <span class="keywordflow">for</span>(; face_loci&lt;nb_faces_elem; face_loci++)
        {
          face_i0=elem_faces(elem0,face_loci);
          <span class="keywordtype">double</span> signei=1.0;
          <span class="keywordflow">if</span>(face_voisins(face_i0,0)!=elem0)
            signei=-1.0;
          <span class="keywordtype">double</span> psci=0;
          <span class="keywordflow">for</span>(comp0=0; comp0&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp0++)
            psci+=tab_vitesse(face_i0,comp0)*face_normales(face_i0,comp0);
          psci*=signei;
<span class="comment">// Kij(elem,face_loci,face_loci)=0.;</span>
          <span class="keywordflow">for</span>(face_locj=face_loci+1; face_locj&lt;nb_faces_elem; face_locj++)
            {
              face_j0=elem_faces(elem0,face_locj);
              <span class="keywordtype">double</span> signej=1.0;
              <span class="keywordflow">if</span>(face_voisins(face_j0,0)!=elem0)
                signej=-1.0;

              <span class="keywordtype">double</span> pscj=0;
<span class="comment">// psci=0;</span>
              <span class="keywordflow">for</span>(comp0=0; comp0&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp0++)
                pscj+=tab_vitesse(face_j0,comp0)*face_normales(face_j0,comp0);
              pscj*=signej;
              Kij(elem0,face_loci,face_locj)=-1./nb_faces_elem*pscj;
              Kij(elem0,face_loci,face_loci)+=1./nb_faces_elem*pscj;
              Kij(elem0,face_locj,face_loci)=-1./nb_faces_elem*psci;
              Kij(elem0,face_locj,face_locj)+=1./nb_faces_elem*psci;
            }
        }
    }
<span class="comment">// </span>
<span class="comment">// Correction des Kij pour Dirichlet !</span>
<span class="comment">// </span>
  {
    <span class="keywordtype">int</span> nb_bord=zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
    <span class="keywordtype">int</span> face;
    <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>=1./<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
      {
        <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
        <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
        <span class="keywordtype">int</span> nb_faces_tot=le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
        <span class="keywordflow">if</span> (( (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())) || (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())) )
            &amp;&amp; ( <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a0fa21a81e6deda452a87699846cc1cd6">volumes_etendus_</a>))
          {
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face&lt;nb_faces_tot; ind_face++)
              {
                face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
                <span class="keywordtype">int</span> elem=face_voisins(face,0);
                assert(elem!=-1);
                <span class="keywordtype">int</span> face_loc_j;
                <span class="keywordtype">int</span> face_j=-1;
                <span class="keywordflow">for</span> (face_loc_j=0; (face_loc_j&lt;nb_faces_elem &amp;&amp; face_j!=face); face_loc_j++)
                  {
                    face_j=elem_faces(elem,face_loc_j);
                  }
                face_loc_j--;
                assert(face_loc_j&gt;=0);
                assert(face_loc_j&lt;nb_faces_elem);
                assert(elem_faces(elem,face_loc_j)==face);
                <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; kjj=Kij(elem,face_loc_j,face_loc_j);
                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_i=0; face_loc_i&lt;nb_faces_elem; face_loc_i++)
                  {
                    <span class="keywordtype">int</span> face_i=elem_faces(elem,face_loc_i);
                    <span class="keywordflow">if</span>(face_i!=face)
                      {
                        <span class="keywordtype">double</span>&amp; kii=Kij(elem,face_loc_i,face_loc_i);
                        <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; kji=Kij(elem,face_loc_j,face_loc_i);
                        kii+=coeff*kji;
                        <span class="keywordtype">double</span>&amp; kij=Kij(elem,face_loc_i,face_loc_j);
                        kij+=coeff*kjj;
                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_k=(face_loc_i+1); face_loc_k&lt;nb_faces_elem; face_loc_k++)
                          {
                            <span class="keywordtype">int</span> face_k=elem_faces(elem,face_loc_k);
                            <span class="keywordflow">if</span>(face_k!=face)
                              {
                                <span class="keywordtype">double</span>&amp; kik=Kij(elem,face_loc_i,face_loc_k);
                                <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; kjk=Kij(elem,face_loc_j,face_loc_k);
                                <span class="keywordtype">double</span>&amp; kki=Kij(elem,face_loc_k,face_loc_i);
                                kik+=coeff*kjk;
                                kki+=coeff*kji;
                              }
                          }
                      }
                  }
                {
                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_i=0; face_loc_i&lt;nb_faces_elem; face_loc_i++)
                    Kij(elem,face_loc_j,face_loc_i)=0;
                }
                {
                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_i=0; face_loc_i&lt;nb_faces_elem; face_loc_i++)
                    {
                      <span class="keywordtype">double</span> sum=0.;
                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_k=0; face_loc_k&lt;nb_faces_elem; face_loc_k++)
                        {
                          sum+=Kij(elem,face_loc_i,face_loc_k);
                        }
<span class="comment">// Cerr &lt;&lt; &quot;somme apres : &quot; &lt;&lt; sum &lt;&lt; finl;</span>
                      Kij(elem,face_loc_i,face_loc_i)-=sum;<span class="comment">//car div(u)=0!</span>
                    }
                }
              }<span class="comment">//!&lt; for face</span>
<span class="comment"></span>          }<span class="comment">//!&lt; sub_type Dirichlet</span>
<span class="comment"></span>      }
  }

<span class="comment">// </span>
<span class="comment">// Calcul de resu</span>
<span class="comment">// </span>

  <span class="keywordtype">double</span> sigma_fijd=0;
  <span class="keywordtype">double</span> sigma_fija=0;

  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> pplusi(nb_comp);
  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> qplusi(nb_comp);
  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> pmoinsi(nb_comp);
  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> qmoinsi(nb_comp);

  <span class="keywordflow">for</span>(elem0=0; elem0&lt;nb_elem_tot; elem0++)
    {
      <span class="keywordtype">int</span> face_loci=0;
      <span class="keywordtype">int</span> face_locj=0;

      <span class="keywordflow">for</span>(; face_loci&lt;nb_faces_elem; face_loci++)
        {
          face_i0=elem_faces(elem0,face_loci);

          <span class="keywordflow">for</span>(comp0=0; comp0&lt;nb_comp; comp0++)
            resu(face_i0,comp0)+=Kij(elem0,face_loci,face_loci)*transporte(face_i0,comp0);

          pplusi=0., qplusi=0., pmoinsi=0., qmoinsi=0.;

          <span class="keywordtype">int</span> elem1=face_voisins(face_i0,0);
          <span class="keywordtype">int</span> elem2=face_voisins(face_i0,1);
          <span class="keywordtype">int</span> face_loc_i=0;
          <span class="keywordtype">int</span> face_loc_j=0;
          <span class="keywordtype">double</span> dT,min_dT,max_dT;
          <span class="keywordtype">double</span> K,min_K,max_K;

<span class="comment">// </span>
<span class="comment">// dans elem1 :</span>
<span class="comment">// </span>
          <span class="keywordflow">while</span>((face_loc_i&lt;nb_faces_elem)&amp;&amp;(elem_faces(elem1,face_loc_i)!=face_i0))
            face_loc_i++;
          <span class="keywordflow">if</span>(face_loc_i==nb_faces_elem)
            {
<span class="comment">// Periodique!!</span>
              assert(elem2!=-1);
              face_loc_i=0;
              <span class="keywordflow">while</span>( (face_loc_i&lt;nb_faces_elem) &amp;&amp;
                     (face_voisins(elem_faces(elem1,face_loc_i),0)!=elem2) &amp;&amp;
                     (face_voisins(elem_faces(elem1,face_loc_i),1)!=elem2) )
                face_loc_i++;
            }
          assert(face_loc_i&lt;nb_faces_elem);
          <span class="keywordflow">for</span>(face_loc_j=0; face_loc_j&lt;nb_faces_elem; face_loc_j++)
            {
              <span class="keywordtype">int</span> face_j=elem_faces(elem1,face_loc_j);
              <span class="keywordflow">if</span>(face_j!=face_i0)
                {
                  K=Kij(elem1,face_loc_i,face_loc_j);

                  <span class="keywordflow">if</span>(K&gt;0.)
                    {
                      max_K=K ;
                      min_K=0.;
                    }
                  <span class="keywordflow">else</span>
                    {
                      max_K=0.;
                      min_K=K ;
                    }

                  <span class="keywordflow">for</span>(comp0=0; comp0&lt;nb_comp; comp0++)
                    {
                      dT =transporte(face_j,comp0);
                      dT-=transporte(face_i0,comp0);

                      <span class="keywordflow">if</span>(dT&gt;0.)
                        {
                          max_dT=dT ;
                          min_dT=0 ;
                        }
                      <span class="keywordflow">else</span>
                        {
                          max_dT=0. ;
                          min_dT=dT ;
                        }

                      pplusi(comp0) +=min_K*min_dT;
                      pmoinsi(comp0)+=min_K*max_dT;
                      qplusi(comp0) +=max_K*max_dT;
                      qmoinsi(comp0)+=max_K*min_dT;
                    }
                }
            }

<span class="comment">// </span>
<span class="comment">// dans elem2 :</span>
<span class="comment">// </span>

          <span class="keywordflow">if</span>(elem2!=-1)
            {
              face_loc_i=0;
              <span class="keywordflow">while</span>((face_loc_i&lt;nb_faces_elem)&amp;&amp;(elem_faces(elem2,face_loc_i)!=face_i0))
                face_loc_i++;
              <span class="keywordflow">if</span>(face_loc_i==nb_faces_elem)
                {
<span class="comment">// Periodique!!</span>
                  face_loc_i=0;
                  <span class="keywordflow">while</span>( (face_loc_i&lt;nb_faces_elem) &amp;&amp;
                         (face_voisins(elem_faces(elem2,face_loc_i),0)!=elem1) &amp;&amp;
                         (face_voisins(elem_faces(elem2,face_loc_i),1)!=elem1) )
                    face_loc_i++;
                }
              assert(face_loc_i&lt;nb_faces_elem);
              <span class="keywordflow">for</span>(face_loc_j=0; face_loc_j&lt;nb_faces_elem; face_loc_j++)
                {
                  <span class="keywordtype">int</span> face_j=elem_faces(elem2,face_loc_j);
                  <span class="keywordflow">if</span>(face_j!=face_i0)
                    {
                      K=Kij(elem2,face_loc_i,face_loc_j);

                      <span class="keywordflow">if</span>(K&gt;0.)
                        {
                          max_K=K ;
                          min_K=0.;
                        }
                      <span class="keywordflow">else</span>
                        {
                          max_K=0.;
                          min_K=K ;
                        }

                      <span class="keywordflow">for</span>(comp0=0; comp0&lt;nb_comp; comp0++)
                        {
                          dT =transporte(face_j,comp0);
                          dT-=transporte(face_i0,comp0);

                          <span class="keywordflow">if</span>(dT&gt;0.)
                            {
                              max_dT=dT ;
                              min_dT=0 ;
                            }
                          <span class="keywordflow">else</span>
                            {
                              max_dT=0. ;
                              min_dT=dT ;
                            }

                          pplusi(comp0) +=min_K*min_dT;
                          pmoinsi(comp0)+=min_K*max_dT;
                          qplusi(comp0) +=max_K*max_dT;
                          qmoinsi(comp0)+=max_K*min_dT;
                        }
                    }
                }
            }



          <span class="keywordflow">for</span>(face_locj=0; face_locj&lt;nb_faces_elem; face_locj++)
            <span class="keywordflow">if</span>(face_locj!=face_loci)
              {
                face_j0=elem_faces(elem0,face_locj);
                <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; kij=Kij(elem0,face_loci,face_locj);
                <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; kji=Kij(elem0,face_locj,face_loci);
                <span class="keywordtype">double</span> dij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ae5963d1de142bf425808b7401692bd90">Dij</a>(elem0,face_loci,face_locj,Kij);
                <span class="keywordtype">double</span> lji=kji+dij;
                <span class="keywordtype">double</span> lij=kij+dij;
                assert(lij&gt;=0);
                assert(lji&gt;=0);

                <span class="keywordflow">for</span>(comp0=0; comp0&lt;nb_comp; comp0++)
                  {
                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; Ti=transporte(face_i0,comp0);
                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; Tj=transporte(face_j0,comp0);
                    <span class="keywordtype">double</span> deltaij=Ti-Tj;
                    <span class="keywordtype">double</span> Fij=0;
                    <span class="keywordflow">if</span>(lij&lt;=lji)
                      {
                        <span class="keywordtype">double</span> coef=1;
                        <span class="keywordflow">if</span> (lij==lji)  coef=.5;
                        <span class="keywordflow">if</span>(deltaij)
                          {
                            <span class="keywordflow">if</span>(Ti &gt;= Tj)
                              {
                                <span class="keywordflow">if</span>(pplusi(comp0))
                                  {
                                    <span class="keywordtype">double</span> R=qplusi(comp0)/pplusi(comp0);
                                    Fij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ade923cb828015cfde5aff245ecd65936">minimum</a>(<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a36b674f178bc8694c4bc14686f6f17bb">limiteur</a>(R)*dij,lji);
                                  }
                              }
                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pmoinsi(comp0))
                              {
                                <span class="keywordtype">double</span> R=qmoinsi(comp0)/pmoinsi(comp0);
                                Fij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ade923cb828015cfde5aff245ecd65936">minimum</a>(<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a36b674f178bc8694c4bc14686f6f17bb">limiteur</a>(R)*dij,lji);
                              }
                            assert(Fij*dij&gt;=0);
                            sigma_fijd+=dij;
                            sigma_fija+=Fij;
                            Fij-=dij;
                            Fij*=deltaij;
                          }
                        resu(face_i0,comp0)+=coef*(kij*Tj+Fij);
                        resu(face_j0,comp0)+=coef*(kji*Ti-Fij);
                      }
                  }
              }
        }
    }
<span class="comment">// On reprend ici le traitement qui est fait pour la CL de Neumann_sortie_libre dans Op_Conv_VEF_Face</span>
  <span class="keywordtype">int</span> nb_bord=zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
  <span class="keywordtype">int</span> face;
  <span class="keyword">const</span> <span class="keywordtype">int</span> ncomp_ch_transporte = transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      <span class="keywordtype">int</span> nb_faces_tot=le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();

      <span class="keywordtype">double</span> psc;
      <span class="keywordtype">int</span> num_face,i;

      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; la_sortie_libre = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>, la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<span class="comment">// const Front_VF&amp; le_bord = ref_cast(Front_VF,la_cl.frontiere_dis());</span>
          <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
          <span class="keywordtype">int</span> num2 = num1 + le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
          <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; fluent_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>, <a class="code" href="classOp__Conv__VEF__base.html#a32b54e8fd5340e238cf4f28ff6e743ec" title="tableau qui sert pour le calcul du pas de temps de stabilite">fluent</a>);

          <span class="keywordflow">for</span> (num_face=num1; num_face&lt;num2; num_face++)
            {
              psc =0;
              <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)
                psc += tab_vitesse(num_face,i)*face_normales(num_face,i);
              <span class="keywordflow">if</span> (psc&gt;0)
                {
                  <span class="keywordflow">for</span> (i=0; i&lt;ncomp_ch_transporte; i++)
                    resu(num_face,i) -= psc*transporte(num_face,i);
                }
              <span class="keywordflow">else</span>
                {
                  <span class="keywordflow">for</span> (i=0; i&lt;ncomp_ch_transporte; i++)
                    resu(num_face,i) -= psc*la_sortie_libre.<a class="code" href="classNeumann__sortie__libre.html#a886f1804fa2a9028fc56a0778a72a75d" title="Renvoie la valeur de la i-eme composante du champ impose a l&#39;exterieur de la frontiere.">val_ext</a>(num_face-num1,i);
                  fluent_(num_face) -= psc;
                }
            }
        }
<span class="comment">// Pour periodique</span>
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
          <span class="keywordtype">int</span> <a class="code" href="AssembleurPP1BUtil_8cpp.html#a3e374d53ebc7860e1c2f0b7906f2936d">face_associee</a>,ind_face_associee;
          <a class="code" href="classIntVect.html">IntVect</a> fait(nb_faces_tot);
          fait = 0;

          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face&lt;nb_faces_tot; ind_face++)
            {
              face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              <span class="keywordflow">if</span> (fait(ind_face) == 0)
                {
                  fait(ind_face) = 1;
                  ind_face_associee=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(ind_face);
                  fait(ind_face_associee) = 1;
                  face_associee=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face_associee);
                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
                    resu(face_associee, comp)=(resu(face,comp)+=resu(face_associee,comp));
                }<span class="comment">//!&lt; if fait</span>
<span class="comment"></span>            }<span class="comment">//!&lt; for face</span>
<span class="comment"></span>        }<span class="comment">//!&lt; sub_type Perio</span>
<span class="comment"></span>    }
  <span class="comment">/*</span>
<span class="comment">    ArrOfDouble bilan(nb_comp);</span>
<span class="comment">    BilanQdmVEF::bilan_qdm(resu, zone_Cl_VEF, bilan);</span>
<span class="comment">    if(nb_comp==1)</span>
<span class="comment">    Cout &lt;&lt; &quot;Scalaire Bilan Convectif : &quot; &lt;&lt; bilan[0] &lt;&lt; finl;</span>
<span class="comment">    else</span>
<span class="comment">    for (int comp=0; comp&lt;nb_comp; comp++)</span>
<span class="comment">    Cout &lt;&lt; &quot;Vecteur Bilan Convectif &quot; &lt;&lt; comp &lt;&lt; &quot; : &quot; &lt;&lt; bilan[comp] &lt;&lt; finl;</span>
<span class="comment">    bilan=0;</span>
<span class="comment">    BilanQdmVEF::bilan_energie(resu, transporte, zone_Cl_VEF, bilan);</span>
<span class="comment">    if(nb_comp==1)</span>
<span class="comment">    Cout &lt;&lt; &quot;Scalaire Bilan Convectif Energie : &quot; &lt;&lt; bilan[0] &lt;&lt; finl;</span>
<span class="comment">    else</span>
<span class="comment">    for (int comp=0; comp&lt;nb_comp; comp++)</span>
<span class="comment">    Cout &lt;&lt; &quot;Vecteur Bilan Convectif Energie &quot; &lt;&lt; comp &lt;&lt; &quot; : &quot; &lt;&lt; bilan[comp] &lt;&lt; finl;</span>
<span class="comment">    if(nb_comp==1)</span>
<span class="comment">    {</span>
<span class="comment">    Cout &lt;&lt; &quot;min = &quot; &lt;&lt; min(transporte);</span>
<span class="comment">    Cout &lt;&lt; &quot; max = &quot; &lt;&lt; max(transporte) &lt;&lt; finl;</span>
<span class="comment">    }</span>
<span class="comment">    //  else</span>
<span class="comment">    //    for (int comp=0; comp&lt;nb_comp; comp++)</span>
<span class="comment">    //    {</span>
<span class="comment">    //      Cout &lt;&lt; &quot;min(&quot;&lt;&lt;comp&lt;&lt;&quot;) = &quot; &lt;&lt; transporte.min(comp);</span>
<span class="comment">    //      Cout &lt;&lt; &quot; max(&quot;&lt;&lt;comp&lt;&lt;&quot;) = &quot; &lt;&lt; transporte.max(comp) &lt;&lt; finl;</span>
<span class="comment">    //    }</span>
<span class="comment">    Cout &lt;&lt; &quot; Ratio Antidiffusion/Diffusion = &quot; &lt;&lt; sigma_fija/sigma_fijd &lt;&lt; finl;</span>
<span class="comment">  */</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1cc3e4915dcd0e22759b0f290f9ffbf5"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::ajouter_operateur_centre" ref="a1cc3e4915dcd0e22759b0f290f9ffbf5" args="(const DoubleTab &amp;, const DoubleTab &amp;, DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Op_Conv_EF_VEF_P1NC_Stab::ajouter_operateur_centre </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00762">762</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="IntVect_8h_source.html#l00150">IntVect::line_size()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, and <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01169">test_difference_resu()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">test_implicite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF=<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot=zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntVect.html#a5ba680066169c8e057bb3e3b876e4a8c">line_size</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
  <span class="keywordtype">int</span> elem=0,facei=0,facei_loc=0, facej=0,facej_loc=0, ligne=0,colonne=0, dim=0;
  <span class="keywordtype">double</span> kij=0.,kji=0.,delta=0.;
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; transporteV=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,transporte);
  <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resuV=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,resu);

  <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
    <span class="keywordflow">for</span> (facei_loc=0; facei_loc&lt;nb_faces_elem; facei_loc++)
      {
        facei=elem_faces(elem,facei_loc);
        <span class="keywordflow">for</span> (facej_loc=facei_loc+1; facej_loc&lt;nb_faces_elem; facej_loc++)
          {
            facej=elem_faces(elem,facej_loc);
            assert(facej!=facei);
            kij=Kij(elem,facei_loc,facej_loc);
            kji=Kij(elem,facej_loc,facei_loc);

            <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
              {
                ligne=facei*nb_comp+dim;
                colonne=facej*nb_comp+dim;
                delta=transporteV[colonne]-transporteV[ligne];
                resuV[ligne]+=kij*delta;
                resuV[colonne]-=kji*delta;
              }
          }
      }

  <span class="keywordflow">return</span> resu;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a81ab1069edcf31b0e416a557d9443f7f"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::ajouter_partie_compressible" ref="a81ab1069edcf31b0e416a557d9443f7f" args="(const DoubleTab &amp;, DoubleTab &amp;, const DoubleTab &amp;vitesse) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Op_Conv_EF_VEF_P1NC_Stab::ajouter_partie_compressible </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vitesse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00633">633</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00103">elem_nb_faces_dirichlet_</a>, <a class="el" href="MorEqn_8h_source.html#l00082">MorEqn::equation()</a>, <a class="el" href="Zone__VEF_8h_source.html#l00145">Zone_VEF::face_normales()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00216">formule_2D()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00237">formule_3D()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00206">formule_Id_2D()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00211">formule_Id_3D()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="IntVect_8h_source.html#l00150">IntVect::line_size()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Op__Conv__VEF__base_8cpp_source.html#l00053">Op_Conv_VEF_base::phi_u_transportant()</a>, <a class="el" href="Zone__VF_8h_source.html#l00315">Zone_VF::porosite_elem()</a>, <a class="el" href="Zone__VF_8h_source.html#l00285">Zone_VF::porosite_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Raffiner__Simplexes_8cpp_source.html#l00183">type_elem()</a>, <a class="el" href="Ref__Champ__Inc__base_8h_source.html#l00028">Ref_Champ_Inc_base::valeur()</a>, <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>, <a class="el" href="Champ__Inc__base_8cpp_source.html#l00221">Champ_Inc_base::valeurs()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00094">Op_Conv_VEF_base::vitesse_</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00115">volumes_etendus_</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01169">test_difference_resu()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">test_implicite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF=<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales=zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot=zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntVect.html#a5ba680066169c8e057bb3e3b876e4a8c">line_size</a>();

<span class="comment">// Pour tenir compte de la porosite</span>
  <span class="keyword">const</span> <span class="keywordtype">int</span> marq = <a class="code" href="classOp__Conv__VEF__base.html#ad380b9b9ca1d70282b289838a604a4b0" title="definit si l&#39;on convecte psi avec phi*u ou avec u">phi_u_transportant</a>(<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>());
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_elem = zone_VEF.<a class="code" href="classZone__VF.html#afd135a1b227731193b1a97b7ed525435">porosite_elem</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite_face = zone_VEF.<a class="code" href="classZone__VF.html#ad9d74d1d9da9f50ab26768dbbca7711b">porosite_face</a>();

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> tab_vitesse(<a class="code" href="classOp__Conv__VEF__base.html#a5547875832fb45e09b1115372fb76ffd">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>().<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>());
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;tab_vitesse.dimension(0); i++)
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;tab_vitesse.dimension(1); j++)
      tab_vitesse(i,j)*=porosite_face(i);

  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
  <span class="keywordtype">int</span> elem=0,<a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>=0, facei=0,facei_loc=0, ligne=0, dim=0;
  <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>=0., signe=0., div=0.;

  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; transporteV=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,transporte);
  <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resuV=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,resu);

  double (*formule)(int);
  <span class="keywordflow">if</span> (!<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a0fa21a81e6deda452a87699846cc1cd6">volumes_etendus_</a>)
    formule= (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==2) ? &amp;<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a7799aa1823cec7df9243ea24bcf2f493">formule_Id_2D</a> : &amp;<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a89170674bf686e027b6f6babdf658253">formule_Id_3D</a>;
  <span class="keywordflow">else</span>
    formule= (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==2) ? &amp;<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#aa1313236a6927475a5d773405ad84c0e">formule_2D</a> : &amp;<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a1b2dc898af7cd545a374f228d5eee000">formule_3D</a>;


  <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem_tot; elem++)
    {
<span class="comment">// Type de l&#39;element : le nombre de faces de Dirichlet</span>
<span class="comment">// qu&#39;il contient</span>
      <a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aed3b960a81290a5110ae7ac8f9006fd8">elem_nb_faces_dirichlet_</a>(elem);
      coeff=formule(<a class="code" href="Raffiner__Simplexes_8cpp.html#a358dc168d8905bbafc12587204bc9fb8">type_elem</a>);

<span class="comment">// Calcul de la divergence par element</span>
      div=0.;
      <span class="keywordflow">for</span> (facei_loc=0; facei_loc&lt;nb_faces_elem; facei_loc++)
        {
          facei=elem_faces(elem,facei_loc);
          signe=(face_voisins(facei,0)==elem)? 1.:-1.;

          <span class="keywordflow">for</span> (dim=0; dim&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; dim++)
            div+=signe*face_normales(facei,dim)*tab_vitesse(facei,dim);
        }
      div*=<a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
      <span class="keywordflow">if</span> (!marq) div/=porosite_elem(elem);

<span class="comment">// Calcul de la partie compressible</span>
      <span class="keywordflow">for</span> (facei_loc=0; facei_loc&lt;nb_faces_elem; facei_loc++)
        {
          facei=elem_faces(elem,facei_loc);
          <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
            {
              ligne=facei*nb_comp+dim;
              resuV[ligne]-=div*transporteV[ligne];
            }
        }
    }

  <span class="keywordflow">return</span> resu;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3c1c70e249ebd12239c7987a4e50d277"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::calculer_coefficients_operateur_centre" ref="a3c1c70e249ebd12239c7987a4e50d277" args="(DoubleTab &amp;, const int &amp;, const DoubleTab &amp;vitesse) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::calculer_coefficients_operateur_centre </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>nb_comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vitesse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00313">313</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00104">elem_faces_dirichlet_</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00103">elem_nb_faces_dirichlet_</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Zone__VEF_8h_source.html#l00145">Zone_VEF::face_normales()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Zone__VF_8h_source.html#l00176">Zone_VF::get_num_fac_loc()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="IntVect_8h_source.html#l00150">IntVect::line_size()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="DoubleTab_8h_source.html#l00264">DoubleTab::nb_dim()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00066">Front_VF::nb_faces_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Objet__U_8cpp_source.html#l00132">Objet_U::que_suis_je()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>, <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00115">volumes_etendus_</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02191">ajouter_contribution()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01021">test_difference_Kij()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">test_implicite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales=zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntVect.html#a5ba680066169c8e057bb3e3b876e4a8c">line_size</a>();

  assert(Kij.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>()==3);
  assert(Kij.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)==nb_elem_tot);
  assert(Kij.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1)==Kij.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(2));
  assert(Kij.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1)==nb_faces_elem);

<span class="comment">// </span>
<span class="comment">// Calcul des coefficients de l&#39;operateur</span>
<span class="comment">// </span>
  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem_tot; elem++)
    {
      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> face_loci=0; face_loci&lt;nb_faces_elem; face_loci++)
        {
          <span class="keywordtype">int</span> face_i=elem_faces(elem,face_loci);

          <span class="keywordtype">double</span> signei=1.0;
          <span class="keywordflow">if</span>(face_voisins(face_i,0)!=elem) signei=-1.0;

          <span class="keywordtype">double</span> psci=0;
          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
            psci+=tab_vitesse(face_i,comp)*face_normales(face_i,comp);
          psci*=signei;

<span class="comment">// Kij(elem,face_loci,face_loci)=0.;</span>
          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> face_locj=face_loci+1; face_locj&lt;nb_faces_elem; face_locj++)
            {
              <span class="keywordtype">int</span> face_j=elem_faces(elem,face_locj);
              <span class="keywordtype">double</span> signej=1.0;
              <span class="keywordflow">if</span>(face_voisins(face_j,0)!=elem)
                signej=-1.0;

              <span class="keywordtype">double</span> pscj=0;
<span class="comment">// psci=0;</span>
              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
                pscj+=tab_vitesse(face_j,comp)*face_normales(face_j,comp);
              pscj*=signej;

              Kij(elem,face_loci,face_locj)=-1./nb_faces_elem*pscj;
              Kij(elem,face_loci,face_loci)+=1./nb_faces_elem*pscj;
              Kij(elem,face_locj,face_loci)=-1./nb_faces_elem*psci;
              Kij(elem,face_locj,face_locj)+=1./nb_faces_elem*psci;
            }<span class="comment">//fin du for sur &quot;face_locj&quot;</span>
        }<span class="comment">//fin du for sur &quot;face_loci&quot;</span>
    }<span class="comment">//fin du for sur &quot;elem&quot;</span>

<span class="comment">// </span>
<span class="comment">// Correction des Kij pour Dirichlet !</span>
<span class="comment">// </span>
  {
    <span class="keywordtype">int</span> nb_bord=zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
    <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; num_fac_loc = zone_VEF.<a class="code" href="classZone__VF.html#a95113b10f16f37600ba81d3fb41102b2">get_num_fac_loc</a>();
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
      {
        <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
        <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
        <span class="keywordtype">int</span> nb_faces_tot=le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
        <span class="keywordtype">int</span> face;

        <span class="keywordflow">if</span> ( (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
             || (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
           )
          {
<span class="comment">// GF on retire le test sur nb_comp car sinon en scalaire on fait tjs du volume etendu</span>
            <span class="keywordflow">if</span> ( <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a0fa21a81e6deda452a87699846cc1cd6">volumes_etendus_</a> )
              {
<span class="comment">// </span>
<span class="comment">// Modification des coefficients de la matrice</span>
<span class="comment">// </span>
                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face&lt;nb_faces_tot; ind_face++)
                  {
                    face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
                    <span class="keyword">const</span> <span class="keywordtype">int</span> elem=face_voisins(face,0);
                    assert(elem!=-1);

                    <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nb_faces_bord = <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aed3b960a81290a5110ae7ac8f9006fd8">elem_nb_faces_dirichlet_</a>(elem);

<span class="comment">// </span>
<span class="comment">// Calcul du coefficient ponderateur</span>
<span class="comment">// </span>

                    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==2) ?
                                         nb_faces_bord/2. : nb_faces_bord*nb_faces_bord/6.-nb_faces_bord/3.+1./2;

<span class="comment">// </span>
<span class="comment">// Fin du calcul du coefficient ponderateur</span>
<span class="comment">// </span>

                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_i=0; face_loc_i&lt;nb_faces_elem; face_loc_i++)
                      {
                        <span class="keyword">const</span> <span class="keywordtype">int</span> face_i = elem_faces(elem,face_loc_i);

                        <span class="comment">/* On determine si &quot;face_i&quot; est une face de Dirichlet */</span>
                        <span class="keywordtype">bool</span> is_not_on_boundary = <span class="keyword">true</span>;
                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f_loc=0; f_loc&lt;nb_faces_bord; f_loc++)
                          is_not_on_boundary&amp;=(face_i!=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">elem_faces_dirichlet_</a>(elem,f_loc));

                        <span class="keywordflow">if</span> (is_not_on_boundary) <span class="comment">/* si &quot;face_i&quot; n&#39;est pas de Dirichlet */</span>
                          {
                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_j=0; face_loc_j&lt;nb_faces_elem; face_loc_j++)
                              {
                                <span class="comment">/* Modification des coefficients de la matrice */</span>
                                <span class="comment">/* selon les fonctions de formes etendues */</span>
                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f_loc=0; f_loc&lt;nb_faces_bord; f_loc++)
                                  {
                                    <span class="keyword">const</span> <span class="keywordtype">int</span> face_bord = <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">elem_faces_dirichlet_</a>(elem,f_loc);
                                    <span class="keyword">const</span> <span class="keywordtype">int</span> face_loc_k = num_fac_loc(face_bord,0);
                                    assert(face_loc_k&gt;=0);
                                    assert(face_loc_k&lt;nb_faces_elem);

                                    <span class="keywordtype">double</span>&amp; kij = Kij(elem,face_loc_i,face_loc_j);
                                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; kkj = Kij(elem,face_loc_k,face_loc_j);
                                    kij+=coeff*kkj;

                                  }<span class="comment">//fin du for sur &quot;f_loc&quot;</span>

                              }<span class="comment">//fin du for sur &quot;face_loc_k&quot;</span>

                          }<span class="comment">//fin du if</span>

                      }<span class="comment">//fin du for sur &quot;face_loc_i&quot;</span>


<span class="comment">// </span>
<span class="comment">// Remise a zero des coefficients associes aux noeuds</span>
<span class="comment">// qui se situent sur la frontiere de Dirichlet</span>
<span class="comment">// </span>
                    {
                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f_loc=0; f_loc&lt;nb_faces_bord; f_loc++)
                        {
                          <span class="keyword">const</span> <span class="keywordtype">int</span> face_bord = <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">elem_faces_dirichlet_</a>(elem,f_loc);
                          <span class="keyword">const</span> <span class="keywordtype">int</span> face_loc_j = num_fac_loc(face_bord,0);
                          assert(face_loc_j&gt;=0);
                          assert(face_loc_j&lt;nb_faces_elem);

                          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_i=0; face_loc_i&lt;nb_faces_elem; face_loc_i++)
                            Kij(elem,face_loc_j,face_loc_i)=0;
                        }<span class="comment">//fin du for sur &quot;f_loc&quot;</span>
                    }
<span class="comment">// </span>
<span class="comment">// Fin de la remise a zero</span>
<span class="comment">// </span>

<span class="comment">// </span>
<span class="comment">// Pour retrouver le schema LED</span>
<span class="comment">// </span>
                    {
                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_i=0; face_loc_i&lt;nb_faces_elem; face_loc_i++)
                        {
                          <span class="keywordtype">double</span> sum=0.;
                          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_k=0; face_loc_k&lt;nb_faces_elem; face_loc_k++)
                            {
                              sum+=Kij(elem,face_loc_i,face_loc_k);
                            }
<span class="comment">// Cerr &lt;&lt; &quot;somme apres : &quot; &lt;&lt; sum &lt;&lt; finl;</span>
                          Kij(elem,face_loc_i,face_loc_i)-=sum;<span class="comment">//car div(u)=0!</span>
                        }
                    }
<span class="comment">// </span>
<span class="comment">// Fin du schema LED</span>
<span class="comment">// </span>

                  }<span class="comment">//!&lt; for face  Fin de la modification des coefficients de la matrice </span>
<span class="comment"></span><span class="comment">//</span>
<span class="comment">//</span>
<span class="comment">//</span>

              }<span class="comment">//fin du if sur &quot;volumes_etendus_&quot;</span>

          }<span class="comment">//!&lt; sub_type Dirichlet</span>
<span class="comment"></span>

        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann.html" title="Classe Neumann Cette classe est la classe de base de la hierarchie des conditions aux limites de type...">Neumann</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__homogene.html" title="Classe Neumann_homogene Cette classe est la classe de base de la hierarchie des conditions aux limite...">Neumann_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__val__ext.html" title="Classe Neumann_val_ext Cette classe est la classe de base de la hierarchie des conditions aux limites...">Neumann_val_ext</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
          {
<span class="comment">// On ne fait rien</span>
          }<span class="comment">//fin du if sur Neumann</span>

        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classSymetrie.html" title="classe Symetrie Sur les faces de symetrie on a les proprietes suivantes: - composante normale de la v...">Symetrie</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
          {
<span class="comment">// On ne fait rien</span>
          }<span class="comment">//fin du if sur Symetrie</span>

        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
          {
<span class="comment">// On ne fait rien</span>
          }<span class="comment">//fin du if sur Periodique</span>

        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classEchange__impose__base.html" title="classe Echange_impose_base: Cette condition limite sert uniquement pour l&#39;equation d&#39;energie...">Echange_impose_base</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
          {
<span class="comment">// On ne fait rien</span>
          }<span class="comment">//fin du if sur Echange_impose_base</span>

        <span class="keywordflow">else</span>
          {
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur Op_Conv_EF_VEF_P1NC_Stab::calculer_coefficients_operateur_centre()&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Condition aux limites &quot;</span> &lt;&lt; la_cl.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; non codee.&quot;</span>   &lt;&lt; finl;
            <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Sortie du programme.&quot;</span> &lt;&lt; finl;
            <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
          }<span class="comment">//fin du else sur les autres conditions aux limites</span>

      }<span class="comment">//fin des conditions aux limites</span>
  }

<span class="comment">// </span>
<span class="comment">// Fin de la correction des Kij</span>
<span class="comment">// </span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a483b58e139830af331d1abcd63f2e834"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::calculer_data_pour_dirichlet" ref="a483b58e139830af331d1abcd63f2e834" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::calculer_data_pour_dirichlet </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02042">2042</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00104">elem_faces_dirichlet_</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00103">elem_nb_faces_dirichlet_</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00066">Front_VF::nb_faces_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>, and <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02104">completer()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();

  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_bord=zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();

<span class="comment">// Dimensionnement et initialisation des attributs</span>
<span class="comment">// REMARQUE : un element ne peut pas avoir plus de</span>
<span class="comment">// (dimension) faces de Dirichlet</span>
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aed3b960a81290a5110ae7ac8f9006fd8">elem_nb_faces_dirichlet_</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_elem_tot);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">elem_faces_dirichlet_</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_elem_tot,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aed3b960a81290a5110ae7ac8f9006fd8">elem_nb_faces_dirichlet_</a>=0;
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">elem_faces_dirichlet_</a>=-1;


  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      <span class="keywordtype">int</span> face, nb_faces_tot=le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();

      <span class="keywordflow">if</span> ( (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
           || (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
         )
        {
<span class="comment">// </span>
<span class="comment">// Remplissage des tableaux</span>
<span class="comment">// </span>
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face&lt;nb_faces_tot; ind_face++)
            {
              face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              <span class="keyword">const</span> <span class="keywordtype">int</span> elem=face_voisins(face,0);
              assert(elem!=-1);

              <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aed3b960a81290a5110ae7ac8f9006fd8">elem_nb_faces_dirichlet_</a>(elem)+=1;
              assert(<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aed3b960a81290a5110ae7ac8f9006fd8">elem_nb_faces_dirichlet_</a>(elem)&lt;=<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>);

              <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">elem_faces_dirichlet_</a>(elem,0)==-1) <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">elem_faces_dirichlet_</a>(elem,0)=face;
              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">elem_faces_dirichlet_</a>(elem,1)==-1) <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">elem_faces_dirichlet_</a>(elem,1)=face;
              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>==3 &amp;&amp; <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">elem_faces_dirichlet_</a>(elem,2)==-1) <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">elem_faces_dirichlet_</a>(elem,2)=face;
              <span class="keywordflow">else</span>
                {
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur Op_Conv_EF_VEF_P1NC_Stab::calculer_data_pour_dirichlet()&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;L&#39;element numero &quot;</span> &lt;&lt; elem &lt;&lt; <span class="stringliteral">&quot; contient plus de &quot;</span>
                       &lt;&lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a> &lt;&lt; <span class="stringliteral">&quot; faces de Dirichlet&quot;</span> &lt;&lt; finl;
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Sortie du programme.&quot;</span> &lt;&lt; finl;
                  <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
                }
            }<span class="comment">//fin du for sur &quot;face&quot;</span>

<span class="comment">// </span>
<span class="comment">// Fin du remplissage des tableaux</span>
<span class="comment">// </span>

        }<span class="comment">//fin du if sur &quot;Dirichlet&quot;</span>

    }<span class="comment">//fin du for sur &quot;n_bord&quot;</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2a5d2defd737046ab7ee6397e476ec8b"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::calculer_flux_bords" ref="a2a5d2defd737046ab7ee6397e476ec8b" args="(const DoubleTab &amp;, const DoubleTab &amp;, const DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::calculer_flux_bords </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>tab_vitesse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00702">702</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Zone__VEF_8h_source.html#l00145">Zone_VEF::face_normales()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Operateur__base_8h_source.html#l00168">Operateur_base::flux_bords_</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="Front__VF_8h_source.html#l00061">Front_VF::nb_faces()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Objet__U_8cpp_source.html#l00132">Objet_U::que_suis_je()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>, and <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>.</p>
<div class="fragment"><pre class="fragment">{

  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF=<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
<span class="preprocessor">#ifndef NDEBUG</span>
<span class="preprocessor"></span>  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; transporteV=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,transporte);
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales=zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_bord = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

<span class="comment">// int elem=0;</span>
  <span class="keywordtype">int</span> facei=0, dim=0, n_bord=0, num1=0,num2=0, ind_face=0;
  <span class="keywordtype">double</span> psc=0.;

  <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;nb_bord; n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      num1 = 0;
      num2 = le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();<span class="comment">//il ne faut boucler que sur les faces reelles ici</span>

      <span class="keywordflow">if</span> ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) )
        {
<span class="comment">// On ne calcule pas le flux aux bords Dirichlet_homogene</span>
        }
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann.html" title="Classe Neumann Cette classe est la classe de base de la hierarchie des conditions aux limites de type...">Neumann</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())
                || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__val__ext.html" title="Classe Neumann_val_ext Cette classe est la classe de base de la hierarchie des conditions aux limites...">Neumann_val_ext</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())
                || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__homogene.html" title="Classe Neumann_homogene Cette classe est la classe de base de la hierarchie des conditions aux limite...">Neumann_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())
                || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classSymetrie.html" title="classe Symetrie Sur les faces de symetrie on a les proprietes suivantes: - composante normale de la v...">Symetrie</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())
                || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classEchange__impose__base.html" title="classe Echange_impose_base: Cette condition limite sert uniquement pour l&#39;equation d&#39;energie...">Echange_impose_base</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())
                || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())
                || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) )
        {
          <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
            {
              facei = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              assert(face_voisins(facei,0)!=-1);
              psc=0.;
              <span class="keywordflow">for</span> (dim=0; dim&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; dim++)
                psc-=tab_vitesse(facei,dim)*face_normales(facei,dim);

              <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
                <a class="code" href="classOperateur__base.html#a451f51b41518ddbc0d3f586a8177d319" title="Tableau contenant les flux sur les bords de l&#39;operateur.">flux_bords_</a>(facei,dim)=psc*transporteV[facei*nb_comp+dim];
            }

        }<span class="comment">//fin du if sur &quot;Neumann&quot;, &quot;Neumann_homogene&quot;, &quot;Symetrie&quot;, &quot;Echange_impose_base&quot;</span>
      <span class="keywordflow">else</span>
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur Op_Conv_EF_VEF_P1NC_Stab::calculer_flux_bords()&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Condition aux limites &quot;</span> &lt;&lt; la_cl.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; non codee.&quot;</span>   &lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Sortie du programme.&quot;</span> &lt;&lt; finl;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
        }<span class="comment">//fin du else sur les autres conditions aux limites</span>
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a49f11cc19b99f1b9ade819f868877381"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::calculer_senseur" ref="a49f11cc19b99f1b9ade819f868877381" args="(const DoubleTab &amp;, const DoubleVect &amp;, const int &amp;, const int &amp;, const IntTab &amp;, const IntTab &amp;, const IntTab &amp;, ArrOfDouble &amp;, ArrOfDouble &amp;, ArrOfDouble &amp;, ArrOfDouble &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::calculer_senseur </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>transporteV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>nb_comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>face_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td>
          <td class="paramname"><em>elem_faces</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td>
          <td class="paramname"><em>face_voisins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td>
          <td class="paramname"><em>num_fac_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;&#160;</td>
          <td class="paramname"><em>P_plus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;&#160;</td>
          <td class="paramname"><em>P_moins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;&#160;</td>
          <td class="paramname"><em>Q_plus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> &amp;&#160;</td>
          <td class="paramname"><em>Q_moins</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00941">941</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, and <a class="el" href="ArrOfDouble_8h_source.html#l00350">ArrOfDouble::size_array()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00845">ajouter_antidiffusion()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02610">ajouter_contribution_antidiffusion()</a>.</p>
<div class="fragment"><pre class="fragment">{
  assert(P_plus.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()==nb_comp);
  assert(Q_plus.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()==nb_comp);
  assert(P_moins.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()==nb_comp);
  assert(Q_moins.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()==nb_comp);
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem_voisin=0; elem_voisin&lt;2; elem_voisin++)
    {
      <span class="keywordtype">int</span> elem = face_voisins(face_i,elem_voisin);
      <span class="keywordflow">if</span> (elem!=-1)
        {
          <span class="keywordtype">int</span> face_i_loc = num_fac_loc(face_i,elem_voisin);
          assert(face_i_loc&gt;=0);
          assert(face_i_loc&lt;nb_faces_elem);
<span class="comment">// On travaille sur les faces de &quot;elem&quot;</span>
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_k_loc=0; face_k_loc&lt;nb_faces_elem; face_k_loc++)
            {
              <span class="keywordtype">int</span> face_k=elem_faces(elem,face_k_loc);
              <span class="keywordtype">double</span> kik=Kij(elem,face_i_loc,face_k_loc);
<span class="comment">// </span>
<span class="comment">// Calcul des variables intermediaires</span>
<span class="comment">// </span>
              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dim=0; dim&lt;nb_comp; dim++)
                {
                  <span class="keywordtype">double</span> deltaki = transporteV[face_k*nb_comp+dim]-transporteV[face_i*nb_comp+dim];
                  <span class="comment">/* Codage initial:</span>
<span class="comment">                     P_plus(dim)+=minimum(0.,kik)*minimum(0.,deltaki);</span>
<span class="comment">                     P_moins(dim)+=minimum(0.,kik)*maximum(0.,deltaki);</span>
<span class="comment">                     Q_plus(dim)+=maximum(0.,kik)*maximum(0.,deltaki);</span>
<span class="comment">                     Q_moins(dim)+=maximum(0.,kik)*minimum(0.,deltaki);</span>
<span class="comment">// Calcul de P_plus et P_moins</span>
<span class="comment">// Calcul de Q_plus et Q_moins</span>
<span class="comment">                  */</span>
<span class="comment">// Codage optimise:</span>
                  <span class="keywordtype">double</span> tmp = kik*deltaki;
                  <span class="keywordflow">if</span> (kik&gt;0)
                    {
                      <span class="keywordflow">if</span> (tmp&gt;0) Q_plus(dim)+=tmp;
                      <span class="keywordflow">else</span>       Q_moins(dim)+=tmp;
                    }
                  <span class="keywordflow">else</span>
                    {
                      <span class="keywordflow">if</span> (tmp&gt;0) P_plus(dim)+=tmp;
                      <span class="keywordflow">else</span>       P_moins(dim)+=tmp;
                    }
                  assert(P_plus(dim)&gt;=0);
                  assert(Q_plus(dim)&gt;=0);
                  assert(P_moins(dim)&lt;=0);
                  assert(Q_moins(dim)&lt;=0);
                }<span class="comment">//fin du for sur &quot;dim&quot;</span>
<span class="comment">// </span>
<span class="comment">// Fin du calcul des variables intermediaires</span>
<span class="comment">// </span>
            }<span class="comment">//fin du for sur &quot;face_k_loc&quot;</span>
        }<span class="comment">//fin du if sur &quot;elem!=-1&quot;</span>
    }<span class="comment">//fin du for sur &quot;elem_voisin&quot;</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="ada87b91828b2a25c45b299cce3e8e26a"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::completer" ref="ada87b91828b2a25c45b299cce3e8e26a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::completer </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Associe l'operateur a la zone_dis, la zone_Cl_dis,<br/>
et a l'inconnue de son equation. </p>

<p><p>&lt; pour ajout _Mx (moment) </p>
</p>

<p>Reimplemented from <a class="el" href="classOperateur__base.html#a9560967884361b918b12a67813476608">Operateur_base</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02104">2104</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00110">alpha_</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00123">alpha_ssz</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00106">alpha_tab</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00107">beta</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02042">calculer_data_pour_dirichlet()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Probleme__base_8cpp_source.html#l01393">Probleme_base::domaine()</a>, <a class="el" href="MorEqn_8h_source.html#l00082">MorEqn::equation()</a>, <a class="el" href="Objet__U_8cpp_source.html#l00330">Objet_U::est_egal_a()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00120">la_sous_zone_dis</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Sous__zone__VF_8h_source.html#l00065">Sous_zone_VF::les_faces()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00122">nb_ssz_alpha</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00119">nom_sous_zone</a>, <a class="el" href="Domaine__dis_8h_source.html#l00056">Domaine_dis::nombre_de_sous_zones_dis()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00124">noms_ssz_alpha</a>, <a class="el" href="Equation__base_8cpp_source.html#l00964">Equation_base::probleme()</a>, <a class="el" href="Ref_8h_source.html#l00026">REF</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="ArrOfDouble_8h_source.html#l00244">ArrOfDouble::resize_array()</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00117">sous_zone</a>, <a class="el" href="Domaine__dis_8h_source.html#l00060">Domaine_dis::sous_zone_dis()</a>, <a class="el" href="Domaine_8h_source.html#l00373">Domaine::ss_zone()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00125">ssz_alpha</a>, <a class="el" href="Ref__Sous__zone__VF_8h_source.html#l00028">Ref_Sous_zone_VF::valeur()</a>, and <a class="el" href="Sous__zone__dis_8h_source.html#l00028">Deriv_Sous_zone_dis_base::valeur()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ada87b91828b2a25c45b299cce3e8e26a" title="Associe l&#39;operateur a la zone_dis, la zone_Cl_dis, et a l&#39;inconnue de son equation.">Op_Conv_VEF_Face::completer</a>();
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a483b58e139830af331d1abcd63f2e834">calculer_data_pour_dirichlet</a>();

<span class="comment">// int nb_comp=1;</span>
<span class="comment">// if (equation().inconnue().valeurs().nb_dim()&gt;1)</span>
<span class="comment">// nb_comp=equation().inconnue().valeurs().dimension(1);</span>

<span class="comment">// limiteurs_.resize(la_zone_vef-&gt;nb_faces_tot(),nb_comp);</span>
<span class="comment">// limiteurs_=0.;</span>

  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>.<a class="code" href="classArrOfDouble.html#a610464f4b3dccac6f814915b526783ed">resize_array</a>(<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>-&gt;nb_faces_tot());
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a> = <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a515503fe50ac73fb7f86363fea4ee594">alpha_</a>;
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac1b44ec3559d53eaf94d49b3e029ae4b" title="vaut zero pour les faces ou l&#39;on souhaite degenerer en Amont. mutable DoubleTab limiteurs_;//tableau ...">beta</a>.<a class="code" href="classArrOfDouble.html#a610464f4b3dccac6f814915b526783ed">resize_array</a>(<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>-&gt;nb_faces_tot());
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac1b44ec3559d53eaf94d49b3e029ae4b" title="vaut zero pour les faces ou l&#39;on souhaite degenerer en Amont. mutable DoubleTab limiteurs_;//tableau ...">beta</a>=1.;

  <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aebf5d2735a227a53fd44c9df6042b10d">ssz_alpha</a>)
    {
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac6dad1bca9e67b647241a2c17b1d9998">nb_ssz_alpha</a>; i++)
        {
          <a class="code" href="Ref_8h.html#aab5720a5c34da14028d0745e386aaa01">REF</a>(<a class="code" href="classSous__zone__VF.html">Sous_zone_VF</a>) la_ssz;
          const <a class="code" href="classSous__Zone.html" title="Classe Sous_Zone Represente une sous zone volumique i.e un sous ensemble de polyedres d&#39;un objet de t...">Sous_Zone</a>&amp; la_sous_zone=<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().probleme().domaine().ss_zone(<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a902ac33a37f9a30d97206c9d9a9acadf">noms_ssz_alpha</a>[i]);
          const <a class="code" href="classDomaine__dis.html">Domaine_dis</a>&amp; le_domaine_dis=<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>-&gt;domaine_dis();
          <span class="keywordtype">bool</span> trouve=false;
          for (<span class="keywordtype">int</span> ssz=0; ssz&lt;le_domaine_dis.nombre_de_sous_zones_dis(); ssz++)
            {
              <span class="keywordflow">if</span> (le_domaine_dis.sous_zone_dis(ssz)-&gt;sous_zone().est_egal_a(la_sous_zone))
                {
                  trouve=<span class="keyword">true</span>;
                  la_ssz=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSous__zone__VF.html">Sous_zone_VF</a>,le_domaine_dis.sous_zone_dis(ssz).valeur());
                }
            }

          <span class="keywordflow">if</span>(!trouve)
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On ne trouve pas la sous_zone discretisee associee a &quot;</span> &lt;&lt; <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a902ac33a37f9a30d97206c9d9a9acadf">noms_ssz_alpha</a>[i] &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
              <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
            }
          <span class="keyword">const</span> <a class="code" href="classSous__zone__VF.html">Sous_zone_VF</a>&amp; ssz=la_ssz.valeur();
          <span class="keywordtype">int</span> nb_faces = ssz.<a class="code" href="classSous__zone__VF.html#a225bbd841aa3d6705e5a196ceac09a6a">les_faces</a>().<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>();

          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=0; face&lt;nb_faces; face++)
            {
              <span class="keywordtype">int</span> la_face=ssz.<a class="code" href="classSous__zone__VF.html#a225bbd841aa3d6705e5a196ceac09a6a">les_faces</a>()[face];
              <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac1b44ec3559d53eaf94d49b3e029ae4b" title="vaut zero pour les faces ou l&#39;on souhaite degenerer en Amont. mutable DoubleTab limiteurs_;//tableau ...">beta</a>(la_face) = 1.;
              <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(la_face) = <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aedd6723f68a86c7ff13cb281c5ecb03b">alpha_ssz</a>(i);
            }
        }
    }




  <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a13400182e7ede0cc88d147e934b1cd1d" title="Cas d&#39;une sous-zone a definir pour que l&#39;EF_Stab degenere en Amont.">sous_zone</a>)
    {
      <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a13400182e7ede0cc88d147e934b1cd1d" title="Cas d&#39;une sous-zone a definir pour que l&#39;EF_Stab degenere en Amont.">sous_zone</a>=<span class="keyword">false</span>;
      <span class="keyword">const</span> <a class="code" href="classSous__Zone.html" title="Classe Sous_Zone Represente une sous zone volumique i.e un sous ensemble de polyedres d&#39;un objet de t...">Sous_Zone</a>&amp; la_sous_zone=<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#afa73c54a5b6b111e0f08cd1ab3608178" title="Renvoie le domaine associe au probleme. (version const)">domaine</a>().<a class="code" href="classDomaine.html#ad38f4fc3c0e1b44dc9fdc947985178a5" title="Renvoie la i-ieme sous-zone. (version const)">ss_zone</a>(<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af0f2ade834ec7306b493e72c80f1aca1">nom_sous_zone</a>);
      <span class="keyword">const</span> <a class="code" href="classDomaine__dis.html">Domaine_dis</a>&amp; le_domaine_dis=<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>-&gt;domaine_dis();
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ssz=0; ssz&lt;le_domaine_dis.<a class="code" href="classDomaine__dis.html#a5c9b9b7a50ef289e8e21eab8fbc3cd59">nombre_de_sous_zones_dis</a>(); ssz++)
        {
          <span class="keywordflow">if</span> (le_domaine_dis.<a class="code" href="classDomaine__dis.html#a68da87b6c22915b52ea1ea7e796b6569">sous_zone_dis</a>(ssz)-&gt;sous_zone().<a class="code" href="classObjet__U.html#a2f971749d04905572135930932f4bde3" title="Renvoie 1 si l&#39;objet x et *this sont une seule et meme instance&lt;br&gt;(meme adresse en memoire)...">est_egal_a</a>(la_sous_zone))
            {
              <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a13400182e7ede0cc88d147e934b1cd1d" title="Cas d&#39;une sous-zone a definir pour que l&#39;EF_Stab degenere en Amont.">sous_zone</a>=<span class="keyword">true</span>;
              <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a99b6274ae7744713950dbf600509b053">la_sous_zone_dis</a>=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSous__zone__VF.html">Sous_zone_VF</a>,le_domaine_dis.<a class="code" href="classDomaine__dis.html#a68da87b6c22915b52ea1ea7e796b6569">sous_zone_dis</a>(ssz).<a class="code" href="classDeriv__Sous__zone__dis__base.html#a50a9f40b6a7e9fb50d29cca81c297a97">valeur</a>());
            }
        }

      <span class="keywordflow">if</span>(!<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a13400182e7ede0cc88d147e934b1cd1d" title="Cas d&#39;une sous-zone a definir pour que l&#39;EF_Stab degenere en Amont.">sous_zone</a>)
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On ne trouve pas la sous_zone discretisee associee a &quot;</span> &lt;&lt; <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af0f2ade834ec7306b493e72c80f1aca1">nom_sous_zone</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
        }

      <span class="keyword">const</span> <a class="code" href="classSous__zone__VF.html">Sous_zone_VF</a>&amp; ssz=<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a99b6274ae7744713950dbf600509b053">la_sous_zone_dis</a>.<a class="code" href="classRef__Sous__zone__VF.html#a9fee3162fd9657393bc56cd5eb30a58e">valeur</a>();
      <span class="keywordtype">int</span> nb_faces = ssz.<a class="code" href="classSous__zone__VF.html#a225bbd841aa3d6705e5a196ceac09a6a">les_faces</a>().<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>();

      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=0; face&lt;nb_faces; face++)
        {
          <span class="keywordtype">int</span> la_face=ssz.<a class="code" href="classSous__zone__VF.html#a225bbd841aa3d6705e5a196ceac09a6a">les_faces</a>()[face];
          <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac1b44ec3559d53eaf94d49b3e029ae4b" title="vaut zero pour les faces ou l&#39;on souhaite degenerer en Amont. mutable DoubleTab limiteurs_;//tableau ...">beta</a>(la_face) = 0.;
          <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">alpha_tab</a>(la_face) = 1.;
        }
    }

}
</pre></div>
</div>
</div>
<a class="anchor" id="ae88c01c5bab6101cc73c18023db6f55b"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::contribuer_a_avec" ref="ae88c01c5bab6101cc73c18023db6f55b" args="(const DoubleTab &amp;, Matrice_Morse &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::contribuer_a_avec </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>inco</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>matrice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>on assemble la matrice des inconnues implicite. </p>

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#a27f891883f7b38b525b59d38d3f97ef3">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00129">129</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02191">ajouter_contribution()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a25b8ce54605b7783a8d7078a932e4187">ajouter_contribution</a>(inco, matrice);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0bc0e96870fa11143a92dcbeb2a36ec6"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::cree_instance" ref="a0bc0e96870fa11143a92dcbeb2a36ec6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classObjet__U.html">Objet_U</a> * Op_Conv_EF_VEF_P1NC_Stab::cree_instance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#a95e421a79f78a63f6fc31001e480b801">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00038">38</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1b807c5a31fa60c909ebe69e81a2adc4"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::duplique" ref="a1b807c5a31fa60c909ebe69e81a2adc4" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Op_Conv_EF_VEF_P1NC_Stab::duplique </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#a730ff7f720a85346c2e64d887d2e83a3">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00038">38</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a1c79230221c8b7758076fa691e5b39c5"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::get_info" ref="a1c79230221c8b7758076fa691e5b39c5" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a> * Op_Conv_EF_VEF_P1NC_Stab::get_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Donne des informations sur le type de l'Objet_U. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>const Type_info*<br/>
 Signification: structure regroupant les informations sur le type de l'Objet_U<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#a7956413d25ad3f47537c18be89fa8a93">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00038">38</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a3507906fb3da346af9d9b6d23fccefa0"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::info" ref="a3507906fb3da346af9d9b6d23fccefa0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a> * Op_Conv_EF_VEF_P1NC_Stab::info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Donne des informations sur le type de l'Objet_U. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>const Type_info*<br/>
 Signification: structure regroupant les informations sur le type de l'Objet_U<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#a96dd257161111f4a1bc7028456c16da4">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00038">38</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a47038cfd3c5fd1d0bbc4e61bc0d58d9d"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::is_compressible" ref="a47038cfd3c5fd1d0bbc4e61bc0d58d9d" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Op_Conv_EF_VEF_P1NC_Stab::is_compressible </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00135">135</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00112">is_compressible_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a5ed7b641e615d0a8fea46aaf3eaaad3b">is_compressible_</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab106a70062c1831cca041196080bdeaf"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::mettre_a_jour_pour_periodicite" ref="ab106a70062c1831cca041196080bdeaf" args="(DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::mettre_a_jour_pour_periodicite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em></td><td>)</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01562">1562</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="Periodique_8h_source.html#l00056">Periodique::face_associee()</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="DoubleTab_8h_source.html#l00264">DoubleTab::nb_dim()</a>, <a class="el" href="Front__VF_8h_source.html#l00061">Front_VF::nb_faces()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, and <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01169">test_difference_resu()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">test_implicite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_bord = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp = (resu.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>()==1) ? 1 : resu.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
  <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resuV=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,resu);
  <span class="keywordtype">int</span> ligne=0,ligneAss=0,facei=0,faceiAss=0, ind_face=0;
  <span class="keywordtype">int</span> num1=0,num2=0, ind_face_associee=0, dim=0;

<span class="comment">// Faces de bord</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      num1=0;
      num2=le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();

      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());

          <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
            {
              facei=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              ind_face_associee=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(ind_face);
              faceiAss=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face_associee);

              <span class="keywordflow">if</span> (facei&lt;faceiAss)
                <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
                  {
                    ligne=facei*nb_comp+dim;
                    ligneAss=faceiAss*nb_comp+dim;

                    resuV[ligneAss]+=resuV[ligne];
                    resuV[ligne]=resuV[ligneAss];
                  }

            }<span class="comment">//fin du for sur &quot;face_i&quot;</span>

        }<span class="comment">//fin du if sur &quot;Periodique&quot;</span>

    }<span class="comment">//fin du for sur &quot;n_bord&quot;</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="af4230688a46b05442654639fb87b1a14"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::modifier_pour_Cl" ref="af4230688a46b05442654639fb87b1a14" args="(Matrice_Morse &amp;, DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::modifier_pour_Cl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMatrice__Morse.html">Matrice_Morse</a> &amp;&#160;</td>
          <td class="paramname"><em>matrice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>secmem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>On modifie le second membre et la matrice dans le cas des<br/>
conditions de dirichlet. </p>

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#aa087b349430a7cd7fd4ef64670dad088">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02231">2231</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af4230688a46b05442654639fb87b1a14" title="On modifie le second membre et la matrice dans le cas des conditions de dirichlet.">Op_Conv_VEF_Face::modifier_pour_Cl</a>(matrice,secmem);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a603ebee3d7bebc91e571c828355a13ff"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::printOn" ref="a603ebee3d7bebc91e571c828355a13ff" args="(Sortie &amp;x) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSortie.html">Sortie</a> &amp; Op_Conv_EF_VEF_P1NC_Stab::printOn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td> const<code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>NE FAIT RIEN<br/>
A surcharger dans les classes derivees. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp;<br/>
 Signification: le flot de sortie<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#a8eacb11670d5ea5cc15ed16632d15360">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00044">44</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Objet__U_8cpp_source.html#l00132">Objet_U::que_suis_je()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a902293420aedb4314065a6855089ac7e"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::readOn" ref="a902293420aedb4314065a6855089ac7e" args="(Entree &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEntree.html">Entree</a> &amp; Op_Conv_EF_VEF_P1NC_Stab::readOn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEntree.html">Entree</a> &amp;&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>NE FAIT RIEN<br/>
A surcharger dans les classes derivees. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp;<br/>
 Signification: le flot d'entree<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#a20514a9862bc5e8a557eadc1b8860a2a">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">52</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00110">alpha_</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00123">alpha_ssz</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="vect__impl_8cpp_source.html#l00145">vect_impl::dimensionner()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00112">is_compressible_</a>, <a class="el" href="Process_8cpp_source.html#l00095">Process::je_suis_maitre()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00122">nb_ssz_alpha</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00118">new_jacobienne_</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00119">nom_sous_zone</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00124">noms_ssz_alpha</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00114">old_</a>, <a class="el" href="DoubleVect_8h_source.html#l00193">DoubleVect::resize()</a>, <a class="el" href="Motcle_8cpp_source.html#l00538">Motcles::search()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00117">sous_zone</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00125">ssz_alpha</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00113">test_</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00115">volumes_etendus_</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Les mots a reconnaitre</span>
  <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> motlu, accouverte = <span class="stringliteral">&quot;{&quot;</span> , accfermee = <span class="stringliteral">&quot;}&quot;</span> ;
  <a class="code" href="classMotcles.html" title="Un tableau d&#39;objets de la classe Motcle.">Motcles</a> les_mots(9);
  {
    les_mots[0] = <span class="stringliteral">&quot;alpha&quot;</span>;
    les_mots[1] = <span class="stringliteral">&quot;test&quot;</span>;
    les_mots[2] = <span class="stringliteral">&quot;TdivU&quot;</span>;
    les_mots[3] = <span class="stringliteral">&quot;old&quot;</span>;
    les_mots[4] = <span class="stringliteral">&quot;volumes_etendus&quot;</span>;
    les_mots[5] = <span class="stringliteral">&quot;volumes_non_etendus&quot;</span>;
    les_mots[6] = <span class="stringliteral">&quot;amont_sous_zone&quot;</span>;
    les_mots[7] = <span class="stringliteral">&quot;nouvelle_matrice_implicite&quot;</span>;
    les_mots[8] = <span class="stringliteral">&quot;alpha_sous_zone&quot;</span>;
  }

<span class="comment">// Les variables a instancier</span>
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a515503fe50ac73fb7f86363fea4ee594">alpha_</a>=1.;
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af913e1b9445b37211f13e9bf5c01d92e">test_</a>=0;
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a5ed7b641e615d0a8fea46aaf3eaaad3b">is_compressible_</a>=0;
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#add33e5ac4396a277bfeca3638cf7a585">old_</a>=0;
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a0fa21a81e6deda452a87699846cc1cd6">volumes_etendus_</a>=1;
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a13400182e7ede0cc88d147e934b1cd1d" title="Cas d&#39;une sous-zone a definir pour que l&#39;EF_Stab degenere en Amont.">sous_zone</a>=<span class="keyword">false</span>;
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aebf5d2735a227a53fd44c9df6042b10d">ssz_alpha</a>=<span class="keyword">false</span>;
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a8b4181342631eedf901e574b5e9e4474">new_jacobienne_</a>=0;
  s &gt;&gt; motlu;
  <span class="keywordflow">if</span> (motlu!=accouverte)
    {
      <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur Op_Conv_EF_VEF_P1NC_Stab::readOn()&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Depuis la 1.5.3, la syntaxe du mot cle EF_stab a change.&quot;</span> &lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Il faut commencer par une accolade ouvrante {&quot;</span> &lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;et les options eventuelles sont entre les accolades:&quot;</span> &lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Convection { EF_stab } -&gt; Convection { EF_stab { } }&quot;</span> &lt;&lt; finl;
        }
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }
  s &gt;&gt; motlu;

  <span class="keywordflow">while</span>(motlu!=accfermee)
    {
      <span class="keywordtype">int</span> rang=les_mots.search(motlu);

      <span class="keywordflow">switch</span>(rang)
        {
        <span class="keywordflow">case</span> 0 :

          s &gt;&gt; <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a515503fe50ac73fb7f86363fea4ee594">alpha_</a>;
          <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> 1 :

          <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af913e1b9445b37211f13e9bf5c01d92e">test_</a>=1;
          <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> 2 :

          <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a5ed7b641e615d0a8fea46aaf3eaaad3b">is_compressible_</a>=1;
          <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> 3 :

          <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#add33e5ac4396a277bfeca3638cf7a585">old_</a>=1;
          <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> 4 :

          <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a0fa21a81e6deda452a87699846cc1cd6">volumes_etendus_</a>=1;
          <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> 5 :

          <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a0fa21a81e6deda452a87699846cc1cd6">volumes_etendus_</a>=0;
          <span class="keywordflow">break</span>;

        <span class="keywordflow">case</span> 6 :
          <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a13400182e7ede0cc88d147e934b1cd1d" title="Cas d&#39;une sous-zone a definir pour que l&#39;EF_Stab degenere en Amont.">sous_zone</a>=<span class="keyword">true</span>;
          s &gt;&gt; <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af0f2ade834ec7306b493e72c80f1aca1">nom_sous_zone</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> 7 :
          s &gt;&gt; <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a8b4181342631eedf901e574b5e9e4474">new_jacobienne_</a>;
          <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> 8 :
          <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aebf5d2735a227a53fd44c9df6042b10d">ssz_alpha</a>=<span class="keyword">true</span>;
          s &gt;&gt; <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac6dad1bca9e67b647241a2c17b1d9998">nb_ssz_alpha</a>;
          <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a902ac33a37f9a30d97206c9d9a9acadf">noms_ssz_alpha</a>.<a class="code" href="classvect__impl.html#ad841d6b676a796bae26ed2566b7b3b41">dimensionner</a>(nb_ssz_alpha);
          <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aedd6723f68a86c7ff13cb281c5ecb03b">alpha_ssz</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_ssz_alpha);
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac6dad1bca9e67b647241a2c17b1d9998">nb_ssz_alpha</a>; i++)
            {
              s&gt;&gt;<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a902ac33a37f9a30d97206c9d9a9acadf">noms_ssz_alpha</a>[i];
              s&gt;&gt;<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aedd6723f68a86c7ff13cb281c5ecb03b">alpha_ssz</a>(i);
            }
          <span class="keywordflow">break</span>;
        <span class="keywordflow">default</span> :

          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur Op_Conv_EF_VEF_P1NC_Stab::readOn()&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Mot clef &quot;</span> &lt;&lt; motlu &lt;&lt; <span class="stringliteral">&quot; non connu.&quot;</span> &lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Sortie du programme.&quot;</span> &lt;&lt; finl;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
          <span class="keywordflow">break</span>;

        }<span class="comment">//fin du switch</span>

<span class="comment">// Suite de la lecture</span>
      s &gt;&gt; motlu;

    }<span class="comment">//fin du while</span>

  <span class="keywordflow">return</span> s ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a23d5e4497b9f329921e370a3208ff9fc"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::reinit_conv_pour_Cl" ref="a23d5e4497b9f329921e370a3208ff9fc" args="(const DoubleTab &amp;, const IntList &amp;, const DoubleTabs &amp;, const DoubleTab &amp;, DoubleTab &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::reinit_conv_pour_Cl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classIntList.html">IntList</a> &amp;&#160;</td>
          <td class="paramname"><em>faces</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTabs.html">DoubleTabs</a> &amp;&#160;</td>
          <td class="paramname"><em>valeurs_faces</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>tab_vitesse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00271">271</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone__VEF_8h_source.html#l00145">Zone_VEF::face_normales()</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="Front__VF_8h_source.html#l00066">Front_VF::nb_faces_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Neumann__sortie__libre_8cpp_source.html#l00138">Neumann_sortie_libre::val_ext()</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>, and <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF=<a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF=<a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales=zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_bord=zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=transporte.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
  <span class="keywordtype">int</span> n_bord=0, num1=0, num2=0, ind_face=0,facei=0, dim=0;
  <span class="keywordtype">double</span> psc=0.;

  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; transporteV=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,transporte);

<span class="comment">// Boucle pour dimensionner la liste &quot;faces&quot;</span>
  <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;nb_bord; n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      num1 = 0;
      num2 = le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();

      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keyword">const</span> <a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>&amp; la_sortie_libre
            = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classNeumann__sortie__libre.html" title="classe Neumann_sortie_libre Cette classe represente une frontiere ouverte sans vitesse imposee Pour l...">Neumann_sortie_libre</a>, la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());

          <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
            {
              facei = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);

              psc=0.;
              <span class="keywordflow">for</span> (dim=0; dim&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; dim++)
                psc-=tab_vitesse(facei,dim)*face_normales(facei,dim);

              <span class="keywordflow">if</span> (psc&gt;0)
                <span class="keywordflow">for</span> (dim=0; dim&lt;nb_comp; dim++)
                  resu(facei,dim)+=psc*(la_sortie_libre.<a class="code" href="classNeumann__sortie__libre.html#a886f1804fa2a9028fc56a0778a72a75d" title="Renvoie la valeur de la i-eme composante du champ impose a l&#39;exterieur de la frontiere.">val_ext</a>(facei-num1,dim)-transporteV[facei*nb_comp+dim]);

            }
        }<span class="comment">//fin du if sur &quot;Neumann_sortie_libre&quot;</span>
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1c6a846b83bbf93ffaddfe6b0f040fe1"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::remplir_fluent" ref="a1c6a846b83bbf93ffaddfe6b0f040fe1" args="(DoubleVect &amp;) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::remplir_fluent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>fluent_</em></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#a1fcf6b33ff3ee706ffef89a117e2f54a">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00528">528</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone__VEF_8h_source.html#l00145">Zone_VEF::face_normales()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__VF_8h_source.html#l00519">Zone_VF::nb_faces()</a>, <a class="el" href="Ref__Champ__Inc__base_8h_source.html#l00028">Ref_Champ_Inc_base::valeur()</a>, <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>, <a class="el" href="Champ__Inc__base_8cpp_source.html#l00221">Champ_Inc_base::valeurs()</a>, and <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00094">Op_Conv_VEF_base::vitesse_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; la_vitesse=<a class="code" href="classOp__Conv__VEF__base.html#a5547875832fb45e09b1115372fb76ffd">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_vitesse=la_vitesse.<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales=zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces = zone_VEF.<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
<span class="comment">// calcul de la CFL.</span>
  <span class="keywordtype">double</span> psc;
<span class="comment">// On remet a zero le tableau qui sert pour</span>
<span class="comment">// le calcul du pas de temps de stabilite</span>
  fluent_ = 0;

  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> num_face=0; num_face&lt;nb_faces; num_face++)
    {
      psc=0.;
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++)
        psc+=tab_vitesse(num_face,i)*face_normales(num_face,i);
      fluent_(num_face)=<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(psc);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a19f131f7e109c2715031324fa9c116f9"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::self_cast" ref="a19f131f7e109c2715031324fa9c116f9" args="(Objet_U &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html">Op_Conv_EF_VEF_P1NC_Stab</a> &amp; Op_Conv_EF_VEF_P1NC_Stab::self_cast </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classObjet__U.html">Objet_U</a> &amp;&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#aaf796aa5e9861e15db4afb2db07d6e12">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00038">38</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a72ce7a8fd1825b07a59f1eb8fddd656f"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::self_cast" ref="a72ce7a8fd1825b07a59f1eb8fddd656f" args="(const Objet_U &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html">Op_Conv_EF_VEF_P1NC_Stab</a> &amp; Op_Conv_EF_VEF_P1NC_Stab::self_cast </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classObjet__U.html">Objet_U</a> &amp;&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>methode ajoutee pour caster en python </p>

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#a137b0427f8ba4a591de409481c8e54d4">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00038">38</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aa7fe145018f53089c26323d64b1cd808"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::taille_memoire" ref="aa7fe145018f53089c26323d64b1cd808" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned Op_Conv_EF_VEF_P1NC_Stab::taille_memoire </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#a0425dbae6b4c7a815392e6e4ae50861d">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00038">38</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a17c05c25fb60782de56829f75478f094"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::test" ref="a17c05c25fb60782de56829f75478f094" args="(const DoubleTab &amp;, const DoubleTab &amp;, const DoubleTab &amp;vitesse) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::test </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vitesse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01004">1004</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01021">test_difference_Kij()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01169">test_difference_resu()</a>, and <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Kij2(nb_elem_tot,nb_faces_elem, nb_faces_elem);
  Kij2=0.;

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Kij_ancien(nb_elem_tot,nb_faces_elem, nb_faces_elem);
  Kij_ancien=0.;

  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#acc4bfd43f8e442a185a5310a22b8176e">test_difference_Kij</a>(transporte,Kij2,Kij_ancien,tab_vitesse);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af6c40b1ce58622e73b53f011fbb0f0e5">test_difference_resu</a>(Kij2,Kij_ancien,transporte,resu,tab_vitesse);
}
</pre></div>
</div>
</div>
<a class="anchor" id="acc4bfd43f8e442a185a5310a22b8176e"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::test_difference_Kij" ref="acc4bfd43f8e442a185a5310a22b8176e" args="(const DoubleTab &amp;, DoubleTab &amp;, DoubleTab &amp;, const DoubleTab &amp;vitesse) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::test_difference_Kij </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij_ancien</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vitesse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01021">1021</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00313">calculer_coefficients_operateur_centre()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Champ__P1iP1B__implementation_8cpp_source.html#l00331">coeff</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Zone__VEF_8h_source.html#l00145">Zone_VEF::face_normales()</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00829">local_max_abs_vect()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="DoubleTab_8h_source.html#l00264">DoubleTab::nb_dim()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00066">Front_VF::nb_faces_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>, <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00115">volumes_etendus_</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01004">test()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
<span class="comment">// const Champ_P1NC&amp; la_vitesse=ref_cast( Champ_P1NC, vitesse_.valeur());</span>
<span class="comment">// const DoubleTab&amp; vitesse=la_vitesse.valeurs();</span>

  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; face_normales=zone_VEF.<a class="code" href="classZone__VEF.html#a5742d75972e4846bf9fbb6ed5715053e">face_normales</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();

  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp = (transporte.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>()!=1) ? transporte.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) : 1;
  <span class="keywordtype">int</span> face_i0, face_j0, elem0, comp;

  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a3c1c70e249ebd12239c7987a4e50d277">calculer_coefficients_operateur_centre</a>(Kij,nb_comp,tab_vitesse);

<span class="comment">// </span>
<span class="comment">// Calcul des Kij_ancien :</span>
<span class="comment">// </span>
  <span class="keywordflow">for</span>(elem0=0; elem0&lt;nb_elem_tot; elem0++)
    {
      <span class="keywordtype">int</span> face_loci=0;
      <span class="keywordtype">int</span> face_locj=0;
      <span class="keywordflow">for</span>(; face_loci&lt;nb_faces_elem; face_loci++)
        {
          face_i0=elem_faces(elem0,face_loci);
          <span class="keywordtype">double</span> signei=1.0;
          <span class="keywordflow">if</span>(face_voisins(face_i0,0)!=elem0)
            signei=-1.0;
          <span class="keywordtype">double</span> psci=0;
          <span class="keywordflow">for</span>(comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
            psci+=tab_vitesse(face_i0,comp)*face_normales(face_i0,comp);
          psci*=signei;
<span class="comment">// Kij_ancien(elem,face_loci,face_loci)=0.;</span>
          <span class="keywordflow">for</span>(face_locj=face_loci+1; face_locj&lt;nb_faces_elem; face_locj++)
            {
              face_j0=elem_faces(elem0,face_locj);
              <span class="keywordtype">double</span> signej=1.0;
              <span class="keywordflow">if</span>(face_voisins(face_j0,0)!=elem0)
                signej=-1.0;

              <span class="keywordtype">double</span> pscj=0;
<span class="comment">// psci=0;</span>
              <span class="keywordflow">for</span>(comp=0; comp&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; comp++)
                pscj+=tab_vitesse(face_j0,comp)*face_normales(face_j0,comp);
              pscj*=signej;
              Kij_ancien(elem0,face_loci,face_locj)=-1./nb_faces_elem*pscj;
              Kij_ancien(elem0,face_loci,face_loci)+=1./nb_faces_elem*pscj;
              Kij_ancien(elem0,face_locj,face_loci)=-1./nb_faces_elem*psci;
              Kij_ancien(elem0,face_locj,face_locj)+=1./nb_faces_elem*psci;
            }
        }
    }
<span class="comment">// Correction des Kij_ancien pour Dirichlet !</span>
  {
    <span class="keywordtype">int</span> nb_bord=zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
    <span class="keywordtype">int</span> face;
    <span class="keywordtype">double</span> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>=1./<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>;
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
      {
        <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
        <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
        <span class="keywordtype">int</span> nb_faces_tot=le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();

        <span class="keywordflow">if</span> ( (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
             || (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
           )
          {
            <span class="keywordflow">if</span> ( <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a0fa21a81e6deda452a87699846cc1cd6">volumes_etendus_</a> )
              {
                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=0; ind_face&lt;nb_faces_tot; ind_face++)
                  {
                    face = le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
                    <span class="keywordtype">int</span> elem=face_voisins(face,0);
                    assert(elem!=-1);
                    <span class="keywordtype">int</span> face_loc_j;
                    <span class="keywordtype">int</span> face_j=-1;
                    <span class="keywordflow">for</span> (face_loc_j=0; (face_loc_j&lt;nb_faces_elem &amp;&amp; face_j!=face); face_loc_j++)
                      {
                        face_j=elem_faces(elem,face_loc_j);
                      }
                    face_loc_j--;
                    assert(face_loc_j&gt;=0);
                    assert(face_loc_j&lt;nb_faces_elem);
                    assert(elem_faces(elem,face_loc_j)==face);
                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; kjj=Kij_ancien(elem,face_loc_j,face_loc_j);
                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_i=0; face_loc_i&lt;nb_faces_elem; face_loc_i++)
                      {
                        <span class="keywordtype">int</span> face_i=elem_faces(elem,face_loc_i);
                        <span class="keywordflow">if</span>(face_i!=face)
                          {
                            <span class="keywordtype">double</span>&amp; kii=Kij_ancien(elem,face_loc_i,face_loc_i);
                            <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; kji=Kij_ancien(elem,face_loc_j,face_loc_i);
                            kii+=coeff*kji;
                            <span class="keywordtype">double</span>&amp; kij=Kij_ancien(elem,face_loc_i,face_loc_j);
                            kij+=coeff*kjj;
                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_k=(face_loc_i+1); face_loc_k&lt;nb_faces_elem; face_loc_k++)
                              {
                                <span class="keywordtype">int</span> face_k=elem_faces(elem,face_loc_k);
                                <span class="keywordflow">if</span>(face_k!=face)
                                  {
                                    <span class="keywordtype">double</span>&amp; kik=Kij_ancien(elem,face_loc_i,face_loc_k);
                                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; kjk=Kij_ancien(elem,face_loc_j,face_loc_k);
                                    <span class="keywordtype">double</span>&amp; kki=Kij_ancien(elem,face_loc_k,face_loc_i);
                                    kik+=coeff*kjk;
                                    kki+=coeff*kji;
                                  }
                              }
                          }
                      }
                    {
                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_i=0; face_loc_i&lt;nb_faces_elem; face_loc_i++)
                        Kij_ancien(elem,face_loc_j,face_loc_i)=0;
                    }
                    {
                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_i=0; face_loc_i&lt;nb_faces_elem; face_loc_i++)
                        {
                          <span class="keywordtype">double</span> sum=0.;
                          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_loc_k=0; face_loc_k&lt;nb_faces_elem; face_loc_k++)
                            {
                              sum+=Kij_ancien(elem,face_loc_i,face_loc_k);
                            }
<span class="comment">// Cerr &lt;&lt; &quot;somme apres : &quot; &lt;&lt; sum &lt;&lt; finl;</span>
                          Kij_ancien(elem,face_loc_i,face_loc_i)-=sum;<span class="comment">//car div(u)=0!</span>
                        }
                    }
                  }<span class="comment">//!&lt; for face</span>
<span class="comment"></span>
              }<span class="comment">//fin du if sur &quot;volumes_etendus_&quot;</span>

          }<span class="comment">//!&lt; sub_type Dirichlet</span>
<span class="comment"></span>      }
  }

  Kij-=Kij_ancien;
  <span class="keyword">const</span> <span class="keywordtype">double</span> max_kij = <a class="code" href="DoubleVect_8cpp.html#aad339141fa6027fa3b627825a2407c12">local_max_abs_vect</a>(Kij);
  <span class="keywordflow">if</span> (max_kij &gt; 1.e-15)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans le calcul des Kij : &quot;</span> &lt;&lt; max_kij &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Sortie du programme&quot;</span> &lt;&lt; finl;
      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
    }

  Kij+=Kij_ancien;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af6c40b1ce58622e73b53f011fbb0f0e5"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::test_difference_resu" ref="af6c40b1ce58622e73b53f011fbb0f0e5" args="(const DoubleTab &amp;, const DoubleTab &amp;, const DoubleTab &amp;, const DoubleTab &amp;, const DoubleTab &amp;vitesse) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::test_difference_resu </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>Kij_ancien</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>transporte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>resu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>vitesse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01169">1169</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00845">ajouter_antidiffusion()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00800">ajouter_diffusion()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00762">ajouter_operateur_centre()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00633">ajouter_partie_compressible()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00190">Dij()</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="Zone__VF_8h_source.html#l00574">Zone_VF::elem_faces()</a>, <a class="el" href="MorEqn_8h_source.html#l00082">MorEqn::equation()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Periodique_8h_source.html#l00056">Periodique::face_associee()</a>, <a class="el" href="AssembleurPP1BUtil_8cpp_source.html#l00046">face_associee</a>, <a class="el" href="Zone__VF_8h_source.html#l00458">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00112">is_compressible_</a>, <a class="el" href="Process_8cpp_source.html#l00345">Process::Journal()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00200">limiteur()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="IntVect_8h_source.html#l00150">IntVect::line_size()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00829">local_max_abs_vect()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01562">mettre_a_jour_pour_periodicite()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00181">minimum()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00061">Front_VF::nb_faces()</a>, <a class="el" href="Front__VF_8h_source.html#l00071">Front_VF::num_premiere_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Equation__base_8cpp_source.html#l01120">Equation_base::schema_temps()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Schema__Temps__base_8h_source.html#l00676">Schema_Temps_base::temps_courant()</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>, and <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01004">test()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> resu1(resu);
  resu1=0;

  <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a5ed7b641e615d0a8fea46aaf3eaaad3b">is_compressible_</a>) <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a81ab1069edcf31b0e416a557d9443f7f">ajouter_partie_compressible</a>(transporte,resu1,tab_vitesse);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a1cc3e4915dcd0e22759b0f290f9ffbf5">ajouter_operateur_centre</a>(Kij,transporte,resu1);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a2afbe2fa6f98fe9539705ef2d0d392f7">ajouter_diffusion</a>(Kij,transporte,resu1);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#afaf4f194109f5b37d07e7010278aafdc">ajouter_antidiffusion</a>(Kij,transporte,resu1);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ab106a70062c1831cca041196080bdeaf">mettre_a_jour_pour_periodicite</a>(resu1);

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> resu2(resu);
  resu2=0;

<span class="comment">// </span>
<span class="comment">// Calcul de resu2</span>
<span class="comment">// </span>

  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();

  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = zone_VEF.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_voisins = zone_VEF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem=elem_faces.<a class="code" href="classIntVect.html#a5ba680066169c8e057bb3e3b876e4a8c">line_size</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();

  <span class="keywordtype">int</span> face_i0, face_j0, elem, comp0;
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces0 = transporte.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
  <span class="keywordtype">double</span> sigma_fijd=0., sigma_fija=0.;

  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> pplusi(nb_comp);
  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> qplusi(nb_comp);
  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> pmoinsi(nb_comp);
  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> qmoinsi(nb_comp);

  <span class="keywordflow">for</span>(elem=0; elem&lt;nb_elem_tot; elem++)
    {
      <span class="keywordtype">int</span> face_loci=0, face_locj=0;

      <span class="keywordflow">for</span>(; face_loci&lt;nb_faces_elem; face_loci++)
        {
          face_i0=elem_faces(elem,face_loci);
          <span class="keywordflow">for</span>(comp0=0; comp0&lt;nb_comp; comp0++)
            resu2(face_i0,comp0)+=Kij_ancien(elem,face_loci,face_loci)*transporte(face_i0,comp0);

          pplusi=0.;
          qplusi=0.;
          pmoinsi=0.;
          qmoinsi=0.;

          <span class="keywordtype">int</span> elem1=face_voisins(face_i0,0), elem2=face_voisins(face_i0,1);
          <span class="keywordtype">int</span> face_loc_i=0, face_loc_j=0;
          <span class="keywordtype">double</span> dT,min_dT,max_dT, K,min_K,max_K;

<span class="comment">// </span>
<span class="comment">// dans elem1 :</span>
<span class="comment">// </span>
          <span class="keywordflow">while</span>((face_loc_i&lt;nb_faces_elem)&amp;&amp;(elem_faces(elem1,face_loc_i)!=face_i0))
            face_loc_i++;
          <span class="keywordflow">if</span>(face_loc_i==nb_faces_elem)
            {
<span class="comment">// Periodique!!</span>
              assert(elem2!=-1);
              face_loc_i=0;
              <span class="keywordflow">while</span>( (face_loc_i&lt;nb_faces_elem) &amp;&amp;
                     (face_voisins(elem_faces(elem1,face_loc_i),0)!=elem2) &amp;&amp;
                     (face_voisins(elem_faces(elem1,face_loc_i),1)!=elem2) )
                face_loc_i++;
            }

          assert(face_loc_i&lt;nb_faces_elem);
          <span class="keywordflow">for</span>(face_loc_j=0; face_loc_j&lt;nb_faces_elem; face_loc_j++)
            {
              <span class="keywordtype">int</span> face_j=elem_faces(elem1,face_loc_j);
              <span class="keywordflow">if</span>(face_j!=face_i0)
                {
                  K=Kij_ancien(elem1,face_loc_i,face_loc_j);

                  <span class="keywordflow">if</span>(K&gt;0.)
                    {
                      max_K=K ;
                      min_K=0.;
                    }
                  <span class="keywordflow">else</span>
                    {
                      max_K=0.;
                      min_K=K ;
                    }

                  <span class="keywordflow">for</span>(comp0=0; comp0&lt;nb_comp; comp0++)
                    {
                      dT =transporte(face_j,comp0);
                      dT-=transporte(face_i0,comp0);

                      <span class="keywordflow">if</span>(dT&gt;0.)
                        {
                          max_dT=dT ;
                          min_dT=0 ;
                        }
                      <span class="keywordflow">else</span>
                        {
                          max_dT=0. ;
                          min_dT=dT ;
                        }

                      pplusi(comp0) +=min_K*min_dT;
                      pmoinsi(comp0)+=min_K*max_dT;
                      qplusi(comp0) +=max_K*max_dT;
                      qmoinsi(comp0)+=max_K*min_dT;
                    }
                }
            }

<span class="comment">// </span>
<span class="comment">// dans elem2 :</span>
<span class="comment">// </span>

          <span class="keywordflow">if</span>(elem2!=-1)
            {
              face_loc_i=0;
              <span class="keywordflow">while</span>((face_loc_i&lt;nb_faces_elem)&amp;&amp;(elem_faces(elem2,face_loc_i)!=face_i0))
                face_loc_i++;
              <span class="keywordflow">if</span>(face_loc_i==nb_faces_elem)
                {
<span class="comment">// Periodique!!</span>
                  face_loc_i=0;
                  <span class="keywordflow">while</span>( (face_loc_i&lt;nb_faces_elem) &amp;&amp;
                         (face_voisins(elem_faces(elem2,face_loc_i),0)!=elem1) &amp;&amp;
                         (face_voisins(elem_faces(elem2,face_loc_i),1)!=elem1) )
                    face_loc_i++;
                }
              assert(face_loc_i&lt;nb_faces_elem);
              <span class="keywordflow">for</span>(face_loc_j=0; face_loc_j&lt;nb_faces_elem; face_loc_j++)
                {
                  <span class="keywordtype">int</span> face_j=elem_faces(elem2,face_loc_j);
                  <span class="keywordflow">if</span>(face_j!=face_i0)
                    {
                      K=Kij_ancien(elem2,face_loc_i,face_loc_j);

                      <span class="keywordflow">if</span>(K&gt;0.)
                        {
                          max_K=K ;
                          min_K=0.;
                        }
                      <span class="keywordflow">else</span>
                        {
                          max_K=0.;
                          min_K=K ;
                        }

                      <span class="keywordflow">for</span>(comp0=0; comp0&lt;nb_comp; comp0++)
                        {
                          dT =transporte(face_j,comp0);
                          dT-=transporte(face_i0,comp0);

                          <span class="keywordflow">if</span>(dT&gt;0.)
                            {
                              max_dT=dT ;
                              min_dT=0 ;
                            }
                          <span class="keywordflow">else</span>
                            {
                              max_dT=0. ;
                              min_dT=dT ;
                            }

                          pplusi(comp0) +=min_K*min_dT;
                          pmoinsi(comp0)+=min_K*max_dT;
                          qplusi(comp0) +=max_K*max_dT;
                          qmoinsi(comp0)+=max_K*min_dT;
                        }
                    }
                }
            }

          <span class="keywordflow">for</span>(face_locj=0; face_locj&lt;nb_faces_elem; face_locj++)
            <span class="keywordflow">if</span>(face_locj!=face_loci)
              {
                face_j0=elem_faces(elem,face_locj);
                <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; kij=Kij_ancien(elem,face_loci,face_locj);
                <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; kji=Kij_ancien(elem,face_locj,face_loci);
                <span class="keywordtype">double</span> dij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ae5963d1de142bf425808b7401692bd90">Dij</a>(elem,face_loci,face_locj,Kij_ancien);
                <span class="keywordtype">double</span> lji=kji+dij;
                <span class="keywordtype">double</span> lij=kij+dij;
                assert(lij&gt;=0);
                assert(lji&gt;=0);

                <span class="keywordflow">for</span>(comp0=0; comp0&lt;nb_comp; comp0++)
                  {
                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; Ti=transporte(face_i0,comp0);
                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; Tj=transporte(face_j0,comp0);
                    <span class="keywordtype">double</span> deltaij=Ti-Tj;
                    <span class="keywordtype">double</span> Fij=0;
                    <span class="keywordflow">if</span>(lij&lt;=lji)
                      {
                        <span class="keywordtype">double</span> coef=1;
                        <span class="keywordflow">if</span> (lij==lji)  coef=.5;
                        <span class="keywordflow">if</span>(deltaij)
                          {
                            <span class="keywordflow">if</span>(Ti &gt;= Tj)
                              {
                                <span class="keywordflow">if</span>(pplusi(comp0))
                                  {
                                    <span class="keywordtype">double</span> R=qplusi(comp0)/pplusi(comp0);
                                    Fij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ade923cb828015cfde5aff245ecd65936">minimum</a>(<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a36b674f178bc8694c4bc14686f6f17bb">limiteur</a>(R)*dij,lji);
                                  }
                              }
                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pmoinsi(comp0))
                              {
                                <span class="keywordtype">double</span> R=qmoinsi(comp0)/pmoinsi(comp0);
                                Fij=<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#ade923cb828015cfde5aff245ecd65936">minimum</a>(<a class="code" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp.html#a36b674f178bc8694c4bc14686f6f17bb">limiteur</a>(R)*dij,lji);
                              }

                            assert(Fij*dij&gt;=0);
                            sigma_fijd+=dij;
                            sigma_fija+=Fij;
                            Fij-=dij;
                            Fij*=deltaij;
                          }
                        resu2(face_i0,comp0)+=coef*(kij*Tj+Fij);
                        resu2(face_j0,comp0)+=coef*(kji*Ti-Fij);
                      }
                  }
              }
        }
    }

<span class="comment">// Pour periodique</span>

  <span class="keywordtype">int</span> nb_bord=zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();
  <span class="keywordtype">int</span> face;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
      <span class="keywordtype">int</span> nb_faces_b=le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
      <span class="keywordtype">int</span> num2 = num1 + nb_faces_b;
      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
          <span class="keywordtype">int</span> <a class="code" href="AssembleurPP1BUtil_8cpp.html#a3e374d53ebc7860e1c2f0b7906f2936d">face_associee</a>;
          <a class="code" href="classIntVect.html">IntVect</a> fait(nb_faces_b);
          fait = 0;

          <span class="keywordflow">for</span> (face=num1; face&lt;num2; face++)
            {
              <span class="keywordflow">if</span> (fait(face-num1) == 0)
                {
                  fait(face-num1) = 1;
                  face_associee=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(face-num1);
                  fait(face_associee) = 1;
                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
                    resu2(face_associee+num1, comp)=(resu2(face,comp)+=resu2(face_associee+num1,comp));
                }<span class="comment">//!&lt; if fait</span>
<span class="comment"></span>            }<span class="comment">//!&lt; for face</span>
<span class="comment"></span>        }<span class="comment">//!&lt; sub_type Perio</span>
<span class="comment"></span>    }

  resu1-=resu2;

<span class="comment">// Dans le cas des faces de Dirichlet, notre algorithme ne calcule aucune</span>
<span class="comment">// valeur sur les faces de Dirichlet car de toute facon, elles sont ecrasees</span>
<span class="comment">// par la matrice de masse. Mais ce n&#39;est pas le cas de l&#39;ancien algorithme</span>
<span class="comment">// d&#39;ou la modification apportee ici pour eviter de ne voir que les erreurs</span>
<span class="comment">// commises sur les bords de Dirichlet qui n&#39;ont aucune importance</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
      <span class="keywordtype">int</span> nb_faces=le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
      <span class="keywordtype">int</span> num2 = num1 + nb_faces;

      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) || <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keywordflow">for</span> (face=num1; face&lt;num2; face++)
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dim=0; dim&lt;nb_comp; dim++)
              resu1(face,dim)=0;
        }<span class="comment">//fin du if sur Dirichlet</span>
    }<span class="comment">//fin du for sur &quot;n_bord&quot;</span>

  <span class="keyword">const</span> <span class="keywordtype">double</span> max_abs_resu1 = <a class="code" href="DoubleVect_8cpp.html#aad339141fa6027fa3b627825a2407c12">local_max_abs_vect</a>(resu1);
  <a class="code" href="classProcess.html#a57e0f54b11e6eaadbea224fa904b18dd" title="Renvoie un objet statique de type Sortie qui sert de journal d&#39;evenements. Si message_level &lt;= verbose...">Journal</a>() &lt;&lt; <span class="stringliteral">&quot;local_max_abs_vect(resu1) = &quot;</span> &lt;&lt; max_abs_resu1
            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;

  <span class="keywordflow">if</span> (max_abs_resu1 &gt; 1.e-15)
    {
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Erreur dans le calcul des resu : &quot;</span> &lt;&lt; max_abs_resu1 &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Affichage des faces de bord&quot;</span> &lt;&lt; finl;

      <span class="comment">/**************************************************/</span>
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Affichage des faces de bord.&quot;</span> &lt;&lt; finl;

      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
        {
          <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
          <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
          <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
          <span class="keywordtype">int</span> nb_faces=le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
          <span class="keywordtype">int</span> num2 = num1 + nb_faces;

          <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Bord periodique : &quot;</span>;
              <span class="keywordflow">for</span> (face=num1; face&lt;num2; face++)
                {
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; face &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;
                }<span class="comment">//!&lt; for face</span>
<span class="comment"></span>              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl;
            }<span class="comment">//!&lt; sub_type Perio</span>
<span class="comment"></span>
          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()) || (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>())) )
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Bord de Dirichlet : &quot;</span>;
              <span class="keywordflow">for</span> (face=num1; face&lt;num2; face++)
                {
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; face &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;
                }<span class="comment">//!&lt; for face</span>
<span class="comment"></span>              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl;
            }

        }<span class="comment">//fin du for sur &quot;nbord&quot;</span>
      <span class="comment">/**************************************************/</span>

      <span class="comment">/**************************************************/</span>
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Affichage des faces qui posent probleme : &quot;</span> &lt;&lt; finl;
      <span class="keywordflow">if</span> (nb_comp==1)
        {
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_i=0; face_i&lt;nb_faces0; face_i++)
            {
              <span class="keywordflow">if</span> (resu1(face_i)&gt;1.e-15)
                <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; face_i &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; face_voisins(face_i,0) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>
                     &lt;&lt; face_voisins(face_i,1) &lt;&lt; <span class="stringliteral">&quot;) ; &quot;</span>;
            }<span class="comment">//fin du for sur &quot;face_i&quot;</span>
        }
      <span class="keywordflow">else</span>
        {
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face_i=0; face_i&lt;nb_faces0; face_i++)
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; face_i &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; face_voisins(face_i,0) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>
                   &lt;&lt; face_voisins(face_i,1) &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;

              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dim=0; dim&lt;nb_comp; dim++)
                {
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>  &lt;&lt; <span class="stringliteral">&quot;, resu1(&quot;</span>
                        &lt;&lt; face_i &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; dim &lt;&lt; <span class="stringliteral">&quot;)= &quot;</span>
                        &lt;&lt; resu1(face_i,dim);
                }
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl;
            }
        }
      <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl;
      <span class="comment">/**************************************************/</span>

      <span class="comment">/**************************************************/</span>
      resu1+=resu2;

      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;nb_bord; n_bord++)
        {
          <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
          <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
          <span class="keywordtype">int</span> num1 = le_bord.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
          <span class="keywordtype">int</span> nb_faces=le_bord.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
          <span class="keywordtype">int</span> num2 = num1 + nb_faces;

          <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
            {
              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Affichage des valeurs des resu au bord perio&quot;</span> &lt;&lt; finl;
              <span class="keywordflow">for</span> (face=num1; face&lt;num2; face++)
                {
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;resu1(&quot;</span> &lt;&lt; face &lt;&lt; <span class="stringliteral">&quot;) : &quot;</span> &lt;&lt; resu1(face) &lt;&lt; finl;
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;resu2(&quot;</span> &lt;&lt; face &lt;&lt; <span class="stringliteral">&quot;) : &quot;</span> &lt;&lt; resu2(face) &lt;&lt; finl;
                }<span class="comment">//!&lt; for face</span>
<span class="comment"></span>              <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl;
            }<span class="comment">//!&lt; sub_type Perio</span>
<span class="comment"></span>
        }<span class="comment">//fin du for sur &quot;nbord&quot;</span>

      <span class="comment">/**************************************************/</span>

      <span class="keyword">static</span> <span class="keywordtype">int</span> count = 0;
      count++;
      <span class="keywordflow">if</span> (count==2)
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Sortie du programme&quot;</span> &lt;&lt; finl;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
        }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2235e9d9ed398ec7c4b0fb6d91269e11"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::test_implicite" ref="a2235e9d9ed398ec7c4b0fb6d91269e11" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Op_Conv_EF_VEF_P1NC_Stab::test_implicite </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">2838</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a>.</p>

<p>References <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00845">ajouter_antidiffusion()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02610">ajouter_contribution_antidiffusion()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02350">ajouter_contribution_diffusion()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02236">ajouter_contribution_operateur_centre()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02474">ajouter_contribution_partie_compressible()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00800">ajouter_diffusion()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00936">Matrice_Morse::ajouter_multvect_()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00762">ajouter_operateur_centre()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00633">ajouter_partie_compressible()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00313">calculer_coefficients_operateur_centre()</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="Op__Conv__VEF__Face_8h_source.html#l00084">Op_Conv_VEF_Face::dimensionner()</a>, <a class="el" href="MorEqn_8h_source.html#l00082">MorEqn::equation()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Periodique_8h_source.html#l00056">Periodique::face_associee()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Cond__lim_8h_source.html#l00130">Cond_lim::frontiere_dis()</a>, <a class="el" href="Matrice__Morse_8cpp_source.html#l00104">Matrice_Morse::imprimer_formatte()</a>, <a class="el" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">Equation_base::inconnue()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00112">is_compressible_</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00093">Op_Conv_VEF_base::la_zcl_vef</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00092">Op_Conv_VEF_base::la_zone_vef</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00522">Zone_Cl_dis_base::les_conditions_limites()</a>, <a class="el" href="DoubleVect_8h_source.html#l00164">DoubleVect::line_size()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01562">mettre_a_jour_pour_periodicite()</a>, <a class="el" href="Zone__Cl__dis__base_8cpp_source.html#l00603">Zone_Cl_dis_base::nb_cond_lim()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Zone_8h_source.html#l00469">Zone::nb_faces_elem()</a>, <a class="el" href="Front__VF_8h_source.html#l00066">Front_VF::nb_faces_tot()</a>, <a class="el" href="Zone__VF_8h_source.html#l00527">Zone_VF::nb_faces_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Cond__lim_8h_source.html#l00031">Deriv_Cond_lim_base::valeur()</a>, <a class="el" href="Ref__Champ__Inc__base_8h_source.html#l00028">Ref_Champ_Inc_base::valeur()</a>, <a class="el" href="Ref__Zone__Cl__VEF_8h_source.html#l00028">Ref_Zone_Cl_VEF::valeur()</a>, <a class="el" href="Ref__Zone__VEF_8h_source.html#l00028">Ref_Zone_VEF::valeur()</a>, <a class="el" href="Champ__Inc__base_8cpp_source.html#l00221">Champ_Inc_base::valeurs()</a>, <a class="el" href="Champ__Inc_8cpp_source.html#l00245">Champ_Inc::valeurs()</a>, <a class="el" href="Op__Conv__VEF__base_8h_source.html#l00094">Op_Conv_VEF_base::vitesse_</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02191">ajouter_contribution()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classZone__VEF.html" title="class Zone_VEF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VEF</a>&amp; zone_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a6c29a488a6805ba4a9f2f059cdba77ae">la_zone_vef</a>.<a class="code" href="classRef__Zone__VEF.html#aafd9a5ee1a76f290c9c6b5447b0c8d30">valeur</a>();
  <span class="keyword">const</span> <a class="code" href="classZone__Cl__VEF.html">Zone_Cl_VEF</a>&amp; zone_Cl_VEF = <a class="code" href="classOp__Conv__VEF__base.html#a03f677ee7911706a4f85cd37e0ca4535">la_zcl_vef</a>.<a class="code" href="classRef__Zone__Cl__VEF.html#a0970d7253def65ad4f0c5ce1830fd243">valeur</a>();

  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; unknown=<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_vitesse=<a class="code" href="classOp__Conv__VEF__base.html#a5547875832fb45e09b1115372fb76ffd">vitesse_</a>.<a class="code" href="classRef__Champ__Inc__base.html#a17553641a4c06730e1562125e07b3490">valeur</a>().<a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> tab_test(unknown);
  <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; test2=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,tab_test);
  test2=0.;

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> resuExp(unknown);
  <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resu2Exp=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,resuExp);
  resu2Exp=0.;

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> resuImp(unknown);
  <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; resu2Imp=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>,resuImp);
  resu2Imp=0.;

  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem_tot = zone_VEF.<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem = zone_VEF.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_tot=zone_VEF.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_bord=zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#aa6f1df56cfd6e2eae83cc991c7cc9b41" title="Renvoie le nombre de conditions aux limites.">nb_cond_lim</a>();

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Kij(nb_elem_tot,nb_faces_elem,nb_faces_elem);
  Kij=0.;

  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp=unknown.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
  <span class="keywordtype">int</span> size=unknown.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
  <span class="keywordtype">int</span> face=0,face2=0, faceAss=0, ind_face=0,ind_faceAss=0, n_bord=0, num1=0,num2=0;

  <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> testResu(<span class="stringliteral">&quot;test.txt&quot;</span>);
  <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> testMat(<span class="stringliteral">&quot;matrice.txt&quot;</span>);

<span class="comment">// </span>
<span class="comment">// Pour la periodicite</span>
<span class="comment">// </span>
  <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> faces_associees(nb_faces_tot);
  <span class="keywordflow">for</span> (face=0; face&lt;nb_faces_tot; face++)
    faces_associees(face)=face;

  <span class="keywordflow">for</span> (n_bord=0; n_bord&lt;nb_bord; n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = zone_Cl_VEF.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>(n_bord);
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; le_bord = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
      num1 = 0;
      num2=le_bord.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();<span class="comment">//pour ne pas en oublier</span>

      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
        {
          <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_perio = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());

          <span class="keywordflow">for</span> (ind_face=num1; ind_face&lt;num2; ind_face++)
            {
              face=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              ind_faceAss=la_cl_perio.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(ind_face);
              faceAss=le_bord.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_faceAss);

<span class="comment">// Pour ne parcourir que la moitie des faces periodiques</span>
              <span class="keywordflow">if</span> (face&lt;faceAss)
                {
                  faces_associees(face)=faceAss;
                  faces_associees(faceAss)=face;
                }
            }
        }
    }
<span class="comment">// </span>
<span class="comment">// Fin du traitement pour la periodicite</span>
<span class="comment">// </span>

  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a3c1c70e249ebd12239c7987a4e50d277">calculer_coefficients_operateur_centre</a>(Kij,nb_comp,tab_vitesse);

<span class="comment">// </span>
<span class="comment">// Construction de la matrice</span>
<span class="comment">// </span>
  <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a> matrice;
  <a class="code" href="classOp__Conv__VEF__Face.html#a968452c80df39cea3adbc3a89976785a" title="on dimensionne notre matrice au moyen de la methode dimensionner de la classe Op_VEF_Face.">dimensionner</a>(matrice);
  <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a5ed7b641e615d0a8fea46aaf3eaaad3b">is_compressible_</a>)
    <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a12349ea012bfb6446b63f9133eb3da11">ajouter_contribution_partie_compressible</a>(unknown,tab_vitesse,matrice);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ad7f5145ac5fa237d31363a2ef4037afa">ajouter_contribution_operateur_centre</a>(Kij,unknown,matrice);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#afe634e48a923aa8f514e3addb1061b9e">ajouter_contribution_diffusion</a>(Kij,unknown,matrice);
  <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a205252afcc4f18ae771ce126e561ff57">ajouter_contribution_antidiffusion</a>(Kij,unknown,matrice);
  matrice.<a class="code" href="classMatrice__Morse.html#a60c1de967d05b21b9b96a9bf6d73334e">imprimer_formatte</a>(testMat);
<span class="comment">// </span>
<span class="comment">// Fin de la construction de la matrice</span>
<span class="comment">// </span>

<span class="comment">// </span>
<span class="comment">// Calcul de l&#39;operateur explicite et comparaison</span>
<span class="comment">// </span>
  <span class="keywordflow">for</span> (face=0; face&lt;size; face++)
    {
      test2[face]=1.;
      test2[faces_associees(face)]=1.;

      <span class="comment">/* Calcul de l&#39;operateur explicite */</span>
      resuExp=0.;
      <span class="keywordflow">if</span> (<a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a5ed7b641e615d0a8fea46aaf3eaaad3b">is_compressible_</a>)
        <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a81ab1069edcf31b0e416a557d9443f7f">ajouter_partie_compressible</a>(tab_test,resuExp,tab_vitesse);
      <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a1cc3e4915dcd0e22759b0f290f9ffbf5">ajouter_operateur_centre</a>(Kij,tab_test,resuExp);
      <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a2afbe2fa6f98fe9539705ef2d0d392f7">ajouter_diffusion</a>(Kij,tab_test,resuExp);
      <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#afaf4f194109f5b37d07e7010278aafdc">ajouter_antidiffusion</a>(Kij,tab_test,resuExp);
      <a class="code" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ab106a70062c1831cca041196080bdeaf">mettre_a_jour_pour_periodicite</a>(resuExp);

      <span class="comment">/* Calcul de l&#39;operateur implicite */</span>
      resuImp=0.;
      matrice.<a class="code" href="classMatrice__Morse.html#a46680c7fbcd8478a9fdc774914de2a53" title="Operation de multiplication-accumulation (saxpy) matrice vecteur. Operation: resu = resu + A*x...">ajouter_multvect_</a>(tab_test,resuImp);

      <span class="comment">/* Calcul de la difference */</span>
      resuExp+=resuImp;

      <span class="comment">/* Affichage de la difference */</span>
      testResu&lt;&lt;<span class="stringliteral">&quot;*************************&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
      testResu&lt;&lt;<span class="stringliteral">&quot;Face test : &quot;</span>&lt;&lt;face&lt;&lt;finl;
      <span class="keywordflow">for</span> (face2=0; face2&lt;size; face2++)
        <span class="keywordflow">if</span> (resu2Exp[face2]&lt;=1.e-13)
          testResu&lt;&lt;face2&lt;&lt;<span class="stringliteral">&quot; OK&quot;</span>&lt;&lt;finl;
        <span class="keywordflow">else</span>
          testResu&lt;&lt;face2&lt;&lt;<span class="stringliteral">&quot; residu : &quot;</span>&lt;&lt;resu2Exp[face2]&lt;&lt;finl;
      testResu&lt;&lt;<span class="stringliteral">&quot;*************************&quot;</span>&lt;&lt;finl;

      test2[face]=0.;
      test2[faces_associees(face)]=0.;
    }
<span class="comment">// </span>
<span class="comment">// Fin du calcul de l&#39;operateur explicite et comparaison</span>
<span class="comment">// </span>

  <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a515503fe50ac73fb7f86363fea4ee594"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::alpha_" ref="a515503fe50ac73fb7f86363fea4ee594" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a515503fe50ac73fb7f86363fea4ee594">Op_Conv_EF_VEF_P1NC_Stab::alpha_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#aebc1771cc4608fc51a8b6d15b93c8d3d">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00110">110</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02104">completer()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="aedd6723f68a86c7ff13cb281c5ecb03b"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::alpha_ssz" ref="aedd6723f68a86c7ff13cb281c5ecb03b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a> <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aedd6723f68a86c7ff13cb281c5ecb03b">Op_Conv_EF_VEF_P1NC_Stab::alpha_ssz</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00123">123</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02104">completer()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="a4eb4574264a472696b84d7395b8a44ef"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::alpha_tab" ref="a4eb4574264a472696b84d7395b8a44ef" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a4eb4574264a472696b84d7395b8a44ef">Op_Conv_EF_VEF_P1NC_Stab::alpha_tab</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00106">106</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00845">ajouter_antidiffusion()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02610">ajouter_contribution_antidiffusion()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02350">ajouter_contribution_diffusion()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00800">ajouter_diffusion()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02104">completer()</a>.</p>

</div>
</div>
<a class="anchor" id="ac1b44ec3559d53eaf94d49b3e029ae4b"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::beta" ref="ac1b44ec3559d53eaf94d49b3e029ae4b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArrOfDouble.html">ArrOfDouble</a> <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac1b44ec3559d53eaf94d49b3e029ae4b">Op_Conv_EF_VEF_P1NC_Stab::beta</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>vaut zero pour les faces ou l'on souhaite degenerer en Amont. mutable <a class="el" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> limiteurs_;//tableau stockant pour chaque face la moyenne algebrique du limiteur </p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00107">107</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00845">ajouter_antidiffusion()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02610">ajouter_contribution_antidiffusion()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02104">completer()</a>.</p>

</div>
</div>
<a class="anchor" id="a37365045072580f022e3020d68b6abf4"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::elem_faces_dirichlet_" ref="a37365045072580f022e3020d68b6abf4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a37365045072580f022e3020d68b6abf4">Op_Conv_EF_VEF_P1NC_Stab::elem_faces_dirichlet_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00104">104</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00313">calculer_coefficients_operateur_centre()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02042">calculer_data_pour_dirichlet()</a>.</p>

</div>
</div>
<a class="anchor" id="aed3b960a81290a5110ae7ac8f9006fd8"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::elem_nb_faces_dirichlet_" ref="aed3b960a81290a5110ae7ac8f9006fd8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aed3b960a81290a5110ae7ac8f9006fd8">Op_Conv_EF_VEF_P1NC_Stab::elem_nb_faces_dirichlet_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00103">103</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02474">ajouter_contribution_partie_compressible()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00633">ajouter_partie_compressible()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00313">calculer_coefficients_operateur_centre()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02042">calculer_data_pour_dirichlet()</a>.</p>

</div>
</div>
<a class="anchor" id="a219062e7ce20f8e2d281c87823754ecf"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::info_obj" ref="a219062e7ce20f8e2d281c87823754ecf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a> <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a219062e7ce20f8e2d281c87823754ecf">Op_Conv_EF_VEF_P1NC_Stab::info_obj</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classOp__Conv__VEF__Face.html#ab04ee3b4166df4eea5ee4afa9bf25d43">Op_Conv_VEF_Face</a>.</p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00053">53</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5ed7b641e615d0a8fea46aaf3eaaad3b"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::is_compressible_" ref="a5ed7b641e615d0a8fea46aaf3eaaad3b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a5ed7b641e615d0a8fea46aaf3eaaad3b">Op_Conv_EF_VEF_P1NC_Stab::is_compressible_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00112">112</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02191">ajouter_contribution()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00135">is_compressible()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">readOn()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01169">test_difference_resu()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02838">test_implicite()</a>.</p>

</div>
</div>
<a class="anchor" id="a99b6274ae7744713950dbf600509b053"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::la_sous_zone_dis" ref="a99b6274ae7744713950dbf600509b053" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRef__Sous__zone__VF.html">Ref_Sous_zone_VF</a> <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a99b6274ae7744713950dbf600509b053">Op_Conv_EF_VEF_P1NC_Stab::la_sous_zone_dis</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00120">120</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02104">completer()</a>.</p>

</div>
</div>
<a class="anchor" id="ac6dad1bca9e67b647241a2c17b1d9998"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::nb_ssz_alpha" ref="ac6dad1bca9e67b647241a2c17b1d9998" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#ac6dad1bca9e67b647241a2c17b1d9998">Op_Conv_EF_VEF_P1NC_Stab::nb_ssz_alpha</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00122">122</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02104">completer()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="a8b4181342631eedf901e574b5e9e4474"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::new_jacobienne_" ref="a8b4181342631eedf901e574b5e9e4474" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a8b4181342631eedf901e574b5e9e4474">Op_Conv_EF_VEF_P1NC_Stab::new_jacobienne_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00118">118</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02191">ajouter_contribution()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="af0f2ade834ec7306b493e72c80f1aca1"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::nom_sous_zone" ref="af0f2ade834ec7306b493e72c80f1aca1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNom.html">Nom</a> <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af0f2ade834ec7306b493e72c80f1aca1">Op_Conv_EF_VEF_P1NC_Stab::nom_sous_zone</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00119">119</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02104">completer()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="a902ac33a37f9a30d97206c9d9a9acadf"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::noms_ssz_alpha" ref="a902ac33a37f9a30d97206c9d9a9acadf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNoms.html">Noms</a> <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a902ac33a37f9a30d97206c9d9a9acadf">Op_Conv_EF_VEF_P1NC_Stab::noms_ssz_alpha</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00124">124</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02104">completer()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="add33e5ac4396a277bfeca3638cf7a585"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::old_" ref="add33e5ac4396a277bfeca3638cf7a585" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#add33e5ac4396a277bfeca3638cf7a585">Op_Conv_EF_VEF_P1NC_Stab::old_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00114">114</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="a13400182e7ede0cc88d147e934b1cd1d"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::sous_zone" ref="a13400182e7ede0cc88d147e934b1cd1d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a13400182e7ede0cc88d147e934b1cd1d">Op_Conv_EF_VEF_P1NC_Stab::sous_zone</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Cas d'une sous-zone a definir pour que l'EF_Stab degenere en Amont. </p>

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00117">117</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02104">completer()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="aebf5d2735a227a53fd44c9df6042b10d"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::ssz_alpha" ref="aebf5d2735a227a53fd44c9df6042b10d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#aebf5d2735a227a53fd44c9df6042b10d">Op_Conv_EF_VEF_P1NC_Stab::ssz_alpha</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00125">125</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02104">completer()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="af913e1b9445b37211f13e9bf5c01d92e"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::test_" ref="af913e1b9445b37211f13e9bf5c01d92e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#af913e1b9445b37211f13e9bf5c01d92e">Op_Conv_EF_VEF_P1NC_Stab::test_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00113">113</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00551">ajouter()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02191">ajouter_contribution()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="a0fa21a81e6deda452a87699846cc1cd6"></a><!-- doxytag: member="Op_Conv_EF_VEF_P1NC_Stab::volumes_etendus_" ref="a0fa21a81e6deda452a87699846cc1cd6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classOp__Conv__EF__VEF__P1NC__Stab.html#a0fa21a81e6deda452a87699846cc1cd6">Op_Conv_EF_VEF_P1NC_Stab::volumes_etendus_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html#l00115">115</a> of file <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l02474">ajouter_contribution_partie_compressible()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01606">ajouter_old()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00633">ajouter_partie_compressible()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00313">calculer_coefficients_operateur_centre()</a>, <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l00052">readOn()</a>, and <a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html#l01021">test_difference_Kij()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/VEF/Operateurs/<a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8h_source.html">Op_Conv_EF_VEF_P1NC_Stab.h</a></li>
<li>src/VEF/Operateurs/<a class="el" href="Op__Conv__EF__VEF__P1NC__Stab_8cpp_source.html">Op_Conv_EF_VEF_P1NC_Stab.cpp</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:37:15 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
