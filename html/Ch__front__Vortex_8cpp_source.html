<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Champs/Ch_front_Vortex.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Champs/Ch_front_Vortex.cpp</div>  </div>
</div>
<div class="contents">
<a href="Ch__front__Vortex_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Ch_front_Vortex.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Champs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/21</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Ch__front__Vortex_8h.html">Ch_front_Vortex.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="LecFicDiffuse_8h.html">LecFicDiffuse.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Interprete_8h.html">Interprete.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VF_8h.html">Zone_VF.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;time.h&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="SFichier_8h.html">SFichier.h</a>&gt;</span>
<a name="l00030"></a>00030 
<a name="l00031"></a><a class="code" href="Ch__front__Vortex_8cpp.html#a07734d79bf8124bdc13d077636a58536">00031</a> <a class="code" href="Declare__Inst_8h.html#acc0aee837ea82cfdb264285a980747e9">Implemente_instanciable_sans_destructeur</a>(<a class="code" href="classCh__front__Vortex.html" title="classe Ch_fr_Vortex Classe derivee de Champ_front_var qui represente les champs aux frontieres calcul...">Ch_front_Vortex</a>,<span class="stringliteral">&quot;Champ_front_Vortex&quot;</span>,<a class="code" href="classChamp__front__var__instationnaire.html" title="classe Champ_front_var_instationnaire Classe derivee de Champ_front_var qui represente les champs aux...">Champ_front_var_instationnaire</a>);
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 
<a name="l00034"></a><a class="code" href="classCh__front__Vortex.html#a35e7d33bccf25395e1e6439275964b75">00034</a> <a class="code" href="classCh__front__Vortex.html#a35e7d33bccf25395e1e6439275964b75">Ch_front_Vortex::~Ch_front_Vortex</a>()
<a name="l00035"></a>00035 {
<a name="l00036"></a>00036   <a class="code" href="classCh__front__Vortex.html#a92eeca833750471b514bb21030d5c535">sauvegarder_vortex</a>();
<a name="l00037"></a>00037 }
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="comment">// Precondition:</span>
<a name="l00040"></a>00040 <span class="comment">// Parametre: Sortie&amp; os</span>
<a name="l00041"></a>00041 <span class="comment">// Signification: un flot de sortie</span>
<a name="l00042"></a>00042 <span class="comment">// Valeurs par defaut:</span>
<a name="l00043"></a>00043 <span class="comment">// Contraintes:</span>
<a name="l00044"></a>00044 <span class="comment">// Acces: entree/sortie</span>
<a name="l00045"></a>00045 <span class="comment">// Exception:</span>
<a name="l00046"></a>00046 <span class="comment">// Effets de bord:</span>
<a name="l00047"></a>00047 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00048"></a>00048 <span class="comment">//</span>
<a name="l00049"></a>00049 <span class="comment">//</span>
<a name="l00050"></a>00050 <span class="comment">//</span><span class="comment"></span>
<a name="l00051"></a>00051 <span class="comment">//! Imprime le champ sur flot de sortie.&lt;br&gt;Imprime la taille du champ et la valeur (constante) sur&lt;br&gt;la frontiere.</span>
<a name="l00052"></a>00052 <span class="comment"></span><span class="comment">/** \return Sortie\&amp;&lt;br&gt;</span>
<a name="l00053"></a>00053 <span class="comment">Signification: le flot de sortie modifie&lt;br&gt;</span>
<a name="l00054"></a>00054 <span class="comment">Contraintes: */</span>
<a name="l00055"></a><a class="code" href="classCh__front__Vortex.html#a97d01bddedd10b2a95b993a3b6df635e">00055</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classCh__front__Vortex.html#a97d01bddedd10b2a95b993a3b6df635e" title="Imprime le champ sur flot de sortie. Imprime la taille du champ et la valeur (constante) sur la front...">Ch_front_Vortex::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00056"></a>00056 <span class="keyword"></span>{
<a name="l00057"></a>00057   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab=<a class="code" href="classChamp__front__base.html#a7d124849f85571b21d805a760deefdc0" title="Renvoie le tableau des valeurs du champ.">valeurs</a>();
<a name="l00058"></a>00058   os &lt;&lt; tab.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00059"></a>00059   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;tab.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>(); i++)
<a name="l00060"></a>00060     os &lt;&lt; tab(0,i);
<a name="l00061"></a>00061   <span class="keywordflow">return</span> os;
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="comment">// Precondition:</span>
<a name="l00065"></a>00065 <span class="comment">// Parametre: Entree&amp; is</span>
<a name="l00066"></a>00066 <span class="comment">// Signification: un flot d&#39;entree</span>
<a name="l00067"></a>00067 <span class="comment">// Valeurs par defaut:</span>
<a name="l00068"></a>00068 <span class="comment">// Contraintes:</span>
<a name="l00069"></a>00069 <span class="comment">// Acces: entree/sortie</span>
<a name="l00070"></a>00070 <span class="comment">// Exception:</span>
<a name="l00071"></a>00071 <span class="comment">// Effets de bord:</span>
<a name="l00072"></a>00072 <span class="comment">// Postcondition: le champ analytique a la valeur lue</span>
<a name="l00073"></a>00073 <span class="comment">//</span>
<a name="l00074"></a>00074 <span class="comment">//</span>
<a name="l00075"></a>00075 <span class="comment">//</span><span class="comment"></span>
<a name="l00076"></a>00076 <span class="comment">//! Lit le champ a partir d&#39;un flot d&#39;entree.&lt;br&gt;Format:&lt;br&gt;Champ_front_Vortex nb_compo vrel_1 ... [vrel_i]</span>
<a name="l00077"></a>00077 <span class="comment"></span><span class="comment">/** \return Entree\&amp; is&lt;br&gt;</span>
<a name="l00078"></a>00078 <span class="comment">Signification: le flot d&#39;entree modifie&lt;br&gt;</span>
<a name="l00079"></a>00079 <span class="comment">Contraintes: */</span>
<a name="l00080"></a><a class="code" href="classCh__front__Vortex.html#a6c73d2a8f7d4cae789521500365a8642">00080</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classCh__front__Vortex.html#a6c73d2a8f7d4cae789521500365a8642" title="Lit le champ a partir d&#39;un flot d&#39;entree. Format: Champ_front_Vortex nb_compo vrel_1 ...">Ch_front_Vortex::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00081"></a>00081 {
<a name="l00082"></a>00082 
<a name="l00083"></a>00083   <span class="keywordflow">if</span>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>!=3)
<a name="l00084"></a>00084     {
<a name="l00085"></a>00085       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Vortex Boundary condition requests 3D problem &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00086"></a>00086       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00087"></a>00087     }
<a name="l00088"></a>00088 
<a name="l00089"></a>00089   <a class="code" href="classField__base.html#a0d3bb177287a79b9d7da6f3a46deff53" title="Fixe le nombre de composantes du champ. Le champ est vectoriel s&#39;il est de meme dimension que l&#39;espac...">fixer_nb_comp</a>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00090"></a>00090 
<a name="l00091"></a>00091   <a class="code" href="classCh__front__Vortex.html#a1980beb61eb5e208d1ab0b0ee5c13369">init</a> = 1;
<a name="l00092"></a>00092   <a class="code" href="classCh__front__Vortex.html#af42fc5d26e012aa4c736ce6812391b9c">first_rand</a> = 1;
<a name="l00093"></a>00093 
<a name="l00094"></a>00094   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom;
<a name="l00095"></a>00095   is &gt;&gt; nom &gt;&gt; <a class="code" href="classCh__front__Vortex.html#a4b66b4a94927c059c11c3764aee62305">geom</a> &gt;&gt; <a class="code" href="classCh__front__Vortex.html#a68b8c321eb0b486eddd2ff4354f1c07a">nu</a> &gt;&gt; <a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097   <a class="code" href="classCh__front__Vortex.html#a21058f2551c0090dfa749a4dc819a002">mon_domaine</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>, <a class="code" href="classInterprete.html#a3ca248609f0b72eac68baca14621b4ee" title="Voir Interprete_bloc::objet_global() BM: la classe Interprete n&#39;est pas le meilleur endroit pour cett...">Interprete::objet</a>(nom));
<a name="l00098"></a>00098 
<a name="l00099"></a>00099   <span class="keywordflow">return</span> is;
<a name="l00100"></a>00100 }
<a name="l00101"></a>00101 
<a name="l00102"></a>00102 <span class="comment">// Precondition:</span>
<a name="l00103"></a>00103 <span class="comment">// Parametre: Champ_front_base&amp; ch</span>
<a name="l00104"></a>00104 <span class="comment">// Signification:</span>
<a name="l00105"></a>00105 <span class="comment">// Valeurs par defaut:</span>
<a name="l00106"></a>00106 <span class="comment">// Contraintes: reference constante</span>
<a name="l00107"></a>00107 <span class="comment">// Acces: NON ACCEDE</span>
<a name="l00108"></a>00108 <span class="comment">// Exception:</span>
<a name="l00109"></a>00109 <span class="comment">// Effets de bord:</span>
<a name="l00110"></a>00110 <span class="comment">// Postcondition:</span>
<a name="l00111"></a>00111 <span class="comment">//</span><span class="comment"></span>
<a name="l00112"></a>00112 <span class="comment">//! Renvoie l&#39;objet upcaste en Champ_front_base\&amp;</span>
<a name="l00113"></a>00113 <span class="comment"></span><span class="comment">/** \return Champ_front_base\&amp;&lt;br&gt;</span>
<a name="l00114"></a>00114 <span class="comment">Signification: (*this) upcaste en Champ_front_base\&amp;&lt;br&gt;</span>
<a name="l00115"></a>00115 <span class="comment">Contraintes: */</span>
<a name="l00116"></a><a class="code" href="classCh__front__Vortex.html#af302b1540bf5c9083fb5d911d94c5661">00116</a> <a class="code" href="classChamp__front__base.html" title="classe Champ_front_base Classe de base pour la hierarchie des champs aux frontieres. Un objet Champ_front_base definit un champ sur la frontiere d&#39;un domaine. Un objet de type Champ_front_base sera associe a chaque condition aux limites. Champ_front_base derive de Champ_Proto, afin d&#39;avoir une interface conforme a tous les champs, et d&#39;heriter des operations courantes sur les Champs. Les deux methodes principales sont initialiser et mettre_a_jour. Ce sont les deux seules qui peuvent modifier les valeurs du champ. La methode initialiser est appelee une fois au debut du calcul. Elle ne doit pas dependre de donnees exterieures a l&#39;equation qui porte la CL (en effet, rien ne garantit que ces donnees sont initialisees). En revanche, les valeurs de l&#39;inconnue sur laquelle porte la CL peuvent etre utiles pour l&#39;initialisation =&gt; l&#39;inconnue est passee en parametre en lecture seule. La methode mettre_a_jour est appelee au debut de chaque pas de temps ou sous-pas-de-temps, elle peut utiliser des donnees exterieures a l&#39;equation. A charge a l&#39;algorithme de s&#39;assurer que ces donnees sont pertinentes... Dans le cas de champs stationnaires, la methode mettre_a_jour n&#39;a rien a faire et les valeurs sont remplies une fois pour toutes par la methode initialiser. Dans le cas de champs instationnaires, il y a plusieurs valeurs en temps et chacune peut etre mise a jour. Les Champ_front sont divises en : * Champ_front_uniforme, constant dans le temps et l&#39;espace * Champ_front_instationnaire_base, uniformes en espace mais variables en temps * Champ_front_var, variables en espace. Les Champ_front_var sont ensuite classes selon qu&#39;ils sont stationnaires ou instationnaires. Les valeurs sont stockees dans une roue de DoubleTab. Si le champ est uniforme en espace, les DoubleTab sont dimensionnes a 1. S&#39;il est stationnaire, la roue n&#39;a qu&#39;une valeur temporelle et le temps qui lui est assigne n&#39;a pas de sens. S&#39;il est instationnaire, les valeurs temporelles sont celles de l&#39;inconnue de l&#39;equation a laquelle se rapporte le champ.">Champ_front_base</a>&amp; <a class="code" href="classCh__front__Vortex.html#af302b1540bf5c9083fb5d911d94c5661" title="Renvoie l&#39;objet upcaste en Champ_front_base&amp;.">Ch_front_Vortex::affecter_</a>(<span class="keyword">const</span> <a class="code" href="classChamp__front__base.html" title="classe Champ_front_base Classe de base pour la hierarchie des champs aux frontieres. Un objet Champ_front_base definit un champ sur la frontiere d&#39;un domaine. Un objet de type Champ_front_base sera associe a chaque condition aux limites. Champ_front_base derive de Champ_Proto, afin d&#39;avoir une interface conforme a tous les champs, et d&#39;heriter des operations courantes sur les Champs. Les deux methodes principales sont initialiser et mettre_a_jour. Ce sont les deux seules qui peuvent modifier les valeurs du champ. La methode initialiser est appelee une fois au debut du calcul. Elle ne doit pas dependre de donnees exterieures a l&#39;equation qui porte la CL (en effet, rien ne garantit que ces donnees sont initialisees). En revanche, les valeurs de l&#39;inconnue sur laquelle porte la CL peuvent etre utiles pour l&#39;initialisation =&gt; l&#39;inconnue est passee en parametre en lecture seule. La methode mettre_a_jour est appelee au debut de chaque pas de temps ou sous-pas-de-temps, elle peut utiliser des donnees exterieures a l&#39;equation. A charge a l&#39;algorithme de s&#39;assurer que ces donnees sont pertinentes... Dans le cas de champs stationnaires, la methode mettre_a_jour n&#39;a rien a faire et les valeurs sont remplies une fois pour toutes par la methode initialiser. Dans le cas de champs instationnaires, il y a plusieurs valeurs en temps et chacune peut etre mise a jour. Les Champ_front sont divises en : * Champ_front_uniforme, constant dans le temps et l&#39;espace * Champ_front_instationnaire_base, uniformes en espace mais variables en temps * Champ_front_var, variables en espace. Les Champ_front_var sont ensuite classes selon qu&#39;ils sont stationnaires ou instationnaires. Les valeurs sont stockees dans une roue de DoubleTab. Si le champ est uniforme en espace, les DoubleTab sont dimensionnes a 1. S&#39;il est stationnaire, la roue n&#39;a qu&#39;une valeur temporelle et le temps qui lui est assigne n&#39;a pas de sens. S&#39;il est instationnaire, les valeurs temporelles sont celles de l&#39;inconnue de l&#39;equation a laquelle se rapporte le champ.">Champ_front_base</a>&amp; ch)
<a name="l00117"></a>00117 {
<a name="l00118"></a>00118   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00119"></a>00119 }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 
<a name="l00122"></a><a class="code" href="classCh__front__Vortex.html#a7365ff344057b574afd8ed68c7ce4e99">00122</a> <span class="keywordtype">int</span> <a class="code" href="classCh__front__Vortex.html#a7365ff344057b574afd8ed68c7ce4e99">Ch_front_Vortex::my_rand</a>( )
<a name="l00123"></a>00123 {
<a name="l00124"></a>00124   <span class="keywordflow">if</span> (<a class="code" href="classCh__front__Vortex.html#af42fc5d26e012aa4c736ce6812391b9c">first_rand</a> == 1)
<a name="l00125"></a>00125     {
<a name="l00126"></a>00126       srand(time (NULL));
<a name="l00127"></a>00127       <a class="code" href="classCh__front__Vortex.html#af42fc5d26e012aa4c736ce6812391b9c">first_rand</a> = 0;
<a name="l00128"></a>00128     }
<a name="l00129"></a>00129   <span class="keywordflow">return</span> (rand ());
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 
<a name="l00132"></a><a class="code" href="classCh__front__Vortex.html#a92eeca833750471b514bb21030d5c535">00132</a> <span class="keywordtype">void</span> <a class="code" href="classCh__front__Vortex.html#a92eeca833750471b514bb21030d5c535">Ch_front_Vortex::sauvegarder_vortex</a>()
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> fichier = <span class="stringliteral">&quot;vortex.sauv&quot;</span>;
<a name="l00135"></a>00135   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">nproc</a>()&gt;1) fichier=fichier.<a class="code" href="classNom.html#a49a5c6438b6efe73ab314900c60a329c" title="Insere _prefix000n (n=me() ou nproc()) dans un nom de fichier (par ex:toto.titi) pour donner toto_pre...">nom_me</a>(<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">me</a>());
<a name="l00136"></a>00136   <span class="keywordflow">if</span>(<a class="code" href="classChamp__front__base.html#a99ee1ceac721d515e0f1ff4d88a6a2a8">la_frontiere_dis</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l00137"></a>00137     {
<a name="l00138"></a>00138       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Saving vortices in &quot;</span> &lt;&lt; fichier &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00139"></a>00139       <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> fic(fichier);
<a name="l00140"></a>00140       fic.<a class="code" href="classSortie__Fichier__base.html#a5ddd834ca9c766c24cc608cd03ef0e96">setf</a>(ios::scientific);
<a name="l00141"></a>00141 
<a name="l00142"></a>00142       <span class="keywordtype">int</span> nbvortex =  <a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l00143"></a>00143 
<a name="l00144"></a>00144       fic &lt;&lt; <a class="code" href="classCh__front__Vortex.html#a376ac2bd95c3c04b062a8af069d2c9d0">temps</a> &lt;&lt; finl;
<a name="l00145"></a>00145       fic &lt;&lt; nbvortex &lt;&lt; finl;
<a name="l00146"></a>00146 
<a name="l00147"></a>00147       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nbvortex; i++)
<a name="l00148"></a>00148         {
<a name="l00149"></a>00149           fic &lt;&lt; <a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#ae5a10eed9c9b2b2f757430133581221c" title="durees de vie des vortex">tvort</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;
<a name="l00150"></a>00150           fic &lt;&lt; <a class="code" href="classCh__front__Vortex.html#ad50d955e5f1d629f933b4c22717f6e23" title="signes de la vorticite des vortex">svort</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#a891d07a8d676a6d17cbe43b94e0098a6" title="numero faces contenant le centre du vortex">fvort</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#a0ed8dc0c07118c11d6efc8236fcf3623" title="intensite du vortex">gamma</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#a3fe211ee1e9e813ffc28ad24efb3ed46" title="longeur caracteristique du vortex">sigma</a>(i) &lt;&lt; finl;
<a name="l00151"></a>00151         }
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153 }
<a name="l00154"></a>00154 
<a name="l00155"></a><a class="code" href="classCh__front__Vortex.html#a18cef59441f234a642d5cf7bff043ec1">00155</a> <span class="keywordtype">void</span> <a class="code" href="classCh__front__Vortex.html#a18cef59441f234a642d5cf7bff043ec1">Ch_front_Vortex::reprendre_vortex</a>()
<a name="l00156"></a>00156 {
<a name="l00157"></a>00157   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Ch_front_Vortex::reprendre_vortex&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00158"></a>00158 
<a name="l00159"></a>00159   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> fichier = <span class="stringliteral">&quot;vortex.sauv&quot;</span>;
<a name="l00160"></a>00160   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">nproc</a>()&gt;1) fichier=fichier.<a class="code" href="classNom.html#a49a5c6438b6efe73ab314900c60a329c" title="Insere _prefix000n (n=me() ou nproc()) dans un nom de fichier (par ex:toto.titi) pour donner toto_pre...">nom_me</a>(<a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">me</a>());
<a name="l00161"></a>00161   <span class="keywordflow">if</span>(<a class="code" href="classChamp__front__base.html#a99ee1ceac721d515e0f1ff4d88a6a2a8">la_frontiere_dis</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l00162"></a>00162     {
<a name="l00163"></a>00163       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Resumption of vortices in &quot;</span> &lt;&lt; fichier &lt;&lt; finl;
<a name="l00164"></a>00164       <a class="code" href="classEFichier.html" title="Fichier en lecture Cette classe est a la classe C++ ifstream ce que la classe Entree est a la classe ...">EFichier</a> fic(fichier);
<a name="l00165"></a>00165       fic.<a class="code" href="classEntree__Fichier__base.html#a6c26b698a9e6a4a36d3a86d36722b2fb">setf</a>(ios::scientific);
<a name="l00166"></a>00166 
<a name="l00167"></a>00167       <span class="keywordflow">if</span>(fic.<a class="code" href="classEntree__Fichier__base.html#a27c3eab43170c45ca83c64dd0d0c483d">fail</a>())
<a name="l00168"></a>00168         {
<a name="l00169"></a>00169           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Unable to open file &quot;</span> &lt;&lt; fichier &lt;&lt; finl;
<a name="l00170"></a>00170           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00171"></a>00171         }
<a name="l00172"></a>00172 
<a name="l00173"></a>00173       <span class="keywordtype">double</span> tps;
<a name="l00174"></a>00174       <span class="keywordtype">int</span> nbvortex;
<a name="l00175"></a>00175 
<a name="l00176"></a>00176       fic &gt;&gt; tps;
<a name="l00177"></a>00177       fic &gt;&gt; nbvortex;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179       <span class="keywordflow">if</span>(!(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classCh__front__Vortex.html#a376ac2bd95c3c04b062a8af069d2c9d0">temps</a>-tps)/(<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(tps)+1.e-24)&lt;1.e-6))
<a name="l00180"></a>00180         {
<a name="l00181"></a>00181           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; time : &quot;</span> &lt;&lt; tps &lt;&lt; <span class="stringliteral">&quot; in &quot;</span> &lt;&lt; fichier &lt;&lt; <span class="stringliteral">&quot; does not match the time of resumed &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#a376ac2bd95c3c04b062a8af069d2c9d0">temps</a> &lt;&lt; finl;
<a name="l00182"></a>00182           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00183"></a>00183         }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; resumed &quot;</span> &lt;&lt; nbvortex &lt;&lt; <span class="stringliteral">&quot; vortex at time &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#a376ac2bd95c3c04b062a8af069d2c9d0">temps</a> &lt;&lt; finl;
<a name="l00186"></a>00186 
<a name="l00187"></a>00187       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nbvortex; i++)
<a name="l00188"></a>00188         {
<a name="l00189"></a>00189           fic &gt;&gt; <a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i) &gt;&gt; <a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i) &gt;&gt; <a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i) &gt;&gt; <a class="code" href="classCh__front__Vortex.html#ae5a10eed9c9b2b2f757430133581221c" title="durees de vie des vortex">tvort</a>(i);
<a name="l00190"></a>00190           fic &gt;&gt; <a class="code" href="classCh__front__Vortex.html#ad50d955e5f1d629f933b4c22717f6e23" title="signes de la vorticite des vortex">svort</a>(i) &gt;&gt; <a class="code" href="classCh__front__Vortex.html#a891d07a8d676a6d17cbe43b94e0098a6" title="numero faces contenant le centre du vortex">fvort</a>(i) &gt;&gt; <a class="code" href="classCh__front__Vortex.html#a0ed8dc0c07118c11d6efc8236fcf3623" title="intensite du vortex">gamma</a>(i) &gt;&gt; <a class="code" href="classCh__front__Vortex.html#a3fe211ee1e9e813ffc28ad24efb3ed46" title="longeur caracteristique du vortex">sigma</a>(i);
<a name="l00191"></a>00191         }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; resumed made &quot;</span> &lt;&lt; finl;
<a name="l00194"></a>00194     }
<a name="l00195"></a>00195 }
<a name="l00196"></a>00196 
<a name="l00197"></a>00197 
<a name="l00198"></a><a class="code" href="classCh__front__Vortex.html#a77b8ea3be6dfe17263e09d709cb0cb09">00198</a> <span class="keywordtype">int</span> <a class="code" href="classCh__front__Vortex.html#a77b8ea3be6dfe17263e09d709cb0cb09" title="Initialise le temps courant et Gpoint.">Ch_front_Vortex::initialiser</a>(<span class="keywordtype">double</span> un_temps, <span class="keyword">const</span> <a class="code" href="classChamp__Inc__base.html" title="Classe Champ_Inc_base Classe de base des champs inconnues qui sont les champs calcules par une equati...">Champ_Inc_base</a>&amp; inco)
<a name="l00199"></a>00199 {
<a name="l00200"></a>00200   <span class="keywordflow">if</span> (!<a class="code" href="classChamp__front__var__instationnaire.html#a2250c6689f2010951ddf9121bb00df7e" title="Initialise le temps courant et Gpoint.">Champ_front_var_instationnaire::initialiser</a>(un_temps,inco))
<a name="l00201"></a>00201     <span class="keywordflow">return</span> 0;
<a name="l00202"></a>00202 
<a name="l00203"></a>00203   <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; domaine=<a class="code" href="classCh__front__Vortex.html#a21058f2551c0090dfa749a4dc819a002">mon_domaine</a>.<a class="code" href="classRef__Domaine.html#a89e1c374ada79faa2c7e9a76c3393ad8">valeur</a>();
<a name="l00204"></a>00204   <span class="keyword">const</span> <a class="code" href="classFrontiere__dis__base.html" title="classe Frontiere_dis_base Classe representant une frontiere discretisee. Les objets Frontiere_dis_bas...">Frontiere_dis_base</a>&amp; fr_dis=<a class="code" href="classChamp__front__base.html#af5b3aaf468fe33492ed777c2e5772651" title="Renvoie la frontiere discretisee associee au champ. (version const)">frontiere_dis</a>();
<a name="l00205"></a>00205   <span class="keyword">const</span> <a class="code" href="classFrontiere.html" title="Classe Frontiere. Une Frontiere decrit une partie de la frontiere d&#39;une Zone, elle possede un Nom...">Frontiere</a>&amp; frontiere=fr_dis.<a class="code" href="classFrontiere__dis__base.html#a95f81b046cd23c8c8083ae03eebe93cd" title="Renvoie la frontiere geometrique associee. (version const)">frontiere</a>();
<a name="l00206"></a>00206   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces=frontiere.<a class="code" href="classFrontiere.html#aa073fe9dbdddde59471ee7032b256aa2" title="Renvoie le nombre de faces de la frontiere.">nb_faces</a>();
<a name="l00207"></a>00207   <span class="keyword">const</span> <span class="keywordtype">int</span> ndeb=frontiere.<a class="code" href="classFrontiere.html#a2a41c319a1530c984c356121e5ca2383">num_premiere_face</a>();
<a name="l00208"></a>00208   <span class="keyword">const</span> <span class="keywordtype">int</span> nfin=ndeb+nb_faces;
<a name="l00209"></a>00209   <span class="keyword">const</span> <a class="code" href="classFaces.html" title="enum Type_Face Les differents types geometriques de faces.">Faces</a>&amp; faces=frontiere.<a class="code" href="classFrontiere.html#ac64479069f0c43a17cb5766a39ce5ba8" title="Renvoie les faces de la frontiere&lt;br&gt;(version const)">faces</a>();
<a name="l00210"></a>00210   <span class="keywordtype">int</span> nbsf=faces.<a class="code" href="classFaces.html#a1361d27e4c8b239c48de671fad23428c" title="Renvoie le nombre de sommet par face.">nb_som_faces</a>();
<a name="l00211"></a>00211   <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zvf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, <a class="code" href="classChamp__front__base.html#a4cef320acc233b308e5241fc7c271145">zone_dis</a>());
<a name="l00212"></a>00212   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xv=zvf.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00213"></a>00213 
<a name="l00214"></a>00214   <span class="keywordtype">double</span> x,y,z;
<a name="l00215"></a>00215   <span class="keywordtype">double</span> dx,dy,dz;
<a name="l00216"></a>00216   <span class="keywordtype">double</span> <a class="code" href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a>;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218   <span class="keywordtype">double</span>  C_mu = 0.09;
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 
<a name="l00221"></a>00221   <a class="code" href="classCh__front__Vortex.html#a0846f4b090711d25226c15dea87ddc00">u</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_faces);
<a name="l00222"></a>00222   <a class="code" href="classCh__front__Vortex.html#a7a1d86baf6bdcced9c2b408e71cf1834">v</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_faces);
<a name="l00223"></a>00223   <a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_faces);
<a name="l00224"></a>00224   <a class="code" href="classCh__front__Vortex.html#a19bb41d9661e48bd6927ad3d20cae688">u_moy</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_faces);
<a name="l00225"></a>00225   <a class="code" href="classCh__front__Vortex.html#a09886efd56280aa9c775ef73ef474ad8">dudy</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_faces);
<a name="l00226"></a>00226   <a class="code" href="classCh__front__Vortex.html#aade11454b6fee45d63edd9a5b4ac6a30">k</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_faces);
<a name="l00227"></a>00227   <a class="code" href="classCh__front__Vortex.html#a997c0f1f940d84ed0b69727b3e9d99cc">eps</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_faces);
<a name="l00228"></a>00228   <a class="code" href="classCh__front__Vortex.html#abbcf4852e88ad3d92c0868a8de6ad67d" title="processus de Wiener">Wk</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_faces);
<a name="l00229"></a>00229 
<a name="l00230"></a>00230   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> face=ndeb; face&lt;nfin; face++)
<a name="l00231"></a>00231     {
<a name="l00232"></a>00232       <a class="code" href="classCh__front__Vortex.html#abbcf4852e88ad3d92c0868a8de6ad67d" title="processus de Wiener">Wk</a>(face) = 2.*drand48()-1.;
<a name="l00233"></a>00233     }
<a name="l00234"></a>00234 
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 <span class="comment">//</span>
<a name="l00237"></a>00237 <span class="comment">// caracteristiques geometriques associees a la frontiere</span>
<a name="l00238"></a>00238 <span class="comment">//</span>
<a name="l00239"></a>00239 
<a name="l00240"></a>00240   <span class="keywordflow">if</span>(<a class="code" href="classCh__front__Vortex.html#a4b66b4a94927c059c11c3764aee62305">geom</a>==<span class="stringliteral">&quot;circle&quot;</span>)
<a name="l00241"></a>00241     {
<a name="l00242"></a>00242 
<a name="l00243"></a>00243       <span class="keywordtype">double</span> x_xmin=1.e6;
<a name="l00244"></a>00244       <span class="keywordtype">double</span> x_xmax=-1.e6;
<a name="l00245"></a>00245       <span class="keywordtype">double</span> y_xmin=1.e6;
<a name="l00246"></a>00246       <span class="keywordtype">double</span> y_xmax=-1.e6;
<a name="l00247"></a>00247       <span class="keywordtype">double</span> z_xmin=1.e6;
<a name="l00248"></a>00248       <span class="keywordtype">double</span> z_xmax=-1.e6;
<a name="l00249"></a>00249       <span class="keywordtype">double</span> x_ymin=1.e6;
<a name="l00250"></a>00250       <span class="keywordtype">double</span> x_ymax=-1.e6;
<a name="l00251"></a>00251       <span class="keywordtype">double</span> y_ymin=1.e6;
<a name="l00252"></a>00252       <span class="keywordtype">double</span> y_ymax=-1.e6;
<a name="l00253"></a>00253       <span class="keywordtype">double</span> z_ymin=1.e6;
<a name="l00254"></a>00254       <span class="keywordtype">double</span> z_ymax=-1.e6;
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 
<a name="l00257"></a>00257       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> face=ndeb; face&lt;nfin; face++)
<a name="l00258"></a>00258         {
<a name="l00259"></a>00259           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kk=0; kk&lt;nbsf; kk++)
<a name="l00260"></a>00260             {
<a name="l00261"></a>00261               x=domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,kk),0);
<a name="l00262"></a>00262               y=domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,kk),1);
<a name="l00263"></a>00263               z=domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(faces.<a class="code" href="classFaces.html#abac5c946cee7423e80cef0a110f1007b" title="Renvoie le numero du j-ieme sommet de la i-ieme face.">sommet</a>(face,kk),2);
<a name="l00264"></a>00264 
<a name="l00265"></a>00265               <span class="keywordflow">if</span>(y&lt;y_ymin)
<a name="l00266"></a>00266                 {
<a name="l00267"></a>00267                   y_ymin=y;
<a name="l00268"></a>00268                   x_ymin=x;
<a name="l00269"></a>00269                   z_ymin=z;
<a name="l00270"></a>00270                 }
<a name="l00271"></a>00271               <span class="keywordflow">if</span>(y&gt;y_ymax)
<a name="l00272"></a>00272                 {
<a name="l00273"></a>00273                   y_ymax=y;
<a name="l00274"></a>00274                   x_ymax=x;
<a name="l00275"></a>00275                   z_ymax=z;
<a name="l00276"></a>00276                 }
<a name="l00277"></a>00277 
<a name="l00278"></a>00278               <span class="keywordflow">if</span>(x&lt;x_xmin)
<a name="l00279"></a>00279                 {
<a name="l00280"></a>00280                   x_xmin=x;
<a name="l00281"></a>00281                   y_xmin=y;
<a name="l00282"></a>00282                   z_xmin=z;
<a name="l00283"></a>00283                 }
<a name="l00284"></a>00284               <span class="keywordflow">if</span>(x&gt;x_xmax)
<a name="l00285"></a>00285                 {
<a name="l00286"></a>00286                   x_xmax=x;
<a name="l00287"></a>00287                   y_xmax=y;
<a name="l00288"></a>00288                   z_xmax=z;
<a name="l00289"></a>00289                 }
<a name="l00290"></a>00290             }
<a name="l00291"></a>00291         }
<a name="l00292"></a>00292 
<a name="l00293"></a>00293       <span class="keywordflow">if</span>(!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(y_ymin,y_ymax))
<a name="l00294"></a>00294         {
<a name="l00295"></a>00295           dx=x_ymax-x_ymin;
<a name="l00296"></a>00296           dy=y_ymax-y_ymin;
<a name="l00297"></a>00297           dz=z_ymax-z_ymin;
<a name="l00298"></a>00298 
<a name="l00299"></a>00299           <a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a>=0.5*(x_ymax+x_ymin);
<a name="l00300"></a>00300           <a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a>=0.5*(y_ymax+y_ymin);
<a name="l00301"></a>00301           <a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a>=0.5*(z_ymax+z_ymin);
<a name="l00302"></a>00302         }
<a name="l00303"></a>00303       <span class="keywordflow">else</span>
<a name="l00304"></a>00304         {
<a name="l00305"></a>00305           dx=x_xmax-x_xmin;
<a name="l00306"></a>00306           dy=y_xmax-y_xmin;
<a name="l00307"></a>00307           dz=z_xmax-z_xmin;
<a name="l00308"></a>00308 
<a name="l00309"></a>00309           <a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a>=0.5*(x_xmax+x_xmin);
<a name="l00310"></a>00310           <a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a>=0.5*(y_xmax+y_xmin);
<a name="l00311"></a>00311           <a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a>=0.5*(z_xmax+z_xmin);
<a name="l00312"></a>00312         }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314       <a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a>=0.5*sqrt(dx*dx+dy*dy+dz*dz);
<a name="l00315"></a>00315 
<a name="l00316"></a>00316       <a class="code" href="classCh__front__Vortex.html#a60e3e8549826914c8a628bd62d58d28a">surf</a> = <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>*<a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a>*<a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a>;
<a name="l00317"></a>00317 
<a name="l00318"></a>00318       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Coordinates associated with the boundary : &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00319"></a>00319       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Radius computed : &quot;</span> &lt;&lt; R &lt;&lt; finl;
<a name="l00320"></a>00320 
<a name="l00321"></a>00321     }
<a name="l00322"></a>00322   <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classCh__front__Vortex.html#a4b66b4a94927c059c11c3764aee62305">geom</a>==<span class="stringliteral">&quot;channel&quot;</span>)
<a name="l00323"></a>00323     {
<a name="l00324"></a>00324 <span class="comment">// </span>
<a name="l00325"></a>00325 <span class="comment">// le canal est suppose etre oriente suivant x,</span>
<a name="l00326"></a>00326 <span class="comment">// periodique suivant z (et x)</span>
<a name="l00327"></a>00327 <span class="comment">// la frontiere d&#39;entree centree sur l&#39;origine</span>
<a name="l00328"></a>00328 <span class="comment">// de hauteur et largeur: 2</span>
<a name="l00329"></a>00329 <span class="comment">// soit (x,y,z) : [0;0]x[-1;+1]x[-1;+1]</span>
<a name="l00330"></a>00330 
<a name="l00331"></a>00331       <a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a>=1.;
<a name="l00332"></a>00332 
<a name="l00333"></a>00333       <a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a>=0.;
<a name="l00334"></a>00334       <a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a>=0.;
<a name="l00335"></a>00335       <a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a>=0.;
<a name="l00336"></a>00336 
<a name="l00337"></a>00337       <a class="code" href="classCh__front__Vortex.html#a60e3e8549826914c8a628bd62d58d28a">surf</a> = 4.;
<a name="l00338"></a>00338     }
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 <span class="comment">//</span>
<a name="l00341"></a>00341 <span class="comment">// repere local (t1;t2) associe a la frontiere (supposee plane)</span>
<a name="l00342"></a>00342 <span class="comment">//</span>
<a name="l00343"></a>00343   <span class="keywordflow">if</span> (nb_faces==0)
<a name="l00344"></a>00344     {
<a name="l00345"></a>00345       <a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>=0;
<a name="l00346"></a>00346     }
<a name="l00347"></a>00347   <span class="keywordflow">else</span>
<a name="l00348"></a>00348     {
<a name="l00349"></a>00349       <a class="code" href="classCh__front__Vortex.html#a91021e42dedf83492f54dcdf0ca3f38f">nx</a>=-zvf.<a class="code" href="classZone__VF.html#a547ab50904dc51bee39fed54a20934b2">face_normales</a>(ndeb,0);  <span class="comment">//!&lt; normales orientees vers l&#39;interieur du domaine</span>
<a name="l00350"></a>00350 <span class="comment"></span>      <a class="code" href="classCh__front__Vortex.html#ac84e3fefbdbb7554592d8eb86e92d21b">ny</a>=-zvf.<a class="code" href="classZone__VF.html#a547ab50904dc51bee39fed54a20934b2">face_normales</a>(ndeb,1);
<a name="l00351"></a>00351       <a class="code" href="classCh__front__Vortex.html#a564dc5d920963b14616451bec2abb86c" title="composantes normales du repere associe a la frontiere">nz</a>=-zvf.<a class="code" href="classZone__VF.html#a547ab50904dc51bee39fed54a20934b2">face_normales</a>(ndeb,2);
<a name="l00352"></a>00352 
<a name="l00353"></a>00353       norme = sqrt( <a class="code" href="classCh__front__Vortex.html#a91021e42dedf83492f54dcdf0ca3f38f">nx</a>*<a class="code" href="classCh__front__Vortex.html#a91021e42dedf83492f54dcdf0ca3f38f">nx</a> + <a class="code" href="classCh__front__Vortex.html#ac84e3fefbdbb7554592d8eb86e92d21b">ny</a>*<a class="code" href="classCh__front__Vortex.html#ac84e3fefbdbb7554592d8eb86e92d21b">ny</a> + <a class="code" href="classCh__front__Vortex.html#a564dc5d920963b14616451bec2abb86c" title="composantes normales du repere associe a la frontiere">nz</a>*<a class="code" href="classCh__front__Vortex.html#a564dc5d920963b14616451bec2abb86c" title="composantes normales du repere associe a la frontiere">nz</a> );
<a name="l00354"></a>00354 
<a name="l00355"></a>00355       <a class="code" href="classCh__front__Vortex.html#a91021e42dedf83492f54dcdf0ca3f38f">nx</a>/=<a class="code" href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a>;
<a name="l00356"></a>00356       <a class="code" href="classCh__front__Vortex.html#ac84e3fefbdbb7554592d8eb86e92d21b">ny</a>/=<a class="code" href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a>;
<a name="l00357"></a>00357       nz/=<a class="code" href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a>;
<a name="l00358"></a>00358 
<a name="l00359"></a>00359       <a class="code" href="classCh__front__Vortex.html#a43fc8d58e7e3600101e17cc3caf7fc5a">t1x</a> = -<a class="code" href="classCh__front__Vortex.html#ac84e3fefbdbb7554592d8eb86e92d21b">ny</a>;
<a name="l00360"></a>00360       <a class="code" href="classCh__front__Vortex.html#a56f1a9ae529336c92ba6e0f588a5bfed">t1y</a> =  <a class="code" href="classCh__front__Vortex.html#a91021e42dedf83492f54dcdf0ca3f38f">nx</a>;
<a name="l00361"></a>00361       <a class="code" href="classCh__front__Vortex.html#a099523bdd2f72e4167411221b82fc182" title="composantes tangentielles : n.t1 = 0">t1z</a> =  0.;
<a name="l00362"></a>00362 
<a name="l00363"></a>00363       <span class="keywordflow">if</span>( (<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(<a class="code" href="classCh__front__Vortex.html#a91021e42dedf83492f54dcdf0ca3f38f">nx</a>,0.)) &amp;&amp; (<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(<a class="code" href="classCh__front__Vortex.html#ac84e3fefbdbb7554592d8eb86e92d21b">ny</a>,0.)) )
<a name="l00364"></a>00364         {
<a name="l00365"></a>00365           <a class="code" href="classCh__front__Vortex.html#a43fc8d58e7e3600101e17cc3caf7fc5a">t1x</a> =  0.;
<a name="l00366"></a>00366           <a class="code" href="classCh__front__Vortex.html#a56f1a9ae529336c92ba6e0f588a5bfed">t1y</a> =  <a class="code" href="classCh__front__Vortex.html#a564dc5d920963b14616451bec2abb86c" title="composantes normales du repere associe a la frontiere">nz</a>;
<a name="l00367"></a>00367           <a class="code" href="classCh__front__Vortex.html#a099523bdd2f72e4167411221b82fc182" title="composantes tangentielles : n.t1 = 0">t1z</a> = -<a class="code" href="classCh__front__Vortex.html#ac84e3fefbdbb7554592d8eb86e92d21b">ny</a>;
<a name="l00368"></a>00368         }
<a name="l00369"></a>00369 
<a name="l00370"></a>00370       norme = sqrt( <a class="code" href="classCh__front__Vortex.html#a43fc8d58e7e3600101e17cc3caf7fc5a">t1x</a>*<a class="code" href="classCh__front__Vortex.html#a43fc8d58e7e3600101e17cc3caf7fc5a">t1x</a> + <a class="code" href="classCh__front__Vortex.html#a56f1a9ae529336c92ba6e0f588a5bfed">t1y</a>*<a class="code" href="classCh__front__Vortex.html#a56f1a9ae529336c92ba6e0f588a5bfed">t1y</a> + <a class="code" href="classCh__front__Vortex.html#a099523bdd2f72e4167411221b82fc182" title="composantes tangentielles : n.t1 = 0">t1z</a>*<a class="code" href="classCh__front__Vortex.html#a099523bdd2f72e4167411221b82fc182" title="composantes tangentielles : n.t1 = 0">t1z</a> );
<a name="l00371"></a>00371 
<a name="l00372"></a>00372       <a class="code" href="classCh__front__Vortex.html#a43fc8d58e7e3600101e17cc3caf7fc5a">t1x</a>/=<a class="code" href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a>;
<a name="l00373"></a>00373       <a class="code" href="classCh__front__Vortex.html#a56f1a9ae529336c92ba6e0f588a5bfed">t1y</a>/=<a class="code" href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a>;
<a name="l00374"></a>00374       t1z/=<a class="code" href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a>;
<a name="l00375"></a>00375 
<a name="l00376"></a>00376       <a class="code" href="classCh__front__Vortex.html#a01edecb605df54514c82f310d87f8736">t2x</a> =  <a class="code" href="classCh__front__Vortex.html#ac84e3fefbdbb7554592d8eb86e92d21b">ny</a>*t1z - nz*<a class="code" href="classCh__front__Vortex.html#a56f1a9ae529336c92ba6e0f588a5bfed">t1y</a>;
<a name="l00377"></a>00377       <a class="code" href="classCh__front__Vortex.html#a470851ff1a389033858eeb55173e25c6">t2y</a> =  nz*<a class="code" href="classCh__front__Vortex.html#a43fc8d58e7e3600101e17cc3caf7fc5a">t1x</a> - <a class="code" href="classCh__front__Vortex.html#a91021e42dedf83492f54dcdf0ca3f38f">nx</a>*<a class="code" href="classCh__front__Vortex.html#a099523bdd2f72e4167411221b82fc182" title="composantes tangentielles : n.t1 = 0">t1z</a>;
<a name="l00378"></a>00378       <a class="code" href="classCh__front__Vortex.html#a8c3a35fe1c8e8c9d0cfdaaf1388cd906" title="composantes tangentielles : t2 = n ^ t1 = 0">t2z</a> =  <a class="code" href="classCh__front__Vortex.html#a91021e42dedf83492f54dcdf0ca3f38f">nx</a>*t1y - <a class="code" href="classCh__front__Vortex.html#ac84e3fefbdbb7554592d8eb86e92d21b">ny</a>*<a class="code" href="classCh__front__Vortex.html#a43fc8d58e7e3600101e17cc3caf7fc5a">t1x</a>;
<a name="l00379"></a>00379       <span class="comment">/*</span>
<a name="l00380"></a>00380 <span class="comment">           Cerr &lt;&lt; &quot; t1x &quot; &lt;&lt; t1x &lt;&lt; finl;</span>
<a name="l00381"></a>00381 <span class="comment">           Cerr &lt;&lt; &quot; t1y &quot; &lt;&lt; t1y &lt;&lt; finl;</span>
<a name="l00382"></a>00382 <span class="comment">           Cerr &lt;&lt; &quot; t1z &quot; &lt;&lt; t1z &lt;&lt; finl;</span>
<a name="l00383"></a>00383 <span class="comment">           Cerr &lt;&lt; &quot; t2x &quot; &lt;&lt; t2x &lt;&lt; finl;</span>
<a name="l00384"></a>00384 <span class="comment">           Cerr &lt;&lt; &quot; t2y &quot; &lt;&lt; t2y &lt;&lt; finl;</span>
<a name="l00385"></a>00385 <span class="comment">           Cerr &lt;&lt; &quot; t2z &quot; &lt;&lt; t2z &lt;&lt; finl;</span>
<a name="l00386"></a>00386 <span class="comment">      */</span>
<a name="l00387"></a>00387 <span class="comment">//</span>
<a name="l00388"></a>00388 <span class="comment">// initialisation des champ de : vitesse - k - epsilon (analytique)</span>
<a name="l00389"></a>00389 <span class="comment">//</span>
<a name="l00390"></a>00390 
<a name="l00391"></a>00391       <span class="keywordtype">double</span> d,dplus,Reytau;
<a name="l00392"></a>00392       <span class="keywordtype">double</span> kappa = 0.41;
<a name="l00393"></a>00393       <span class="keywordtype">double</span> beta = 5.1;
<a name="l00394"></a>00394       <span class="keywordtype">double</span> tmp=15*15*15*15;
<a name="l00395"></a>00395       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> face=ndeb; face&lt;nfin; face++)
<a name="l00396"></a>00396         {
<a name="l00397"></a>00397           x=xv(face,0);
<a name="l00398"></a>00398           y=xv(face,1);
<a name="l00399"></a>00399           z=xv(face,2);
<a name="l00400"></a>00400 
<a name="l00401"></a>00401           dx=x-<a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a>;
<a name="l00402"></a>00402           dy=y-<a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a>;
<a name="l00403"></a>00403           dz=z-<a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a>;
<a name="l00404"></a>00404 
<a name="l00405"></a>00405           <span class="keywordflow">if</span>(<a class="code" href="classCh__front__Vortex.html#a4b66b4a94927c059c11c3764aee62305">geom</a>==<span class="stringliteral">&quot;circle&quot;</span>)
<a name="l00406"></a>00406             {
<a name="l00407"></a>00407               d = <a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a> - sqrt(dx*dx+dy*dy+dz*dz) ;  <span class="comment">//!&lt; distance a la paroi</span>
<a name="l00408"></a>00408 <span class="comment"></span>            }
<a name="l00409"></a>00409           <span class="keywordflow">else</span>
<a name="l00410"></a>00410             {
<a name="l00411"></a>00411               d = <a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a> - <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(y) ;  <span class="comment">//!&lt; distance a la paroi</span>
<a name="l00412"></a>00412 <span class="comment"></span>            }
<a name="l00413"></a>00413 
<a name="l00414"></a>00414           <span class="keywordflow">if</span>(d&lt;=0.)
<a name="l00415"></a>00415             {
<a name="l00416"></a>00416               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; the computation of a zero or negative distance is prejudicial for the rest of the calculation&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00417"></a>00417               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Problem certainly related to the calculation of the size of domain or origin related to the bondary&quot;</span> &lt;&lt; finl;
<a name="l00418"></a>00418               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00419"></a>00419             }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421           dplus   = d*<a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>/<a class="code" href="classCh__front__Vortex.html#a68b8c321eb0b486eddd2ff4354f1c07a">nu</a>;
<a name="l00422"></a>00422           Reytau  = <a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a>*<a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>/<a class="code" href="classCh__front__Vortex.html#a68b8c321eb0b486eddd2ff4354f1c07a">nu</a>;
<a name="l00423"></a>00423 
<a name="l00424"></a>00424           <span class="keywordflow">if</span>(dplus&lt;11.)
<a name="l00425"></a>00425             {
<a name="l00426"></a>00426               <a class="code" href="classCh__front__Vortex.html#a19bb41d9661e48bd6927ad3d20cae688">u_moy</a>(face) = <a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>*dplus ;
<a name="l00427"></a>00427             }
<a name="l00428"></a>00428           <span class="keywordflow">else</span>
<a name="l00429"></a>00429             {
<a name="l00430"></a>00430               <a class="code" href="classCh__front__Vortex.html#a19bb41d9661e48bd6927ad3d20cae688">u_moy</a>(face) = <a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>*((1./kappa)*log(dplus)+beta) ;
<a name="l00431"></a>00431             }
<a name="l00432"></a>00432 
<a name="l00433"></a>00433           <span class="keywordflow">if</span>(dplus&lt;11.)
<a name="l00434"></a>00434             {
<a name="l00435"></a>00435               <a class="code" href="classCh__front__Vortex.html#a09886efd56280aa9c775ef73ef474ad8">dudy</a>(face) = <a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>*<a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>/<a class="code" href="classCh__front__Vortex.html#a68b8c321eb0b486eddd2ff4354f1c07a">nu</a> ;  <span class="comment">//!&lt; -&gt; gradient dudy discontinu a dplus = 11</span>
<a name="l00436"></a>00436 <span class="comment"></span>            }
<a name="l00437"></a>00437           <span class="keywordflow">else</span>
<a name="l00438"></a>00438             {
<a name="l00439"></a>00439               <a class="code" href="classCh__front__Vortex.html#a09886efd56280aa9c775ef73ef474ad8">dudy</a>(face) = <a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>/(kappa*d) ;  <span class="comment">//!&lt; -&gt; genere une discontinuite sur u&#39; en cette position</span>
<a name="l00440"></a>00440 <span class="comment"></span>            }
<a name="l00441"></a>00441 
<a name="l00442"></a>00442           <a class="code" href="classCh__front__Vortex.html#aade11454b6fee45d63edd9a5b4ac6a30">k</a>(face)   = <a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>*<a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a> * ( 0.07*dplus*dplus*exp(-dplus/8)+4.5*(1.-exp(-dplus/20.))/(1.+4.*dplus/Reytau) ) ;
<a name="l00443"></a>00443           <a class="code" href="classCh__front__Vortex.html#a997c0f1f940d84ed0b69727b3e9d99cc">eps</a>(face) = (<a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>*<a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>*<a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>*<a class="code" href="classCh__front__Vortex.html#aff969476ae08c05b1f2051b95589f211">utau</a>/<a class="code" href="classCh__front__Vortex.html#a68b8c321eb0b486eddd2ff4354f1c07a">nu</a>) * (1./(0.41 *(pow(dplus*dplus*dplus*dplus+tmp,0.25)))) ;
<a name="l00444"></a>00444         }
<a name="l00445"></a>00445 
<a name="l00446"></a>00446       <a class="code" href="classCh__front__Vortex.html#a0846f4b090711d25226c15dea87ddc00">u</a> = <a class="code" href="classCh__front__Vortex.html#a19bb41d9661e48bd6927ad3d20cae688">u_moy</a>;
<a name="l00447"></a>00447 
<a name="l00448"></a>00448 <span class="comment">//</span>
<a name="l00449"></a>00449 <span class="comment">// evaluation du nombre de vortex</span>
<a name="l00450"></a>00450 <span class="comment">//</span>
<a name="l00451"></a>00451 
<a name="l00452"></a>00452       <span class="keywordtype">double</span> sigma_moy = 0.;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> face=ndeb; face&lt;nfin; face++)
<a name="l00455"></a>00455         {
<a name="l00456"></a>00456           <span class="keywordtype">double</span> sx=zvf.<a class="code" href="classZone__VF.html#a547ab50904dc51bee39fed54a20934b2">face_normales</a>(face,0);
<a name="l00457"></a>00457           <span class="keywordtype">double</span> sy=zvf.<a class="code" href="classZone__VF.html#a547ab50904dc51bee39fed54a20934b2">face_normales</a>(face,1);
<a name="l00458"></a>00458           <span class="keywordtype">double</span> <a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a>=zvf.<a class="code" href="classZone__VF.html#a547ab50904dc51bee39fed54a20934b2">face_normales</a>(face,2);
<a name="l00459"></a>00459 
<a name="l00460"></a>00460           sigma_moy += sqrt(sx*sx+sy*sy+sz*sz) * pow(<a class="code" href="classCh__front__Vortex.html#aade11454b6fee45d63edd9a5b4ac6a30">k</a>(face),1.5) / <a class="code" href="classCh__front__Vortex.html#a997c0f1f940d84ed0b69727b3e9d99cc">eps</a>(face);
<a name="l00461"></a>00461 
<a name="l00462"></a>00462         }
<a name="l00463"></a>00463       sigma_moy *= pow(C_mu,0.75);
<a name="l00464"></a>00464       sigma_moy /= <a class="code" href="classCh__front__Vortex.html#a60e3e8549826914c8a628bd62d58d28a">surf</a>;
<a name="l00465"></a>00465 <span class="comment">// On ne peut pas utiliser modf (voir Schema_Temps_base::limpr) car</span>
<a name="l00466"></a>00466 <span class="comment">// nb_vortex sert a dimensionner des tableaux !</span>
<a name="l00467"></a>00467       <a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a> = (int) ( <a class="code" href="classCh__front__Vortex.html#a60e3e8549826914c8a628bd62d58d28a">surf</a> / (<a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> * sigma_moy *sigma_moy) );
<a name="l00468"></a>00468     }
<a name="l00469"></a>00469   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;nb_vortex &quot;</span> &lt;&lt;<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00470"></a>00470 
<a name="l00471"></a>00471 <span class="comment">// nb_vortex=1;</span>
<a name="l00472"></a>00472 <span class="comment">// nb_vortex=nb_faces;</span>
<a name="l00473"></a>00473 
<a name="l00474"></a>00474   <a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>);
<a name="l00475"></a>00475   <a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>);
<a name="l00476"></a>00476   <a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>);
<a name="l00477"></a>00477   <a class="code" href="classCh__front__Vortex.html#ae5a10eed9c9b2b2f757430133581221c" title="durees de vie des vortex">tvort</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>);
<a name="l00478"></a>00478   <a class="code" href="classCh__front__Vortex.html#ad50d955e5f1d629f933b4c22717f6e23" title="signes de la vorticite des vortex">svort</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>);
<a name="l00479"></a>00479   <a class="code" href="classCh__front__Vortex.html#a891d07a8d676a6d17cbe43b94e0098a6" title="numero faces contenant le centre du vortex">fvort</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>);
<a name="l00480"></a>00480   <a class="code" href="classCh__front__Vortex.html#a0ed8dc0c07118c11d6efc8236fcf3623" title="intensite du vortex">gamma</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>);
<a name="l00481"></a>00481   <a class="code" href="classCh__front__Vortex.html#a3fe211ee1e9e813ffc28ad24efb3ed46" title="longeur caracteristique du vortex">sigma</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>);
<a name="l00482"></a>00482 
<a name="l00483"></a>00483 <span class="comment">//</span>
<a name="l00484"></a>00484 <span class="comment">// Calcul du temps de duree de vie minimum des vortex</span>
<a name="l00485"></a>00485 <span class="comment">//</span>
<a name="l00486"></a>00486 
<a name="l00487"></a>00487   <span class="keywordtype">double</span> dt_vortex,dt_min=1.e6;
<a name="l00488"></a>00488 
<a name="l00489"></a>00489   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_faces; i++) <span class="comment">//!&lt; estimation du dt_min requis</span>
<a name="l00490"></a>00490 <span class="comment"></span>    {
<a name="l00491"></a>00491       dt_vortex=5.*C_mu*pow(<a class="code" href="classCh__front__Vortex.html#aade11454b6fee45d63edd9a5b4ac6a30">k</a>(i),3./2.)/(<a class="code" href="classCh__front__Vortex.html#a997c0f1f940d84ed0b69727b3e9d99cc">eps</a>(i)*<a class="code" href="classCh__front__Vortex.html#a19bb41d9661e48bd6927ad3d20cae688">u_moy</a>(i));
<a name="l00492"></a>00492       <span class="keywordflow">if</span>(dt_vortex&lt;dt_min) dt_min=dt_vortex;
<a name="l00493"></a>00493     }
<a name="l00494"></a>00494 
<a name="l00495"></a>00495   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; DT_MIN VORTEX &quot;</span> &lt;&lt; dt_min &lt;&lt; finl;
<a name="l00496"></a>00496 
<a name="l00497"></a>00497 <span class="comment">//</span>
<a name="l00498"></a>00498 <span class="comment">// initialisation des vortex par tirage aleatoire</span>
<a name="l00499"></a>00499 <span class="comment">//</span>
<a name="l00500"></a>00500 
<a name="l00501"></a>00501   <span class="comment">/*</span>
<a name="l00502"></a>00502 <span class="comment">           for (int i=0;i&lt;nb_vortex;i++)  // random different a chaque nouveau tirage</span>
<a name="l00503"></a>00503 <span class="comment">           {</span>
<a name="l00504"></a>00504 <span class="comment">           int face = my_rand() % nb_faces;</span>
<a name="l00505"></a>00505 <span class="comment">           double rand1 = (my_rand() % 100)/100.;</span>
<a name="l00506"></a>00506 <span class="comment">           double rand2 = (my_rand() % 100)/100.;</span>
<a name="l00507"></a>00507 <span class="comment">           xvort(i)=xv(face,0);</span>
<a name="l00508"></a>00508 <span class="comment">           yvort(i)=xv(face,1);</span>
<a name="l00509"></a>00509 <span class="comment">           zvort(i)=xv(face,2);</span>
<a name="l00510"></a>00510 <span class="comment">           tvort(i)=rand1*5.*C_mu*pow(k(face),3./2.)/(eps(face)*u_moy(face));</span>
<a name="l00511"></a>00511 <span class="comment">           if (rand2&lt;0.5) svort(i)=-1.;</span>
<a name="l00512"></a>00512 <span class="comment">           else svort(i)=1.;</span>
<a name="l00513"></a>00513 <span class="comment"></span>
<a name="l00514"></a>00514 <span class="comment">           Cerr &lt;&lt; &quot; Vortex &quot; &lt;&lt; i &lt;&lt; finl;</span>
<a name="l00515"></a>00515 <span class="comment">           Cerr &lt;&lt; &quot; Face &quot; &lt;&lt; face &lt;&lt; &quot; &quot; &lt;&lt; xvort(i) &lt;&lt; &quot; &quot; &lt;&lt;yvort(i) &lt;&lt; &quot; &quot; &lt;&lt;zvort(i) &lt;&lt; finl;</span>
<a name="l00516"></a>00516 <span class="comment">           Cerr &lt;&lt;&quot; &quot; &lt;&lt; tvort(i) &lt;&lt; &quot; &quot; &lt;&lt;svort(i) &lt;&lt; finl;</span>
<a name="l00517"></a>00517 <span class="comment">           Cerr &lt;&lt; &quot; &quot; &lt;&lt; finl;</span>
<a name="l00518"></a>00518 <span class="comment"></span>
<a name="l00519"></a>00519 <span class="comment">           }</span>
<a name="l00520"></a>00520 <span class="comment">  */</span>
<a name="l00521"></a>00521 
<a name="l00522"></a>00522   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>; i++) <span class="comment">//!&lt; random identique a chaque nouveau tirage</span>
<a name="l00523"></a>00523 <span class="comment"></span>    {
<a name="l00524"></a>00524       <span class="keywordtype">int</span> face = (int)(nb_faces*drand48());
<a name="l00525"></a>00525       <a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i)=xv(face,0);
<a name="l00526"></a>00526       <a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i)=xv(face,1);
<a name="l00527"></a>00527       <a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i)=xv(face,2);
<a name="l00528"></a>00528       <a class="code" href="classCh__front__Vortex.html#ae5a10eed9c9b2b2f757430133581221c" title="durees de vie des vortex">tvort</a>(i)=drand48()*5.*C_mu*pow(<a class="code" href="classCh__front__Vortex.html#aade11454b6fee45d63edd9a5b4ac6a30">k</a>(face),3./2.)/(<a class="code" href="classCh__front__Vortex.html#a997c0f1f940d84ed0b69727b3e9d99cc">eps</a>(face)*<a class="code" href="classCh__front__Vortex.html#a19bb41d9661e48bd6927ad3d20cae688">u_moy</a>(face));
<a name="l00529"></a>00529       <span class="keywordflow">if</span> (drand48()&lt;0.5) <a class="code" href="classCh__front__Vortex.html#ad50d955e5f1d629f933b4c22717f6e23" title="signes de la vorticite des vortex">svort</a>(i)=-1.;
<a name="l00530"></a>00530       <span class="keywordflow">else</span> <a class="code" href="classCh__front__Vortex.html#ad50d955e5f1d629f933b4c22717f6e23" title="signes de la vorticite des vortex">svort</a>(i)=1.;
<a name="l00531"></a>00531       <span class="comment">/*</span>
<a name="l00532"></a>00532 <span class="comment">             Cerr &lt;&lt; &quot; Vortex &quot; &lt;&lt; i &lt;&lt; finl;</span>
<a name="l00533"></a>00533 <span class="comment">             Cerr &lt;&lt; &quot; Face &quot; &lt;&lt; face &lt;&lt; &quot; &quot; &lt;&lt; xvort(i) &lt;&lt; &quot; &quot; &lt;&lt;yvort(i) &lt;&lt; &quot; &quot; &lt;&lt;zvort(i) &lt;&lt; finl;</span>
<a name="l00534"></a>00534 <span class="comment">             Cerr &lt;&lt;&quot; &quot; &lt;&lt; tvort(i) &lt;&lt; &quot; &quot; &lt;&lt;svort(i) &lt;&lt; finl;</span>
<a name="l00535"></a>00535 <span class="comment">             Cerr &lt;&lt; &quot; &quot; &lt;&lt; finl;</span>
<a name="l00536"></a>00536 <span class="comment">      */</span>
<a name="l00537"></a>00537     }
<a name="l00538"></a>00538 
<a name="l00539"></a>00539   <a class="code" href="classCh__front__Vortex.html#a495c94cf9bb555fa738f8711fdf8ffa2" title="NE FAIT RIEN, a surcharger. Cette methode est appelee au debut de chaque pas de temps ou sous-pas-de-...">mettre_a_jour</a>(un_temps);
<a name="l00540"></a>00540 
<a name="l00541"></a>00541   <span class="keywordflow">return</span> 1;
<a name="l00542"></a>00542 }
<a name="l00543"></a>00543 
<a name="l00544"></a><a class="code" href="classCh__front__Vortex.html#a48f6931d124bdf881f851e982bb7500e">00544</a> <span class="keywordtype">void</span>  <a class="code" href="classCh__front__Vortex.html#a48f6931d124bdf881f851e982bb7500e">Ch_front_Vortex::deplacement_vortex</a>(<span class="keywordtype">double</span> dx,<span class="keywordtype">double</span> dy,<span class="keywordtype">double</span> dz,<span class="keywordtype">double</span> asigma,<span class="keywordtype">double</span> agamma,
<a name="l00545"></a>00545                                           <span class="keywordtype">double</span>&amp; vv,<span class="keywordtype">double</span>&amp; ww)
<a name="l00546"></a>00546 {
<a name="l00547"></a>00547   <span class="keywordtype">double</span> norme2 = dx*dx + dy*dy + dz*dz ;
<a name="l00548"></a>00548 
<a name="l00549"></a>00549   <span class="keywordflow">if</span>(norme2&lt;(4.*asigma) &amp;&amp; norme2&gt;1.e-8)
<a name="l00550"></a>00550     {
<a name="l00551"></a>00551       <span class="keywordtype">double</span> e1 = exp(-norme2/(2.*asigma*asigma));
<a name="l00552"></a>00552       <span class="keywordtype">double</span> f  = (1.-e1) * agamma * e1 / (2.* <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a> * norme2 );
<a name="l00553"></a>00553 
<a name="l00554"></a>00554       <span class="keywordtype">double</span> dt1 = dx*<a class="code" href="classCh__front__Vortex.html#a43fc8d58e7e3600101e17cc3caf7fc5a">t1x</a> + dy*<a class="code" href="classCh__front__Vortex.html#a56f1a9ae529336c92ba6e0f588a5bfed">t1y</a> + dz*<a class="code" href="classCh__front__Vortex.html#a099523bdd2f72e4167411221b82fc182" title="composantes tangentielles : n.t1 = 0">t1z</a> ;
<a name="l00555"></a>00555       <span class="keywordtype">double</span> dt2 = dx*<a class="code" href="classCh__front__Vortex.html#a01edecb605df54514c82f310d87f8736">t2x</a> + dy*<a class="code" href="classCh__front__Vortex.html#a470851ff1a389033858eeb55173e25c6">t2y</a> + dz*<a class="code" href="classCh__front__Vortex.html#a8c3a35fe1c8e8c9d0cfdaaf1388cd906" title="composantes tangentielles : t2 = n ^ t1 = 0">t2z</a> ;
<a name="l00556"></a>00556 
<a name="l00557"></a>00557       vv += dt2*f;
<a name="l00558"></a>00558       ww -= dt1*f;
<a name="l00559"></a>00559     }
<a name="l00560"></a>00560 }
<a name="l00561"></a>00561 
<a name="l00562"></a><a class="code" href="classCh__front__Vortex.html#a495c94cf9bb555fa738f8711fdf8ffa2">00562</a> <span class="keywordtype">void</span> <a class="code" href="classCh__front__Vortex.html#a495c94cf9bb555fa738f8711fdf8ffa2" title="NE FAIT RIEN, a surcharger. Cette methode est appelee au debut de chaque pas de temps ou sous-pas-de-...">Ch_front_Vortex::mettre_a_jour</a>(<span class="keywordtype">double</span> tps)
<a name="l00563"></a>00563 {
<a name="l00564"></a>00564   <span class="keyword">const</span> <a class="code" href="classFrontiere__dis__base.html" title="classe Frontiere_dis_base Classe representant une frontiere discretisee. Les objets Frontiere_dis_bas...">Frontiere_dis_base</a>&amp; fr_dis=<a class="code" href="classChamp__front__base.html#af5b3aaf468fe33492ed777c2e5772651" title="Renvoie la frontiere discretisee associee au champ. (version const)">frontiere_dis</a>();
<a name="l00565"></a>00565   <span class="keyword">const</span> <a class="code" href="classFrontiere.html" title="Classe Frontiere. Une Frontiere decrit une partie de la frontiere d&#39;une Zone, elle possede un Nom...">Frontiere</a>&amp; frontiere=fr_dis.<a class="code" href="classFrontiere__dis__base.html#a95f81b046cd23c8c8083ae03eebe93cd" title="Renvoie la frontiere geometrique associee. (version const)">frontiere</a>();
<a name="l00566"></a>00566   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces=frontiere.<a class="code" href="classFrontiere.html#aa073fe9dbdddde59471ee7032b256aa2" title="Renvoie le nombre de faces de la frontiere.">nb_faces</a>();
<a name="l00567"></a>00567   <span class="keyword">const</span> <span class="keywordtype">int</span> ndeb=frontiere.<a class="code" href="classFrontiere.html#a2a41c319a1530c984c356121e5ca2383">num_premiere_face</a>();
<a name="l00568"></a>00568   <span class="keyword">const</span> <span class="keywordtype">int</span> nfin=ndeb+nb_faces;
<a name="l00569"></a>00569   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; les_val=<a class="code" href="classChamp__front__base.html#a7d124849f85571b21d805a760deefdc0" title="Renvoie le tableau des valeurs du champ.">valeurs</a>();
<a name="l00570"></a>00570 
<a name="l00571"></a>00571   <span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zvf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, <a class="code" href="classChamp__front__base.html#a4cef320acc233b308e5241fc7c271145">zone_dis</a>());
<a name="l00572"></a>00572   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xv=zvf.<a class="code" href="classZone__VF.html#a918c0885a9b67317fcce3a0535306542">xv</a>();
<a name="l00573"></a>00573 
<a name="l00574"></a>00574   <span class="keywordtype">double</span> alpha=0;
<a name="l00575"></a>00575   <span class="keywordtype">double</span> dist,dist2;
<a name="l00576"></a>00576   <span class="keywordtype">double</span> x,yter,z;
<a name="l00577"></a>00577   <span class="keywordtype">double</span> xp,yp,zp;
<a name="l00578"></a>00578   <span class="keywordtype">double</span> xvort_mir,yvort_mir,zvort_mir;
<a name="l00579"></a>00579   <span class="keywordtype">double</span> xvort_per,yvort_per,zvort_per;
<a name="l00580"></a>00580   <span class="keywordtype">double</span> dx,dy,dz;
<a name="l00581"></a>00581 
<a name="l00582"></a>00582   <span class="keywordtype">double</span>  C_mu = 0.09;
<a name="l00583"></a>00583 
<a name="l00584"></a>00584   <span class="keywordflow">if</span>(<a class="code" href="classCh__front__Vortex.html#a1980beb61eb5e208d1ab0b0ee5c13369">init</a>)
<a name="l00585"></a>00585     {
<a name="l00586"></a>00586       <a class="code" href="classCh__front__Vortex.html#a1980beb61eb5e208d1ab0b0ee5c13369">init</a>=0;
<a name="l00587"></a>00587       <a class="code" href="classCh__front__Vortex.html#a376ac2bd95c3c04b062a8af069d2c9d0">temps</a>=tps;
<a name="l00588"></a>00588 
<a name="l00589"></a>00589       <span class="keywordflow">if</span>(<a class="code" href="classCh__front__Vortex.html#a376ac2bd95c3c04b062a8af069d2c9d0">temps</a>!=0.) <span class="comment">//!&lt; il s&#39;agit d&#39;une reprise</span>
<a name="l00590"></a>00590 <span class="comment"></span>        <a class="code" href="classCh__front__Vortex.html#a18cef59441f234a642d5cf7bff043ec1">reprendre_vortex</a>();
<a name="l00591"></a>00591     }
<a name="l00592"></a>00592 
<a name="l00593"></a>00593 <span class="comment">//</span>
<a name="l00594"></a>00594 <span class="comment">// caracteristiques des vortex (position-vorticite)</span>
<a name="l00595"></a>00595 <span class="comment">//</span>
<a name="l00596"></a>00596   <span class="keywordflow">if</span> (<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>!=0)
<a name="l00597"></a>00597     alpha = 4.*sqrt(<a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>*<a class="code" href="classCh__front__Vortex.html#a60e3e8549826914c8a628bd62d58d28a">surf</a>/(3.*<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>*(2.*log(3.)-3.*log(2.))));
<a name="l00598"></a>00598 
<a name="l00599"></a>00599   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>; i++)
<a name="l00600"></a>00600     {
<a name="l00601"></a>00601       x=<a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i);
<a name="l00602"></a>00602       yter=<a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i);
<a name="l00603"></a>00603       z=<a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i);
<a name="l00604"></a>00604 
<a name="l00605"></a>00605       dist=1.e6;
<a name="l00606"></a>00606       <span class="keywordtype">int</span> face=-1;
<a name="l00607"></a>00607 
<a name="l00608"></a>00608       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=ndeb; j&lt;nfin; j++)
<a name="l00609"></a>00609         {
<a name="l00610"></a>00610           dist2=(xv(j,0)-x)*(xv(j,0)-x)+(xv(j,1)-yter)*(xv(j,1)-yter)+(xv(j,2)-z)*(xv(j,2)-z);
<a name="l00611"></a>00611 
<a name="l00612"></a>00612           <span class="keywordflow">if</span>(dist2&lt;dist)
<a name="l00613"></a>00613             {
<a name="l00614"></a>00614               dist=dist2;
<a name="l00615"></a>00615               face=j;
<a name="l00616"></a>00616             }
<a name="l00617"></a>00617         }
<a name="l00618"></a>00618       <a class="code" href="classCh__front__Vortex.html#a0ed8dc0c07118c11d6efc8236fcf3623" title="intensite du vortex">gamma</a>(i)     = alpha * sqrt(<a class="code" href="classCh__front__Vortex.html#aade11454b6fee45d63edd9a5b4ac6a30">k</a>(face)) * <a class="code" href="classCh__front__Vortex.html#ad50d955e5f1d629f933b4c22717f6e23" title="signes de la vorticite des vortex">svort</a>(i);
<a name="l00619"></a>00619       <a class="code" href="classCh__front__Vortex.html#a3fe211ee1e9e813ffc28ad24efb3ed46" title="longeur caracteristique du vortex">sigma</a>(i)     = pow(C_mu,0.75) * pow(<a class="code" href="classCh__front__Vortex.html#aade11454b6fee45d63edd9a5b4ac6a30">k</a>(face),1.5) / <a class="code" href="classCh__front__Vortex.html#a997c0f1f940d84ed0b69727b3e9d99cc">eps</a>(face);
<a name="l00620"></a>00620       <a class="code" href="classCh__front__Vortex.html#a891d07a8d676a6d17cbe43b94e0098a6" title="numero faces contenant le centre du vortex">fvort</a>(i)     = face ;
<a name="l00621"></a>00621     }
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 <span class="comment">//</span>
<a name="l00624"></a>00624 <span class="comment">// calcul de la vitesse induite par les vortex en chacune des faces de la frontiere</span>
<a name="l00625"></a>00625 <span class="comment">//</span>
<a name="l00626"></a>00626 
<a name="l00627"></a>00627   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> face=ndeb; face&lt;nfin; face++)
<a name="l00628"></a>00628     {
<a name="l00629"></a>00629       x=xv(face,0);
<a name="l00630"></a>00630       yter=xv(face,1);
<a name="l00631"></a>00631       z=xv(face,2);
<a name="l00632"></a>00632 
<a name="l00633"></a>00633       x -= <a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a> ;  <span class="comment">//!&lt; ATTENTION : Pour des raisons pratiques,</span>
<a name="l00634"></a>00634 <span class="comment"></span>      yter -= <a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a> ;  <span class="comment">//!&lt; les coordonnees des points sont exprimees</span>
<a name="l00635"></a>00635 <span class="comment"></span>      z -= <a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a> ;  <span class="comment">//!&lt; en fonction de l&#39;origine Ox,Oy,Oz de la frontiere</span>
<a name="l00636"></a>00636 <span class="comment"></span>
<a name="l00637"></a>00637       <a class="code" href="classCh__front__Vortex.html#a7a1d86baf6bdcced9c2b408e71cf1834">v</a>(face) = 0.;  <span class="comment">//!&lt; vitesse induite par les vortex a la face suivant t1</span>
<a name="l00638"></a>00638 <span class="comment"></span>      <a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>(face) = 0.;  <span class="comment">//!&lt; vitesse induite par les vortex a la face suivant t2</span>
<a name="l00639"></a>00639 <span class="comment"></span>
<a name="l00640"></a>00640       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>; i++)
<a name="l00641"></a>00641         {
<a name="l00642"></a>00642           dx = (<a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i)-<a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a>) - x;
<a name="l00643"></a>00643           dy = (<a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i)-<a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a>) - yter;
<a name="l00644"></a>00644           dz = (<a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i)-<a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a>) - z;
<a name="l00645"></a>00645 
<a name="l00646"></a>00646           <a class="code" href="classCh__front__Vortex.html#a48f6931d124bdf881f851e982bb7500e">deplacement_vortex</a>(dx,dy,dz,<a class="code" href="classCh__front__Vortex.html#a3fe211ee1e9e813ffc28ad24efb3ed46" title="longeur caracteristique du vortex">sigma</a>(i),<a class="code" href="classCh__front__Vortex.html#a0ed8dc0c07118c11d6efc8236fcf3623" title="intensite du vortex">gamma</a>(i),<a class="code" href="classCh__front__Vortex.html#a7a1d86baf6bdcced9c2b408e71cf1834">v</a>(face),<a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>(face));
<a name="l00647"></a>00647 
<a name="l00648"></a>00648 
<a name="l00649"></a>00649 <span class="comment">//</span>
<a name="l00650"></a>00650 <span class="comment">// traitement des conditions limites</span>
<a name="l00651"></a>00651 <span class="comment">//</span>
<a name="l00652"></a>00652 
<a name="l00653"></a>00653           <span class="comment">//***************************************</span>
<a name="l00654"></a>00654           <span class="comment">// Parois : traitement des vortex miroirs</span>
<a name="l00655"></a>00655           <span class="comment">//***************************************</span>
<a name="l00656"></a>00656 
<a name="l00657"></a>00657           <span class="keywordflow">if</span>(<a class="code" href="classCh__front__Vortex.html#a4b66b4a94927c059c11c3764aee62305">geom</a>==<span class="stringliteral">&quot;circle&quot;</span>)
<a name="l00658"></a>00658             {
<a name="l00659"></a>00659               xp = x * <a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a> / (sqrt(x*x+yter*yter+z*z)) ;
<a name="l00660"></a>00660               yp = yter * <a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a> / (sqrt(x*x+yter*yter+z*z)) ;
<a name="l00661"></a>00661               zp = z * <a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a> / (sqrt(x*x+yter*yter+z*z)) ;
<a name="l00662"></a>00662             }
<a name="l00663"></a>00663           <span class="keywordflow">else</span> <span class="comment">//channel</span>
<a name="l00664"></a>00664             {
<a name="l00665"></a>00665               xp = x;
<a name="l00666"></a>00666               yp = <a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a>;
<a name="l00667"></a>00667               <span class="keywordflow">if</span>(yter&lt;0) yp = -<a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a>;
<a name="l00668"></a>00668               zp = z;
<a name="l00669"></a>00669             }
<a name="l00670"></a>00670 
<a name="l00671"></a>00671           xvort_mir = 2. * xp - (<a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i)-<a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a>);
<a name="l00672"></a>00672           yvort_mir = 2. * yp - (<a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i)-<a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a>);
<a name="l00673"></a>00673           zvort_mir = 2. * zp - (<a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i)-<a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a>);
<a name="l00674"></a>00674 
<a name="l00675"></a>00675           dx = xvort_mir - x;
<a name="l00676"></a>00676           dy = yvort_mir - yter;
<a name="l00677"></a>00677           dz = zvort_mir - z;
<a name="l00678"></a>00678 
<a name="l00679"></a>00679           <a class="code" href="classCh__front__Vortex.html#a48f6931d124bdf881f851e982bb7500e">deplacement_vortex</a>(dx,dy,dz,<a class="code" href="classCh__front__Vortex.html#a3fe211ee1e9e813ffc28ad24efb3ed46" title="longeur caracteristique du vortex">sigma</a>(i),<a class="code" href="classCh__front__Vortex.html#a0ed8dc0c07118c11d6efc8236fcf3623" title="intensite du vortex">gamma</a>(i),<a class="code" href="classCh__front__Vortex.html#a7a1d86baf6bdcced9c2b408e71cf1834">v</a>(face),<a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>(face));
<a name="l00680"></a>00680 
<a name="l00681"></a>00681 
<a name="l00682"></a>00682           <span class="comment">//***************************************</span>
<a name="l00683"></a>00683           <span class="comment">// Periodicite : canal plan uniquement</span>
<a name="l00684"></a>00684           <span class="comment">//***************************************</span>
<a name="l00685"></a>00685 
<a name="l00686"></a>00686           <span class="keywordflow">if</span>(<a class="code" href="classCh__front__Vortex.html#a4b66b4a94927c059c11c3764aee62305">geom</a>==<span class="stringliteral">&quot;channel&quot;</span>)
<a name="l00687"></a>00687             {
<a name="l00688"></a>00688 
<a name="l00689"></a>00689               xvort_per = (<a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i)-<a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a>);
<a name="l00690"></a>00690               yvort_per = (<a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i)-<a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a>);
<a name="l00691"></a>00691               <span class="keywordflow">if</span>( (<a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i)-<a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a>) &gt;0.) zvort_per = -2.*<a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a> + (<a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i)-<a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a>) ;
<a name="l00692"></a>00692               <span class="keywordflow">else</span>                            zvort_per =  2.*<a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a> + (<a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i)-<a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a>);
<a name="l00693"></a>00693 
<a name="l00694"></a>00694               dx = xvort_per - x;
<a name="l00695"></a>00695               dy = yvort_per - yter;
<a name="l00696"></a>00696               dz = zvort_per - z;
<a name="l00697"></a>00697 
<a name="l00698"></a>00698               <a class="code" href="classCh__front__Vortex.html#a48f6931d124bdf881f851e982bb7500e">deplacement_vortex</a>(dx,dy,dz,<a class="code" href="classCh__front__Vortex.html#a3fe211ee1e9e813ffc28ad24efb3ed46" title="longeur caracteristique du vortex">sigma</a>(i),<a class="code" href="classCh__front__Vortex.html#a0ed8dc0c07118c11d6efc8236fcf3623" title="intensite du vortex">gamma</a>(i),<a class="code" href="classCh__front__Vortex.html#a7a1d86baf6bdcced9c2b408e71cf1834">v</a>(face),<a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>(face));
<a name="l00699"></a>00699 
<a name="l00700"></a>00700             }
<a name="l00701"></a>00701 
<a name="l00702"></a>00702         }<span class="comment">//boucle sur vortex</span>
<a name="l00703"></a>00703 
<a name="l00704"></a>00704 <span class="comment"></span>
<a name="l00705"></a>00705 <span class="comment">      ////////////////////////////////////////////////////////////////////////////</span>
<a name="l00706"></a>00706 <span class="comment"></span>      <span class="comment">// calcul de la fluctuation de vitesse logitudinale par equation de Langevin</span><span class="comment"></span>
<a name="l00707"></a>00707 <span class="comment">      ////////////////////////////////////////////////////////////////////////////</span>
<a name="l00708"></a>00708 <span class="comment"></span>
<a name="l00709"></a>00709 
<a name="l00710"></a>00710       <span class="comment">//     double up = u(face) - u_moy(face);</span>
<a name="l00711"></a>00711       <span class="keywordtype">double</span> up= <a class="code" href="classCh__front__Vortex.html#a0846f4b090711d25226c15dea87ddc00">u</a>(face);
<a name="l00712"></a>00712       <span class="keywordflow">if</span>(tps==0.) up=0.;
<a name="l00713"></a>00713       <span class="keywordtype">double</span> vp;
<a name="l00714"></a>00714 
<a name="l00715"></a>00715       <span class="keywordflow">if</span>(<a class="code" href="classCh__front__Vortex.html#a4b66b4a94927c059c11c3764aee62305">geom</a>==<span class="stringliteral">&quot;channel&quot;</span>) vp = <a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>(face);
<a name="l00716"></a>00716       <span class="keywordflow">else</span> <span class="comment">//(geom==&quot;circle&quot;)</span>
<a name="l00717"></a>00717         {
<a name="l00718"></a>00718           <span class="keywordtype">double</span> <a class="code" href="Double_8h.html#ac842198e9490fae75825cab2a03eed2d">norme</a> = sqrt(x*x+yter*yter+z*z);
<a name="l00719"></a>00719           <span class="keywordtype">double</span> costheta = ( x*<a class="code" href="classCh__front__Vortex.html#a43fc8d58e7e3600101e17cc3caf7fc5a">t1x</a> + yter*<a class="code" href="classCh__front__Vortex.html#a56f1a9ae529336c92ba6e0f588a5bfed">t1y</a> + z*<a class="code" href="classCh__front__Vortex.html#a099523bdd2f72e4167411221b82fc182" title="composantes tangentielles : n.t1 = 0">t1z</a> ) / norme;
<a name="l00720"></a>00720           <span class="keywordtype">double</span> sintheta = ( x*<a class="code" href="classCh__front__Vortex.html#a01edecb605df54514c82f310d87f8736">t2x</a> + yter*<a class="code" href="classCh__front__Vortex.html#a470851ff1a389033858eeb55173e25c6">t2y</a> + z*<a class="code" href="classCh__front__Vortex.html#a8c3a35fe1c8e8c9d0cfdaaf1388cd906" title="composantes tangentielles : t2 = n ^ t1 = 0">t2z</a> ) / norme;
<a name="l00721"></a>00721           vp = costheta*<a class="code" href="classCh__front__Vortex.html#a7a1d86baf6bdcced9c2b408e71cf1834">v</a>(face) + sintheta*<a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>(face) ;
<a name="l00722"></a>00722         }
<a name="l00723"></a>00723 <span class="comment"></span>
<a name="l00724"></a>00724 <span class="comment">      ///// processus de Wiener : tirage aleatoire &quot;gaussien&quot; verifiant &lt;dW&gt;=0 et &lt;dW^2&gt;=1 /////////</span>
<a name="l00725"></a>00725 <span class="comment">      /////</span>
<a name="l00726"></a>00726 <span class="comment">      ///// http://www.taygeta.com/random/gaussian.html</span>
<a name="l00727"></a>00727 <span class="comment"></span>
<a name="l00728"></a>00728       <span class="keywordtype">double</span> x1,x2,ybis,Wkp1,dW;
<a name="l00729"></a>00729 
<a name="l00730"></a>00730       <span class="keywordflow">do</span>
<a name="l00731"></a>00731         {
<a name="l00732"></a>00732           x1 = 2. * drand48() - 1. ;
<a name="l00733"></a>00733           x2 = 2. * drand48() - 1. ;
<a name="l00734"></a>00734           ybis = x1 * x1 + x2 * x2;
<a name="l00735"></a>00735         }
<a name="l00736"></a>00736       <span class="keywordflow">while</span> ( ybis &gt;= 1. );
<a name="l00737"></a>00737 
<a name="l00738"></a>00738       Wkp1     =  x1 * sqrt( (-1.0 * log( ybis ) ) / ybis );  <span class="comment">// On travaille sur dW -&gt; pour assurer &lt;dW^2&gt;=1, on doit modifier le coef</span>
<a name="l00739"></a>00739       dW       =  Wkp1 - <a class="code" href="classCh__front__Vortex.html#abbcf4852e88ad3d92c0868a8de6ad67d" title="processus de Wiener">Wk</a>(face) ;                       <span class="comment">// par rapport a la formulation proposee dans &#39;taygeta&#39;</span>
<a name="l00740"></a>00740       <a class="code" href="classCh__front__Vortex.html#abbcf4852e88ad3d92c0868a8de6ad67d" title="processus de Wiener">Wk</a>(face) =  Wkp1 ;
<a name="l00741"></a>00741 
<a name="l00742"></a>00742       <span class="comment">/*</span>
<a name="l00743"></a>00743 <span class="comment">        double Wkp1,dW;</span>
<a name="l00744"></a>00744 <span class="comment"></span>
<a name="l00745"></a>00745 <span class="comment">        Wkp1     =  2.*drand48()-1.;</span>
<a name="l00746"></a>00746 <span class="comment">        dW       = (Wkp1 - Wk(face))*sqrt(3./2.) ;</span>
<a name="l00747"></a>00747 <span class="comment">        Wk(face) =  Wkp1 ;</span>
<a name="l00748"></a>00748 <span class="comment"></span>
<a name="l00749"></a>00749 <span class="comment"></span>
<a name="l00750"></a>00750 <span class="comment">        double W,Wp1,dW;</span>
<a name="l00751"></a>00751 <span class="comment">        W     =  2.*drand48()-1.;</span>
<a name="l00752"></a>00752 <span class="comment">        Wp1   =  2.*drand48()-1.;</span>
<a name="l00753"></a>00753 <span class="comment">        dW    = (Wp1 - W)*sqrt(3./2.) ;</span>
<a name="l00754"></a>00754 <span class="comment">      */</span>
<a name="l00755"></a>00755 
<a name="l00756"></a>00756 <span class="comment"></span>
<a name="l00757"></a>00757 <span class="comment">      //////////////////////////////////</span>
<a name="l00758"></a>00758 <span class="comment"></span>
<a name="l00759"></a>00759       <span class="keywordtype">double</span> C0,C1,C2;
<a name="l00760"></a>00760 
<a name="l00761"></a>00761       C0=14./15.;
<a name="l00762"></a>00762       C1=1.8;
<a name="l00763"></a>00763       C2=0.6;
<a name="l00764"></a>00764 
<a name="l00765"></a>00765       <span class="keywordtype">double</span> T=<a class="code" href="classCh__front__Vortex.html#aade11454b6fee45d63edd9a5b4ac6a30">k</a>(face)/<a class="code" href="classCh__front__Vortex.html#a997c0f1f940d84ed0b69727b3e9d99cc">eps</a>(face);
<a name="l00766"></a>00766 
<a name="l00767"></a>00767       <span class="keywordtype">double</span> dt = tps - <a class="code" href="classCh__front__Vortex.html#a376ac2bd95c3c04b062a8af069d2c9d0">temps</a>;
<a name="l00768"></a>00768 
<a name="l00769"></a>00769       <span class="keywordflow">if</span>(dt!=0.) <span class="comment">// codage conforme a these Sergent + papier eDF (au coef 2/3 pres vis-a-vis de C2)</span>
<a name="l00770"></a>00770         {
<a name="l00771"></a>00771           up += dt*( -(C1/(2.*T))*up  + (C2-1.)*<a class="code" href="classCh__front__Vortex.html#a09886efd56280aa9c775ef73ef474ad8">dudy</a>(face)*vp + sqrt(C0*<a class="code" href="classCh__front__Vortex.html#a997c0f1f940d84ed0b69727b3e9d99cc">eps</a>(face))*dW/dt );
<a name="l00772"></a>00772 
<a name="l00773"></a>00773           <span class="comment">//        up += dt*( -(C1/(2.*T))*up  + ((2./3.)*C2-1.)*dudy(face)*vp + sqrt(C0*eps(face))*dW/dt );</span>
<a name="l00774"></a>00774         }
<a name="l00775"></a>00775       <span class="comment">/*</span>
<a name="l00776"></a>00776 <span class="comment">             if(dt!=0.) // codage conforme a ce qui est code dans Saturne</span>
<a name="l00777"></a>00777 <span class="comment">             {</span>
<a name="l00778"></a>00778 <span class="comment">             up += dt*(-(1.-(2./3.)*C2)*dudy(face)*vp)  + 2.*sqrt((2./3.)*(C1-1.)*eps(face)*dt)*dW;</span>
<a name="l00779"></a>00779 <span class="comment">             up /= (1.+5.*C1*dt/T);</span>
<a name="l00780"></a>00780 <span class="comment">             }</span>
<a name="l00781"></a>00781 <span class="comment">      */</span>
<a name="l00782"></a>00782 
<a name="l00783"></a>00783       <span class="comment">//     u(face) = u_moy(face) + up;</span>
<a name="l00784"></a>00784       <a class="code" href="classCh__front__Vortex.html#a0846f4b090711d25226c15dea87ddc00">u</a>(face) = up;
<a name="l00785"></a>00785 
<a name="l00786"></a>00786 
<a name="l00787"></a>00787       les_val(face,0) = <a class="code" href="classCh__front__Vortex.html#a0846f4b090711d25226c15dea87ddc00">u</a>(face)*<a class="code" href="classCh__front__Vortex.html#a91021e42dedf83492f54dcdf0ca3f38f">nx</a> + <a class="code" href="classCh__front__Vortex.html#a7a1d86baf6bdcced9c2b408e71cf1834">v</a>(face)*<a class="code" href="classCh__front__Vortex.html#a43fc8d58e7e3600101e17cc3caf7fc5a">t1x</a> + <a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>(face)*<a class="code" href="classCh__front__Vortex.html#a01edecb605df54514c82f310d87f8736">t2x</a> ;
<a name="l00788"></a>00788       les_val(face,1) = <a class="code" href="classCh__front__Vortex.html#a0846f4b090711d25226c15dea87ddc00">u</a>(face)*<a class="code" href="classCh__front__Vortex.html#ac84e3fefbdbb7554592d8eb86e92d21b">ny</a> + <a class="code" href="classCh__front__Vortex.html#a7a1d86baf6bdcced9c2b408e71cf1834">v</a>(face)*<a class="code" href="classCh__front__Vortex.html#a56f1a9ae529336c92ba6e0f588a5bfed">t1y</a> + <a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>(face)*<a class="code" href="classCh__front__Vortex.html#a470851ff1a389033858eeb55173e25c6">t2y</a> ;
<a name="l00789"></a>00789       les_val(face,2) = <a class="code" href="classCh__front__Vortex.html#a0846f4b090711d25226c15dea87ddc00">u</a>(face)*<a class="code" href="classCh__front__Vortex.html#a564dc5d920963b14616451bec2abb86c" title="composantes normales du repere associe a la frontiere">nz</a> + <a class="code" href="classCh__front__Vortex.html#a7a1d86baf6bdcced9c2b408e71cf1834">v</a>(face)*<a class="code" href="classCh__front__Vortex.html#a099523bdd2f72e4167411221b82fc182" title="composantes tangentielles : n.t1 = 0">t1z</a> + <a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>(face)*<a class="code" href="classCh__front__Vortex.html#a8c3a35fe1c8e8c9d0cfdaaf1388cd906" title="composantes tangentielles : t2 = n ^ t1 = 0">t2z</a> ;
<a name="l00790"></a>00790 
<a name="l00791"></a>00791       <span class="comment">/*</span>
<a name="l00792"></a>00792 <span class="comment">        les_val(face,0) =  gamma(face) ;</span>
<a name="l00793"></a>00793 <span class="comment">        les_val(face,1) =  sigma(face) ;</span>
<a name="l00794"></a>00794 <span class="comment">        les_val(face,2) =  fvort(face) ;</span>
<a name="l00795"></a>00795 <span class="comment"></span>
<a name="l00796"></a>00796 <span class="comment">        les_val(face,0) =  k(face)  ;</span>
<a name="l00797"></a>00797 <span class="comment">        les_val(face,1) =  eps(face)  ;</span>
<a name="l00798"></a>00798 <span class="comment">        les_val(face,2) =  u_moy(face)  ;</span>
<a name="l00799"></a>00799 <span class="comment"></span>
<a name="l00800"></a>00800 <span class="comment">      */</span>
<a name="l00801"></a>00801     }<span class="comment">//boucle sur face</span>
<a name="l00802"></a>00802 
<a name="l00803"></a>00803 <span class="comment"></span>
<a name="l00804"></a>00804 <span class="comment">  //////////////////////////</span>
<a name="l00805"></a>00805 <span class="comment"></span>  <span class="comment">// deplacement des vortex</span><span class="comment"></span>
<a name="l00806"></a>00806 <span class="comment">  //////////////////////////</span>
<a name="l00807"></a>00807 <span class="comment"></span>
<a name="l00808"></a>00808 
<a name="l00809"></a>00809   <span class="keywordtype">double</span> dt = tps - <a class="code" href="classCh__front__Vortex.html#a376ac2bd95c3c04b062a8af069d2c9d0">temps</a>;
<a name="l00810"></a>00810   temps=tps;
<a name="l00811"></a>00811 
<a name="l00812"></a>00812 
<a name="l00813"></a>00813   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>; i++)
<a name="l00814"></a>00814     {
<a name="l00815"></a>00815       <span class="keywordtype">int</span> face = <a class="code" href="classCh__front__Vortex.html#a891d07a8d676a6d17cbe43b94e0098a6" title="numero faces contenant le centre du vortex">fvort</a>(i);
<a name="l00816"></a>00816 
<a name="l00817"></a>00817       x = <a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i) + dt * ( <a class="code" href="classCh__front__Vortex.html#a7a1d86baf6bdcced9c2b408e71cf1834">v</a>(face)*<a class="code" href="classCh__front__Vortex.html#a43fc8d58e7e3600101e17cc3caf7fc5a">t1x</a> + <a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>(face)*<a class="code" href="classCh__front__Vortex.html#a01edecb605df54514c82f310d87f8736">t2x</a> ); <span class="comment">// Les deplacements des vortex ne s&#39;operent</span>
<a name="l00818"></a>00818       yter = <a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i) + dt * ( <a class="code" href="classCh__front__Vortex.html#a7a1d86baf6bdcced9c2b408e71cf1834">v</a>(face)*<a class="code" href="classCh__front__Vortex.html#a56f1a9ae529336c92ba6e0f588a5bfed">t1y</a> + <a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>(face)*<a class="code" href="classCh__front__Vortex.html#a470851ff1a389033858eeb55173e25c6">t2y</a> ); <span class="comment">// que dans le plan d&#39;entree. D&#39;ou les composantes</span>
<a name="l00819"></a>00819       z = <a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i) + dt * ( <a class="code" href="classCh__front__Vortex.html#a7a1d86baf6bdcced9c2b408e71cf1834">v</a>(face)*<a class="code" href="classCh__front__Vortex.html#a099523bdd2f72e4167411221b82fc182" title="composantes tangentielles : n.t1 = 0">t1z</a> + <a class="code" href="classCh__front__Vortex.html#a0d727a366ebaedd2fde4a68597b21e0d">w</a>(face)*<a class="code" href="classCh__front__Vortex.html#a8c3a35fe1c8e8c9d0cfdaaf1388cd906" title="composantes tangentielles : t2 = n ^ t1 = 0">t2z</a> ); <span class="comment">// u.n proscrites</span>
<a name="l00820"></a>00820 
<a name="l00821"></a>00821       x -= <a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a> ;  <span class="comment">// ATTENTION : Pour des raisons pratiques,</span>
<a name="l00822"></a>00822       yter -= <a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a> ;  <span class="comment">// les coordonnees des points sont exprimees</span>
<a name="l00823"></a>00823       z -= <a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a> ;  <span class="comment">// en fonction de l&#39;origine Ox,Oy,Oz de la frontiere</span>
<a name="l00824"></a>00824 
<a name="l00825"></a>00825 
<a name="l00826"></a>00826       <span class="keywordflow">if</span>( (<a class="code" href="classCh__front__Vortex.html#a4b66b4a94927c059c11c3764aee62305">geom</a>==<span class="stringliteral">&quot;circle&quot;</span>) &amp;&amp; ((x*x+yter*yter+z*z)&gt;=(<a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a>*<a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a>)) ) <span class="comment">//paroi</span>
<a name="l00827"></a>00827         {
<a name="l00828"></a>00828           <span class="comment">// paroi : On ne fait rien - on laisse le vortex a sa position</span>
<a name="l00829"></a>00829         }
<a name="l00830"></a>00830       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( (<a class="code" href="classCh__front__Vortex.html#a4b66b4a94927c059c11c3764aee62305">geom</a>==<span class="stringliteral">&quot;channel&quot;</span>) &amp;&amp; (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(yter)&gt;<a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a>) ) <span class="comment">//paroi</span>
<a name="l00831"></a>00831         {
<a name="l00832"></a>00832           <span class="comment">// paroi : On ne fait rien - on laisse le vortex a sa position</span>
<a name="l00833"></a>00833         }
<a name="l00834"></a>00834       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( (<a class="code" href="classCh__front__Vortex.html#a4b66b4a94927c059c11c3764aee62305">geom</a>==<span class="stringliteral">&quot;channel&quot;</span>) &amp;&amp; (z&gt;<a class="code" href="classCh__front__Vortex.html#a16b43b062f4110cde2df1fbeae031193">R</a>) ) <span class="comment">//periodicite</span>
<a name="l00835"></a>00835         {
<a name="l00836"></a>00836           <a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i) = x + <a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a>;
<a name="l00837"></a>00837           <a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i) = yter + <a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a>;
<a name="l00838"></a>00838           <a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i) = -2.*R + z + <a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a>;
<a name="l00839"></a>00839         }
<a name="l00840"></a>00840       <span class="keywordflow">else</span> <span class="keywordflow">if</span>( (<a class="code" href="classCh__front__Vortex.html#a4b66b4a94927c059c11c3764aee62305">geom</a>==<span class="stringliteral">&quot;channel&quot;</span>) &amp;&amp; (z&lt;-R) ) <span class="comment">//periodicite</span>
<a name="l00841"></a>00841         {
<a name="l00842"></a>00842           <a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i) = x + <a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a>;
<a name="l00843"></a>00843           <a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i) = yter + <a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a>;
<a name="l00844"></a>00844           <a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i) = 2.*R - z + <a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a>;
<a name="l00845"></a>00845         }
<a name="l00846"></a>00846       <span class="keywordflow">else</span>
<a name="l00847"></a>00847         {
<a name="l00848"></a>00848           <a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i) = x + <a class="code" href="classCh__front__Vortex.html#a41eb08eb8463c283209a7c58e552ce6c">Ox</a>;
<a name="l00849"></a>00849           <a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i) = yter + <a class="code" href="classCh__front__Vortex.html#a24d48d6095eaf1593b69e6f575a7b14a">Oy</a>;
<a name="l00850"></a>00850           <a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i) = z + <a class="code" href="classCh__front__Vortex.html#a3f58c89bae14607751e0b9872e40e6be">Oz</a>;
<a name="l00851"></a>00851         }
<a name="l00852"></a>00852     }
<a name="l00853"></a>00853 <span class="comment"></span>
<a name="l00854"></a>00854 <span class="comment">  ///////////////////////////////////////////////////////</span>
<a name="l00855"></a>00855 <span class="comment"></span>  <span class="comment">// fin de vie des vortex - generation de nouveau vortex</span><span class="comment"></span>
<a name="l00856"></a>00856 <span class="comment">  ///////////////////////////////////////////////////////</span>
<a name="l00857"></a>00857 <span class="comment"></span>
<a name="l00858"></a>00858   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classCh__front__Vortex.html#aab9ce519993217a789250b332dd47380">nb_vortex</a>; i++)
<a name="l00859"></a>00859     {
<a name="l00860"></a>00860       <a class="code" href="classCh__front__Vortex.html#ae5a10eed9c9b2b2f757430133581221c" title="durees de vie des vortex">tvort</a>(i) -= dt ;
<a name="l00861"></a>00861 
<a name="l00862"></a>00862       <span class="keywordflow">if</span>(<a class="code" href="classCh__front__Vortex.html#ae5a10eed9c9b2b2f757430133581221c" title="durees de vie des vortex">tvort</a>(i)&lt;=0.)<span class="comment">// fin de vie du vortex</span>
<a name="l00863"></a>00863         {
<a name="l00864"></a>00864           <span class="comment">/*</span>
<a name="l00865"></a>00865 <span class="comment">            int face = my_rand() % nb_faces;            // random different a chaque nouveau tirage</span>
<a name="l00866"></a>00866 <span class="comment">            //       double rand1 = (my_rand() % 100)/100.;</span>
<a name="l00867"></a>00867 <span class="comment">            double rand2 = (my_rand() % 100)/100.;</span>
<a name="l00868"></a>00868 <span class="comment">            xvort(i)=xv(face,0);</span>
<a name="l00869"></a>00869 <span class="comment">            yvort(i)=xv(face,1);</span>
<a name="l00870"></a>00870 <span class="comment">            zvort(i)=xv(face,2);</span>
<a name="l00871"></a>00871 <span class="comment">            tvort(i)=5.*C_mu*pow(k(face),3./2.)/(eps(face)*u_moy(face));</span>
<a name="l00872"></a>00872 <span class="comment">            if (rand2&lt;0.5) svort(i)=-1.;</span>
<a name="l00873"></a>00873 <span class="comment">            else svort(i)=1.;</span>
<a name="l00874"></a>00874 <span class="comment">          */</span>
<a name="l00875"></a>00875           <span class="keywordtype">int</span> face = (int)(nb_faces*drand48());       <span class="comment">// random identique a chaque execution</span>
<a name="l00876"></a>00876           <a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i)=xv(face,0);
<a name="l00877"></a>00877           <a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i)=xv(face,1);
<a name="l00878"></a>00878           <a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i)=xv(face,2);
<a name="l00879"></a>00879           <a class="code" href="classCh__front__Vortex.html#ae5a10eed9c9b2b2f757430133581221c" title="durees de vie des vortex">tvort</a>(i)=5.*C_mu*pow(<a class="code" href="classCh__front__Vortex.html#aade11454b6fee45d63edd9a5b4ac6a30">k</a>(face),3./2.)/(<a class="code" href="classCh__front__Vortex.html#a997c0f1f940d84ed0b69727b3e9d99cc">eps</a>(face)*<a class="code" href="classCh__front__Vortex.html#a19bb41d9661e48bd6927ad3d20cae688">u_moy</a>(face));
<a name="l00880"></a>00880           <span class="keywordflow">if</span> (drand48()&lt;0.5) <a class="code" href="classCh__front__Vortex.html#ad50d955e5f1d629f933b4c22717f6e23" title="signes de la vorticite des vortex">svort</a>(i)=-1.;
<a name="l00881"></a>00881           <span class="keywordflow">else</span> <a class="code" href="classCh__front__Vortex.html#ad50d955e5f1d629f933b4c22717f6e23" title="signes de la vorticite des vortex">svort</a>(i)=1.;
<a name="l00882"></a>00882 
<a name="l00883"></a>00883           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Time &quot;</span> &lt;&lt; temps &lt;&lt; <span class="stringliteral">&quot; Vortex &quot;</span> &lt;&lt; i &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00884"></a>00884           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Face &quot;</span> &lt;&lt; face &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#a0f15996c97c5735956567a1cd60bf3fe" title="coordonnees x des vortex">xvort</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;<a class="code" href="classCh__front__Vortex.html#a8e4b9768f916a2fbb7759d32f71edeff" title="coordonnees y des vortex">yvort</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;<a class="code" href="classCh__front__Vortex.html#af396e06d71941410be471ba794912655" title="coordonnees z des vortex">zvort</a>(i) &lt;&lt; finl;
<a name="l00885"></a>00885           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt;<span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classCh__front__Vortex.html#ae5a10eed9c9b2b2f757430133581221c" title="durees de vie des vortex">tvort</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;<a class="code" href="classCh__front__Vortex.html#ad50d955e5f1d629f933b4c22717f6e23" title="signes de la vorticite des vortex">svort</a>(i) &lt;&lt; finl;
<a name="l00886"></a>00886           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; finl;
<a name="l00887"></a>00887         }
<a name="l00888"></a>00888     }
<a name="l00889"></a>00889 }
<a name="l00890"></a>00890 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:12 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
