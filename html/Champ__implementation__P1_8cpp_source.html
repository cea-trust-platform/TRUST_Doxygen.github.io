<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Champs_dis/Champ_implementation_P1.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Champs_dis/Champ_implementation_P1.cpp</div>  </div>
</div>
<div class="contents">
<a href="Champ__implementation__P1_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Champ_implementation_P1.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Champs_dis</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/17</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Champ__implementation__P1_8h.html">Champ_implementation_P1.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Octree__Double_8h.html">Octree_Double.h</a>&gt;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="classChamp__implementation__P1.html#a795361ef0c8835e43364fee325929a1f">00027</a> <span class="keywordtype">double</span> <a class="code" href="classChamp__implementation__P1.html#a795361ef0c8835e43364fee325929a1f">Champ_implementation_P1::form_function</a>(<span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; position, <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; les_elems, <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; nodes, <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; index, <span class="keywordtype">int</span> cell, <span class="keywordtype">int</span> ddl)<span class="keyword"> const</span>
<a name="l00028"></a>00028 <span class="keyword"></span>{
<a name="l00029"></a>00029   <span class="keywordtype">int</span> nb_nodes_per_cell = les_elems.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00030"></a>00030   assert(ddl &lt; nb_nodes_per_cell);
<a name="l00031"></a>00031 
<a name="l00032"></a>00032   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_nodes_per_cell; i++)
<a name="l00033"></a>00033     index[i] = les_elems(cell,(i+ddl)%nb_nodes_per_cell);
<a name="l00034"></a>00034 
<a name="l00035"></a>00035   <span class="keywordflow">if</span> (nb_nodes_per_cell==2)
<a name="l00036"></a>00036     {
<a name="l00037"></a>00037       <span class="keywordtype">double</span> num=0.;
<a name="l00038"></a>00038       <span class="keywordtype">double</span> den=0.;
<a name="l00039"></a>00039       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; d++)
<a name="l00040"></a>00040         {
<a name="l00041"></a>00041           num+=(position[d]-nodes(index[0],d))*(position[d]-nodes(index[0],d));
<a name="l00042"></a>00042           den+=(nodes(index[1],d)-nodes(index[0],d))*(nodes(index[1],d)-nodes(index[0],d));
<a name="l00043"></a>00043         }
<a name="l00044"></a>00044       <span class="keywordtype">double</span> res= 1.-sqrt(num/den);
<a name="l00045"></a>00045 <span class="comment">// Cerr&lt;&lt;&quot;ii &quot;&lt;&lt;res&lt;&lt;&quot; &quot;&lt;&lt;index[0]&lt;&lt;&quot; &quot;&lt;&lt;ddl&lt;&lt;&quot; &quot;&lt;&lt;(ddl)%nb_nodes_per_cell&lt;&lt;finl;</span>
<a name="l00046"></a>00046       <span class="keywordflow">return</span> res;
<a name="l00047"></a>00047     }
<a name="l00048"></a>00048   <span class="keywordtype">double</span> num = 0.;
<a name="l00049"></a>00049   <span class="keywordtype">double</span> den = 0.;
<a name="l00050"></a>00050 
<a name="l00051"></a>00051   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a> == 2)
<a name="l00052"></a>00052     {
<a name="l00053"></a>00053       den = (nodes(index[2],0) - nodes(index[1],0)) * (nodes(index[0],1) - nodes(index[1],1))
<a name="l00054"></a>00054             - (nodes(index[2],1) - nodes(index[1],1)) * (nodes(index[0],0) - nodes(index[1],0));
<a name="l00055"></a>00055 
<a name="l00056"></a>00056       num = (nodes(index[2],0) - nodes(index[1],0)) * (position[1] - nodes(index[1],1))
<a name="l00057"></a>00057             - (nodes(index[2],1) - nodes(index[1],1)) * (position[0] - nodes(index[1],0));
<a name="l00058"></a>00058     }
<a name="l00059"></a>00059   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a> == 3)
<a name="l00060"></a>00060     {
<a name="l00061"></a>00061       <span class="keywordtype">double</span> xp = (nodes(index[2],1) - nodes(index[1],1)) * (nodes(index[0],2) - nodes(index[1],2))
<a name="l00062"></a>00062                   - (nodes(index[2],2) - nodes(index[1],2)) * (nodes(index[0],1) - nodes(index[1],1));
<a name="l00063"></a>00063 
<a name="l00064"></a>00064       <span class="keywordtype">double</span> yp = (nodes(index[2],2) - nodes(index[1],2)) * (nodes(index[0],0) - nodes(index[1],0))
<a name="l00065"></a>00065                   - (nodes(index[2],0) - nodes(index[1],0)) * (nodes(index[0],2) - nodes(index[1],2));
<a name="l00066"></a>00066 
<a name="l00067"></a>00067       <span class="keywordtype">double</span> zp = (nodes(index[2],0) - nodes(index[1],0)) * (nodes(index[0],1) - nodes(index[1],1))
<a name="l00068"></a>00068                   - (nodes(index[2],1) - nodes(index[1],1)) * (nodes(index[0],0) - nodes(index[1],0));
<a name="l00069"></a>00069 
<a name="l00070"></a>00070       den = xp * (nodes(index[3],0) - nodes(index[1],0))
<a name="l00071"></a>00071             + yp * (nodes(index[3],1) - nodes(index[1],1))
<a name="l00072"></a>00072             + zp * (nodes(index[3],2) - nodes(index[1],2));
<a name="l00073"></a>00073 
<a name="l00074"></a>00074       xp = (nodes(index[2],1) - nodes(index[1],1)) * (position[2] - nodes(index[1],2))
<a name="l00075"></a>00075            - (nodes(index[2],2) - nodes(index[1],2)) * (position[1] - nodes(index[1],1));
<a name="l00076"></a>00076 
<a name="l00077"></a>00077       yp = (nodes(index[2],2) - nodes(index[1],2)) * (position[0] - nodes(index[1],0))
<a name="l00078"></a>00078            - (nodes(index[2],0) - nodes(index[1],0)) * (position[2] - nodes(index[1],2));
<a name="l00079"></a>00079 
<a name="l00080"></a>00080       zp = (nodes(index[2],0) - nodes(index[1],0)) * (position[1] - nodes(index[1],1))
<a name="l00081"></a>00081            - (nodes(index[2],1) - nodes(index[1],1)) * (position[0] - nodes(index[1],0));
<a name="l00082"></a>00082 
<a name="l00083"></a>00083       num = xp * (nodes(index[3],0) - nodes(index[1],0))
<a name="l00084"></a>00084             + yp * (nodes(index[3],1) - nodes(index[1],1))
<a name="l00085"></a>00085             + zp * (nodes(index[3],2) - nodes(index[1],2));
<a name="l00086"></a>00086     }
<a name="l00087"></a>00087   <span class="keywordflow">else</span>
<a name="l00088"></a>00088     {
<a name="l00089"></a>00089       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Champ_implementation_P1::form_function : Invalid dimension&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00090"></a>00090       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00091"></a>00091     }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093   assert(den != 0.);
<a name="l00094"></a>00094   <span class="keywordtype">double</span> result = num/den;
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <span class="keywordflow">if</span> ((result &lt; -<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>) || (result &gt; 1.+<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>))
<a name="l00097"></a>00097     {
<a name="l00098"></a>00098       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: The barycentric coordinate of point :&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00099"></a>00099       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;x= &quot;</span> &lt;&lt; position[0] &lt;&lt; <span class="stringliteral">&quot; y=&quot;</span> &lt;&lt; position[1];
<a name="l00100"></a>00100       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a> == 3)
<a name="l00101"></a>00101         {
<a name="l00102"></a>00102           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; z=&quot;</span> &lt;&lt; position[3];
<a name="l00103"></a>00103         }
<a name="l00104"></a>00104       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl;
<a name="l00105"></a>00105       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;is not between 0 and 1 : &quot;</span> &lt;&lt; result &lt;&lt; finl;
<a name="l00106"></a>00106       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;On the element &quot;</span> &lt;&lt; cell &lt;&lt; <span class="stringliteral">&quot; of the processor &quot;</span> &lt;&lt; <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>() &lt;&lt; finl;
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 <span class="preprocessor">#ifndef NDEBUG</span>
<a name="l00109"></a>00109 <span class="preprocessor"></span>      <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00110"></a>00110 <span class="preprocessor">#endif</span>
<a name="l00111"></a>00111 <span class="preprocessor"></span>
<a name="l00112"></a>00112     }
<a name="l00113"></a>00113 
<a name="l00114"></a>00114   <span class="keywordflow">return</span> result;
<a name="l00115"></a>00115 }
<a name="l00116"></a><a class="code" href="classChamp__implementation__P1.html#a113e800c9e86fa439f9a35942731594a">00116</a> <span class="keywordtype">void</span> <a class="code" href="classChamp__implementation__P1.html#a113e800c9e86fa439f9a35942731594a">Champ_implementation_P1::value_interpolation</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions, <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; cells, <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; values, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; resu, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00117"></a>00117 <span class="keyword"></span>{
<a name="l00118"></a>00118   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp;      zone              = <a class="code" href="classChamp__implementation__base.html#a25450317f64965ccdb136cfbec406b8a">get_zone_geom</a>();
<a name="l00119"></a>00119   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp;    les_elems         = zone.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00120"></a>00120   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; nodes = zone.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>();
<a name="l00121"></a>00121   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_nodes_per_cell = zone.<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>(), N = resu.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00122"></a>00122   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> index(nb_nodes_per_cell);
<a name="l00123"></a>00123   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> position(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>);
<a name="l00124"></a>00124   resu = 0;
<a name="l00125"></a>00125   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ic=0; ic&lt;cells.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>(); ic++)
<a name="l00126"></a>00126     {
<a name="l00127"></a>00127       <span class="keywordtype">int</span> cell = cells(ic);
<a name="l00128"></a>00128       <span class="keywordflow">if</span> (cell&lt;0) <span class="keywordflow">continue</span>;
<a name="l00129"></a>00129       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>; k++)
<a name="l00130"></a>00130         position(k) = positions(ic,k);
<a name="l00131"></a>00131 
<a name="l00132"></a>00132       assert(cell &gt;= 0);
<a name="l00133"></a>00133       assert(cell &lt; les_elems.<a class="code" href="classIntTab.html#a71e9b9ddc1793094b1b3f109377952b1" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0));
<a name="l00134"></a>00134       <span class="keywordflow">if</span> (ncomp != -1)
<a name="l00135"></a>00135         {
<a name="l00136"></a>00136           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_nodes_per_cell; j++)
<a name="l00137"></a>00137             {
<a name="l00138"></a>00138               <span class="keywordtype">int</span> node = les_elems(cell, j);
<a name="l00139"></a>00139               resu(ic) += values(node, ncomp) * <a class="code" href="classChamp__implementation__P1.html#a795361ef0c8835e43364fee325929a1f">form_function</a>(position,les_elems,nodes,index,cell,j);
<a name="l00140"></a>00140             }
<a name="l00141"></a>00141         }
<a name="l00142"></a>00142       <span class="keywordflow">else</span>
<a name="l00143"></a>00143         {
<a name="l00144"></a>00144 
<a name="l00145"></a>00145           assert(values.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>() == N);
<a name="l00146"></a>00146           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_nodes_per_cell; j++)
<a name="l00147"></a>00147             {
<a name="l00148"></a>00148               <span class="keywordtype">double</span> weight = <a class="code" href="classChamp__implementation__P1.html#a795361ef0c8835e43364fee325929a1f">form_function</a>(position,les_elems,nodes,index,cell,j);
<a name="l00149"></a>00149               <span class="keywordtype">int</span> node = les_elems(cell, j);
<a name="l00150"></a>00150               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; N; k++)
<a name="l00151"></a>00151                 resu(ic, k) += values(node, k) * weight;
<a name="l00152"></a>00152             }
<a name="l00153"></a>00153         }
<a name="l00154"></a>00154     }
<a name="l00155"></a>00155 }
<a name="l00156"></a>00156 
<a name="l00157"></a>00157 <span class="comment">//</span>
<a name="l00158"></a>00158 <span class="comment">//</span>
<a name="l00159"></a>00159 <span class="comment">//</span>
<a name="l00160"></a>00160 <span class="comment">//</span>
<a name="l00161"></a>00161 <span class="comment">//</span>
<a name="l00162"></a>00162 <span class="comment">//</span>
<a name="l00163"></a>00163 <span class="comment">//</span><span class="comment"></span>
<a name="l00164"></a>00164 <span class="comment">//! Initialise le tableau de valeurs aux sommets du domaine dom a partir de valeurs lues dans &quot;input&quot;.&lt;br&gt;(on dimensionne, associe la structure parallele et remplit les valeurs reelles et virtuelles)&lt;br&gt;Le fichier doit avoir le format suivant (n est le nombre de valeurs nodales&lt;br&gt;stockees, x, y, z sont les coordonnees des sommets, compo1... sont les valeurs&lt;br&gt;des composantes.&lt;br&gt;n  (int)&lt;br&gt;x y [z] compo1 [compo2 [compo3 ... ]]   (type double)</span>
<a name="l00165"></a><a class="code" href="classChamp__implementation__P1.html#aa8a7e3f20eac92f926f3f19b29076a92">00165</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classChamp__implementation__P1.html#aa8a7e3f20eac92f926f3f19b29076a92" title="Initialise le tableau de valeurs aux sommets du domaine dom a partir de valeurs lues dans &quot;input&quot;...">Champ_implementation_P1::init_from_file</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val, <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,
<a name="l00166"></a>00166                                              <span class="keywordtype">int</span> nb_comp, <span class="keywordtype">double</span> tolerance, <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; input)
<a name="l00167"></a>00167 {
<a name="l00168"></a>00168   val.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, nb_comp);
<a name="l00169"></a>00169   dom.<a class="code" href="classDomaine.html#a32c7de9f9e8e78e3d5ea68715b2ceb2b" title="Cree un tableau ayant une &quot;ligne&quot; par sommet du maillage. Voir MD_Vector_tools::creer_tableau_distrib...">creer_tableau_sommets</a>(val, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="comment">// Construction d&#39;un octree avec les sommets du domaine:</span>
<a name="l00172"></a>00172   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord = dom.<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
<a name="l00173"></a>00173   <a class="code" href="classOctree__Double.html" title=": Un octree permettant de chercher dans l&#39;espace des elements ou des points decrits par des coordonne...">Octree_Double</a> octree;
<a name="l00174"></a>00174   octree.<a class="code" href="classOctree__Double.html#a0b66bd315e7f45a024695b6a2764e7d4" title="construit un octree contenant les points de coordonnees coords. Si include_virtual=1, on stocke coords.dimension_tot(0) elements, sinon on en stocke coords.dimension(0) Si epsilon = 0, on construit un octree de points de taille nulle (chaque point se trouve dans un seul octree_floor) Sinon, on construit un octree d&#39;elements cubiques centres sur les coords, de demie-largeur epsilon. Un point peut alors se trouver dans plusieurs octree_floor.">build_nodes</a>(coord, 0 <span class="comment">/* do not include virtual nodes */</span>);
<a name="l00175"></a>00175 
<a name="l00176"></a>00176 <span class="comment">// Lecture des valeurs dans input</span>
<a name="l00177"></a>00177   <span class="keywordtype">int</span> nb_val_lues;
<a name="l00178"></a>00178   input &gt;&gt; nb_val_lues;
<a name="l00179"></a>00179   <span class="keyword">const</span> <span class="keywordtype">int</span> dim = coord.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00180"></a>00180   <span class="keyword">const</span> <span class="keywordtype">int</span> tmp_size = dim + nb_comp;
<a name="l00181"></a>00181   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> tmp(tmp_size);
<a name="l00182"></a>00182   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> node_coord; <span class="comment">//!&lt; points to the dim first elements of &quot;tmp&quot; (coordinates of the node)</span>
<a name="l00183"></a>00183 <span class="comment"></span>  node_coord.<a class="code" href="classArrOfDouble.html#a1831984f45c77967bf13fe67b97e95a9" title="Fait pointer le tableau vers les memes donnees qu&#39;un tableau existant. Le tableau sera du meme type q...">ref_array</a>(tmp, 0 <span class="comment">/* start index */</span>, dim <span class="comment">/* size */</span>);
<a name="l00184"></a>00184   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> node_list;
<a name="l00185"></a>00185   node_list.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);
<a name="l00186"></a>00186 
<a name="l00187"></a>00187   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> count(dom.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>()); <span class="comment">//!&lt; number of times this coordinate has been found</span>
<a name="l00188"></a>00188 <span class="comment"></span>
<a name="l00189"></a>00189   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_val = 0; i_val &lt; nb_val_lues; i_val++)
<a name="l00190"></a>00190     {
<a name="l00191"></a>00191       input.<a class="code" href="classEntree.html#aa434f5ceb8169e469613d1f6cd1fd99f" title="methode virtuelle pour lire un tableau d&#39;ints ou reels&lt;br&gt;(le tableau doit avoir la bonne dimension: ...">get</a>(tmp.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), tmp_size);
<a name="l00192"></a>00192 <span class="comment">// first call returns more points (some might be at a larger distance)</span>
<a name="l00193"></a>00193       octree.<a class="code" href="classOctree__Double.html#a1dffcace51ca06cb52ff6e2330ab4b2e" title="cherche tous les elements ou points ayant potentiellement une intersection non vide avec la boite don...">search_elements_box</a>(node_coord, tolerance, node_list);
<a name="l00194"></a>00194       octree.<a class="code" href="classOctree__Double.html#a8ba1f6ceba5dae2af587d2f9a766aac2" title="Methode hors classe Cherche parmi les sommets de la liste node_list ceux qui sont a une distance infe...">search_nodes_close_to</a>(node_coord, coord, node_list, tolerance);
<a name="l00195"></a>00195       <span class="keyword">const</span> <span class="keywordtype">int</span> n = node_list.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00196"></a>00196       <span class="keywordflow">if</span> (n &gt; 1)
<a name="l00197"></a>00197         {
<a name="l00198"></a>00198           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Champ_som_lu::readOn: point &quot;</span> &lt;&lt; node_coord
<a name="l00199"></a>00199                &lt;&lt; <span class="stringliteral">&quot; corresponds to &quot;</span> &lt;&lt; node_list.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()
<a name="l00200"></a>00200                &lt;&lt; <span class="stringliteral">&quot; nodes in the geometry within the specified tolerance&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00201"></a>00201           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00202"></a>00202         }
<a name="l00203"></a>00203       <span class="keywordflow">if</span> (n == 1)
<a name="l00204"></a>00204         {
<a name="l00205"></a>00205           <span class="keyword">const</span> <span class="keywordtype">int</span> node_index = node_list[0];
<a name="l00206"></a>00206           count[node_index]++;
<a name="l00207"></a>00207           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_comp; i++)
<a name="l00208"></a>00208             val(node_index, i) = tmp[dim + i];
<a name="l00209"></a>00209         }
<a name="l00210"></a>00210       <span class="keywordflow">else</span>
<a name="l00211"></a>00211         {
<a name="l00212"></a>00212 <span class="comment">// Ce sommet n&#39;est pas sur ce processeur...</span>
<a name="l00213"></a>00213         }
<a name="l00214"></a>00214     }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216   <span class="keywordflow">if</span> (dom.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>() &gt; 0 &amp;&amp; <a class="code" href="ArrOfDouble_8cpp.html#abd3998749a1a8dab00dd6ac1798327fb" title="Retourne la valeur minimale.">min_array</a>(count) == 0)
<a name="l00217"></a>00217     {
<a name="l00218"></a>00218       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Champ_som_lu::readOn: some coordinates were not found in the file&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00219"></a>00219       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00220"></a>00220     }
<a name="l00221"></a>00221   val.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l00222"></a>00222 }
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 <span class="comment">// Precondition:</span>
<a name="l00225"></a>00225 <span class="comment">// Parametre: IntTab&amp; polys</span>
<a name="l00226"></a>00226 <span class="comment">// Signification: tableau contenant les numeros des elements</span>
<a name="l00227"></a>00227 <span class="comment">// par rapport auxquels on veut calculer une</span>
<a name="l00228"></a>00228 <span class="comment">// coordonnee barycentrique.</span>
<a name="l00229"></a>00229 <span class="comment">// polys(i,0) est l&#39;indice du sommet 0 de l&#39;element</span>
<a name="l00230"></a>00230 <span class="comment">// i dans le tableau des coordonnees (coord).</span>
<a name="l00231"></a>00231 <span class="comment">// Valeurs par defaut:</span>
<a name="l00232"></a>00232 <span class="comment">// Contraintes: reference constante</span>
<a name="l00233"></a>00233 <span class="comment">// Acces: entree</span>
<a name="l00234"></a>00234 <span class="comment">// Parametre: DoubleTab&amp; coord</span>
<a name="l00235"></a>00235 <span class="comment">// Signification: les coordonnees des sommets par auxquels on veut</span>
<a name="l00236"></a>00236 <span class="comment">// calculer les coordonnees barycentriques.</span>
<a name="l00237"></a>00237 <span class="comment">// Valeurs par defaut:</span>
<a name="l00238"></a>00238 <span class="comment">// Contraintes: reference constante</span>
<a name="l00239"></a>00239 <span class="comment">// Acces: entree</span>
<a name="l00240"></a>00240 <span class="comment">// Parametre: double x</span>
<a name="l00241"></a>00241 <span class="comment">// Signification: la premiere coordonnee cartesienne du point dont</span>
<a name="l00242"></a>00242 <span class="comment">// on veut calculer les coordonnees barycentriques</span>
<a name="l00243"></a>00243 <span class="comment">// Valeurs par defaut:</span>
<a name="l00244"></a>00244 <span class="comment">// Contraintes:</span>
<a name="l00245"></a>00245 <span class="comment">// Acces: entree</span>
<a name="l00246"></a>00246 <span class="comment">// Parametre: double y</span>
<a name="l00247"></a>00247 <span class="comment">// Signification: la deuxieme coordonnee cartesienne du point dont</span>
<a name="l00248"></a>00248 <span class="comment">// on veut calculer les coordonnees barycentriques</span>
<a name="l00249"></a>00249 <span class="comment">// Valeurs par defaut:</span>
<a name="l00250"></a>00250 <span class="comment">// Contraintes:</span>
<a name="l00251"></a>00251 <span class="comment">// Acces: entree</span>
<a name="l00252"></a>00252 <span class="comment">// Parametre: int le_poly</span>
<a name="l00253"></a>00253 <span class="comment">// Signification: le numero de l&#39;element (dans le tableau polys) par</span>
<a name="l00254"></a>00254 <span class="comment">// rapport auquel on calculera la coordonnee barycentrique.</span>
<a name="l00255"></a>00255 <span class="comment">// Valeurs par defaut:</span>
<a name="l00256"></a>00256 <span class="comment">// Contraintes:</span>
<a name="l00257"></a>00257 <span class="comment">// Acces: entre</span>
<a name="l00258"></a>00258 <span class="comment">// Parametre: int i</span>
<a name="l00259"></a>00259 <span class="comment">// Signification: le numero du sommet par rapport auquel on veut la</span>
<a name="l00260"></a>00260 <span class="comment">// coordonnee barycentrique.</span>
<a name="l00261"></a>00261 <span class="comment">// Valeurs par defaut:</span>
<a name="l00262"></a>00262 <span class="comment">// Contraintes: Triangle  0 &lt;= i &lt;= 2</span>
<a name="l00263"></a>00263 <span class="comment">// Contraintes: Rectangle 0 &lt;= i &lt;= 3</span>
<a name="l00264"></a>00264 <span class="comment">// Acces: entree</span>
<a name="l00265"></a>00265 <span class="comment">// Exception: erreur arithmetique, denominateur nul</span>
<a name="l00266"></a>00266 <span class="comment">// Exception: erreur de calcul, coordonnee barycentrique invalide</span>
<a name="l00267"></a>00267 <span class="comment">// Effets de bord:</span>
<a name="l00268"></a>00268 <span class="comment">// Postcondition:</span>
<a name="l00269"></a>00269 <span class="comment">// Not inlined (this method has been splitted in coord_barycentrique_P1_triangle and coord_barycentrique_P1_rectangle to be inlined elsewhere in the code)</span>
<a name="l00270"></a>00270 <span class="comment">//</span>
<a name="l00271"></a>00271 <span class="comment">//</span>
<a name="l00272"></a>00272 <span class="comment">//</span><span class="comment"></span>
<a name="l00273"></a>00273 <span class="comment">//! Calcule la coordonnee barycentrique d&#39;un point (x,y) par&lt;br&gt;rapport au sommet specifie d&#39;un triangle ou d&#39;un rectange (un element)&lt;br&gt;Ce calcul concerne un point 2D.</span>
<a name="l00274"></a>00274 <span class="comment"></span><span class="comment">/** \return double&lt;br&gt;</span>
<a name="l00275"></a>00275 <span class="comment">Signification: la coordonnee barycentrique du point (x,y) par rapport&lt;br&gt;</span>
<a name="l00276"></a>00276 <span class="comment">au sommet specifie (i) dans l&#39;element specifie (le_poly)&lt;br&gt;</span>
<a name="l00277"></a>00277 <span class="comment">Contraintes: 0 &lt;= valeur &lt;= 1&lt;br&gt;</span>
<a name="l00278"></a>00278 <span class="comment">Excpetion: un triangle n&#39;a pas plus de 3 sommets&lt;br&gt;</span>
<a name="l00279"></a>00279 <span class="comment">Excpetion: un rectangle n&#39;a pas plus de 4 sommets */</span>
<a name="l00280"></a><a class="code" href="Champ__implementation__P1_8h.html#a101599c9532a7736fd54b962d4551f8c">00280</a> <span class="keywordtype">double</span> <a class="code" href="Champ__implementation__P1_8cpp.html#a101599c9532a7736fd54b962d4551f8c" title="Calcule la coordonnee barycentrique d&#39;un point (x,y) par rapport au sommet specifie d&#39;un triangle ou ...">coord_barycentrique_P1</a>(<span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; polys,
<a name="l00281"></a>00281                               <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord,
<a name="l00282"></a>00282                               <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">int</span> le_poly, <span class="keywordtype">int</span> i)
<a name="l00283"></a>00283 {
<a name="l00284"></a>00284   <span class="keywordtype">int</span> nb_som_elem = polys.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00285"></a>00285 <span class="comment">// Distinction du calcul de la coordonnee barycentrique en fonction du type de l element</span>
<a name="l00286"></a>00286 <span class="comment">// Cas Triangle</span>
<a name="l00287"></a>00287   <span class="keywordflow">if</span> (nb_som_elem==3)
<a name="l00288"></a>00288     <span class="keywordflow">return</span> <a class="code" href="Champ__implementation__P1_8h.html#a9c0b4e243a99d689224836eaaa32ee61">coord_barycentrique_P1_triangle</a>(polys,coord,x,y,le_poly,i);
<a name="l00289"></a>00289 <span class="comment">// Cas Rectangle</span>
<a name="l00290"></a>00290   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nb_som_elem==4)
<a name="l00291"></a>00291     <span class="keywordflow">return</span> <a class="code" href="Champ__implementation__P1_8h.html#a1ad6f80596ca28c7ca5008f844478c01">coord_barycentrique_P1_rectangle</a>(polys,coord,x,y,le_poly,i);
<a name="l00292"></a>00292   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;The number of nodes by element &quot;</span> &lt;&lt;nb_som_elem&lt;&lt;<span class="stringliteral">&quot; does not correspond to a treated situation in the coord_barycentrique_P1 function.&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00293"></a>00293   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00294"></a>00294   <span class="keywordflow">return</span> 0.;
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 
<a name="l00298"></a>00298 <span class="comment">// Precondition:</span>
<a name="l00299"></a>00299 <span class="comment">// Parametre: IntTab&amp; polys</span>
<a name="l00300"></a>00300 <span class="comment">// Signification: tableau contenant les numeros des elements</span>
<a name="l00301"></a>00301 <span class="comment">// par rapport auxquels on veut calculer une</span>
<a name="l00302"></a>00302 <span class="comment">// coordonnee barycentrique.</span>
<a name="l00303"></a>00303 <span class="comment">// polys(i,0) est l&#39;indice du sommet 0 de l&#39;element</span>
<a name="l00304"></a>00304 <span class="comment">// i dans le tableau des coordonnees (coord).</span>
<a name="l00305"></a>00305 <span class="comment">// Valeurs par defaut:</span>
<a name="l00306"></a>00306 <span class="comment">// Contraintes: reference constante</span>
<a name="l00307"></a>00307 <span class="comment">// Acces: entree</span>
<a name="l00308"></a>00308 <span class="comment">// Parametre: DoubleTab&amp; coord</span>
<a name="l00309"></a>00309 <span class="comment">// Signification: les coordonnees des sommets par auxquels on veut</span>
<a name="l00310"></a>00310 <span class="comment">// calculer les coordonnees barycentriques.</span>
<a name="l00311"></a>00311 <span class="comment">// Valeurs par defaut:</span>
<a name="l00312"></a>00312 <span class="comment">// Contraintes: reference constante</span>
<a name="l00313"></a>00313 <span class="comment">// Acces: entree</span>
<a name="l00314"></a>00314 <span class="comment">// Parametre: double x</span>
<a name="l00315"></a>00315 <span class="comment">// Signification: la premiere coordonnee cartesienne du point dont</span>
<a name="l00316"></a>00316 <span class="comment">// on veut calculer les coordonnees barycentriques</span>
<a name="l00317"></a>00317 <span class="comment">// Valeurs par defaut:</span>
<a name="l00318"></a>00318 <span class="comment">// Contraintes:</span>
<a name="l00319"></a>00319 <span class="comment">// Acces: entree</span>
<a name="l00320"></a>00320 <span class="comment">// Parametre: double y</span>
<a name="l00321"></a>00321 <span class="comment">// Signification: la deuxieme coordonnee cartesienne du point dont</span>
<a name="l00322"></a>00322 <span class="comment">// on veut calculer les coordonnees barycentriques</span>
<a name="l00323"></a>00323 <span class="comment">// Valeurs par defaut:</span>
<a name="l00324"></a>00324 <span class="comment">// Contraintes:</span>
<a name="l00325"></a>00325 <span class="comment">// Acces: entree</span>
<a name="l00326"></a>00326 <span class="comment">// Parametre: double z</span>
<a name="l00327"></a>00327 <span class="comment">// Signification: la troisieme coordonnee cartesienne du point dont</span>
<a name="l00328"></a>00328 <span class="comment">// on veut calculer les coordonnees barycentriques</span>
<a name="l00329"></a>00329 <span class="comment">// Valeurs par defaut:</span>
<a name="l00330"></a>00330 <span class="comment">// Contraintes:</span>
<a name="l00331"></a>00331 <span class="comment">// Acces: entree</span>
<a name="l00332"></a>00332 <span class="comment">// Parametre: int le_poly</span>
<a name="l00333"></a>00333 <span class="comment">// Signification: le numero de l&#39;element (dans le tableau polys) par</span>
<a name="l00334"></a>00334 <span class="comment">// rapport auquel on calculera la coordonnee barycentrique.</span>
<a name="l00335"></a>00335 <span class="comment">// Valeurs par defaut:</span>
<a name="l00336"></a>00336 <span class="comment">// Contraintes:</span>
<a name="l00337"></a>00337 <span class="comment">// Acces: entre</span>
<a name="l00338"></a>00338 <span class="comment">// Parametre: int i</span>
<a name="l00339"></a>00339 <span class="comment">// Signification: le numero du sommet par rapport auquel on veut la</span>
<a name="l00340"></a>00340 <span class="comment">// coordonnee barycentrique.</span>
<a name="l00341"></a>00341 <span class="comment">// Valeurs par defaut:</span>
<a name="l00342"></a>00342 <span class="comment">// Contraintes: Tetraedre 0 &lt;= i &lt;= 3</span>
<a name="l00343"></a>00343 <span class="comment">// Contraintes: Hexaedre  0 &lt;= i &lt;= 7</span>
<a name="l00344"></a>00344 <span class="comment">// Acces: entree</span>
<a name="l00345"></a>00345 <span class="comment">// Exception: un tetraedre n&#39;a pas plus de 4 sommets</span>
<a name="l00346"></a>00346 <span class="comment">// Exception: un hexaedre n&#39;a pas plus de 8 sommets</span>
<a name="l00347"></a>00347 <span class="comment">// Exception: erreur arithmetique, denominateur nul</span>
<a name="l00348"></a>00348 <span class="comment">// Exception: erreur de calcul, coordonnee barycentrique invalide</span>
<a name="l00349"></a>00349 <span class="comment">// Effets de bord:</span>
<a name="l00350"></a>00350 <span class="comment">// Postcondition:</span>
<a name="l00351"></a>00351 <span class="comment">// Do NOT inline (use call to coord_barycentrique_P1_tetraedre or coord_barycentrique_P1_hexaedre instead)</span>
<a name="l00352"></a>00352 <span class="comment">//</span>
<a name="l00353"></a>00353 <span class="comment">//</span>
<a name="l00354"></a>00354 <span class="comment">//</span><span class="comment"></span>
<a name="l00355"></a>00355 <span class="comment">//! Calcule la coordonnee barycentrique d&#39;un point (x,y,z) par&lt;br&gt;rapport au sommet specifie d&#39;un tetraedre ou d&#39;un hexaedre (un element)&lt;br&gt;Ce calcul concerne un point 3D.</span>
<a name="l00356"></a>00356 <span class="comment"></span><span class="comment">/** \return double&lt;br&gt;</span>
<a name="l00357"></a>00357 <span class="comment">Signification: la coordonnee barycentrique du point (x,y,z) par rapport&lt;br&gt;</span>
<a name="l00358"></a>00358 <span class="comment">au sommet specifie (i) dans l&#39;element specifie (le_poly)&lt;br&gt;</span>
<a name="l00359"></a>00359 <span class="comment">Contraintes: 0 &lt;= valeur &lt;= 1 */</span>
<a name="l00360"></a><a class="code" href="Champ__implementation__P1_8h.html#ad26ec356aba8ab167417ca9dcc365354">00360</a> <span class="keywordtype">double</span> <a class="code" href="Champ__implementation__P1_8cpp.html#a101599c9532a7736fd54b962d4551f8c" title="Calcule la coordonnee barycentrique d&#39;un point (x,y) par rapport au sommet specifie d&#39;un triangle ou ...">coord_barycentrique_P1</a>(<span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; polys,
<a name="l00361"></a>00361                               <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord,
<a name="l00362"></a>00362                               <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z,
<a name="l00363"></a>00363                               <span class="keywordtype">int</span> le_poly, <span class="keywordtype">int</span> i)
<a name="l00364"></a>00364 {
<a name="l00365"></a>00365   <span class="keywordtype">int</span> nb_som_elem = polys.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00366"></a>00366 <span class="comment">// Distinction du calcul de la coordonnee barycentrique en fonction du type de l element</span>
<a name="l00367"></a>00367 <span class="comment">// Cas Tetraedre</span>
<a name="l00368"></a>00368   <span class="keywordflow">if</span> (nb_som_elem==4)
<a name="l00369"></a>00369     <span class="keywordflow">return</span> <a class="code" href="Champ__implementation__P1_8h.html#ab40ad27af50075ee8b2c9d9e9f786357">coord_barycentrique_P1_tetraedre</a>(polys, coord, x, y, z, le_poly, i);
<a name="l00370"></a>00370   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nb_som_elem==8)
<a name="l00371"></a>00371     <span class="keywordflow">return</span> <a class="code" href="Champ__implementation__P1_8h.html#adf677edb42b66a8e581ab5ba490b6f46">coord_barycentrique_P1_hexaedre</a>(polys, coord, x, y, z, le_poly, i);
<a name="l00372"></a>00372   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;The number of nodes by element &quot;</span> &lt;&lt;nb_som_elem&lt;&lt;<span class="stringliteral">&quot; does not correspond to a treated situation in the coord_barycentrique_P1 function.&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00373"></a>00373   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00374"></a>00374   <span class="keywordflow">return</span> 0.;
<a name="l00375"></a>00375 }
<a name="l00376"></a>00376 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:13 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
