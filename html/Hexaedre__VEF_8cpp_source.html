<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Geometrie/Hexaedre_VEF.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Geometrie/Hexaedre_VEF.cpp</div>  </div>
</div>
<div class="contents">
<a href="Hexaedre__VEF_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2015 - 2016, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Hexaedre_VEF.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Geometrie</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/25</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Hexaedre__VEF_8h.html">Hexaedre_VEF.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="Hexaedre__VEF_8cpp.html#a55c49e3fc6e1f0d37b00b79d5c0b1554">00026</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classHexaedre__VEF.html" title="Classe Hexaedre_VEF Cette classe represente l&#39;element geometrique Hexaedre_VEF. Un Hexaedre_VEF est u...">Hexaedre_VEF</a>,<span class="stringliteral">&quot;Hexaedre_VEF&quot;</span>,<a class="code" href="classElem__geom__base.html" title="Classe Elem_geom_base Cette classe est la classe de base pour la definition d&#39;elements geometriques c...">Elem_geom_base</a>);
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">// Precondition:</span>
<a name="l00030"></a>00030 <span class="comment">// Parametre: Sortie&amp; s</span>
<a name="l00031"></a>00031 <span class="comment">// Signification: un flot de sortie</span>
<a name="l00032"></a>00032 <span class="comment">// Valeurs par defaut:</span>
<a name="l00033"></a>00033 <span class="comment">// Contraintes:</span>
<a name="l00034"></a>00034 <span class="comment">// Acces:</span>
<a name="l00035"></a>00035 <span class="comment">// Exception:</span>
<a name="l00036"></a>00036 <span class="comment">// Effets de bord:</span>
<a name="l00037"></a>00037 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00038"></a>00038 <span class="comment">//</span><span class="comment"></span>
<a name="l00039"></a>00039 <span class="comment">//! NE FAIT RIEN</span>
<a name="l00040"></a>00040 <span class="comment"></span><span class="comment">/** \return Sortie\&amp;&lt;br&gt;</span>
<a name="l00041"></a>00041 <span class="comment">Signification: le flot de sortie&lt;br&gt;</span>
<a name="l00042"></a>00042 <span class="comment">Contraintes: */</span>
<a name="l00043"></a><a class="code" href="classHexaedre__VEF.html#a963844660655ab9827d52e733efe592d">00043</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classHexaedre__VEF.html#a963844660655ab9827d52e733efe592d" title="NE FAIT RIEN.">Hexaedre_VEF::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00044"></a>00044 <span class="keyword"></span>{
<a name="l00045"></a>00045   <span class="keywordflow">return</span> s;
<a name="l00046"></a>00046 }
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="comment">// Precondition:</span>
<a name="l00050"></a>00050 <span class="comment">// Parametre: Entree&amp; s</span>
<a name="l00051"></a>00051 <span class="comment">// Signification: un flot d&#39;entree</span>
<a name="l00052"></a>00052 <span class="comment">// Valeurs par defaut:</span>
<a name="l00053"></a>00053 <span class="comment">// Contraintes:</span>
<a name="l00054"></a>00054 <span class="comment">// Acces:</span>
<a name="l00055"></a>00055 <span class="comment">// Exception:</span>
<a name="l00056"></a>00056 <span class="comment">// Effets de bord:</span>
<a name="l00057"></a>00057 <span class="comment">// Postcondition:</span>
<a name="l00058"></a>00058 <span class="comment">//</span><span class="comment"></span>
<a name="l00059"></a>00059 <span class="comment">//! NE FAIT RIEN</span>
<a name="l00060"></a>00060 <span class="comment"></span><span class="comment">/** \return Entree\&amp;&lt;br&gt;</span>
<a name="l00061"></a>00061 <span class="comment">Signification: le flot d&#39;entree&lt;br&gt;</span>
<a name="l00062"></a>00062 <span class="comment">Contraintes: */</span>
<a name="l00063"></a><a class="code" href="classHexaedre__VEF.html#a8a135567d07809f9de959ed79773fe51">00063</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classHexaedre__VEF.html#a8a135567d07809f9de959ed79773fe51" title="NE FAIT RIEN.">Hexaedre_VEF::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s )
<a name="l00064"></a>00064 {
<a name="l00065"></a>00065   <span class="keywordflow">return</span> s;
<a name="l00066"></a>00066 }
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="comment">// Precondition:</span>
<a name="l00072"></a>00072 <span class="comment">// Parametre:</span>
<a name="l00073"></a>00073 <span class="comment">// Signification:</span>
<a name="l00074"></a>00074 <span class="comment">// Valeurs par defaut:</span>
<a name="l00075"></a>00075 <span class="comment">// Contraintes:</span>
<a name="l00076"></a>00076 <span class="comment">// Acces:</span>
<a name="l00077"></a>00077 <span class="comment">// Exception:</span>
<a name="l00078"></a>00078 <span class="comment">// Effets de bord:</span>
<a name="l00079"></a>00079 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00080"></a>00080 <span class="comment">//</span><span class="comment"></span>
<a name="l00081"></a>00081 <span class="comment">//! Renvoie le nom LML d&#39;un Hexaedre_VEF = &quot;HEXA8&quot;.</span>
<a name="l00082"></a>00082 <span class="comment"></span><span class="comment">/** \return Nom\&amp;&lt;br&gt;</span>
<a name="l00083"></a>00083 <span class="comment">Signification: toujours egal a &quot;HEXA8&quot;&lt;br&gt;</span>
<a name="l00084"></a>00084 <span class="comment">Contraintes: reference constante */</span>
<a name="l00085"></a><a class="code" href="classHexaedre__VEF.html#a368a5510b319ae7a67f759fea0766eb9">00085</a> <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; <a class="code" href="classHexaedre__VEF.html#a368a5510b319ae7a67f759fea0766eb9" title="Renvoie le nom LML d&#39;un Hexaedre_VEF = &quot;HEXA8&quot;.">Hexaedre_VEF::nom_lml</a>()<span class="keyword"> const</span>
<a name="l00086"></a>00086 <span class="keyword"></span>{
<a name="l00087"></a>00087   <span class="keyword">static</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom=<span class="stringliteral">&quot;VOXEL8&quot;</span>;
<a name="l00088"></a>00088   <span class="keywordflow">return</span> nom;
<a name="l00089"></a>00089 }
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="comment">// Precondition:</span>
<a name="l00092"></a>00092 <span class="comment">// Parametre:</span>
<a name="l00093"></a>00093 <span class="comment">// Signification:</span>
<a name="l00094"></a>00094 <span class="comment">// Valeurs par defaut:</span>
<a name="l00095"></a>00095 <span class="comment">// Contraintes:</span>
<a name="l00096"></a>00096 <span class="comment">// Acces:</span>
<a name="l00097"></a>00097 <span class="comment">// Exception:</span>
<a name="l00098"></a>00098 <span class="comment">// Effets de bord:</span>
<a name="l00099"></a>00099 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00100"></a>00100 <span class="comment">//</span><span class="comment"></span>
<a name="l00101"></a>00101 <span class="comment">//! teste si une position pos est un tetraedre de sommets som(i)</span>
<a name="l00102"></a>00102 <span class="comment"></span><span class="comment">/** \return Nom\&amp;&lt;br&gt;</span>
<a name="l00103"></a>00103 <span class="comment">Signification: toujours egal a &quot;HEXA8&quot;&lt;br&gt;</span>
<a name="l00104"></a>00104 <span class="comment">Contraintes: reference constante */</span>
<a name="l00105"></a><a class="code" href="Hexaedre__VEF_8cpp.html#a507c66bfbcfff327e9ae3835ed22a4bc">00105</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="Hexaedre__VEF_8cpp.html#a507c66bfbcfff327e9ae3835ed22a4bc" title="teste si une position pos est un tetraedre de sommets som(i)">entre_faces</a>(<span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone,<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,<span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; pos, <span class="keywordtype">int</span> Asom0_, <span class="keywordtype">int</span> Asom1_, <span class="keywordtype">int</span> Asom2_, <span class="keywordtype">int</span> Bsom0_, <span class="keywordtype">int</span> Bsom1_, <span class="keywordtype">int</span> Bsom2_)
<a name="l00106"></a>00106 {
<a name="l00107"></a>00107   <span class="keywordtype">double</span> prodA,prodB;
<a name="l00108"></a>00108   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord=dom.<a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>();
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="comment">// pour A</span>
<a name="l00111"></a>00111   <span class="keywordtype">double</span> vecA1[3], vecA2[3], AP[3];
<a name="l00112"></a>00112   <span class="keywordtype">double</span> normaleA[3];
<a name="l00113"></a>00113   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;3; i++)
<a name="l00114"></a>00114     {
<a name="l00115"></a>00115       <span class="keywordtype">double</span> ref=coord(Asom0_,i);
<a name="l00116"></a>00116       vecA1[i]=coord(Asom1_,i)-ref;
<a name="l00117"></a>00117       vecA2[i]=coord(Asom2_,i)-ref;
<a name="l00118"></a>00118       AP[i]=pos[i]-ref;
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120   normaleA[0]=(vecA1[1]*vecA2[2]-vecA1[2]*vecA2[1]);
<a name="l00121"></a>00121   normaleA[1]=(vecA1[2]*vecA2[0]-vecA1[0]*vecA2[2]);
<a name="l00122"></a>00122   normaleA[2]=(vecA1[0]*vecA2[1]-vecA1[1]*vecA2[0]);
<a name="l00123"></a>00123   prodA=0;
<a name="l00124"></a>00124   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;3; i++)
<a name="l00125"></a>00125     prodA+=normaleA[i]*AP[i];
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="comment">// pour B</span>
<a name="l00128"></a>00128   <span class="keywordtype">double</span> vecB1[3], vecB2[3], BP[3];
<a name="l00129"></a>00129   <span class="keywordtype">double</span> normaleB[3];
<a name="l00130"></a>00130   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;3; i++)
<a name="l00131"></a>00131     {
<a name="l00132"></a>00132       <span class="keywordtype">double</span> ref=coord(Bsom0_,i);
<a name="l00133"></a>00133       vecB1[i]=coord(Bsom1_,i)-ref;
<a name="l00134"></a>00134       vecB2[i]=coord(Bsom2_,i)-ref;
<a name="l00135"></a>00135       BP[i]=pos[i]-ref;
<a name="l00136"></a>00136     }
<a name="l00137"></a>00137   normaleB[0]=(vecB1[1]*vecB2[2]-vecB1[2]*vecB2[1]);
<a name="l00138"></a>00138   normaleB[1]=(vecB1[2]*vecB2[0]-vecB1[0]*vecB2[2]);
<a name="l00139"></a>00139   normaleB[2]=(vecB1[0]*vecB2[1]-vecB1[1]*vecB2[0]);
<a name="l00140"></a>00140   prodB=0;
<a name="l00141"></a>00141   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;3; i++)
<a name="l00142"></a>00142     prodB+=normaleB[i]*BP[i];
<a name="l00143"></a>00143 
<a name="l00144"></a>00144   <span class="keywordflow">if</span> (prodA*prodB&lt;=0)
<a name="l00145"></a>00145     <span class="keywordflow">return</span> 1;
<a name="l00146"></a>00146   <span class="keywordflow">else</span>
<a name="l00147"></a>00147     {
<a name="l00148"></a>00148 <span class="comment">// on regarde si on n&#39;est pas limite</span>
<a name="l00149"></a>00149       <span class="keywordtype">double</span> rap=prodA/prodB;
<a name="l00150"></a>00150       <span class="keywordflow">if</span> (rap&gt;1) rap=prodB/prodA;
<a name="l00151"></a>00151       <span class="keywordflow">if</span> (rap&lt; <a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>) <span class="keywordflow">return</span> 1;
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153   <span class="keywordflow">return</span> 0;
<a name="l00154"></a>00154 }
<a name="l00155"></a>00155 <span class="comment">// Precondition:</span>
<a name="l00156"></a>00156 <span class="comment">// Parametre:</span>
<a name="l00157"></a>00157 <span class="comment">// Signification:</span>
<a name="l00158"></a>00158 <span class="comment">// Valeurs par defaut:</span>
<a name="l00159"></a>00159 <span class="comment">// Contraintes:</span>
<a name="l00160"></a>00160 <span class="comment">// Acces:</span>
<a name="l00161"></a>00161 <span class="comment">// Exception:</span>
<a name="l00162"></a>00162 <span class="comment">// Effets de bord:</span>
<a name="l00163"></a>00163 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00164"></a>00164 <span class="comment">//</span><span class="comment"></span>
<a name="l00165"></a>00165 <span class="comment">//! teste si une position pos est un tetraedre de sommets som(i)</span>
<a name="l00166"></a>00166 <span class="comment"></span><span class="comment">/** \return Nom\&amp;&lt;br&gt;</span>
<a name="l00167"></a>00167 <span class="comment">Signification: toujours egal a &quot;HEXA8&quot;&lt;br&gt;</span>
<a name="l00168"></a>00168 <span class="comment">Contraintes: reference constante */</span>
<a name="l00169"></a><a class="code" href="Hexaedre__VEF_8cpp.html#a5482a11a374f0a4b5efb84e228011149">00169</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="Hexaedre__VEF_8cpp.html#a5482a11a374f0a4b5efb84e228011149" title="teste si une position pos est un tetraedre de sommets som(i)">contient_Tetra</a>(<span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone,<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,<span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; pos, <span class="keywordtype">int</span> som0_, <span class="keywordtype">int</span> som1_, <span class="keywordtype">int</span> som2_, <span class="keywordtype">int</span> som3_, <span class="keywordtype">int</span> aff)
<a name="l00170"></a>00170 {
<a name="l00171"></a>00171   <span class="keywordtype">double</span> prod1,prod2;
<a name="l00172"></a>00172   <span class="keywordtype">int</span> som0, som1, som2, som3;
<a name="l00173"></a>00173   som0 = som0_;
<a name="l00174"></a>00174   som1 = som1_;
<a name="l00175"></a>00175   som2 = som2_;
<a name="l00176"></a>00176   som3 = som3_;
<a name="l00177"></a>00177   <span class="keywordtype">double</span> vec0[3], vec1[3], vec2[3];
<a name="l00178"></a>00178   <span class="keywordtype">double</span> vecx0[3], vecx1[3], vecx2[3];
<a name="l00179"></a>00179 
<a name="l00180"></a>00180   <span class="keywordflow">if</span> (aff)
<a name="l00181"></a>00181     {
<a name="l00182"></a>00182       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Test contient_Tetra nodes=&quot;</span>&lt;&lt;som0_&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;som1_&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;som2_&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;som3_&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00183"></a>00183       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  position=&quot;</span>&lt;&lt;pos[0]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;pos[1]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;pos[2]&lt;&lt;finl;
<a name="l00184"></a>00184     }
<a name="l00185"></a>00185 
<a name="l00186"></a>00186   <span class="keywordflow">if</span>( ( <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,0),pos[0]) &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,1),pos[1]) &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,2),pos[2]) )
<a name="l00187"></a>00187       || (<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,0),pos[0]) &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,1),pos[1]) &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,2),pos[2]))
<a name="l00188"></a>00188       || (<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,0),pos[0]) &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,1),pos[1]) &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,2),pos[2]))
<a name="l00189"></a>00189       || (<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,0),pos[0]) &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,1),pos[1]) &amp;&amp; <a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,2),pos[2])) )
<a name="l00190"></a>00190     <span class="keywordflow">return</span> 1;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;4; j++)
<a name="l00193"></a>00193     {
<a name="l00194"></a>00194       <span class="keywordflow">switch</span>(j)
<a name="l00195"></a>00195         {
<a name="l00196"></a>00196         <span class="keywordflow">case</span> 0 :
<a name="l00197"></a>00197           som0 = som0_;
<a name="l00198"></a>00198           som1 = som1_;
<a name="l00199"></a>00199           som2 = som2_;
<a name="l00200"></a>00200           som3 = som3_;
<a name="l00201"></a>00201           <span class="keywordflow">break</span>;
<a name="l00202"></a>00202         <span class="keywordflow">case</span> 1 :
<a name="l00203"></a>00203           som0 = som1_;
<a name="l00204"></a>00204           som1 = som2_;
<a name="l00205"></a>00205           som2 = som3_;
<a name="l00206"></a>00206           som3 = som0_;
<a name="l00207"></a>00207           <span class="keywordflow">break</span>;
<a name="l00208"></a>00208         <span class="keywordflow">case</span> 2 :
<a name="l00209"></a>00209           som0 = som2_;
<a name="l00210"></a>00210           som1 = som3_;
<a name="l00211"></a>00211           som2 = som0_;
<a name="l00212"></a>00212           som3 = som1_;
<a name="l00213"></a>00213           <span class="keywordflow">break</span>;
<a name="l00214"></a>00214         <span class="keywordflow">case</span> 3 :
<a name="l00215"></a>00215           som0 = som3_;
<a name="l00216"></a>00216           som1 = som0_;
<a name="l00217"></a>00217           som2 = som1_;
<a name="l00218"></a>00218           som3 = som2_;
<a name="l00219"></a>00219           <span class="keywordflow">break</span>;
<a name="l00220"></a>00220         }
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 <span class="comment">// algo : les produits mixtes (som0, som1, som2,som3) et (pos, som1, som2,som3) doivent a voir le meme signe</span>
<a name="l00223"></a>00223 <span class="comment">// construction des vecteurs</span>
<a name="l00224"></a>00224       vec0[0] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,0) - dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,0);
<a name="l00225"></a>00225       vec0[1] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,1) - dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,1);
<a name="l00226"></a>00226       vec0[2] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,2) - dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,2);
<a name="l00227"></a>00227       vec1[0] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,0) - dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,0);
<a name="l00228"></a>00228       vec1[1] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,1) - dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,1);
<a name="l00229"></a>00229       vec1[2] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,2) - dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,2);
<a name="l00230"></a>00230       vec2[0] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,0) - dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,0);
<a name="l00231"></a>00231       vec2[1] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,1) - dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,1);
<a name="l00232"></a>00232       vec2[2] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,2) - dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,2);
<a name="l00233"></a>00233       vecx0[0] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,0) - pos[0];
<a name="l00234"></a>00234       vecx0[1] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,1) - pos[1];
<a name="l00235"></a>00235       vecx0[2] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,2) - pos[2];
<a name="l00236"></a>00236       vecx1[0] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,0) - pos[0];
<a name="l00237"></a>00237       vecx1[1] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,1) - pos[1];
<a name="l00238"></a>00238       vecx1[2] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,2) - pos[2];
<a name="l00239"></a>00239       vecx2[0] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,0) - pos[0];
<a name="l00240"></a>00240       vecx2[1] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,1) - pos[1];
<a name="l00241"></a>00241       vecx2[2] = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,2) - pos[2];
<a name="l00242"></a>00242       prod1 = vec0[0]*vec1[1]*vec2[2] + vec0[1]*vec1[2]*vec2[0] + vec0[2]*vec1[0]*vec2[1]
<a name="l00243"></a>00243               - vec0[0]*vec1[2]*vec2[1] - vec0[1]*vec1[0]*vec2[2] - vec0[2]*vec1[1]*vec2[0];
<a name="l00244"></a>00244       prod2 = vecx0[0]*vecx1[1]*vecx2[2] + vecx0[1]*vecx1[2]*vecx2[0] + vecx0[2]*vecx1[0]*vecx2[1]
<a name="l00245"></a>00245               - vecx0[0]*vecx1[2]*vecx2[1] - vecx0[1]*vecx1[0]*vecx2[2] - vecx0[2]*vecx1[1]*vecx2[0];
<a name="l00246"></a>00246 
<a name="l00247"></a>00247       <span class="keywordflow">if</span> (aff)
<a name="l00248"></a>00248         {
<a name="l00249"></a>00249           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  test &quot;</span>&lt;&lt;som0&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;som1&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;som2&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;som3&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00250"></a>00250           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  node0=&quot;</span>&lt;&lt;som0&lt;&lt;<span class="stringliteral">&quot; : &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,1)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,2)&lt;&lt;finl;
<a name="l00251"></a>00251           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  node1=&quot;</span>&lt;&lt;som1&lt;&lt;<span class="stringliteral">&quot; : &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,1)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,2)&lt;&lt;finl;
<a name="l00252"></a>00252           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  node2=&quot;</span>&lt;&lt;som2&lt;&lt;<span class="stringliteral">&quot; : &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,1)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,2)&lt;&lt;finl;
<a name="l00253"></a>00253           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  node3=&quot;</span>&lt;&lt;som3&lt;&lt;<span class="stringliteral">&quot; : &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,1)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,2)&lt;&lt;finl;
<a name="l00254"></a>00254           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  position : &quot;</span>&lt;&lt;pos[0]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;pos[1]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;pos[2]&lt;&lt;finl;
<a name="l00255"></a>00255           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;      prod1=&quot;</span>&lt;&lt;prod1&lt;&lt;<span class="stringliteral">&quot; prod2=&quot;</span>&lt;&lt;prod2&lt;&lt;finl;
<a name="l00256"></a>00256         }
<a name="l00257"></a>00257 
<a name="l00258"></a>00258       <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(prod1)&lt;<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>)
<a name="l00259"></a>00259         {
<a name="l00260"></a>00260           <span class="keywordtype">double</span> norm_v0=0,norm_v1=0,norm_v2=0;
<a name="l00261"></a>00261           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;3; ii++)
<a name="l00262"></a>00262             {
<a name="l00263"></a>00263               norm_v0+=vec0[ii]*vec0[ii];
<a name="l00264"></a>00264               norm_v1+=vec1[ii]*vec1[ii];
<a name="l00265"></a>00265               norm_v2+=vec2[ii]*vec2[ii];
<a name="l00266"></a>00266             }
<a name="l00267"></a>00267           <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(prod1)&lt;<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>*sqrt(norm_v0*norm_v1*norm_v2))
<a name="l00268"></a>00268             {
<a name="l00269"></a>00269               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Test contient_Tetra ERROR : coplanar nodes&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00270"></a>00270               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  node0=&quot;</span>&lt;&lt;som0&lt;&lt;<span class="stringliteral">&quot; : &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,1)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,2)&lt;&lt;finl;
<a name="l00271"></a>00271               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  node1=&quot;</span>&lt;&lt;som1&lt;&lt;<span class="stringliteral">&quot; : &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,1)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,2)&lt;&lt;finl;
<a name="l00272"></a>00272               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  node2=&quot;</span>&lt;&lt;som2&lt;&lt;<span class="stringliteral">&quot; : &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,1)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,2)&lt;&lt;finl;
<a name="l00273"></a>00273               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  node3=&quot;</span>&lt;&lt;som3&lt;&lt;<span class="stringliteral">&quot; : &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,1)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,2)&lt;&lt;finl;
<a name="l00274"></a>00274               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  position : &quot;</span>&lt;&lt;pos[0]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;pos[1]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;pos[2]&lt;&lt;finl;
<a name="l00275"></a>00275               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00276"></a>00276             }
<a name="l00277"></a>00277         }
<a name="l00278"></a>00278 
<a name="l00279"></a>00279       <span class="keywordflow">if</span> (prod1*prod2&lt;0 &amp;&amp; <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(prod2)&gt;<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(prod1)*<a class="code" href="classObjet__U.html#a7447e25c68cc8d3a1c06cf99f0565cff">Objet_U::precision_geom</a>)
<a name="l00280"></a>00280         {
<a name="l00281"></a>00281           <span class="keywordflow">if</span> (aff)
<a name="l00282"></a>00282             {
<a name="l00283"></a>00283               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  CONTAINS=0&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00284"></a>00284             }
<a name="l00285"></a>00285           <span class="keywordflow">return</span> 0;
<a name="l00286"></a>00286         }
<a name="l00287"></a>00287     }
<a name="l00288"></a>00288   <span class="keywordflow">if</span> (aff)
<a name="l00289"></a>00289     {
<a name="l00290"></a>00290       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;  CONTAINS=1&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00291"></a>00291     }
<a name="l00292"></a>00292   <span class="keywordflow">return</span> 1;
<a name="l00293"></a>00293 }
<a name="l00294"></a>00294 
<a name="l00295"></a>00295 <span class="comment">// Precondition:</span>
<a name="l00296"></a>00296 <span class="comment">// Parametre: DoubleVect&amp; pos</span>
<a name="l00297"></a>00297 <span class="comment">// Signification: coordonnees du point que l&#39;on</span>
<a name="l00298"></a>00298 <span class="comment">// cherche a localiser</span>
<a name="l00299"></a>00299 <span class="comment">// Valeurs par defaut:</span>
<a name="l00300"></a>00300 <span class="comment">// Contraintes: reference constante</span>
<a name="l00301"></a>00301 <span class="comment">// Acces: entree</span>
<a name="l00302"></a>00302 <span class="comment">// Parametre: int ielem</span>
<a name="l00303"></a>00303 <span class="comment">// Signification: le numero de l&#39;element de la zone</span>
<a name="l00304"></a>00304 <span class="comment">// dans lequel on cherche le point.</span>
<a name="l00305"></a>00305 <span class="comment">// Valeurs par defaut:</span>
<a name="l00306"></a>00306 <span class="comment">// Contraintes:</span>
<a name="l00307"></a>00307 <span class="comment">// Acces:</span>
<a name="l00308"></a>00308 <span class="comment">// Exception:</span>
<a name="l00309"></a>00309 <span class="comment">// Effets de bord:</span>
<a name="l00310"></a>00310 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00311"></a>00311 <span class="comment">//</span>
<a name="l00312"></a>00312 <span class="comment">//</span>
<a name="l00313"></a>00313 <span class="comment">//</span>
<a name="l00314"></a>00314 <span class="comment">//</span><span class="comment"></span>
<a name="l00315"></a>00315 <span class="comment">//! Renvoie 1 si l&#39;element ielem de la zone associee a&lt;br&gt;l&#39;element geometrique contient le point&lt;br&gt;de coordonnees specifiees par le parametre &quot;pos&quot;.&lt;br&gt;Renvoie 0 sinon.</span>
<a name="l00316"></a>00316 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00317"></a>00317 <span class="comment">Signification: 1 si le point de coordonnees specifiees&lt;br&gt;</span>
<a name="l00318"></a>00318 <span class="comment">appartient a l&#39;element ielem&lt;br&gt;</span>
<a name="l00319"></a>00319 <span class="comment">0 sinon&lt;br&gt;</span>
<a name="l00320"></a>00320 <span class="comment">Contraintes: */</span>
<a name="l00321"></a><a class="code" href="classHexaedre__VEF.html#ab5a0de097eb29313e7aa54f0201abb86">00321</a> <span class="keywordtype">int</span> <a class="code" href="classHexaedre__VEF.html#ab5a0de097eb29313e7aa54f0201abb86" title="Renvoie 1 si l&#39;element ielem de la zone associee a l&#39;element geometrique contient le point de coordon...">Hexaedre_VEF::contient</a>(<span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; pos, <span class="keywordtype">int</span> element )<span class="keyword"> const</span>
<a name="l00322"></a>00322 <span class="keyword"></span>{
<a name="l00323"></a>00323   assert(pos.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()==3);
<a name="l00324"></a>00324   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone=<a class="code" href="classElem__geom__base.html#a70fcd0baca7afb11d3153b9ac5433ede">ma_zone</a>.<a class="code" href="classRef__Zone.html#ab4ba0de67809ff502efeb24c1e43bfe1">valeur</a>();
<a name="l00325"></a>00325   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone.domaine();
<a name="l00326"></a>00326   <span class="keywordtype">int</span> som0 = zone.sommet_elem(element,0);
<a name="l00327"></a>00327   <span class="keywordtype">int</span> som1 = zone.sommet_elem(element,1);
<a name="l00328"></a>00328   <span class="keywordtype">int</span> som2 = zone.sommet_elem(element,2);
<a name="l00329"></a>00329   <span class="keywordtype">int</span> som3 = zone.sommet_elem(element,3);
<a name="l00330"></a>00330   <span class="keywordtype">int</span> som4 = zone.sommet_elem(element,4);
<a name="l00331"></a>00331   <span class="keywordtype">int</span> som5 = zone.sommet_elem(element,5);
<a name="l00332"></a>00332   <span class="keywordtype">int</span> som6 = zone.sommet_elem(element,6);
<a name="l00333"></a>00333   <span class="keywordtype">int</span> som7 = zone.sommet_elem(element,7);
<a name="l00334"></a>00334 
<a name="l00335"></a>00335 <span class="comment">// GF on teste si le point est boen entre les 2 faces</span>
<a name="l00336"></a>00336   <span class="keywordflow">if</span> (<a class="code" href="Hexaedre__VEF_8cpp.html#a507c66bfbcfff327e9ae3835ed22a4bc" title="teste si une position pos est un tetraedre de sommets som(i)">entre_faces</a>(zone,dom,pos,som0,som1,som2,som4,som5,som6))
<a name="l00337"></a>00337     <span class="keywordflow">if</span> (<a class="code" href="Hexaedre__VEF_8cpp.html#a507c66bfbcfff327e9ae3835ed22a4bc" title="teste si une position pos est un tetraedre de sommets som(i)">entre_faces</a>(zone,dom,pos,som0,som1,som4,som2,som3,som6))
<a name="l00338"></a>00338 
<a name="l00339"></a>00339       <span class="keywordflow">if</span> (<a class="code" href="Hexaedre__VEF_8cpp.html#a507c66bfbcfff327e9ae3835ed22a4bc" title="teste si une position pos est un tetraedre de sommets som(i)">entre_faces</a>(zone,dom,pos,som0,som2,som4,som1,som3,som5))
<a name="l00340"></a>00340         <span class="keywordflow">return</span> 1;
<a name="l00341"></a>00341   <span class="keywordflow">return</span> 0;
<a name="l00342"></a>00342 <span class="comment">// PQ : 04/03 : optimisation</span>
<a name="l00343"></a>00343   <span class="keywordtype">int</span> aff = 0;
<a name="l00344"></a>00344   <span class="keywordflow">if</span> (element==-701)
<a name="l00345"></a>00345     {
<a name="l00346"></a>00346       aff = 1;
<a name="l00347"></a>00347     }
<a name="l00348"></a>00348   <span class="keywordflow">if</span> (<a class="code" href="Hexaedre__VEF_8cpp.html#a5482a11a374f0a4b5efb84e228011149" title="teste si une position pos est un tetraedre de sommets som(i)">contient_Tetra</a>(zone, dom, pos, som0,som1,som2,som4,aff) ||
<a name="l00349"></a>00349       <a class="code" href="Hexaedre__VEF_8cpp.html#a5482a11a374f0a4b5efb84e228011149" title="teste si une position pos est un tetraedre de sommets som(i)">contient_Tetra</a>(zone, dom, pos, som1,som2,som3,som6,aff) ||
<a name="l00350"></a>00350       <a class="code" href="Hexaedre__VEF_8cpp.html#a5482a11a374f0a4b5efb84e228011149" title="teste si une position pos est un tetraedre de sommets som(i)">contient_Tetra</a>(zone, dom, pos, som1,som2,som4,som6,aff) ||
<a name="l00351"></a>00351       <a class="code" href="Hexaedre__VEF_8cpp.html#a5482a11a374f0a4b5efb84e228011149" title="teste si une position pos est un tetraedre de sommets som(i)">contient_Tetra</a>(zone, dom, pos, som3,som5,som6,som7,aff) ||
<a name="l00352"></a>00352       <a class="code" href="Hexaedre__VEF_8cpp.html#a5482a11a374f0a4b5efb84e228011149" title="teste si une position pos est un tetraedre de sommets som(i)">contient_Tetra</a>(zone, dom, pos, som1,som4,som5,som6,aff) ||
<a name="l00353"></a>00353       <a class="code" href="Hexaedre__VEF_8cpp.html#a5482a11a374f0a4b5efb84e228011149" title="teste si une position pos est un tetraedre de sommets som(i)">contient_Tetra</a>(zone, dom, pos, som1,som3,som5,som6,aff))
<a name="l00354"></a>00354     {
<a name="l00355"></a>00355       <span class="keywordflow">return</span> 1;
<a name="l00356"></a>00356     }
<a name="l00357"></a>00357 
<a name="l00358"></a>00358   <span class="keywordflow">return</span> 0;
<a name="l00359"></a>00359 
<a name="l00360"></a>00360 }
<a name="l00361"></a>00361 
<a name="l00362"></a>00362 
<a name="l00363"></a>00363 <span class="comment">// Precondition:</span>
<a name="l00364"></a>00364 <span class="comment">// Parametre: IntVect&amp; pos</span>
<a name="l00365"></a>00365 <span class="comment">// Signification: les numeros des sommets a comparer</span>
<a name="l00366"></a>00366 <span class="comment">// avec ceux de l&#39;elements &quot;element&quot;</span>
<a name="l00367"></a>00367 <span class="comment">// Valeurs par defaut:</span>
<a name="l00368"></a>00368 <span class="comment">// Contraintes: reference constante</span>
<a name="l00369"></a>00369 <span class="comment">// Acces: entree</span>
<a name="l00370"></a>00370 <span class="comment">// Parametre: int element</span>
<a name="l00371"></a>00371 <span class="comment">// Signification: le numero de l&#39;element de la zone</span>
<a name="l00372"></a>00372 <span class="comment">// dont on veut comparer les sommets</span>
<a name="l00373"></a>00373 <span class="comment">// Valeurs par defaut:</span>
<a name="l00374"></a>00374 <span class="comment">// Contraintes:</span>
<a name="l00375"></a>00375 <span class="comment">// Acces:</span>
<a name="l00376"></a>00376 <span class="comment">// Exception:</span>
<a name="l00377"></a>00377 <span class="comment">// Effets de bord:</span>
<a name="l00378"></a>00378 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00379"></a>00379 <span class="comment">//</span>
<a name="l00380"></a>00380 <span class="comment">//</span>
<a name="l00381"></a>00381 <span class="comment">//</span><span class="comment"></span>
<a name="l00382"></a>00382 <span class="comment">//! Renvoie 1 si les sommets specifies par le parametre &quot;pos&quot;&lt;br&gt;sont les sommets de l&#39;element &quot;element&quot; de la zone associee a&lt;br&gt;l&#39;element geometrique.</span>
<a name="l00383"></a>00383 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00384"></a>00384 <span class="comment">Signification: 1 si les sommets passes en parametre&lt;br&gt;</span>
<a name="l00385"></a>00385 <span class="comment">sont ceux de l&#39;element specifie, 0 sinon&lt;br&gt;</span>
<a name="l00386"></a>00386 <span class="comment">Contraintes: */</span>
<a name="l00387"></a><a class="code" href="classHexaedre__VEF.html#ae0ab40625c4e12d77cec0fa79aaf7753">00387</a> <span class="keywordtype">int</span> <a class="code" href="classHexaedre__VEF.html#ab5a0de097eb29313e7aa54f0201abb86" title="Renvoie 1 si l&#39;element ielem de la zone associee a l&#39;element geometrique contient le point de coordon...">Hexaedre_VEF::contient</a>(<span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; som, <span class="keywordtype">int</span> element )<span class="keyword"> const</span>
<a name="l00388"></a>00388 <span class="keyword"></span>{
<a name="l00389"></a>00389   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone=<a class="code" href="classElem__geom__base.html#a70fcd0baca7afb11d3153b9ac5433ede">ma_zone</a>.<a class="code" href="classRef__Zone.html#ab4ba0de67809ff502efeb24c1e43bfe1">valeur</a>();
<a name="l00390"></a>00390   <span class="keywordflow">if</span>((zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(element,0)==som[0])&amp;&amp;
<a name="l00391"></a>00391       (zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(element,1)==som[1])&amp;&amp;
<a name="l00392"></a>00392       (zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(element,2)==som[2])&amp;&amp;
<a name="l00393"></a>00393       (zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(element,3)==som[3])&amp;&amp;
<a name="l00394"></a>00394       (zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(element,4)==som[4])&amp;&amp;
<a name="l00395"></a>00395       (zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(element,5)==som[5])&amp;&amp;
<a name="l00396"></a>00396       (zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(element,6)==som[6])&amp;&amp;
<a name="l00397"></a>00397       (zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(element,7)==som[7]))
<a name="l00398"></a>00398     <span class="keywordflow">return</span> 1;
<a name="l00399"></a>00399   <span class="keywordflow">else</span>
<a name="l00400"></a>00400     <span class="keywordflow">return</span> 0;
<a name="l00401"></a>00401 }
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 <span class="comment">// Precondition:</span>
<a name="l00404"></a>00404 <span class="comment">// Parametre: DoubleVect&amp; volumes</span>
<a name="l00405"></a>00405 <span class="comment">// Signification: le vecteur contenant les valeurs  des</span>
<a name="l00406"></a>00406 <span class="comment">// des volumes des elements de la zone</span>
<a name="l00407"></a>00407 <span class="comment">// Valeurs par defaut:</span>
<a name="l00408"></a>00408 <span class="comment">// Contraintes:</span>
<a name="l00409"></a>00409 <span class="comment">// Acces: sortie</span>
<a name="l00410"></a>00410 <span class="comment">// </span>
<a name="l00411"></a>00411 <span class="comment">// Signification:</span>
<a name="l00412"></a>00412 <span class="comment">// Contraintes:</span>
<a name="l00413"></a>00413 <span class="comment">// Exception:</span>
<a name="l00414"></a>00414 <span class="comment">// Effets de bord:</span>
<a name="l00415"></a>00415 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00416"></a>00416 <span class="comment">//</span><span class="comment"></span>
<a name="l00417"></a>00417 <span class="comment">//! Calcule les volumes des elements de la zone associee.</span>
<a name="l00418"></a><a class="code" href="classHexaedre__VEF.html#a4b163a4b8209c9f3c423cef2021d87ea">00418</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classHexaedre__VEF.html#a4b163a4b8209c9f3c423cef2021d87ea" title="Calcule les volumes des elements de la zone associee.">Hexaedre_VEF::calculer_volumes</a>(<a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes)<span class="keyword"> const</span>
<a name="l00419"></a>00419 <span class="keyword"></span>{
<a name="l00420"></a>00420   <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone=<a class="code" href="classElem__geom__base.html#a70fcd0baca7afb11d3153b9ac5433ede">ma_zone</a>.<a class="code" href="classRef__Zone.html#ab4ba0de67809ff502efeb24c1e43bfe1">valeur</a>();
<a name="l00421"></a>00421   <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom=zone.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
<a name="l00422"></a>00422   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> face_sommet_global;
<a name="l00423"></a>00423   face_sommet_global.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(6,4);
<a name="l00424"></a>00424   <span class="keywordtype">double</span> x0,y0,z0;
<a name="l00425"></a>00425   <span class="keywordtype">double</span> x1,y1,z1;
<a name="l00426"></a>00426   <span class="keywordtype">double</span> x2,y2,z2;
<a name="l00427"></a>00427   <span class="keywordtype">double</span> x3,y3,z3;
<a name="l00428"></a>00428   <span class="keywordtype">double</span> volume;
<a name="l00429"></a>00429   <span class="keywordtype">double</span> volume_global;
<a name="l00430"></a>00430   <span class="keywordtype">int</span> s1,s2,s3,s4;
<a name="l00431"></a>00431   <span class="keywordtype">int</span> som0,som1,som2,som3,som4,som5,som6,som7;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433   volume_global =0;
<a name="l00434"></a>00434 
<a name="l00435"></a>00435   <span class="keywordtype">int</span> size_tot = zone.<a class="code" href="classZone.html#aa3a33e8b723618b9092460007153e42d" title="Renvoie le nombre total d&#39;elements de la zone.">nb_elem_tot</a>();
<a name="l00436"></a>00436   assert(volumes.<a class="code" href="classDoubleVect.html#ad2d21b364e1c6559771970596a25c006" title="Identique a size_array()">size_totale</a>()==size_tot);
<a name="l00437"></a>00437   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_poly=0; num_poly&lt;size_tot; num_poly++)
<a name="l00438"></a>00438     {
<a name="l00439"></a>00439 <span class="comment">// on initialise le volume</span>
<a name="l00440"></a>00440 <span class="comment">// volumes[num_poly] =0;</span>
<a name="l00441"></a>00441 <span class="comment">// pour chaque elem on le decoupe en tetra.</span>
<a name="l00442"></a>00442 <span class="comment">// On calcul le volume par somme des volumes des tetras.</span>
<a name="l00443"></a>00443 
<a name="l00444"></a>00444 <span class="comment">// on definit les sommets de l&#39;elem</span>
<a name="l00445"></a>00445 <span class="comment">// on recupere le centre de l&#39;element.</span>
<a name="l00446"></a>00446 
<a name="l00447"></a>00447       som0 = zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(num_poly,0);
<a name="l00448"></a>00448       som1 = zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(num_poly,1);
<a name="l00449"></a>00449       som2 = zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(num_poly,2);
<a name="l00450"></a>00450       som3 = zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(num_poly,3);
<a name="l00451"></a>00451       som4 = zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(num_poly,4);
<a name="l00452"></a>00452       som5 = zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(num_poly,5);
<a name="l00453"></a>00453       som6 = zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(num_poly,6);
<a name="l00454"></a>00454       som7 = zone.<a class="code" href="classZone.html#aa164c00997bc77a365a6da57bbec29ce" title="Renvoie le numero (global) j-ieme sommet du i-ieme element.">sommet_elem</a>(num_poly,7);
<a name="l00455"></a>00455 
<a name="l00456"></a>00456 <span class="comment">// Cerr &lt;&lt; &quot; som0 &quot; &lt;&lt; som0 &lt;&lt; &quot; som1 &quot; &lt;&lt; som1 &lt;&lt; &quot; som2 &quot; &lt;&lt; som2 &lt;&lt; &quot; som3 &quot; &lt;&lt; som3 &lt;&lt;  finl;</span>
<a name="l00457"></a>00457 <span class="comment">// Cerr &lt;&lt; &quot; som4 &quot; &lt;&lt; som4 &lt;&lt; &quot; som5 &quot; &lt;&lt; som5 &lt;&lt; &quot; som6 &quot; &lt;&lt; som6 &lt;&lt; &quot; som7 &quot; &lt;&lt; som7 &lt;&lt;   finl;</span>
<a name="l00458"></a>00458 
<a name="l00459"></a>00459 
<a name="l00460"></a>00460 <span class="comment">// on construit le tableau de travail face_sommet_global</span>
<a name="l00461"></a>00461 <span class="comment">// les faces seront ordonnee suivant Xmin, Xmax, Ymin, Ymax, Zmin,Zmax</span>
<a name="l00462"></a>00462 <span class="comment">// toujours en gardant la numerotation de TRUST</span>
<a name="l00463"></a>00463       face_sommet_global(0,0) =som0;
<a name="l00464"></a>00464       face_sommet_global(0,1) =som1;
<a name="l00465"></a>00465       face_sommet_global(0,2) =som2;
<a name="l00466"></a>00466       face_sommet_global(0,3) =som3;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468       face_sommet_global(1,0) =som4;
<a name="l00469"></a>00469       face_sommet_global(1,1) =som5;
<a name="l00470"></a>00470       face_sommet_global(1,2) =som6;
<a name="l00471"></a>00471       face_sommet_global(1,3) =som7;
<a name="l00472"></a>00472 
<a name="l00473"></a>00473       face_sommet_global(2,0) =som0;
<a name="l00474"></a>00474       face_sommet_global(2,1) =som4;
<a name="l00475"></a>00475       face_sommet_global(2,2) =som2;
<a name="l00476"></a>00476       face_sommet_global(2,3) =som6;
<a name="l00477"></a>00477 
<a name="l00478"></a>00478       face_sommet_global(3,0) =som1;
<a name="l00479"></a>00479       face_sommet_global(3,1) =som5;
<a name="l00480"></a>00480       face_sommet_global(3,2) =som3;
<a name="l00481"></a>00481       face_sommet_global(3,3) =som7;
<a name="l00482"></a>00482 
<a name="l00483"></a>00483       face_sommet_global(4,0) =som0;
<a name="l00484"></a>00484       face_sommet_global(4,1) =som4;
<a name="l00485"></a>00485       face_sommet_global(4,2) =som1;
<a name="l00486"></a>00486       face_sommet_global(4,3) =som5;
<a name="l00487"></a>00487 
<a name="l00488"></a>00488       face_sommet_global(5,0) =som2;
<a name="l00489"></a>00489       face_sommet_global(5,1) =som6;
<a name="l00490"></a>00490       face_sommet_global(5,2) =som3;
<a name="l00491"></a>00491       face_sommet_global(5,3) =som7;
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 <span class="comment">// le sommet 0 sera toujours le centre de gravite</span>
<a name="l00494"></a>00494       x0 = ( dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,0) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,0) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,0) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,0) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som4,0) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som5,0) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som6,0) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som7,0) )*0.125;
<a name="l00495"></a>00495       y0 = ( dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,1) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,1) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,1) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,1) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som4,1) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som5,1) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som6,1) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som7,1) )*0.125;
<a name="l00496"></a>00496       z0 = ( dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som0,2) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som1,2) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som2,2) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som3,2) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som4,2) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som5,2) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som6,2) + dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(som7,2) )*0.125;
<a name="l00497"></a>00497 
<a name="l00498"></a>00498 <span class="comment">// Cerr &lt;&lt; &quot;le num poly traite &quot; &lt;&lt; num_poly &lt;&lt; finl;</span>
<a name="l00499"></a>00499 <span class="comment">// Cerr &lt;&lt; &quot;le centre de gravite &quot; &lt;&lt; x0 &lt;&lt; &quot; &quot; &lt;&lt; y0 &lt;&lt; &quot; &quot; &lt;&lt; z0 &lt;&lt; finl;</span>
<a name="l00500"></a>00500 
<a name="l00501"></a>00501       volume =0;
<a name="l00502"></a>00502 
<a name="l00503"></a>00503 
<a name="l00504"></a>00504 <span class="comment">// On decoupe en tetra.</span>
<a name="l00505"></a>00505 <span class="comment">// pour chaque face de l&#39;hexa ( 0 a 7 )</span>
<a name="l00506"></a>00506       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> k=0 ; k&lt;<a class="code" href="classHexaedre__VEF.html#aa0e6b26172951f753ad52570ff66e3cc" title="Renvoie le nombre de faces du type specifie que possede l&#39;element geometrique.">nb_faces</a>(); k++)
<a name="l00507"></a>00507         {
<a name="l00508"></a>00508 <span class="comment">// on recupere les sommets de la face consideree</span>
<a name="l00509"></a>00509           s1 = face_sommet_global(k,0);
<a name="l00510"></a>00510           s2 = face_sommet_global(k,1);
<a name="l00511"></a>00511           s3 = face_sommet_global(k,2);
<a name="l00512"></a>00512           s4 = face_sommet_global(k,3);
<a name="l00513"></a>00513 
<a name="l00514"></a>00514 <span class="comment">// Cerr &lt;&lt; &quot; les sommets de la face &quot; &lt;&lt; k &lt;&lt; &quot; = &quot; &lt;&lt; s1 &lt;&lt; &quot; &quot; &lt;&lt; s2 &lt;&lt; &quot; &quot; &lt;&lt; s3 &lt;&lt; &quot; &quot; &lt;&lt; s4 &lt;&lt; finl;</span>
<a name="l00515"></a>00515 <span class="comment">// Cerr &lt;&lt; &quot;coord de s1 &quot; &lt;&lt; dom.coord(s1,0) &lt;&lt; &quot; &quot; &lt;&lt; dom.coord(s1,1) &lt;&lt; &quot; &quot; &lt;&lt; dom.coord(s1,2) &lt;&lt; finl;</span>
<a name="l00516"></a>00516 <span class="comment">// Cerr &lt;&lt; &quot;coord de s2 &quot; &lt;&lt; dom.coord(s2,0) &lt;&lt; &quot; &quot; &lt;&lt; dom.coord(s2,1) &lt;&lt; &quot; &quot; &lt;&lt; dom.coord(s2,2) &lt;&lt; finl;</span>
<a name="l00517"></a>00517 <span class="comment">// Cerr &lt;&lt; &quot;coord de s3 &quot; &lt;&lt; dom.coord(s3,0) &lt;&lt; &quot; &quot; &lt;&lt; dom.coord(s3,1) &lt;&lt; &quot; &quot; &lt;&lt; dom.coord(s3,2) &lt;&lt; finl;</span>
<a name="l00518"></a>00518 <span class="comment">// Cerr &lt;&lt; &quot;coord de s4 &quot; &lt;&lt; dom.coord(s4,0) &lt;&lt; &quot; &quot; &lt;&lt; dom.coord(s4,1) &lt;&lt; &quot; &quot; &lt;&lt; dom.coord(s4,2) &lt;&lt; finl;</span>
<a name="l00519"></a>00519 
<a name="l00520"></a>00520           x1 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s1,0);
<a name="l00521"></a>00521           y1 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s1,1);
<a name="l00522"></a>00522           z1 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s1,2);
<a name="l00523"></a>00523 
<a name="l00524"></a>00524           x2 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s2,0);
<a name="l00525"></a>00525           y2 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s2,1);
<a name="l00526"></a>00526           z2 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s2,2);
<a name="l00527"></a>00527 
<a name="l00528"></a>00528           x3 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s4,0);
<a name="l00529"></a>00529           y3 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s4,1);
<a name="l00530"></a>00530           z3 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s4,2);
<a name="l00531"></a>00531 
<a name="l00532"></a>00532 <span class="comment">// volume_tetra1 =  dabs((x1-x0)*((y2-y0)*(z3-z0)-(y3-y0)*(z2-z0))-</span>
<a name="l00533"></a>00533 <span class="comment">// (x2-x0)*((y1-y0)*(z3-z0)-(y3-y0)*(z1-z0))+</span>
<a name="l00534"></a>00534 <span class="comment">// (x3-x0)*((y1-y0)*(z2-z0)-(y2-y0)*(z1-z0)))/6;</span>
<a name="l00535"></a>00535 
<a name="l00536"></a>00536           volume += <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>((x1-x0)*((y2-y0)*(z3-z0)-(y3-y0)*(z2-z0))-
<a name="l00537"></a>00537                          (x2-x0)*((y1-y0)*(z3-z0)-(y3-y0)*(z1-z0))+
<a name="l00538"></a>00538                          (x3-x0)*((y1-y0)*(z2-z0)-(y2-y0)*(z1-z0)))/6;
<a name="l00539"></a>00539 
<a name="l00540"></a>00540           x1 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s1,0);
<a name="l00541"></a>00541           y1 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s1,1);
<a name="l00542"></a>00542           z1 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s1,2);
<a name="l00543"></a>00543 
<a name="l00544"></a>00544           x2 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s4,0);
<a name="l00545"></a>00545           y2 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s4,1);
<a name="l00546"></a>00546           z2 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s4,2);
<a name="l00547"></a>00547 
<a name="l00548"></a>00548           x3 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s3,0);
<a name="l00549"></a>00549           y3 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s3,1);
<a name="l00550"></a>00550           z3 = dom.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(s3,2);
<a name="l00551"></a>00551 
<a name="l00552"></a>00552 <span class="comment">// volume_tetra2 = dabs((x1-x0)*((y2-y0)*(z3-z0)-(y3-y0)*(z2-z0))-</span>
<a name="l00553"></a>00553 <span class="comment">// (x2-x0)*((y1-y0)*(z3-z0)-(y3-y0)*(z1-z0))+</span>
<a name="l00554"></a>00554 <span class="comment">// (x3-x0)*((y1-y0)*(z2-z0)-(y2-y0)*(z1-z0)))/6;</span>
<a name="l00555"></a>00555 
<a name="l00556"></a>00556           volume += <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>((x1-x0)*((y2-y0)*(z3-z0)-(y3-y0)*(z2-z0))-
<a name="l00557"></a>00557                          (x2-x0)*((y1-y0)*(z3-z0)-(y3-y0)*(z1-z0))+
<a name="l00558"></a>00558                          (x3-x0)*((y1-y0)*(z2-z0)-(y2-y0)*(z1-z0)))/6;
<a name="l00559"></a>00559         }
<a name="l00560"></a>00560 
<a name="l00561"></a>00561       volumes[num_poly] = volume;
<a name="l00562"></a>00562       volume_global += volumes[num_poly];
<a name="l00563"></a>00563     }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 <span class="comment">// Cerr &lt;&lt; &quot;volumes &quot; &lt;&lt; volumes  &lt;&lt; finl;</span>
<a name="l00566"></a>00566 <span class="comment">// Cerr &lt;&lt; &quot; le volume global est = &quot; &lt;&lt; volume_global &lt;&lt; finl;</span>
<a name="l00567"></a>00567 
<a name="l00568"></a>00568 }
<a name="l00569"></a>00569 
<a name="l00570"></a>00570 <span class="comment">// Precondition:</span>
<a name="l00571"></a>00571 <span class="comment">// Parametre:</span>
<a name="l00572"></a>00572 <span class="comment">// Signification:</span>
<a name="l00573"></a>00573 <span class="comment">// Valeurs par defaut:</span>
<a name="l00574"></a>00574 <span class="comment">// Contraintes:</span>
<a name="l00575"></a>00575 <span class="comment">// Acces: sortie</span>
<a name="l00576"></a>00576 <span class="comment">// </span>
<a name="l00577"></a>00577 <span class="comment">// Signification:</span>
<a name="l00578"></a>00578 <span class="comment">// Contraintes:</span>
<a name="l00579"></a>00579 <span class="comment">// Exception:</span>
<a name="l00580"></a>00580 <span class="comment">// Effets de bord:</span>
<a name="l00581"></a>00581 <span class="comment">// Postcondition:</span>
<a name="l00582"></a>00582 <span class="comment">//</span><span class="comment"></span>
<a name="l00583"></a>00583 <span class="comment">//! Reordonne</span>
<a name="l00584"></a><a class="code" href="Hexaedre__VEF_8cpp.html#a369c61d2711df5114f1c22169dd1255e">00584</a> <span class="comment"></span><span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="Hexaedre__VEF_8cpp.html#a369c61d2711df5114f1c22169dd1255e" title="Reordonne.">reordonne</a>(<span class="keywordtype">int</span> i0,<span class="keywordtype">int</span> i1,<span class="keywordtype">int</span> i2,<span class="keywordtype">int</span> i3,<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord,<a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem,<span class="keywordtype">int</span>&amp; num_poly,<span class="keywordtype">int</span> <a class="code" href="Op__Grad__EF_8cpp.html#abc0897c211f7aa4541da5833388f868b">test</a>, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; v, <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; prod_,<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; prod_v, <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; dist, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; prod_v2)
<a name="l00585"></a>00585 {
<a name="l00586"></a>00586   <span class="keywordtype">int</span> s[4];
<a name="l00587"></a>00587   s[0]=elem(num_poly,i0);
<a name="l00588"></a>00588   s[1]=elem(num_poly,i1);
<a name="l00589"></a>00589   s[2]=elem(num_poly,i2);
<a name="l00590"></a>00590   s[3]=elem(num_poly,i3);
<a name="l00591"></a>00591 <span class="comment">// DoubleTab v(3,3);</span>
<a name="l00592"></a>00592   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;4; i++)
<a name="l00593"></a>00593     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir=0; dir&lt;3; dir++)
<a name="l00594"></a>00594       v(i-1,dir)=coord(s[i],dir)-coord(s[0],dir);
<a name="l00595"></a>00595 <span class="comment">// ArrOfDouble prod_(3);</span>
<a name="l00596"></a>00596   <span class="keywordtype">int</span> opp=-1;
<a name="l00597"></a>00597 <span class="comment">// avant tout on teste si on a bien un plan</span>
<a name="l00598"></a>00598   {
<a name="l00599"></a>00599 
<a name="l00600"></a>00600 <span class="comment">// ArrOfDouble prod_v(3);</span>
<a name="l00601"></a>00601     <span class="keywordtype">int</span> op=0,i=1;
<a name="l00602"></a>00602 <span class="comment">// prod_v=O1^O2</span>
<a name="l00603"></a>00603     prod_v(0)=v(op,1)*v(i,2)-v(op,2)*v(i,1);
<a name="l00604"></a>00604     prod_v(1)=v(op,2)*v(i,0)-v(op,0)*v(i,2);
<a name="l00605"></a>00605     prod_v(2)=v(op,0)*v(i,1)-v(op,1)*v(i,0);
<a name="l00606"></a>00606 <span class="comment">// ArrOfDouble dist(8);</span>
<a name="l00607"></a>00607     dist=0;
<a name="l00608"></a>00608     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;8; j++)
<a name="l00609"></a>00609       {
<a name="l00610"></a>00610         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir=0; dir&lt;3; dir++)
<a name="l00611"></a>00611           dist(j)+=prod_v(dir)*(coord(elem(num_poly,j),dir)-coord(s[0],dir));
<a name="l00612"></a>00612       }
<a name="l00613"></a>00613 <span class="comment">// Cerr&lt;&lt;&quot;ici &quot;&lt;&lt;i0 &lt;&lt;&quot; i1 &quot; &lt;&lt;i1&lt;&lt;&quot; i2 &quot;&lt;&lt;i2 &lt;&lt; &quot; i3 &quot;&lt;&lt;i3 &lt;&lt;&quot; &quot;&lt;&lt;dist&lt;&lt;finl;</span>
<a name="l00614"></a>00614 <span class="comment">// sommet le plus proche du plan</span>
<a name="l00615"></a>00615     <span class="keywordtype">int</span> s_plan=0;
<a name="l00616"></a>00616     <span class="keywordtype">double</span> min_dist=1e25;
<a name="l00617"></a>00617     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;8; j++)
<a name="l00618"></a>00618       {
<a name="l00619"></a>00619         <span class="keywordflow">if</span> ((j!=i0)&amp;&amp;(j!=i1)&amp;&amp;(j!=i2))
<a name="l00620"></a>00620           <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(dist(j))&lt;min_dist)
<a name="l00621"></a>00621             {
<a name="l00622"></a>00622               s_plan=j;
<a name="l00623"></a>00623               min_dist=<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(dist(j));
<a name="l00624"></a>00624             }
<a name="l00625"></a>00625       }
<a name="l00626"></a>00626     <span class="keywordflow">if</span> (s_plan!=i3)
<a name="l00627"></a>00627       {
<a name="l00628"></a>00628 <span class="comment">// pas un plan</span>
<a name="l00629"></a>00629         <span class="keywordflow">if</span> (test)
<a name="l00630"></a>00630           {
<a name="l00631"></a>00631 <span class="comment">// Cerr&lt;&lt;&quot;ici pb&quot;&lt;&lt;finl;</span>
<a name="l00632"></a>00632             <span class="keywordflow">return</span> 1;
<a name="l00633"></a>00633           }
<a name="l00634"></a>00634         <span class="keywordflow">else</span>
<a name="l00635"></a>00635           {
<a name="l00636"></a>00636             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;we do not have a plan &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00637"></a>00637             <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00638"></a>00638           }
<a name="l00639"></a>00639       }
<a name="l00640"></a>00640 <span class="comment">// doit on tester  si les 4 autres points sont du meme cote ???</span>
<a name="l00641"></a>00641 
<a name="l00642"></a>00642   }
<a name="l00643"></a>00643   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> op=0; op&lt;3; op++)
<a name="l00644"></a>00644     {
<a name="l00645"></a>00645 <span class="comment">// DoubleTab prod_v2(3,3);</span>
<a name="l00646"></a>00646       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;3; i++)
<a name="l00647"></a>00647         {
<a name="l00648"></a>00648           prod_v2(i,0)=v(op,1)*v(i,2)-v(op,2)*v(i,1);
<a name="l00649"></a>00649           prod_v2(i,1)=v(op,2)*v(i,0)-v(op,0)*v(i,2);
<a name="l00650"></a>00650           prod_v2(i,2)=v(op,0)*v(i,1)-v(op,1)*v(i,0);
<a name="l00651"></a>00651         }
<a name="l00652"></a>00652       <span class="keywordtype">double</span> <a class="code" href="Zone__CoviMAC_8h.html#aa24d8c7ee8fd93e2360821d3636ec69d">prod</a>=0;
<a name="l00653"></a>00653       <span class="keywordtype">int</span> i1bis=-1,j2bis=-1;
<a name="l00654"></a>00654       <span class="keywordflow">if</span> (op==0)
<a name="l00655"></a>00655         {
<a name="l00656"></a>00656           i1bis=1;
<a name="l00657"></a>00657           j2bis=2;
<a name="l00658"></a>00658         }
<a name="l00659"></a>00659       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (op==1)
<a name="l00660"></a>00660         {
<a name="l00661"></a>00661           i1bis=0;
<a name="l00662"></a>00662           j2bis=2;
<a name="l00663"></a>00663         }
<a name="l00664"></a>00664       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (op==2)
<a name="l00665"></a>00665         {
<a name="l00666"></a>00666           i1bis=0;
<a name="l00667"></a>00667           j2bis=1;
<a name="l00668"></a>00668         }
<a name="l00669"></a>00669       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir=0; dir&lt;3; dir++)
<a name="l00670"></a>00670         prod+=(prod_v2(i1bis,dir)*prod_v2(j2bis,dir));
<a name="l00671"></a>00671       prod_[op]=<a class="code" href="Zone__CoviMAC_8h.html#aa24d8c7ee8fd93e2360821d3636ec69d">prod</a>;
<a name="l00672"></a>00672       <span class="keywordflow">if</span> (prod&lt;0)
<a name="l00673"></a>00673         {
<a name="l00674"></a>00674           <span class="keywordflow">if</span> (opp!=-1)
<a name="l00675"></a>00675             {
<a name="l00676"></a>00676               op=3;
<a name="l00677"></a>00677               <span class="keywordflow">if</span> (test) <span class="keywordflow">return</span> 1;
<a name="l00678"></a>00678 <span class="comment">// on a deux produits negatifs on ne fait rien</span>
<a name="l00679"></a>00679             }
<a name="l00680"></a>00680           opp=op;
<a name="l00681"></a>00681 
<a name="l00682"></a>00682         }
<a name="l00683"></a>00683     }
<a name="l00684"></a>00684   <span class="keywordflow">if</span> ((test==0)&amp;&amp; ((opp==3)||(opp==-1)))
<a name="l00685"></a>00685     {
<a name="l00686"></a>00686       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; this does not seem to be a plan &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00687"></a>00687       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00688"></a>00688     }
<a name="l00689"></a>00689   <span class="keywordflow">if</span> ((opp!=2)&amp;&amp;(opp!=-2))
<a name="l00690"></a>00690     {
<a name="l00691"></a>00691       <span class="keywordtype">int</span> i2b=i2;
<a name="l00692"></a>00692       <span class="keywordflow">if</span> (opp==0) i2b=i1;
<a name="l00693"></a>00693       <span class="keywordflow">if</span> (test==0)
<a name="l00694"></a>00694         {
<a name="l00695"></a>00695           <span class="keywordtype">int</span> tmp=elem(num_poly,i2b);
<a name="l00696"></a>00696           elem(num_poly,i2b)=elem(num_poly,i3);
<a name="l00697"></a>00697           elem(num_poly,i3)=tmp;
<a name="l00698"></a>00698 
<a name="l00699"></a>00699 
<a name="l00700"></a>00700           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Permutation of local nodes &quot;</span>&lt;&lt;i2b&lt;&lt;<span class="stringliteral">&quot; and &quot;</span>&lt;&lt;i3&lt;&lt;<span class="stringliteral">&quot; on the element &quot;</span> &lt;&lt;num_poly&lt;&lt;<span class="stringliteral">&quot; prod &quot;</span>&lt;&lt;prod_&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00701"></a>00701 
<a name="l00702"></a>00702         }
<a name="l00703"></a>00703       <span class="keywordflow">return</span> 1;
<a name="l00704"></a>00704     }
<a name="l00705"></a>00705   <span class="keywordflow">return</span> 0;
<a name="l00706"></a>00706 }
<a name="l00707"></a><a class="code" href="classHexaedre__VEF.html#accd707f9a65655d6bb9d5febcd44aae7">00707</a> <span class="keywordtype">void</span> <a class="code" href="classHexaedre__VEF.html#accd707f9a65655d6bb9d5febcd44aae7" title="NE FAIT RIEN: A surcharger dans les classes derivees.">Hexaedre_VEF::reordonner</a>()
<a name="l00708"></a>00708 {
<a name="l00709"></a>00709   <span class="comment">/*</span>
<a name="l00710"></a>00710 <span class="comment">    22/12/04 : Generalisation de la methode (mais c&#39;est plus lent!)</span>
<a name="l00711"></a>00711 <span class="comment">    Numerotation d&#39;un hexa VEF:</span>
<a name="l00712"></a>00712 <span class="comment">    6--------7</span>
<a name="l00713"></a>00713 <span class="comment">    | \       |\</span>
<a name="l00714"></a>00714 <span class="comment">    4   2-----3  5</span>
<a name="l00715"></a>00715 <span class="comment">    \ /       \ |</span>
<a name="l00716"></a>00716 <span class="comment">    0---------1</span>
<a name="l00717"></a>00717 <span class="comment">    On boucle sur chacune des faces et on fait le produit scalaire 03.12/|03||12|</span>
<a name="l00718"></a>00718 <span class="comment">    et on le compare a 02.13/|02||13|</span>
<a name="l00719"></a>00719 <span class="comment">    S&#39;il est plus grand on intervertit les sommets 2 et 3.</span>
<a name="l00720"></a>00720 <span class="comment">    L&#39;algorithme fonctionne si 0123 et 4567 sont deja sur une meme face</span>
<a name="l00721"></a>00721 <span class="comment">  */</span>
<a name="l00722"></a>00722   <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone=<a class="code" href="classElem__geom__base.html#a70fcd0baca7afb11d3153b9ac5433ede">ma_zone</a>.<a class="code" href="classRef__Zone.html#ab4ba0de67809ff502efeb24c1e43bfe1">valeur</a>();
<a name="l00723"></a>00723   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem=zone.<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00724"></a>00724   <span class="keywordtype">int</span> nb_elem=zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>();
<a name="l00725"></a>00725   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coord=zone.<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>();
<a name="l00726"></a>00726 <span class="comment">// tableau contenant les permutations valides d&#39;un quadrangle</span>
<a name="l00727"></a>00727   <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> perm(8,4);
<a name="l00728"></a>00728   perm( 0 , 0 )= 0 ;
<a name="l00729"></a>00729   perm( 0 , 1 )= 1 ;
<a name="l00730"></a>00730   perm( 0 , 2 )= 2 ;
<a name="l00731"></a>00731   perm( 0 , 3 )= 3 ;
<a name="l00732"></a>00732   perm( 1 , 0 )= 0 ;
<a name="l00733"></a>00733   perm( 1 , 1 )= 2 ;
<a name="l00734"></a>00734   perm( 1 , 2 )= 1 ;
<a name="l00735"></a>00735   perm( 1 , 3 )= 3 ;
<a name="l00736"></a>00736   perm( 2 , 0 )= 1 ;
<a name="l00737"></a>00737   perm( 2 , 1 )= 0 ;
<a name="l00738"></a>00738   perm( 2 , 2 )= 3 ;
<a name="l00739"></a>00739   perm( 2 , 3 )= 2 ;
<a name="l00740"></a>00740   perm( 3 , 0 )= 1 ;
<a name="l00741"></a>00741   perm( 3 , 1 )= 3 ;
<a name="l00742"></a>00742   perm( 3 , 2 )= 0 ;
<a name="l00743"></a>00743   perm( 3 , 3 )= 2 ;
<a name="l00744"></a>00744   perm( 4 , 0 )= 2 ;
<a name="l00745"></a>00745   perm( 4 , 1 )= 0 ;
<a name="l00746"></a>00746   perm( 4 , 2 )= 3 ;
<a name="l00747"></a>00747   perm( 4 , 3 )= 1 ;
<a name="l00748"></a>00748   perm( 5 , 0 )= 2 ;
<a name="l00749"></a>00749   perm( 5 , 1 )= 3 ;
<a name="l00750"></a>00750   perm( 5 , 2 )= 0 ;
<a name="l00751"></a>00751   perm( 5 , 3 )= 1 ;
<a name="l00752"></a>00752   perm( 6 , 0 )= 3 ;
<a name="l00753"></a>00753   perm( 6 , 1 )= 1 ;
<a name="l00754"></a>00754   perm( 6 , 2 )= 2 ;
<a name="l00755"></a>00755   perm( 6 , 3 )= 0 ;
<a name="l00756"></a>00756   perm( 7 , 0 )= 3 ;
<a name="l00757"></a>00757   perm( 7 , 1 )= 2 ;
<a name="l00758"></a>00758   perm( 7 , 2 )= 1 ;
<a name="l00759"></a>00759   perm( 7 , 3 )= 0 ;
<a name="l00760"></a>00760 
<a name="l00761"></a>00761   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> v(3,3);
<a name="l00762"></a>00762   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> prod_(3);
<a name="l00763"></a>00763   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> prod_v(3);
<a name="l00764"></a>00764   <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> dist(8);
<a name="l00765"></a>00765   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> prod_v2(3,3);
<a name="l00766"></a>00766 
<a name="l00767"></a>00767   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> sa(8);
<a name="l00768"></a>00768   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_poly=0; num_poly&lt;nb_elem; num_poly++)
<a name="l00769"></a>00769     {
<a name="l00770"></a>00770       <span class="keywordtype">int</span> permutations=-1;
<a name="l00771"></a>00771 <span class="comment">// int niter=0;</span>
<a name="l00772"></a>00772 <span class="comment">// on commence par remettre correctement les 2 plans opposes</span>
<a name="l00773"></a>00773       permutations+=<a class="code" href="Hexaedre__VEF_8cpp.html#a369c61d2711df5114f1c22169dd1255e" title="Reordonne.">reordonne</a>(0,1,2,3,coord,elem,num_poly,0, v,prod_, prod_v, dist, prod_v2);
<a name="l00774"></a>00774       permutations+=<a class="code" href="Hexaedre__VEF_8cpp.html#a369c61d2711df5114f1c22169dd1255e" title="Reordonne.">reordonne</a>(4,5,6,7,coord,elem,num_poly,0, v,prod_, prod_v, dist, prod_v2);
<a name="l00775"></a>00775       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)
<a name="l00776"></a>00776         sa(i)=elem(num_poly,i);
<a name="l00777"></a>00777 <span class="comment">// on teste les 8 possibilites</span>
<a name="l00778"></a>00778       <span class="keywordtype">int</span> j;
<a name="l00779"></a>00779       <span class="keywordtype">int</span> n=0;
<a name="l00780"></a>00780       <span class="keywordtype">int</span> perm_valid=-1;
<a name="l00781"></a>00781       <span class="keywordflow">for</span> ( j=0; j&lt;8; j++)
<a name="l00782"></a>00782         {
<a name="l00783"></a>00783 <span class="comment">// Cerr&lt;&lt;&quot; debut test &quot;&lt;&lt;j&lt;&lt;finl;</span>
<a name="l00784"></a>00784           <span class="keywordtype">int</span> <a class="code" href="Op__Grad__EF_8cpp.html#abc0897c211f7aa4541da5833388f868b">test</a>=1;
<a name="l00785"></a>00785           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=4; i&lt;8; i++)
<a name="l00786"></a>00786             elem(num_poly,i)=sa(perm(j,i-4)+4);
<a name="l00787"></a>00787 <span class="comment">// on regarde si les 6 plans sont valides</span>
<a name="l00788"></a>00788           permutations=0;
<a name="l00789"></a>00789           permutations+=<a class="code" href="Hexaedre__VEF_8cpp.html#a369c61d2711df5114f1c22169dd1255e" title="Reordonne.">reordonne</a>(2,0,3,1,coord,elem,num_poly,test, v,prod_, prod_v, dist, prod_v2);
<a name="l00790"></a>00790           permutations+=<a class="code" href="Hexaedre__VEF_8cpp.html#a369c61d2711df5114f1c22169dd1255e" title="Reordonne.">reordonne</a>(3,1,7,5,coord,elem,num_poly,test, v,prod_, prod_v, dist, prod_v2);
<a name="l00791"></a>00791           permutations+=<a class="code" href="Hexaedre__VEF_8cpp.html#a369c61d2711df5114f1c22169dd1255e" title="Reordonne.">reordonne</a>(7,5,6,4,coord,elem,num_poly,test, v,prod_, prod_v, dist, prod_v2);
<a name="l00792"></a>00792           permutations+=<a class="code" href="Hexaedre__VEF_8cpp.html#a369c61d2711df5114f1c22169dd1255e" title="Reordonne.">reordonne</a>(6,4,2,0,coord,elem,num_poly,test, v,prod_, prod_v, dist, prod_v2);
<a name="l00793"></a>00793           permutations+=<a class="code" href="Hexaedre__VEF_8cpp.html#a369c61d2711df5114f1c22169dd1255e" title="Reordonne.">reordonne</a>(2,3,6,7,coord,elem,num_poly,test, v,prod_, prod_v, dist, prod_v2);
<a name="l00794"></a>00794           permutations+=<a class="code" href="Hexaedre__VEF_8cpp.html#a369c61d2711df5114f1c22169dd1255e" title="Reordonne.">reordonne</a>(4,5,0,1,coord,elem,num_poly,test, v,prod_, prod_v, dist, prod_v2);
<a name="l00795"></a>00795           <span class="keywordflow">if</span> (permutations==0)
<a name="l00796"></a>00796             {
<a name="l00797"></a>00797               <span class="keywordflow">if</span> (n&gt;0)
<a name="l00798"></a>00798 
<a name="l00799"></a>00799                 <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; former permutation &quot;</span>&lt;&lt; perm_valid&lt;&lt;<span class="stringliteral">&quot; new permutation &quot;</span>&lt;&lt;j&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00800"></a>00800               perm_valid=j;
<a name="l00801"></a>00801               n++;
<a name="l00802"></a>00802             }
<a name="l00803"></a>00803 
<a name="l00804"></a>00804 <span class="comment">// Cerr &lt;&lt; permutations &lt;&lt; &quot; permutations sur l&#39;element &quot; &lt;&lt; num_poly &lt;&lt; finl;</span>
<a name="l00805"></a>00805 <span class="comment">// Cerr &lt;&lt; elem(num_poly,0) &lt;&lt; &quot; &quot; &lt;&lt; elem(num_poly,1) &lt;&lt; &quot; &quot; &lt;&lt; elem(num_poly,2) &lt;&lt; &quot; &quot; &lt;&lt; elem(num_poly,3);</span>
<a name="l00806"></a>00806 <span class="comment">// Cerr &lt;&lt; &quot; &quot; &lt;&lt; elem(num_poly,4) &lt;&lt; &quot; &quot; &lt;&lt; elem(num_poly,5) &lt;&lt; &quot; &quot; &lt;&lt; elem(num_poly,6) &lt;&lt; &quot; &quot; &lt;&lt; elem(num_poly,7) &lt;&lt; finl;</span>
<a name="l00807"></a>00807 <span class="comment">// Cerr&lt;&lt;&quot; fin test &quot;&lt;&lt;j&lt;&lt;finl;</span>
<a name="l00808"></a>00808         }
<a name="l00809"></a>00809       <span class="keywordflow">if</span> (n==0)
<a name="l00810"></a>00810         {
<a name="l00811"></a>00811           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Failure of the algorithm in Hexaedre_VEF::reordonner&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00812"></a>00812           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Here is the connectivity element-node of the cell &quot;</span> &lt;&lt; num_poly &lt;&lt; <span class="stringliteral">&quot; that raises problem:&quot;</span> &lt;&lt; finl;
<a name="l00813"></a>00813           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)
<a name="l00814"></a>00814             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; sa(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00815"></a>00815           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl;
<a name="l00816"></a>00816           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00817"></a>00817         }
<a name="l00818"></a>00818       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n&gt;1)
<a name="l00819"></a>00819         {
<a name="l00820"></a>00820           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Failure of the algorithm in Hexaedre_VEF::reordonner&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00821"></a>00821           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;many permutations possibles&quot;</span>&lt;&lt;finl;
<a name="l00822"></a>00822           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Here is the connectivity element-node of the cell &quot;</span> &lt;&lt; num_poly &lt;&lt; <span class="stringliteral">&quot; that raises problem:&quot;</span> &lt;&lt; finl;
<a name="l00823"></a>00823           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)
<a name="l00824"></a>00824             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; sa(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00825"></a>00825           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl;
<a name="l00826"></a>00826           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Here is the new connectivity element-node of the cell &quot;</span> &lt;&lt; num_poly &lt;&lt; <span class="stringliteral">&quot; that raises problem:&quot;</span> &lt;&lt; finl;
<a name="l00827"></a>00827           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++)
<a name="l00828"></a>00828             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; elem(num_poly,i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00829"></a>00829           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl;
<a name="l00830"></a>00830 <span class="comment">// exit();</span>
<a name="l00831"></a>00831         }
<a name="l00832"></a>00832       {
<a name="l00833"></a>00833         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=4; i&lt;8; i++)
<a name="l00834"></a>00834           elem(num_poly,i)=sa(perm(perm_valid,i-4)+4);
<a name="l00835"></a>00835 
<a name="l00836"></a>00836         <span class="keywordflow">if</span>(perm_valid!=0)
<a name="l00837"></a>00837           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; we carried out the permutation &quot;</span>&lt;&lt;perm_valid&lt;&lt;<span class="stringliteral">&quot; on the element &quot;</span>&lt;&lt;num_poly&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00838"></a>00838       }
<a name="l00839"></a>00839     }
<a name="l00840"></a>00840 }
<a name="l00841"></a><a class="code" href="Hexaedre__VEF_8cpp.html#a20cee52334f65a17ab47414d5dde3e88">00841</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="Hexaedre__VEF_8cpp.html#a20cee52334f65a17ab47414d5dde3e88">faces_sommets_hexa_vef</a>[6][4] =
<a name="l00842"></a>00842 {
<a name="l00843"></a>00843   { 0, 2, 4, 6 },
<a name="l00844"></a>00844   { 0, 1, 4, 5 },
<a name="l00845"></a>00845   { 0, 1, 2, 3 },
<a name="l00846"></a>00846   { 1, 3, 5, 7 },
<a name="l00847"></a>00847   { 2, 3, 6, 7 },
<a name="l00848"></a>00848   { 4, 5, 6, 7 }
<a name="l00849"></a>00849 };
<a name="l00850"></a>00850 <span class="comment"></span>
<a name="l00851"></a>00851 <span class="comment">//! voir ElemGeomBase::get_tab_faces_sommets_locaux</span>
<a name="l00852"></a><a class="code" href="classHexaedre__VEF.html#a3fed12ae429a7a7d42807c29ca3d1cd4">00852</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classHexaedre__VEF.html#a3fed12ae429a7a7d42807c29ca3d1cd4" title="voir ElemGeomBase::get_tab_faces_sommets_locaux">Hexaedre_VEF::get_tab_faces_sommets_locaux</a>(<a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_som_local)<span class="keyword"> const</span>
<a name="l00853"></a>00853 <span class="keyword"></span>{
<a name="l00854"></a>00854   faces_som_local.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(6,4);
<a name="l00855"></a>00855   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;6; i++)
<a name="l00856"></a>00856     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;4; j++)
<a name="l00857"></a>00857       faces_som_local(i,j) = <a class="code" href="Hexaedre__VEF_8cpp.html#a20cee52334f65a17ab47414d5dde3e88">faces_sommets_hexa_vef</a>[i][j];
<a name="l00858"></a>00858   <span class="keywordflow">return</span> 1;
<a name="l00859"></a>00859 }
<a name="l00860"></a>00860 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:19 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
