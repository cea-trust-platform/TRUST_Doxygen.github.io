<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/ThHyd/Incompressible/Equations/Navier_Stokes_std.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/ThHyd/Incompressible/Equations/Navier_Stokes_std.cpp</div>  </div>
</div>
<div class="contents">
<a href="Navier__Stokes__std_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Navier_Stokes_std.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/ThHyd/Incompressible/Equations</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/121</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Navier__Stokes__std_8h.html">Navier_Stokes_std.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Probleme__base_8h.html">Probleme_base.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Fluide__base_8h.html">Fluide_base.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Discret__Thyd_8h.html">Discret_Thyd.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Avanc_8h.html">Avanc.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Debog_8h.html">Debog.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="LecFicDistribue_8h.html">LecFicDistribue.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse__Sym_8h.html">Matrice_Morse_Sym.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Uniforme_8h.html">Champ_Uniforme.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Op__Conv__ALE_8h.html">Op_Conv_ALE.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Frontiere__dis__base_8h.html">Frontiere_dis_base.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="solv__iteratif_8h.html">solv_iteratif.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Temps_8h.html">Schema_Temps.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="DoubleTrav_8h.html">DoubleTrav.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="Check__espace__virtuel_8h.html">Check_espace_virtuel.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="Assembleur__base_8h.html">Assembleur_base.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="communications_8h.html">communications.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="Transport__Interfaces__base_8h.html">Transport_Interfaces_base.h</a>&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;<a class="code" href="Ensemble__Lagrange__base_8h.html">Ensemble_Lagrange_base.h</a>&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="SFichier_8h.html">SFichier.h</a>&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;<a class="code" href="Param_8h.html">Param.h</a>&gt;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;<a class="code" href="MD__Vector__std_8h.html">MD_Vector_std.h</a>&gt;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &lt;<a class="code" href="MD__Vector__composite_8h.html">MD_Vector_composite.h</a>&gt;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;<a class="code" href="MD__Vector__tools_8h.html">MD_Vector_tools.h</a>&gt;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &lt;<a class="code" href="ConstDoubleTab__parts_8h.html">ConstDoubleTab_parts.h</a>&gt;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VF_8h.html">Zone_VF.h</a>&gt;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &lt;<a class="code" href="Source__PDF__base_8h.html">Source_PDF_base.h</a>&gt;</span> <span class="comment">//!&lt; For Immersed Boundary Method (IBM)</span>
<a name="l00051"></a>00051 <span class="comment"></span>
<a name="l00052"></a><a class="code" href="Navier__Stokes__std_8cpp.html#af014d78ac62407ac1a92deb2f396324a">00052</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classNavier__Stokes__std.html" title="classe Navier_Stokes_std Cette classe porte les termes de l&#39;equation de la dynamique pour un fluide s...">Navier_Stokes_std</a>,<span class="stringliteral">&quot;Navier_Stokes_standard&quot;</span>,<a class="code" href="classEquation__base.html">Equation_base</a>);
<a name="l00053"></a>00053 
<a name="l00054"></a><a class="code" href="classNavier__Stokes__std.html#aa7ecf982e968083104411f40d418c0a5">00054</a> <a class="code" href="classNavier__Stokes__std.html#aa7ecf982e968083104411f40d418c0a5">Navier_Stokes_std::Navier_Stokes_std</a>():methode_calcul_pression_initiale_(0),div_u_nul_et_non_dsurdt_divu_(0),postraitement_gradient_P_(0)
<a name="l00055"></a>00055 {
<a name="l00056"></a>00056   <a class="code" href="classNavier__Stokes__std.html#a7e3bbcec7e27b0a5a9db865711bea9ee">projection_initiale</a> = 1;
<a name="l00057"></a>00057   <a class="code" href="classNavier__Stokes__std.html#af9c35ba318c93f61c8c4afcec827fe2b">dt_projection</a>=1.e12;
<a name="l00058"></a>00058   <a class="code" href="classNavier__Stokes__std.html#a79d95aa22a50a68351909f89bd91801b">max_div_U</a>=1.e12;
<a name="l00059"></a>00059   <a class="code" href="classNavier__Stokes__std.html#a2daee5722e9109ff537ae5c818556049">seuil_projection</a> = 0.;
<a name="l00060"></a>00060   <a class="code" href="classNavier__Stokes__std.html#a83cd41e652d760f61f871626780e898d">seuil_uzawa</a> = 1.e-12;
<a name="l00061"></a>00061   <a class="code" href="classNavier__Stokes__std.html#af4b0fd768cdbc86d5649b7f058cd7cb8">seuil_divU</a> = 100.;
<a name="l00062"></a>00062   <a class="code" href="classNavier__Stokes__std.html#a5d6182d739775d51469385fdaee02477">cumulative_</a>=0;
<a name="l00063"></a>00063   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;vorticite&quot;</span>);
<a name="l00064"></a>00064   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;critere_Q&quot;</span>);
<a name="l00065"></a>00065   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;porosite_volumique&quot;</span>);
<a name="l00066"></a>00066   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;y_plus&quot;</span>);
<a name="l00067"></a>00067   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;reynolds_maille&quot;</span>);
<a name="l00068"></a>00068   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;courant_maille&quot;</span>);
<a name="l00069"></a>00069   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;taux_cisaillement&quot;</span>);
<a name="l00070"></a>00070   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;pression_hydrostatique&quot;</span>);
<a name="l00071"></a>00071   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;gradient_vitesse&quot;</span>);
<a name="l00072"></a>00072   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#a6bf07487654d24d9683955140ea44054">ajoute_nom_compris</a>(<span class="stringliteral">&quot;vitesse_residu&quot;</span>);
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="comment">// Default values for IBM parameters</span>
<a name="l00075"></a>00075   <a class="code" href="classNavier__Stokes__std.html#a860d58250e340bc1aa44f4469df82320">postraiter_gradient_pression_sans_masse_</a> = 0;
<a name="l00076"></a>00076   <a class="code" href="classNavier__Stokes__std.html#ad14f58cd42e2a5a8631b8c7181630184">correction_matrice_projection_initiale_</a> = 0;
<a name="l00077"></a>00077   <a class="code" href="classNavier__Stokes__std.html#a754b63d4c4a12da049992901506b3f60">correction_calcul_pression_initiale_</a> = 0;
<a name="l00078"></a>00078   <a class="code" href="classNavier__Stokes__std.html#a2731b349868649fd27e20b4517079c0a">correction_vitesse_projection_initiale_</a> = 1;
<a name="l00079"></a>00079   <a class="code" href="classNavier__Stokes__std.html#a5f86768d882558420477430db7ca1293">correction_matrice_pression_</a> = 1;
<a name="l00080"></a>00080   <a class="code" href="classNavier__Stokes__std.html#aa82c5d9c34a459ed915e4d448aadeca8">matrice_pression_penalisee_H1_</a> = 0;
<a name="l00081"></a>00081   <a class="code" href="classNavier__Stokes__std.html#a8f7fa77dddccb7f42e7144c3b16a256f">correction_vitesse_modifie_</a> = 1;
<a name="l00082"></a>00082   <a class="code" href="classNavier__Stokes__std.html#ad3bd1e6bc79e71af01931bc207fd3028">correction_pression_modifie_</a> = 0;
<a name="l00083"></a>00083   <a class="code" href="classNavier__Stokes__std.html#a5526acdbeb7c79654690c5dd385ff08b">gradient_pression_qdm_modifie_</a> = 0;
<a name="l00084"></a>00084 }
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 <span class="comment">// Precondition:</span>
<a name="l00087"></a>00087 <span class="comment">// Parametre: Sortie&amp; os</span>
<a name="l00088"></a>00088 <span class="comment">// Signification: un flot de sortie</span>
<a name="l00089"></a>00089 <span class="comment">// Valeurs par defaut:</span>
<a name="l00090"></a>00090 <span class="comment">// Contraintes:</span>
<a name="l00091"></a>00091 <span class="comment">// Acces: entree/sortie</span>
<a name="l00092"></a>00092 <span class="comment">// Exception:</span>
<a name="l00093"></a>00093 <span class="comment">// Effets de bord:</span>
<a name="l00094"></a>00094 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet la methode ne modifie pas l&#39;objet</span>
<a name="l00095"></a>00095 <span class="comment">//</span>
<a name="l00096"></a>00096 <span class="comment">//</span><span class="comment"></span>
<a name="l00097"></a>00097 <span class="comment">//! Simple appel a:  Equation_base::printOn(Sortie\&amp;)&lt;br&gt;Ecrit l&#39;equation sur un flot de sortie.</span>
<a name="l00098"></a>00098 <span class="comment"></span><span class="comment">/** \return Sortie\&amp;&lt;br&gt;</span>
<a name="l00099"></a>00099 <span class="comment">Signification: le flot de sortie modifie&lt;br&gt;</span>
<a name="l00100"></a>00100 <span class="comment">Contraintes: */</span>
<a name="l00101"></a><a class="code" href="classNavier__Stokes__std.html#a8cef761317f3344b5a793de30396f2f9">00101</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a8cef761317f3344b5a793de30396f2f9" title="Simple appel a: Equation_base::printOn(Sortie&amp;) Ecrit l&#39;equation sur un flot de sortie.">Navier_Stokes_std::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; is)<span class="keyword"> const</span>
<a name="l00102"></a>00102 <span class="keyword"></span>{
<a name="l00103"></a>00103   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a8cef761317f3344b5a793de30396f2f9" title="Simple appel a: Equation_base::printOn(Sortie&amp;) Ecrit l&#39;equation sur un flot de sortie.">Equation_base::printOn</a>(is);
<a name="l00104"></a>00104 }
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 <span class="comment">// Precondition: l&#39;equation doit avoir un milieu fluide associe</span>
<a name="l00108"></a>00108 <span class="comment">// Parametre: Entree&amp; is</span>
<a name="l00109"></a>00109 <span class="comment">// Signification: un flot d&#39;entree</span>
<a name="l00110"></a>00110 <span class="comment">// Valeurs par defaut:</span>
<a name="l00111"></a>00111 <span class="comment">// Contraintes:</span>
<a name="l00112"></a>00112 <span class="comment">// Acces: entree/sortie</span>
<a name="l00113"></a>00113 <span class="comment">// Exception: terme diffusif non specifie dans jeu de donnees, specifier</span>
<a name="l00114"></a>00114 <span class="comment">// un type negligeable pour l&#39;operateur si il est a negliger</span>
<a name="l00115"></a>00115 <span class="comment">// Exception: terme convectif non specifie dans jeu de donnees, specifier</span>
<a name="l00116"></a>00116 <span class="comment">// un type negligeable pour l&#39;operateur si il est a negliger</span>
<a name="l00117"></a>00117 <span class="comment">// Exception: solveur pression non defini dans jeu de donnees</span>
<a name="l00118"></a>00118 <span class="comment">// Effets de bord:</span>
<a name="l00119"></a>00119 <span class="comment">// Postcondition:</span>
<a name="l00120"></a>00120 <span class="comment">//</span>
<a name="l00121"></a>00121 <span class="comment">//</span>
<a name="l00122"></a>00122 <span class="comment">//</span>
<a name="l00123"></a>00123 <span class="comment">//</span>
<a name="l00124"></a>00124 <span class="comment">//</span><span class="comment"></span>
<a name="l00125"></a>00125 <span class="comment">//! Appel Equation_base::readOn(Entree\&amp; is)&lt;br&gt;En sortie verifie que l&#39;on a bien lu:&lt;br&gt;- le terme diffusif,&lt;br&gt;- le terme convectif,&lt;br&gt;- le solveur en pression</span>
<a name="l00126"></a>00126 <span class="comment"></span><span class="comment">/** \return Entree\&amp;&lt;br&gt;</span>
<a name="l00127"></a>00127 <span class="comment">Signification: le flot d&#39;entree modifie&lt;br&gt;</span>
<a name="l00128"></a>00128 <span class="comment">Contraintes: */</span>
<a name="l00129"></a><a class="code" href="classNavier__Stokes__std.html#afae43f83d43d650962d31ad028ebae50">00129</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classNavier__Stokes__std.html#afae43f83d43d650962d31ad028ebae50" title="Appel Equation_base::readOn(Entree&amp; is) En sortie verifie que l&#39;on a bien lu: - le terme diffusif...">Navier_Stokes_std::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00130"></a>00130 {
<a name="l00131"></a>00131   <a class="code" href="classNavier__Stokes__std.html#afae43f83d43d650962d31ad028ebae50" title="Appel Equation_base::readOn(Entree&amp; is) En sortie verifie que l&#39;on a bien lu: - le terme diffusif...">Equation_base::readOn</a>(is);
<a name="l00132"></a>00132   <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(<a class="code" href="classNavier__Stokes__std.html#a2daee5722e9109ff537ae5c818556049">seuil_projection</a>,0.) &amp;&amp; (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classsolv__iteratif.html">solv_iteratif</a>,<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>())))
<a name="l00133"></a>00133     {
<a name="l00134"></a>00134       <a class="code" href="classsolv__iteratif.html">solv_iteratif</a>&amp; solv_iter = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classsolv__iteratif.html">solv_iteratif</a>,<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>());
<a name="l00135"></a>00135       <a class="code" href="classNavier__Stokes__std.html#a2daee5722e9109ff537ae5c818556049">seuil_projection</a> = solv_iter.<a class="code" href="classsolv__iteratif.html#acb57780795c754663eb6974e123aec88">get_seuil</a>();
<a name="l00136"></a>00136     }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138   <a class="code" href="classNavier__Stokes__std.html#a3a5698f420e093b2bbb77df313b5bb97">terme_convectif</a>.<a class="code" href="classOperateur.html#adf6c5f02d4e0bd15282a628c4814d61f">set_fichier</a>(<span class="stringliteral">&quot;Convection_qdm&quot;</span>);
<a name="l00139"></a>00139   <a class="code" href="classNavier__Stokes__std.html#a3a5698f420e093b2bbb77df313b5bb97">terme_convectif</a>.<a class="code" href="classOperateur.html#abe53b54eda0c886809a704bf79b60aa9">set_description</a>(<span class="stringliteral">&quot;Momentum flow rate=Integral(rho*u*u*ndS) [N] if SI units used&quot;</span>);
<a name="l00140"></a>00140   <a class="code" href="classNavier__Stokes__std.html#a0a5eb69f0664bd8b0f008e7656ac25d6">terme_diffusif</a>.<a class="code" href="classOperateur.html#adf6c5f02d4e0bd15282a628c4814d61f">set_fichier</a>(<span class="stringliteral">&quot;Contrainte_visqueuse&quot;</span>);
<a name="l00141"></a>00141   <a class="code" href="classNavier__Stokes__std.html#a0a5eb69f0664bd8b0f008e7656ac25d6">terme_diffusif</a>.<a class="code" href="classOperateur.html#abe53b54eda0c886809a704bf79b60aa9">set_description</a>(<span class="stringliteral">&quot;Friction drag exerted by the fluid=Integral(-mu*grad(u)*ndS) [N] if SI units used&quot;</span>);
<a name="l00142"></a>00142   <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur.html#adf6c5f02d4e0bd15282a628c4814d61f">set_fichier</a>(<span class="stringliteral">&quot;Debit&quot;</span>);
<a name="l00143"></a>00143   <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur.html#abe53b54eda0c886809a704bf79b60aa9">set_description</a>((<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>)<span class="stringliteral">&quot;Volumetric flow rate=Integral(u*ndS) [m&quot;</span>+(<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>)(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+<a class="code" href="classObjet__U.html#a9a47c1add9760324894500792c17a178">bidim_axi</a>)+<span class="stringliteral">&quot;.s-1] if SI units used&quot;</span>);
<a name="l00144"></a>00144   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur.html#adf6c5f02d4e0bd15282a628c4814d61f">set_fichier</a>(<span class="stringliteral">&quot;Force_pression&quot;</span>);
<a name="l00145"></a>00145   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur.html#abe53b54eda0c886809a704bf79b60aa9">set_description</a>(<span class="stringliteral">&quot;Pressure drag exerted by the fluid=Integral(P*ndS) [N] if SI units used&quot;</span>);
<a name="l00146"></a>00146   <span class="keywordtype">int</span> i_source = -1;
<a name="l00147"></a>00147   <span class="keywordtype">int</span> nb_source_pdf = 0;
<a name="l00148"></a>00148   <span class="keywordtype">int</span> nb_source  = <a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>().<a class="code" href="classliste.html#ab47f280662ff68f9aa2e00e50431c5dc" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>();
<a name="l00149"></a>00149   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;nb_source : &quot;</span> &lt;&lt; nb_source &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00150"></a>00150   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i&lt;nb_source; i++)
<a name="l00151"></a>00151     {
<a name="l00152"></a>00152 <span class="comment">// Cerr &lt;&lt; (sources())[i].valeur().que_suis_je() &lt;&lt; &quot;, &quot; &lt;&lt; (sources())[i].valeur().que_suis_je().find(&quot;gne&quot;) &lt;&lt; finl;</span>
<a name="l00153"></a>00153       <span class="keywordflow">if</span> ((<a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>())[i].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>().find(<span class="stringliteral">&quot;Source_PDF&quot;</span>) &gt; -1)
<a name="l00154"></a>00154         {
<a name="l00155"></a>00155           i_source = i;
<a name="l00156"></a>00156           nb_source_pdf++;
<a name="l00157"></a>00157         }
<a name="l00158"></a>00158     }
<a name="l00159"></a>00159   <span class="keywordflow">if</span> (nb_source_pdf&gt;1)
<a name="l00160"></a>00160     {
<a name="l00161"></a>00161       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;(IBM) More than one Source_PDF_base detected.&quot;</span>&lt;&lt;finl;
<a name="l00162"></a>00162       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;(IBM) Case not supported.&quot;</span>&lt;&lt;finl;
<a name="l00163"></a>00163       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Aborting...&quot;</span>&lt;&lt;finl;
<a name="l00164"></a>00164       <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">abort</a>();
<a name="l00165"></a>00165     }
<a name="l00166"></a>00166   <a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a> = i_source;
<a name="l00167"></a>00167   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a> != -1)
<a name="l00168"></a>00168     {
<a name="l00169"></a>00169       <a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>()[<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a>].<a class="code" href="classList__Source.html#a7e4137d89cdcf913702c88f720a7f316" title="Retourne l&#39;Objet_U associe a la cellule de la liste.">valeur</a>().set_description((<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>)<span class="stringliteral">&quot;Sum of the source term on the obstacle (~= force induced by the obstacle under some assumptions)&quot;</span>);
<a name="l00170"></a>00170       <a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>()[<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a>].<a class="code" href="classList__Source.html#a7e4137d89cdcf913702c88f720a7f316" title="Retourne l&#39;Objet_U associe a la cellule de la liste.">valeur</a>().set_fichier((<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>)<span class="stringliteral">&quot;Force_induced_by_obstacle&quot;</span>);
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172   <span class="keywordflow">return</span> is;
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a><a class="code" href="classNavier__Stokes__std.html#a82569c8cb349b0eaf4d97bc658e2b8fb">00175</a> <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#a82569c8cb349b0eaf4d97bc658e2b8fb">Navier_Stokes_std::set_param</a>(<a class="code" href="classParam.html" title="Defined below in this file.">Param</a>&amp; param)
<a name="l00176"></a>00176 {
<a name="l00177"></a>00177   <a class="code" href="classNavier__Stokes__std.html#a82569c8cb349b0eaf4d97bc658e2b8fb">Equation_base::set_param</a>(param);
<a name="l00178"></a>00178   param.<a class="code" href="classParam.html#a8d8bcddfd8087e577ffbb170c68e4f88">ajouter_non_std</a>(<span class="stringliteral">&quot;diffusion&quot;</span>,(<span class="keyword">this</span>));
<a name="l00179"></a>00179   param.<a class="code" href="classParam.html#a8d8bcddfd8087e577ffbb170c68e4f88">ajouter_non_std</a>(<span class="stringliteral">&quot;convection&quot;</span>,(<span class="keyword">this</span>));
<a name="l00180"></a>00180   param.<a class="code" href="classParam.html#a6363f31c467c06512aee2f004abac69d">ajouter_condition</a>(<span class="stringliteral">&quot;is_read_diffusion&quot;</span>,<span class="stringliteral">&quot;The diffusion operator must be read, select negligeable type if you want to neglect it.&quot;</span>);
<a name="l00181"></a>00181   param.<a class="code" href="classParam.html#a6363f31c467c06512aee2f004abac69d">ajouter_condition</a>(<span class="stringliteral">&quot;is_read_convection&quot;</span>,<span class="stringliteral">&quot;The convection operator must be read, select negligeable type if you want to neglect it.&quot;</span>);
<a name="l00182"></a>00182   param.<a class="code" href="classParam.html#a8d8bcddfd8087e577ffbb170c68e4f88">ajouter_non_std</a>(<span class="stringliteral">&quot;solveur_pression&quot;</span>,(<span class="keyword">this</span>),<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384aaf5b6dfac1c5970478525407cc6ac572">Param::REQUIRED</a>);
<a name="l00183"></a>00183   param.<a class="code" href="classParam.html#a8d8bcddfd8087e577ffbb170c68e4f88">ajouter_non_std</a>(<span class="stringliteral">&quot;dt_projection&quot;</span>,(<span class="keyword">this</span>));
<a name="l00184"></a>00184   param.<a class="code" href="classParam.html#a8d8bcddfd8087e577ffbb170c68e4f88">ajouter_non_std</a>(<span class="stringliteral">&quot;Traitement_particulier&quot;</span>,(<span class="keyword">this</span>));
<a name="l00185"></a>00185   param.<a class="code" href="classParam.html#a8d8bcddfd8087e577ffbb170c68e4f88">ajouter_non_std</a>(<span class="stringliteral">&quot;Erreur_max_DivU&quot;</span>,(<span class="keyword">this</span>));
<a name="l00186"></a>00186   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;uzawa&quot;</span>,&amp;<a class="code" href="classNavier__Stokes__std.html#a83cd41e652d760f61f871626780e898d">seuil_uzawa</a>);
<a name="l00187"></a>00187 <span class="comment">// param.ajouter_non_std(&quot;vitesse_transportante&quot;,(this));</span>
<a name="l00188"></a>00188   param.<a class="code" href="classParam.html#a8d8bcddfd8087e577ffbb170c68e4f88">ajouter_non_std</a>(<span class="stringliteral">&quot;seuil_divU&quot;</span>,(<span class="keyword">this</span>));
<a name="l00189"></a>00189   param.<a class="code" href="classParam.html#a8d8bcddfd8087e577ffbb170c68e4f88">ajouter_non_std</a>(<span class="stringliteral">&quot;solveur_bar&quot;</span>,(<span class="keyword">this</span>));
<a name="l00190"></a>00190   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;projection_initiale&quot;</span>,&amp;<a class="code" href="classNavier__Stokes__std.html#a7e3bbcec7e27b0a5a9db865711bea9ee">projection_initiale</a>);
<a name="l00191"></a>00191   param.<a class="code" href="classParam.html#a8d8bcddfd8087e577ffbb170c68e4f88">ajouter_non_std</a>(<span class="stringliteral">&quot;methode_calcul_pression_initiale&quot;</span>,(<span class="keyword">this</span>));
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 <span class="comment">// Parameters for IBM</span>
<a name="l00194"></a>00194   param.<a class="code" href="classParam.html#ae3d50612a0014a9d58e6e035a65f20e5">ajouter_flag</a>(<span class="stringliteral">&quot;postraiter_gradient_pression_sans_masse&quot;</span>,&amp;<a class="code" href="classNavier__Stokes__std.html#a860d58250e340bc1aa44f4469df82320">postraiter_gradient_pression_sans_masse_</a>,<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384a636f87f06d9b732f1443c9051bf2c23a">Param::OPTIONAL</a>);
<a name="l00195"></a>00195   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;correction_matrice_projection_initiale&quot;</span>,&amp;<a class="code" href="classNavier__Stokes__std.html#ad14f58cd42e2a5a8631b8c7181630184">correction_matrice_projection_initiale_</a>,<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384a636f87f06d9b732f1443c9051bf2c23a">Param::OPTIONAL</a>);
<a name="l00196"></a>00196   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;correction_calcul_pression_initiale&quot;</span>,&amp;<a class="code" href="classNavier__Stokes__std.html#a754b63d4c4a12da049992901506b3f60">correction_calcul_pression_initiale_</a>,<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384a636f87f06d9b732f1443c9051bf2c23a">Param::OPTIONAL</a>);
<a name="l00197"></a>00197   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;correction_vitesse_projection_initiale&quot;</span>,&amp;<a class="code" href="classNavier__Stokes__std.html#a2731b349868649fd27e20b4517079c0a">correction_vitesse_projection_initiale_</a>,<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384a636f87f06d9b732f1443c9051bf2c23a">Param::OPTIONAL</a>);
<a name="l00198"></a>00198   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;correction_matrice_pression&quot;</span>,&amp;<a class="code" href="classNavier__Stokes__std.html#a5f86768d882558420477430db7ca1293">correction_matrice_pression_</a>,<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384a636f87f06d9b732f1443c9051bf2c23a">Param::OPTIONAL</a>);
<a name="l00199"></a>00199   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;matrice_pression_penalisee_H1&quot;</span>,&amp;<a class="code" href="classNavier__Stokes__std.html#aa82c5d9c34a459ed915e4d448aadeca8">matrice_pression_penalisee_H1_</a>,<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384a636f87f06d9b732f1443c9051bf2c23a">Param::OPTIONAL</a>);
<a name="l00200"></a>00200   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;correction_vitesse_modifie&quot;</span>,&amp;<a class="code" href="classNavier__Stokes__std.html#a8f7fa77dddccb7f42e7144c3b16a256f">correction_vitesse_modifie_</a>,<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384a636f87f06d9b732f1443c9051bf2c23a">Param::OPTIONAL</a>);
<a name="l00201"></a>00201   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;correction_pression_modifie&quot;</span>,&amp;<a class="code" href="classNavier__Stokes__std.html#ad3bd1e6bc79e71af01931bc207fd3028">correction_pression_modifie_</a>,<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384a636f87f06d9b732f1443c9051bf2c23a">Param::OPTIONAL</a>);
<a name="l00202"></a>00202   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;gradient_pression_qdm_modifie&quot;</span>,&amp;<a class="code" href="classNavier__Stokes__std.html#a5526acdbeb7c79654690c5dd385ff08b">gradient_pression_qdm_modifie_</a>,<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384a636f87f06d9b732f1443c9051bf2c23a">Param::OPTIONAL</a>);
<a name="l00203"></a>00203 }
<a name="l00204"></a>00204 
<a name="l00205"></a><a class="code" href="classNavier__Stokes__std.html#ab70369d00836f24de31887b8786d9582">00205</a> <span class="keywordtype">int</span> <a class="code" href="classNavier__Stokes__std.html#ab70369d00836f24de31887b8786d9582" title="Lecture des parametres de type non simple d&#39;un objet_U a partir d&#39;un flot d&#39;entree.">Navier_Stokes_std::lire_motcle_non_standard</a>(<span class="keyword">const</span> <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>&amp; mot, <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00206"></a>00206 {
<a name="l00207"></a>00207   <span class="keywordflow">if</span> (mot==<span class="stringliteral">&quot;diffusion&quot;</span>)
<a name="l00208"></a>00208     {
<a name="l00209"></a>00209       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Reading and typing of the diffusion operator : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00210"></a>00210       <a class="code" href="classNavier__Stokes__std.html#a0a5eb69f0664bd8b0f008e7656ac25d6">terme_diffusif</a>.<a class="code" href="classOperateur__Diff.html#a9e560c15136324e71568e3087f3652b5" title="Associe la diffusivite a l&#39;operateur.">associer_diffusivite</a>(<a class="code" href="classNavier__Stokes__std.html#a58b27703d4eb0328d939b957061532e4">diffusivite_pour_transport</a>());
<a name="l00211"></a>00211       is &gt;&gt; <a class="code" href="classNavier__Stokes__std.html#a0a5eb69f0664bd8b0f008e7656ac25d6">terme_diffusif</a>;
<a name="l00212"></a>00212 <span class="comment">// le champ pour le dt_stab est le meme que celui de l&#39;operateur</span>
<a name="l00213"></a>00213       terme_diffusif.<a class="code" href="classOperateur__Diff.html#a75a11b9bc776e5de33c49f48e947f8be">associer_diffusivite_pour_pas_de_temps</a>(<a class="code" href="classNavier__Stokes__std.html#abfbc25c93eadc54604cedd904ca9b38f">diffusivite_pour_pas_de_temps</a>());
<a name="l00214"></a>00214       <span class="keywordflow">return</span> 1;
<a name="l00215"></a>00215     }
<a name="l00216"></a>00216   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mot==<span class="stringliteral">&quot;convection&quot;</span>)
<a name="l00217"></a>00217     {
<a name="l00218"></a>00218       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Reading and typing of the convection operator : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00219"></a>00219       <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; vitesse_transportante = <a class="code" href="classNavier__Stokes__std.html#a323445e680b6374474d6f58fa841ec0e">vitesse_pour_transport</a>();
<a name="l00220"></a>00220       <a class="code" href="classNavier__Stokes__std.html#a3a5698f420e093b2bbb77df313b5bb97">terme_convectif</a>.<a class="code" href="classOperateur__Conv.html#ab97c7035846db1561eb447f7d8aa7e39" title="Associe la vitesse (en tant que vitesse transportante) a l&#39;operateur de convection.">associer_vitesse</a>(vitesse_transportante);
<a name="l00221"></a>00221       is &gt;&gt; <a class="code" href="classNavier__Stokes__std.html#a3a5698f420e093b2bbb77df313b5bb97">terme_convectif</a>;
<a name="l00222"></a>00222       <span class="keywordflow">return</span> 1;
<a name="l00223"></a>00223     }
<a name="l00224"></a>00224   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mot==<span class="stringliteral">&quot;solveur_pression&quot;</span>)
<a name="l00225"></a>00225     {
<a name="l00226"></a>00226       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Reading and typing of pressure solver : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00227"></a>00227       is &gt;&gt; <a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>;
<a name="l00228"></a>00228       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Pressure solver type : &quot;</span>&lt;&lt;solveur_pression_.valeur().que_suis_je()&lt;&lt; finl;
<a name="l00229"></a>00229       solveur_pression_.nommer(<span class="stringliteral">&quot;solveur_pression&quot;</span>);
<a name="l00230"></a>00230       <span class="keywordflow">return</span> 1;
<a name="l00231"></a>00231     }
<a name="l00232"></a>00232   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mot==<span class="stringliteral">&quot;dt_projection&quot;</span>)
<a name="l00233"></a>00233     {
<a name="l00234"></a>00234       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Reading projection time step &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00235"></a>00235       is &gt;&gt; <a class="code" href="classNavier__Stokes__std.html#af9c35ba318c93f61c8c4afcec827fe2b">dt_projection</a>;
<a name="l00236"></a>00236       is &gt;&gt; <a class="code" href="classNavier__Stokes__std.html#a2daee5722e9109ff537ae5c818556049">seuil_projection</a>;
<a name="l00237"></a>00237       <span class="keywordflow">return</span> 1;
<a name="l00238"></a>00238     }
<a name="l00239"></a>00239   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mot==<span class="stringliteral">&quot;Traitement_particulier&quot;</span>)
<a name="l00240"></a>00240     {
<a name="l00241"></a>00241       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Reading and typing of Traitement_particulier considered : &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00242"></a>00242       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> type=<span class="stringliteral">&quot;Traitement_particulier_NS_&quot;</span>;
<a name="l00243"></a>00243       <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> motbidon;
<a name="l00244"></a>00244       <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> accouverte = <span class="stringliteral">&quot;{&quot;</span> , accfermee = <span class="stringliteral">&quot;}&quot;</span> ;
<a name="l00245"></a>00245       is &gt;&gt; motbidon;
<a name="l00246"></a>00246       <span class="keywordflow">if</span> (motbidon == accouverte)
<a name="l00247"></a>00247         {
<a name="l00248"></a>00248           <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> le_cas;
<a name="l00249"></a>00249           is &gt;&gt; le_cas;
<a name="l00250"></a>00250           <span class="keywordflow">if</span> (le_cas == accfermee)
<a name="l00251"></a>00251             le_cas =<span class="stringliteral">&quot;&quot;</span>;
<a name="l00252"></a>00252           <span class="keywordflow">else</span>
<a name="l00253"></a>00253             {
<a name="l00254"></a>00254               type+= le_cas;
<a name="l00255"></a>00255               type+= <span class="stringliteral">&quot;_&quot;</span>;
<a name="l00256"></a>00256             }
<a name="l00257"></a>00257           <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> discr=<a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
<a name="l00258"></a>00258           <span class="keywordflow">if</span> (discr == <span class="stringliteral">&quot;VEFPreP1B&quot;</span>)
<a name="l00259"></a>00259             discr = <span class="stringliteral">&quot;VEF&quot;</span>;
<a name="l00260"></a>00260           type+=discr;
<a name="l00261"></a>00261           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; type &lt;&lt; finl;
<a name="l00262"></a>00262           <a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(type);
<a name="l00263"></a>00263           <a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classTraitement__particulier__NS.html#a37aaa54ff6984d8d62546cbad1f26c00">associer_eqn</a>(*<span class="keyword">this</span>);
<a name="l00264"></a>00264           <a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classTraitement__particulier__NS.html#a14707cd2766a4f749f056eb6202a2235">lire</a>(is);
<a name="l00265"></a>00265         }
<a name="l00266"></a>00266       <span class="keywordflow">else</span>
<a name="l00267"></a>00267         {
<a name="l00268"></a>00268           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error while reading Traitement_particulier for Navier_Stokes_standard equation&quot;</span>;
<a name="l00269"></a>00269           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;A { was expected.&quot;</span> &lt;&lt; finl;
<a name="l00270"></a>00270           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00271"></a>00271         }
<a name="l00272"></a>00272       <span class="keywordflow">return</span> 1;
<a name="l00273"></a>00273     }
<a name="l00274"></a>00274   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mot==<span class="stringliteral">&quot;Erreur_max_DivU&quot;</span>)
<a name="l00275"></a>00275     {
<a name="l00276"></a>00276       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Reading DivU maximun&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00277"></a>00277       is &gt;&gt; <a class="code" href="classNavier__Stokes__std.html#a79d95aa22a50a68351909f89bd91801b">max_div_U</a>;
<a name="l00278"></a>00278       is &gt;&gt; <a class="code" href="classNavier__Stokes__std.html#a2daee5722e9109ff537ae5c818556049">seuil_projection</a>;
<a name="l00279"></a>00279       <span class="keywordflow">return</span> 1;
<a name="l00280"></a>00280     }
<a name="l00281"></a>00281   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mot==<span class="stringliteral">&quot;seuil_divU&quot;</span>)
<a name="l00282"></a>00282     {
<a name="l00283"></a>00283       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Reading the threshold value for the velocity divergence &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00284"></a>00284       is &gt;&gt; <a class="code" href="classNavier__Stokes__std.html#af4b0fd768cdbc86d5649b7f058cd7cb8">seuil_divU</a>;
<a name="l00285"></a>00285       is &gt;&gt; <a class="code" href="classNavier__Stokes__std.html#a124966ac3857a95f691710c74b95afdb">raison_seuil_divU</a>;
<a name="l00286"></a>00286       <span class="keywordflow">return</span> 1;
<a name="l00287"></a>00287     }
<a name="l00288"></a>00288   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mot==<span class="stringliteral">&quot;solveur_bar&quot;</span>)
<a name="l00289"></a>00289     {
<a name="l00290"></a>00290       <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> motlu;
<a name="l00291"></a>00291       <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> accouverte = <span class="stringliteral">&quot;{&quot;</span> , accfermee = <span class="stringliteral">&quot;}&quot;</span> ;
<a name="l00292"></a>00292       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> type_solv(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00293"></a>00293       <span class="keywordtype">int</span> acc=0;
<a name="l00294"></a>00294       <span class="keywordtype">int</span> ok=0;
<a name="l00295"></a>00295       <span class="keywordflow">while</span> (acc!=0 || !ok)
<a name="l00296"></a>00296         {
<a name="l00297"></a>00297           is &gt;&gt; motlu;
<a name="l00298"></a>00298           <span class="keywordflow">if</span> (motlu==accouverte)
<a name="l00299"></a>00299             {
<a name="l00300"></a>00300               ok=1;
<a name="l00301"></a>00301               acc++;
<a name="l00302"></a>00302             };
<a name="l00303"></a>00303           <span class="keywordflow">if</span> (motlu==accfermee) acc--;
<a name="l00304"></a>00304           type_solv+=<span class="stringliteral">&quot; &quot;</span>;
<a name="l00305"></a>00305           type_solv+=motlu;
<a name="l00306"></a>00306         }
<a name="l00307"></a>00307       <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00308"></a>00308         {
<a name="l00309"></a>00309           <a class="code" href="classSFichier.html" title="Cette classe est a la classe C++ ofstream ce que la classe Sortie est a la classe C++ ostream Elle re...">SFichier</a> s(<span class="stringliteral">&quot;solveur.bar&quot;</span>);
<a name="l00310"></a>00310           s&lt;&lt;type_solv&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00311"></a>00311           s.<a class="code" href="classSortie__Fichier__base.html#ac246a47c4438e3183322c20db2a3323c">close</a>();
<a name="l00312"></a>00312         }
<a name="l00313"></a>00313       <span class="keywordflow">return</span> 1;
<a name="l00314"></a>00314     }
<a name="l00315"></a>00315   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mot==<span class="stringliteral">&quot;methode_calcul_pression_initiale&quot;</span>)
<a name="l00316"></a>00316     {
<a name="l00317"></a>00317       <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> methode;
<a name="l00318"></a>00318       is &gt;&gt; methode;
<a name="l00319"></a>00319       <a class="code" href="classMotcles.html" title="Un tableau d&#39;objets de la classe Motcle.">Motcles</a> compris(4);
<a name="l00320"></a>00320       compris[0]=<span class="stringliteral">&quot;avec_les_cl&quot;</span>;
<a name="l00321"></a>00321       compris[1]=<span class="stringliteral">&quot;avec_sources&quot;</span>;
<a name="l00322"></a>00322       compris[2]=<span class="stringliteral">&quot;avec_sources_et_operateurs&quot;</span>;
<a name="l00323"></a>00323       compris[3]=<span class="stringliteral">&quot;sans_rien&quot;</span>;
<a name="l00324"></a>00324       <a class="code" href="classNavier__Stokes__std.html#af841545a0b6ccfcbd117ae9af74c175f">methode_calcul_pression_initiale_</a>=compris.<a class="code" href="classMotcles.html#a79f1b0c557e31eece226b045ea412cd6">rang</a>(methode);
<a name="l00325"></a>00325       <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#af841545a0b6ccfcbd117ae9af74c175f">methode_calcul_pression_initiale_</a>&lt;0)
<a name="l00326"></a>00326         {
<a name="l00327"></a>00327           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;methode&lt;&lt;<span class="stringliteral">&quot; is not understood.&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00328"></a>00328           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; Allowed keywords are :&quot;</span>&lt;&lt;compris&lt;&lt;finl;
<a name="l00329"></a>00329           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00330"></a>00330         }
<a name="l00331"></a>00331       <span class="keywordflow">return</span> 1;
<a name="l00332"></a>00332     }
<a name="l00333"></a>00333   <span class="keywordflow">else</span>
<a name="l00334"></a>00334     <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#ab70369d00836f24de31887b8786d9582" title="Lecture des parametres de type non simple d&#39;un objet_U a partir d&#39;un flot d&#39;entree.">Equation_base::lire_motcle_non_standard</a>(mot,is);
<a name="l00335"></a>00335   <span class="keywordflow">return</span> 1;
<a name="l00336"></a>00336 }
<a name="l00337"></a>00337 
<a name="l00338"></a><a class="code" href="classNavier__Stokes__std.html#a58b27703d4eb0328d939b957061532e4">00338</a> <span class="keyword">const</span> <a class="code" href="classChamp__Don.html" title="classe Champ_Don Classe generique de la hierarchie des champs donnes, un objet Champ_Don peut referen...">Champ_Don</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a58b27703d4eb0328d939b957061532e4">Navier_Stokes_std::diffusivite_pour_transport</a>()
<a name="l00339"></a>00339 {
<a name="l00340"></a>00340   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a6b341590bc39e1395c14560f10d67fdb" title="Renvoie le fluide incompressible (milieu physique de l&#39;equation) associe a l&#39;equation. (version const)">fluide</a>().<a class="code" href="classFluide__base.html#a37eb07407d8aa121049355ecc4f8c8dd" title="Renvoie la viscosite cinematique, nu. (vesrion const)">viscosite_cinematique</a>();
<a name="l00341"></a>00341 }
<a name="l00342"></a>00342 
<a name="l00343"></a><a class="code" href="classNavier__Stokes__std.html#abfbc25c93eadc54604cedd904ca9b38f">00343</a> <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; <a class="code" href="classNavier__Stokes__std.html#abfbc25c93eadc54604cedd904ca9b38f">Navier_Stokes_std::diffusivite_pour_pas_de_temps</a>()
<a name="l00344"></a>00344 {
<a name="l00345"></a>00345   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a0a5eb69f0664bd8b0f008e7656ac25d6">terme_diffusif</a>.<a class="code" href="classOperateur__Diff.html#ac978c440bdc56f79f2aa7d5496a35289" title="Renvoie le champ representant la diffusivite.">diffusivite</a>();
<a name="l00346"></a>00346 }
<a name="l00347"></a>00347 
<a name="l00348"></a><a class="code" href="classNavier__Stokes__std.html#a323445e680b6374474d6f58fa841ec0e">00348</a> <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a323445e680b6374474d6f58fa841ec0e">Navier_Stokes_std::vitesse_pour_transport</a>()
<a name="l00349"></a>00349 {
<a name="l00350"></a>00350   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>;
<a name="l00351"></a>00351 }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 <span class="comment">// Precondition:</span>
<a name="l00355"></a>00355 <span class="comment">// Parametre: Probleme_base&amp; pb</span>
<a name="l00356"></a>00356 <span class="comment">// Signification: le probleme auquel s&#39;associer</span>
<a name="l00357"></a>00357 <span class="comment">// Valeurs par defaut:</span>
<a name="l00358"></a>00358 <span class="comment">// Contraintes: reference constante</span>
<a name="l00359"></a>00359 <span class="comment">// Acces: entree</span>
<a name="l00360"></a>00360 <span class="comment">// </span>
<a name="l00361"></a>00361 <span class="comment">// Signification:</span>
<a name="l00362"></a>00362 <span class="comment">// Contraintes:</span>
<a name="l00363"></a>00363 <span class="comment">// Exception:</span>
<a name="l00364"></a>00364 <span class="comment">// Effets de bord:</span>
<a name="l00365"></a>00365 <span class="comment">// Postcondition: l&#39;equation est liee a son probleme, ainsi</span>
<a name="l00366"></a>00366 <span class="comment">// que les operateurs gradient et divergence qui lui sont</span>
<a name="l00367"></a>00367 <span class="comment">// associes.</span>
<a name="l00368"></a>00368 <span class="comment">//</span>
<a name="l00369"></a>00369 <span class="comment">//</span>
<a name="l00370"></a>00370 <span class="comment">//</span><span class="comment"></span>
<a name="l00371"></a>00371 <span class="comment">//! S&#39;associe au probleme:&lt;br&gt;apelle Equation_base::associer_pb_base(const Probleme_base\&amp;)&lt;br&gt;s&#39;associe avec les operateurs de divergence et de gradient.</span>
<a name="l00372"></a><a class="code" href="classNavier__Stokes__std.html#a201312019d077f26c36636cc1e561a10">00372</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#a201312019d077f26c36636cc1e561a10" title="S&#39;associe au probleme: apelle Equation_base::associer_pb_base(const Probleme_base&amp;) s&#39;associe avec le...">Navier_Stokes_std::associer_pb_base</a>(<span class="keyword">const</span> <a class="code" href="classProbleme__base.html" title="classe Probleme_base C&#39;est un Probleme_U qui n&#39;est pas un couplage. Le role d&#39;un Probleme_base est la...">Probleme_base</a>&amp; pb)
<a name="l00373"></a>00373 {
<a name="l00374"></a>00374   <a class="code" href="classNavier__Stokes__std.html#a201312019d077f26c36636cc1e561a10" title="S&#39;associe au probleme: apelle Equation_base::associer_pb_base(const Probleme_base&amp;) s&#39;associe avec le...">Equation_base::associer_pb_base</a>(pb);
<a name="l00375"></a>00375   <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classMorEqn.html#a1a6c57edd46cc696aa45c6b01a76e14c" title="Associe une equation a l&#39;objet. Affecte le membre MorEqn::mon_equation avec l&#39;objet passe en parametr...">associer_eqn</a>(*<span class="keyword">this</span>);
<a name="l00376"></a>00376   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classMorEqn.html#a1a6c57edd46cc696aa45c6b01a76e14c" title="Associe une equation a l&#39;objet. Affecte le membre MorEqn::mon_equation avec l&#39;objet passe en parametr...">associer_eqn</a>(*<span class="keyword">this</span>);
<a name="l00377"></a>00377 }
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 <span class="comment">// Precondition:</span>
<a name="l00380"></a>00380 <span class="comment">// Parametre:</span>
<a name="l00381"></a>00381 <span class="comment">// Signification:</span>
<a name="l00382"></a>00382 <span class="comment">// Valeurs par defaut:</span>
<a name="l00383"></a>00383 <span class="comment">// Contraintes:</span>
<a name="l00384"></a>00384 <span class="comment">// Acces:</span>
<a name="l00385"></a>00385 <span class="comment">// </span>
<a name="l00386"></a>00386 <span class="comment">// Signification:</span>
<a name="l00387"></a>00387 <span class="comment">// Contraintes:</span>
<a name="l00388"></a>00388 <span class="comment">// Exception:</span>
<a name="l00389"></a>00389 <span class="comment">// Effets de bord:</span>
<a name="l00390"></a>00390 <span class="comment">// Postcondition:</span>
<a name="l00391"></a>00391 <span class="comment">//</span>
<a name="l00392"></a>00392 <span class="comment">//</span>
<a name="l00393"></a>00393 <span class="comment">//</span>
<a name="l00394"></a>00394 <span class="comment">//</span>
<a name="l00395"></a>00395 <span class="comment">//</span>
<a name="l00396"></a>00396 <span class="comment">//</span>
<a name="l00397"></a>00397 <span class="comment">//</span>
<a name="l00398"></a>00398 <span class="comment">//</span><span class="comment"></span>
<a name="l00399"></a>00399 <span class="comment">//! Complete l&#39;equation base,&lt;br&gt;associe la pression a l&#39;equation,&lt;br&gt;complete la divergence, le gradient et le solveur pression.&lt;br&gt;Ajout de 2 termes sources: l&#39;un representant la force centrifuge&lt;br&gt;dans le cas axi-symetrique,l&#39;autre intervenant dans la resolution&lt;br&gt;en 2D axisymetrique&lt;br&gt;Association d une equation de transport d interface a l ensemble&lt;br&gt;de points suivis si le fluide est marque</span>
<a name="l00400"></a><a class="code" href="classNavier__Stokes__std.html#a7c62f384d8ebf3a7654ac0579855bf44">00400</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#a7c62f384d8ebf3a7654ac0579855bf44" title="Complete l&#39;equation base, associe la pression a l&#39;equation, complete la divergence, le gradient et le solveur pression. Ajout de 2 termes sources: l&#39;un representant la force centrifuge dans le cas axi-symetrique,l&#39;autre intervenant dans la resolution en 2D axisymetrique Association d une equation de transport d interface a l ensemble de points suivis si le fluide est marque.">Navier_Stokes_std::completer</a>()
<a name="l00401"></a>00401 {
<a name="l00402"></a>00402   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#ad9b82ace9d4c7902ec704b6a78f76991">axi</a> == 1)
<a name="l00403"></a>00403     {
<a name="l00404"></a>00404       <a class="code" href="classSource.html" title="classe Source Classe generique de la hierarchie des sources, un objet Source peut referencer n&#39;import...">Source</a> t;
<a name="l00405"></a>00405       <a class="code" href="classSource.html" title="classe Source Classe generique de la hierarchie des sources, un objet Source peut referencer n&#39;import...">Source</a>&amp; so=<a class="code" href="classEquation__base.html#a6dae2cb8a228b0e3a6d90042fd75f360">les_sources</a>.<a class="code" href="classList__Source.html#a8570b867f430a1520cb721e062afbbee">add</a>(t);
<a name="l00406"></a>00406       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Centrifuge force term creation for Axi case.&quot;</span>&lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00407"></a>00407       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> type_so = <span class="stringliteral">&quot;Force_Centrifuge_&quot;</span>;
<a name="l00408"></a>00408       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> disc = <a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
<a name="l00409"></a>00409       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> champ = <a class="code" href="classNavier__Stokes__std.html#a743b777e6185faee7837326844c8fca1" title="Renvoie la vitesse (champ inconnue de l&#39;equation) (version const)">inconnue</a>()-&gt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
<a name="l00410"></a>00410       champ.<a class="code" href="classNom.html#acdb0a56b1654b0c37050be0ca9435706" title="extraction de suffix : Nom x(&quot;azerty&quot;); x.suffix(&quot;aze&quot;) x contient &quot;rty&quot;.">suffix</a>(<span class="stringliteral">&quot;Champ_&quot;</span>);
<a name="l00411"></a>00411       type_so+=disc;
<a name="l00412"></a>00412       type_so+=<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00413"></a>00413       type_so+=champ;
<a name="l00414"></a>00414       type_so += <span class="stringliteral">&quot;_Axi&quot;</span>;
<a name="l00415"></a>00415       so.<a class="code" href="classSource.html#a89a68814e70580379a0e85bfa18a25f7">typer_direct</a>(type_so);
<a name="l00416"></a>00416       so-&gt;associer_eqn(*<span class="keyword">this</span>);
<a name="l00417"></a>00417     }
<a name="l00418"></a>00418 
<a name="l00419"></a>00419   <a class="code" href="classNavier__Stokes__std.html#a7c62f384d8ebf3a7654ac0579855bf44" title="Complete l&#39;equation base, associe la pression a l&#39;equation, complete la divergence, le gradient et le solveur pression. Ajout de 2 termes sources: l&#39;un representant la force centrifuge dans le cas axi-symetrique,l&#39;autre intervenant dans la resolution en 2D axisymetrique Association d une equation de transport d interface a l ensemble de points suivis si le fluide est marque.">Equation_base::completer</a>();
<a name="l00420"></a>00420 
<a name="l00421"></a>00421 <span class="comment">// On ne decline pas le residu par composantes pour la vitesse:</span>
<a name="l00422"></a>00422   <a class="code" href="classEquation__base.html#a888dc3f8eb5fb54b05250b6b704a6997">initialise_residu</a>(1);
<a name="l00423"></a>00423 
<a name="l00424"></a>00424   <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#aa6febd6d77fcb0d182b368f6f2c26b2e" title="Appel a l&#39;objet sous-jacent Associe le champ a l&#39;equation dont il est une inconnue.">associer_eqn</a>(*<span class="keyword">this</span>);
<a name="l00425"></a>00425   <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>-&gt;completer(<a class="code" href="classEquation__base.html#aa097c6ddc00bdb913c39739689f6d5c4">la_zone_Cl_dis</a>.<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00426"></a>00426 <span class="comment">// [ABN] make sure the pressure knows the zone_Cl_dis to be able to use specific postreatment like &#39;gravcl&#39;</span>
<a name="l00427"></a>00427   <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>-&gt;associer_zone_cl_dis(<a class="code" href="classEquation__base.html#aa097c6ddc00bdb913c39739689f6d5c4">la_zone_Cl_dis</a>);
<a name="l00428"></a>00428 
<a name="l00429"></a>00429   <a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#aa6febd6d77fcb0d182b368f6f2c26b2e" title="Appel a l&#39;objet sous-jacent Associe le champ a l&#39;equation dont il est une inconnue.">associer_eqn</a>(*<span class="keyword">this</span>);
<a name="l00430"></a>00430   <a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#aa6febd6d77fcb0d182b368f6f2c26b2e" title="Appel a l&#39;objet sous-jacent Associe le champ a l&#39;equation dont il est une inconnue.">associer_eqn</a>(*<span class="keyword">this</span>);
<a name="l00431"></a>00431   <a class="code" href="classNavier__Stokes__std.html#a5b5b3a99c0ffa104a77774fd5f30944d">la_pression_en_pa</a>.<a class="code" href="classChamp__Inc.html#aa6febd6d77fcb0d182b368f6f2c26b2e" title="Appel a l&#39;objet sous-jacent Associe le champ a l&#39;equation dont il est une inconnue.">associer_eqn</a>(*<span class="keyword">this</span>);
<a name="l00432"></a>00432   <a class="code" href="classNavier__Stokes__std.html#a5b5b3a99c0ffa104a77774fd5f30944d">la_pression_en_pa</a>-&gt;completer(<a class="code" href="classEquation__base.html#aa097c6ddc00bdb913c39739689f6d5c4">la_zone_Cl_dis</a>.<a class="code" href="classDeriv__Zone__Cl__dis__base.html#a6b56880f00b604e1f13970ec6d5bc077">valeur</a>());
<a name="l00433"></a>00433   <a class="code" href="classNavier__Stokes__std.html#a5b5b3a99c0ffa104a77774fd5f30944d">la_pression_en_pa</a>-&gt;associer_zone_cl_dis(<a class="code" href="classEquation__base.html#aa097c6ddc00bdb913c39739689f6d5c4">la_zone_Cl_dis</a>);
<a name="l00434"></a>00434   <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur.html#ac40f77a68a1959a5d37b5b2e45b40571" title="Met a jour les references des objets associes a l&#39;operateur. Operateur::le_champ_inco, Operateur::champ_inco Appelle Operateur_base::completer()">completer</a>();
<a name="l00435"></a>00435   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur.html#ac40f77a68a1959a5d37b5b2e45b40571" title="Met a jour les references des objets associes a l&#39;operateur. Operateur::le_champ_inco, Operateur::champ_inco Appelle Operateur_base::completer()">completer</a>();
<a name="l00436"></a>00436   <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classAssembleur.html#ab27293d87850e739f5fa52a0d03456bb" title="Appel a l&#39;objet sous-jacent. Permet d&#39;associer l&#39;objet a la Zone_Cl_dis.">associer_zone_cl_dis_base</a>(<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00437"></a>00437   <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classAssembleur.html#abc6eb6bb28193f36b9c6c1825a306e35" title="Appel a l&#39;objet sous-jacent. Permet de completer le systeme.">completer</a>(*<span class="keyword">this</span>);
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 
<a name="l00440"></a><a class="code" href="classNavier__Stokes__std.html#a8bf77f5350a24d4342ab7f8f34a30cf2">00440</a> <span class="keywordtype">int</span> <a class="code" href="classNavier__Stokes__std.html#a8bf77f5350a24d4342ab7f8f34a30cf2" title="Verifie la compatibilite des conditions limites avec l&#39;equation. voir Conds_lim::compatible_avec_eqn(...">Navier_Stokes_std::verif_Cl</a>()<span class="keyword"> const</span>
<a name="l00441"></a>00441 <span class="keyword"></span>{
<a name="l00442"></a>00442   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a8bf77f5350a24d4342ab7f8f34a30cf2" title="Verifie la compatibilite des conditions limites avec l&#39;equation. voir Conds_lim::compatible_avec_eqn(...">Equation_base::verif_Cl</a>();
<a name="l00443"></a>00443 }
<a name="l00444"></a>00444 
<a name="l00445"></a>00445 <span class="comment">// Precondition:</span>
<a name="l00446"></a>00446 <span class="comment">// Parametre:</span>
<a name="l00447"></a>00447 <span class="comment">// Signification:</span>
<a name="l00448"></a>00448 <span class="comment">// Valeurs par defaut:</span>
<a name="l00449"></a>00449 <span class="comment">// Contraintes:</span>
<a name="l00450"></a>00450 <span class="comment">// Acces:</span>
<a name="l00451"></a>00451 <span class="comment">// </span>
<a name="l00452"></a>00452 <span class="comment">// Signification:</span>
<a name="l00453"></a>00453 <span class="comment">// Contraintes:</span>
<a name="l00454"></a>00454 <span class="comment">// Exception:</span>
<a name="l00455"></a>00455 <span class="comment">// Effets de bord:</span>
<a name="l00456"></a>00456 <span class="comment">// Postcondition: l&#39;equation est discretisee</span>
<a name="l00457"></a>00457 <span class="comment">//</span><span class="comment"></span>
<a name="l00458"></a>00458 <span class="comment">//! Dicretise l&#39;equation.</span>
<a name="l00459"></a><a class="code" href="classNavier__Stokes__std.html#ada1952b4225d12a7038b7a968a26e047">00459</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#ada1952b4225d12a7038b7a968a26e047" title="Dicretise l&#39;equation.">Navier_Stokes_std::discretiser</a>()
<a name="l00460"></a>00460 {
<a name="l00461"></a>00461   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Hydraulic equation discretization (Navier_Stokes_std::discretiser)&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00462"></a>00462   <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>, <a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
<a name="l00463"></a>00463 
<a name="l00464"></a>00464   <a class="code" href="classNavier__Stokes__std.html#ab8c28dae40a64bb151636caea955acb8">discretiser_vitesse</a>();
<a name="l00465"></a>00465   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>);
<a name="l00466"></a>00466   <a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>().<a class="code" href="classField__base.html#ae2b6a412b1720b5c49422ec13b8e6bf5">add_synonymous</a>(<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(<span class="stringliteral">&quot;velocity&quot;</span>));
<a name="l00467"></a>00467 
<a name="l00468"></a>00468   dis.<a class="code" href="classDiscret__Thyd.html#a95daa63f720fc2a3fb469e4d6251bf80">pression</a>(<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>(), <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(), <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>);
<a name="l00469"></a>00469   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>);
<a name="l00470"></a>00470   <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>().<a class="code" href="classField__base.html#ae2b6a412b1720b5c49422ec13b8e6bf5">add_synonymous</a>(<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(<span class="stringliteral">&quot;P_star&quot;</span>));
<a name="l00471"></a>00471 
<a name="l00472"></a>00472   dis.<a class="code" href="classDiscret__Thyd.html#a1dd972406eb5cb941623c1de46ff8910">pression_en_pa</a>(<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>(), <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(), <a class="code" href="classNavier__Stokes__std.html#a5b5b3a99c0ffa104a77774fd5f30944d">la_pression_en_pa</a>);
<a name="l00473"></a>00473   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#a5b5b3a99c0ffa104a77774fd5f30944d">la_pression_en_pa</a>);
<a name="l00474"></a>00474 
<a name="l00475"></a>00475   <a class="code" href="classNavier__Stokes__std.html#a5b5b3a99c0ffa104a77774fd5f30944d">la_pression_en_pa</a>.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>().<a class="code" href="classField__base.html#ae2b6a412b1720b5c49422ec13b8e6bf5">add_synonymous</a>(<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(<span class="stringliteral">&quot;Pressure&quot;</span>));
<a name="l00476"></a>00476 
<a name="l00477"></a>00477   dis.<a class="code" href="classDiscret__Thyd.html#a907e330c77262387fc7a38dd8608bf2a">divergence_U</a>(<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>(), <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(), <a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>);
<a name="l00478"></a>00478   dis.<a class="code" href="classDiscret__Thyd.html#a31008474f06a1081d495a10d34a1ae97">gradient_P</a>(<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>(), <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(), <a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>);
<a name="l00479"></a>00479   <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur__Div.html#ab1f3f08dfaf75b6aba6fc1b766a95df9" title="Type l&#39;operateur: se type &quot;Op_div_&quot;+discretisation()+ &quot;_&quot;+inconnue().suffix.">typer</a>();
<a name="l00480"></a>00480   <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur__Div.html#a2f39b0febdf8343ad85cdeeeaa26b15f" title="Renvoie l&#39;objet sous-jacent upcaste en Operateur_base.">l_op_base</a>().<a class="code" href="classOperateur__base.html#addce89950be87e830970589f6aba37d3" title="Associe une equation a l&#39;operateur. Simple Appel a MorEqn::associer_eqn(const Equation_base&amp;)">associer_eqn</a>(*<span class="keyword">this</span>);
<a name="l00481"></a>00481   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur__Grad.html#a719f54e2cf3c4aed630ef86f220476b4" title="Type l&#39;operateur: se type &quot;Op_Grad_&quot;+discretisation()+ &quot;_&quot;+inconnue().suffix.">typer</a>();
<a name="l00482"></a>00482   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur__Grad.html#a4c27adaad3d68c9f29ece74d912c9916" title="Renvoie l&#39;objet sous-jacent upcaste en Operateur_base.">l_op_base</a>().<a class="code" href="classOperateur__base.html#addce89950be87e830970589f6aba37d3" title="Associe une equation a l&#39;operateur. Simple Appel a MorEqn::associer_eqn(const Equation_base&amp;)">associer_eqn</a>(*<span class="keyword">this</span>);
<a name="l00483"></a>00483 
<a name="l00484"></a>00484 
<a name="l00485"></a>00485 
<a name="l00486"></a>00486   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>);
<a name="l00487"></a>00487   <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>);
<a name="l00488"></a>00488 
<a name="l00489"></a>00489 
<a name="l00490"></a>00490 <span class="comment">// Appel a la methode virtuelle de discretisation de l&#39;assembleur pression:</span>
<a name="l00491"></a>00491   <a class="code" href="classNavier__Stokes__std.html#a9aa1faa2cdbd71a11b40d1b249af46e0" title="Typage de l&#39;assembleur pression. Le nom de l&#39;assembleur utilise est construit comme : Assembleur_P_xx...">discretiser_assembleur_pression</a>();
<a name="l00492"></a>00492 
<a name="l00493"></a>00493   <a class="code" href="classNavier__Stokes__std.html#ada1952b4225d12a7038b7a968a26e047" title="Dicretise l&#39;equation.">Equation_base::discretiser</a>();
<a name="l00494"></a>00494 }
<a name="l00495"></a>00495 
<a name="l00496"></a><a class="code" href="classNavier__Stokes__std.html#ab8c28dae40a64bb151636caea955acb8">00496</a> <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#ab8c28dae40a64bb151636caea955acb8">Navier_Stokes_std::discretiser_vitesse</a>()
<a name="l00497"></a>00497 {
<a name="l00498"></a>00498   <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>, <a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
<a name="l00499"></a>00499   dis.<a class="code" href="classDiscret__Thyd.html#a13ce88c3d8f9009af4f9ab85d69e50b0">vitesse</a>(<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>(), <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(), <a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>);
<a name="l00500"></a>00500 }
<a name="l00501"></a>00501 
<a name="l00502"></a>00502 <span class="comment">//</span>
<a name="l00503"></a>00503 <span class="comment">//</span>
<a name="l00504"></a>00504 <span class="comment">//</span>
<a name="l00505"></a>00505 <span class="comment">//</span>
<a name="l00506"></a>00506 <span class="comment">//</span><span class="comment"></span>
<a name="l00507"></a>00507 <span class="comment">//! Typage de l&#39;assembleur pression. Le nom de l&#39;assembleur&lt;br&gt;utilise est construit comme :&lt;br&gt;Assembleur_P_xxx&quot; ou &quot;xxx&quot; est le nom de la discretisation.&lt;br&gt;Cette methode est virtuelle et surchargee dans le front-tracking.&lt;br&gt;Elle est appelee par Navier_Stokes_std::discretiser()</span>
<a name="l00508"></a><a class="code" href="classNavier__Stokes__std.html#a9aa1faa2cdbd71a11b40d1b249af46e0">00508</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#a9aa1faa2cdbd71a11b40d1b249af46e0" title="Typage de l&#39;assembleur pression. Le nom de l&#39;assembleur utilise est construit comme : Assembleur_P_xx...">Navier_Stokes_std::discretiser_assembleur_pression</a>()
<a name="l00509"></a>00509 {
<a name="l00510"></a>00510   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> type = <span class="stringliteral">&quot;Assembleur_P_&quot;</span>;
<a name="l00511"></a>00511   type += <a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
<a name="l00512"></a>00512   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Navier_Stokes_std::discretiser_assembleur_pression : type=&quot;</span>&lt;&lt; type &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00513"></a>00513   <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(type);
<a name="l00514"></a>00514   <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classAssembleur.html#ae76ebb7a2a14165904c81d5ca4f3a4b4" title="Appel a l&#39;objet sous-jacent. Permet d&#39;associer l&#39;objet a la zone discretisee.">associer_zone_dis_base</a>(<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l00515"></a>00515 }
<a name="l00516"></a>00516 
<a name="l00517"></a>00517 <span class="comment">// Precondition:</span>
<a name="l00518"></a>00518 <span class="comment">// Parametre:</span>
<a name="l00519"></a>00519 <span class="comment">// Signification:</span>
<a name="l00520"></a>00520 <span class="comment">// Valeurs par defaut:</span>
<a name="l00521"></a>00521 <span class="comment">// Contraintes:</span>
<a name="l00522"></a>00522 <span class="comment">// Acces:</span>
<a name="l00523"></a>00523 <span class="comment">// Exception:</span>
<a name="l00524"></a>00524 <span class="comment">// Effets de bord:</span>
<a name="l00525"></a>00525 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00526"></a>00526 <span class="comment">//</span>
<a name="l00527"></a>00527 <span class="comment">//</span><span class="comment"></span>
<a name="l00528"></a>00528 <span class="comment">//! Renvoie le nombre d&#39;operateurs de l&#39;equation:&lt;br&gt;Pour Navier Stokes Standard c&#39;est 2.</span>
<a name="l00529"></a>00529 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00530"></a>00530 <span class="comment">Signification: le nombre d&#39;operateur de l&#39;equation&lt;br&gt;</span>
<a name="l00531"></a>00531 <span class="comment">Contraintes: toujours egal a 2 */</span>
<a name="l00532"></a><a class="code" href="classNavier__Stokes__std.html#ac7db452db8cfdb5f15bf971a47df82f1">00532</a> <span class="keywordtype">int</span> <a class="code" href="classNavier__Stokes__std.html#ac7db452db8cfdb5f15bf971a47df82f1" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: Pour Navier Stokes Standard c&#39;est 2.">Navier_Stokes_std::nombre_d_operateurs</a>()<span class="keyword"> const</span>
<a name="l00533"></a>00533 <span class="keyword"></span>{
<a name="l00534"></a>00534   <span class="keywordflow">return</span> 2;
<a name="l00535"></a>00535 }
<a name="l00536"></a>00536 
<a name="l00537"></a><a class="code" href="classNavier__Stokes__std.html#a7e751bd24af36758063e162aea42d9d3">00537</a> <span class="keywordtype">int</span> <a class="code" href="classNavier__Stokes__std.html#a7e751bd24af36758063e162aea42d9d3">Navier_Stokes_std::nombre_d_operateurs_tot</a>()<span class="keyword"> const</span>
<a name="l00538"></a>00538 <span class="keyword"></span>{
<a name="l00539"></a>00539   <span class="keywordflow">return</span> 4;
<a name="l00540"></a>00540 }
<a name="l00541"></a>00541 
<a name="l00542"></a>00542 <span class="comment">// Precondition:</span>
<a name="l00543"></a>00543 <span class="comment">// Parametre: int i</span>
<a name="l00544"></a>00544 <span class="comment">// Signification: l&#39;index de l&#39;operateur a renvoyer</span>
<a name="l00545"></a>00545 <span class="comment">// Valeurs par defaut:</span>
<a name="l00546"></a>00546 <span class="comment">// Contraintes: 0 &lt;= i &lt;= 1</span>
<a name="l00547"></a>00547 <span class="comment">// Acces: entree</span>
<a name="l00548"></a>00548 <span class="comment">// Exception:</span>
<a name="l00549"></a>00549 <span class="comment">// Effets de bord:</span>
<a name="l00550"></a>00550 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00551"></a>00551 <span class="comment">//</span>
<a name="l00552"></a>00552 <span class="comment">//</span>
<a name="l00553"></a>00553 <span class="comment">//</span>
<a name="l00554"></a>00554 <span class="comment">//</span>
<a name="l00555"></a>00555 <span class="comment">//</span><span class="comment"></span>
<a name="l00556"></a>00556 <span class="comment">//! Renvoie le i-eme operateur de l&#39;equation:&lt;br&gt;- le terme_diffusif si i = 0&lt;br&gt;- le terme_convectif si i = 1&lt;br&gt;exit si i&gt;1&lt;br&gt;(version const)</span>
<a name="l00557"></a>00557 <span class="comment"></span><span class="comment">/** \return Operateur\&amp;&lt;br&gt;</span>
<a name="l00558"></a>00558 <span class="comment">Signification: l&#39;operateur indexe par i&lt;br&gt;</span>
<a name="l00559"></a>00559 <span class="comment">Contraintes: reference constante */</span>
<a name="l00560"></a><a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df">00560</a> <span class="keyword">const</span> <a class="code" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df" title="Renvoie le i-eme operateur de l&#39;equation: - le terme_diffusif si i = 0 - le terme_convectif si i = 1 ...">Navier_Stokes_std::operateur</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l00561"></a>00561 <span class="keyword"></span>{
<a name="l00562"></a>00562   <span class="keywordflow">switch</span>(i)
<a name="l00563"></a>00563     {
<a name="l00564"></a>00564     <span class="keywordflow">case</span> 0:
<a name="l00565"></a>00565       <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a0a5eb69f0664bd8b0f008e7656ac25d6">terme_diffusif</a>;
<a name="l00566"></a>00566     <span class="keywordflow">case</span> 1:
<a name="l00567"></a>00567       <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a3a5698f420e093b2bbb77df313b5bb97">terme_convectif</a>;
<a name="l00568"></a>00568     <span class="keywordflow">default</span> :
<a name="l00569"></a>00569       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error for Navier_Stokes_std::operateur(int i)&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00570"></a>00570       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Navier_Stokes_std has &quot;</span> &lt;&lt; <a class="code" href="classNavier__Stokes__std.html#ac7db452db8cfdb5f15bf971a47df82f1" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: Pour Navier Stokes Standard c&#39;est 2.">nombre_d_operateurs</a>() &lt;&lt;<span class="stringliteral">&quot; operators &quot;</span>&lt;&lt;finl;
<a name="l00571"></a>00571       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;and you are trying to access the &quot;</span> &lt;&lt; i &lt;&lt;<span class="stringliteral">&quot; th one.&quot;</span>&lt;&lt; finl;
<a name="l00572"></a>00572       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00573"></a>00573     }
<a name="l00574"></a>00574 <span class="comment">// Pour les compilos!!</span>
<a name="l00575"></a>00575   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a0a5eb69f0664bd8b0f008e7656ac25d6">terme_diffusif</a>;
<a name="l00576"></a>00576 }
<a name="l00577"></a>00577 
<a name="l00578"></a>00578 <span class="comment">// Precondition:</span>
<a name="l00579"></a>00579 <span class="comment">// Parametre: int i</span>
<a name="l00580"></a>00580 <span class="comment">// Signification: l&#39;index de l&#39;operateur a renvoyer</span>
<a name="l00581"></a>00581 <span class="comment">// Valeurs par defaut:</span>
<a name="l00582"></a>00582 <span class="comment">// Contraintes: 0 &lt;= i &lt;= 1</span>
<a name="l00583"></a>00583 <span class="comment">// Acces: entree</span>
<a name="l00584"></a>00584 <span class="comment">// Exception:</span>
<a name="l00585"></a>00585 <span class="comment">// Effets de bord:</span>
<a name="l00586"></a>00586 <span class="comment">// Postcondition:</span>
<a name="l00587"></a>00587 <span class="comment">//</span>
<a name="l00588"></a>00588 <span class="comment">//</span>
<a name="l00589"></a>00589 <span class="comment">//</span>
<a name="l00590"></a>00590 <span class="comment">//</span><span class="comment"></span>
<a name="l00591"></a>00591 <span class="comment">//! Renvoie le i-eme operateur de l&#39;equation:&lt;br&gt;- le terme_diffusif si i = 0&lt;br&gt;- le terme_convectif si i = 1&lt;br&gt;exit si i&gt;1</span>
<a name="l00592"></a>00592 <span class="comment"></span><span class="comment">/** \return Operateur\&amp;&lt;br&gt;</span>
<a name="l00593"></a>00593 <span class="comment">Signification: l&#39;operateur indexe par i&lt;br&gt;</span>
<a name="l00594"></a>00594 <span class="comment">Contraintes: */</span>
<a name="l00595"></a><a class="code" href="classNavier__Stokes__std.html#a93fffca62894d14a04e60b1b013295b0">00595</a> <a class="code" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df" title="Renvoie le i-eme operateur de l&#39;equation: - le terme_diffusif si i = 0 - le terme_convectif si i = 1 ...">Navier_Stokes_std::operateur</a>(<span class="keywordtype">int</span> i)
<a name="l00596"></a>00596 {
<a name="l00597"></a>00597   <span class="keywordflow">switch</span>(i)
<a name="l00598"></a>00598     {
<a name="l00599"></a>00599     <span class="keywordflow">case</span> 0:
<a name="l00600"></a>00600       <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a0a5eb69f0664bd8b0f008e7656ac25d6">terme_diffusif</a>;
<a name="l00601"></a>00601     <span class="keywordflow">case</span> 1:
<a name="l00602"></a>00602       <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a3a5698f420e093b2bbb77df313b5bb97">terme_convectif</a>;
<a name="l00603"></a>00603     <span class="keywordflow">default</span> :
<a name="l00604"></a>00604       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error for Navier_Stokes_std::operateur(int i)&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00605"></a>00605       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Navier_Stokes_std has &quot;</span> &lt;&lt; <a class="code" href="classNavier__Stokes__std.html#ac7db452db8cfdb5f15bf971a47df82f1" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: Pour Navier Stokes Standard c&#39;est 2.">nombre_d_operateurs</a>() &lt;&lt;<span class="stringliteral">&quot; operators &quot;</span>&lt;&lt;finl;
<a name="l00606"></a>00606       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;and you are trying to access the &quot;</span> &lt;&lt; i &lt;&lt;<span class="stringliteral">&quot; th one.&quot;</span>&lt;&lt; finl;
<a name="l00607"></a>00607       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00608"></a>00608     }
<a name="l00609"></a>00609 <span class="comment">// Pour les compilos!!</span>
<a name="l00610"></a>00610   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a0a5eb69f0664bd8b0f008e7656ac25d6">terme_diffusif</a>;
<a name="l00611"></a>00611 }
<a name="l00612"></a>00612 
<a name="l00613"></a><a class="code" href="classNavier__Stokes__std.html#adf5896dee3b5634685951ca31f6432a2">00613</a> <span class="keyword">const</span> <a class="code" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a>&amp; <a class="code" href="classNavier__Stokes__std.html#adf5896dee3b5634685951ca31f6432a2">Navier_Stokes_std::operateur_fonctionnel</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l00614"></a>00614 <span class="keyword"></span>{
<a name="l00615"></a>00615   <span class="keywordflow">switch</span>(i)
<a name="l00616"></a>00616     {
<a name="l00617"></a>00617     <span class="keywordflow">case</span> 0:
<a name="l00618"></a>00618       <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>;
<a name="l00619"></a>00619     <span class="keywordflow">case</span> 1:
<a name="l00620"></a>00620       <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>;
<a name="l00621"></a>00621     <span class="keywordflow">default</span> :
<a name="l00622"></a>00622       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error for Navier_Stokes_std::operateur_fonctionnel(int i)&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00623"></a>00623       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Navier_Stokes_std has &quot;</span> &lt;&lt; <a class="code" href="classNavier__Stokes__std.html#ac7db452db8cfdb5f15bf971a47df82f1" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: Pour Navier Stokes Standard c&#39;est 2.">nombre_d_operateurs</a>() &lt;&lt;<span class="stringliteral">&quot; functional operators &quot;</span>&lt;&lt;finl;
<a name="l00624"></a>00624       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;and you are trying to access the &quot;</span> &lt;&lt; i &lt;&lt;<span class="stringliteral">&quot; th one.&quot;</span>&lt;&lt; finl;
<a name="l00625"></a>00625       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00626"></a>00626     }
<a name="l00627"></a>00627 <span class="comment">// Pour les compilos!!</span>
<a name="l00628"></a>00628   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#adf5896dee3b5634685951ca31f6432a2">Navier_Stokes_std::operateur_fonctionnel</a>(i);
<a name="l00629"></a>00629 }
<a name="l00630"></a>00630 
<a name="l00631"></a><a class="code" href="classNavier__Stokes__std.html#a4f1450a4bbc7dc309aa9138422557e19">00631</a> <a class="code" href="classOperateur.html" title="classe Operateur Classe generique de la hierarchie des operateurs. Cette classe generique est particu...">Operateur</a>&amp; <a class="code" href="classNavier__Stokes__std.html#adf5896dee3b5634685951ca31f6432a2">Navier_Stokes_std::operateur_fonctionnel</a>(<span class="keywordtype">int</span> i)
<a name="l00632"></a>00632 {
<a name="l00633"></a>00633   <span class="keywordflow">switch</span>(i)
<a name="l00634"></a>00634     {
<a name="l00635"></a>00635     <span class="keywordflow">case</span> 0:
<a name="l00636"></a>00636       <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>;
<a name="l00637"></a>00637     <span class="keywordflow">case</span> 1:
<a name="l00638"></a>00638       <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>;
<a name="l00639"></a>00639     <span class="keywordflow">default</span> :
<a name="l00640"></a>00640       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error for Navier_Stokes_std::operateur_fonctionnel(int i)&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00641"></a>00641       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Navier_Stokes_std has &quot;</span> &lt;&lt; <a class="code" href="classNavier__Stokes__std.html#ac7db452db8cfdb5f15bf971a47df82f1" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: Pour Navier Stokes Standard c&#39;est 2.">nombre_d_operateurs</a>() &lt;&lt;<span class="stringliteral">&quot; functional operators &quot;</span>&lt;&lt;finl;
<a name="l00642"></a>00642       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;and you are trying to access the &quot;</span> &lt;&lt; i &lt;&lt;<span class="stringliteral">&quot; th one.&quot;</span>&lt;&lt; finl;
<a name="l00643"></a>00643       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00644"></a>00644     }
<a name="l00645"></a>00645 <span class="comment">// Pour les compilos!!</span>
<a name="l00646"></a>00646   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#adf5896dee3b5634685951ca31f6432a2">Navier_Stokes_std::operateur_fonctionnel</a>(i);
<a name="l00647"></a>00647 }
<a name="l00648"></a>00648 
<a name="l00649"></a>00649 
<a name="l00650"></a>00650 <span class="comment">// Precondition:</span>
<a name="l00651"></a>00651 <span class="comment">// Parametre:</span>
<a name="l00652"></a>00652 <span class="comment">// Signification:</span>
<a name="l00653"></a>00653 <span class="comment">// Valeurs par defaut:</span>
<a name="l00654"></a>00654 <span class="comment">// Contraintes:</span>
<a name="l00655"></a>00655 <span class="comment">// Acces:</span>
<a name="l00656"></a>00656 <span class="comment">// Exception:</span>
<a name="l00657"></a>00657 <span class="comment">// Effets de bord:</span>
<a name="l00658"></a>00658 <span class="comment">// Postcondition:</span>
<a name="l00659"></a>00659 <span class="comment">//</span>
<a name="l00660"></a>00660 <span class="comment">//</span><span class="comment"></span>
<a name="l00661"></a>00661 <span class="comment">//! Renvoie l&#39;operateur de calcul de la divergence&lt;br&gt;associe a l&#39;equation.</span>
<a name="l00662"></a>00662 <span class="comment"></span><span class="comment">/** \return Operateur_Div\&amp;&lt;br&gt;</span>
<a name="l00663"></a>00663 <span class="comment">Signification: l&#39;operateur de calcul de la divergence.&lt;br&gt;</span>
<a name="l00664"></a>00664 <span class="comment">Contraintes: */</span>
<a name="l00665"></a><a class="code" href="classNavier__Stokes__std.html#a614d41350181667ee295b87a72779c1a">00665</a> <a class="code" href="classOperateur__Div.html" title="classe Operateur_Div Classe generique de la hierarchie des operateurs calculant la divergence d&#39;un ch...">Operateur_Div</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a614d41350181667ee295b87a72779c1a" title="Renvoie l&#39;operateur de calcul de la divergence associe a l&#39;equation.">Navier_Stokes_std::operateur_divergence</a>()
<a name="l00666"></a>00666 {
<a name="l00667"></a>00667   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>;
<a name="l00668"></a>00668 }
<a name="l00669"></a>00669 
<a name="l00670"></a>00670 <span class="comment">// Precondition:</span>
<a name="l00671"></a>00671 <span class="comment">// Parametre:</span>
<a name="l00672"></a>00672 <span class="comment">// Signification:</span>
<a name="l00673"></a>00673 <span class="comment">// Valeurs par defaut:</span>
<a name="l00674"></a>00674 <span class="comment">// Contraintes:</span>
<a name="l00675"></a>00675 <span class="comment">// Acces:</span>
<a name="l00676"></a>00676 <span class="comment">// Exception:</span>
<a name="l00677"></a>00677 <span class="comment">// Effets de bord:</span>
<a name="l00678"></a>00678 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00679"></a>00679 <span class="comment">//</span>
<a name="l00680"></a>00680 <span class="comment">//</span>
<a name="l00681"></a>00681 <span class="comment">//</span><span class="comment"></span>
<a name="l00682"></a>00682 <span class="comment">//! Renvoie l&#39;operateur de calcul de la divergence&lt;br&gt;associe a l&#39;equation.&lt;br&gt;(version const)</span>
<a name="l00683"></a>00683 <span class="comment"></span><span class="comment">/** \return Operateur_Div\&amp;&lt;br&gt;</span>
<a name="l00684"></a>00684 <span class="comment">Signification: l&#39;operateur de calcul de la divergence&lt;br&gt;</span>
<a name="l00685"></a>00685 <span class="comment">Contraintes: reference constante */</span>
<a name="l00686"></a><a class="code" href="classNavier__Stokes__std.html#a3d413e04d5ced1fd7dcc597e76f20347">00686</a> <span class="keyword">const</span> <a class="code" href="classOperateur__Div.html" title="classe Operateur_Div Classe generique de la hierarchie des operateurs calculant la divergence d&#39;un ch...">Operateur_Div</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a614d41350181667ee295b87a72779c1a" title="Renvoie l&#39;operateur de calcul de la divergence associe a l&#39;equation.">Navier_Stokes_std::operateur_divergence</a>()<span class="keyword"> const</span>
<a name="l00687"></a>00687 <span class="keyword"></span>{
<a name="l00688"></a>00688   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>;
<a name="l00689"></a>00689 }
<a name="l00690"></a>00690 
<a name="l00691"></a>00691 <span class="comment">// Precondition:</span>
<a name="l00692"></a>00692 <span class="comment">// Parametre:</span>
<a name="l00693"></a>00693 <span class="comment">// Signification:</span>
<a name="l00694"></a>00694 <span class="comment">// Valeurs par defaut:</span>
<a name="l00695"></a>00695 <span class="comment">// Contraintes:</span>
<a name="l00696"></a>00696 <span class="comment">// Acces:</span>
<a name="l00697"></a>00697 <span class="comment">// Exception:</span>
<a name="l00698"></a>00698 <span class="comment">// Effets de bord:</span>
<a name="l00699"></a>00699 <span class="comment">// Postcondition:</span>
<a name="l00700"></a>00700 <span class="comment">//</span>
<a name="l00701"></a>00701 <span class="comment">//</span><span class="comment"></span>
<a name="l00702"></a>00702 <span class="comment">//! Renvoie l&#39;operateur de calcul du gradient&lt;br&gt;associe a l&#39;equation.</span>
<a name="l00703"></a>00703 <span class="comment"></span><span class="comment">/** \return Operateur_Grad\&amp;&lt;br&gt;</span>
<a name="l00704"></a>00704 <span class="comment">Signification: l&#39;operateur de calcul du gradient&lt;br&gt;</span>
<a name="l00705"></a>00705 <span class="comment">Contraintes: */</span>
<a name="l00706"></a><a class="code" href="classNavier__Stokes__std.html#a840295836fce939b7861f1353da595ff">00706</a> <a class="code" href="classOperateur__Grad.html" title="Classe Operateur_Grad Classe generique de la hierarchie des operateurs calculant le gradient d&#39;un cha...">Operateur_Grad</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a840295836fce939b7861f1353da595ff" title="Renvoie l&#39;operateur de calcul du gradient associe a l&#39;equation.">Navier_Stokes_std::operateur_gradient</a>()
<a name="l00707"></a>00707 {
<a name="l00708"></a>00708   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>;
<a name="l00709"></a>00709 }
<a name="l00710"></a>00710 
<a name="l00711"></a>00711 <span class="comment">// Precondition:</span>
<a name="l00712"></a>00712 <span class="comment">// Parametre:</span>
<a name="l00713"></a>00713 <span class="comment">// Signification:</span>
<a name="l00714"></a>00714 <span class="comment">// Valeurs par defaut:</span>
<a name="l00715"></a>00715 <span class="comment">// Contraintes:</span>
<a name="l00716"></a>00716 <span class="comment">// Acces:</span>
<a name="l00717"></a>00717 <span class="comment">// Exception:</span>
<a name="l00718"></a>00718 <span class="comment">// Effets de bord:</span>
<a name="l00719"></a>00719 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00720"></a>00720 <span class="comment">//</span>
<a name="l00721"></a>00721 <span class="comment">//</span>
<a name="l00722"></a>00722 <span class="comment">//</span><span class="comment"></span>
<a name="l00723"></a>00723 <span class="comment">//! Renvoie l&#39;operateur de calcul du gradient&lt;br&gt;associe a l&#39;equation.&lt;br&gt;(version const)</span>
<a name="l00724"></a>00724 <span class="comment"></span><span class="comment">/** \return Operateur_Grad\&amp;&lt;br&gt;</span>
<a name="l00725"></a>00725 <span class="comment">Signification: l&#39;operateur de calcul du gradient&lt;br&gt;</span>
<a name="l00726"></a>00726 <span class="comment">Contraintes: reference constante */</span>
<a name="l00727"></a><a class="code" href="classNavier__Stokes__std.html#aacb638fdda4238f3027f59d4cd48e6c4">00727</a> <span class="keyword">const</span> <a class="code" href="classOperateur__Grad.html" title="Classe Operateur_Grad Classe generique de la hierarchie des operateurs calculant le gradient d&#39;un cha...">Operateur_Grad</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a840295836fce939b7861f1353da595ff" title="Renvoie l&#39;operateur de calcul du gradient associe a l&#39;equation.">Navier_Stokes_std::operateur_gradient</a>()<span class="keyword"> const</span>
<a name="l00728"></a>00728 <span class="keyword"></span>{
<a name="l00729"></a>00729   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>;
<a name="l00730"></a>00730 }
<a name="l00731"></a>00731 
<a name="l00732"></a>00732 
<a name="l00733"></a>00733 <span class="comment">// Precondition:</span>
<a name="l00734"></a>00734 <span class="comment">// Parametre:</span>
<a name="l00735"></a>00735 <span class="comment">// Signification:</span>
<a name="l00736"></a>00736 <span class="comment">// Valeurs par defaut:</span>
<a name="l00737"></a>00737 <span class="comment">// Contraintes:</span>
<a name="l00738"></a>00738 <span class="comment">// Acces:</span>
<a name="l00739"></a>00739 <span class="comment">// Exception:</span>
<a name="l00740"></a>00740 <span class="comment">// Effets de bord:</span>
<a name="l00741"></a>00741 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00742"></a>00742 <span class="comment">//</span>
<a name="l00743"></a>00743 <span class="comment">//</span><span class="comment"></span>
<a name="l00744"></a>00744 <span class="comment">//! Renvoie la vitesse (champ inconnue de l&#39;equation)&lt;br&gt;(version const)</span>
<a name="l00745"></a>00745 <span class="comment"></span><span class="comment">/** \return Champ_Inc\&amp;&lt;br&gt;</span>
<a name="l00746"></a>00746 <span class="comment">Signification: le champ inconnue representant la vitesse&lt;br&gt;</span>
<a name="l00747"></a>00747 <span class="comment">Contraintes: reference constante */</span>
<a name="l00748"></a><a class="code" href="classNavier__Stokes__std.html#a743b777e6185faee7837326844c8fca1">00748</a> <span class="keyword">const</span> <a class="code" href="classChamp__Inc.html">Champ_Inc</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a743b777e6185faee7837326844c8fca1" title="Renvoie la vitesse (champ inconnue de l&#39;equation) (version const)">Navier_Stokes_std::inconnue</a>()<span class="keyword"> const</span>
<a name="l00749"></a>00749 <span class="keyword"></span>{
<a name="l00750"></a>00750   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>;
<a name="l00751"></a>00751 }
<a name="l00752"></a>00752 
<a name="l00753"></a>00753 <span class="comment">// Precondition:</span>
<a name="l00754"></a>00754 <span class="comment">// Parametre:</span>
<a name="l00755"></a>00755 <span class="comment">// Signification:</span>
<a name="l00756"></a>00756 <span class="comment">// Valeurs par defaut:</span>
<a name="l00757"></a>00757 <span class="comment">// Contraintes:</span>
<a name="l00758"></a>00758 <span class="comment">// Acces:</span>
<a name="l00759"></a>00759 <span class="comment">// Exception:</span>
<a name="l00760"></a>00760 <span class="comment">// Effets de bord:</span>
<a name="l00761"></a>00761 <span class="comment">// Postcondition:</span>
<a name="l00762"></a>00762 <span class="comment">//</span><span class="comment"></span>
<a name="l00763"></a>00763 <span class="comment">//! Renvoie la vitesse (champ inconnue de l&#39;equation)</span>
<a name="l00764"></a>00764 <span class="comment"></span><span class="comment">/** \return Champ_Inc\&amp;&lt;br&gt;</span>
<a name="l00765"></a>00765 <span class="comment">Signification: le champ inconnue representant la vitesse&lt;br&gt;</span>
<a name="l00766"></a>00766 <span class="comment">Contraintes: */</span>
<a name="l00767"></a><a class="code" href="classNavier__Stokes__std.html#a0b2f0b294b57f09914daddeab971089e">00767</a> <a class="code" href="classChamp__Inc.html">Champ_Inc</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a743b777e6185faee7837326844c8fca1" title="Renvoie la vitesse (champ inconnue de l&#39;equation) (version const)">Navier_Stokes_std::inconnue</a>()
<a name="l00768"></a>00768 {
<a name="l00769"></a>00769   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>;
<a name="l00770"></a>00770 }
<a name="l00771"></a>00771 
<a name="l00772"></a>00772 <span class="comment">// Precondition:</span>
<a name="l00773"></a>00773 <span class="comment">// Parametre:</span>
<a name="l00774"></a>00774 <span class="comment">// Signification:</span>
<a name="l00775"></a>00775 <span class="comment">// Valeurs par defaut:</span>
<a name="l00776"></a>00776 <span class="comment">// Contraintes:</span>
<a name="l00777"></a>00777 <span class="comment">// Acces:</span>
<a name="l00778"></a>00778 <span class="comment">// Exception:</span>
<a name="l00779"></a>00779 <span class="comment">// Effets de bord:</span>
<a name="l00780"></a>00780 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00781"></a>00781 <span class="comment">//</span>
<a name="l00782"></a>00782 <span class="comment">//</span><span class="comment"></span>
<a name="l00783"></a>00783 <span class="comment">//! Renvoie le solveur en pression&lt;br&gt;(version const)</span>
<a name="l00784"></a>00784 <span class="comment"></span><span class="comment">/** \return SolveurSys\&amp;&lt;br&gt;</span>
<a name="l00785"></a>00785 <span class="comment">Signification: le solveur en pression&lt;br&gt;</span>
<a name="l00786"></a>00786 <span class="comment">Contraintes: reference constante */</span>
<a name="l00787"></a><a class="code" href="classNavier__Stokes__std.html#ae83d9f7a42531293583f32be1efd3d5f">00787</a> <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; <a class="code" href="classNavier__Stokes__std.html#ae83d9f7a42531293583f32be1efd3d5f" title="Renvoie le solveur en pression&lt;br&gt;(version const)">Navier_Stokes_std::solveur_pression</a>()
<a name="l00788"></a>00788 {
<a name="l00789"></a>00789   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>;
<a name="l00790"></a>00790 }
<a name="l00791"></a>00791 
<a name="l00792"></a>00792 <span class="comment">// Precondition:</span>
<a name="l00793"></a>00793 <span class="comment">// Parametre:</span>
<a name="l00794"></a>00794 <span class="comment">// Signification:</span>
<a name="l00795"></a>00795 <span class="comment">// Valeurs par defaut:</span>
<a name="l00796"></a>00796 <span class="comment">// Contraintes:</span>
<a name="l00797"></a>00797 <span class="comment">// Acces:</span>
<a name="l00798"></a>00798 <span class="comment">// Exception:</span>
<a name="l00799"></a>00799 <span class="comment">// Effets de bord:</span>
<a name="l00800"></a>00800 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00801"></a>00801 <span class="comment">//</span>
<a name="l00802"></a>00802 <span class="comment">//</span>
<a name="l00803"></a>00803 <span class="comment">//</span><span class="comment"></span>
<a name="l00804"></a>00804 <span class="comment">//! Renvoie le fluide incompressible (milieu physique de l&#39;equation)&lt;br&gt;associe a l&#39;equation.&lt;br&gt;(version const)</span>
<a name="l00805"></a>00805 <span class="comment"></span><span class="comment">/** \return Fluide_base\&amp;&lt;br&gt;</span>
<a name="l00806"></a>00806 <span class="comment">Signification: le fluide incompressible associe a l&#39;equation&lt;br&gt;</span>
<a name="l00807"></a>00807 <span class="comment">Contraintes: reference constante */</span>
<a name="l00808"></a><a class="code" href="classNavier__Stokes__std.html#a6b341590bc39e1395c14560f10d67fdb">00808</a> <span class="keyword">const</span> <a class="code" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a6b341590bc39e1395c14560f10d67fdb" title="Renvoie le fluide incompressible (milieu physique de l&#39;equation) associe a l&#39;equation. (version const)">Navier_Stokes_std::fluide</a>()<span class="keyword"> const</span>
<a name="l00809"></a>00809 <span class="keyword"></span>{
<a name="l00810"></a>00810   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#ad9aa0a7593fc4cc74b362ce25f1b2d61">le_fluide</a>.<a class="code" href="classRef__Fluide__base.html#a614fc18293b0b3da4f460a857a3b3cb8">valeur</a>();
<a name="l00811"></a>00811 }
<a name="l00812"></a>00812 
<a name="l00813"></a>00813 
<a name="l00814"></a>00814 <span class="comment">// Precondition:</span>
<a name="l00815"></a>00815 <span class="comment">// Parametre:</span>
<a name="l00816"></a>00816 <span class="comment">// Signification:</span>
<a name="l00817"></a>00817 <span class="comment">// Valeurs par defaut:</span>
<a name="l00818"></a>00818 <span class="comment">// Contraintes:</span>
<a name="l00819"></a>00819 <span class="comment">// Acces:</span>
<a name="l00820"></a>00820 <span class="comment">// Exception:</span>
<a name="l00821"></a>00821 <span class="comment">// Effets de bord:</span>
<a name="l00822"></a>00822 <span class="comment">// Postcondition:</span>
<a name="l00823"></a>00823 <span class="comment">//</span>
<a name="l00824"></a>00824 <span class="comment">//</span><span class="comment"></span>
<a name="l00825"></a>00825 <span class="comment">//! Renvoie le fluide incompressible (milieu physique de l&#39;equation)&lt;br&gt;associe a l&#39;equation.</span>
<a name="l00826"></a>00826 <span class="comment"></span><span class="comment">/** \return Fluide_base\&amp;&lt;br&gt;</span>
<a name="l00827"></a>00827 <span class="comment">Signification: le fluide incompressible associe a l&#39;equation&lt;br&gt;</span>
<a name="l00828"></a>00828 <span class="comment">Contraintes: */</span>
<a name="l00829"></a><a class="code" href="classNavier__Stokes__std.html#adb567aff09e229a9abd3c2fb29ef94c5">00829</a> <a class="code" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a6b341590bc39e1395c14560f10d67fdb" title="Renvoie le fluide incompressible (milieu physique de l&#39;equation) associe a l&#39;equation. (version const)">Navier_Stokes_std::fluide</a>()
<a name="l00830"></a>00830 {
<a name="l00831"></a>00831   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#ad9aa0a7593fc4cc74b362ce25f1b2d61">le_fluide</a>.<a class="code" href="classRef__Fluide__base.html#a614fc18293b0b3da4f460a857a3b3cb8">valeur</a>();
<a name="l00832"></a>00832 }
<a name="l00833"></a>00833 
<a name="l00834"></a><a class="code" href="classNavier__Stokes__std.html#a472e541d2dafe4f05ee73196b319b027">00834</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a472e541d2dafe4f05ee73196b319b027" title="Lecture des conditions initiales dans un flot d&#39;entree. Le format de lecture est le suivant: { Nom [D...">Navier_Stokes_std::lire_cond_init</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00835"></a>00835 {
<a name="l00836"></a>00836   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Reading of initial conditions\n&quot;</span>;
<a name="l00837"></a>00837   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom;
<a name="l00838"></a>00838   <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> motlu;
<a name="l00839"></a>00839   is &gt;&gt; nom;
<a name="l00840"></a>00840   motlu = nom;
<a name="l00841"></a>00841   <span class="keywordflow">if</span>(motlu!=<a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>(<span class="stringliteral">&quot;{&quot;</span>))
<a name="l00842"></a>00842     {
<a name="l00843"></a>00843       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;We expected a { while reading &quot;</span> &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00844"></a>00844       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;and not : &quot;</span> &lt;&lt; nom &lt;&lt; finl;
<a name="l00845"></a>00845       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00846"></a>00846     }
<a name="l00847"></a>00847   <a class="code" href="classMotcles.html" title="Un tableau d&#39;objets de la classe Motcle.">Motcles</a> compris(3);
<a name="l00848"></a>00848   compris[0]=<span class="stringliteral">&quot;}&quot;</span>;
<a name="l00849"></a>00849   compris[1]=<span class="stringliteral">&quot;vitesse&quot;</span>;
<a name="l00850"></a>00850   compris[2]=<span class="stringliteral">&quot;pression&quot;</span>;
<a name="l00851"></a>00851   <span class="keywordtype">int</span> ind = -1;
<a name="l00852"></a>00852   <span class="keywordflow">while</span> (ind!=0)
<a name="l00853"></a>00853     {
<a name="l00854"></a>00854       is &gt;&gt; nom;
<a name="l00855"></a>00855       motlu = nom;
<a name="l00856"></a>00856       ind = compris.<a class="code" href="classMotcles.html#a79f1b0c557e31eece226b045ea412cd6">rang</a>(motlu);
<a name="l00857"></a>00857       <span class="keywordflow">if</span> (ind==1)
<a name="l00858"></a>00858         {
<a name="l00859"></a>00859           <a class="code" href="classChamp__Don.html" title="classe Champ_Don Classe generique de la hierarchie des champs donnes, un objet Champ_Don peut referen...">Champ_Don</a> ch_init;
<a name="l00860"></a>00860           is &gt;&gt; ch_init;
<a name="l00861"></a>00861           <a class="code" href="classEquation__base.html#ad1f2ad11c460019344768e591ec41825" title="Verification du nombre de composantes lues pour la specification d un champ. Actuellement utilise pou...">verifie_ch_init_nb_comp</a>(<a class="code" href="classNavier__Stokes__std.html#a743b777e6185faee7837326844c8fca1" title="Renvoie la vitesse (champ inconnue de l&#39;equation) (version const)">inconnue</a>(),ch_init.nb_comp());
<a name="l00862"></a>00862           <a class="code" href="classNavier__Stokes__std.html#a743b777e6185faee7837326844c8fca1" title="Renvoie la vitesse (champ inconnue de l&#39;equation) (version const)">inconnue</a>()-&gt;affecter(ch_init.valeur());
<a name="l00863"></a>00863         }
<a name="l00864"></a>00864       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ind==2)
<a name="l00865"></a>00865         {
<a name="l00866"></a>00866           <a class="code" href="classChamp__Don.html" title="classe Champ_Don Classe generique de la hierarchie des champs donnes, un objet Champ_Don peut referen...">Champ_Don</a> ch_init;
<a name="l00867"></a>00867           is &gt;&gt; ch_init;
<a name="l00868"></a>00868           <a class="code" href="classEquation__base.html#ad1f2ad11c460019344768e591ec41825" title="Verification du nombre de composantes lues pour la specification d un champ. Actuellement utilise pou...">verifie_ch_init_nb_comp</a>(<a class="code" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a" title="Renvoie le champ de pression.">pression</a>(),ch_init.nb_comp());
<a name="l00869"></a>00869           <a class="code" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a" title="Renvoie le champ de pression.">pression</a>()-&gt;affecter(ch_init.valeur());
<a name="l00870"></a>00870         }
<a name="l00871"></a>00871       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ind==-1)
<a name="l00872"></a>00872         {
<a name="l00873"></a>00873           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; nom &lt;&lt; <span class="stringliteral">&quot; is not understood. Keywords are:&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00874"></a>00874           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; compris &lt;&lt; finl;
<a name="l00875"></a>00875           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00876"></a>00876         }
<a name="l00877"></a>00877     }
<a name="l00878"></a>00878   <span class="keywordflow">return</span> is;
<a name="l00879"></a>00879 }
<a name="l00880"></a>00880 
<a name="l00881"></a>00881 <span class="comment">//</span>
<a name="l00882"></a>00882 <span class="comment">//</span><span class="comment"></span>
<a name="l00883"></a>00883 <span class="comment">//! Add a specific term for Navier Stokes (-gradP(n)) if necessary</span>
<a name="l00884"></a><a class="code" href="classNavier__Stokes__std.html#a8fc2b544594acef9cc31ff48e5184c47">00884</a> <span class="comment"></span><a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a8fc2b544594acef9cc31ff48e5184c47" title="Add a specific term for Navier Stokes (-gradP(n)) if necessary.">Navier_Stokes_std::corriger_derivee_expl</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; derivee)
<a name="l00885"></a>00885 {
<a name="l00886"></a>00886   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classDeriv__Assembleur__base.html#ac0c74810fc600fc5053e645bf19d4ece">valeur</a>().<a class="code" href="classAssembleur__base.html#afb2f8c92496b38dcafa391fe380c0385" title="Renvoie la valeur du drapeau resoudre_increment_pression_ (0 ou 1) Renvoie -1 si le drapeau n&#39;a pas e...">get_resoudre_increment_pression</a>())
<a name="l00887"></a>00887     {
<a name="l00888"></a>00888 <span class="comment">// PL: Pour ne pas calculer ce gradient, il faut</span>
<a name="l00889"></a>00889 <span class="comment">// A) postraitement_gradient_P_==0 car sinon grad contient alors M-1BtP</span>
<a name="l00890"></a>00890 <span class="comment">// B) les conditions en pression soient stationnaires (pas facile a detecter: Orlansky, P(t), gradient_pression impose...)</span>
<a name="l00891"></a>00891 <span class="comment">// En outre, cela fait des ecarts avec le schema CN iteratif</span>
<a name="l00892"></a>00892       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_pression = <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00893"></a>00893       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; gradP = <a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00894"></a>00894       <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur__Grad.html#a179b2f08f6907e9b69fa715cfb98fa81" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(tab_pression, gradP);
<a name="l00895"></a>00895       derivee -= gradP;
<a name="l00896"></a>00896     }
<a name="l00897"></a>00897   <span class="keywordflow">return</span> derivee;
<a name="l00898"></a>00898 }
<a name="l00899"></a>00899 
<a name="l00900"></a>00900 <span class="comment">//</span>
<a name="l00901"></a>00901 <span class="comment">//</span><span class="comment"></span>
<a name="l00902"></a>00902 <span class="comment">//! Resolution de la pression, inconnue implicitee de Navier Stokes</span>
<a name="l00903"></a><a class="code" href="classNavier__Stokes__std.html#a278b56e9fb68e110d6e62014e8ea15a2">00903</a> <span class="comment"></span><a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a278b56e9fb68e110d6e62014e8ea15a2" title="Resolution de la pression, inconnue implicitee de Navier Stokes.">Navier_Stokes_std::corriger_derivee_impl</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; derivee)
<a name="l00904"></a>00904 {
<a name="l00905"></a>00905 <span class="comment">// We want to solve:</span>
<a name="l00906"></a>00906 <span class="comment">// dU/dt + M-1 Bt Cp = M-1(F - BtP)</span>
<a name="l00907"></a>00907 <span class="comment">// B dU/dt = 0</span>
<a name="l00908"></a>00908 <span class="comment">// with F explicit terms: sum(operators)+sources</span>
<a name="l00909"></a>00909 <span class="comment">// In:  derivee = M-1(F - BtP(n))</span>
<a name="l00910"></a>00910 <span class="comment">// Out: derivee = M-1(F - BtP(n+1)), P(n+1)=P(n)+Cp</span>
<a name="l00911"></a>00911 
<a name="l00912"></a>00912 <span class="comment">// In case of ALE:</span>
<a name="l00913"></a>00913 <span class="comment">// Out: derivee = M-1(F + ALEconvectiveTerm - BtP(n+1)) = derivee_out, P(n+1)=P(n)+Cp</span>
<a name="l00914"></a>00914 <span class="comment">// Cp is calculated from the following equation:</span>
<a name="l00915"></a>00915 <span class="comment">// (BJ_{n}M-1Bt)Cp=B(J_{n}U_{n}/timestep+J_{n}derivee_out-J_{n+1}U_ALE), J-Jacobian, _{n}- at time n</span>
<a name="l00916"></a>00916 
<a name="l00917"></a>00917   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_pression=<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00918"></a>00918   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; gradP=<a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00919"></a>00919   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> secmemP(tab_pression);
<a name="l00920"></a>00920   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> deriveeALE(derivee);
<a name="l00921"></a>00921 
<a name="l00922"></a>00922   <span class="keywordtype">double</span> timestep=<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a0cf6c541e30cd21c3da32fc122cb0e2b" title="Renvoie le schema en temps associe au probleme. (si il est non nul) (version const)">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l00923"></a>00923 
<a name="l00924"></a>00924 <span class="comment">// can be used for methods like ALE</span>
<a name="l00925"></a>00925   <a class="code" href="classNavier__Stokes__std.html#a4dedb77200a30c4a503170ec2dcb89ed">renewing_jacobians</a>( derivee );
<a name="l00926"></a>00926 
<a name="l00927"></a>00927   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#ab8a98de5265582fe9101a70d33c6e8cc">div_u_nul_et_non_dsurdt_divu_</a>)
<a name="l00928"></a>00928     {
<a name="l00929"></a>00929 <span class="comment">// on veut div u =0 et non d/dt (div u)=0 pour eviter de cumuler les erreurs</span>
<a name="l00930"></a>00930 <span class="comment">// cela ne marche qu&#39;avec les schema type euler_explicite</span>
<a name="l00931"></a>00931       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> derivee2(derivee);
<a name="l00932"></a>00932       <span class="keyword">const</span> <span class="keywordtype">double</span> dt=<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l00933"></a>00933       derivee2*=dt;
<a name="l00934"></a>00934       derivee2+=<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>.<a class="code" href="classChamp__Inc.html#ad4e16720f4575dceb8536c9f09635a3c" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t-i.">passe</a>();
<a name="l00935"></a>00935       derivee2/=dt;
<a name="l00936"></a>00936       <span class="keywordflow">if</span>( !<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classOp__Conv__ALE.html">Op_Conv_ALE</a>, <a class="code" href="classNavier__Stokes__std.html#a3a5698f420e093b2bbb77df313b5bb97">terme_convectif</a>.<a class="code" href="classDeriv__Operateur__Conv__base.html#aa721c2abc082bf961c812c62d24ccb2b">valeur</a>()) ) <span class="comment">//No ALE method</span>
<a name="l00937"></a>00937         {
<a name="l00938"></a>00938           <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur__Div.html#ad3dbe52ca9c4899797444afeb0fe4ef4" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(derivee2, secmemP); <span class="comment">//!&lt; Div(M-1(F - BtP))</span>
<a name="l00939"></a>00939 <span class="comment"></span>        }
<a name="l00940"></a>00940     }
<a name="l00941"></a>00941   <span class="keywordflow">else</span>
<a name="l00942"></a>00942     {
<a name="l00943"></a>00943       <span class="keywordflow">if</span>( !<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classOp__Conv__ALE.html">Op_Conv_ALE</a>, <a class="code" href="classNavier__Stokes__std.html#a3a5698f420e093b2bbb77df313b5bb97">terme_convectif</a>.<a class="code" href="classDeriv__Operateur__Conv__base.html#aa721c2abc082bf961c812c62d24ccb2b">valeur</a>()) ) <span class="comment">//No ALE method</span>
<a name="l00944"></a>00944         {
<a name="l00945"></a>00945           <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur__Div.html#ad3dbe52ca9c4899797444afeb0fe4ef4" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(derivee, secmemP); <span class="comment">//!&lt; Div(M-1(F - BtP))</span>
<a name="l00946"></a>00946 <span class="comment"></span>        }
<a name="l00947"></a>00947     }
<a name="l00948"></a>00948 
<a name="l00949"></a>00949   <span class="keywordflow">if</span>( !<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classOp__Conv__ALE.html">Op_Conv_ALE</a>, <a class="code" href="classNavier__Stokes__std.html#a3a5698f420e093b2bbb77df313b5bb97">terme_convectif</a>.<a class="code" href="classDeriv__Operateur__Conv__base.html#aa721c2abc082bf961c812c62d24ccb2b">valeur</a>()) ) <span class="comment">//No ALE method</span>
<a name="l00950"></a>00950     {
<a name="l00951"></a>00951       secmemP *= -1; <span class="comment">//!&lt; car div =-B Correction du second membre d&#39;apres les conditions aux limites :</span>
<a name="l00952"></a>00952 <span class="comment"></span><span class="comment">//</span>
<a name="l00953"></a>00953       <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classAssembleur.html#abac307565fa214099f111a015e1cda3f" title="Appel a l&#39;objet sous-jacent. Permet de modifier le second membre du systeme Modifie egalement la solu...">modifier_secmem</a>(secmemP);
<a name="l00954"></a>00954     }
<a name="l00955"></a>00955 
<a name="l00956"></a>00956 <span class="comment">// Set print of the linear system solve according to dt_impr:</span>
<a name="l00957"></a>00957   <a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>-&gt;fixer_schema_temps_limpr(<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classEquation__base.html#a864f40c89a8f90da70f177f7304d0f19" title="Demande au schema en temps si il faut effectuer une impression. Renvoie 1 si il faut effectuer une im...">limpr</a>());
<a name="l00958"></a>00958 
<a name="l00959"></a>00959   <span class="keyword">const</span> <span class="keywordtype">bool</span> is_PolyMAC = ( <a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() == <span class="stringliteral">&quot;PolyMAC&quot;</span> );
<a name="l00960"></a>00960   <span class="keyword">const</span> <span class="keywordtype">bool</span> is_ALE = ( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classOp__Conv__ALE.html">Op_Conv_ALE</a>, <a class="code" href="classNavier__Stokes__std.html#a3a5698f420e093b2bbb77df313b5bb97">terme_convectif</a>.<a class="code" href="classDeriv__Operateur__Conv__base.html#aa721c2abc082bf961c812c62d24ccb2b">valeur</a>()) );
<a name="l00961"></a>00961 
<a name="l00962"></a>00962   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classDeriv__Assembleur__base.html#ac0c74810fc600fc5053e645bf19d4ece">valeur</a>().<a class="code" href="classAssembleur__base.html#afb2f8c92496b38dcafa391fe380c0385" title="Renvoie la valeur du drapeau resoudre_increment_pression_ (0 ou 1) Renvoie -1 si le drapeau n&#39;a pas e...">get_resoudre_increment_pression</a>())
<a name="l00963"></a>00963     {
<a name="l00964"></a>00964 
<a name="l00965"></a>00965       <span class="keywordflow">if</span> ( ! is_PolyMAC )
<a name="l00966"></a>00966         {
<a name="l00967"></a>00967           <span class="keywordflow">if</span>( is_ALE )
<a name="l00968"></a>00968             {
<a name="l00969"></a>00969 <span class="comment">// we don&#39;t want to have domaine_ale object here</span>
<a name="l00970"></a>00970               <a class="code" href="classNavier__Stokes__std.html#a54fbabd340bded8a8dc792c9cf72e121">div_ale_derivative</a>( deriveeALE, timestep, derivee, secmemP );
<a name="l00971"></a>00971             }
<a name="l00972"></a>00972 <span class="comment">// Solve B M-1 Bt Cp = M-1(F - BtP)</span>
<a name="l00973"></a>00973           <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> Cp(tab_pression);
<a name="l00974"></a>00974           <a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(<a class="code" href="classNavier__Stokes__std.html#a65ad55520bdc8a52dd452c24574a7b03">matrice_pression_</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmemP, Cp);
<a name="l00975"></a>00975 
<a name="l00976"></a>00976 <span class="comment">// P(n+1) = P(n) + Cp</span>
<a name="l00977"></a>00977           tab_pression += Cp;
<a name="l00978"></a>00978           <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classAssembleur.html#ac7b804a7151f761f15395e67aa8fd024" title="Appel a l&#39;objet sous-jacent. Permet de modifier la pression.">modifier_solution</a>(tab_pression);
<a name="l00979"></a>00979 
<a name="l00980"></a>00980 <span class="comment">// M-1 Bt P(n+1)</span>
<a name="l00981"></a>00981           <a class="code" href="classEquation__base.html#aaaf61d60cca8205d2490a023633cc7d4">solveur_masse</a>.<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(gradP);
<a name="l00982"></a>00982           derivee += gradP; <span class="comment">//!&lt; M-1 F</span>
<a name="l00983"></a>00983 <span class="comment"></span>        }
<a name="l00984"></a>00984       <span class="keywordflow">else</span> <span class="comment">//PolyMAC : le solveur pression calcule la correction en vitesse...</span>
<a name="l00985"></a>00985         {
<a name="l00986"></a>00986           <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> Cp(tab_pression);
<a name="l00987"></a>00987           <a class="code" href="classDoubleTab__parts.html">DoubleTab_parts</a> Cp_parts(Cp);
<a name="l00988"></a>00988 <span class="comment">// secmemP contient (- div v, 0) / Cp contient (- corr en pression, nouvelles vitesses)</span>
<a name="l00989"></a>00989           <a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(<a class="code" href="classNavier__Stokes__std.html#a65ad55520bdc8a52dd452c24574a7b03">matrice_pression_</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmemP, Cp);
<a name="l00990"></a>00990           tab_pression -= Cp;
<a name="l00991"></a>00991           <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classAssembleur.html#ac7b804a7151f761f15395e67aa8fd024" title="Appel a l&#39;objet sous-jacent. Permet de modifier la pression.">modifier_solution</a>(tab_pression);
<a name="l00992"></a>00992 <span class="comment">// l&#39;assembleur pression a une fonction pour corriger les vitesses</span>
<a name="l00993"></a>00993           <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classDeriv__Assembleur__base.html#ac0c74810fc600fc5053e645bf19d4ece">valeur</a>().<a class="code" href="classAssembleur__base.html#a545320f11a7a922a722a5be44ac16e96">corriger_vitesses</a>(Cp, derivee);
<a name="l00994"></a>00994         }
<a name="l00995"></a>00995     }
<a name="l00996"></a>00996   <span class="keywordflow">else</span>
<a name="l00997"></a>00997     {
<a name="l00998"></a>00998       <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() == <span class="stringliteral">&quot;PolyMAC&quot;</span>) <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">abort</a>();
<a name="l00999"></a>00999 <span class="comment">// Solve B M-1 Bt P(n+1) = B M-1 F</span>
<a name="l01000"></a>01000       <a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(<a class="code" href="classNavier__Stokes__std.html#a65ad55520bdc8a52dd452c24574a7b03">matrice_pression_</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(), secmemP, tab_pression);
<a name="l01001"></a>01001       <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classAssembleur.html#ac7b804a7151f761f15395e67aa8fd024" title="Appel a l&#39;objet sous-jacent. Permet de modifier la pression.">modifier_solution</a>(tab_pression);
<a name="l01002"></a>01002 <span class="comment">// It is not done anymore cause:</span>
<a name="l01003"></a>01003 <span class="comment">// Iterative solvers are less accurate</span>
<a name="l01004"></a>01004 <span class="comment">// Time converges in O(sqrt(dt)) and not O(dt)</span>
<a name="l01005"></a>01005 <span class="comment">// See: http://www.sciencedirect.com/science/article/pii/S0021999108004518</span>
<a name="l01006"></a>01006     }
<a name="l01007"></a>01007 
<a name="l01008"></a>01008   <span class="keywordflow">if</span> ( ! is_PolyMAC ) <span class="comment">//en PolyMAC, on a deja modifie la vitesse</span>
<a name="l01009"></a>01009     {
<a name="l01010"></a>01010 <span class="comment">// (BM) gradient operator requires updated virtual space in source vector</span>
<a name="l01011"></a>01011 <span class="comment">// Calculate Bt P(n+1)</span>
<a name="l01012"></a>01012       tab_pression.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01013"></a>01013       <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur__Grad.html#a179b2f08f6907e9b69fa715cfb98fa81" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(tab_pression, gradP);
<a name="l01014"></a>01014 
<a name="l01015"></a>01015 <span class="comment">// gradP = Bt P(n+1) is kept and</span>
<a name="l01016"></a>01016 <span class="comment">// M-1Bt P(n+1) is calculated:</span>
<a name="l01017"></a>01017       <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> Mmoins1gradP(gradP);
<a name="l01018"></a>01018       Mmoins1gradP = gradP;
<a name="l01019"></a>01019       <a class="code" href="classEquation__base.html#aaaf61d60cca8205d2490a023633cc7d4">solveur_masse</a>.<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(Mmoins1gradP);
<a name="l01020"></a>01020 
<a name="l01021"></a>01021 <span class="comment">// dU/dt = M-1(F-Bt P(n+1))</span>
<a name="l01022"></a>01022       derivee -= Mmoins1gradP;
<a name="l01023"></a>01023     }
<a name="l01024"></a>01024 
<a name="l01025"></a>01025   <span class="keywordflow">return</span> derivee;
<a name="l01026"></a>01026 }
<a name="l01027"></a>01027 
<a name="l01028"></a>01028 
<a name="l01029"></a>01029 <span class="comment">// Precondition:</span>
<a name="l01030"></a>01030 <span class="comment">// Parametre:</span>
<a name="l01031"></a>01031 <span class="comment">// Signification:</span>
<a name="l01032"></a>01032 <span class="comment">// Valeurs par defaut:</span>
<a name="l01033"></a>01033 <span class="comment">// Contraintes:</span>
<a name="l01034"></a>01034 <span class="comment">// Acces:</span>
<a name="l01035"></a>01035 <span class="comment">// </span>
<a name="l01036"></a>01036 <span class="comment">// Signification:</span>
<a name="l01037"></a>01037 <span class="comment">// Contraintes:</span>
<a name="l01038"></a>01038 <span class="comment">// Exception: pas de temps trop petit</span>
<a name="l01039"></a>01039 <span class="comment">// Effets de bord:</span>
<a name="l01040"></a>01040 <span class="comment">// Postcondition:</span>
<a name="l01041"></a>01041 <span class="comment">//</span>
<a name="l01042"></a>01042 <span class="comment">//</span>
<a name="l01043"></a>01043 <span class="comment">//</span>
<a name="l01044"></a>01044 <span class="comment">//</span>
<a name="l01045"></a>01045 <span class="comment">//</span>
<a name="l01046"></a>01046 <span class="comment">//</span>
<a name="l01047"></a>01047 <span class="comment">//</span><span class="comment"></span>
<a name="l01048"></a>01048 <span class="comment">//! Calcule la solution U des equations:&lt;br&gt;| M(U-V)/dt + BtP = 0&lt;br&gt;|-BU=0&lt;br&gt;On resoud le probleme en pression: -BM-1BtP = -BV/dt&lt;br&gt;sachant que -BV represente le calcul de la divergence de V&lt;br&gt;On resoud le probleme en vitesse en appliquant le solveur&lt;br&gt;de masse au gradient de P:  U=V - dt*M-1BtP</span>
<a name="l01049"></a><a class="code" href="classNavier__Stokes__std.html#a5750f93d713b5094138e41c9d81bedb7">01049</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#a5750f93d713b5094138e41c9d81bedb7" title="Calcule la solution U des equations: | M(U-V)/dt + BtP = 0 |-BU=0 On resoud le probleme en pression: ...">Navier_Stokes_std::projeter</a>()
<a name="l01050"></a>01050 {
<a name="l01051"></a>01051   <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().is_dilatable() &amp;&amp; <a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().reprise_effectuee())
<a name="l01052"></a>01052     {
<a name="l01053"></a>01053       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;WARNING: Quasi compressible model --&gt; no projection (except the first time step).&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01054"></a>01054     }
<a name="l01055"></a>01055   <span class="keywordflow">else</span>
<a name="l01056"></a>01056     {
<a name="l01057"></a>01057       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_vitesse=<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l01058"></a>01058       tab_vitesse.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01059"></a>01059       <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>().<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01060"></a>01060       <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> secmem(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01061"></a>01061 <span class="comment">// Cela ne sert a rien d&#39;initialiser lagrange avec la pression</span>
<a name="l01062"></a>01062 <span class="comment">// voir ca penalise le calcul en p1B et CL p&lt;&gt;0</span>
<a name="l01063"></a>01063 <span class="comment">// On prend un DoubleTrav au lieu d&#39;un DoubleTab pour avoir lagrange=0</span>
<a name="l01064"></a>01064       <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> lagrange(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01065"></a>01065       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> gradP(<a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01066"></a>01066 
<a name="l01067"></a>01067       <span class="keywordtype">double</span> normal_seuil=0;
<a name="l01068"></a>01068 
<a name="l01069"></a>01069 <span class="comment">// M u + eBt l = M v</span>
<a name="l01070"></a>01070 <span class="comment">// B u = 0</span>
<a name="l01071"></a>01071 <span class="comment">// =&gt; e B(M-1)Bt l = Bv</span>
<a name="l01072"></a>01072 <span class="comment">// </span>
<a name="l01073"></a>01073       <span class="keywordflow">if</span> ((<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a> != -1) &amp;&amp; (<a class="code" href="classNavier__Stokes__std.html#a2731b349868649fd27e20b4517079c0a">correction_vitesse_projection_initiale_</a>==1))
<a name="l01074"></a>01074         {
<a name="l01075"></a>01075           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;(IBM) Immersed Interface: modified initial velocity for initial projection.&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01076"></a>01076           <span class="keyword">const</span> <a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>&amp; src = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>&amp;<span class="keyword">&gt;</span>((<a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>())[<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a>].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l01077"></a>01077           src.<a class="code" href="classSource__PDF__base.html#af5394ac649be7f22ba9e41c4ea4eace0">correct_vitesse</a>(<a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a>, tab_vitesse);
<a name="l01078"></a>01078           tab_vitesse.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01079"></a>01079         }
<a name="l01080"></a>01080       <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur__Div.html#ad3dbe52ca9c4899797444afeb0fe4ef4" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(tab_vitesse, secmem);
<a name="l01081"></a>01081 <span class="comment">// Desormais on calcule le pas de temps avant la projection</span>
<a name="l01082"></a>01082 <span class="comment">// Avant, on avait dt=dt_min au debut du calcul</span>
<a name="l01083"></a>01083       <span class="keywordtype">double</span> dt = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(<a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;pas_temps_min(),<a class="code" href="classEquation__base.html#a5b0b97f18ca64a6f26e984e25c944ee1" title="Calcul du prochain pas de temps. Renvoie l&#39;inverse de la somme des inverses des pas de temps calcules...">calculer_pas_de_temps</a>());
<a name="l01084"></a>01084       dt = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(dt, <a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;pas_temps_max());
<a name="l01085"></a>01085 
<a name="l01086"></a>01086       secmem*=(-1./dt);
<a name="l01087"></a>01087       secmem.echange_espace_virtuel();
<a name="l01088"></a>01088 
<a name="l01089"></a>01089       <span class="keywordtype">double</span> bilan=<a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(secmem);
<a name="l01090"></a>01090       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;-------------  Projection  -----------------&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01091"></a>01091       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;--------------------------------------------&quot;</span> &lt;&lt; finl;
<a name="l01092"></a>01092       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;Bilan de masse avant projection : &quot;</span> &lt;&lt; bilan &lt;&lt; finl;
<a name="l01093"></a>01093 
<a name="l01094"></a>01094       <span class="keywordflow">if</span>( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classsolv__iteratif.html">solv_iteratif</a>,<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>()) )
<a name="l01095"></a>01095         {
<a name="l01096"></a>01096           <a class="code" href="classsolv__iteratif.html">solv_iteratif</a>&amp; solv_iter=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classsolv__iteratif.html">solv_iteratif</a>,<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>());
<a name="l01097"></a>01097           normal_seuil=solv_iter.<a class="code" href="classsolv__iteratif.html#acb57780795c754663eb6974e123aec88">get_seuil</a>();
<a name="l01098"></a>01098           solv_iter.<a class="code" href="classsolv__iteratif.html#a8f895c998d8b0548468b12c4cd908b2d">set_seuil</a>(<a class="code" href="classNavier__Stokes__std.html#a2daee5722e9109ff537ae5c818556049">seuil_projection</a>);
<a name="l01099"></a>01099         }
<a name="l01100"></a>01100 
<a name="l01101"></a>01101 <span class="comment">// Correction du second membre d&#39;apres les conditions aux limites :</span>
<a name="l01102"></a>01102       <a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(<a class="code" href="classNavier__Stokes__std.html#a65ad55520bdc8a52dd452c24574a7b03">matrice_pression_</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(),secmem,lagrange);
<a name="l01103"></a>01103       <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classAssembleur.html#ac7b804a7151f761f15395e67aa8fd024" title="Appel a l&#39;objet sous-jacent. Permet de modifier la pression.">modifier_solution</a>(lagrange);
<a name="l01104"></a>01104       lagrange.echange_espace_virtuel();
<a name="l01105"></a>01105       <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() == <span class="stringliteral">&quot;PolyMAC&quot;</span>) <span class="comment">//en PolyMAC, on a deja les vitesses</span>
<a name="l01106"></a>01106         lagrange *= -dt, <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classDeriv__Assembleur__base.html#ac0c74810fc600fc5053e645bf19d4ece">valeur</a>().<a class="code" href="classAssembleur__base.html#a545320f11a7a922a722a5be44ac16e96">corriger_vitesses</a>(lagrange, tab_vitesse);
<a name="l01107"></a>01107       <span class="keywordflow">else</span>
<a name="l01108"></a>01108         {
<a name="l01109"></a>01109 <span class="comment">// M-1 Bt l</span>
<a name="l01110"></a>01110           <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>-&gt;multvect(lagrange, gradP);
<a name="l01111"></a>01111           <span class="keywordflow">if</span> ((<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a> != -1) &amp;&amp; (<a class="code" href="classNavier__Stokes__std.html#a2731b349868649fd27e20b4517079c0a">correction_vitesse_projection_initiale_</a>==1))
<a name="l01112"></a>01112             {
<a name="l01113"></a>01113               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;(IBM) Immersed Interface: modified velocity corrector for initial projection.&quot;</span>&lt;&lt;finl;
<a name="l01114"></a>01114               gradP /= <a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a>;
<a name="l01115"></a>01115             }
<a name="l01116"></a>01116           gradP.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01117"></a>01117 
<a name="l01118"></a>01118           <a class="code" href="classEquation__base.html#aaaf61d60cca8205d2490a023633cc7d4">solveur_masse</a>.<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(gradP);
<a name="l01119"></a>01119           gradP.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01120"></a>01120 
<a name="l01121"></a>01121           tab_vitesse.<a class="code" href="classDoubleVect.html#a4da8824015866b68783677b1e80f1f9a" title="x+=alpha*y">ajoute</a>(-dt,gradP);
<a name="l01122"></a>01122           tab_vitesse.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01123"></a>01123           <a class="code" href="classEquation__base.html#aaaf61d60cca8205d2490a023633cc7d4">solveur_masse</a>.<a class="code" href="classSolveur__Masse.html#a328dc53fbe227ba188eaf55cd98474b8">corriger_solution</a>(tab_vitesse, tab_vitesse);
<a name="l01124"></a>01124         }
<a name="l01125"></a>01125 
<a name="l01126"></a>01126       <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;Navier_Stokes_std::projeter, vitesse&quot;</span>, tab_vitesse);
<a name="l01127"></a>01127 
<a name="l01128"></a>01128 <span class="comment">// Verif ...</span>
<a name="l01129"></a>01129       <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur__Div.html#ad3dbe52ca9c4899797444afeb0fe4ef4" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(tab_vitesse, secmem);
<a name="l01130"></a>01130       secmem.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01131"></a>01131 
<a name="l01132"></a>01132       bilan=<a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(secmem);
<a name="l01133"></a>01133       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;Bilan de masse apres projection : &quot;</span> &lt;&lt; bilan &lt;&lt; finl;
<a name="l01134"></a>01134       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;-------------  Projection  OK---------------&quot;</span> &lt;&lt; finl;
<a name="l01135"></a>01135       <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a> &lt;&lt; <span class="stringliteral">&quot;--------------------------------------------&quot;</span> &lt;&lt; finl;
<a name="l01136"></a>01136 
<a name="l01137"></a>01137       <span class="keywordflow">if</span>( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classsolv__iteratif.html">solv_iteratif</a>,<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>()) )
<a name="l01138"></a>01138         {
<a name="l01139"></a>01139           <a class="code" href="classsolv__iteratif.html">solv_iteratif</a>&amp; solv_iter=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classsolv__iteratif.html">solv_iteratif</a>,<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>());
<a name="l01140"></a>01140           solv_iter.<a class="code" href="classsolv__iteratif.html#a8f895c998d8b0548468b12c4cd908b2d">set_seuil</a>(normal_seuil);
<a name="l01141"></a>01141         }
<a name="l01142"></a>01142       <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur__Div.html#ad3dbe52ca9c4899797444afeb0fe4ef4" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(),<a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01143"></a>01143       <a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>()=0.;  <span class="comment">//!&lt; on remet les bons flux bords</span>
<a name="l01144"></a>01144 <span class="comment"></span>
<a name="l01145"></a>01145     }
<a name="l01146"></a>01146   <a class="code" href="classNavier__Stokes__std.html#a7e3bbcec7e27b0a5a9db865711bea9ee">projection_initiale</a> = 0;
<a name="l01147"></a>01147 }
<a name="l01148"></a>01148 
<a name="l01149"></a><a class="code" href="classNavier__Stokes__std.html#ab819cfb138ceeb57e6d8b18143260caf">01149</a> <span class="keywordtype">int</span> <a class="code" href="classNavier__Stokes__std.html#ab819cfb138ceeb57e6d8b18143260caf">Navier_Stokes_std::projection_a_faire</a>()
<a name="l01150"></a>01150 {
<a name="l01151"></a>01151 <span class="comment">// Pas de projection si l&#39;equation n&#39;est pas resolue</span>
<a name="l01152"></a>01152 <span class="comment">// if (equation_non_resolue()) return 0;</span>
<a name="l01153"></a>01153 
<a name="l01154"></a>01154   <span class="keywordtype">double</span> temps = <a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;temps_courant()+<a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;pas_de_temps();
<a name="l01155"></a>01155 <span class="comment">// Voir Schema_Temps_base::limpr pour information sur modf</span>
<a name="l01156"></a>01156   <span class="keywordtype">double</span> nb_proj_int;
<a name="l01157"></a>01157   modf(temps/<a class="code" href="classNavier__Stokes__std.html#af9c35ba318c93f61c8c4afcec827fe2b">dt_projection</a>, &amp;nb_proj_int);
<a name="l01158"></a>01158   <span class="keyword">static</span> <span class="keywordtype">double</span> nb_proj = nb_proj_int;
<a name="l01159"></a>01159   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#a7e3bbcec7e27b0a5a9db865711bea9ee">projection_initiale</a>)
<a name="l01160"></a>01160     <span class="keywordflow">return</span> 1;
<a name="l01161"></a>01161   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#a5901bfb1e96e24490e63ba2521a9cb13">inf_ou_egal</a>((nb_proj+1.)*<a class="code" href="classNavier__Stokes__std.html#af9c35ba318c93f61c8c4afcec827fe2b">dt_projection</a>,temps))
<a name="l01162"></a>01162     {
<a name="l01163"></a>01163       nb_proj=nb_proj+1.;
<a name="l01164"></a>01164       <span class="keywordflow">return</span> 1;
<a name="l01165"></a>01165     }
<a name="l01166"></a>01166   <span class="keywordflow">return</span> 0;
<a name="l01167"></a>01167 }
<a name="l01168"></a>01168 
<a name="l01169"></a>01169 <span class="comment">// Precondition:</span>
<a name="l01170"></a>01170 <span class="comment">// Parametre:</span>
<a name="l01171"></a>01171 <span class="comment">// Signification:</span>
<a name="l01172"></a>01172 <span class="comment">// Valeurs par defaut:</span>
<a name="l01173"></a>01173 <span class="comment">// Contraintes:</span>
<a name="l01174"></a>01174 <span class="comment">// Acces:</span>
<a name="l01175"></a>01175 <span class="comment">// Exception:</span>
<a name="l01176"></a>01176 <span class="comment">// Effets de bord:</span>
<a name="l01177"></a>01177 <span class="comment">// Postcondition:</span>
<a name="l01178"></a>01178 <span class="comment">//</span>
<a name="l01179"></a>01179 <span class="comment">//</span>
<a name="l01180"></a>01180 <span class="comment">//</span><span class="comment"></span>
<a name="l01181"></a>01181 <span class="comment">//! cf Equation_base::preparer_calcul()&lt;br&gt;Assemblage du solveur pression et&lt;br&gt;initialisation de la pression.</span>
<a name="l01182"></a>01182 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l01183"></a>01183 <span class="comment">Signification: renvoie toujours 1&lt;br&gt;</span>
<a name="l01184"></a>01184 <span class="comment">Contraintes: */</span>
<a name="l01185"></a><a class="code" href="classNavier__Stokes__std.html#ac215bfec4ede646e4f45e61b0bf73a18">01185</a> <span class="keywordtype">int</span> <a class="code" href="classNavier__Stokes__std.html#ac215bfec4ede646e4f45e61b0bf73a18" title="cf Equation_base::preparer_calcul() Assemblage du solveur pression et initialisation de la pression...">Navier_Stokes_std::preparer_calcul</a>()
<a name="l01186"></a>01186 <span class="comment">// assemblage du systeme en pression</span>
<a name="l01187"></a>01187 {
<a name="l01188"></a>01188   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Navier_Stokes_std::preparer_calcul()&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01189"></a>01189   <span class="keyword">const</span> <span class="keywordtype">double</span> temps = <a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>();
<a name="l01190"></a>01190   <a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>().<a class="code" href="classSources.html#aa993ae270b7536a4d1a321899b905bf8" title="Mise a jour en temps, de toute les sources de la liste.">mettre_a_jour</a>(temps);
<a name="l01191"></a>01191   <a class="code" href="classNavier__Stokes__std.html#ac215bfec4ede646e4f45e61b0bf73a18" title="cf Equation_base::preparer_calcul() Assemblage du solveur pression et initialisation de la pression...">Equation_base::preparer_calcul</a>();
<a name="l01192"></a>01192   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_eq=<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
<a name="l01193"></a>01193   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_eq2(nom_eq);
<a name="l01194"></a>01194   nom_eq2.<a class="code" href="classNom.html#aa296fc70f7abcf978968e09582d8fb06">prefix</a>(<span class="stringliteral">&quot;_QC&quot;</span>);
<a name="l01195"></a>01195 
<a name="l01196"></a>01196   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a> != -1)
<a name="l01197"></a>01197     {
<a name="l01198"></a>01198       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;(IBM) Immersed Interface: compute pressure matrix coefficients.&quot;</span>&lt;&lt;finl;
<a name="l01199"></a>01199       <a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>&amp; src = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>&amp;<span class="keyword">&gt;</span>((<a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>())[<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a>].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l01200"></a>01200       src.<a class="code" href="classSource__PDF__base.html#ac0eba76dc8d8fe2a40cb62617ea42115">updateChampRho</a>();
<a name="l01201"></a>01201 <span class="comment">// if (src.getInterpolationBool())</span>
<a name="l01202"></a>01202 <span class="comment">// {</span>
<a name="l01203"></a>01203 <span class="comment">// src.calculer_vitesse_imposee();</span>
<a name="l01204"></a>01204 <span class="comment">// }</span>
<a name="l01205"></a>01205       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
<a name="l01206"></a>01206       coeff = src.<a class="code" href="classSource__PDF__base.html#a9aeeb6642d74622b0d03ba1b7268fe4d">compute_coeff_matrice_pression</a>();
<a name="l01207"></a>01207       coeff.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01208"></a>01208 <span class="comment">// Cerr&lt;&lt;&quot;Min/max : &quot;&lt;&lt; mp_min_vect(coeff) &lt;&lt; &quot; &quot; &lt;&lt; mp_max_vect(coeff) &lt;&lt;finl;</span>
<a name="l01209"></a>01209       <a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a> = <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>;
<a name="l01210"></a>01210       <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#ad14f58cd42e2a5a8631b8c7181630184">correction_matrice_projection_initiale_</a>==1)
<a name="l01211"></a>01211         {
<a name="l01212"></a>01212           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;(IBM) Immersed Interface: modified pressure matrix for initial projection.&quot;</span>&lt;&lt;finl;
<a name="l01213"></a>01213           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> inv_coeff(<a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a>);
<a name="l01214"></a>01214           inv_coeff = 1. ;
<a name="l01215"></a>01215           inv_coeff *= <a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a>;
<a name="l01216"></a>01216           src.<a class="code" href="classSource__PDF__base.html#a4c614b6e1b86ff096379db1be4d155ef">multiply_coeff_volume</a>(inv_coeff);
<a name="l01217"></a>01217           inv_coeff.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01218"></a>01218           <a class="code" href="classNavier__Stokes__std.html#af9f5e0396945755597f147bd424a4a08">assembleur_pression</a>().<a class="code" href="classDeriv__Assembleur__base.html#ac0c74810fc600fc5053e645bf19d4ece">valeur</a>().<a class="code" href="classAssembleur__base.html#a0710705cb88b7db3620b993a2cb31e05">assembler_mat</a>(<a class="code" href="classNavier__Stokes__std.html#a65ad55520bdc8a52dd452c24574a7b03">matrice_pression_</a>,inv_coeff,1,1);
<a name="l01219"></a>01219         }
<a name="l01220"></a>01220       <span class="keywordflow">else</span>
<a name="l01221"></a>01221         {
<a name="l01222"></a>01222           <span class="keywordflow">if</span> ((nom_eq2==nom_eq))
<a name="l01223"></a>01223             {
<a name="l01224"></a>01224               <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classAssembleur.html#afdab75003f47baf9c5c509edda4916e9" title="Appel a l&#39;objet sous-jacent. Permet d&#39;assembler le systeme.">assembler</a>(<a class="code" href="classNavier__Stokes__std.html#a65ad55520bdc8a52dd452c24574a7b03">matrice_pression_</a>);
<a name="l01225"></a>01225             }
<a name="l01226"></a>01226           <span class="keywordflow">else</span>
<a name="l01227"></a>01227             {
<a name="l01228"></a>01228               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Assembling for quasi-compressible&quot;</span>&lt;&lt;finl;
<a name="l01229"></a>01229               <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classAssembleur.html#a5b4633872b02d6baa6520083c032b2bf" title="Appel a l&#39;objet sous-jacent. Permet d&#39;assembler le systeme.">assembler_QC</a>(<a class="code" href="classNavier__Stokes__std.html#ad9aa0a7593fc4cc74b362ce25f1b2d61">le_fluide</a>-&gt;masse_volumique().valeurs(),<a class="code" href="classNavier__Stokes__std.html#a65ad55520bdc8a52dd452c24574a7b03">matrice_pression_</a>);
<a name="l01230"></a>01230             }
<a name="l01231"></a>01231         }
<a name="l01232"></a>01232     }
<a name="l01233"></a>01233   <span class="keywordflow">else</span>
<a name="l01234"></a>01234     {
<a name="l01235"></a>01235       <span class="keywordflow">if</span> ((nom_eq2==nom_eq))
<a name="l01236"></a>01236         {
<a name="l01237"></a>01237           <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classAssembleur.html#afdab75003f47baf9c5c509edda4916e9" title="Appel a l&#39;objet sous-jacent. Permet d&#39;assembler le systeme.">assembler</a>(<a class="code" href="classNavier__Stokes__std.html#a65ad55520bdc8a52dd452c24574a7b03">matrice_pression_</a>);
<a name="l01238"></a>01238         }
<a name="l01239"></a>01239       <span class="keywordflow">else</span>
<a name="l01240"></a>01240         {
<a name="l01241"></a>01241           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Assembling for quasi-compressible&quot;</span>&lt;&lt;finl;
<a name="l01242"></a>01242           <a class="code" href="classNavier__Stokes__std.html#abe7328f5584e0df4da2a8a77dfd9854e">assembleur_pression_</a>.<a class="code" href="classAssembleur.html#a5b4633872b02d6baa6520083c032b2bf" title="Appel a l&#39;objet sous-jacent. Permet d&#39;assembler le systeme.">assembler_QC</a>(<a class="code" href="classNavier__Stokes__std.html#ad9aa0a7593fc4cc74b362ce25f1b2d61">le_fluide</a>-&gt;masse_volumique().valeurs(),<a class="code" href="classNavier__Stokes__std.html#a65ad55520bdc8a52dd452c24574a7b03">matrice_pression_</a>);
<a name="l01243"></a>01243         }
<a name="l01244"></a>01244     }
<a name="l01245"></a>01245 
<a name="l01246"></a>01246 <span class="comment">// GF en cas de reprise on conserve la valeur de la pression</span>
<a name="l01247"></a>01247 <span class="comment">// avant elle ne servait qu&#39; a initialiser le lagrange pour la projection</span>
<a name="l01248"></a>01248 <span class="comment">// C&#39;est important pour le Simpler/Piso de bien repartir de la pression</span>
<a name="l01249"></a>01249 <span class="comment">// sauvegardee...</span>
<a name="l01250"></a>01250 <span class="comment">// la_pression.valeurs()=0.;</span>
<a name="l01251"></a>01251   <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a6494d54f7acebf6bd446c7e8ecaf8e21" title="Appel a l&#39;objet sous-jacent Fixe le temps courant.">changer_temps</a>(temps);
<a name="l01252"></a>01252 <span class="comment">// Calcul du gradient et mise au meme temps que la pression</span>
<a name="l01253"></a>01253   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur__Grad.html#a179b2f08f6907e9b69fa715cfb98fa81" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(), <a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01254"></a>01254   <a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a6494d54f7acebf6bd446c7e8ecaf8e21" title="Appel a l&#39;objet sous-jacent Fixe le temps courant.">changer_temps</a>(temps);
<a name="l01255"></a>01255 
<a name="l01256"></a>01256 
<a name="l01257"></a>01257   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;Navier_Stokes_std::preparer_calcul, la_pression av projeter&quot;</span>, <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01258"></a>01258   <span class="keywordtype">int</span> proj_fait=0;
<a name="l01259"></a>01259   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#ab819cfb138ceeb57e6d8b18143260caf">projection_a_faire</a>())
<a name="l01260"></a>01260     {
<a name="l01261"></a>01261       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Projection of initial and boundaries conditions &quot;</span> &lt;&lt; finl;
<a name="l01262"></a>01262       <a class="code" href="classNavier__Stokes__std.html#a5750f93d713b5094138e41c9d81bedb7" title="Calcule la solution U des equations: | M(U-V)/dt + BtP = 0 |-BU=0 On resoud le probleme en pression: ...">projeter</a>();
<a name="l01263"></a>01263       proj_fait=1;
<a name="l01264"></a>01264     }
<a name="l01265"></a>01265   <span class="keywordflow">else</span>
<a name="l01266"></a>01266     {
<a name="l01267"></a>01267       <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur__Div.html#ad3dbe52ca9c4899797444afeb0fe4ef4" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(),<a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01268"></a>01268       <a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>()=0.;  <span class="comment">//!&lt; on remet les bons flux bords</span>
<a name="l01269"></a>01269 <span class="comment"></span>    }
<a name="l01270"></a>01270   <a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#a6494d54f7acebf6bd446c7e8ecaf8e21" title="Appel a l&#39;objet sous-jacent Fixe le temps courant.">changer_temps</a>(temps);
<a name="l01271"></a>01271 
<a name="l01272"></a>01272 
<a name="l01273"></a>01273 <span class="comment">// Au cas ou une cl de pression depend de u que l&#39;on vient de modifier</span>
<a name="l01274"></a>01274   <a class="code" href="classEquation__base.html#aa097c6ddc00bdb913c39739689f6d5c4">la_zone_Cl_dis</a>-&gt;<a class="code" href="classZone__Cl__dis.html#a241a6b48ebc8b6767013dee04c429719" title="Appel a l&#39;objet sous-jacent Effectue une mise a jour en temps des conditions aux limites.">mettre_a_jour</a>(temps);
<a name="l01275"></a>01275   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur__Grad.html#a179b2f08f6907e9b69fa715cfb98fa81" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(), <a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01276"></a>01276 
<a name="l01277"></a>01277   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;Navier_Stokes_std::preparer_calcul, la_pression ap projeter&quot;</span>, <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01278"></a>01278 
<a name="l01279"></a>01279 <span class="comment">// Initialisation du champ de pression (resolution de Laplacien(P)=0 avec les conditions limites en pression)</span>
<a name="l01280"></a>01280 <span class="comment">// Permet de demarrer la resolution avec une bonne approximation de la pression (important pour le Piso ou P!=0)</span>
<a name="l01281"></a>01281 
<a name="l01282"></a>01282   <span class="keywordflow">if</span>  (<a class="code" href="classNavier__Stokes__std.html#af841545a0b6ccfcbd117ae9af74c175f">methode_calcul_pression_initiale_</a>!=3)
<a name="l01283"></a>01283     <span class="keywordflow">if</span> (!<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#acafc48b3c050d6c292bb8395a7904a33">reprise_effectuee</a>())
<a name="l01284"></a>01284       {
<a name="l01285"></a>01285         <a class="code" href="EntreeSortie_8h.html#a1007c2f57f1c8fc7334a3f62aab08414">Cout</a>&lt;&lt;<span class="stringliteral">&quot;Estimation du champ de pression au demarrage:&quot;</span> &lt;&lt;finl;
<a name="l01286"></a>01286 
<a name="l01287"></a>01287         <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> secmem(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01288"></a>01288         <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> vpoint(<a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01289"></a>01289         vpoint-=<a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l01290"></a>01290         <span class="keywordflow">if</span> ((<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a> != -1) &amp;&amp; ((<a class="code" href="classNavier__Stokes__std.html#ad14f58cd42e2a5a8631b8c7181630184">correction_matrice_projection_initiale_</a>==1)||(<a class="code" href="classNavier__Stokes__std.html#aa82c5d9c34a459ed915e4d448aadeca8">matrice_pression_penalisee_H1_</a>==1)))
<a name="l01291"></a>01291           {
<a name="l01292"></a>01292 <span class="comment">// Source_PDF&amp; src = ref_cast(Source_PDF, (sources())[i_source_pdf_].valeur());</span>
<a name="l01293"></a>01293 <span class="comment">// if (src.getInterpolationBool())</span>
<a name="l01294"></a>01294 <span class="comment">// {</span>
<a name="l01295"></a>01295 <span class="comment">// src.calculer_vitesse_imposee();</span>
<a name="l01296"></a>01296 <span class="comment">// }</span>
<a name="l01297"></a>01297             <span class="keywordflow">if</span> ((<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a> != -1)&amp;&amp;(((<a class="code" href="classNavier__Stokes__std.html#ad14f58cd42e2a5a8631b8c7181630184">correction_matrice_projection_initiale_</a>==1)||(<a class="code" href="classNavier__Stokes__std.html#aa82c5d9c34a459ed915e4d448aadeca8">matrice_pression_penalisee_H1_</a>==1))))
<a name="l01298"></a>01298               {
<a name="l01299"></a>01299                 <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;(IBM) Immersed Interface: modified pressure gradient for initial pressure computation.&quot;</span>&lt;&lt;finl;
<a name="l01300"></a>01300                 vpoint/=<a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a>;
<a name="l01301"></a>01301               }
<a name="l01302"></a>01302           }
<a name="l01303"></a>01303         <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#af841545a0b6ccfcbd117ae9af74c175f">methode_calcul_pression_initiale_</a>&gt;=2)
<a name="l01304"></a>01304           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> op=0; op&lt;<a class="code" href="classNavier__Stokes__std.html#ac7db452db8cfdb5f15bf971a47df82f1" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: Pour Navier Stokes Standard c&#39;est 2.">nombre_d_operateurs</a>(); op++)
<a name="l01305"></a>01305             <a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df" title="Renvoie le i-eme operateur de l&#39;equation: - le terme_diffusif si i = 0 - le terme_convectif si i = 1 ...">operateur</a>(op).<a class="code" href="classOperateur.html#accdf61cf1e33fb42e9eb06f1c501422b">ajouter</a>(vpoint);
<a name="l01306"></a>01306         <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#af841545a0b6ccfcbd117ae9af74c175f">methode_calcul_pression_initiale_</a>&gt;=1)
<a name="l01307"></a>01307           {
<a name="l01308"></a>01308             <span class="keywordtype">int</span> mod=0;
<a name="l01309"></a>01309             <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;pas_de_temps()==0)
<a name="l01310"></a>01310               {
<a name="l01311"></a>01311                 <span class="keywordtype">double</span> dt = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(<a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;pas_temps_min(),<a class="code" href="classEquation__base.html#a5b0b97f18ca64a6f26e984e25c944ee1" title="Calcul du prochain pas de temps. Renvoie l&#39;inverse de la somme des inverses des pas de temps calcules...">calculer_pas_de_temps</a>());
<a name="l01312"></a>01312                 dt = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(dt, <a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;pas_temps_max());
<a name="l01313"></a>01313                 <a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;set_dt()=(dt);
<a name="l01314"></a>01314                 mod=1;
<a name="l01315"></a>01315               }
<a name="l01316"></a>01316             <a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>().<a class="code" href="classSources.html#a6fc277f1920a71841cb041dc1b6ed771" title="Ajoute la contribution de toutes les sources de la liste au tableau passe en parametre, et renvoie ce tableau.">ajouter</a>(vpoint);
<a name="l01317"></a>01317 <span class="comment">// &lt;IBM&gt; Taking into account potential Source_PDF term for Immersed Boundary Method</span>
<a name="l01318"></a>01318             <span class="keywordflow">if</span> ((<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a> != -1) &amp;&amp; ((<a class="code" href="classNavier__Stokes__std.html#ad14f58cd42e2a5a8631b8c7181630184">correction_matrice_projection_initiale_</a>==1)||(<a class="code" href="classNavier__Stokes__std.html#aa82c5d9c34a459ed915e4d448aadeca8">matrice_pression_penalisee_H1_</a>==1)) &amp;&amp; proj_fait)
<a name="l01319"></a>01319               {
<a name="l01320"></a>01320                 <span class="keyword">const</span> <a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>&amp; src = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>&amp;<span class="keyword">&gt;</span>((<a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>())[<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a>].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l01321"></a>01321                 <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;Immersed Interface: Dirichlet velocity in initial pressure computation for PDF (if any).&quot;</span>&lt;&lt;finl;
<a name="l01322"></a>01322                 <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> secmem_pdf(vpoint);
<a name="l01323"></a>01323                 src.<a class="code" href="classSource__PDF__base.html#a91f70302fead64b75f850d113836b257">calculer_pdf</a>(secmem_pdf);
<a name="l01324"></a>01324                 vpoint -= secmem_pdf;
<a name="l01325"></a>01325                 vpoint.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01326"></a>01326               }
<a name="l01327"></a>01327 <span class="comment">// &lt;/IBM&gt;</span>
<a name="l01328"></a>01328             <span class="keywordflow">if</span> (mod)
<a name="l01329"></a>01329               <a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;set_dt()=0;
<a name="l01330"></a>01330           }
<a name="l01331"></a>01331         <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() == <span class="stringliteral">&quot;PolyMAC&quot;</span>) <span class="comment">//PolyMAC -&gt; pas vraiment faisable</span>
<a name="l01332"></a>01332           {
<a name="l01333"></a>01333             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Not done with PolyMAC !&quot;</span> &lt;&lt; finl;
<a name="l01334"></a>01334           }
<a name="l01335"></a>01335         <span class="keywordflow">else</span>
<a name="l01336"></a>01336           {
<a name="l01337"></a>01337             <a class="code" href="classEquation__base.html#aaaf61d60cca8205d2490a023633cc7d4">solveur_masse</a>.<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(vpoint);
<a name="l01338"></a>01338             vpoint.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01339"></a>01339             <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur__Div.html#ad3dbe52ca9c4899797444afeb0fe4ef4" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(vpoint, secmem);
<a name="l01340"></a>01340             secmem*=-1;
<a name="l01341"></a>01341             secmem.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01342"></a>01342 
<a name="l01343"></a>01343             <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> inc_pre(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01344"></a>01344             <a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(<a class="code" href="classNavier__Stokes__std.html#a65ad55520bdc8a52dd452c24574a7b03">matrice_pression_</a>.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>(),secmem, inc_pre);
<a name="l01345"></a>01345 <span class="comment">// &lt;IBM&gt; Correction of pressure for Immersed Boundary Method</span>
<a name="l01346"></a>01346             <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Pressure increment computed successfully&quot;</span> &lt;&lt; finl;
<a name="l01347"></a>01347             <span class="keywordflow">if</span> ((<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a> != -1) &amp;&amp; (<a class="code" href="classNavier__Stokes__std.html#a754b63d4c4a12da049992901506b3f60">correction_calcul_pression_initiale_</a> == 1))
<a name="l01348"></a>01348               {
<a name="l01349"></a>01349                 <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;(IBM) Immersed Interface: correction of initial pressure.&quot;</span>&lt;&lt;finl;
<a name="l01350"></a>01350                 <span class="keyword">const</span> <a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>&amp; src = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>&amp;<span class="keyword">&gt;</span>((<a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>())[<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a>].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l01351"></a>01351                 src.<a class="code" href="classSource__PDF__base.html#a6c51c646a6632cdd8402aa7ef1278d4b">correct_incr_pressure</a>(<a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a>, inc_pre);
<a name="l01352"></a>01352                 inc_pre.echange_espace_virtuel();
<a name="l01353"></a>01353               }
<a name="l01354"></a>01354 <span class="comment">// &lt;/IBM&gt;</span>
<a name="l01355"></a>01355 <span class="comment">// On veut que l&#39;espace virtuel soit a jour, donc all_items</span>
<a name="l01356"></a>01356             <a class="code" href="DoubleVect_8cpp.html#a9dd7edead35e9d46fc6c8960f33e668a">operator_add</a>(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(), inc_pre, <a class="code" href="MD__Vector_8h.html#a3616a15fe105ad6150819554ee8b11caad18680091a9f62247573cb3caa6450b9">VECT_ALL_ITEMS</a>);
<a name="l01357"></a>01357           }
<a name="l01358"></a>01358 
<a name="l01359"></a>01359         <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur__Grad.html#a179b2f08f6907e9b69fa715cfb98fa81" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(),<a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01360"></a>01360         <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur__Div.html#ad3dbe52ca9c4899797444afeb0fe4ef4" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(),<a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01361"></a>01361         <a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>()=0.;  <span class="comment">//!&lt; on remet les bons flux bords pour div</span>
<a name="l01362"></a>01362 <span class="comment"></span>      }
<a name="l01363"></a>01363   <a class="code" href="classNavier__Stokes__std.html#aef9f0339909c31f6b1b9bab3c7d470a5" title="Calcul de &quot;la_pression_en_pa&quot; en fonction de &quot;la_pression&quot;. Si le champ milieu().masse_volumique() es...">calculer_la_pression_en_pa</a>();
<a name="l01364"></a>01364 
<a name="l01365"></a>01365 
<a name="l01366"></a>01366   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01367"></a>01367     <a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classTraitement__particulier__NS.html#a2499f23217bd4b1dfc30a1320915f404">preparer_calcul_particulier</a>();
<a name="l01368"></a>01368 
<a name="l01369"></a>01369   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;Navier_Stokes_std::preparer_calcul, vitesse&quot;</span>, <a class="code" href="classNavier__Stokes__std.html#a743b777e6185faee7837326844c8fca1" title="Renvoie la vitesse (champ inconnue de l&#39;equation) (version const)">inconnue</a>());
<a name="l01370"></a>01370   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;Navier_Stokes_std::preparer_calcul, pression&quot;</span>, <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>);
<a name="l01371"></a>01371 
<a name="l01372"></a>01372 <span class="comment">// &lt;IBM&gt; Immersed Boundary Method</span>
<a name="l01373"></a>01373   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a> != -1)
<a name="l01374"></a>01374     {
<a name="l01375"></a>01375       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a>(<a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a>);
<a name="l01376"></a>01376       coeff = 1.;
<a name="l01377"></a>01377       <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#aa82c5d9c34a459ed915e4d448aadeca8">matrice_pression_penalisee_H1_</a>==1)
<a name="l01378"></a>01378         {
<a name="l01379"></a>01379           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;(IBM) Immersed Interface: H1 penalty of pressure matrix.&quot;</span>&lt;&lt;finl;
<a name="l01380"></a>01380           coeff /= <a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a>;
<a name="l01381"></a>01381         }
<a name="l01382"></a>01382       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#a5f86768d882558420477430db7ca1293">correction_matrice_pression_</a>==1)
<a name="l01383"></a>01383         {
<a name="l01384"></a>01384           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;(IBM) Immersed Interface: modification of pressure matrix.&quot;</span>&lt;&lt;finl;
<a name="l01385"></a>01385           coeff *= <a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a>;
<a name="l01386"></a>01386 <span class="comment">// Cerr&lt;&lt;&quot;Min/max of coefficients: &quot;&lt;&lt; mp_min_vect(champ_coeff_pdf_som_) &lt;&lt; &quot; &quot; &lt;&lt; mp_max_vect(champ_coeff_pdf_som_) &lt;&lt;finl;</span>
<a name="l01387"></a>01387         }
<a name="l01388"></a>01388       <span class="keyword">const</span> <a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>&amp; src = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>&amp;<span class="keyword">&gt;</span>((<a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>())[<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a>].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l01389"></a>01389       src.<a class="code" href="classSource__PDF__base.html#a4c614b6e1b86ff096379db1be4d155ef">multiply_coeff_volume</a>(coeff);
<a name="l01390"></a>01390       coeff.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01391"></a>01391       <a class="code" href="classNavier__Stokes__std.html#af9f5e0396945755597f147bd424a4a08">assembleur_pression</a>().<a class="code" href="classDeriv__Assembleur__base.html#ac0c74810fc600fc5053e645bf19d4ece">valeur</a>().<a class="code" href="classAssembleur__base.html#a0710705cb88b7db3620b993a2cb31e05">assembler_mat</a>(<a class="code" href="classNavier__Stokes__std.html#a65ad55520bdc8a52dd452c24574a7b03">matrice_pression_</a>,coeff,1,1);
<a name="l01392"></a>01392     }
<a name="l01393"></a>01393 <span class="comment">// &lt;/IBM&gt;</span>
<a name="l01394"></a>01394 
<a name="l01395"></a>01395   <span class="keywordflow">return</span> 1;
<a name="l01396"></a>01396 }
<a name="l01397"></a>01397 
<a name="l01398"></a>01398 <span class="comment">// Precondition:</span>
<a name="l01399"></a>01399 <span class="comment">// Parametre: double temps</span>
<a name="l01400"></a>01400 <span class="comment">// Signification: le temps de mise a jour</span>
<a name="l01401"></a>01401 <span class="comment">// Valeurs par defaut:</span>
<a name="l01402"></a>01402 <span class="comment">// Contraintes:</span>
<a name="l01403"></a>01403 <span class="comment">// Acces:</span>
<a name="l01404"></a>01404 <span class="comment">// </span>
<a name="l01405"></a>01405 <span class="comment">// Signification:</span>
<a name="l01406"></a>01406 <span class="comment">// Contraintes:</span>
<a name="l01407"></a>01407 <span class="comment">// Exception:</span>
<a name="l01408"></a>01408 <span class="comment">// Effets de bord:</span>
<a name="l01409"></a>01409 <span class="comment">// Postcondition:</span>
<a name="l01410"></a>01410 <span class="comment">//</span>
<a name="l01411"></a>01411 <span class="comment">//</span>
<a name="l01412"></a>01412 <span class="comment">//</span>
<a name="l01413"></a>01413 <span class="comment">//</span>
<a name="l01414"></a>01414 <span class="comment">//</span><span class="comment"></span>
<a name="l01415"></a>01415 <span class="comment">//! Effectue une mise a jour en temps de l&#39;equation.&lt;br&gt;Appelle Equation_base::mettre_a_jour(double)&lt;br&gt;et met a jour la pression.&lt;br&gt;Integration des points suivis si le fluide est marque&lt;br&gt;Mise a jour du champ postraitable correspondant</span>
<a name="l01416"></a><a class="code" href="classNavier__Stokes__std.html#a217c7e80c17cb8c15a69f823309131bd">01416</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#a217c7e80c17cb8c15a69f823309131bd" title="Effectue une mise a jour en temps de l&#39;equation. Appelle Equation_base::mettre_a_jour(double) et met ...">Navier_Stokes_std::mettre_a_jour</a>(<span class="keywordtype">double</span> temps)
<a name="l01417"></a>01417 {
<a name="l01418"></a>01418 <span class="comment">// Mise a jour de la classe mere (on tourne la roue).</span>
<a name="l01419"></a>01419   <a class="code" href="classNavier__Stokes__std.html#a217c7e80c17cb8c15a69f823309131bd" title="Effectue une mise a jour en temps de l&#39;equation. Appelle Equation_base::mettre_a_jour(double) et met ...">Equation_base::mettre_a_jour</a>(temps);
<a name="l01420"></a>01420 
<a name="l01421"></a>01421 <span class="comment">// Mise a jour de la pression</span>
<a name="l01422"></a>01422   <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#aa18fe93c1bb1b1131f31e7ab89da1d02">mettre_a_jour</a>(temps);
<a name="l01423"></a>01423 
<a name="l01424"></a>01424 <span class="comment">// Update the divergence of the velocity div(U)</span>
<a name="l01425"></a>01425   <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur__Div.html#ad3dbe52ca9c4899797444afeb0fe4ef4" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(),<a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01426"></a>01426   <a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#aa18fe93c1bb1b1131f31e7ab89da1d02">mettre_a_jour</a>(temps);
<a name="l01427"></a>01427 
<a name="l01428"></a>01428 <span class="comment">// Update the pressure field in Pascal</span>
<a name="l01429"></a>01429   <a class="code" href="classNavier__Stokes__std.html#aef9f0339909c31f6b1b9bab3c7d470a5" title="Calcul de &quot;la_pression_en_pa&quot; en fonction de &quot;la_pression&quot;. Si le champ milieu().masse_volumique() es...">calculer_la_pression_en_pa</a>();
<a name="l01430"></a>01430   <a class="code" href="classNavier__Stokes__std.html#a5b5b3a99c0ffa104a77774fd5f30944d">la_pression_en_pa</a>.<a class="code" href="classChamp__Inc.html#aa18fe93c1bb1b1131f31e7ab89da1d02">mettre_a_jour</a>(temps);
<a name="l01431"></a>01431 
<a name="l01432"></a>01432 <span class="comment">// Pour le postraitement, on veut M-1BtP et non BtP</span>
<a name="l01433"></a>01433   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#afda7801637a0d464a8c254808bfae4e8">postraitement_gradient_P_</a>)
<a name="l01434"></a>01434     {
<a name="l01435"></a>01435       <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur__Grad.html#a179b2f08f6907e9b69fa715cfb98fa81" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(), <a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01436"></a>01436       <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#a860d58250e340bc1aa44f4469df82320">postraiter_gradient_pression_sans_masse_</a>)
<a name="l01437"></a>01437         {
<a name="l01438"></a>01438           <a class="code" href="classEquation__base.html#aaaf61d60cca8205d2490a023633cc7d4">solveur_masse</a>.<a class="code" href="classSolveur__Masse.html#af7afe8c2d4d5764f7428f2cd4ef43ddb" title="Appel a l&#39;objet sous-jacent. Resoud le systeme lineaire, dont la matrice est la matrice de masse...">appliquer</a>(<a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01439"></a>01439         }
<a name="l01440"></a>01440     }
<a name="l01441"></a>01441   <a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#aa18fe93c1bb1b1131f31e7ab89da1d02">mettre_a_jour</a>(temps);
<a name="l01442"></a>01442 
<a name="l01443"></a>01443 <span class="comment">// Estimation of a flow rate relative error</span>
<a name="l01444"></a>01444   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> array(<a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>()); <span class="comment">//!&lt; array(i)=sum(u.ndS)</span>
<a name="l01445"></a>01445 <span class="comment"></span>  <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur__Div.html#ad960676e405c7d46000efccf9fa062b4" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">volumique</a>(array); <span class="comment">//!&lt; array(i)=sum(u.ndS)/vol(i)</span>
<a name="l01446"></a>01446 <span class="comment"></span>  <span class="keywordtype">double</span> dt = <a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l01447"></a>01447   <a class="code" href="classNavier__Stokes__std.html#a9ffae36bff4d5c71d667a48c2abe36a0">LocalFlowRateRelativeError_</a> = <a class="code" href="DoubleVect_8cpp.html#acb21ec8c0b3909c26b20e3f3455e0289">mp_max_abs_vect</a>(array) * dt; <span class="comment">//!&lt; =max|sum(u.ndS)/(vol(i)/dt)|</span>
<a name="l01448"></a>01448 <span class="comment"></span>
<a name="l01449"></a>01449 <span class="comment">// PQ : 04/03 : procedure de determination dynamique du seuil de convergence en pression</span>
<a name="l01450"></a>01450   <span class="keywordflow">if</span>(<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classsolv__iteratif.html">solv_iteratif</a>,<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>()) &amp;&amp; <a class="code" href="classNavier__Stokes__std.html#af4b0fd768cdbc86d5649b7f058cd7cb8">seuil_divU</a> &lt; 1.)
<a name="l01451"></a>01451     {
<a name="l01452"></a>01452 <span class="comment">// Calcul dynamique d&#39;un seuil sur le solveur iteratif de pression</span>
<a name="l01453"></a>01453       <a class="code" href="classsolv__iteratif.html">solv_iteratif</a>&amp; solv_iter=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classsolv__iteratif.html">solv_iteratif</a>,<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>());
<a name="l01454"></a>01454       <span class="keywordtype">double</span> seuil_dyn=solv_iter.<a class="code" href="classsolv__iteratif.html#acb57780795c754663eb6974e123aec88">get_seuil</a>();
<a name="l01455"></a>01455 
<a name="l01456"></a>01456       <span class="keywordflow">if</span>(<a class="code" href="classNavier__Stokes__std.html#a9ffae36bff4d5c71d667a48c2abe36a0">LocalFlowRateRelativeError_</a>&lt;<a class="code" href="classNavier__Stokes__std.html#af4b0fd768cdbc86d5649b7f058cd7cb8">seuil_divU</a>)
<a name="l01457"></a>01457         seuil_dyn*=<a class="code" href="classNavier__Stokes__std.html#a124966ac3857a95f691710c74b95afdb">raison_seuil_divU</a>;
<a name="l01458"></a>01458       <span class="keywordflow">else</span>
<a name="l01459"></a>01459         seuil_dyn/=<a class="code" href="classNavier__Stokes__std.html#a124966ac3857a95f691710c74b95afdb">raison_seuil_divU</a>;
<a name="l01460"></a>01460       <span class="keywordtype">double</span> seuil_dyn_max = 1.e-10;
<a name="l01461"></a>01461       seuil_dyn=<a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(seuil_dyn,seuil_dyn_max);
<a name="l01462"></a>01462       solv_iter.<a class="code" href="classsolv__iteratif.html#a8f895c998d8b0548468b12c4cd908b2d">set_seuil</a>(seuil_dyn);
<a name="l01463"></a>01463     }
<a name="l01464"></a>01464 <span class="comment">// fin procedure de determination du seuil dynamique de convergence en pression</span>
<a name="l01465"></a>01465 
<a name="l01466"></a>01466   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#ab819cfb138ceeb57e6d8b18143260caf">projection_a_faire</a>())
<a name="l01467"></a>01467     <a class="code" href="classNavier__Stokes__std.html#a5750f93d713b5094138e41c9d81bedb7" title="Calcule la solution U des equations: | M(U-V)/dt + BtP = 0 |-BU=0 On resoud le probleme en pression: ...">projeter</a>();
<a name="l01468"></a>01468 
<a name="l01469"></a>01469   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01470"></a>01470     <a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classTraitement__particulier__NS.html#ace89184b8f9eef7f974f4da5f9f43e50">post_traitement_particulier</a>();
<a name="l01471"></a>01471   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;Navier_Stokes_std::mettre_a_jour : pression&quot;</span>,  <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01472"></a>01472   <a class="code" href="Op__Div__VEFP1B__Elem_8cpp.html#a45261662b3b88d5db461b3fc99246e5a">Debog::verifier</a>(<span class="stringliteral">&quot;Navier_Stokes_std::mettre_a_jour : vitesse&quot;</span>, <a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01473"></a>01473 }
<a name="l01474"></a>01474 
<a name="l01475"></a><a class="code" href="classNavier__Stokes__std.html#ae8d744f9e6ee58850ab1a5dc33c14b95">01475</a> <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#ae8d744f9e6ee58850ab1a5dc33c14b95" title="Reinitialiser ce qui doit l&#39;etre. Cette methode est appelee lorsqu&#39;un pas de temps est abandonne...">Navier_Stokes_std::abortTimeStep</a>()
<a name="l01476"></a>01476 {
<a name="l01477"></a>01477 <span class="comment">// On reprend la pression du debut du pas de temps</span>
<a name="l01478"></a>01478 <span class="comment">// Utile si on reprend le pas de temps parce que la pression a diverge (sinon tres mauvaise precision)</span>
<a name="l01479"></a>01479 <span class="comment">// et si on est en Piso (suppose pression juste au debut du pas de temps).</span>
<a name="l01480"></a>01480   <a class="code" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a" title="Renvoie le champ de pression.">pression</a>()-&gt;<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>()=<a class="code" href="classNavier__Stokes__std.html#aec50aaf2d08b682b007b1f6f3443a914">P_n</a>;
<a name="l01481"></a>01481 <span class="comment">// pression()-&gt;valeurs()=0;</span>
<a name="l01482"></a>01482   <a class="code" href="classNavier__Stokes__std.html#ae8d744f9e6ee58850ab1a5dc33c14b95" title="Reinitialiser ce qui doit l&#39;etre. Cette methode est appelee lorsqu&#39;un pas de temps est abandonne...">Equation_base::abortTimeStep</a>();
<a name="l01483"></a>01483 }
<a name="l01484"></a>01484 
<a name="l01485"></a>01485 
<a name="l01486"></a><a class="code" href="classNavier__Stokes__std.html#ab5e9f2f2f0d6d95cc5165280c32c5dff">01486</a> <span class="keywordtype">bool</span> <a class="code" href="classNavier__Stokes__std.html#ab5e9f2f2f0d6d95cc5165280c32c5dff" title="Allocation et initialisation de l&#39;inconnue et des CLs jusqu&#39;a present+dt. + autres initialisations po...">Navier_Stokes_std::initTimeStep</a>(<span class="keywordtype">double</span> dt)
<a name="l01487"></a>01487 {
<a name="l01488"></a>01488   <a class="code" href="classNavier__Stokes__std.html#aec50aaf2d08b682b007b1f6f3443a914">P_n</a>=<a class="code" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a" title="Renvoie le champ de pression.">pression</a>()-&gt;<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l01489"></a>01489 
<a name="l01490"></a>01490 <span class="comment">// needed by ALE method and we don&#39;t want domaine_ale object in TRUST</span>
<a name="l01491"></a>01491   <a class="code" href="classNavier__Stokes__std.html#aa8c6f4accec70a26369bda20fd024f1f">update_pressure_matrix</a>( );
<a name="l01492"></a>01492 
<a name="l01493"></a>01493 <span class="comment">// Verification que dt_max est correctement fixe pour un champ</span>
<a name="l01494"></a>01494 <span class="comment">// de vitesse nul et diffusion_implicite active &lt;=&gt; dt_conv=INF</span>
<a name="l01495"></a>01495   <span class="keyword">const</span> <a class="code" href="classSchema__Temps__base.html" title="classe Schema_Temps_base">Schema_Temps_base</a>&amp; sch_tps = <a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>.<a class="code" href="classRef__Schema__Temps__base.html#a1cdfccd0f1ad187e0e83d762e69a7834">valeur</a>();
<a name="l01496"></a>01496   <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; dt_max = sch_tps.<a class="code" href="classSchema__Temps__base.html#a7c52d28f5bb86270c2a33bcc20bb9e6f" title="Renvoie le pas de temps maximum. (version const)">pas_temps_max</a>();
<a name="l01497"></a>01497   <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; diff_implicite = sch_tps.<a class="code" href="classSchema__Temps__base.html#af19143270478f1a870292550da641a94" title="Renvoie 1 si le schema en temps a ete lu diffusion_implicite.">diffusion_implicite</a>();
<a name="l01498"></a>01498   <span class="keywordflow">if</span> (diff_implicite)
<a name="l01499"></a>01499     {
<a name="l01500"></a>01500       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_vitesse = <a class="code" href="classNavier__Stokes__std.html#a743b777e6185faee7837326844c8fca1" title="Renvoie la vitesse (champ inconnue de l&#39;equation) (version const)">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l01501"></a>01501       <span class="keywordtype">int</span> size = tab_vitesse.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>()==1?1:tab_vitesse.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l01502"></a>01502       <a class="code" href="classDoubleVect.html">DoubleVect</a> max_vit;
<a name="l01503"></a>01503       max_vit.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(size);
<a name="l01504"></a>01504       <a class="code" href="DoubleTab_8cpp.html#a45f3ed78ddbbca7ed00d97e33be19a22">mp_max_abs_tab</a>(tab_vitesse,max_vit);
<a name="l01505"></a>01505       <span class="keywordtype">double</span> <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a> = <a class="code" href="DoubleVect_8cpp.html#acb21ec8c0b3909c26b20e3f3455e0289">mp_max_abs_vect</a>(max_vit);
<a name="l01506"></a>01506 
<a name="l01507"></a>01507       <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#a2c495f52155e100aae5a8903602ff590">sup_strict</a>(max,0.))
<a name="l01508"></a>01508         {
<a name="l01509"></a>01509           <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(dt_max,1.e30))
<a name="l01510"></a>01510             {
<a name="l01511"></a>01511               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01512"></a>01512               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; Diffusion operators are implicited and the current velocity field is null,&quot;</span>&lt;&lt;finl;
<a name="l01513"></a>01513               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; then leading to an infinite time step if dt_max is not defined.&quot;</span> &lt;&lt; finl;
<a name="l01514"></a>01514               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; Please, specify an appropriate dt_max value.&quot;</span>&lt;&lt;finl;
<a name="l01515"></a>01515               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; WARNING : The first value of dt_max that you will specified &quot;</span>&lt;&lt;finl;
<a name="l01516"></a>01516               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; may need to be decreased if the calculation still crash.&quot;</span>&lt;&lt;finl;
<a name="l01517"></a>01517               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01518"></a>01518             }
<a name="l01519"></a>01519           <span class="keywordflow">else</span>
<a name="l01520"></a>01520             {
<a name="l01521"></a>01521               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01522"></a>01522               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;===========================================================================&quot;</span>&lt;&lt;finl;
<a name="l01523"></a>01523               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; WARNING : &quot;</span>&lt;&lt;finl;
<a name="l01524"></a>01524               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; Diffusion operators are implicited and the current velocity field is null. &quot;</span>&lt;&lt;finl;
<a name="l01525"></a>01525               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; In the case the calculation crash, please try to decrease&quot;</span>&lt;&lt;finl;
<a name="l01526"></a>01526               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; the dt_max value in the time scheme block of your data set. &quot;</span>&lt;&lt;finl;
<a name="l01527"></a>01527               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;===========================================================================&quot;</span>&lt;&lt;finl;
<a name="l01528"></a>01528               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;finl;
<a name="l01529"></a>01529             }
<a name="l01530"></a>01530         }
<a name="l01531"></a>01531     }
<a name="l01532"></a>01532 
<a name="l01533"></a>01533 <span class="comment">// &lt;IBM&gt; Immersed Boundary Method</span>
<a name="l01534"></a>01534   <span class="keywordtype">double</span> ddt = <a class="code" href="classNavier__Stokes__std.html#ab5e9f2f2f0d6d95cc5165280c32c5dff" title="Allocation et initialisation de l&#39;inconnue et des CLs jusqu&#39;a present+dt. + autres initialisations po...">Equation_base::initTimeStep</a>(dt);
<a name="l01535"></a>01535 
<a name="l01536"></a>01536   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=sch_tps.<a class="code" href="classSchema__Temps__base.html#a9d24dd8112258e09c09a9b58c4b7e335">nb_valeurs_futures</a>(); i++) <span class="keywordflow">if</span> (i &lt;= <a class="code" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a" title="Renvoie le champ de pression.">pression</a>().<a class="code" href="classChamp__Inc.html#ab4847a769013ea94d3033240173f674b" title="Appel a l&#39;objet sous-jacent Renvoie le nombre de pas de temps conserve.">nb_valeurs_temporelles</a>())
<a name="l01537"></a>01537       {
<a name="l01538"></a>01538         <span class="keywordtype">double</span> tps=sch_tps.<a class="code" href="classSchema__Temps__base.html#a46d916b7db340c822e87edf21ab77c00">temps_futur</a>(i);
<a name="l01539"></a>01539 <span class="comment">// Mise a jour du temps dans les champs de pression</span>
<a name="l01540"></a>01540         <a class="code" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a" title="Renvoie le champ de pression.">pression</a>()-&gt;changer_temps_futur(tps,i);
<a name="l01541"></a>01541         <a class="code" href="classNavier__Stokes__std.html#a2233a18979d8e301c9d376d8639877ee">pression_pa</a>()-&gt;changer_temps_futur(tps,i);
<a name="l01542"></a>01542         <a class="code" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a" title="Renvoie le champ de pression.">pression</a>()-&gt;<a class="code" href="classChamp__Inc.html#a518c3eb1e7a249ae0fc4d1a4e0d072d0" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t+i.">futur</a>(i)=<a class="code" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a" title="Renvoie le champ de pression.">pression</a>()-&gt;<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l01543"></a>01543         <a class="code" href="classNavier__Stokes__std.html#a2233a18979d8e301c9d376d8639877ee">pression_pa</a>()-&gt;<a class="code" href="classChamp__Inc.html#a518c3eb1e7a249ae0fc4d1a4e0d072d0" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps t+i.">futur</a>(i)=<a class="code" href="classNavier__Stokes__std.html#afbb8f39bdfd70328dfad21bf2b9dd45a" title="Renvoie le champ de pression.">pression</a>()-&gt;<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l01544"></a>01544       }
<a name="l01545"></a>01545 
<a name="l01546"></a>01546   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a> != -1)
<a name="l01547"></a>01547     {
<a name="l01548"></a>01548       <a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>&amp; src = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSource__PDF__base.html" title="class Source_PDF_base Base class for the source terms for the penalisation of the momentum in the Imm...">Source_PDF_base</a>&amp;<span class="keyword">&gt;</span>((<a class="code" href="classEquation__base.html#a3c8ac50e3e7b6ed29024a43e828a5396" title="Renvoie les termes sources asssocies a l&#39;equation.">sources</a>())[<a class="code" href="classNavier__Stokes__std.html#a147061c196d27a3c7141abef9740e35b">i_source_pdf_</a>].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>());
<a name="l01549"></a>01549       src.<a class="code" href="classSource__PDF__base.html#ac0eba76dc8d8fe2a40cb62617ea42115">updateChampRho</a>();
<a name="l01550"></a>01550       src.<a class="code" href="classSource__PDF__base.html#a0bacb4650f0690fb80667f90c95c08f4">calculer_vitesse_imposee</a>();
<a name="l01551"></a>01551       <span class="keywordtype">bool</span> mat_var = src.<a class="code" href="classSource__PDF__base.html#a4828b958411bc7024389fb3bf80d38e3">get_matrice_pression_variable_bool_</a>();
<a name="l01552"></a>01552       <span class="keywordflow">if</span> (mat_var == <span class="keyword">false</span>) <span class="keywordflow">return</span>  ddt;
<a name="l01553"></a>01553       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;(IBM) Immersed Interface: update of pressure matrix coefficents.&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01554"></a>01554       <a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a> = src.<a class="code" href="classSource__PDF__base.html#a9aeeb6642d74622b0d03ba1b7268fe4d">compute_coeff_matrice_pression</a>();
<a name="l01555"></a>01555       <a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a>.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01556"></a>01556 <span class="comment">// Cerr&lt;&lt;&quot;Min/max of coefficients: &quot;&lt;&lt; mp_min_vect(champ_coeff_pdf_som_) &lt;&lt; &quot; &quot; &lt;&lt; mp_max_vect(champ_coeff_pdf_som_) &lt;&lt;finl;</span>
<a name="l01557"></a>01557 
<a name="l01558"></a>01558       <span class="keywordflow">if</span> ((<a class="code" href="classNavier__Stokes__std.html#a5f86768d882558420477430db7ca1293">correction_matrice_pression_</a>==1) || (<a class="code" href="classNavier__Stokes__std.html#aa82c5d9c34a459ed915e4d448aadeca8">matrice_pression_penalisee_H1_</a>==1))
<a name="l01559"></a>01559         {
<a name="l01560"></a>01560           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;(IBM) Immersed Interface: update of pressure matrix.&quot;</span>&lt;&lt;finl;
<a name="l01561"></a>01561           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> inv_coeff(<a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a>);
<a name="l01562"></a>01562           inv_coeff = 1.;
<a name="l01563"></a>01563           inv_coeff *= <a class="code" href="classNavier__Stokes__std.html#a5af47f493dac16351e211b1404c71785">champ_coeff_pdf_som_</a>;
<a name="l01564"></a>01564           src.<a class="code" href="classSource__PDF__base.html#a4c614b6e1b86ff096379db1be4d155ef">multiply_coeff_volume</a>(inv_coeff);
<a name="l01565"></a>01565           inv_coeff.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01566"></a>01566           <a class="code" href="classNavier__Stokes__std.html#af9f5e0396945755597f147bd424a4a08">assembleur_pression</a>().<a class="code" href="classDeriv__Assembleur__base.html#ac0c74810fc600fc5053e645bf19d4ece">valeur</a>().<a class="code" href="classAssembleur__base.html#a0710705cb88b7db3620b993a2cb31e05">assembler_mat</a>(<a class="code" href="classNavier__Stokes__std.html#a65ad55520bdc8a52dd452c24574a7b03">matrice_pression_</a>,inv_coeff,1,1);
<a name="l01567"></a>01567         }
<a name="l01568"></a>01568     }
<a name="l01569"></a>01569 <span class="comment">// &lt;/IBM&gt;</span>
<a name="l01570"></a>01570   <span class="keywordflow">return</span> ddt;
<a name="l01571"></a>01571 }
<a name="l01572"></a>01572 
<a name="l01573"></a>01573 <span class="comment">//</span>
<a name="l01574"></a>01574 <span class="comment">//</span>
<a name="l01575"></a>01575 <span class="comment">//</span>
<a name="l01576"></a>01576 <span class="comment">//</span>
<a name="l01577"></a>01577 <span class="comment">//</span><span class="comment"></span>
<a name="l01578"></a>01578 <span class="comment">//! Calcul de &quot;la_pression_en_pa&quot; en fonction de &quot;la_pression&quot;.&lt;br&gt;Si le champ milieu().masse_volumique() est uniforme, on suppose que&lt;br&gt;la_pression est P* = P/rho, et on multiplie par rho. Sinon,&lt;br&gt;la_pression est deja en Pa.&lt;br&gt;Cette methode est surchargee en front-tracking.</span>
<a name="l01579"></a><a class="code" href="classNavier__Stokes__std.html#aef9f0339909c31f6b1b9bab3c7d470a5">01579</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#aef9f0339909c31f6b1b9bab3c7d470a5" title="Calcul de &quot;la_pression_en_pa&quot; en fonction de &quot;la_pression&quot;. Si le champ milieu().masse_volumique() es...">Navier_Stokes_std::calculer_la_pression_en_pa</a>()
<a name="l01580"></a>01580 {
<a name="l01581"></a>01581   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; Pa=<a class="code" href="classNavier__Stokes__std.html#a5b5b3a99c0ffa104a77774fd5f30944d">la_pression_en_pa</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l01582"></a>01582   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; tab_pression=<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l01583"></a>01583   <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; rho=<a class="code" href="classNavier__Stokes__std.html#a442d8f1138c18da07aa895728b3e41f2" title="Renvoie le milieu physique de l&#39;equation (le Fluide_base upcaste en Milieu_base)">milieu</a>().<a class="code" href="classMilieu__base.html#a46a9a4bfb046ed22d0f267b6c052889f" title="Renvoie la masse volumique du milieu. (version const)">masse_volumique</a>();
<a name="l01584"></a>01584   Pa = tab_pression;
<a name="l01585"></a>01585 <span class="comment">// On multiplie par rho si uniforme sinon deja en Pa...</span>
<a name="l01586"></a>01586   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Uniforme.html" title="classe Champ_Uniforme Represente un champ constant dans l&#39;espace et dans le temps.">Champ_Uniforme</a>,rho))
<a name="l01587"></a>01587     Pa *= rho(0,0);
<a name="l01588"></a>01588 }
<a name="l01589"></a>01589 
<a name="l01590"></a>01590 <span class="comment">// Precondition:</span>
<a name="l01591"></a>01591 <span class="comment">// Parametre: Sortie&amp; os</span>
<a name="l01592"></a>01592 <span class="comment">// Signification: un flot de sortie sur lequel sauvegarder</span>
<a name="l01593"></a>01593 <span class="comment">// Valeurs par defaut:</span>
<a name="l01594"></a>01594 <span class="comment">// Contraintes:</span>
<a name="l01595"></a>01595 <span class="comment">// Acces: entree/sortie</span>
<a name="l01596"></a>01596 <span class="comment">// Exception:</span>
<a name="l01597"></a>01597 <span class="comment">// Effets de bord:</span>
<a name="l01598"></a>01598 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l01599"></a>01599 <span class="comment">//</span>
<a name="l01600"></a>01600 <span class="comment">//</span><span class="comment"></span>
<a name="l01601"></a>01601 <span class="comment">//! Appelle Equation_base::sauvegarder(Sortie\&amp;)&lt;br&gt;et sauvegarde la pression sur un flot de sortie.</span>
<a name="l01602"></a>01602 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l01603"></a>01603 <span class="comment">Signification: renvoie toujours 1&lt;br&gt;</span>
<a name="l01604"></a>01604 <span class="comment">Contraintes: */</span>
<a name="l01605"></a><a class="code" href="classNavier__Stokes__std.html#ad2ebc09c7ba9a06e7dd565c4751a98c2">01605</a> <span class="keywordtype">int</span> <a class="code" href="classNavier__Stokes__std.html#ad2ebc09c7ba9a06e7dd565c4751a98c2" title="Appelle Equation_base::sauvegarder(Sortie&amp;) et sauvegarde la pression sur un flot de sortie...">Navier_Stokes_std::sauvegarder</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l01606"></a>01606 <span class="keyword"></span>{
<a name="l01607"></a>01607   <span class="keywordtype">int</span> bytes=0;
<a name="l01608"></a>01608   bytes += <a class="code" href="classNavier__Stokes__std.html#ad2ebc09c7ba9a06e7dd565c4751a98c2" title="Appelle Equation_base::sauvegarder(Sortie&amp;) et sauvegarde la pression sur un flot de sortie...">Equation_base::sauvegarder</a>(os);
<a name="l01609"></a>01609   bytes += <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a454ab8f891f10bfd54449b12f8d44f52" title="Appel a l&#39;objet sous-jacent Effectue une sauvegarde sur un flot de sortie.">sauvegarder</a>(os);
<a name="l01610"></a>01610 <span class="comment">// La methode sauver() assurant la sauvegarde pour le traitement particulier</span>
<a name="l01611"></a>01611 <span class="comment">// est maintenant appelee ici au lieu d etre appelee dans des problemes particuliers</span>
<a name="l01612"></a>01612   <a class="code" href="classNavier__Stokes__std.html#ad950563c6bc8dded1516dd94cd91e21d">sauver</a>();
<a name="l01613"></a>01613 
<a name="l01614"></a>01614   <span class="keywordflow">return</span> bytes;
<a name="l01615"></a>01615 }
<a name="l01616"></a>01616 
<a name="l01617"></a>01617 <span class="comment">// Precondition:</span>
<a name="l01618"></a>01618 <span class="comment">// Parametre: Entree&amp; is</span>
<a name="l01619"></a>01619 <span class="comment">// Signification: un flot d&#39;entree</span>
<a name="l01620"></a>01620 <span class="comment">// Valeurs par defaut:</span>
<a name="l01621"></a>01621 <span class="comment">// Contraintes:</span>
<a name="l01622"></a>01622 <span class="comment">// Acces: entree/sortie</span>
<a name="l01623"></a>01623 <span class="comment">// Exception: la reprise a echoue, identificateur de la pression non trouve</span>
<a name="l01624"></a>01624 <span class="comment">// Effets de bord:</span>
<a name="l01625"></a>01625 <span class="comment">// Postcondition:</span>
<a name="l01626"></a>01626 <span class="comment">//</span>
<a name="l01627"></a>01627 <span class="comment">//</span>
<a name="l01628"></a>01628 <span class="comment">//</span><span class="comment"></span>
<a name="l01629"></a>01629 <span class="comment">//! Effectue une reprise a partir d&#39;un flot d&#39;entree.&lt;br&gt;Appelle Equation_base::reprendre()&lt;br&gt;et reprend la pression.</span>
<a name="l01630"></a>01630 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l01631"></a>01631 <span class="comment">Signification: renvoie toujours 1&lt;br&gt;</span>
<a name="l01632"></a>01632 <span class="comment">Contraintes: */</span>
<a name="l01633"></a><a class="code" href="classNavier__Stokes__std.html#a5f3f3efd5eec3339e0881df9f0e79f95">01633</a> <span class="keywordtype">int</span> <a class="code" href="classNavier__Stokes__std.html#a5f3f3efd5eec3339e0881df9f0e79f95" title="Effectue une reprise a partir d&#39;un flot d&#39;entree. Appelle Equation_base::reprendre() et reprend la pr...">Navier_Stokes_std::reprendre</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l01634"></a>01634 {
<a name="l01635"></a>01635   <a class="code" href="classNavier__Stokes__std.html#a5f3f3efd5eec3339e0881df9f0e79f95" title="Effectue une reprise a partir d&#39;un flot d&#39;entree. Appelle Equation_base::reprendre() et reprend la pr...">Equation_base::reprendre</a>(is);
<a name="l01636"></a>01636   <span class="keywordtype">double</span> temps = <a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>();
<a name="l01637"></a>01637   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> ident_pression(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classO__U__Ptr.html#a5aae0c48048a40339f3847aa14109231" title="Renvoie ref_().le_nom() si le pointeur est non nul ou &quot;Pointeur Nul&quot;.">le_nom</a>());
<a name="l01638"></a>01638   ident_pression += <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classDeriv__Champ__Inc__base.html#a9e0b743a3e124e7114fa977b36b68225">valeur</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
<a name="l01639"></a>01639   ident_pression += <a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#afa73c54a5b6b111e0f08cd1ab3608178" title="Renvoie le domaine associe au probleme. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>();
<a name="l01640"></a>01640   ident_pression += <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>(temps,<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().reprise_format_temps());
<a name="l01641"></a>01641   <a class="code" href="Avanc_8cpp.html#ae61571402d637eb7962957b7714ffc33">avancer_fichier</a>(is, ident_pression);
<a name="l01642"></a>01642   <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a1a11a937f6d82d26f2d708e4a7b85d36" title="Appel a l&#39;objet sous-jacent Effectue une reprise sur un flot d&#39;entree.">reprendre</a>(is);
<a name="l01643"></a>01643 
<a name="l01644"></a>01644   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01645"></a>01645     <a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classTraitement__particulier__NS.html#a04f35a87b8e5a7b0cacf86c2650cd466">reprendre_stat</a>();
<a name="l01646"></a>01646 
<a name="l01647"></a>01647   <span class="keywordflow">return</span> 1;
<a name="l01648"></a>01648 }
<a name="l01649"></a>01649 
<a name="l01650"></a>01650 <span class="comment">// Precondition:</span>
<a name="l01651"></a>01651 <span class="comment">// Parametre: Milieu_base&amp; un_milieu</span>
<a name="l01652"></a>01652 <span class="comment">// Signification: le milieu a associer a l&#39;equation</span>
<a name="l01653"></a>01653 <span class="comment">// Valeurs par defaut:</span>
<a name="l01654"></a>01654 <span class="comment">// Contraintes: le milieu doit etre de type Fluide_base</span>
<a name="l01655"></a>01655 <span class="comment">// Acces: entree</span>
<a name="l01656"></a>01656 <span class="comment">// </span>
<a name="l01657"></a>01657 <span class="comment">// Signification:</span>
<a name="l01658"></a>01658 <span class="comment">// Contraintes:</span>
<a name="l01659"></a>01659 <span class="comment">// Exception:</span>
<a name="l01660"></a>01660 <span class="comment">// Effets de bord:</span>
<a name="l01661"></a>01661 <span class="comment">// Postcondition:</span>
<a name="l01662"></a>01662 <span class="comment">//</span>
<a name="l01663"></a>01663 <span class="comment">//</span>
<a name="l01664"></a>01664 <span class="comment">//</span><span class="comment"></span>
<a name="l01665"></a>01665 <span class="comment">//! Associe un mileu physique a l&#39;equation en construisant&lt;br&gt;dynamiquement (cast) un objet de type Fluide_base&lt;br&gt;a partir de l&#39;objet Milieu_base passe en parametre.</span>
<a name="l01666"></a><a class="code" href="classNavier__Stokes__std.html#a5958751de3bf0e7273c156addebd93e6">01666</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#a5958751de3bf0e7273c156addebd93e6" title="Associe un mileu physique a l&#39;equation en construisant dynamiquement (cast) un objet de type Fluide_b...">Navier_Stokes_std::associer_milieu_base</a>(<span class="keyword">const</span> <a class="code" href="classMilieu__base.html" title="classe Milieu_base Cette classe est la base de la hierarchie des milieux (physiques) Elle regroupe le...">Milieu_base</a>&amp; un_milieu)
<a name="l01667"></a>01667 {
<a name="l01668"></a>01668   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>, un_milieu))
<a name="l01669"></a>01669     {
<a name="l01670"></a>01670       <span class="keyword">const</span> <a class="code" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>&amp; un_fluide = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFluide__base.html" title="classe Fluide_base Cette classe represente un d&#39;un fluide incompressible ainsi que ses proprietes: - ...">Fluide_base</a>,un_milieu);
<a name="l01671"></a>01671       <a class="code" href="classNavier__Stokes__std.html#a519ec2dc7ddc21bd9696b3c0144c1a69" title="Associe un fluide incompressible a l&#39;equation.">associer_fluide</a>(un_fluide);
<a name="l01672"></a>01672     }
<a name="l01673"></a>01673   <span class="keywordflow">else</span>
<a name="l01674"></a>01674     {
<a name="l01675"></a>01675       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error of fluid type for the method Navier_Stokes_std::associer_milieu_base&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01676"></a>01676       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01677"></a>01677     }
<a name="l01678"></a>01678 }
<a name="l01679"></a>01679 
<a name="l01680"></a>01680 <span class="comment">// Precondition:</span>
<a name="l01681"></a>01681 <span class="comment">// Parametre:</span>
<a name="l01682"></a>01682 <span class="comment">// Signification:</span>
<a name="l01683"></a>01683 <span class="comment">// Valeurs par defaut:</span>
<a name="l01684"></a>01684 <span class="comment">// Contraintes:</span>
<a name="l01685"></a>01685 <span class="comment">// Acces:</span>
<a name="l01686"></a>01686 <span class="comment">// Exception:</span>
<a name="l01687"></a>01687 <span class="comment">// Effets de bord:</span>
<a name="l01688"></a>01688 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l01689"></a>01689 <span class="comment">//</span>
<a name="l01690"></a>01690 <span class="comment">//</span><span class="comment"></span>
<a name="l01691"></a>01691 <span class="comment">//! Renvoie le milieu physique de l&#39;equation&lt;br&gt;(le Fluide_base upcaste en Milieu_base)</span>
<a name="l01692"></a>01692 <span class="comment"></span><span class="comment">/** \return Milieu_base\&amp;&lt;br&gt;</span>
<a name="l01693"></a>01693 <span class="comment">Signification: le Fluide_base de l&#39;equation upcaste en Milieu_base&lt;br&gt;</span>
<a name="l01694"></a>01694 <span class="comment">Contraintes: */</span>
<a name="l01695"></a><a class="code" href="classNavier__Stokes__std.html#a442d8f1138c18da07aa895728b3e41f2">01695</a> <span class="keyword">const</span> <a class="code" href="classMilieu__base.html" title="classe Milieu_base Cette classe est la base de la hierarchie des milieux (physiques) Elle regroupe le...">Milieu_base</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a442d8f1138c18da07aa895728b3e41f2" title="Renvoie le milieu physique de l&#39;equation (le Fluide_base upcaste en Milieu_base)">Navier_Stokes_std::milieu</a>()<span class="keyword"> const</span>
<a name="l01696"></a>01696 <span class="keyword"></span>{
<a name="l01697"></a>01697   <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#ad9aa0a7593fc4cc74b362ce25f1b2d61">le_fluide</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01698"></a>01698     {
<a name="l01699"></a>01699       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;You forgot to associate a fluid to the problem named &quot;</span> &lt;&lt; <a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a58bc0b101f3f3f1d8522a9f41f1fad7b" title="surcharge Objet_U::le_nom() Renvoie le nom du probleme">le_nom</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01700"></a>01700       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01701"></a>01701     }
<a name="l01702"></a>01702   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#ad9aa0a7593fc4cc74b362ce25f1b2d61">le_fluide</a>.<a class="code" href="classRef__Fluide__base.html#a614fc18293b0b3da4f460a857a3b3cb8">valeur</a>();
<a name="l01703"></a>01703 }
<a name="l01704"></a>01704 
<a name="l01705"></a>01705 <span class="comment">// Precondition:</span>
<a name="l01706"></a>01706 <span class="comment">// Parametre:</span>
<a name="l01707"></a>01707 <span class="comment">// Signification:</span>
<a name="l01708"></a>01708 <span class="comment">// Valeurs par defaut:</span>
<a name="l01709"></a>01709 <span class="comment">// Contraintes:</span>
<a name="l01710"></a>01710 <span class="comment">// Acces:</span>
<a name="l01711"></a>01711 <span class="comment">// Exception:</span>
<a name="l01712"></a>01712 <span class="comment">// Effets de bord:</span>
<a name="l01713"></a>01713 <span class="comment">// Postcondition:</span>
<a name="l01714"></a>01714 <span class="comment">//</span>
<a name="l01715"></a>01715 <span class="comment">//</span>
<a name="l01716"></a>01716 <span class="comment">//</span><span class="comment"></span>
<a name="l01717"></a>01717 <span class="comment">//! Renvoie le milieu physique de l&#39;equation&lt;br&gt;(le Fluide_base upcaste en Milieu_base)&lt;br&gt;(version const)</span>
<a name="l01718"></a>01718 <span class="comment"></span><span class="comment">/** \return Milieu_base\&amp;&lt;br&gt;</span>
<a name="l01719"></a>01719 <span class="comment">Signification: le Fluide_base de l&#39;equation upcaste en Milieu_base&lt;br&gt;</span>
<a name="l01720"></a>01720 <span class="comment">Contraintes: reference constante */</span>
<a name="l01721"></a><a class="code" href="classNavier__Stokes__std.html#a541d6e3c34ac99f997f92bd214265b99">01721</a> <a class="code" href="classMilieu__base.html" title="classe Milieu_base Cette classe est la base de la hierarchie des milieux (physiques) Elle regroupe le...">Milieu_base</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a442d8f1138c18da07aa895728b3e41f2" title="Renvoie le milieu physique de l&#39;equation (le Fluide_base upcaste en Milieu_base)">Navier_Stokes_std::milieu</a>()
<a name="l01722"></a>01722 {
<a name="l01723"></a>01723   <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#ad9aa0a7593fc4cc74b362ce25f1b2d61">le_fluide</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01724"></a>01724     {
<a name="l01725"></a>01725       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;You forgot to associate a fluid to the problem named &quot;</span> &lt;&lt; <a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a58bc0b101f3f3f1d8522a9f41f1fad7b" title="surcharge Objet_U::le_nom() Renvoie le nom du probleme">le_nom</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01726"></a>01726       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l01727"></a>01727     }
<a name="l01728"></a>01728   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#ad9aa0a7593fc4cc74b362ce25f1b2d61">le_fluide</a>.<a class="code" href="classRef__Fluide__base.html#a614fc18293b0b3da4f460a857a3b3cb8">valeur</a>();
<a name="l01729"></a>01729 }
<a name="l01730"></a>01730 
<a name="l01731"></a><a class="code" href="classNavier__Stokes__std.html#aee702c4a9e915328b0ca7baf7d7dcad9">01731</a> <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#aee702c4a9e915328b0ca7baf7d7dcad9">Navier_Stokes_std::creer_champ</a>(<span class="keyword">const</span> <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>&amp; motlu)
<a name="l01732"></a>01732 {
<a name="l01733"></a>01733   <a class="code" href="classNavier__Stokes__std.html#aee702c4a9e915328b0ca7baf7d7dcad9">Equation_base::creer_champ</a>(motlu);
<a name="l01734"></a>01734 
<a name="l01735"></a>01735   <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;vorticite&quot;</span>)
<a name="l01736"></a>01736     {
<a name="l01737"></a>01737       <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#ad68415be934f14173d641e3a9ef0bb21">la_vorticite</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01738"></a>01738         {
<a name="l01739"></a>01739           <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>, <a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
<a name="l01740"></a>01740           dis.<a class="code" href="classDiscret__Thyd.html#ab5b678a9905ee21648169f2e7d229396" title="NE FAIT RIEN, provoque une erreur A surcharger dans les classes derivees.">creer_champ_vorticite</a>(<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>(),<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>,<a class="code" href="classNavier__Stokes__std.html#ad68415be934f14173d641e3a9ef0bb21">la_vorticite</a>);
<a name="l01741"></a>01741           <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#ad68415be934f14173d641e3a9ef0bb21">la_vorticite</a>);
<a name="l01742"></a>01742         }
<a name="l01743"></a>01743     }
<a name="l01744"></a>01744   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;critere_Q&quot;</span>)
<a name="l01745"></a>01745     {
<a name="l01746"></a>01746       <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#a182cdd05e6d80504c54447e6e74c1974">critere_Q</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01747"></a>01747         {
<a name="l01748"></a>01748           <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>, <a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
<a name="l01749"></a>01749           dis.<a class="code" href="classDiscret__Thyd.html#ae9384d4cab506218abcfcbc19f1ea127" title="NE FAIT RIEN, provoque une erreur A surcharger dans les classes derivees.">critere_Q</a>(<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(),<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>(),<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>,<a class="code" href="classNavier__Stokes__std.html#a182cdd05e6d80504c54447e6e74c1974">critere_Q</a>);
<a name="l01750"></a>01750           <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#a182cdd05e6d80504c54447e6e74c1974">critere_Q</a>);
<a name="l01751"></a>01751         }
<a name="l01752"></a>01752     }
<a name="l01753"></a>01753 
<a name="l01754"></a>01754   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;porosite_volumique&quot;</span>)
<a name="l01755"></a>01755     {
<a name="l01756"></a>01756       <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#adf242692fa439c24b44de66a165e00cb">porosite_volumique</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01757"></a>01757         {
<a name="l01758"></a>01758           <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>, <a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
<a name="l01759"></a>01759           dis.<a class="code" href="classDiscret__Thyd.html#a9fd451ed77af6d478501d7e5510f754c" title="NE FAIT RIEN, provoque une erreur A surcharger dans les classes derivees.">porosite_volumique</a>(<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(),<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>(),<a class="code" href="classNavier__Stokes__std.html#adf242692fa439c24b44de66a165e00cb">porosite_volumique</a>);
<a name="l01760"></a>01760           <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#adf242692fa439c24b44de66a165e00cb">porosite_volumique</a>);
<a name="l01761"></a>01761         }
<a name="l01762"></a>01762     }
<a name="l01763"></a>01763   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;y_plus&quot;</span>)
<a name="l01764"></a>01764     {
<a name="l01765"></a>01765       <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#aa643efb8ab053981bf490a4e484428cb">y_plus</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01766"></a>01766         {
<a name="l01767"></a>01767           <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>,<a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
<a name="l01768"></a>01768           dis.<a class="code" href="classDiscret__Thyd.html#ae5bb3e9ff50256abadf6d7a75b735725">y_plus</a>(<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(),<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>(),<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>,<a class="code" href="classNavier__Stokes__std.html#aa643efb8ab053981bf490a4e484428cb">y_plus</a>);
<a name="l01769"></a>01769           <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#aa643efb8ab053981bf490a4e484428cb">y_plus</a>);
<a name="l01770"></a>01770         }
<a name="l01771"></a>01771     }
<a name="l01772"></a>01772   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;reynolds_maille&quot;</span>)
<a name="l01773"></a>01773     {
<a name="l01774"></a>01774       <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#a47641417e98e2cc1616945bae4a942a2">Reynolds_maille</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01775"></a>01775         {
<a name="l01776"></a>01776           <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>,<a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
<a name="l01777"></a>01777           dis.<a class="code" href="classDiscret__Thyd.html#a3ac03e473ebaca06e6e9eed819a32727">reynolds_maille</a>(<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(),<a class="code" href="classNavier__Stokes__std.html#a6b341590bc39e1395c14560f10d67fdb" title="Renvoie le fluide incompressible (milieu physique de l&#39;equation) associe a l&#39;equation. (version const)">fluide</a>(),<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>,<a class="code" href="classNavier__Stokes__std.html#a47641417e98e2cc1616945bae4a942a2">Reynolds_maille</a>);
<a name="l01778"></a>01778           <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#a47641417e98e2cc1616945bae4a942a2">Reynolds_maille</a>);
<a name="l01779"></a>01779         }
<a name="l01780"></a>01780     }
<a name="l01781"></a>01781   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;courant_maille&quot;</span>)
<a name="l01782"></a>01782     {
<a name="l01783"></a>01783       <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#a2c2dca99b1c2d47e165d08d72f7af136">Courant_maille</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01784"></a>01784         {
<a name="l01785"></a>01785           <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>,<a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
<a name="l01786"></a>01786           dis.<a class="code" href="classDiscret__Thyd.html#a403f5aa51a4d388908e43b7ca7879db2">courant_maille</a>(<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(),<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>(),<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>,<a class="code" href="classNavier__Stokes__std.html#a2c2dca99b1c2d47e165d08d72f7af136">Courant_maille</a>);
<a name="l01787"></a>01787           <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#a2c2dca99b1c2d47e165d08d72f7af136">Courant_maille</a>);
<a name="l01788"></a>01788         }
<a name="l01789"></a>01789     }
<a name="l01790"></a>01790   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;taux_cisaillement&quot;</span>)
<a name="l01791"></a>01791     {
<a name="l01792"></a>01792       <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#a113f232e08bebd94d85e2ceed503cb3b">Taux_cisaillement</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01793"></a>01793         {
<a name="l01794"></a>01794           <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>,<a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
<a name="l01795"></a>01795           dis.<a class="code" href="classDiscret__Thyd.html#a115de43ee392c0720cf0df09fa040d75">taux_cisaillement</a>(<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(),<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>(),<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>,<a class="code" href="classNavier__Stokes__std.html#a113f232e08bebd94d85e2ceed503cb3b">Taux_cisaillement</a>);
<a name="l01796"></a>01796           <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#a113f232e08bebd94d85e2ceed503cb3b">Taux_cisaillement</a>);
<a name="l01797"></a>01797         }
<a name="l01798"></a>01798     }
<a name="l01799"></a>01799   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;pression_hydrostatique&quot;</span>)
<a name="l01800"></a>01800     {
<a name="l01801"></a>01801       <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#a5586398b1db77bc695d062d9a1de5fd9">pression_hydrostatique_</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01802"></a>01802         {
<a name="l01803"></a>01803           <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>,<a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
<a name="l01804"></a>01804           dis.<a class="code" href="classDiscretisation__base.html#a03257807e08369739ccc39eba02f74b5">discretiser_champ</a>(<span class="stringliteral">&quot;Champ_sommets&quot;</span>,<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(),<span class="stringliteral">&quot;pression_hydrostatique&quot;</span>,<span class="stringliteral">&quot;Pa&quot;</span>,1,0.,<a class="code" href="classNavier__Stokes__std.html#a5586398b1db77bc695d062d9a1de5fd9">pression_hydrostatique_</a>);
<a name="l01805"></a>01805           <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#a5586398b1db77bc695d062d9a1de5fd9">pression_hydrostatique_</a>);
<a name="l01806"></a>01806         }
<a name="l01807"></a>01807     }
<a name="l01808"></a>01808 
<a name="l01809"></a>01809   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (motlu == <span class="stringliteral">&quot;gradient_vitesse&quot;</span>)
<a name="l01810"></a>01810     {
<a name="l01811"></a>01811       <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#ab86057ad9274038ff672042483fd68f2">grad_u</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01812"></a>01812         {
<a name="l01813"></a>01813           <span class="keyword">const</span> <a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>&amp; dis=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDiscret__Thyd.html" title="classe Discret_Thyd Cette classe est la classe de base representant une discretisation spatiale appli...">Discret_Thyd</a>, <a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>());
<a name="l01814"></a>01814           dis.<a class="code" href="classDiscret__Thyd.html#a6b57908a65293713f458679247c39fc6">grad_u</a>(<a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>(),<a class="code" href="classEquation__base.html#af265fe0ea30868eb2176a0c887e4efab" title="Renvoie la zone des conditions aux limite discretisee associee a l&#39;equation.">zone_Cl_dis</a>(),<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>,<a class="code" href="classNavier__Stokes__std.html#ab86057ad9274038ff672042483fd68f2">grad_u</a>);
<a name="l01815"></a>01815           <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#aae00ca562b7d89ff638fae94d6973fcf">ajoute_champ</a>(<a class="code" href="classNavier__Stokes__std.html#ab86057ad9274038ff672042483fd68f2">grad_u</a>);
<a name="l01816"></a>01816         }
<a name="l01817"></a>01817     }
<a name="l01818"></a>01818 
<a name="l01819"></a>01819   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01820"></a>01820     <a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>-&gt;creer_champ(motlu);
<a name="l01821"></a>01821 }
<a name="l01822"></a>01822 
<a name="l01823"></a><a class="code" href="classNavier__Stokes__std.html#a685028238cf939bdcd4dd7450ab7e038">01823</a> <span class="keywordtype">void</span>  <a class="code" href="classNavier__Stokes__std.html#a685028238cf939bdcd4dd7450ab7e038">Navier_Stokes_std::calculer_pression_hydrostatique</a>(<a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; pression_hydro)<span class="keyword"> const</span>
<a name="l01824"></a>01824 <span class="keyword"></span>{
<a name="l01825"></a>01825 <span class="comment">// abort();</span>
<a name="l01826"></a>01826   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val= pression_hydro.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>();
<a name="l01827"></a>01827   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coords = <a class="code" href="classEquation__base.html#a12d97ae801edc18f614523677921346e" title="Renvoie la zone discretisee associee a l&#39;equation.">zone_dis</a>().<a class="code" href="classZone__dis.html#a544a4bbef7158ed91f3dc33970340889" title="Appel a l&#39;objet sous-jacent. Renvoie la zone associee. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>();
<a name="l01828"></a>01828   <span class="keywordflow">if</span> (!<a class="code" href="classNavier__Stokes__std.html#a442d8f1138c18da07aa895728b3e41f2" title="Renvoie le milieu physique de l&#39;equation (le Fluide_base upcaste en Milieu_base)">milieu</a>().a_gravite())
<a name="l01829"></a>01829     {
<a name="l01830"></a>01830       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;postprocessing of presion_hydrostatique needs gravity&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01831"></a>01831       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01832"></a>01832     }
<a name="l01833"></a>01833   <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; rho = <a class="code" href="classNavier__Stokes__std.html#a442d8f1138c18da07aa895728b3e41f2" title="Renvoie le milieu physique de l&#39;equation (le Fluide_base upcaste en Milieu_base)">milieu</a>().<a class="code" href="classMilieu__base.html#a46a9a4bfb046ed22d0f267b6c052889f" title="Renvoie la masse volumique du milieu. (version const)">masse_volumique</a>();
<a name="l01834"></a>01834   <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classChamp__Uniforme.html" title="classe Champ_Uniforme Represente un champ constant dans l&#39;espace et dans le temps.">Champ_Uniforme</a>,rho))
<a name="l01835"></a>01835     {
<a name="l01836"></a>01836       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;postprocessing of presion_hydrostatique availabe only for incompressible flow&quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01837"></a>01837       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01838"></a>01838     }
<a name="l01839"></a>01839   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; gravite = <a class="code" href="classNavier__Stokes__std.html#a442d8f1138c18da07aa895728b3e41f2" title="Renvoie le milieu physique de l&#39;equation (le Fluide_base upcaste en Milieu_base)">milieu</a>().<a class="code" href="classMilieu__base.html#a206e8e71c6afc96f24a3963e5c65d865" title="Renvoie la gravite du milieu si elle a ete associe provoque une erreur sinon. (version const)...">gravite</a>().<a class="code" href="classChamp__Don__base.html#ac0ac51817e03e27c28d2b96bb15db9a0" title="Surcharge Champ_base::valeurs() Renvoie le tableau des valeurs.">valeurs</a>();
<a name="l01840"></a>01840 
<a name="l01841"></a>01841   val=rho.<a class="code" href="classChamp__Proto.html#a9d8c69f11d1b0a8e378cc6ca41793614">valeurs</a>()(0,0);
<a name="l01842"></a>01842   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som=val.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l01843"></a>01843 
<a name="l01844"></a>01844   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> som=0; som&lt;nb_som; som++)
<a name="l01845"></a>01845     {
<a name="l01846"></a>01846       <span class="keywordtype">double</span> gz=0;
<a name="l01847"></a>01847       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir=0; dir&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; dir++)
<a name="l01848"></a>01848         gz+=coords(som,dir)*gravite(0,dir);
<a name="l01849"></a>01849       val[som]*=gz;
<a name="l01850"></a>01850     }
<a name="l01851"></a>01851   val.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l01852"></a>01852 }
<a name="l01853"></a>01853 
<a name="l01854"></a><a class="code" href="classNavier__Stokes__std.html#a18eccb9461a019135740a00f5e3dbec1">01854</a> <span class="keyword">const</span> <a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a18eccb9461a019135740a00f5e3dbec1">Navier_Stokes_std::get_champ</a>(<span class="keyword">const</span> <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>&amp; nom)<span class="keyword"> const</span>
<a name="l01855"></a>01855 <span class="keyword"></span>{
<a name="l01856"></a>01856   <a class="code" href="Ref_8h.html#aab5720a5c34da14028d0745e386aaa01">REF</a>(<a class="code" href="classChamp__base.html" title="classe Champ_base Cette classe est la base de la hierarchie des champs. Ses membres sont les attribut...">Champ_base</a>) ref_champ;
<a name="l01857"></a>01857   <span class="keywordtype">double</span> temps_init = <a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a2389e67de1603768ab6b1bd396e0adba" title="Renvoie le temps initial.">temps_init</a>();
<a name="l01858"></a>01858   <span class="keywordflow">if</span> (nom==<span class="stringliteral">&quot;gradient_pression&quot;</span>) <a class="code" href="classNavier__Stokes__std.html#afda7801637a0d464a8c254808bfae4e8">postraitement_gradient_P_</a>=1;
<a name="l01859"></a>01859   <span class="keywordflow">if</span> (nom==<span class="stringliteral">&quot;vorticite&quot;</span>)
<a name="l01860"></a>01860     {
<a name="l01861"></a>01861       <a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>&amp; ch=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>,<a class="code" href="classNavier__Stokes__std.html#ad68415be934f14173d641e3a9ef0bb21">la_vorticite</a>.<a class="code" href="classDeriv__Champ__Fonc__base.html#a6c7253d2225e858b40c9251d97d57f72">valeur</a>());
<a name="l01862"></a>01862       <span class="keywordflow">if</span> (((ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()!=<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>()) || (ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()==temps_init)) &amp;&amp; (<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;mon_equation_non_nul()))
<a name="l01863"></a>01863         ch.<a class="code" href="classChamp__Fonc__base.html#ab7d6cd96245a8c9971313976c0f34ccc" title="Mise a jour en temps du champ.">mettre_a_jour</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>());
<a name="l01864"></a>01864       <span class="keywordflow">return</span> <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#af38aefe53d102cb5ea2d328df769f85f">get_champ</a>(nom);
<a name="l01865"></a>01865     }
<a name="l01866"></a>01866   <span class="keywordflow">if</span> (nom==<span class="stringliteral">&quot;critere_Q&quot;</span>)
<a name="l01867"></a>01867     {
<a name="l01868"></a>01868       <a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>&amp; ch=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>,<a class="code" href="classNavier__Stokes__std.html#a182cdd05e6d80504c54447e6e74c1974">critere_Q</a>.<a class="code" href="classDeriv__Champ__Fonc__base.html#a6c7253d2225e858b40c9251d97d57f72">valeur</a>());
<a name="l01869"></a>01869       <span class="keywordflow">if</span> (((ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()!=<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>()) || (ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()==temps_init)) &amp;&amp; (<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;mon_equation_non_nul()))
<a name="l01870"></a>01870         ch.<a class="code" href="classChamp__Fonc__base.html#ab7d6cd96245a8c9971313976c0f34ccc" title="Mise a jour en temps du champ.">mettre_a_jour</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>());
<a name="l01871"></a>01871       <span class="keywordflow">return</span> <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#af38aefe53d102cb5ea2d328df769f85f">get_champ</a>(nom);
<a name="l01872"></a>01872     }
<a name="l01873"></a>01873   <span class="keywordflow">if</span> (nom==<span class="stringliteral">&quot;porosite_volumique&quot;</span>)
<a name="l01874"></a>01874     {
<a name="l01875"></a>01875       <span class="keywordtype">double</span> temps_courant = <a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a5054df01edb6d4f7baec7e612d423834" title="Renvoie le temps courant.">temps_courant</a>();
<a name="l01876"></a>01876       <a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>&amp; ch=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>,<a class="code" href="classNavier__Stokes__std.html#adf242692fa439c24b44de66a165e00cb">porosite_volumique</a>.<a class="code" href="classDeriv__Champ__Fonc__base.html#a6c7253d2225e858b40c9251d97d57f72">valeur</a>());
<a name="l01877"></a>01877       <span class="keywordflow">if</span> ((ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()!=temps_courant) || (ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()==temps_init))
<a name="l01878"></a>01878         ch.<a class="code" href="classChamp__Fonc__base.html#ab7d6cd96245a8c9971313976c0f34ccc" title="Mise a jour en temps du champ.">mettre_a_jour</a>(temps_courant);
<a name="l01879"></a>01879       <span class="keywordflow">return</span> <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#af38aefe53d102cb5ea2d328df769f85f">get_champ</a>(nom);
<a name="l01880"></a>01880     }
<a name="l01881"></a>01881   <span class="keywordflow">if</span> (nom==<span class="stringliteral">&quot;y_plus&quot;</span>)
<a name="l01882"></a>01882     {
<a name="l01883"></a>01883       <a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>&amp; ch=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>,<a class="code" href="classNavier__Stokes__std.html#aa643efb8ab053981bf490a4e484428cb">y_plus</a>.<a class="code" href="classDeriv__Champ__Fonc__base.html#a6c7253d2225e858b40c9251d97d57f72">valeur</a>());
<a name="l01884"></a>01884       <span class="keywordflow">if</span> (((ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()!=<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>()) || (ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()==temps_init)) &amp;&amp; (<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;mon_equation_non_nul()))
<a name="l01885"></a>01885         ch.<a class="code" href="classChamp__Fonc__base.html#ab7d6cd96245a8c9971313976c0f34ccc" title="Mise a jour en temps du champ.">mettre_a_jour</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>());
<a name="l01886"></a>01886       <span class="keywordflow">return</span> <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#af38aefe53d102cb5ea2d328df769f85f">get_champ</a>(nom);
<a name="l01887"></a>01887     }
<a name="l01888"></a>01888   <span class="keywordflow">if</span> (nom==<span class="stringliteral">&quot;reynolds_maille&quot;</span>)
<a name="l01889"></a>01889     {
<a name="l01890"></a>01890       <a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>&amp; ch=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>,<a class="code" href="classNavier__Stokes__std.html#a47641417e98e2cc1616945bae4a942a2">Reynolds_maille</a>.<a class="code" href="classDeriv__Champ__Fonc__base.html#a6c7253d2225e858b40c9251d97d57f72">valeur</a>());
<a name="l01891"></a>01891       <span class="keywordflow">if</span> (((ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()!=<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>()) || (ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()==temps_init)) &amp;&amp; (<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;mon_equation_non_nul()))
<a name="l01892"></a>01892         ch.<a class="code" href="classChamp__Fonc__base.html#ab7d6cd96245a8c9971313976c0f34ccc" title="Mise a jour en temps du champ.">mettre_a_jour</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>());
<a name="l01893"></a>01893       <span class="keywordflow">return</span> <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#af38aefe53d102cb5ea2d328df769f85f">get_champ</a>(nom);
<a name="l01894"></a>01894     }
<a name="l01895"></a>01895   <span class="keywordflow">if</span> (nom==<span class="stringliteral">&quot;courant_maille&quot;</span>)
<a name="l01896"></a>01896     {
<a name="l01897"></a>01897       <a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>&amp; ch=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>,<a class="code" href="classNavier__Stokes__std.html#a2c2dca99b1c2d47e165d08d72f7af136">Courant_maille</a>.<a class="code" href="classDeriv__Champ__Fonc__base.html#a6c7253d2225e858b40c9251d97d57f72">valeur</a>());
<a name="l01898"></a>01898       <span class="keywordflow">if</span> (((ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()!=<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>()) || (ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()==temps_init)) &amp;&amp; (<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;mon_equation_non_nul()))
<a name="l01899"></a>01899         ch.<a class="code" href="classChamp__Fonc__base.html#ab7d6cd96245a8c9971313976c0f34ccc" title="Mise a jour en temps du champ.">mettre_a_jour</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>());
<a name="l01900"></a>01900       <span class="keywordflow">return</span> <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#af38aefe53d102cb5ea2d328df769f85f">get_champ</a>(nom);
<a name="l01901"></a>01901     }
<a name="l01902"></a>01902   <span class="keywordflow">if</span> (nom==<span class="stringliteral">&quot;taux_cisaillement&quot;</span>)
<a name="l01903"></a>01903     {
<a name="l01904"></a>01904       <a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>&amp; ch=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>,<a class="code" href="classNavier__Stokes__std.html#a113f232e08bebd94d85e2ceed503cb3b">Taux_cisaillement</a>.<a class="code" href="classDeriv__Champ__Fonc__base.html#a6c7253d2225e858b40c9251d97d57f72">valeur</a>());
<a name="l01905"></a>01905       <span class="keywordflow">if</span> (((ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()!=<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>()) || (ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()==temps_init)) &amp;&amp; (<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;mon_equation_non_nul()))
<a name="l01906"></a>01906         ch.<a class="code" href="classChamp__Fonc__base.html#ab7d6cd96245a8c9971313976c0f34ccc" title="Mise a jour en temps du champ.">mettre_a_jour</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>());
<a name="l01907"></a>01907       <span class="keywordflow">return</span> <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#af38aefe53d102cb5ea2d328df769f85f">get_champ</a>(nom);
<a name="l01908"></a>01908     }
<a name="l01909"></a>01909   <span class="keywordflow">if</span> (nom==<span class="stringliteral">&quot;gradient_vitesse&quot;</span>)
<a name="l01910"></a>01910     {
<a name="l01911"></a>01911       <a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>&amp; ch=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>, <a class="code" href="classNavier__Stokes__std.html#ab86057ad9274038ff672042483fd68f2">grad_u</a>.<a class="code" href="classDeriv__Champ__Fonc__base.html#a6c7253d2225e858b40c9251d97d57f72">valeur</a>());
<a name="l01912"></a>01912       <span class="keywordflow">if</span> (((ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()!=<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>()) || (ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()==temps_init)) &amp;&amp; (<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;mon_equation_non_nul()))
<a name="l01913"></a>01913         ch.<a class="code" href="classChamp__Fonc__base.html#ab7d6cd96245a8c9971313976c0f34ccc" title="Mise a jour en temps du champ.">mettre_a_jour</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>());
<a name="l01914"></a>01914       <span class="keywordflow">return</span> <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#af38aefe53d102cb5ea2d328df769f85f">get_champ</a>(nom);
<a name="l01915"></a>01915     }
<a name="l01916"></a>01916   <span class="keywordflow">if</span> (nom==<span class="stringliteral">&quot;pression_hydrostatique&quot;</span>)
<a name="l01917"></a>01917     {
<a name="l01918"></a>01918       <a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>&amp; ch=<a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classChamp__Fonc__base.html" title="classe Champ_Fonc_base Classe de base des champs qui sont fonction d&#39;une grandeur calculee au cours d...">Champ_Fonc_base</a>,<a class="code" href="classNavier__Stokes__std.html#a5586398b1db77bc695d062d9a1de5fd9">pression_hydrostatique_</a>.<a class="code" href="classDeriv__Champ__Fonc__base.html#a6c7253d2225e858b40c9251d97d57f72">valeur</a>());
<a name="l01919"></a>01919       <span class="keywordflow">if</span> (((ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()!=<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>()) || (ch.<a class="code" href="classChamp__base.html#ada7350aecb7b6f20dcaee2d1106ab1a0" title="Renvoie le temps du champ.">temps</a>()==temps_init)) &amp;&amp; (<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;mon_equation_non_nul()))
<a name="l01920"></a>01920         {
<a name="l01921"></a>01921           <a class="code" href="classNavier__Stokes__std.html#a685028238cf939bdcd4dd7450ab7e038">calculer_pression_hydrostatique</a>(ch);
<a name="l01922"></a>01922           ch.<a class="code" href="classChamp__Fonc__base.html#ab7d6cd96245a8c9971313976c0f34ccc" title="Mise a jour en temps du champ.">mettre_a_jour</a>(<a class="code" href="classNavier__Stokes__std.html#aad26bec6d951fe047bccbf5cbf7a8fd8">la_vitesse</a>-&gt;<a class="code" href="classChamp__Inc.html#a38da91792d3b4d3ab725a6edf7f62b5a" title="Appel a l&#39;objet sous-jacent Renvoie le temps courant.">temps</a>());
<a name="l01923"></a>01923         }
<a name="l01924"></a>01924       <span class="keywordflow">return</span> <a class="code" href="classEquation__base.html#ad687c312e72dcbc783cf597af5927b07">champs_compris_</a>.<a class="code" href="classChamps__compris.html#af38aefe53d102cb5ea2d328df769f85f">get_champ</a>(nom);
<a name="l01925"></a>01925     }
<a name="l01926"></a>01926   <span class="keywordflow">try</span>
<a name="l01927"></a>01927     {
<a name="l01928"></a>01928       <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a18eccb9461a019135740a00f5e3dbec1">Equation_base::get_champ</a>(nom);
<a name="l01929"></a>01929     }
<a name="l01930"></a>01930   <span class="keywordflow">catch</span> (<a class="code" href="classChamps__compris__erreur.html">Champs_compris_erreur</a>)
<a name="l01931"></a>01931     {
<a name="l01932"></a>01932     }
<a name="l01933"></a>01933 
<a name="l01934"></a>01934   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01935"></a>01935     <span class="keywordflow">try</span>
<a name="l01936"></a>01936       {
<a name="l01937"></a>01937         <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>-&gt;get_champ(nom);
<a name="l01938"></a>01938       }
<a name="l01939"></a>01939     <span class="keywordflow">catch</span> (<a class="code" href="classChamps__compris__erreur.html">Champs_compris_erreur</a>)
<a name="l01940"></a>01940       {
<a name="l01941"></a>01941       }
<a name="l01942"></a>01942   <span class="keywordflow">throw</span> <a class="code" href="classChamps__compris__erreur.html">Champs_compris_erreur</a>();
<a name="l01943"></a>01943 
<a name="l01944"></a>01944   <span class="keywordflow">return</span> ref_champ;
<a name="l01945"></a>01945 }
<a name="l01946"></a>01946 
<a name="l01947"></a><a class="code" href="classNavier__Stokes__std.html#a1d96936c11657f7896bbf024827300b9">01947</a> <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#a1d96936c11657f7896bbf024827300b9">Navier_Stokes_std::get_noms_champs_postraitables</a>(<a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; nom,<a class="code" href="Champs__compris__interface_8h.html#a0e65ad13124ea2cb5e255b640464e35f">Option</a> opt)<span class="keyword"> const</span>
<a name="l01948"></a>01948 <span class="keyword"></span>{
<a name="l01949"></a>01949   <a class="code" href="classNavier__Stokes__std.html#a1d96936c11657f7896bbf024827300b9">Equation_base::get_noms_champs_postraitables</a>(nom,opt);
<a name="l01950"></a>01950 
<a name="l01951"></a>01951   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l01952"></a>01952     <a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>-&gt;get_noms_champs_postraitables(nom,opt);
<a name="l01953"></a>01953 }
<a name="l01954"></a>01954 
<a name="l01955"></a>01955 <span class="comment">// Precondition:</span>
<a name="l01956"></a>01956 <span class="comment">// Parametre: Sortie&amp; os</span>
<a name="l01957"></a>01957 <span class="comment">// Signification: un flot de sortie</span>
<a name="l01958"></a>01958 <span class="comment">// Valeurs par defaut:</span>
<a name="l01959"></a>01959 <span class="comment">// Contraintes:</span>
<a name="l01960"></a>01960 <span class="comment">// Acces: entree/sortie</span>
<a name="l01961"></a>01961 <span class="comment">// Exception:</span>
<a name="l01962"></a>01962 <span class="comment">// Effets de bord:</span>
<a name="l01963"></a>01963 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l01964"></a>01964 <span class="comment">//</span>
<a name="l01965"></a>01965 <span class="comment">//</span>
<a name="l01966"></a>01966 <span class="comment">//</span>
<a name="l01967"></a>01967 <span class="comment">//</span>
<a name="l01968"></a>01968 <span class="comment">//</span>
<a name="l01969"></a>01969 <span class="comment">//</span><span class="comment"></span>
<a name="l01970"></a>01970 <span class="comment">//! Effectue quelques impressions sur un flot de sortie:&lt;br&gt;- maximum de div U&lt;br&gt;- terme convectif&lt;br&gt;- terme diffusif&lt;br&gt;- divergence&lt;br&gt;- gradient</span>
<a name="l01971"></a>01971 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l01972"></a>01972 <span class="comment">Signification: renvoie toujours 1&lt;br&gt;</span>
<a name="l01973"></a>01973 <span class="comment">Contraintes: */</span>
<a name="l01974"></a><a class="code" href="classNavier__Stokes__std.html#a6b2eb34ff25d0c01a654a90c29a47a5c">01974</a> <span class="keywordtype">int</span> <a class="code" href="classNavier__Stokes__std.html#a6b2eb34ff25d0c01a654a90c29a47a5c" title="Effectue quelques impressions sur un flot de sortie: - maximum de div U - terme convectif - terme dif...">Navier_Stokes_std::impr</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l01975"></a>01975 <span class="keyword"></span>{
<a name="l01976"></a>01976 <span class="comment">// Affichage des bilans volumiques si on n&#39;est pas en QC, ni en Front Tracking</span>
<a name="l01977"></a>01977   <span class="keywordflow">if</span> (!<a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().is_dilatable() &amp;&amp; <a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>()!=<span class="stringliteral">&quot;Probleme_FT_Disc_gen&quot;</span>)
<a name="l01978"></a>01978     {
<a name="l01979"></a>01979       <span class="keywordtype">double</span> LocalFlowRateError=<a class="code" href="DoubleVect_8cpp.html#acb21ec8c0b3909c26b20e3f3455e0289">mp_max_abs_vect</a>(<a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l01980"></a>01980       os &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l01981"></a>01981       os &lt;&lt; <span class="stringliteral">&quot;Cell balance flow rate control for the problem &quot;</span> &lt;&lt; <a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#a58bc0b101f3f3f1d8522a9f41f1fad7b" title="surcharge Objet_U::le_nom() Renvoie le nom du probleme">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; finl;
<a name="l01982"></a>01982       os &lt;&lt; <span class="stringliteral">&quot;Absolute value : &quot;</span> &lt;&lt; LocalFlowRateError &lt;&lt; <span class="stringliteral">&quot; m&quot;</span>&lt;&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>+<a class="code" href="classObjet__U.html#a9a47c1add9760324894500792c17a178">bidim_axi</a>&lt;&lt;<span class="stringliteral">&quot;/s&quot;</span> &lt;&lt; finl;
<a name="l01983"></a>01983       os &lt;&lt; <span class="stringliteral">&quot;Relative value : &quot;</span> &lt;&lt; <a class="code" href="classNavier__Stokes__std.html#a9ffae36bff4d5c71d667a48c2abe36a0">LocalFlowRateRelativeError_</a> &lt;&lt; finl; <span class="comment">//!&lt; max|sum(u.ndS)i/(vol(i)/dt)|=max|div(U)i/dt| Calculation as OpenFOAM: http://foam.sourceforge.net/docs/cpp/a04190_source.html It is relative errors (normalized by the volume/dt)</span>
<a name="l01984"></a>01984 <span class="comment"></span><span class="comment">//</span>
<a name="l01985"></a>01985 <span class="comment">//</span>
<a name="l01986"></a>01986       <span class="keywordtype">double</span> dt = <a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l01987"></a>01987       <span class="keywordtype">double</span> local = LocalFlowRateError / ( <a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#afa73c54a5b6b111e0f08cd1ab3608178" title="Renvoie le domaine associe au probleme. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#ab642027f7a7c19e98f906f0ae007c2b7">volume_total</a>() / dt );
<a name="l01988"></a>01988       <span class="keywordtype">double</span> global = <a class="code" href="DoubleVect_8cpp.html#a07dd5e25d47ad3892ae0fa4e997ed011">mp_somme_vect</a>(<a class="code" href="classNavier__Stokes__std.html#a4d192e21abc7422e413db6726ababf12">divergence_U</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>()) / ( <a class="code" href="classEquation__base.html#aa8151a96f63719523bf50ddd832e0f8f" title="Renvoie le probleme associe a l&#39;equation.">probleme</a>().<a class="code" href="classProbleme__base.html#afa73c54a5b6b111e0f08cd1ab3608178" title="Renvoie le domaine associe au probleme. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#ab642027f7a7c19e98f906f0ae007c2b7">volume_total</a>() / dt );
<a name="l01989"></a>01989       <a class="code" href="classNavier__Stokes__std.html#a5d6182d739775d51469385fdaee02477">cumulative_</a> += global;
<a name="l01990"></a>01990       os &lt;&lt; <span class="stringliteral">&quot;time step continuity errors : sum local = &quot;</span> &lt;&lt; local &lt;&lt; <span class="stringliteral">&quot;, global = &quot;</span> &lt;&lt; global &lt;&lt; <span class="stringliteral">&quot;, cumulative = &quot;</span> &lt;&lt; cumulative_ &lt;&lt; finl;
<a name="l01991"></a>01991 <span class="comment">// Nouveau 1.6.1, arret si bilans de masse mauvais et seuil&lt;1.e20</span>
<a name="l01992"></a>01992       <span class="keywordflow">if</span> (local&gt;0.01 &amp;&amp; <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classsolv__iteratif.html">solv_iteratif</a>,<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>()))
<a name="l01993"></a>01993         {
<a name="l01994"></a>01994           <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classsolv__iteratif.html">solv_iteratif</a>,<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>()).get_seuil()&lt;1e10)
<a name="l01995"></a>01995             {
<a name="l01996"></a>01996               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The mass balance is too bad (relative value&gt;1%).&quot;</span> &lt;&lt; finl;
<a name="l01997"></a>01997               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Please check and lower the convergence value of the pressure solver.&quot;</span> &lt;&lt; finl;
<a name="l01998"></a>01998               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l01999"></a>01999             }
<a name="l02000"></a>02000         }
<a name="l02001"></a>02001 <span class="comment">// Since 1.6.6, warning to use PETSc Cholesky instead of an iterative method for pressure solver</span>
<a name="l02002"></a>02002       <span class="keywordtype">int</span> nw=100;
<a name="l02003"></a>02003       <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>-&gt;solveur_direct()==0 &amp;&amp; <a class="code" href="classEquation__base.html#a7284f978da77834a1978eb89d2cb238c">le_schema_en_temps</a>-&gt;nb_pas_dt()&lt;nw &amp;&amp; <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>()&lt;256 &amp;&amp; <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>().<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>()&lt;40000)
<a name="l02004"></a>02004         {
<a name="l02005"></a>02005           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl &lt;&lt; <span class="stringliteral">&quot;********************** Advice (printed only on the first &quot;</span> &lt;&lt; nw &lt;&lt; <span class="stringliteral">&quot; time steps) *********************&quot;</span> &lt;&lt; finl;
<a name="l02006"></a>02006           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;You should use PETSc Cholesky solver instead of an iterative method for the pressure solver.&quot;</span> &lt;&lt; finl;
<a name="l02007"></a>02007           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;For the caracteristics of your problem, it will be faster and give a better mass flow balance.&quot;</span> &lt;&lt; finl;
<a name="l02008"></a>02008           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;**********************************************************************************************&quot;</span> &lt;&lt; finl &lt;&lt; finl;
<a name="l02009"></a>02009         }
<a name="l02010"></a>02010     }
<a name="l02011"></a>02011 
<a name="l02012"></a>02012   <span class="keywordflow">if</span> ((<a class="code" href="classNavier__Stokes__std.html#af4b0fd768cdbc86d5649b7f058cd7cb8">seuil_divU</a> &lt; 1.) &amp;&amp; (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classsolv__iteratif.html">solv_iteratif</a>,<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>())))
<a name="l02013"></a>02013     {
<a name="l02014"></a>02014       <span class="keyword">const</span> <a class="code" href="classsolv__iteratif.html">solv_iteratif</a>&amp; solv_iter=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classsolv__iteratif.html">solv_iteratif</a>,<a class="code" href="classNavier__Stokes__std.html#ae90b64397bdc684f0b7e3e3cb7a28f74">solveur_pression_</a>.<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>());
<a name="l02015"></a>02015       os &lt;&lt; <span class="stringliteral">&quot; seuil de convergence du solveur iteratif  : &quot;</span> &lt;&lt; solv_iter.<a class="code" href="classsolv__iteratif.html#acb57780795c754663eb6974e123aec88">get_seuil</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02016"></a>02016     }
<a name="l02017"></a>02017   <a class="code" href="classNavier__Stokes__std.html#a6b2eb34ff25d0c01a654a90c29a47a5c" title="Effectue quelques impressions sur un flot de sortie: - maximum de div U - terme convectif - terme dif...">Equation_base::impr</a>(os);
<a name="l02018"></a>02018   <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>.<a class="code" href="classOperateur.html#aaedb62a510abf7d73256488f5d69ea29" title="Imprime l&#39;operateur sur un flot de sortie de facon inconditionnelle.">impr</a>(os);
<a name="l02019"></a>02019   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur.html#aaedb62a510abf7d73256488f5d69ea29" title="Imprime l&#39;operateur sur un flot de sortie de facon inconditionnelle.">impr</a>(os);
<a name="l02020"></a>02020   <span class="keywordflow">return</span> 1;
<a name="l02021"></a>02021 }
<a name="l02022"></a>02022 
<a name="l02023"></a>02023 
<a name="l02024"></a>02024 <span class="comment">// Precondition:</span>
<a name="l02025"></a>02025 <span class="comment">// Parametre:</span>
<a name="l02026"></a>02026 <span class="comment">// Signification:</span>
<a name="l02027"></a>02027 <span class="comment">// Valeurs par defaut:</span>
<a name="l02028"></a>02028 <span class="comment">// Contraintes:</span>
<a name="l02029"></a>02029 <span class="comment">// Acces:</span>
<a name="l02030"></a>02030 <span class="comment">// Exception:</span>
<a name="l02031"></a>02031 <span class="comment">// Effets de bord:</span>
<a name="l02032"></a>02032 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l02033"></a>02033 <span class="comment">//</span><span class="comment"></span>
<a name="l02034"></a>02034 <span class="comment">//! Renvoie le nom du domaine d&#39;application: &quot;Hydraulique&quot;.</span>
<a name="l02035"></a>02035 <span class="comment"></span><span class="comment">/** \return Motcle\&amp;&lt;br&gt;</span>
<a name="l02036"></a>02036 <span class="comment">Signification: lenom representant le domaine d&#39;application&lt;br&gt;</span>
<a name="l02037"></a>02037 <span class="comment">Contraintes: toujours egal a &quot;Hydraulique&quot;, reference constante. */</span>
<a name="l02038"></a><a class="code" href="classNavier__Stokes__std.html#a21950da7d02f9410e0fac5f764bc1837">02038</a> <span class="keyword">const</span> <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a21950da7d02f9410e0fac5f764bc1837" title="Renvoie le nom du domaine d&#39;application: &quot;Hydraulique&quot;.">Navier_Stokes_std::domaine_application</a>()<span class="keyword"> const</span>
<a name="l02039"></a>02039 <span class="keyword"></span>{
<a name="l02040"></a>02040   <span class="keyword">static</span> <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a> domaine = <span class="stringliteral">&quot;Hydraulique&quot;</span>;
<a name="l02041"></a>02041   <span class="keywordflow">return</span> domaine;
<a name="l02042"></a>02042 }
<a name="l02043"></a>02043 
<a name="l02044"></a><a class="code" href="Navier__Stokes__std_8cpp.html#ad8494e060660cc8123cebd07c0729771">02044</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="Navier__Stokes__std_8cpp.html#ad8494e060660cc8123cebd07c0729771">construire_matrice_implicite</a>(<a class="code" href="classOperateur__base.html" title="classe Operateur_base Classe est la base de la hierarchie des objets representant un operateur utilis...">Operateur_base</a>&amp; op,
<a name="l02045"></a>02045                                          <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; valeurs_inconnue,
<a name="l02046"></a>02046                                          <span class="keyword">const</span> <a class="code" href="classSolveur__Masse.html" title="classe Solveur_Masse Classe generique de la hierarchie des solveurs de masse, un objet Solveur_Masse ...">Solveur_Masse</a>&amp; solv_masse,
<a name="l02047"></a>02047                                          <span class="keyword">const</span> <span class="keywordtype">double</span> dt)
<a name="l02048"></a>02048 {
<a name="l02049"></a>02049   <a class="code" href="classMatrice.html">Matrice</a>&amp; mat = op.<a class="code" href="classOperateur__base.html#a58bbc3d85feaa143ec0d87e68d8fe137">set_matrice</a>();
<a name="l02050"></a>02050   <span class="keywordflow">if</span>(!mat.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l02051"></a>02051     mat.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Matrice_Morse&quot;</span>);
<a name="l02052"></a>02052 
<a name="l02053"></a>02053   <span class="keywordflow">if</span>(op.<a class="code" href="classOperateur__base.html#ae7dae6829b1287b470717b08a8ae761e">get_decal_temps</a>()==1)
<a name="l02054"></a>02054     {
<a name="l02055"></a>02055       <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>, mat.<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l02056"></a>02056       op.<a class="code" href="classOperateur__base.html#a66ef3c42e72d13fce0852ba92e56be6a" title="NE FAIT RIEN A surcharger dans les classes derivees.">dimensionner</a>(matrice);
<a name="l02057"></a>02057       op.<a class="code" href="classOperateur__base.html#a903e728aad8e2d490580bf264319d65f" title="NE FAIT RIEN A surcharger dans les classes derivees.">contribuer_a_avec</a>(valeurs_inconnue, matrice);
<a name="l02058"></a>02058       solv_masse.<a class="code" href="classSolveur__Masse.html#adc554d2f7efe81e71ff8995d4f2df8c7">ajouter_masse</a>(dt, matrice);
<a name="l02059"></a>02059       matrice *= dt;
<a name="l02060"></a>02060 
<a name="l02061"></a>02061 <span class="comment">// Si le solveur est cholesky ou gcp, on attend une matrice de type</span>
<a name="l02062"></a>02062 <span class="comment">// Matrice_Morse_Sym. Transformation du type de la matrice:</span>
<a name="l02063"></a>02063       <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; type_solveur = op.<a class="code" href="classOperateur__base.html#a2861e28bd5b9d3484c73271209b2e0b6">get_solveur</a>()-&gt;<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>();
<a name="l02064"></a>02064       <span class="keywordflow">if</span>(type_solveur == <span class="stringliteral">&quot;Solv_Cholesky&quot;</span> || type_solveur == <span class="stringliteral">&quot;Solv_GCP&quot;</span>)
<a name="l02065"></a>02065         {
<a name="l02066"></a>02066           <a class="code" href="classMatrice__Morse__Sym.html" title="Classe Matrice_Morse_Sym Represente une matrice M (creuse) symetrique stockee au format Morse Symetri...">Matrice_Morse_Sym</a> new_mat(matrice);
<a name="l02067"></a>02067           new_mat.<a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(1);
<a name="l02068"></a>02068 <span class="comment">// mat est detruite puis reconstruite:</span>
<a name="l02069"></a>02069           mat = new_mat;
<a name="l02070"></a>02070 <span class="comment">// Reinitialisation du solveur (recalcul des preconditionnements, factorisation, etc...)</span>
<a name="l02071"></a>02071 <span class="comment">// ref_cast_non_const(SolveurSys_base,op.get_solveur().valeur()).reinit();</span>
<a name="l02072"></a>02072           op.<a class="code" href="classOperateur__base.html#a2fe69e40852fa946df7685516d3e5c66">set_solveur</a>().<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>().<a class="code" href="classSolveurSys__base.html#a8737bd7292204c64e4b7bfe4c7bd88ef">reinit</a>();
<a name="l02073"></a>02073         }
<a name="l02074"></a>02074     }
<a name="l02075"></a>02075 }
<a name="l02076"></a>02076 
<a name="l02077"></a>02077 <span class="comment">/* dans CoviMAC, le gradient contribue a la matrice de l&#39;equation de N-S */</span>
<a name="l02078"></a><a class="code" href="classNavier__Stokes__std.html#aaadc6039370a9a655edc1f2c9c98b49c">02078</a> <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#aaadc6039370a9a655edc1f2c9c98b49c">Navier_Stokes_std::dimensionner_matrice_sans_mem</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice)
<a name="l02079"></a>02079 {
<a name="l02080"></a>02080   <a class="code" href="classNavier__Stokes__std.html#aaadc6039370a9a655edc1f2c9c98b49c">Equation_base::dimensionner_matrice_sans_mem</a>(matrice);
<a name="l02081"></a>02081   <span class="keywordflow">if</span> (<a class="code" href="classEquation__base.html#a324a761eaad25eb00d18e14764a1362e" title="Renvoie la discretisation associee a l&#39;equation.">discretisation</a>().<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() == <span class="stringliteral">&quot;CoviMAC&quot;</span>)
<a name="l02082"></a>02082     <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classDeriv__Operateur__Grad__base.html#abb2da411c7f8984b95704eeb0d4deeab">valeur</a>().<a class="code" href="classOperateur__base.html#a1beeeb32ed7ba7f084cf0ff81152d36a">dimensionner_blocs</a>({{ <span class="stringliteral">&quot;vitesse&quot;</span>, &amp;matrice }});
<a name="l02083"></a>02083 }
<a name="l02084"></a>02084 
<a name="l02085"></a><a class="code" href="classNavier__Stokes__std.html#ac20dbb919584c93e60550d51976c39aa">02085</a> <span class="keywordtype">int</span> <a class="code" href="classNavier__Stokes__std.html#ac20dbb919584c93e60550d51976c39aa">Navier_Stokes_std::has_interface_blocs</a>()<span class="keyword"> const</span>
<a name="l02086"></a>02086 <span class="keyword"></span>{
<a name="l02087"></a>02087   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#ac20dbb919584c93e60550d51976c39aa">Equation_base::has_interface_blocs</a>() &amp;&amp; <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classDeriv__Operateur__Grad__base.html#abb2da411c7f8984b95704eeb0d4deeab">valeur</a>().<a class="code" href="classOperateur__base.html#add0b573a00ff5807bca488783aeec334">has_interface_blocs</a>();
<a name="l02088"></a>02088 }
<a name="l02089"></a>02089 
<a name="l02090"></a>02090 <span class="comment">/* le gradient passe en dernier */</span>
<a name="l02091"></a>02091 <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#ac5d3ff5344d625741a9fd6fc715fc43f">Navier_Stokes_std::dimensionner_blocs</a>(<a class="code" href="Interface__blocs_8h.html#a68e4f5c4505f6b31305de844302660bb">matrices_t</a> matrices, <span class="keyword">const</span> <a class="code" href="Interface__blocs_8h.html#a2d7480bf11fc9f791b1d2839fa30a5c3">tabs_t</a>&amp; semi_impl)<span class="keyword"> const</span>
<a name="l02092"></a>02092 <span class="keyword"></span>{
<a name="l02093"></a>02093   <a class="code" href="classNavier__Stokes__std.html#ac5d3ff5344d625741a9fd6fc715fc43f">Equation_base::dimensionner_blocs</a>(matrices, semi_impl);
<a name="l02094"></a>02094   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classDeriv__Operateur__Grad__base.html#abb2da411c7f8984b95704eeb0d4deeab">valeur</a>().<a class="code" href="classOperateur__base.html#a1beeeb32ed7ba7f084cf0ff81152d36a">dimensionner_blocs</a>(matrices, semi_impl);
<a name="l02095"></a>02095 }
<a name="l02096"></a>02096 
<a name="l02097"></a>02097 <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#a5d60f27928e31fcccf96aefaad401b1b">Navier_Stokes_std::assembler_blocs</a>(<a class="code" href="Interface__blocs_8h.html#a68e4f5c4505f6b31305de844302660bb">matrices_t</a> matrices, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; secmem, <span class="keyword">const</span> <a class="code" href="Interface__blocs_8h.html#a2d7480bf11fc9f791b1d2839fa30a5c3">tabs_t</a>&amp; semi_impl)<span class="keyword"> const</span>
<a name="l02098"></a>02098 <span class="keyword"></span>{
<a name="l02099"></a>02099   <a class="code" href="classNavier__Stokes__std.html#a5d60f27928e31fcccf96aefaad401b1b">Equation_base::assembler_blocs</a>(matrices, secmem, semi_impl);
<a name="l02100"></a>02100   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classDeriv__Operateur__Grad__base.html#abb2da411c7f8984b95704eeb0d4deeab">valeur</a>().<a class="code" href="classOperateur__base.html#a0044e3ee1822094970ba5a32997fbd2a">ajouter_blocs</a>(matrices, secmem, semi_impl);
<a name="l02101"></a>02101 }
<a name="l02102"></a>02102 
<a name="l02103"></a><a class="code" href="classNavier__Stokes__std.html#ac3cac99cf56da9758ff23ca3a5e80be7">02103</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classNavier__Stokes__std.html#ac3cac99cf56da9758ff23ca3a5e80be7" title="Returns the time derivative of the unknown I of the equation: dI/dt = M-1*(sum(operators(I) + sources...">Navier_Stokes_std::derivee_en_temps_inco</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; derivee)
<a name="l02104"></a>02104 {
<a name="l02105"></a>02105 <span class="comment">// Calcul de la derivee en temps:</span>
<a name="l02106"></a>02106   <span class="keywordflow">if</span>(!<a class="code" href="classEquation__base.html#aef791a4afd5964d1b4dfd3d2ac3f5e5e">implicite_</a>)
<a name="l02107"></a>02107     {
<a name="l02108"></a>02108 <span class="comment">// Calcul explicite, on utilise la derivee en temps standard:</span>
<a name="l02109"></a>02109       <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#ac3cac99cf56da9758ff23ca3a5e80be7" title="Returns the time derivative of the unknown I of the equation: dI/dt = M-1*(sum(operators(I) + sources...">Equation_base::derivee_en_temps_inco</a>(derivee);
<a name="l02110"></a>02110     }
<a name="l02111"></a>02111   <span class="keywordflow">else</span>
<a name="l02112"></a>02112     {
<a name="l02113"></a>02113 <span class="comment">// Calcul implicite d&#39;un ou plusieurs operateurs (peu utilise)</span>
<a name="l02114"></a>02114 <span class="comment">// Syntaxe jeu de donnees: operateur { implicite solveur cholesky|gcp ... }</span>
<a name="l02115"></a>02115       derivee = 0;
<a name="l02116"></a>02116       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classNavier__Stokes__std.html#ac7db452db8cfdb5f15bf971a47df82f1" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: Pour Navier Stokes Standard c&#39;est 2.">nombre_d_operateurs</a>(); i++)
<a name="l02117"></a>02117         <a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df" title="Renvoie le i-eme operateur de l&#39;equation: - le terme_diffusif si i = 0 - le terme_convectif si i = 1 ...">operateur</a>(i).<a class="code" href="classOperateur.html#accdf61cf1e33fb42e9eb06f1c501422b">ajouter</a>(derivee);
<a name="l02118"></a>02118 
<a name="l02119"></a>02119       <a class="code" href="classEquation__base.html#a6dae2cb8a228b0e3a6d90042fd75f360">les_sources</a>.<a class="code" href="classSources.html#a6fc277f1920a71841cb041dc1b6ed771" title="Ajoute la contribution de toutes les sources de la liste au tableau passe en parametre, et renvoie ce tableau.">ajouter</a>(derivee);
<a name="l02120"></a>02120       derivee.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l02121"></a>02121 
<a name="l02122"></a>02122       <span class="keyword">const</span> <span class="keywordtype">double</span> dt=<a class="code" href="classEquation__base.html#abc11e51aa75b4c7aa55c27f71eb2f2c4" title="Renvoie le schema en temps associe a l&#39;equation.">schema_temps</a>().<a class="code" href="classSchema__Temps__base.html#a0e4f67ef6086c09434ddc161668077b2" title="Renvoie le pas de temps (delta_t) courant.">pas_de_temps</a>();
<a name="l02123"></a>02123       <span class="keyword">static</span> <span class="keywordtype">double</span> dt_old=dt;
<a name="l02124"></a>02124 
<a name="l02125"></a>02125       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classNavier__Stokes__std.html#ac7db452db8cfdb5f15bf971a47df82f1" title="Renvoie le nombre d&#39;operateurs de l&#39;equation: Pour Navier Stokes Standard c&#39;est 2.">nombre_d_operateurs</a>(); i++)
<a name="l02126"></a>02126         {
<a name="l02127"></a>02127           <a class="code" href="classOperateur__base.html" title="classe Operateur_base Classe est la base de la hierarchie des objets representant un operateur utilis...">Operateur_base</a>&amp; op=<a class="code" href="classNavier__Stokes__std.html#a3ad069bdae3ec7e0ffb25319401480df" title="Renvoie le i-eme operateur de l&#39;equation: - le terme_diffusif si i = 0 - le terme_convectif si i = 1 ...">operateur</a>(i).<a class="code" href="classOperateur.html#a1f3e24efd9b54d05821e731fe4bd6027">l_op_base</a>();
<a name="l02128"></a>02128 <span class="comment">// If matrix not build or matrix time dependant:</span>
<a name="l02129"></a>02129           <span class="keywordflow">if</span>(!op.<a class="code" href="classOperateur__base.html#a02e406fee1f2f32954a0fc6f1b86dca8">get_matrice</a>().<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>() || !<a class="code" href="classEquation__base.html#afd09d18db565d1acb431885b9c6d4a55">sys_invariant_</a>)
<a name="l02130"></a>02130             <a class="code" href="Navier__Stokes__std_8cpp.html#ad8494e060660cc8123cebd07c0729771">construire_matrice_implicite</a>(op, <a class="code" href="classNavier__Stokes__std.html#a743b777e6185faee7837326844c8fca1" title="Renvoie la vitesse (champ inconnue de l&#39;equation) (version const)">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(), <a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>(), dt);
<a name="l02131"></a>02131 
<a name="l02132"></a>02132           <span class="keywordflow">if</span>(op.<a class="code" href="classOperateur__base.html#ae7dae6829b1287b470717b08a8ae761e">get_decal_temps</a>()==1)
<a name="l02133"></a>02133             {
<a name="l02134"></a>02134               <span class="keywordflow">if</span>(<a class="code" href="classEquation__base.html#afd09d18db565d1acb431885b9c6d4a55">sys_invariant_</a> &amp;&amp; dt!=dt_old)
<a name="l02135"></a>02135                 {
<a name="l02136"></a>02136 <span class="comment">// La matrice ne change pas mais on change le pas de temps.</span>
<a name="l02137"></a>02137 <span class="comment">// La matrice s&#39;ecrit A =</span>
<a name="l02138"></a>02138 <span class="comment">// Mise a jour simplifiee de la matrice</span>
<a name="l02139"></a>02139                   <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>, op.<a class="code" href="classOperateur__base.html#a58bbc3d85feaa143ec0d87e68d8fe137">set_matrice</a>().<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l02140"></a>02140                   matrice/=dt_old;
<a name="l02141"></a>02141                   <a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#adc554d2f7efe81e71ff8995d4f2df8c7">ajouter_masse</a>(-dt_old, op.<a class="code" href="classOperateur__base.html#a58bbc3d85feaa143ec0d87e68d8fe137">set_matrice</a>().<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l02142"></a>02142                   <a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#adc554d2f7efe81e71ff8995d4f2df8c7">ajouter_masse</a>(dt, op.<a class="code" href="classOperateur__base.html#a58bbc3d85feaa143ec0d87e68d8fe137">set_matrice</a>().<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l02143"></a>02143                   matrice*=dt;
<a name="l02144"></a>02144                   <a class="code" href="Cast_8h.html#ad3836a067c92103af8df5ad8f35959a6">ref_cast_non_const</a>(<a class="code" href="classSolveurSys__base.html">SolveurSys_base</a>,op.<a class="code" href="classOperateur__base.html#a2861e28bd5b9d3484c73271209b2e0b6">get_solveur</a>().<a class="code" href="classDeriv__SolveurSys__base.html#aa1f67fc10fc25960d05d484a67d1bb54">valeur</a>()).reinit();
<a name="l02145"></a>02145                 }
<a name="l02146"></a>02146               <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; matrice=<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>, op.<a class="code" href="classOperateur__base.html#a58bbc3d85feaa143ec0d87e68d8fe137">set_matrice</a>().<a class="code" href="classDeriv__Matrice__Base.html#ae43f3a90ca16518c191f9e7d5ebef912">valeur</a>());
<a name="l02147"></a>02147               <span class="keywordflow">if</span>(<a class="code" href="classEquation__base.html#aef791a4afd5964d1b4dfd3d2ac3f5e5e">implicite_</a>==1)
<a name="l02148"></a>02148                 {
<a name="l02149"></a>02149 <span class="comment">// Un seul operateur implicite.</span>
<a name="l02150"></a>02150                   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> secmem(derivee);
<a name="l02151"></a>02151                   secmem=derivee;
<a name="l02152"></a>02152                   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> incre_pre(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l02153"></a>02153                   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur__Grad.html#a179b2f08f6907e9b69fa715cfb98fa81" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(),<a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l02154"></a>02154                   secmem-=<a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l02155"></a>02155                   <a class="code" href="classNavier__Stokes__std.html#ac2a9d91d700bc58623ef68765547cc3e">uzawa</a>(secmem, matrice,op.<a class="code" href="classOperateur__base.html#a2fe69e40852fa946df7685516d3e5c66">set_solveur</a>(),derivee, incre_pre);
<a name="l02156"></a>02156 
<a name="l02157"></a>02157                   <a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>()+=incre_pre;
<a name="l02158"></a>02158                   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>.<a class="code" href="classOperateur__Grad.html#a179b2f08f6907e9b69fa715cfb98fa81" title="Initialise le tableau passe en parametre avec la contribution de l&#39;operateur.">calculer</a>(<a class="code" href="classNavier__Stokes__std.html#a830014846ec7a21c2f28faf6e6577739">la_pression</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>(),<a class="code" href="classNavier__Stokes__std.html#a65ce14ae1566c51b43db29143c200a5b">gradient_P</a>.<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>());
<a name="l02159"></a>02159                 }
<a name="l02160"></a>02160               <span class="keywordflow">else</span>
<a name="l02161"></a>02161                 {
<a name="l02162"></a>02162 <span class="comment">// plusieurs operateurs implicites ...</span>
<a name="l02163"></a>02163                   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;To be developped ... &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02164"></a>02164                   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l02165"></a>02165                 }
<a name="l02166"></a>02166             }
<a name="l02167"></a>02167         }
<a name="l02168"></a>02168       dt_old=dt;
<a name="l02169"></a>02169       <span class="keywordflow">return</span> derivee;
<a name="l02170"></a>02170     }
<a name="l02171"></a>02171 }
<a name="l02172"></a>02172 
<a name="l02173"></a><a class="code" href="classNavier__Stokes__std.html#ac2a9d91d700bc58623ef68765547cc3e">02173</a> <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#ac2a9d91d700bc58623ef68765547cc3e">Navier_Stokes_std::uzawa</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; secmem,
<a name="l02174"></a>02174                               <span class="keyword">const</span> <a class="code" href="classMatrice__Base.html">Matrice_Base</a>&amp; A,
<a name="l02175"></a>02175                               <a class="code" href="classSolveurSys.html">SolveurSys</a>&amp; solveur,
<a name="l02176"></a>02176                               <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; U,
<a name="l02177"></a>02177                               <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; P)
<a name="l02178"></a>02178 {
<a name="l02179"></a>02179 <span class="comment">// A U + Bt P = secmem</span>
<a name="l02180"></a>02180 <span class="comment">// B U        = G</span>
<a name="l02181"></a>02181 <span class="comment">// On part de la pression courante et</span>
<a name="l02182"></a>02182 <span class="comment">// secmem = inertie + conv + sources + cl diff</span>
<a name="l02183"></a>02183 <span class="comment">// On part de P0 et U0 verifiant les C.L. et BU0=G</span>
<a name="l02184"></a>02184 
<a name="l02185"></a>02185 <span class="comment">// AU + Bt Cp = secmem</span>
<a name="l02186"></a>02186 <span class="comment">// BU         = 0</span>
<a name="l02187"></a>02187 
<a name="l02188"></a>02188 <span class="comment">// On ecrit un GC sur B(A-1)Bt Cp = B(A-1)(secmem)</span>
<a name="l02189"></a>02189 
<a name="l02190"></a>02190   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> Cu(U);
<a name="l02191"></a>02191   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> grad(U);
<a name="l02192"></a>02192   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> grad0(U);
<a name="l02193"></a>02193   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> resu(P);
<a name="l02194"></a>02194   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> residu(P);
<a name="l02195"></a>02195   <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> Cp(P);
<a name="l02196"></a>02196   <span class="keywordtype">double</span> dold,dnew,alfa;
<a name="l02197"></a>02197   <span class="keywordtype">double</span> seuil=<a class="code" href="classNavier__Stokes__std.html#a83cd41e652d760f61f871626780e898d">seuil_uzawa</a>;
<a name="l02198"></a>02198 
<a name="l02199"></a>02199 <span class="comment">// Cu = A(-1) secmem</span>
<a name="l02200"></a>02200   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Begining Uzawa, secmem norm value : &quot;</span> &lt;&lt; <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(secmem) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02201"></a>02201   P=0.;
<a name="l02202"></a>02202   <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>-&gt;multvect(P, grad0);
<a name="l02203"></a>02203   solveur.<a class="code" href="classSolveurSys.html#a17fa90c93f514a6d2a898e682e724d3b" title="Donne un nom a l&#39;Objet_U Methode virtuelle a surcharger.">nommer</a>(<span class="stringliteral">&quot;uzawa_solver&quot;</span>);
<a name="l02204"></a>02204   solveur.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(A, secmem, U);
<a name="l02205"></a>02205   <a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#a328dc53fbe227ba188eaf55cd98474b8">corriger_solution</a>(U,Cu); <span class="comment">//!&lt; pour les C.L. de Dirichlet!</span>
<a name="l02206"></a>02206 <span class="comment"></span>
<a name="l02207"></a>02207 <span class="comment">// residu=BCu</span>
<a name="l02208"></a>02208   <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>-&gt;multvect(U, resu);
<a name="l02209"></a>02209 
<a name="l02210"></a>02210   residu.<a class="code" href="classDoubleTab.html#aa4dd124734ab5d6cb7aa93a104c0868e">copy</a>(resu);
<a name="l02211"></a>02211   residu*=-1.;
<a name="l02212"></a>02212 
<a name="l02213"></a>02213 <span class="comment">// Cp = -residu;</span>
<a name="l02214"></a>02214   Cp = residu;
<a name="l02215"></a>02215   Cp*=-1;
<a name="l02216"></a>02216   Cp.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
<a name="l02217"></a>02217 
<a name="l02218"></a>02218 <span class="comment">// Carre de la norme</span>
<a name="l02219"></a>02219   dold = <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(residu);
<a name="l02220"></a>02220   dold = dold * dold;
<a name="l02221"></a>02221   dnew = dold;
<a name="l02222"></a>02222 
<a name="l02223"></a>02223   <span class="keywordtype">double</span> s=0;
<a name="l02224"></a>02224   <span class="keywordtype">int</span> niter=0;
<a name="l02225"></a>02225   <span class="keywordtype">int</span> nmax=Cp.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l02226"></a>02226   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Uzawa, initial residue : &quot;</span> &lt;&lt; dnew &lt;&lt; finl;
<a name="l02227"></a>02227 <span class="comment">// seuil=dmax(seuil, dnew*1.e-12);</span>
<a name="l02228"></a>02228   <span class="keywordflow">while</span> ( ( dnew &gt; seuil ) &amp;&amp; (niter++ &lt; nmax) )
<a name="l02229"></a>02229     {
<a name="l02230"></a>02230       <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>-&gt;multvect(Cp, grad);
<a name="l02231"></a>02231       grad-=grad0;
<a name="l02232"></a>02232       grad*=-1;
<a name="l02233"></a>02233       solveur.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(A, grad, Cu);
<a name="l02234"></a>02234       <a class="code" href="classEquation__base.html#adfedf474c07a92f6b2261ca2f1cee80e" title="Renvoie le solveur de masse associe a l&#39;equation.">solv_masse</a>().<a class="code" href="classSolveur__Masse.html#a328dc53fbe227ba188eaf55cd98474b8">corriger_solution</a>(Cu,U); <span class="comment">//!&lt; pour les C.L. de Dirichlet!</span>
<a name="l02235"></a>02235 <span class="comment"></span>      <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>-&gt;multvect(Cu, resu);
<a name="l02236"></a>02236       resu*=-1;
<a name="l02237"></a>02237 
<a name="l02238"></a>02238       s = <a class="code" href="DoubleVect_8cpp.html#a07d13cbdadca6b60d5e128653f52a4bb">mp_prodscal</a>(resu, Cp);
<a name="l02239"></a>02239       alfa = dold/(s);
<a name="l02240"></a>02240       P.<a class="code" href="classDoubleVect.html#a4da8824015866b68783677b1e80f1f9a" title="x+=alpha*y">ajoute</a>(alfa,Cp);
<a name="l02241"></a>02241       residu.<a class="code" href="classDoubleVect.html#a4da8824015866b68783677b1e80f1f9a" title="x+=alpha*y">ajoute</a>(alfa,resu);
<a name="l02242"></a>02242       U.<a class="code" href="classDoubleVect.html#a4da8824015866b68783677b1e80f1f9a" title="x+=alpha*y">ajoute</a>(alfa,Cu);
<a name="l02243"></a>02243       dnew = <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(residu);
<a name="l02244"></a>02244       dnew = dnew * dnew;
<a name="l02245"></a>02245       assert(dnew &gt;= 0);
<a name="l02246"></a>02246       Cp *= (dnew/dold);
<a name="l02247"></a>02247       Cp -= residu;
<a name="l02248"></a>02248       dold = dnew;
<a name="l02249"></a>02249 <span class="comment">// Cerr &lt;&lt; &quot;Uzawa, Residu apres &quot;</span>
<a name="l02250"></a>02250 <span class="comment">// &lt;&lt; niter &lt;&lt; &quot; iterations = &quot; &lt;&lt; dnew &lt;&lt; finl;</span>
<a name="l02251"></a>02251     }
<a name="l02252"></a>02252 
<a name="l02253"></a>02253   <span class="keywordflow">if</span>(dnew &gt; seuil)
<a name="l02254"></a>02254     {
<a name="l02255"></a>02255       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;######## Uzawa, No convergence after : &quot;</span> &lt;&lt; niter &lt;&lt; <span class="stringliteral">&quot; iterations\n&quot;</span>;
<a name="l02256"></a>02256       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;######## Uzawa,  Residue : &quot;</span>&lt;&lt; dnew &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;
<a name="l02257"></a>02257       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l02258"></a>02258     }
<a name="l02259"></a>02259 
<a name="l02260"></a>02260   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>()))
<a name="l02261"></a>02261     {
<a name="l02262"></a>02262       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; finl &lt;&lt; <span class="stringliteral">&quot;Uzawa, convergence reached after &quot;</span> &lt;&lt; niter &lt;&lt; <span class="stringliteral">&quot; iterations&quot;</span> &lt;&lt; finl;
<a name="l02263"></a>02263     }
<a name="l02264"></a>02264   {
<a name="l02265"></a>02265 <span class="comment">// On verifie :</span>
<a name="l02266"></a>02266 
<a name="l02267"></a>02267     <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> R(resu);
<a name="l02268"></a>02268     <a class="code" href="classNavier__Stokes__std.html#a9580035208e30ae398134dee118786fa">divergence</a>-&gt;multvect(U, R);
<a name="l02269"></a>02269     <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Ending Uzawa : mass residue : &quot;</span> &lt;&lt; <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(R) &lt;&lt;finl;
<a name="l02270"></a>02270 
<a name="l02271"></a>02271     <a class="code" href="classNavier__Stokes__std.html#a357e5a57b5e90c4604224112d31d8016">gradient</a>-&gt;multvect(P, grad);
<a name="l02272"></a>02272     grad-=grad0;
<a name="l02273"></a>02273     <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> F(secmem);
<a name="l02274"></a>02274     <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> UU(U);
<a name="l02275"></a>02275     F=secmem;
<a name="l02276"></a>02276     F-=grad;
<a name="l02277"></a>02277 
<a name="l02278"></a>02278     solveur.<a class="code" href="classSolveurSys.html#a62ca198f0c5dc599e53b0535761e5138">resoudre_systeme</a>(A, F, UU);
<a name="l02279"></a>02279     UU-=U;
<a name="l02280"></a>02280     <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Ending Uzawa : Qdm residue : &quot;</span> &lt;&lt; <a class="code" href="DoubleVect_8cpp.html#afaa33f0032aa927d8d54ff9fb002b749">mp_norme_vect</a>(UU)&lt;&lt;finl;
<a name="l02281"></a>02281   }
<a name="l02282"></a>02282 }
<a name="l02283"></a>02283 
<a name="l02284"></a><a class="code" href="classNavier__Stokes__std.html#ad950563c6bc8dded1516dd94cd91e21d">02284</a> <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#ad950563c6bc8dded1516dd94cd91e21d">Navier_Stokes_std::sauver</a>()<span class="keyword"> const</span>
<a name="l02285"></a>02285 <span class="keyword"></span>{
<a name="l02286"></a>02286   <span class="keywordflow">if</span> (<a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>())
<a name="l02287"></a>02287     <a class="code" href="classNavier__Stokes__std.html#ac6f63331af442374f5d769e208c9ad0f">le_traitement_particulier</a>.<a class="code" href="classTraitement__particulier__NS.html#af453e0b2fcccb65966e3c9ffdfaac0a0">sauver_stat</a>();
<a name="l02288"></a>02288 }
<a name="l02289"></a>02289 
<a name="l02290"></a><a class="code" href="classNavier__Stokes__std.html#a1de05cd8d0ca7595e1c1c0e80ca7f8ab">02290</a> <span class="keyword">const</span> <a class="code" href="classChamp__Inc.html">Champ_Inc</a>&amp; <a class="code" href="classNavier__Stokes__std.html#a1de05cd8d0ca7595e1c1c0e80ca7f8ab">Navier_Stokes_std::rho_la_vitesse</a>()<span class="keyword"> const</span>
<a name="l02291"></a>02291 <span class="keyword"></span>{
<a name="l02292"></a>02292   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot; Navier_Stokes_std::rho_la_vitesse() must be overloaded &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l02293"></a>02293   assert(0);
<a name="l02294"></a>02294   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l02295"></a>02295   <span class="keywordflow">throw</span>;
<a name="l02296"></a>02296   <span class="keywordflow">return</span> <a class="code" href="classNavier__Stokes__std.html#a1de05cd8d0ca7595e1c1c0e80ca7f8ab">rho_la_vitesse</a>();
<a name="l02297"></a>02297 }
<a name="l02298"></a>02298 
<a name="l02299"></a><a class="code" href="classNavier__Stokes__std.html#a4dedb77200a30c4a503170ec2dcb89ed">02299</a> <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#a4dedb77200a30c4a503170ec2dcb89ed">Navier_Stokes_std::renewing_jacobians</a>( <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; derivee )
<a name="l02300"></a>02300 {
<a name="l02301"></a>02301 <span class="comment">// nothing to do</span>
<a name="l02302"></a>02302 }
<a name="l02303"></a>02303 
<a name="l02304"></a><a class="code" href="classNavier__Stokes__std.html#a54fbabd340bded8a8dc792c9cf72e121">02304</a> <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#a54fbabd340bded8a8dc792c9cf72e121">Navier_Stokes_std::div_ale_derivative</a>( <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a>&amp; deriveeALE, <span class="keywordtype">double</span> timestep, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; derivee, <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a>&amp; secmemP )
<a name="l02305"></a>02305 {
<a name="l02306"></a>02306 <span class="comment">// nothing to do</span>
<a name="l02307"></a>02307 }
<a name="l02308"></a>02308 
<a name="l02309"></a><a class="code" href="classNavier__Stokes__std.html#aa8c6f4accec70a26369bda20fd024f1f">02309</a> <span class="keywordtype">void</span> <a class="code" href="classNavier__Stokes__std.html#aa8c6f4accec70a26369bda20fd024f1f">Navier_Stokes_std::update_pressure_matrix</a>( <span class="keywordtype">void</span> )
<a name="l02310"></a>02310 {
<a name="l02311"></a>02311 <span class="comment">// nothing to do</span>
<a name="l02312"></a>02312 }
<a name="l02313"></a>02313 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:34 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
