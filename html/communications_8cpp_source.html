<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Utilitaires/communications.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Utilitaires/communications.cpp</div>  </div>
</div>
<div class="contents">
<a href="communications_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2020, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        communications.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Utilitaires</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/25</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="comment">// Fichiers comm.* renommes communications.* car</span>
<a name="l00024"></a>00024 <span class="comment">// il existe des includes systemes nommes comm.h (eg: paradis)</span>
<a name="l00025"></a>00025 <span class="comment">// qui peuvent creer des conflits en compilant avec mpiCC au lieu de g++</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="communications_8h.html">communications.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="communications__array_8h.html">communications_array.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="InOutCommBuffers_8h.html">InOutCommBuffers.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Comm__Group_8h.html">Comm_Group.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="PE__Groups_8h.html">PE_Groups.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Schema__Comm_8h.html">Schema_Comm.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="DoubleTabs_8h.html">DoubleTabs.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="Vect__ArrOfInt_8h.html">Vect_ArrOfInt.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Motcle_8h.html">Motcle.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="DerOu___8h.html">DerOu_.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="IntTab_8h.html">IntTab.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00038"></a>00038 <span class="comment">//</span>
<a name="l00039"></a>00039 <span class="comment">//</span>
<a name="l00040"></a>00040 <span class="comment">//</span>
<a name="l00041"></a>00041 <span class="comment">//</span>
<a name="l00042"></a>00042 <span class="comment">//</span>
<a name="l00043"></a>00043 <span class="comment">//</span>
<a name="l00044"></a>00044 <span class="comment">//</span>
<a name="l00045"></a>00045 <span class="comment">//</span>
<a name="l00046"></a>00046 <span class="comment">//</span>
<a name="l00047"></a>00047 <span class="comment">//</span>
<a name="l00048"></a>00048 <span class="comment">//</span>
<a name="l00049"></a>00049 <span class="comment">//</span>
<a name="l00050"></a>00050 <span class="comment">//</span>
<a name="l00051"></a>00051 <span class="comment">//</span>
<a name="l00052"></a>00052 <span class="comment">//</span>
<a name="l00053"></a>00053 <span class="comment">//</span>
<a name="l00054"></a>00054 <span class="comment">//</span>
<a name="l00055"></a>00055 <span class="comment">//</span>
<a name="l00056"></a>00056 <span class="comment">//</span>
<a name="l00057"></a>00057 <span class="comment">//</span>
<a name="l00058"></a>00058 <span class="comment">//</span>
<a name="l00059"></a>00059 <span class="comment">//</span>
<a name="l00060"></a>00060 <span class="comment">//</span>
<a name="l00061"></a>00061 <span class="comment">//</span>
<a name="l00062"></a>00062 <span class="comment">//</span>
<a name="l00063"></a>00063 <span class="comment">//</span>
<a name="l00064"></a>00064 <span class="comment">//</span>
<a name="l00065"></a>00065 <span class="comment">//</span>
<a name="l00066"></a>00066 <span class="comment">//</span>
<a name="l00067"></a>00067 <span class="comment">//</span>
<a name="l00068"></a>00068 <span class="comment">//</span>
<a name="l00069"></a>00069 <span class="comment">//</span>
<a name="l00070"></a>00070 <span class="comment">//</span>
<a name="l00071"></a>00071 <span class="comment">//</span>
<a name="l00072"></a>00072 <span class="comment">//</span><span class="comment"></span>
<a name="l00073"></a>00073 <span class="comment">//! Envoi de messages point-to-point synchrone entre la source et la cible.&lt;br&gt;La fonction envoyer se termine au plus tard lorsque le message a ete&lt;br&gt;recu par l&#39;instruction &quot;recevoir&quot; correspondante  et l&#39;envoi peut etre blocant&lt;br&gt;(le blocage est force en mode debug, selon Comm_Group::check_enabled() )&lt;br&gt;Ces communications utilisent Comm_Group::send() et Comm_Group::recv()&lt;br&gt;Exemples d&#39;utilisations possibles:&lt;br&gt;1) communication point-a-point (processeur 2 vers processeur 5)&lt;br&gt;if (me() == 2)&lt;br&gt;envoyer(objet, 5, canal);&lt;br&gt;else if (me() == 5)&lt;br&gt;recevoir(objet, 2, canal);&lt;br&gt;ou de facon equivalente :&lt;br&gt;envoyer(objet, 2, 5, canal); // ne fait rien sur les processeurs autres que 2&lt;br&gt;recevoir(objet, 2, 5, canal); // ne fait rien sur les processeurs autres que 5&lt;br&gt;2) gather : le processeur 0 recupere les donnees de l&#39;objet t de tout le monde&lt;br&gt;envoyer(t, me(), 0, canal); // Tout le monde envoie au processeur 0, sur le maitre, ne fait rien&lt;br&gt;if (je_suis_maitre())&lt;br&gt;for (i = 0; i &lt; nproc(); i++) {&lt;br&gt;recevoir(t, 0, i; canal); // Si i==0, ne fait rien.&lt;br&gt;... faire quelque chose avec t&lt;br&gt;}&lt;br&gt;3) broadcast : le processeur 0 envoie l&#39;objet a tous les autres processeurs&lt;br&gt;Il n&#39;est pas necessaire de faire le test &quot;if (je_suis_maitre())&quot;&lt;br&gt;envoyer(objet, 0, -1, canal); // Les processeurs autres que 0 ignorent l&#39;appel&lt;br&gt;recevoir(objet, 0, -1, canal);// Le processeur 0 ignore l&#39;appel&lt;br&gt;Il vaut mieux utiliser envoyer_broadcast() pour cet usage.&lt;br&gt;4) broadcast : ecriture equivalente&lt;br&gt;if (je_suis_maitre())&lt;br&gt;envoyer(objet, -1, canal); // Emission par le maitre a tous les processeurs, sauf lui-meme&lt;br&gt;else&lt;br&gt;recevoir(objet, 0, canal); // Reception d&#39;un message du processeur maitre&lt;br&gt;Il vaut mieux utiliser envoyer_broadcast() pour cet usage.&lt;br&gt;Dans l&#39;implementation de envoyer_, on encapsule l&#39;objet recu dans un buffer et on envoie le buffer.&lt;br&gt;Ca marche donc pour les types complexes pourvu que Entree et Sortie sachent lire et ecrire l&#39;objet.&lt;br&gt;Chaque envoi necessite l&#39;envoi de deux messages : d&#39;abord la taille du buffer, puis le contenu.</span>
<a name="l00074"></a><a class="code" href="communications_8cpp.html#ad12997c063e6bdbab6f9aaffb326f140">00074</a> <span class="comment"></span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#ad12997c063e6bdbab6f9aaffb326f140" title="Envoi de messages point-to-point synchrone entre la source et la cible. La fonction envoyer se termin...">envoyer_buffered_</a>(<span class="keyword">const</span> T&amp; objet, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal)
<a name="l00075"></a>00075 {
<a name="l00076"></a>00076   <span class="keyword">const</span> <span class="keywordtype">int</span> moi = <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>();
<a name="l00077"></a>00077   <span class="keywordflow">if</span> (moi == cible)
<a name="l00078"></a>00078     <span class="keywordflow">return</span> 0;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080   <span class="keywordflow">if</span> (source != moi &amp;&amp; source != -1)
<a name="l00081"></a>00081     <span class="keywordflow">return</span> 0;
<a name="l00082"></a>00082 
<a name="l00083"></a>00083   <a class="code" href="classOutputCommBuffer.html" title=": Classe outil utilisee exclusivement par Schema_Comm. C&#39;est une classe derivee de Entree dont le str...">OutputCommBuffer</a> buffer;
<a name="l00084"></a>00084   buffer &lt;&lt; objet;
<a name="l00085"></a>00085   <span class="keyword">const</span> <span class="keywordtype">char</span> * data = buffer.<a class="code" href="classOutputCommBuffer.html#ad4526ebfe5863c4009c858d59576c638">get_buffer</a>();
<a name="l00086"></a>00086   <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a>   = buffer.<a class="code" href="classOutputCommBuffer.html#a3dd24532686e8a731b2809b0049c7a4c">get_buffer_size</a>();
<a name="l00087"></a>00087   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00088"></a>00088   <span class="keywordflow">if</span> (cible &lt; 0)
<a name="l00089"></a>00089     {
<a name="l00090"></a>00090       <span class="keyword">const</span> <span class="keywordtype">int</span> n = grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>();
<a name="l00091"></a>00091       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l00092"></a>00092         {
<a name="l00093"></a>00093           <span class="keywordflow">if</span> (i != moi)
<a name="l00094"></a>00094             {
<a name="l00095"></a>00095               grp.<a class="code" href="classComm__Group.html#a5489eba2c9ba6099899f96e2621131f6" title="Envoi bloquant.">send</a>(i, &amp;sz, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), canal);
<a name="l00096"></a>00096               grp.<a class="code" href="classComm__Group.html#a5489eba2c9ba6099899f96e2621131f6" title="Envoi bloquant.">send</a>(i, data, sz, canal);
<a name="l00097"></a>00097             }
<a name="l00098"></a>00098         }
<a name="l00099"></a>00099     }
<a name="l00100"></a>00100   <span class="keywordflow">else</span>
<a name="l00101"></a>00101     {
<a name="l00102"></a>00102       grp.<a class="code" href="classComm__Group.html#a5489eba2c9ba6099899f96e2621131f6" title="Envoi bloquant.">send</a>(cible, &amp;sz, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), canal);
<a name="l00103"></a>00103       grp.<a class="code" href="classComm__Group.html#a5489eba2c9ba6099899f96e2621131f6" title="Envoi bloquant.">send</a>(cible, data, sz, canal);
<a name="l00104"></a>00104     }
<a name="l00105"></a>00105   <span class="keywordflow">return</span> 1;
<a name="l00106"></a>00106 }
<a name="l00107"></a>00107 <span class="comment"></span>
<a name="l00108"></a>00108 <span class="comment">//! Reception d&#39;un message en provenance du processeur source</span>
<a name="l00109"></a><a class="code" href="communications_8cpp.html#a951bf6a97290cbf68e148102dc94049e">00109</a> <span class="comment"></span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a951bf6a97290cbf68e148102dc94049e" title="Reception d&#39;un message en provenance du processeur source.">recevoir_buffered_</a>(T&amp; objet, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal)
<a name="l00110"></a>00110 {
<a name="l00111"></a>00111   <span class="keyword">const</span> <span class="keywordtype">int</span> moi = <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>();
<a name="l00112"></a>00112   <span class="keywordflow">if</span> (moi == source)
<a name="l00113"></a>00113     <span class="keywordflow">return</span> 0;
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="keywordflow">if</span> (cible != moi &amp;&amp; cible != -1)
<a name="l00116"></a>00116     <span class="keywordflow">return</span> 0;
<a name="l00117"></a>00117 
<a name="l00118"></a>00118   <span class="keywordtype">int</span> <a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a>;
<a name="l00119"></a>00119   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00120"></a>00120   grp.<a class="code" href="classComm__Group.html#ae3622cd7a58e3dfeba7bf9496c298d0f" title="Reception bloquante.">recv</a>(source, &amp;sz, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), canal);
<a name="l00121"></a>00121   <a class="code" href="classInputCommBuffer.html" title=": Classe outil utilisee exclusivement par Schema_Comm. C&#39;est une classe derivee de Entree dont le str...">InputCommBuffer</a> buffer;
<a name="l00122"></a>00122   <span class="keywordtype">char</span> * data = buffer.<a class="code" href="classInputCommBuffer.html#a1ea808033309fd6c3def0db5ac439fa4">reserve_buffer</a>(sz);
<a name="l00123"></a>00123   grp.<a class="code" href="classComm__Group.html#ae3622cd7a58e3dfeba7bf9496c298d0f" title="Reception bloquante.">recv</a>(source, data, sz, canal);
<a name="l00124"></a>00124   buffer.<a class="code" href="classInputCommBuffer.html#a3a272bcedfa78423e2fb29084334000a">create_stream</a>();
<a name="l00125"></a>00125   buffer &gt;&gt; objet;
<a name="l00126"></a>00126   buffer.<a class="code" href="classInputCommBuffer.html#a4df9114080cacee52c46a14ad052509a">clear</a>();
<a name="l00127"></a>00127   <span class="keywordflow">return</span> 1;
<a name="l00128"></a>00128 }
<a name="l00129"></a>00129 
<a name="l00130"></a>00130 <span class="comment">// Attention: le template ne marche que pour les types simples (pas Objet_U !)</span>
<a name="l00131"></a>00131 <span class="comment">// On ne passe pas par un buffer Entree / Sortie mais on envoie directement le tableau sous sa forme binaire.</span>
<a name="l00132"></a>00132 <span class="comment">// Un seul message envoye, sauf en mode check() ou on envoie aussi la taille pour verifier.</span>
<a name="l00133"></a><a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">00133</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(<span class="keyword">const</span> T * objet, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal)
<a name="l00134"></a>00134 {
<a name="l00135"></a>00135   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00136"></a>00136   <span class="keyword">const</span> <span class="keywordtype">int</span> moi = grp.<a class="code" href="classComm__Group.html#a4ce6b03e1167d23c5e0e1e3447012c51" title="Renvoie le rang du processeur local dans le groupe *this. ou -1 si je ne suis pas dans le groupe...">rank</a>();
<a name="l00137"></a>00137   <span class="keywordflow">if</span> (moi == cible)
<a name="l00138"></a>00138     <span class="keywordflow">return</span> 0;
<a name="l00139"></a>00139 
<a name="l00140"></a>00140   <span class="keywordflow">if</span> (source != moi &amp;&amp; source != -1)
<a name="l00141"></a>00141     <span class="keywordflow">return</span> 0;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143   <span class="keyword">const</span> <span class="keywordtype">char</span> * data = (<span class="keyword">const</span> <span class="keywordtype">char</span>*) objet;
<a name="l00144"></a>00144   <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a>   = <span class="keyword">sizeof</span>(T) * n;
<a name="l00145"></a>00145   <span class="keywordflow">if</span> (cible &lt; 0)
<a name="l00146"></a>00146     {
<a name="l00147"></a>00147       <span class="keyword">const</span> <span class="keywordtype">int</span> nbproc = grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>();
<a name="l00148"></a>00148       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbproc; i++)
<a name="l00149"></a>00149         {
<a name="l00150"></a>00150           <span class="keywordflow">if</span> (i != moi)
<a name="l00151"></a>00151             {
<a name="l00152"></a>00152 <span class="comment">// En mode check, on verifie que n est bien le meme sur l&#39;expediteur et le recepteur</span>
<a name="l00153"></a>00153               <span class="keywordflow">if</span> (grp.<a class="code" href="classComm__Group.html#a0f230fe65c9f52fd2a168a1ea70e7b15">check_enabled</a>())
<a name="l00154"></a>00154                 grp.<a class="code" href="classComm__Group.html#a5489eba2c9ba6099899f96e2621131f6" title="Envoi bloquant.">send</a>(i, &amp;sz, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), canal);
<a name="l00155"></a>00155               <span class="keywordflow">if</span> (sz &gt; 0)
<a name="l00156"></a>00156                 grp.<a class="code" href="classComm__Group.html#a5489eba2c9ba6099899f96e2621131f6" title="Envoi bloquant.">send</a>(i, data, sz, canal);
<a name="l00157"></a>00157             }
<a name="l00158"></a>00158         }
<a name="l00159"></a>00159     }
<a name="l00160"></a>00160   <span class="keywordflow">else</span>
<a name="l00161"></a>00161     {
<a name="l00162"></a>00162       <span class="keywordflow">if</span> (grp.<a class="code" href="classComm__Group.html#a0f230fe65c9f52fd2a168a1ea70e7b15">check_enabled</a>())
<a name="l00163"></a>00163         grp.<a class="code" href="classComm__Group.html#a5489eba2c9ba6099899f96e2621131f6" title="Envoi bloquant.">send</a>(cible, &amp;sz, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), canal);
<a name="l00164"></a>00164       <span class="keywordflow">if</span> (sz &gt; 0)
<a name="l00165"></a>00165         grp.<a class="code" href="classComm__Group.html#a5489eba2c9ba6099899f96e2621131f6" title="Envoi bloquant.">send</a>(cible, data, sz, canal);
<a name="l00166"></a>00166     }
<a name="l00167"></a>00167   <span class="keywordflow">return</span> 1;
<a name="l00168"></a>00168 }
<a name="l00169"></a>00169 
<a name="l00170"></a><a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">00170</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(T * objet, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal)
<a name="l00171"></a>00171 {
<a name="l00172"></a>00172   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00173"></a>00173   <span class="keyword">const</span> <span class="keywordtype">int</span> moi = grp.<a class="code" href="classComm__Group.html#a4ce6b03e1167d23c5e0e1e3447012c51" title="Renvoie le rang du processeur local dans le groupe *this. ou -1 si je ne suis pas dans le groupe...">rank</a>();
<a name="l00174"></a>00174   <span class="keywordflow">if</span> (moi == source)
<a name="l00175"></a>00175     <span class="keywordflow">return</span> 0;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177   <span class="keywordflow">if</span> (cible != moi &amp;&amp; cible != -1)
<a name="l00178"></a>00178     <span class="keywordflow">return</span> 0;
<a name="l00179"></a>00179 
<a name="l00180"></a>00180   <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a> = <span class="keyword">sizeof</span>(T) * n;
<a name="l00181"></a>00181   <span class="keywordflow">if</span> (grp.<a class="code" href="classComm__Group.html#a0f230fe65c9f52fd2a168a1ea70e7b15">check_enabled</a>())
<a name="l00182"></a>00182     {
<a name="l00183"></a>00183       <span class="keywordtype">int</span> sz_check;
<a name="l00184"></a>00184       grp.<a class="code" href="classComm__Group.html#ae3622cd7a58e3dfeba7bf9496c298d0f" title="Reception bloquante.">recv</a>(source, &amp;sz_check, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), canal);
<a name="l00185"></a>00185       <span class="keywordflow">if</span> (sz_check != sz)
<a name="l00186"></a>00186         {
<a name="l00187"></a>00187           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Fatal error in template &lt;class T&gt; int recevoir_array_ : incorrect size\n&quot;</span>
<a name="l00188"></a>00188                &lt;&lt; <span class="stringliteral">&quot; sent=&quot;</span> &lt;&lt; sz_check &lt;&lt; <span class="stringliteral">&quot; expected=&quot;</span> &lt;&lt; sz &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00189"></a>00189           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00190"></a>00190         }
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192   <span class="keywordtype">char</span> * data = (<span class="keywordtype">char</span>*) objet;
<a name="l00193"></a>00193   <span class="keywordflow">if</span> (sz &gt; 0)
<a name="l00194"></a>00194     grp.<a class="code" href="classComm__Group.html#ae3622cd7a58e3dfeba7bf9496c298d0f" title="Reception bloquante.">recv</a>(source, data, sz, canal);
<a name="l00195"></a>00195   <span class="keywordflow">return</span> 1;
<a name="l00196"></a>00196 }
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 <span class="comment">// Pour les types simples, on passe par envoyer_array_ qui n&#39;utilise pas un buffer mais envoie directement</span>
<a name="l00199"></a>00199 <span class="comment">// les valeurs. Plus rapide.</span>
<a name="l00200"></a><a class="code" href="communications_8h.html#af9feb6405277b375b2ebcbfaec9f8af3">00200</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#af9feb6405277b375b2ebcbfaec9f8af3">envoyer</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp;   t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00201"></a>00201 {
<a name="l00202"></a>00202   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(&amp;t, 1, source, cible, canal);
<a name="l00203"></a>00203 }
<a name="l00204"></a>00204 <span class="preprocessor">#ifndef INT_is_64_</span>
<a name="l00205"></a><a class="code" href="communications_8h.html#a2e22da54b0f72e5cf8d14ede79039b62">00205</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#af9feb6405277b375b2ebcbfaec9f8af3">envoyer</a>(<span class="keyword">const</span> <span class="keywordtype">long</span>&amp;     t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00206"></a>00206 {
<a name="l00207"></a>00207   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(&amp;t, 1, source, cible, canal);
<a name="l00208"></a>00208 }
<a name="l00209"></a>00209 <span class="preprocessor">#endif</span>
<a name="l00210"></a><a class="code" href="communications_8h.html#a581495a97568959fef0683e7f64da0be">00210</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#af9feb6405277b375b2ebcbfaec9f8af3">envoyer</a>(<span class="keyword">const</span> <span class="keywordtype">float</span>&amp;    t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(&amp;t, 1, source, cible, canal);
<a name="l00213"></a>00213 }
<a name="l00214"></a><a class="code" href="communications_8h.html#a4e1dd31ae99e8ca7112d60051b3ce4a7">00214</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#af9feb6405277b375b2ebcbfaec9f8af3">envoyer</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp;   t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00215"></a>00215 {
<a name="l00216"></a>00216   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(&amp;t, 1, source, cible, canal);
<a name="l00217"></a>00217 }
<a name="l00218"></a><a class="code" href="communications_8h.html#adf84865cbc943510d0bbef3fa31be03b">00218</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#af9feb6405277b375b2ebcbfaec9f8af3">envoyer</a>(<span class="keyword">const</span> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00219"></a>00219 {
<a name="l00220"></a>00220   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#ad12997c063e6bdbab6f9aaffb326f140" title="Envoi de messages point-to-point synchrone entre la source et la cible. La fonction envoyer se termin...">envoyer_buffered_</a>(t, source, cible, canal);
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="communications_8h.html#a44d47ca1a5e3ff2aa84a44764044ffd2">00223</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#af9feb6405277b375b2ebcbfaec9f8af3">envoyer</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp;   t, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00224"></a>00224 {
<a name="l00225"></a>00225   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(&amp;t, 1, <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), cible, canal);
<a name="l00226"></a>00226 }
<a name="l00227"></a>00227 <span class="preprocessor">#ifndef INT_is_64_</span>
<a name="l00228"></a><a class="code" href="communications_8h.html#a0bf9a21999ce4a784846bcf2240f4ea5">00228</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#af9feb6405277b375b2ebcbfaec9f8af3">envoyer</a>(<span class="keyword">const</span> <span class="keywordtype">long</span>&amp;     t, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00229"></a>00229 {
<a name="l00230"></a>00230   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(&amp;t, 1, <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), cible, canal);
<a name="l00231"></a>00231 }
<a name="l00232"></a>00232 <span class="preprocessor">#endif</span>
<a name="l00233"></a><a class="code" href="communications_8h.html#ad98f4216d2e2b0dd4a224f05ddbcc8e0">00233</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#af9feb6405277b375b2ebcbfaec9f8af3">envoyer</a>(<span class="keyword">const</span> <span class="keywordtype">float</span>&amp;    t, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00234"></a>00234 {
<a name="l00235"></a>00235   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(&amp;t, 1, <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), cible, canal);
<a name="l00236"></a>00236 }
<a name="l00237"></a><a class="code" href="communications_8h.html#ab037cb5312c10de24e1ea9dd825210d0">00237</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#af9feb6405277b375b2ebcbfaec9f8af3">envoyer</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp;   t, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00238"></a>00238 {
<a name="l00239"></a>00239   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(&amp;t, 1, <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), cible, canal);
<a name="l00240"></a>00240 }
<a name="l00241"></a><a class="code" href="communications_8h.html#a59143ab4a5497e6ffb3880d50e4ae480">00241</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#af9feb6405277b375b2ebcbfaec9f8af3">envoyer</a>(<span class="keyword">const</span> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; t, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00242"></a>00242 {
<a name="l00243"></a>00243   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#ad12997c063e6bdbab6f9aaffb326f140" title="Envoi de messages point-to-point synchrone entre la source et la cible. La fonction envoyer se termin...">envoyer_buffered_</a>(t, <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), cible, canal);
<a name="l00244"></a>00244 }
<a name="l00245"></a>00245 
<a name="l00246"></a><a class="code" href="communications_8h.html#a729d9499913e22a5f0db62ef07b9793f">00246</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a729d9499913e22a5f0db62ef07b9793f">recevoir</a>(<span class="keywordtype">int</span>&amp; t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00247"></a>00247 {
<a name="l00248"></a>00248   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(&amp;t, 1, source, cible, canal);
<a name="l00249"></a>00249 }
<a name="l00250"></a>00250 <span class="preprocessor">#ifndef INT_is_64_</span>
<a name="l00251"></a><a class="code" href="communications_8h.html#acb418a58e08b11386a210b7c3f9731d2">00251</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a729d9499913e22a5f0db62ef07b9793f">recevoir</a>(<span class="keywordtype">long</span>&amp;     t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00252"></a>00252 {
<a name="l00253"></a>00253   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(&amp;t, 1, source, cible, canal);
<a name="l00254"></a>00254 }
<a name="l00255"></a>00255 <span class="preprocessor">#endif</span>
<a name="l00256"></a><a class="code" href="communications_8h.html#a1e63248580aaf36b6cb9db0074172bd8">00256</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a729d9499913e22a5f0db62ef07b9793f">recevoir</a>(<span class="keywordtype">float</span>&amp;    t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00257"></a>00257 {
<a name="l00258"></a>00258   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(&amp;t, 1, source, cible, canal);
<a name="l00259"></a>00259 }
<a name="l00260"></a><a class="code" href="communications_8h.html#a34c2f9eb6581668b35e8879a153ced5e">00260</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a729d9499913e22a5f0db62ef07b9793f">recevoir</a>(<span class="keywordtype">double</span>&amp;   t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00261"></a>00261 {
<a name="l00262"></a>00262   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(&amp;t, 1, source, cible, canal);
<a name="l00263"></a>00263 }
<a name="l00264"></a><a class="code" href="communications_8h.html#a486fb18563e940716d63be14ea997826">00264</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a729d9499913e22a5f0db62ef07b9793f">recevoir</a>(<a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00265"></a>00265 {
<a name="l00266"></a>00266   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a951bf6a97290cbf68e148102dc94049e" title="Reception d&#39;un message en provenance du processeur source.">recevoir_buffered_</a>(t, source, cible, canal);
<a name="l00267"></a>00267 }
<a name="l00268"></a>00268 
<a name="l00269"></a><a class="code" href="communications_8h.html#ae32fddddd8024de409e595405da7b1de">00269</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a729d9499913e22a5f0db62ef07b9793f">recevoir</a>(<span class="keywordtype">int</span>&amp; t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> canal )
<a name="l00270"></a>00270 {
<a name="l00271"></a>00271   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(&amp;t, 1, source, <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), canal);
<a name="l00272"></a>00272 }
<a name="l00273"></a>00273 <span class="preprocessor">#ifndef INT_is_64_</span>
<a name="l00274"></a><a class="code" href="communications_8h.html#a054f21f5fe3739d1a948729e28291d9b">00274</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a729d9499913e22a5f0db62ef07b9793f">recevoir</a>(<span class="keywordtype">long</span>&amp;     t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> canal )
<a name="l00275"></a>00275 {
<a name="l00276"></a>00276   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(&amp;t, 1, source, <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), canal);
<a name="l00277"></a>00277 }
<a name="l00278"></a>00278 <span class="preprocessor">#endif</span>
<a name="l00279"></a><a class="code" href="communications_8h.html#a36f6ecb5e8a160366f50575684307634">00279</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a729d9499913e22a5f0db62ef07b9793f">recevoir</a>(<span class="keywordtype">float</span>&amp;    t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> canal )
<a name="l00280"></a>00280 {
<a name="l00281"></a>00281   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(&amp;t, 1, source, <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), canal);
<a name="l00282"></a>00282 }
<a name="l00283"></a><a class="code" href="communications_8h.html#a2bfed459236dd2e24399b9b5af8b1ead">00283</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a729d9499913e22a5f0db62ef07b9793f">recevoir</a>(<span class="keywordtype">double</span>&amp;   t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> canal )
<a name="l00284"></a>00284 {
<a name="l00285"></a>00285   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(&amp;t, 1, source, <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), canal);
<a name="l00286"></a>00286 }
<a name="l00287"></a><a class="code" href="communications_8h.html#af7c14d8a308c9f2f070023193744b971">00287</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a729d9499913e22a5f0db62ef07b9793f">recevoir</a>(<a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; t, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> canal )
<a name="l00288"></a>00288 {
<a name="l00289"></a>00289   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a951bf6a97290cbf68e148102dc94049e" title="Reception d&#39;un message en provenance du processeur source.">recevoir_buffered_</a>(t, source, <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), canal);
<a name="l00290"></a>00290 }
<a name="l00291"></a>00291 
<a name="l00292"></a><a class="code" href="communications__array_8h.html#a04e95dd4fe1420ee75d0deff4bdaa110">00292</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a04e95dd4fe1420ee75d0deff4bdaa110">envoyer_array</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>  * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00293"></a>00293 {
<a name="l00294"></a>00294   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(t, n, source, cible, canal);
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 <span class="preprocessor">#ifndef INT_is_64_</span>
<a name="l00297"></a><a class="code" href="communications__array_8h.html#a3400d648d176fe302a76dcb636b33c67">00297</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a04e95dd4fe1420ee75d0deff4bdaa110">envoyer_array</a>(<span class="keyword">const</span> <span class="keywordtype">long</span>    * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00298"></a>00298 {
<a name="l00299"></a>00299   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(t, n, source, cible, canal);
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 <span class="preprocessor">#endif</span>
<a name="l00302"></a><a class="code" href="communications__array_8h.html#a5afa956d41755f6475e108fc718fd420">00302</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a04e95dd4fe1420ee75d0deff4bdaa110">envoyer_array</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>  * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(t, n, source, cible, canal);
<a name="l00305"></a>00305 }
<a name="l00306"></a><a class="code" href="communications__array_8h.html#a15a001432ac989bcc7461c99389300f6">00306</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a04e95dd4fe1420ee75d0deff4bdaa110">envoyer_array</a>(<span class="keyword">const</span> <span class="keywordtype">float</span>   * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00307"></a>00307 {
<a name="l00308"></a>00308   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a65678f9ed38807067ae3fa15cd66806f">envoyer_array_</a>(t, n, source, cible, canal);
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a><a class="code" href="communications__array_8h.html#a12a1890122da2d6748f2acfed84cc94d">00311</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a12a1890122da2d6748f2acfed84cc94d">recevoir_array</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>  * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00312"></a>00312 {
<a name="l00313"></a>00313   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(t, n, source, cible, canal);
<a name="l00314"></a>00314 }
<a name="l00315"></a>00315 <span class="preprocessor">#ifndef INT_is_64_</span>
<a name="l00316"></a><a class="code" href="communications__array_8h.html#ab0fd47692366fcbf5bc67370e5e35c83">00316</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a12a1890122da2d6748f2acfed84cc94d">recevoir_array</a>(<span class="keyword">const</span> <span class="keywordtype">long</span>    * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00317"></a>00317 {
<a name="l00318"></a>00318   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(t, n, source, cible, canal);
<a name="l00319"></a>00319 }
<a name="l00320"></a>00320 <span class="preprocessor">#endif</span>
<a name="l00321"></a><a class="code" href="communications__array_8h.html#a602373579fb2a3fc8c4f893a61f19060">00321</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a12a1890122da2d6748f2acfed84cc94d">recevoir_array</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>  * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00322"></a>00322 {
<a name="l00323"></a>00323   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(t, n, source, cible, canal);
<a name="l00324"></a>00324 }
<a name="l00325"></a><a class="code" href="communications__array_8h.html#a92e9faa8413ec5e3162ecda0213c6d08">00325</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a12a1890122da2d6748f2acfed84cc94d">recevoir_array</a>(<span class="keyword">const</span> <span class="keywordtype">float</span>   * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source, <span class="keywordtype">int</span> cible, <span class="keywordtype">int</span> canal )
<a name="l00326"></a>00326 {
<a name="l00327"></a>00327   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a8e26e50e5b7d8b2dda73202a50369ef5">recevoir_array_</a>(t, n, source, cible, canal);
<a name="l00328"></a>00328 }
<a name="l00329"></a>00329 
<a name="l00330"></a><a class="code" href="communications_8cpp.html#af0ca1aabc59ab95f2bce20e361f5acdd">00330</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#af0ca1aabc59ab95f2bce20e361f5acdd">envoyer_broadcast_</a>(T * objet, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source)
<a name="l00331"></a>00331 {
<a name="l00332"></a>00332   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00333"></a>00333   <span class="keywordflow">if</span> (grp.<a class="code" href="classComm__Group.html#a0f230fe65c9f52fd2a168a1ea70e7b15">check_enabled</a>())
<a name="l00334"></a>00334     {
<a name="l00335"></a>00335       <span class="keywordtype">int</span> copie_n = n;
<a name="l00336"></a>00336       grp.<a class="code" href="classComm__Group.html#a9e33e15e2e719843a0c42afc348f7a10">broadcast</a>(&amp;copie_n, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), source);
<a name="l00337"></a>00337       <span class="keywordflow">if</span> (copie_n != n)
<a name="l00338"></a>00338         {
<a name="l00339"></a>00339           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in envoyer_broadcast_(T * objet, int n, int source)&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00340"></a>00340           <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00341"></a>00341         }
<a name="l00342"></a>00342     }
<a name="l00343"></a>00343   grp.<a class="code" href="classComm__Group.html#a9e33e15e2e719843a0c42afc348f7a10">broadcast</a>(objet, <span class="keyword">sizeof</span>(T) * n, source);
<a name="l00344"></a>00344   <span class="keywordflow">return</span> 1;
<a name="l00345"></a>00345 }
<a name="l00346"></a>00346 
<a name="l00347"></a>00347 <span class="comment">//</span><span class="comment"></span>
<a name="l00348"></a>00348 <span class="comment">//! Broadcast de l&#39;objet par le processeur source a tous les autres processeurs.&lt;br&gt;Fonctionne pour des types complexes supportes par Entree ou Sortie.</span>
<a name="l00349"></a><a class="code" href="communications_8cpp.html#a951d785ca3c2ffeba337363a7ad838ea">00349</a> <span class="comment"></span><span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a951d785ca3c2ffeba337363a7ad838ea" title="Broadcast de l&#39;objet par le processeur source a tous les autres processeurs. Fonctionne pour des type...">envoyer_broadcast_buffered_</a>(T&amp; objet, <span class="keywordtype">int</span> source)
<a name="l00350"></a>00350 {
<a name="l00351"></a>00351   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00352"></a>00352   <span class="keywordflow">if</span> (grp.<a class="code" href="classComm__Group.html#a4ce6b03e1167d23c5e0e1e3447012c51" title="Renvoie le rang du processeur local dans le groupe *this. ou -1 si je ne suis pas dans le groupe...">rank</a>() == source)
<a name="l00353"></a>00353     {
<a name="l00354"></a>00354       <a class="code" href="classOutputCommBuffer.html" title=": Classe outil utilisee exclusivement par Schema_Comm. C&#39;est une classe derivee de Entree dont le str...">OutputCommBuffer</a> buffer;
<a name="l00355"></a>00355       buffer &lt;&lt; objet;
<a name="l00356"></a>00356       <span class="keyword">const</span> <span class="keywordtype">char</span> * data = buffer.<a class="code" href="classOutputCommBuffer.html#ad4526ebfe5863c4009c858d59576c638">get_buffer</a>();
<a name="l00357"></a>00357       <span class="keywordtype">int</span> <a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a>   = buffer.<a class="code" href="classOutputCommBuffer.html#a3dd24532686e8a731b2809b0049c7a4c">get_buffer_size</a>();
<a name="l00358"></a>00358       grp.<a class="code" href="classComm__Group.html#a9e33e15e2e719843a0c42afc348f7a10">broadcast</a>(&amp;sz, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), source);
<a name="l00359"></a>00359       grp.<a class="code" href="classComm__Group.html#a9e33e15e2e719843a0c42afc348f7a10">broadcast</a>((<span class="keywordtype">char</span>*) data, sz, source);
<a name="l00360"></a>00360     }
<a name="l00361"></a>00361   <span class="keywordflow">else</span>
<a name="l00362"></a>00362     {
<a name="l00363"></a>00363       <span class="keywordtype">int</span> <a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a>;
<a name="l00364"></a>00364       grp.<a class="code" href="classComm__Group.html#a9e33e15e2e719843a0c42afc348f7a10">broadcast</a>(&amp;sz, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), source);
<a name="l00365"></a>00365       <a class="code" href="classInputCommBuffer.html" title=": Classe outil utilisee exclusivement par Schema_Comm. C&#39;est une classe derivee de Entree dont le str...">InputCommBuffer</a> buffer;
<a name="l00366"></a>00366       <span class="keywordtype">char</span> * data = buffer.<a class="code" href="classInputCommBuffer.html#a1ea808033309fd6c3def0db5ac439fa4">reserve_buffer</a>(sz);
<a name="l00367"></a>00367       grp.<a class="code" href="classComm__Group.html#a9e33e15e2e719843a0c42afc348f7a10">broadcast</a>((<span class="keywordtype">char</span>*) data, sz, source);
<a name="l00368"></a>00368       buffer.<a class="code" href="classInputCommBuffer.html#a3a272bcedfa78423e2fb29084334000a">create_stream</a>();
<a name="l00369"></a>00369       buffer &gt;&gt; objet;
<a name="l00370"></a>00370       buffer.<a class="code" href="classInputCommBuffer.html#a4df9114080cacee52c46a14ad052509a">clear</a>();
<a name="l00371"></a>00371     }
<a name="l00372"></a>00372   <span class="keywordflow">return</span> 1;
<a name="l00373"></a>00373 }
<a name="l00374"></a>00374 
<a name="l00375"></a><a class="code" href="communications_8h.html#a2335b36078ae87e23dab400a6e129a3c">00375</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a2335b36078ae87e23dab400a6e129a3c">envoyer_broadcast</a>(<span class="keywordtype">int</span>&amp; t, <span class="keywordtype">int</span> source)
<a name="l00376"></a>00376 {
<a name="l00377"></a>00377   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#af0ca1aabc59ab95f2bce20e361f5acdd">envoyer_broadcast_</a>(&amp;t, 1, source);
<a name="l00378"></a>00378 }
<a name="l00379"></a>00379 <span class="preprocessor">#ifndef INT_is_64_</span>
<a name="l00380"></a><a class="code" href="communications_8h.html#aabf1331a1088b891edc38cbbc13eb06b">00380</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a2335b36078ae87e23dab400a6e129a3c">envoyer_broadcast</a>(<span class="keywordtype">long</span>&amp;     t, <span class="keywordtype">int</span> source)
<a name="l00381"></a>00381 {
<a name="l00382"></a>00382   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#af0ca1aabc59ab95f2bce20e361f5acdd">envoyer_broadcast_</a>(&amp;t, 1, source);
<a name="l00383"></a>00383 }
<a name="l00384"></a>00384 <span class="preprocessor">#endif</span>
<a name="l00385"></a><a class="code" href="communications_8h.html#a1fc49243e834f1cfa159777a703f151b">00385</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a2335b36078ae87e23dab400a6e129a3c">envoyer_broadcast</a>(<span class="keywordtype">long</span> <span class="keywordtype">long</span>&amp;     t, <span class="keywordtype">int</span> source)
<a name="l00386"></a>00386 {
<a name="l00387"></a>00387   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#af0ca1aabc59ab95f2bce20e361f5acdd">envoyer_broadcast_</a>(&amp;t, 1, source);
<a name="l00388"></a>00388 }
<a name="l00389"></a><a class="code" href="communications_8h.html#ae3c470233dd69aaabeacb0ba3f7dbc7c">00389</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a2335b36078ae87e23dab400a6e129a3c">envoyer_broadcast</a>(<span class="keywordtype">float</span>&amp;    t, <span class="keywordtype">int</span> source)
<a name="l00390"></a>00390 {
<a name="l00391"></a>00391   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#af0ca1aabc59ab95f2bce20e361f5acdd">envoyer_broadcast_</a>(&amp;t, 1, source);
<a name="l00392"></a>00392 }
<a name="l00393"></a><a class="code" href="communications_8h.html#ab2973f929062ceaf21c4e454d3ed2a86">00393</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a2335b36078ae87e23dab400a6e129a3c">envoyer_broadcast</a>(<span class="keywordtype">double</span>&amp;   t, <span class="keywordtype">int</span> source)
<a name="l00394"></a>00394 {
<a name="l00395"></a>00395   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#af0ca1aabc59ab95f2bce20e361f5acdd">envoyer_broadcast_</a>(&amp;t, 1, source);
<a name="l00396"></a>00396 }
<a name="l00397"></a><a class="code" href="communications_8h.html#ac27e5b453a41187241fa75bfd2e76df2">00397</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a2335b36078ae87e23dab400a6e129a3c">envoyer_broadcast</a>(<a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; t, <span class="keywordtype">int</span> source)
<a name="l00398"></a>00398 {
<a name="l00399"></a>00399   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#a951d785ca3c2ffeba337363a7ad838ea" title="Broadcast de l&#39;objet par le processeur source a tous les autres processeurs. Fonctionne pour des type...">envoyer_broadcast_buffered_</a>(t, source);
<a name="l00400"></a>00400 }
<a name="l00401"></a>00401 
<a name="l00402"></a><a class="code" href="communications__array_8h.html#a53171079efd86536c24c4ef5a4e3994f">00402</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a53171079efd86536c24c4ef5a4e3994f">envoyer_broadcast_array</a>(<span class="keywordtype">int</span>  * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source)
<a name="l00403"></a>00403 {
<a name="l00404"></a>00404   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#af0ca1aabc59ab95f2bce20e361f5acdd">envoyer_broadcast_</a>(t, n, source);
<a name="l00405"></a>00405 }
<a name="l00406"></a>00406 <span class="preprocessor">#ifndef INT_is_64_</span>
<a name="l00407"></a><a class="code" href="communications__array_8h.html#ac14cbc7eb3fd3dd1fb8bc32fefba01bc">00407</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a53171079efd86536c24c4ef5a4e3994f">envoyer_broadcast_array</a>(<span class="keywordtype">long</span>    * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source)
<a name="l00408"></a>00408 {
<a name="l00409"></a>00409   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#af0ca1aabc59ab95f2bce20e361f5acdd">envoyer_broadcast_</a>(t, n, source);
<a name="l00410"></a>00410 }
<a name="l00411"></a>00411 <span class="preprocessor">#endif</span>
<a name="l00412"></a><a class="code" href="communications__array_8h.html#a5f18783245a7f873e66a7f74fa3bd94d">00412</a> <span class="preprocessor"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a53171079efd86536c24c4ef5a4e3994f">envoyer_broadcast_array</a>(<span class="keywordtype">float</span>   * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source)
<a name="l00413"></a>00413 {
<a name="l00414"></a>00414   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#af0ca1aabc59ab95f2bce20e361f5acdd">envoyer_broadcast_</a>(t, n, source);
<a name="l00415"></a>00415 }
<a name="l00416"></a><a class="code" href="communications__array_8h.html#a7ad78af858b587592e2c8362e824d9eb">00416</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a53171079efd86536c24c4ef5a4e3994f">envoyer_broadcast_array</a>(<span class="keywordtype">double</span>  * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source)
<a name="l00417"></a>00417 {
<a name="l00418"></a>00418   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#af0ca1aabc59ab95f2bce20e361f5acdd">envoyer_broadcast_</a>(t, n, source);
<a name="l00419"></a>00419 }
<a name="l00420"></a><a class="code" href="communications__array_8h.html#afacc4f9bd6188e463b1141d3bb6befc3">00420</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a53171079efd86536c24c4ef5a4e3994f">envoyer_broadcast_array</a>(<span class="keywordtype">char</span>    * t, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> source)
<a name="l00421"></a>00421 {
<a name="l00422"></a>00422   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#af0ca1aabc59ab95f2bce20e361f5acdd">envoyer_broadcast_</a>(t, n, source);
<a name="l00423"></a>00423 }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425 <span class="comment">// Template qui marche pour tout objet T qui ressemble a un vecteur (possede un operator[])</span>
<a name="l00426"></a>00426 <span class="comment">// de taille nproc()</span>
<a name="l00427"></a><a class="code" href="communications_8cpp.html#ad02b76a1902928baf8e648e1a0bcffd1">00427</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#ad02b76a1902928baf8e648e1a0bcffd1">envoyer_all_to_all_</a>(<span class="keyword">const</span> T&amp; src, T&amp; dest)
<a name="l00428"></a>00428 {
<a name="l00429"></a>00429   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00430"></a>00430   <a class="code" href="classSchema__Comm.html">Schema_Comm</a> sch;
<a name="l00431"></a>00431   <span class="keyword">const</span> <span class="keywordtype">int</span> nproc = grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>();
<a name="l00432"></a>00432   <span class="keyword">const</span> <span class="keywordtype">int</span> moi = grp.<a class="code" href="classComm__Group.html#a4ce6b03e1167d23c5e0e1e3447012c51" title="Renvoie le rang du processeur local dans le groupe *this. ou -1 si je ne suis pas dans le groupe...">rank</a>();
<a name="l00433"></a>00433   dest[moi] = src[moi];
<a name="l00434"></a>00434   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> send_pe_list(1);
<a name="l00435"></a>00435   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> recv_pe_list(1);
<a name="l00436"></a>00436   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 1; p &lt; nproc; p++)
<a name="l00437"></a>00437     {
<a name="l00438"></a>00438       <span class="keyword">const</span> <span class="keywordtype">int</span> send_to = (moi + p) % nproc;
<a name="l00439"></a>00439       <span class="keyword">const</span> <span class="keywordtype">int</span> recv_from = (moi + nproc - p) % nproc;
<a name="l00440"></a>00440       send_pe_list[0] = send_to;
<a name="l00441"></a>00441       recv_pe_list[0] = recv_from;
<a name="l00442"></a>00442       sch.<a class="code" href="classSchema__Comm.html#ad11c9b47999c294c26ae4df8d2bbd57b" title="Definit la liste des processeurs a qui on va envoyer et de qui on va recevoir des donnees...">set_send_recv_pe_list</a>(send_pe_list, recv_pe_list);
<a name="l00443"></a>00443       sch.<a class="code" href="classSchema__Comm.html#ac617b53de22748cdd9fa30a0cfd0f4a8" title="Statut passe a WRITING Autorise si status_ == WRITING:">begin_comm</a>();
<a name="l00444"></a>00444       sch.<a class="code" href="classSchema__Comm.html#a6c771eae3b46250ae0d2f0126a7d8065" title="renvoie le buffer correspondant au processeur num_PE pour y entasser des donnees a envoyer...">send_buffer</a>(send_to) &lt;&lt; src[send_to];
<a name="l00445"></a>00445       sch.<a class="code" href="classSchema__Comm.html#abca0e8ac6c2b742d26f3cfaee0690c72" title="Statut passe a EXCHANGED.">echange_taille_et_messages</a>();
<a name="l00446"></a>00446       sch.<a class="code" href="classSchema__Comm.html#a0c056eb81ab8fd513912b336b4d13a1a" title="renvoie le buffer correspondant au processeur num_PE pour y lire les donnees recues. Le schema doit etre dans l&#39;etat EXCHANGED.">recv_buffer</a>(recv_from) &gt;&gt; dest[recv_from];
<a name="l00447"></a>00447       sch.<a class="code" href="classSchema__Comm.html#a73a981f88b6ffebc150fb46c5cce75d9" title="Statut passe a RESET Accesseurs:">end_comm</a>();
<a name="l00448"></a>00448     }
<a name="l00449"></a>00449   <span class="keywordflow">return</span> 1;
<a name="l00450"></a>00450 }
<a name="l00451"></a>00451 
<a name="l00452"></a><a class="code" href="communications_8h.html#a5ceda011ec527d63b691f62cd2fb61c8">00452</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTabs.html" title="DoubleTabs est equivalent a VECT(DoubleTab)">DoubleTabs</a>&amp; src,     <a class="code" href="classDoubleTabs.html" title="DoubleTabs est equivalent a VECT(DoubleTab)">DoubleTabs</a>&amp; dest)
<a name="l00453"></a>00453 {
<a name="l00454"></a>00454 <span class="comment">// Je mets le assert ici car si on veut faire un envoyer_all_to_all(IntTab)</span>
<a name="l00455"></a>00455 <span class="comment">// le assert doit utiliser size_array()</span>
<a name="l00456"></a>00456   assert(src.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>() == <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>());
<a name="l00457"></a>00457   assert(dest.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>() == <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>());
<a name="l00458"></a>00458   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#ad02b76a1902928baf8e648e1a0bcffd1">envoyer_all_to_all_</a>(src, dest);
<a name="l00459"></a>00459 }
<a name="l00460"></a>00460 
<a name="l00461"></a><a class="code" href="communications_8h.html#aa691419d8d34adc34ca7fb1768a4a959">00461</a> <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(<span class="keyword">const</span> <a class="code" href="Vect_8h.html#adc7c7b04809c9aec2cb897cd2ef06378">VECT</a>(<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>) &amp; src, <a class="code" href="Vect_8h.html#adc7c7b04809c9aec2cb897cd2ef06378">VECT</a>(<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>) &amp; dest)
<a name="l00462"></a>00462 {
<a name="l00463"></a>00463   assert(src.size() == <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>());
<a name="l00464"></a>00464   assert(dest.size() == <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>());
<a name="l00465"></a>00465   <span class="keywordflow">return</span> <a class="code" href="communications_8cpp.html#ad02b76a1902928baf8e648e1a0bcffd1">envoyer_all_to_all_</a>(src, dest);
<a name="l00466"></a>00466 }
<a name="l00467"></a>00467 
<a name="l00468"></a>00468 <span class="comment">//</span>
<a name="l00469"></a>00469 <span class="comment">//</span>
<a name="l00470"></a>00470 <span class="comment">//</span>
<a name="l00471"></a>00471 <span class="comment">//</span><span class="comment"></span>
<a name="l00472"></a>00472 <span class="comment">//! On suppose que les tableaux en entree et en sortie&lt;br&gt;sont de taille nproc() . On envoie src[0] au proc 0,&lt;br&gt;src[1] au proc 1, etc... la valeur recue du processeur 0 et mise dans&lt;br&gt;dest[0], processeur 1 dans dest[1], etc...&lt;br&gt;Il est autorise d&#39;appeler la fonction avec le meme tableau src et dest.</span>
<a name="l00473"></a><a class="code" href="communications_8h.html#a8e6503c6c798571979f364c8b7470b68">00473</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(<span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; src, <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; dest)
<a name="l00474"></a>00474 {
<a name="l00475"></a>00475   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00476"></a>00476   assert(src.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() == grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>());
<a name="l00477"></a>00477   assert(dest.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() == grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>());
<a name="l00478"></a>00478   <span class="keywordflow">if</span> (src.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() == dest.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>())
<a name="l00479"></a>00479     {
<a name="l00480"></a>00480       <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> tmp;
<a name="l00481"></a>00481       tmp.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>(), <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>);
<a name="l00482"></a>00482       grp.<a class="code" href="classComm__Group.html#abf4e41f7151bf25ea7a2591e31907cff">all_to_all</a>(src.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), tmp.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <span class="keyword">sizeof</span>(int));
<a name="l00483"></a>00483       dest.<a class="code" href="classArrOfInt.html#a195c644d98bf2da2fe4f8aede4e02262" title="Copie les elements source[first_element_source + i] dans les elements (*this)[first_element_dest + i]...">inject_array</a>(tmp);
<a name="l00484"></a>00484     }
<a name="l00485"></a>00485   <span class="keywordflow">else</span>
<a name="l00486"></a>00486     {
<a name="l00487"></a>00487       grp.<a class="code" href="classComm__Group.html#abf4e41f7151bf25ea7a2591e31907cff">all_to_all</a>(src.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), dest.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <span class="keyword">sizeof</span>(int));
<a name="l00488"></a>00488     }
<a name="l00489"></a>00489   <span class="keywordflow">return</span> 1;
<a name="l00490"></a>00490 }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 <span class="comment">//</span>
<a name="l00493"></a>00493 <span class="comment">//</span>
<a name="l00494"></a>00494 <span class="comment">//</span>
<a name="l00495"></a>00495 <span class="comment">//</span><span class="comment"></span>
<a name="l00496"></a>00496 <span class="comment">//! On suppose que les tableaux en entree et en sortie&lt;br&gt;sont de taille nproc() . On envoie src[0] au proc 0,&lt;br&gt;src[1] au proc 1, etc... la valeur recue du processeur 0 et mise dans&lt;br&gt;dest[0], processeur 1 dans dest[1], etc...&lt;br&gt;Il est autorise d&#39;appeler la fonction avec le meme tableau src et dest.</span>
<a name="l00497"></a><a class="code" href="communications_8h.html#a2e7e2f84fb9bece91b8670e7d42bc9a0">00497</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(<span class="keyword">const</span> <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; src, <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; dest)
<a name="l00498"></a>00498 {
<a name="l00499"></a>00499   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00500"></a>00500   assert(src.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() == grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>());
<a name="l00501"></a>00501   assert(dest.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() == grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>());
<a name="l00502"></a>00502   <span class="keywordflow">if</span> (src.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() == dest.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>())
<a name="l00503"></a>00503     {
<a name="l00504"></a>00504       <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> tmp;
<a name="l00505"></a>00505       tmp.<a class="code" href="classArrOfDouble.html#a610464f4b3dccac6f814915b526783ed">resize_array</a>(grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>(), <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ffaf6ae9ba7eb51c5f298ce693345b3ec68">Array_base::NOCOPY_NOINIT</a>);
<a name="l00506"></a>00506       grp.<a class="code" href="classComm__Group.html#abf4e41f7151bf25ea7a2591e31907cff">all_to_all</a>(src.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), tmp.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <span class="keyword">sizeof</span>(double));
<a name="l00507"></a>00507       dest.<a class="code" href="classArrOfDouble.html#a2fcb2a2d3b59425c6cb37526ea6af6a3" title="Copie les elements source[first_element_source + i] dans les elements (*this)[first_element_dest + i]...">inject_array</a>(tmp);
<a name="l00508"></a>00508     }
<a name="l00509"></a>00509   <span class="keywordflow">else</span>
<a name="l00510"></a>00510     {
<a name="l00511"></a>00511       grp.<a class="code" href="classComm__Group.html#abf4e41f7151bf25ea7a2591e31907cff">all_to_all</a>(src.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), dest.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <span class="keyword">sizeof</span>(double));
<a name="l00512"></a>00512     }
<a name="l00513"></a>00513   <span class="keywordflow">return</span> 1;
<a name="l00514"></a>00514 }
<a name="l00515"></a>00515 
<a name="l00516"></a>00516 <span class="comment">//</span>
<a name="l00517"></a>00517 <span class="comment">//</span>
<a name="l00518"></a>00518 <span class="comment">//</span>
<a name="l00519"></a>00519 <span class="comment">//</span><span class="comment"></span>
<a name="l00520"></a>00520 <span class="comment">//! On suppose que les tableaux en entree et en sortie&lt;br&gt;sont de taille nproc() . On envoie src[0] au proc 0,&lt;br&gt;src[1] au proc 1, etc... la valeur recue du processeur 0 et mise dans&lt;br&gt;dest[0], processeur 1 dans dest[1], etc...&lt;br&gt;Il est autorise d&#39;appeler la fonction avec le meme tableau src et dest.</span>
<a name="l00521"></a><a class="code" href="communications_8h.html#adee531c9d6e1a4fac2c8adae2632b384">00521</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(std::vector&lt;long long&gt;&amp; src, std::vector&lt;long long&gt;&amp; dest)
<a name="l00522"></a>00522 {
<a name="l00523"></a>00523   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00524"></a>00524   assert(static_cast&lt;int&gt;(src.size()) == grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>());
<a name="l00525"></a>00525   assert(static_cast&lt;int&gt;(dest.size()) == grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>());
<a name="l00526"></a>00526   <span class="keywordflow">if</span> (src.data() == dest.data())
<a name="l00527"></a>00527     {
<a name="l00528"></a>00528       std::vector&lt;long long&gt; tmp(grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>(),0);
<a name="l00529"></a>00529       grp.<a class="code" href="classComm__Group.html#abf4e41f7151bf25ea7a2591e31907cff">all_to_all</a>(src.data(), tmp.data(), <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> long));
<a name="l00530"></a>00530       dest = tmp;
<a name="l00531"></a>00531     }
<a name="l00532"></a>00532   <span class="keywordflow">else</span>
<a name="l00533"></a>00533     {
<a name="l00534"></a>00534       grp.<a class="code" href="classComm__Group.html#abf4e41f7151bf25ea7a2591e31907cff">all_to_all</a>(src.data(), dest.data(), <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> long));
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536   <span class="keywordflow">return</span> 1;
<a name="l00537"></a>00537 }
<a name="l00538"></a>00538 
<a name="l00539"></a>00539 <span class="comment">// Precondition:</span>
<a name="l00540"></a>00540 <span class="comment">// Cette fonction doit etre appelee simultanement sur tous les processeurs</span>
<a name="l00541"></a>00541 <span class="comment">// du groupe.</span>
<a name="l00542"></a>00542 <span class="comment">// Valeur de retour:</span>
<a name="l00543"></a>00543 <span class="comment">// nombre d&#39;elements dans dest_list.</span>
<a name="l00544"></a>00544 <span class="comment">//</span>
<a name="l00545"></a>00545 <span class="comment">//</span>
<a name="l00546"></a>00546 <span class="comment">//</span>
<a name="l00547"></a>00547 <span class="comment">//</span>
<a name="l00548"></a>00548 <span class="comment">//</span>
<a name="l00549"></a>00549 <span class="comment">//</span>
<a name="l00550"></a>00550 <span class="comment">//</span>
<a name="l00551"></a>00551 <span class="comment">//</span>
<a name="l00552"></a>00552 <span class="comment">//</span>
<a name="l00553"></a>00553 <span class="comment">//</span>
<a name="l00554"></a>00554 <span class="comment">//</span>
<a name="l00555"></a>00555 <span class="comment">//</span>
<a name="l00556"></a>00556 <span class="comment">//</span>
<a name="l00557"></a>00557 <span class="comment">//</span>
<a name="l00558"></a>00558 <span class="comment">//</span>
<a name="l00559"></a>00559 <span class="comment">//</span><span class="comment"></span>
<a name="l00560"></a>00560 <span class="comment">//! Calcule la transposee d&#39;une liste de processeurs:&lt;br&gt;On construit le tableau dest_list tel que:&lt;br&gt;x est dans la liste src_list sur le processeur y&lt;br&gt;si et seulement si&lt;br&gt;y est dans la liste dest_list sur le processeur x&lt;br&gt;En pratique, cette fonction permet de calculer la liste des&lt;br&gt;processeurs qui recoivent des messages si on connait la liste&lt;br&gt;des processeurs qui envoient des messages, et reciproquement.&lt;br&gt;Parametre:     src_list&lt;br&gt;Signification: Une liste de numeros de PEs presents dans ce groupe de comm.&lt;br&gt;Ce sont les indices des pes dans le groupe courant (0 &lt;= pe &lt; nproc_)&lt;br&gt;Parametre:     dest_list&lt;br&gt;Signification: Le tableau ou stocker le resultat. On le met a la bonne taille&lt;br&gt;et on le remplit. Les numeros de PEs sont mis dans l&#39;ordre&lt;br&gt;croissant.&lt;br&gt;Ce sont les indices des pes dans le groupe courant (0 &lt;= pe &lt; nproc_)</span>
<a name="l00561"></a><a class="code" href="communications_8h.html#a38c9e2f958081bff6f390b56ec939523">00561</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a38c9e2f958081bff6f390b56ec939523" title="Calcule la transposee d&#39;une liste de processeurs: On construit le tableau dest_list tel que: x est da...">reverse_send_recv_pe_list</a>(<span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; src_list, <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; dest_list)
<a name="l00562"></a>00562 {
<a name="l00563"></a>00563   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00564"></a>00564   <span class="keyword">const</span> <span class="keywordtype">int</span> np = grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>();
<a name="l00565"></a>00565   assert(src_list.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() == 0 || <a class="code" href="ArrOfDouble_8cpp.html#a95241fccf4bed7fb7a4e2340b7735f14" title="Retourne la valeur maximale.">max_array</a>(src_list) &lt; np);
<a name="l00566"></a>00566   assert(src_list.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() == 0 || <a class="code" href="ArrOfDouble_8cpp.html#abd3998749a1a8dab00dd6ac1798327fb" title="Retourne la valeur minimale.">min_array</a>(src_list) &gt;= 0);
<a name="l00567"></a>00567   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> flag(np);
<a name="l00568"></a>00568   <span class="keywordtype">int</span> i;
<a name="l00569"></a>00569   <span class="keyword">const</span> <span class="keywordtype">int</span> src_size = src_list.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00570"></a>00570   <span class="keywordflow">for</span> (i = 0; i &lt; src_size; i++)
<a name="l00571"></a>00571     {
<a name="l00572"></a>00572       <span class="keyword">const</span> <span class="keywordtype">int</span> pe = src_list[i];
<a name="l00573"></a>00573       flag[pe] = 1;
<a name="l00574"></a>00574     }
<a name="l00575"></a>00575   <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> flag_recv(np);
<a name="l00576"></a>00576   <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(flag, flag_recv);
<a name="l00577"></a>00577   <span class="keywordtype">int</span> n = 0;
<a name="l00578"></a>00578   dest_list.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(np);
<a name="l00579"></a>00579   <span class="keywordflow">for</span> (i = 0; i &lt; np; i++)
<a name="l00580"></a>00580     <span class="keywordflow">if</span> (flag_recv[i])
<a name="l00581"></a>00581       dest_list[n++] = i;
<a name="l00582"></a>00582   dest_list.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(n);
<a name="l00583"></a>00583   <span class="keywordflow">return</span> 1;
<a name="l00584"></a>00584 }
<a name="l00585"></a>00585 
<a name="l00586"></a>00586 <span class="comment">//</span><span class="comment"></span>
<a name="l00587"></a>00587 <span class="comment">//! renvoie le plus grand int i sur l&#39;ensemble des processeurs du&lt;br&gt;groupe courant.</span>
<a name="l00588"></a><a class="code" href="communications_8h.html#af38abf085839dd0d79d29b2995cb2f4a">00588</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a6b5d757052506cb052efbc14b268775b" title="renvoie le plus grand int i sur l&#39;ensemble des processeurs du groupe courant.">mp_max</a>(<span class="keywordtype">int</span> x)
<a name="l00589"></a>00589 {
<a name="l00590"></a>00590   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00591"></a>00591   <span class="keywordtype">int</span> y;
<a name="l00592"></a>00592   grp.<a class="code" href="classComm__Group.html#abe4ac5fc38da03874333ddf9f4af5fa7">mp_collective_op</a>(&amp;x, &amp;y, 1, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302ca97e266ea06542559109eef5e5d642b86">Comm_Group::COLL_MAX</a>);
<a name="l00593"></a>00593   <span class="keywordflow">return</span> y;
<a name="l00594"></a>00594 }
<a name="l00595"></a>00595 
<a name="l00596"></a>00596 <span class="comment">//</span><span class="comment"></span>
<a name="l00597"></a>00597 <span class="comment">//! renvoie le plus petit int i sur l&#39;ensemble des processeurs du&lt;br&gt;groupe courant.</span>
<a name="l00598"></a><a class="code" href="communications_8h.html#a09479130b5ffcd404062587c51d30846">00598</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#adb9fffe31bc56a52685e93ba06932547" title="renvoie le plus petit int i sur l&#39;ensemble des processeurs du groupe courant.">mp_min</a>(<span class="keywordtype">int</span> x)
<a name="l00599"></a>00599 {
<a name="l00600"></a>00600   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00601"></a>00601   <span class="keywordtype">int</span> y;
<a name="l00602"></a>00602   grp.<a class="code" href="classComm__Group.html#abe4ac5fc38da03874333ddf9f4af5fa7">mp_collective_op</a>(&amp;x, &amp;y, 1, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302cac56938ec8d65390f71357f084c9be49f">Comm_Group::COLL_MIN</a>);
<a name="l00603"></a>00603   <span class="keywordflow">return</span> y;
<a name="l00604"></a>00604 }
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 <span class="comment">//</span><span class="comment"></span>
<a name="l00607"></a>00607 <span class="comment">//! Calul de la somme partielle de i sur les processeurs 0 a me()-1&lt;br&gt;(renvoie 0 sur le processeur 0). Voir Comm_Group::mppartial_sum()</span>
<a name="l00608"></a><a class="code" href="communications_8h.html#aa7769d3df1507412dabca5ea877ee4aa">00608</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071" title="Calul de la somme partielle de i sur les processeurs 0 a me()-1 (renvoie 0 sur le processeur 0)...">mppartial_sum</a>(<span class="keywordtype">int</span> x)
<a name="l00609"></a>00609 {
<a name="l00610"></a>00610   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00611"></a>00611   <span class="keywordtype">int</span> y;
<a name="l00612"></a>00612   grp.<a class="code" href="classComm__Group.html#abe4ac5fc38da03874333ddf9f4af5fa7">mp_collective_op</a>(&amp;x, &amp;y, 1, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302ca31173cff9138da25f8a6f87612e14edb">Comm_Group::COLL_PARTIAL_SUM</a>);
<a name="l00613"></a>00613   <span class="keywordflow">return</span> y;
<a name="l00614"></a>00614 }
<a name="l00615"></a>00615 
<a name="l00616"></a>00616 
<a name="l00617"></a><a class="code" href="communications_8h.html#af63556e6cd8ba837d64821d5e66a090e">00617</a> <span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#af63556e6cd8ba837d64821d5e66a090e">mpsum_multiple</a>(<span class="keywordtype">double</span>&amp; x1, <span class="keywordtype">double</span>&amp; x2)
<a name="l00618"></a>00618 {
<a name="l00619"></a>00619   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00620"></a>00620   <span class="keywordtype">double</span> x[2];
<a name="l00621"></a>00621   <span class="keywordtype">double</span> y[2];
<a name="l00622"></a>00622   x[0] = x1;
<a name="l00623"></a>00623   x[1] = x2;
<a name="l00624"></a>00624   grp.<a class="code" href="classComm__Group.html#abe4ac5fc38da03874333ddf9f4af5fa7">mp_collective_op</a>(x, y, 2, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302ca55879cc8c9d3898570abc1279177d330">Comm_Group::COLL_SUM</a>);
<a name="l00625"></a>00625   x1 = y[0];
<a name="l00626"></a>00626   x2 = y[1];
<a name="l00627"></a>00627 }
<a name="l00628"></a>00628 
<a name="l00629"></a><a class="code" href="communications_8cpp.html#a70c2380c28dafa7fb6cf123da11db8e2">00629</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#a70c2380c28dafa7fb6cf123da11db8e2">mp_collective_op</a>(<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; x, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302c">Comm_Group::Collective_Op</a> op)
<a name="l00630"></a>00630 {
<a name="l00631"></a>00631   <span class="keywordtype">int</span> <a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a> = x.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00632"></a>00632   <a class="code" href="communications_8cpp.html#a9e67e5ed9733705075e50eb6ea135279" title="en mode comm_check_enabled(), verifie que le parametre a la meme valeur sur tous les processeurs...">assert_parallel</a>(sz);
<a name="l00633"></a>00633   <span class="keywordflow">if</span> (sz &gt; 0)
<a name="l00634"></a>00634     {
<a name="l00635"></a>00635       <span class="keywordtype">int</span> *data = x.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00636"></a>00636       <span class="keywordtype">int</span> *tmp = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a>];
<a name="l00637"></a>00637       <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00638"></a>00638       grp.<a class="code" href="classComm__Group.html#abe4ac5fc38da03874333ddf9f4af5fa7">mp_collective_op</a>(data, tmp, sz, op);
<a name="l00639"></a>00639       memcpy(data, tmp, sz * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));
<a name="l00640"></a>00640       <span class="keyword">delete</span> [] tmp;
<a name="l00641"></a>00641     }
<a name="l00642"></a>00642 }
<a name="l00643"></a>00643 
<a name="l00644"></a><a class="code" href="communications_8cpp.html#a6353f6dbde6c66658dc1ed28318f7031">00644</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#a70c2380c28dafa7fb6cf123da11db8e2">mp_collective_op</a>(<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; x, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302c">Comm_Group::Collective_Op</a> op)
<a name="l00645"></a>00645 {
<a name="l00646"></a>00646   <span class="keywordtype">int</span> <a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a> = x.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00647"></a>00647   <a class="code" href="communications_8cpp.html#a9e67e5ed9733705075e50eb6ea135279" title="en mode comm_check_enabled(), verifie que le parametre a la meme valeur sur tous les processeurs...">assert_parallel</a>(sz);
<a name="l00648"></a>00648   <span class="keywordflow">if</span> (sz &gt; 0)
<a name="l00649"></a>00649     {
<a name="l00650"></a>00650       <span class="keywordtype">double</span> *data = x.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>();
<a name="l00651"></a>00651       <span class="keywordtype">double</span> *tmp = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a>];
<a name="l00652"></a>00652       <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00653"></a>00653       grp.<a class="code" href="classComm__Group.html#abe4ac5fc38da03874333ddf9f4af5fa7">mp_collective_op</a>(data, tmp, sz, op);
<a name="l00654"></a>00654       memcpy(data, tmp, sz * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00655"></a>00655       <span class="keyword">delete</span> [] tmp;
<a name="l00656"></a>00656     }
<a name="l00657"></a>00657 }
<a name="l00658"></a>00658 
<a name="l00659"></a><a class="code" href="communications_8h.html#a057fbd3ff87d6d4ff68f0beca44195d8">00659</a> <span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#a5f15b8a5c15449d3277ff3cde06fa68a">mp_sum_for_each_item</a>(<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; x)
<a name="l00660"></a>00660 {
<a name="l00661"></a>00661   <a class="code" href="communications_8cpp.html#a70c2380c28dafa7fb6cf123da11db8e2">mp_collective_op</a>(x, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302ca55879cc8c9d3898570abc1279177d330">Comm_Group::COLL_SUM</a>);
<a name="l00662"></a>00662 }
<a name="l00663"></a><a class="code" href="communications_8h.html#a120dedc9fdec2ebc0af6fc8556a99cc5">00663</a> <span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#a5f15b8a5c15449d3277ff3cde06fa68a">mp_sum_for_each_item</a>(<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; x)
<a name="l00664"></a>00664 {
<a name="l00665"></a>00665   <a class="code" href="communications_8cpp.html#a70c2380c28dafa7fb6cf123da11db8e2">mp_collective_op</a>(x, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302ca55879cc8c9d3898570abc1279177d330">Comm_Group::COLL_SUM</a>);
<a name="l00666"></a>00666 }
<a name="l00667"></a><a class="code" href="communications_8h.html#a80b8dbc4abc1f62d3764e1af57a263dd">00667</a> <span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#aba41fffdc595094c8dfb819a44ca3f0a">mp_min_for_each_item</a>(<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; x)
<a name="l00668"></a>00668 {
<a name="l00669"></a>00669   <a class="code" href="communications_8cpp.html#a70c2380c28dafa7fb6cf123da11db8e2">mp_collective_op</a>(x, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302cac56938ec8d65390f71357f084c9be49f">Comm_Group::COLL_MIN</a>);
<a name="l00670"></a>00670 }
<a name="l00671"></a><a class="code" href="communications_8h.html#a066847ff404f5112d60c17f44490128c">00671</a> <span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#aba41fffdc595094c8dfb819a44ca3f0a">mp_min_for_each_item</a>(<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; x)
<a name="l00672"></a>00672 {
<a name="l00673"></a>00673   <a class="code" href="communications_8cpp.html#a70c2380c28dafa7fb6cf123da11db8e2">mp_collective_op</a>(x, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302cac56938ec8d65390f71357f084c9be49f">Comm_Group::COLL_MIN</a>);
<a name="l00674"></a>00674 }
<a name="l00675"></a><a class="code" href="communications_8h.html#afec672b753241505a7d4fa8f46931fee">00675</a> <span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#aafa4a4611353c452208f47a6e4381488">mp_max_for_each_item</a>(<a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; x)
<a name="l00676"></a>00676 {
<a name="l00677"></a>00677   <a class="code" href="communications_8cpp.html#a70c2380c28dafa7fb6cf123da11db8e2">mp_collective_op</a>(x, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302ca97e266ea06542559109eef5e5d642b86">Comm_Group::COLL_MAX</a>);
<a name="l00678"></a>00678 }
<a name="l00679"></a><a class="code" href="communications_8h.html#a230feacfe4036591f62f8324edb2d2fa">00679</a> <span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#aafa4a4611353c452208f47a6e4381488">mp_max_for_each_item</a>(<a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a>&amp; x)
<a name="l00680"></a>00680 {
<a name="l00681"></a>00681   <a class="code" href="communications_8cpp.html#a70c2380c28dafa7fb6cf123da11db8e2">mp_collective_op</a>(x, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302ca97e266ea06542559109eef5e5d642b86">Comm_Group::COLL_MAX</a>);
<a name="l00682"></a>00682 }
<a name="l00683"></a>00683 
<a name="l00684"></a>00684 <span class="comment">//</span>
<a name="l00685"></a>00685 <span class="comment">//</span>
<a name="l00686"></a>00686 <span class="comment">//</span>
<a name="l00687"></a>00687 <span class="comment">//</span>
<a name="l00688"></a>00688 <span class="comment">//</span><span class="comment"></span>
<a name="l00689"></a>00689 <span class="comment">//! On suppose que les tableaux en entree et en sortie&lt;br&gt;sont tels que dimension(0)==nproc() et que les autres dimensions&lt;br&gt;sont identiques. On envoie src(0, i, j, ...) au proc 0,&lt;br&gt;src(0, i, j, ...) au proc 1, etc... la valeur recue du processeur 0 et mise dans&lt;br&gt;dest(0, i, j, ...) , processeur 1 dans dest(1, i, j, ...) , etc...&lt;br&gt;Il est autorise d&#39;appeler la fonction avec le meme tableau src et dest.</span>
<a name="l00690"></a><a class="code" href="communications_8h.html#a9e6627b879442a57e8cccbe801c83eab">00690</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; src, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; dest)
<a name="l00691"></a>00691 {
<a name="l00692"></a>00692   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00693"></a>00693   assert(src.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0) == grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>());
<a name="l00694"></a>00694   assert(dest.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0) == grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>());
<a name="l00695"></a>00695   assert(src.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>() == dest.<a class="code" href="classArrOfDouble.html#a3c3b33bea0e88b87315c21ee94bee05f" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>());
<a name="l00696"></a>00696 
<a name="l00697"></a>00697   <span class="keywordflow">if</span> (dest.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>() == src.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>())
<a name="l00698"></a>00698     {
<a name="l00699"></a>00699       <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> tmp(src);
<a name="l00700"></a>00700       <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(src, tmp);
<a name="l00701"></a>00701       dest = tmp;
<a name="l00702"></a>00702     }
<a name="l00703"></a>00703   <span class="keywordflow">else</span>
<a name="l00704"></a>00704     {
<a name="l00705"></a>00705       <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a> = src.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>() / grp.<a class="code" href="classComm__Group.html#a657c34d2d722170d7e052b594e17654c" title="Renvoie le nombre de processeurs dans le groupe *this.">nproc</a>() * <span class="keyword">sizeof</span>(double);
<a name="l00706"></a>00706       grp.<a class="code" href="classComm__Group.html#abf4e41f7151bf25ea7a2591e31907cff">all_to_all</a>(src.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), dest.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="Nom_8cpp.html#a0e1ea19fb9fa7881d15d84eff4c090e1">sz</a>);
<a name="l00707"></a>00707     }
<a name="l00708"></a>00708 }
<a name="l00709"></a>00709 
<a name="l00710"></a>00710 <span class="comment">//</span>
<a name="l00711"></a>00711 <span class="comment">//</span>
<a name="l00712"></a>00712 <span class="comment">//</span>
<a name="l00713"></a>00713 <span class="comment">//</span>
<a name="l00714"></a>00714 <span class="comment">//</span>
<a name="l00715"></a>00715 <span class="comment">//</span><span class="comment"></span>
<a name="l00716"></a>00716 <span class="comment">//! renvoie le drapeau Comm_Group::check_enabled().&lt;br&gt;Ce drapeau indique si le code tourne en mode DEBUG du parallele.&lt;br&gt;Dans ce cas, des communications supplementaires ont lieu pour&lt;br&gt;verifier la coherence du parallelisme et le mode de communication&lt;br&gt;est force en mode synchrone.&lt;br&gt;Cette methode permet de tester le drapeau, et s&#39;il est mis de&lt;br&gt;realiser des verifications supplementaires</span>
<a name="l00717"></a><a class="code" href="communications_8h.html#a40943dd8a0e3ea77b7f2e7d404d9cd53">00717</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#a40943dd8a0e3ea77b7f2e7d404d9cd53" title="renvoie le drapeau Comm_Group::check_enabled(). Ce drapeau indique si le code tourne en mode DEBUG du...">comm_check_enabled</a>()
<a name="l00718"></a>00718 {
<a name="l00719"></a>00719   <span class="keywordflow">return</span> <a class="code" href="classComm__Group.html#a0f230fe65c9f52fd2a168a1ea70e7b15">Comm_Group::check_enabled</a>();
<a name="l00720"></a>00720 }
<a name="l00721"></a>00721 
<a name="l00722"></a>00722 <span class="comment">//</span><span class="comment"></span>
<a name="l00723"></a>00723 <span class="comment">//! renvoie 1 (sur tous les procs) si le parametre est identique sur tous les procs,&lt;br&gt;sinon renvoie 0 (sur tous les procs)</span>
<a name="l00724"></a><a class="code" href="communications_8h.html#ab2c3f842da413b3de32448f068bd33b8">00724</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#ab2c3f842da413b3de32448f068bd33b8" title="renvoie 1 (sur tous les procs) si le parametre est identique sur tous les procs, sinon renvoie 0 (sur...">is_parallel_object</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> x)
<a name="l00725"></a>00725 {
<a name="l00726"></a>00726   <span class="keyword">const</span> <span class="keywordtype">int</span> x1 = <a class="code" href="communications_8cpp.html#adb9fffe31bc56a52685e93ba06932547" title="renvoie le plus petit int i sur l&#39;ensemble des processeurs du groupe courant.">mp_min</a>(x);
<a name="l00727"></a>00727   <span class="keyword">const</span> <span class="keywordtype">int</span> x2 = <a class="code" href="communications_8cpp.html#a6b5d757052506cb052efbc14b268775b" title="renvoie le plus grand int i sur l&#39;ensemble des processeurs du groupe courant.">mp_max</a>(x);
<a name="l00728"></a>00728   <span class="keywordflow">return</span> x1 == x2;
<a name="l00729"></a>00729 }
<a name="l00730"></a>00730 
<a name="l00731"></a>00731 <span class="comment">//</span><span class="comment"></span>
<a name="l00732"></a>00732 <span class="comment">//! renvoie 1 (sur tous les procs) si le parametre est identique sur tous les procs,&lt;br&gt;sinon renvoie 0 (sur tous les procs)</span>
<a name="l00733"></a><a class="code" href="communications_8h.html#af91a91fe3b374ba49dfb59c729f43e45">00733</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#ab2c3f842da413b3de32448f068bd33b8" title="renvoie 1 (sur tous les procs) si le parametre est identique sur tous les procs, sinon renvoie 0 (sur...">is_parallel_object</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x)
<a name="l00734"></a>00734 {
<a name="l00735"></a>00735   <span class="keyword">const</span> <a class="code" href="classComm__Group.html" title=": Cette classe decrit un groupe de processeurs sur lesquels une portion de code s&#39;execute simultaneme...">Comm_Group</a>&amp; grp = <a class="code" href="classPE__Groups.html#ae6ca0277a58f2ab34ebfb3216578fa75" title="renvoie une reference au groupe de processeurs actif courant">PE_Groups::current_group</a>();
<a name="l00736"></a>00736   <span class="keywordtype">double</span> tab_x[2];
<a name="l00737"></a>00737   tab_x[0] = x;
<a name="l00738"></a>00738   tab_x[1] = x;
<a name="l00739"></a>00739   <span class="keywordtype">double</span> tab_y[2];
<a name="l00740"></a>00740   <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302c">Comm_Group::Collective_Op</a> tab_op[] = { <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302cac56938ec8d65390f71357f084c9be49f">Comm_Group::COLL_MIN</a>, <a class="code" href="classComm__Group.html#a16a3e8b4b57b4ac0ee1d237b4a7e302ca97e266ea06542559109eef5e5d642b86">Comm_Group::COLL_MAX</a> };
<a name="l00741"></a>00741   grp.<a class="code" href="classComm__Group.html#abe4ac5fc38da03874333ddf9f4af5fa7">mp_collective_op</a>(tab_x, tab_y, tab_op, 2);
<a name="l00742"></a>00742   <span class="keywordflow">return</span> tab_y[0] == tab_y[1];
<a name="l00743"></a>00743 }
<a name="l00744"></a>00744 
<a name="l00745"></a>00745 <span class="comment">//</span><span class="comment"></span>
<a name="l00746"></a>00746 <span class="comment">//! en mode comm_check_enabled(), verifie que le parametre&lt;br&gt;a la meme valeur sur tous les processeurs</span>
<a name="l00747"></a><a class="code" href="communications_8h.html#a9e67e5ed9733705075e50eb6ea135279">00747</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#a9e67e5ed9733705075e50eb6ea135279" title="en mode comm_check_enabled(), verifie que le parametre a la meme valeur sur tous les processeurs...">assert_parallel</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> x)
<a name="l00748"></a>00748 {
<a name="l00749"></a>00749   <span class="keywordflow">if</span> (!<a class="code" href="classComm__Group.html#a0f230fe65c9f52fd2a168a1ea70e7b15">Comm_Group::check_enabled</a>())
<a name="l00750"></a>00750     <span class="keywordflow">return</span>;
<a name="l00751"></a>00751   <span class="keywordflow">if</span> (!<a class="code" href="communications_8cpp.html#ab2c3f842da413b3de32448f068bd33b8" title="renvoie 1 (sur tous les procs) si le parametre est identique sur tous les procs, sinon renvoie 0 (sur...">is_parallel_object</a>(x))
<a name="l00752"></a>00752     {
<a name="l00753"></a>00753       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Fatal error in assert_parallel(const int x). See log files&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00754"></a>00754       <a class="code" href="classProcess.html#a57e0f54b11e6eaadbea224fa904b18dd" title="Renvoie un objet statique de type Sortie qui sert de journal d&#39;evenements. Si message_level &lt;= verbose...">Process::Journal</a>() &lt;&lt; <span class="stringliteral">&quot;Error in assert_parallel(const int x)          )&quot;</span>
<a name="l00755"></a>00755                          &lt;&lt; <span class="stringliteral">&quot;This processor has this value: &quot;</span> &lt;&lt; x &lt;&lt; finl;
<a name="l00756"></a>00756       <a class="code" href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1" title="Synchronise tous les processeurs du groupe courant&lt;br&gt;(attend que tous les processeurs soient arrives...">Process::barrier</a>();
<a name="l00757"></a>00757       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00758"></a>00758     }
<a name="l00759"></a>00759 }
<a name="l00760"></a>00760 
<a name="l00761"></a>00761 <span class="comment">//</span><span class="comment"></span>
<a name="l00762"></a>00762 <span class="comment">//! en mode comm_check_enabled(), verifie que le parametre&lt;br&gt;a la meme valeur sur tous les processeurs</span>
<a name="l00763"></a><a class="code" href="communications_8h.html#ac56f91fbf75f4b568a17767a58e7000d">00763</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#a9e67e5ed9733705075e50eb6ea135279" title="en mode comm_check_enabled(), verifie que le parametre a la meme valeur sur tous les processeurs...">assert_parallel</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x)
<a name="l00764"></a>00764 {
<a name="l00765"></a>00765   <span class="keywordflow">if</span> (!<a class="code" href="classComm__Group.html#a0f230fe65c9f52fd2a168a1ea70e7b15">Comm_Group::check_enabled</a>())
<a name="l00766"></a>00766     <span class="keywordflow">return</span>;
<a name="l00767"></a>00767   <span class="keywordflow">if</span> (!<a class="code" href="communications_8cpp.html#ab2c3f842da413b3de32448f068bd33b8" title="renvoie 1 (sur tous les procs) si le parametre est identique sur tous les procs, sinon renvoie 0 (sur...">is_parallel_object</a>(x))
<a name="l00768"></a>00768     {
<a name="l00769"></a>00769       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Fatal error in assert_parallel(const double x). See log files&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00770"></a>00770       <a class="code" href="classProcess.html#a57e0f54b11e6eaadbea224fa904b18dd" title="Renvoie un objet statique de type Sortie qui sert de journal d&#39;evenements. Si message_level &lt;= verbose...">Process::Journal</a>() &lt;&lt; <span class="stringliteral">&quot;Error in assert_parallel(const double x)          )&quot;</span>
<a name="l00771"></a>00771                          &lt;&lt; <span class="stringliteral">&quot;This processor has this value: &quot;</span> &lt;&lt; x &lt;&lt; finl;
<a name="l00772"></a>00772       <a class="code" href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1" title="Synchronise tous les processeurs du groupe courant&lt;br&gt;(attend que tous les processeurs soient arrives...">Process::barrier</a>();
<a name="l00773"></a>00773       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00774"></a>00774     }
<a name="l00775"></a>00775 }
<a name="l00776"></a>00776 
<a name="l00777"></a><a class="code" href="communications_8cpp.html#aedeafb71cede98447e03249a15284305">00777</a> <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#aedeafb71cede98447e03249a15284305">compare</a>(<span class="keyword">const</span> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; a, <span class="keyword">const</span> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; b, <span class="keywordtype">int</span>&amp; <a class="code" href="Solv__GCP__NS_8cpp.html#ab6aa1075b965c7713d8db20dd3a8e09b">erreur</a>)
<a name="l00778"></a>00778 {
<a name="l00779"></a>00779   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(T, a))
<a name="l00780"></a>00780     {
<a name="l00781"></a>00781       <span class="keyword">const</span> T&amp; a_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(T, a);
<a name="l00782"></a>00782       <span class="keyword">const</span> T&amp; b_ = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(T, b);
<a name="l00783"></a>00783       <span class="keywordflow">if</span> (! (a_ == b_))
<a name="l00784"></a>00784         erreur = 1;
<a name="l00785"></a>00785       <span class="keywordflow">return</span> 1;
<a name="l00786"></a>00786     }
<a name="l00787"></a>00787   <span class="keywordflow">else</span>
<a name="l00788"></a>00788     {
<a name="l00789"></a>00789       <span class="keywordflow">return</span> 0;
<a name="l00790"></a>00790     }
<a name="l00791"></a>00791 }
<a name="l00792"></a>00792 
<a name="l00793"></a>00793 <span class="comment">//</span><span class="comment"></span>
<a name="l00794"></a>00794 <span class="comment">//! renvoie 1 (sur tous les procs) si le parametre est identique sur tous les procs,&lt;br&gt;sinon renvoie 0 (sur tous les procs)</span>
<a name="l00795"></a><a class="code" href="communications_8h.html#a8270e959598a810a79eb90658d83fa4e">00795</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="communications_8cpp.html#ab2c3f842da413b3de32448f068bd33b8" title="renvoie 1 (sur tous les procs) si le parametre est identique sur tous les procs, sinon renvoie 0 (sur...">is_parallel_object</a>(<span class="keyword">const</span> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; obj)
<a name="l00796"></a>00796 {
<a name="l00797"></a>00797   <span class="keywordtype">int</span> <a class="code" href="Solv__GCP__NS_8cpp.html#ab6aa1075b965c7713d8db20dd3a8e09b">erreur</a> = 0;
<a name="l00798"></a>00798   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
<a name="l00799"></a>00799     {
<a name="l00800"></a>00800       <a class="code" href="Deriv_8h.html#a4b39337b42cbf2fddeba7868ced6f860" title="Soit une classe Type_base qui derive de Objet_U. DERIV(T) est une petite classe contenant un pointeur...">DERIV</a>(<a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>) copie;
<a name="l00801"></a>00801       <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>();
<a name="l00802"></a>00802       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; n; i++)
<a name="l00803"></a>00803         {
<a name="l00804"></a>00804           <a class="code" href="communications_8cpp.html#a729d9499913e22a5f0db62ef07b9793f">recevoir</a>(copie, i, 67 <span class="comment">/* tag */</span>);
<a name="l00805"></a>00805           <span class="keywordflow">if</span> (erreur)
<a name="l00806"></a>00806             <span class="keywordflow">continue</span>; <span class="comment">//!&lt; On a deja trouve une erreur, on recoit les autres messages mais c&#39;est tout...</span>
<a name="l00807"></a>00807 <span class="comment"></span>          <span class="keyword">const</span> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; obj2 = copie.valeur();
<a name="l00808"></a>00808           <span class="keywordflow">if</span> (obj2.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() != obj.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>())
<a name="l00809"></a>00809             {
<a name="l00810"></a>00810               erreur = 1;
<a name="l00811"></a>00811             }
<a name="l00812"></a>00812           <span class="keywordflow">else</span>
<a name="l00813"></a>00813             {
<a name="l00814"></a>00814 <span class="comment">// L&#39;operateur == n&#39;est pas virtuel, on ne peut pas se contenter de comparer avec ==.</span>
<a name="l00815"></a>00815 <span class="comment">// Il faut appeler == pour le sous-type specifique de l&#39;objet.</span>
<a name="l00816"></a>00816 <span class="comment">// L&#39;ordre est important: d&#39;abord le type le plus derive, puis sa classe de base.</span>
<a name="l00817"></a>00817               <span class="keywordflow">if</span> (compare&lt;IntTab&gt; (obj, obj2, erreur));
<a name="l00818"></a>00818               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (compare&lt;DoubleTab&gt; (obj, obj2, erreur));
<a name="l00819"></a>00819               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (compare&lt;IntVect&gt; (obj, obj2, erreur));
<a name="l00820"></a>00820               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (compare&lt;DoubleVect&gt; (obj, obj2, erreur));
<a name="l00821"></a>00821               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (compare&lt;ArrOfInt&gt; (obj, obj2, erreur));
<a name="l00822"></a>00822               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (compare&lt;ArrOfDouble&gt; (obj, obj2, erreur));
<a name="l00823"></a>00823               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (compare&lt;Motcle&gt; (obj, obj2, erreur));
<a name="l00824"></a>00824               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (compare&lt;Nom&gt; (obj, obj2, erreur));
<a name="l00825"></a>00825               <span class="keywordflow">else</span>
<a name="l00826"></a>00826                 {
<a name="l00827"></a>00827                   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Internal error in is_parallel_objec() : it is not coded for &quot;</span> &lt;&lt; obj.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00828"></a>00828                   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00829"></a>00829                 }
<a name="l00830"></a>00830             }
<a name="l00831"></a>00831         }
<a name="l00832"></a>00832     }
<a name="l00833"></a>00833   <span class="keywordflow">else</span>
<a name="l00834"></a>00834     {
<a name="l00835"></a>00835 <span class="comment">// On envoie un objet de type DERIV..</span>
<a name="l00836"></a>00836       <a class="code" href="Deriv_8h.html#a4b39337b42cbf2fddeba7868ced6f860" title="Soit une classe Type_base qui derive de Objet_U. DERIV(T) est une petite classe contenant un pointeur...">DERIV</a>(<a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>) copie(obj);
<a name="l00837"></a>00837       <a class="code" href="communications_8cpp.html#af9feb6405277b375b2ebcbfaec9f8af3">envoyer</a>(copie, 0, 67 <span class="comment">/* tag */</span>);
<a name="l00838"></a>00838     }
<a name="l00839"></a>00839 
<a name="l00840"></a>00840   <a class="code" href="communications_8cpp.html#a2335b36078ae87e23dab400a6e129a3c">envoyer_broadcast</a>(erreur, 0 <span class="comment">/* pe source */</span>);
<a name="l00841"></a>00841   <span class="keywordflow">return</span> !<a class="code" href="Solv__GCP__NS_8cpp.html#ab6aa1075b965c7713d8db20dd3a8e09b">erreur</a>;
<a name="l00842"></a>00842 }
<a name="l00843"></a>00843 
<a name="l00844"></a>00844 <span class="comment">//</span>
<a name="l00845"></a>00845 <span class="comment">//</span>
<a name="l00846"></a>00846 <span class="comment">//</span><span class="comment"></span>
<a name="l00847"></a>00847 <span class="comment">//! en mode comm_check_enabled(), verifie que le parametre&lt;br&gt;a la meme valeur sur tous les processeurs.&lt;br&gt;Ne fonctionne pas pour tous les types !&lt;br&gt;Pour l&#39;instant ok pour Noms, Motcles et tableaux.</span>
<a name="l00848"></a><a class="code" href="communications_8h.html#a25174b69bc837d68b2ccc944a78277bf">00848</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="communications_8cpp.html#a9e67e5ed9733705075e50eb6ea135279" title="en mode comm_check_enabled(), verifie que le parametre a la meme valeur sur tous les processeurs...">assert_parallel</a>(<span class="keyword">const</span> <a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; obj)
<a name="l00849"></a>00849 {
<a name="l00850"></a>00850   <span class="keywordflow">if</span> (!<a class="code" href="classComm__Group.html#a0f230fe65c9f52fd2a168a1ea70e7b15">Comm_Group::check_enabled</a>())
<a name="l00851"></a>00851     <span class="keywordflow">return</span>;
<a name="l00852"></a>00852 
<a name="l00853"></a>00853   <span class="keywordflow">if</span> (!<a class="code" href="communications_8cpp.html#ab2c3f842da413b3de32448f068bd33b8" title="renvoie 1 (sur tous les procs) si le parametre est identique sur tous les procs, sinon renvoie 0 (sur...">is_parallel_object</a>(obj))
<a name="l00854"></a>00854     {
<a name="l00855"></a>00855       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Fatal error in assert_parallel(const Objet_U &amp; obj): objects do not match, see log files&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00856"></a>00856       <a class="code" href="classProcess.html#a57e0f54b11e6eaadbea224fa904b18dd" title="Renvoie un objet statique de type Sortie qui sert de journal d&#39;evenements. Si message_level &lt;= verbose...">Process::Journal</a>() &lt;&lt; <span class="stringliteral">&quot;Error in assert_parallel(const Objet_U &amp; obj)&quot;</span>
<a name="l00857"></a>00857                          &lt;&lt; <span class="stringliteral">&quot;This processor has this object : &quot;</span> &lt;&lt; obj.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; finl
<a name="l00858"></a>00858                          &lt;&lt; obj &lt;&lt; finl;
<a name="l00859"></a>00859       <a class="code" href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1" title="Synchronise tous les processeurs du groupe courant&lt;br&gt;(attend que tous les processeurs soient arrives...">Process::barrier</a>();
<a name="l00860"></a>00860       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00861"></a>00861     }
<a name="l00862"></a>00862 }
<a name="l00863"></a>00863 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:26 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
