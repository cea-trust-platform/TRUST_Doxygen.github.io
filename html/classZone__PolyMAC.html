<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: Zone_PolyMAC Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">Zone_PolyMAC Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Zone_PolyMAC" --><!-- doxytag: inherits="Zone_VF" -->
<p>class <a class="el" href="classZone__PolyMAC.html" title="class Zone_PolyMAC Classe instanciable qui derive de Zone_VF. Cette classe contient les informations ...">Zone_PolyMAC</a><br/>
Classe instanciable qui derive de <a class="el" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>.<br/>
Cette classe contient les informations geometriques que demande<br/>
la methode des Volumes Elements Finis (element de Crouzeix-Raviart)<br/>
La classe porte un certain nombre d'informations concernant les faces<br/>
Dans cet ensemble de faces on fait figurer aussi les faces du bord et<br/>
des joints. Pour manipuler les faces on distingue 2 categories:<br/>
- les faces non standard qui sont sur un joint, un bord ou qui sont<br/>
internes tout en appartenant a un element du bord<br/>
- les faces standard qui sont les faces internes n'appartenant pas<br/>
a un element du bord<br/>
Cette distinction correspond au traitement des conditions aux limites:les<br/>
faces standard ne "voient pas" les conditions aux limites.<br/>
L'ensemble des faces est numerote comme suit:<br/>
- les faces qui sont sur une Zone_joint apparaissent en premier<br/>
(dans l'ordre du vecteur les_joints)<br/>
- les faces qui sont sur une Zone_bord apparaissent ensuite<br/>
(dans l'ordre du vecteur les_bords)<br/>
- les faces internes non standard apparaissent ensuite<br/>
- les faces internes standard en dernier<br/>
Finalement on trouve regroupees en premier toutes les faces non standard<br/>
qui vont necessiter un traitement particulier<br/>
On distingue deux types d'elements<br/>
- les elements non standard : ils ont au moins une face de bord<br/>
- les elements standard : ils n'ont pas de face de bord<br/>
Les elements standard (resp. les elements non standard) ne sont pas ranges<br/>
de maniere consecutive dans l'objet <a class="el" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>. On utilise le tableau<br/>
rang_elem_non_std pour acceder de maniere selective a l'un ou<br/>
l'autre des types d'elements  
 <a href="classZone__PolyMAC.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Zone_PolyMAC:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classZone__PolyMAC.png" usemap="#Zone_PolyMAC_map" alt=""/>
  <map id="Zone_PolyMAC_map" name="Zone_PolyMAC_map">
<area href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ..." alt="Zone_VF" shape="rect" coords="0,168,103,192"/>
<area href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode." alt="Zone_dis_base" shape="rect" coords="0,112,103,136"/>
<area href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob..." alt="Objet_U" shape="rect" coords="0,56,103,80"/>
<area href="classProcess.html" title="Classe de base de TRUST (notamment Objet_U). Elle fournit quelques services de base accessibles de pa..." alt="Process" shape="rect" coords="0,0,103,24"/>
</map>
 </div></div>

<p><a href="classZone__PolyMAC-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a2b6ca217e6535059768279738d03cef1">Zone_PolyMAC</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#afff89e8cf755bda91897938115ce861c">~Zone_PolyMAC</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a977b928653c1dd9244a55c875a8f07d7">taille_memoire</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a445215cf384633d5fafbd25d217fd114">duplique</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classType__info.html">Type_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a8c3307ce001ca2537b05d38bae9d5ff4">get_info</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Donne des informations sur le type de l'Objet_U.  <a href="#a8c3307ce001ca2537b05d38bae9d5ff4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#add58bbb3309b38e7710b404c0525c0f0">typer_elem</a> (<a class="el" href="classZone.html">Zone</a> &amp;zone_geom)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#abf34bff21d4615b9727d0d9d256dbe3b">discretiser</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Genere les faces<br/>
construits les frontieres.  <a href="#abf34bff21d4615b9727d0d9d256dbe3b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a807c2e05fffa2b4cc2518c0e68855ed3">swap</a> (int, int, int)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ad9f8344b5967eb8bdbf9b36e569fd69a">reordonner</a> (<a class="el" href="classFaces.html">Faces</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Methode appelee par <a class="el" href="classZone__VF.html#ab147799e94c91fc4b18b190cdd3dbd0a" title="Genere les faces construits les frontieres.">Zone_VF::discretiser</a> apres la creation<br/>
des faces reelles.<br/>
On reordonne les faces de sorte a placer les faces "non standard"<br/>
au debut de la liste des faces. Les faces non standard sont celles<br/>
dont les volumes de controles sont modifies par les conditions aux<br/>
limites.  <a href="#ad9f8344b5967eb8bdbf9b36e569fd69a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a052c2d8776d7c7a43386bc4921f5af82">modifier_pour_Cl</a> (const <a class="el" href="classConds__lim.html">Conds_lim</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classElem__PolyMAC.html">Elem_PolyMAC</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a369ea15b260f758e13bcdc5385460426">type_elem</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a2ad9804df772625c1b7846f5bbf5660b">nb_elem_Cl</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a0648285447e084ae66a816fbc397dc16">nb_faces_joint</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#af17635ac2c2a5af41025b8b60fcf7aae">nb_faces_std</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#aab266ede1487ea6ad1759b0fea78bcb2">nb_elem_std</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ab5dee6d3a7bf4f29644044a61436d429">carre_pas_du_maillage</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ab4b79e85aeefbb5d1e883c66d269a3d4">carre_pas_maille</a> (int i) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ac461c322bf3ecf7a0b1a8099c98ca8a7">face_normales</a> (int, int) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a6bf501ddebc8e5f02ed6713b72277d66">longueur_aretes</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a731aa21d100f00b42b6830ed66baa103">ta</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classIntTab.html">IntTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a1374a0b9ba180cd834269be02f337ef5">arete_faces</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ac0072097ee9c21dea931fc1a70d8523b">face_normales</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#acebc3a496b9f9f1ec7bc5d0d1b07ec5b">face_normales</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntVect.html">IntVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a997edb83d05d02d970f88ad60b8086c0">rang_elem_non_std</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classIntVect.html">IntVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a9c96a79673cf23e19b30c9edba14ae5d">rang_elem_non_std</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a99bd91bcc80c7118fe601b800078e220">oriente_normale</a> (int face_opp, int elem2) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classArrOfInt.html">ArrOfInt</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ae6677bb0faf4357455f4a78c26a31a47">ind_faces_virt_non_std</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a14135870d92d9d24bc6c12a98a3e320c">calculer_volumes_entrelaces</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a21c54ff5bcbcde1c828969cf93bfb205">calculer_h_carre</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a3136412dd13e1120b72758b8a5013a10">volumes_entrelaces_dir</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a1ae045bb171677252d0b51c94c996644">volumes_entrelaces_dir</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a> (const double *a, const double *b, const double *ma=NULL, const double *mb=NULL) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::array&lt; double, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a440d581bbedd755e0fd86e8e2ff7f444">cross</a> (int dima, int dimb, const double *a, const double *b, const double *ma=NULL, const double *mb=NULL) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ab756547f1620fdad0ef46cffae4a5a90">dist_norm</a> (int num_face) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a0a6a2de1fef3dba598e9b870ee35b9da">dist_norm_bord</a> (int num_face) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ab3a872a19c923da59c7c11aca0dec416">dist_norm_bord</a> (<a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;, const <a class="el" href="classNom.html">Nom</a> &amp;nom_bord) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a5b591df01bd0eca800b3e961dcec5afa">dist_face_elem0</a> (int num_face, int n0) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a9654dac24f65d63da67da2b7c2c5bca2">dist_face_elem1</a> (int num_face, int n1) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a70e6c6a4b87f65c1641f4cff828fa7ae">dist_face_elem0_period</a> (int num_face, int n0, double l) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#af09737eeaf582103400dc1f45884cb31">dist_face_elem1_period</a> (int num_face, int n1, double l) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a2b1025462b8ecfa5971deef395649c58">orthocentrer</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a5177ecf773d223f075c3aea6576610a5">detecter_faces_non_planes</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ae48d3cf3e8cf9d86b86c8bdadd582520">init_ve</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a4fbf9ff80fbb21ecbbcbac2c9c0e0c13">init_rf</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ae6c3e86897bee01dc3f6b1aa36dd70c3">ajouter_stabilisation</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;M, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;N) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#afadc655691d6d38cd9ac09a490221f47">W_stabiliser</a> (<a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;W, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;R, <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;N, int *ctr, double *spectre) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ace03dac8b89bce9f38aa39cd951c59df">init_m2</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a0773d1ae573ed5da6e6dd82983d342eb">init_m2solv</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ad5ca5e80325c5f46a98e657ab32a4311">init_we</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a3a30c73bd3415b17879f3d4261861b4a">init_we_2d</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a20115c1a7b4f3f6102185cf2e1d7bcb0">init_we_3d</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a460c2044828915de85cf7168599a6d16">init_m1</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a22adf992084598225ebd66a6e30bdb57">init_m1_2d</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#aa2af2128ede28e1f8589241262ac7a08">init_m1_3d</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ac7d63e6ad15a24ef255b33ffaf2a7004">init_virt_ef_map</a> () const </td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classObjet__U.html">Objet_U</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ad110ffa4e8da492bc54ef906d633efbc">cree_instance</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classType__info.html">Type_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a08d0961aa83d143dc5dd4d23297dcce2">info</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Donne des informations sur le type de l'Objet_U.  <a href="#a08d0961aa83d143dc5dd4d23297dcce2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classZone__PolyMAC.html">Zone_PolyMAC</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ab8c53d341136866fa5c7d254d9e4a723">self_cast</a> (<a class="el" href="classObjet__U.html">Objet_U</a> &amp;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classZone__PolyMAC.html">Zone_PolyMAC</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a84b5198bad81ebede71ab205c73af3bc">self_cast</a> (const <a class="el" href="classObjet__U.html">Objet_U</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">methode ajoutee pour caster en python  <a href="#a84b5198bad81ebede71ab205c73af3bc"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntVect.html">IntVect</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a632f8cc11df954d566c97bbf177ae6ad">cyclic</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">cyclic(i) = 1 i le poly i est cyclique  <a href="#a632f8cc11df954d566c97bbf177ae6ad"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::map&lt; int, int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#aedbee7d653ae0f28ab65674b28bf78f2">som_arete</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a9878f0653163f907ea6b2c20ee0d89ee">vedeb</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ad1e5259622bbf8ce56dbd4cfd5708475">veji</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ad009c3ee5402613abf0d7e8b15da1c6f">veci</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a88975dc4a6176ff5756f110ec492ba6f">rfdeb</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a4ce87d1be325b893ec0904b21053bced">rfji</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ad9732b8eabce055eadf9195bca623332">rfci</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a672f82b0a35bb4eb3dbc2b0af8e00cbc">m2d</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#abae0465aee7760855c9b4eae58957bd9">m2i</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a6ffe4bbe605a937ab537b14eae6d7ed1">m2j</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ad76e9d4739f1092d19cf1985c632524d">w2i</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#aa0cebde1e4683a6c55b944f821d5c097">w2j</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a1ef09e85a9897db3633c6fb921fe63e9">m2c</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a0806de38360333cf9ea39a791f20906e">w2c</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">avec le coeff diagonal en premier (facilite <a class="el" href="classEchange__contact__PolyMAC.html">Echange_contact_PolyMAC</a>)  <a href="#a0806de38360333cf9ea39a791f20906e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a415f14d9e9e0765e1cfc7fc39229af5b">m2mat</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSolveurSys.html">SolveurSys</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a3a97852ae61b7a5ea10e1b9ff728faca">m2solv</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#af61335f5cde4fc2cdd1d5fcd734e0516">wedeb</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a0e0a04421ef4f416ac46e96943c9e887">weji</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a034313bc3890500f6179ad7fbfe50e5e">weci</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a44d477541e608609ff8f0ca5b9f80884">m1deb</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#abbb87713bcfa7d40bc0092946c3058d4">m1ji</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#adf9e0183c83be84d04cd2d682619100b">m1ci</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMD__Vector.html">MD_Vector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a943e05074e1c95435e96551f26d43e80">mdv_elems_faces</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMD__Vector.html">MD_Vector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#aee0dd0b4d16e9cd79a46a529dfe3797e">mdv_faces_aretes</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; std::array&lt; int, 2 &gt;<br class="typebreak"/>
, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ab280f7d8d35c0a0a7c576ef52145a09e">virt_ef_map</a></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classType__info.html">Type_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#abaa3f690f191e96591d440a6607c5d44">info_obj</a></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a68df324de334832c5dfc312e10e3132e">printOn</a> (<a class="el" href="classSortie.html">Sortie</a> &amp;x) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Surcharge <a class="el" href="classObjet__U.html#a68f520bd9ba3e848370861d6610720b5" title="Ecriture de l&#39;objet sur un flot de sortie Methode a surcharger.">Objet_U::printOn</a>(<a class="el" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp;)<br/>
NE FAIT RIEN<br/>
A surcharger dans les classes derivees.<br/>
Imprime la zone discretisee sur un flot de sortie.  <a href="#a68df324de334832c5dfc312e10e3132e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classEntree.html">Entree</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a069179df5a26299b9d2f3e0c348e5adc">readOn</a> (<a class="el" href="classEntree.html">Entree</a> &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Surcharge <a class="el" href="classObjet__U.html#a6f4c7788efee2dce629ebd1628b73288" title="Lecture d&#39;un Objet_U sur un flot d&#39;entree Methode a surcharger.">Objet_U::readOn</a>(<a class="el" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp;)<br/>
NE FAIT RIEN<br/>
A surcharger dans les classes derivees.<br/>
Lit une zone discretisee a partir d'un flot d'entree.  <a href="#a069179df5a26299b9d2f3e0c348e5adc"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a21406240dca3cd30ed879b82f4a97631">remplir_elem_faces</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a5cf8bdb73573a302f9dab2d2f0ffdf80">ecrit</a> (<a class="el" href="classSortie.html">Sortie</a> &amp;os) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#aac86d6f78066fe8fb87d7d39d5794474">creer_faces_virtuelles_non_std</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">creation de l'espace distant pour les faces virtuelles;<br/>
creation du tableau des faces virtuelles de bord  <a href="#aac86d6f78066fe8fb87d7d39d5794474"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a3122c86faa41d079ec3ed009a3c2136e">h_carre</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">carre du pas du maillage  <a href="#a3122c86faa41d079ec3ed009a3c2136e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleVect.html">DoubleVect</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a72eda8458311fdd4c2a899abfdca99d2">h_carre_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">carre du pas d'une maille  <a href="#a72eda8458311fdd4c2a899abfdca99d2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classElem__PolyMAC.html">Elem_PolyMAC</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998">type_elem_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">type de l'element de discretisation  <a href="#aacc27abe34053cf43e4c0af67d21a998"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f">face_normales_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">normales aux faces  <a href="#a9a713f7f3752672fdaba0ddd98c1d81f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleVect.html">DoubleVect</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#ac4cfae3ceac2c9e92565c5d3b4e1e542">longueur_aretes_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a2b20af52d5cf15a8cfc12069ee7298b8">nb_faces_std_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">nombre de faces standard  <a href="#a2b20af52d5cf15a8cfc12069ee7298b8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a1d10485a5ee3b7b952e39ef12cb35416">nb_elem_std_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">nombre d'elements standard  <a href="#a1d10485a5ee3b7b952e39ef12cb35416"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntVect.html">IntVect</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b">rang_elem_non_std_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">rang_elem_non_std_= -1 si l'element est standard rang_elem_non_std_= rang de l'element dans les tableaux relatifs aux elements non standards  <a href="#a8d141e85eb500e9143b06dc38547fb0b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classArrOfInt.html">ArrOfInt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#aa1115569d0d619b49344d24d29760227">ind_faces_virt_non_std_</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">contient les indices des faces virtuelles non standard  <a href="#aa1115569d0d619b49344d24d29760227"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIntTab.html">IntTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a1214dca84091e8bc3f48b17465437986">arete_faces_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDoubleTab.html">DoubleTab</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classZone__PolyMAC.html#a280bc522cc5b57552bb9dcfbdd1493c5">ta_</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>class <a class="el" href="classZone__PolyMAC.html" title="class Zone_PolyMAC Classe instanciable qui derive de Zone_VF. Cette classe contient les informations ...">Zone_PolyMAC</a><br/>
Classe instanciable qui derive de <a class="el" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>.<br/>
Cette classe contient les informations geometriques que demande<br/>
la methode des Volumes Elements Finis (element de Crouzeix-Raviart)<br/>
La classe porte un certain nombre d'informations concernant les faces<br/>
Dans cet ensemble de faces on fait figurer aussi les faces du bord et<br/>
des joints. Pour manipuler les faces on distingue 2 categories:<br/>
- les faces non standard qui sont sur un joint, un bord ou qui sont<br/>
internes tout en appartenant a un element du bord<br/>
- les faces standard qui sont les faces internes n'appartenant pas<br/>
a un element du bord<br/>
Cette distinction correspond au traitement des conditions aux limites:les<br/>
faces standard ne "voient pas" les conditions aux limites.<br/>
L'ensemble des faces est numerote comme suit:<br/>
- les faces qui sont sur une Zone_joint apparaissent en premier<br/>
(dans l'ordre du vecteur les_joints)<br/>
- les faces qui sont sur une Zone_bord apparaissent ensuite<br/>
(dans l'ordre du vecteur les_bords)<br/>
- les faces internes non standard apparaissent ensuite<br/>
- les faces internes standard en dernier<br/>
Finalement on trouve regroupees en premier toutes les faces non standard<br/>
qui vont necessiter un traitement particulier<br/>
On distingue deux types d'elements<br/>
- les elements non standard : ils ont au moins une face de bord<br/>
- les elements standard : ils n'ont pas de face de bord<br/>
Les elements standard (resp. les elements non standard) ne sont pas ranges<br/>
de maniere consecutive dans l'objet <a class="el" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>. On utilise le tableau<br/>
rang_elem_non_std pour acceder de maniere selective a l'un ou<br/>
l'autre des types d'elements </p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00095">95</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a2b6ca217e6535059768279738d03cef1"></a><!-- doxytag: member="Zone_PolyMAC::Zone_PolyMAC" ref="a2b6ca217e6535059768279738d03cef1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Zone_PolyMAC::Zone_PolyMAC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00081">81</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="afff89e8cf755bda91897938115ce861c"></a><!-- doxytag: member="Zone_PolyMAC::~Zone_PolyMAC" ref="afff89e8cf755bda91897938115ce861c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Zone_PolyMAC::~Zone_PolyMAC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00081">81</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ae6c3e86897bee01dc3f6b1aa36dd70c3"></a><!-- doxytag: member="Zone_PolyMAC::ajouter_stabilisation" ref="ae6c3e86897bee01dc3f6b1aa36dd70c3" args="(DoubleTab &amp;M, DoubleTab &amp;N) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::ajouter_stabilisation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00910">910</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="arch_8h_source.html#l00075">F77NAME</a>, <a class="el" href="Zone__CoviMAC_8h_source.html#l00359">kersol()</a>, <a class="el" href="Double_8h_source.html#l00180">max()</a>, <a class="el" href="Double_8h_source.html#l00199">min()</a>, and <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i, j, k, i1, i2, j1, j2, n_f = M.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0), lwork = -1, infoo = 0;
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> A, S, b(n_f, 1), D(1, 1), x(1, 1), work(1), U(n_f - <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>, n_f - <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>), V;

  <span class="comment">/* spectre de M */</span>
  <a class="code" href="Zone__CoviMAC_8h.html#acaf341ab8f98a1dbd4151f02dbd07e18">kersol</a>(M, b, 1e-12, NULL, x, S);
  <span class="keywordtype">double</span> l_max = S(0), l_min = S(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> - 1); <span class="comment">//vp la plus petite sans stabilisation</span>

  <span class="comment">/* D : noyau de N (N.D = 0), de taille n_f * (n_f - dimension) */</span>
  b.resize(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>, 1), <a class="code" href="Zone__CoviMAC_8h.html#acaf341ab8f98a1dbd4151f02dbd07e18">kersol</a>(N, b, 1e-12, &amp;D, x, S);
  assert(D.dimension(1) == n_f - <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>); <span class="comment">//M doit etre de rang d</span>

  <span class="comment">/* matrice U telle que M + D.U.Dt mimimise les termes hors diagonale */</span>
<span class="comment">// une ligne par coeff M(i, j &gt; i), une colonne par terme U(i, j &gt;= i)</span>
  <span class="keywordtype">int</span> n_k = D.dimension(1), n_l = n_f * (n_f - 1) / 2, n_c = n_k * (n_k + 1) / 2, un = 1;
  A.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n_l, n_c), b.resize(n_l, 1);
  <span class="keywordflow">for</span> (i1 = i = 0; i1 &lt; n_f; i1++) <span class="keywordflow">for</span> (i2 = i1 + 1; i2 &lt; n_f; i2++, i++) <span class="comment">//(i1, i2, i) -&gt; numero de ligne</span>
      <span class="keywordflow">for</span> (j1 = j = 0, b(i, 0) = -M(i1, i2); j1 &lt; n_k; j1++) <span class="keywordflow">for</span> (j2 = j1; j2 &lt; n_k; j2++, j++) <span class="comment">//(j1, j2, j) -&gt; numero de colonne</span>
          A(i, j) = D(i1, j1) * D(i2, j2) + (j1 != j2) * D(i1, j2) * D(i2, j1);
  <span class="keywordtype">char</span> trans = <span class="charliteral">&#39;T&#39;</span>;
<span class="comment">// minimise la somme des carres des termes hors diag de M</span>
  <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(dgels)(&amp;trans, &amp;n_c, &amp;n_l, &amp;un, &amp;A(0, 0), &amp;n_c, &amp;b(0, 0), &amp;n_l, &amp;work(0), &amp;lwork, &amp;infoo); <span class="comment">//&quot;workspace query&quot;</span>
  work.resize(lwork = work(0));
  <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(dgels)(&amp;trans, &amp;n_c, &amp;n_l, &amp;un, &amp;A(0, 0), &amp;n_c, &amp;b(0, 0), &amp;n_l, &amp;work(0), &amp;lwork, &amp;infoo); <span class="comment">//le vrai appel</span>
  assert(infoo == 0);
<span class="comment">// reconstruction de U</span>
  <span class="keywordflow">for</span> (j1 = j = 0; j1 &lt; n_k; j1++) <span class="keywordflow">for</span> (j2 = j1; j2 &lt; n_k; j2++, j++) U(j1, j2) = U(j2, j1) = b(j, 0);

  <span class="comment">/* ajustement de U pour que la vp minimale depasse eps */</span>
<span class="comment">// decomposition de Schur U = Vt.S.V</span>
  <span class="keywordtype">char</span> jobz = <span class="charliteral">&#39;V&#39;</span>, uplo = <span class="charliteral">&#39;U&#39;</span>;
  V = U, S.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n_k);
  <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(dsyev)(&amp;jobz, &amp;uplo, &amp;n_k, &amp;V(0, 0), &amp;n_k, &amp;S(0), &amp;work(0), &amp;lwork, &amp;infoo);<span class="comment">//&quot;workspace query&quot;</span>
  work.resize(lwork = work(0));
  <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(dsyev)(&amp;jobz, &amp;uplo, &amp;n_k, &amp;V(0, 0), &amp;n_k, &amp;S(0), &amp;work(0), &amp;lwork, &amp;infoo);
  assert(infoo == 0);
<span class="comment">// pour garantir des vp plus grandes que eps : S(k) -&gt; max(S(k), eps)</span>
  <span class="keywordflow">for</span> (i = 0, U = 0; i &lt; n_k; i++) <span class="keywordflow">for</span> (j = 0; j &lt; n_k; j++) <span class="keywordflow">for</span> (k = 0; k &lt; n_k; k++) U(i, j) += V(k, i) * <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(<a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(S(k), l_min), l_max) * V(k, j);

  <span class="comment">/* ajout a M */</span>
  <span class="keywordflow">for</span> (i1 = 0; i1 &lt; n_f; i1++) <span class="keywordflow">for</span> (i2 = 0; i2 &lt; n_f; i2++) <span class="keywordflow">for</span> (j1 = 0; j1 &lt; n_k; j1++) <span class="keywordflow">for</span> (j2 = 0; j2 &lt; n_k; j2++)
          M(i1, i2) += D(i1, j1) * U(j1, j2) * D(i2, j2);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1374a0b9ba180cd834269be02f337ef5"></a><!-- doxytag: member="Zone_PolyMAC::arete_faces" ref="a1374a0b9ba180cd834269be02f337ef5" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classIntTab.html">IntTab</a>&amp; Zone_PolyMAC::arete_faces </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00126">126</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00223">arete_faces_</a>.</p>

<p>Referenced by <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00186">Champ_Face_PolyMAC::init_ra()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00236">Champ_Face_PolyMAC::init_va()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#a1214dca84091e8bc3f48b17465437986">arete_faces_</a>;
  };
</pre></div>
</div>
</div>
<a class="anchor" id="a21c54ff5bcbcde1c828969cf93bfb205"></a><!-- doxytag: member="Zone_PolyMAC::calculer_h_carre" ref="a21c54ff5bcbcde1c828969cf93bfb205" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::calculer_h_carre </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00671">671</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Zone__VF_8h_source.html#l00581">Zone_VF::elem_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00054">Zone_VF::face_surfaces()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00207">h_carre</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00208">h_carre_</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00140">Zone_dis_base::nb_elem()</a>, <a class="el" href="Zone__VF_8h_source.html#l00519">Zone_VF::nb_faces()</a>, <a class="el" href="Zone_8h_source.html#l00469">Zone::nb_faces_elem()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="DoubleVect_8h_source.html#l00193">DoubleVect::resize()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00231">type_elem()</a>, <a class="el" href="Zone_8h_source.html#l00491">Zone::type_elem()</a>, <a class="el" href="Source__Generique__Face__PolyMAC_8cpp_source.html#l00045">valeur()</a>, <a class="el" href="Elem__geom_8h_source.html#l00044">Deriv_Elem_geom_base::valeur()</a>, <a class="el" href="Zone__VF_8h_source.html#l00430">Zone_VF::volumes()</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Calcul de h_carre</span>
  <a class="code" href="classZone__PolyMAC.html#a3122c86faa41d079ec3ed009a3c2136e" title="carre du pas du maillage">h_carre</a> = 1.e30;
  <a class="code" href="classZone__PolyMAC.html#a72eda8458311fdd4c2a899abfdca99d2" title="carre du pas d&#39;une maille">h_carre_</a>.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>());
<span class="comment">// Calcul des surfaces</span>
  <a class="code" href="classElem__geom__base.html" title="Classe Elem_geom_base Cette classe est la classe de base pour la definition d&#39;elements geometriques c...">Elem_geom_base</a>&amp; elem_geom = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classDeriv__Elem__geom__base.html#a384b487459a33f9f521fb16539ec81de">valeur</a>();
  <span class="keywordtype">int</span> is_polyedre = <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPoly__geom__base.html" title=": class Poly_geom_base &lt;Description of class Poly_geom_base&gt;">Poly_geom_base</a>, elem_geom) ? 1 : 0;
  <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> PolyIndex = is_polyedre ? <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPoly__geom__base.html" title=": class Poly_geom_base &lt;Description of class Poly_geom_base&gt;">Poly_geom_base</a>, <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone__PolyMAC.html#a369ea15b260f758e13bcdc5385460426">type_elem</a>().<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>()).getElemIndex() : <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>(0);

  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; surfaces=<a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>();
  <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; nbe=<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>();

  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;nbe; num_elem++)
    {
      <span class="keywordtype">double</span> surf_max = 0;
      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_elem = is_polyedre ? PolyIndex(num_elem+1) - PolyIndex(num_elem) : <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().nb_faces_elem();
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_faces_elem; i++)
        {
          <span class="keywordtype">double</span> surf = surfaces(<a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(num_elem,i));
          surf_max = (surf &gt; surf_max)? surf : surf_max;
        }
      <span class="keywordtype">double</span> vol = <a class="code" href="classZone__VF.html#a9598b08cb9126f88cfafe72fc0eeca70" title="renvoie le tableaux des volumes des mailles.">volumes</a>(num_elem)/surf_max;
      vol *= vol;
      <a class="code" href="classZone__PolyMAC.html#a72eda8458311fdd4c2a899abfdca99d2" title="carre du pas d&#39;une maille">h_carre_</a>(num_elem) = vol;
      <a class="code" href="classZone__PolyMAC.html#a3122c86faa41d079ec3ed009a3c2136e" title="carre du pas du maillage">h_carre</a> = ( vol &lt; <a class="code" href="classZone__PolyMAC.html#a3122c86faa41d079ec3ed009a3c2136e" title="carre du pas du maillage">h_carre</a> )? vol : <a class="code" href="classZone__PolyMAC.html#a3122c86faa41d079ec3ed009a3c2136e" title="carre du pas du maillage">h_carre</a>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a14135870d92d9d24bc6c12a98a3e320c"></a><!-- doxytag: member="Zone_PolyMAC::calculer_volumes_entrelaces" ref="a14135870d92d9d24bc6c12a98a3e320c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::calculer_volumes_entrelaces </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00700">700</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Zone__VF_8cpp_source.html#l00623">Zone_VF::creer_tableau_faces()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00341">dot()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="Zone__VF_8h_source.html#l00054">Zone_VF::face_surfaces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00232">Zone_VF::face_voisins_</a>, <a class="el" href="Zone__VF_8h_source.html#l00519">Zone_VF::nb_faces()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>, <a class="el" href="Zone__VF_8h_source.html#l00219">Zone_VF::volumes_entrelaces_</a>, <a class="el" href="Zone__VF_8h_source.html#l00220">Zone_VF::volumes_entrelaces_dir_</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, and <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>.</p>
<div class="fragment"><pre class="fragment">{
<span class="comment">// Cerr &lt;&lt; &quot;les normales aux faces &quot; &lt;&lt; face_normales() &lt;&lt; finl;</span>
<span class="comment">// On calcule les volumes entrelaces;</span>
<span class="comment">// volumes_entrelaces_.resize(nb_faces());</span>

  <a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(<a class="code" href="classZone__VF.html#a4d84eafd75968d81d72275f240390ee8" title="volumes entrelaces pour l&#39;integration des Qdm">volumes_entrelaces_</a>);
  <a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>(), 2);
  <a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(<a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>);
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; fs = <a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>();

  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=0; num_face&lt;<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>(); num_face++)
    {
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir=0; dir&lt;2; dir++)
        {
          <span class="keywordtype">int</span> elem = <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(num_face,dir);
          <span class="keywordflow">if</span> (elem!=-1)
            {
              <a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>(num_face, dir) = sqrt(<a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(elem, 0), &amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(elem, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(num_face, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(num_face, 0))) * fs[num_face];
              <a class="code" href="classZone__VF.html#a4d84eafd75968d81d72275f240390ee8" title="volumes entrelaces pour l&#39;integration des Qdm">volumes_entrelaces_</a>[num_face] += <a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>(num_face, dir);
            }
        }
    }
  <a class="code" href="classZone__VF.html#a4d84eafd75968d81d72275f240390ee8" title="volumes entrelaces pour l&#39;integration des Qdm">volumes_entrelaces_</a>.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
  <a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab5dee6d3a7bf4f29644044a61436d429"></a><!-- doxytag: member="Zone_PolyMAC::carre_pas_du_maillage" ref="ab5dee6d3a7bf4f29644044a61436d429" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Zone_PolyMAC::carre_pas_du_maillage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00312">312</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00207">h_carre</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#a3122c86faa41d079ec3ed009a3c2136e" title="carre du pas du maillage">h_carre</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab4b79e85aeefbb5d1e883c66d269a3d4"></a><!-- doxytag: member="Zone_PolyMAC::carre_pas_maille" ref="ab4b79e85aeefbb5d1e883c66d269a3d4" args="(int i) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Zone_PolyMAC::carre_pas_maille </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00113">113</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00208">h_carre_</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#a72eda8458311fdd4c2a899abfdca99d2" title="carre du pas d&#39;une maille">h_carre_</a>(i);
  };
</pre></div>
</div>
</div>
<a class="anchor" id="ad110ffa4e8da492bc54ef906d633efbc"></a><!-- doxytag: member="Zone_PolyMAC::cree_instance" ref="ad110ffa4e8da492bc54ef906d633efbc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classObjet__U.html">Objet_U</a> * Zone_PolyMAC::cree_instance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00081">81</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="aac86d6f78066fe8fb87d7d39d5794474"></a><!-- doxytag: member="Zone_PolyMAC::creer_faces_virtuelles_non_std" ref="aac86d6f78066fe8fb87d7d39d5794474" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::creer_faces_virtuelles_non_std </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>creation de l'espace distant pour les faces virtuelles;<br/>
creation du tableau des faces virtuelles de bord </p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00830">830</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="IntVect_8cpp_source.html#l00276">IntVect::echange_espace_virtuel()</a>, <a class="el" href="Joint_8cpp_source.html#l00149">Joint::esp_dist_faces()</a>, <a class="el" href="Zone_8h_source.html#l01250">Zone::ind_faces_virt_bord()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00218">ind_faces_virt_non_std_</a>, <a class="el" href="Zone__VF_8h_source.html#l00405">Zone_VF::joint()</a>, <a class="el" href="Zone__VF_8h_source.html#l00504">Zone_VF::nb_joints()</a>, <a class="el" href="Joint_8cpp_source.html#l00099">Joint::PEvoisin()</a>, <a class="el" href="Zone__VF_8h_source.html#l00512">Zone_VF::premiere_face_int()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00240">ArrOfInt::resize_array()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00342">ArrOfInt::size_array()</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00726">remplir_elem_faces()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classZone__PolyMAC.html#aa1115569d0d619b49344d24d29760227" title="contient les indices des faces virtuelles non standard">ind_faces_virt_non_std_</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(314);
  <a class="code" href="classZone__PolyMAC.html#aa1115569d0d619b49344d24d29760227" title="contient les indices des faces virtuelles non standard">ind_faces_virt_non_std_</a> = -999;
<span class="preprocessor">#if 0</span>
<span class="preprocessor"></span>  <span class="keywordtype">int</span> i,j,id_joint;
  <span class="keywordtype">int</span> nb_faces_front=<a class="code" href="classZone__VF.html#a12869806fa4834aca8f2964e16509dfd" title="une face est interne ssi elle separe deux elements. renvoie le numero de la premiere face interne...">premiere_face_int</a>();
  <span class="keywordtype">int</span> nb_faces_virt=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a95faad2781efaed3b1129a2b4ec1644b">ind_faces_virt_bord</a>().<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();


<span class="comment">// Constitution du tableau des indices de faces</span>
<span class="comment">// virtuelles non standards.</span>
  <span class="keywordtype">int</span> prem_face_std=premiere_face_std();
  <a class="code" href="classIntVect.html">IntVect</a> ind_faces_nstd(nb_faces_non_std());
  <a class="code" href="classIntVect.html">IntVect</a> ind_faces(nb_faces_);
  <span class="keyword">const</span> VectEsp_Virt&amp; vev_id_f = ind_faces.renvoi_espaces_virtuels();

  <span class="keywordflow">for</span>(j=0; j&lt;nb_faces_; j++)
    ind_faces[j]=j;
  <span class="keywordflow">for</span>(j=<a class="code" href="classZone__VF.html#a12869806fa4834aca8f2964e16509dfd" title="une face est interne ssi elle separe deux elements. renvoie le numero de la premiere face interne...">premiere_face_int</a>(); j&lt;prem_face_std; j++)
    ind_faces_nstd[j]=j;

  <span class="keywordflow">for</span>(id_joint=0; id_joint&lt;<a class="code" href="classZone__VF.html#a9992bccc1f1e4a6f93287bd9fe219d29" title="renvoie le nombre de joints">nb_joints</a>(); id_joint++)
    {
      <a class="code" href="classJoint.html" title="La classe Joint est une Frontiere qui contient les faces et les sommets de joint avec la zone PEvoisi...">Joint</a>&amp; le_joint = <a class="code" href="classZone__VF.html#a1cc36e321abd137ddd1c8f70ce74f4cf" title="renvoie le ieme joint.">joint</a>(id_joint);
      <span class="keywordtype">int</span> PEvoisin=le_joint.<a class="code" href="classJoint.html#a0952bc5c7805434ccd8cd5c9b01e3747" title="Renvoie PEvoisin (numero de la zone voisine)">PEvoisin</a>();
      <span class="keyword">const</span> <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; edf=le_joint.<a class="code" href="classJoint.html#ab4f3bf9722a57679feefd4cd7352590e">esp_dist_faces</a>();

      <span class="keywordtype">int</span> nbfd = edf.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
      ind_faces.ajoute_espace_distant(PEvoisin,edf);
      <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> tempo(nbfd);
      <span class="keywordtype">int</span> cpt=0;
      <span class="keywordflow">for</span>(i=0; i&lt;nbfd; i++)
        <span class="keywordflow">if</span>((edf[i]&lt;prem_face_std)&amp;&amp;(edf[i]&gt;=nb_faces_front))
          tempo[cpt++]=edf[i];
      tempo.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(cpt);
      ind_faces_nstd.ajoute_espace_distant(PEvoisin,tempo);
    }
  ind_faces.echange_espace_virtuel();
  ind_faces_nstd.echange_espace_virtuel();

  <span class="keyword">const</span> VectEsp_Virt&amp; vev_id_fnstd =
    ind_faces_nstd.renvoi_espaces_virtuels();
  <a class="code" href="classZone__PolyMAC.html#aa1115569d0d619b49344d24d29760227" title="contient les indices des faces virtuelles non standard">ind_faces_virt_non_std_</a>.<a class="code" href="classArrOfInt.html#a9b3afbb46b16870dbd36236c8935b535">resize_array</a>(nb_faces_virt);
  <span class="keywordflow">for</span>(id_joint=0; id_joint&lt;<a class="code" href="classZone__VF.html#a9992bccc1f1e4a6f93287bd9fe219d29" title="renvoie le nombre de joints">nb_joints</a>(); id_joint++)
    {
      <span class="keywordtype">int</span> deb=vev_id_f[id_joint].deb();
      <span class="keywordtype">int</span> fin=deb+vev_id_f[id_joint].nb();
      <span class="keywordtype">int</span> deb_b=vev_id_fnstd[id_joint].deb();
      <span class="keywordtype">int</span> fin_b=deb_b+vev_id_fnstd[id_joint].nb();
      <span class="keywordflow">for</span>(i=deb_b; i&lt;fin_b; i++)
        {
          <span class="keywordflow">for</span>(j=deb; j&lt;fin; j++)
            <span class="keywordflow">if</span>(ind_faces[j]==ind_faces_nstd[i])
              <span class="keywordflow">break</span>;
          assert(j&lt;fin);
          <a class="code" href="classZone__PolyMAC.html#aa1115569d0d619b49344d24d29760227" title="contient les indices des faces virtuelles non standard">ind_faces_virt_non_std_</a>[j-nb_faces_]=i;
        }
    }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>}
</pre></div>
</div>
</div>
<a class="anchor" id="a440d581bbedd755e0fd86e8e2ff7f444"></a><!-- doxytag: member="Zone_PolyMAC::cross" ref="a440d581bbedd755e0fd86e8e2ff7f444" args="(int dima, int dimb, const double *a, const double *b, const double *ma=NULL, const double *mb=NULL) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::array&lt; double, 3 &gt; Zone_PolyMAC::cross </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dima</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dimb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>ma</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>mb</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00349">349</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01249">init_m1_2d()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00186">Champ_Face_PolyMAC::init_ra()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01156">init_rf()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00236">Champ_Face_PolyMAC::init_va()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01201">init_we_2d()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01221">init_we_3d()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00573">orthocentrer()</a>.</p>
<div class="fragment"><pre class="fragment">{
  std::array&lt;double, 3&gt; va = {{ 0, 0, 0 }}, vb = {{ 0, 0, 0 }}, res;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dima; i++) va[i] = a[i] - (ma ? ma[i] : 0);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dimb; i++) vb[i] = b[i] - (mb ? mb[i] : 0);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) res[i] = va[(i + 1) % 3] * vb[(i + 2) % 3] - va[(i + 2) % 3] * vb[(i + 1) % 3];
  <span class="keywordflow">return</span> res;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5177ecf773d223f075c3aea6576610a5"></a><!-- doxytag: member="Zone_PolyMAC::detecter_faces_non_planes" ref="a5177ecf773d223f075c3aea6576610a5" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::detecter_faces_non_planes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00648">648</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Domaine_8h_source.html#l00500">Domaine::coord_sommets()</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00341">dot()</a>, <a class="el" href="communications_8cpp_source.html#l00452">envoyer_all_to_all()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>, <a class="el" href="Zone__VF_8h_source.html#l00239">Zone_VF::face_sommets_</a>, <a class="el" href="Zone__VF_8h_source.html#l00054">Zone_VF::face_surfaces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00466">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Double_8h_source.html#l00048">M_PI</a>, <a class="el" href="Process_8cpp_source.html#l00117">Process::me()</a>, <a class="el" href="Zone__VF_8h_source.html#l00519">Zone_VF::nb_faces()</a>, <a class="el" href="Process_8cpp_source.html#l00109">Process::nproc()</a>, <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; f_e = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(), &amp;f_s = <a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>;
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xs = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>(), &amp;nf = <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>;
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; fs = <a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>();
  <span class="keywordtype">int</span> i, j, f, s, rk = <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), np = <a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>();
  <span class="keywordtype">double</span> sin2;
  <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> val(np); <span class="comment">//sur chaque proc : { cos^2 max, indice de face, indices d&#39;elements }</span>
  <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> face(np), elem1(np), elem2(np);

<span class="comment">// sur chaque proc : on cherche l&#39;angle le plus grand entre un sommet et le plan de sa face</span>
  <span class="keywordflow">for</span> (f = 0; f &lt; <a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>(); f++) <span class="keywordflow">for</span> (i = 0; i &lt; f_s.dimension(1) &amp;&amp; (s = f_s(f, i)) &gt;= 0; i++)
      <span class="keywordflow">if</span> ((sin2 = std::pow(<a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;xs(s, 0), &amp;nf(f, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0)) / fs(f), 2) / <a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;xs(s, 0), &amp;xs(s, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0))) &gt; val(rk))
        val(rk) = sin2, face(rk) = f, elem1(rk) = f_e(f, 0), elem2(rk) = f_e(f, 1);
  <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(val, val), <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(face, face), <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(elem1, elem1), <a class="code" href="communications_8cpp.html#a5ceda011ec527d63b691f62cd2fb61c8">envoyer_all_to_all</a>(elem2, elem2);

  <span class="keywordflow">for</span> (i = j = sin2 = 0; i &lt; Process::nproc(); i++) if (val(i) &gt; sin2) sin2 = val(i), j = i;
  <span class="keywordtype">double</span> theta = asin(sqrt(sin2)) * 180 / <a class="code" href="Double_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>;
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Zone_PolyMAC : angle sommet/face max &quot;</span> &lt;&lt; theta &lt;&lt; <span class="stringliteral">&quot; deg (proc &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; , face &quot;</span>;
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; face(j) &lt;&lt; <span class="stringliteral">&quot; , elems &quot;</span> &lt;&lt; elem1(j) &lt;&lt; <span class="stringliteral">&quot; / &quot;</span> &lt;&lt; elem2(j) &lt;&lt; <span class="stringliteral">&quot; )&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  <span class="keywordflow">if</span> (theta &gt; 1) <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Zone_PolyMAC : face non plane detectee! Veuillez reparer votre maillage...&quot;</span> &lt;&lt; finl, <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="abf34bff21d4615b9727d0d9d256dbe3b"></a><!-- doxytag: member="Zone_PolyMAC::discretiser" ref="abf34bff21d4615b9727d0d9d256dbe3b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::discretiser </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Genere les faces<br/>
construits les frontieres. </p>

<p><p>&lt; Detache la structure parallele</p>
<p>&lt; Extremas du domaine et volumes</p>
<p>&lt; Aires des bords</p>
<p>&lt; Nombre elements et sommets </p>
</p>

<p>Reimplemented from <a class="el" href="classZone__VF.html#ab147799e94c91fc4b18b190cdd3dbd0a">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">344</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="MD__Vector__composite_8cpp_source.html#l00307">MD_Vector_composite::add_part()</a>, <a class="el" href="Zone_8h_source.html#l01290">Zone::aretes_som()</a>, <a class="el" href="Zone__VF_8cpp_source.html#l00400">Zone_VF::calculer_diametres_hydrauliques()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00671">calculer_h_carre()</a>, <a class="el" href="Zone__VF_8cpp_source.html#l00387">Zone_VF::calculer_porosites()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00700">calculer_volumes_entrelaces()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Domaine_8h_source.html#l00500">Domaine::coord_sommets()</a>, <a class="el" href="MD__Vector_8cpp_source.html#l00031">MD_Vector::copy()</a>, <a class="el" href="Faces__builder_8cpp_source.html#l00940">Zone::creer_aretes()</a>, <a class="el" href="Zone__VF_8cpp_source.html#l00628">Zone_VF::creer_tableau_aretes()</a>, <a class="el" href="Zone__VF_8cpp_source.html#l00623">Zone_VF::creer_tableau_faces()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00648">detecter_faces_non_planes()</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="IntTab_8h_source.html#l00244">IntTab::dimension_tot()</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00341">dot()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00277">DoubleVect::echange_espace_virtuel()</a>, <a class="el" href="Zone__VF_8h_source.html#l00581">Zone_VF::elem_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00238">Zone_VF::elem_faces_</a>, <a class="el" href="Double_8h_source.html#l00273">est_egal()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>, <a class="el" href="Zone__VF_8h_source.html#l00616">Zone_VF::face_sommets()</a>, <a class="el" href="Zone__VF_8h_source.html#l00239">Zone_VF::face_sommets_</a>, <a class="el" href="Zone__VDF_8cpp_source.html#l00352">face_vois()</a>, <a class="el" href="Zone__VF_8h_source.html#l00466">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="IntVect_8h_source.html#l00087">IntVect::get_md_vector()</a>, <a class="el" href="Domaine_8h_source.html#l00204">Domaine::le_nom()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00211">longueur_aretes_</a>, <a class="el" href="Zone__VF_8h_source.html#l00205">Zone_VF::md_vector_aretes()</a>, <a class="el" href="Zone__VF_8h_source.html#l00248">Zone_VF::md_vector_aretes_</a>, <a class="el" href="Zone__VF_8h_source.html#l00200">Zone_VF::md_vector_faces()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00200">mdv_elems_faces</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00200">mdv_faces_aretes</a>, <a class="el" href="Zone_8h_source.html#l01266">Zone::nb_aretes_tot()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Zone__VF_8h_source.html#l00519">Zone_VF::nb_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00527">Zone_VF::nb_faces_tot()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00152">Zone_dis_base::nb_som_tot()</a>, <a class="el" href="Elem__PolyMAC_8h_source.html#l00069">Elem_PolyMAC::normale()</a>, <a class="el" href="Objet__U_8cpp_source.html#l00132">Objet_U::que_suis_je()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>, <a class="el" href="Zone_8h_source.html#l01295">Zone::set_aretes_som()</a>, <a class="el" href="Zone_8h_source.html#l01308">Zone::set_elem_aretes()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00159">som_arete</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00144">swap()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00224">ta_</a>, <a class="el" href="Zone_8h_source.html#l00491">Zone::type_elem()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00209">type_elem_</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00329">typer_elem()</a>, <a class="el" href="Elem__PolyMAC_8h_source.html#l00041">Deriv_Elem_PolyMAC_base::valeur()</a>, <a class="el" href="Elem__geom_8h_source.html#l00044">Deriv_Elem_geom_base::valeur()</a>, <a class="el" href="Zone__VF_8h_source.html#l00240">Zone_VF::xa_</a>, <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>
<div class="fragment"><pre class="fragment">{

  <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone_geom=<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
  <a class="code" href="classZone__PolyMAC.html#add58bbb3309b38e7710b404c0525c0f0">typer_elem</a>(zone_geom);
  <a class="code" href="classElem__geom__base.html" title="Classe Elem_geom_base Cette classe est la classe de base pour la definition d&#39;elements geometriques c...">Elem_geom_base</a>&amp; elem_geom = zone_geom.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classDeriv__Elem__geom__base.html#a384b487459a33f9f521fb16539ec81de">valeur</a>();
  <a class="code" href="classZone__PolyMAC.html#abf34bff21d4615b9727d0d9d256dbe3b" title="Genere les faces construits les frontieres.">Zone_VF::discretiser</a>();

<span class="comment">// Correction du tableau facevoisins:</span>
<span class="comment">// A l&#39;issue de Zone_VF::discretiser(), les elements voisins 0 et 1 d&#39;une</span>
<span class="comment">// face sont les memes sur tous les processeurs qui possedent la face.</span>
<span class="comment">// Si la face est virtuelle et qu&#39;un des deux elements voisins n&#39;est</span>
<span class="comment">// pas connu (il n&#39;est pas dans l&#39;epaisseur du joint), l&#39;element voisin</span>
<span class="comment">// vaut -1. Cela peut etre un voisin 0 ou un voisin 1.</span>
<span class="comment">// On corrige les faces virtuelles pour que, si un element voisin n&#39;est</span>
<span class="comment">// pas connu, alors il est voisin1. Le voisin0 est donc toujours valide.</span>
  {
    <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; <a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a> = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>();
    <span class="keyword">const</span> <span class="keywordtype">int</span> debut = <a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
    <span class="keyword">const</span> <span class="keywordtype">int</span> fin   = <a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = debut; i &lt; fin; i++)
      {
        <span class="keywordflow">if</span> (<a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(i, 0) == -1)
          {
            <a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(i, 0) = <a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(i, 1);
            <a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(i, 1) = -1;
          }
      }
  }

<span class="comment">// Verification de la coherence entre l&#39;element geometrique et</span>
<span class="comment">// l&#39;elemnt de discretisation</span>


  <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classSegment__PolyMAC.html">Segment_PolyMAC</a>,<a class="code" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998" title="type de l&#39;element de discretisation">type_elem_</a>.<a class="code" href="classDeriv__Elem__PolyMAC__base.html#a6ef33a3fccc63510647e9e87378e576c">valeur</a>()))
    {
      <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classSegment.html" title="Classe Segment Cette classe represente l&#39;element geometrique segment. Un segment a 1 face et 2 sommet...">Segment</a>,elem_geom))
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Le type de l&#39;element geometrique &quot;</span> &lt;&lt; elem_geom.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; est incorrect&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
        }
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classTri__PolyMAC.html">Tri_PolyMAC</a>,<a class="code" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998" title="type de l&#39;element de discretisation">type_elem_</a>.<a class="code" href="classDeriv__Elem__PolyMAC__base.html#a6ef33a3fccc63510647e9e87378e576c">valeur</a>()))
    {
      <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classTriangle.html" title="Classe Triangle Cette classe represente l&#39;element geometrique Triangle. Un triangle a 3 faces...">Triangle</a>,elem_geom))
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Le type de l&#39;element geometrique &quot;</span> &lt;&lt;
               elem_geom.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; est incorrect&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Seul le type Triangle est compatible avec la discretisation PolyMAC en dimension 2&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Il faut trianguler le domaine lorsqu&#39;on utilise le mailleur interne&quot;</span> ;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; en utilisant l&#39;instruction: Trianguler nom_dom&quot;</span> &lt;&lt; finl;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
        }
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classTetra__PolyMAC.html">Tetra_PolyMAC</a>,<a class="code" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998" title="type de l&#39;element de discretisation">type_elem_</a>.<a class="code" href="classDeriv__Elem__PolyMAC__base.html#a6ef33a3fccc63510647e9e87378e576c">valeur</a>()))
    {
      <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classTetraedre.html" title="Classe Tetraedre Cette classe represente l&#39;element geometrique Tetraedre. Un tetraedre est un polyedr...">Tetraedre</a>,elem_geom))
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Le type de l&#39;element geometrique &quot;</span> &lt;&lt;
               elem_geom.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; est incorrect&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Seul le type Tetraedre est compatible avec la discretisation PolyMAC en dimension 3&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Il faut tetraedriser le domaine lorsqu&#39;on utilise le mailleur interne&quot;</span>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; en utilisant l&#39;instruction: Tetraedriser nom_dom&quot;</span> &lt;&lt; finl;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
        }
    }

  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classQuadri__PolyMAC.html">Quadri_PolyMAC</a>,<a class="code" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998" title="type de l&#39;element de discretisation">type_elem_</a>.<a class="code" href="classDeriv__Elem__PolyMAC__base.html#a6ef33a3fccc63510647e9e87378e576c">valeur</a>()))
    {

      <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classQuadrangle__VEF.html" title="Classe Quadrangle_VEF Cette classe represente l&#39;element geometrique Quadrangle_VEF. Un Quadrangle_VEF a 4 faces, 4 sommets et un seul type de face ayant 2 sommets par face.">Quadrangle_VEF</a>,elem_geom))
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Le type de l&#39;element geometrique &quot;</span> &lt;&lt; elem_geom.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; est incorrect&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
        }
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classHexa__PolyMAC.html">Hexa_PolyMAC</a>,<a class="code" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998" title="type de l&#39;element de discretisation">type_elem_</a>.<a class="code" href="classDeriv__Elem__PolyMAC__base.html#a6ef33a3fccc63510647e9e87378e576c">valeur</a>()))
    {

      <span class="keywordflow">if</span> (!<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classHexaedre__VEF.html" title="Classe Hexaedre_VEF Cette classe represente l&#39;element geometrique Hexaedre_VEF. Un Hexaedre_VEF est u...">Hexaedre_VEF</a>,elem_geom))
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Le type de l&#39;element geometrique &quot;</span> &lt;&lt; elem_geom.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; est incorrect&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
        }
    }

  <span class="keywordtype">int</span> num_face;


<span class="comment">// On remplit le tableau face_normales_;</span>
<span class="comment">// Attention : le tableau face_voisins n&#39;est pas exactement un</span>
<span class="comment">// tableau distribue. Une face n&#39;a pas ses deux voisins dans le</span>
<span class="comment">// meme ordre sur tous les processeurs qui possedent la face.</span>
<span class="comment">// Donc la normale a la face peut changer de direction d&#39;un</span>
<span class="comment">// processeur a l&#39;autre, y compris pour les faces de joint.</span>
  {
    <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>();
    <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<span class="comment">// const Domaine &amp; dom = zone().domaine();</span>
<span class="comment">// Scatter::creer_tableau_distribue(dom, Joint::FACE, face_normales_);</span>
    <a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(<a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>);
    <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_som = <a class="code" href="classZone__VF.html#a6cac6a6e8fc1e7b0381b7b15eb451257" title="renvoie le tableau de connectivite faces/sommets.">face_sommets</a>();
    <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; face_vois = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>();
    <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_face = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>();
    <span class="keyword">const</span> <span class="keywordtype">int</span> n_tot = <a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
    <span class="keywordflow">for</span> (num_face = 0; num_face &lt; n_tot; num_face++)
      {
        <a class="code" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998" title="type de l&#39;element de discretisation">type_elem_</a>.<a class="code" href="classElem__PolyMAC.html#adc49b83205f71e4e400accc53a3360b0">normale</a>(num_face,
                           <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>,
                           face_som, face_vois, elem_face, zone_geom);
      }

    <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> old(<a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>);
    <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();
    <span class="keywordflow">for</span> (num_face = 0; num_face &lt; n_tot; num_face++)
      {
        <span class="keywordtype">int</span> <span class="keywordtype">id</span>=1;
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d=0; d&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; d++)
          <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(old(num_face,d),<a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>(num_face,d)))
            {
              <span class="keywordtype">id</span>=0;
              <span class="keywordflow">if</span> (!<a class="code" href="Double_8h.html#ac86f5f350b0f95fd8c34b0ac8d720f6f">est_egal</a>(old(num_face,d),-<a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>(num_face,d)))
                {
                  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a>&lt;&lt;<span class="stringliteral">&quot;pb in faces_normales&quot;</span> &lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
                  <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
                }
            }
        <span class="keywordflow">if</span> (<span class="keywordtype">id</span>==0)
          {
<span class="comment">// on a change le sens de la normale, on inverse elem1 elem2</span>
            <a class="code" href="classZone__PolyMAC.html#a807c2e05fffa2b4cc2518c0e68855ed3">std::swap</a>(<a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(num_face,0),<a class="code" href="Zone__VDF_8cpp.html#a6edff0459a52988927869a8a2eb5573c">face_vois</a>(num_face,1));
          }
      }
  }

  <span class="comment">/* recalcul de xv pour avoir les vrais CG des faces */</span>
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; coords = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face = 0; dimension == 3 &amp;&amp; face &lt; <a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>(); face++)
    {
      <span class="keywordtype">double</span> xs[3] = { 0, }, S = 0;
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1); k++) <span class="keywordflow">if</span> (<a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>(face, k) &gt;= 0)
          {
            <span class="keywordtype">int</span> s0 = <a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>(face, 0), s1 = <a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>(face, k),
                s2 = k + 1 &lt; <a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; <a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>(face, k + 1) &gt;= 0 ? <a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>(face, k +1) : s0;
            <span class="keywordtype">double</span> s = 0;
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; 3; r++) <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)
                s += (i ? -1 : 1) * <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>(face, r) * (coords(s2, (r + 1 +  i) % 3) - coords(s0, (r + 1 +  i) % 3))
                     * (coords(s1, (r + 1 + !i) % 3) - coords(s0, (r + 1 + !i) % 3));
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; 3; r++) xs[r] += s * (coords(s0, r) + coords(s1, r) + coords(s2, r)) / 3;
            S += s;
          }
      <span class="keywordflow">if</span> (S == 0 &amp;&amp; <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classHexa__PolyMAC.html">Hexa_PolyMAC</a>,<a class="code" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998" title="type de l&#39;element de discretisation">type_elem_</a>.<a class="code" href="classDeriv__Elem__PolyMAC__base.html#a6ef33a3fccc63510647e9e87378e576c">valeur</a>()))
        {
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;===============================&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in your mesh for PolyMAC!&quot;</span> &lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Add this keyword before discretization in your data file to create polyedras:&quot;</span> &lt;&lt; finl;
          <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Polyedriser &quot;</span> &lt;&lt; <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>() &lt;&lt; finl;
          <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
        }
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; 3; r++) <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(face, r) = xs[r] / S;
    }
  <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>.<a class="code" href="classDoubleVect.html#abfebbc2f685ce7bc4b80c720d7da9bf3">echange_espace_virtuel</a>();

<span class="comment">// orthocentrer();</span>

  <a class="code" href="classZone__PolyMAC.html#a5177ecf773d223f075c3aea6576610a5">detecter_faces_non_planes</a>();

  <a class="code" href="classZone__VF.html#aff50cd7737b84daca35f56ebf78aee47">Zone_VF::calculer_porosites</a>();
  <a class="code" href="classZone__VF.html#a96ffa418fd3594b770d03c22c2ef47b6">Zone_VF::calculer_diametres_hydrauliques</a>();
  <a class="code" href="classZone__PolyMAC.html#a14135870d92d9d24bc6c12a98a3e320c">calculer_volumes_entrelaces</a>();
  <a class="code" href="classZone__PolyMAC.html#a21c54ff5bcbcde1c828969cf93bfb205">calculer_h_carre</a>();

  <span class="comment">/* ordre canonique dans elem_faces_ */</span>
  std::map&lt;std::array&lt;double, 3&gt;, <span class="keywordtype">int</span>&gt; xv_fsa;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0, i, j, f; e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++)
    {
      <span class="keywordflow">for</span> (i = 0, j = 0, xv_fsa.clear(); i &lt; <a class="code" href="classZone__VF.html#acd9376481d4268df6a0c394c5a1a0e61" title="connectivite element/faces">elem_faces_</a>.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (f = <a class="code" href="classZone__VF.html#acd9376481d4268df6a0c394c5a1a0e61" title="connectivite element/faces">elem_faces_</a>(e, i)) &gt;= 0; i++)
        xv_fsa[ {{ <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0), <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 1), dimension &lt; 3 ? 0 : <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 2) }}] = f;
      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;c_f : xv_fsa) <a class="code" href="classZone__VF.html#acd9376481d4268df6a0c394c5a1a0e61" title="connectivite element/faces">elem_faces_</a>(e, j) = c_f.second, j++;
    }

<span class="comment">// diverses quantites liees aux aretes</span>
  <span class="keywordflow">if</span> (dimension &gt; 2)
    {
      <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#af27e3cb93ea77b05069e6016f981e227">creer_aretes</a>();
      <a class="code" href="classZone__VF.html#ae1b492b7e2ca6a4c22ec6f31996494a3">md_vector_aretes_</a> = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#affa60690e1b372fa4c01d6088267dbe4" title="renvoie le tableau de connectivite aretes/sommets.">aretes_som</a>().<a class="code" href="classIntVect.html#ae74e1fee6aca124d32718267e33a40c6">get_md_vector</a>();

      <span class="comment">/* ordre canonique dans aretes_som */</span>
      <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; a_s = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a3d3b8afa4cacd3da37252096b283db18">set_aretes_som</a>(), &amp;e_a = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a93022949033dd71337db67980a5378da">set_elem_aretes</a>();
      <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xs = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> a = 0, i, j, s; a &lt; a_s.<a class="code" href="classIntTab.html#a71e9b9ddc1793094b1b3f109377952b1" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0); a++)
        {
          <span class="keywordflow">for</span> (i = 0, j = 0, xv_fsa.clear(); i &lt; a_s.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (s = a_s(a, i)) &gt;= 0; i++) xv_fsa[ {{ xs(s, 0), xs(s, 1), xs(s, 2) }}] = s;
          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;c_s : xv_fsa) a_s(a, j) = c_s.second, j++;
        }

<span class="comment">// remplissage de som_aretes</span>
      <a class="code" href="classZone__PolyMAC.html#aedbee7d653ae0f28ab65674b28bf78f2">som_arete</a>.resize(<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone__dis__base.html#a8f793341b7a41d67561ba563ae0f69a0">nb_som_tot</a>());
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; a_s.<a class="code" href="classIntTab.html#a71e9b9ddc1793094b1b3f109377952b1" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0); i++) <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++) <a class="code" href="classZone__PolyMAC.html#aedbee7d653ae0f28ab65674b28bf78f2">som_arete</a>[a_s(i, j)][a_s(i, !j)] = i;

<span class="comment">// remplissage de xa (CGs des aretes), de ta_ (vecteur tangent aux aretes) et de longueur_arete_ (longueurs des aretes)</span>
      <a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, 3), <a class="code" href="classZone__PolyMAC.html#a280bc522cc5b57552bb9dcfbdd1493c5">ta_</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, 3);
      <a class="code" href="classZone__VF.html#ae77f9ddf0711c0bcf2162921698d0bea">creer_tableau_aretes</a>(<a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>), <a class="code" href="classZone__VF.html#ae77f9ddf0711c0bcf2162921698d0bea">creer_tableau_aretes</a>(<a class="code" href="classZone__PolyMAC.html#a280bc522cc5b57552bb9dcfbdd1493c5">ta_</a>), <a class="code" href="classZone__VF.html#ae77f9ddf0711c0bcf2162921698d0bea">creer_tableau_aretes</a>(<a class="code" href="classZone__PolyMAC.html#ac4cfae3ceac2c9e92565c5d3b4e1e542">longueur_aretes_</a>);
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, k; i &lt; <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a59ae0ababf85ce303a7c6f339430e335" title="renvoie le nombre d&#39;aretes total (reelles+virtuelles).">nb_aretes_tot</a>(); i++)
        {
          <span class="keywordtype">int</span> s1 = a_s(i, 0), s2 = a_s(i, 1);
          <a class="code" href="classZone__PolyMAC.html#ac4cfae3ceac2c9e92565c5d3b4e1e542">longueur_aretes_</a>(i) = sqrt( <a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;xs(s2, 0), &amp;xs(s2, 0), &amp;xs(s1, 0), &amp;xs(s1, 0)));
          <span class="keywordflow">for</span> (k = 0; k &lt; 3; k++) <a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(i, k) = (xs(s1, k) + xs(s2, k)) / 2, <a class="code" href="classZone__PolyMAC.html#a280bc522cc5b57552bb9dcfbdd1493c5">ta_</a>(i, k) = (xs(s2, k) - xs(s1, k)) / <a class="code" href="classZone__PolyMAC.html#ac4cfae3ceac2c9e92565c5d3b4e1e542">longueur_aretes_</a>(i);
        }

      <span class="comment">/* ordre canonique dans elem_aretes_ */</span>
      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0, i, j, a; e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++)
        {
          <span class="keywordflow">for</span> (i = 0, j = 0, xv_fsa.clear(); i &lt; e_a.dimension(1) &amp;&amp; (a = e_a(e, i)) &gt;= 0; i++) xv_fsa[ {{ <a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(a, 0), <a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(a, 1), <a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(a, 2) }}] = a;
          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;c_a : xv_fsa) e_a(e, j) = c_a.second, j++;
        }
    }

<span class="comment">// MD_vector pour Champ_P0_PolyMAC (elems + faces)</span>
  <a class="code" href="classMD__Vector__composite.html" title="Metadata for a distributed composite vector. This class describes a vector that contains one or more ...">MD_Vector_composite</a> mdc_ef;
  mdc_ef.<a class="code" href="classMD__Vector__composite.html#aef7b99d29af74b1eea8b7b414614e63f" title="Append the &quot;part&quot; descriptor to the composite vector. By default, shape=0 says that for each item in ...">add_part</a>(<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().md_vector_elements()), mdc_ef.<a class="code" href="classMD__Vector__composite.html#aef7b99d29af74b1eea8b7b414614e63f" title="Append the &quot;part&quot; descriptor to the composite vector. By default, shape=0 says that for each item in ...">add_part</a>(<a class="code" href="classZone__VF.html#abe1f45dce7441b402b8c54b5a407367b">md_vector_faces</a>());
  <a class="code" href="classZone__PolyMAC.html#a943e05074e1c95435e96551f26d43e80">mdv_elems_faces</a>.<a class="code" href="classMD__Vector.html#a063644dd8ca62e707a2d059eedeb58a7" title="construction d&#39;un objet MD_Vector par copie d&#39;un objet existant. C&#39;est la methode recommandee pour cr...">copy</a>(mdc_ef);

<span class="comment">// MD_vector pour Champ_Face_PolyMAC (faces + aretes)</span>
  <a class="code" href="classMD__Vector__composite.html" title="Metadata for a distributed composite vector. This class describes a vector that contains one or more ...">MD_Vector_composite</a> mdc_fa;
  mdc_fa.<a class="code" href="classMD__Vector__composite.html#aef7b99d29af74b1eea8b7b414614e63f" title="Append the &quot;part&quot; descriptor to the composite vector. By default, shape=0 says that for each item in ...">add_part</a>(<a class="code" href="classZone__VF.html#abe1f45dce7441b402b8c54b5a407367b">md_vector_faces</a>()), mdc_fa.<a class="code" href="classMD__Vector__composite.html#aef7b99d29af74b1eea8b7b414614e63f" title="Append the &quot;part&quot; descriptor to the composite vector. By default, shape=0 says that for each item in ...">add_part</a>(dimension &lt; 3 ? <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().domaine().md_vector_sommets() : <a class="code" href="classZone__VF.html#a93f73d93187a780a1b927be5b3d5c2a2">md_vector_aretes</a>());
  <a class="code" href="classZone__PolyMAC.html#aee0dd0b4d16e9cd79a46a529dfe3797e">mdv_faces_aretes</a>.<a class="code" href="classMD__Vector.html#a063644dd8ca62e707a2d059eedeb58a7" title="construction d&#39;un objet MD_Vector par copie d&#39;un objet existant. C&#39;est la methode recommandee pour cr...">copy</a>(mdc_fa);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5b591df01bd0eca800b3e961dcec5afa"></a><!-- doxytag: member="Zone_PolyMAC::dist_face_elem0" ref="a5b591df01bd0eca800b3e961dcec5afa" args="(int num_face, int n0) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Zone_PolyMAC::dist_face_elem0 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_face</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00407">407</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00341">dot()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>, <a class="el" href="Zone__VF_8h_source.html#l00054">Zone_VF::face_surfaces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, and <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(e, 0), &amp;<a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>(f, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0))) / <a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>(f);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a70e6c6a4b87f65c1641f4cff828fa7ae"></a><!-- doxytag: member="Zone_PolyMAC::dist_face_elem0_period" ref="a70e6c6a4b87f65c1641f4cff828fa7ae" args="(int num_face, int n0, double l) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Zone_PolyMAC::dist_face_elem0_period </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_face</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00417">417</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Process_8cpp_source.html#l00329">Process::abort()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">abort</a>();
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9654dac24f65d63da67da2b7c2c5bca2"></a><!-- doxytag: member="Zone_PolyMAC::dist_face_elem1" ref="a9654dac24f65d63da67da2b7c2c5bca2" args="(int num_face, int n1) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Zone_PolyMAC::dist_face_elem1 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_face</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00412">412</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00341">dot()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>, <a class="el" href="Zone__VF_8h_source.html#l00054">Zone_VF::face_surfaces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, and <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(e, 0), &amp;<a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>(f, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0))) / <a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>(f);
}
</pre></div>
</div>
</div>
<a class="anchor" id="af09737eeaf582103400dc1f45884cb31"></a><!-- doxytag: member="Zone_PolyMAC::dist_face_elem1_period" ref="af09737eeaf582103400dc1f45884cb31" args="(int num_face, int n1, double l) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Zone_PolyMAC::dist_face_elem1_period </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_face</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>l</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00423">423</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Process_8cpp_source.html#l00329">Process::abort()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classProcess.html#a6a4b64571b10f150a70db229b839e881" title="Routine de sortie de Trio-U sur une erreur abort()">abort</a>();
  <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab756547f1620fdad0ef46cffae4a5a90"></a><!-- doxytag: member="Zone_PolyMAC::dist_norm" ref="ab756547f1620fdad0ef46cffae4a5a90" args="(int num_face) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Zone_PolyMAC::dist_norm </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_face</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00402">402</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00341">dot()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>, <a class="el" href="Zone__VF_8h_source.html#l00054">Zone_VF::face_surfaces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00466">Zone_VF::face_voisins()</a>, and <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(<a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f, 0), 0), &amp;<a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>(f, 0), &amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(<a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f, 1), 0))) / <a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>(f);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0a6a2de1fef3dba598e9b870ee35b9da"></a><!-- doxytag: member="Zone_PolyMAC::dist_norm_bord" ref="a0a6a2de1fef3dba598e9b870ee35b9da" args="(int num_face) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Zone_PolyMAC::dist_norm_bord </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_face</em></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00396">396</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00341">dot()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>, <a class="el" href="Zone__VF_8h_source.html#l00054">Zone_VF::face_surfaces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00466">Zone_VF::face_voisins()</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, and <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00893">dist_norm_bord()</a>, and <a class="el" href="Op__Diff__PolyMAC__base_8cpp_source.html#l00324">Op_Diff_PolyMAC_base::update_nu()</a>.</p>
<div class="fragment"><pre class="fragment">{
  assert(<a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f, 1) == -1);
  <span class="keywordflow">return</span> <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(<a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(f, 0), 0), &amp;<a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>(f, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0))) / <a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>(f);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab3a872a19c923da59c7c11aca0dec416"></a><!-- doxytag: member="Zone_PolyMAC::dist_norm_bord" ref="ab3a872a19c923da59c7c11aca0dec416" args="(DoubleVect &amp;, const Nom &amp;nom_bord) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp; Zone_PolyMAC::dist_norm_bord </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleVect.html">DoubleVect</a> &amp;&#160;</td>
          <td class="paramname"><em>dist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classNom.html">Nom</a> &amp;&#160;</td>
          <td class="paramname"><em>nom_bord</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00893">893</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00396">dist_norm_bord()</a>, <a class="el" href="Zone__VF_8h_source.html#l00644">Zone_VF::front_VF()</a>, <a class="el" href="Frontiere__dis__base_8cpp_source.html#l00146">Frontiere_dis_base::le_nom()</a>, <a class="el" href="Zone__VF_8h_source.html#l00250">Zone_VF::les_bords_</a>, <a class="el" href="Front__VF_8h_source.html#l00061">Front_VF::nb_faces()</a>, <a class="el" href="Front__VF_8h_source.html#l00071">Front_VF::num_premiere_face()</a>, <a class="el" href="DoubleVect_8h_source.html#l00193">DoubleVect::resize()</a>, and <a class="el" href="vect__impl_8h_source.html#l00057">vect_impl::size()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord=0; n_bord&lt;<a class="code" href="classZone__VF.html#ab582b1b65b2a3740318b6725cddac726">les_bords_</a>.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); n_bord++)
    {
      <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; fr_vf = <a class="code" href="classZone__VF.html#a45e54622328fcf035535edf96172c1e4" title="renvoie la ieme frontiere_discrete.">front_VF</a>(n_bord);
      <span class="keywordflow">if</span> (fr_vf.<a class="code" href="classFrontiere__dis__base.html#a5a7eb46dc3af8a7d4225adc1814845d8" title="Renvoie le nom de la frontiere geometrique.">le_nom</a>() == nom_bord)
        {
          dist.<a class="code" href="classDoubleVect.html#ac55a86eea7b2f06b084b88b16042b67b" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(fr_vf.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>());
          <span class="keywordtype">int</span> ndeb = fr_vf.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> face=ndeb; face&lt;ndeb+fr_vf.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>(); face++)
            dist(face-ndeb) = <a class="code" href="classZone__PolyMAC.html#a0a6a2de1fef3dba598e9b870ee35b9da">dist_norm_bord</a>(face);
        }
    }
  <span class="keywordflow">return</span> dist;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9a9034a4c1164e859f9bb5b20c6218cc"></a><!-- doxytag: member="Zone_PolyMAC::dot" ref="a9a9034a4c1164e859f9bb5b20c6218cc" args="(const double *a, const double *b, const double *ma=NULL, const double *mb=NULL) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Zone_PolyMAC::dot </td>
          <td>(</td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>ma</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>mb</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00341">341</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>.</p>

<p>Referenced by <a class="el" href="Terme__Boussinesq__PolyMAC__Face_8cpp_source.html#l00059">Terme_Boussinesq_PolyMAC_Face::ajouter()</a>, <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00064">Perte_Charge_PolyMAC::ajouter()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00127">Op_Conv_EF_Stab_PolyMAC_Face::ajouter()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00700">calculer_volumes_entrelaces()</a>, <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00106">Perte_Charge_PolyMAC::contribuer_a_avec()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00173">Op_Conv_EF_Stab_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00648">detecter_faces_non_planes()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00090">Op_Conv_EF_Stab_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00407">dist_face_elem0()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00412">dist_face_elem1()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00402">dist_norm()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00396">dist_norm_bord()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00186">Champ_Face_PolyMAC::init_ra()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01156">init_rf()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00236">Champ_Face_PolyMAC::init_va()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01221">init_we_3d()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00437">Champ_Face_PolyMAC::interp_gve()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00573">orthocentrer()</a>, and <a class="el" href="Op__Diff__PolyMAC__base_8h_source.html#l00105">Op_Diff_PolyMAC_base::remplir_nu_ef()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> res = 0;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; i++) res += (a[i] - (ma ? ma[i] : 0)) * (b[i] - (mb ? mb[i] : 0));
  <span class="keywordflow">return</span> res;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a445215cf384633d5fafbd25d217fd114"></a><!-- doxytag: member="Zone_PolyMAC::duplique" ref="a445215cf384633d5fafbd25d217fd114" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Zone_PolyMAC::duplique </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classZone__VF.html#a6136b04634a565b6dbdce7998ed4f3c7">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00081">81</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a5cf8bdb73573a302f9dab2d2f0ffdf80"></a><!-- doxytag: member="Zone_PolyMAC::ecrit" ref="a5cf8bdb73573a302f9dab2d2f0ffdf80" args="(Sortie &amp;os) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSortie.html">Sortie</a> &amp; Zone_PolyMAC::ecrit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00087">87</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="IntVect_8cpp_source.html#l00282">IntVect::ecrit()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00534">DoubleTab::ecrit()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00283">DoubleVect::ecrit()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00207">h_carre</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00213">nb_elem_std_</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00212">nb_faces_std_</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00110">printOn()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00214">rang_elem_non_std_</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00209">type_elem_</a>, and <a class="el" href="Zone__VF_8h_source.html#l00219">Zone_VF::volumes_entrelaces_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classZone__PolyMAC.html#a68df324de334832c5dfc312e10e3132e" title="Surcharge Objet_U::printOn(Sortie&amp;) NE FAIT RIEN A surcharger dans les classes derivees. Imprime la zone discretisee sur un flot de sortie.">Zone_VF::printOn</a>(os);
  os &lt;&lt; <span class="stringliteral">&quot;____ h_carre &quot;</span>&lt;&lt;<a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  os &lt;&lt; <a class="code" href="classZone__PolyMAC.html#a3122c86faa41d079ec3ed009a3c2136e" title="carre du pas du maillage">h_carre</a> &lt;&lt; finl;
  os &lt;&lt; <span class="stringliteral">&quot;____ type_elem_ &quot;</span>&lt;&lt;finl;
  os &lt;&lt; <a class="code" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998" title="type de l&#39;element de discretisation">type_elem_</a> &lt;&lt; finl;
  os &lt;&lt; <span class="stringliteral">&quot;____ nb_elem_std_ &quot;</span>&lt;&lt;finl;
  os &lt;&lt; <a class="code" href="classZone__PolyMAC.html#a1d10485a5ee3b7b952e39ef12cb35416" title="nombre d&#39;elements standard">nb_elem_std_</a> &lt;&lt; finl;
  os &lt;&lt; <span class="stringliteral">&quot;____ volumes_entrelaces_ &quot;</span>&lt;&lt;finl;
  <a class="code" href="classZone__VF.html#a4d84eafd75968d81d72275f240390ee8" title="volumes entrelaces pour l&#39;integration des Qdm">volumes_entrelaces_</a>.<a class="code" href="classDoubleVect.html#ad55e6b8d8409ed1382d7cb83e0d311a8" title="ecriture des valeurs du tableau &quot;raw&quot; sans structure parallele">ecrit</a>(os);
  os &lt;&lt; <span class="stringliteral">&quot;____ face_normales_ &quot;</span>&lt;&lt;finl;
  <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>.<a class="code" href="classDoubleTab.html#ab7588e94792cc0be3a3288573c44ca18" title="ecriture des valeurs du tableau &quot;raw&quot; sans structure parallele">ecrit</a>(os);
  os &lt;&lt; <span class="stringliteral">&quot;____ nb_faces_std_ &quot;</span>&lt;&lt;finl;
  os &lt;&lt; <a class="code" href="classZone__PolyMAC.html#a2b20af52d5cf15a8cfc12069ee7298b8" title="nombre de faces standard">nb_faces_std_</a> &lt;&lt; finl;
  os &lt;&lt; <span class="stringliteral">&quot;____ rang_elem_non_std_ &quot;</span>&lt;&lt;finl;
  <a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a>.<a class="code" href="classIntVect.html#ae08d96549fed9a6fbac1bb89ab355301" title="ecriture des valeurs du tableau &quot;raw&quot; sans structure parallele">ecrit</a>(os);
  <span class="keywordflow">return</span> os;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac461c322bf3ecf7a0b1a8099c98ca8a7"></a><!-- doxytag: member="Zone_PolyMAC::face_normales" ref="ac461c322bf3ecf7a0b1a8099c98ca8a7" args="(int, int) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Zone_PolyMAC::face_normales </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>face</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>comp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classZone__VF.html#a547ab50904dc51bee39fed54a20934b2">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00238">238</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>.</p>

<p>Referenced by <a class="el" href="Champ__Fonc__Face__PolyMAC_8cpp_source.html#l00084">Champ_Fonc_Face_PolyMAC::affecter_()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00100">Champ_Face_PolyMAC::affecter_()</a>, <a class="el" href="Perte__Charge__Singuliere__PolyMAC__Face_8cpp_source.html#l00086">Perte_Charge_Singuliere_PolyMAC_Face::ajouter()</a>, <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00145">Masse_PolyMAC_Face::ajouter_masse()</a>, <a class="el" href="Perte__Charge__Singuliere__PolyMAC__Face_8cpp_source.html#l00108">Perte_Charge_Singuliere_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Op__Grad__PolyMAC__Face_8cpp_source.html#l00212">Op_Grad_PolyMAC_Face::impr()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00186">Champ_Face_PolyMAC::init_ra()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00236">Champ_Face_PolyMAC::init_va()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00437">Champ_Face_PolyMAC::interp_gve()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00388">Champ_Face_PolyMAC::interp_ve()</a>, <a class="el" href="Assembleur__P__PolyMAC_8cpp_source.html#l00240">Assembleur_P_PolyMAC::modifier_secmem()</a>, <a class="el" href="Champ__Fonc__Face__PolyMAC_8cpp_source.html#l00148">Champ_Fonc_Face_PolyMAC::valeur_aux_elems()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00547">Champ_Face_PolyMAC::valeur_aux_faces()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>(face,comp);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac0072097ee9c21dea931fc1a70d8523b"></a><!-- doxytag: member="Zone_PolyMAC::face_normales" ref="ac0072097ee9c21dea931fc1a70d8523b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Zone_PolyMAC::face_normales </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00245">245</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01059">init_m2()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01156">init_rf()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="acebc3a496b9f9f1ec7bc5d0d1b07ec5b"></a><!-- doxytag: member="Zone_PolyMAC::face_normales" ref="acebc3a496b9f9f1ec7bc5d0d1b07ec5b" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Zone_PolyMAC::face_normales </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00252">252</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8c3307ce001ca2537b05d38bae9d5ff4"></a><!-- doxytag: member="Zone_PolyMAC::get_info" ref="a8c3307ce001ca2537b05d38bae9d5ff4" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a> * Zone_PolyMAC::get_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Donne des informations sur le type de l'Objet_U. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>const Type_info*<br/>
 Signification: structure regroupant les informations sur le type de l'Objet_U<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classZone__VF.html#a63bdab95d4b55dcf4cbfb5595f290669">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00081">81</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ae6677bb0faf4357455f4a78c26a31a47"></a><!-- doxytag: member="Zone_PolyMAC::ind_faces_virt_non_std" ref="ae6677bb0faf4357455f4a78c26a31a47" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classArrOfInt.html">ArrOfInt</a> &amp; Zone_PolyMAC::ind_faces_virt_non_std </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00335">335</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00218">ind_faces_virt_non_std_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#aa1115569d0d619b49344d24d29760227" title="contient les indices des faces virtuelles non standard">ind_faces_virt_non_std_</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a08d0961aa83d143dc5dd4d23297dcce2"></a><!-- doxytag: member="Zone_PolyMAC::info" ref="a08d0961aa83d143dc5dd4d23297dcce2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a> * Zone_PolyMAC::info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Donne des informations sur le type de l'Objet_U. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>const Type_info*<br/>
 Signification: structure regroupant les informations sur le type de l'Objet_U<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classZone__VF.html#a23019fd74a4153f22120e4ec7757d22f">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00081">81</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a460c2044828915de85cf7168599a6d16"></a><!-- doxytag: member="Zone_PolyMAC::init_m1" ref="a460c2044828915de85cf7168599a6d16" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::init_m1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01322">1322</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01249">init_m1_2d()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01180">init_we()</a>, and <a class="el" href="Zone__PolyMAC_8h_source.html#l00162">is_init</a>.</p>

<p>Referenced by <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00145">Masse_PolyMAC_Face::ajouter_masse()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00055">Op_Diff_PolyMAC_Face::completer()</a>, <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00120">Masse_PolyMAC_Face::dimensionner()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00236">Champ_Face_PolyMAC::init_va()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (<a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;m1&quot;</span>]) <span class="keywordflow">return</span>;
  <a class="code" href="classZone__PolyMAC.html#ad5ca5e80325c5f46a98e657ab32a4311">init_we</a>();
  <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> &lt; 3 ? <a class="code" href="classZone__PolyMAC.html#a22adf992084598225ebd66a6e30bdb57">init_m1_2d</a>() : <a class="code" href="classZone__PolyMAC.html#aa2af2128ede28e1f8589241262ac7a08">init_m1_3d</a>();
  <a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;m1&quot;</span>] = 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a22adf992084598225ebd66a6e30bdb57"></a><!-- doxytag: member="Zone_PolyMAC::init_m1_2d" ref="a22adf992084598225ebd66a6e30bdb57" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::init_m1_2d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01249">1249</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="DoubleTab_8h_source.html#l00271">DoubleTab::append_line()</a>, <a class="el" href="IntTab_8h_source.html#l00261">IntTab::append_line()</a>, <a class="el" href="Domaine_8h_source.html#l00500">Domaine::coord_sommets()</a>, <a class="el" href="Zone__CoviMAC_8h_source.html#l00427">CRIMP</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00349">cross()</a>, <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__VF_8h_source.html#l00581">Zone_VF::elem_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00239">Zone_VF::face_sommets_</a>, <a class="el" href="stat__counters_8cpp_source.html#l00079">m1</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00197">m1ci</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00196">m1deb</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00196">m1ji</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Zone_8cpp_source.html#l00608">Zone::nb_som_tot()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00152">Zone_dis_base::nb_som_tot()</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="ArrOfDouble_8cpp_source.html#l00442">ArrOfDouble::set_smart_resize()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00443">ArrOfInt::set_smart_resize()</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01322">init_m1()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; e_f = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(), &amp;f_s = <a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>;
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xs = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
  <span class="keywordtype">int</span> i, j, e, f, s;

  std::vector&lt;std::map&lt;std::array&lt;int, 2&gt;, <span class="keywordtype">double</span>&gt;&gt; <a class="code" href="stat__counters_8cpp.html#a0b22d8bb1162b491f7d0505b588a9d06">m1</a>(<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone__dis__base.html#a8f793341b7a41d67561ba563ae0f69a0">nb_som_tot</a>()); <span class="comment">//m1[a][{ ab, e }] : contribution de (arete ab, element e)</span>
  <span class="keywordflow">for</span> (e = 0; e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++)
    {
<span class="comment">// une contribution par &quot;facette&quot; (triangle entre le sommet, le CG de la face et celui de l&#39;element)</span>
      <span class="keywordflow">for</span> (i = 0; i &lt; e_f.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (f = e_f(e, i)) &gt;= 0; i++)
        <span class="keywordflow">for</span> (j = 0; j &lt; f_s.dimension(1) &amp;&amp; (s = f_s(f, j)) &gt;= 0; j++) <span class="comment">//contrib. de chaque sommet de chaque face</span>
          <a class="code" href="stat__counters_8cpp.html#a0b22d8bb1162b491f7d0505b588a9d06">m1</a>[s][ {{ s, e }}] += <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classZone__PolyMAC.html#a440d581bbedd755e0fd86e8e2ff7f444">cross</a>(2, 2, &amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(e, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0), &amp;xs(s, 0), &amp;xs(s, 0))[2]) / 2;
    }

<span class="comment">// remplissage</span>
  <a class="code" href="classZone__PolyMAC.html#a44d477541e608609ff8f0ca5b9f80884">m1deb</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(1), <a class="code" href="classZone__PolyMAC.html#a44d477541e608609ff8f0ca5b9f80884">m1deb</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#abbb87713bcfa7d40bc0092946c3058d4">m1ji</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, 2), <a class="code" href="classZone__PolyMAC.html#abbb87713bcfa7d40bc0092946c3058d4">m1ji</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#adf9e0183c83be84d04cd2d682619100b">m1ci</a>.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);
  <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a01ed67af826d6045ef4eacfb87a663e8" title="Renvoie le nombre total de sommets de la zone. i.e. le nombre de sommets reels et virtuels sur le pro...">nb_som_tot</a>(); <a class="code" href="classZone__PolyMAC.html#a44d477541e608609ff8f0ca5b9f80884">m1deb</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(<a class="code" href="classZone__PolyMAC.html#abbb87713bcfa7d40bc0092946c3058d4">m1ji</a>.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)), i++) <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;kv : <a class="code" href="stat__counters_8cpp.html#a0b22d8bb1162b491f7d0505b588a9d06">m1</a>[i])
      <a class="code" href="classZone__PolyMAC.html#abbb87713bcfa7d40bc0092946c3058d4">m1ji</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(kv.first[0], kv.first[1]), <a class="code" href="classZone__PolyMAC.html#adf9e0183c83be84d04cd2d682619100b">m1ci</a>.<a class="code" href="classDoubleTab.html#a0bf29d92d15188db10e37a4f7d627784" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(kv.second);
  <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a44d477541e608609ff8f0ca5b9f80884">m1deb</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#abbb87713bcfa7d40bc0092946c3058d4">m1ji</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#adf9e0183c83be84d04cd2d682619100b">m1ci</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa2af2128ede28e1f8589241262ac7a08"></a><!-- doxytag: member="Zone_PolyMAC::init_m1_3d" ref="aa2af2128ede28e1f8589241262ac7a08" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::init_m1_3d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">1272</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00910">ajouter_stabilisation()</a>, <a class="el" href="DoubleTab_8h_source.html#l00271">DoubleTab::append_line()</a>, <a class="el" href="IntTab_8h_source.html#l00261">IntTab::append_line()</a>, <a class="el" href="Process_8cpp_source.html#l00127">Process::barrier()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Zone_8cpp_source.html#l01600">Zone::creer_tableau_elements()</a>, <a class="el" href="Zone__CoviMAC_8h_source.html#l00427">CRIMP</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00349">cross()</a>, <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00341">dot()</a>, <a class="el" href="Zone_8h_source.html#l01282">Zone::elem_aretes()</a>, <a class="el" href="Zone__VF_8h_source.html#l00238">Zone_VF::elem_faces_</a>, <a class="el" href="Zone__VF_8h_source.html#l00239">Zone_VF::face_sommets_</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Domaine_8h_source.html#l00204">Domaine::le_nom()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00211">longueur_aretes_</a>, <a class="el" href="stat__counters_8cpp_source.html#l00079">m1</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00197">m1ci</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00196">m1deb</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00196">m1ji</a>, <a class="el" href="Zone_8h_source.html#l01266">Zone::nb_aretes_tot()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00140">Zone_dis_base::nb_elem()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00443">ArrOfInt::set_smart_resize()</a>, <a class="el" href="ArrOfDouble_8cpp_source.html#l00442">ArrOfDouble::set_smart_resize()</a>, <a class="el" href="Op__Conv__Muscl__old__VEF__Face_8cpp_source.html#l00053">sgn</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00159">som_arete</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00224">ta_</a>, <a class="el" href="Zone__VF_8h_source.html#l00430">Zone_VF::volumes()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00190">weci</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00189">wedeb</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00189">weji</a>, <a class="el" href="Zone__VF_8h_source.html#l00240">Zone_VF::xa_</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01322">init_m1()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; f_s = <a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>, &amp;e_a = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a1e1e86ef5b088c4d33d42cd38a967b4a" title="renvoie le numero de la jeme arete du ieme element.">elem_aretes</a>(), &amp;e_f = <a class="code" href="classZone__VF.html#acd9376481d4268df6a0c394c5a1a0e61" title="connectivite element/faces">elem_faces_</a>;
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; la = <a class="code" href="classZone__PolyMAC.html#ac4cfae3ceac2c9e92565c5d3b4e1e542">longueur_aretes_</a>, &amp;ve = <a class="code" href="classZone__VF.html#a9598b08cb9126f88cfafe72fc0eeca70" title="renvoie le tableaux des volumes des mailles.">volumes</a>();
  <span class="keywordtype">int</span> a, ab, i, j, k, e, f, s, s2, n_a;

  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; : initialisation de m1... &quot;</span>;
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> M, N;
  M.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), N.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);

  <span class="comment">/* tableau parallele */</span>
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> m1e(0, e_a.dimension(1), e_a.dimension(1));
  <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(m1e);
  std::map&lt;int, int&gt; idxa;
  <span class="keywordflow">for</span> (e = 0; e &lt; <a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); e++)
    {
      <span class="comment">/* matrice non stabilisee : contribution par facette (couple face/arete) */</span>
      <span class="keywordflow">for</span> (i = 0, idxa.clear(), n_a = 0; i &lt; e_a.dimension(1) &amp;&amp; (a = e_a(e, i)) &gt;= 0; i++) idxa[a] = i, n_a++;
      M.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n_a, n_a), N.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>, n_a);
      <span class="keywordflow">for</span> (i = 0, M = 0; i &lt; e_f.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (f = e_f(e, i)) &gt;= 0; i++) <span class="keywordflow">for</span> (j = 0; j &lt; f_s.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (s = f_s(f, j)) &gt;= 0; j++)
          {
            s2 = f_s(f, j + 1 &lt; f_s.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; f_s(f, j + 1) &gt;= 0 ? j + 1 : 0), a = <a class="code" href="classZone__PolyMAC.html#aedbee7d653ae0f28ab65674b28bf78f2">som_arete</a>[s].at(s2);
            std::array&lt;double, 3&gt; vec = <a class="code" href="classZone__PolyMAC.html#a440d581bbedd755e0fd86e8e2ff7f444">cross</a>(3, 3, &amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(e, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0), &amp;<a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(a, 0), &amp;<a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(a, 0));
<span class="comment">// on tourne la facette dans la bonne direction</span>
            <span class="keywordtype">int</span> <a class="code" href="Op__Conv__Muscl__old__VEF__Face_8cpp.html#ae1b5a554c1d4d97654c06032a92f800a">sgn</a> = <a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;<a class="code" href="classZone__PolyMAC.html#a280bc522cc5b57552bb9dcfbdd1493c5">ta_</a>(a, 0), &amp;vec[0]) &gt; 0 ? 1 : -1;
            <span class="keywordflow">for</span> (k = <a class="code" href="classZone__PolyMAC.html#af61335f5cde4fc2cdd1d5fcd734e0516">wedeb</a>(e); k &lt; <a class="code" href="classZone__PolyMAC.html#af61335f5cde4fc2cdd1d5fcd734e0516">wedeb</a>(e + 1); k++) M(idxa[a], idxa[<a class="code" href="classZone__PolyMAC.html#a0e0a04421ef4f416ac46e96943c9e887">weji</a>(k)]) += sgn * la(a) * <a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;vec[0], &amp;<a class="code" href="classZone__PolyMAC.html#a034313bc3890500f6179ad7fbfe50e5e">weci</a>(k, 0)) / 2 / ve(e);
          }
      <span class="keywordflow">for</span> (i = 0; i &lt; e_a.dimension(1) &amp;&amp; (a = e_a(e, i)) &gt;= 0; i++) <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; j++) N(j, i) = <a class="code" href="classZone__PolyMAC.html#a280bc522cc5b57552bb9dcfbdd1493c5">ta_</a>(a, j);

      <span class="comment">/* stabilisation et stockage */</span>
      <a class="code" href="classZone__PolyMAC.html#ae6c3e86897bee01dc3f6b1aa36dd70c3">ajouter_stabilisation</a>(M, N);
      <span class="keywordflow">for</span> (i = 0; i &lt; n_a; i++) <span class="keywordflow">for</span> (j = 0; j &lt; n_a; j++) m1e(e, i, j) = M(i, j);
    }

  <span class="comment">/* echange et remplissage d&#39;un map global */</span>
  m1e.echange_espace_virtuel();
  std::vector&lt;std::map&lt;std::array&lt;int, 2&gt;, <span class="keywordtype">double</span>&gt;&gt; <a class="code" href="stat__counters_8cpp.html#a0b22d8bb1162b491f7d0505b588a9d06">m1</a>(<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().nb_aretes_tot()); <span class="comment">//m1[a][{ ab, e }] : contribution de (arete ab, element e)</span>
  <span class="keywordflow">for</span> (e = 0; e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++)
    <span class="keywordflow">for</span> (i = 0; i &lt; e_a.dimension(1) &amp;&amp; (a = e_a(e, i)) &gt;= 0; i++) <span class="keywordflow">for</span> (j = 0; j &lt; e_a.dimension(1) &amp;&amp; (ab = e_a(e, j)) &gt;= 0; j++)
        <span class="keywordflow">if</span> (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(m1e(e, i, j)) &gt; 1e-8) <a class="code" href="stat__counters_8cpp.html#a0b22d8bb1162b491f7d0505b588a9d06">m1</a>[a][ {{ ab, e }}] += ve(e) * m1e(e, i, j);

  <span class="comment">/* remplissage final */</span>
  <a class="code" href="classZone__PolyMAC.html#a44d477541e608609ff8f0ca5b9f80884">m1deb</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(1), <a class="code" href="classZone__PolyMAC.html#a44d477541e608609ff8f0ca5b9f80884">m1deb</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#abbb87713bcfa7d40bc0092946c3058d4">m1ji</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, 2), <a class="code" href="classZone__PolyMAC.html#abbb87713bcfa7d40bc0092946c3058d4">m1ji</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#adf9e0183c83be84d04cd2d682619100b">m1ci</a>.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);
  <span class="keywordflow">for</span> (a = 0; a &lt; <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a59ae0ababf85ce303a7c6f339430e335" title="renvoie le nombre d&#39;aretes total (reelles+virtuelles).">nb_aretes_tot</a>(); <a class="code" href="classZone__PolyMAC.html#a44d477541e608609ff8f0ca5b9f80884">m1deb</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(<a class="code" href="classZone__PolyMAC.html#abbb87713bcfa7d40bc0092946c3058d4">m1ji</a>.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)), a++) <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;kv : <a class="code" href="stat__counters_8cpp.html#a0b22d8bb1162b491f7d0505b588a9d06">m1</a>[a])
      <a class="code" href="classZone__PolyMAC.html#abbb87713bcfa7d40bc0092946c3058d4">m1ji</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(kv.first[0], kv.first[1]), <a class="code" href="classZone__PolyMAC.html#adf9e0183c83be84d04cd2d682619100b">m1ci</a>.<a class="code" href="classDoubleTab.html#a0bf29d92d15188db10e37a4f7d627784" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(kv.second);
  <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a44d477541e608609ff8f0ca5b9f80884">m1deb</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#abbb87713bcfa7d40bc0092946c3058d4">m1ji</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#adf9e0183c83be84d04cd2d682619100b">m1ci</a>);
  <a class="code" href="classProcess.html#aa9e74a5c06a68ea38298a08ea401e7b1" title="Synchronise tous les processeurs du groupe courant&lt;br&gt;(attend que tous les processeurs soient arrives...">Process::barrier</a>();
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;OK&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ace03dac8b89bce9f38aa39cd951c59df"></a><!-- doxytag: member="Zone_PolyMAC::init_m2" ref="ace03dac8b89bce9f38aa39cd951c59df" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::init_m2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01059">1059</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="ArrOfDouble_8h_source.html#l00379">ArrOfDouble::addr()</a>, <a class="el" href="DoubleTab_8h_source.html#l00271">DoubleTab::append_line()</a>, <a class="el" href="IntTab_8h_source.html#l00261">IntTab::append_line()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Zone_8cpp_source.html#l01600">Zone::creer_tableau_elements()</a>, <a class="el" href="Zone__CoviMAC_8h_source.html#l00427">CRIMP</a>, <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__VF_8h_source.html#l00581">Zone_VF::elem_faces()</a>, <a class="el" href="arch_8h_source.html#l00075">F77NAME</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00245">face_normales()</a>, <a class="el" href="Zone__VF_8h_source.html#l00616">Zone_VF::face_sommets()</a>, <a class="el" href="Zone__VF_8h_source.html#l00054">Zone_VF::face_surfaces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00466">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00162">is_init</a>, <a class="el" href="Domaine_8h_source.html#l00204">Domaine::le_nom()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00180">m2c</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">m2d</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">m2i</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">m2j</a>, <a class="el" href="Process_8cpp_source.html#l00156">Process::mp_max()</a>, <a class="el" href="Process_8cpp_source.html#l00167">Process::mp_min()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00597">mp_somme_vect()</a>, <a class="el" href="Process_8cpp_source.html#l00178">Process::mp_sum()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00140">Zone_dis_base::nb_elem()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>, <a class="el" href="ArrOfDouble_8cpp_source.html#l00442">ArrOfDouble::set_smart_resize()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00443">ArrOfInt::set_smart_resize()</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="Zone__VF_8h_source.html#l00430">Zone_VF::volumes()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00180">w2c</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">w2i</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">w2j</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00957">W_stabiliser()</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>

<p>Referenced by <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00145">Masse_PolyMAC_Face::ajouter_masse()</a>, <a class="el" href="Masse__PolyMAC__Elem_8cpp_source.html#l00166">Masse_PolyMAC_Elem::ajouter_masse()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00055">Op_Diff_PolyMAC_Face::completer()</a>, <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00120">Masse_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Masse__PolyMAC__Elem_8cpp_source.html#l00120">Masse_PolyMAC_Elem::dimensionner()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00071">Op_Diff_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00179">Op_Diff_PolyMAC_Elem::dimensionner()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01331">init_m2solv()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00186">Champ_Face_PolyMAC::init_ra()</a>, and <a class="el" href="Echange__contact__PolyMAC_8cpp_source.html#l00152">Echange_contact_PolyMAC::update_coeffs()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; f_e = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(), &amp;e_f = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(), &amp;f_s = <a class="code" href="classZone__VF.html#a6cac6a6e8fc1e7b0381b7b15eb451257" title="renvoie le tableau de connectivite faces/sommets.">face_sommets</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; fs = <a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>(), &amp;ve = <a class="code" href="classZone__VF.html#a9598b08cb9126f88cfafe72fc0eeca70" title="renvoie le tableaux des volumes des mailles.">volumes</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; nf = <a class="code" href="classZone__PolyMAC.html#ac0072097ee9c21dea931fc1a70d8523b">face_normales</a>();
  <span class="keywordtype">int</span> i, j, e, f, s, n_f, ctr[3] = {0, 0, 0 }, n_tot = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>()), infoo = 0;
  <span class="keywordtype">double</span> spectre[4] = { DBL_MAX, DBL_MAX, 0, 0 }; <span class="comment">//vp min (partie consistante, partie stab), vp max (partie consistante, partie stab)</span>
  <span class="keywordtype">char</span> uplo = <span class="charliteral">&#39;U&#39;</span>;

  <span class="keywordflow">if</span> (<a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;w2&quot;</span>]) <span class="keywordflow">return</span>;
  <a class="code" href="classZone__PolyMAC.html#a672f82b0a35bb4eb3dbc2b0af8e00cbc">m2d</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#abae0465aee7760855c9b4eae58957bd9">m2i</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#a6ffe4bbe605a937ab537b14eae6d7ed1">m2j</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#a1ef09e85a9897db3633c6fb921fe63e9">m2c</a>.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);
  <a class="code" href="classZone__PolyMAC.html#ad76e9d4739f1092d19cf1985c632524d">w2i</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#aa0cebde1e4683a6c55b944f821d5c097">w2j</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#a0806de38360333cf9ea39a791f20906e" title="avec le coeff diagonal en premier (facilite Echange_contact_PolyMAC)">w2c</a>.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; : initializing w2/m2 ... &quot;</span>;

  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> W, M, R, N;
  W.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), M.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), R.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), N.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);

  <span class="comment">/* pour le partage entre procs */</span>
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> m2e(0, e_f.dimension(1), e_f.dimension(1)), w2e(0, e_f.dimension(1), e_f.dimension(1));
  <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(m2e), <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(w2e);


  <span class="comment">/* calcul sur les elements reels */</span>
  std::map&lt;int, std::vector&lt;int&gt;&gt; som_face; <span class="comment">//som_face[s] : faces de l&#39;element e touchant le sommet s</span>
  <a class="code" href="classIntTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un IntTab avec allocation dans un pool de memoire gere...">IntTrav</a> nnz, nef;<span class="comment">//par elements : nombre de coeffs non nuls, nombre de faces (lignes)</span>
  <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(nnz), <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(nef);
  <span class="keywordflow">for</span> (e = 0; e &lt; <a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); e++)
    {
      <span class="keywordflow">for</span> (n_f = 0; n_f &lt; e_f.dimension(1) &amp;&amp; e_f(e, n_f) &gt;= 0; ) n_f++;
      W.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n_f, n_f), R.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n_f, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>), N.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(n_f, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);

      <span class="comment">/* matrices R (lignes elements -&gt; faces) et N (normales sortantes aux faces) */</span>
      <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++) <span class="keywordflow">for</span> (j = 0, f = e_f(e, i); j &lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; j++)
          N(i, j) = nf(f, j) / fs(f) * (e == f_e(f, 0) ? 1 : -1), R(i, j) = (<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, j) - <a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(e, j)) * fs(f) / ve(e);

      <span class="comment">/* faces connectees a chaque sommet, puis stencil admissible */</span>
      <span class="keywordflow">for</span> (i = 0, W = 0, som_face.clear(); i &lt; n_f; i++)
        <span class="keywordflow">for</span> (j = 0, f = e_f(e, i); j &lt; f_s.dimension(1) &amp;&amp; (s = f_s(f, j)) &gt;= 0; j++) som_face[s].push_back(i);
      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;s_fs : som_face) <span class="keywordflow">for</span> (<span class="keyword">auto</span> i1 : s_fs.second) <span class="keywordflow">for</span> (<span class="keyword">auto</span> i2 : s_fs.second) W(i1, i2) = 1;

      <span class="comment">/* matrice W2 stabilisee */</span>
      W = 1, <a class="code" href="classZone__PolyMAC.html#afadc655691d6d38cd9ac09a490221f47">W_stabiliser</a>(W, R, N, ctr, spectre); <span class="comment">/* il faut une matrice complete */</span>

      <span class="comment">/* matrice M2 : W2^-1 */</span>
      M = W;
      <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(dpotrf)(&amp;uplo, &amp;n_f, M.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;n_f, &amp;infoo);
      <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(dpotri)(&amp;uplo, &amp;n_f, M.<a class="code" href="classArrOfDouble.html#a95357a1390c11dbd481d385257f2e983" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), &amp;n_f, &amp;infoo);
      assert(infoo == 0);
      <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++) <span class="keywordflow">for</span> (j = i + 1; j &lt; n_f; j++) M(i, j) = M(j, i);

      <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++) for (j = 0, nef(e)++; j &lt; n_f; j++) w2e(e, i, j) = W(i, j), nnz(e) += (dabs(W(i, j)) &gt; 1e-6);
      <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++) <span class="keywordflow">for</span> (j = 0; j &lt; n_f; j++) m2e(e, i, j) = M(i, j);
    }

  <span class="comment">/* echange et remplissage */</span>
  m2e.echange_espace_virtuel(), w2e.echange_espace_virtuel();
  <span class="keywordflow">for</span> (e = 0, <a class="code" href="classZone__PolyMAC.html#a672f82b0a35bb4eb3dbc2b0af8e00cbc">m2d</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(0), <a class="code" href="classZone__PolyMAC.html#abae0465aee7760855c9b4eae58957bd9">m2i</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(0), <a class="code" href="classZone__PolyMAC.html#ad76e9d4739f1092d19cf1985c632524d">w2i</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(0); e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++, <a class="code" href="classZone__PolyMAC.html#a672f82b0a35bb4eb3dbc2b0af8e00cbc">m2d</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(<a class="code" href="classZone__PolyMAC.html#abae0465aee7760855c9b4eae58957bd9">m2i</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>() - 1))
    {
      <span class="keywordflow">for</span> (n_f = 0; n_f &lt; e_f.dimension(1) &amp;&amp; e_f(e, n_f) &gt;= 0; ) n_f++;
      <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++, <a class="code" href="classZone__PolyMAC.html#abae0465aee7760855c9b4eae58957bd9">m2i</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(<a class="code" href="classZone__PolyMAC.html#a6ffe4bbe605a937ab537b14eae6d7ed1">m2j</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>())) <span class="keywordflow">for</span> (j = 0, <a class="code" href="classZone__PolyMAC.html#a6ffe4bbe605a937ab537b14eae6d7ed1">m2j</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(i), <a class="code" href="classZone__PolyMAC.html#a1ef09e85a9897db3633c6fb921fe63e9">m2c</a>.<a class="code" href="classDoubleTab.html#a0bf29d92d15188db10e37a4f7d627784" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(m2e(e, i, i)); j &lt; n_f; j++)
          <span class="keywordflow">if</span> (j != i &amp;&amp; <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(m2e(e, i, j)) &gt; 1e-6) <a class="code" href="classZone__PolyMAC.html#a6ffe4bbe605a937ab537b14eae6d7ed1">m2j</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(j), <a class="code" href="classZone__PolyMAC.html#a1ef09e85a9897db3633c6fb921fe63e9">m2c</a>.<a class="code" href="classDoubleTab.html#a0bf29d92d15188db10e37a4f7d627784" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(m2e(e, i, j));
      <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++, <a class="code" href="classZone__PolyMAC.html#ad76e9d4739f1092d19cf1985c632524d">w2i</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(<a class="code" href="classZone__PolyMAC.html#aa0cebde1e4683a6c55b944f821d5c097">w2j</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>())) <span class="keywordflow">for</span> (j = 0, <a class="code" href="classZone__PolyMAC.html#aa0cebde1e4683a6c55b944f821d5c097">w2j</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(i), <a class="code" href="classZone__PolyMAC.html#a0806de38360333cf9ea39a791f20906e" title="avec le coeff diagonal en premier (facilite Echange_contact_PolyMAC)">w2c</a>.<a class="code" href="classDoubleTab.html#a0bf29d92d15188db10e37a4f7d627784" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(w2e(e, i, i)); j &lt; n_f; j++)
          <span class="keywordflow">if</span> (j != i &amp;&amp; <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(w2e(e, i, j)) &gt; 1e-6) <a class="code" href="classZone__PolyMAC.html#aa0cebde1e4683a6c55b944f821d5c097">w2j</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(j), <a class="code" href="classZone__PolyMAC.html#a0806de38360333cf9ea39a791f20906e" title="avec le coeff diagonal en premier (facilite Echange_contact_PolyMAC)">w2c</a>.<a class="code" href="classDoubleTab.html#a0bf29d92d15188db10e37a4f7d627784" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(w2e(e, i, j));
    }

  <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a672f82b0a35bb4eb3dbc2b0af8e00cbc">m2d</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#abae0465aee7760855c9b4eae58957bd9">m2i</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a6ffe4bbe605a937ab537b14eae6d7ed1">m2j</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a1ef09e85a9897db3633c6fb921fe63e9">m2c</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#ad76e9d4739f1092d19cf1985c632524d">w2i</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#aa0cebde1e4683a6c55b944f821d5c097">w2j</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a0806de38360333cf9ea39a791f20906e" title="avec le coeff diagonal en premier (facilite Echange_contact_PolyMAC)">w2c</a>);
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; 100. * <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(ctr[0]) / n_tot &lt;&lt; <span class="stringliteral">&quot;% diag &quot;</span> &lt;&lt; 100. * <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(ctr[1]) / n_tot &lt;&lt; <span class="stringliteral">&quot;% sym &quot;</span>
       &lt;&lt; 100. * <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(ctr[2]) / n_tot &lt;&lt; <span class="stringliteral">&quot;% sparse lambda : &quot;</span> &lt;&lt; <a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_min</a>(spectre[0]) &lt;&lt; <span class="stringliteral">&quot; / &quot;</span>
       &lt;&lt; <a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_min</a>(spectre[1]) &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; <a class="code" href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d" title="Calcule le max de x sur tous les processeurs du groupe courant. Remarques : Cette methode doit etre a...">Process::mp_max</a>(spectre[2])
       &lt;&lt; <span class="stringliteral">&quot; / &quot;</span> &lt;&lt; <a class="code" href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d" title="Calcule le max de x sur tous les processeurs du groupe courant. Remarques : Cette methode doit etre a...">Process::mp_max</a>(spectre[3]) &lt;&lt; <span class="stringliteral">&quot; width : &quot;</span> &lt;&lt; <a class="code" href="DoubleVect_8cpp.html#a07dd5e25d47ad3892ae0fa4e997ed011">mp_somme_vect</a>(nnz) * 1. / <a class="code" href="DoubleVect_8cpp.html#a07dd5e25d47ad3892ae0fa4e997ed011">mp_somme_vect</a>(nef) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  <a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;w2&quot;</span>] = 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0773d1ae573ed5da6e6dd82983d342eb"></a><!-- doxytag: member="Zone_PolyMAC::init_m2solv" ref="a0773d1ae573ed5da6e6dd82983d342eb" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::init_m2solv </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01331">1331</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Matrix__tools_8cpp_source.html#l00192">Matrix_tools::allocate_symmetric_morse_matrix()</a>, <a class="el" href="IntTab_8h_source.html#l00261">IntTab::append_line()</a>, <a class="el" href="Zone__VF_8h_source.html#l00581">Zone_VF::elem_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00466">Zone_VF::face_voisins()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01059">init_m2()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00162">is_init</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00180">m2c</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">m2d</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">m2i</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">m2j</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00182">m2mat</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00183">m2solv</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Zone__VF_8h_source.html#l00519">Zone_VF::nb_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00527">Zone_VF::nb_faces_tot()</a>, <a class="el" href="Matrice__Sym_8cpp_source.html#l00032">Matrice_Sym::set_est_definie()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00443">ArrOfInt::set_smart_resize()</a>, <a class="el" href="Array__tools_8cpp_source.html#l00389">tableau_trier_retirer_doublons()</a>, and <a class="el" href="Zone__VF_8h_source.html#l00430">Zone_VF::volumes()</a>.</p>

<p>Referenced by <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00437">Champ_Face_PolyMAC::interp_gve()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classZone__PolyMAC.html#ace03dac8b89bce9f38aa39cd951c59df">init_m2</a>();
  <span class="keywordflow">if</span> (<a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;m2solv&quot;</span>]) <span class="keywordflow">return</span>;
  <span class="comment">/* stencil et allocation */</span>
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; e_f = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(), &amp;f_e = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>();
  <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> stencil(0, 2);
  stencil.set_smart_resize(1);
  <span class="keywordtype">int</span> e, i, j, k, f, fb;
  <span class="keywordflow">for</span> (e = 0; e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++) <span class="keywordflow">for</span> (i = 0, j = <a class="code" href="classZone__PolyMAC.html#a672f82b0a35bb4eb3dbc2b0af8e00cbc">m2d</a>(e); j &lt; <a class="code" href="classZone__PolyMAC.html#a672f82b0a35bb4eb3dbc2b0af8e00cbc">m2d</a>(e + 1); i++, j++)
      <span class="keywordflow">for</span> (f = e_f(e, i), k = <a class="code" href="classZone__PolyMAC.html#abae0465aee7760855c9b4eae58957bd9">m2i</a>(j); f &lt; <a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>() &amp;&amp; k &lt; <a class="code" href="classZone__PolyMAC.html#abae0465aee7760855c9b4eae58957bd9">m2i</a>(j + 1); k++) <span class="keywordflow">if</span> (f &lt;= (fb = e_f(e, <a class="code" href="classZone__PolyMAC.html#a6ffe4bbe605a937ab537b14eae6d7ed1">m2j</a>(k))))
          stencil.append_line(f, fb);
  <a class="code" href="Array__tools_8cpp.html#a07eed4c823b0632bdbf353fdab2a3c6b" title="Trie le tableau tab dans l&#39;ordre lexicographique et retire les doublons (attention [1...">tableau_trier_retirer_doublons</a>(stencil);
  <a class="code" href="classMatrix__tools.html#ad452da2005d07c2ef2d33ed32936d0a9">Matrix_tools::allocate_symmetric_morse_matrix</a>(<a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>() + <a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>(), stencil, <a class="code" href="classZone__PolyMAC.html#a415f14d9e9e0765e1cfc7fc39229af5b">m2mat</a>);

  <span class="comment">/* remplissage */</span>
  <span class="keywordflow">for</span> (e = 0; e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++) <span class="keywordflow">for</span> (i = 0, j = <a class="code" href="classZone__PolyMAC.html#a672f82b0a35bb4eb3dbc2b0af8e00cbc">m2d</a>(e); j &lt; <a class="code" href="classZone__PolyMAC.html#a672f82b0a35bb4eb3dbc2b0af8e00cbc">m2d</a>(e + 1); i++, j++)
      <span class="keywordflow">for</span> (f = e_f(e, i), k = <a class="code" href="classZone__PolyMAC.html#abae0465aee7760855c9b4eae58957bd9">m2i</a>(j); f &lt; <a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>() &amp;&amp; k &lt; <a class="code" href="classZone__PolyMAC.html#abae0465aee7760855c9b4eae58957bd9">m2i</a>(j + 1); k++) <span class="keywordflow">if</span> (f &lt;= (fb = e_f(e, <a class="code" href="classZone__PolyMAC.html#a6ffe4bbe605a937ab537b14eae6d7ed1">m2j</a>(k))))
          <a class="code" href="classZone__PolyMAC.html#a415f14d9e9e0765e1cfc7fc39229af5b">m2mat</a>(f, fb) += (e == f_e(f, 0) ? 1 : -1) * (e == f_e(fb, 0) ? 1 : -1) * <a class="code" href="classZone__VF.html#a9598b08cb9126f88cfafe72fc0eeca70" title="renvoie le tableaux des volumes des mailles.">volumes</a>(e) * <a class="code" href="classZone__PolyMAC.html#a1ef09e85a9897db3633c6fb921fe63e9">m2c</a>(k);
  <a class="code" href="classZone__PolyMAC.html#a415f14d9e9e0765e1cfc7fc39229af5b">m2mat</a>.<a class="code" href="classMatrice__Sym.html#a532cf830aed3865010c9977b545927c0">set_est_definie</a>(1);

  <span class="keywordtype">char</span> lu[] = <span class="stringliteral">&quot;Petsc Cholesky { quiet }&quot;</span>;
  <a class="code" href="classEChaine.html" title="Une entree dont la source est une chaine de caracteres. Le constructeur cree sa propre copie de la ch...">EChaine</a> ch(lu);
  ch &gt;&gt; <a class="code" href="classZone__PolyMAC.html#a3a97852ae61b7a5ea10e1b9ff728faca">m2solv</a>;
  <a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;m2solv&quot;</span>] = 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4fbf9ff80fbb21ecbbcbac2c9c0e0c13"></a><!-- doxytag: member="Zone_PolyMAC::init_rf" ref="a4fbf9ff80fbb21ecbbcbac2c9c0e0c13" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::init_rf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01156">1156</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="DoubleTab_8h_source.html#l00271">DoubleTab::append_line()</a>, <a class="el" href="IntTab_8h_source.html#l00261">IntTab::append_line()</a>, <a class="el" href="Domaine_8h_source.html#l00500">Domaine::coord_sommets()</a>, <a class="el" href="Zone__CoviMAC_8h_source.html#l00427">CRIMP</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00349">cross()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00341">dot()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00245">face_normales()</a>, <a class="el" href="Zone__VF_8h_source.html#l00616">Zone_VF::face_sommets()</a>, <a class="el" href="Zone__VF_8h_source.html#l00054">Zone_VF::face_surfaces()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00162">is_init</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00118">longueur_aretes()</a>, <a class="el" href="Zone__VF_8h_source.html#l00527">Zone_VF::nb_faces_tot()</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00171">rfci</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00170">rfdeb</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00170">rfji</a>, <a class="el" href="ArrOfDouble_8cpp_source.html#l00442">ArrOfDouble::set_smart_resize()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00443">ArrOfInt::set_smart_resize()</a>, <a class="el" href="Op__Conv__Muscl__old__VEF__Face_8cpp_source.html#l00053">sgn</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00159">som_arete</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00224">ta_</a>, <a class="el" href="Zone__VF_8h_source.html#l00240">Zone_VF::xa_</a>, <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>

<p>Referenced by <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00055">Op_Diff_PolyMAC_Face::completer()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; f_s = <a class="code" href="classZone__VF.html#a6cac6a6e8fc1e7b0381b7b15eb451257" title="renvoie le tableau de connectivite faces/sommets.">face_sommets</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xs = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>(), &amp;nf = <a class="code" href="classZone__PolyMAC.html#ac0072097ee9c21dea931fc1a70d8523b">face_normales</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; la = <a class="code" href="classZone__PolyMAC.html#a6bf501ddebc8e5f02ed6713b72277d66">longueur_aretes</a>(), &amp;fs = <a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>();

  <span class="keywordflow">if</span> (<a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;rf&quot;</span>]) <span class="keywordflow">return</span>;
  <span class="keywordtype">int</span> i, s, f;
  <a class="code" href="classZone__PolyMAC.html#a88975dc4a6176ff5756f110ec492ba6f">rfdeb</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(1), <a class="code" href="classZone__PolyMAC.html#a88975dc4a6176ff5756f110ec492ba6f">rfdeb</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#a4ce87d1be325b893ec0904b21053bced">rfji</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#ad9732b8eabce055eadf9195bca623332">rfci</a>.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);
  <span class="keywordflow">for</span> (f = 0; f &lt; <a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>(); <a class="code" href="classZone__PolyMAC.html#a88975dc4a6176ff5756f110ec492ba6f">rfdeb</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(<a class="code" href="classZone__PolyMAC.html#a4ce87d1be325b893ec0904b21053bced">rfji</a>.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)), f++)
    <span class="keywordflow">for</span> (i = 0; i &lt; f_s.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (s = f_s(f, i)) &gt;= 0; i++)
      {
        <span class="keywordtype">int</span> s2 = f_s(f, i + 1 &lt; f_s.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; f_s(f, i + 1) &gt;= 0 ? i + 1 : 0),
            a = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> &lt; 3 ? s : <a class="code" href="classZone__PolyMAC.html#aedbee7d653ae0f28ab65674b28bf78f2">som_arete</a>[s].at(s2);
        std::array&lt;double, 3&gt; taz = {{ 0, 0, 1 }}, vec; <span class="comment">//vecteur tangent a l&#39;arete et produit vectoriel de celui-ci avec xa - xv</span>
        vec = <a class="code" href="classZone__PolyMAC.html#a440d581bbedd755e0fd86e8e2ff7f444">cross</a>(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>, 3, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> &lt; 3 ? &amp;xs(a, 0) : &amp;<a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(a, 0), <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> &lt; 3 ? &amp;taz[0] : &amp;<a class="code" href="classZone__PolyMAC.html#a280bc522cc5b57552bb9dcfbdd1493c5">ta_</a>(a, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0));
        <span class="keywordtype">int</span> <a class="code" href="Op__Conv__Muscl__old__VEF__Face_8cpp.html#ae1b5a554c1d4d97654c06032a92f800a">sgn</a> = <a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;vec[0], &amp;nf(f, 0)) &gt; 0 ? 1 : -1;
        <a class="code" href="classZone__PolyMAC.html#a4ce87d1be325b893ec0904b21053bced">rfji</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(a), <a class="code" href="classZone__PolyMAC.html#ad9732b8eabce055eadf9195bca623332">rfci</a>.<a class="code" href="classDoubleTab.html#a0bf29d92d15188db10e37a4f7d627784" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(sgn * (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> &lt; 3 ? 1 : la(a)) / fs(f));
      }
  <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a88975dc4a6176ff5756f110ec492ba6f">rfdeb</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a4ce87d1be325b893ec0904b21053bced">rfji</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#ad9732b8eabce055eadf9195bca623332">rfci</a>);
  <a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;rf&quot;</span>] = 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae48d3cf3e8cf9d86b86c8bdadd582520"></a><!-- doxytag: member="Zone_PolyMAC::init_ve" ref="ae48d3cf3e8cf9d86b86c8bdadd582520" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::init_ve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01134">1134</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="DoubleTab_8h_source.html#l00271">DoubleTab::append_line()</a>, <a class="el" href="IntTab_8h_source.html#l00261">IntTab::append_line()</a>, <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Zone__CoviMAC_8h_source.html#l00427">CRIMP</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__VF_8h_source.html#l00581">Zone_VF::elem_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00054">Zone_VF::face_surfaces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00466">Zone_VF::face_voisins()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00162">is_init</a>, <a class="el" href="Domaine_8h_source.html#l00204">Domaine::le_nom()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="ArrOfDouble_8cpp_source.html#l00442">ArrOfDouble::set_smart_resize()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00443">ArrOfInt::set_smart_resize()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00166">veci</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00165">vedeb</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00165">veji</a>, <a class="el" href="Zone__VF_8h_source.html#l00217">Zone_VF::volumes_</a>, <a class="el" href="Zone__VF_8h_source.html#l00706">Zone_VF::xp()</a>, <a class="el" href="Zone__VF_8h_source.html#l00688">Zone_VF::xv()</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00127">Op_Conv_EF_Stab_PolyMAC_Face::ajouter()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00090">Op_Conv_EF_Stab_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00236">Champ_Face_PolyMAC::init_va()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00388">Champ_Face_PolyMAC::interp_ve()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; e_f = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(), &amp;f_e = <a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ve = <a class="code" href="classZone__VF.html#aa3dafba95eaf5c0026d73c9e15b937b0" title="volumes des elements">volumes_</a>, &amp;fs = <a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>();
  <span class="keywordtype">int</span> i, k, e, f;

  <span class="keywordflow">if</span> (<a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;ve&quot;</span>]) <span class="keywordflow">return</span>;
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; : initialisation de ve... &quot;</span>;
  <a class="code" href="classZone__PolyMAC.html#a9878f0653163f907ea6b2c20ee0d89ee">vedeb</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(1), <a class="code" href="classZone__PolyMAC.html#a9878f0653163f907ea6b2c20ee0d89ee">vedeb</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#ad1e5259622bbf8ce56dbd4cfd5708475">veji</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#ad009c3ee5402613abf0d7e8b15da1c6f">veci</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, 3), <a class="code" href="classZone__PolyMAC.html#ad009c3ee5402613abf0d7e8b15da1c6f">veci</a>.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);
<span class="comment">// formule (1) de Basumatary et al. (2014) https://doi.org/10.1016/j.jcp.2014.04.033 d&#39;apres Perot</span>
  <span class="keywordflow">for</span> (e = 0; e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); <a class="code" href="classZone__PolyMAC.html#a9878f0653163f907ea6b2c20ee0d89ee">vedeb</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(<a class="code" href="classZone__PolyMAC.html#ad1e5259622bbf8ce56dbd4cfd5708475">veji</a>.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)), e++)
    <span class="keywordflow">for</span> (i = 0; i &lt; e_f.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (f = e_f(e, i)) &gt;= 0; i++)
      {
        <span class="keywordtype">double</span> x[3] = { 0, };
        <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; k++) x[k] = fs(f) * (<a class="code" href="classZone__VF.html#a6c108eadb292f20b662cff6e3ecf6115">xv</a>(f, k) - <a class="code" href="classZone__VF.html#ad9f40bf649129fcc43578cbf057954ef">xp</a>(e, k)) * (e == f_e(f, 0) ? 1 : -1) / ve(e);
        <a class="code" href="classZone__PolyMAC.html#ad1e5259622bbf8ce56dbd4cfd5708475">veji</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(f), <a class="code" href="classZone__PolyMAC.html#ad009c3ee5402613abf0d7e8b15da1c6f">veci</a>.<a class="code" href="classDoubleTab.html#a0bf29d92d15188db10e37a4f7d627784" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(x[0], x[1], x[2]);
      }
  <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a9878f0653163f907ea6b2c20ee0d89ee">vedeb</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#ad1e5259622bbf8ce56dbd4cfd5708475">veji</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#ad009c3ee5402613abf0d7e8b15da1c6f">veci</a>);
  <a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;ve&quot;</span>] = 1, <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;OK&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac7d63e6ad15a24ef255b33ffaf2a7004"></a><!-- doxytag: member="Zone_PolyMAC::init_virt_ef_map" ref="ac7d63e6ad15a24ef255b33ffaf2a7004" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::init_virt_ef_map </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01358">1358</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Zone_8cpp_source.html#l01600">Zone::creer_tableau_elements()</a>, <a class="el" href="Zone__VF_8cpp_source.html#l00623">Zone_VF::creer_tableau_faces()</a>, <a class="el" href="IntVect_8cpp_source.html#l00276">IntVect::echange_espace_virtuel()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00162">is_init</a>, <a class="el" href="Process_8cpp_source.html#l00117">Process::me()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00140">Zone_dis_base::nb_elem()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Zone__VF_8h_source.html#l00519">Zone_VF::nb_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00527">Zone_VF::nb_faces_tot()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00204">virt_ef_map</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (<a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;virt_ef&quot;</span>]) <span class="keywordflow">return</span>; <span class="comment">//deja initialisa</span>
  <span class="keywordtype">int</span> e, f;
  <a class="code" href="classIntTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un IntTab avec allocation dans un pool de memoire gere...">IntTrav</a> p_e(0, 2), p_f(0, 2);
  <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(p_e), <a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(p_f);
  <span class="keywordflow">for</span> (e = 0; e &lt; <a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>() ; e++) p_e(e, 0) = <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), p_e(e, 1) = e;
  <span class="keywordflow">for</span> (f = 0; f &lt; <a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>(); f++) p_f(f, 0) = <a class="code" href="classProcess.html#ab55ba07167ec807ed3a145cac0f5dca4" title="renvoie mon rang dans le groupe de communication courant. Voir Comm_Group::rank() et PE_Groups::curre...">Process::me</a>(), p_f(f, 1) = <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>() + f;
  p_e.echange_espace_virtuel(), p_f.echange_espace_virtuel();
  <span class="keywordflow">for</span> (e = <a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>() ; e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>() ; e++) <a class="code" href="classZone__PolyMAC.html#ab280f7d8d35c0a0a7c576ef52145a09e">virt_ef_map</a>[ {{ p_e(e, 0), p_e(e, 1) }}] = e;
  <span class="keywordflow">for</span> (f = <a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>(); f &lt; <a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>(); f++) <a class="code" href="classZone__PolyMAC.html#ab280f7d8d35c0a0a7c576ef52145a09e">virt_ef_map</a>[ {{ p_f(f, 0), p_f(f, 1) }}] = <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>() + f;
  <a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;virt_ef&quot;</span>] = 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad5ca5e80325c5f46a98e657ab32a4311"></a><!-- doxytag: member="Zone_PolyMAC::init_we" ref="ad5ca5e80325c5f46a98e657ab32a4311" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::init_we </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01180">1180</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00223">arete_faces_</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone__VF_8h_source.html#l00239">Zone_VF::face_sommets_</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01201">init_we_2d()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01221">init_we_3d()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00162">is_init</a>, <a class="el" href="Double_8h_source.html#l00180">max()</a>, <a class="el" href="Zone__VF_8h_source.html#l00527">Zone_VF::nb_faces_tot()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00152">Zone_dis_base::nb_som_tot()</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00159">som_arete</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01322">init_m1()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (<a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;we&quot;</span>]) <span class="keywordflow">return</span>;

<span class="comment">// remplissage de arete_faces_ (liste des faces touchant chaque arete en 3D, chaque sommet en 2D)</span>
  std::vector&lt;std::vector&lt;int&gt; &gt; a_f_vect(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> &lt; 3 ? <a class="code" href="classZone__dis__base.html#a8f793341b7a41d67561ba563ae0f69a0">nb_som_tot</a>() : <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().nb_aretes_tot());
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; f_s = <a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0, i, s1; f &lt; <a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>(); f++) <span class="keywordflow">for</span> (i = 0; i &lt; f_s.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (s1 = f_s(f, i)) &gt;= 0; i++)
      {
        <span class="keywordtype">int</span> s2 = f_s(f, i + 1 &lt; f_s.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; f_s(f, i + 1) &gt;= 0 ? i + 1 : 0);
        a_f_vect[<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> &lt; 3 ? s1 : <a class="code" href="classZone__PolyMAC.html#aedbee7d653ae0f28ab65674b28bf78f2">som_arete</a>[s1].at(s2)].push_back(f);
      }
  <span class="keywordtype">int</span> a_f_max = 0;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; (int) a_f_vect.size(); i++) a_f_max = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(a_f_max, (<span class="keywordtype">int</span>) a_f_vect[i].size());
  <a class="code" href="classZone__PolyMAC.html#a1214dca84091e8bc3f48b17465437986">arete_faces_</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(a_f_vect.size(), a_f_max), <a class="code" href="classZone__PolyMAC.html#a1214dca84091e8bc3f48b17465437986">arete_faces_</a> = -1;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, j; i &lt; <a class="code" href="classZone__PolyMAC.html#a1214dca84091e8bc3f48b17465437986">arete_faces_</a>.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0); i++) <span class="keywordflow">for</span> (j = 0; j &lt; (int) a_f_vect[i].size(); j++) <a class="code" href="classZone__PolyMAC.html#a1214dca84091e8bc3f48b17465437986">arete_faces_</a>(i, j) = a_f_vect[i][j];

  <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> &lt; 3 ? <a class="code" href="classZone__PolyMAC.html#a3a30c73bd3415b17879f3d4261861b4a">init_we_2d</a>() : <a class="code" href="classZone__PolyMAC.html#a20115c1a7b4f3f6102185cf2e1d7bcb0">init_we_3d</a>();
  <a class="code" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">is_init</a>[<span class="stringliteral">&quot;we&quot;</span>] = 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3a30c73bd3415b17879f3d4261861b4a"></a><!-- doxytag: member="Zone_PolyMAC::init_we_2d" ref="a3a30c73bd3415b17879f3d4261861b4a" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::init_we_2d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01201">1201</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="DoubleTab_8h_source.html#l00271">DoubleTab::append_line()</a>, <a class="el" href="IntTab_8h_source.html#l00261">IntTab::append_line()</a>, <a class="el" href="Domaine_8h_source.html#l00500">Domaine::coord_sommets()</a>, <a class="el" href="Zone__CoviMAC_8h_source.html#l00427">CRIMP</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00349">cross()</a>, <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__VF_8h_source.html#l00581">Zone_VF::elem_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00239">Zone_VF::face_sommets_</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="ArrOfDouble_8cpp_source.html#l00442">ArrOfDouble::set_smart_resize()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00443">ArrOfInt::set_smart_resize()</a>, <a class="el" href="Zone__VF_8h_source.html#l00430">Zone_VF::volumes()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00190">weci</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00189">wedeb</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00189">weji</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01180">init_we()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; e_f = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(), &amp;f_s = <a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>;
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xs = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; ve = <a class="code" href="classZone__VF.html#a9598b08cb9126f88cfafe72fc0eeca70" title="renvoie le tableaux des volumes des mailles.">volumes</a>();
  <span class="keywordtype">int</span> i, j, e, f, s;

  <a class="code" href="classZone__PolyMAC.html#af61335f5cde4fc2cdd1d5fcd734e0516">wedeb</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(1), <a class="code" href="classZone__PolyMAC.html#af61335f5cde4fc2cdd1d5fcd734e0516">wedeb</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#a0e0a04421ef4f416ac46e96943c9e887">weji</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#a034313bc3890500f6179ad7fbfe50e5e">weci</a>.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);
  std::map&lt;int, double&gt; wemi;
  <span class="keywordflow">for</span> (e = 0; e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); <a class="code" href="classZone__PolyMAC.html#af61335f5cde4fc2cdd1d5fcd734e0516">wedeb</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(<a class="code" href="classZone__PolyMAC.html#a0e0a04421ef4f416ac46e96943c9e887">weji</a>.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)), wemi.clear(), e++)
    {
<span class="comment">// une contribution par &quot;facette&quot; (triangle entre le sommet, le CG de la face et celui de l&#39;element)</span>
      <span class="keywordflow">for</span> (i = 0; i &lt; e_f.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (f = e_f(e, i)) &gt;= 0; i++)
        <span class="keywordflow">for</span> (j = 0; j &lt; f_s.dimension(1) &amp;&amp; (s = f_s(f, j)) &gt;= 0; j++) <span class="comment">//contrib. de chaque sommet de chaque face</span>
          wemi[s] += <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classZone__PolyMAC.html#a440d581bbedd755e0fd86e8e2ff7f444">cross</a>(2, 2, &amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(e, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0), &amp;xs(s, 0), &amp;xs(s, 0))[2]) / (2 * ve(e));
      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;kv : wemi) <a class="code" href="classZone__PolyMAC.html#a0e0a04421ef4f416ac46e96943c9e887">weji</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(kv.first), <a class="code" href="classZone__PolyMAC.html#a034313bc3890500f6179ad7fbfe50e5e">weci</a>.<a class="code" href="classDoubleTab.html#a0bf29d92d15188db10e37a4f7d627784" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(kv.second);
    }
  <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#af61335f5cde4fc2cdd1d5fcd734e0516">wedeb</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a0e0a04421ef4f416ac46e96943c9e887">weji</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a034313bc3890500f6179ad7fbfe50e5e">weci</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a20115c1a7b4f3f6102185cf2e1d7bcb0"></a><!-- doxytag: member="Zone_PolyMAC::init_we_3d" ref="a20115c1a7b4f3f6102185cf2e1d7bcb0" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::init_we_3d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01221">1221</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="DoubleTab_8h_source.html#l00271">DoubleTab::append_line()</a>, <a class="el" href="IntTab_8h_source.html#l00261">IntTab::append_line()</a>, <a class="el" href="Zone__CoviMAC_8h_source.html#l00427">CRIMP</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00349">cross()</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00341">dot()</a>, <a class="el" href="Zone__VF_8h_source.html#l00581">Zone_VF::elem_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00239">Zone_VF::face_sommets_</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00211">longueur_aretes_</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="ArrOfDouble_8cpp_source.html#l00442">ArrOfDouble::set_smart_resize()</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00443">ArrOfInt::set_smart_resize()</a>, <a class="el" href="Op__Conv__Muscl__old__VEF__Face_8cpp_source.html#l00053">sgn</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00159">som_arete</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00224">ta_</a>, <a class="el" href="Zone__VF_8h_source.html#l00217">Zone_VF::volumes_</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00190">weci</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00189">wedeb</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00189">weji</a>, <a class="el" href="Zone__VF_8h_source.html#l00240">Zone_VF::xa_</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, and <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01180">init_we()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; e_f = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>(), &amp;f_s = <a class="code" href="classZone__VF.html#aed9555a55cac4a6ce8af5662cea174a1" title="sommets des faces">face_sommets_</a>;
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; la = <a class="code" href="classZone__PolyMAC.html#ac4cfae3ceac2c9e92565c5d3b4e1e542">longueur_aretes_</a>, &amp;ve = <a class="code" href="classZone__VF.html#aa3dafba95eaf5c0026d73c9e15b937b0" title="volumes des elements">volumes_</a>;
  <span class="keywordtype">int</span> i, j, k, e, f, s;

  <a class="code" href="classZone__PolyMAC.html#af61335f5cde4fc2cdd1d5fcd734e0516">wedeb</a>.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(1), <a class="code" href="classZone__PolyMAC.html#af61335f5cde4fc2cdd1d5fcd734e0516">wedeb</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#a0e0a04421ef4f416ac46e96943c9e887">weji</a>.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), <a class="code" href="classZone__PolyMAC.html#a034313bc3890500f6179ad7fbfe50e5e">weci</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(0, 3), <a class="code" href="classZone__PolyMAC.html#a034313bc3890500f6179ad7fbfe50e5e">weci</a>.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);
  std::map&lt;int, std::array&lt;double, 3&gt; &gt; wemi;
  <span class="keywordflow">for</span> (e = 0; e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); <a class="code" href="classZone__PolyMAC.html#af61335f5cde4fc2cdd1d5fcd734e0516">wedeb</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(<a class="code" href="classZone__PolyMAC.html#a0e0a04421ef4f416ac46e96943c9e887">weji</a>.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0)), wemi.clear(), e++)
    {
<span class="comment">// une contribution par &quot;facette&quot; (triangle entre CG de l&#39;arete, le CG de la face et celui de l&#39;element)</span>
      <span class="keywordflow">for</span> (i = 0; i &lt; e_f.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (f = e_f(e, i)) &gt;= 0; i++)
        <span class="keywordflow">for</span> (j = 0; j &lt; f_s.dimension(1) &amp;&amp; (s = f_s(f, j)) &gt;= 0; j++) <span class="comment">//contrib. de chaque sommet de chaque face</span>
          {
            <span class="keywordtype">int</span> s2 = f_s(f, j + 1 &lt; f_s.dimension(1) &amp;&amp; f_s(f, j + 1) &gt;= 0 ? j + 1 : 0),
                a = <a class="code" href="classZone__PolyMAC.html#aedbee7d653ae0f28ab65674b28bf78f2">som_arete</a>[s].at(s2);
            std::array&lt;double, 3&gt; vec = <a class="code" href="classZone__PolyMAC.html#a440d581bbedd755e0fd86e8e2ff7f444">cross</a>(3, 3, &amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(e, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0), &amp;<a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(a, 0), &amp;<a class="code" href="classZone__VF.html#a4ba38185cf824e8f4bcf315bd84ee5d3" title="centres de gravite des aretes">xa_</a>(a, 0));
<span class="comment">// on tourne la facette dans la bonne direction</span>
            <span class="keywordtype">int</span> <a class="code" href="Op__Conv__Muscl__old__VEF__Face_8cpp.html#ae1b5a554c1d4d97654c06032a92f800a">sgn</a> = <a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;<a class="code" href="classZone__PolyMAC.html#a280bc522cc5b57552bb9dcfbdd1493c5">ta_</a>(a, 0), &amp;vec[0]) &gt; 0 ? 1 : -1;
            <span class="keywordflow">for</span> (k = 0; k &lt; 3; k++) wemi[a][k] += sgn * vec[k] * la(a) / (2 * ve(e));
          }
      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp;kv : wemi) <a class="code" href="classZone__PolyMAC.html#a0e0a04421ef4f416ac46e96943c9e887">weji</a>.<a class="code" href="classIntTab.html#ac0af4eac42ca46facc05f985c3ef05c6" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(kv.first), <a class="code" href="classZone__PolyMAC.html#a034313bc3890500f6179ad7fbfe50e5e">weci</a>.<a class="code" href="classDoubleTab.html#a0bf29d92d15188db10e37a4f7d627784" title="Adds 1 to dimension_tot(0) and puts a in the added line.">append_line</a>(kv.second[0], kv.second[1], kv.second[2]);
    }
  <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#af61335f5cde4fc2cdd1d5fcd734e0516">wedeb</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a0e0a04421ef4f416ac46e96943c9e887">weji</a>), <a class="code" href="Zone__CoviMAC_8h.html#a30133bb5f8cebac5322355d13a055208">CRIMP</a>(<a class="code" href="classZone__PolyMAC.html#a034313bc3890500f6179ad7fbfe50e5e">weci</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6bf501ddebc8e5f02ed6713b72277d66"></a><!-- doxytag: member="Zone_PolyMAC::longueur_aretes" ref="a6bf501ddebc8e5f02ed6713b72277d66" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classDoubleVect.html">DoubleVect</a>&amp; Zone_PolyMAC::longueur_aretes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00118">118</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00211">longueur_aretes_</a>.</p>

<p>Referenced by <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00186">Champ_Face_PolyMAC::init_ra()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01156">init_rf()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#ac4cfae3ceac2c9e92565c5d3b4e1e542">longueur_aretes_</a>;
  };
</pre></div>
</div>
</div>
<a class="anchor" id="a052c2d8776d7c7a43386bc4921f5af82"></a><!-- doxytag: member="Zone_PolyMAC::modifier_pour_Cl" ref="a052c2d8776d7c7a43386bc4921f5af82" args="(const Conds_lim &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::modifier_pour_Cl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classConds__lim.html">Conds_lim</a> &amp;&#160;</td>
          <td class="paramname"><em>conds_lim</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classZone__VF.html#a9f0a628711baca94adde68020c1b9954">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00731">731</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Periodique_8h_source.html#l00056">Periodique::face_associee()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>, <a class="el" href="Zone__VF_8h_source.html#l00232">Zone_VF::face_voisins_</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Cond__lim__base_8h_source.html#l00123">Cond_lim_base::frontiere_dis()</a>, <a class="el" href="Process_8cpp_source.html#l00345">Process::Journal()</a>, <a class="el" href="Zone__VF_8cpp_source.html#l00508">Zone_VF::marquer_faces_double_contrib()</a>, <a class="el" href="Zone__VF_8h_source.html#l00519">Zone_VF::nb_faces()</a>, <a class="el" href="Front__VF_8h_source.html#l00061">Front_VF::nb_faces()</a>, <a class="el" href="Zone_8h_source.html#l00469">Zone::nb_faces_elem()</a>, <a class="el" href="Front__VF_8h_source.html#l00066">Front_VF::nb_faces_tot()</a>, <a class="el" href="Front__VF_8h_source.html#l00076">Front_VF::num_face()</a>, <a class="el" href="Front__VF_8h_source.html#l00071">Front_VF::num_premiere_face()</a>, <a class="el" href="Cast_8h_source.html#l00059">ref_cast</a>, <a class="el" href="vect__impl_8h_source.html#l00057">vect_impl::size()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Zone__VF_8h_source.html#l00217">Zone_VF::volumes_</a>, <a class="el" href="Zone__VF_8h_source.html#l00219">Zone_VF::volumes_entrelaces_</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>
<div class="fragment"><pre class="fragment">{


<span class="comment">// if (volumes_sommets_thilde_.size()!=nb_som())</span>
  {

    <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;La Zone_PolyMAC a ete remplie avec succes&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;

<span class="comment">// calculer_h_carre();</span>
<span class="comment">// Calcul des porosites</span>

<span class="comment">// les porosites sommets ne servent pas</span>
<span class="comment">// calculer_porosites_sommets();</span>


  }
  <a class="code" href="classProcess.html#a57e0f54b11e6eaadbea224fa904b18dd" title="Renvoie un objet statique de type Sortie qui sert de journal d&#39;evenements. Si message_level &lt;= verbose...">Journal</a>() &lt;&lt; <span class="stringliteral">&quot;Zone_PolyMAC::Modifier_pour_Cl&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  <span class="keywordtype">int</span> nb_cond_lim=conds_lim.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>();
  <span class="keywordtype">int</span> num_cond_lim=0;
  <span class="keywordflow">for</span> (; num_cond_lim&lt;nb_cond_lim; num_cond_lim++)
    {
<span class="comment">// for cl</span>
      <span class="keyword">const</span> <a class="code" href="classCond__lim__base.html" title="classe Cond_lim_base Classe de base pour la hierarchie des classes qui representent les differentes c...">Cond_lim_base</a>&amp; cl = conds_lim[num_cond_lim].valeur();
      <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>, cl))
        {
<span class="comment">// if Perio</span>
          <span class="keyword">const</span> <a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>&amp; la_cl_period = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,cl);
          <span class="keywordtype">int</span> nb_faces_elem = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a548fbc7518be2f122b1a5c9589a443c2" title="Renvoie le nombre de face de type i des elements geometriques constituants la zone. Ex: les objets de la classe Prisme ont 2 types de faces: triangle ou quadrangle.">nb_faces_elem</a>();
          <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; la_front_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,cl.<a class="code" href="classCond__lim__base.html#ad88b3b516351146c85e8fce1df0f691a" title="Renvoie la frontiere discretisee a laquelle les conditions aux limites s&#39;appliquent.">frontiere_dis</a>());
          <span class="keywordtype">int</span> ndeb = 0;
          <span class="keywordtype">int</span> nfin = la_front_dis.<a class="code" href="classFront__VF.html#aed4006d91bf2ef3af2b9f7933d863a09" title="Nombre de faces reelles et virtuelles du bord.">nb_faces_tot</a>();
<span class="preprocessor">#ifndef NDEBUG</span>
<span class="preprocessor"></span>          <span class="keywordtype">int</span> num_premiere_face = la_front_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
          <span class="keywordtype">int</span> num_derniere_face = num_premiere_face+nfin;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>          <span class="keywordtype">int</span> nbr_faces_bord = la_front_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
          assert((<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>()==0)||(ndeb&lt;<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>()));
          assert(nfin&gt;=ndeb);
          <span class="keywordtype">int</span> elem1,elem2,k;
          <span class="keywordtype">int</span> face;
<span class="comment">// Modification des tableaux face_voisins_ , face_normales_ , volumes_entrelaces_</span>
<span class="comment">// On change l&#39;orientation de certaines normales</span>
<span class="comment">// de sorte que les normales aux faces de periodicite soient orientees</span>
<span class="comment">// de face_voisins(la_face_en_question,0) vers face_voisins(la_face_en_question,1)</span>
<span class="comment">// comme le sont les faces internes d&#39;ailleurs</span>

          <a class="code" href="classDoubleVect.html">DoubleVect</a> C1C2(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
          <span class="keywordtype">double</span> vol,psc=0;

          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind_face=ndeb; ind_face&lt;nfin; ind_face++)
            {
<span class="comment">// for ind_face</span>
              face = la_front_dis.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(ind_face);
              <span class="keywordflow">if</span>  ( (<a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(face,0) == -1) || (<a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(face,1) == -1) )
                {
                  <span class="keywordtype">int</span> faassociee = la_front_dis.<a class="code" href="classFront__VF.html#a3402a19d7e54ed797d2b18e9a47ead1e" title="Renvoie le numero de face de la ieme face du bord.">num_face</a>(la_cl_period.<a class="code" href="classPeriodique.html#a207b86556f199a63ea059b841851ca6a">face_associee</a>(ind_face));
                  <span class="keywordflow">if</span> (ind_face&lt;nbr_faces_bord)
                    {
                      assert(faassociee&gt;=num_premiere_face);
                      assert(faassociee&lt;num_derniere_face);
                    }

                  elem1 = <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(face,0);
                  elem2 = <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(faassociee,0);
                  vol = (<a class="code" href="classZone__VF.html#aa3dafba95eaf5c0026d73c9e15b937b0" title="volumes des elements">volumes_</a>[elem1] + <a class="code" href="classZone__VF.html#aa3dafba95eaf5c0026d73c9e15b937b0" title="volumes des elements">volumes_</a>[elem2])/nb_faces_elem;
                  <a class="code" href="classZone__VF.html#a4d84eafd75968d81d72275f240390ee8" title="volumes entrelaces pour l&#39;integration des Qdm">volumes_entrelaces_</a>[face] = vol;
                  <a class="code" href="classZone__VF.html#a4d84eafd75968d81d72275f240390ee8" title="volumes entrelaces pour l&#39;integration des Qdm">volumes_entrelaces_</a>[faassociee] = vol;
                  <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(face,1) = elem2;
                  <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(faassociee,0) = elem1;
                  <a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(faassociee,1) = elem2;
                  psc = 0;
                  <span class="keywordflow">for</span> (k=0; k&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; k++)
                    {
                      C1C2[k] = <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(face,k) - <a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(<a class="code" href="classZone__VF.html#a0137bd5587e0f140922bb6f21e3f4ea1" title="connectivite face/elements">face_voisins_</a>(face,0),k);
                      psc += <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>(face,k)*C1C2[k];
                    }

                  <span class="keywordflow">if</span> (psc &lt; 0)
                    <span class="keywordflow">for</span> (k=0; k&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; k++)
                      <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>(face,k) *= -1;

                  <span class="keywordflow">for</span> (k=0; k&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; k++)
                    <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>(faassociee,k) = <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>(face,k);
                }
            }
        }
    }

<span class="comment">// PQ : 10/10/05 : les faces periodiques etant a double contribution</span>
<span class="comment">// l&#39;appel a marquer_faces_double_contrib s&#39;effectue dans cette methode</span>
<span class="comment">// afin de pouvoir beneficier de conds_lim.</span>
  <a class="code" href="classZone__VF.html#a70e4e330a3466cc3c26293e3642a77b1">Zone_VF::marquer_faces_double_contrib</a>(conds_lim);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2ad9804df772625c1b7846f5bbf5660b"></a><!-- doxytag: member="Zone_PolyMAC::nb_elem_Cl" ref="a2ad9804df772625c1b7846f5bbf5660b" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Zone_PolyMAC::nb_elem_Cl </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00305">305</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__dis__base_8h_source.html#l00140">Zone_dis_base::nb_elem()</a>, and <a class="el" href="Zone__PolyMAC_8h_source.html#l00213">nb_elem_std_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>() - <a class="code" href="classZone__PolyMAC.html#a1d10485a5ee3b7b952e39ef12cb35416" title="nombre d&#39;elements standard">nb_elem_std_</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aab266ede1487ea6ad1759b0fea78bcb2"></a><!-- doxytag: member="Zone_PolyMAC::nb_elem_std" ref="aab266ede1487ea6ad1759b0fea78bcb2" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Zone_PolyMAC::nb_elem_std </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00299">299</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00213">nb_elem_std_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#a1d10485a5ee3b7b952e39ef12cb35416" title="nombre d&#39;elements standard">nb_elem_std_</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0648285447e084ae66a816fbc397dc16"></a><!-- doxytag: member="Zone_PolyMAC::nb_faces_joint" ref="a0648285447e084ae66a816fbc397dc16" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Zone_PolyMAC::nb_faces_joint </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00286">286</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> 0;
<span class="comment">// return nb_faces_joint_;    A FAIRE</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="af17635ac2c2a5af41025b8b60fcf7aae"></a><!-- doxytag: member="Zone_PolyMAC::nb_faces_std" ref="af17635ac2c2a5af41025b8b60fcf7aae" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Zone_PolyMAC::nb_faces_std </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00293">293</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00212">nb_faces_std_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#a2b20af52d5cf15a8cfc12069ee7298b8" title="nombre de faces standard">nb_faces_std_</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a99bd91bcc80c7118fe601b800078e220"></a><!-- doxytag: member="Zone_PolyMAC::oriente_normale" ref="a99bd91bcc80c7118fe601b800078e220" args="(int face_opp, int elem2) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Zone_PolyMAC::oriente_normale </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>face_opp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>elem2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00318">318</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__VF_8h_source.html#l00466">Zone_VF::face_voisins()</a>.</p>

<p>Referenced by <a class="el" href="Op__Div__PolyMAC_8cpp_source.html#l00069">Op_Div_PolyMAC::ajouter()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span>(<a class="code" href="classZone__VF.html#a816ac37fd526f962468cae6fbd8061f8" title="renvoie le tableaux des volumes des connectivites face elements cf au dessus.">face_voisins</a>(face_opp,0)==elem2)
    <span class="keywordflow">return</span> 1;
  <span class="keywordflow">else</span> <span class="keywordflow">return</span> -1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2b1025462b8ecfa5971deef395649c58"></a><!-- doxytag: member="Zone_PolyMAC::orthocentrer" ref="a2b1025462b8ecfa5971deef395649c58" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::orthocentrer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>&lt; b_{f,e}_ortho(f/e) = 1 si la face / l'element est orthocentre </p>
</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00573">573</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Domaine_8h_source.html#l00500">Domaine::coord_sommets()</a>, <a class="el" href="Zone_8cpp_source.html#l01600">Zone::creer_tableau_elements()</a>, <a class="el" href="Zone__VF_8cpp_source.html#l00623">Zone_VF::creer_tableau_faces()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00349">cross()</a>, <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00341">dot()</a>, <a class="el" href="Zone__VF_8h_source.html#l00581">Zone_VF::elem_faces()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>, <a class="el" href="Zone__VF_8h_source.html#l00616">Zone_VF::face_sommets()</a>, <a class="el" href="Zone__VF_8h_source.html#l00054">Zone_VF::face_surfaces()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Zone__CoviMAC_8h_source.html#l00359">kersol()</a>, <a class="el" href="Domaine_8h_source.html#l00204">Domaine::le_nom()</a>, <a class="el" href="Zone_8h_source.html#l00402">Zone::les_elems()</a>, <a class="el" href="Double_8h_source.html#l00180">max()</a>, <a class="el" href="Double_8h_source.html#l00199">min()</a>, <a class="el" href="DoubleVect_8cpp_source.html#l00597">mp_somme_vect()</a>, <a class="el" href="Process_8cpp_source.html#l00178">Process::mp_sum()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00140">Zone_dis_base::nb_elem()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00144">Zone_dis_base::nb_elem_tot()</a>, <a class="el" href="Zone__VF_8h_source.html#l00519">Zone_VF::nb_faces()</a>, <a class="el" href="Zone__VF_8h_source.html#l00527">Zone_VF::nb_faces_tot()</a>, <a class="el" href="IntTab_8cpp_source.html#l00353">IntTab::resize()</a>, <a class="el" href="ArrOfDouble_8cpp_source.html#l00442">ArrOfDouble::set_smart_resize()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00159">som_arete</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00224">ta_</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; f_s = <a class="code" href="classZone__VF.html#a6cac6a6e8fc1e7b0381b7b15eb451257" title="renvoie le tableau de connectivite faces/sommets.">face_sommets</a>(), &amp;e_s = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>(), &amp;e_f = <a class="code" href="classZone__VF.html#a8e09b61902b9f1d2c4c7bedc3b8f39d3" title="renvoie le tableau de connectivite element/faces">elem_faces</a>();
  <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xs = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>(), &amp;nf = <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a>;
  <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; fs = <a class="code" href="classZone__VF.html#a40c3382b189a4fc508cf1c3e37b04b21">face_surfaces</a>();
  <span class="keywordtype">int</span> i, j, e, f, s, np;
  <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> M(0, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> + 1), X(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> + 1, 1), S(0, 1), vp; <span class="comment">//pour les systemes lineaires</span>
  M.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1), S.set_smart_resize(1), vp.<a class="code" href="classArrOfDouble.html#ab49f6cae96be9d3f597468d8a53b67b6" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);
  <a class="code" href="classIntTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un IntTab avec allocation dans un pool de memoire gere...">IntTrav</a> b_f_ortho, b_e_ortho; <span class="comment">//!&lt; b_{f,e}_ortho(f/e) = 1 si la face / l&#39;element est orthocentre</span>
<span class="comment"></span>  <a class="code" href="classZone__VF.html#a8e02e68f236356f72728b82536538ac5">creer_tableau_faces</a>(b_f_ortho), <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(b_e_ortho);

  <span class="comment">/* 1. orthocentrage des faces (en dimension 3) */</span>
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;
  <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> &lt; 3) b_f_ortho = 1; <span class="comment">//les faces (segments) sont deja orthcentrees!</span>
  <span class="keywordflow">else</span> <span class="keywordflow">for</span> (f = 0; f &lt; <a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>(); f++)
      {
<span class="comment">// la face est-elle deja orthocentree?</span>
        <span class="keywordtype">double</span> d2min = DBL_MAX, d2max = 0, d2;
        <span class="keywordflow">for</span> (i = 0, np = 0; i &lt; f_s.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (s = f_s(f, i)) &gt;= 0; i++, np++)
          d2min = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(d2min, d2 = <a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;xs(s, 0), &amp;xs(s, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0))), d2max = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(d2max, d2);
        <span class="keywordflow">if</span> ((b_f_ortho(f) = (d2max / d2min - 1 &lt; 1e-8))) <span class="keywordflow">continue</span>;

<span class="comment">// peut-on l&#39;orthocentrer?</span>
        M.resize(np + 1, 4), S.resize(np + 1, 1);
        <span class="keywordflow">for</span> (i = 0; i &lt; np; i++) <span class="keywordflow">for</span> (j = 0, S(i, 0) = 0, M(i, 3) = 1; j &lt; 3; j++)
            S(i, 0) += 0.5 * std::pow(M(i, j) = xs(f_s(f, i), j) - <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, j), 2);
        <span class="keywordflow">for</span> (j = 0, S(np, 0) = M(np, 3) = 0; j &lt; 3; j++) M(np, j) = nf(f, j) / fs(f);
        <span class="keywordflow">if</span> (<a class="code" href="Zone__CoviMAC_8h.html#acaf341ab8f98a1dbd4151f02dbd07e18">kersol</a>(M, S, 1e-12, NULL, X, vp) &gt; 1e-8) <span class="keywordflow">continue</span>; <span class="comment">//la face n&#39;a pas d&#39;orthocentre</span>

<span class="comment">// contrainte : ne pas diminuer la distance entre xv et chaque arete de plus de 50%</span>
        <span class="keywordtype">double</span> r2min = DBL_MAX;
        <span class="keywordflow">for</span> (i = 0; i &lt; f_s.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (s = f_s(f, i)) &gt;= 0; i++)
          {
            <span class="keywordtype">int</span> s2 = f_s(f, i + 1 &lt; f_s.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; f_s(f, i + 1) &gt;= 0 ? i + 1 : 0),
                a = <a class="code" href="classZone__PolyMAC.html#aedbee7d653ae0f28ab65674b28bf78f2">som_arete</a>[s].at(s2);
            std::array&lt;double, 3&gt; vec = <a class="code" href="classZone__PolyMAC.html#a440d581bbedd755e0fd86e8e2ff7f444">cross</a>(3, 3, &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0), &amp;<a class="code" href="classZone__PolyMAC.html#a280bc522cc5b57552bb9dcfbdd1493c5">ta_</a>(a, 0), &amp;xs(s, 0));
            r2min = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(r2min, <a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;vec[0], &amp;vec[0]));
          }
        <span class="keywordflow">if</span> (<a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;X(0, 0), &amp;X(0, 0)) &gt; 0.25 * r2min) <span class="keywordflow">continue</span>; <span class="comment">//on s&#39;eloigne trop du CG</span>

        <span class="keywordflow">for</span> (i = 0, b_f_ortho(f) = 1; i &lt; dimension; i++) if (dabs(X(i, 0)) &gt; 1e-8) <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, i) += X(i, 0);
      }
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; 100. * <a class="code" href="DoubleVect_8cpp.html#a07dd5e25d47ad3892ae0fa4e997ed011">mp_somme_vect</a>(b_f_ortho) / <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(<a class="code" href="classZone__VF.html#aede27992d9f2eedd52c24d4a80ff7ffb" title="renvoie le nombre global de faces.">nb_faces</a>()) &lt;&lt; <span class="stringliteral">&quot;% de faces orthocentrees&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;

  <span class="comment">/* 2. orthocentrage des elements */</span>
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>().<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;
  <span class="keywordflow">for</span> (e = 0; e &lt; <a class="code" href="classZone__dis__base.html#a4d6aa445f152aa6dc54d66ea7a071147">nb_elem_tot</a>(); e++)
    {
<span class="comment">// l&#39;element est-il deja orthocentre?</span>
      <span class="keywordtype">double</span> d2min = DBL_MAX, d2max = 0, d2;
      <span class="keywordflow">for</span> (i = 0, np = 0; i &lt; e_s.dimension(1) &amp;&amp; (s = e_s(e, i)) &gt;= 0; i++, np++)
        d2min = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(d2min, d2 = <a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;xs(s, 0), &amp;xs(s, 0), &amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(e, 0), &amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(e, 0))), d2max = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(d2max, d2);
      <span class="keywordflow">if</span> ((b_e_ortho(e) = (d2max / d2min - 1 &lt; 1e-8))) <span class="keywordflow">continue</span>;

<span class="comment">// pour qu&#39;on puisse l&#39;orthocentrer, il faut que ses faces le soient</span>
      <span class="keywordflow">for</span> (i = 0, j = 1; i &lt; e_f.dimension(1) &amp;&amp; (f = e_f(e, i)) &gt;= 0; i++) j = j &amp;&amp; b_f_ortho(f);
      <span class="keywordflow">if</span> (!j) <span class="keywordflow">continue</span>;

<span class="comment">// existe-il un orthocentre?</span>
      M.<a class="code" href="classIntTab.html#a22e6bed6826b3688d4d0181cbf3b7a38" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(np, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a> + 1), S.resize(np, 1);
      <span class="keywordflow">for</span> (i = 0; i &lt; np; i++) <span class="keywordflow">for</span> (j = 0, S(i, 0) = 0, M(i, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>) = 1; j &lt; <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; j++)
          S(i, 0) += 0.5 * std::pow(M(i, j) = xs(e_s(e, i), j) - <a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(e, j), 2);
      <span class="keywordflow">if</span> (<a class="code" href="Zone__CoviMAC_8h.html#acaf341ab8f98a1dbd4151f02dbd07e18">kersol</a>(M, S, 1e-12, NULL, X, vp) &gt; 1e-8) <span class="keywordflow">continue</span>; <span class="comment">//l&#39;element n&#39;a pas d&#39;orthocentre</span>

<span class="comment">// contrainte : ne pas diminuer la distance entre xp et chaque face de plus de 50%</span>
      <span class="keywordtype">double</span> rmin = DBL_MAX;
      <span class="keywordflow">for</span> (i = 0; i &lt; e_f.dimension(1) &amp;&amp; (f = e_f(e, i)) &gt;= 0; i++)
        rmin = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(rmin, <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(<a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;<a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(e, 0), &amp;nf(f, 0), &amp;<a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>(f, 0)) / fs(f)));
      <span class="keywordflow">if</span> (<a class="code" href="classZone__PolyMAC.html#a9a9034a4c1164e859f9bb5b20c6218cc">dot</a>(&amp;X(0, 0), &amp;X(0, 0)) &gt; 0.25 * rmin * rmin) <span class="keywordflow">continue</span>; <span class="comment">//on s&#39;eloigne trop du CG</span>

      <span class="keywordflow">for</span> (i = 0, b_e_ortho(e) = 1; i &lt; dimension; i++) if (dabs(X(i, 0)) &gt; 1e-8) <a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>(e, i) += X(i, 0);
    }
  <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; 100. * <a class="code" href="DoubleVect_8cpp.html#a07dd5e25d47ad3892ae0fa4e997ed011">mp_somme_vect</a>(b_e_ortho) / <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>()) &lt;&lt; <span class="stringliteral">&quot;% d&#39;elements orthocentres&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a68df324de334832c5dfc312e10e3132e"></a><!-- doxytag: member="Zone_PolyMAC::printOn" ref="a68df324de334832c5dfc312e10e3132e" args="(Sortie &amp;x) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSortie.html">Sortie</a> &amp; Zone_PolyMAC::printOn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSortie.html">Sortie</a> &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td> const<code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Surcharge <a class="el" href="classObjet__U.html#a68f520bd9ba3e848370861d6610720b5" title="Ecriture de l&#39;objet sur un flot de sortie Methode a surcharger.">Objet_U::printOn</a>(<a class="el" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp;)<br/>
NE FAIT RIEN<br/>
A surcharger dans les classes derivees.<br/>
Imprime la zone discretisee sur un flot de sortie. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp;<br/>
 Signification: le flot de sortie modifie<br/>
 Contraintes: </dd></dl>

<p><p>&lt; PQ : 12/10/05 : a voir ce qu'il faut faire ici ??? </p>
</p>

<p>Reimplemented from <a class="el" href="classZone__VF.html#ad766c03e736035233a249c9ee9c8efaf">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00110">110</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00207">h_carre</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00213">nb_elem_std_</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00212">nb_faces_std_</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00214">rang_elem_non_std_</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00209">type_elem_</a>, <a class="el" href="Zone__VF_8h_source.html#l00219">Zone_VF::volumes_entrelaces_</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, and <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00087">ecrit()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classZone__PolyMAC.html#a68df324de334832c5dfc312e10e3132e" title="Surcharge Objet_U::printOn(Sortie&amp;) NE FAIT RIEN A surcharger dans les classes derivees. Imprime la zone discretisee sur un flot de sortie.">Zone_VF::printOn</a>(os);

  os &lt;&lt; <a class="code" href="classZone__PolyMAC.html#a3122c86faa41d079ec3ed009a3c2136e" title="carre du pas du maillage">h_carre</a> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
  os &lt;&lt; <a class="code" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998" title="type de l&#39;element de discretisation">type_elem_</a> &lt;&lt; finl;
  os &lt;&lt; <a class="code" href="classZone__PolyMAC.html#a1d10485a5ee3b7b952e39ef12cb35416" title="nombre d&#39;elements standard">nb_elem_std_</a> &lt;&lt; finl;
  os &lt;&lt; <a class="code" href="classZone__VF.html#a4d84eafd75968d81d72275f240390ee8" title="volumes entrelaces pour l&#39;integration des Qdm">volumes_entrelaces_</a> &lt;&lt; finl;
  os &lt;&lt; <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a> &lt;&lt; finl;
  os &lt;&lt; <a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a> &lt;&lt; finl;
  os &lt;&lt; <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a> &lt;&lt; finl;
  os &lt;&lt; <a class="code" href="classZone__PolyMAC.html#a2b20af52d5cf15a8cfc12069ee7298b8" title="nombre de faces standard">nb_faces_std_</a> &lt;&lt; finl;
  os &lt;&lt; <a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a> &lt;&lt; finl;
  <span class="keywordflow">return</span> os;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9c96a79673cf23e19b30c9edba14ae5d"></a><!-- doxytag: member="Zone_PolyMAC::rang_elem_non_std" ref="a9c96a79673cf23e19b30c9edba14ae5d" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classIntVect.html">IntVect</a> &amp; Zone_PolyMAC::rang_elem_non_std </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00279">279</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00214">rang_elem_non_std_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a997edb83d05d02d970f88ad60b8086c0"></a><!-- doxytag: member="Zone_PolyMAC::rang_elem_non_std" ref="a997edb83d05d02d970f88ad60b8086c0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntVect.html">IntVect</a> &amp; Zone_PolyMAC::rang_elem_non_std </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00273">273</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00214">rang_elem_non_std_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a069179df5a26299b9d2f3e0c348e5adc"></a><!-- doxytag: member="Zone_PolyMAC::readOn" ref="a069179df5a26299b9d2f3e0c348e5adc" args="(Entree &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEntree.html">Entree</a> &amp; Zone_PolyMAC::readOn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEntree.html">Entree</a> &amp;&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Surcharge <a class="el" href="classObjet__U.html#a6f4c7788efee2dce629ebd1628b73288" title="Lecture d&#39;un Objet_U sur un flot d&#39;entree Methode a surcharger.">Objet_U::readOn</a>(<a class="el" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp;)<br/>
NE FAIT RIEN<br/>
A surcharger dans les classes derivees.<br/>
Lit une zone discretisee a partir d'un flot d'entree. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp;<br/>
 Signification: le flot d'entree modifie<br/>
 Contraintes: </dd></dl>

<p>Reimplemented from <a class="el" href="classZone__VF.html#a09b53ec3f4d05c40c866fd396952c2eb">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00129">129</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">face_normales_</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00207">h_carre</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00213">nb_elem_std_</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00212">nb_faces_std_</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00214">rang_elem_non_std_</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00209">type_elem_</a>, <a class="el" href="Zone__VF_8h_source.html#l00219">Zone_VF::volumes_entrelaces_</a>, <a class="el" href="Zone__VF_8h_source.html#l00234">Zone_VF::xp_</a>, and <a class="el" href="Zone__VF_8h_source.html#l00235">Zone_VF::xv_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classZone__PolyMAC.html#a069179df5a26299b9d2f3e0c348e5adc" title="Surcharge Objet_U::readOn(Sortie&amp;) NE FAIT RIEN A surcharger dans les classes derivees. Lit une zone discretisee a partir d&#39;un flot d&#39;entree.">Zone_VF::readOn</a>(is);
  is &gt;&gt; <a class="code" href="classZone__PolyMAC.html#a3122c86faa41d079ec3ed009a3c2136e" title="carre du pas du maillage">h_carre</a>;
  is &gt;&gt; <a class="code" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998" title="type de l&#39;element de discretisation">type_elem_</a>;
  is &gt;&gt; <a class="code" href="classZone__PolyMAC.html#a1d10485a5ee3b7b952e39ef12cb35416" title="nombre d&#39;elements standard">nb_elem_std_</a> ;
  is &gt;&gt; <a class="code" href="classZone__VF.html#a4d84eafd75968d81d72275f240390ee8" title="volumes entrelaces pour l&#39;integration des Qdm">volumes_entrelaces_</a> ;
  is &gt;&gt; <a class="code" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f" title="normales aux faces">face_normales_</a> ;
  is &gt;&gt; <a class="code" href="classZone__VF.html#ae0dc3dc379de71f9d99115ab6973f0f6" title="centres de gravite des elements">xp_</a>;
  is &gt;&gt; <a class="code" href="classZone__VF.html#a30d5c38f1825d8d35ce9c83aa37e5aa6" title="centres de gravite des faces">xv_</a>;
  is &gt;&gt; <a class="code" href="classZone__PolyMAC.html#a2b20af52d5cf15a8cfc12069ee7298b8" title="nombre de faces standard">nb_faces_std_</a> ;
  is &gt;&gt; <a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a> ;
  <span class="keywordflow">return</span> is;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a21406240dca3cd30ed879b82f4a97631"></a><!-- doxytag: member="Zone_PolyMAC::remplir_elem_faces" ref="a21406240dca3cd30ed879b82f4a97631" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::remplir_elem_faces </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [private, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classZone__VF.html#a03f908e0365f9afa24ddcdb52cb194cc">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00726">726</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00830">creer_faces_virtuelles_non_std()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="classZone__PolyMAC.html#aac86d6f78066fe8fb87d7d39d5794474" title="creation de l&#39;espace distant pour les faces virtuelles; creation du tableau des faces virtuelles de b...">creer_faces_virtuelles_non_std</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad9f8344b5967eb8bdbf9b36e569fd69a"></a><!-- doxytag: member="Zone_PolyMAC::reordonner" ref="ad9f8344b5967eb8bdbf9b36e569fd69a" args="(Faces &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::reordonner </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFaces.html">Faces</a> &amp;&#160;</td>
          <td class="paramname"><em>les_faces</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Methode appelee par <a class="el" href="classZone__VF.html#ab147799e94c91fc4b18b190cdd3dbd0a" title="Genere les faces construits les frontieres.">Zone_VF::discretiser</a> apres la creation<br/>
des faces reelles.<br/>
On reordonne les faces de sorte a placer les faces "non standard"<br/>
au debut de la liste des faces. Les faces non standard sont celles<br/>
dont les volumes de controles sont modifies par les conditions aux<br/>
limites. </p>

<p><p>&lt; renum_items_communs rempli ?</p>
<p>&lt; ancien indice local </p>
</p>

<p>Reimplemented from <a class="el" href="classZone__VF.html#a1a4e88b7d72866d3c06582ff4fe0cf90">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00156">156</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Domaine_8cpp_source.html#l00450">Domaine::creer_tableau_elements()</a>, <a class="el" href="IntTab_8h_source.html#l00233">IntTab::dimension()</a>, <a class="el" href="Zone_8cpp_source.html#l00262">Zone::domaine()</a>, <a class="el" href="IntVect_8cpp_source.html#l00276">IntVect::echange_espace_virtuel()</a>, <a class="el" href="Zone__VF_8h_source.html#l00238">Zone_VF::elem_faces_</a>, <a class="el" href="Joint_8h_source.html#l00066">Joint::FACE</a>, <a class="el" href="Zone_8h_source.html#l01098">Zone::faces_joint()</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Frontiere_8h_source.html#l00212">Frontiere::fixer_num_premiere_face()</a>, <a class="el" href="Process_8cpp_source.html#l00095">Process::je_suis_maitre()</a>, <a class="el" href="Faces_8h_source.html#l00268">Faces::les_sommets()</a>, <a class="el" href="Zone__dis__base_8h_source.html#l00140">Zone_dis_base::nb_elem()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00213">nb_elem_std_</a>, <a class="el" href="Frontiere_8h_source.html#l00114">Frontiere::nb_faces()</a>, <a class="el" href="Faces_8h_source.html#l00152">Faces::nb_faces()</a>, <a class="el" href="Zone_8h_source.html#l01240">Zone::nb_faces_frontiere()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00212">nb_faces_std_</a>, <a class="el" href="ArrOfInt_8cpp_source.html#l00897">ArrOfInt::ordonne_array()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00214">rang_elem_non_std_</a>, <a class="el" href="Joint__Items_8cpp_source.html#l00056">Joint_Items::set_items_communs()</a>, <a class="el" href="Joint_8cpp_source.html#l00159">Joint::set_joint_item()</a>, <a class="el" href="liste_8cpp_source.html#l00175">liste::size()</a>, <a class="el" href="IntVect_8h_source.html#l00139">IntVect::size()</a>, <a class="el" href="ArrOfInt_8h_source.html#l00342">ArrOfInt::size_array()</a>, <a class="el" href="IntVect_8h_source.html#l00145">IntVect::size_totale()</a>, <a class="el" href="Faces_8h_source.html#l00293">Faces::voisin()</a>, <a class="el" href="Faces_8h_source.html#l00375">Faces::voisins()</a>, and <a class="el" href="Zone__dis__base_8h_source.html#l00106">Zone_dis_base::zone()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
    <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Zone_PolyMAC::reordonner les_faces &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;

<span class="comment">// Construction de rang_elem_non_std_ :</span>
<span class="comment">// C&#39;est un vecteur indexe par les elements du domaine.</span>
<span class="comment">// size() = nb_elem()</span>
<span class="comment">// size_tot() = nb_elem_tot()</span>
<span class="comment">// Valeurs dans le tableau :</span>
<span class="comment">// rang_elem_non_std_[i] = -1 si l&#39;element i est standard,</span>
<span class="comment">// sinon</span>
<span class="comment">// rang_elem_non_std_[i] = j, ou j est l&#39;indice de l&#39;element dans</span>
<span class="comment">// les tableaux indexes par les elements non standards (par exemple</span>
<span class="comment">// le tableau Zone_Cl_PolyMAC::type_elem_Cl_).</span>
<span class="comment">// Un element est non standard s&#39;il est voisin d&#39;une face frontiere.</span>
  {
    <span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a379ad2206b5a13a4f4f3df6d44c7546a" title="Renvoie le domaine dont la zone fait partie. (version const)">domaine</a>();
    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elements = <a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>();
    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_front = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#adb3970b0289aa1b0a38772011fd5d915" title="Renvoie le nombre de faces frontiere de la zone du type specifie. C&#39;est la somme des nombres de bords...">nb_faces_frontiere</a>();
    dom.<a class="code" href="classDomaine.html#a5d820427207d7534f4993971b98630f0" title="Cree un tableau ayant une &quot;ligne&quot; par element du maillage. Pour l&#39;instant, erreur s&#39;il y a plus d&#39;u...">creer_tableau_elements</a>(<a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a>);
<span class="comment">// rang_elem_non_std_.resize(nb_elements);</span>
<span class="comment">// Scatter::creer_tableau_distribue(dom, Joint::ELEMENT, rang_elem_non_std_);</span>
    <a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a> = -1;
    <span class="keywordtype">int</span> nb_elems_non_std = 0;
<span class="comment">// D&#39;abord on marque les elements non standards avec rang_elem_non_std_[i] = 0</span>
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_face = 0; i_face &lt; nb_faces_front; i_face++)
      {
        <span class="keyword">const</span> <span class="keywordtype">int</span> elem = les_faces.<a class="code" href="classFaces.html#aa4c932a03838b3ee81d00e3359379933" title="Renvoie le numero du i-ieme voisin de face.">voisin</a>(i_face, 0);
        <span class="keywordflow">if</span> (<a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a>[elem] &lt; 0)
          {
            <a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a>[elem] = 0;
            nb_elems_non_std++;
          }
      }
    <a class="code" href="classZone__PolyMAC.html#a1d10485a5ee3b7b952e39ef12cb35416" title="nombre d&#39;elements standard">nb_elem_std_</a> = nb_elements - nb_elems_non_std;
    <a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a>.<a class="code" href="classIntVect.html#ad12bea67621d1a0ee82b27c9a37ca4ef">echange_espace_virtuel</a>();
    <span class="keywordtype">int</span> count = 0;
    <span class="keyword">const</span> <span class="keywordtype">int</span> size_tot = <a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a>.<a class="code" href="classIntVect.html#afa716e1f0a1f0f74f4f73e95b5651412" title="Identique a size_array()">size_totale</a>();
<span class="comment">// On remplace le marqueur &quot;0&quot; par l&#39;indice j.</span>
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem = 0; elem &lt; size_tot; elem++)
      {
        <span class="keywordflow">if</span> (<a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a>[elem] == 0)
          {
            <a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a>[elem] = count;
            count++;
          }
      }
  }

<span class="comment">// Construction du tableau de renumerotation des faces. Ce tableau,</span>
<span class="comment">// une fois trie dans l&#39;ordre croissant donne l&#39;ordre des faces dans</span>
<span class="comment">// la zone_VF. La cle de tri est construite de sorte a pouvoir retrouver</span>
<span class="comment">// l&#39;indice de la face a partir de la cle par la formule :</span>
<span class="comment">// indice_face = cle % nb_faces</span>
  <span class="keyword">const</span> <span class="keywordtype">int</span> nbfaces = les_faces.<a class="code" href="classFaces.html#a64d898edb20c3687d357018f1821c50a" title="Renvoie le nombre de Faces.">nb_faces</a>();
  <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> sort_key(nbfaces);
  {
    <a class="code" href="classZone__PolyMAC.html#a2b20af52d5cf15a8cfc12069ee7298b8" title="nombre de faces standard">nb_faces_std_</a> =0;
    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_faces_front = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#adb3970b0289aa1b0a38772011fd5d915" title="Renvoie le nombre de faces frontiere de la zone du type specifie. C&#39;est la somme des nombres de bords...">nb_faces_frontiere</a>();
<span class="comment">// Attention : face_voisins_ n&#39;est pas encore initialise, il</span>
<span class="comment">// faut passer par les_faces.voisins() :</span>
    <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; facevoisins = les_faces.<a class="code" href="classFaces.html#af49c4448e67aa7c732c2cc1dc237b442" title="Renvoie le tableau des voisins (des faces).">voisins</a>();
<span class="comment">// On place en premier les faces de bord:</span>
    <span class="keywordtype">int</span> i_face;
    <span class="keywordflow">for</span> (i_face = 0; i_face &lt; nbfaces; i_face++)
      {
        <span class="keywordtype">int</span> key = -1;
        <span class="keywordflow">if</span> (i_face &lt; nb_faces_front)
          {
<span class="comment">// Si la face est au bord, elle doit etre placee au debut</span>
<span class="comment">// (en fait elle ne doit pas etre renumerotee)</span>
            key = i_face;
          }
        <span class="keywordflow">else</span>
          {
            <span class="keyword">const</span> <span class="keywordtype">int</span> elem0 = facevoisins(i_face, 0);
            <span class="keyword">const</span> <span class="keywordtype">int</span> elem1 = facevoisins(i_face, 1);
<span class="comment">// Ces faces ont toujours deux voisins.</span>
            assert(elem0 &gt;= 0 &amp;&amp; elem1 &gt;= 0);
            <span class="keywordflow">if</span> (<a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a>[elem0] &gt;= 0 || <a class="code" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b" title="rang_elem_non_std_= -1 si l&#39;element est standard rang_elem_non_std_= rang de l&#39;element dans les table...">rang_elem_non_std_</a>[elem1] &gt;= 0)
              {
<span class="comment">// Si la face est voisine d&#39;un element non standard, elle</span>
<span class="comment">// doit etre classee juste apres les faces de bord:</span>
                key = i_face;
              }
            <span class="keywordflow">else</span>
              {
<span class="comment">// Face standard : a la fin du tableau</span>
                key = i_face + nbfaces;
                <a class="code" href="classZone__PolyMAC.html#a2b20af52d5cf15a8cfc12069ee7298b8" title="nombre de faces standard">nb_faces_std_</a>++;
              }
          }
        sort_key[i_face] = key;
      }
    sort_key.ordonne_array();

<span class="comment">// On transforme a nouveau la cle en numero de face:</span>
    <span class="keywordflow">for</span> (i_face = 0; i_face &lt; nbfaces; i_face++)
      {
        <span class="keyword">const</span> <span class="keywordtype">int</span> key = sort_key[i_face] % nbfaces;
        sort_key[i_face] = key;
      }
  }
<span class="comment">// On reordonne les faces:</span>
  {
    <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_sommets = les_faces.<a class="code" href="classFaces.html#a07b8d8db9e3d656b93a21a49c063430c">les_sommets</a>();
    <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> old_tab(faces_sommets);
    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_som_faces = faces_sommets.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbfaces; i++)
      {
        <span class="keyword">const</span> <span class="keywordtype">int</span> old_i = sort_key[i];
        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_som_faces; j++)
          faces_sommets(i, j) = old_tab(old_i, j);
      }
  }

  {
    <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_voisins = les_faces.<a class="code" href="classFaces.html#af49c4448e67aa7c732c2cc1dc237b442" title="Renvoie le tableau des voisins (des faces).">voisins</a>();
    <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a> old_tab(faces_voisins);
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbfaces; i++)
      {
        <span class="keyword">const</span> <span class="keywordtype">int</span> old_i = sort_key[i];
        faces_voisins(i, 0) = old_tab(old_i, 0);
        faces_voisins(i, 1) = old_tab(old_i, 1);
      }
  }

<span class="comment">// Calcul de la table inversee: reverse_index[ancien_numero] = nouveau numero</span>
  <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> reverse_index(nbfaces);
  {
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbfaces; i++)
      {
        <span class="keyword">const</span> <span class="keywordtype">int</span> j = sort_key[i];
        reverse_index[j] = i;
      }
  }
<span class="comment">// Renumerotation de elem_faces:</span>
  {
<span class="comment">// Nombre d&#39;indices de faces dans le tableau</span>
    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_items = <a class="code" href="classZone__VF.html#acd9376481d4268df6a0c394c5a1a0e61" title="connectivite element/faces">elem_faces_</a>.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>();
    <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; array = <a class="code" href="classZone__VF.html#acd9376481d4268df6a0c394c5a1a0e61" title="connectivite element/faces">elem_faces_</a>;
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_items; i++)
      {
        <span class="keyword">const</span> <span class="keywordtype">int</span> old = array[i];
        <span class="keywordflow">if</span> (old&lt;0)
          array[i] = -1;
        <span class="keywordflow">else</span>
          array[i] = reverse_index[old];
      }
  }
<span class="comment">// Mise a jour des indices des faces de joint:</span>
  {
    <a class="code" href="classJoints.html" title="Classe Joints Cette classe represente une liste d&#39;objet de type Joint.">Joints</a>&amp;      joints    = <a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>().<a class="code" href="classZone.html#a16f273a76321d31435995cdad664285a" title="Renvoie la liste des joints de la zone. (version const)">faces_joint</a>();
    <span class="keyword">const</span> <span class="keywordtype">int</span> nbjoints = joints.<a class="code" href="classliste.html#ab47f280662ff68f9aa2e00e50431c5dc" title="Renvoie la taille de la liste Une liste vide est de taille nulle.">size</a>();
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_joint = 0; i_joint &lt; nbjoints; i_joint++)
      {
        <a class="code" href="classJoint.html" title="La classe Joint est une Frontiere qui contient les faces et les sommets de joint avec la zone PEvoisi...">Joint</a>&amp;     un_joint         = joints[i_joint];
        <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a>&amp; indices_faces = un_joint.<a class="code" href="classJoint.html#aa1c4d729a3017082d26907d82ad1d7de" title="Renvoie les informations de joint pour un type d&#39;item geometrique donne, pour remplissage des structu...">set_joint_item</a>(<a class="code" href="classJoint.html#a1e2d15d088c27c9b7b11c02bf4d2c926ab255b88987fc7f64c215c958cbe2af6b">Joint::FACE</a>).<a class="code" href="classJoint__Items.html#aa01c4601d506c658f4f1d45e66951ce0" title="Renvoie le tableau items_communs_ pour le remplir. (BM: ce tableau n&#39;est pas encore rempli)...">set_items_communs</a>();
        <span class="keyword">const</span> <span class="keywordtype">int</span> nbfaces2    = indices_faces.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
        assert(nbfaces2 == un_joint.<a class="code" href="classFrontiere.html#aa073fe9dbdddde59471ee7032b256aa2" title="Renvoie le nombre de faces de la frontiere.">nb_faces</a>()); <span class="comment">//!&lt; renum_items_communs rempli ?</span>
<span class="comment"></span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nbfaces2; i++)
          {
            <span class="keyword">const</span> <span class="keywordtype">int</span> old = indices_faces[i]; <span class="comment">//!&lt; ancien indice local</span>
<span class="comment"></span>            indices_faces[i] = reverse_index[old];
          }
<span class="comment">// Les faces de joint ne sont plus consecutives dans le</span>
<span class="comment">// tableau: num_premiere_face n&#39;a plus ne sens</span>
        un_joint.<a class="code" href="classFrontiere.html#a66cbd407fb5a1611b9aca04bddd0f6e0">fixer_num_premiere_face</a>(-1);
      }
  }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a84b5198bad81ebede71ab205c73af3bc"></a><!-- doxytag: member="Zone_PolyMAC::self_cast" ref="a84b5198bad81ebede71ab205c73af3bc" args="(const Objet_U &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classZone__PolyMAC.html">Zone_PolyMAC</a> &amp; Zone_PolyMAC::self_cast </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classObjet__U.html">Objet_U</a> &amp;&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>methode ajoutee pour caster en python </p>

<p>Reimplemented from <a class="el" href="classZone__VF.html#a3f216efbb86dd88096724101ec1d86bb">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00081">81</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab8c53d341136866fa5c7d254d9e4a723"></a><!-- doxytag: member="Zone_PolyMAC::self_cast" ref="ab8c53d341136866fa5c7d254d9e4a723" args="(Objet_U &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classZone__PolyMAC.html">Zone_PolyMAC</a> &amp; Zone_PolyMAC::self_cast </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classObjet__U.html">Objet_U</a> &amp;&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classZone__VF.html#aab8e045407de06836912fd873b272d2e">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00081">81</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a807c2e05fffa2b4cc2518c0e68855ed3"></a><!-- doxytag: member="Zone_PolyMAC::swap" ref="a807c2e05fffa2b4cc2518c0e68855ed3" args="(int, int, int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::swap </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fac1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fac2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nb_som_faces</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00144">144</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>.</p>
<div class="fragment"><pre class="fragment">{

}
</pre></div>
</div>
</div>
<a class="anchor" id="a731aa21d100f00b42b6830ed66baa103"></a><!-- doxytag: member="Zone_PolyMAC::ta" ref="a731aa21d100f00b42b6830ed66baa103" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classDoubleTab.html">DoubleTab</a>&amp; Zone_PolyMAC::ta </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00122">122</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00224">ta_</a>.</p>

<p>Referenced by <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00186">Champ_Face_PolyMAC::init_ra()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00236">Champ_Face_PolyMAC::init_va()</a>.</p>
<div class="fragment"><pre class="fragment">  {
    <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#a280bc522cc5b57552bb9dcfbdd1493c5">ta_</a>;
  };
</pre></div>
</div>
</div>
<a class="anchor" id="a977b928653c1dd9244a55c875a8f07d7"></a><!-- doxytag: member="Zone_PolyMAC::taille_memoire" ref="a977b928653c1dd9244a55c875a8f07d7" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned Zone_PolyMAC::taille_memoire </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classObjet__U.html#a0ee0946339f09a2c73c09fcda71c3be2">Objet_U</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00081">81</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a369ea15b260f758e13bcdc5385460426"></a><!-- doxytag: member="Zone_PolyMAC::type_elem" ref="a369ea15b260f758e13bcdc5385460426" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classElem__PolyMAC.html">Elem_PolyMAC</a> &amp; Zone_PolyMAC::type_elem </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00231">231</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__PolyMAC_8h_source.html#l00209">type_elem_</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00671">calculer_h_carre()</a>, and <a class="el" href="PolyMAC__discretisation_8cpp_source.html#l00311">PolyMAC_discretisation::vorticite()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998" title="type de l&#39;element de discretisation">type_elem_</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="add58bbb3309b38e7710b404c0525c0f0"></a><!-- doxytag: member="Zone_PolyMAC::typer_elem" ref="add58bbb3309b38e7710b404c0525c0f0" args="(Zone &amp;zone_geom)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Zone_PolyMAC::typer_elem </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classZone.html">Zone</a> &amp;&#160;</td>
          <td class="paramname"><em>zone_geom</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classZone__VF.html#a69f32512c6e83973c5bc1e9021adeabd">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00329">329</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="Objet__U_8cpp_source.html#l00132">Objet_U::que_suis_je()</a>, <a class="el" href="Cast_8h_source.html#l00054">sub_type</a>, <a class="el" href="Zone_8h_source.html#l00491">Zone::type_elem()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00209">type_elem_</a>, <a class="el" href="Elem__PolyMAC_8cpp_source.html#l00063">Elem_PolyMAC::typer()</a>, <a class="el" href="Zone_8h_source.html#l00639">Zone::typer()</a>, and <a class="el" href="Elem__geom_8h_source.html#l00044">Deriv_Elem_geom_base::valeur()</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">const</span> <a class="code" href="classElem__geom__base.html" title="Classe Elem_geom_base Cette classe est la classe de base pour la definition d&#39;elements geometriques c...">Elem_geom_base</a>&amp; type_elem_geom = zone_geom.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classDeriv__Elem__geom__base.html#a384b487459a33f9f521fb16539ec81de">valeur</a>();

  <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classRectangle.html" title="Classe Rectangle Cette classe represente l&#39;element geometrique Rectangle. Un rectangle a 4 faces...">Rectangle</a>,type_elem_geom))
    {
      zone_geom.<a class="code" href="classZone.html#ac1ff391994a372815b7f88c3fdc39f55" title="Type les elements de la zone avec le nom passe en parametre. Et associe le type d&#39;element a la zone...">typer</a>(<span class="stringliteral">&quot;Quadrangle&quot;</span>);
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classHexaedre.html" title="Classe Hexaedre Cette represente un element geometrique a 6 faces, 8 sommets et un seul type de face ...">Hexaedre</a>,type_elem_geom))
    zone_geom.<a class="code" href="classZone.html#ac1ff391994a372815b7f88c3fdc39f55" title="Type les elements de la zone avec le nom passe en parametre. Et associe le type d&#39;element a la zone...">typer</a>(<span class="stringliteral">&quot;Hexaedre_VEF&quot;</span>);

  <span class="keyword">const</span> <a class="code" href="classElem__geom__base.html" title="Classe Elem_geom_base Cette classe est la classe de base pour la definition d&#39;elements geometriques c...">Elem_geom_base</a>&amp; elem_geom = zone_geom.<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classDeriv__Elem__geom__base.html#a384b487459a33f9f521fb16539ec81de">valeur</a>();
  <a class="code" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998" title="type de l&#39;element de discretisation">type_elem_</a>.<a class="code" href="classElem__PolyMAC.html#a2024eb07f5d123b2e5ba4539c362d27a" title="determination du type">typer</a>(elem_geom.<a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>());
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1ae045bb171677252d0b51c94c996644"></a><!-- doxytag: member="Zone_PolyMAC::volumes_entrelaces_dir" ref="a1ae045bb171677252d0b51c94c996644" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Zone_PolyMAC::volumes_entrelaces_dir </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classZone__VF.html#a24e4ad17ae5192e2fe9f5dcf0edc567a">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00266">266</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__VF_8h_source.html#l00220">Zone_VF::volumes_entrelaces_dir_</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3136412dd13e1120b72758b8a5013a10"></a><!-- doxytag: member="Zone_PolyMAC::volumes_entrelaces_dir" ref="a3136412dd13e1120b72758b8a5013a10" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp; Zone_PolyMAC::volumes_entrelaces_dir </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classZone__VF.html#a6440349307402c7d9bef3d2a1d104412">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00259">259</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>References <a class="el" href="Zone__VF_8h_source.html#l00220">Zone_VF::volumes_entrelaces_dir_</a>.</p>

<p>Referenced by <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00127">Op_Conv_EF_Stab_PolyMAC_Face::ajouter()</a>, and <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00173">Op_Conv_EF_Stab_PolyMAC_Face::contribuer_a_avec()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> <a class="code" href="classZone__VF.html#a40e71e7c7acb45cd7b7987d814e3701e" title="volumes entrelaces par cote">volumes_entrelaces_dir_</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="afadc655691d6d38cd9ac09a490221f47"></a><!-- doxytag: member="Zone_PolyMAC::W_stabiliser" ref="afadc655691d6d38cd9ac09a490221f47" args="(DoubleTab &amp;W, DoubleTab &amp;R, DoubleTab &amp;N, int *ctr, double *spectre) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Zone_PolyMAC::W_stabiliser </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDoubleTab.html">DoubleTab</a> &amp;&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ctr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>spectre</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00957">957</a> of file <a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a>.</p>

<p>References <a class="el" href="EntreeSortie_8h_source.html#l00032">Cerr</a>, <a class="el" href="Double_8h_source.html#l00255">dabs()</a>, <a class="el" href="Objet__U_8h_source.html#l00079">Objet_U::dimension</a>, <a class="el" href="DoubleTab_8h_source.html#l00243">DoubleTab::dimension()</a>, <a class="el" href="Process_8cpp_source.html#l00223">Process::exit()</a>, <a class="el" href="arch_8h_source.html#l00075">F77NAME</a>, <a class="el" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="el" href="Loi__horaire_8cpp_source.html#l00142">inverse()</a>, <a class="el" href="Double_8h_source.html#l00180">max()</a>, <a class="el" href="Double_8h_source.html#l00199">min()</a>, and <a class="el" href="DoubleTab_8cpp_source.html#l00335">DoubleTab::resize()</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01059">init_m2()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">int</span> i, j, k, l, n_f = R.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0), nv = 0, d = R.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1), infoo = 0, lwork = -1, sym, diag, ret, it, cv;

  <span class="comment">/* idx : numero de l&#39;inconnue W(i, j) dans le probleme d&#39;optimisation */</span>
<span class="comment">// si NtR est symetrique, alors on cherche a avoir W symetrique</span>
  <a class="code" href="classMatrice33.html" title="une matrice 3x3. Convention pour m(i,j): i est l&#39;indice de ligne, j l&#39;indice de colonne entre 0 et 2 ...">Matrice33</a> NtR(0, 0, 0, 0, d &lt; 2, 0, 0, 0, d &lt; 3), iNtR;
  <span class="keywordflow">for</span> (i = 0; i &lt; d; i++) <span class="keywordflow">for</span> (j = 0; j &lt; d; j++) <span class="keywordflow">for</span> (k = 0; k &lt; n_f; k++) NtR(i, j) += N(k, i) * R(k, j);
  <span class="keywordflow">for</span> (i = 0, sym = 1; i &lt; d; i++) <span class="keywordflow">for</span> (j = i + 1; j &lt; d; j++) sym &amp;= (<a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(NtR(i, j) - NtR(j, i)) &lt; 1e-8);
<span class="comment">// remplissage de idx(i, j) : numero de W_{ij} dans le pb d&#39;optimisation</span>
  <a class="code" href="classIntTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un IntTab avec allocation dans un pool de memoire gere...">IntTrav</a> idx(n_f, n_f);
  <span class="keywordflow">if</span> (sym) <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++) <span class="keywordflow">for</span> (j = i; j &lt; n_f; j++) idx(i, j) = idx(j, i) = (W(i, j) ? nv++ : -1);
  <span class="keywordflow">else</span> <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++) <span class="keywordflow">for</span> (j = 0; j &lt; n_f; j++) idx(i, j) = (W(i, j) ? nv++ : -1);

  <span class="comment">/* version non stabilisee : W0 = N.(NtR)^-1.Nt */</span>
  <a class="code" href="Loi__horaire_8cpp.html#a3419dc9c5aa47723b8e50bdfe0aa264a">Matrice33::inverse</a>(NtR, iNtR); <span class="comment">//crash si NtR non inversible</span>
  <span class="keywordflow">for</span> (i = 0, W = 0; i &lt; n_f; i++) <span class="keywordflow">for</span> (j = 0; j &lt; d; j++) <span class="keywordflow">for</span> (k = 0; k &lt; d; k++) <span class="keywordflow">for</span> (l = 0; l &lt; n_f; l++) W(i, l) += N(i, j) * iNtR(j, k) * N(l, k);
<span class="comment">// spectre de Ws (partie symetrique de W)</span>
  <a class="code" href="classDoubleTrav.html" title="Tableau de travail a n entrees pour n&lt;= 4 C&#39;est un DoubleTab avec allocation dans un pool de memoire g...">DoubleTrav</a> Ws(n_f, n_f), S(n_f), work(1);
  <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++) <span class="keywordflow">for</span> (j = 0; j &lt; n_f; j++) Ws(i, j) = (W(i, j) + W(j, i)) / 2;
  <span class="keywordtype">char</span> jobz = <span class="charliteral">&#39;N&#39;</span>, uplo = <span class="charliteral">&#39;U&#39;</span>;
  <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(dsyev)(&amp;jobz, &amp;uplo, &amp;n_f, &amp;Ws(0, 0), &amp;n_f, &amp;S(0), &amp;work(0), &amp;lwork, &amp;infoo);<span class="comment">//&quot;workspace query&quot;</span>
  work.resize(lwork = work(0));
  <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(dsyev)(&amp;jobz, &amp;uplo, &amp;n_f, &amp;Ws(0, 0), &amp;n_f, &amp;S(0), &amp;work(0), &amp;lwork, &amp;infoo);<span class="comment">//vrai appel</span>
  assert(S(0) &gt; -1e-8 &amp;&amp; S(n_f - <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>) &gt; 0);
  <span class="keywordflow">if</span> (spectre) spectre[0] = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(spectre[0], S(n_f - <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>)), spectre[2] = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(spectre[2], S(n_f - 1));
<span class="comment">// bornes sur le spectre de la matrice finale</span>
  <span class="keywordtype">double</span> l_min = S(n_f - <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>) / 10, l_max = S(n_f - 1) * 10;

  <span class="comment">/* probleme d&#39;optimisation : sur les W_{ij} autorises */</span>
  OSQPData data;
  OSQPSettings settings;
  osqp_set_default_settings(&amp;settings);
  settings.scaled_termination = 1, settings.polish = 1, settings.eps_abs = settings.eps_rel = 1e-8, settings.max_iter = 1e3;

  <span class="comment">/* contrainte : W.R = N */</span>
  std::vector&lt;std::map&lt;int, double&gt;&gt; C(nv); <span class="comment">//stockage CSC : C[j][i] = M_{ij}</span>
  std::vector&lt;double&gt; lb, ub; <span class="comment">//bornes inf/sup</span>
  <span class="keywordtype">int</span> il = 0; <span class="comment">//suivi de la ligne qu&#39;on est en train de creer</span>
  <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++) <span class="keywordflow">for</span> (j = 0; j &lt; d; j++, il++) <span class="keywordflow">for</span> (k = 0, lb.push_back(N(i, j)), ub.push_back(N(i, j)); k &lt; n_f; k++)
        <span class="keywordflow">if</span> (idx(i, k) &gt;= 0) C[idx(i, k)][il] += R(k, j);

  <span class="comment">/* objectif: minimiser la norme l2 des termes hors diagonale */</span>
  std::vector&lt;int&gt; P_c(nv + 1), P_l(nv), A_c, A_l; <span class="comment">//coeffs de la colonne c : indices [P_c(c), P_c(c + 1)[ dans P_l, P_v</span>
  std::vector&lt;double&gt; P_v(nv), A_v, Q(nv, 0.);
  <span class="keywordflow">for</span> (i = 0; i &lt; nv; i++) P_l[i] = i, P_c[i + 1] = i + 1;
  <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++) for (j = 0; j &lt; n_f; j++) if (idx(i, j) &gt;= 0) P_v[idx(i, j)] += (i == j ? 1e-2 : 1);
  data.n = nv, data.P = csc_matrix(nv, nv, P_v.size(), P_v.data(), P_l.data(), P_c.data()), data.q = Q.data();

<span class="comment">// iterations : on resout et on ajoute des contraintes tant que W a un spectre hors de [l_min, l_max]</span>
  std::fenv_t fenv;
  std::feholdexcept(&amp;fenv); <span class="comment">//suspend les exceptions FP</span>
  std::vector&lt;double&gt; sol(nv);
  <span class="keywordflow">for</span> (cv = 0, it = 0; !cv &amp;&amp; it &lt; 100; it++)
    {
      <span class="comment">/* assemblage de A : matrice des contraintes */</span>
      <span class="keywordflow">for</span> (j = 0, A_c.resize(1), A_l.resize(0), A_v.resize(0); j &lt; nv; j++, A_c.push_back(A_l.size()))
        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;&amp; l_v : C[j]) A_l.push_back(l_v.first), A_v.push_back(l_v.second);
      data.A = csc_matrix(lb.size(), nv, A_v.size(), A_v.data(), A_l.data(), A_c.data());
      data.l = lb.data(), data.u = ub.data(), data.m = lb.size();

      <span class="comment">/* resolution  */</span>
      OSQPWorkspace *osqp = NULL;
      <span class="keywordflow">if</span> (osqp_setup(&amp;osqp, &amp;data, &amp;settings)) <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Zone_PolyMAC::W_stabiliser : osqp_setup error&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>, <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
      <span class="keywordflow">if</span> (it) osqp_warm_start_x(osqp, sol.data()); <span class="comment">//repart de l&#39;iteration precedente</span>
      osqp_solve(osqp);
      ret = osqp-&gt;info-&gt;status_val, sol.assign(osqp-&gt;solution-&gt;x, osqp-&gt;solution-&gt;x + nv);
      <span class="keywordflow">if</span> (ret == OSQP_PRIMAL_INFEASIBLE || ret == OSQP_PRIMAL_INFEASIBLE_INACCURATE)
        {
          osqp_cleanup(osqp), free(data.A);
          <span class="keywordflow">break</span>;
        }
      <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++) for (j = 0; j &lt; n_f; j++) W(i, j) = (idx(i, j) &gt;= 0 ? sol[idx(i, j)] : 0);

      <span class="comment">/* calcul du spectre : Ws recupere les vecteurs propres */</span>
      <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++) <span class="keywordflow">for</span> (j = 0; j &lt; n_f; j++) Ws(i, j) = (W(i, j) + W(j, i)) / 2;
      jobz = <span class="charliteral">&#39;V&#39;</span>, <a class="code" href="arch_8h.html#a9b91c72ded7de2f0b393ea75de53929b">F77NAME</a>(dsyev)(&amp;jobz, &amp;uplo, &amp;n_f, &amp;Ws(0, 0), &amp;n_f, &amp;S(0), &amp;work(0), &amp;lwork, &amp;infoo);

      <span class="comment">/* pour chaque vp sortant de [ l_min, l_max ], on ajoute une contrainte pour la restreindre a [l_min * 1.1, l_max / 1.1 ] */</span>
      <span class="keywordflow">for</span> (i = 0, cv = (osqp-&gt;info-&gt;status_val == OSQP_SOLVED); i &lt; n_f; i++) if (S(i) &lt; l_min || S(i) &gt; l_max)
          {
            <span class="keywordflow">for</span> (j = 0; j &lt; n_f; j++) for (k = 0; k &lt; n_f; k++) if(idx(j, k) &gt;= 0) C[idx(j, k)][il]  += Ws(i, j) * Ws(i, k);
            lb.push_back(l_min * (S(i) &lt; l_min ? 1.1 : 1)), ub.push_back(l_max / (S(i) &gt; l_max ? 1.1 : 1));
            cv = 0, il++; <span class="comment">//on repart avec une ligne en plus</span>
          }
      osqp_cleanup(osqp), free(data.A);
    }
  free(data.P);
  std::fesetenv(&amp;fenv);     <span class="comment">//remet les exceptions FP</span>

  <span class="keywordflow">if</span> (!cv) <span class="keywordflow">return</span> 0; <span class="comment">//ca passe ou ca casse</span>
  <span class="keywordflow">if</span> (spectre) <span class="keywordflow">for</span> (i = 0; i &lt; n_f; i++) spectre[1] = <a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">min</a>(spectre[1], S(i)), spectre[3] = <a class="code" href="Double_8h.html#a1c45761573e6cbc97cfacac78d905016">max</a>(spectre[3], S(i));

<span class="comment">// statistiques</span>
<span class="comment">// ctr[0] : diagonale, ctr[1] : symetrique</span>
  <span class="keywordflow">for</span> (i = 0, diag = 1; i &lt; n_f; i++) <span class="keywordflow">for</span> (j = 0; j &lt; n_f; j++) diag &amp;= (i == j || <a class="code" href="Double_8h.html#aaecd4ca8a2fe69cc6568af2938b94d2e">dabs</a>(W(i, j)) &lt; 1e-6);
  ctr[0] += diag, ctr[1] += sym;
  <span class="keywordflow">return</span> 1;
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a1214dca84091e8bc3f48b17465437986"></a><!-- doxytag: member="Zone_PolyMAC::arete_faces_" ref="a1214dca84091e8bc3f48b17465437986" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#a1214dca84091e8bc3f48b17465437986">Zone_PolyMAC::arete_faces_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00223">223</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8h_source.html#l00126">arete_faces()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01180">init_we()</a>.</p>

</div>
</div>
<a class="anchor" id="a632f8cc11df954d566c97bbf177ae6ad"></a><!-- doxytag: member="Zone_PolyMAC::cyclic" ref="a632f8cc11df954d566c97bbf177ae6ad" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntVect.html">IntVect</a> <a class="el" href="classZone__PolyMAC.html#a632f8cc11df954d566c97bbf177ae6ad">Zone_PolyMAC::cyclic</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>cyclic(i) = 1 i le poly i est cyclique </p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00153">153</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9a713f7f3752672fdaba0ddd98c1d81f"></a><!-- doxytag: member="Zone_PolyMAC::face_normales_" ref="a9a713f7f3752672fdaba0ddd98c1d81f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> <a class="el" href="classZone__PolyMAC.html#a9a713f7f3752672fdaba0ddd98c1d81f">Zone_PolyMAC::face_normales_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>normales aux faces </p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00210">210</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00648">detecter_faces_non_planes()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00407">dist_face_elem0()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00412">dist_face_elem1()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00402">dist_norm()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00396">dist_norm_bord()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00087">ecrit()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00238">face_normales()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00731">modifier_pour_Cl()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00573">orthocentrer()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00110">printOn()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00129">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="a3122c86faa41d079ec3ed009a3c2136e"></a><!-- doxytag: member="Zone_PolyMAC::h_carre" ref="a3122c86faa41d079ec3ed009a3c2136e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classZone__PolyMAC.html#a3122c86faa41d079ec3ed009a3c2136e">Zone_PolyMAC::h_carre</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>carre du pas du maillage </p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00207">207</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00671">calculer_h_carre()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00312">carre_pas_du_maillage()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00087">ecrit()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00110">printOn()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00129">readOn()</a>.</p>

</div>
</div>
<a class="anchor" id="a72eda8458311fdd4c2a899abfdca99d2"></a><!-- doxytag: member="Zone_PolyMAC::h_carre_" ref="a72eda8458311fdd4c2a899abfdca99d2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a> <a class="el" href="classZone__PolyMAC.html#a72eda8458311fdd4c2a899abfdca99d2">Zone_PolyMAC::h_carre_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>carre du pas d'une maille </p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00208">208</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00671">calculer_h_carre()</a>, and <a class="el" href="Zone__PolyMAC_8h_source.html#l00113">carre_pas_maille()</a>.</p>

</div>
</div>
<a class="anchor" id="aa1115569d0d619b49344d24d29760227"></a><!-- doxytag: member="Zone_PolyMAC::ind_faces_virt_non_std_" ref="aa1115569d0d619b49344d24d29760227" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArrOfInt.html">ArrOfInt</a> <a class="el" href="classZone__PolyMAC.html#aa1115569d0d619b49344d24d29760227">Zone_PolyMAC::ind_faces_virt_non_std_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>contient les indices des faces virtuelles non standard </p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00218">218</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00830">creer_faces_virtuelles_non_std()</a>, and <a class="el" href="Zone__PolyMAC_8h_source.html#l00335">ind_faces_virt_non_std()</a>.</p>

</div>
</div>
<a class="anchor" id="abaa3f690f191e96591d440a6607c5d44"></a><!-- doxytag: member="Zone_PolyMAC::info_obj" ref="abaa3f690f191e96591d440a6607c5d44" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classType__info.html">Type_info</a> <a class="el" href="classZone__PolyMAC.html#abaa3f690f191e96591d440a6607c5d44">Zone_PolyMAC::info_obj</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classZone__VF.html#ab228ce0349fe5e80d8bba409fe6433b3">Zone_VF</a>.</p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00098">98</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

</div>
</div>
<a class="anchor" id="a909803b7a94bbc2f1110852a82148982"></a><!-- doxytag: member="Zone_PolyMAC::is_init" ref="a909803b7a94bbc2f1110852a82148982" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, int&gt; <a class="el" href="classZone__PolyMAC.html#a909803b7a94bbc2f1110852a82148982">Zone_PolyMAC::is_init</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00162">162</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01322">init_m1()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01059">init_m2()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01331">init_m2solv()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01156">init_rf()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01134">init_ve()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01358">init_virt_ef_map()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01180">init_we()</a>.</p>

</div>
</div>
<a class="anchor" id="ac4cfae3ceac2c9e92565c5d3b4e1e542"></a><!-- doxytag: member="Zone_PolyMAC::longueur_aretes_" ref="ac4cfae3ceac2c9e92565c5d3b4e1e542" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleVect.html">DoubleVect</a> <a class="el" href="classZone__PolyMAC.html#ac4cfae3ceac2c9e92565c5d3b4e1e542">Zone_PolyMAC::longueur_aretes_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00211">211</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01221">init_we_3d()</a>, and <a class="el" href="Zone__PolyMAC_8h_source.html#l00118">longueur_aretes()</a>.</p>

</div>
</div>
<a class="anchor" id="adf9e0183c83be84d04cd2d682619100b"></a><!-- doxytag: member="Zone_PolyMAC::m1ci" ref="adf9e0183c83be84d04cd2d682619100b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> <a class="el" href="classZone__PolyMAC.html#adf9e0183c83be84d04cd2d682619100b">Zone_PolyMAC::m1ci</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00197">197</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00100">Op_Diff_PolyMAC_Face::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00136">Op_Diff_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01249">init_m1_2d()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>.</p>

</div>
</div>
<a class="anchor" id="a44d477541e608609ff8f0ca5b9f80884"></a><!-- doxytag: member="Zone_PolyMAC::m1deb" ref="a44d477541e608609ff8f0ca5b9f80884" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#a44d477541e608609ff8f0ca5b9f80884">Zone_PolyMAC::m1deb</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00196">196</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00100">Op_Diff_PolyMAC_Face::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00136">Op_Diff_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00071">Op_Diff_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01249">init_m1_2d()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>.</p>

</div>
</div>
<a class="anchor" id="abbb87713bcfa7d40bc0092946c3058d4"></a><!-- doxytag: member="Zone_PolyMAC::m1ji" ref="abbb87713bcfa7d40bc0092946c3058d4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#abbb87713bcfa7d40bc0092946c3058d4">Zone_PolyMAC::m1ji</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00196">196</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00100">Op_Diff_PolyMAC_Face::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00136">Op_Diff_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00071">Op_Diff_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01249">init_m1_2d()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>.</p>

</div>
</div>
<a class="anchor" id="a1ef09e85a9897db3633c6fb921fe63e9"></a><!-- doxytag: member="Zone_PolyMAC::m2c" ref="a1ef09e85a9897db3633c6fb921fe63e9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> <a class="el" href="classZone__PolyMAC.html#a1ef09e85a9897db3633c6fb921fe63e9">Zone_PolyMAC::m2c</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00180">180</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00064">Perte_Charge_PolyMAC::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00100">Op_Diff_PolyMAC_Face::ajouter()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00127">Op_Conv_EF_Stab_PolyMAC_Face::ajouter()</a>, <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00145">Masse_PolyMAC_Face::ajouter_masse()</a>, <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00106">Perte_Charge_PolyMAC::contribuer_a_avec()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00136">Op_Diff_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00173">Op_Conv_EF_Stab_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01059">init_m2()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01331">init_m2solv()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00186">Champ_Face_PolyMAC::init_ra()</a>.</p>

</div>
</div>
<a class="anchor" id="a672f82b0a35bb4eb3dbc2b0af8e00cbc"></a><!-- doxytag: member="Zone_PolyMAC::m2d" ref="a672f82b0a35bb4eb3dbc2b0af8e00cbc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#a672f82b0a35bb4eb3dbc2b0af8e00cbc">Zone_PolyMAC::m2d</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">179</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00064">Perte_Charge_PolyMAC::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00100">Op_Diff_PolyMAC_Face::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00300">Op_Diff_PolyMAC_Elem::ajouter()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00127">Op_Conv_EF_Stab_PolyMAC_Face::ajouter()</a>, <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00145">Masse_PolyMAC_Face::ajouter_masse()</a>, <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00106">Perte_Charge_PolyMAC::contribuer_a_avec()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00136">Op_Diff_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00357">Op_Diff_PolyMAC_Elem::contribuer_a_avec()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00173">Op_Conv_EF_Stab_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00120">Masse_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00071">Op_Diff_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00179">Op_Diff_PolyMAC_Elem::dimensionner()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00090">Op_Conv_EF_Stab_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01059">init_m2()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01331">init_m2solv()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00186">Champ_Face_PolyMAC::init_ra()</a>, <a class="el" href="Op__Diff__PolyMAC__base_8h_source.html#l00105">Op_Diff_PolyMAC_base::remplir_nu_ef()</a>, <a class="el" href="Echange__contact__PolyMAC_8cpp_source.html#l00152">Echange_contact_PolyMAC::update_coeffs()</a>, and <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00114">Op_Diff_PolyMAC_Elem::update_delta_int()</a>.</p>

</div>
</div>
<a class="anchor" id="abae0465aee7760855c9b4eae58957bd9"></a><!-- doxytag: member="Zone_PolyMAC::m2i" ref="abae0465aee7760855c9b4eae58957bd9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#abae0465aee7760855c9b4eae58957bd9">Zone_PolyMAC::m2i</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">179</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00064">Perte_Charge_PolyMAC::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00100">Op_Diff_PolyMAC_Face::ajouter()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00127">Op_Conv_EF_Stab_PolyMAC_Face::ajouter()</a>, <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00145">Masse_PolyMAC_Face::ajouter_masse()</a>, <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00106">Perte_Charge_PolyMAC::contribuer_a_avec()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00136">Op_Diff_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00173">Op_Conv_EF_Stab_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00120">Masse_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00071">Op_Diff_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00090">Op_Conv_EF_Stab_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01059">init_m2()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01331">init_m2solv()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00186">Champ_Face_PolyMAC::init_ra()</a>.</p>

</div>
</div>
<a class="anchor" id="a6ffe4bbe605a937ab537b14eae6d7ed1"></a><!-- doxytag: member="Zone_PolyMAC::m2j" ref="a6ffe4bbe605a937ab537b14eae6d7ed1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#a6ffe4bbe605a937ab537b14eae6d7ed1">Zone_PolyMAC::m2j</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">179</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00064">Perte_Charge_PolyMAC::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00100">Op_Diff_PolyMAC_Face::ajouter()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00127">Op_Conv_EF_Stab_PolyMAC_Face::ajouter()</a>, <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00145">Masse_PolyMAC_Face::ajouter_masse()</a>, <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00106">Perte_Charge_PolyMAC::contribuer_a_avec()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00136">Op_Diff_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00173">Op_Conv_EF_Stab_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Masse__PolyMAC__Face_8cpp_source.html#l00120">Masse_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00071">Op_Diff_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00090">Op_Conv_EF_Stab_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01059">init_m2()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01331">init_m2solv()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00186">Champ_Face_PolyMAC::init_ra()</a>.</p>

</div>
</div>
<a class="anchor" id="a415f14d9e9e0765e1cfc7fc39229af5b"></a><!-- doxytag: member="Zone_PolyMAC::m2mat" ref="a415f14d9e9e0765e1cfc7fc39229af5b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMatrice__Morse__Sym.html">Matrice_Morse_Sym</a> <a class="el" href="classZone__PolyMAC.html#a415f14d9e9e0765e1cfc7fc39229af5b">Zone_PolyMAC::m2mat</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00182">182</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01331">init_m2solv()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00437">Champ_Face_PolyMAC::interp_gve()</a>.</p>

</div>
</div>
<a class="anchor" id="a3a97852ae61b7a5ea10e1b9ff728faca"></a><!-- doxytag: member="Zone_PolyMAC::m2solv" ref="a3a97852ae61b7a5ea10e1b9ff728faca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSolveurSys.html">SolveurSys</a> <a class="el" href="classZone__PolyMAC.html#a3a97852ae61b7a5ea10e1b9ff728faca">Zone_PolyMAC::m2solv</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00183">183</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01331">init_m2solv()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00437">Champ_Face_PolyMAC::interp_gve()</a>.</p>

</div>
</div>
<a class="anchor" id="a943e05074e1c95435e96551f26d43e80"></a><!-- doxytag: member="Zone_PolyMAC::mdv_elems_faces" ref="a943e05074e1c95435e96551f26d43e80" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMD__Vector.html">MD_Vector</a> <a class="el" href="classZone__PolyMAC.html#a943e05074e1c95435e96551f26d43e80">Zone_PolyMAC::mdv_elems_faces</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00200">200</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>.</p>

</div>
</div>
<a class="anchor" id="aee0dd0b4d16e9cd79a46a529dfe3797e"></a><!-- doxytag: member="Zone_PolyMAC::mdv_faces_aretes" ref="aee0dd0b4d16e9cd79a46a529dfe3797e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMD__Vector.html">MD_Vector</a> <a class="el" href="classZone__PolyMAC.html#aee0dd0b4d16e9cd79a46a529dfe3797e">Zone_PolyMAC::mdv_faces_aretes</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00200">200</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00076">Champ_Face_PolyMAC::fixer_nb_valeurs_nodales()</a>.</p>

</div>
</div>
<a class="anchor" id="a1d10485a5ee3b7b952e39ef12cb35416"></a><!-- doxytag: member="Zone_PolyMAC::nb_elem_std_" ref="a1d10485a5ee3b7b952e39ef12cb35416" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classZone__PolyMAC.html#a1d10485a5ee3b7b952e39ef12cb35416">Zone_PolyMAC::nb_elem_std_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>nombre d'elements standard </p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00213">213</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00087">ecrit()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00305">nb_elem_Cl()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00299">nb_elem_std()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00110">printOn()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00129">readOn()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00156">reordonner()</a>.</p>

</div>
</div>
<a class="anchor" id="a2b20af52d5cf15a8cfc12069ee7298b8"></a><!-- doxytag: member="Zone_PolyMAC::nb_faces_std_" ref="a2b20af52d5cf15a8cfc12069ee7298b8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classZone__PolyMAC.html#a2b20af52d5cf15a8cfc12069ee7298b8">Zone_PolyMAC::nb_faces_std_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>nombre de faces standard </p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00212">212</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00087">ecrit()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00293">nb_faces_std()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00110">printOn()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00129">readOn()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00156">reordonner()</a>.</p>

</div>
</div>
<a class="anchor" id="a8d141e85eb500e9143b06dc38547fb0b"></a><!-- doxytag: member="Zone_PolyMAC::rang_elem_non_std_" ref="a8d141e85eb500e9143b06dc38547fb0b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntVect.html">IntVect</a> <a class="el" href="classZone__PolyMAC.html#a8d141e85eb500e9143b06dc38547fb0b">Zone_PolyMAC::rang_elem_non_std_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>rang_elem_non_std_= -1 si l'element est standard rang_elem_non_std_= rang de l'element dans les tableaux relatifs aux elements non standards </p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00214">214</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00087">ecrit()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00110">printOn()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00273">rang_elem_non_std()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00129">readOn()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00156">reordonner()</a>.</p>

</div>
</div>
<a class="anchor" id="ad9732b8eabce055eadf9195bca623332"></a><!-- doxytag: member="Zone_PolyMAC::rfci" ref="ad9732b8eabce055eadf9195bca623332" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> <a class="el" href="classZone__PolyMAC.html#ad9732b8eabce055eadf9195bca623332">Zone_PolyMAC::rfci</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00171">171</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00100">Op_Diff_PolyMAC_Face::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00136">Op_Diff_PolyMAC_Face::contribuer_a_avec()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01156">init_rf()</a>.</p>

</div>
</div>
<a class="anchor" id="a88975dc4a6176ff5756f110ec492ba6f"></a><!-- doxytag: member="Zone_PolyMAC::rfdeb" ref="a88975dc4a6176ff5756f110ec492ba6f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#a88975dc4a6176ff5756f110ec492ba6f">Zone_PolyMAC::rfdeb</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00170">170</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00100">Op_Diff_PolyMAC_Face::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00136">Op_Diff_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00071">Op_Diff_PolyMAC_Face::dimensionner()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01156">init_rf()</a>.</p>

</div>
</div>
<a class="anchor" id="a4ce87d1be325b893ec0904b21053bced"></a><!-- doxytag: member="Zone_PolyMAC::rfji" ref="a4ce87d1be325b893ec0904b21053bced" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#a4ce87d1be325b893ec0904b21053bced">Zone_PolyMAC::rfji</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00170">170</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00100">Op_Diff_PolyMAC_Face::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00136">Op_Diff_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Op__Diff__PolyMAC__Face_8cpp_source.html#l00071">Op_Diff_PolyMAC_Face::dimensionner()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01156">init_rf()</a>.</p>

</div>
</div>
<a class="anchor" id="aedbee7d653ae0f28ab65674b28bf78f2"></a><!-- doxytag: member="Zone_PolyMAC::som_arete" ref="aedbee7d653ae0f28ab65674b28bf78f2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::map&lt;int, int&gt; &gt; <a class="el" href="classZone__PolyMAC.html#aedbee7d653ae0f28ab65674b28bf78f2">Zone_PolyMAC::som_arete</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00159">159</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01156">init_rf()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01180">init_we()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01221">init_we_3d()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00573">orthocentrer()</a>.</p>

</div>
</div>
<a class="anchor" id="a280bc522cc5b57552bb9dcfbdd1493c5"></a><!-- doxytag: member="Zone_PolyMAC::ta_" ref="a280bc522cc5b57552bb9dcfbdd1493c5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> <a class="el" href="classZone__PolyMAC.html#a280bc522cc5b57552bb9dcfbdd1493c5">Zone_PolyMAC::ta_</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00224">224</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01156">init_rf()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01221">init_we_3d()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00573">orthocentrer()</a>, and <a class="el" href="Zone__PolyMAC_8h_source.html#l00122">ta()</a>.</p>

</div>
</div>
<a class="anchor" id="aacc27abe34053cf43e4c0af67d21a998"></a><!-- doxytag: member="Zone_PolyMAC::type_elem_" ref="aacc27abe34053cf43e4c0af67d21a998" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classElem__PolyMAC.html">Elem_PolyMAC</a> <a class="el" href="classZone__PolyMAC.html#aacc27abe34053cf43e4c0af67d21a998">Zone_PolyMAC::type_elem_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>type de l'element de discretisation </p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00209">209</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00344">discretiser()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00087">ecrit()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00110">printOn()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00129">readOn()</a>, <a class="el" href="Zone__PolyMAC_8h_source.html#l00231">type_elem()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l00329">typer_elem()</a>.</p>

</div>
</div>
<a class="anchor" id="ad009c3ee5402613abf0d7e8b15da1c6f"></a><!-- doxytag: member="Zone_PolyMAC::veci" ref="ad009c3ee5402613abf0d7e8b15da1c6f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> <a class="el" href="classZone__PolyMAC.html#ad009c3ee5402613abf0d7e8b15da1c6f">Zone_PolyMAC::veci</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00166">166</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00064">Perte_Charge_PolyMAC::ajouter()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00127">Op_Conv_EF_Stab_PolyMAC_Face::ajouter()</a>, <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00106">Perte_Charge_PolyMAC::contribuer_a_avec()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00173">Op_Conv_EF_Stab_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00090">Op_Conv_EF_Stab_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00236">Champ_Face_PolyMAC::init_va()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01134">init_ve()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00437">Champ_Face_PolyMAC::interp_gve()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00388">Champ_Face_PolyMAC::interp_ve()</a>.</p>

</div>
</div>
<a class="anchor" id="a9878f0653163f907ea6b2c20ee0d89ee"></a><!-- doxytag: member="Zone_PolyMAC::vedeb" ref="a9878f0653163f907ea6b2c20ee0d89ee" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#a9878f0653163f907ea6b2c20ee0d89ee">Zone_PolyMAC::vedeb</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00165">165</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00064">Perte_Charge_PolyMAC::ajouter()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00127">Op_Conv_EF_Stab_PolyMAC_Face::ajouter()</a>, <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00106">Perte_Charge_PolyMAC::contribuer_a_avec()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00173">Op_Conv_EF_Stab_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00090">Op_Conv_EF_Stab_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00236">Champ_Face_PolyMAC::init_va()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01134">init_ve()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00437">Champ_Face_PolyMAC::interp_gve()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00388">Champ_Face_PolyMAC::interp_ve()</a>.</p>

</div>
</div>
<a class="anchor" id="ad1e5259622bbf8ce56dbd4cfd5708475"></a><!-- doxytag: member="Zone_PolyMAC::veji" ref="ad1e5259622bbf8ce56dbd4cfd5708475" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#ad1e5259622bbf8ce56dbd4cfd5708475">Zone_PolyMAC::veji</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00165">165</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00064">Perte_Charge_PolyMAC::ajouter()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00127">Op_Conv_EF_Stab_PolyMAC_Face::ajouter()</a>, <a class="el" href="Perte__Charge__PolyMAC_8cpp_source.html#l00106">Perte_Charge_PolyMAC::contribuer_a_avec()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00173">Op_Conv_EF_Stab_PolyMAC_Face::contribuer_a_avec()</a>, <a class="el" href="Op__Conv__EF__Stab__PolyMAC__Face_8cpp_source.html#l00090">Op_Conv_EF_Stab_PolyMAC_Face::dimensionner()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00236">Champ_Face_PolyMAC::init_va()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01134">init_ve()</a>, <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00437">Champ_Face_PolyMAC::interp_gve()</a>, and <a class="el" href="Champ__Face__PolyMAC_8cpp_source.html#l00388">Champ_Face_PolyMAC::interp_ve()</a>.</p>

</div>
</div>
<a class="anchor" id="ab280f7d8d35c0a0a7c576ef52145a09e"></a><!-- doxytag: member="Zone_PolyMAC::virt_ef_map" ref="ab280f7d8d35c0a0a7c576ef52145a09e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::array&lt;int, 2&gt;, int&gt; <a class="el" href="classZone__PolyMAC.html#ab280f7d8d35c0a0a7c576ef52145a09e">Zone_PolyMAC::virt_ef_map</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00204">204</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01358">init_virt_ef_map()</a>.</p>

</div>
</div>
<a class="anchor" id="a0806de38360333cf9ea39a791f20906e"></a><!-- doxytag: member="Zone_PolyMAC::w2c" ref="a0806de38360333cf9ea39a791f20906e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> <a class="el" href="classZone__PolyMAC.html#a0806de38360333cf9ea39a791f20906e">Zone_PolyMAC::w2c</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>avec le coeff diagonal en premier (facilite <a class="el" href="classEchange__contact__PolyMAC.html">Echange_contact_PolyMAC</a>) </p>

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00180">180</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00300">Op_Diff_PolyMAC_Elem::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00357">Op_Diff_PolyMAC_Elem::contribuer_a_avec()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01059">init_m2()</a>, <a class="el" href="Echange__contact__PolyMAC_8cpp_source.html#l00152">Echange_contact_PolyMAC::update_coeffs()</a>, and <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00114">Op_Diff_PolyMAC_Elem::update_delta_int()</a>.</p>

</div>
</div>
<a class="anchor" id="ad76e9d4739f1092d19cf1985c632524d"></a><!-- doxytag: member="Zone_PolyMAC::w2i" ref="ad76e9d4739f1092d19cf1985c632524d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#ad76e9d4739f1092d19cf1985c632524d">Zone_PolyMAC::w2i</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">179</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00300">Op_Diff_PolyMAC_Elem::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00357">Op_Diff_PolyMAC_Elem::contribuer_a_avec()</a>, <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00179">Op_Diff_PolyMAC_Elem::dimensionner()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01059">init_m2()</a>, <a class="el" href="Echange__contact__PolyMAC_8cpp_source.html#l00152">Echange_contact_PolyMAC::update_coeffs()</a>, and <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00114">Op_Diff_PolyMAC_Elem::update_delta_int()</a>.</p>

</div>
</div>
<a class="anchor" id="aa0cebde1e4683a6c55b944f821d5c097"></a><!-- doxytag: member="Zone_PolyMAC::w2j" ref="aa0cebde1e4683a6c55b944f821d5c097" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#aa0cebde1e4683a6c55b944f821d5c097">Zone_PolyMAC::w2j</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00179">179</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00300">Op_Diff_PolyMAC_Elem::ajouter()</a>, <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00357">Op_Diff_PolyMAC_Elem::contribuer_a_avec()</a>, <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00179">Op_Diff_PolyMAC_Elem::dimensionner()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01059">init_m2()</a>, <a class="el" href="Echange__contact__PolyMAC_8cpp_source.html#l00152">Echange_contact_PolyMAC::update_coeffs()</a>, and <a class="el" href="Op__Diff__PolyMAC__Elem_8cpp_source.html#l00114">Op_Diff_PolyMAC_Elem::update_delta_int()</a>.</p>

</div>
</div>
<a class="anchor" id="a034313bc3890500f6179ad7fbfe50e5e"></a><!-- doxytag: member="Zone_PolyMAC::weci" ref="a034313bc3890500f6179ad7fbfe50e5e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDoubleTab.html">DoubleTab</a> <a class="el" href="classZone__PolyMAC.html#a034313bc3890500f6179ad7fbfe50e5e">Zone_PolyMAC::weci</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00190">190</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01201">init_we_2d()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01221">init_we_3d()</a>.</p>

</div>
</div>
<a class="anchor" id="af61335f5cde4fc2cdd1d5fcd734e0516"></a><!-- doxytag: member="Zone_PolyMAC::wedeb" ref="af61335f5cde4fc2cdd1d5fcd734e0516" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#af61335f5cde4fc2cdd1d5fcd734e0516">Zone_PolyMAC::wedeb</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00189">189</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01201">init_we_2d()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01221">init_we_3d()</a>.</p>

</div>
</div>
<a class="anchor" id="a0e0a04421ef4f416ac46e96943c9e887"></a><!-- doxytag: member="Zone_PolyMAC::weji" ref="a0e0a04421ef4f416ac46e96943c9e887" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIntTab.html">IntTab</a> <a class="el" href="classZone__PolyMAC.html#a0e0a04421ef4f416ac46e96943c9e887">Zone_PolyMAC::weji</a><code> [mutable]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Zone__PolyMAC_8h_source.html#l00189">189</a> of file <a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a>.</p>

<p>Referenced by <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01272">init_m1_3d()</a>, <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01201">init_we_2d()</a>, and <a class="el" href="Zone__PolyMAC_8cpp_source.html#l01221">init_we_3d()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/PolyMAC/Zones/<a class="el" href="Zone__PolyMAC_8h_source.html">Zone_PolyMAC.h</a></li>
<li>src/PolyMAC/Zones/<a class="el" href="Zone__PolyMAC_8cpp_source.html">Zone_PolyMAC.cpp</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:38:13 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
