<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VDF/Champs/Champ_P0_VDF.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VDF/Champs/Champ_P0_VDF.cpp</div>  </div>
</div>
<div class="contents">
<a href="Champ__P0__VDF_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Champ_P0_VDF.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VDF/Champs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/20</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Champ__P0__VDF_8h.html">Champ_P0_VDF.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VDF_8h.html">Zone_VDF.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="LecFicDiffuse_8h.html">LecFicDiffuse.h</a>&gt;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a><a class="code" href="Champ__P0__VDF_8cpp.html#a334779346ef2a4e635119d8ea3b4b0fb">00027</a> <a class="code" href="Op__Diff__CoviMAC__Face_8cpp.html#aa86ec8ba612a969d9b4370b775037144">Implemente_instanciable</a>(<a class="code" href="classChamp__P0__VDF.html" title="classe Champ_P0_VDF Classe qui represente un champ discret P0 par element associe a une zone discreti...">Champ_P0_VDF</a>,<span class="stringliteral">&quot;Champ_P0_VDF&quot;</span>,<a class="code" href="classChamp__Inc__P0__base.html" title=": class Champ_Inc_P0_base Decrire ici la classe Champ_Inc_P0_base">Champ_Inc_P0_base</a>);
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">// printOn()</span>
<a name="l00030"></a>00030 <span class="comment">//</span>
<a name="l00031"></a>00031 
<a name="l00032"></a><a class="code" href="classChamp__P0__VDF.html#ad77a07b4ac076668d6edd3532617cd08">00032</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classChamp__P0__VDF.html#ad77a07b4ac076668d6edd3532617cd08" title="Surcharge Champ_base::printOn(Sortie&amp;) const Imprime le champ sur un flot de sortie. Simple appel a Champ_base::printOn(Sortie&amp;) const.">Champ_P0_VDF::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s)<span class="keyword"> const</span>
<a name="l00033"></a>00033 <span class="keyword"></span>{
<a name="l00034"></a>00034   <span class="keywordflow">return</span> s &lt;&lt; <a class="code" href="classObjet__U.html#aa58e9a81c0ddc2c1149053b8f96698ac" title="renvoie la chaine identifiant la classe.">que_suis_je</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classField__base.html#ae1377124eabe8387aced762115b062bb" title="Renvoie le nom du champ.">le_nom</a>();
<a name="l00035"></a>00035 }
<a name="l00036"></a>00036 <span class="comment"></span>
<a name="l00037"></a>00037 <span class="comment">////!&lt; readOn </span>
<a name="l00038"></a>00038 <span class="comment"></span><span class="comment">//</span>
<a name="l00039"></a>00039 
<a name="l00040"></a><a class="code" href="classChamp__P0__VDF.html#a74d0faa453e38493b9573706c18e4296">00040</a> <a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classChamp__P0__VDF.html#a74d0faa453e38493b9573706c18e4296" title="Lit un champ inconnue sur un flot d&#39;entree. Simple appel a Champ_base::readOn(Entree&amp;)">Champ_P0_VDF::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s)
<a name="l00041"></a>00041 {
<a name="l00042"></a>00042   <span class="keywordflow">return</span> s ;
<a name="l00043"></a>00043 }
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="classChamp__P0__VDF.html#ab49987e0fd9f9e5bc01d3c492111d39d">00045</a> <span class="keywordtype">void</span> <a class="code" href="classChamp__P0__VDF.html#ab49987e0fd9f9e5bc01d3c492111d39d">Champ_P0_VDF::associer_zone_dis_base</a>(<span class="keyword">const</span> <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; zone_dis)
<a name="l00046"></a>00046 {
<a name="l00047"></a>00047   <a class="code" href="classChamp__P0__VDF.html#ab77d32dc44fa3261706a397e777ca6cc">la_zone_VDF</a> = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>, zone_dis);
<a name="l00048"></a>00048 }
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="classChamp__P0__VDF.html#a2ba1b32df4ccafea3101e03cabcfba52">00050</a> <span class="keywordtype">double</span> <a class="code" href="classChamp__P0__VDF.html#a2ba1b32df4ccafea3101e03cabcfba52">Champ_P0_VDF::valeur_au_bord</a>(<span class="keywordtype">int</span> face)<span class="keyword"> const</span>
<a name="l00051"></a>00051 <span class="keyword"></span>{
<a name="l00052"></a>00052   <span class="keywordtype">double</span> val_bord;
<a name="l00053"></a>00053   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val = <a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00054"></a>00054   assert(<a class="code" href="classChamp__P0__VDF.html#ab77d32dc44fa3261706a397e777ca6cc">la_zone_VDF</a>.<a class="code" href="classO__U__Ptr.html#a16f216b2d169e885876419182658ddcc" title="Renvoie 1 si le pointeur est non_nul Renvoie 0 sinon.">non_nul</a>());
<a name="l00055"></a>00055   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_VDF=<a class="code" href="classChamp__P0__VDF.html#ab77d32dc44fa3261706a397e777ca6cc">la_zone_VDF</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00056"></a>00056 
<a name="l00057"></a>00057   <span class="keywordtype">int</span> n0 = zone_VDF.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(face,0);
<a name="l00058"></a>00058   <span class="keywordflow">if</span> (n0 != -1)
<a name="l00059"></a>00059     val_bord = val[n0];
<a name="l00060"></a>00060   <span class="keywordflow">else</span>
<a name="l00061"></a>00061     val_bord = val[zone_VDF.face_voisins(face,1)];
<a name="l00062"></a>00062   <span class="keywordflow">return</span> val_bord;
<a name="l00063"></a>00063 }
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="classChamp__P0__VDF.html#a8959b1fdb2791a7e8507d00da82270e9">00065</a> <span class="keyword">const</span> <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; <a class="code" href="classChamp__P0__VDF.html#a8959b1fdb2791a7e8507d00da82270e9">Champ_P0_VDF::zone_dis_base</a>()<span class="keyword"> const</span>
<a name="l00066"></a>00066 <span class="keyword"></span>{
<a name="l00067"></a>00067   <span class="keywordflow">return</span> <a class="code" href="classChamp__P0__VDF.html#ab77d32dc44fa3261706a397e777ca6cc">la_zone_VDF</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00068"></a>00068 }
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="classChamp__P0__VDF.html#a6abb1a5056c1e747254bef25d2fd98d4">00070</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; <a class="code" href="classChamp__P0__VDF.html#a6abb1a5056c1e747254bef25d2fd98d4">Champ_P0_VDF::remplir_coord_noeuds</a>(<a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; positions)<span class="keyword"> const</span>
<a name="l00071"></a>00071 <span class="keyword"></span>{
<a name="l00072"></a>00072   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_vdf = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>,<a class="code" href="classChamp__P0__VDF.html#a8959b1fdb2791a7e8507d00da82270e9">zone_dis_base</a>());
<a name="l00073"></a>00073   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xp = zone_vdf.<a class="code" href="classZone__VF.html#a87a29f0223c71256a25ee343c9277599">xp</a>();
<a name="l00074"></a>00074   <span class="keywordtype">int</span> nb_poly = zone_vdf.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>();
<a name="l00075"></a>00075   <span class="keywordflow">if</span> ( (xp.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0) == nb_poly ) &amp;&amp; (xp.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) == <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>) )
<a name="l00076"></a>00076     positions.<a class="code" href="classDoubleTab.html#afc7cddeeec2c80636e54eaf330ac41ad" title="fait pointer le tableau sur le vecteur v et en associant la meme structure parallele. Attention, si line_size du vecteur v est different de 1, on cree un tableau bidimensionnel (on peut avoir un vecteur de ce type si on copie un Tab dans un Vect puis on prend une ref sur ce Vect).">ref</a>(xp);
<a name="l00077"></a>00077   <span class="keywordflow">else</span>
<a name="l00078"></a>00078     {
<a name="l00079"></a>00079       <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone = zone_vdf.<a class="code" href="classZone__dis__base.html#a0bb3a4512e111f91fa2c352de44653a4" title="Renvoie la Zone associee a l&#39;objet. (version const)">zone</a>();
<a name="l00080"></a>00080       positions.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(nb_poly, <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00081"></a>00081       zone.<a class="code" href="classZone.html#ad8104f9be27f9c357e345b281a79064e" title="Calcule les centres de gravites des elements de la zone.">calculer_centres_gravite</a>(positions);
<a name="l00082"></a>00082     }
<a name="l00083"></a>00083   <span class="keywordflow">return</span> positions;
<a name="l00084"></a>00084 }
<a name="l00085"></a>00085 
<a name="l00086"></a>00086 <span class="comment">//</span>
<a name="l00087"></a>00087 <span class="comment">//</span>
<a name="l00088"></a>00088 <span class="comment">//</span><span class="comment"></span>
<a name="l00089"></a>00089 <span class="comment">//! renvoie la moyenne du champ au sens P0 i.e la somme, divisee par&lt;br&gt;le volume total du domaine, des valeurs constantes par element&lt;br&gt;multipliees par les volumes des elements</span>
<a name="l00090"></a>00090 <span class="comment"></span>
<a name="l00091"></a><a class="code" href="classChamp__P0__VDF.html#ae272cd0d21370b6bd4847fc71c15f83f">00091</a> <a class="code" href="classDoubleVect.html">DoubleVect</a> <a class="code" href="classChamp__P0__VDF.html#ae272cd0d21370b6bd4847fc71c15f83f" title="renvoie la moyenne du champ au sens P0 i.e la somme, divisee par le volume total du domaine...">Champ_P0_VDF::moyenne</a>()<span class="keyword"> const</span>
<a name="l00092"></a>00092 <span class="keyword"></span>{
<a name="l00093"></a>00093   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf=<a class="code" href="classChamp__P0__VDF.html#ab77d32dc44fa3261706a397e777ca6cc">la_zone_VDF</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00094"></a>00094   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite = zvdf.<a class="code" href="classZone__VF.html#afd135a1b227731193b1a97b7ed525435">porosite_elem</a>();
<a name="l00095"></a>00095   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes = zvdf.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00096"></a>00096   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val = <a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <span class="keywordtype">int</span> k,nb_compo = <a class="code" href="classField__base.html#a16e3abfebaaf9b7ef83acb936c872a91" title="Renvoie le nombre de composantes du champ.">nb_comp</a>();
<a name="l00099"></a>00099   <a class="code" href="classDoubleVect.html">DoubleVect</a> moy(nb_compo);
<a name="l00100"></a>00100   moy =0;
<a name="l00101"></a>00101   <span class="keywordtype">double</span> coef,sum_vol=0;
<a name="l00102"></a>00102 
<a name="l00103"></a>00103   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;zvdf.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); num_elem++)
<a name="l00104"></a>00104     {
<a name="l00105"></a>00105       coef = porosite(num_elem)*volumes(num_elem);
<a name="l00106"></a>00106       <span class="keywordflow">for</span> (k=0; k&lt;nb_compo; k++)
<a name="l00107"></a>00107         moy[k] += val(num_elem,k)*coef;
<a name="l00108"></a>00108       sum_vol += coef;
<a name="l00109"></a>00109     }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111   moy /= sum_vol;
<a name="l00112"></a>00112   <span class="keywordflow">return</span> moy;
<a name="l00113"></a>00113 }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 <span class="comment">//</span>
<a name="l00116"></a>00116 <span class="comment">//</span><span class="comment"></span>
<a name="l00117"></a>00117 <span class="comment">//! Cette fonction effectue le calcul de la moyenne au sens P0&lt;br&gt;de la kieme composante du champ</span>
<a name="l00118"></a><a class="code" href="classChamp__P0__VDF.html#ab6f46c1be5b3ef9a58ce931de6125919">00118</a> <span class="comment"></span><span class="keywordtype">double</span> <a class="code" href="classChamp__P0__VDF.html#ae272cd0d21370b6bd4847fc71c15f83f" title="renvoie la moyenne du champ au sens P0 i.e la somme, divisee par le volume total du domaine...">Champ_P0_VDF::moyenne</a>(<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00119"></a>00119 <span class="keyword"></span>{
<a name="l00120"></a>00120   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zvdf=<a class="code" href="classChamp__P0__VDF.html#ab77d32dc44fa3261706a397e777ca6cc">la_zone_VDF</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00121"></a>00121   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; porosite = zvdf.<a class="code" href="classZone__VF.html#afd135a1b227731193b1a97b7ed525435">porosite_elem</a>();
<a name="l00122"></a>00122   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes = zvdf.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00123"></a>00123   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val = <a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   <span class="keywordtype">double</span> moy=0;
<a name="l00126"></a>00126   <span class="keywordtype">double</span> coef,sum_vol=0;
<a name="l00127"></a>00127 
<a name="l00128"></a>00128   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_elem=0; num_elem&lt;zvdf.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>(); num_elem++)
<a name="l00129"></a>00129     {
<a name="l00130"></a>00130       coef = porosite(num_elem)*volumes(num_elem);
<a name="l00131"></a>00131       moy += val(num_elem,ncomp)*coef;
<a name="l00132"></a>00132       sum_vol += coef;
<a name="l00133"></a>00133     }
<a name="l00134"></a>00134   moy /= sum_vol;
<a name="l00135"></a>00135   <span class="keywordflow">return</span> moy;
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <span class="comment">//</span><span class="comment"></span>
<a name="l00139"></a>00139 <span class="comment">//! Ecrit le champ sous la forme IJK</span>
<a name="l00140"></a><a class="code" href="classChamp__P0__VDF.html#a54799d85a24329138c90e2db4dceb4f4">00140</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classChamp__P0__VDF.html#a54799d85a24329138c90e2db4dceb4f4" title="Ecrit le champ sous la forme IJK.">Champ_P0_VDF::imprime</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os, <span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00141"></a>00141 <span class="keyword"></span>{
<a name="l00142"></a>00142 <span class="comment">// valeur_au_ijk(xi,yj,zk,valeurs,ncomp);</span>
<a name="l00143"></a>00143 <span class="comment">// principe  : creer un tableau points avec selon si champ_elem ou champ_faces</span>
<a name="l00144"></a>00144 <span class="comment">// une grille construite a partie de xi,yj,zk lu dans un fichier</span>
<a name="l00145"></a>00145 <span class="comment">// sub_type(Champ_P0, *this) : grille construite a partir de (xi+xi+1)/2,etc...</span>
<a name="l00146"></a>00146 <span class="comment">// Sinon : grille construite a partir de xi,xi+1,etc...</span>
<a name="l00147"></a>00147 <span class="comment">// Boucle sur ni,nj,nk</span>
<a name="l00148"></a>00148 <span class="comment">// K=</span>
<a name="l00149"></a>00149 <span class="comment">// I=1 I=2 I=3 I=4</span>
<a name="l00150"></a>00150 <span class="comment">// J=10 Vij</span>
<a name="l00151"></a>00151 <span class="comment">// J=9</span>
<a name="l00152"></a>00152 <span class="comment">// ...</span>
<a name="l00153"></a>00153   <span class="keywordtype">int</span> ni,nj,nk=-1;
<a name="l00154"></a>00154   <span class="keywordtype">int</span> ii,jj,k;
<a name="l00155"></a>00155   <span class="keywordtype">int</span> np,elem;
<a name="l00156"></a>00156   <span class="keywordtype">int</span> cmax=7;
<a name="l00157"></a>00157   <a class="code" href="classDoubleVect.html">DoubleVect</a> xi,yj,zk;
<a name="l00158"></a>00158   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> Grille;
<a name="l00159"></a>00159 <span class="comment">// Lecture de xi,yj,zk dans un fichier .xiyjzk</span>
<a name="l00160"></a>00160   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nomfic(<a class="code" href="classObjet__U.html#a7c27c4f80259eeef76ff8fe2d3bc61f7" title="Renvoie une reference constante vers le nom du cas. Cette methode est statique.">nom_du_cas</a>());
<a name="l00161"></a>00161   nomfic+=<span class="stringliteral">&quot;.xiyjzk&quot;</span>;
<a name="l00162"></a>00162   <a class="code" href="classLecFicDiffuse.html" title="Cette classe implemente les operateurs et les methodes virtuelles de la classe EFichier de la facon s...">LecFicDiffuse</a> ficijk(nomfic);
<a name="l00163"></a>00163   ficijk &gt;&gt; xi;
<a name="l00164"></a>00164   ni=xi.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l00165"></a>00165   ficijk &gt;&gt; yj;
<a name="l00166"></a>00166   nj=yj.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l00167"></a>00167   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)
<a name="l00168"></a>00168     {
<a name="l00169"></a>00169       ficijk &gt;&gt; zk;
<a name="l00170"></a>00170       nk=zk.<a class="code" href="classDoubleVect.html#a392c1f20b462563365389d28e0853867" title="Identique a size_reelle()">size</a>();
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172   <span class="keywordflow">if</span> (ncomp == 1)
<a name="l00173"></a>00173     {
<a name="l00174"></a>00174       <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==3)
<a name="l00175"></a>00175         {
<a name="l00176"></a>00176 <span class="comment">// Grille ordonnee sur les centres des elements</span>
<a name="l00177"></a>00177           np=(ni-1)*(nj-1)*(nk-1);
<a name="l00178"></a>00178           Grille.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(np,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00179"></a>00179           <span class="keywordflow">for</span>(k=0; k&lt;nk-1; k++)
<a name="l00180"></a>00180             <span class="keywordflow">for</span>(ii=0; ii&lt;ni-1; ii++)
<a name="l00181"></a>00181               <span class="keywordflow">for</span>(jj=0; jj&lt;nj-1; jj++)
<a name="l00182"></a>00182                 {
<a name="l00183"></a>00183                   elem=jj+(nj-1)*(ii+k*(ni-1));
<a name="l00184"></a>00184                   Grille(elem,0)=0.5*(xi(ii)+xi(ii+1));
<a name="l00185"></a>00185                   Grille(elem,1)=0.5*(yj(jj)+yj(jj+1));
<a name="l00186"></a>00186                   Grille(elem,2)=0.5*(zk(k)+zk(k+1));
<a name="l00187"></a>00187                 }
<a name="l00188"></a>00188           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> tab_valeurs(np, <a class="code" href="classField__base.html#ac3539c9ffa67a0b2abe334607c61664f">nb_compo_</a>);
<a name="l00189"></a>00189           <a class="code" href="classChamp__Inc__base.html#acca7f919ef9955e1af15472a3ed80c57" title="Calcule les valeurs du champs inconnue aux positions specifiees.">valeur_aux</a>(Grille, tab_valeurs);
<a name="l00190"></a>00190           <span class="keywordflow">for</span>(k=0; k&lt;nk-1; k++)
<a name="l00191"></a>00191             {
<a name="l00192"></a>00192               os &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00193"></a>00193               os &lt;&lt; <span class="stringliteral">&quot;Coupe a K= &quot;</span> &lt;&lt; k &lt;&lt; finl;
<a name="l00194"></a>00194               <span class="keywordtype">int</span> n1=0,n2=0;
<a name="l00195"></a>00195               <span class="keywordflow">while</span> (n2&lt;ni-1)
<a name="l00196"></a>00196                 {
<a name="l00197"></a>00197                   n1=n2;
<a name="l00198"></a>00198                   n2=<a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">::min</a>(ni-1,n2+cmax);
<a name="l00199"></a>00199                   os &lt;&lt; finl;
<a name="l00200"></a>00200                   os &lt;&lt; <span class="stringliteral">&quot;I=     &quot;</span>;
<a name="l00201"></a>00201                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=n1; i&lt;n2; i++)
<a name="l00202"></a>00202                     os &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;              &quot;</span>;
<a name="l00203"></a>00203                   os &lt;&lt; finl;
<a name="l00204"></a>00204                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=nj-2; j&gt;-1; j--)
<a name="l00205"></a>00205                     {
<a name="l00206"></a>00206                       os &lt;&lt; <span class="stringliteral">&quot;J= &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00207"></a>00207                       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=n1; i&lt;n2; i++)
<a name="l00208"></a>00208                         {
<a name="l00209"></a>00209                           elem=j+(nj-1)*(i+k*(ni-1));
<a name="l00210"></a>00210                           os &lt;&lt; tab_valeurs(elem,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00211"></a>00211                         }
<a name="l00212"></a>00212                       os &lt;&lt; finl;
<a name="l00213"></a>00213                     }
<a name="l00214"></a>00214                 }
<a name="l00215"></a>00215             }
<a name="l00216"></a>00216         }
<a name="l00217"></a>00217       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>==2)
<a name="l00218"></a>00218         {
<a name="l00219"></a>00219           np=(ni-1)*(nj-1);
<a name="l00220"></a>00220           Grille.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(np,<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>);
<a name="l00221"></a>00221           <span class="keywordflow">for</span>(ii=0; ii&lt;ni-1; ii++)
<a name="l00222"></a>00222             <span class="keywordflow">for</span>(jj=0; jj&lt;nj-1; jj++)
<a name="l00223"></a>00223               {
<a name="l00224"></a>00224                 elem=jj+(nj-1)*ii;
<a name="l00225"></a>00225                 Grille(elem,0)=0.5*(xi(ii)+xi(ii+1));
<a name="l00226"></a>00226                 Grille(elem,1)=0.5*(yj(jj)+yj(jj+1));
<a name="l00227"></a>00227               }
<a name="l00228"></a>00228           <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> tab_valeurs(np, <a class="code" href="classField__base.html#ac3539c9ffa67a0b2abe334607c61664f">nb_compo_</a>);
<a name="l00229"></a>00229           <a class="code" href="classChamp__Inc__base.html#acca7f919ef9955e1af15472a3ed80c57" title="Calcule les valeurs du champs inconnue aux positions specifiees.">valeur_aux</a>(Grille, tab_valeurs);
<a name="l00230"></a>00230           <span class="keywordtype">int</span> n1=0,n2=0;
<a name="l00231"></a>00231           <span class="keywordflow">while</span> (n2&lt;ni-1)
<a name="l00232"></a>00232             {
<a name="l00233"></a>00233               n1=n2;
<a name="l00234"></a>00234               n2=<a class="code" href="Double_8h.html#a2f8edc4561e9744ed4233b205fa7ec32">::min</a>(ni-1,n2+cmax);
<a name="l00235"></a>00235               os &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00236"></a>00236               os &lt;&lt; <span class="stringliteral">&quot;I=     &quot;</span>;
<a name="l00237"></a>00237               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=n1; i&lt;n2; i++)
<a name="l00238"></a>00238                 os &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;              &quot;</span>;
<a name="l00239"></a>00239               os &lt;&lt; finl;
<a name="l00240"></a>00240               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=nj-2; j&gt;-1; j--)
<a name="l00241"></a>00241                 {
<a name="l00242"></a>00242                   os &lt;&lt; <span class="stringliteral">&quot;J= &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00243"></a>00243                   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=n1; i&lt;n2; i++)
<a name="l00244"></a>00244                     {
<a name="l00245"></a>00245                       elem=j+(nj-1)*i;
<a name="l00246"></a>00246                       os &lt;&lt; tab_valeurs(elem,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00247"></a>00247                     }
<a name="l00248"></a>00248                   os &lt;&lt; finl;
<a name="l00249"></a>00249                 }
<a name="l00250"></a>00250             }
<a name="l00251"></a>00251         }
<a name="l00252"></a>00252     }
<a name="l00253"></a>00253   <span class="keywordflow">else</span>
<a name="l00254"></a>00254     {
<a name="l00255"></a>00255       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Champ_P0_VDF::imprime_P0_VDF avec nb_compo_&gt;1 non code.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00256"></a>00256       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00257"></a>00257     }
<a name="l00258"></a>00258   <span class="keywordflow">return</span> 1;
<a name="l00259"></a>00259 }
<a name="l00260"></a>00260 
<a name="l00261"></a>00261 <span class="comment">// Precondition:</span>
<a name="l00262"></a>00262 <span class="comment">// Parametre: int ncomp</span>
<a name="l00263"></a>00263 <span class="comment">// Signification: le numero de la composante integree en espace</span>
<a name="l00264"></a>00264 <span class="comment">// Valeurs par defaut:</span>
<a name="l00265"></a>00265 <span class="comment">// Contraintes:</span>
<a name="l00266"></a>00266 <span class="comment">// Acces:</span>
<a name="l00267"></a>00267 <span class="comment">// Exception:</span>
<a name="l00268"></a>00268 <span class="comment">// Effets de bord:</span>
<a name="l00269"></a>00269 <span class="comment">//</span>
<a name="l00270"></a>00270 <span class="comment">//</span>
<a name="l00271"></a>00271 <span class="comment">//</span><span class="comment"></span>
<a name="l00272"></a>00272 <span class="comment">//! Appel a l&#39;objet sous-jacent&lt;br&gt;calcule l&#39;integrale de l&#39;une des composantes&lt;br&gt;du champ sur le domaine qui lui correspond</span>
<a name="l00273"></a>00273 <span class="comment"></span><span class="comment">/** \return double&lt;br&gt;</span>
<a name="l00274"></a>00274 <span class="comment">Signification: valeur de l&#39;integrale&lt;br&gt;</span>
<a name="l00275"></a>00275 <span class="comment">Contraintes: */</span>
<a name="l00276"></a><a class="code" href="classChamp__P0__VDF.html#af636efbddb025616b490ee488712ef5f">00276</a> <span class="keywordtype">double</span> <a class="code" href="classChamp__P0__VDF.html#af636efbddb025616b490ee488712ef5f" title="Appel a l&#39;objet sous-jacent calcule l&#39;integrale de l&#39;une des composantes du champ sur le domaine qui ...">Champ_P0_VDF::integrale_espace</a>(<span class="keywordtype">int</span> ncomp)<span class="keyword"> const</span>
<a name="l00277"></a>00277 <span class="keyword"></span>{
<a name="l00278"></a>00278 <span class="comment">// Cerr &lt;&lt; &quot;Champ_P0_VDF::integrale_espace &quot; &lt;&lt; finl;</span>
<a name="l00279"></a>00279   <span class="keywordtype">double</span> integr=0.;
<a name="l00280"></a>00280   <span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; zone_vdf=<a class="code" href="classChamp__P0__VDF.html#ab77d32dc44fa3261706a397e777ca6cc">la_zone_VDF</a>.<a class="code" href="classRef__Zone__VDF.html#a84151da4db745d02791d6246e3682b67">valeur</a>();
<a name="l00281"></a>00281   <span class="keyword">const</span> <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; volumes = zone_vdf.<a class="code" href="classZone__VF.html#aea771c835e561469d2d21dbca5fac1cf" title="renvoie le volume de la maille i.">volumes</a>();
<a name="l00282"></a>00282   <span class="keywordtype">int</span> nb_elem =zone_vdf.<a class="code" href="classZone__dis__base.html#a790cb2f6bc2928518799e748313d0eb3">nb_elem</a>();
<a name="l00283"></a>00283   <span class="keywordtype">int</span> elem;
<a name="l00284"></a>00284   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; val = <a class="code" href="classChamp__Inc__base.html#adb537f43f1649e103a8980314c7ed175" title="Renvoie le tableau des valeurs du champ au temps courant.">valeurs</a>();
<a name="l00285"></a>00285   assert(ncomp &lt; val.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>());
<a name="l00286"></a>00286 
<a name="l00287"></a>00287   <span class="keywordflow">for</span> (elem=0; elem&lt;nb_elem; elem++)
<a name="l00288"></a>00288     integr+= val(elem,ncomp)*volumes(elem);
<a name="l00289"></a>00289 
<a name="l00290"></a>00290   <span class="keywordflow">return</span> integr;
<a name="l00291"></a>00291 }
<a name="l00292"></a>00292 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:37 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
