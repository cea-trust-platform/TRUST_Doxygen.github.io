<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/VDF/Operateurs/Op_VDF_Face.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/VDF/Operateurs/Op_VDF_Face.cpp</div>  </div>
</div>
<div class="contents">
<a href="Op__VDF__Face_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Op_VDF_Face.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/VDF/Operateurs</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/19</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Op__VDF__Face_8h.html">Op_VDF_Face.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VDF_8h.html">Zone_VDF.h</a>&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__VDF_8h.html">Zone_Cl_VDF.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Periodique_8h.html">Periodique.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet_8h.html">Dirichlet.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Dirichlet__homogene_8h.html">Dirichlet_homogene.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Symetrie_8h.html">Symetrie.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Matrice__Morse_8h.html">Matrice_Morse.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="Equation__base_8h.html">Equation_base.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Champ__Inc_8h.html">Champ_Inc.h</a>&gt;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 
<a name="l00035"></a><a class="code" href="Op__VDF__Face_8cpp.html#af4c4d3f3df90f2cfae84d1d3ee23d8e4">00035</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="Op__VDF__Face_8cpp.html#af4c4d3f3df90f2cfae84d1d3ee23d8e4">face_bord_amont2</a>(<span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; la_zone, <span class="keywordtype">int</span> num_face, <span class="keywordtype">int</span> k, <span class="keywordtype">int</span> i)
<a name="l00036"></a>00036 {
<a name="l00037"></a>00037   <span class="keywordtype">int</span> ori = la_zone.<a class="code" href="classZone__VDF.html#a9a9bd747218e463b3408a3590c12814c" title="inline DoubleVect&amp; Zone_VDF::porosite_face() { return porosite_face_; }">orientation</a>(num_face);
<a name="l00038"></a>00038   <span class="keywordtype">int</span> elem = la_zone.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(num_face,0);
<a name="l00039"></a>00039   <span class="keywordflow">if</span>(elem != -1)
<a name="l00040"></a>00040     {
<a name="l00041"></a>00041       <span class="keywordtype">int</span> face = la_zone.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>(elem, k+i*<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>);
<a name="l00042"></a>00042       <span class="keywordtype">int</span> elem_bis = la_zone.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>(face,i);
<a name="l00043"></a>00043       <span class="keywordflow">if</span> (elem_bis != -1)
<a name="l00044"></a>00044         elem = la_zone.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>(elem_bis, ori+Objet_U::dimension);
<a name="l00045"></a>00045       <span class="keywordflow">else</span>
<a name="l00046"></a>00046         elem = -1;
<a name="l00047"></a>00047     }
<a name="l00048"></a>00048   <span class="keywordflow">else</span>
<a name="l00049"></a>00049     {
<a name="l00050"></a>00050       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00051"></a>00051     }
<a name="l00052"></a>00052   <span class="keywordflow">return</span> elem;
<a name="l00053"></a>00053 }
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="classOp__VDF__Face.html#afe64470aaf50961f00b89e47a5743e57">00056</a> <span class="keywordtype">void</span> <a class="code" href="classOp__VDF__Face.html#afe64470aaf50961f00b89e47a5743e57">Op_VDF_Face::dimensionner</a>(<span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; la_zone,
<a name="l00057"></a>00057                                <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; la_zone_cl,
<a name="l00058"></a>00058                                <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; la_matrice)<span class="keyword"> const</span>
<a name="l00059"></a>00059 <span class="keyword"></span>{
<a name="l00060"></a>00060 <span class="comment">// Dimensionnement de la matrice qui devra recevoir les coefficients provenant de</span>
<a name="l00061"></a>00061 <span class="comment">// la convection, de la diffusion pour le cas des faces.</span>
<a name="l00062"></a>00062 <span class="comment">// Cette matrice a une structure de matrice morse.</span>
<a name="l00063"></a>00063 <span class="comment">// Nous commencons par calculer les tailles des tableaux tab1 et tab2.</span>
<a name="l00064"></a>00064   <span class="keywordtype">int</span> ndeb = 0;
<a name="l00065"></a>00065   <span class="keywordtype">int</span> nfin = la_zone.<a class="code" href="classZone__VF.html#a50fd21c9535680489015a3c8b88c685a" title="renvoie le nombre total de faces. C&#39;est-a-dire faces reelles + faces virtuelles">nb_faces_tot</a>();
<a name="l00066"></a>00066   <span class="keywordtype">int</span> dimension = <a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">Objet_U::dimension</a>;
<a name="l00067"></a>00067 
<a name="l00068"></a>00068   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; champ_inconnue = la_zone_cl.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00069"></a>00069   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp = champ_inconnue.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00070"></a>00070 
<a name="l00071"></a>00071   la_matrice.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nfin*nb_comp,nfin*nb_comp,0);
<a name="l00072"></a>00072 
<a name="l00073"></a>00073   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = la_matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l00074"></a>00074   coeff=0;
<a name="l00075"></a>00075   <a class="code" href="classIntVect.html">IntVect</a> rang_voisin(nfin);
<a name="l00076"></a>00076   rang_voisin=1;
<a name="l00077"></a>00077   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; orientation=la_zone.<a class="code" href="classZone__VDF.html#a9a9bd747218e463b3408a3590c12814c" title="inline DoubleVect&amp; Zone_VDF::porosite_face() { return porosite_face_; }">orientation</a>();
<a name="l00078"></a>00078 
<a name="l00079"></a>00079   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00080"></a>00080     {
<a name="l00081"></a>00081       <span class="keywordtype">int</span> ori=orientation(num_face);
<a name="l00082"></a>00082       <span class="keywordtype">int</span> face1=la_zone.<a class="code" href="classZone__VDF.html#a300a532c10f90581a3dd5b0eab6d89d9">face_amont_princ</a>(num_face,0);
<a name="l00083"></a>00083       <span class="keywordtype">int</span> face2=la_zone.<a class="code" href="classZone__VDF.html#a300a532c10f90581a3dd5b0eab6d89d9">face_amont_princ</a>(num_face,1);
<a name="l00084"></a>00084       <span class="keywordtype">int</span> face3=la_zone.<a class="code" href="classZone__VDF.html#ac081a43d3b552e8fb6b756e0748ef62b" title="Determine la face voisine de notre face en prevoyant que cette derniere puisse etre de type bord...">face_bord_amont</a>(num_face,(ori+1)%dimension,0);
<a name="l00085"></a>00085       <span class="keywordtype">int</span> face4=la_zone.<a class="code" href="classZone__VDF.html#ac081a43d3b552e8fb6b756e0748ef62b" title="Determine la face voisine de notre face en prevoyant que cette derniere puisse etre de type bord...">face_bord_amont</a>(num_face,(ori+1)%dimension,1);
<a name="l00086"></a>00086       <span class="keywordflow">if</span>(face1 &gt; -1)
<a name="l00087"></a>00087         (rang_voisin(num_face))++;
<a name="l00088"></a>00088       <span class="keywordflow">if</span>(face2 &gt; -1)
<a name="l00089"></a>00089         (rang_voisin(num_face))++;
<a name="l00090"></a>00090       <span class="keywordflow">if</span>(face3 &gt; -1)
<a name="l00091"></a>00091         (rang_voisin(num_face))++;
<a name="l00092"></a>00092       <span class="keywordflow">if</span>(face4 &gt; -1)
<a name="l00093"></a>00093         (rang_voisin(num_face))++;
<a name="l00094"></a>00094       <span class="keywordflow">if</span> (dimension==3)
<a name="l00095"></a>00095         {
<a name="l00096"></a>00096           <span class="keywordtype">int</span> face5=la_zone.<a class="code" href="classZone__VDF.html#ac081a43d3b552e8fb6b756e0748ef62b" title="Determine la face voisine de notre face en prevoyant que cette derniere puisse etre de type bord...">face_bord_amont</a>(num_face,(ori+2)%dimension,0);
<a name="l00097"></a>00097           <span class="keywordtype">int</span> face6=la_zone.<a class="code" href="classZone__VDF.html#ac081a43d3b552e8fb6b756e0748ef62b" title="Determine la face voisine de notre face en prevoyant que cette derniere puisse etre de type bord...">face_bord_amont</a>(num_face,(ori+2)%dimension,1);
<a name="l00098"></a>00098 
<a name="l00099"></a>00099           <span class="keywordflow">if</span>(face5 &gt; -1)
<a name="l00100"></a>00100             (rang_voisin(num_face))++;
<a name="l00101"></a>00101           <span class="keywordflow">if</span>(face6 &gt; -1)
<a name="l00102"></a>00102             (rang_voisin(num_face))++;
<a name="l00103"></a>00103         }
<a name="l00104"></a>00104     }
<a name="l00105"></a>00105 <span class="comment">// Cerr&lt;&lt;&quot;nbre max de voisin &quot;&lt;&lt;max(rang_voisin)&lt;&lt;&quot; &quot;&lt;&lt;rang_voisin(0)&lt;&lt;finl;</span>
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 <span class="comment">// Cerr&lt;&lt;&quot;nbre max de voisin &quot;&lt;&lt;max(rang_voisin)&lt;&lt;&quot; &quot;&lt;&lt;rang_voisin(0)&lt;&lt;finl;</span>
<a name="l00108"></a>00108 <span class="comment">// on dimensionne tab1 et tab2 au nombre de faces</span>
<a name="l00109"></a>00109 
<a name="l00110"></a>00110   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1=la_matrice.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l00111"></a>00111   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab2=la_matrice.<a class="code" href="classMatrice__Morse.html#af11c5853518e9e6db4c7e6e6acc8d7fd">get_set_tab2</a>();
<a name="l00112"></a>00112   tab1(0)=1;
<a name="l00113"></a>00113   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00114"></a>00114     {
<a name="l00115"></a>00115       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt; nb_comp; k++)
<a name="l00116"></a>00116         tab1(num_face*nb_comp+1+k)=rang_voisin(num_face)+tab1(num_face*nb_comp+k);
<a name="l00117"></a>00117     }
<a name="l00118"></a>00118 
<a name="l00119"></a>00119   la_matrice.<a class="code" href="classMatrice__Morse.html#ae95f9ed88a8a3fc637cd2a705cead9c8" title="Size the matrix with n lines and n columns and nnz zero-values coefficients.">dimensionner</a>(nfin*nb_comp,tab1(nfin*nb_comp)-1);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=ndeb; num_face&lt;nfin; num_face++)
<a name="l00122"></a>00122     {
<a name="l00123"></a>00123       <span class="keywordtype">int</span> ori=orientation(num_face);
<a name="l00124"></a>00124       <span class="keywordtype">int</span> face1=la_zone.<a class="code" href="classZone__VDF.html#a300a532c10f90581a3dd5b0eab6d89d9">face_amont_princ</a>(num_face,0);
<a name="l00125"></a>00125       <span class="keywordtype">int</span> face2=la_zone.<a class="code" href="classZone__VDF.html#a300a532c10f90581a3dd5b0eab6d89d9">face_amont_princ</a>(num_face,1);
<a name="l00126"></a>00126       <span class="keywordtype">int</span> face3=la_zone.<a class="code" href="classZone__VDF.html#ac081a43d3b552e8fb6b756e0748ef62b" title="Determine la face voisine de notre face en prevoyant que cette derniere puisse etre de type bord...">face_bord_amont</a>(num_face,(ori+1)%dimension,0);
<a name="l00127"></a>00127       <span class="keywordtype">int</span> face4=la_zone.<a class="code" href="classZone__VDF.html#ac081a43d3b552e8fb6b756e0748ef62b" title="Determine la face voisine de notre face en prevoyant que cette derniere puisse etre de type bord...">face_bord_amont</a>(num_face,(ori+1)%dimension,1);
<a name="l00128"></a>00128 
<a name="l00129"></a>00129       <span class="keywordtype">int</span> cpt=tab1[num_face]-1;
<a name="l00130"></a>00130       tab2[cpt]=num_face+1;
<a name="l00131"></a>00131       cpt++;
<a name="l00132"></a>00132 
<a name="l00133"></a>00133       <span class="keywordflow">if</span>(face1 &gt; -1)
<a name="l00134"></a>00134         {
<a name="l00135"></a>00135           tab2[cpt]=face1+1;
<a name="l00136"></a>00136           cpt++;
<a name="l00137"></a>00137         }
<a name="l00138"></a>00138       <span class="keywordflow">if</span>(face2 &gt; -1)
<a name="l00139"></a>00139         {
<a name="l00140"></a>00140           tab2[cpt]=face2+1;
<a name="l00141"></a>00141           cpt++;
<a name="l00142"></a>00142         }
<a name="l00143"></a>00143       <span class="keywordflow">if</span>(face3 &gt; -1)
<a name="l00144"></a>00144         {
<a name="l00145"></a>00145           tab2[cpt]=face3+1;
<a name="l00146"></a>00146           cpt++;
<a name="l00147"></a>00147         }
<a name="l00148"></a>00148       <span class="keywordflow">if</span>(face4 &gt; -1)
<a name="l00149"></a>00149         {
<a name="l00150"></a>00150           tab2[cpt]=face4+1;
<a name="l00151"></a>00151           cpt++;
<a name="l00152"></a>00152         }
<a name="l00153"></a>00153       <span class="keywordflow">if</span> (dimension==3)
<a name="l00154"></a>00154         {
<a name="l00155"></a>00155           <span class="keywordtype">int</span> face5=la_zone.<a class="code" href="classZone__VDF.html#ac081a43d3b552e8fb6b756e0748ef62b" title="Determine la face voisine de notre face en prevoyant que cette derniere puisse etre de type bord...">face_bord_amont</a>(num_face,(ori+2)%dimension,0);
<a name="l00156"></a>00156           <span class="keywordtype">int</span> face6=la_zone.<a class="code" href="classZone__VDF.html#ac081a43d3b552e8fb6b756e0748ef62b" title="Determine la face voisine de notre face en prevoyant que cette derniere puisse etre de type bord...">face_bord_amont</a>(num_face,(ori+2)%dimension,1);
<a name="l00157"></a>00157 
<a name="l00158"></a>00158           <span class="keywordflow">if</span>(face5 &gt; -1)
<a name="l00159"></a>00159             {
<a name="l00160"></a>00160               tab2[cpt]=face5+1;
<a name="l00161"></a>00161               cpt++;
<a name="l00162"></a>00162             }
<a name="l00163"></a>00163           <span class="keywordflow">if</span>(face6 &gt; -1)
<a name="l00164"></a>00164             {
<a name="l00165"></a>00165               tab2[cpt]=face6+1;
<a name="l00166"></a>00166               cpt++;
<a name="l00167"></a>00167             }
<a name="l00168"></a>00168         }
<a name="l00169"></a>00169     }
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="comment">// on traite la condition de periodicite</span>
<a name="l00172"></a>00172 <span class="comment">// en effet ce n&#39;est pas sur que les faces de frontiere soient les bonnes</span>
<a name="l00173"></a>00173 <span class="comment">// plus precisement a droite on a la face de gauche et non celle de droite</span>
<a name="l00174"></a>00174   <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; les_cl = la_zone_cl.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>();
<a name="l00175"></a>00175   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; faces_voisins=la_zone.<a class="code" href="classZone__VF.html#a49d4322f5585a8fa95748ca785b70702" title="renvoie l&#39;element voisin de numface dans la direction i. i=0 : dans le sens oppose de l&#39;axe orthogona...">face_voisins</a>();
<a name="l00176"></a>00176   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces=la_zone.<a class="code" href="classZone__VF.html#a067e462dcd3ab92b0f6d945b19e4eb37" title="renvoie le numero de le ieme face de la maille num_elem la facon dont ces faces sont numerotees est l...">elem_faces</a>();
<a name="l00177"></a>00177   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;les_cl.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); i++)
<a name="l00178"></a>00178     {
<a name="l00179"></a>00179       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = les_cl[i];
<a name="l00180"></a>00180       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00181"></a>00181         {
<a name="l00182"></a>00182           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; la_front_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00183"></a>00183           <span class="keywordtype">int</span> ndeb_p = la_front_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00184"></a>00184           <span class="keywordtype">int</span> nfaces = la_front_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00185"></a>00185           <span class="keywordtype">int</span> nfin_p=ndeb_p+nfaces;
<a name="l00186"></a>00186 
<a name="l00187"></a>00187 <span class="comment">// fait = 0;</span>
<a name="l00188"></a>00188           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> num_face=ndeb_p; num_face&lt;nfin_p; num_face++)
<a name="l00189"></a>00189             {
<a name="l00190"></a>00190               <span class="keywordtype">int</span> ori=orientation(num_face);
<a name="l00191"></a>00191 
<a name="l00192"></a>00192               {
<a name="l00193"></a>00193 <span class="comment">// fait[ind_face_local] = 1;</span>
<a name="l00194"></a>00194 <span class="comment">// fait[la_cl_perio.face_associee(ind_face_local)] = 1;</span>
<a name="l00195"></a>00195 <span class="comment">// int face1=la_zone.face_amont_princ(num_face,0);</span>
<a name="l00196"></a>00196 <span class="comment">// int face2=la_zone.face_amont_princ(num_face,1);</span>
<a name="l00197"></a>00197                 <span class="keywordtype">int</span> face3=la_zone.<a class="code" href="classZone__VDF.html#ac081a43d3b552e8fb6b756e0748ef62b" title="Determine la face voisine de notre face en prevoyant que cette derniere puisse etre de type bord...">face_bord_amont</a>(num_face,(ori+1)%dimension,0);
<a name="l00198"></a>00198                 <span class="keywordtype">int</span> face4=la_zone.<a class="code" href="classZone__VDF.html#ac081a43d3b552e8fb6b756e0748ef62b" title="Determine la face voisine de notre face en prevoyant que cette derniere puisse etre de type bord...">face_bord_amont</a>(num_face,(ori+1)%dimension,1);
<a name="l00199"></a>00199 
<a name="l00200"></a>00200                 <span class="keywordtype">int</span> face1b=elem_faces(faces_voisins(num_face,1),ori);
<a name="l00201"></a>00201 
<a name="l00202"></a>00202                 <span class="keywordtype">int</span> cpt=tab1[num_face]-1;
<a name="l00203"></a>00203                 cpt+=3;
<a name="l00204"></a>00204                 <span class="keywordflow">if</span> (face1b!=num_face)
<a name="l00205"></a>00205                   {
<a name="l00206"></a>00206 <span class="comment">// on recalcule fac3 fac4</span>
<a name="l00207"></a>00207                     <span class="keywordtype">int</span> face3n=<a class="code" href="Op__VDF__Face_8cpp.html#af4c4d3f3df90f2cfae84d1d3ee23d8e4">face_bord_amont2</a>(la_zone,num_face,(ori+1)%dimension,0);
<a name="l00208"></a>00208                     <span class="keywordtype">int</span> face4n=<a class="code" href="Op__VDF__Face_8cpp.html#af4c4d3f3df90f2cfae84d1d3ee23d8e4">face_bord_amont2</a>(la_zone,num_face,(ori+1)%dimension,1);
<a name="l00209"></a>00209 
<a name="l00210"></a>00210                     <span class="keywordflow">if</span> (face3!=-1)
<a name="l00211"></a>00211                       {
<a name="l00212"></a>00212 <span class="comment">// int face3n=la_cl_perio.face_associee(face3-ndeb_p)+ndeb_p;</span>
<a name="l00213"></a>00213 <span class="comment">// on remplace face3 pae face3n dans tab2</span>
<a name="l00214"></a>00214                         assert(tab2[cpt]==face3+1);
<a name="l00215"></a>00215                         tab2[cpt]=face3n+1;
<a name="l00216"></a>00216                         cpt++;
<a name="l00217"></a>00217                       }
<a name="l00218"></a>00218                     <span class="keywordflow">if</span> (face4!=-1)
<a name="l00219"></a>00219                       {
<a name="l00220"></a>00220 <span class="comment">// int face4n=la_cl_perio.face_associee(face4-ndeb_p)+ndeb_p;</span>
<a name="l00221"></a>00221 <span class="comment">// on remplace face4 pae face4n dans tab2</span>
<a name="l00222"></a>00222                         assert(tab2[cpt]==face4+1);
<a name="l00223"></a>00223                         tab2[cpt]=face4n+1;
<a name="l00224"></a>00224                         cpt++;
<a name="l00225"></a>00225                       }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227                     <span class="keywordflow">if</span> (dimension==3)
<a name="l00228"></a>00228                       {
<a name="l00229"></a>00229                         <span class="keywordtype">int</span> face5=la_zone.<a class="code" href="classZone__VDF.html#ac081a43d3b552e8fb6b756e0748ef62b" title="Determine la face voisine de notre face en prevoyant que cette derniere puisse etre de type bord...">face_bord_amont</a>(num_face,(ori+2)%dimension,0);
<a name="l00230"></a>00230                         <span class="keywordtype">int</span> face6=la_zone.<a class="code" href="classZone__VDF.html#ac081a43d3b552e8fb6b756e0748ef62b" title="Determine la face voisine de notre face en prevoyant que cette derniere puisse etre de type bord...">face_bord_amont</a>(num_face,(ori+2)%dimension,1);
<a name="l00231"></a>00231                         <span class="keywordtype">int</span> face5n=<a class="code" href="Op__VDF__Face_8cpp.html#af4c4d3f3df90f2cfae84d1d3ee23d8e4">face_bord_amont2</a>(la_zone,num_face,(ori+2)%dimension,0);
<a name="l00232"></a>00232                         <span class="keywordtype">int</span> face6n=<a class="code" href="Op__VDF__Face_8cpp.html#af4c4d3f3df90f2cfae84d1d3ee23d8e4">face_bord_amont2</a>(la_zone,num_face,(ori+2)%dimension,1);
<a name="l00233"></a>00233 
<a name="l00234"></a>00234                         <span class="keywordflow">if</span> (face5!=-1)
<a name="l00235"></a>00235                           {
<a name="l00236"></a>00236 <span class="comment">// int face5n=la_cl_perio.face_associee(face5-ndeb_p)+ndeb_p;</span>
<a name="l00237"></a>00237 <span class="comment">// on remplace face4 pae face4n dans tab2</span>
<a name="l00238"></a>00238                             assert(tab2[cpt]==face5+1);
<a name="l00239"></a>00239                             tab2[cpt]=face5n+1;
<a name="l00240"></a>00240                             cpt++;
<a name="l00241"></a>00241                           }
<a name="l00242"></a>00242                         <span class="keywordflow">if</span> (face6!=-1)
<a name="l00243"></a>00243                           {
<a name="l00244"></a>00244 <span class="comment">// int face6n=la_cl_perio.face_associee(face6-ndeb_p)+ndeb_p;</span>
<a name="l00245"></a>00245 <span class="comment">// on remplace face4 pae face4n dans tab2</span>
<a name="l00246"></a>00246                             assert(tab2[cpt]==face6+1);
<a name="l00247"></a>00247                             tab2[cpt]=face6n+1;
<a name="l00248"></a>00248                             cpt++;
<a name="l00249"></a>00249                           }
<a name="l00250"></a>00250                       }
<a name="l00251"></a>00251                   }
<a name="l00252"></a>00252               }
<a name="l00253"></a>00253             }
<a name="l00254"></a>00254         }
<a name="l00255"></a>00255     }
<a name="l00256"></a>00256   <span class="comment">/*</span>
<a name="l00257"></a>00257 <span class="comment">    coeff=1;</span>
<a name="l00258"></a>00258 <span class="comment">    Cout&lt;&lt;&quot;iciMM&quot;&lt;&lt;finl;</span>
<a name="l00259"></a>00259 <span class="comment">    la_matrice.imprimer_formatte(Cout);</span>
<a name="l00260"></a>00260 <span class="comment">    coeff=0;</span>
<a name="l00261"></a>00261 <span class="comment">    Cerr&lt;&lt;la_zone.xv()&lt;&lt;finl;</span>
<a name="l00262"></a>00262 <span class="comment">  */</span>
<a name="l00263"></a>00263 }
<a name="l00264"></a>00264 
<a name="l00265"></a><a class="code" href="classOp__VDF__Face.html#a4fe467b002ba0383722191ea0add6d6f">00265</a> <span class="keywordtype">void</span> <a class="code" href="classOp__VDF__Face.html#a4fe467b002ba0383722191ea0add6d6f">Op_VDF_Face::modifier_pour_Cl</a>(<span class="keyword">const</span> <a class="code" href="classZone__VDF.html" title="class Zone_VDF Classe instanciable qui derive de Zone_VF. Cette classe contient les informations geom...">Zone_VDF</a>&amp; la_zone,
<a name="l00266"></a>00266                                    <span class="keyword">const</span> <a class="code" href="classZone__Cl__VDF.html" title="&lt; namespace TypeAreteCoinVDF">Zone_Cl_VDF</a>&amp; la_zone_cl,
<a name="l00267"></a>00267                                    <a class="code" href="classMatrice__Morse.html" title="Classe Matrice_Morse Represente une matrice M (creuse), non necessairement carree stockee au format M...">Matrice_Morse</a>&amp; la_matrice, <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; secmem)<span class="keyword"> const</span>
<a name="l00268"></a>00268 <span class="keyword"></span>{
<a name="l00269"></a>00269 <span class="comment">// Cerr &lt;&lt; &quot; dans modifier_pour_cl &quot; &lt;&lt; finl;</span>
<a name="l00270"></a>00270   <span class="keywordtype">int</span>  face, i, k,nbvois;
<a name="l00271"></a>00271 <span class="comment">// int nfin = la_zone.nb_faces();</span>
<a name="l00272"></a>00272   <span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; les_cl = la_zone_cl.<a class="code" href="classZone__Cl__dis__base.html#af75e0ed7786863e4d333bfb29d67c323" title="Renvoie la i-ieme condition aux limites. (version const)">les_conditions_limites</a>();
<a name="l00273"></a>00273 
<a name="l00274"></a>00274   <a class="code" href="classIntVect.html">IntVect</a>&amp; tab1=la_matrice.<a class="code" href="classMatrice__Morse.html#a7a49c763706dcfaed900f9d2cbb68716">get_set_tab1</a>();
<a name="l00275"></a>00275   <a class="code" href="classDoubleVect.html">DoubleVect</a>&amp; <a class="code" href="Champ__P1iP1B__implementation_8cpp.html#aa8c8f49390c3cf7c702d71a71bc977e3">coeff</a> = la_matrice.<a class="code" href="classMatrice__Morse.html#acd067e8514e5741f52b18a1d99746d11">get_set_coeff</a>();
<a name="l00276"></a>00276   <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; orientation=la_zone.<a class="code" href="classZone__VDF.html#a9a9bd747218e463b3408a3590c12814c" title="inline DoubleVect&amp; Zone_VDF::porosite_face() { return porosite_face_; }">orientation</a>();
<a name="l00277"></a>00277 
<a name="l00278"></a>00278   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; champ_inconnue = la_zone_cl.<a class="code" href="classMorEqn.html#a615dd9abff96edcb625fa0424a489864" title="Renvoie la reference sur l&#39;equation pointe par MorEqn::mon_equation. (version const)">equation</a>().<a class="code" href="classEquation__base.html#a5a1fce9487b9a8dd17020914100c2c89">inconnue</a>().<a class="code" href="classChamp__Inc.html#a28ef3d411d12cb5684ac5e799efb7d24" title="Appel a l&#39;objet sous-jacent Renvoie le tableau des valeurs au temps courant.">valeurs</a>();
<a name="l00279"></a>00279   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_comp = champ_inconnue.<a class="code" href="classDoubleVect.html#ab02d01cd1bdab66fbd66f9a47cc29e10">line_size</a>();
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="comment">// Prise en compte des conditions de type periodicite</span>
<a name="l00282"></a>00282 
<a name="l00283"></a>00283   <span class="keywordflow">for</span> (i=0; i&lt;les_cl.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>(); i++)
<a name="l00284"></a>00284     {
<a name="l00285"></a>00285       <span class="keyword">const</span> <a class="code" href="classCond__lim.html" title="classe Cond_lim Classe generique servant a representer n&#39;importe quelle classe derivee de la classe C...">Cond_lim</a>&amp; la_cl = les_cl[i];
<a name="l00286"></a>00286 
<a name="l00287"></a>00287       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00288"></a>00288         {
<a name="l00289"></a>00289           <span class="keyword">const</span> <a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>&amp; la_cl_Dirichlet = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDirichlet.html" title="classe Dirichlet Cette classe est la classe de base de la hierarchie des conditions aux limites de ty...">Dirichlet</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00290"></a>00290           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; la_front_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00291"></a>00291           <span class="keywordtype">int</span> numdeb = la_front_dis.num_premiere_face();
<a name="l00292"></a>00292           <span class="keywordtype">int</span> nfaces = la_front_dis.nb_faces();
<a name="l00293"></a>00293 
<a name="l00294"></a>00294           <span class="keywordflow">for</span> (face=numdeb; face &lt; (numdeb + nfaces); face++)
<a name="l00295"></a>00295             {
<a name="l00296"></a>00296               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l00297"></a>00297                 {
<a name="l00298"></a>00298                   <span class="keywordtype">int</span> idiag = tab1[face*nb_comp+comp]-1;
<a name="l00299"></a>00299                   coeff[idiag]=1;
<a name="l00300"></a>00300 
<a name="l00301"></a>00301 <span class="comment">// pour les voisins</span>
<a name="l00302"></a>00302 
<a name="l00303"></a>00303                   nbvois = tab1[face*nb_comp+1+comp] - tab1[face*nb_comp+comp];
<a name="l00304"></a>00304 
<a name="l00305"></a>00305                   <span class="keywordflow">for</span> (k=1; k &lt; nbvois; k++)
<a name="l00306"></a>00306                     {
<a name="l00307"></a>00307                       coeff[idiag+k]=0;
<a name="l00308"></a>00308                     }
<a name="l00309"></a>00309 <span class="comment">// pour le second membre</span>
<a name="l00310"></a>00310 <span class="comment">// Correction erreur (10/99):</span>
<a name="l00311"></a>00311 <span class="comment">// WEC : correction numero de face</span>
<a name="l00312"></a>00312                   <span class="keywordtype">int</span> ori = orientation(face);
<a name="l00313"></a>00313                   secmem[face*nb_comp+comp] = la_cl_Dirichlet.<a class="code" href="classDirichlet.html#ab59a2214e3208ac45048a2232c132803" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere au temps par defaut du cham...">val_imp</a>(face-numdeb,ori);
<a name="l00314"></a>00314                 }
<a name="l00315"></a>00315             }
<a name="l00316"></a>00316         }
<a name="l00317"></a>00317       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classSymetrie.html" title="classe Symetrie Sur les faces de symetrie on a les proprietes suivantes: - composante normale de la v...">Symetrie</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00318"></a>00318         {
<a name="l00319"></a>00319           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; la_front_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00320"></a>00320           <span class="keywordtype">int</span> numdeb = la_front_dis.<a class="code" href="classFront__VF.html#a4986f0c65653fe9eb40bbbff5a97bf16" title="Numero de la premiere face du bord dans la liste des faces.">num_premiere_face</a>();
<a name="l00321"></a>00321           <span class="keywordtype">int</span> nfaces = la_front_dis.<a class="code" href="classFront__VF.html#a341e2fcb5117b96e745fd7078ba86bab" title="Nombre de faces reelles du bord.">nb_faces</a>();
<a name="l00322"></a>00322 
<a name="l00323"></a>00323           <span class="keywordflow">for</span> (face=numdeb; face &lt; numdeb + nfaces; face++)
<a name="l00324"></a>00324             {
<a name="l00325"></a>00325               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l00326"></a>00326                 {
<a name="l00327"></a>00327                   <span class="keywordtype">int</span> idiag = tab1[face*nb_comp+comp]-1;
<a name="l00328"></a>00328                   coeff[idiag]=1;
<a name="l00329"></a>00329 
<a name="l00330"></a>00330 <span class="comment">// pour les voisins</span>
<a name="l00331"></a>00331 
<a name="l00332"></a>00332                   nbvois = tab1[face*nb_comp+1+comp] - tab1[face*nb_comp+comp];
<a name="l00333"></a>00333 
<a name="l00334"></a>00334                   <span class="keywordflow">for</span> (k=1; k &lt; nbvois; k++)
<a name="l00335"></a>00335                     {
<a name="l00336"></a>00336                       coeff[idiag+k]=0;
<a name="l00337"></a>00337                     }
<a name="l00338"></a>00338                   secmem[face*nb_comp+comp] = 0;
<a name="l00339"></a>00339                 }
<a name="l00340"></a>00340             }
<a name="l00341"></a>00341         }
<a name="l00342"></a>00342       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>()))
<a name="l00343"></a>00343         {
<a name="l00344"></a>00344           <span class="keyword">const</span> <a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>&amp; la_cl_Dirichlet_homogene = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDirichlet__homogene.html" title="Classe Dirichlet_homogene Cette classe est la classe de base de la hierarchie des conditions aux limi...">Dirichlet_homogene</a>,la_cl.<a class="code" href="classDeriv__Cond__lim__base.html#a482c910c704f6f51065a8b7d25acf48a">valeur</a>());
<a name="l00345"></a>00345           <span class="keyword">const</span> <a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>&amp; la_front_dis = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classFront__VF.html" title="class Front_VF">Front_VF</a>,la_cl.<a class="code" href="classCond__lim.html#a5b2d24809cee07727006a891d4ce8d22" title="Appel a l&#39;objet sous-jacent Renvoie la frontiere discretisee associee a la condition aux limites...">frontiere_dis</a>());
<a name="l00346"></a>00346           <span class="keywordtype">int</span> numdeb = la_front_dis.num_premiere_face();
<a name="l00347"></a>00347           <span class="keywordtype">int</span> nfaces = la_front_dis.nb_faces();
<a name="l00348"></a>00348 
<a name="l00349"></a>00349           <span class="keywordflow">for</span> (face=numdeb; face &lt; numdeb + nfaces; face++)
<a name="l00350"></a>00350             {
<a name="l00351"></a>00351               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_comp; comp++)
<a name="l00352"></a>00352                 {
<a name="l00353"></a>00353                   <span class="keywordtype">int</span> idiag = tab1[face*nb_comp+comp]-1;
<a name="l00354"></a>00354                   coeff[idiag]=1;
<a name="l00355"></a>00355 
<a name="l00356"></a>00356 <span class="comment">// pour les voisins</span>
<a name="l00357"></a>00357 
<a name="l00358"></a>00358                   nbvois = tab1[face*nb_comp+1+comp] - tab1[face*nb_comp+comp];
<a name="l00359"></a>00359 
<a name="l00360"></a>00360                   <span class="keywordflow">for</span> (k=1; k &lt; nbvois; k++)
<a name="l00361"></a>00361                     {
<a name="l00362"></a>00362                       coeff[idiag+k]=0;
<a name="l00363"></a>00363                     }
<a name="l00364"></a>00364 
<a name="l00365"></a>00365 <span class="comment">// pour le second membre</span>
<a name="l00366"></a>00366 <span class="comment">// Correction erreur (10/99) :</span>
<a name="l00367"></a>00367 <span class="comment">// WEC : correction numero de face</span>
<a name="l00368"></a>00368                   <span class="keywordtype">int</span> ori = orientation(face);
<a name="l00369"></a>00369                   secmem[face*nb_comp+comp] = la_cl_Dirichlet_homogene.<a class="code" href="classDirichlet__homogene.html#a79fd7fbac0243313b42a2c6b79eb546a" title="Renvoie la valeur imposee sur la i-eme composante du champ a la frontiere. Toujours 0 pour Dirichlet ...">val_imp</a>(face-numdeb,ori);
<a name="l00370"></a>00370                 }
<a name="l00371"></a>00371             }
<a name="l00372"></a>00372         }
<a name="l00373"></a>00373     }
<a name="l00374"></a>00374 }
<a name="l00375"></a>00375 
<a name="l00376"></a>00376 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:39 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
