<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Geometrie/Domaine.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Geometrie/Domaine.cpp</div>  </div>
</div>
<div class="contents">
<a href="Domaine_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Domaine.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Geometrie</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/69</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="Domaine_8h.html">Domaine.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;<a class="code" href="Sous__Zone_8h.html">Sous_Zone.h</a>&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="Zone__VF_8h.html">Zone_VF.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="Periodique_8h.html">Periodique.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="Zone__Cl__dis_8h.html">Zone_Cl_dis.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="Extraire__surface_8h.html">Extraire_surface.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="Frontiere__dis__base_8h.html">Frontiere_dis_base.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="NettoieNoeuds_8h.html">NettoieNoeuds.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="Reordonner__faces__periodiques_8h.html">Reordonner_faces_periodiques.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="MD__Vector__tools_8h.html">MD_Vector_tools.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="Scatter_8h.html">Scatter.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="Octree__Double_8h.html">Octree_Double.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="Interprete__bloc_8h.html">Interprete_bloc.h</a>&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="Domaine__dis_8h.html">Domaine_dis.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#ifdef MEDCOUPLING_</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="keyword">using</span> MEDCoupling::DataArrayInt;
<a name="l00040"></a>00040 <span class="keyword">using</span> MEDCoupling::DataArrayDouble;
<a name="l00041"></a>00041 <span class="preprocessor">#endif</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span>
<a name="l00043"></a><a class="code" href="Domaine_8cpp.html#a0b39d5b3122045322ff11e3996dae634">00043</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>,<span class="stringliteral">&quot;Domaine&quot;</span>,<a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>);
<a name="l00044"></a><a class="code" href="Domaine_8cpp.html#a3de878fa93a4e0678d036bc114a150f2">00044</a> <a class="code" href="MacList_8h.html#a261e70524a054683e3b6c94c8ccbc396">Implemente_liste</a>(<a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>);
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="comment">// Precondition:</span>
<a name="l00047"></a>00047 <span class="comment">// Parametre: Sortie&amp; s</span>
<a name="l00048"></a>00048 <span class="comment">// Signification: un flot de sortie</span>
<a name="l00049"></a>00049 <span class="comment">// Valeurs par defaut:</span>
<a name="l00050"></a>00050 <span class="comment">// Contraintes:</span>
<a name="l00051"></a>00051 <span class="comment">// Acces: entree/sortie</span>
<a name="l00052"></a>00052 <span class="comment">// Exception:</span>
<a name="l00053"></a>00053 <span class="comment">// Effets de bord:</span>
<a name="l00054"></a>00054 <span class="comment">// Postcondition: la methode ne modifie pas l&#39;objet</span>
<a name="l00055"></a>00055 <span class="comment">//</span>
<a name="l00056"></a>00056 <span class="comment">//</span>
<a name="l00057"></a>00057 <span class="comment">//</span><span class="comment"></span>
<a name="l00058"></a>00058 <span class="comment">//! Ecrit le domaine sur un flot de sortie.&lt;br&gt;On ecrit le nom, les sommets, les zones&lt;br&gt;et les sous-zones.</span>
<a name="l00059"></a>00059 <span class="comment"></span><span class="comment">/** \return Sortie\&amp;&lt;br&gt;</span>
<a name="l00060"></a>00060 <span class="comment">Signification: le flot de sortie modifie&lt;br&gt;</span>
<a name="l00061"></a>00061 <span class="comment">Contraintes: */</span>
<a name="l00062"></a><a class="code" href="classDomaine.html#a6b7eb07289c9ea2bcfc3bf1d371aaed4">00062</a> <a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classDomaine.html#a6b7eb07289c9ea2bcfc3bf1d371aaed4" title="Ecrit le domaine sur un flot de sortie. On ecrit le nom, les sommets, les zones et les sous-zones...">Domaine::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; s )<span class="keyword"> const</span>
<a name="l00063"></a>00063 <span class="keyword"></span>{
<a name="l00064"></a>00064   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Writing of &quot;</span> &lt;&lt; <a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>() &lt;&lt; <span class="stringliteral">&quot; nodes.&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00065"></a>00065 <span class="preprocessor">#ifdef SORT_POUR_DEBOG</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>  s.<a class="code" href="classSortie.html#a05322f1a56de2325a18095d3eea2e0a3">setf</a>(ios::scientific);
<a name="l00067"></a>00067   s.<a class="code" href="classSortie.html#a846ea173fd5e5b18fa2a0764f39724e3">precision</a>(20);
<a name="l00068"></a>00068 <span class="preprocessor">#endif</span>
<a name="l00069"></a>00069 <span class="preprocessor"></span>  s &lt;&lt; <a class="code" href="classDomaine.html#a9d3acef349da08a5dcddbbe32ef0693b">nom_</a> &lt;&lt; finl;
<a name="l00070"></a>00070   s &lt;&lt; <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>;
<a name="l00071"></a>00071   s &lt;&lt; <a class="code" href="classDomaine.html#a5bf3cc0ffbfee1d9d0c83b3e304aac25">les_zones</a>;
<a name="l00072"></a>00072 <span class="comment">// s &lt;&lt; les_ss_zones;</span>
<a name="l00073"></a>00073   <span class="keywordflow">return</span> s ;
<a name="l00074"></a>00074 }
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="comment">//</span>
<a name="l00078"></a>00078 <span class="comment">//</span>
<a name="l00079"></a>00079 <span class="comment">//</span>
<a name="l00080"></a>00080 <span class="comment">//</span>
<a name="l00081"></a>00081 <span class="comment">//</span>
<a name="l00082"></a>00082 <span class="comment">//</span>
<a name="l00083"></a>00083 <span class="comment">//</span>
<a name="l00084"></a>00084 <span class="comment">//</span>
<a name="l00085"></a>00085 <span class="comment">//</span>
<a name="l00086"></a>00086 <span class="comment">//</span>
<a name="l00087"></a>00087 <span class="comment">//</span>
<a name="l00088"></a>00088 <span class="comment">//</span><span class="comment"></span>
<a name="l00089"></a>00089 <span class="comment">//! Lit les specifications d&#39;un domaine&lt;br&gt;a partir d&#39;un flot d&#39;entree. Associe les zones&lt;br&gt;lues au domaine.&lt;br&gt;Format:&lt;br&gt;nom_domaine&lt;br&gt;bloc de lecture des Sommets&lt;br&gt;bloc de lecture des Zones&lt;br&gt;bloc de lecture des Sous_Zones&lt;br&gt;Attention: en parallele, chaque processeur s&#39;attend a lire une strucutre domaine&lt;br&gt;avec des infos de joint, mais il y a des communications globales.&lt;br&gt;Pour lire un domaine sur un seul processeur, il faut mettre le processeur dans&lt;br&gt;un groupe seul</span>
<a name="l00090"></a><a class="code" href="classDomaine.html#a2660c1194bf32f3a41350c16630c2520">00090</a> <span class="comment"></span><a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classDomaine.html#a2660c1194bf32f3a41350c16630c2520" title="Lit les specifications d&#39;un domaine a partir d&#39;un flot d&#39;entree. Associe les zones lues au domaine...">Domaine::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s)
<a name="l00091"></a>00091 {
<a name="l00092"></a>00092 <span class="preprocessor">#ifdef SORT_POUR_DEBOG</span>
<a name="l00093"></a>00093 <span class="preprocessor"></span>  s.setf(ios::scientific);
<a name="l00094"></a>00094   s.precision(20);
<a name="l00095"></a>00095 <span class="preprocessor">#endif</span>
<a name="l00096"></a>00096 <span class="preprocessor"></span><span class="comment">// Ajout BM: reset de la structure (a pour effet de debloquer la structure parallele)</span>
<a name="l00097"></a>00097   <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>.<a class="code" href="classDoubleTab.html#acb465ae8c9b24990db18002693b42dea" title="met le tableau dans l&#39;etat obtenu par le constructeur par defaut voir DoubleVect::reset()">reset</a>();
<a name="l00098"></a>00098   <a class="code" href="classDomaine.html#ad3a4531c849f2af73b79d175c5ca48c9">renum_som_perio</a>.<a class="code" href="classArrOfInt.html#afc932bc1df352ead26b844dcb090dacc" title="Remet le tableau dans l&#39;etat obtenu avec le constructeur par defaut (libere la memoire mais conserve ...">reset</a>();
<a name="l00099"></a>00099 <span class="comment">// ne pas faire reset du nom (deja lu)</span>
<a name="l00100"></a>00100 <span class="comment">// pour deformable je ne sais pas...</span>
<a name="l00101"></a>00101 <span class="comment">// Pour les sous_zones je ne sais pas non plus... les_ss_zones.vide();</span>
<a name="l00102"></a>00102   <a class="code" href="classDomaine.html#a5bf3cc0ffbfee1d9d0c83b3e304aac25">les_zones</a>.<a class="code" href="classliste.html#a6cf18c012f5c03fd88aafac2d263883e" title="Vide la liste.">vide</a>();
<a name="l00103"></a>00103 
<a name="l00104"></a>00104   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> tmp;
<a name="l00105"></a>00105   s &gt;&gt; tmp;
<a name="l00106"></a>00106 <span class="comment">// Si le domaine n&#39;est pas nomme, on prend celui lu</span>
<a name="l00107"></a>00107   <span class="keywordflow">if</span> (<a class="code" href="classDomaine.html#a9d3acef349da08a5dcddbbe32ef0693b">nom_</a>==<span class="stringliteral">&quot;??&quot;</span>) <a class="code" href="classDomaine.html#a9d3acef349da08a5dcddbbe32ef0693b">nom_</a>=tmp;
<a name="l00108"></a>00108   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Reading domain &quot;</span> &lt;&lt; <a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00109"></a>00109   s &gt;&gt; <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>;
<a name="l00110"></a>00110 <span class="comment">// PL : pas tout a fait exact le nombre affiche de sommets, on compte plusieurs fois les sommets des joints...</span>
<a name="l00111"></a>00111   <span class="keywordtype">int</span> nbsom = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_sum</a>(sommets.dimension(0));
<a name="l00112"></a>00112   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Number of nodes: &quot;</span> &lt;&lt; nbsom &lt;&lt; finl;
<a name="l00113"></a>00113   s &gt;&gt; <a class="code" href="classDomaine.html#a5bf3cc0ffbfee1d9d0c83b3e304aac25">les_zones</a>;
<a name="l00114"></a>00114 <span class="comment">// s &gt;&gt; les_ss_zones;</span>
<a name="l00115"></a>00115   <span class="keywordflow">if</span> ( (<a class="code" href="classProcess.html#a6bf692ce58d9578aa62ac3c07b8caaa1" title="renvoie le nombre de processeurs dans le groupe courant Voir Comm_Group::nproc() et PE_Groups::curren...">Process::nproc</a>()==1) &amp;&amp; (<a class="code" href="classNettoieNoeuds.html#afc99956ed4f8454dfb675528e2207e2a" title="Fonction principale de l&#39;interprete NettoieNoeuds Structure du jeu de donnee (en dimension 2) : Netto...">NettoieNoeuds::NettoiePasNoeuds</a>==0) )
<a name="l00116"></a>00116     {
<a name="l00117"></a>00117       <a class="code" href="classNettoieNoeuds.html#a9d727b7775b661cf5721ec322f061727">NettoieNoeuds::nettoie</a>(*<span class="keyword">this</span>);
<a name="l00118"></a>00118       nbsom = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_sum</a>(sommets.dimension(0));
<a name="l00119"></a>00119       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot; Number of nodes after node-cleanup: &quot;</span> &lt;&lt; nbsom &lt;&lt; finl;
<a name="l00120"></a>00120     }
<a name="l00121"></a>00121   les_zones.associer_domaine(*<span class="keyword">this</span>);
<a name="l00122"></a>00122 
<a name="l00123"></a>00123 <span class="comment">// On initialise les descripteurs &quot;sequentiels&quot; (attention, cela bloque le resize des tableaux sommets et elements !)</span>
<a name="l00124"></a>00124   <a class="code" href="classScatter.html#a1874139ffd29d5a68191bc7828d3a5bd" title="cree des descripteurs sequentiels pour les tableaux sommets et elements du domaine (necessaire car Sc...">Scatter::init_sequential_domain</a>(*<span class="keyword">this</span>);
<a name="l00125"></a>00125 
<a name="l00126"></a>00126   <span class="keywordflow">return</span> s;
<a name="l00127"></a>00127 }
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 
<a name="l00130"></a>00130 <span class="comment">//</span><span class="comment"></span>
<a name="l00131"></a>00131 <span class="comment">//! only read vertices from the stream s</span>
<a name="l00132"></a><a class="code" href="classDomaine.html#a5ebe2a9e34ba2e1b8b54541e7418e08b">00132</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classDomaine.html#a5ebe2a9e34ba2e1b8b54541e7418e08b" title="only read vertices from the stream s">Domaine::read_vertices</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; s)
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134 <span class="comment">// Ajout BM: reset de la structure (a pour effet de debloquer la structure parallele)</span>
<a name="l00135"></a>00135   <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>.<a class="code" href="classDoubleTab.html#acb465ae8c9b24990db18002693b42dea" title="met le tableau dans l&#39;etat obtenu par le constructeur par defaut voir DoubleVect::reset()">reset</a>();
<a name="l00136"></a>00136   <a class="code" href="classDomaine.html#ad3a4531c849f2af73b79d175c5ca48c9">renum_som_perio</a>.<a class="code" href="classArrOfInt.html#afc932bc1df352ead26b844dcb090dacc" title="Remet le tableau dans l&#39;etat obtenu avec le constructeur par defaut (libere la memoire mais conserve ...">reset</a>();
<a name="l00137"></a>00137   <a class="code" href="classDomaine.html#a5bf3cc0ffbfee1d9d0c83b3e304aac25">les_zones</a>.<a class="code" href="classliste.html#a6cf18c012f5c03fd88aafac2d263883e" title="Vide la liste.">vide</a>();
<a name="l00138"></a>00138 
<a name="l00139"></a>00139   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> tmp;
<a name="l00140"></a>00140   s &gt;&gt; tmp;
<a name="l00141"></a>00141 <span class="comment">// Si le domaine n&#39;est pas nomme, on prend celui lu</span>
<a name="l00142"></a>00142   <span class="keywordflow">if</span> (<a class="code" href="classDomaine.html#a9d3acef349da08a5dcddbbe32ef0693b">nom_</a>==<span class="stringliteral">&quot;??&quot;</span>) <a class="code" href="classDomaine.html#a9d3acef349da08a5dcddbbe32ef0693b">nom_</a>=tmp;
<a name="l00143"></a>00143   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Reading domain &quot;</span> &lt;&lt; <a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00144"></a>00144   s &gt;&gt; <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>;
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 <span class="comment">// Precondition:</span>
<a name="l00150"></a>00150 <span class="comment">// Parametre:</span>
<a name="l00151"></a>00151 <span class="comment">// Signification:</span>
<a name="l00152"></a>00152 <span class="comment">// Valeurs par defaut:</span>
<a name="l00153"></a>00153 <span class="comment">// Contraintes:</span>
<a name="l00154"></a>00154 <span class="comment">// Acces:</span>
<a name="l00155"></a>00155 <span class="comment">// </span>
<a name="l00156"></a>00156 <span class="comment">// Signification:</span>
<a name="l00157"></a>00157 <span class="comment">// Contraintes:</span>
<a name="l00158"></a>00158 <span class="comment">// Exception:</span>
<a name="l00159"></a>00159 <span class="comment">// Effets de bord:</span>
<a name="l00160"></a>00160 <span class="comment">// Postcondition:</span>
<a name="l00161"></a>00161 <span class="comment">//</span>
<a name="l00162"></a>00162 <span class="comment">//</span>
<a name="l00163"></a>00163 <span class="comment">//</span>
<a name="l00164"></a>00164 <span class="comment">//</span>
<a name="l00165"></a>00165 <span class="comment">//</span><span class="comment"></span>
<a name="l00166"></a>00166 <span class="comment">//! Constructeur par defaut d&#39;un objet Domaine.&lt;br&gt;Ne fait rien sauf fixer la valeur d&#39;epsilon&lt;br&gt;a Objet_U::precision_geom&lt;br&gt;Si 2 points d&#39;un domaine sont separes d&#39;une distance&lt;br&gt;inferieure ou egale a epsilon ils sont consideres egaux.</span>
<a name="l00167"></a><a class="code" href="classDomaine.html#a29b7a1ce071402c47f1559660c71b512">00167</a> <span class="comment"></span><a class="code" href="classDomaine.html#a29b7a1ce071402c47f1559660c71b512" title="Constructeur par defaut d&#39;un objet Domaine. Ne fait rien sauf fixer la valeur d&#39;epsilon a Objet_U::pr...">Domaine::Domaine</a>() : epsilon_(<a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>::precision_geom),deformable_(0)
<a name="l00168"></a>00168 {
<a name="l00169"></a>00169 <span class="preprocessor">#ifdef MEDCOUPLING_</span>
<a name="l00170"></a>00170 <span class="preprocessor"></span>  mesh_ = NULL;
<a name="l00171"></a>00171 <span class="preprocessor">#endif</span>
<a name="l00172"></a>00172 <span class="preprocessor"></span>  <a class="code" href="classDomaine.html#ac74bcdded30b9442f6b88bdc8c039a02">axi1d</a> = 0;
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="comment">//</span><span class="comment"></span>
<a name="l00176"></a>00176 <span class="comment">//! Renvoie le nombre total de sommets</span>
<a name="l00177"></a><a class="code" href="classDomaine.html#a394e61cf1993665886de0fbbd0c0178e">00177</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classDomaine.html#a394e61cf1993665886de0fbbd0c0178e" title="Renvoie le nombre total de sommets.">Domaine::nb_som_tot</a>()<span class="keyword"> const</span>
<a name="l00178"></a>00178 <span class="keyword"></span>{
<a name="l00179"></a>00179   <span class="keywordflow">return</span> <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>.<a class="code" href="classDoubleTab.html#a3eadd63f3ba20c1b454d760b430acbf7" title="Returns the total dimensions of the multi-dimensionnal array, including virtual items (used in parall...">dimension_tot</a>(0);
<a name="l00180"></a>00180 }
<a name="l00181"></a>00181 
<a name="l00182"></a>00182 <span class="comment">//</span><span class="comment"></span>
<a name="l00183"></a>00183 <span class="comment">//! Renvoie le nombre de sommets</span>
<a name="l00184"></a><a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce">00184</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">Domaine::nb_som</a>()<span class="keyword"> const</span>
<a name="l00185"></a>00185 <span class="keyword"></span>{
<a name="l00186"></a>00186   <span class="keywordflow">return</span> <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00187"></a>00187 }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189 <span class="comment">// Precondition:</span>
<a name="l00190"></a>00190 <span class="comment">// Parametre: Zone&amp; une_zone</span>
<a name="l00191"></a>00191 <span class="comment">// Signification: la zone a ajouter au domaine</span>
<a name="l00192"></a>00192 <span class="comment">// Valeurs par defaut:</span>
<a name="l00193"></a>00193 <span class="comment">// Contraintes:</span>
<a name="l00194"></a>00194 <span class="comment">// Acces: entree</span>
<a name="l00195"></a>00195 <span class="comment">// Exception:</span>
<a name="l00196"></a>00196 <span class="comment">// Effets de bord:</span>
<a name="l00197"></a>00197 <span class="comment">// Postcondition:</span>
<a name="l00198"></a>00198 <span class="comment">//</span><span class="comment"></span>
<a name="l00199"></a>00199 <span class="comment">//! Ajoute une Zone au domaine.</span>
<a name="l00200"></a>00200 <span class="comment"></span><span class="comment">/** \return Zone\&amp;&lt;br&gt;</span>
<a name="l00201"></a>00201 <span class="comment">Signification: la zone que l&#39;on vient d&#39;ajouter au domaine&lt;br&gt;</span>
<a name="l00202"></a>00202 <span class="comment">Contraintes: */</span>
<a name="l00203"></a><a class="code" href="classDomaine.html#a878185dc89da68b027feb31728a5c6f8">00203</a> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; <a class="code" href="classDomaine.html#a6204a2b89860bfd74ca2858d1d8750bf" title="Ajoute une Sous_Zone au domaine.">Domaine::add</a>(<a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; une_zone)
<a name="l00204"></a>00204 {
<a name="l00205"></a>00205   <span class="keywordflow">return</span> <a class="code" href="classDomaine.html#a5bf3cc0ffbfee1d9d0c83b3e304aac25">les_zones</a>.<a class="code" href="classList__Zone.html#a84b7b641fda9188064e077ba92cc3eea">add</a>(une_zone);
<a name="l00206"></a>00206 }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <span class="comment">// Precondition:</span>
<a name="l00209"></a>00209 <span class="comment">// Parametre: DoubleTab&amp; soms</span>
<a name="l00210"></a>00210 <span class="comment">// Signification: le tableau contenant les coordonnees</span>
<a name="l00211"></a>00211 <span class="comment">// des noeuds a ajouter au domaine</span>
<a name="l00212"></a>00212 <span class="comment">// Valeurs par defaut:</span>
<a name="l00213"></a>00213 <span class="comment">// Contraintes: reference constante</span>
<a name="l00214"></a>00214 <span class="comment">// Acces: entree</span>
<a name="l00215"></a>00215 <span class="comment">// </span>
<a name="l00216"></a>00216 <span class="comment">// Signification:</span>
<a name="l00217"></a>00217 <span class="comment">// Contraintes:</span>
<a name="l00218"></a>00218 <span class="comment">// Exception:</span>
<a name="l00219"></a>00219 <span class="comment">// Effets de bord:</span>
<a name="l00220"></a>00220 <span class="comment">// Postcondition:</span>
<a name="l00221"></a>00221 <span class="comment">//</span>
<a name="l00222"></a>00222 <span class="comment">//</span><span class="comment"></span>
<a name="l00223"></a>00223 <span class="comment">//! Ajoute des noeuds (ou sommets) au domaine&lt;br&gt;(sans verifier les doublons)</span>
<a name="l00224"></a><a class="code" href="classDomaine.html#a4bfe91e45d505b46196bace2f9d0d698">00224</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classDomaine.html#a9e067ee24e1952315722374190c8cb06" title="Ajoute des noeuds au domaine avec elimination des noeuds double au retour nums contient les nouveaux ...">Domaine::ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; soms)
<a name="l00225"></a>00225 {
<a name="l00226"></a>00226   <span class="keywordtype">int</span> oldsz=<a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00227"></a>00227   <span class="keywordtype">int</span> ajoutsz=soms.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00228"></a>00228   <span class="keywordtype">int</span> dim=soms.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00229"></a>00229   <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(oldsz+ajoutsz,dim);
<a name="l00230"></a>00230   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;ajoutsz; i++)
<a name="l00231"></a>00231     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;dim; k++)
<a name="l00232"></a>00232       <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>(oldsz+i,k)=soms(i,k) ;
<a name="l00233"></a>00233 }
<a name="l00234"></a>00234 
<a name="l00235"></a>00235 <span class="comment">// Precondition:</span>
<a name="l00236"></a>00236 <span class="comment">// Parametre: DoubleTab&amp; soms</span>
<a name="l00237"></a>00237 <span class="comment">// Signification: le tableau contenant les coordonnees</span>
<a name="l00238"></a>00238 <span class="comment">// des noeuds a ajouter au domaine</span>
<a name="l00239"></a>00239 <span class="comment">// Valeurs par defaut:</span>
<a name="l00240"></a>00240 <span class="comment">// Contraintes: reference constante</span>
<a name="l00241"></a>00241 <span class="comment">// Acces: entree</span>
<a name="l00242"></a>00242 <span class="comment">// Parametre: IntVect&amp; nums</span>
<a name="l00243"></a>00243 <span class="comment">// Signification: le tableau des nouveaux numeros apres</span>
<a name="l00244"></a>00244 <span class="comment">// ajout des nouveaux noeuds et elimination</span>
<a name="l00245"></a>00245 <span class="comment">// des doublons.</span>
<a name="l00246"></a>00246 <span class="comment">// Valeurs par defaut:</span>
<a name="l00247"></a>00247 <span class="comment">// Contraintes:</span>
<a name="l00248"></a>00248 <span class="comment">// Acces: sortie</span>
<a name="l00249"></a>00249 <span class="comment">// </span>
<a name="l00250"></a>00250 <span class="comment">// Signification:</span>
<a name="l00251"></a>00251 <span class="comment">// Contraintes:</span>
<a name="l00252"></a>00252 <span class="comment">// Exception: des noeuds double ont ete trouve</span>
<a name="l00253"></a>00253 <span class="comment">// Effets de bord:</span>
<a name="l00254"></a>00254 <span class="comment">// Postcondition:</span>
<a name="l00255"></a>00255 <span class="comment">//</span>
<a name="l00256"></a>00256 <span class="comment">//</span>
<a name="l00257"></a>00257 <span class="comment">//</span><span class="comment"></span>
<a name="l00258"></a>00258 <span class="comment">//! Ajoute des noeuds au domaine avec elimination des noeuds double&lt;br&gt;au retour nums contient les nouveaux numeros des noeuds de soms&lt;br&gt;apres elimination des doublons.</span>
<a name="l00259"></a><a class="code" href="classDomaine.html#a9e067ee24e1952315722374190c8cb06">00259</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classDomaine.html#a9e067ee24e1952315722374190c8cb06" title="Ajoute des noeuds au domaine avec elimination des noeuds double au retour nums contient les nouveaux ...">Domaine::ajouter</a>(<span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; soms, <a class="code" href="classIntVect.html">IntVect</a>&amp; nums)
<a name="l00260"></a>00260 {
<a name="l00261"></a>00261   <span class="keywordtype">int</span> oldsz=<a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00262"></a>00262   <span class="keywordtype">int</span> ajoutsz=soms.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00263"></a>00263   <span class="keywordtype">int</span> dim=soms.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00264"></a>00264   nums.<a class="code" href="classIntVect.html#a5900779fd9a3f9a82c68007a42b87d98" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(ajoutsz);
<a name="l00265"></a>00265   nums=-1;
<a name="l00266"></a>00266   <span class="keywordflow">if</span>(oldsz!=0)
<a name="l00267"></a>00267     {
<a name="l00268"></a>00268       assert(dim==<a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1));
<a name="l00269"></a>00269       <a class="code" href="classOctree__Double.html" title=": Un octree permettant de chercher dans l&#39;espace des elements ou des points decrits par des coordonne...">Octree_Double</a> octree;
<a name="l00270"></a>00270       octree.<a class="code" href="classOctree__Double.html#a0b66bd315e7f45a024695b6a2764e7d4" title="construit un octree contenant les points de coordonnees coords. Si include_virtual=1, on stocke coords.dimension_tot(0) elements, sinon on en stocke coords.dimension(0) Si epsilon = 0, on construit un octree de points de taille nulle (chaque point se trouve dans un seul octree_floor) Sinon, on construit un octree d&#39;elements cubiques centres sur les coords, de demie-largeur epsilon. Un point peut alors se trouver dans plusieurs octree_floor.">build_nodes</a>(<a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>(), 0 <span class="comment">/* ne pas inclure les sommets virtuels */</span>);
<a name="l00271"></a>00271 
<a name="l00272"></a>00272       <span class="keywordtype">int</span> i, k;
<a name="l00273"></a>00273       <span class="keywordtype">int</span> <a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>=0;
<a name="l00274"></a>00274       <a class="code" href="classArrOfDouble.html" title="Represente un tableau d&#39;elements de type double. L&#39;etat du tableau est caracterise par la valeur de p...">ArrOfDouble</a> tab_coord(dim);
<a name="l00275"></a>00275       <a class="code" href="classArrOfInt.html" title="Represente un tableau d&#39;elements de type int. L&#39;etat du tableau est caracterise par la valeur de p_ e...">ArrOfInt</a> liste_sommets;
<a name="l00276"></a>00276       liste_sommets.<a class="code" href="classArrOfInt.html#a22d744bcd452d039580d1d9186f02b4e" title="Change le mode l&#39;allocation memoire: reallocation d&#39;un tableau a chaque changement de taille (flag = ...">set_smart_resize</a>(1);
<a name="l00277"></a>00277       <span class="keywordflow">for</span>( i=0; i&lt; ajoutsz; i++)
<a name="l00278"></a>00278         {
<a name="l00279"></a>00279           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dim; j++)
<a name="l00280"></a>00280             tab_coord[j] = soms(i,j);
<a name="l00281"></a>00281           octree.search_elements_box(tab_coord, <a class="code" href="classDomaine.html#ae1eb151f3c31f1f2b3f61a4d6be849eb">epsilon_</a>, liste_sommets);
<a name="l00282"></a>00282           octree.search_nodes_close_to(tab_coord, <a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>(), liste_sommets, <a class="code" href="classDomaine.html#ae1eb151f3c31f1f2b3f61a4d6be849eb">epsilon_</a>);
<a name="l00283"></a>00283           <span class="keyword">const</span> <span class="keywordtype">int</span> nb_sommets_proches = liste_sommets.<a class="code" href="classArrOfInt.html#a0f41611fce0a58c3ef3409dc1af8904d" title="Renvoie la taille du tableau (nombre d&#39;elements declares a la construction ou a resize_array()). C&#39;est le nombre d&#39;elements accessibles a operator[].">size_array</a>();
<a name="l00284"></a>00284           <span class="keywordflow">if</span> (nb_sommets_proches == 0)
<a name="l00285"></a>00285             {
<a name="l00286"></a>00286 <span class="comment">// Aucun sommet du premier domaine n&#39;est proche du sommet i.</span>
<a name="l00287"></a>00287 <span class="comment">// Garder i.</span>
<a name="l00288"></a>00288             }
<a name="l00289"></a>00289           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nb_sommets_proches == 1)
<a name="l00290"></a>00290             {
<a name="l00291"></a>00291 <span class="comment">// Un sommet est confondu avec le sommet i a epsilon_ pres.</span>
<a name="l00292"></a>00292 <span class="comment">// Ne pas garder le sommet</span>
<a name="l00293"></a>00293               nums(i) = liste_sommets[0];
<a name="l00294"></a>00294               compteur++;
<a name="l00295"></a>00295             }
<a name="l00296"></a>00296           <span class="keywordflow">else</span>
<a name="l00297"></a>00297             {
<a name="l00298"></a>00298 <span class="comment">// Plusieurs sommets du domaine initial sont dans un rayon de epsilon.</span>
<a name="l00299"></a>00299 <span class="comment">// epsilon est trop grand.</span>
<a name="l00300"></a>00300               <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error : several nodes of the domain 1 are within radius epsilon=&quot;</span>
<a name="l00301"></a>00301                    &lt;&lt; <a class="code" href="classDomaine.html#ae1eb151f3c31f1f2b3f61a4d6be849eb">epsilon_</a> &lt;&lt; <span class="stringliteral">&quot; of point &quot;</span> &lt;&lt; tab_coord &lt;&lt; <span class="stringliteral">&quot;. We must reduce epsilon. &quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00302"></a>00302               <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00303"></a>00303             }
<a name="l00304"></a>00304         }
<a name="l00305"></a>00305       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; compteur &lt;&lt; <span class="stringliteral">&quot; double nodes were found \n&quot;</span>;
<a name="l00306"></a>00306       <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>.<a class="code" href="classDoubleTab.html#ae83b4d31205c53d9c8d2b43da178ce75" title="Change la taille du vecteur (identique a resize_array() pour le traitement des anciennes valeurs et d...">resize</a>(oldsz+ajoutsz-compteur,dim);
<a name="l00307"></a>00307       compteur=0;
<a name="l00308"></a>00308       <span class="keywordflow">for</span>( i=0; i&lt;ajoutsz; i++)
<a name="l00309"></a>00309         <span class="keywordflow">if</span>(nums(i)==-1)
<a name="l00310"></a>00310           {
<a name="l00311"></a>00311             nums(i)=oldsz+<a class="code" href="Memoire_8cpp.html#ade857a99d48bcb8cfaa57c4cd8d7d2e8">compteur</a>;
<a name="l00312"></a>00312             compteur++;
<a name="l00313"></a>00313             <span class="keywordflow">for</span>( k=0; k&lt;dim; k++)
<a name="l00314"></a>00314               <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>(nums(i),k)=soms(i,k) ;
<a name="l00315"></a>00315           }
<a name="l00316"></a>00316     }
<a name="l00317"></a>00317   <span class="keywordflow">else</span>
<a name="l00318"></a>00318     {
<a name="l00319"></a>00319       <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>=soms;
<a name="l00320"></a>00320 <span class="comment">// if som has a descriptor, delete it:</span>
<a name="l00321"></a>00321       <a class="code" href="classDomaine.html#ae345cdb7a62c4fb41e256fb5a01a5d53">sommets</a>.<a class="code" href="classDoubleTab.html#a2f40241acb678b0dd0dac7ee4f421b1d" title="associe le md_vector au vecteur (voir DoubleVect::set_md_vector()) dimension(0) sera initialise a md_...">set_md_vector</a>(<a class="code" href="classMD__Vector.html" title=": Cette classe est un DERIV mais l&#39;objet pointe est partage entre plusieurs instances de cette classe...">MD_Vector</a>());
<a name="l00322"></a>00322       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;ajoutsz; i++)
<a name="l00323"></a>00323         {
<a name="l00324"></a>00324           nums(i)=i;
<a name="l00325"></a>00325         }
<a name="l00326"></a>00326     }
<a name="l00327"></a>00327 }
<a name="l00328"></a>00328 
<a name="l00329"></a>00329 <span class="comment">// Precondition:</span>
<a name="l00330"></a>00330 <span class="comment">// Parametre:</span>
<a name="l00331"></a>00331 <span class="comment">// Signification:</span>
<a name="l00332"></a>00332 <span class="comment">// Valeurs par defaut:</span>
<a name="l00333"></a>00333 <span class="comment">// Contraintes:</span>
<a name="l00334"></a>00334 <span class="comment">// Acces:</span>
<a name="l00335"></a>00335 <span class="comment">// </span>
<a name="l00336"></a>00336 <span class="comment">// Signification:</span>
<a name="l00337"></a>00337 <span class="comment">// Contraintes:</span>
<a name="l00338"></a>00338 <span class="comment">// Exception:</span>
<a name="l00339"></a>00339 <span class="comment">// Effets de bord:</span>
<a name="l00340"></a>00340 <span class="comment">// Postcondition:</span>
<a name="l00341"></a>00341 <span class="comment">//</span><span class="comment"></span>
<a name="l00342"></a>00342 <span class="comment">//! Rassemble les Zones de meme type</span>
<a name="l00343"></a><a class="code" href="classDomaine.html#a17683d925e73c1d37ddd8cd433993a12">00343</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classDomaine.html#a17683d925e73c1d37ddd8cd433993a12" title="Rassemble les Zones de meme type.">Domaine::comprimer</a>()
<a name="l00344"></a>00344 {
<a name="l00345"></a>00345   <a class="code" href="classDomaine.html#a5bf3cc0ffbfee1d9d0c83b3e304aac25">les_zones</a>.<a class="code" href="classZones.html#ac44eff9ec3300f7d43aa1f0979ba3815" title="On agglomere les Zones de meme type.">comprimer</a>();
<a name="l00346"></a>00346 }
<a name="l00347"></a>00347 
<a name="l00348"></a>00348 <span class="comment">// Precondition:</span>
<a name="l00349"></a>00349 <span class="comment">// Parametre: Objet_U&amp; ob</span>
<a name="l00350"></a>00350 <span class="comment">// Signification: l&#39;objet a associer</span>
<a name="l00351"></a>00351 <span class="comment">// Valeurs par defaut:</span>
<a name="l00352"></a>00352 <span class="comment">// Contraintes: doit deriver Sous_Zone</span>
<a name="l00353"></a>00353 <span class="comment">// Acces:</span>
<a name="l00354"></a>00354 <span class="comment">// Exception:</span>
<a name="l00355"></a>00355 <span class="comment">// Effets de bord:</span>
<a name="l00356"></a>00356 <span class="comment">// Postcondition:</span>
<a name="l00357"></a>00357 <span class="comment">//</span>
<a name="l00358"></a>00358 <span class="comment">//</span>
<a name="l00359"></a>00359 <span class="comment">//</span>
<a name="l00360"></a>00360 <span class="comment">//</span><span class="comment"></span>
<a name="l00361"></a>00361 <span class="comment">//! Association d&#39;une Sous_Zone au domaine.&lt;br&gt;L&#39;interface permet de passer n&#39;importe quel&lt;br&gt;Objet_U mais ne gere (dynamiquement) que&lt;br&gt;l&#39;association d&#39;un objet derivant Sous_Zone.</span>
<a name="l00362"></a>00362 <span class="comment"></span><span class="comment">/** \return int&lt;br&gt;</span>
<a name="l00363"></a>00363 <span class="comment">Signification: 1 si l&#39;association a reussie&lt;br&gt;</span>
<a name="l00364"></a>00364 <span class="comment">0 sinon (l&#39;objet n&#39;etait pas derive Sous_Zone)&lt;br&gt;</span>
<a name="l00365"></a>00365 <span class="comment">Contraintes: */</span>
<a name="l00366"></a><a class="code" href="classDomaine.html#afc3831b68ea05e464cb89abf44d875ce">00366</a> <span class="keywordtype">int</span> <a class="code" href="classDomaine.html#afc3831b68ea05e464cb89abf44d875ce" title="Association d&#39;une Sous_Zone au domaine. L&#39;interface permet de passer n&#39;importe quel Objet_U mais ne g...">Domaine::associer_</a>(<a class="code" href="classObjet__U.html" title="classe Objet_U Cette classe est la classe de base des Objets de TRUST Dans les classes derivees de Ob...">Objet_U</a>&amp; ob)
<a name="l00367"></a>00367 {
<a name="l00368"></a>00368   <span class="keywordflow">if</span>( <a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classSous__Zone.html" title="Classe Sous_Zone Represente une sous zone volumique i.e un sous ensemble de polyedres d&#39;un objet de t...">Sous_Zone</a>, ob))
<a name="l00369"></a>00369     {
<a name="l00370"></a>00370       <a class="code" href="classDomaine.html#a6204a2b89860bfd74ca2858d1d8750bf" title="Ajoute une Sous_Zone au domaine.">add</a>(<a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classSous__Zone.html" title="Classe Sous_Zone Represente une sous zone volumique i.e un sous ensemble de polyedres d&#39;un objet de t...">Sous_Zone</a>, ob));
<a name="l00371"></a>00371       ob.<a class="code" href="classObjet__U.html#a1b935d498f25a47cb114b057ca878dd8" title="Associe l&#39;Objet_U a un autre Objet_U Methode virtuelle a surcharger.">associer_</a>(*<span class="keyword">this</span>);
<a name="l00372"></a>00372       <span class="keywordflow">return</span> 1;
<a name="l00373"></a>00373     }
<a name="l00374"></a>00374   <span class="keywordflow">return</span> 0;
<a name="l00375"></a>00375 }
<a name="l00376"></a>00376 
<a name="l00377"></a>00377 
<a name="l00378"></a>00378 <span class="comment">// Precondition:</span>
<a name="l00379"></a>00379 <span class="comment">// Parametre: Sous_Zone&amp; ssz</span>
<a name="l00380"></a>00380 <span class="comment">// Signification: la Sous-zone a ajouter au domaine</span>
<a name="l00381"></a>00381 <span class="comment">// Valeurs par defaut:</span>
<a name="l00382"></a>00382 <span class="comment">// Contraintes: reference constante</span>
<a name="l00383"></a>00383 <span class="comment">// Acces: entree</span>
<a name="l00384"></a>00384 <span class="comment">// </span>
<a name="l00385"></a>00385 <span class="comment">// Signification:</span>
<a name="l00386"></a>00386 <span class="comment">// Contraintes:</span>
<a name="l00387"></a>00387 <span class="comment">// Exception:</span>
<a name="l00388"></a>00388 <span class="comment">// Effets de bord:</span>
<a name="l00389"></a>00389 <span class="comment">// Postcondition:</span>
<a name="l00390"></a>00390 <span class="comment">//</span><span class="comment"></span>
<a name="l00391"></a>00391 <span class="comment">//! Ajoute une Sous_Zone au domaine.</span>
<a name="l00392"></a><a class="code" href="classDomaine.html#a6204a2b89860bfd74ca2858d1d8750bf">00392</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classDomaine.html#a6204a2b89860bfd74ca2858d1d8750bf" title="Ajoute une Sous_Zone au domaine.">Domaine::add</a>(<span class="keyword">const</span> <a class="code" href="classSous__Zone.html" title="Classe Sous_Zone Represente une sous zone volumique i.e un sous ensemble de polyedres d&#39;un objet de t...">Sous_Zone</a>&amp; ssz)
<a name="l00393"></a>00393 {
<a name="l00394"></a>00394   <a class="code" href="classDomaine.html#a152005216d7e11a4e14cf65c33898d6f">les_ss_zones</a>.<a class="code" href="classList__Ref__Sous__Zone.html#a20de41fffada50805e71886ef1949694">add</a>(ssz);
<a name="l00395"></a>00395 }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="comment">// Precondition:</span>
<a name="l00398"></a>00398 <span class="comment">// Parametre:</span>
<a name="l00399"></a>00399 <span class="comment">// Signification:</span>
<a name="l00400"></a>00400 <span class="comment">// Valeurs par defaut:</span>
<a name="l00401"></a>00401 <span class="comment">// Contraintes:</span>
<a name="l00402"></a>00402 <span class="comment">// Acces:</span>
<a name="l00403"></a>00403 <span class="comment">// </span>
<a name="l00404"></a>00404 <span class="comment">// Signification:</span>
<a name="l00405"></a>00405 <span class="comment">// Contraintes:</span>
<a name="l00406"></a>00406 <span class="comment">// Exception:</span>
<a name="l00407"></a>00407 <span class="comment">// Effets de bord:</span>
<a name="l00408"></a>00408 <span class="comment">// Postcondition: les mailles du domaine sont reordonnees</span>
<a name="l00409"></a>00409 <span class="comment">// suivant les conventions de Trio-U</span>
<a name="l00410"></a>00410 <span class="comment">//</span>
<a name="l00411"></a>00411 <span class="comment">//</span><span class="comment"></span>
<a name="l00412"></a>00412 <span class="comment">//! Reordonne les mailles du domaine suivant les&lt;br&gt;conventions de Trio-U.</span>
<a name="l00413"></a><a class="code" href="classDomaine.html#a0d407f1671c26ed0f3d3d331135a77e2">00413</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classDomaine.html#a0d407f1671c26ed0f3d3d331135a77e2" title="Reordonne les mailles du domaine suivant les conventions de Trio-U.">Domaine::reordonner</a>()
<a name="l00414"></a>00414 {
<a name="l00415"></a>00415   <a class="code" href="classDomaine.html#a5bf3cc0ffbfee1d9d0c83b3e304aac25">les_zones</a>.<a class="code" href="classZones.html#a8603cba5c523f3b76801b4d7e2c84447" title="Reordonne les elements du maillage. On appelle Zone::reordonner() sur chaque zone de la liste...">reordonner</a>();
<a name="l00416"></a>00416 }
<a name="l00417"></a>00417 
<a name="l00418"></a><a class="code" href="classDomaine.html#a842241a224e6c050f1f15530a2d06531">00418</a> <span class="keywordtype">void</span> <a class="code" href="classDomaine.html#a842241a224e6c050f1f15530a2d06531">Domaine::construire_renum_som_perio</a>(<span class="keyword">const</span> <a class="code" href="classConds__lim.html">Conds_lim</a>&amp; les_cl,
<a name="l00419"></a>00419                                          <span class="keyword">const</span> <a class="code" href="classZone__dis.html" title="classe Zone_dis Classe generique de la hierarchie des zones discretisees. Un objet de type Zone_dis p...">Zone_dis</a>&amp; zone_dis)
<a name="l00420"></a>00420 {
<a name="l00421"></a>00421   <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a> bords_perio;
<a name="l00422"></a>00422   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_bords = les_cl.<a class="code" href="classvect__impl.html#a78155bfbd6b61f4710b9830641ed1694">size</a>();
<a name="l00423"></a>00423   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n_bord = 0; n_bord &lt; nb_bords; n_bord++)
<a name="l00424"></a>00424     {
<a name="l00425"></a>00425       <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classPeriodique.html" title="classe Periodique Cette classe represente une condition aux limites periodique. On peut specifier une...">Periodique</a>, les_cl[n_bord].<a class="code" href="Source__Generique__Face__PolyMAC_8cpp.html#a7d7b5d77a3caa1af70f5e1c9108de5a1">valeur</a>()))
<a name="l00426"></a>00426         bords_perio.<a class="code" href="classVect__Nom.html#ae20c0d0842c00756c1a2610fe0ca471f">add</a>(les_cl[n_bord].frontiere_dis().frontiere().<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>());
<a name="l00427"></a>00427     }
<a name="l00428"></a>00428 
<a name="l00429"></a>00429   <a class="code" href="classDomaine.html#ad3a4531c849f2af73b79d175c5ca48c9">Reordonner_faces_periodiques::renum_som_perio</a>(*<span class="keyword">this</span>, bords_perio, <a class="code" href="classDomaine.html#ad3a4531c849f2af73b79d175c5ca48c9">renum_som_perio</a>,
<a name="l00430"></a>00430                                                 1 <span class="comment">/* Calculer les valeurs pour les sommets virtuels */</span>);
<a name="l00431"></a>00431 }
<a name="l00432"></a>00432 
<a name="l00433"></a>00433 <span class="comment">//</span><span class="comment"></span>
<a name="l00434"></a>00434 <span class="comment">//! Cree un tableau ayant une &quot;ligne&quot; par sommet du maillage.&lt;br&gt;Voir MD_Vector_tools::creer_tableau_distribue()</span>
<a name="l00435"></a><a class="code" href="classDomaine.html#a32c7de9f9e8e78e3d5ea68715b2ceb2b">00435</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classDomaine.html#a32c7de9f9e8e78e3d5ea68715b2ceb2b" title="Cree un tableau ayant une &quot;ligne&quot; par sommet du maillage. Voir MD_Vector_tools::creer_tableau_distrib...">Domaine::creer_tableau_sommets</a>(<a class="code" href="classArray__base.html" title=": classe vide servant de base a tous les tableaux. (permet de passer un type generique quel que soit ...">Array_base</a>&amp; v, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ff">Array_base::Resize_Options</a> opt)<span class="keyword"> const</span>
<a name="l00436"></a>00436 <span class="keyword"></span>{
<a name="l00437"></a>00437   <span class="keyword">const</span> <a class="code" href="classMD__Vector.html" title=": Cette classe est un DERIV mais l&#39;objet pointe est partage entre plusieurs instances de cette classe...">MD_Vector</a>&amp; md = <a class="code" href="classDomaine.html#a94843a61bbc3e432cf87ef40c440fb80">md_vector_sommets</a>();
<a name="l00438"></a>00438   <a class="code" href="MD__Vector__tools_8cpp.html#aff1ed2791dba1a76fdb300920147cfdf">MD_Vector_tools::creer_tableau_distribue</a>(md, v, opt);
<a name="l00439"></a>00439 }
<a name="l00440"></a>00440 
<a name="l00441"></a><a class="code" href="classDomaine.html#a94843a61bbc3e432cf87ef40c440fb80">00441</a> <span class="keyword">const</span> <a class="code" href="classMD__Vector.html" title=": Cette classe est un DERIV mais l&#39;objet pointe est partage entre plusieurs instances de cette classe...">MD_Vector</a>&amp; <a class="code" href="classDomaine.html#a94843a61bbc3e432cf87ef40c440fb80">Domaine::md_vector_sommets</a>()<span class="keyword"> const</span>
<a name="l00442"></a>00442 <span class="keyword"></span>{
<a name="l00443"></a>00443   <span class="keyword">const</span> <a class="code" href="classMD__Vector.html" title=": Cette classe est un DERIV mais l&#39;objet pointe est partage entre plusieurs instances de cette classe...">MD_Vector</a>&amp; md = <a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>().<a class="code" href="classDoubleVect.html#a0d16d30580c90526e4895388fb44be5d">get_md_vector</a>();
<a name="l00444"></a>00444   <span class="keywordflow">return</span> md;
<a name="l00445"></a>00445 }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 <span class="comment">//</span>
<a name="l00448"></a>00448 <span class="comment">//</span><span class="comment"></span>
<a name="l00449"></a>00449 <span class="comment">//! Cree un tableau ayant une &quot;ligne&quot; par element du maillage.&lt;br&gt;Pour l&#39;instant, erreur s&#39;il y a plus d&#39;une zone dans le domaine.&lt;br&gt;Voir MD_Vector_tools::creer_tableau_distribue()</span>
<a name="l00450"></a><a class="code" href="classDomaine.html#a5d820427207d7534f4993971b98630f0">00450</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classDomaine.html#a5d820427207d7534f4993971b98630f0" title="Cree un tableau ayant une &quot;ligne&quot; par element du maillage. Pour l&#39;instant, erreur s&#39;il y a plus d&#39;u...">Domaine::creer_tableau_elements</a>(<a class="code" href="classArray__base.html" title=": classe vide servant de base a tous les tableaux. (permet de passer un type generique quel que soit ...">Array_base</a>&amp; v, <a class="code" href="classArray__base.html#abee342aa9ac59623c4c782dc9d7877ff">Array_base::Resize_Options</a> opt)<span class="keyword"> const</span>
<a name="l00451"></a>00451 <span class="keyword"></span>{
<a name="l00452"></a>00452 <span class="comment">// On pourra faire evoluer le code ci-dessous en creant un</span>
<a name="l00453"></a>00453 <span class="comment">// tableau associe a un MD_Vector_composite:</span>
<a name="l00454"></a>00454   <span class="keywordflow">if</span> (<a class="code" href="classDomaine.html#a9f3fc389a1310d1fc8b4b27976855376" title="Renvoie le nombre de zone du domaine.">nb_zones</a>() != 1)
<a name="l00455"></a>00455     {
<a name="l00456"></a>00456       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Error in Domaine::creer_tableau_elements(Array_base &amp; v):\n&quot;</span>
<a name="l00457"></a>00457            &lt;&lt; <span class="stringliteral">&quot; Domain does not have exactely 1 zone !&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00458"></a>00458       <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">Process::exit</a>();
<a name="l00459"></a>00459     }
<a name="l00460"></a>00460   <a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a600fa15a19c7e1384564dffd83ecab4d" title="creation d&#39;un tableau parallele de valeurs aux elements. Voir MD_Vector_tools::creer_tableau_distribu...">creer_tableau_elements</a>(v, opt);
<a name="l00461"></a>00461 }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463 
<a name="l00464"></a>00464 
<a name="l00465"></a>00465 <span class="comment">// Creation des domaines frontieres (appele lors de la discretisation)</span>
<a name="l00466"></a>00466 <span class="comment">// Actuellement une liste statique de Domaines ou l&#39;on a besoin pour</span>
<a name="l00467"></a>00467 <span class="comment">// chaque domaine de connaitre le premier element</span>
<a name="l00468"></a><a class="code" href="classDomaine.html#a5dfc0ff9d38992281bbb1270fdbd255d">00468</a> <span class="keywordtype">void</span> <a class="code" href="classDomaine.html#a5dfc0ff9d38992281bbb1270fdbd255d">Domaine::creer_mes_domaines_frontieres</a>(<span class="keyword">const</span> <a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>&amp; zone_vf)
<a name="l00469"></a>00469 {
<a name="l00470"></a>00470   <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> expr_elements(<span class="stringliteral">&quot;1&quot;</span>);
<a name="l00471"></a>00471   <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> expr_faces(<span class="stringliteral">&quot;1&quot;</span>);
<a name="l00472"></a>00472   <span class="keywordtype">int</span> nb_frontieres = <a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a9bf185c52ad1809d954bba670d9aed8a" title="Renvoie le nombre de bords + le nombre de raccords + le nombre de faces frontieres internes...">nb_front_Cl</a>();
<a name="l00473"></a>00473   <a class="code" href="classDomaine.html#a0690b2b626e1962cffdba33932066829">domaines_frontieres_</a>.<a class="code" href="classliste.html#a6cf18c012f5c03fd88aafac2d263883e" title="Vide la liste.">vide</a>();
<a name="l00474"></a>00474   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nb_frontieres; i++)
<a name="l00475"></a>00475     {
<a name="l00476"></a>00476 <span class="comment">// Nom de la frontiere</span>
<a name="l00477"></a>00477       <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a> nom_frontiere(1);
<a name="l00478"></a>00478       nom_frontiere[0]=<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#ac338b119d4b0bc4f510a223b9086fe5e">frontiere</a>(i).<a class="code" href="classFrontiere.html#a2868774681d6f050479a95cbc7cd6fc9" title="Renvoie le nom de la frontiere.">le_nom</a>();
<a name="l00479"></a>00479 <span class="comment">// Nom du domaine surfacique que l&#39;on va construire</span>
<a name="l00480"></a>00480       <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_domaine_surfacique=<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>();
<a name="l00481"></a>00481       nom_domaine_surfacique+=<span class="stringliteral">&quot;_boundaries_&quot;</span>;
<a name="l00482"></a>00482       nom_domaine_surfacique+=<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#ac338b119d4b0bc4f510a223b9086fe5e">frontiere</a>(i).<a class="code" href="classFrontiere.html#a2868774681d6f050479a95cbc7cd6fc9" title="Renvoie le nom de la frontiere.">le_nom</a>();
<a name="l00483"></a>00483 <span class="comment">// Creation</span>
<a name="l00484"></a>00484       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Creating a surface domain named &quot;</span> &lt;&lt; nom_domaine_surfacique &lt;&lt; <span class="stringliteral">&quot; for the boundary &quot;</span> &lt;&lt; nom_frontiere[0] &lt;&lt; <span class="stringliteral">&quot; of the domain &quot;</span> &lt;&lt; <a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486       <a class="code" href="classInterprete__bloc.html" title="Interprete un bloc d&#39;instructions dans le jeu de donnees. Voir Interprete_bloc::interpreter()">Interprete_bloc</a>&amp; interp = <a class="code" href="classInterprete__bloc.html#a7c4cb0474e21ba03265a06f9bfc196a2" title="renvoie l&#39;interprete_bloc en train d&#39;etre lu dans le jeu de donnees. On change d&#39;interprete courant q...">Interprete_bloc::interprete_courant</a>();
<a name="l00487"></a>00487       <span class="keywordflow">if</span> (interp.<a class="code" href="classInterprete__bloc.html#a30f30f6da652cfd4a3819775480e056f" title="renvoie un drapeau indiquant si un objet de ce nom existe dans inteprete_courant() ou l&#39;un de ses par...">objet_global_existant</a>(nom_domaine_surfacique))
<a name="l00488"></a>00488         {
<a name="l00489"></a>00489           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Domain &quot;</span> &lt;&lt; nom_domaine_surfacique
<a name="l00490"></a>00490                &lt;&lt; <span class="stringliteral">&quot; already exists, writing to this object.&quot;</span> &lt;&lt; finl;
<a name="l00491"></a>00491 
<a name="l00492"></a>00492           <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom_new = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>, <a class="code" href="classObjet__U.html#a9b5c13352a6601b5cec65941575f2e9a">interprete</a>().objet(nom_domaine_surfacique));
<a name="l00493"></a>00493           <a class="code" href="classScatter.html#a8cf934a9b5f7ecb7ef89f61c09804f45" title="methode utilisee par les interpretes qui modifient le domaine&lt;br&gt;(sequentiel), detruit les descripteu...">Scatter::uninit_sequential_domain</a>(dom_new);
<a name="l00494"></a>00494         }
<a name="l00495"></a>00495       <span class="keywordflow">else</span>
<a name="l00496"></a>00496         {
<a name="l00497"></a>00497           <a class="code" href="classDeriv__Objet__U.html">DerObjU</a> ob;
<a name="l00498"></a>00498           ob.<a class="code" href="classDeriv__.html#ad1d33400ed15b6ff96579ed82d9e2719" title="Essaie de creer une instance du type &quot;type&quot;. si type n&#39;est pas un type ou type n&#39;est pas instanciab...">typer</a>(<span class="stringliteral">&quot;Domaine&quot;</span>);
<a name="l00499"></a>00499           interp.<a class="code" href="classInterprete__bloc.html#a229ccd01911aa158cca828a109ead063" title="Ajoute l&#39;objet ob a la liste des objets de l&#39;interprete, et nomme l&#39;objet avec nom. Si l&#39;objet existe deja, exit()">ajouter</a>(nom_domaine_surfacique, ob);
<a name="l00500"></a>00500         }
<a name="l00501"></a>00501       <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom_new = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>, <a class="code" href="classObjet__U.html#a9b5c13352a6601b5cec65941575f2e9a">interprete</a>().objet(nom_domaine_surfacique));
<a name="l00502"></a>00502 
<a name="l00503"></a>00503       <a class="code" href="classExtraire__surface.html#aed143166d49f2a14ee2c354644760582">Extraire_surface::extraire_surface</a>(dom_new,*<span class="keyword">this</span>,nom_domaine_surfacique,zone_vf,expr_elements,expr_faces,0,nom_frontiere);
<a name="l00504"></a>00504       <a class="code" href="Ref_8h.html#aab5720a5c34da14028d0745e386aaa01">REF</a>(<a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>)&amp; ref_dom_new=<a class="code" href="classDomaine.html#a0690b2b626e1962cffdba33932066829">domaines_frontieres_</a>.<a class="code" href="classList__Ref__Domaine.html#a732c60c2c8d5b444ab74036fc12ac80b">add</a>(<a class="code" href="Ref_8h.html#aab5720a5c34da14028d0745e386aaa01">REF</a>(<a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>)());
<a name="l00505"></a>00505       ref_dom_new=dom_new;
<a name="l00506"></a>00506     }
<a name="l00507"></a>00507 }
<a name="l00508"></a>00508 
<a name="l00509"></a><a class="code" href="classDomaine.html#aa6a2cc7601835fd81cac4f8cdc24aa35">00509</a> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> <a class="code" href="classDomaine.html#aa6a2cc7601835fd81cac4f8cdc24aa35">Domaine::getBoundingBox</a>()<span class="keyword"> const</span>
<a name="l00510"></a>00510 <span class="keyword"></span>{
<a name="l00511"></a>00511   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> BB(<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>, 2);
<a name="l00512"></a>00512   <span class="keywordtype">int</span> nbsom=<a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>().<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00513"></a>00513   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; j++)
<a name="l00514"></a>00514     {
<a name="l00515"></a>00515       <span class="keywordtype">double</span> min_=0.5*<a class="code" href="Double_8h.html#ae0ee0cebfad5968da0ad6cc7a49e16b6">DMAXFLOAT</a>;
<a name="l00516"></a>00516       <span class="keywordtype">double</span> max_=-0.5*<a class="code" href="Double_8h.html#ae0ee0cebfad5968da0ad6cc7a49e16b6">DMAXFLOAT</a>;
<a name="l00517"></a>00517       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nbsom; i++)
<a name="l00518"></a>00518         {
<a name="l00519"></a>00519           <span class="keywordtype">double</span> c = <a class="code" href="classDomaine.html#aecd32c3eecc15cce7d1a0e468dadbf96" title="Renvoie le tableau des coordonnees des noeuds (sommets). (acces en lecture)">coord_sommets</a>()(i,j);
<a name="l00520"></a>00520           min_ = (c &lt; min_ ? c : min_);
<a name="l00521"></a>00521           max_ = (c &gt; max_ ? c : max_);
<a name="l00522"></a>00522         }
<a name="l00523"></a>00523       BB(j,0) = min_;
<a name="l00524"></a>00524       BB(j,1) = max_;
<a name="l00525"></a>00525     }
<a name="l00526"></a>00526   <span class="keywordflow">return</span> BB;
<a name="l00527"></a>00527 }
<a name="l00528"></a>00528 
<a name="l00529"></a><a class="code" href="classDomaine.html#a059af9d067d119928c0e2af6c9a454a1">00529</a> <span class="keywordtype">void</span> <a class="code" href="classDomaine.html#a059af9d067d119928c0e2af6c9a454a1">Domaine::imprimer</a>()<span class="keyword"> const</span>
<a name="l00530"></a>00530 <span class="keyword"></span>{
<a name="l00531"></a>00531   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;==============================================&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00532"></a>00532   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The extreme coordinates of the domain &quot;</span> &lt;&lt; <a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; are:&quot;</span> &lt;&lt; finl;
<a name="l00533"></a>00533 <span class="comment">// Il n&#39;existe pas de recherche du min et du max dans DoubleTab donc je code:</span>
<a name="l00534"></a>00534   <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a> BB = <a class="code" href="classDomaine.html#aa6a2cc7601835fd81cac4f8cdc24aa35">getBoundingBox</a>();
<a name="l00535"></a>00535   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="classObjet__U.html#a3e23491c01f2f39245fb6f3b6d6d9b17">dimension</a>; j++)
<a name="l00536"></a>00536     {
<a name="l00537"></a>00537       <span class="keywordtype">double</span> min_ = <a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_min</a>(BB(j,0));
<a name="l00538"></a>00538       <span class="keywordtype">double</span> max_ = <a class="code" href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d" title="Calcule le max de x sur tous les processeurs du groupe courant. Remarques : Cette methode doit etre a...">mp_max</a>(BB(j,1));
<a name="l00539"></a>00539       <span class="keywordflow">if</span> (j==0) <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;x &quot;</span>;
<a name="l00540"></a>00540       <span class="keywordflow">if</span> (j==1) <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;y &quot;</span>;
<a name="l00541"></a>00541       <span class="keywordflow">if</span> (j==2) <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;z &quot;</span>;
<a name="l00542"></a>00542       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;is between &quot;</span> &lt;&lt; min_ &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; max_ &lt;&lt; finl;
<a name="l00543"></a>00543     }
<a name="l00544"></a>00544   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;==============================================&quot;</span> &lt;&lt; finl;
<a name="l00545"></a>00545 <span class="comment">// We recompute volumes (cause stored in Zone_VF and so not available from Domaine...):</span>
<a name="l00546"></a>00546   <a class="code" href="classDoubleVect.html">DoubleVect</a> volumes;
<a name="l00547"></a>00547   <a class="code" href="classDoubleVect.html">DoubleVect</a> inverse_volumes;
<a name="l00548"></a>00548   <a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#ad7300cf52a8b6880346dafa3c73b5d3a" title="Calcule les volumes des elements de la zone.">calculer_volumes</a>(volumes,inverse_volumes);
<a name="l00549"></a>00549   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;==============================================&quot;</span> &lt;&lt; finl;
<a name="l00550"></a>00550   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;The volume cells of the domain &quot;</span> &lt;&lt; <a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>() &lt;&lt; <span class="stringliteral">&quot; are:&quot;</span> &lt;&lt; finl;
<a name="l00551"></a>00551   <span class="keyword">const</span> <span class="keywordtype">int</span> i_vmax = <a class="code" href="ArrOfDouble_8cpp.html#ace2773782c6cf82f52e226ca32314ae4" title="Retourne l&#39;indice du max ou -1 si le tableau est vide.">imax_array</a>(volumes);
<a name="l00552"></a>00552   <span class="keyword">const</span> <span class="keywordtype">int</span> i_vmin = <a class="code" href="ArrOfDouble_8cpp.html#afe9f20f22a4feecff7412bbcd71cafea" title="Retourne l&#39;indice du min ou -1 si le tableau est vide.">imin_array</a>(volumes);
<a name="l00553"></a>00553   <span class="keyword">const</span> <span class="keywordtype">double</span> vmin_local = (i_vmin &lt; 0) ? 1e40 : volumes[i_vmin];
<a name="l00554"></a>00554   <span class="keyword">const</span> <span class="keywordtype">double</span> vmax_local = (i_vmax &lt; 0) ? -1e40 : volumes[i_vmax];
<a name="l00555"></a>00555   <span class="keyword">const</span> <span class="keywordtype">double</span> volmin = <a class="code" href="classProcess.html#a05de57db7288d95f9e67046af585d5ff" title="Calcule le min de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">mp_min</a>(vmin_local);
<a name="l00556"></a>00556   <span class="keyword">const</span> <span class="keywordtype">double</span> volmax = <a class="code" href="classProcess.html#a1e9d9f9899b71927cfafae14c7bd048d" title="Calcule le max de x sur tous les processeurs du groupe courant. Remarques : Cette methode doit etre a...">mp_max</a>(vmax_local);
<a name="l00557"></a>00557   <span class="keywordtype">double</span> volume_total = <a class="code" href="DoubleVect_8cpp.html#a07dd5e25d47ad3892ae0fa4e997ed011">mp_somme_vect</a>(volumes);
<a name="l00558"></a>00558   <span class="keyword">const</span> <span class="keywordtype">int</span> nb_elem = <a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>();
<a name="l00559"></a>00559   <span class="keywordtype">double</span> volmoy = volume_total / <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(nb_elem);
<a name="l00560"></a>00560   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;sum(volume cells)= &quot;</span>  &lt;&lt; volume_total &lt;&lt; finl;
<a name="l00561"></a>00561   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;mean(volume cells)= &quot;</span> &lt;&lt; volmoy &lt;&lt; finl;
<a name="l00562"></a>00562   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;min(volume cells)= &quot;</span>  &lt;&lt; volmin &lt;&lt; finl;
<a name="l00563"></a>00563   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;max(volume cells)= &quot;</span>  &lt;&lt; volmax &lt;&lt; finl;
<a name="l00564"></a>00564   <span class="keywordflow">if</span> (volmin*1000&lt;volmoy)
<a name="l00565"></a>00565     {
<a name="l00566"></a>00566       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&quot;</span> &lt;&lt; finl;
<a name="l00567"></a>00567       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Warning, a cell volume is more than 1000 times smaller than the average cell volume. Check your mesh.&quot;</span> &lt;&lt; finl;
<a name="l00568"></a>00568       <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&quot;</span> &lt;&lt; finl;
<a name="l00569"></a>00569     }
<a name="l00570"></a>00570   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;==============================================&quot;</span> &lt;&lt; finl;
<a name="l00571"></a>00571 }
<a name="l00572"></a>00572 
<a name="l00573"></a>00573 <span class="comment">// Build the faces mesh:</span>
<a name="l00574"></a><a class="code" href="classDomaine.html#a9b9fc1aeadc23c56914e01d2be268b99">00574</a> <span class="keywordtype">void</span> <a class="code" href="classDomaine.html#a9b9fc1aeadc23c56914e01d2be268b99">Domaine::buildUFacesMesh</a>(<span class="keyword">const</span> <a class="code" href="classZone__dis__base.html" title="classe Zone_dis_base Cette classe est la base de la hierarchie des zones discretisees. Un objet Zone est associe a la zone discretise. A chaque methode numerique de Trio U correspond une classe derivant de Zone_dis_base implementant les outils necessaires a la methode.">Zone_dis_base</a>&amp; zone_dis_base)<span class="keyword"> const</span>
<a name="l00575"></a>00575 <span class="keyword"></span>{
<a name="l00576"></a>00576 <span class="preprocessor">#ifdef MEDCOUPLING_</span>
<a name="l00577"></a>00577 <span class="preprocessor"></span>  MCAuto&lt;DataArrayInt&gt; desc(DataArrayInt::New());
<a name="l00578"></a>00578   MCAuto&lt;DataArrayInt&gt; descIndx(DataArrayInt::New());
<a name="l00579"></a>00579   MCAuto&lt;DataArrayInt&gt; revDesc(DataArrayInt::New());
<a name="l00580"></a>00580   MCAuto&lt;DataArrayInt&gt; revDescIndx(DataArrayInt::New());
<a name="l00581"></a>00581   faces_mesh_ = mesh_-&gt;buildDescendingConnectivity(desc, descIndx, revDesc, revDescIndx);
<a name="l00582"></a>00582 <span class="comment">// Renumber faces to have the same numbering than Domaine_dis</span>
<a name="l00583"></a>00583   std::size_t size = faces_mesh_-&gt;getNumberOfCells();
<a name="l00584"></a>00584   <a class="code" href="classIntVect.html">IntVect</a> renum(size);
<a name="l00585"></a>00585 <span class="comment">// Compute Center of Mass</span>
<a name="l00586"></a>00586   MCAuto&lt;DataArrayDouble&gt; xv_med = faces_mesh_-&gt;computeCellCenterOfMass();
<a name="l00587"></a>00587 <span class="comment">// On boucle sur les elements des tableaux Zone_VF::elem_faces et desc</span>
<a name="l00588"></a>00588 <span class="comment">// Ensuite on compare geometriquement les centres des faces de ces tableaux pour trouver les relations</span>
<a name="l00589"></a>00589 <span class="comment">// Boucle sur les mailles</span>
<a name="l00590"></a>00590   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; elem_faces = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, zone_dis_base).elem_faces();
<a name="l00591"></a>00591   <span class="keywordtype">int</span> nb_elem = elem_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00592"></a>00592   assert(nb_elem == (<span class="keywordtype">int</span>)descIndx-&gt;getNbOfElems()-1);
<a name="l00593"></a>00593 <span class="comment">// Centre des faces TRUST:</span>
<a name="l00594"></a>00594   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; xv = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classZone__VF.html" title="class Zone_VF Cette classe abstraite contient les informations geometriques communes aux methodes de ...">Zone_VF</a>, zone_dis_base).xv();
<a name="l00595"></a>00595 <span class="comment">// int nb_faces = xv.dimension_tot(0);</span>
<a name="l00596"></a>00596   <span class="keywordtype">int</span> nb_comp = xv.dimension_tot(1), f;
<a name="l00597"></a>00597 
<a name="l00598"></a>00598 <span class="comment">// Boucle sur les elements</span>
<a name="l00599"></a>00599   MCAuto&lt;DataArrayInt&gt; renum_local(DataArrayInt::New());
<a name="l00600"></a>00600   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> elem=0; elem&lt;nb_elem; elem++)
<a name="l00601"></a>00601     {
<a name="l00602"></a>00602 <span class="comment">// Cerr &lt;&lt; &quot;elem=&quot; &lt;&lt; elem &lt;&lt; finl;</span>
<a name="l00603"></a>00603       <span class="keywordtype">int</span> nb_face_elem = 0;
<a name="l00604"></a>00604       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; elem_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; elem_faces(elem, i) &gt;= 0; i++)
<a name="l00605"></a>00605         nb_face_elem++;
<a name="l00606"></a>00606 <span class="comment">// xv1, xv2 tableaux temporaires des centres des faces de l&#39;element elem pour comparaison</span>
<a name="l00607"></a>00607       MCAuto&lt;DataArrayDouble&gt; xv1(DataArrayDouble::New());
<a name="l00608"></a>00608       xv1-&gt;alloc(nb_face_elem, nb_comp);
<a name="l00609"></a>00609       MCAuto&lt;DataArrayDouble&gt; xv2(DataArrayDouble::New());
<a name="l00610"></a>00610       xv2-&gt;alloc(nb_face_elem, nb_comp);
<a name="l00611"></a>00611       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; elem_faces.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &amp;&amp; (f = elem_faces(elem, i)) &gt;= 0; i++)
<a name="l00612"></a>00612         {
<a name="l00613"></a>00613           <span class="comment">/*</span>
<a name="l00614"></a>00614 <span class="comment">          Cerr &lt;&lt; &quot;\tface=&quot; &lt;&lt; face;</span>
<a name="l00615"></a>00615 <span class="comment">          for (int j=0; j&lt;nb_comp; j++) Cerr &lt;&lt; &quot; &quot; &lt;&lt; xv(face, j);</span>
<a name="l00616"></a>00616 <span class="comment">          Cerr &lt;&lt; finl; */</span>
<a name="l00617"></a>00617 <span class="comment">// Face globale MED</span>
<a name="l00618"></a>00618           <span class="keywordtype">int</span> index = descIndx-&gt;getIJ(elem, 0);
<a name="l00619"></a>00619           <span class="keywordtype">int</span> face_med = desc-&gt;getIJ(index + i, 0);
<a name="l00620"></a>00620           <span class="comment">/*</span>
<a name="l00621"></a>00621 <span class="comment">          Cerr &lt;&lt; &quot;\tface_med=&quot; &lt;&lt; face_med;</span>
<a name="l00622"></a>00622 <span class="comment">          for (int j=0; j&lt;nb_comp; j++) Cerr &lt;&lt; &quot; &quot; &lt;&lt; xv_med-&gt;getIJ(face_med, j);</span>
<a name="l00623"></a>00623 <span class="comment">          Cerr &lt;&lt; finl; */</span>
<a name="l00624"></a>00624 <span class="comment">// Centre des faces TRUST et MED</span>
<a name="l00625"></a>00625           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nb_comp; j++)
<a name="l00626"></a>00626             {
<a name="l00627"></a>00627               xv1-&gt;setIJ(i, j, xv(f, j));
<a name="l00628"></a>00628               xv2-&gt;setIJ(i, j, xv_med-&gt;getIJ(face_med, j));
<a name="l00629"></a>00629             }
<a name="l00630"></a>00630         }
<a name="l00631"></a>00631       renum_local = xv2-&gt;findClosestTupleId(xv1);
<a name="l00632"></a>00632       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;renum_local-&gt;getNumberOfTuples(); i++)
<a name="l00633"></a>00633         {
<a name="l00634"></a>00634           <span class="keywordtype">int</span> i_med = renum_local-&gt;getIJ(i, 0);
<a name="l00635"></a>00635           <span class="keywordtype">int</span> face_med = desc-&gt;getIJ(descIndx-&gt;getIJ(elem, 0) + i_med, 0);
<a name="l00636"></a>00636           <span class="keywordtype">int</span> face = elem_faces(elem, i);
<a name="l00637"></a>00637           <span class="comment">/*</span>
<a name="l00638"></a>00638 <span class="comment">          Cerr &lt;&lt; &quot;Local: &quot; &lt;&lt; i_med &lt;&lt; &quot; -&gt; &quot; &lt;&lt; (int)i &lt;&lt; finl;</span>
<a name="l00639"></a>00639 <span class="comment">          Cerr &lt;&lt; &quot;Global:&quot; &lt;&lt; face_med &lt;&lt; &quot; -&gt; &quot; &lt;&lt; face &lt;&lt; finl;</span>
<a name="l00640"></a>00640 <span class="comment">           */</span>
<a name="l00641"></a>00641           renum(face_med) = face;
<a name="l00642"></a>00642         }
<a name="l00643"></a>00643     }
<a name="l00644"></a>00644 <span class="preprocessor">#ifdef NDEBUG</span>
<a name="l00645"></a>00645 <span class="preprocessor"></span>  <span class="keywordtype">bool</span> <a class="code" href="Loi__horaire_8cpp.html#a988880a6b263216f9b9186f02da544a9">check</a> = <span class="keyword">false</span>;
<a name="l00646"></a>00646 <span class="preprocessor">#else</span>
<a name="l00647"></a>00647 <span class="preprocessor"></span>  <span class="keywordtype">bool</span> check = <span class="keyword">true</span>;
<a name="l00648"></a>00648 <span class="preprocessor">#endif</span>
<a name="l00649"></a>00649 <span class="preprocessor"></span><span class="comment">// Apply the renumbering:</span>
<a name="l00650"></a>00650   faces_mesh_-&gt;renumberCells(renum.<a class="code" href="classArrOfInt.html#ad0b31250e60cd9040ea60be55db73c3d" title="Renvoie un pointeur sur le premier element du tableau. Le pointeur est nul si le tableau est &quot;detach...">addr</a>(), <a class="code" href="Loi__horaire_8cpp.html#a988880a6b263216f9b9186f02da544a9">check</a>);
<a name="l00651"></a>00651 <span class="preprocessor">#ifndef NDEBUG</span>
<a name="l00652"></a>00652 <span class="preprocessor"></span>  faces_mesh_-&gt;checkConsistency();
<a name="l00653"></a>00653 <span class="preprocessor">#endif</span>
<a name="l00654"></a>00654 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00655"></a>00655 <span class="preprocessor"></span>}
<a name="l00656"></a>00656 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:18 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
