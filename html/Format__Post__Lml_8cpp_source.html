<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TRUST: src/Kernel/Framework/Format_Post_Lml.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">TRUST&#160;<span id="projectnumber">1.8.4</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">src/Kernel/Framework/Format_Post_Lml.cpp</div>  </div>
</div>
<div class="contents">
<a href="Format__Post__Lml_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">* Copyright (c) 2021, CEA</span>
<a name="l00003"></a>00003 <span class="comment">* All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment">*</span>
<a name="l00005"></a>00005 <span class="comment">* Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00006"></a>00006 <span class="comment">* 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00007"></a>00007 <span class="comment">* 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00008"></a>00008 <span class="comment">* 3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00009"></a>00009 <span class="comment">*</span>
<a name="l00010"></a>00010 <span class="comment">* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00011"></a>00011 <span class="comment">* IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;</span>
<a name="l00012"></a>00012 <span class="comment">* OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00013"></a>00013 <span class="comment">*</span>
<a name="l00014"></a>00014 <span class="comment">*****************************************************************************/</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">// </span>
<a name="l00017"></a>00017 <span class="comment">// File:        Format_Post_Lml.cpp</span>
<a name="l00018"></a>00018 <span class="comment">// Directory:   $TRUST_ROOT/src/Kernel/Framework</span>
<a name="l00019"></a>00019 <span class="comment">// Version:     /main/23</span>
<a name="l00020"></a>00020 <span class="comment">// </span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;<a class="code" href="Format__Post__Lml_8h.html">Format_Post_Lml.h</a>&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;<a class="code" href="communications_8h.html">communications.h</a>&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;<a class="code" href="Param_8h.html">Param.h</a>&gt;</span>
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="Format__Post__Lml_8cpp.html#ac5f1ccbcabbb2519bc021a2e475e4ab8">00026</a> <a class="code" href="Declare__Inst_8h.html#afcab3f7633508e92f2077d767e19bc60">Implemente_instanciable_sans_constructeur</a>(<a class="code" href="classFormat__Post__Lml.html" title=": Classe de postraitement des champs euleriens au format lml.">Format_Post_Lml</a>,<span class="stringliteral">&quot;Format_Post_Lml&quot;</span>,<a class="code" href="classFormat__Post__base.html" title="Classe de base des formats de postraitements pour les champs&lt;br&gt;(lata, med, lml, meshtv). Utilisation de la classe par l&#39;interface generique: -typer un objet format de postraitement -initialiser l objet format de postraitement -proceder a des operations de complement et verification -ecrire un domaine -ecrire_temps -ecrire_champ (un type de champ supporte: aux elements ou aux sommets, ou encore aux faces si on a ecrit les faces du domaine et si les faces sont supportees par le postraitement)">Format_Post_base</a>);
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">//</span>
<a name="l00030"></a>00030 <span class="comment">// Parametre: lml_basename_</span>
<a name="l00031"></a>00031 <span class="comment">// Signification: debut du nom du fichier</span>
<a name="l00032"></a>00032 <span class="comment">// Extension lml</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="comment">// Specificites de ce format</span>
<a name="l00035"></a>00035 <span class="comment">// Ecriture dans un seul fichier (sequentiel ou parallele)</span>
<a name="l00036"></a>00036 <span class="comment">//</span>
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="comment">//</span>
<a name="l00039"></a>00039 <span class="comment">//</span><span class="comment"></span>
<a name="l00040"></a>00040 <span class="comment">//! Constructeur par defaut:&lt;br&gt;Specifier dans commentaire ce qui est fixe par defaut</span>
<a name="l00041"></a>00041 <span class="comment"></span>
<a name="l00042"></a><a class="code" href="classFormat__Post__Lml.html#a9249a14af66c4fbe980a08de342c70e4">00042</a> <a class="code" href="classFormat__Post__Lml.html#a9249a14af66c4fbe980a08de342c70e4" title="Constructeur par defaut: Specifier dans commentaire ce qui est fixe par defaut.">Format_Post_Lml::Format_Post_Lml</a>()
<a name="l00043"></a>00043 {
<a name="l00044"></a>00044   <a class="code" href="classFormat__Post__Lml.html#adaae3b1f09563b9d66382a367e79d058" title="Remet l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut.">reset</a>();
<a name="l00045"></a>00045 }
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="comment">//</span><span class="comment"></span>
<a name="l00048"></a>00048 <span class="comment">//! Remet l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut.</span>
<a name="l00049"></a><a class="code" href="classFormat__Post__Lml.html#adaae3b1f09563b9d66382a367e79d058">00049</a> <span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classFormat__Post__Lml.html#adaae3b1f09563b9d66382a367e79d058" title="Remet l&#39;objet dans l&#39;etat obtenu par le constructeur par defaut.">Format_Post_Lml::reset</a>()
<a name="l00050"></a>00050 {
<a name="l00051"></a>00051   <a class="code" href="classFormat__Post__Lml.html#a05f3c19010e74bb4dde09984f91440e8">lml_basename_</a> = <span class="stringliteral">&quot;??&quot;</span>;
<a name="l00052"></a>00052 }
<a name="l00053"></a>00053 <span class="comment"></span>
<a name="l00054"></a>00054 <span class="comment">//! erreur =&gt; exit</span>
<a name="l00055"></a><a class="code" href="classFormat__Post__Lml.html#afcc6d5fbe8a35e573ea2886ff1c7d41a">00055</a> <span class="comment"></span><a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; <a class="code" href="classFormat__Post__Lml.html#afcc6d5fbe8a35e573ea2886ff1c7d41a" title="erreur =&gt; exit">Format_Post_Lml::printOn</a>(<a class="code" href="classSortie.html" title="Classe de base des flux de sortie. Elle sait ecrire des types simples&lt;br&gt;(entiers, flottants) et des Ob...">Sortie</a>&amp; os)<span class="keyword"> const</span>
<a name="l00056"></a>00056 <span class="keyword"></span>{
<a name="l00057"></a>00057   <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;Format_Post_Lml::printOn : error&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00058"></a>00058   <a class="code" href="classProcess.html#acc2fbbe761e08e5870ae605c0705491c" title="Routine de sortie de Trio-U sur une erreur Sauvegarde la memoire et le hierarchie dans les fichiers &quot;...">exit</a>();
<a name="l00059"></a>00059   <span class="keywordflow">return</span> os;
<a name="l00060"></a>00060 }
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">//</span>
<a name="l00063"></a>00063 <span class="comment">//</span>
<a name="l00064"></a>00064 <span class="comment">//</span>
<a name="l00065"></a>00065 <span class="comment">//</span><span class="comment"></span>
<a name="l00066"></a>00066 <span class="comment">//! Lecture des parametres du postraitement au format &quot;jeu de donnees&quot;&lt;br&gt;Le format attendu est le suivant:&lt;br&gt;{&lt;br&gt;nom_fichier basename_sans_extension&lt;br&gt;}</span>
<a name="l00067"></a><a class="code" href="classFormat__Post__Lml.html#a30423fd11570d1d8e0d41904e4efee52">00067</a> <span class="comment"></span><a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; <a class="code" href="classFormat__Post__Lml.html#a30423fd11570d1d8e0d41904e4efee52" title="Lecture des parametres du postraitement au format &quot;jeu de donnees&quot; Le format attendu est le suivant: ...">Format_Post_Lml::readOn</a>(<a class="code" href="classEntree.html" title="Classe de definition des operateurs et methodes pour toute lecture dans un flot d&#39;entree (fichier...">Entree</a>&amp; is)
<a name="l00068"></a>00068 {
<a name="l00069"></a>00069   <a class="code" href="classFormat__Post__Lml.html#a30423fd11570d1d8e0d41904e4efee52" title="Lecture des parametres du postraitement au format &quot;jeu de donnees&quot; Le format attendu est le suivant: ...">Format_Post_base::readOn</a>(is);
<a name="l00070"></a>00070   <span class="keywordflow">return</span> is;
<a name="l00071"></a>00071 }
<a name="l00072"></a>00072 
<a name="l00073"></a><a class="code" href="classFormat__Post__Lml.html#a87236c2e9c6f3c9cf41027ccaaa27d79">00073</a> <span class="keywordtype">void</span> <a class="code" href="classFormat__Post__Lml.html#a87236c2e9c6f3c9cf41027ccaaa27d79">Format_Post_Lml::set_param</a>(<a class="code" href="classParam.html" title="Defined below in this file.">Param</a>&amp; param)
<a name="l00074"></a>00074 {
<a name="l00075"></a>00075   param.<a class="code" href="classParam.html#affb8a0102361201ba896bac7ca8bc21c">ajouter</a>(<span class="stringliteral">&quot;nom_fichier&quot;</span>,&amp;<a class="code" href="classFormat__Post__Lml.html#a05f3c19010e74bb4dde09984f91440e8">lml_basename_</a>,<a class="code" href="classParam.html#aa4ad0ca1d49bc5f2ebc5fc83ee9df384aaf5b6dfac1c5970478525407cc6ac572">Param::REQUIRED</a>);
<a name="l00076"></a>00076 }
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="comment">//</span><span class="comment"></span>
<a name="l00079"></a>00079 <span class="comment">//! Initialisation de la classe avec des parametres par&lt;br&gt;defaut</span>
<a name="l00080"></a><a class="code" href="classFormat__Post__Lml.html#a62d7c28fa4b93da007ed4b0ed0aee9c9">00080</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#a62d7c28fa4b93da007ed4b0ed0aee9c9" title="Initialisation de la classe avec des parametres par defaut.">Format_Post_Lml::initialize_by_default</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; file_basename)
<a name="l00081"></a>00081 {
<a name="l00082"></a>00082   <a class="code" href="classFormat__Post__Lml.html#a05f3c19010e74bb4dde09984f91440e8">lml_basename_</a>= file_basename;
<a name="l00083"></a>00083   <span class="keywordflow">return</span> 1;
<a name="l00084"></a>00084 }
<a name="l00085"></a>00085 
<a name="l00086"></a><a class="code" href="classFormat__Post__Lml.html#aaa3c03fc78aeb47643d0eaf4af7c96e2">00086</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#aaa3c03fc78aeb47643d0eaf4af7c96e2">Format_Post_Lml::initialize</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; file_basename, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; format, <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; option_para)
<a name="l00087"></a>00087 {
<a name="l00088"></a>00088 
<a name="l00089"></a>00089   <a class="code" href="classFormat__Post__Lml.html#a05f3c19010e74bb4dde09984f91440e8">lml_basename_</a>= file_basename;
<a name="l00090"></a>00090   <span class="keywordflow">return</span> 1;
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00093"></a><a class="code" href="classFormat__Post__Lml.html#a39c32e3df0da98ab6efb2e958d24b57f">00093</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#a39c32e3df0da98ab6efb2e958d24b57f">Format_Post_Lml::ecrire_entete</a>(<span class="keywordtype">double</span> temps_courant,<span class="keywordtype">int</span> reprise,<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; est_le_premier_post)
<a name="l00094"></a>00094 {
<a name="l00095"></a>00095 
<a name="l00096"></a>00096   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_fich(<a class="code" href="classFormat__Post__Lml.html#a05f3c19010e74bb4dde09984f91440e8">lml_basename_</a>);
<a name="l00097"></a>00097   nom_fich +=<span class="stringliteral">&quot;.&quot;</span>;
<a name="l00098"></a>00098   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> format=<span class="stringliteral">&quot;lml&quot;</span>;
<a name="l00099"></a>00099   nom_fich += format;
<a name="l00100"></a>00100 
<a name="l00101"></a>00101   <a class="code" href="classFormat__Post__Lml.html#aa2bf59b62223358a0738e7b939ef32f7">ecrire_entete_lml</a>(nom_fich,est_le_premier_post);
<a name="l00102"></a>00102   <span class="keywordflow">return</span> 1;
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 }
<a name="l00105"></a>00105 
<a name="l00106"></a><a class="code" href="classFormat__Post__Lml.html#a7b126c46b87d9f7ad486bbf8827ae79f">00106</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#a7b126c46b87d9f7ad486bbf8827ae79f">Format_Post_Lml::finir</a>(<span class="keywordtype">int</span>&amp; est_le_dernier_post)
<a name="l00107"></a>00107 {
<a name="l00108"></a>00108 
<a name="l00109"></a>00109   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_fich(<a class="code" href="classFormat__Post__Lml.html#a05f3c19010e74bb4dde09984f91440e8">lml_basename_</a>);
<a name="l00110"></a>00110   nom_fich +=<span class="stringliteral">&quot;.&quot;</span>;
<a name="l00111"></a>00111   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> format=<span class="stringliteral">&quot;lml&quot;</span>;
<a name="l00112"></a>00112   nom_fich += format;
<a name="l00113"></a>00113 
<a name="l00114"></a>00114   <a class="code" href="classFormat__Post__Lml.html#a96a38c6ea0f833e316f16747e44d3679">finir_lml</a>(nom_fich,est_le_dernier_post);
<a name="l00115"></a>00115   <span class="keywordflow">return</span> 1;
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 
<a name="l00119"></a><a class="code" href="classFormat__Post__Lml.html#a705954f56fb8be418127fe43ebbf06f1">00119</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#a705954f56fb8be418127fe43ebbf06f1">Format_Post_Lml::completer_post</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; dom,<span class="keyword">const</span> <span class="keywordtype">int</span> is_axi,
<a name="l00120"></a>00120                                     <span class="keyword">const</span> <a class="code" href="Field__base_8h.html#a1b86c8f670a9b34da7f628a821fb646b" title="This is a base class from which inherit Champ_base and Champ_front_base. It handles all the generic a...">Nature_du_champ</a>&amp; nature,<span class="keyword">const</span> <span class="keywordtype">int</span> nb_compo,<span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; noms_compo,
<a name="l00121"></a>00121                                     <span class="keyword">const</span> <a class="code" href="classMotcle.html" title="Une chaine de caractere (Nom) en majuscules.">Motcle</a>&amp; loc_post,<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; le_nom_champ_post)
<a name="l00122"></a>00122 {
<a name="l00123"></a>00123 
<a name="l00124"></a>00124   <a class="code" href="classFormat__Post__Lml.html#abebdb4dfac7ed6b11e6fc1ca7cad8cb6">completer_post_lml</a>();
<a name="l00125"></a>00125   <span class="keywordflow">return</span> 1;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 }
<a name="l00128"></a>00128 
<a name="l00129"></a><a class="code" href="classFormat__Post__Lml.html#a1a4bbf0b8b36f0182452fdf5f29a4401">00129</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#a1a4bbf0b8b36f0182452fdf5f29a4401">Format_Post_Lml::preparer_post</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; id_du_domaine,<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; est_le_premier_post,
<a name="l00130"></a>00130                                    <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; reprise,
<a name="l00131"></a>00131                                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; t_init)
<a name="l00132"></a>00132 {
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   <a class="code" href="classFormat__Post__Lml.html#ae1d7fae64ff86e60abd5bedc35f22f52">preparer_post_lml</a>();
<a name="l00135"></a>00135   <span class="keywordflow">return</span> 1;
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 }
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="comment">//</span><span class="comment"></span>
<a name="l00140"></a>00140 <span class="comment">//! voir Format_Post_base::ecrire_domaine</span>
<a name="l00141"></a><a class="code" href="classFormat__Post__Lml.html#a17fc677953b4e34a4eec7cdaa57ff596">00141</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#a17fc677953b4e34a4eec7cdaa57ff596" title="voir Format_Post_base::ecrire_domaine">Format_Post_Lml::ecrire_domaine</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; domaine,<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; est_le_premier_post)
<a name="l00142"></a>00142 {
<a name="l00143"></a>00143 <span class="comment">// Appel de la methode statique specifique au format lml</span>
<a name="l00144"></a>00144   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_fich(<a class="code" href="classFormat__Post__Lml.html#a05f3c19010e74bb4dde09984f91440e8">lml_basename_</a>);
<a name="l00145"></a>00145   nom_fich +=<span class="stringliteral">&quot;.&quot;</span>;
<a name="l00146"></a>00146   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> format=<span class="stringliteral">&quot;lml&quot;</span>;
<a name="l00147"></a>00147   nom_fich += format;
<a name="l00148"></a>00148   <a class="code" href="classFormat__Post__Lml.html#a1d1c099eef21d0d68685e47666e3ac5d">ecrire_domaine_lml</a>(domaine,nom_fich);
<a name="l00149"></a>00149   <span class="keywordflow">return</span> 1; <span class="comment">//!&lt; ok tout va bien</span>
<a name="l00150"></a>00150 <span class="comment"></span>}
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 <span class="comment">//</span>
<a name="l00153"></a>00153 <span class="comment">//</span>
<a name="l00154"></a>00154 <span class="comment">//</span><span class="comment"></span>
<a name="l00155"></a>00155 <span class="comment">//! commence l&#39;ecriture d&#39;un nouveau pas de temps&lt;br&gt;En l&#39;occurence pour le format Lml:&lt;br&gt;Ouvre le fichier maitre en mode APPEND et ajoute une ligne&lt;br&gt;&quot;TEMPS xxxxx&quot;</span>
<a name="l00156"></a><a class="code" href="classFormat__Post__Lml.html#a3b44fd9ea14628b2ae6c92693c756498">00156</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#a3b44fd9ea14628b2ae6c92693c756498" title="commence l&#39;ecriture d&#39;un nouveau pas de temps En l&#39;occurence pour le format Lml: Ouvre le fichier mai...">Format_Post_Lml::ecrire_temps</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> temps)
<a name="l00157"></a>00157 {
<a name="l00158"></a>00158 
<a name="l00159"></a>00159   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_fich(<a class="code" href="classFormat__Post__Lml.html#a05f3c19010e74bb4dde09984f91440e8">lml_basename_</a>);
<a name="l00160"></a>00160   nom_fich +=<span class="stringliteral">&quot;.&quot;</span>;
<a name="l00161"></a>00161   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> format=<span class="stringliteral">&quot;lml&quot;</span>;
<a name="l00162"></a>00162   nom_fich += format;
<a name="l00163"></a>00163 
<a name="l00164"></a>00164   <a class="code" href="classFormat__Post__Lml.html#ac8246ef3046658b3caa13b330c9c25a7">ecrire_temps_lml</a>(temps,nom_fich);
<a name="l00165"></a>00165 
<a name="l00166"></a>00166   <span class="keywordflow">return</span> 1;
<a name="l00167"></a>00167 }
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 <span class="comment">//</span><span class="comment"></span>
<a name="l00170"></a>00170 <span class="comment">//! voir Format_Post_base::ecrire_champ</span>
<a name="l00171"></a><a class="code" href="classFormat__Post__Lml.html#aa431a7c03ea1d3b81358a6b738a374f8">00171</a> <span class="comment"></span><span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#aa431a7c03ea1d3b81358a6b738a374f8" title="voir Format_Post_base::ecrire_champ">Format_Post_Lml::ecrire_champ</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; domaine,<span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; unite_, <span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; noms_compo,
<a name="l00172"></a>00172                                   <span class="keywordtype">int</span> ncomp,<span class="keywordtype">double</span> temps_,<span class="keywordtype">double</span> temps_courant,
<a name="l00173"></a>00173                                   <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; id_champ,
<a name="l00174"></a>00174                                   <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; id_du_domaine,
<a name="l00175"></a>00175                                   <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; localisation,
<a name="l00176"></a>00176                                   <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   nature,
<a name="l00177"></a>00177                                   <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; valeurs)
<a name="l00178"></a>00178 
<a name="l00179"></a>00179 {
<a name="l00180"></a>00180 
<a name="l00181"></a>00181 <span class="comment">// Appel de la methode statique specifique au format lml</span>
<a name="l00182"></a>00182   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_fich(<a class="code" href="classFormat__Post__Lml.html#a05f3c19010e74bb4dde09984f91440e8">lml_basename_</a>);
<a name="l00183"></a>00183   nom_fich +=<span class="stringliteral">&quot;.&quot;</span>;
<a name="l00184"></a>00184   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> format=<span class="stringliteral">&quot;lml&quot;</span>;
<a name="l00185"></a>00185   nom_fich += format;
<a name="l00186"></a>00186 
<a name="l00187"></a>00187   <a class="code" href="classFormat__Post__Lml.html#a14853550601066d7b2d100278eaddd7b">ecrire_champ_lml</a>(domaine,unite_,noms_compo,ncomp,temps_,id_champ,id_du_domaine,localisation,valeurs,nom_fich);
<a name="l00188"></a>00188 
<a name="l00189"></a>00189   <span class="keywordflow">return</span> 1;
<a name="l00190"></a>00190 }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 <span class="comment">//</span>
<a name="l00193"></a><a class="code" href="classFormat__Post__Lml.html#a12ba90840dfa218afb3c1d53296ea04f">00193</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#a12ba90840dfa218afb3c1d53296ea04f" title="Ecriture d&#39;un tableau d&#39;entiers dans le fichier de postraitement Voir aussi ecrire_champ Parametre: r...">Format_Post_Lml::ecrire_item_int</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;     id_item,
<a name="l00194"></a>00194                                      <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;     id_du_domaine,
<a name="l00195"></a>00195                                      <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;     id_zone,
<a name="l00196"></a>00196                                      <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;     localisation,
<a name="l00197"></a>00197                                      <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;     reference,
<a name="l00198"></a>00198                                      <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; valeurs,
<a name="l00199"></a>00199                                      <span class="keyword">const</span> <span class="keywordtype">int</span>   reference_size)
<a name="l00200"></a>00200 {
<a name="l00201"></a>00201 
<a name="l00202"></a>00202   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_fich(<a class="code" href="classFormat__Post__Lml.html#a05f3c19010e74bb4dde09984f91440e8">lml_basename_</a>);
<a name="l00203"></a>00203   nom_fich +=<span class="stringliteral">&quot;.&quot;</span>;
<a name="l00204"></a>00204   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> format=<span class="stringliteral">&quot;lml&quot;</span>;
<a name="l00205"></a>00205   nom_fich += format;
<a name="l00206"></a>00206   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> id_zone_dom(id_zone);
<a name="l00207"></a>00207   id_zone_dom+=<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00208"></a>00208   id_zone_dom+=id_du_domaine;
<a name="l00209"></a>00209   <a class="code" href="classFormat__Post__Lml.html#a34d7b0ec1a2209e66f1bb3bf786142eb">ecrire_item_int_lml</a>(id_item,id_zone,valeurs,nom_fich);
<a name="l00210"></a>00210 
<a name="l00211"></a>00211   <span class="keywordflow">return</span> 1;
<a name="l00212"></a>00212 }
<a name="l00213"></a>00213 
<a name="l00214"></a><a class="code" href="classFormat__Post__Lml.html#aa2bf59b62223358a0738e7b939ef32f7">00214</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#aa2bf59b62223358a0738e7b939ef32f7">Format_Post_Lml::ecrire_entete_lml</a>(<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fich,<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; est_le_premier_post)
<a name="l00215"></a>00215 {
<a name="l00216"></a>00216   <span class="keywordflow">if</span> (est_le_premier_post)
<a name="l00217"></a>00217     {
<a name="l00218"></a>00218 
<a name="l00219"></a>00219       <a class="code" href="classEcrFicPartage.html">EcrFicPartage</a> s;
<a name="l00220"></a>00220       s.<a class="code" href="classEcrFicPartage.html#aae9fd9a7163d0edcb12e0235a2eabdfa" title="Ouvre le fichier avec les parametres mode et prot donnes Ces parametres sont les parametres de la met...">ouvrir</a>(nom_fich);
<a name="l00221"></a>00221 
<a name="l00222"></a>00222       <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
<a name="l00223"></a>00223         {
<a name="l00224"></a>00224           s &lt;&lt; <span class="stringliteral">&quot;Trio_U&quot;</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <span class="stringliteral">&quot;Version &quot;</span>  &lt;&lt; <span class="stringliteral">&quot;1&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00225"></a>00225           s &lt;&lt; <a class="code" href="classObjet__U.html#a7c27c4f80259eeef76ff8fe2d3bc61f7" title="Renvoie une reference constante vers le nom du cas. Cette methode est statique.">nom_du_cas</a>() &lt;&lt; finl;
<a name="l00226"></a>00226           s &lt;&lt; <span class="stringliteral">&quot;Trio_U&quot;</span> &lt;&lt; finl;
<a name="l00227"></a>00227         }
<a name="l00228"></a>00228 
<a name="l00229"></a>00229       s.<a class="code" href="classEcrFicPartage.html#a19beb0cfbe321168ef1bd1d9ab59e69b" title="Force l&#39;ecriture sur disque des donnees dans le tampon Utilise l&#39;implementation de la classe ofstream...">flush</a>();
<a name="l00230"></a>00230       s.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233   <span class="keywordflow">return</span> 1;
<a name="l00234"></a>00234 }
<a name="l00235"></a>00235 
<a name="l00236"></a><a class="code" href="classFormat__Post__Lml.html#a96a38c6ea0f833e316f16747e44d3679">00236</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#a96a38c6ea0f833e316f16747e44d3679">Format_Post_Lml::finir_lml</a>(<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fich, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; est_le_dernier_post)
<a name="l00237"></a>00237 {
<a name="l00238"></a>00238 
<a name="l00239"></a>00239   <a class="code" href="classEcrFicPartage.html">EcrFicPartage</a> s;
<a name="l00240"></a>00240   s.<a class="code" href="classEcrFicPartage.html#aae9fd9a7163d0edcb12e0235a2eabdfa" title="Ouvre le fichier avec les parametres mode et prot donnes Ces parametres sont les parametres de la met...">ouvrir</a>(nom_fich,ios::app);
<a name="l00241"></a>00241 
<a name="l00242"></a>00242   <span class="keywordflow">if</span> (est_le_dernier_post)
<a name="l00243"></a>00243     {
<a name="l00244"></a>00244       <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">Process::je_suis_maitre</a>())
<a name="l00245"></a>00245         {
<a name="l00246"></a>00246           s &lt;&lt; <span class="stringliteral">&quot;FIN&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00247"></a>00247         }
<a name="l00248"></a>00248     }
<a name="l00249"></a>00249 
<a name="l00250"></a>00250   s.<a class="code" href="classEcrFicPartage.html#a19beb0cfbe321168ef1bd1d9ab59e69b" title="Force l&#39;ecriture sur disque des donnees dans le tampon Utilise l&#39;implementation de la classe ofstream...">flush</a>();
<a name="l00251"></a>00251   s.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00252"></a>00252 
<a name="l00253"></a>00253   <span class="keywordflow">return</span> 1;
<a name="l00254"></a>00254 }
<a name="l00255"></a>00255 
<a name="l00256"></a><a class="code" href="classFormat__Post__Lml.html#abebdb4dfac7ed6b11e6fc1ca7cad8cb6">00256</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#abebdb4dfac7ed6b11e6fc1ca7cad8cb6">Format_Post_Lml::completer_post_lml</a>()
<a name="l00257"></a>00257 {
<a name="l00258"></a>00258   <span class="keywordflow">return</span> 1;
<a name="l00259"></a>00259 }
<a name="l00260"></a>00260 
<a name="l00261"></a><a class="code" href="classFormat__Post__Lml.html#ae1d7fae64ff86e60abd5bedc35f22f52">00261</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#ae1d7fae64ff86e60abd5bedc35f22f52">Format_Post_Lml::preparer_post_lml</a>()
<a name="l00262"></a>00262 {
<a name="l00263"></a>00263   <span class="keywordflow">return</span> 1;
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 
<a name="l00266"></a><a class="code" href="classFormat__Post__Lml.html#a1d1c099eef21d0d68685e47666e3ac5d">00266</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#a1d1c099eef21d0d68685e47666e3ac5d">Format_Post_Lml::ecrire_domaine_lml</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; domaine,<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fich)
<a name="l00267"></a>00267 {
<a name="l00268"></a>00268 <span class="comment">// Actuellement copie identique de la methode Domaine::postraiter_lml()</span>
<a name="l00269"></a>00269 
<a name="l00270"></a>00270   <a class="code" href="classEcrFicPartage.html">EcrFicPartage</a> s;
<a name="l00271"></a>00271   s.<a class="code" href="classEcrFicPartage.html#aae9fd9a7163d0edcb12e0235a2eabdfa" title="Ouvre le fichier avec les parametres mode et prot donnes Ces parametres sont les parametres de la met...">ouvrir</a>(nom_fich,ios::app);
<a name="l00272"></a>00272   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_grille(<span class="stringliteral">&quot;Grille_&quot;</span>);
<a name="l00273"></a>00273   nom_grille+= domaine.<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>();
<a name="l00274"></a>00274 
<a name="l00275"></a>00275   <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00276"></a>00276     s &lt;&lt; <span class="stringliteral">&quot;GRILLE&quot;</span> &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00277"></a>00277 
<a name="l00278"></a>00278   <span class="keywordtype">int</span> nb_som_tot = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(domaine.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>());
<a name="l00279"></a>00279   <span class="keywordtype">int</span> dim = domaine.<a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>().<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="comment">// Ecriture des coordonnees des noeuds</span>
<a name="l00282"></a>00282 <span class="comment">// Toutes les grandeurs qui apparaissent dans le .lml doivent</span>
<a name="l00283"></a>00283 <span class="comment">// etre exprimees dans le repere des coordonnees cartesiennes</span>
<a name="l00284"></a>00284 <span class="comment">// Si l&#39;option Axi a ete choisie on recalcule les coordonnees</span>
<a name="l00285"></a>00285 <span class="comment">// cartesiennes a partir des coordonnees cylindriques.</span>
<a name="l00286"></a>00286 
<a name="l00287"></a>00287   <span class="keywordflow">if</span> (<a class="code" href="classObjet__U.html#ad9b82ace9d4c7902ec704b6a78f76991">axi</a>)
<a name="l00288"></a>00288     {
<a name="l00289"></a>00289 <span class="comment">// Ecriture des noeuds du maillage</span>
<a name="l00290"></a>00290       <span class="keywordflow">if</span> ( dim == 3)
<a name="l00291"></a>00291         {
<a name="l00292"></a>00292           <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00293"></a>00293             s &lt;&lt; nom_grille &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <span class="stringliteral">&quot;3 &quot;</span> &lt;&lt; nb_som_tot &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00294"></a>00294           s.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00295"></a>00295 
<a name="l00296"></a>00296           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nsom=0; nsom&lt;domaine.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>(); nsom++)
<a name="l00297"></a>00297             {
<a name="l00298"></a>00298               s &lt;&lt; domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,0)*cos(domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,1)) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00299"></a>00299                 &lt;&lt; domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,0)*sin(domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,1)) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00300"></a>00300                 &lt;&lt; domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,2) &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00301"></a>00301             }
<a name="l00302"></a>00302 
<a name="l00303"></a>00303           s.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00304"></a>00304           s.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00305"></a>00305         }
<a name="l00306"></a>00306       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( dim == 2)
<a name="l00307"></a>00307         {
<a name="l00308"></a>00308           <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00309"></a>00309             s &lt;&lt; nom_grille &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <span class="stringliteral">&quot;3 &quot;</span> &lt;&lt; 2*nb_som_tot &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00310"></a>00310           s.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00311"></a>00311 <span class="comment">// Ecriture des noeuds du maillage</span>
<a name="l00312"></a>00312           <span class="keywordtype">int</span> nsom;
<a name="l00313"></a>00313 
<a name="l00314"></a>00314           <span class="keywordflow">for</span> (nsom=0; nsom&lt;domaine.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>(); nsom++)
<a name="l00315"></a>00315             {
<a name="l00316"></a>00316               s &lt;&lt; domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,0)*cos(domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,1)) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00317"></a>00317                 &lt;&lt; domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,0)*sin(domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,1)) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00318"></a>00318                 &lt;&lt;  0. &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00319"></a>00319             }
<a name="l00320"></a>00320           <span class="keywordflow">for</span> (nsom=0; nsom&lt;domaine.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>(); nsom++)
<a name="l00321"></a>00321             {
<a name="l00322"></a>00322               s &lt;&lt; domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,0)*cos(domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,1)) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00323"></a>00323                 &lt;&lt; domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,0)*sin(domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,1)) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00324"></a>00324                 &lt;&lt; 1. &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00325"></a>00325             }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327           s.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00328"></a>00328           s.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00329"></a>00329         }
<a name="l00330"></a>00330     }
<a name="l00331"></a>00331   <span class="keywordflow">else</span>
<a name="l00332"></a>00332     {
<a name="l00333"></a>00333 <span class="comment">// Ecriture des noeuds du maillage</span>
<a name="l00334"></a>00334       <span class="keywordflow">if</span> ( dim == 3)
<a name="l00335"></a>00335         {
<a name="l00336"></a>00336           <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00337"></a>00337             s &lt;&lt; nom_grille &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <span class="stringliteral">&quot;3 &quot;</span> &lt;&lt; nb_som_tot &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00338"></a>00338           s.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00339"></a>00339 
<a name="l00340"></a>00340           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nsom=0; nsom&lt;domaine.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>(); nsom++)
<a name="l00341"></a>00341             {
<a name="l00342"></a>00342               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;3; j++)
<a name="l00343"></a>00343                 s &lt;&lt; domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom, j) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;
<a name="l00344"></a>00344               s &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00345"></a>00345             }
<a name="l00346"></a>00346 
<a name="l00347"></a>00347           s.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00348"></a>00348           s.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00349"></a>00349         }
<a name="l00350"></a>00350       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( dim == 2)
<a name="l00351"></a>00351         {
<a name="l00352"></a>00352           <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00353"></a>00353             s &lt;&lt; nom_grille &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <span class="stringliteral">&quot;3 &quot;</span> &lt;&lt; 2*nb_som_tot &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00354"></a>00354           s.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00355"></a>00355 <span class="comment">// Ecriture des noeuds du maillage</span>
<a name="l00356"></a>00356           <span class="keywordtype">int</span> nsom;
<a name="l00357"></a>00357 
<a name="l00358"></a>00358           <span class="keywordflow">for</span> (nsom=0; nsom&lt;domaine.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>(); nsom++)
<a name="l00359"></a>00359             {
<a name="l00360"></a>00360               s &lt;&lt; domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00361"></a>00361                 &lt;&lt; domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00362"></a>00362                 &lt;&lt; 0. &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00363"></a>00363             }
<a name="l00364"></a>00364           <span class="keywordflow">for</span> (nsom=0; nsom&lt;domaine.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>(); nsom++)
<a name="l00365"></a>00365             {
<a name="l00366"></a>00366               s &lt;&lt; domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00367"></a>00367                 &lt;&lt; domaine.<a class="code" href="classDomaine.html#a716f7248439ab8ec62d3e033ddfede41" title="Renvoie la j-ieme coordonnee du i-ieme noeud.">coord</a>(nsom,1) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00368"></a>00368                 &lt;&lt; 1. &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00369"></a>00369             }
<a name="l00370"></a>00370 
<a name="l00371"></a>00371           s.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00372"></a>00372           s.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00373"></a>00373         }
<a name="l00374"></a>00374     }
<a name="l00375"></a>00375 
<a name="l00376"></a>00376 <span class="comment">// Actuellement copie identique de la methode Zone::postraiter_lml()</span>
<a name="l00377"></a>00377 
<a name="l00378"></a>00378 <span class="comment">//</span>
<a name="l00379"></a>00379 
<a name="l00380"></a>00380   <span class="keywordtype">int</span> j;
<a name="l00381"></a>00381   <span class="keywordtype">int</span> nsom = domaine.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>();
<a name="l00382"></a>00382   <span class="keywordtype">int</span> nb_elem_tot = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(domaine.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>());
<a name="l00383"></a>00383   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_top(<span class="stringliteral">&quot;Topologie_&quot;</span>);
<a name="l00384"></a>00384   nom_top+= domaine.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#aad29ea7a38564404cc0417383233aaf0" title="Renvoie le nom de la zone.">le_nom</a>();
<a name="l00385"></a>00385   nom_top+=<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00386"></a>00386   nom_top+=domaine.<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>();
<a name="l00387"></a>00387   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> type_maille=domaine.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a18cf83cd0f9c368dcfa32fb802a0ac94" title="Renvoie un element geometrique du type de ceux qui constituent la zone. (version const)">type_elem</a>().<a class="code" href="classElem__geom.html#a7ba47620a58598a08fc07fe1f42601de">nom_lml</a>();
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 
<a name="l00390"></a>00390 <span class="comment">// Ajout pour modification syntaxe ci-dessous</span>
<a name="l00391"></a>00391   <span class="keywordtype">int</span> nb_elem = domaine.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>() ;
<a name="l00392"></a>00392   <span class="keywordtype">int</span> nb_som_elem = domaine.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#ae0b34a93b9ae8146df2d1884157afe9f" title="Renvoie le nombre de sommets des elements geometriques constituants la zone. Tous les elements de la ...">nb_som_elem</a>();
<a name="l00393"></a>00393   <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; sommet_elem = domaine.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#ac115e8342be89afb882b7b61cc343267" title="Renvoie le tableau des sommets des elements.">les_elems</a>();
<a name="l00394"></a>00394   <span class="keywordtype">int</span> nb_som_PE = <a class="code" href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071" title="Calul de la somme partielle de i sur les processeurs 0 a me()-1 (renvoie 0 sur le processeur 0)...">mppartial_sum</a>(nsom);
<a name="l00395"></a>00395   <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00396"></a>00396     {
<a name="l00397"></a>00397       s &lt;&lt; <span class="stringliteral">&quot;TOPOLOGIE&quot;</span> &lt;&lt; finl;
<a name="l00398"></a>00398       s &lt;&lt; nom_top &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nom_grille &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00399"></a>00399       s &lt;&lt;  <span class="stringliteral">&quot;MAILLE&quot;</span> &lt;&lt; finl;
<a name="l00400"></a>00400       s &lt;&lt; nb_elem_tot &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00401"></a>00401     }
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 <span class="comment">// Ecriture des elements du maillage</span>
<a name="l00404"></a>00404   <span class="keywordflow">if</span> (dim == 3 )
<a name="l00405"></a>00405     {
<a name="l00406"></a>00406       s.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00407"></a>00407 
<a name="l00408"></a>00408       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nelem=0; nelem&lt;nb_elem; nelem++)
<a name="l00409"></a>00409         {
<a name="l00410"></a>00410           s &lt;&lt; type_maille &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00411"></a>00411           <span class="keywordflow">for</span> (j=0; j&lt;nb_som_elem; j++)
<a name="l00412"></a>00412             s &lt;&lt; sommet_elem(nelem,j)+1+nb_som_PE &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;
<a name="l00413"></a>00413           s &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00414"></a>00414         }
<a name="l00415"></a>00415       s.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00416"></a>00416       s.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00417"></a>00417     }
<a name="l00418"></a>00418   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( dim == 2)
<a name="l00419"></a>00419     {
<a name="l00420"></a>00420       s.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00421"></a>00421       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nelem=0; nelem&lt;nb_elem; nelem++)
<a name="l00422"></a>00422         {
<a name="l00423"></a>00423           s &lt;&lt; type_maille &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00424"></a>00424           <span class="keywordtype">int</span> count = 0;
<a name="l00425"></a>00425           <span class="keywordflow">for</span> (j=0; j&lt;nb_som_elem &amp;&amp; (sommet_elem( nelem,j) &gt; -1); j++)
<a name="l00426"></a>00426             s &lt;&lt; sommet_elem( nelem,j)+1+2*nb_som_PE &lt;&lt; <span class="stringliteral">&quot; &quot;</span>, count++;
<a name="l00427"></a>00427           <span class="keywordflow">for</span> (j=0; j&lt;nb_som_elem &amp;&amp; (sommet_elem( nelem,j) &gt; -1); j++)
<a name="l00428"></a>00428             s &lt;&lt; sommet_elem( nelem,j)+1+2*nb_som_PE+nsom &lt;&lt; <span class="stringliteral">&quot; &quot;</span>, count++;
<a name="l00429"></a>00429           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = count; k &lt; 2 * nb_som_elem; k++) s &lt;&lt; (<span class="keywordtype">int</span>)0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00430"></a>00430           s &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00431"></a>00431           s.<a class="code" href="classEcrFicPartage.html#a19beb0cfbe321168ef1bd1d9ab59e69b" title="Force l&#39;ecriture sur disque des donnees dans le tampon Utilise l&#39;implementation de la classe ofstream...">flush</a>();
<a name="l00432"></a>00432         }
<a name="l00433"></a>00433       s.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00434"></a>00434       s.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00435"></a>00435     }
<a name="l00436"></a>00436   <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00437"></a>00437     {
<a name="l00438"></a>00438       s &lt;&lt;  <span class="stringliteral">&quot;FACE&quot;</span> &lt;&lt; finl ;
<a name="l00439"></a>00439       s &lt;&lt; (int)0 &lt;&lt; <span class="stringliteral">&quot;&quot;</span> &lt;&lt; finl;
<a name="l00440"></a>00440     }
<a name="l00441"></a>00441 
<a name="l00442"></a>00442 
<a name="l00443"></a>00443 <span class="comment">//</span>
<a name="l00444"></a>00444 
<a name="l00445"></a>00445   s.<a class="code" href="classEcrFicPartage.html#a19beb0cfbe321168ef1bd1d9ab59e69b" title="Force l&#39;ecriture sur disque des donnees dans le tampon Utilise l&#39;implementation de la classe ofstream...">flush</a>();
<a name="l00446"></a>00446   s.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00447"></a>00447 
<a name="l00448"></a>00448   <span class="keywordflow">return</span> 1;
<a name="l00449"></a>00449 }
<a name="l00450"></a>00450 
<a name="l00451"></a><a class="code" href="classFormat__Post__Lml.html#ac8246ef3046658b3caa13b330c9c25a7">00451</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#ac8246ef3046658b3caa13b330c9c25a7">Format_Post_Lml::ecrire_temps_lml</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> temps,<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fich)
<a name="l00452"></a>00452 {
<a name="l00453"></a>00453 
<a name="l00454"></a>00454   <a class="code" href="classEcrFicPartage.html">EcrFicPartage</a> s;
<a name="l00455"></a>00455   s.<a class="code" href="classEcrFicPartage.html#aae9fd9a7163d0edcb12e0235a2eabdfa" title="Ouvre le fichier avec les parametres mode et prot donnes Ces parametres sont les parametres de la met...">ouvrir</a>(nom_fich,ios::app);
<a name="l00456"></a>00456   <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00457"></a>00457     s &lt;&lt; <span class="stringliteral">&quot;TEMPS &quot;</span> &lt;&lt; temps &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00458"></a>00458   s.<a class="code" href="classEcrFicPartage.html#a19beb0cfbe321168ef1bd1d9ab59e69b" title="Force l&#39;ecriture sur disque des donnees dans le tampon Utilise l&#39;implementation de la classe ofstream...">flush</a>();
<a name="l00459"></a>00459   s.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00460"></a>00460 
<a name="l00461"></a>00461   <span class="keywordflow">return</span> 1;
<a name="l00462"></a>00462 }
<a name="l00463"></a>00463 
<a name="l00464"></a><a class="code" href="classFormat__Post__Lml.html#a14853550601066d7b2d100278eaddd7b">00464</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#a14853550601066d7b2d100278eaddd7b">Format_Post_Lml::ecrire_champ_lml</a>(<span class="keyword">const</span> <a class="code" href="classDomaine.html" title="Classe Domaine Un Domaine represente le domaine (spatial) de resolution d&#39;un Probleme. Un Domaine a un Nom, il est constitue d&#39;une ou plusieurs Zone qui peuvent etre eventuellement decoupees en Sous_Zone. Un Domaine porte l&#39;ensemble des sommets utilises par ses Zones. On peut vouloir resoudre des problemes de type different sur plusieurs domaines, geometriquement les domaines sont alors couples par des surfaces qu&#39;on appelle Raccord.">Domaine</a>&amp; domaine,<span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; unite_,<span class="keyword">const</span> <a class="code" href="classNoms.html" title="Un tableau de chaine de caracteres (VECT(Nom))">Noms</a>&amp; noms_compo,
<a name="l00465"></a>00465                                       <span class="keywordtype">int</span> ncomp, <span class="keywordtype">double</span> temps_,
<a name="l00466"></a>00466                                       <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   id_du_champ,
<a name="l00467"></a>00467                                       <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   id_du_domaine,
<a name="l00468"></a>00468                                       <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   localisation,
<a name="l00469"></a>00469                                       <span class="keyword">const</span> <a class="code" href="classDoubleTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un DoubleVect avec calculs de l&#39;indice corespondant Voir les...">DoubleTab</a>&amp; data,<a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fich)
<a name="l00470"></a>00470 
<a name="l00471"></a>00471 {
<a name="l00472"></a>00472   <a class="code" href="classEcrFicPartage.html">EcrFicPartage</a> os;
<a name="l00473"></a>00473   os.<a class="code" href="classEcrFicPartage.html#aae9fd9a7163d0edcb12e0235a2eabdfa" title="Ouvre le fichier avec les parametres mode et prot donnes Ces parametres sont les parametres de la met...">ouvrir</a>(nom_fich,ios::app);
<a name="l00474"></a>00474   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_top(<span class="stringliteral">&quot;Topologie_&quot;</span>);
<a name="l00475"></a>00475   nom_top+= domaine.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0).<a class="code" href="classZone.html#aad29ea7a38564404cc0417383233aaf0" title="Renvoie le nom de la zone.">le_nom</a>();
<a name="l00476"></a>00476   nom_top+=<span class="stringliteral">&quot;_&quot;</span>;
<a name="l00477"></a>00477   nom_top+=domaine.<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>();
<a name="l00478"></a>00478   <span class="keywordtype">int</span> dim = domaine.<a class="code" href="classDomaine.html#a0846ac03a10b65c4df911fe35a19c02f" title="Renvoie le nombre total de sommets.">les_sommets</a>().<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00479"></a>00479   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_post = id_du_champ;
<a name="l00480"></a>00480   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_dom= domaine.<a class="code" href="classDomaine.html#a87e2cdc035a26565e6fe481446aa4cd3" title="Renvoie le nom du domaine.">le_nom</a>();
<a name="l00481"></a>00481 
<a name="l00482"></a>00482   <span class="keywordflow">if</span> (ncomp==-1)
<a name="l00483"></a>00483     {
<a name="l00484"></a>00484       <span class="keywordtype">int</span> nb_compo_ = data.<a class="code" href="classDoubleTab.html#ae6dda48778e7107e1beb723beef1f75b" title="Returns the number of dimensions of the array (&gt;= 1)">nb_dim</a>()&gt;1 ? data.<a class="code" href="classDoubleTab.html#ac3805e2637a3b880ba2d3e650c69dac4" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) : 1;
<a name="l00485"></a>00485       <span class="keywordflow">if</span>(localisation==<span class="stringliteral">&quot;SOM&quot;</span>)
<a name="l00486"></a>00486         {
<a name="l00487"></a>00487           <span class="keywordtype">int</span> nb_som = domaine.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>();
<a name="l00488"></a>00488           <span class="keywordtype">int</span> nb_som_tot = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(nb_som);
<a name="l00489"></a>00489           <span class="keywordtype">int</span> nb_som_PE = <a class="code" href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071" title="Calul de la somme partielle de i sur les processeurs 0 a me()-1 (renvoie 0 sur le processeur 0)...">mppartial_sum</a>(nb_som);
<a name="l00490"></a>00490           <span class="keywordflow">if</span> (dim==2)
<a name="l00491"></a>00491             {
<a name="l00492"></a>00492               nb_som_tot*=2;
<a name="l00493"></a>00493               nb_som_PE*=2;
<a name="l00494"></a>00494             }
<a name="l00495"></a>00495           <span class="keywordtype">int</span> nb_compo_dv = (nb_compo_==2 ? 3 : nb_compo_);
<a name="l00496"></a>00496 
<a name="l00497"></a>00497           <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00498"></a>00498             {
<a name="l00499"></a>00499               os &lt;&lt; <span class="stringliteral">&quot;CHAMPPOINT &quot;</span> &lt;&lt; nom_post &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nom_top &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; temps_ &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00500"></a>00500               os &lt;&lt; nom_post &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nb_compo_dv &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; unite_[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00501"></a>00501                  &lt;&lt; <span class="stringliteral">&quot;type0&quot;</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nb_som_tot &lt;&lt; finl;
<a name="l00502"></a>00502             }
<a name="l00503"></a>00503           os.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00504"></a>00504           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4-dim; i++)
<a name="l00505"></a>00505             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nb_som; j++)
<a name="l00506"></a>00506               {
<a name="l00507"></a>00507                 os &lt;&lt; i * nb_som + j + 1 + nb_som_PE &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00508"></a>00508                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp = 0; comp &lt; nb_compo_; comp++)
<a name="l00509"></a>00509                   os &lt;&lt; data(j, comp) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00510"></a>00510                 <span class="keywordflow">if</span> (nb_compo_ == 2) os &lt;&lt; <span class="stringliteral">&quot;0.&quot;</span>;
<a name="l00511"></a>00511                 os &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00512"></a>00512               }
<a name="l00513"></a>00513           os.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00514"></a>00514           os.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00515"></a>00515         }
<a name="l00516"></a>00516       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(localisation==<span class="stringliteral">&quot;ELEM&quot;</span>)
<a name="l00517"></a>00517         {
<a name="l00518"></a>00518           <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone=domaine.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);
<a name="l00519"></a>00519           <span class="keywordtype">int</span> nb_elem=zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>();
<a name="l00520"></a>00520           <span class="keywordtype">int</span> nb_elem_tot = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(nb_elem);
<a name="l00521"></a>00521           <span class="keywordtype">int</span> nb_elem_PE = <a class="code" href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071" title="Calul de la somme partielle de i sur les processeurs 0 a me()-1 (renvoie 0 sur le processeur 0)...">mppartial_sum</a>(nb_elem);
<a name="l00522"></a>00522           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> comp=0; comp&lt;nb_compo_; comp++)
<a name="l00523"></a>00523             {
<a name="l00524"></a>00524               <span class="keywordflow">if</span> (<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00525"></a>00525                 {
<a name="l00526"></a>00526                   os &lt;&lt; <span class="stringliteral">&quot;CHAMPMAILLE &quot;</span>;
<a name="l00527"></a>00527                   os &lt;&lt; (nb_compo_ == 1 ? nom_post : noms_compo[comp]) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nom_top &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; temps_ &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00528"></a>00528                   os &lt;&lt; (nb_compo_ == 1 ? nom_post : noms_compo[comp]) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>)1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; unite_[comp] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;
<a name="l00529"></a>00529                   os &lt;&lt; <span class="stringliteral">&quot;type0&quot;</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nb_elem_tot &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00530"></a>00530                 }
<a name="l00531"></a>00531               os.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00532"></a>00532               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nb_elem; j++)
<a name="l00533"></a>00533                 os &lt;&lt; j+1+nb_elem_PE &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; data(j,comp) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00534"></a>00534               os.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00535"></a>00535               os.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00536"></a>00536             }
<a name="l00537"></a>00537         }
<a name="l00538"></a>00538       <span class="keywordflow">else</span>
<a name="l00539"></a>00539         {
<a name="l00540"></a>00540           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;We do not know to postprocess &quot;</span> &lt;&lt;  id_du_champ
<a name="l00541"></a>00541                &lt;&lt; <span class="stringliteral">&quot; with the keyword &quot;</span> &lt;&lt; localisation &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00542"></a>00542           <span class="keywordflow">return</span> -1;
<a name="l00543"></a>00543         }
<a name="l00544"></a>00544     }
<a name="l00545"></a>00545   <span class="keywordflow">else</span>
<a name="l00546"></a>00546     {
<a name="l00547"></a>00547       <span class="keywordflow">if</span>(localisation==<span class="stringliteral">&quot;SOM&quot;</span>)
<a name="l00548"></a>00548         {
<a name="l00549"></a>00549           <span class="keywordtype">int</span> nb_som=domaine.<a class="code" href="classDomaine.html#abc4abc8b8db5bebeb161fae4162a89ce" title="Renvoie le nombre de sommets.">nb_som</a>();
<a name="l00550"></a>00550           <span class="keywordtype">int</span> nb_som_tot = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(nb_som);
<a name="l00551"></a>00551           <span class="keywordtype">int</span> nb_som_PE = <a class="code" href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071" title="Calul de la somme partielle de i sur les processeurs 0 a me()-1 (renvoie 0 sur le processeur 0)...">mppartial_sum</a>(nb_som);
<a name="l00552"></a>00552           <span class="keywordflow">if</span> (dim==2)
<a name="l00553"></a>00553             {
<a name="l00554"></a>00554               nb_som_tot*=2;
<a name="l00555"></a>00555               nb_som_PE*=2;
<a name="l00556"></a>00556             }
<a name="l00557"></a>00557           <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00558"></a>00558             {
<a name="l00559"></a>00559               os &lt;&lt; <span class="stringliteral">&quot;CHAMPPOINT &quot;</span>;
<a name="l00560"></a>00560               os &lt;&lt; nom_post &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nom_top &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; temps_ &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00561"></a>00561               os &lt;&lt; nom_post &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (int)1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; unite_[ncomp] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00562"></a>00562                  &lt;&lt; <span class="stringliteral">&quot;type0&quot;</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nb_som_tot &lt;&lt; finl;
<a name="l00563"></a>00563             }
<a name="l00564"></a>00564           os.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00565"></a>00565           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4-dim; i++)
<a name="l00566"></a>00566             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nb_som; j++)
<a name="l00567"></a>00567               os &lt;&lt; i*nb_som+j+1+nb_som_PE &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; data(j) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00568"></a>00568           os.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00569"></a>00569           os.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00570"></a>00570         }
<a name="l00571"></a>00571       <span class="keywordflow">else</span> <span class="keywordflow">if</span>(localisation==<span class="stringliteral">&quot;ELEM&quot;</span>)
<a name="l00572"></a>00572         {
<a name="l00573"></a>00573           <span class="keyword">const</span> <a class="code" href="classZone.html" title="classe Zone Une Zone est un maillage compose d&#39;un ensemble d&#39;elements geometriques de meme type...">Zone</a>&amp; zone=domaine.<a class="code" href="classDomaine.html#a0e62f2bc829542fafa29e3f2c614159c" title="Renvoie la i-ieme zone du domaine. (version const)">zone</a>(0);
<a name="l00574"></a>00574           <span class="keywordtype">int</span> nb_elem=zone.<a class="code" href="classZone.html#a7f249429803b27139a1c54436f6164a5" title="Renvoie le nombre d&#39;elements de la zone.">nb_elem</a>();
<a name="l00575"></a>00575           <span class="keywordtype">int</span> nb_elem_tot = <a class="code" href="classProcess.html#a7d23bc1ef94b3f0623fbc79d034c27fd" title="Calcule la somme de x sur tous les processeurs du groupe courant. Voir aussi mp_max()">Process::mp_sum</a>(nb_elem);
<a name="l00576"></a>00576           <span class="keywordtype">int</span> nb_elem_PE = <a class="code" href="communications_8cpp.html#a13b5bdc7cfe14771b52a033b1ecbc071" title="Calul de la somme partielle de i sur les processeurs 0 a me()-1 (renvoie 0 sur le processeur 0)...">mppartial_sum</a>(nb_elem);
<a name="l00577"></a>00577           <span class="keywordflow">if</span>(<a class="code" href="classProcess.html#acd052b99706c577f8a5b6656217cf4c2" title="renvoie 1 si on est sur le processeur maitre du groupe courant (c&#39;est a dire me() == 0)...">je_suis_maitre</a>())
<a name="l00578"></a>00578             {
<a name="l00579"></a>00579               os &lt;&lt; <span class="stringliteral">&quot;CHAMPMAILLE &quot;</span>;
<a name="l00580"></a>00580               os &lt;&lt; nom_post &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nom_top &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; temps_ &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00581"></a>00581               os &lt;&lt; nom_post &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (int)1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; unite_[ncomp] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;
<a name="l00582"></a>00582               os &lt;&lt; <span class="stringliteral">&quot;type0&quot;</span> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; nb_elem_tot &lt;&lt; finl;
<a name="l00583"></a>00583             }
<a name="l00584"></a>00584           os.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00585"></a>00585           <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nb_elem; j++)
<a name="l00586"></a>00586             os &lt;&lt; j+1+nb_elem_PE &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; data(j) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00587"></a>00587           os.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00588"></a>00588           os.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00589"></a>00589         }
<a name="l00590"></a>00590       <span class="keywordflow">else</span>
<a name="l00591"></a>00591         {
<a name="l00592"></a>00592           <a class="code" href="EntreeSortie_8h.html#a5ebb6b5243d6167369bddecb78d0b5b8">Cerr</a> &lt;&lt; <span class="stringliteral">&quot;We do not know to postprocess &quot;</span> &lt;&lt; id_du_champ
<a name="l00593"></a>00593                &lt;&lt; <span class="stringliteral">&quot; with the keyword &quot;</span> &lt;&lt; localisation &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00594"></a>00594           <span class="keywordflow">return</span> -1;
<a name="l00595"></a>00595         }
<a name="l00596"></a>00596     }
<a name="l00597"></a>00597   <span class="keywordflow">return</span> 1;
<a name="l00598"></a>00598 }
<a name="l00599"></a>00599 
<a name="l00600"></a>00600 
<a name="l00601"></a><a class="code" href="classFormat__Post__Lml.html#a34d7b0ec1a2209e66f1bb3bf786142eb">00601</a> <span class="keywordtype">int</span> <a class="code" href="classFormat__Post__Lml.html#a34d7b0ec1a2209e66f1bb3bf786142eb">Format_Post_Lml::ecrire_item_int_lml</a>(<span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   id_item,
<a name="l00602"></a>00602                                          <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp;   id_zone,
<a name="l00603"></a>00603                                          <span class="keyword">const</span> <a class="code" href="classIntVect.html">IntVect</a>&amp; vect,
<a name="l00604"></a>00604                                          <span class="keyword">const</span> <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a>&amp; nom_fic)
<a name="l00605"></a>00605 {
<a name="l00606"></a>00606   <a class="code" href="classEcrFicPartage.html">EcrFicPartage</a> os;
<a name="l00607"></a>00607   os.<a class="code" href="classEcrFicPartage.html#aae9fd9a7163d0edcb12e0235a2eabdfa" title="Ouvre le fichier avec les parametres mode et prot donnes Ces parametres sont les parametres de la met...">ouvrir</a>(nom_fic,ios::app);
<a name="l00608"></a>00608 
<a name="l00609"></a>00609   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_vect(id_item);
<a name="l00610"></a>00610   nom_vect += <span class="stringliteral">&quot;_elem_dom&quot;</span>;
<a name="l00611"></a>00611 
<a name="l00612"></a>00612   <a class="code" href="classNom.html" title="class Nom Une chaine de caractere pour nommer les objets de TRUST">Nom</a> nom_topologie(<span class="stringliteral">&quot;Topologie_&quot;</span>);
<a name="l00613"></a>00613   nom_topologie+= id_zone;
<a name="l00614"></a>00614 
<a name="l00615"></a>00615 <span class="comment">// Actuellement temp_courant n est pas passe en argument</span>
<a name="l00616"></a>00616 <span class="comment">//</span>
<a name="l00617"></a>00617 
<a name="l00618"></a>00618   <span class="keywordflow">if</span> (<a class="code" href="Cast_8h.html#a9632e68536db6c29c2b754cb55381fbe">sub_type</a>(<a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>,vect))
<a name="l00619"></a>00619     {
<a name="l00620"></a>00620       <span class="keyword">const</span> <a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>&amp; tab = <a class="code" href="Cast_8h.html#ad116a7acb85c9c91e5687c44941a0d0c">ref_cast</a>(<a class="code" href="classIntTab.html" title="Tableau a n entrees pour n&lt;= 4 Repose sur un IntVect avec calculs de l&#39;indice corespondant Voir les co...">IntTab</a>,vect);
<a name="l00621"></a>00621       os.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00622"></a>00622       os &lt;&lt; nom_vect &lt;&lt; tab.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1) &lt;&lt; <span class="stringliteral">&quot; 1 &quot;</span> &lt;&lt; <span class="stringliteral">&quot; type0 &quot;</span> &lt;&lt; tab.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00623"></a>00623       os.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00624"></a>00624       os.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00625"></a>00625       {
<a name="l00626"></a>00626         <span class="keywordtype">int</span> tab_dimension0_opt=tab.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(0);
<a name="l00627"></a>00627         os.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00628"></a>00628         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;tab_dimension0_opt; i++)
<a name="l00629"></a>00629           {
<a name="l00630"></a>00630             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;tab.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1); j++)
<a name="l00631"></a>00631               {
<a name="l00632"></a>00632                 <span class="keywordtype">int</span> tab_dimension1_opt=tab.<a class="code" href="classIntTab.html#abc3b32c94925a82f69d5b153a356e359" title="Returns one of the &quot;real&quot; dimensions of the multi-dimensionnal array, as defined by: dimension(0) = s...">dimension</a>(1);
<a name="l00633"></a>00633                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j2=0; j2&lt;tab_dimension1_opt; j2++)
<a name="l00634"></a>00634                   os &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; tab(i,j2) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00635"></a>00635               }
<a name="l00636"></a>00636             os &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00637"></a>00637           }
<a name="l00638"></a>00638         os.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00639"></a>00639         os.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00640"></a>00640       }
<a name="l00641"></a>00641 
<a name="l00642"></a>00642     }
<a name="l00643"></a>00643   <span class="keywordflow">else</span>
<a name="l00644"></a>00644     {
<a name="l00645"></a>00645       os.<a class="code" href="classEcrFicPartage.html#a94805a085e3c4312dc43cb65217b8d1b" title="Permet au processus appelant de bloquer en attente de la ressource commune a tous les processus qui e...">lockfile</a>();
<a name="l00646"></a>00646       os &lt;&lt; nom_vect &lt;&lt; <span class="stringliteral">&quot; 1&quot;</span> &lt;&lt; <span class="stringliteral">&quot; 1 &quot;</span> &lt;&lt; <span class="stringliteral">&quot; type0 &quot;</span> &lt;&lt; vect.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>() &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00647"></a>00647       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;vect.<a class="code" href="classIntVect.html#ad90cfd411cbbd631ccf1935bb36f7c40" title="Identique a size_reelle()">size</a>(); i++)
<a name="l00648"></a>00648         os &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vect(i) &lt;&lt; <a class="code" href="EntreeSortie_8h.html#a7f716d3c5b6411631d5d0700ead09467">finl</a>;
<a name="l00649"></a>00649       os.<a class="code" href="classEcrFicPartage.html#a9e949d929e1f36fad99b492c32caea50" title="Permet de debloquer la ressource critique pour leprocessus suivant. Le processus appelant, sauf si c&#39;est le premier processus du groupe, envoie sa position courante au precessus suivant dans le groupe. Cette methode est a appeler apres chaque ecriture dans le fichier.">unlockfile</a>();
<a name="l00650"></a>00650       os.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00651"></a>00651     }
<a name="l00652"></a>00652 
<a name="l00653"></a>00653   os.<a class="code" href="classEcrFicPartage.html#a19beb0cfbe321168ef1bd1d9ab59e69b" title="Force l&#39;ecriture sur disque des donnees dans le tampon Utilise l&#39;implementation de la classe ofstream...">flush</a>();
<a name="l00654"></a>00654   os.<a class="code" href="classEcrFicPartage.html#a76131150f8293c86eb36f4b45125183d" title="Provoque l&#39;ecriture sur disque des donnees accumulees sur les differents processeurs depuis le dernie...">syncfile</a>();
<a name="l00655"></a>00655 
<a name="l00656"></a>00656   <span class="keywordflow">return</span> 1;
<a name="l00657"></a>00657 }
<a name="l00658"></a>00658 
<a name="l00659"></a>00659 
<a name="l00660"></a>00660 
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 14 2021 19:35:15 for TRUST by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
